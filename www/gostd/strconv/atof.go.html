<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html" class="current">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2065026">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2065081">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2065135">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2065186">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2065263">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2065287">package</span>&nbsp;<span class="ident" id="2065295">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2065304">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2065352">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2065366">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2065413">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2065486">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2065546">import</span>&nbsp;<span class="string" id="2065553">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2065561">var</span>&nbsp;<span class="ident" id="2065565">optimize</span>&nbsp;<span class="op" id="2065574">=</span>&nbsp;<span class="builtintype" id="2065576">true</span>&nbsp;<span class="comment" id="2065581">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2065608">func</span>&nbsp;<span class="ident" id="2065613">equalIgnoreCase</span><span class="op" id="2065628">(</span><span class="ident" id="2065629">s1</span><span class="op" id="2065631">,</span>&nbsp;<span class="ident" id="2065633">s2</span>&nbsp;<span class="builtintype" id="2065636">string</span><span class="op" id="2065642">)</span>&nbsp;<span class="builtintype" id="2065644">bool</span>&nbsp;<span class="op" id="2065649">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065652">if</span>&nbsp;<span class="builtinfunc" id="2065655">len</span><span class="op" id="2065658">(</span><span class="ident" id="2065659">s1</span><span class="op" id="2065661">)</span>&nbsp;<span class="op" id="2065663">!=</span>&nbsp;<span class="builtinfunc" id="2065666">len</span><span class="op" id="2065669">(</span><span class="ident" id="2065670">s2</span><span class="op" id="2065672">)</span>&nbsp;<span class="op" id="2065674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065678">return</span>&nbsp;<span class="builtintype" id="2065685">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065695">for</span>&nbsp;<span class="ident" id="2065699">i</span>&nbsp;<span class="op" id="2065701">:=</span>&nbsp;<span class="num" id="2065704">0</span><span class="op" id="2065705">;</span>&nbsp;<span class="ident" id="2065707">i</span>&nbsp;<span class="op" id="2065709">&lt;</span>&nbsp;<span class="builtinfunc" id="2065711">len</span><span class="op" id="2065714">(</span><span class="ident" id="2065715">s1</span><span class="op" id="2065717">)</span><span class="op" id="2065718">;</span>&nbsp;<span class="ident" id="2065720">i</span><span class="op" id="2065721">++</span>&nbsp;<span class="op" id="2065724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065728">c1</span>&nbsp;<span class="op" id="2065731">:=</span>&nbsp;<span class="ident" id="2065734">s1</span><span class="op" id="2065736">[</span><span class="ident" id="2065737">i</span><span class="op" id="2065738">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065742">if</span>&nbsp;<span class="string" id="2065745">&#39;A&#39;</span>&nbsp;<span class="op" id="2065749">&lt;=</span>&nbsp;<span class="ident" id="2065752">c1</span>&nbsp;<span class="op" id="2065755">&amp;&amp;</span>&nbsp;<span class="ident" id="2065758">c1</span>&nbsp;<span class="op" id="2065761">&lt;=</span>&nbsp;<span class="string" id="2065764">&#39;Z&#39;</span>&nbsp;<span class="op" id="2065768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065773">c1</span>&nbsp;<span class="op" id="2065776">+=</span>&nbsp;<span class="string" id="2065779">&#39;a&#39;</span>&nbsp;<span class="op" id="2065783">-</span>&nbsp;<span class="string" id="2065785">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065795">c2</span>&nbsp;<span class="op" id="2065798">:=</span>&nbsp;<span class="ident" id="2065801">s2</span><span class="op" id="2065803">[</span><span class="ident" id="2065804">i</span><span class="op" id="2065805">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065809">if</span>&nbsp;<span class="string" id="2065812">&#39;A&#39;</span>&nbsp;<span class="op" id="2065816">&lt;=</span>&nbsp;<span class="ident" id="2065819">c2</span>&nbsp;<span class="op" id="2065822">&amp;&amp;</span>&nbsp;<span class="ident" id="2065825">c2</span>&nbsp;<span class="op" id="2065828">&lt;=</span>&nbsp;<span class="string" id="2065831">&#39;Z&#39;</span>&nbsp;<span class="op" id="2065835">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2065840">c2</span>&nbsp;<span class="op" id="2065843">+=</span>&nbsp;<span class="string" id="2065846">&#39;a&#39;</span>&nbsp;<span class="op" id="2065850">-</span>&nbsp;<span class="string" id="2065852">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065862">if</span>&nbsp;<span class="ident" id="2065865">c1</span>&nbsp;<span class="op" id="2065868">!=</span>&nbsp;<span class="ident" id="2065871">c2</span>&nbsp;<span class="op" id="2065874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065879">return</span>&nbsp;<span class="builtintype" id="2065886">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065894">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065900">return</span>&nbsp;<span class="builtintype" id="2065907">true</span><br>
<span class="lineno"></span><span class="op" id="2065912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2065915">func</span>&nbsp;<span class="ident" id="2065920">special</span><span class="op" id="2065927">(</span><span class="ident" id="2065928">s</span>&nbsp;<span class="builtintype" id="2065930">string</span><span class="op" id="2065936">)</span>&nbsp;<span class="op" id="2065938">(</span><span class="ident" id="2065939">f</span>&nbsp;<span class="builtintype" id="2065941">float64</span><span class="op" id="2065948">,</span>&nbsp;<span class="ident" id="2065950">ok</span>&nbsp;<span class="builtintype" id="2065953">bool</span><span class="op" id="2065957">)</span>&nbsp;<span class="op" id="2065959">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065962">if</span>&nbsp;<span class="builtinfunc" id="2065965">len</span><span class="op" id="2065968">(</span><span class="ident" id="2065969">s</span><span class="op" id="2065970">)</span>&nbsp;<span class="op" id="2065972">==</span>&nbsp;<span class="num" id="2065975">0</span>&nbsp;<span class="op" id="2065977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065981">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2065989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2065992">switch</span>&nbsp;<span class="ident" id="2065999">s</span><span class="op" id="2066000">[</span><span class="num" id="2066001">0</span><span class="op" id="2066002">]</span>&nbsp;<span class="op" id="2066004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066007">default</span><span class="op" id="2066014">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066026">case</span>&nbsp;<span class="string" id="2066031">&#39;+&#39;</span><span class="op" id="2066034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066038">if</span>&nbsp;<span class="ident" id="2066041">equalIgnoreCase</span><span class="op" id="2066056">(</span><span class="ident" id="2066057">s</span><span class="op" id="2066058">,</span>&nbsp;<span class="string" id="2066060">&#34;+inf&#34;</span><span class="op" id="2066066">)</span>&nbsp;<span class="op" id="2066068">||</span>&nbsp;<span class="ident" id="2066071">equalIgnoreCase</span><span class="op" id="2066086">(</span><span class="ident" id="2066087">s</span><span class="op" id="2066088">,</span>&nbsp;<span class="string" id="2066090">&#34;+infinity&#34;</span><span class="op" id="2066101">)</span>&nbsp;<span class="op" id="2066103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066108">return</span>&nbsp;<span class="ident" id="2066115">math</span><span class="op" id="2066119">.</span><span class="ident" id="2066120">Inf</span><span class="op" id="2066123">(</span><span class="num" id="2066124">1</span><span class="op" id="2066125">)</span><span class="op" id="2066126">,</span>&nbsp;<span class="builtintype" id="2066128">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066135">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066138">case</span>&nbsp;<span class="string" id="2066143">&#39;-&#39;</span><span class="op" id="2066146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066150">if</span>&nbsp;<span class="ident" id="2066153">equalIgnoreCase</span><span class="op" id="2066168">(</span><span class="ident" id="2066169">s</span><span class="op" id="2066170">,</span>&nbsp;<span class="string" id="2066172">&#34;-inf&#34;</span><span class="op" id="2066178">)</span>&nbsp;<span class="op" id="2066180">||</span>&nbsp;<span class="ident" id="2066183">equalIgnoreCase</span><span class="op" id="2066198">(</span><span class="ident" id="2066199">s</span><span class="op" id="2066200">,</span>&nbsp;<span class="string" id="2066202">&#34;-infinity&#34;</span><span class="op" id="2066213">)</span>&nbsp;<span class="op" id="2066215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066220">return</span>&nbsp;<span class="ident" id="2066227">math</span><span class="op" id="2066231">.</span><span class="ident" id="2066232">Inf</span><span class="op" id="2066235">(</span><span class="op" id="2066236">-</span><span class="num" id="2066237">1</span><span class="op" id="2066238">)</span><span class="op" id="2066239">,</span>&nbsp;<span class="builtintype" id="2066241">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066251">case</span>&nbsp;<span class="string" id="2066256">&#39;n&#39;</span><span class="op" id="2066259">,</span>&nbsp;<span class="string" id="2066261">&#39;N&#39;</span><span class="op" id="2066264">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066268">if</span>&nbsp;<span class="ident" id="2066271">equalIgnoreCase</span><span class="op" id="2066286">(</span><span class="ident" id="2066287">s</span><span class="op" id="2066288">,</span>&nbsp;<span class="string" id="2066290">&#34;nan&#34;</span><span class="op" id="2066295">)</span>&nbsp;<span class="op" id="2066297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066302">return</span>&nbsp;<span class="ident" id="2066309">math</span><span class="op" id="2066313">.</span><span class="ident" id="2066314">NaN</span><span class="op" id="2066317">(</span><span class="op" id="2066318">)</span><span class="op" id="2066319">,</span>&nbsp;<span class="builtintype" id="2066321">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066331">case</span>&nbsp;<span class="string" id="2066336">&#39;i&#39;</span><span class="op" id="2066339">,</span>&nbsp;<span class="string" id="2066341">&#39;I&#39;</span><span class="op" id="2066344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066348">if</span>&nbsp;<span class="ident" id="2066351">equalIgnoreCase</span><span class="op" id="2066366">(</span><span class="ident" id="2066367">s</span><span class="op" id="2066368">,</span>&nbsp;<span class="string" id="2066370">&#34;inf&#34;</span><span class="op" id="2066375">)</span>&nbsp;<span class="op" id="2066377">||</span>&nbsp;<span class="ident" id="2066380">equalIgnoreCase</span><span class="op" id="2066395">(</span><span class="ident" id="2066396">s</span><span class="op" id="2066397">,</span>&nbsp;<span class="string" id="2066399">&#34;infinity&#34;</span><span class="op" id="2066409">)</span>&nbsp;<span class="op" id="2066411">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066416">return</span>&nbsp;<span class="ident" id="2066423">math</span><span class="op" id="2066427">.</span><span class="ident" id="2066428">Inf</span><span class="op" id="2066431">(</span><span class="num" id="2066432">1</span><span class="op" id="2066433">)</span><span class="op" id="2066434">,</span>&nbsp;<span class="builtintype" id="2066436">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066449">return</span><br>
<span class="lineno"></span><span class="op" id="2066456">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2066459">func</span>&nbsp;<span class="op" id="2066464">(</span><span class="ident" id="2066465">b</span>&nbsp;<span class="op" id="2066467">*</span><span class="ident" id="2066468">decimal</span><span class="op" id="2066475">)</span>&nbsp;<span class="ident" id="2066477">set</span><span class="op" id="2066480">(</span><span class="ident" id="2066481">s</span>&nbsp;<span class="builtintype" id="2066483">string</span><span class="op" id="2066489">)</span>&nbsp;<span class="op" id="2066491">(</span><span class="ident" id="2066492">ok</span>&nbsp;<span class="builtintype" id="2066495">bool</span><span class="op" id="2066499">)</span>&nbsp;<span class="op" id="2066501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066504">i</span>&nbsp;<span class="op" id="2066506">:=</span>&nbsp;<span class="num" id="2066509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066512">b</span><span class="op" id="2066513">.</span><span class="ident" id="2066514">neg</span>&nbsp;<span class="op" id="2066518">=</span>&nbsp;<span class="builtintype" id="2066520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066527">b</span><span class="op" id="2066528">.</span><span class="ident" id="2066529">trunc</span>&nbsp;<span class="op" id="2066535">=</span>&nbsp;<span class="builtintype" id="2066537">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066545">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066563">if</span>&nbsp;<span class="ident" id="2066566">i</span>&nbsp;<span class="op" id="2066568">&gt;=</span>&nbsp;<span class="builtinfunc" id="2066571">len</span><span class="op" id="2066574">(</span><span class="ident" id="2066575">s</span><span class="op" id="2066576">)</span>&nbsp;<span class="op" id="2066578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066582">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066590">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066593">switch</span>&nbsp;<span class="op" id="2066600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066603">case</span>&nbsp;<span class="ident" id="2066608">s</span><span class="op" id="2066609">[</span><span class="ident" id="2066610">i</span><span class="op" id="2066611">]</span>&nbsp;<span class="op" id="2066613">==</span>&nbsp;<span class="string" id="2066616">&#39;+&#39;</span><span class="op" id="2066619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066623">i</span><span class="op" id="2066624">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066628">case</span>&nbsp;<span class="ident" id="2066633">s</span><span class="op" id="2066634">[</span><span class="ident" id="2066635">i</span><span class="op" id="2066636">]</span>&nbsp;<span class="op" id="2066638">==</span>&nbsp;<span class="string" id="2066641">&#39;-&#39;</span><span class="op" id="2066644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066648">b</span><span class="op" id="2066649">.</span><span class="ident" id="2066650">neg</span>&nbsp;<span class="op" id="2066654">=</span>&nbsp;<span class="builtintype" id="2066656">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066663">i</span><span class="op" id="2066664">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2066672">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066683">sawdot</span>&nbsp;<span class="op" id="2066690">:=</span>&nbsp;<span class="builtintype" id="2066693">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066700">sawdigits</span>&nbsp;<span class="op" id="2066710">:=</span>&nbsp;<span class="builtintype" id="2066713">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066720">for</span>&nbsp;<span class="op" id="2066724">;</span>&nbsp;<span class="ident" id="2066726">i</span>&nbsp;<span class="op" id="2066728">&lt;</span>&nbsp;<span class="builtinfunc" id="2066730">len</span><span class="op" id="2066733">(</span><span class="ident" id="2066734">s</span><span class="op" id="2066735">)</span><span class="op" id="2066736">;</span>&nbsp;<span class="ident" id="2066738">i</span><span class="op" id="2066739">++</span>&nbsp;<span class="op" id="2066742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066746">switch</span>&nbsp;<span class="op" id="2066753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066757">case</span>&nbsp;<span class="ident" id="2066762">s</span><span class="op" id="2066763">[</span><span class="ident" id="2066764">i</span><span class="op" id="2066765">]</span>&nbsp;<span class="op" id="2066767">==</span>&nbsp;<span class="string" id="2066770">&#39;.&#39;</span><span class="op" id="2066773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066778">if</span>&nbsp;<span class="ident" id="2066781">sawdot</span>&nbsp;<span class="op" id="2066788">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066794">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066809">sawdot</span>&nbsp;<span class="op" id="2066816">=</span>&nbsp;<span class="builtintype" id="2066818">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066826">b</span><span class="op" id="2066827">.</span><span class="ident" id="2066828">dp</span>&nbsp;<span class="op" id="2066831">=</span>&nbsp;<span class="ident" id="2066833">b</span><span class="op" id="2066834">.</span><span class="ident" id="2066835">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066841">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066853">case</span>&nbsp;<span class="string" id="2066858">&#39;0&#39;</span>&nbsp;<span class="op" id="2066862">&lt;=</span>&nbsp;<span class="ident" id="2066865">s</span><span class="op" id="2066866">[</span><span class="ident" id="2066867">i</span><span class="op" id="2066868">]</span>&nbsp;<span class="op" id="2066870">&amp;&amp;</span>&nbsp;<span class="ident" id="2066873">s</span><span class="op" id="2066874">[</span><span class="ident" id="2066875">i</span><span class="op" id="2066876">]</span>&nbsp;<span class="op" id="2066878">&lt;=</span>&nbsp;<span class="string" id="2066881">&#39;9&#39;</span><span class="op" id="2066884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066889">sawdigits</span>&nbsp;<span class="op" id="2066899">=</span>&nbsp;<span class="builtintype" id="2066901">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066909">if</span>&nbsp;<span class="ident" id="2066912">s</span><span class="op" id="2066913">[</span><span class="ident" id="2066914">i</span><span class="op" id="2066915">]</span>&nbsp;<span class="op" id="2066917">==</span>&nbsp;<span class="string" id="2066920">&#39;0&#39;</span>&nbsp;<span class="op" id="2066924">&amp;&amp;</span>&nbsp;<span class="ident" id="2066927">b</span><span class="op" id="2066928">.</span><span class="ident" id="2066929">nd</span>&nbsp;<span class="op" id="2066932">==</span>&nbsp;<span class="num" id="2066935">0</span>&nbsp;<span class="op" id="2066937">{</span>&nbsp;<span class="comment" id="2066939">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2066967">b</span><span class="op" id="2066968">.</span><span class="ident" id="2066969">dp</span><span class="op" id="2066971">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066978">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2066990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2066995">if</span>&nbsp;<span class="ident" id="2066998">b</span><span class="op" id="2066999">.</span><span class="ident" id="2067000">nd</span>&nbsp;<span class="op" id="2067003">&lt;</span>&nbsp;<span class="builtinfunc" id="2067005">len</span><span class="op" id="2067008">(</span><span class="ident" id="2067009">b</span><span class="op" id="2067010">.</span><span class="ident" id="2067011">d</span><span class="op" id="2067012">)</span>&nbsp;<span class="op" id="2067014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067020">b</span><span class="op" id="2067021">.</span><span class="ident" id="2067022">d</span><span class="op" id="2067023">[</span><span class="ident" id="2067024">b</span><span class="op" id="2067025">.</span><span class="ident" id="2067026">nd</span><span class="op" id="2067028">]</span>&nbsp;<span class="op" id="2067030">=</span>&nbsp;<span class="ident" id="2067032">s</span><span class="op" id="2067033">[</span><span class="ident" id="2067034">i</span><span class="op" id="2067035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067041">b</span><span class="op" id="2067042">.</span><span class="ident" id="2067043">nd</span><span class="op" id="2067045">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067051">}</span>&nbsp;<span class="keyword" id="2067053">else</span>&nbsp;<span class="keyword" id="2067058">if</span>&nbsp;<span class="ident" id="2067061">s</span><span class="op" id="2067062">[</span><span class="ident" id="2067063">i</span><span class="op" id="2067064">]</span>&nbsp;<span class="op" id="2067066">!=</span>&nbsp;<span class="string" id="2067069">&#39;0&#39;</span>&nbsp;<span class="op" id="2067073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067079">b</span><span class="op" id="2067080">.</span><span class="ident" id="2067081">trunc</span>&nbsp;<span class="op" id="2067087">=</span>&nbsp;<span class="builtintype" id="2067089">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067102">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067113">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067117">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067127">if</span>&nbsp;<span class="op" id="2067130">!</span><span class="ident" id="2067131">sawdigits</span>&nbsp;<span class="op" id="2067141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067145">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067153">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067156">if</span>&nbsp;<span class="op" id="2067159">!</span><span class="ident" id="2067160">sawdot</span>&nbsp;<span class="op" id="2067167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067171">b</span><span class="op" id="2067172">.</span><span class="ident" id="2067173">dp</span>&nbsp;<span class="op" id="2067176">=</span>&nbsp;<span class="ident" id="2067178">b</span><span class="op" id="2067179">.</span><span class="ident" id="2067180">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067188">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067231">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067278">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067324">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2067376">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067402">if</span>&nbsp;<span class="ident" id="2067405">i</span>&nbsp;<span class="op" id="2067407">&lt;</span>&nbsp;<span class="builtinfunc" id="2067409">len</span><span class="op" id="2067412">(</span><span class="ident" id="2067413">s</span><span class="op" id="2067414">)</span>&nbsp;<span class="op" id="2067416">&amp;&amp;</span>&nbsp;<span class="op" id="2067419">(</span><span class="ident" id="2067420">s</span><span class="op" id="2067421">[</span><span class="ident" id="2067422">i</span><span class="op" id="2067423">]</span>&nbsp;<span class="op" id="2067425">==</span>&nbsp;<span class="string" id="2067428">&#39;e&#39;</span>&nbsp;<span class="op" id="2067432">||</span>&nbsp;<span class="ident" id="2067435">s</span><span class="op" id="2067436">[</span><span class="ident" id="2067437">i</span><span class="op" id="2067438">]</span>&nbsp;<span class="op" id="2067440">==</span>&nbsp;<span class="string" id="2067443">&#39;E&#39;</span><span class="op" id="2067446">)</span>&nbsp;<span class="op" id="2067448">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067452">i</span><span class="op" id="2067453">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067458">if</span>&nbsp;<span class="ident" id="2067461">i</span>&nbsp;<span class="op" id="2067463">&gt;=</span>&nbsp;<span class="builtinfunc" id="2067466">len</span><span class="op" id="2067469">(</span><span class="ident" id="2067470">s</span><span class="op" id="2067471">)</span>&nbsp;<span class="op" id="2067473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067478">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067491">esign</span>&nbsp;<span class="op" id="2067497">:=</span>&nbsp;<span class="num" id="2067500">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067504">if</span>&nbsp;<span class="ident" id="2067507">s</span><span class="op" id="2067508">[</span><span class="ident" id="2067509">i</span><span class="op" id="2067510">]</span>&nbsp;<span class="op" id="2067512">==</span>&nbsp;<span class="string" id="2067515">&#39;+&#39;</span>&nbsp;<span class="op" id="2067519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067524">i</span><span class="op" id="2067525">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067530">}</span>&nbsp;<span class="keyword" id="2067532">else</span>&nbsp;<span class="keyword" id="2067537">if</span>&nbsp;<span class="ident" id="2067540">s</span><span class="op" id="2067541">[</span><span class="ident" id="2067542">i</span><span class="op" id="2067543">]</span>&nbsp;<span class="op" id="2067545">==</span>&nbsp;<span class="string" id="2067548">&#39;-&#39;</span>&nbsp;<span class="op" id="2067552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067557">i</span><span class="op" id="2067558">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067564">esign</span>&nbsp;<span class="op" id="2067570">=</span>&nbsp;<span class="op" id="2067572">-</span><span class="num" id="2067573">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067581">if</span>&nbsp;<span class="ident" id="2067584">i</span>&nbsp;<span class="op" id="2067586">&gt;=</span>&nbsp;<span class="builtinfunc" id="2067589">len</span><span class="op" id="2067592">(</span><span class="ident" id="2067593">s</span><span class="op" id="2067594">)</span>&nbsp;<span class="op" id="2067596">||</span>&nbsp;<span class="ident" id="2067599">s</span><span class="op" id="2067600">[</span><span class="ident" id="2067601">i</span><span class="op" id="2067602">]</span>&nbsp;<span class="op" id="2067604">&lt;</span>&nbsp;<span class="string" id="2067606">&#39;0&#39;</span>&nbsp;<span class="op" id="2067610">||</span>&nbsp;<span class="ident" id="2067613">s</span><span class="op" id="2067614">[</span><span class="ident" id="2067615">i</span><span class="op" id="2067616">]</span>&nbsp;<span class="op" id="2067618">&gt;</span>&nbsp;<span class="string" id="2067620">&#39;9&#39;</span>&nbsp;<span class="op" id="2067624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067629">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067642">e</span>&nbsp;<span class="op" id="2067644">:=</span>&nbsp;<span class="num" id="2067647">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067651">for</span>&nbsp;<span class="op" id="2067655">;</span>&nbsp;<span class="ident" id="2067657">i</span>&nbsp;<span class="op" id="2067659">&lt;</span>&nbsp;<span class="builtinfunc" id="2067661">len</span><span class="op" id="2067664">(</span><span class="ident" id="2067665">s</span><span class="op" id="2067666">)</span>&nbsp;<span class="op" id="2067668">&amp;&amp;</span>&nbsp;<span class="string" id="2067671">&#39;0&#39;</span>&nbsp;<span class="op" id="2067675">&lt;=</span>&nbsp;<span class="ident" id="2067678">s</span><span class="op" id="2067679">[</span><span class="ident" id="2067680">i</span><span class="op" id="2067681">]</span>&nbsp;<span class="op" id="2067683">&amp;&amp;</span>&nbsp;<span class="ident" id="2067686">s</span><span class="op" id="2067687">[</span><span class="ident" id="2067688">i</span><span class="op" id="2067689">]</span>&nbsp;<span class="op" id="2067691">&lt;=</span>&nbsp;<span class="string" id="2067694">&#39;9&#39;</span><span class="op" id="2067697">;</span>&nbsp;<span class="ident" id="2067699">i</span><span class="op" id="2067700">++</span>&nbsp;<span class="op" id="2067703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067708">if</span>&nbsp;<span class="ident" id="2067711">e</span>&nbsp;<span class="op" id="2067713">&lt;</span>&nbsp;<span class="num" id="2067715">10000</span>&nbsp;<span class="op" id="2067721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067727">e</span>&nbsp;<span class="op" id="2067729">=</span>&nbsp;<span class="ident" id="2067731">e</span><span class="op" id="2067732">*</span><span class="num" id="2067733">10</span>&nbsp;<span class="op" id="2067736">+</span>&nbsp;<span class="builtintype" id="2067738">int</span><span class="op" id="2067741">(</span><span class="ident" id="2067742">s</span><span class="op" id="2067743">[</span><span class="ident" id="2067744">i</span><span class="op" id="2067745">]</span><span class="op" id="2067746">)</span>&nbsp;<span class="op" id="2067748">-</span>&nbsp;<span class="string" id="2067750">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067761">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067765">b</span><span class="op" id="2067766">.</span><span class="ident" id="2067767">dp</span>&nbsp;<span class="op" id="2067770">+=</span>&nbsp;<span class="ident" id="2067773">e</span>&nbsp;<span class="op" id="2067775">*</span>&nbsp;<span class="ident" id="2067777">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067788">if</span>&nbsp;<span class="ident" id="2067791">i</span>&nbsp;<span class="op" id="2067793">!=</span>&nbsp;<span class="builtinfunc" id="2067796">len</span><span class="op" id="2067799">(</span><span class="ident" id="2067800">s</span><span class="op" id="2067801">)</span>&nbsp;<span class="op" id="2067803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067807">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2067815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2067819">ok</span>&nbsp;<span class="op" id="2067822">=</span>&nbsp;<span class="builtintype" id="2067824">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2067830">return</span><br>
<span class="lineno"></span><span class="op" id="2067837">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2067840">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2067904">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2067970">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2068009">func</span>&nbsp;<span class="ident" id="2068014">readFloat</span><span class="op" id="2068023">(</span><span class="ident" id="2068024">s</span>&nbsp;<span class="builtintype" id="2068026">string</span><span class="op" id="2068032">)</span>&nbsp;<span class="op" id="2068034">(</span><span class="ident" id="2068035">mantissa</span>&nbsp;<span class="ident" id="2068044">uint64</span><span class="op" id="2068050">,</span>&nbsp;<span class="ident" id="2068052">exp</span>&nbsp;<span class="builtintype" id="2068056">int</span><span class="op" id="2068059">,</span>&nbsp;<span class="ident" id="2068061">neg</span><span class="op" id="2068064">,</span>&nbsp;<span class="ident" id="2068066">trunc</span><span class="op" id="2068071">,</span>&nbsp;<span class="ident" id="2068073">ok</span>&nbsp;<span class="builtintype" id="2068076">bool</span><span class="op" id="2068080">)</span>&nbsp;<span class="op" id="2068082">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068085">const</span>&nbsp;<span class="ident" id="2068091">uint64digits</span>&nbsp;<span class="op" id="2068104">=</span>&nbsp;<span class="num" id="2068106">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068110">i</span>&nbsp;<span class="op" id="2068112">:=</span>&nbsp;<span class="num" id="2068115">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068119">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068137">if</span>&nbsp;<span class="ident" id="2068140">i</span>&nbsp;<span class="op" id="2068142">&gt;=</span>&nbsp;<span class="builtinfunc" id="2068145">len</span><span class="op" id="2068148">(</span><span class="ident" id="2068149">s</span><span class="op" id="2068150">)</span>&nbsp;<span class="op" id="2068152">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068156">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068167">switch</span>&nbsp;<span class="op" id="2068174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068177">case</span>&nbsp;<span class="ident" id="2068182">s</span><span class="op" id="2068183">[</span><span class="ident" id="2068184">i</span><span class="op" id="2068185">]</span>&nbsp;<span class="op" id="2068187">==</span>&nbsp;<span class="string" id="2068190">&#39;+&#39;</span><span class="op" id="2068193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068197">i</span><span class="op" id="2068198">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068202">case</span>&nbsp;<span class="ident" id="2068207">s</span><span class="op" id="2068208">[</span><span class="ident" id="2068209">i</span><span class="op" id="2068210">]</span>&nbsp;<span class="op" id="2068212">==</span>&nbsp;<span class="string" id="2068215">&#39;-&#39;</span><span class="op" id="2068218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068222">neg</span>&nbsp;<span class="op" id="2068226">=</span>&nbsp;<span class="builtintype" id="2068228">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068235">i</span><span class="op" id="2068236">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068244">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068255">sawdot</span>&nbsp;<span class="op" id="2068262">:=</span>&nbsp;<span class="builtintype" id="2068265">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068272">sawdigits</span>&nbsp;<span class="op" id="2068282">:=</span>&nbsp;<span class="builtintype" id="2068285">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068292">nd</span>&nbsp;<span class="op" id="2068295">:=</span>&nbsp;<span class="num" id="2068298">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068301">ndMant</span>&nbsp;<span class="op" id="2068308">:=</span>&nbsp;<span class="num" id="2068311">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068314">dp</span>&nbsp;<span class="op" id="2068317">:=</span>&nbsp;<span class="num" id="2068320">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068323">for</span>&nbsp;<span class="op" id="2068327">;</span>&nbsp;<span class="ident" id="2068329">i</span>&nbsp;<span class="op" id="2068331">&lt;</span>&nbsp;<span class="builtinfunc" id="2068333">len</span><span class="op" id="2068336">(</span><span class="ident" id="2068337">s</span><span class="op" id="2068338">)</span><span class="op" id="2068339">;</span>&nbsp;<span class="ident" id="2068341">i</span><span class="op" id="2068342">++</span>&nbsp;<span class="op" id="2068345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068349">switch</span>&nbsp;<span class="ident" id="2068356">c</span>&nbsp;<span class="op" id="2068358">:=</span>&nbsp;<span class="ident" id="2068361">s</span><span class="op" id="2068362">[</span><span class="ident" id="2068363">i</span><span class="op" id="2068364">]</span><span class="op" id="2068365">;</span>&nbsp;<span class="builtintype" id="2068367">true</span>&nbsp;<span class="op" id="2068372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068376">case</span>&nbsp;<span class="ident" id="2068381">c</span>&nbsp;<span class="op" id="2068383">==</span>&nbsp;<span class="string" id="2068386">&#39;.&#39;</span><span class="op" id="2068389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068394">if</span>&nbsp;<span class="ident" id="2068397">sawdot</span>&nbsp;<span class="op" id="2068404">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068410">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068425">sawdot</span>&nbsp;<span class="op" id="2068432">=</span>&nbsp;<span class="builtintype" id="2068434">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068442">dp</span>&nbsp;<span class="op" id="2068445">=</span>&nbsp;<span class="ident" id="2068447">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068453">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068465">case</span>&nbsp;<span class="string" id="2068470">&#39;0&#39;</span>&nbsp;<span class="op" id="2068474">&lt;=</span>&nbsp;<span class="ident" id="2068477">c</span>&nbsp;<span class="op" id="2068479">&amp;&amp;</span>&nbsp;<span class="ident" id="2068482">c</span>&nbsp;<span class="op" id="2068484">&lt;=</span>&nbsp;<span class="string" id="2068487">&#39;9&#39;</span><span class="op" id="2068490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068495">sawdigits</span>&nbsp;<span class="op" id="2068505">=</span>&nbsp;<span class="builtintype" id="2068507">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068515">if</span>&nbsp;<span class="ident" id="2068518">c</span>&nbsp;<span class="op" id="2068520">==</span>&nbsp;<span class="string" id="2068523">&#39;0&#39;</span>&nbsp;<span class="op" id="2068527">&amp;&amp;</span>&nbsp;<span class="ident" id="2068530">nd</span>&nbsp;<span class="op" id="2068533">==</span>&nbsp;<span class="num" id="2068536">0</span>&nbsp;<span class="op" id="2068538">{</span>&nbsp;<span class="comment" id="2068540">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068568">dp</span><span class="op" id="2068570">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068577">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068594">nd</span><span class="op" id="2068596">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068602">if</span>&nbsp;<span class="ident" id="2068605">ndMant</span>&nbsp;<span class="op" id="2068612">&lt;</span>&nbsp;<span class="ident" id="2068614">uint64digits</span>&nbsp;<span class="op" id="2068627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068633">mantissa</span>&nbsp;<span class="op" id="2068642">*=</span>&nbsp;<span class="num" id="2068645">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068652">mantissa</span>&nbsp;<span class="op" id="2068661">+=</span>&nbsp;<span class="ident" id="2068664">uint64</span><span class="op" id="2068670">(</span><span class="ident" id="2068671">c</span>&nbsp;<span class="op" id="2068673">-</span>&nbsp;<span class="string" id="2068675">&#39;0&#39;</span><span class="op" id="2068678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068684">ndMant</span><span class="op" id="2068690">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068696">}</span>&nbsp;<span class="keyword" id="2068698">else</span>&nbsp;<span class="keyword" id="2068703">if</span>&nbsp;<span class="ident" id="2068706">s</span><span class="op" id="2068707">[</span><span class="ident" id="2068708">i</span><span class="op" id="2068709">]</span>&nbsp;<span class="op" id="2068711">!=</span>&nbsp;<span class="string" id="2068714">&#39;0&#39;</span>&nbsp;<span class="op" id="2068718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068724">trunc</span>&nbsp;<span class="op" id="2068730">=</span>&nbsp;<span class="builtintype" id="2068732">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068740">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068745">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068760">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068770">if</span>&nbsp;<span class="op" id="2068773">!</span><span class="ident" id="2068774">sawdigits</span>&nbsp;<span class="op" id="2068784">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068788">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2068799">if</span>&nbsp;<span class="op" id="2068802">!</span><span class="ident" id="2068803">sawdot</span>&nbsp;<span class="op" id="2068810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2068814">dp</span>&nbsp;<span class="op" id="2068817">=</span>&nbsp;<span class="ident" id="2068819">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2068823">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068827">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068870">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068917">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2068963">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069015">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069041">if</span>&nbsp;<span class="ident" id="2069044">i</span>&nbsp;<span class="op" id="2069046">&lt;</span>&nbsp;<span class="builtinfunc" id="2069048">len</span><span class="op" id="2069051">(</span><span class="ident" id="2069052">s</span><span class="op" id="2069053">)</span>&nbsp;<span class="op" id="2069055">&amp;&amp;</span>&nbsp;<span class="op" id="2069058">(</span><span class="ident" id="2069059">s</span><span class="op" id="2069060">[</span><span class="ident" id="2069061">i</span><span class="op" id="2069062">]</span>&nbsp;<span class="op" id="2069064">==</span>&nbsp;<span class="string" id="2069067">&#39;e&#39;</span>&nbsp;<span class="op" id="2069071">||</span>&nbsp;<span class="ident" id="2069074">s</span><span class="op" id="2069075">[</span><span class="ident" id="2069076">i</span><span class="op" id="2069077">]</span>&nbsp;<span class="op" id="2069079">==</span>&nbsp;<span class="string" id="2069082">&#39;E&#39;</span><span class="op" id="2069085">)</span>&nbsp;<span class="op" id="2069087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069091">i</span><span class="op" id="2069092">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069097">if</span>&nbsp;<span class="ident" id="2069100">i</span>&nbsp;<span class="op" id="2069102">&gt;=</span>&nbsp;<span class="builtinfunc" id="2069105">len</span><span class="op" id="2069108">(</span><span class="ident" id="2069109">s</span><span class="op" id="2069110">)</span>&nbsp;<span class="op" id="2069112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069117">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069130">esign</span>&nbsp;<span class="op" id="2069136">:=</span>&nbsp;<span class="num" id="2069139">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069143">if</span>&nbsp;<span class="ident" id="2069146">s</span><span class="op" id="2069147">[</span><span class="ident" id="2069148">i</span><span class="op" id="2069149">]</span>&nbsp;<span class="op" id="2069151">==</span>&nbsp;<span class="string" id="2069154">&#39;+&#39;</span>&nbsp;<span class="op" id="2069158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069163">i</span><span class="op" id="2069164">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069169">}</span>&nbsp;<span class="keyword" id="2069171">else</span>&nbsp;<span class="keyword" id="2069176">if</span>&nbsp;<span class="ident" id="2069179">s</span><span class="op" id="2069180">[</span><span class="ident" id="2069181">i</span><span class="op" id="2069182">]</span>&nbsp;<span class="op" id="2069184">==</span>&nbsp;<span class="string" id="2069187">&#39;-&#39;</span>&nbsp;<span class="op" id="2069191">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069196">i</span><span class="op" id="2069197">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069203">esign</span>&nbsp;<span class="op" id="2069209">=</span>&nbsp;<span class="op" id="2069211">-</span><span class="num" id="2069212">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069220">if</span>&nbsp;<span class="ident" id="2069223">i</span>&nbsp;<span class="op" id="2069225">&gt;=</span>&nbsp;<span class="builtinfunc" id="2069228">len</span><span class="op" id="2069231">(</span><span class="ident" id="2069232">s</span><span class="op" id="2069233">)</span>&nbsp;<span class="op" id="2069235">||</span>&nbsp;<span class="ident" id="2069238">s</span><span class="op" id="2069239">[</span><span class="ident" id="2069240">i</span><span class="op" id="2069241">]</span>&nbsp;<span class="op" id="2069243">&lt;</span>&nbsp;<span class="string" id="2069245">&#39;0&#39;</span>&nbsp;<span class="op" id="2069249">||</span>&nbsp;<span class="ident" id="2069252">s</span><span class="op" id="2069253">[</span><span class="ident" id="2069254">i</span><span class="op" id="2069255">]</span>&nbsp;<span class="op" id="2069257">&gt;</span>&nbsp;<span class="string" id="2069259">&#39;9&#39;</span>&nbsp;<span class="op" id="2069263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069268">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069281">e</span>&nbsp;<span class="op" id="2069283">:=</span>&nbsp;<span class="num" id="2069286">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069290">for</span>&nbsp;<span class="op" id="2069294">;</span>&nbsp;<span class="ident" id="2069296">i</span>&nbsp;<span class="op" id="2069298">&lt;</span>&nbsp;<span class="builtinfunc" id="2069300">len</span><span class="op" id="2069303">(</span><span class="ident" id="2069304">s</span><span class="op" id="2069305">)</span>&nbsp;<span class="op" id="2069307">&amp;&amp;</span>&nbsp;<span class="string" id="2069310">&#39;0&#39;</span>&nbsp;<span class="op" id="2069314">&lt;=</span>&nbsp;<span class="ident" id="2069317">s</span><span class="op" id="2069318">[</span><span class="ident" id="2069319">i</span><span class="op" id="2069320">]</span>&nbsp;<span class="op" id="2069322">&amp;&amp;</span>&nbsp;<span class="ident" id="2069325">s</span><span class="op" id="2069326">[</span><span class="ident" id="2069327">i</span><span class="op" id="2069328">]</span>&nbsp;<span class="op" id="2069330">&lt;=</span>&nbsp;<span class="string" id="2069333">&#39;9&#39;</span><span class="op" id="2069336">;</span>&nbsp;<span class="ident" id="2069338">i</span><span class="op" id="2069339">++</span>&nbsp;<span class="op" id="2069342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069347">if</span>&nbsp;<span class="ident" id="2069350">e</span>&nbsp;<span class="op" id="2069352">&lt;</span>&nbsp;<span class="num" id="2069354">10000</span>&nbsp;<span class="op" id="2069360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069366">e</span>&nbsp;<span class="op" id="2069368">=</span>&nbsp;<span class="ident" id="2069370">e</span><span class="op" id="2069371">*</span><span class="num" id="2069372">10</span>&nbsp;<span class="op" id="2069375">+</span>&nbsp;<span class="builtintype" id="2069377">int</span><span class="op" id="2069380">(</span><span class="ident" id="2069381">s</span><span class="op" id="2069382">[</span><span class="ident" id="2069383">i</span><span class="op" id="2069384">]</span><span class="op" id="2069385">)</span>&nbsp;<span class="op" id="2069387">-</span>&nbsp;<span class="string" id="2069389">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069404">dp</span>&nbsp;<span class="op" id="2069407">+=</span>&nbsp;<span class="ident" id="2069410">e</span>&nbsp;<span class="op" id="2069412">*</span>&nbsp;<span class="ident" id="2069414">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069425">if</span>&nbsp;<span class="ident" id="2069428">i</span>&nbsp;<span class="op" id="2069430">!=</span>&nbsp;<span class="builtinfunc" id="2069433">len</span><span class="op" id="2069436">(</span><span class="ident" id="2069437">s</span><span class="op" id="2069438">)</span>&nbsp;<span class="op" id="2069440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069444">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069456">exp</span>&nbsp;<span class="op" id="2069460">=</span>&nbsp;<span class="ident" id="2069462">dp</span>&nbsp;<span class="op" id="2069465">-</span>&nbsp;<span class="ident" id="2069467">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069475">ok</span>&nbsp;<span class="op" id="2069478">=</span>&nbsp;<span class="builtintype" id="2069480">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069486">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2069494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2069497">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2069545">var</span>&nbsp;<span class="ident" id="2069549">powtab</span>&nbsp;<span class="op" id="2069556">=</span>&nbsp;<span class="op" id="2069558">[</span><span class="op" id="2069559">]</span><span class="builtintype" id="2069560">int</span><span class="op" id="2069563">{</span><span class="num" id="2069564">1</span><span class="op" id="2069565">,</span>&nbsp;<span class="num" id="2069567">3</span><span class="op" id="2069568">,</span>&nbsp;<span class="num" id="2069570">6</span><span class="op" id="2069571">,</span>&nbsp;<span class="num" id="2069573">9</span><span class="op" id="2069574">,</span>&nbsp;<span class="num" id="2069576">13</span><span class="op" id="2069578">,</span>&nbsp;<span class="num" id="2069580">16</span><span class="op" id="2069582">,</span>&nbsp;<span class="num" id="2069584">19</span><span class="op" id="2069586">,</span>&nbsp;<span class="num" id="2069588">23</span><span class="op" id="2069590">,</span>&nbsp;<span class="num" id="2069592">26</span><span class="op" id="2069594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2069597">func</span>&nbsp;<span class="op" id="2069602">(</span><span class="ident" id="2069603">d</span>&nbsp;<span class="op" id="2069605">*</span><span class="ident" id="2069606">decimal</span><span class="op" id="2069613">)</span>&nbsp;<span class="ident" id="2069615">floatBits</span><span class="op" id="2069624">(</span><span class="ident" id="2069625">flt</span>&nbsp;<span class="op" id="2069629">*</span><span class="ident" id="2069630">floatInfo</span><span class="op" id="2069639">)</span>&nbsp;<span class="op" id="2069641">(</span><span class="ident" id="2069642">b</span>&nbsp;<span class="ident" id="2069644">uint64</span><span class="op" id="2069650">,</span>&nbsp;<span class="ident" id="2069652">overflow</span>&nbsp;<span class="builtintype" id="2069661">bool</span><span class="op" id="2069665">)</span>&nbsp;<span class="op" id="2069667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069670">var</span>&nbsp;<span class="ident" id="2069674">exp</span>&nbsp;<span class="builtintype" id="2069678">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069683">var</span>&nbsp;<span class="ident" id="2069687">mant</span>&nbsp;<span class="ident" id="2069692">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069701">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069736">if</span>&nbsp;<span class="ident" id="2069739">d</span><span class="op" id="2069740">.</span><span class="ident" id="2069741">nd</span>&nbsp;<span class="op" id="2069744">==</span>&nbsp;<span class="num" id="2069747">0</span>&nbsp;<span class="op" id="2069749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069753">mant</span>&nbsp;<span class="op" id="2069758">=</span>&nbsp;<span class="num" id="2069760">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2069764">exp</span>&nbsp;<span class="op" id="2069768">=</span>&nbsp;<span class="ident" id="2069770">flt</span><span class="op" id="2069773">.</span><span class="ident" id="2069774">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069781">goto</span>&nbsp;<span class="ident" id="2069786">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069795">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069827">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069867">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069942">if</span>&nbsp;<span class="ident" id="2069945">d</span><span class="op" id="2069946">.</span><span class="ident" id="2069947">dp</span>&nbsp;<span class="op" id="2069950">&gt;</span>&nbsp;<span class="num" id="2069952">310</span>&nbsp;<span class="op" id="2069956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069960">goto</span>&nbsp;<span class="ident" id="2069965">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2069975">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2069978">if</span>&nbsp;<span class="ident" id="2069981">d</span><span class="op" id="2069982">.</span><span class="ident" id="2069983">dp</span>&nbsp;<span class="op" id="2069986">&lt;</span>&nbsp;<span class="op" id="2069988">-</span><span class="num" id="2069989">330</span>&nbsp;<span class="op" id="2069993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2069997">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070007">mant</span>&nbsp;<span class="op" id="2070012">=</span>&nbsp;<span class="num" id="2070014">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070018">exp</span>&nbsp;<span class="op" id="2070022">=</span>&nbsp;<span class="ident" id="2070024">flt</span><span class="op" id="2070027">.</span><span class="ident" id="2070028">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070035">goto</span>&nbsp;<span class="ident" id="2070040">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070049">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070102">exp</span>&nbsp;<span class="op" id="2070106">=</span>&nbsp;<span class="num" id="2070108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070111">for</span>&nbsp;<span class="ident" id="2070115">d</span><span class="op" id="2070116">.</span><span class="ident" id="2070117">dp</span>&nbsp;<span class="op" id="2070120">&gt;</span>&nbsp;<span class="num" id="2070122">0</span>&nbsp;<span class="op" id="2070124">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070128">var</span>&nbsp;<span class="ident" id="2070132">n</span>&nbsp;<span class="builtintype" id="2070134">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070140">if</span>&nbsp;<span class="ident" id="2070143">d</span><span class="op" id="2070144">.</span><span class="ident" id="2070145">dp</span>&nbsp;<span class="op" id="2070148">&gt;=</span>&nbsp;<span class="builtinfunc" id="2070151">len</span><span class="op" id="2070154">(</span><span class="ident" id="2070155">powtab</span><span class="op" id="2070161">)</span>&nbsp;<span class="op" id="2070163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070168">n</span>&nbsp;<span class="op" id="2070170">=</span>&nbsp;<span class="num" id="2070172">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070177">}</span>&nbsp;<span class="keyword" id="2070179">else</span>&nbsp;<span class="op" id="2070184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070189">n</span>&nbsp;<span class="op" id="2070191">=</span>&nbsp;<span class="ident" id="2070193">powtab</span><span class="op" id="2070199">[</span><span class="ident" id="2070200">d</span><span class="op" id="2070201">.</span><span class="ident" id="2070202">dp</span><span class="op" id="2070204">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070212">d</span><span class="op" id="2070213">.</span><span class="ident" id="2070214">Shift</span><span class="op" id="2070219">(</span><span class="op" id="2070220">-</span><span class="ident" id="2070221">n</span><span class="op" id="2070222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070226">exp</span>&nbsp;<span class="op" id="2070230">+=</span>&nbsp;<span class="ident" id="2070233">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070239">for</span>&nbsp;<span class="ident" id="2070243">d</span><span class="op" id="2070244">.</span><span class="ident" id="2070245">dp</span>&nbsp;<span class="op" id="2070248">&lt;</span>&nbsp;<span class="num" id="2070250">0</span>&nbsp;<span class="op" id="2070252">||</span>&nbsp;<span class="ident" id="2070255">d</span><span class="op" id="2070256">.</span><span class="ident" id="2070257">dp</span>&nbsp;<span class="op" id="2070260">==</span>&nbsp;<span class="num" id="2070263">0</span>&nbsp;<span class="op" id="2070265">&amp;&amp;</span>&nbsp;<span class="ident" id="2070268">d</span><span class="op" id="2070269">.</span><span class="ident" id="2070270">d</span><span class="op" id="2070271">[</span><span class="num" id="2070272">0</span><span class="op" id="2070273">]</span>&nbsp;<span class="op" id="2070275">&lt;</span>&nbsp;<span class="string" id="2070277">&#39;5&#39;</span>&nbsp;<span class="op" id="2070281">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070285">var</span>&nbsp;<span class="ident" id="2070289">n</span>&nbsp;<span class="builtintype" id="2070291">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070297">if</span>&nbsp;<span class="op" id="2070300">-</span><span class="ident" id="2070301">d</span><span class="op" id="2070302">.</span><span class="ident" id="2070303">dp</span>&nbsp;<span class="op" id="2070306">&gt;=</span>&nbsp;<span class="builtinfunc" id="2070309">len</span><span class="op" id="2070312">(</span><span class="ident" id="2070313">powtab</span><span class="op" id="2070319">)</span>&nbsp;<span class="op" id="2070321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070326">n</span>&nbsp;<span class="op" id="2070328">=</span>&nbsp;<span class="num" id="2070330">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070335">}</span>&nbsp;<span class="keyword" id="2070337">else</span>&nbsp;<span class="op" id="2070342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070347">n</span>&nbsp;<span class="op" id="2070349">=</span>&nbsp;<span class="ident" id="2070351">powtab</span><span class="op" id="2070357">[</span><span class="op" id="2070358">-</span><span class="ident" id="2070359">d</span><span class="op" id="2070360">.</span><span class="ident" id="2070361">dp</span><span class="op" id="2070363">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070371">d</span><span class="op" id="2070372">.</span><span class="ident" id="2070373">Shift</span><span class="op" id="2070378">(</span><span class="ident" id="2070379">n</span><span class="op" id="2070380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070384">exp</span>&nbsp;<span class="op" id="2070388">-=</span>&nbsp;<span class="ident" id="2070391">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070398">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070458">exp</span><span class="op" id="2070461">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070466">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070516">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070563">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070589">if</span>&nbsp;<span class="ident" id="2070592">exp</span>&nbsp;<span class="op" id="2070596">&lt;</span>&nbsp;<span class="ident" id="2070598">flt</span><span class="op" id="2070601">.</span><span class="ident" id="2070602">bias</span><span class="op" id="2070606">+</span><span class="num" id="2070607">1</span>&nbsp;<span class="op" id="2070609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070613">n</span>&nbsp;<span class="op" id="2070615">:=</span>&nbsp;<span class="ident" id="2070618">flt</span><span class="op" id="2070621">.</span><span class="ident" id="2070622">bias</span>&nbsp;<span class="op" id="2070627">+</span>&nbsp;<span class="num" id="2070629">1</span>&nbsp;<span class="op" id="2070631">-</span>&nbsp;<span class="ident" id="2070633">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070639">d</span><span class="op" id="2070640">.</span><span class="ident" id="2070641">Shift</span><span class="op" id="2070646">(</span><span class="op" id="2070647">-</span><span class="ident" id="2070648">n</span><span class="op" id="2070649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070653">exp</span>&nbsp;<span class="op" id="2070657">+=</span>&nbsp;<span class="ident" id="2070660">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070667">if</span>&nbsp;<span class="ident" id="2070670">exp</span><span class="op" id="2070673">-</span><span class="ident" id="2070674">flt</span><span class="op" id="2070677">.</span><span class="ident" id="2070678">bias</span>&nbsp;<span class="op" id="2070683">&gt;=</span>&nbsp;<span class="num" id="2070686">1</span><span class="op" id="2070687">&lt;&lt;</span><span class="ident" id="2070689">flt</span><span class="op" id="2070692">.</span><span class="ident" id="2070693">expbits</span><span class="op" id="2070700">-</span><span class="num" id="2070701">1</span>&nbsp;<span class="op" id="2070703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070707">goto</span>&nbsp;<span class="ident" id="2070712">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070722">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070726">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070759">d</span><span class="op" id="2070760">.</span><span class="ident" id="2070761">Shift</span><span class="op" id="2070766">(</span><span class="builtintype" id="2070767">int</span><span class="op" id="2070770">(</span><span class="num" id="2070771">1</span>&nbsp;<span class="op" id="2070773">+</span>&nbsp;<span class="ident" id="2070775">flt</span><span class="op" id="2070778">.</span><span class="ident" id="2070779">mantbits</span><span class="op" id="2070787">)</span><span class="op" id="2070788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070791">mant</span>&nbsp;<span class="op" id="2070796">=</span>&nbsp;<span class="ident" id="2070798">d</span><span class="op" id="2070799">.</span><span class="ident" id="2070800">RoundedInteger</span><span class="op" id="2070814">(</span><span class="op" id="2070815">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070819">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070868">if</span>&nbsp;<span class="ident" id="2070871">mant</span>&nbsp;<span class="op" id="2070876">==</span>&nbsp;<span class="num" id="2070879">2</span><span class="op" id="2070880">&lt;&lt;</span><span class="ident" id="2070882">flt</span><span class="op" id="2070885">.</span><span class="ident" id="2070886">mantbits</span>&nbsp;<span class="op" id="2070895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070899">mant</span>&nbsp;<span class="op" id="2070904">&gt;&gt;=</span>&nbsp;<span class="num" id="2070908">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2070912">exp</span><span class="op" id="2070915">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070920">if</span>&nbsp;<span class="ident" id="2070923">exp</span><span class="op" id="2070926">-</span><span class="ident" id="2070927">flt</span><span class="op" id="2070930">.</span><span class="ident" id="2070931">bias</span>&nbsp;<span class="op" id="2070936">&gt;=</span>&nbsp;<span class="num" id="2070939">1</span><span class="op" id="2070940">&lt;&lt;</span><span class="ident" id="2070942">flt</span><span class="op" id="2070945">.</span><span class="ident" id="2070946">expbits</span><span class="op" id="2070953">-</span><span class="num" id="2070954">1</span>&nbsp;<span class="op" id="2070956">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2070961">goto</span>&nbsp;<span class="ident" id="2070966">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2070984">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071002">if</span>&nbsp;<span class="ident" id="2071005">mant</span><span class="op" id="2071009">&amp;</span><span class="op" id="2071010">(</span><span class="num" id="2071011">1</span><span class="op" id="2071012">&lt;&lt;</span><span class="ident" id="2071014">flt</span><span class="op" id="2071017">.</span><span class="ident" id="2071018">mantbits</span><span class="op" id="2071026">)</span>&nbsp;<span class="op" id="2071028">==</span>&nbsp;<span class="num" id="2071031">0</span>&nbsp;<span class="op" id="2071033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071037">exp</span>&nbsp;<span class="op" id="2071041">=</span>&nbsp;<span class="ident" id="2071043">flt</span><span class="op" id="2071046">.</span><span class="ident" id="2071047">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071056">goto</span>&nbsp;<span class="ident" id="2071061">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2071066">overflow</span><span class="op" id="2071074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2071077">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071087">mant</span>&nbsp;<span class="op" id="2071092">=</span>&nbsp;<span class="num" id="2071094">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071097">exp</span>&nbsp;<span class="op" id="2071101">=</span>&nbsp;<span class="num" id="2071103">1</span><span class="op" id="2071104">&lt;&lt;</span><span class="ident" id="2071106">flt</span><span class="op" id="2071109">.</span><span class="ident" id="2071110">expbits</span>&nbsp;<span class="op" id="2071118">-</span>&nbsp;<span class="num" id="2071120">1</span>&nbsp;<span class="op" id="2071122">+</span>&nbsp;<span class="ident" id="2071124">flt</span><span class="op" id="2071127">.</span><span class="ident" id="2071128">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071134">overflow</span>&nbsp;<span class="op" id="2071143">=</span>&nbsp;<span class="builtintype" id="2071145">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2071151">out</span><span class="op" id="2071154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2071157">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071176">bits</span>&nbsp;<span class="op" id="2071181">:=</span>&nbsp;<span class="ident" id="2071184">mant</span>&nbsp;<span class="op" id="2071189">&amp;</span>&nbsp;<span class="op" id="2071191">(</span><span class="ident" id="2071192">uint64</span><span class="op" id="2071198">(</span><span class="num" id="2071199">1</span><span class="op" id="2071200">)</span><span class="op" id="2071201">&lt;&lt;</span><span class="ident" id="2071203">flt</span><span class="op" id="2071206">.</span><span class="ident" id="2071207">mantbits</span>&nbsp;<span class="op" id="2071216">-</span>&nbsp;<span class="num" id="2071218">1</span><span class="op" id="2071219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071222">bits</span>&nbsp;<span class="op" id="2071227">|=</span>&nbsp;<span class="ident" id="2071230">uint64</span><span class="op" id="2071236">(</span><span class="op" id="2071237">(</span><span class="ident" id="2071238">exp</span><span class="op" id="2071241">-</span><span class="ident" id="2071242">flt</span><span class="op" id="2071245">.</span><span class="ident" id="2071246">bias</span><span class="op" id="2071250">)</span><span class="op" id="2071251">&amp;</span><span class="op" id="2071252">(</span><span class="num" id="2071253">1</span><span class="op" id="2071254">&lt;&lt;</span><span class="ident" id="2071256">flt</span><span class="op" id="2071259">.</span><span class="ident" id="2071260">expbits</span><span class="op" id="2071267">-</span><span class="num" id="2071268">1</span><span class="op" id="2071269">)</span><span class="op" id="2071270">)</span>&nbsp;<span class="op" id="2071272">&lt;&lt;</span>&nbsp;<span class="ident" id="2071275">flt</span><span class="op" id="2071278">.</span><span class="ident" id="2071279">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071289">if</span>&nbsp;<span class="ident" id="2071292">d</span><span class="op" id="2071293">.</span><span class="ident" id="2071294">neg</span>&nbsp;<span class="op" id="2071298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2071302">bits</span>&nbsp;<span class="op" id="2071307">|=</span>&nbsp;<span class="num" id="2071310">1</span>&nbsp;<span class="op" id="2071312">&lt;&lt;</span>&nbsp;<span class="ident" id="2071315">flt</span><span class="op" id="2071318">.</span><span class="ident" id="2071319">mantbits</span>&nbsp;<span class="op" id="2071328">&lt;&lt;</span>&nbsp;<span class="ident" id="2071331">flt</span><span class="op" id="2071334">.</span><span class="ident" id="2071335">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2071344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2071347">return</span>&nbsp;<span class="ident" id="2071354">bits</span><span class="op" id="2071358">,</span>&nbsp;<span class="ident" id="2071360">overflow</span><br>
<span class="lineno"></span><span class="op" id="2071369">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2071372">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2071395">var</span>&nbsp;<span class="ident" id="2071399">float64pow10</span>&nbsp;<span class="op" id="2071412">=</span>&nbsp;<span class="op" id="2071414">[</span><span class="op" id="2071415">]</span><span class="builtintype" id="2071416">float64</span><span class="op" id="2071423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2071426">1e0</span><span class="op" id="2071429">,</span>&nbsp;<span class="num" id="2071431">1e1</span><span class="op" id="2071434">,</span>&nbsp;<span class="num" id="2071436">1e2</span><span class="op" id="2071439">,</span>&nbsp;<span class="num" id="2071441">1e3</span><span class="op" id="2071444">,</span>&nbsp;<span class="num" id="2071446">1e4</span><span class="op" id="2071449">,</span>&nbsp;<span class="num" id="2071451">1e5</span><span class="op" id="2071454">,</span>&nbsp;<span class="num" id="2071456">1e6</span><span class="op" id="2071459">,</span>&nbsp;<span class="num" id="2071461">1e7</span><span class="op" id="2071464">,</span>&nbsp;<span class="num" id="2071466">1e8</span><span class="op" id="2071469">,</span>&nbsp;<span class="num" id="2071471">1e9</span><span class="op" id="2071474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2071477">1e10</span><span class="op" id="2071481">,</span>&nbsp;<span class="num" id="2071483">1e11</span><span class="op" id="2071487">,</span>&nbsp;<span class="num" id="2071489">1e12</span><span class="op" id="2071493">,</span>&nbsp;<span class="num" id="2071495">1e13</span><span class="op" id="2071499">,</span>&nbsp;<span class="num" id="2071501">1e14</span><span class="op" id="2071505">,</span>&nbsp;<span class="num" id="2071507">1e15</span><span class="op" id="2071511">,</span>&nbsp;<span class="num" id="2071513">1e16</span><span class="op" id="2071517">,</span>&nbsp;<span class="num" id="2071519">1e17</span><span class="op" id="2071523">,</span>&nbsp;<span class="num" id="2071525">1e18</span><span class="op" id="2071529">,</span>&nbsp;<span class="num" id="2071531">1e19</span><span class="op" id="2071535">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2071538">1e20</span><span class="op" id="2071542">,</span>&nbsp;<span class="num" id="2071544">1e21</span><span class="op" id="2071548">,</span>&nbsp;<span class="num" id="2071550">1e22</span><span class="op" id="2071554">,</span><br>
<span class="lineno"></span><span class="op" id="2071556">}</span><br>
<span class="lineno"></span><span class="keyword" id="2071558">var</span>&nbsp;<span class="ident" id="2071562">float32pow10</span>&nbsp;<span class="op" id="2071575">=</span>&nbsp;<span class="op" id="2071577">[</span><span class="op" id="2071578">]</span><span class="builtintype" id="2071579">float32</span><span class="op" id="2071586">{</span><span class="num" id="2071587">1e0</span><span class="op" id="2071590">,</span>&nbsp;<span class="num" id="2071592">1e1</span><span class="op" id="2071595">,</span>&nbsp;<span class="num" id="2071597">1e2</span><span class="op" id="2071600">,</span>&nbsp;<span class="num" id="2071602">1e3</span><span class="op" id="2071605">,</span>&nbsp;<span class="num" id="2071607">1e4</span><span class="op" id="2071610">,</span>&nbsp;<span class="num" id="2071612">1e5</span><span class="op" id="2071615">,</span>&nbsp;<span class="num" id="2071617">1e6</span><span class="op" id="2071620">,</span>&nbsp;<span class="num" id="2071622">1e7</span><span class="op" id="2071625">,</span>&nbsp;<span class="num" id="2071627">1e8</span><span class="op" id="2071630">,</span>&nbsp;<span class="num" id="2071632">1e9</span><span class="op" id="2071635">,</span>&nbsp;<span class="num" id="2071637">1e10</span><span class="op" id="2071641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2071644">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2071720">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2071807">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2071830">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2071856">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2071903">//&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2071950">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2072022">func</span>&nbsp;<span class="ident" id="2072027">atof64exact</span><span class="op" id="2072038">(</span><span class="ident" id="2072039">mantissa</span>&nbsp;<span class="ident" id="2072048">uint64</span><span class="op" id="2072054">,</span>&nbsp;<span class="ident" id="2072056">exp</span>&nbsp;<span class="builtintype" id="2072060">int</span><span class="op" id="2072063">,</span>&nbsp;<span class="ident" id="2072065">neg</span>&nbsp;<span class="builtintype" id="2072069">bool</span><span class="op" id="2072073">)</span>&nbsp;<span class="op" id="2072075">(</span><span class="ident" id="2072076">f</span>&nbsp;<span class="builtintype" id="2072078">float64</span><span class="op" id="2072085">,</span>&nbsp;<span class="ident" id="2072087">ok</span>&nbsp;<span class="builtintype" id="2072090">bool</span><span class="op" id="2072094">)</span>&nbsp;<span class="op" id="2072096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072099">if</span>&nbsp;<span class="ident" id="2072102">mantissa</span><span class="op" id="2072110">&gt;&gt;</span><span class="ident" id="2072112">float64info</span><span class="op" id="2072123">.</span><span class="ident" id="2072124">mantbits</span>&nbsp;<span class="op" id="2072133">!=</span>&nbsp;<span class="num" id="2072136">0</span>&nbsp;<span class="op" id="2072138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072150">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072153">f</span>&nbsp;<span class="op" id="2072155">=</span>&nbsp;<span class="builtintype" id="2072157">float64</span><span class="op" id="2072164">(</span><span class="ident" id="2072165">mantissa</span><span class="op" id="2072173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072176">if</span>&nbsp;<span class="ident" id="2072179">neg</span>&nbsp;<span class="op" id="2072183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072187">f</span>&nbsp;<span class="op" id="2072189">=</span>&nbsp;<span class="op" id="2072191">-</span><span class="ident" id="2072192">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072198">switch</span>&nbsp;<span class="op" id="2072205">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072208">case</span>&nbsp;<span class="ident" id="2072213">exp</span>&nbsp;<span class="op" id="2072217">==</span>&nbsp;<span class="num" id="2072220">0</span><span class="op" id="2072221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072225">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072242">return</span>&nbsp;<span class="ident" id="2072249">f</span><span class="op" id="2072250">,</span>&nbsp;<span class="builtintype" id="2072252">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072258">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072291">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072329">case</span>&nbsp;<span class="ident" id="2072334">exp</span>&nbsp;<span class="op" id="2072338">&gt;</span>&nbsp;<span class="num" id="2072340">0</span>&nbsp;<span class="op" id="2072342">&amp;&amp;</span>&nbsp;<span class="ident" id="2072345">exp</span>&nbsp;<span class="op" id="2072349">&lt;=</span>&nbsp;<span class="num" id="2072352">15</span><span class="op" id="2072354">+</span><span class="num" id="2072355">22</span><span class="op" id="2072357">:</span>&nbsp;<span class="comment" id="2072359">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072375">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072428">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072477">if</span>&nbsp;<span class="ident" id="2072480">exp</span>&nbsp;<span class="op" id="2072484">&gt;</span>&nbsp;<span class="num" id="2072486">22</span>&nbsp;<span class="op" id="2072489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072494">f</span>&nbsp;<span class="op" id="2072496">*=</span>&nbsp;<span class="ident" id="2072499">float64pow10</span><span class="op" id="2072511">[</span><span class="ident" id="2072512">exp</span><span class="op" id="2072515">-</span><span class="num" id="2072516">22</span><span class="op" id="2072518">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2072523">exp</span>&nbsp;<span class="op" id="2072527">=</span>&nbsp;<span class="num" id="2072529">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072538">if</span>&nbsp;<span class="ident" id="2072541">f</span>&nbsp;<span class="op" id="2072543">&gt;</span>&nbsp;<span class="num" id="2072545">1e15</span>&nbsp;<span class="op" id="2072550">||</span>&nbsp;<span class="ident" id="2072553">f</span>&nbsp;<span class="op" id="2072555">&lt;</span>&nbsp;<span class="op" id="2072557">-</span><span class="num" id="2072558">1e15</span>&nbsp;<span class="op" id="2072563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2072568">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072609">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072622">return</span>&nbsp;<span class="ident" id="2072629">f</span>&nbsp;<span class="op" id="2072631">*</span>&nbsp;<span class="ident" id="2072633">float64pow10</span><span class="op" id="2072645">[</span><span class="ident" id="2072646">exp</span><span class="op" id="2072649">]</span><span class="op" id="2072650">,</span>&nbsp;<span class="builtintype" id="2072652">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072658">case</span>&nbsp;<span class="ident" id="2072663">exp</span>&nbsp;<span class="op" id="2072667">&lt;</span>&nbsp;<span class="num" id="2072669">0</span>&nbsp;<span class="op" id="2072671">&amp;&amp;</span>&nbsp;<span class="ident" id="2072674">exp</span>&nbsp;<span class="op" id="2072678">&gt;=</span>&nbsp;<span class="op" id="2072681">-</span><span class="num" id="2072682">22</span><span class="op" id="2072684">:</span>&nbsp;<span class="comment" id="2072686">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072702">return</span>&nbsp;<span class="ident" id="2072709">f</span>&nbsp;<span class="op" id="2072711">/</span>&nbsp;<span class="ident" id="2072713">float64pow10</span><span class="op" id="2072725">[</span><span class="op" id="2072726">-</span><span class="ident" id="2072727">exp</span><span class="op" id="2072730">]</span><span class="op" id="2072731">,</span>&nbsp;<span class="builtintype" id="2072733">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2072739">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072742">return</span><br>
<span class="lineno"></span><span class="op" id="2072749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072752">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2072821">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2072894">func</span>&nbsp;<span class="ident" id="2072899">atof32exact</span><span class="op" id="2072910">(</span><span class="ident" id="2072911">mantissa</span>&nbsp;<span class="ident" id="2072920">uint64</span><span class="op" id="2072926">,</span>&nbsp;<span class="ident" id="2072928">exp</span>&nbsp;<span class="builtintype" id="2072932">int</span><span class="op" id="2072935">,</span>&nbsp;<span class="ident" id="2072937">neg</span>&nbsp;<span class="builtintype" id="2072941">bool</span><span class="op" id="2072945">)</span>&nbsp;<span class="op" id="2072947">(</span><span class="ident" id="2072948">f</span>&nbsp;<span class="builtintype" id="2072950">float32</span><span class="op" id="2072957">,</span>&nbsp;<span class="ident" id="2072959">ok</span>&nbsp;<span class="builtintype" id="2072962">bool</span><span class="op" id="2072966">)</span>&nbsp;<span class="op" id="2072968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2072971">if</span>&nbsp;<span class="ident" id="2072974">mantissa</span><span class="op" id="2072982">&gt;&gt;</span><span class="ident" id="2072984">float32info</span><span class="op" id="2072995">.</span><span class="ident" id="2072996">mantbits</span>&nbsp;<span class="op" id="2073005">!=</span>&nbsp;<span class="num" id="2073008">0</span>&nbsp;<span class="op" id="2073010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073014">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073025">f</span>&nbsp;<span class="op" id="2073027">=</span>&nbsp;<span class="builtintype" id="2073029">float32</span><span class="op" id="2073036">(</span><span class="ident" id="2073037">mantissa</span><span class="op" id="2073045">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073048">if</span>&nbsp;<span class="ident" id="2073051">neg</span>&nbsp;<span class="op" id="2073055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073059">f</span>&nbsp;<span class="op" id="2073061">=</span>&nbsp;<span class="op" id="2073063">-</span><span class="ident" id="2073064">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073070">switch</span>&nbsp;<span class="op" id="2073077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073080">case</span>&nbsp;<span class="ident" id="2073085">exp</span>&nbsp;<span class="op" id="2073089">==</span>&nbsp;<span class="num" id="2073092">0</span><span class="op" id="2073093">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073097">return</span>&nbsp;<span class="ident" id="2073104">f</span><span class="op" id="2073105">,</span>&nbsp;<span class="builtintype" id="2073107">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073113">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073145">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073183">case</span>&nbsp;<span class="ident" id="2073188">exp</span>&nbsp;<span class="op" id="2073192">&gt;</span>&nbsp;<span class="num" id="2073194">0</span>&nbsp;<span class="op" id="2073196">&amp;&amp;</span>&nbsp;<span class="ident" id="2073199">exp</span>&nbsp;<span class="op" id="2073203">&lt;=</span>&nbsp;<span class="num" id="2073206">7</span><span class="op" id="2073207">+</span><span class="num" id="2073208">10</span><span class="op" id="2073210">:</span>&nbsp;<span class="comment" id="2073212">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073228">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073281">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073330">if</span>&nbsp;<span class="ident" id="2073333">exp</span>&nbsp;<span class="op" id="2073337">&gt;</span>&nbsp;<span class="num" id="2073339">10</span>&nbsp;<span class="op" id="2073342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073347">f</span>&nbsp;<span class="op" id="2073349">*=</span>&nbsp;<span class="ident" id="2073352">float32pow10</span><span class="op" id="2073364">[</span><span class="ident" id="2073365">exp</span><span class="op" id="2073368">-</span><span class="num" id="2073369">10</span><span class="op" id="2073371">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073376">exp</span>&nbsp;<span class="op" id="2073380">=</span>&nbsp;<span class="num" id="2073382">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073387">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073391">if</span>&nbsp;<span class="ident" id="2073394">f</span>&nbsp;<span class="op" id="2073396">&gt;</span>&nbsp;<span class="num" id="2073398">1e7</span>&nbsp;<span class="op" id="2073402">||</span>&nbsp;<span class="ident" id="2073405">f</span>&nbsp;<span class="op" id="2073407">&lt;</span>&nbsp;<span class="op" id="2073409">-</span><span class="num" id="2073410">1e7</span>&nbsp;<span class="op" id="2073414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073419">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073460">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073473">return</span>&nbsp;<span class="ident" id="2073480">f</span>&nbsp;<span class="op" id="2073482">*</span>&nbsp;<span class="ident" id="2073484">float32pow10</span><span class="op" id="2073496">[</span><span class="ident" id="2073497">exp</span><span class="op" id="2073500">]</span><span class="op" id="2073501">,</span>&nbsp;<span class="builtintype" id="2073503">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073509">case</span>&nbsp;<span class="ident" id="2073514">exp</span>&nbsp;<span class="op" id="2073518">&lt;</span>&nbsp;<span class="num" id="2073520">0</span>&nbsp;<span class="op" id="2073522">&amp;&amp;</span>&nbsp;<span class="ident" id="2073525">exp</span>&nbsp;<span class="op" id="2073529">&gt;=</span>&nbsp;<span class="op" id="2073532">-</span><span class="num" id="2073533">10</span><span class="op" id="2073535">:</span>&nbsp;<span class="comment" id="2073537">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073553">return</span>&nbsp;<span class="ident" id="2073560">f</span>&nbsp;<span class="op" id="2073562">/</span>&nbsp;<span class="ident" id="2073564">float32pow10</span><span class="op" id="2073576">[</span><span class="op" id="2073577">-</span><span class="ident" id="2073578">exp</span><span class="op" id="2073581">]</span><span class="op" id="2073582">,</span>&nbsp;<span class="builtintype" id="2073584">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073593">return</span><br>
<span class="lineno"></span><span class="op" id="2073600">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2073603">const</span>&nbsp;<span class="ident" id="2073609">fnParseFloat</span>&nbsp;<span class="op" id="2073622">=</span>&nbsp;<span class="string" id="2073624">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2073638">func</span>&nbsp;<span class="ident" id="2073643">atof32</span><span class="op" id="2073649">(</span><span class="ident" id="2073650">s</span>&nbsp;<span class="builtintype" id="2073652">string</span><span class="op" id="2073658">)</span>&nbsp;<span class="op" id="2073660">(</span><span class="ident" id="2073661">f</span>&nbsp;<span class="builtintype" id="2073663">float32</span><span class="op" id="2073670">,</span>&nbsp;<span class="ident" id="2073672">err</span>&nbsp;<span class="builtintype" id="2073676">error</span><span class="op" id="2073681">)</span>&nbsp;<span class="op" id="2073683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073686">if</span>&nbsp;<span class="ident" id="2073689">val</span><span class="op" id="2073692">,</span>&nbsp;<span class="ident" id="2073694">ok</span>&nbsp;<span class="op" id="2073697">:=</span>&nbsp;<span class="ident" id="2073700">special</span><span class="op" id="2073707">(</span><span class="ident" id="2073708">s</span><span class="op" id="2073709">)</span><span class="op" id="2073710">;</span>&nbsp;<span class="ident" id="2073712">ok</span>&nbsp;<span class="op" id="2073715">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073719">return</span>&nbsp;<span class="builtintype" id="2073726">float32</span><span class="op" id="2073733">(</span><span class="ident" id="2073734">val</span><span class="op" id="2073737">)</span><span class="op" id="2073738">,</span>&nbsp;<span class="builtintype" id="2073740">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073749">if</span>&nbsp;<span class="ident" id="2073752">optimize</span>&nbsp;<span class="op" id="2073761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073765">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073799">mantissa</span><span class="op" id="2073807">,</span>&nbsp;<span class="ident" id="2073809">exp</span><span class="op" id="2073812">,</span>&nbsp;<span class="ident" id="2073814">neg</span><span class="op" id="2073817">,</span>&nbsp;<span class="ident" id="2073819">trunc</span><span class="op" id="2073824">,</span>&nbsp;<span class="ident" id="2073826">ok</span>&nbsp;<span class="op" id="2073829">:=</span>&nbsp;<span class="ident" id="2073832">readFloat</span><span class="op" id="2073841">(</span><span class="ident" id="2073842">s</span><span class="op" id="2073843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073847">if</span>&nbsp;<span class="ident" id="2073850">ok</span>&nbsp;<span class="op" id="2073853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073858">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073911">if</span>&nbsp;<span class="op" id="2073914">!</span><span class="ident" id="2073915">trunc</span>&nbsp;<span class="op" id="2073921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073927">if</span>&nbsp;<span class="ident" id="2073930">f</span><span class="op" id="2073931">,</span>&nbsp;<span class="ident" id="2073933">ok</span>&nbsp;<span class="op" id="2073936">:=</span>&nbsp;<span class="ident" id="2073939">atof32exact</span><span class="op" id="2073950">(</span><span class="ident" id="2073951">mantissa</span><span class="op" id="2073959">,</span>&nbsp;<span class="ident" id="2073961">exp</span><span class="op" id="2073964">,</span>&nbsp;<span class="ident" id="2073966">neg</span><span class="op" id="2073969">)</span><span class="op" id="2073970">;</span>&nbsp;<span class="ident" id="2073972">ok</span>&nbsp;<span class="op" id="2073975">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073982">return</span>&nbsp;<span class="ident" id="2073989">f</span><span class="op" id="2073990">,</span>&nbsp;<span class="builtintype" id="2073992">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074010">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074039">ext</span>&nbsp;<span class="op" id="2074043">:=</span>&nbsp;<span class="builtinfunc" id="2074046">new</span><span class="op" id="2074049">(</span><span class="ident" id="2074050">extFloat</span><span class="op" id="2074058">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074063">if</span>&nbsp;<span class="ident" id="2074066">ok</span>&nbsp;<span class="op" id="2074069">:=</span>&nbsp;<span class="ident" id="2074072">ext</span><span class="op" id="2074075">.</span><span class="ident" id="2074076">AssignDecimal</span><span class="op" id="2074089">(</span><span class="ident" id="2074090">mantissa</span><span class="op" id="2074098">,</span>&nbsp;<span class="ident" id="2074100">exp</span><span class="op" id="2074103">,</span>&nbsp;<span class="ident" id="2074105">neg</span><span class="op" id="2074108">,</span>&nbsp;<span class="ident" id="2074110">trunc</span><span class="op" id="2074115">,</span>&nbsp;<span class="op" id="2074117">&amp;</span><span class="ident" id="2074118">float32info</span><span class="op" id="2074129">)</span><span class="op" id="2074130">;</span>&nbsp;<span class="ident" id="2074132">ok</span>&nbsp;<span class="op" id="2074135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074141">b</span><span class="op" id="2074142">,</span>&nbsp;<span class="ident" id="2074144">ovf</span>&nbsp;<span class="op" id="2074148">:=</span>&nbsp;<span class="ident" id="2074151">ext</span><span class="op" id="2074154">.</span><span class="ident" id="2074155">floatBits</span><span class="op" id="2074164">(</span><span class="op" id="2074165">&amp;</span><span class="ident" id="2074166">float32info</span><span class="op" id="2074177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074183">f</span>&nbsp;<span class="op" id="2074185">=</span>&nbsp;<span class="ident" id="2074187">math</span><span class="op" id="2074191">.</span><span class="ident" id="2074192">Float32frombits</span><span class="op" id="2074207">(</span><span class="builtintype" id="2074208">uint32</span><span class="op" id="2074214">(</span><span class="ident" id="2074215">b</span><span class="op" id="2074216">)</span><span class="op" id="2074217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074223">if</span>&nbsp;<span class="ident" id="2074226">ovf</span>&nbsp;<span class="op" id="2074230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074237">err</span>&nbsp;<span class="op" id="2074241">=</span>&nbsp;<span class="ident" id="2074243">rangeError</span><span class="op" id="2074253">(</span><span class="ident" id="2074254">fnParseFloat</span><span class="op" id="2074266">,</span>&nbsp;<span class="ident" id="2074268">s</span><span class="op" id="2074269">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074281">return</span>&nbsp;<span class="ident" id="2074288">f</span><span class="op" id="2074289">,</span>&nbsp;<span class="ident" id="2074291">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074305">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074308">var</span>&nbsp;<span class="ident" id="2074312">d</span>&nbsp;<span class="ident" id="2074314">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074323">if</span>&nbsp;<span class="op" id="2074326">!</span><span class="ident" id="2074327">d</span><span class="op" id="2074328">.</span><span class="ident" id="2074329">set</span><span class="op" id="2074332">(</span><span class="ident" id="2074333">s</span><span class="op" id="2074334">)</span>&nbsp;<span class="op" id="2074336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074340">return</span>&nbsp;<span class="num" id="2074347">0</span><span class="op" id="2074348">,</span>&nbsp;<span class="ident" id="2074350">syntaxError</span><span class="op" id="2074361">(</span><span class="ident" id="2074362">fnParseFloat</span><span class="op" id="2074374">,</span>&nbsp;<span class="ident" id="2074376">s</span><span class="op" id="2074377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074383">b</span><span class="op" id="2074384">,</span>&nbsp;<span class="ident" id="2074386">ovf</span>&nbsp;<span class="op" id="2074390">:=</span>&nbsp;<span class="ident" id="2074393">d</span><span class="op" id="2074394">.</span><span class="ident" id="2074395">floatBits</span><span class="op" id="2074404">(</span><span class="op" id="2074405">&amp;</span><span class="ident" id="2074406">float32info</span><span class="op" id="2074417">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074420">f</span>&nbsp;<span class="op" id="2074422">=</span>&nbsp;<span class="ident" id="2074424">math</span><span class="op" id="2074428">.</span><span class="ident" id="2074429">Float32frombits</span><span class="op" id="2074444">(</span><span class="builtintype" id="2074445">uint32</span><span class="op" id="2074451">(</span><span class="ident" id="2074452">b</span><span class="op" id="2074453">)</span><span class="op" id="2074454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074457">if</span>&nbsp;<span class="ident" id="2074460">ovf</span>&nbsp;<span class="op" id="2074464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074468">err</span>&nbsp;<span class="op" id="2074472">=</span>&nbsp;<span class="ident" id="2074474">rangeError</span><span class="op" id="2074484">(</span><span class="ident" id="2074485">fnParseFloat</span><span class="op" id="2074497">,</span>&nbsp;<span class="ident" id="2074499">s</span><span class="op" id="2074500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074506">return</span>&nbsp;<span class="ident" id="2074513">f</span><span class="op" id="2074514">,</span>&nbsp;<span class="ident" id="2074516">err</span><br>
<span class="lineno">475</span><span class="op" id="2074520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2074523">func</span>&nbsp;<span class="ident" id="2074528">atof64</span><span class="op" id="2074534">(</span><span class="ident" id="2074535">s</span>&nbsp;<span class="builtintype" id="2074537">string</span><span class="op" id="2074543">)</span>&nbsp;<span class="op" id="2074545">(</span><span class="ident" id="2074546">f</span>&nbsp;<span class="builtintype" id="2074548">float64</span><span class="op" id="2074555">,</span>&nbsp;<span class="ident" id="2074557">err</span>&nbsp;<span class="builtintype" id="2074561">error</span><span class="op" id="2074566">)</span>&nbsp;<span class="op" id="2074568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074571">if</span>&nbsp;<span class="ident" id="2074574">val</span><span class="op" id="2074577">,</span>&nbsp;<span class="ident" id="2074579">ok</span>&nbsp;<span class="op" id="2074582">:=</span>&nbsp;<span class="ident" id="2074585">special</span><span class="op" id="2074592">(</span><span class="ident" id="2074593">s</span><span class="op" id="2074594">)</span><span class="op" id="2074595">;</span>&nbsp;<span class="ident" id="2074597">ok</span>&nbsp;<span class="op" id="2074600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074604">return</span>&nbsp;<span class="ident" id="2074611">val</span><span class="op" id="2074614">,</span>&nbsp;<span class="builtintype" id="2074616">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074625">if</span>&nbsp;<span class="ident" id="2074628">optimize</span>&nbsp;<span class="op" id="2074637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074641">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074675">mantissa</span><span class="op" id="2074683">,</span>&nbsp;<span class="ident" id="2074685">exp</span><span class="op" id="2074688">,</span>&nbsp;<span class="ident" id="2074690">neg</span><span class="op" id="2074693">,</span>&nbsp;<span class="ident" id="2074695">trunc</span><span class="op" id="2074700">,</span>&nbsp;<span class="ident" id="2074702">ok</span>&nbsp;<span class="op" id="2074705">:=</span>&nbsp;<span class="ident" id="2074708">readFloat</span><span class="op" id="2074717">(</span><span class="ident" id="2074718">s</span><span class="op" id="2074719">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074723">if</span>&nbsp;<span class="ident" id="2074726">ok</span>&nbsp;<span class="op" id="2074729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074734">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074787">if</span>&nbsp;<span class="op" id="2074790">!</span><span class="ident" id="2074791">trunc</span>&nbsp;<span class="op" id="2074797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074803">if</span>&nbsp;<span class="ident" id="2074806">f</span><span class="op" id="2074807">,</span>&nbsp;<span class="ident" id="2074809">ok</span>&nbsp;<span class="op" id="2074812">:=</span>&nbsp;<span class="ident" id="2074815">atof64exact</span><span class="op" id="2074826">(</span><span class="ident" id="2074827">mantissa</span><span class="op" id="2074835">,</span>&nbsp;<span class="ident" id="2074837">exp</span><span class="op" id="2074840">,</span>&nbsp;<span class="ident" id="2074842">neg</span><span class="op" id="2074845">)</span><span class="op" id="2074846">;</span>&nbsp;<span class="ident" id="2074848">ok</span>&nbsp;<span class="op" id="2074851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074858">return</span>&nbsp;<span class="ident" id="2074865">f</span><span class="op" id="2074866">,</span>&nbsp;<span class="builtintype" id="2074868">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074886">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074915">ext</span>&nbsp;<span class="op" id="2074919">:=</span>&nbsp;<span class="builtinfunc" id="2074922">new</span><span class="op" id="2074925">(</span><span class="ident" id="2074926">extFloat</span><span class="op" id="2074934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074939">if</span>&nbsp;<span class="ident" id="2074942">ok</span>&nbsp;<span class="op" id="2074945">:=</span>&nbsp;<span class="ident" id="2074948">ext</span><span class="op" id="2074951">.</span><span class="ident" id="2074952">AssignDecimal</span><span class="op" id="2074965">(</span><span class="ident" id="2074966">mantissa</span><span class="op" id="2074974">,</span>&nbsp;<span class="ident" id="2074976">exp</span><span class="op" id="2074979">,</span>&nbsp;<span class="ident" id="2074981">neg</span><span class="op" id="2074984">,</span>&nbsp;<span class="ident" id="2074986">trunc</span><span class="op" id="2074991">,</span>&nbsp;<span class="op" id="2074993">&amp;</span><span class="ident" id="2074994">float64info</span><span class="op" id="2075005">)</span><span class="op" id="2075006">;</span>&nbsp;<span class="ident" id="2075008">ok</span>&nbsp;<span class="op" id="2075011">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075017">b</span><span class="op" id="2075018">,</span>&nbsp;<span class="ident" id="2075020">ovf</span>&nbsp;<span class="op" id="2075024">:=</span>&nbsp;<span class="ident" id="2075027">ext</span><span class="op" id="2075030">.</span><span class="ident" id="2075031">floatBits</span><span class="op" id="2075040">(</span><span class="op" id="2075041">&amp;</span><span class="ident" id="2075042">float64info</span><span class="op" id="2075053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075059">f</span>&nbsp;<span class="op" id="2075061">=</span>&nbsp;<span class="ident" id="2075063">math</span><span class="op" id="2075067">.</span><span class="ident" id="2075068">Float64frombits</span><span class="op" id="2075083">(</span><span class="ident" id="2075084">b</span><span class="op" id="2075085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075091">if</span>&nbsp;<span class="ident" id="2075094">ovf</span>&nbsp;<span class="op" id="2075098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075105">err</span>&nbsp;<span class="op" id="2075109">=</span>&nbsp;<span class="ident" id="2075111">rangeError</span><span class="op" id="2075121">(</span><span class="ident" id="2075122">fnParseFloat</span><span class="op" id="2075134">,</span>&nbsp;<span class="ident" id="2075136">s</span><span class="op" id="2075137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075143">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075149">return</span>&nbsp;<span class="ident" id="2075156">f</span><span class="op" id="2075157">,</span>&nbsp;<span class="ident" id="2075159">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075176">var</span>&nbsp;<span class="ident" id="2075180">d</span>&nbsp;<span class="ident" id="2075182">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075191">if</span>&nbsp;<span class="op" id="2075194">!</span><span class="ident" id="2075195">d</span><span class="op" id="2075196">.</span><span class="ident" id="2075197">set</span><span class="op" id="2075200">(</span><span class="ident" id="2075201">s</span><span class="op" id="2075202">)</span>&nbsp;<span class="op" id="2075204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075208">return</span>&nbsp;<span class="num" id="2075215">0</span><span class="op" id="2075216">,</span>&nbsp;<span class="ident" id="2075218">syntaxError</span><span class="op" id="2075229">(</span><span class="ident" id="2075230">fnParseFloat</span><span class="op" id="2075242">,</span>&nbsp;<span class="ident" id="2075244">s</span><span class="op" id="2075245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075251">b</span><span class="op" id="2075252">,</span>&nbsp;<span class="ident" id="2075254">ovf</span>&nbsp;<span class="op" id="2075258">:=</span>&nbsp;<span class="ident" id="2075261">d</span><span class="op" id="2075262">.</span><span class="ident" id="2075263">floatBits</span><span class="op" id="2075272">(</span><span class="op" id="2075273">&amp;</span><span class="ident" id="2075274">float64info</span><span class="op" id="2075285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075288">f</span>&nbsp;<span class="op" id="2075290">=</span>&nbsp;<span class="ident" id="2075292">math</span><span class="op" id="2075296">.</span><span class="ident" id="2075297">Float64frombits</span><span class="op" id="2075312">(</span><span class="ident" id="2075313">b</span><span class="op" id="2075314">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075317">if</span>&nbsp;<span class="ident" id="2075320">ovf</span>&nbsp;<span class="op" id="2075324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075328">err</span>&nbsp;<span class="op" id="2075332">=</span>&nbsp;<span class="ident" id="2075334">rangeError</span><span class="op" id="2075344">(</span><span class="ident" id="2075345">fnParseFloat</span><span class="op" id="2075357">,</span>&nbsp;<span class="ident" id="2075359">s</span><span class="op" id="2075360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075366">return</span>&nbsp;<span class="ident" id="2075373">f</span><span class="op" id="2075374">,</span>&nbsp;<span class="ident" id="2075376">err</span><br>
<span class="lineno"></span><span class="op" id="2075380">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2075383">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2075446">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2075525">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2075595">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2075649">//</span><br>
<span class="lineno"></span><span class="comment" id="2075652">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2075715">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2075779">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2075815">//</span><br>
<span class="lineno">525</span><span class="comment" id="2075818">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2075885">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2075913">//</span><br>
<span class="lineno"></span><span class="comment" id="2075916">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2075998">//</span><br>
<span class="lineno">530</span><span class="comment" id="2076001">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2076063">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2076129">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;±Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2076182">func</span>&nbsp;<span class="ident" id="2076187">ParseFloat</span><span class="op" id="2076197">(</span><span class="ident" id="2076198">s</span>&nbsp;<span class="builtintype" id="2076200">string</span><span class="op" id="2076206">,</span>&nbsp;<span class="ident" id="2076208">bitSize</span>&nbsp;<span class="builtintype" id="2076216">int</span><span class="op" id="2076219">)</span>&nbsp;<span class="op" id="2076221">(</span><span class="ident" id="2076222">f</span>&nbsp;<span class="builtintype" id="2076224">float64</span><span class="op" id="2076231">,</span>&nbsp;<span class="ident" id="2076233">err</span>&nbsp;<span class="builtintype" id="2076237">error</span><span class="op" id="2076242">)</span>&nbsp;<span class="op" id="2076244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076247">if</span>&nbsp;<span class="ident" id="2076250">bitSize</span>&nbsp;<span class="op" id="2076258">==</span>&nbsp;<span class="num" id="2076261">32</span>&nbsp;<span class="op" id="2076264">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076268">f1</span><span class="op" id="2076270">,</span>&nbsp;<span class="ident" id="2076272">err1</span>&nbsp;<span class="op" id="2076277">:=</span>&nbsp;<span class="ident" id="2076280">atof32</span><span class="op" id="2076286">(</span><span class="ident" id="2076287">s</span><span class="op" id="2076288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076292">return</span>&nbsp;<span class="builtintype" id="2076299">float64</span><span class="op" id="2076306">(</span><span class="ident" id="2076307">f1</span><span class="op" id="2076309">)</span><span class="op" id="2076310">,</span>&nbsp;<span class="ident" id="2076312">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2076318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2076321">f1</span><span class="op" id="2076323">,</span>&nbsp;<span class="ident" id="2076325">err1</span>&nbsp;<span class="op" id="2076330">:=</span>&nbsp;<span class="ident" id="2076333">atof64</span><span class="op" id="2076339">(</span><span class="ident" id="2076340">s</span><span class="op" id="2076341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2076344">return</span>&nbsp;<span class="ident" id="2076351">f1</span><span class="op" id="2076353">,</span>&nbsp;<span class="ident" id="2076355">err1</span><br>
<span class="lineno">540</span><span class="op" id="2076360">}</span>
</div>
</body>
</html>
