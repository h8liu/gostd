<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/subtle</h2>
<ul>
<li><a href="/gostd/crypto/subtle/constant_time.go.html">constant_time.go</a></li>
<li><a href="/gostd/crypto/subtle/constant_time_test.go.html" class="current">constant_time_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6404841">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6404896">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6404950">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6405001">package</span>&nbsp;<span class="ident" id="6405009">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405017">import</span>&nbsp;<span class="op" id="6405024">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6405027">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6405038">&#34;testing/quick&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6405054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405057">type</span>&nbsp;<span class="ident" id="6405062">TestConstantTimeCompareStruct</span>&nbsp;<span class="keyword" id="6405092">struct</span>&nbsp;<span class="op" id="6405099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6405102">a</span><span class="op" id="6405103">,</span>&nbsp;<span class="ident" id="6405105">b</span>&nbsp;<span class="op" id="6405107">[</span><span class="op" id="6405108">]</span><span class="builtintype" id="6405109">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6405115">out</span>&nbsp;&nbsp;<span class="builtintype" id="6405120">int</span><br>
<span class="lineno">15</span><span class="op" id="6405124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405127">var</span>&nbsp;<span class="ident" id="6405131">testConstantTimeCompareData</span>&nbsp;<span class="op" id="6405159">=</span>&nbsp;<span class="op" id="6405161">[</span><span class="op" id="6405162">]</span><span class="ident" id="6405163">TestConstantTimeCompareStruct</span><span class="op" id="6405192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405195">{</span><span class="op" id="6405196">[</span><span class="op" id="6405197">]</span><span class="builtintype" id="6405198">byte</span><span class="op" id="6405202">{</span><span class="op" id="6405203">}</span><span class="op" id="6405204">,</span>&nbsp;<span class="op" id="6405206">[</span><span class="op" id="6405207">]</span><span class="builtintype" id="6405208">byte</span><span class="op" id="6405212">{</span><span class="op" id="6405213">}</span><span class="op" id="6405214">,</span>&nbsp;<span class="num" id="6405216">1</span><span class="op" id="6405217">}</span><span class="op" id="6405218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405221">{</span><span class="op" id="6405222">[</span><span class="op" id="6405223">]</span><span class="builtintype" id="6405224">byte</span><span class="op" id="6405228">{</span><span class="num" id="6405229">0x11</span><span class="op" id="6405233">}</span><span class="op" id="6405234">,</span>&nbsp;<span class="op" id="6405236">[</span><span class="op" id="6405237">]</span><span class="builtintype" id="6405238">byte</span><span class="op" id="6405242">{</span><span class="num" id="6405243">0x11</span><span class="op" id="6405247">}</span><span class="op" id="6405248">,</span>&nbsp;<span class="num" id="6405250">1</span><span class="op" id="6405251">}</span><span class="op" id="6405252">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405255">{</span><span class="op" id="6405256">[</span><span class="op" id="6405257">]</span><span class="builtintype" id="6405258">byte</span><span class="op" id="6405262">{</span><span class="num" id="6405263">0x12</span><span class="op" id="6405267">}</span><span class="op" id="6405268">,</span>&nbsp;<span class="op" id="6405270">[</span><span class="op" id="6405271">]</span><span class="builtintype" id="6405272">byte</span><span class="op" id="6405276">{</span><span class="num" id="6405277">0x11</span><span class="op" id="6405281">}</span><span class="op" id="6405282">,</span>&nbsp;<span class="num" id="6405284">0</span><span class="op" id="6405285">}</span><span class="op" id="6405286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405289">{</span><span class="op" id="6405290">[</span><span class="op" id="6405291">]</span><span class="builtintype" id="6405292">byte</span><span class="op" id="6405296">{</span><span class="num" id="6405297">0x11</span><span class="op" id="6405301">}</span><span class="op" id="6405302">,</span>&nbsp;<span class="op" id="6405304">[</span><span class="op" id="6405305">]</span><span class="builtintype" id="6405306">byte</span><span class="op" id="6405310">{</span><span class="num" id="6405311">0x11</span><span class="op" id="6405315">,</span>&nbsp;<span class="num" id="6405317">0x12</span><span class="op" id="6405321">}</span><span class="op" id="6405322">,</span>&nbsp;<span class="num" id="6405324">0</span><span class="op" id="6405325">}</span><span class="op" id="6405326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405329">{</span><span class="op" id="6405330">[</span><span class="op" id="6405331">]</span><span class="builtintype" id="6405332">byte</span><span class="op" id="6405336">{</span><span class="num" id="6405337">0x11</span><span class="op" id="6405341">,</span>&nbsp;<span class="num" id="6405343">0x12</span><span class="op" id="6405347">}</span><span class="op" id="6405348">,</span>&nbsp;<span class="op" id="6405350">[</span><span class="op" id="6405351">]</span><span class="builtintype" id="6405352">byte</span><span class="op" id="6405356">{</span><span class="num" id="6405357">0x11</span><span class="op" id="6405361">}</span><span class="op" id="6405362">,</span>&nbsp;<span class="num" id="6405364">0</span><span class="op" id="6405365">}</span><span class="op" id="6405366">,</span><br>
<span class="lineno"></span><span class="op" id="6405368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6405371">func</span>&nbsp;<span class="ident" id="6405376">TestConstantTimeCompare</span><span class="op" id="6405399">(</span><span class="ident" id="6405400">t</span>&nbsp;<span class="op" id="6405402">*</span><span class="ident" id="6405403">testing</span><span class="op" id="6405410">.</span><span class="ident" id="6405411">T</span><span class="op" id="6405412">)</span>&nbsp;<span class="op" id="6405414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405417">for</span>&nbsp;<span class="ident" id="6405421">i</span><span class="op" id="6405422">,</span>&nbsp;<span class="ident" id="6405424">test</span>&nbsp;<span class="op" id="6405429">:=</span>&nbsp;<span class="keyword" id="6405432">range</span>&nbsp;<span class="ident" id="6405438">testConstantTimeCompareData</span>&nbsp;<span class="op" id="6405466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405470">if</span>&nbsp;<span class="ident" id="6405473">r</span>&nbsp;<span class="op" id="6405475">:=</span>&nbsp;<span class="ident" id="6405478">ConstantTimeCompare</span><span class="op" id="6405497">(</span><span class="ident" id="6405498">test</span><span class="op" id="6405502">.</span><span class="ident" id="6405503">a</span><span class="op" id="6405504">,</span>&nbsp;<span class="ident" id="6405506">test</span><span class="op" id="6405510">.</span><span class="ident" id="6405511">b</span><span class="op" id="6405512">)</span><span class="op" id="6405513">;</span>&nbsp;<span class="ident" id="6405515">r</span>&nbsp;<span class="op" id="6405517">!=</span>&nbsp;<span class="ident" id="6405520">test</span><span class="op" id="6405524">.</span><span class="ident" id="6405525">out</span>&nbsp;<span class="op" id="6405529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6405534">t</span><span class="op" id="6405535">.</span><span class="ident" id="6405536">Errorf</span><span class="op" id="6405542">(</span><span class="string" id="6405543">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="6405577">,</span>&nbsp;<span class="ident" id="6405579">i</span><span class="op" id="6405580">,</span>&nbsp;<span class="ident" id="6405582">r</span><span class="op" id="6405583">,</span>&nbsp;<span class="ident" id="6405585">test</span><span class="op" id="6405589">.</span><span class="ident" id="6405590">out</span><span class="op" id="6405593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405597">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405600">}</span><br>
<span class="lineno"></span><span class="op" id="6405602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405605">type</span>&nbsp;<span class="ident" id="6405610">TestConstantTimeByteEqStruct</span>&nbsp;<span class="keyword" id="6405639">struct</span>&nbsp;<span class="op" id="6405646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6405649">a</span><span class="op" id="6405650">,</span>&nbsp;<span class="ident" id="6405652">b</span>&nbsp;<span class="builtintype" id="6405654">uint8</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6405661">out</span>&nbsp;&nbsp;<span class="builtintype" id="6405666">int</span><br>
<span class="lineno"></span><span class="op" id="6405670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405673">var</span>&nbsp;<span class="ident" id="6405677">testConstandTimeByteEqData</span>&nbsp;<span class="op" id="6405704">=</span>&nbsp;<span class="op" id="6405706">[</span><span class="op" id="6405707">]</span><span class="ident" id="6405708">TestConstantTimeByteEqStruct</span><span class="op" id="6405736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405739">{</span><span class="num" id="6405740">0</span><span class="op" id="6405741">,</span>&nbsp;<span class="num" id="6405743">0</span><span class="op" id="6405744">,</span>&nbsp;<span class="num" id="6405746">1</span><span class="op" id="6405747">}</span><span class="op" id="6405748">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405751">{</span><span class="num" id="6405752">0</span><span class="op" id="6405753">,</span>&nbsp;<span class="num" id="6405755">1</span><span class="op" id="6405756">,</span>&nbsp;<span class="num" id="6405758">0</span><span class="op" id="6405759">}</span><span class="op" id="6405760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405763">{</span><span class="num" id="6405764">1</span><span class="op" id="6405765">,</span>&nbsp;<span class="num" id="6405767">0</span><span class="op" id="6405768">,</span>&nbsp;<span class="num" id="6405770">0</span><span class="op" id="6405771">}</span><span class="op" id="6405772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405775">{</span><span class="num" id="6405776">0xff</span><span class="op" id="6405780">,</span>&nbsp;<span class="num" id="6405782">0xff</span><span class="op" id="6405786">,</span>&nbsp;<span class="num" id="6405788">1</span><span class="op" id="6405789">}</span><span class="op" id="6405790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405793">{</span><span class="num" id="6405794">0xff</span><span class="op" id="6405798">,</span>&nbsp;<span class="num" id="6405800">0xfe</span><span class="op" id="6405804">,</span>&nbsp;<span class="num" id="6405806">0</span><span class="op" id="6405807">}</span><span class="op" id="6405808">,</span><br>
<span class="lineno"></span><span class="op" id="6405810">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6405813">func</span>&nbsp;<span class="ident" id="6405818">byteEq</span><span class="op" id="6405824">(</span><span class="ident" id="6405825">a</span><span class="op" id="6405826">,</span>&nbsp;<span class="ident" id="6405828">b</span>&nbsp;<span class="builtintype" id="6405830">uint8</span><span class="op" id="6405835">)</span>&nbsp;<span class="builtintype" id="6405837">int</span>&nbsp;<span class="op" id="6405841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405844">if</span>&nbsp;<span class="ident" id="6405847">a</span>&nbsp;<span class="op" id="6405849">==</span>&nbsp;<span class="ident" id="6405852">b</span>&nbsp;<span class="op" id="6405854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405858">return</span>&nbsp;<span class="num" id="6405865">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6405868">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405871">return</span>&nbsp;<span class="num" id="6405878">0</span><br>
<span class="lineno"></span><span class="op" id="6405880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6405883">func</span>&nbsp;<span class="ident" id="6405888">TestConstantTimeByteEq</span><span class="op" id="6405910">(</span><span class="ident" id="6405911">t</span>&nbsp;<span class="op" id="6405913">*</span><span class="ident" id="6405914">testing</span><span class="op" id="6405921">.</span><span class="ident" id="6405922">T</span><span class="op" id="6405923">)</span>&nbsp;<span class="op" id="6405925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405928">for</span>&nbsp;<span class="ident" id="6405932">i</span><span class="op" id="6405933">,</span>&nbsp;<span class="ident" id="6405935">test</span>&nbsp;<span class="op" id="6405940">:=</span>&nbsp;<span class="keyword" id="6405943">range</span>&nbsp;<span class="ident" id="6405949">testConstandTimeByteEqData</span>&nbsp;<span class="op" id="6405976">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6405980">if</span>&nbsp;<span class="ident" id="6405983">r</span>&nbsp;<span class="op" id="6405985">:=</span>&nbsp;<span class="ident" id="6405988">ConstantTimeByteEq</span><span class="op" id="6406006">(</span><span class="ident" id="6406007">test</span><span class="op" id="6406011">.</span><span class="ident" id="6406012">a</span><span class="op" id="6406013">,</span>&nbsp;<span class="ident" id="6406015">test</span><span class="op" id="6406019">.</span><span class="ident" id="6406020">b</span><span class="op" id="6406021">)</span><span class="op" id="6406022">;</span>&nbsp;<span class="ident" id="6406024">r</span>&nbsp;<span class="op" id="6406026">!=</span>&nbsp;<span class="ident" id="6406029">test</span><span class="op" id="6406033">.</span><span class="ident" id="6406034">out</span>&nbsp;<span class="op" id="6406038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406043">t</span><span class="op" id="6406044">.</span><span class="ident" id="6406045">Errorf</span><span class="op" id="6406051">(</span><span class="string" id="6406052">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="6406086">,</span>&nbsp;<span class="ident" id="6406088">i</span><span class="op" id="6406089">,</span>&nbsp;<span class="ident" id="6406091">r</span><span class="op" id="6406092">,</span>&nbsp;<span class="ident" id="6406094">test</span><span class="op" id="6406098">.</span><span class="ident" id="6406099">out</span><span class="op" id="6406102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406112">err</span>&nbsp;<span class="op" id="6406116">:=</span>&nbsp;<span class="ident" id="6406119">quick</span><span class="op" id="6406124">.</span><span class="ident" id="6406125">CheckEqual</span><span class="op" id="6406135">(</span><span class="ident" id="6406136">ConstantTimeByteEq</span><span class="op" id="6406154">,</span>&nbsp;<span class="ident" id="6406156">byteEq</span><span class="op" id="6406162">,</span>&nbsp;<span class="builtintype" id="6406164">nil</span><span class="op" id="6406167">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406170">if</span>&nbsp;<span class="ident" id="6406173">err</span>&nbsp;<span class="op" id="6406177">!=</span>&nbsp;<span class="builtintype" id="6406180">nil</span>&nbsp;<span class="op" id="6406184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406188">t</span><span class="op" id="6406189">.</span><span class="ident" id="6406190">Error</span><span class="op" id="6406195">(</span><span class="ident" id="6406196">err</span><span class="op" id="6406199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406202">}</span><br>
<span class="lineno"></span><span class="op" id="6406204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6406207">func</span>&nbsp;<span class="ident" id="6406212">eq</span><span class="op" id="6406214">(</span><span class="ident" id="6406215">a</span><span class="op" id="6406216">,</span>&nbsp;<span class="ident" id="6406218">b</span>&nbsp;<span class="builtintype" id="6406220">int32</span><span class="op" id="6406225">)</span>&nbsp;<span class="builtintype" id="6406227">int</span>&nbsp;<span class="op" id="6406231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406234">if</span>&nbsp;<span class="ident" id="6406237">a</span>&nbsp;<span class="op" id="6406239">==</span>&nbsp;<span class="ident" id="6406242">b</span>&nbsp;<span class="op" id="6406244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406248">return</span>&nbsp;<span class="num" id="6406255">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406261">return</span>&nbsp;<span class="num" id="6406268">0</span><br>
<span class="lineno">70</span><span class="op" id="6406270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6406273">func</span>&nbsp;<span class="ident" id="6406278">TestConstantTimeEq</span><span class="op" id="6406296">(</span><span class="ident" id="6406297">t</span>&nbsp;<span class="op" id="6406299">*</span><span class="ident" id="6406300">testing</span><span class="op" id="6406307">.</span><span class="ident" id="6406308">T</span><span class="op" id="6406309">)</span>&nbsp;<span class="op" id="6406311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406314">err</span>&nbsp;<span class="op" id="6406318">:=</span>&nbsp;<span class="ident" id="6406321">quick</span><span class="op" id="6406326">.</span><span class="ident" id="6406327">CheckEqual</span><span class="op" id="6406337">(</span><span class="ident" id="6406338">ConstantTimeEq</span><span class="op" id="6406352">,</span>&nbsp;<span class="ident" id="6406354">eq</span><span class="op" id="6406356">,</span>&nbsp;<span class="builtintype" id="6406358">nil</span><span class="op" id="6406361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406364">if</span>&nbsp;<span class="ident" id="6406367">err</span>&nbsp;<span class="op" id="6406371">!=</span>&nbsp;<span class="builtintype" id="6406374">nil</span>&nbsp;<span class="op" id="6406378">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406382">t</span><span class="op" id="6406383">.</span><span class="ident" id="6406384">Error</span><span class="op" id="6406389">(</span><span class="ident" id="6406390">err</span><span class="op" id="6406393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406396">}</span><br>
<span class="lineno"></span><span class="op" id="6406398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6406401">func</span>&nbsp;<span class="ident" id="6406406">makeCopy</span><span class="op" id="6406414">(</span><span class="ident" id="6406415">v</span>&nbsp;<span class="builtintype" id="6406417">int</span><span class="op" id="6406420">,</span>&nbsp;<span class="ident" id="6406422">x</span><span class="op" id="6406423">,</span>&nbsp;<span class="ident" id="6406425">y</span>&nbsp;<span class="op" id="6406427">[</span><span class="op" id="6406428">]</span><span class="builtintype" id="6406429">byte</span><span class="op" id="6406433">)</span>&nbsp;<span class="op" id="6406435">[</span><span class="op" id="6406436">]</span><span class="builtintype" id="6406437">byte</span>&nbsp;<span class="op" id="6406442">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406445">if</span>&nbsp;<span class="builtinfunc" id="6406448">len</span><span class="op" id="6406451">(</span><span class="ident" id="6406452">x</span><span class="op" id="6406453">)</span>&nbsp;<span class="op" id="6406455">&gt;</span>&nbsp;<span class="builtinfunc" id="6406457">len</span><span class="op" id="6406460">(</span><span class="ident" id="6406461">y</span><span class="op" id="6406462">)</span>&nbsp;<span class="op" id="6406464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406468">x</span>&nbsp;<span class="op" id="6406470">=</span>&nbsp;<span class="ident" id="6406472">x</span><span class="op" id="6406473">[</span><span class="num" id="6406474">0</span><span class="op" id="6406475">:</span><span class="builtinfunc" id="6406476">len</span><span class="op" id="6406479">(</span><span class="ident" id="6406480">y</span><span class="op" id="6406481">)</span><span class="op" id="6406482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406485">}</span>&nbsp;<span class="keyword" id="6406487">else</span>&nbsp;<span class="op" id="6406492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406496">y</span>&nbsp;<span class="op" id="6406498">=</span>&nbsp;<span class="ident" id="6406500">y</span><span class="op" id="6406501">[</span><span class="num" id="6406502">0</span><span class="op" id="6406503">:</span><span class="builtinfunc" id="6406504">len</span><span class="op" id="6406507">(</span><span class="ident" id="6406508">x</span><span class="op" id="6406509">)</span><span class="op" id="6406510">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406513">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406516">if</span>&nbsp;<span class="ident" id="6406519">v</span>&nbsp;<span class="op" id="6406521">==</span>&nbsp;<span class="num" id="6406524">1</span>&nbsp;<span class="op" id="6406526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6406530">copy</span><span class="op" id="6406534">(</span><span class="ident" id="6406535">x</span><span class="op" id="6406536">,</span>&nbsp;<span class="ident" id="6406538">y</span><span class="op" id="6406539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406545">return</span>&nbsp;<span class="ident" id="6406552">x</span><br>
<span class="lineno"></span><span class="op" id="6406554">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6406557">func</span>&nbsp;<span class="ident" id="6406562">constantTimeCopyWrapper</span><span class="op" id="6406585">(</span><span class="ident" id="6406586">v</span>&nbsp;<span class="builtintype" id="6406588">int</span><span class="op" id="6406591">,</span>&nbsp;<span class="ident" id="6406593">x</span><span class="op" id="6406594">,</span>&nbsp;<span class="ident" id="6406596">y</span>&nbsp;<span class="op" id="6406598">[</span><span class="op" id="6406599">]</span><span class="builtintype" id="6406600">byte</span><span class="op" id="6406604">)</span>&nbsp;<span class="op" id="6406606">[</span><span class="op" id="6406607">]</span><span class="builtintype" id="6406608">byte</span>&nbsp;<span class="op" id="6406613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406616">if</span>&nbsp;<span class="builtinfunc" id="6406619">len</span><span class="op" id="6406622">(</span><span class="ident" id="6406623">x</span><span class="op" id="6406624">)</span>&nbsp;<span class="op" id="6406626">&gt;</span>&nbsp;<span class="builtinfunc" id="6406628">len</span><span class="op" id="6406631">(</span><span class="ident" id="6406632">y</span><span class="op" id="6406633">)</span>&nbsp;<span class="op" id="6406635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406639">x</span>&nbsp;<span class="op" id="6406641">=</span>&nbsp;<span class="ident" id="6406643">x</span><span class="op" id="6406644">[</span><span class="num" id="6406645">0</span><span class="op" id="6406646">:</span><span class="builtinfunc" id="6406647">len</span><span class="op" id="6406650">(</span><span class="ident" id="6406651">y</span><span class="op" id="6406652">)</span><span class="op" id="6406653">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406656">}</span>&nbsp;<span class="keyword" id="6406658">else</span>&nbsp;<span class="op" id="6406663">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406667">y</span>&nbsp;<span class="op" id="6406669">=</span>&nbsp;<span class="ident" id="6406671">y</span><span class="op" id="6406672">[</span><span class="num" id="6406673">0</span><span class="op" id="6406674">:</span><span class="builtinfunc" id="6406675">len</span><span class="op" id="6406678">(</span><span class="ident" id="6406679">x</span><span class="op" id="6406680">)</span><span class="op" id="6406681">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406687">v</span>&nbsp;<span class="op" id="6406689">&amp;=</span>&nbsp;<span class="num" id="6406692">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406695">ConstantTimeCopy</span><span class="op" id="6406711">(</span><span class="ident" id="6406712">v</span><span class="op" id="6406713">,</span>&nbsp;<span class="ident" id="6406715">x</span><span class="op" id="6406716">,</span>&nbsp;<span class="ident" id="6406718">y</span><span class="op" id="6406719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406722">return</span>&nbsp;<span class="ident" id="6406729">x</span><br>
<span class="lineno">100</span><span class="op" id="6406731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6406734">func</span>&nbsp;<span class="ident" id="6406739">TestConstantTimeCopy</span><span class="op" id="6406759">(</span><span class="ident" id="6406760">t</span>&nbsp;<span class="op" id="6406762">*</span><span class="ident" id="6406763">testing</span><span class="op" id="6406770">.</span><span class="ident" id="6406771">T</span><span class="op" id="6406772">)</span>&nbsp;<span class="op" id="6406774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406777">err</span>&nbsp;<span class="op" id="6406781">:=</span>&nbsp;<span class="ident" id="6406784">quick</span><span class="op" id="6406789">.</span><span class="ident" id="6406790">CheckEqual</span><span class="op" id="6406800">(</span><span class="ident" id="6406801">constantTimeCopyWrapper</span><span class="op" id="6406824">,</span>&nbsp;<span class="ident" id="6406826">makeCopy</span><span class="op" id="6406834">,</span>&nbsp;<span class="builtintype" id="6406836">nil</span><span class="op" id="6406839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6406842">if</span>&nbsp;<span class="ident" id="6406845">err</span>&nbsp;<span class="op" id="6406849">!=</span>&nbsp;<span class="builtintype" id="6406852">nil</span>&nbsp;<span class="op" id="6406856">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406860">t</span><span class="op" id="6406861">.</span><span class="ident" id="6406862">Error</span><span class="op" id="6406867">(</span><span class="ident" id="6406868">err</span><span class="op" id="6406871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406874">}</span><br>
<span class="lineno"></span><span class="op" id="6406876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6406879">var</span>&nbsp;<span class="ident" id="6406883">lessOrEqTests</span>&nbsp;<span class="op" id="6406897">=</span>&nbsp;<span class="op" id="6406899">[</span><span class="op" id="6406900">]</span><span class="keyword" id="6406901">struct</span>&nbsp;<span class="op" id="6406908">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6406911">x</span><span class="op" id="6406912">,</span>&nbsp;<span class="ident" id="6406914">y</span><span class="op" id="6406915">,</span>&nbsp;<span class="ident" id="6406917">result</span>&nbsp;<span class="builtintype" id="6406924">int</span><br>
<span class="lineno"></span><span class="op" id="6406928">}</span><span class="op" id="6406929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406932">{</span><span class="num" id="6406933">0</span><span class="op" id="6406934">,</span>&nbsp;<span class="num" id="6406936">0</span><span class="op" id="6406937">,</span>&nbsp;<span class="num" id="6406939">1</span><span class="op" id="6406940">}</span><span class="op" id="6406941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406944">{</span><span class="num" id="6406945">1</span><span class="op" id="6406946">,</span>&nbsp;<span class="num" id="6406948">0</span><span class="op" id="6406949">,</span>&nbsp;<span class="num" id="6406951">0</span><span class="op" id="6406952">}</span><span class="op" id="6406953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406956">{</span><span class="num" id="6406957">0</span><span class="op" id="6406958">,</span>&nbsp;<span class="num" id="6406960">1</span><span class="op" id="6406961">,</span>&nbsp;<span class="num" id="6406963">1</span><span class="op" id="6406964">}</span><span class="op" id="6406965">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406968">{</span><span class="num" id="6406969">10</span><span class="op" id="6406971">,</span>&nbsp;<span class="num" id="6406973">20</span><span class="op" id="6406975">,</span>&nbsp;<span class="num" id="6406977">1</span><span class="op" id="6406978">}</span><span class="op" id="6406979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406982">{</span><span class="num" id="6406983">20</span><span class="op" id="6406985">,</span>&nbsp;<span class="num" id="6406987">10</span><span class="op" id="6406989">,</span>&nbsp;<span class="num" id="6406991">0</span><span class="op" id="6406992">}</span><span class="op" id="6406993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6406996">{</span><span class="num" id="6406997">10</span><span class="op" id="6406999">,</span>&nbsp;<span class="num" id="6407001">10</span><span class="op" id="6407003">,</span>&nbsp;<span class="num" id="6407005">1</span><span class="op" id="6407006">}</span><span class="op" id="6407007">,</span><br>
<span class="lineno"></span><span class="op" id="6407009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="6407012">func</span>&nbsp;<span class="ident" id="6407017">TestConstantTimeLessOrEq</span><span class="op" id="6407041">(</span><span class="ident" id="6407042">t</span>&nbsp;<span class="op" id="6407044">*</span><span class="ident" id="6407045">testing</span><span class="op" id="6407052">.</span><span class="ident" id="6407053">T</span><span class="op" id="6407054">)</span>&nbsp;<span class="op" id="6407056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6407059">for</span>&nbsp;<span class="ident" id="6407063">i</span><span class="op" id="6407064">,</span>&nbsp;<span class="ident" id="6407066">test</span>&nbsp;<span class="op" id="6407071">:=</span>&nbsp;<span class="keyword" id="6407074">range</span>&nbsp;<span class="ident" id="6407080">lessOrEqTests</span>&nbsp;<span class="op" id="6407094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6407098">result</span>&nbsp;<span class="op" id="6407105">:=</span>&nbsp;<span class="ident" id="6407108">ConstantTimeLessOrEq</span><span class="op" id="6407128">(</span><span class="ident" id="6407129">test</span><span class="op" id="6407133">.</span><span class="ident" id="6407134">x</span><span class="op" id="6407135">,</span>&nbsp;<span class="ident" id="6407137">test</span><span class="op" id="6407141">.</span><span class="ident" id="6407142">y</span><span class="op" id="6407143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6407147">if</span>&nbsp;<span class="ident" id="6407150">result</span>&nbsp;<span class="op" id="6407157">!=</span>&nbsp;<span class="ident" id="6407160">test</span><span class="op" id="6407164">.</span><span class="ident" id="6407165">result</span>&nbsp;<span class="op" id="6407172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6407177">t</span><span class="op" id="6407178">.</span><span class="ident" id="6407179">Errorf</span><span class="op" id="6407185">(</span><span class="string" id="6407186">&#34;#%d:&nbsp;%d&nbsp;&lt;=&nbsp;%d&nbsp;gave&nbsp;%d,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="6407222">,</span>&nbsp;<span class="ident" id="6407224">i</span><span class="op" id="6407225">,</span>&nbsp;<span class="ident" id="6407227">test</span><span class="op" id="6407231">.</span><span class="ident" id="6407232">x</span><span class="op" id="6407233">,</span>&nbsp;<span class="ident" id="6407235">test</span><span class="op" id="6407239">.</span><span class="ident" id="6407240">y</span><span class="op" id="6407241">,</span>&nbsp;<span class="ident" id="6407243">result</span><span class="op" id="6407249">,</span>&nbsp;<span class="ident" id="6407251">test</span><span class="op" id="6407255">.</span><span class="ident" id="6407256">result</span><span class="op" id="6407262">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6407266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6407269">}</span><br>
<span class="lineno"></span><span class="op" id="6407271">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
