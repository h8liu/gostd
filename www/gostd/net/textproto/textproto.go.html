<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3415790">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3415846">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3415900">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3415951">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="3416031">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="3416082">//</span><br>
<span class="lineno"></span><span class="comment" id="3416085">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="3416110">//</span><br>
<span class="lineno">10</span><span class="comment" id="3416113">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3416170">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="3416183">//</span><br>
<span class="lineno"></span><span class="comment" id="3416186">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="3416242">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="3416258">//</span><br>
<span class="lineno"></span><span class="comment" id="3416261">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="3416309">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="3416366">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="3416421">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="3416456">//</span><br>
<span class="lineno"></span><span class="comment" id="3416459">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="3416504">//</span><br>
<span class="lineno"></span><span class="comment" id="3416507">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="3416579">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="3416616">//</span><br>
<span class="lineno"></span><span class="keyword" id="3416619">package</span>&nbsp;<span class="ident" id="3416627">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3416638">import</span>&nbsp;<span class="op" id="3416645">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3416648">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3416657">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3416664">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3416670">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="3416676">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3416679">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="3416742">type</span>&nbsp;<span class="ident" id="3416747">Error</span>&nbsp;<span class="keyword" id="3416753">struct</span>&nbsp;<span class="op" id="3416760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416763">Code</span>&nbsp;<span class="builtintype" id="3416768">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416773">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="3416778">string</span><br>
<span class="lineno"></span><span class="op" id="3416785">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3416788">func</span>&nbsp;<span class="op" id="3416793">(</span><span class="ident" id="3416794">e</span>&nbsp;<span class="op" id="3416796">*</span><span class="ident" id="3416797">Error</span><span class="op" id="3416802">)</span>&nbsp;<span class="ident" id="3416804">Error</span><span class="op" id="3416809">(</span><span class="op" id="3416810">)</span>&nbsp;<span class="builtintype" id="3416812">string</span>&nbsp;<span class="op" id="3416819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416822">return</span>&nbsp;<span class="ident" id="3416829">fmt</span><span class="op" id="3416832">.</span><span class="ident" id="3416833">Sprintf</span><span class="op" id="3416840">(</span><span class="string" id="3416841">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="3416850">,</span>&nbsp;<span class="ident" id="3416852">e</span><span class="op" id="3416853">.</span><span class="ident" id="3416854">Code</span><span class="op" id="3416858">,</span>&nbsp;<span class="ident" id="3416860">e</span><span class="op" id="3416861">.</span><span class="ident" id="3416862">Msg</span><span class="op" id="3416865">)</span><br>
<span class="lineno"></span><span class="op" id="3416867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3416870">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3416925">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3416976">type</span>&nbsp;<span class="ident" id="3416981">ProtocolError</span>&nbsp;<span class="builtintype" id="3416995">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3417003">func</span>&nbsp;<span class="op" id="3417008">(</span><span class="ident" id="3417009">p</span>&nbsp;<span class="ident" id="3417011">ProtocolError</span><span class="op" id="3417024">)</span>&nbsp;<span class="ident" id="3417026">Error</span><span class="op" id="3417031">(</span><span class="op" id="3417032">)</span>&nbsp;<span class="builtintype" id="3417034">string</span>&nbsp;<span class="op" id="3417041">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417044">return</span>&nbsp;<span class="builtintype" id="3417051">string</span><span class="op" id="3417057">(</span><span class="ident" id="3417058">p</span><span class="op" id="3417059">)</span><br>
<span class="lineno"></span><span class="op" id="3417061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3417064">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3417124">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="3417176">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3417245">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="3417294">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3417347">type</span>&nbsp;<span class="ident" id="3417352">Conn</span>&nbsp;<span class="keyword" id="3417357">struct</span>&nbsp;<span class="op" id="3417364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417367">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417375">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417383">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417393">conn</span>&nbsp;<span class="ident" id="3417398">io</span><span class="op" id="3417400">.</span><span class="ident" id="3417401">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3417417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3417420">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3417470">func</span>&nbsp;<span class="ident" id="3417475">NewConn</span><span class="op" id="3417482">(</span><span class="ident" id="3417483">conn</span>&nbsp;<span class="ident" id="3417488">io</span><span class="op" id="3417490">.</span><span class="ident" id="3417491">ReadWriteCloser</span><span class="op" id="3417506">)</span>&nbsp;<span class="op" id="3417508">*</span><span class="ident" id="3417509">Conn</span>&nbsp;<span class="op" id="3417514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417517">return</span>&nbsp;<span class="op" id="3417524">&amp;</span><span class="ident" id="3417525">Conn</span><span class="op" id="3417529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417533">Reader</span><span class="op" id="3417539">:</span>&nbsp;<span class="ident" id="3417541">Reader</span><span class="op" id="3417547">{</span><span class="ident" id="3417548">R</span><span class="op" id="3417549">:</span>&nbsp;<span class="ident" id="3417551">bufio</span><span class="op" id="3417556">.</span><span class="ident" id="3417557">NewReader</span><span class="op" id="3417566">(</span><span class="ident" id="3417567">conn</span><span class="op" id="3417571">)</span><span class="op" id="3417572">}</span><span class="op" id="3417573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417577">Writer</span><span class="op" id="3417583">:</span>&nbsp;<span class="ident" id="3417585">Writer</span><span class="op" id="3417591">{</span><span class="ident" id="3417592">W</span><span class="op" id="3417593">:</span>&nbsp;<span class="ident" id="3417595">bufio</span><span class="op" id="3417600">.</span><span class="ident" id="3417601">NewWriter</span><span class="op" id="3417610">(</span><span class="ident" id="3417611">conn</span><span class="op" id="3417615">)</span><span class="op" id="3417616">}</span><span class="op" id="3417617">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417621">conn</span><span class="op" id="3417625">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3417629">conn</span><span class="op" id="3417633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417636">}</span><br>
<span class="lineno"></span><span class="op" id="3417638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3417641">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3417673">func</span>&nbsp;<span class="op" id="3417678">(</span><span class="ident" id="3417679">c</span>&nbsp;<span class="op" id="3417681">*</span><span class="ident" id="3417682">Conn</span><span class="op" id="3417686">)</span>&nbsp;<span class="ident" id="3417688">Close</span><span class="op" id="3417693">(</span><span class="op" id="3417694">)</span>&nbsp;<span class="builtintype" id="3417696">error</span>&nbsp;<span class="op" id="3417702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417705">return</span>&nbsp;<span class="ident" id="3417712">c</span><span class="op" id="3417713">.</span><span class="ident" id="3417714">conn</span><span class="op" id="3417718">.</span><span class="ident" id="3417719">Close</span><span class="op" id="3417724">(</span><span class="op" id="3417725">)</span><br>
<span class="lineno"></span><span class="op" id="3417727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3417730">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3417804">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3417855">func</span>&nbsp;<span class="ident" id="3417860">Dial</span><span class="op" id="3417864">(</span><span class="ident" id="3417865">network</span><span class="op" id="3417872">,</span>&nbsp;<span class="ident" id="3417874">addr</span>&nbsp;<span class="builtintype" id="3417879">string</span><span class="op" id="3417885">)</span>&nbsp;<span class="op" id="3417887">(</span><span class="op" id="3417888">*</span><span class="ident" id="3417889">Conn</span><span class="op" id="3417893">,</span>&nbsp;<span class="builtintype" id="3417895">error</span><span class="op" id="3417900">)</span>&nbsp;<span class="op" id="3417902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417905">c</span><span class="op" id="3417906">,</span>&nbsp;<span class="ident" id="3417908">err</span>&nbsp;<span class="op" id="3417912">:=</span>&nbsp;<span class="ident" id="3417915">net</span><span class="op" id="3417918">.</span><span class="ident" id="3417919">Dial</span><span class="op" id="3417923">(</span><span class="ident" id="3417924">network</span><span class="op" id="3417931">,</span>&nbsp;<span class="ident" id="3417933">addr</span><span class="op" id="3417937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417940">if</span>&nbsp;<span class="ident" id="3417943">err</span>&nbsp;<span class="op" id="3417947">!=</span>&nbsp;<span class="ident" id="3417950">nil</span>&nbsp;<span class="op" id="3417954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417958">return</span>&nbsp;<span class="ident" id="3417965">nil</span><span class="op" id="3417968">,</span>&nbsp;<span class="ident" id="3417970">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417978">return</span>&nbsp;<span class="ident" id="3417985">NewConn</span><span class="op" id="3417992">(</span><span class="ident" id="3417993">c</span><span class="op" id="3417994">)</span><span class="op" id="3417995">,</span>&nbsp;<span class="ident" id="3417997">nil</span><br>
<span class="lineno"></span><span class="op" id="3418001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3418004">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3418062">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3418124">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3418185">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3418267">//</span><br>
<span class="lineno"></span><span class="comment" id="3418270">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3418344">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3418357">//</span><br>
<span class="lineno"></span><span class="comment" id="3418360">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3418388">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3418407">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3418427">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3418432">//</span><br>
<span class="lineno"></span><span class="comment" id="3418435">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3418458">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3418485">//</span><br>
<span class="lineno">105</span><span class="comment" id="3418488">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3418540">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3418560">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3418565">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3418598">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3418617">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3418637">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3418642">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3418672">//</span><br>
<span class="lineno"></span><span class="keyword" id="3418675">func</span>&nbsp;<span class="op" id="3418680">(</span><span class="ident" id="3418681">c</span>&nbsp;<span class="op" id="3418683">*</span><span class="ident" id="3418684">Conn</span><span class="op" id="3418688">)</span>&nbsp;<span class="ident" id="3418690">Cmd</span><span class="op" id="3418693">(</span><span class="ident" id="3418694">format</span>&nbsp;<span class="builtintype" id="3418701">string</span><span class="op" id="3418707">,</span>&nbsp;<span class="ident" id="3418709">args</span>&nbsp;<span class="op" id="3418714">...</span><span class="keyword" id="3418717">interface</span><span class="op" id="3418726">{</span><span class="op" id="3418727">}</span><span class="op" id="3418728">)</span>&nbsp;<span class="op" id="3418730">(</span><span class="ident" id="3418731">id</span>&nbsp;<span class="builtintype" id="3418734">uint</span><span class="op" id="3418738">,</span>&nbsp;<span class="ident" id="3418740">err</span>&nbsp;<span class="builtintype" id="3418744">error</span><span class="op" id="3418749">)</span>&nbsp;<span class="op" id="3418751">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418754">id</span>&nbsp;<span class="op" id="3418757">=</span>&nbsp;<span class="ident" id="3418759">c</span><span class="op" id="3418760">.</span><span class="ident" id="3418761">Next</span><span class="op" id="3418765">(</span><span class="op" id="3418766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418769">c</span><span class="op" id="3418770">.</span><span class="ident" id="3418771">StartRequest</span><span class="op" id="3418783">(</span><span class="ident" id="3418784">id</span><span class="op" id="3418786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418789">err</span>&nbsp;<span class="op" id="3418793">=</span>&nbsp;<span class="ident" id="3418795">c</span><span class="op" id="3418796">.</span><span class="ident" id="3418797">PrintfLine</span><span class="op" id="3418807">(</span><span class="ident" id="3418808">format</span><span class="op" id="3418814">,</span>&nbsp;<span class="ident" id="3418816">args</span><span class="op" id="3418820">...</span><span class="op" id="3418823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418826">c</span><span class="op" id="3418827">.</span><span class="ident" id="3418828">EndRequest</span><span class="op" id="3418838">(</span><span class="ident" id="3418839">id</span><span class="op" id="3418841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418844">if</span>&nbsp;<span class="ident" id="3418847">err</span>&nbsp;<span class="op" id="3418851">!=</span>&nbsp;<span class="ident" id="3418854">nil</span>&nbsp;<span class="op" id="3418858">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418862">return</span>&nbsp;<span class="num" id="3418869">0</span><span class="op" id="3418870">,</span>&nbsp;<span class="ident" id="3418872">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418880">return</span>&nbsp;<span class="ident" id="3418887">id</span><span class="op" id="3418889">,</span>&nbsp;<span class="ident" id="3418891">nil</span><br>
<span class="lineno"></span><span class="op" id="3418895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3418898">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3418964">func</span>&nbsp;<span class="ident" id="3418969">TrimString</span><span class="op" id="3418979">(</span><span class="ident" id="3418980">s</span>&nbsp;<span class="builtintype" id="3418982">string</span><span class="op" id="3418988">)</span>&nbsp;<span class="builtintype" id="3418990">string</span>&nbsp;<span class="op" id="3418997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419000">for</span>&nbsp;<span class="builtinfunc" id="3419004">len</span><span class="op" id="3419007">(</span><span class="ident" id="3419008">s</span><span class="op" id="3419009">)</span>&nbsp;<span class="op" id="3419011">&gt;</span>&nbsp;<span class="num" id="3419013">0</span>&nbsp;<span class="op" id="3419015">&amp;&amp;</span>&nbsp;<span class="ident" id="3419018">isASCIISpace</span><span class="op" id="3419030">(</span><span class="ident" id="3419031">s</span><span class="op" id="3419032">[</span><span class="num" id="3419033">0</span><span class="op" id="3419034">]</span><span class="op" id="3419035">)</span>&nbsp;<span class="op" id="3419037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419041">s</span>&nbsp;<span class="op" id="3419043">=</span>&nbsp;<span class="ident" id="3419045">s</span><span class="op" id="3419046">[</span><span class="num" id="3419047">1</span><span class="op" id="3419048">:</span><span class="op" id="3419049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419052">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419055">for</span>&nbsp;<span class="builtinfunc" id="3419059">len</span><span class="op" id="3419062">(</span><span class="ident" id="3419063">s</span><span class="op" id="3419064">)</span>&nbsp;<span class="op" id="3419066">&gt;</span>&nbsp;<span class="num" id="3419068">0</span>&nbsp;<span class="op" id="3419070">&amp;&amp;</span>&nbsp;<span class="ident" id="3419073">isASCIISpace</span><span class="op" id="3419085">(</span><span class="ident" id="3419086">s</span><span class="op" id="3419087">[</span><span class="builtinfunc" id="3419088">len</span><span class="op" id="3419091">(</span><span class="ident" id="3419092">s</span><span class="op" id="3419093">)</span><span class="op" id="3419094">-</span><span class="num" id="3419095">1</span><span class="op" id="3419096">]</span><span class="op" id="3419097">)</span>&nbsp;<span class="op" id="3419099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419103">s</span>&nbsp;<span class="op" id="3419105">=</span>&nbsp;<span class="ident" id="3419107">s</span><span class="op" id="3419108">[</span><span class="op" id="3419109">:</span><span class="builtinfunc" id="3419110">len</span><span class="op" id="3419113">(</span><span class="ident" id="3419114">s</span><span class="op" id="3419115">)</span><span class="op" id="3419116">-</span><span class="num" id="3419117">1</span><span class="op" id="3419118">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419124">return</span>&nbsp;<span class="ident" id="3419131">s</span><br>
<span class="lineno"></span><span class="op" id="3419133">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3419136">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3419201">func</span>&nbsp;<span class="ident" id="3419206">TrimBytes</span><span class="op" id="3419215">(</span><span class="ident" id="3419216">b</span>&nbsp;<span class="op" id="3419218">[</span><span class="op" id="3419219">]</span><span class="builtintype" id="3419220">byte</span><span class="op" id="3419224">)</span>&nbsp;<span class="op" id="3419226">[</span><span class="op" id="3419227">]</span><span class="builtintype" id="3419228">byte</span>&nbsp;<span class="op" id="3419233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419236">for</span>&nbsp;<span class="builtinfunc" id="3419240">len</span><span class="op" id="3419243">(</span><span class="ident" id="3419244">b</span><span class="op" id="3419245">)</span>&nbsp;<span class="op" id="3419247">&gt;</span>&nbsp;<span class="num" id="3419249">0</span>&nbsp;<span class="op" id="3419251">&amp;&amp;</span>&nbsp;<span class="ident" id="3419254">isASCIISpace</span><span class="op" id="3419266">(</span><span class="ident" id="3419267">b</span><span class="op" id="3419268">[</span><span class="num" id="3419269">0</span><span class="op" id="3419270">]</span><span class="op" id="3419271">)</span>&nbsp;<span class="op" id="3419273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419277">b</span>&nbsp;<span class="op" id="3419279">=</span>&nbsp;<span class="ident" id="3419281">b</span><span class="op" id="3419282">[</span><span class="num" id="3419283">1</span><span class="op" id="3419284">:</span><span class="op" id="3419285">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419291">for</span>&nbsp;<span class="builtinfunc" id="3419295">len</span><span class="op" id="3419298">(</span><span class="ident" id="3419299">b</span><span class="op" id="3419300">)</span>&nbsp;<span class="op" id="3419302">&gt;</span>&nbsp;<span class="num" id="3419304">0</span>&nbsp;<span class="op" id="3419306">&amp;&amp;</span>&nbsp;<span class="ident" id="3419309">isASCIISpace</span><span class="op" id="3419321">(</span><span class="ident" id="3419322">b</span><span class="op" id="3419323">[</span><span class="builtinfunc" id="3419324">len</span><span class="op" id="3419327">(</span><span class="ident" id="3419328">b</span><span class="op" id="3419329">)</span><span class="op" id="3419330">-</span><span class="num" id="3419331">1</span><span class="op" id="3419332">]</span><span class="op" id="3419333">)</span>&nbsp;<span class="op" id="3419335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419339">b</span>&nbsp;<span class="op" id="3419341">=</span>&nbsp;<span class="ident" id="3419343">b</span><span class="op" id="3419344">[</span><span class="op" id="3419345">:</span><span class="builtinfunc" id="3419346">len</span><span class="op" id="3419349">(</span><span class="ident" id="3419350">b</span><span class="op" id="3419351">)</span><span class="op" id="3419352">-</span><span class="num" id="3419353">1</span><span class="op" id="3419354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419360">return</span>&nbsp;<span class="ident" id="3419367">b</span><br>
<span class="lineno">145</span><span class="op" id="3419369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419372">func</span>&nbsp;<span class="ident" id="3419377">isASCIISpace</span><span class="op" id="3419389">(</span><span class="ident" id="3419390">b</span>&nbsp;<span class="builtintype" id="3419392">byte</span><span class="op" id="3419396">)</span>&nbsp;<span class="builtintype" id="3419398">bool</span>&nbsp;<span class="op" id="3419403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419406">return</span>&nbsp;<span class="ident" id="3419413">b</span>&nbsp;<span class="op" id="3419415">==</span>&nbsp;<span class="string" id="3419418">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3419422">||</span>&nbsp;<span class="ident" id="3419425">b</span>&nbsp;<span class="op" id="3419427">==</span>&nbsp;<span class="string" id="3419430">&#39;\t&#39;</span>&nbsp;<span class="op" id="3419435">||</span>&nbsp;<span class="ident" id="3419438">b</span>&nbsp;<span class="op" id="3419440">==</span>&nbsp;<span class="string" id="3419443">&#39;\n&#39;</span>&nbsp;<span class="op" id="3419448">||</span>&nbsp;<span class="ident" id="3419451">b</span>&nbsp;<span class="op" id="3419453">==</span>&nbsp;<span class="string" id="3419456">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3419461">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3419464">func</span>&nbsp;<span class="ident" id="3419469">isASCIILetter</span><span class="op" id="3419482">(</span><span class="ident" id="3419483">b</span>&nbsp;<span class="builtintype" id="3419485">byte</span><span class="op" id="3419489">)</span>&nbsp;<span class="builtintype" id="3419491">bool</span>&nbsp;<span class="op" id="3419496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419499">b</span>&nbsp;<span class="op" id="3419501">|=</span>&nbsp;<span class="num" id="3419504">0x20</span>&nbsp;<span class="comment" id="3419509">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419529">return</span>&nbsp;<span class="string" id="3419536">&#39;a&#39;</span>&nbsp;<span class="op" id="3419540">&lt;=</span>&nbsp;<span class="ident" id="3419543">b</span>&nbsp;<span class="op" id="3419545">&amp;&amp;</span>&nbsp;<span class="ident" id="3419548">b</span>&nbsp;<span class="op" id="3419550">&lt;=</span>&nbsp;<span class="string" id="3419553">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3419557">}</span>
</div>
</body>
</html>
