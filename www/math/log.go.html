<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1513878">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1513933">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1513987">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1514038">package</span>&nbsp;<span class="ident" id="1514046">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1514052">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1514086">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1514146">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_log.c</span><br>
<span class="lineno"></span><span class="comment" id="1514204">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simpler</span><br>
<span class="lineno"></span><span class="comment" id="1514260">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1514290">//</span><br>
<span class="lineno"></span><span class="comment" id="1514293">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1514349">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1514418">//</span><br>
<span class="lineno"></span><span class="comment" id="1514421">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1514480">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1514536">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1514593">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1514610">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1514666">//</span><br>
<span class="lineno">25</span><span class="comment" id="1514669">//&nbsp;__ieee754_log(x)</span><br>
<span class="lineno"></span><span class="comment" id="1514689">//&nbsp;Return&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1514718">//</span><br>
<span class="lineno"></span><span class="comment" id="1514721">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="1514733">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction:&nbsp;find&nbsp;k&nbsp;and&nbsp;f&nbsp;such&nbsp;that</span><br>
<span class="lineno">30</span><span class="comment" id="1514784">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;=&nbsp;2**k&nbsp;*&nbsp;(1+f),</span><br>
<span class="lineno"></span><span class="comment" id="1514807">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;sqrt(2)/2&nbsp;&lt;&nbsp;1+f&nbsp;&lt;&nbsp;sqrt(2)&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="1514848">//</span><br>
<span class="lineno"></span><span class="comment" id="1514851">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;log(1+f).</span><br>
<span class="lineno"></span><span class="comment" id="1514886">//&nbsp;&nbsp;&nbsp;&nbspLet&nbsp;s&nbsp;=&nbsp;f/(2+f)&nbsp;;&nbsp;based&nbsp;on&nbsp;log(1+f)&nbsp;=&nbsp;log(1+s)&nbsp;-&nbsp;log(1-s)</span><br>
<span class="lineno">35</span><span class="comment" id="1514947">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;=&nbsp;2s&nbsp;+&nbsp;2/3&nbsp;s**3&nbsp;+&nbsp;2/5&nbsp;s**5&nbsp;+&nbsp;.....,</span><br>
<span class="lineno"></span><span class="comment" id="1514988">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;=&nbsp;2s&nbsp;+&nbsp;s*R</span><br>
<span class="lineno"></span><span class="comment" id="1515009">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Reme&nbsp;algorithm&nbsp;on&nbsp;[0,0.1716]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1515075">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;14&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1515141">//&nbsp;&nbsp;&nbsp;&nbspof&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-58.45.&nbsp;In</span><br>
<span class="lineno">40</span><span class="comment" id="1515205">//&nbsp;&nbsp;&nbsp;&nbspother&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1515221">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</span><br>
<span class="lineno"></span><span class="comment" id="1515280">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;L1*s&nbsp;+L2*s&nbsp;+L3*s&nbsp;+L4*s&nbsp;+L5*s&nbsp;&nbsp;+L6*s&nbsp;&nbsp;+L7*s</span><br>
<span class="lineno"></span><span class="comment" id="1515337">//&nbsp;&nbsp;&nbsp;&nbsp(the&nbsp;values&nbsp;of&nbsp;L1&nbsp;to&nbsp;L7&nbsp;are&nbsp;listed&nbsp;in&nbsp;the&nbsp;program)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1515395">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-58.45</span><br>
<span class="lineno">45</span><span class="comment" id="1515445">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;L1*s&nbsp;+...+L7*s&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1515487">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1515526">//&nbsp;&nbsp;&nbsp;&nbspNote&nbsp;that&nbsp;2s&nbsp;=&nbsp;f&nbsp;-&nbsp;s*f&nbsp;=&nbsp;f&nbsp;-&nbsp;hfsq&nbsp;+&nbsp;s*hfsq,&nbsp;where&nbsp;hfsq&nbsp;=&nbsp;f*f/2.</span><br>
<span class="lineno"></span><span class="comment" id="1515593">//&nbsp;&nbsp;&nbsp;&nbspIn&nbsp;order&nbsp;to&nbsp;guarantee&nbsp;error&nbsp;in&nbsp;log&nbsp;below&nbsp;1ulp,&nbsp;we&nbsp;compute&nbsp;log&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1515661">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog(1+f)&nbsp;=&nbsp;f&nbsp;-&nbsp;s*(f&nbsp;-&nbsp;R)&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp(if&nbsp;f&nbsp;is&nbsp;not&nbsp;too&nbsp;large)</span><br>
<span class="lineno">50</span><span class="comment" id="1515715">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog(1+f)&nbsp;=&nbsp;f&nbsp;-&nbsp;(hfsq&nbsp;-&nbsp;s*(hfsq+R)).&nbsp;&nbsp;&nbsp;&nbsp(better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="1515773">//</span><br>
<span class="lineno"></span><span class="comment" id="1515776">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Finally,&nbsp;&nbsp;log(x)&nbsp;=&nbsp;k*Ln2&nbsp;+&nbsp;log(1+f).</span><br>
<span class="lineno"></span><span class="comment" id="1515819">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;k*Ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*Ln2_lo)))</span><br>
<span class="lineno"></span><span class="comment" id="1515872">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;Here&nbsp;Ln2&nbsp;is&nbsp;split&nbsp;into&nbsp;two&nbsp;floating&nbsp;point&nbsp;number:</span><br>
<span class="lineno">55</span><span class="comment" id="1515928">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspLn2_hi&nbsp;+&nbsp;Ln2_lo,</span><br>
<span class="lineno"></span><span class="comment" id="1515950">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;where&nbsp;n*Ln2_hi&nbsp;is&nbsp;always&nbsp;exact&nbsp;for&nbsp;|n|&nbsp;&lt;&nbsp;2000.</span><br>
<span class="lineno"></span><span class="comment" id="1516003">//</span><br>
<span class="lineno"></span><span class="comment" id="1516006">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1516024">//&nbsp;&nbsp;&nbsp;&nbsplog(x)&nbsp;is&nbsp;NaN&nbsp;with&nbsp;signal&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;(including&nbsp;-INF)&nbsp;;</span><br>
<span class="lineno">60</span><span class="comment" id="1516081">//&nbsp;&nbsp;&nbsp;&nbsplog(+INF)&nbsp;is&nbsp;+INF;&nbsp;log(0)&nbsp;is&nbsp;-INF&nbsp;with&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="1516131">//&nbsp;&nbsp;&nbsp;&nbsplog(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1516171">//</span><br>
<span class="lineno"></span><span class="comment" id="1516174">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1516187">//&nbsp;&nbsp;&nbsp;&nbspaccording&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno">65</span><span class="comment" id="1516252">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno"></span><span class="comment" id="1516287">//</span><br>
<span class="lineno"></span><span class="comment" id="1516290">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1516304">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1516370">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="1516434">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno"></span><span class="comment" id="1516500">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1516545">//&nbsp;Log&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1516588">//</span><br>
<span class="lineno">75</span><span class="comment" id="1516591">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1516613">//&nbsp;&nbsp;&nbsp;&nbspLog(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1516633">//&nbsp;&nbsp;&nbsp;&nbspLog(0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1516650">//&nbsp;&nbsp;&nbsp;&nbspLog(x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1516670">//&nbsp;&nbsp;&nbsp;&nbspLog(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">80</span><span class="keyword" id="1516688">func</span>&nbsp;<span class="ident" id="1516693">Log</span><span class="op" id="1516696">(</span><span class="ident" id="1516697">x</span>&nbsp;<span class="builtintype" id="1516699">float64</span><span class="op" id="1516706">)</span>&nbsp;<span class="builtintype" id="1516708">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1516717">func</span>&nbsp;<span class="ident" id="1516722">log</span><span class="op" id="1516725">(</span><span class="ident" id="1516726">x</span>&nbsp;<span class="builtintype" id="1516728">float64</span><span class="op" id="1516735">)</span>&nbsp;<span class="builtintype" id="1516737">float64</span>&nbsp;<span class="op" id="1516745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516748">const</span>&nbsp;<span class="op" id="1516754">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516758">Ln2Hi</span>&nbsp;<span class="op" id="1516764">=</span>&nbsp;<span class="num" id="1516766">6.93147180369123816490e-01</span>&nbsp;<span class="comment" id="1516793">/*&nbsp;3fe62e42&nbsp;fee00000&nbsp;*/</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516819">Ln2Lo</span>&nbsp;<span class="op" id="1516825">=</span>&nbsp;<span class="num" id="1516827">1.90821492927058770002e-10</span>&nbsp;<span class="comment" id="1516854">/*&nbsp;3dea39ef&nbsp;35793c76&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516880">L1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1516886">=</span>&nbsp;<span class="num" id="1516888">6.666666666666735130e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1516915">/*&nbsp;3FE55555&nbsp;55555593&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516941">L2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1516947">=</span>&nbsp;<span class="num" id="1516949">3.999999999940941908e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1516976">/*&nbsp;3FD99999&nbsp;9997FA04&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517002">L3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1517008">=</span>&nbsp;<span class="num" id="1517010">2.857142874366239149e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1517037">/*&nbsp;3FD24924&nbsp;94229359&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517063">L4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1517069">=</span>&nbsp;<span class="num" id="1517071">2.222219843214978396e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1517098">/*&nbsp;3FCC71C5&nbsp;1D8E78AF&nbsp;*/</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517124">L5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1517130">=</span>&nbsp;<span class="num" id="1517132">1.818357216161805012e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1517159">/*&nbsp;3FC74664&nbsp;96CB03DE&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517185">L6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1517191">=</span>&nbsp;<span class="num" id="1517193">1.531383769920937332e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1517220">/*&nbsp;3FC39A09&nbsp;D078C69F&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517246">L7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1517252">=</span>&nbsp;<span class="num" id="1517254">1.479819860511658591e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1517281">/*&nbsp;3FC2F112&nbsp;DF3E5244&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517310">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517328">switch</span>&nbsp;<span class="op" id="1517335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517338">case</span>&nbsp;<span class="ident" id="1517343"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1517348">(</span><span class="ident" id="1517349"><a href="/math/log.go.html#1516726">x</a></span><span class="op" id="1517350">)</span>&nbsp;<span class="op" id="1517352">||</span>&nbsp;<span class="ident" id="1517355"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1517360">(</span><span class="ident" id="1517361"><a href="/math/log.go.html#1516726">x</a></span><span class="op" id="1517362">,</span>&nbsp;<span class="num" id="1517364">1</span><span class="op" id="1517365">)</span><span class="op" id="1517366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517370">return</span>&nbsp;<span class="ident" id="1517377"><a href="/math/log.go.html#1516726">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517380">case</span>&nbsp;<span class="ident" id="1517385"><a href="/math/log.go.html#1516726">x</a></span>&nbsp;<span class="op" id="1517387">&lt;</span>&nbsp;<span class="num" id="1517389">0</span><span class="op" id="1517390">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517394">return</span>&nbsp;<span class="ident" id="1517401"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1517404">(</span><span class="op" id="1517405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517408">case</span>&nbsp;<span class="ident" id="1517413"><a href="/math/log.go.html#1516726">x</a></span>&nbsp;<span class="op" id="1517415">==</span>&nbsp;<span class="num" id="1517418">0</span><span class="op" id="1517419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517423">return</span>&nbsp;<span class="ident" id="1517430"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1517433">(</span><span class="op" id="1517434">-</span><span class="num" id="1517435">1</span><span class="op" id="1517436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517443">//&nbsp;reduce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517454">f1</span><span class="op" id="1517456">,</span>&nbsp;<span class="ident" id="1517458">ki</span>&nbsp;<span class="op" id="1517461">:=</span>&nbsp;<span class="ident" id="1517464"><a href="/math/frexp.go.html#1460543">Frexp</a></span><span class="op" id="1517469">(</span><span class="ident" id="1517470"><a href="/math/log.go.html#1516726">x</a></span><span class="op" id="1517471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517474">if</span>&nbsp;<span class="ident" id="1517477"><a href="/math/log.go.html#1517454">f1</a></span>&nbsp;<span class="op" id="1517480">&lt;</span>&nbsp;<span class="ident" id="1517482"><a href="/math/const.go.html#1430719">Sqrt2</a></span><span class="op" id="1517487">/</span><span class="num" id="1517488">2</span>&nbsp;<span class="op" id="1517490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517494"><a href="/math/log.go.html#1517454">f1</a></span>&nbsp;<span class="op" id="1517497">*=</span>&nbsp;<span class="num" id="1517500">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517504"><a href="/math/log.go.html#1517458">ki</a></span><span class="op" id="1517506">--</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1517510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517513">f</span>&nbsp;<span class="op" id="1517515">:=</span>&nbsp;<span class="ident" id="1517518"><a href="/math/log.go.html#1517454">f1</a></span>&nbsp;<span class="op" id="1517521">-</span>&nbsp;<span class="num" id="1517523">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517526">k</span>&nbsp;<span class="op" id="1517528">:=</span>&nbsp;<span class="builtintype" id="1517531">float64</span><span class="op" id="1517538">(</span><span class="ident" id="1517539"><a href="/math/log.go.html#1517458">ki</a></span><span class="op" id="1517541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1517545">//&nbsp;compute</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517557">s</span>&nbsp;<span class="op" id="1517559">:=</span>&nbsp;<span class="ident" id="1517562"><a href="/math/log.go.html#1517513">f</a></span>&nbsp;<span class="op" id="1517564">/</span>&nbsp;<span class="op" id="1517566">(</span><span class="num" id="1517567">2</span>&nbsp;<span class="op" id="1517569">+</span>&nbsp;<span class="ident" id="1517571"><a href="/math/log.go.html#1517513">f</a></span><span class="op" id="1517572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517575">s2</span>&nbsp;<span class="op" id="1517578">:=</span>&nbsp;<span class="ident" id="1517581"><a href="/math/log.go.html#1517557">s</a></span>&nbsp;<span class="op" id="1517583">*</span>&nbsp;<span class="ident" id="1517585"><a href="/math/log.go.html#1517557">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517588">s4</span>&nbsp;<span class="op" id="1517591">:=</span>&nbsp;<span class="ident" id="1517594"><a href="/math/log.go.html#1517575">s2</a></span>&nbsp;<span class="op" id="1517597">*</span>&nbsp;<span class="ident" id="1517599"><a href="/math/log.go.html#1517575">s2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517603">t1</span>&nbsp;<span class="op" id="1517606">:=</span>&nbsp;<span class="ident" id="1517609"><a href="/math/log.go.html#1517575">s2</a></span>&nbsp;<span class="op" id="1517612">*</span>&nbsp;<span class="op" id="1517614">(</span><span class="ident" id="1517615"><a href="/math/log.go.html#1516880">L1</a></span>&nbsp;<span class="op" id="1517618">+</span>&nbsp;<span class="ident" id="1517620"><a href="/math/log.go.html#1517588">s4</a></span><span class="op" id="1517622">*</span><span class="op" id="1517623">(</span><span class="ident" id="1517624"><a href="/math/log.go.html#1517002">L3</a></span><span class="op" id="1517626">+</span><span class="ident" id="1517627"><a href="/math/log.go.html#1517588">s4</a></span><span class="op" id="1517629">*</span><span class="op" id="1517630">(</span><span class="ident" id="1517631"><a href="/math/log.go.html#1517124">L5</a></span><span class="op" id="1517633">+</span><span class="ident" id="1517634"><a href="/math/log.go.html#1517588">s4</a></span><span class="op" id="1517636">*</span><span class="ident" id="1517637"><a href="/math/log.go.html#1517246">L7</a></span><span class="op" id="1517639">)</span><span class="op" id="1517640">)</span><span class="op" id="1517641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517644">t2</span>&nbsp;<span class="op" id="1517647">:=</span>&nbsp;<span class="ident" id="1517650"><a href="/math/log.go.html#1517588">s4</a></span>&nbsp;<span class="op" id="1517653">*</span>&nbsp;<span class="op" id="1517655">(</span><span class="ident" id="1517656"><a href="/math/log.go.html#1516941">L2</a></span>&nbsp;<span class="op" id="1517659">+</span>&nbsp;<span class="ident" id="1517661"><a href="/math/log.go.html#1517588">s4</a></span><span class="op" id="1517663">*</span><span class="op" id="1517664">(</span><span class="ident" id="1517665"><a href="/math/log.go.html#1517063">L4</a></span><span class="op" id="1517667">+</span><span class="ident" id="1517668"><a href="/math/log.go.html#1517588">s4</a></span><span class="op" id="1517670">*</span><span class="ident" id="1517671"><a href="/math/log.go.html#1517185">L6</a></span><span class="op" id="1517673">)</span><span class="op" id="1517674">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517677">R</span>&nbsp;<span class="op" id="1517679">:=</span>&nbsp;<span class="ident" id="1517682"><a href="/math/log.go.html#1517603">t1</a></span>&nbsp;<span class="op" id="1517685">+</span>&nbsp;<span class="ident" id="1517687"><a href="/math/log.go.html#1517644">t2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1517691">hfsq</span>&nbsp;<span class="op" id="1517696">:=</span>&nbsp;<span class="num" id="1517699">0.5</span>&nbsp;<span class="op" id="1517703">*</span>&nbsp;<span class="ident" id="1517705"><a href="/math/log.go.html#1517513">f</a></span>&nbsp;<span class="op" id="1517707">*</span>&nbsp;<span class="ident" id="1517709"><a href="/math/log.go.html#1517513">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1517712">return</span>&nbsp;<span class="ident" id="1517719"><a href="/math/log.go.html#1517526">k</a></span><span class="op" id="1517720">*</span><span class="ident" id="1517721"><a href="/math/log.go.html#1516758">Ln2Hi</a></span>&nbsp;<span class="op" id="1517727">-</span>&nbsp;<span class="op" id="1517729">(</span><span class="op" id="1517730">(</span><span class="ident" id="1517731"><a href="/math/log.go.html#1517691">hfsq</a></span>&nbsp;<span class="op" id="1517736">-</span>&nbsp;<span class="op" id="1517738">(</span><span class="ident" id="1517739"><a href="/math/log.go.html#1517557">s</a></span><span class="op" id="1517740">*</span><span class="op" id="1517741">(</span><span class="ident" id="1517742"><a href="/math/log.go.html#1517691">hfsq</a></span><span class="op" id="1517746">+</span><span class="ident" id="1517747"><a href="/math/log.go.html#1517677">R</a></span><span class="op" id="1517748">)</span>&nbsp;<span class="op" id="1517750">+</span>&nbsp;<span class="ident" id="1517752"><a href="/math/log.go.html#1517526">k</a></span><span class="op" id="1517753">*</span><span class="ident" id="1517754"><a href="/math/log.go.html#1516819">Ln2Lo</a></span><span class="op" id="1517759">)</span><span class="op" id="1517760">)</span>&nbsp;<span class="op" id="1517762">-</span>&nbsp;<span class="ident" id="1517764"><a href="/math/log.go.html#1517513">f</a></span><span class="op" id="1517765">)</span><br>
<span class="lineno"></span><span class="op" id="1517767">}</span>
</div>
</body>
</html>
