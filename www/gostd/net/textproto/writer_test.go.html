<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6831370">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6831426">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6831480">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6831531">package</span>&nbsp;<span class="ident" id="6831539">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6831550">import</span>&nbsp;<span class="op" id="6831557">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6831560">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6831569">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6831578">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6831588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6831591">func</span>&nbsp;<span class="ident" id="6831596">TestPrintfLine</span><span class="op" id="6831610">(</span><span class="ident" id="6831611">t</span>&nbsp;<span class="op" id="6831613">*</span><span class="ident" id="6831614">testing</span><span class="op" id="6831621">.</span><span class="ident" id="6831622">T</span><span class="op" id="6831623">)</span>&nbsp;<span class="op" id="6831625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6831628">var</span>&nbsp;<span class="ident" id="6831632">buf</span>&nbsp;<span class="ident" id="6831636">bytes</span><span class="op" id="6831641">.</span><span class="ident" id="6831642">Buffer</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831650">w</span>&nbsp;<span class="op" id="6831652">:=</span>&nbsp;<span class="ident" id="6831655">NewWriter</span><span class="op" id="6831664">(</span><span class="ident" id="6831665">bufio</span><span class="op" id="6831670">.</span><span class="ident" id="6831671">NewWriter</span><span class="op" id="6831680">(</span><span class="op" id="6831681">&amp;</span><span class="ident" id="6831682">buf</span><span class="op" id="6831685">)</span><span class="op" id="6831686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831689">err</span>&nbsp;<span class="op" id="6831693">:=</span>&nbsp;<span class="ident" id="6831696">w</span><span class="op" id="6831697">.</span><span class="ident" id="6831698">PrintfLine</span><span class="op" id="6831708">(</span><span class="string" id="6831709">&#34;foo&nbsp;%d&#34;</span><span class="op" id="6831717">,</span>&nbsp;<span class="num" id="6831719">123</span><span class="op" id="6831722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6831725">if</span>&nbsp;<span class="ident" id="6831728">s</span>&nbsp;<span class="op" id="6831730">:=</span>&nbsp;<span class="ident" id="6831733">buf</span><span class="op" id="6831736">.</span><span class="ident" id="6831737">String</span><span class="op" id="6831743">(</span><span class="op" id="6831744">)</span><span class="op" id="6831745">;</span>&nbsp;<span class="ident" id="6831747">s</span>&nbsp;<span class="op" id="6831749">!=</span>&nbsp;<span class="string" id="6831752">&#34;foo&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="6831766">||</span>&nbsp;<span class="ident" id="6831769">err</span>&nbsp;<span class="op" id="6831773">!=</span>&nbsp;<span class="ident" id="6831776">nil</span>&nbsp;<span class="op" id="6831780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831784">t</span><span class="op" id="6831785">.</span><span class="ident" id="6831786">Fatalf</span><span class="op" id="6831792">(</span><span class="string" id="6831793">&#34;s=%q;&nbsp;err=%s&#34;</span><span class="op" id="6831807">,</span>&nbsp;<span class="ident" id="6831809">s</span><span class="op" id="6831810">,</span>&nbsp;<span class="ident" id="6831812">err</span><span class="op" id="6831815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831818">}</span><br>
<span class="lineno">20</span><span class="op" id="6831820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6831823">func</span>&nbsp;<span class="ident" id="6831828">TestDotWriter</span><span class="op" id="6831841">(</span><span class="ident" id="6831842">t</span>&nbsp;<span class="op" id="6831844">*</span><span class="ident" id="6831845">testing</span><span class="op" id="6831852">.</span><span class="ident" id="6831853">T</span><span class="op" id="6831854">)</span>&nbsp;<span class="op" id="6831856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6831859">var</span>&nbsp;<span class="ident" id="6831863">buf</span>&nbsp;<span class="ident" id="6831867">bytes</span><span class="op" id="6831872">.</span><span class="ident" id="6831873">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831881">w</span>&nbsp;<span class="op" id="6831883">:=</span>&nbsp;<span class="ident" id="6831886">NewWriter</span><span class="op" id="6831895">(</span><span class="ident" id="6831896">bufio</span><span class="op" id="6831901">.</span><span class="ident" id="6831902">NewWriter</span><span class="op" id="6831911">(</span><span class="op" id="6831912">&amp;</span><span class="ident" id="6831913">buf</span><span class="op" id="6831916">)</span><span class="op" id="6831917">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831920">d</span>&nbsp;<span class="op" id="6831922">:=</span>&nbsp;<span class="ident" id="6831925">w</span><span class="op" id="6831926">.</span><span class="ident" id="6831927">DotWriter</span><span class="op" id="6831936">(</span><span class="op" id="6831937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831940">n</span><span class="op" id="6831941">,</span>&nbsp;<span class="ident" id="6831943">err</span>&nbsp;<span class="op" id="6831947">:=</span>&nbsp;<span class="ident" id="6831950">d</span><span class="op" id="6831951">.</span><span class="ident" id="6831952">Write</span><span class="op" id="6831957">(</span><span class="op" id="6831958">[</span><span class="op" id="6831959">]</span><span class="builtintype" id="6831960">byte</span><span class="op" id="6831964">(</span><span class="string" id="6831965">&#34;abc\n.def\n..ghi\n.jkl\n.&#34;</span><span class="op" id="6831992">)</span><span class="op" id="6831993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6831996">if</span>&nbsp;<span class="ident" id="6831999">n</span>&nbsp;<span class="op" id="6832001">!=</span>&nbsp;<span class="num" id="6832004">21</span>&nbsp;<span class="op" id="6832007">||</span>&nbsp;<span class="ident" id="6832010">err</span>&nbsp;<span class="op" id="6832014">!=</span>&nbsp;<span class="ident" id="6832017">nil</span>&nbsp;<span class="op" id="6832021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832025">t</span><span class="op" id="6832026">.</span><span class="ident" id="6832027">Fatalf</span><span class="op" id="6832033">(</span><span class="string" id="6832034">&#34;Write:&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="6832049">,</span>&nbsp;<span class="ident" id="6832051">n</span><span class="op" id="6832052">,</span>&nbsp;<span class="ident" id="6832054">err</span><span class="op" id="6832057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832060">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832063">d</span><span class="op" id="6832064">.</span><span class="ident" id="6832065">Close</span><span class="op" id="6832070">(</span><span class="op" id="6832071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832074">want</span>&nbsp;<span class="op" id="6832079">:=</span>&nbsp;<span class="string" id="6832082">&#34;abc\r\n..def\r\n...ghi\r\n..jkl\r\n..\r\n.\r\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6832132">if</span>&nbsp;<span class="ident" id="6832135">s</span>&nbsp;<span class="op" id="6832137">:=</span>&nbsp;<span class="ident" id="6832140">buf</span><span class="op" id="6832143">.</span><span class="ident" id="6832144">String</span><span class="op" id="6832150">(</span><span class="op" id="6832151">)</span><span class="op" id="6832152">;</span>&nbsp;<span class="ident" id="6832154">s</span>&nbsp;<span class="op" id="6832156">!=</span>&nbsp;<span class="ident" id="6832159">want</span>&nbsp;<span class="op" id="6832164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832168">t</span><span class="op" id="6832169">.</span><span class="ident" id="6832170">Fatalf</span><span class="op" id="6832176">(</span><span class="string" id="6832177">&#34;wrote&nbsp;%q&#34;</span><span class="op" id="6832187">,</span>&nbsp;<span class="ident" id="6832189">s</span><span class="op" id="6832190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832193">}</span><br>
<span class="lineno">35</span><span class="op" id="6832195">}</span>
</div>
</body>
</html>
