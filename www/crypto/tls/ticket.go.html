<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4244661">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4244716">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4244770">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4244821">package</span>&nbsp;<span class="ident" id="4244829">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4244834">import</span>&nbsp;<span class="op" id="4244841">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244844">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244853">&#34;crypto/aes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244867">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244884">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244899">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244916">&#34;crypto/subtle&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244933">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4244943">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4244948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4244951">//&nbsp;sessionState&nbsp;contains&nbsp;the&nbsp;information&nbsp;that&nbsp;is&nbsp;serialized&nbsp;into&nbsp;a&nbsp;session</span><br>
<span class="lineno"></span><span class="comment" id="4245026">//&nbsp;ticket&nbsp;in&nbsp;order&nbsp;to&nbsp;later&nbsp;resume&nbsp;a&nbsp;connection.</span><br>
<span class="lineno">20</span><span class="keyword" id="4245075">type</span>&nbsp;<span class="ident" id="4245080">sessionState</span>&nbsp;<span class="keyword" id="4245093">struct</span>&nbsp;<span class="op" id="4245100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245103">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4245116">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245124">cipherSuite</span>&nbsp;&nbsp;<span class="builtintype" id="4245137">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245145">masterSecret</span>&nbsp;<span class="op" id="4245158">[</span><span class="op" id="4245159">]</span><span class="builtintype" id="4245160">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245166">certificates</span>&nbsp;<span class="op" id="4245179">[</span><span class="op" id="4245180">]</span><span class="op" id="4245181">[</span><span class="op" id="4245182">]</span><span class="builtintype" id="4245183">byte</span><br>
<span class="lineno">25</span><span class="op" id="4245188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4245191">func</span>&nbsp;<span class="op" id="4245196">(</span><span class="ident" id="4245197">s</span>&nbsp;<span class="op" id="4245199">*</span><span class="ident" id="4245200"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4245212">)</span>&nbsp;<span class="ident" id="4245214">equal</span><span class="op" id="4245219">(</span><span class="ident" id="4245220">i</span>&nbsp;<span class="keyword" id="4245222">interface</span><span class="op" id="4245231">{</span><span class="op" id="4245232">}</span><span class="op" id="4245233">)</span>&nbsp;<span class="builtintype" id="4245235">bool</span>&nbsp;<span class="op" id="4245240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245243">s1</span><span class="op" id="4245245">,</span>&nbsp;<span class="ident" id="4245247">ok</span>&nbsp;<span class="op" id="4245250">:=</span>&nbsp;<span class="ident" id="4245253"><a href="/crypto/tls/ticket.go.html#4245220">i</a></span><span class="op" id="4245254">.</span><span class="op" id="4245255">(</span><span class="op" id="4245256">*</span><span class="ident" id="4245257"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4245269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245272">if</span>&nbsp;<span class="op" id="4245275">!</span><span class="ident" id="4245276"><a href="/crypto/tls/ticket.go.html#4245247">ok</a></span>&nbsp;<span class="op" id="4245279">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245283">return</span>&nbsp;<span class="ident" id="4245290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245301">if</span>&nbsp;<span class="ident" id="4245304"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245305">.</span><span class="ident" id="4245306">vers</span>&nbsp;<span class="op" id="4245311">!=</span>&nbsp;<span class="ident" id="4245314"><a href="/crypto/tls/ticket.go.html#4245243">s1</a></span><span class="op" id="4245316">.</span><span class="ident" id="4245317">vers</span>&nbsp;<span class="op" id="4245322">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245327"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245328">.</span><span class="ident" id="4245329">cipherSuite</span>&nbsp;<span class="op" id="4245341">!=</span>&nbsp;<span class="ident" id="4245344"><a href="/crypto/tls/ticket.go.html#4245243">s1</a></span><span class="op" id="4245346">.</span><span class="ident" id="4245347">cipherSuite</span>&nbsp;<span class="op" id="4245359">||</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245364">!</span><span class="ident" id="4245365"><a href="/crypto/tls/ticket.go.html#4244844">bytes</a></span><span class="op" id="4245370">.</span><span class="ident" id="4245371">Equal</span><span class="op" id="4245376">(</span><span class="ident" id="4245377"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245378">.</span><span class="ident" id="4245379">masterSecret</span><span class="op" id="4245391">,</span>&nbsp;<span class="ident" id="4245393"><a href="/crypto/tls/ticket.go.html#4245243">s1</a></span><span class="op" id="4245395">.</span><span class="ident" id="4245396">masterSecret</span><span class="op" id="4245408">)</span>&nbsp;<span class="op" id="4245410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245414">return</span>&nbsp;<span class="ident" id="4245421">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245432">if</span>&nbsp;<span class="builtinfunc" id="4245435">len</span><span class="op" id="4245438">(</span><span class="ident" id="4245439"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245440">.</span><span class="ident" id="4245441">certificates</span><span class="op" id="4245453">)</span>&nbsp;<span class="op" id="4245455">!=</span>&nbsp;<span class="builtinfunc" id="4245458">len</span><span class="op" id="4245461">(</span><span class="ident" id="4245462"><a href="/crypto/tls/ticket.go.html#4245243">s1</a></span><span class="op" id="4245464">.</span><span class="ident" id="4245465">certificates</span><span class="op" id="4245477">)</span>&nbsp;<span class="op" id="4245479">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245483">return</span>&nbsp;<span class="ident" id="4245490">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245501">for</span>&nbsp;<span class="ident" id="4245505">i</span>&nbsp;<span class="op" id="4245507">:=</span>&nbsp;<span class="keyword" id="4245510">range</span>&nbsp;<span class="ident" id="4245516"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245517">.</span><span class="ident" id="4245518">certificates</span>&nbsp;<span class="op" id="4245531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245535">if</span>&nbsp;<span class="op" id="4245538">!</span><span class="ident" id="4245539"><a href="/crypto/tls/ticket.go.html#4244844">bytes</a></span><span class="op" id="4245544">.</span><span class="ident" id="4245545">Equal</span><span class="op" id="4245550">(</span><span class="ident" id="4245551"><a href="/crypto/tls/ticket.go.html#4245197">s</a></span><span class="op" id="4245552">.</span><span class="ident" id="4245553">certificates</span><span class="op" id="4245565">[</span><span class="ident" id="4245566"><a href="/crypto/tls/ticket.go.html#4245505">i</a></span><span class="op" id="4245567">]</span><span class="op" id="4245568">,</span>&nbsp;<span class="ident" id="4245570"><a href="/crypto/tls/ticket.go.html#4245243">s1</a></span><span class="op" id="4245572">.</span><span class="ident" id="4245573">certificates</span><span class="op" id="4245585">[</span><span class="ident" id="4245586"><a href="/crypto/tls/ticket.go.html#4245505">i</a></span><span class="op" id="4245587">]</span><span class="op" id="4245588">)</span>&nbsp;<span class="op" id="4245590">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245595">return</span>&nbsp;<span class="ident" id="4245602">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245617">return</span>&nbsp;<span class="ident" id="4245624">true</span><br>
<span class="lineno">50</span><span class="op" id="4245629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4245632">func</span>&nbsp;<span class="op" id="4245637">(</span><span class="ident" id="4245638">s</span>&nbsp;<span class="op" id="4245640">*</span><span class="ident" id="4245641"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4245653">)</span>&nbsp;<span class="ident" id="4245655">marshal</span><span class="op" id="4245662">(</span><span class="op" id="4245663">)</span>&nbsp;<span class="op" id="4245665">[</span><span class="op" id="4245666">]</span><span class="builtintype" id="4245667">byte</span>&nbsp;<span class="op" id="4245672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245675">length</span>&nbsp;<span class="op" id="4245682">:=</span>&nbsp;<span class="num" id="4245685">2</span>&nbsp;<span class="op" id="4245687">+</span>&nbsp;<span class="num" id="4245689">2</span>&nbsp;<span class="op" id="4245691">+</span>&nbsp;<span class="num" id="4245693">2</span>&nbsp;<span class="op" id="4245695">+</span>&nbsp;<span class="builtinfunc" id="4245697">len</span><span class="op" id="4245700">(</span><span class="ident" id="4245701"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245702">.</span><span class="ident" id="4245703">masterSecret</span><span class="op" id="4245715">)</span>&nbsp;<span class="op" id="4245717">+</span>&nbsp;<span class="num" id="4245719">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4245722">for</span>&nbsp;<span class="ident" id="4245726">_</span><span class="op" id="4245727">,</span>&nbsp;<span class="ident" id="4245729">cert</span>&nbsp;<span class="op" id="4245734">:=</span>&nbsp;<span class="keyword" id="4245737">range</span>&nbsp;<span class="ident" id="4245743"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245744">.</span><span class="ident" id="4245745">certificates</span>&nbsp;<span class="op" id="4245758">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245762"><a href="/crypto/tls/ticket.go.html#4245675">length</a></span>&nbsp;<span class="op" id="4245769">+=</span>&nbsp;<span class="num" id="4245772">4</span>&nbsp;<span class="op" id="4245774">+</span>&nbsp;<span class="builtinfunc" id="4245776">len</span><span class="op" id="4245779">(</span><span class="ident" id="4245780"><a href="/crypto/tls/ticket.go.html#4245729">cert</a></span><span class="op" id="4245784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4245787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245791">ret</span>&nbsp;<span class="op" id="4245795">:=</span>&nbsp;<span class="builtinfunc" id="4245798">make</span><span class="op" id="4245802">(</span><span class="op" id="4245803">[</span><span class="op" id="4245804">]</span><span class="builtintype" id="4245805">byte</span><span class="op" id="4245809">,</span>&nbsp;<span class="ident" id="4245811"><a href="/crypto/tls/ticket.go.html#4245675">length</a></span><span class="op" id="4245817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245820">x</span>&nbsp;<span class="op" id="4245822">:=</span>&nbsp;<span class="ident" id="4245825"><a href="/crypto/tls/ticket.go.html#4245791">ret</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245830"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245831">[</span><span class="num" id="4245832">0</span><span class="op" id="4245833">]</span>&nbsp;<span class="op" id="4245835">=</span>&nbsp;<span class="builtintype" id="4245837">byte</span><span class="op" id="4245841">(</span><span class="ident" id="4245842"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245843">.</span><span class="ident" id="4245844">vers</span>&nbsp;<span class="op" id="4245849">&gt;&gt;</span>&nbsp;<span class="num" id="4245852">8</span><span class="op" id="4245853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245856"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245857">[</span><span class="num" id="4245858">1</span><span class="op" id="4245859">]</span>&nbsp;<span class="op" id="4245861">=</span>&nbsp;<span class="builtintype" id="4245863">byte</span><span class="op" id="4245867">(</span><span class="ident" id="4245868"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245869">.</span><span class="ident" id="4245870">vers</span><span class="op" id="4245874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245877"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245878">[</span><span class="num" id="4245879">2</span><span class="op" id="4245880">]</span>&nbsp;<span class="op" id="4245882">=</span>&nbsp;<span class="builtintype" id="4245884">byte</span><span class="op" id="4245888">(</span><span class="ident" id="4245889"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245890">.</span><span class="ident" id="4245891">cipherSuite</span>&nbsp;<span class="op" id="4245903">&gt;&gt;</span>&nbsp;<span class="num" id="4245906">8</span><span class="op" id="4245907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245910"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245911">[</span><span class="num" id="4245912">3</span><span class="op" id="4245913">]</span>&nbsp;<span class="op" id="4245915">=</span>&nbsp;<span class="builtintype" id="4245917">byte</span><span class="op" id="4245921">(</span><span class="ident" id="4245922"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245923">.</span><span class="ident" id="4245924">cipherSuite</span><span class="op" id="4245935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245938"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245939">[</span><span class="num" id="4245940">4</span><span class="op" id="4245941">]</span>&nbsp;<span class="op" id="4245943">=</span>&nbsp;<span class="builtintype" id="4245945">byte</span><span class="op" id="4245949">(</span><span class="builtinfunc" id="4245950">len</span><span class="op" id="4245953">(</span><span class="ident" id="4245954"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245955">.</span><span class="ident" id="4245956">masterSecret</span><span class="op" id="4245968">)</span>&nbsp;<span class="op" id="4245970">&gt;&gt;</span>&nbsp;<span class="num" id="4245973">8</span><span class="op" id="4245974">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4245977"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4245978">[</span><span class="num" id="4245979">5</span><span class="op" id="4245980">]</span>&nbsp;<span class="op" id="4245982">=</span>&nbsp;<span class="builtintype" id="4245984">byte</span><span class="op" id="4245988">(</span><span class="builtinfunc" id="4245989">len</span><span class="op" id="4245992">(</span><span class="ident" id="4245993"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4245994">.</span><span class="ident" id="4245995">masterSecret</span><span class="op" id="4246007">)</span><span class="op" id="4246008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246011"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span>&nbsp;<span class="op" id="4246013">=</span>&nbsp;<span class="ident" id="4246015"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246016">[</span><span class="num" id="4246017">6</span><span class="op" id="4246018">:</span><span class="op" id="4246019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4246022">copy</span><span class="op" id="4246026">(</span><span class="ident" id="4246027"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246028">,</span>&nbsp;<span class="ident" id="4246030"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4246031">.</span><span class="ident" id="4246032">masterSecret</span><span class="op" id="4246044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246047"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span>&nbsp;<span class="op" id="4246049">=</span>&nbsp;<span class="ident" id="4246051"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246052">[</span><span class="builtinfunc" id="4246053">len</span><span class="op" id="4246056">(</span><span class="ident" id="4246057"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4246058">.</span><span class="ident" id="4246059">masterSecret</span><span class="op" id="4246071">)</span><span class="op" id="4246072">:</span><span class="op" id="4246073">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246077"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246078">[</span><span class="num" id="4246079">0</span><span class="op" id="4246080">]</span>&nbsp;<span class="op" id="4246082">=</span>&nbsp;<span class="builtintype" id="4246084">byte</span><span class="op" id="4246088">(</span><span class="builtinfunc" id="4246089">len</span><span class="op" id="4246092">(</span><span class="ident" id="4246093"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4246094">.</span><span class="ident" id="4246095">certificates</span><span class="op" id="4246107">)</span>&nbsp;<span class="op" id="4246109">&gt;&gt;</span>&nbsp;<span class="num" id="4246112">8</span><span class="op" id="4246113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246116"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246117">[</span><span class="num" id="4246118">1</span><span class="op" id="4246119">]</span>&nbsp;<span class="op" id="4246121">=</span>&nbsp;<span class="builtintype" id="4246123">byte</span><span class="op" id="4246127">(</span><span class="builtinfunc" id="4246128">len</span><span class="op" id="4246131">(</span><span class="ident" id="4246132"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4246133">.</span><span class="ident" id="4246134">certificates</span><span class="op" id="4246146">)</span><span class="op" id="4246147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246150"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span>&nbsp;<span class="op" id="4246152">=</span>&nbsp;<span class="ident" id="4246154"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246155">[</span><span class="num" id="4246156">2</span><span class="op" id="4246157">:</span><span class="op" id="4246158">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246162">for</span>&nbsp;<span class="ident" id="4246166">_</span><span class="op" id="4246167">,</span>&nbsp;<span class="ident" id="4246169">cert</span>&nbsp;<span class="op" id="4246174">:=</span>&nbsp;<span class="keyword" id="4246177">range</span>&nbsp;<span class="ident" id="4246183"><a href="/crypto/tls/ticket.go.html#4245638">s</a></span><span class="op" id="4246184">.</span><span class="ident" id="4246185">certificates</span>&nbsp;<span class="op" id="4246198">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246202"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246203">[</span><span class="num" id="4246204">0</span><span class="op" id="4246205">]</span>&nbsp;<span class="op" id="4246207">=</span>&nbsp;<span class="builtintype" id="4246209">byte</span><span class="op" id="4246213">(</span><span class="builtinfunc" id="4246214">len</span><span class="op" id="4246217">(</span><span class="ident" id="4246218"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246222">)</span>&nbsp;<span class="op" id="4246224">&gt;&gt;</span>&nbsp;<span class="num" id="4246227">24</span><span class="op" id="4246229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246233"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246234">[</span><span class="num" id="4246235">1</span><span class="op" id="4246236">]</span>&nbsp;<span class="op" id="4246238">=</span>&nbsp;<span class="builtintype" id="4246240">byte</span><span class="op" id="4246244">(</span><span class="builtinfunc" id="4246245">len</span><span class="op" id="4246248">(</span><span class="ident" id="4246249"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246253">)</span>&nbsp;<span class="op" id="4246255">&gt;&gt;</span>&nbsp;<span class="num" id="4246258">16</span><span class="op" id="4246260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246264"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246265">[</span><span class="num" id="4246266">2</span><span class="op" id="4246267">]</span>&nbsp;<span class="op" id="4246269">=</span>&nbsp;<span class="builtintype" id="4246271">byte</span><span class="op" id="4246275">(</span><span class="builtinfunc" id="4246276">len</span><span class="op" id="4246279">(</span><span class="ident" id="4246280"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246284">)</span>&nbsp;<span class="op" id="4246286">&gt;&gt;</span>&nbsp;<span class="num" id="4246289">8</span><span class="op" id="4246290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246294"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246295">[</span><span class="num" id="4246296">3</span><span class="op" id="4246297">]</span>&nbsp;<span class="op" id="4246299">=</span>&nbsp;<span class="builtintype" id="4246301">byte</span><span class="op" id="4246305">(</span><span class="builtinfunc" id="4246306">len</span><span class="op" id="4246309">(</span><span class="ident" id="4246310"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246314">)</span><span class="op" id="4246315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4246319">copy</span><span class="op" id="4246323">(</span><span class="ident" id="4246324"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246325">[</span><span class="num" id="4246326">4</span><span class="op" id="4246327">:</span><span class="op" id="4246328">]</span><span class="op" id="4246329">,</span>&nbsp;<span class="ident" id="4246331"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246335">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246339"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span>&nbsp;<span class="op" id="4246341">=</span>&nbsp;<span class="ident" id="4246343"><a href="/crypto/tls/ticket.go.html#4245820">x</a></span><span class="op" id="4246344">[</span><span class="num" id="4246345">4</span><span class="op" id="4246346">+</span><span class="builtinfunc" id="4246347">len</span><span class="op" id="4246350">(</span><span class="ident" id="4246351"><a href="/crypto/tls/ticket.go.html#4246169">cert</a></span><span class="op" id="4246355">)</span><span class="op" id="4246356">:</span><span class="op" id="4246357">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246364">return</span>&nbsp;<span class="ident" id="4246371"><a href="/crypto/tls/ticket.go.html#4245791">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4246375">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4246378">func</span>&nbsp;<span class="op" id="4246383">(</span><span class="ident" id="4246384">s</span>&nbsp;<span class="op" id="4246386">*</span><span class="ident" id="4246387"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4246399">)</span>&nbsp;<span class="ident" id="4246401">unmarshal</span><span class="op" id="4246410">(</span><span class="ident" id="4246411">data</span>&nbsp;<span class="op" id="4246416">[</span><span class="op" id="4246417">]</span><span class="builtintype" id="4246418">byte</span><span class="op" id="4246422">)</span>&nbsp;<span class="builtintype" id="4246424">bool</span>&nbsp;<span class="op" id="4246429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246432">if</span>&nbsp;<span class="builtinfunc" id="4246435">len</span><span class="op" id="4246438">(</span><span class="ident" id="4246439"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246443">)</span>&nbsp;<span class="op" id="4246445">&lt;</span>&nbsp;<span class="num" id="4246447">8</span>&nbsp;<span class="op" id="4246449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246453">return</span>&nbsp;<span class="ident" id="4246460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246467">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246471"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4246472">.</span><span class="ident" id="4246473">vers</span>&nbsp;<span class="op" id="4246478">=</span>&nbsp;<span class="builtintype" id="4246480">uint16</span><span class="op" id="4246486">(</span><span class="ident" id="4246487"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246491">[</span><span class="num" id="4246492">0</span><span class="op" id="4246493">]</span><span class="op" id="4246494">)</span><span class="op" id="4246495">&lt;&lt;</span><span class="num" id="4246497">8</span>&nbsp;<span class="op" id="4246499">|</span>&nbsp;<span class="builtintype" id="4246501">uint16</span><span class="op" id="4246507">(</span><span class="ident" id="4246508"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246512">[</span><span class="num" id="4246513">1</span><span class="op" id="4246514">]</span><span class="op" id="4246515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246518"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4246519">.</span><span class="ident" id="4246520">cipherSuite</span>&nbsp;<span class="op" id="4246532">=</span>&nbsp;<span class="builtintype" id="4246534">uint16</span><span class="op" id="4246540">(</span><span class="ident" id="4246541"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246545">[</span><span class="num" id="4246546">2</span><span class="op" id="4246547">]</span><span class="op" id="4246548">)</span><span class="op" id="4246549">&lt;&lt;</span><span class="num" id="4246551">8</span>&nbsp;<span class="op" id="4246553">|</span>&nbsp;<span class="builtintype" id="4246555">uint16</span><span class="op" id="4246561">(</span><span class="ident" id="4246562"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246566">[</span><span class="num" id="4246567">3</span><span class="op" id="4246568">]</span><span class="op" id="4246569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246572">masterSecretLen</span>&nbsp;<span class="op" id="4246588">:=</span>&nbsp;<span class="builtintype" id="4246591">int</span><span class="op" id="4246594">(</span><span class="ident" id="4246595"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246599">[</span><span class="num" id="4246600">4</span><span class="op" id="4246601">]</span><span class="op" id="4246602">)</span><span class="op" id="4246603">&lt;&lt;</span><span class="num" id="4246605">8</span>&nbsp;<span class="op" id="4246607">|</span>&nbsp;<span class="builtintype" id="4246609">int</span><span class="op" id="4246612">(</span><span class="ident" id="4246613"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246617">[</span><span class="num" id="4246618">5</span><span class="op" id="4246619">]</span><span class="op" id="4246620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246623"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span>&nbsp;<span class="op" id="4246628">=</span>&nbsp;<span class="ident" id="4246630"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246634">[</span><span class="num" id="4246635">6</span><span class="op" id="4246636">:</span><span class="op" id="4246637">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246640">if</span>&nbsp;<span class="builtinfunc" id="4246643">len</span><span class="op" id="4246646">(</span><span class="ident" id="4246647"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246651">)</span>&nbsp;<span class="op" id="4246653">&lt;</span>&nbsp;<span class="ident" id="4246655"><a href="/crypto/tls/ticket.go.html#4246572">masterSecretLen</a></span>&nbsp;<span class="op" id="4246671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246675">return</span>&nbsp;<span class="ident" id="4246682">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246693"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4246694">.</span><span class="ident" id="4246695">masterSecret</span>&nbsp;<span class="op" id="4246708">=</span>&nbsp;<span class="ident" id="4246710"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246714">[</span><span class="op" id="4246715">:</span><span class="ident" id="4246716"><a href="/crypto/tls/ticket.go.html#4246572">masterSecretLen</a></span><span class="op" id="4246731">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246734"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span>&nbsp;<span class="op" id="4246739">=</span>&nbsp;<span class="ident" id="4246741"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246745">[</span><span class="ident" id="4246746"><a href="/crypto/tls/ticket.go.html#4246572">masterSecretLen</a></span><span class="op" id="4246761">:</span><span class="op" id="4246762">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246766">if</span>&nbsp;<span class="builtinfunc" id="4246769">len</span><span class="op" id="4246772">(</span><span class="ident" id="4246773"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246777">)</span>&nbsp;<span class="op" id="4246779">&lt;</span>&nbsp;<span class="num" id="4246781">2</span>&nbsp;<span class="op" id="4246783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246787">return</span>&nbsp;<span class="ident" id="4246794">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246801">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246805">numCerts</span>&nbsp;<span class="op" id="4246814">:=</span>&nbsp;<span class="builtintype" id="4246817">int</span><span class="op" id="4246820">(</span><span class="ident" id="4246821"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246825">[</span><span class="num" id="4246826">0</span><span class="op" id="4246827">]</span><span class="op" id="4246828">)</span><span class="op" id="4246829">&lt;&lt;</span><span class="num" id="4246831">8</span>&nbsp;<span class="op" id="4246833">|</span>&nbsp;<span class="builtintype" id="4246835">int</span><span class="op" id="4246838">(</span><span class="ident" id="4246839"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246843">[</span><span class="num" id="4246844">1</span><span class="op" id="4246845">]</span><span class="op" id="4246846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246849"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span>&nbsp;<span class="op" id="4246854">=</span>&nbsp;<span class="ident" id="4246856"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246860">[</span><span class="num" id="4246861">2</span><span class="op" id="4246862">:</span><span class="op" id="4246863">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246867"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4246868">.</span><span class="ident" id="4246869">certificates</span>&nbsp;<span class="op" id="4246882">=</span>&nbsp;<span class="builtinfunc" id="4246884">make</span><span class="op" id="4246888">(</span><span class="op" id="4246889">[</span><span class="op" id="4246890">]</span><span class="op" id="4246891">[</span><span class="op" id="4246892">]</span><span class="builtintype" id="4246893">byte</span><span class="op" id="4246897">,</span>&nbsp;<span class="ident" id="4246899"><a href="/crypto/tls/ticket.go.html#4246805">numCerts</a></span><span class="op" id="4246907">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246910">for</span>&nbsp;<span class="ident" id="4246914">i</span>&nbsp;<span class="op" id="4246916">:=</span>&nbsp;<span class="keyword" id="4246919">range</span>&nbsp;<span class="ident" id="4246925"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4246926">.</span><span class="ident" id="4246927">certificates</span>&nbsp;<span class="op" id="4246940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246944">if</span>&nbsp;<span class="builtinfunc" id="4246947">len</span><span class="op" id="4246950">(</span><span class="ident" id="4246951"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4246955">)</span>&nbsp;<span class="op" id="4246957">&lt;</span>&nbsp;<span class="num" id="4246959">4</span>&nbsp;<span class="op" id="4246961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4246966">return</span>&nbsp;<span class="ident" id="4246973">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4246981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4246985">certLen</span>&nbsp;<span class="op" id="4246993">:=</span>&nbsp;<span class="builtintype" id="4246996">int</span><span class="op" id="4246999">(</span><span class="ident" id="4247000"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247004">[</span><span class="num" id="4247005">0</span><span class="op" id="4247006">]</span><span class="op" id="4247007">)</span><span class="op" id="4247008">&lt;&lt;</span><span class="num" id="4247010">24</span>&nbsp;<span class="op" id="4247013">|</span>&nbsp;<span class="builtintype" id="4247015">int</span><span class="op" id="4247018">(</span><span class="ident" id="4247019"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247023">[</span><span class="num" id="4247024">1</span><span class="op" id="4247025">]</span><span class="op" id="4247026">)</span><span class="op" id="4247027">&lt;&lt;</span><span class="num" id="4247029">16</span>&nbsp;<span class="op" id="4247032">|</span>&nbsp;<span class="builtintype" id="4247034">int</span><span class="op" id="4247037">(</span><span class="ident" id="4247038"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247042">[</span><span class="num" id="4247043">2</span><span class="op" id="4247044">]</span><span class="op" id="4247045">)</span><span class="op" id="4247046">&lt;&lt;</span><span class="num" id="4247048">8</span>&nbsp;<span class="op" id="4247050">|</span>&nbsp;<span class="builtintype" id="4247052">int</span><span class="op" id="4247055">(</span><span class="ident" id="4247056"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247060">[</span><span class="num" id="4247061">3</span><span class="op" id="4247062">]</span><span class="op" id="4247063">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247067"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span>&nbsp;<span class="op" id="4247072">=</span>&nbsp;<span class="ident" id="4247074"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247078">[</span><span class="num" id="4247079">4</span><span class="op" id="4247080">:</span><span class="op" id="4247081">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247085">if</span>&nbsp;<span class="ident" id="4247088"><a href="/crypto/tls/ticket.go.html#4246985">certLen</a></span>&nbsp;<span class="op" id="4247096">&lt;</span>&nbsp;<span class="num" id="4247098">0</span>&nbsp;<span class="op" id="4247100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247105">return</span>&nbsp;<span class="ident" id="4247112">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247124">if</span>&nbsp;<span class="builtinfunc" id="4247127">len</span><span class="op" id="4247130">(</span><span class="ident" id="4247131"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247135">)</span>&nbsp;<span class="op" id="4247137">&lt;</span>&nbsp;<span class="ident" id="4247139"><a href="/crypto/tls/ticket.go.html#4246985">certLen</a></span>&nbsp;<span class="op" id="4247147">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247152">return</span>&nbsp;<span class="ident" id="4247159">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247171"><a href="/crypto/tls/ticket.go.html#4246384">s</a></span><span class="op" id="4247172">.</span><span class="ident" id="4247173">certificates</span><span class="op" id="4247185">[</span><span class="ident" id="4247186"><a href="/crypto/tls/ticket.go.html#4246914">i</a></span><span class="op" id="4247187">]</span>&nbsp;<span class="op" id="4247189">=</span>&nbsp;<span class="ident" id="4247191"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247195">[</span><span class="op" id="4247196">:</span><span class="ident" id="4247197"><a href="/crypto/tls/ticket.go.html#4246985">certLen</a></span><span class="op" id="4247204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247208"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span>&nbsp;<span class="op" id="4247213">=</span>&nbsp;<span class="ident" id="4247215"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247219">[</span><span class="ident" id="4247220"><a href="/crypto/tls/ticket.go.html#4246985">certLen</a></span><span class="op" id="4247227">:</span><span class="op" id="4247228">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247231">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247235">if</span>&nbsp;<span class="builtinfunc" id="4247238">len</span><span class="op" id="4247241">(</span><span class="ident" id="4247242"><a href="/crypto/tls/ticket.go.html#4246411">data</a></span><span class="op" id="4247246">)</span>&nbsp;<span class="op" id="4247248">&gt;</span>&nbsp;<span class="num" id="4247250">0</span>&nbsp;<span class="op" id="4247252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247256">return</span>&nbsp;<span class="ident" id="4247263">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247274">return</span>&nbsp;<span class="ident" id="4247281">true</span><br>
<span class="lineno"></span><span class="op" id="4247286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4247289">func</span>&nbsp;<span class="op" id="4247294">(</span><span class="ident" id="4247295">c</span>&nbsp;<span class="op" id="4247297">*</span><span class="ident" id="4247298"><a href="/crypto/tls/conn.go.html#4127599">Conn</a></span><span class="op" id="4247302">)</span>&nbsp;<span class="ident" id="4247304">encryptTicket</span><span class="op" id="4247317">(</span><span class="ident" id="4247318">state</span>&nbsp;<span class="op" id="4247324">*</span><span class="ident" id="4247325"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4247337">)</span>&nbsp;<span class="op" id="4247339">(</span><span class="op" id="4247340">[</span><span class="op" id="4247341">]</span><span class="builtintype" id="4247342">byte</span><span class="op" id="4247346">,</span>&nbsp;<span class="builtintype" id="4247348">error</span><span class="op" id="4247353">)</span>&nbsp;<span class="op" id="4247355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247358">serialized</span>&nbsp;<span class="op" id="4247369">:=</span>&nbsp;<span class="ident" id="4247372"><a href="/crypto/tls/ticket.go.html#4247318">state</a></span><span class="op" id="4247377">.</span><span class="ident" id="4247378">marshal</span><span class="op" id="4247385">(</span><span class="op" id="4247386">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247389">encrypted</span>&nbsp;<span class="op" id="4247399">:=</span>&nbsp;<span class="builtinfunc" id="4247402">make</span><span class="op" id="4247406">(</span><span class="op" id="4247407">[</span><span class="op" id="4247408">]</span><span class="builtintype" id="4247409">byte</span><span class="op" id="4247413">,</span>&nbsp;<span class="ident" id="4247415"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4247418">.</span><span class="ident" id="4247419">BlockSize</span><span class="op" id="4247428">+</span><span class="builtinfunc" id="4247429">len</span><span class="op" id="4247432">(</span><span class="ident" id="4247433"><a href="/crypto/tls/ticket.go.html#4247358">serialized</a></span><span class="op" id="4247443">)</span><span class="op" id="4247444">+</span><span class="ident" id="4247445"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4247451">.</span><span class="ident" id="4247452">Size</span><span class="op" id="4247456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247459">iv</span>&nbsp;<span class="op" id="4247462">:=</span>&nbsp;<span class="ident" id="4247465"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247474">[</span><span class="op" id="4247475">:</span><span class="ident" id="4247476"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4247479">.</span><span class="ident" id="4247480">BlockSize</span><span class="op" id="4247489">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247492">macBytes</span>&nbsp;<span class="op" id="4247501">:=</span>&nbsp;<span class="ident" id="4247504"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247513">[</span><span class="builtinfunc" id="4247514">len</span><span class="op" id="4247517">(</span><span class="ident" id="4247518"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247527">)</span><span class="op" id="4247528">-</span><span class="ident" id="4247529"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4247535">.</span><span class="ident" id="4247536">Size</span><span class="op" id="4247540">:</span><span class="op" id="4247541">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247545">if</span>&nbsp;<span class="ident" id="4247548">_</span><span class="op" id="4247549">,</span>&nbsp;<span class="ident" id="4247551">err</span>&nbsp;<span class="op" id="4247555">:=</span>&nbsp;<span class="ident" id="4247558"><a href="/crypto/tls/ticket.go.html#4244943">io</a></span><span class="op" id="4247560">.</span><span class="ident" id="4247561">ReadFull</span><span class="op" id="4247569">(</span><span class="ident" id="4247570"><a href="/crypto/tls/ticket.go.html#4247295">c</a></span><span class="op" id="4247571">.</span><span class="ident" id="4247572">config</span><span class="op" id="4247578">.</span><span class="ident" id="4247579">rand</span><span class="op" id="4247583">(</span><span class="op" id="4247584">)</span><span class="op" id="4247585">,</span>&nbsp;<span class="ident" id="4247587"><a href="/crypto/tls/ticket.go.html#4247459">iv</a></span><span class="op" id="4247589">)</span><span class="op" id="4247590">;</span>&nbsp;<span class="ident" id="4247592"><a href="/crypto/tls/ticket.go.html#4247551">err</a></span>&nbsp;<span class="op" id="4247596">!=</span>&nbsp;<span class="ident" id="4247599">nil</span>&nbsp;<span class="op" id="4247603">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247607">return</span>&nbsp;<span class="ident" id="4247614">nil</span><span class="op" id="4247617">,</span>&nbsp;<span class="ident" id="4247619"><a href="/crypto/tls/ticket.go.html#4247551">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247627">block</span><span class="op" id="4247632">,</span>&nbsp;<span class="ident" id="4247634">err</span>&nbsp;<span class="op" id="4247638">:=</span>&nbsp;<span class="ident" id="4247641"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4247644">.</span><span class="ident" id="4247645">NewCipher</span><span class="op" id="4247654">(</span><span class="ident" id="4247655"><a href="/crypto/tls/ticket.go.html#4247295">c</a></span><span class="op" id="4247656">.</span><span class="ident" id="4247657">config</span><span class="op" id="4247663">.</span><span class="ident" id="4247664">SessionTicketKey</span><span class="op" id="4247680">[</span><span class="op" id="4247681">:</span><span class="num" id="4247682">16</span><span class="op" id="4247684">]</span><span class="op" id="4247685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247688">if</span>&nbsp;<span class="ident" id="4247691"><a href="/crypto/tls/ticket.go.html#4247634">err</a></span>&nbsp;<span class="op" id="4247695">!=</span>&nbsp;<span class="ident" id="4247698">nil</span>&nbsp;<span class="op" id="4247702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4247706">return</span>&nbsp;<span class="ident" id="4247713">nil</span><span class="op" id="4247716">,</span>&nbsp;<span class="ident" id="4247718"><a href="/crypto/tls/ticket.go.html#4244933">errors</a></span><span class="op" id="4247724">.</span><span class="ident" id="4247725">New</span><span class="op" id="4247728">(</span><span class="string" id="4247729">&#34;tls:&nbsp;failed&nbsp;to&nbsp;create&nbsp;cipher&nbsp;while&nbsp;encrypting&nbsp;ticket:&nbsp;&#34;</span>&nbsp;<span class="op" id="4247786">+</span>&nbsp;<span class="ident" id="4247788"><a href="/crypto/tls/ticket.go.html#4247634">err</a></span><span class="op" id="4247791">.</span><span class="ident" id="4247792">Error</span><span class="op" id="4247797">(</span><span class="op" id="4247798">)</span><span class="op" id="4247799">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4247802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247805"><a href="/crypto/tls/ticket.go.html#4244867">cipher</a></span><span class="op" id="4247811">.</span><span class="ident" id="4247812">NewCTR</span><span class="op" id="4247818">(</span><span class="ident" id="4247819"><a href="/crypto/tls/ticket.go.html#4247627">block</a></span><span class="op" id="4247824">,</span>&nbsp;<span class="ident" id="4247826"><a href="/crypto/tls/ticket.go.html#4247459">iv</a></span><span class="op" id="4247828">)</span><span class="op" id="4247829">.</span><span class="ident" id="4247830">XORKeyStream</span><span class="op" id="4247842">(</span><span class="ident" id="4247843"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247852">[</span><span class="ident" id="4247853"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4247856">.</span><span class="ident" id="4247857">BlockSize</span><span class="op" id="4247866">:</span><span class="op" id="4247867">]</span><span class="op" id="4247868">,</span>&nbsp;<span class="ident" id="4247870"><a href="/crypto/tls/ticket.go.html#4247358">serialized</a></span><span class="op" id="4247880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247884">mac</span>&nbsp;<span class="op" id="4247888">:=</span>&nbsp;<span class="ident" id="4247891"><a href="/crypto/tls/ticket.go.html#4244884">hmac</a></span><span class="op" id="4247895">.</span><span class="ident" id="4247896">New</span><span class="op" id="4247899">(</span><span class="ident" id="4247900"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4247906">.</span><span class="ident" id="4247907">New</span><span class="op" id="4247910">,</span>&nbsp;<span class="ident" id="4247912"><a href="/crypto/tls/ticket.go.html#4247295">c</a></span><span class="op" id="4247913">.</span><span class="ident" id="4247914">config</span><span class="op" id="4247920">.</span><span class="ident" id="4247921">SessionTicketKey</span><span class="op" id="4247937">[</span><span class="num" id="4247938">16</span><span class="op" id="4247940">:</span><span class="num" id="4247941">32</span><span class="op" id="4247943">]</span><span class="op" id="4247944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247947"><a href="/crypto/tls/ticket.go.html#4247884">mac</a></span><span class="op" id="4247950">.</span><span class="ident" id="4247951">Write</span><span class="op" id="4247956">(</span><span class="ident" id="4247957"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247966">[</span><span class="op" id="4247967">:</span><span class="builtinfunc" id="4247968">len</span><span class="op" id="4247971">(</span><span class="ident" id="4247972"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4247981">)</span><span class="op" id="4247982">-</span><span class="ident" id="4247983"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4247989">.</span><span class="ident" id="4247990">Size</span><span class="op" id="4247994">]</span><span class="op" id="4247995">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4247998"><a href="/crypto/tls/ticket.go.html#4247884">mac</a></span><span class="op" id="4248001">.</span><span class="ident" id="4248002">Sum</span><span class="op" id="4248005">(</span><span class="ident" id="4248006"><a href="/crypto/tls/ticket.go.html#4247492">macBytes</a></span><span class="op" id="4248014">[</span><span class="op" id="4248015">:</span><span class="num" id="4248016">0</span><span class="op" id="4248017">]</span><span class="op" id="4248018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248022">return</span>&nbsp;<span class="ident" id="4248029"><a href="/crypto/tls/ticket.go.html#4247389">encrypted</a></span><span class="op" id="4248038">,</span>&nbsp;<span class="ident" id="4248040">nil</span><br>
<span class="lineno"></span><span class="op" id="4248044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="4248047">func</span>&nbsp;<span class="op" id="4248052">(</span><span class="ident" id="4248053">c</span>&nbsp;<span class="op" id="4248055">*</span><span class="ident" id="4248056"><a href="/crypto/tls/conn.go.html#4127599">Conn</a></span><span class="op" id="4248060">)</span>&nbsp;<span class="ident" id="4248062">decryptTicket</span><span class="op" id="4248075">(</span><span class="ident" id="4248076">encrypted</span>&nbsp;<span class="op" id="4248086">[</span><span class="op" id="4248087">]</span><span class="builtintype" id="4248088">byte</span><span class="op" id="4248092">)</span>&nbsp;<span class="op" id="4248094">(</span><span class="op" id="4248095">*</span><span class="ident" id="4248096"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4248108">,</span>&nbsp;<span class="builtintype" id="4248110">bool</span><span class="op" id="4248114">)</span>&nbsp;<span class="op" id="4248116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248119">if</span>&nbsp;<span class="ident" id="4248122"><a href="/crypto/tls/ticket.go.html#4248053">c</a></span><span class="op" id="4248123">.</span><span class="ident" id="4248124">config</span><span class="op" id="4248130">.</span><span class="ident" id="4248131">SessionTicketsDisabled</span>&nbsp;<span class="op" id="4248154">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4248159">len</span><span class="op" id="4248162">(</span><span class="ident" id="4248163"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248172">)</span>&nbsp;<span class="op" id="4248174">&lt;</span>&nbsp;<span class="ident" id="4248176"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4248179">.</span><span class="ident" id="4248180">BlockSize</span><span class="op" id="4248189">+</span><span class="ident" id="4248190"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4248196">.</span><span class="ident" id="4248197">Size</span>&nbsp;<span class="op" id="4248202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248206">return</span>&nbsp;<span class="ident" id="4248213">nil</span><span class="op" id="4248216">,</span>&nbsp;<span class="ident" id="4248218">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4248225">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248229">iv</span>&nbsp;<span class="op" id="4248232">:=</span>&nbsp;<span class="ident" id="4248235"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248244">[</span><span class="op" id="4248245">:</span><span class="ident" id="4248246"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4248249">.</span><span class="ident" id="4248250">BlockSize</span><span class="op" id="4248259">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248262">macBytes</span>&nbsp;<span class="op" id="4248271">:=</span>&nbsp;<span class="ident" id="4248274"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248283">[</span><span class="builtinfunc" id="4248284">len</span><span class="op" id="4248287">(</span><span class="ident" id="4248288"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248297">)</span><span class="op" id="4248298">-</span><span class="ident" id="4248299"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4248305">.</span><span class="ident" id="4248306">Size</span><span class="op" id="4248310">:</span><span class="op" id="4248311">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248315">mac</span>&nbsp;<span class="op" id="4248319">:=</span>&nbsp;<span class="ident" id="4248322"><a href="/crypto/tls/ticket.go.html#4244884">hmac</a></span><span class="op" id="4248326">.</span><span class="ident" id="4248327">New</span><span class="op" id="4248330">(</span><span class="ident" id="4248331"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4248337">.</span><span class="ident" id="4248338">New</span><span class="op" id="4248341">,</span>&nbsp;<span class="ident" id="4248343"><a href="/crypto/tls/ticket.go.html#4248053">c</a></span><span class="op" id="4248344">.</span><span class="ident" id="4248345">config</span><span class="op" id="4248351">.</span><span class="ident" id="4248352">SessionTicketKey</span><span class="op" id="4248368">[</span><span class="num" id="4248369">16</span><span class="op" id="4248371">:</span><span class="num" id="4248372">32</span><span class="op" id="4248374">]</span><span class="op" id="4248375">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248378"><a href="/crypto/tls/ticket.go.html#4248315">mac</a></span><span class="op" id="4248381">.</span><span class="ident" id="4248382">Write</span><span class="op" id="4248387">(</span><span class="ident" id="4248388"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248397">[</span><span class="op" id="4248398">:</span><span class="builtinfunc" id="4248399">len</span><span class="op" id="4248402">(</span><span class="ident" id="4248403"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248412">)</span><span class="op" id="4248413">-</span><span class="ident" id="4248414"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4248420">.</span><span class="ident" id="4248421">Size</span><span class="op" id="4248425">]</span><span class="op" id="4248426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248429">expected</span>&nbsp;<span class="op" id="4248438">:=</span>&nbsp;<span class="ident" id="4248441"><a href="/crypto/tls/ticket.go.html#4248315">mac</a></span><span class="op" id="4248444">.</span><span class="ident" id="4248445">Sum</span><span class="op" id="4248448">(</span><span class="ident" id="4248449">nil</span><span class="op" id="4248452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248456">if</span>&nbsp;<span class="ident" id="4248459"><a href="/crypto/tls/ticket.go.html#4244916">subtle</a></span><span class="op" id="4248465">.</span><span class="ident" id="4248466">ConstantTimeCompare</span><span class="op" id="4248485">(</span><span class="ident" id="4248486"><a href="/crypto/tls/ticket.go.html#4248262">macBytes</a></span><span class="op" id="4248494">,</span>&nbsp;<span class="ident" id="4248496"><a href="/crypto/tls/ticket.go.html#4248429">expected</a></span><span class="op" id="4248504">)</span>&nbsp;<span class="op" id="4248506">!=</span>&nbsp;<span class="num" id="4248509">1</span>&nbsp;<span class="op" id="4248511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248515">return</span>&nbsp;<span class="ident" id="4248522">nil</span><span class="op" id="4248525">,</span>&nbsp;<span class="ident" id="4248527">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4248534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248538">block</span><span class="op" id="4248543">,</span>&nbsp;<span class="ident" id="4248545">err</span>&nbsp;<span class="op" id="4248549">:=</span>&nbsp;<span class="ident" id="4248552"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4248555">.</span><span class="ident" id="4248556">NewCipher</span><span class="op" id="4248565">(</span><span class="ident" id="4248566"><a href="/crypto/tls/ticket.go.html#4248053">c</a></span><span class="op" id="4248567">.</span><span class="ident" id="4248568">config</span><span class="op" id="4248574">.</span><span class="ident" id="4248575">SessionTicketKey</span><span class="op" id="4248591">[</span><span class="op" id="4248592">:</span><span class="num" id="4248593">16</span><span class="op" id="4248595">]</span><span class="op" id="4248596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248599">if</span>&nbsp;<span class="ident" id="4248602"><a href="/crypto/tls/ticket.go.html#4248545">err</a></span>&nbsp;<span class="op" id="4248606">!=</span>&nbsp;<span class="ident" id="4248609">nil</span>&nbsp;<span class="op" id="4248613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248617">return</span>&nbsp;<span class="ident" id="4248624">nil</span><span class="op" id="4248627">,</span>&nbsp;<span class="ident" id="4248629">false</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4248636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248639">ciphertext</span>&nbsp;<span class="op" id="4248650">:=</span>&nbsp;<span class="ident" id="4248653"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248662">[</span><span class="ident" id="4248663"><a href="/crypto/tls/ticket.go.html#4244853">aes</a></span><span class="op" id="4248666">.</span><span class="ident" id="4248667">BlockSize</span>&nbsp;<span class="op" id="4248677">:</span>&nbsp;<span class="builtinfunc" id="4248679">len</span><span class="op" id="4248682">(</span><span class="ident" id="4248683"><a href="/crypto/tls/ticket.go.html#4248076">encrypted</a></span><span class="op" id="4248692">)</span><span class="op" id="4248693">-</span><span class="ident" id="4248694"><a href="/crypto/tls/ticket.go.html#4244899">sha256</a></span><span class="op" id="4248700">.</span><span class="ident" id="4248701">Size</span><span class="op" id="4248705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248708">plaintext</span>&nbsp;<span class="op" id="4248718">:=</span>&nbsp;<span class="ident" id="4248721"><a href="/crypto/tls/ticket.go.html#4248639">ciphertext</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248733"><a href="/crypto/tls/ticket.go.html#4244867">cipher</a></span><span class="op" id="4248739">.</span><span class="ident" id="4248740">NewCTR</span><span class="op" id="4248746">(</span><span class="ident" id="4248747"><a href="/crypto/tls/ticket.go.html#4248538">block</a></span><span class="op" id="4248752">,</span>&nbsp;<span class="ident" id="4248754"><a href="/crypto/tls/ticket.go.html#4248229">iv</a></span><span class="op" id="4248756">)</span><span class="op" id="4248757">.</span><span class="ident" id="4248758">XORKeyStream</span><span class="op" id="4248770">(</span><span class="ident" id="4248771"><a href="/crypto/tls/ticket.go.html#4248708">plaintext</a></span><span class="op" id="4248780">,</span>&nbsp;<span class="ident" id="4248782"><a href="/crypto/tls/ticket.go.html#4248639">ciphertext</a></span><span class="op" id="4248792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248796">state</span>&nbsp;<span class="op" id="4248802">:=</span>&nbsp;<span class="builtinfunc" id="4248805">new</span><span class="op" id="4248808">(</span><span class="ident" id="4248809"><a href="/crypto/tls/ticket.go.html#4245080">sessionState</a></span><span class="op" id="4248821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4248824">ok</span>&nbsp;<span class="op" id="4248827">:=</span>&nbsp;<span class="ident" id="4248830"><a href="/crypto/tls/ticket.go.html#4248796">state</a></span><span class="op" id="4248835">.</span><span class="ident" id="4248836">unmarshal</span><span class="op" id="4248845">(</span><span class="ident" id="4248846"><a href="/crypto/tls/ticket.go.html#4248708">plaintext</a></span><span class="op" id="4248855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4248858">return</span>&nbsp;<span class="ident" id="4248865"><a href="/crypto/tls/ticket.go.html#4248796">state</a></span><span class="op" id="4248870">,</span>&nbsp;<span class="ident" id="4248872"><a href="/crypto/tls/ticket.go.html#4248824">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4248875">}</span>
</div>
</body>
</html>
