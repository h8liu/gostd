<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2270205">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2270260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2270314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2270365">package</span>&nbsp;<span class="ident" id="2270373">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2270379">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2270429">//</span><br>
<span class="lineno"></span><span class="comment" id="2270432">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2270454">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2270474">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2270492">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2270536">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2270573">func</span>&nbsp;<span class="ident" id="2270578">Exp</span><span class="op" id="2270581">(</span><span class="ident" id="2270582">x</span>&nbsp;<span class="builtintype" id="2270584">float64</span><span class="op" id="2270591">)</span>&nbsp;<span class="builtintype" id="2270593">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2270602">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2270662">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2270720">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2270779">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2270809">//</span><br>
<span class="lineno"></span><span class="comment" id="2270812">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2270868">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2270937">//</span><br>
<span class="lineno"></span><span class="comment" id="2270940">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2270996">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2271053">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2271070">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2271126">//</span><br>
<span class="lineno"></span><span class="comment" id="2271129">//</span><br>
<span class="lineno">30</span><span class="comment" id="2271132">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2271142">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2271175">//</span><br>
<span class="lineno"></span><span class="comment" id="2271178">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2271188">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2271216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2271275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2271323">//</span><br>
<span class="lineno"></span><span class="comment" id="2271326">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2271375">//</span><br>
<span class="lineno">40</span><span class="comment" id="2271378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2271437">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2271455">//</span><br>
<span class="lineno"></span><span class="comment" id="2271458">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2271524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2271558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2271572">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2271647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2271715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2271784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2271850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2271871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2271941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2272008">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2272020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2272072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2272121">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2272165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2272212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2272247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2272284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2272320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2272363">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2272430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2272474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2272488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2272546">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2272607">//</span><br>
<span class="lineno"></span><span class="comment" id="2272610">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2272647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2272676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2272710">//</span><br>
<span class="lineno"></span><span class="comment" id="2272713">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2272731">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2272773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2272801">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2272854">//</span><br>
<span class="lineno"></span><span class="comment" id="2272857">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2272870">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2272940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2272980">//</span><br>
<span class="lineno"></span><span class="comment" id="2272983">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2272998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2273022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2273090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2273159">//</span><br>
<span class="lineno"></span><span class="comment" id="2273162">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2273176">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2273242">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2273306">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2273372">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2273417">func</span>&nbsp;<span class="ident" id="2273422">exp</span><span class="op" id="2273425">(</span><span class="ident" id="2273426">x</span>&nbsp;<span class="builtintype" id="2273428">float64</span><span class="op" id="2273435">)</span>&nbsp;<span class="builtintype" id="2273437">float64</span>&nbsp;<span class="op" id="2273445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273448">const</span>&nbsp;<span class="op" id="2273454">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273458">Ln2Hi</span>&nbsp;<span class="op" id="2273464">=</span>&nbsp;<span class="num" id="2273466">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273495">Ln2Lo</span>&nbsp;<span class="op" id="2273501">=</span>&nbsp;<span class="num" id="2273503">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273532">Log2e</span>&nbsp;<span class="op" id="2273538">=</span>&nbsp;<span class="num" id="2273540">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273570">Overflow</span>&nbsp;&nbsp;<span class="op" id="2273580">=</span>&nbsp;<span class="num" id="2273582">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273611">Underflow</span>&nbsp;<span class="op" id="2273621">=</span>&nbsp;<span class="op" id="2273623">-</span><span class="num" id="2273624">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2273653">NearZero</span>&nbsp;&nbsp;<span class="op" id="2273663">=</span>&nbsp;<span class="num" id="2273665">1.0</span>&nbsp;<span class="op" id="2273669">/</span>&nbsp;<span class="op" id="2273671">(</span><span class="num" id="2273672">1</span>&nbsp;<span class="op" id="2273674">&lt;&lt;</span>&nbsp;<span class="num" id="2273677">28</span><span class="op" id="2273679">)</span>&nbsp;<span class="comment" id="2273681">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273696">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273714">switch</span>&nbsp;<span class="op" id="2273721">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273724">case</span>&nbsp;<span class="ident" id="2273729"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2273734">(</span><span class="ident" id="2273735"><a href="/math/exp.go.html#2273426">x</a></span><span class="op" id="2273736">)</span>&nbsp;<span class="op" id="2273738">||</span>&nbsp;<span class="ident" id="2273741"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2273746">(</span><span class="ident" id="2273747"><a href="/math/exp.go.html#2273426">x</a></span><span class="op" id="2273748">,</span>&nbsp;<span class="num" id="2273750">1</span><span class="op" id="2273751">)</span><span class="op" id="2273752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273756">return</span>&nbsp;<span class="ident" id="2273763"><a href="/math/exp.go.html#2273426">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273766">case</span>&nbsp;<span class="ident" id="2273771"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2273776">(</span><span class="ident" id="2273777"><a href="/math/exp.go.html#2273426">x</a></span><span class="op" id="2273778">,</span>&nbsp;<span class="op" id="2273780">-</span><span class="num" id="2273781">1</span><span class="op" id="2273782">)</span><span class="op" id="2273783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273787">return</span>&nbsp;<span class="num" id="2273794">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273797">case</span>&nbsp;<span class="ident" id="2273802"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2273804">&gt;</span>&nbsp;<span class="ident" id="2273806"><a href="/math/exp.go.html#2273570">Overflow</a></span><span class="op" id="2273814">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273818">return</span>&nbsp;<span class="ident" id="2273825"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2273828">(</span><span class="num" id="2273829">1</span><span class="op" id="2273830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273833">case</span>&nbsp;<span class="ident" id="2273838"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2273840">&lt;</span>&nbsp;<span class="ident" id="2273842"><a href="/math/exp.go.html#2273611">Underflow</a></span><span class="op" id="2273851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273855">return</span>&nbsp;<span class="num" id="2273862">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273865">case</span>&nbsp;<span class="op" id="2273870">-</span><span class="ident" id="2273871"><a href="/math/exp.go.html#2273653">NearZero</a></span>&nbsp;<span class="op" id="2273880">&lt;</span>&nbsp;<span class="ident" id="2273882"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2273884">&amp;&amp;</span>&nbsp;<span class="ident" id="2273887"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2273889">&lt;</span>&nbsp;<span class="ident" id="2273891"><a href="/math/exp.go.html#2273653">NearZero</a></span><span class="op" id="2273899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273903">return</span>&nbsp;<span class="num" id="2273910">1</span>&nbsp;<span class="op" id="2273912">+</span>&nbsp;<span class="ident" id="2273914"><a href="/math/exp.go.html#2273426">x</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2273917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2273921">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273978">var</span>&nbsp;<span class="ident" id="2273982">k</span>&nbsp;<span class="builtintype" id="2273984">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273989">switch</span>&nbsp;<span class="op" id="2273996">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2273999">case</span>&nbsp;<span class="ident" id="2274004"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2274006">&lt;</span>&nbsp;<span class="num" id="2274008">0</span><span class="op" id="2274009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274013"><a href="/math/exp.go.html#2273982">k</a></span>&nbsp;<span class="op" id="2274015">=</span>&nbsp;<span class="builtintype" id="2274017">int</span><span class="op" id="2274020">(</span><span class="ident" id="2274021"><a href="/math/exp.go.html#2273532">Log2e</a></span><span class="op" id="2274026">*</span><span class="ident" id="2274027"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2274029">-</span>&nbsp;<span class="num" id="2274031">0.5</span><span class="op" id="2274034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274037">case</span>&nbsp;<span class="ident" id="2274042"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2274044">&gt;</span>&nbsp;<span class="num" id="2274046">0</span><span class="op" id="2274047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274051"><a href="/math/exp.go.html#2273982">k</a></span>&nbsp;<span class="op" id="2274053">=</span>&nbsp;<span class="builtintype" id="2274055">int</span><span class="op" id="2274058">(</span><span class="ident" id="2274059"><a href="/math/exp.go.html#2273532">Log2e</a></span><span class="op" id="2274064">*</span><span class="ident" id="2274065"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2274067">+</span>&nbsp;<span class="num" id="2274069">0.5</span><span class="op" id="2274072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274075">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274078">hi</span>&nbsp;<span class="op" id="2274081">:=</span>&nbsp;<span class="ident" id="2274084"><a href="/math/exp.go.html#2273426">x</a></span>&nbsp;<span class="op" id="2274086">-</span>&nbsp;<span class="builtintype" id="2274088">float64</span><span class="op" id="2274095">(</span><span class="ident" id="2274096"><a href="/math/exp.go.html#2273982">k</a></span><span class="op" id="2274097">)</span><span class="op" id="2274098">*</span><span class="ident" id="2274099"><a href="/math/exp.go.html#2273458">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274106">lo</span>&nbsp;<span class="op" id="2274109">:=</span>&nbsp;<span class="builtintype" id="2274112">float64</span><span class="op" id="2274119">(</span><span class="ident" id="2274120"><a href="/math/exp.go.html#2273982">k</a></span><span class="op" id="2274121">)</span>&nbsp;<span class="op" id="2274123">*</span>&nbsp;<span class="ident" id="2274125"><a href="/math/exp.go.html#2273495">Ln2Lo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274133">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274145">return</span>&nbsp;<span class="ident" id="2274152"><a href="/math/exp.go.html#2275025">expmulti</a></span><span class="op" id="2274160">(</span><span class="ident" id="2274161"><a href="/math/exp.go.html#2274078">hi</a></span><span class="op" id="2274163">,</span>&nbsp;<span class="ident" id="2274165"><a href="/math/exp.go.html#2274106">lo</a></span><span class="op" id="2274167">,</span>&nbsp;<span class="ident" id="2274169"><a href="/math/exp.go.html#2273982">k</a></span><span class="op" id="2274170">)</span><br>
<span class="lineno">130</span><span class="op" id="2274172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2274175">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2274226">//</span><br>
<span class="lineno"></span><span class="comment" id="2274229">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2274267">func</span>&nbsp;<span class="ident" id="2274272">Exp2</span><span class="op" id="2274276">(</span><span class="ident" id="2274277">x</span>&nbsp;<span class="builtintype" id="2274279">float64</span><span class="op" id="2274286">)</span>&nbsp;<span class="builtintype" id="2274288">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2274297">func</span>&nbsp;<span class="ident" id="2274302">exp2</span><span class="op" id="2274306">(</span><span class="ident" id="2274307">x</span>&nbsp;<span class="builtintype" id="2274309">float64</span><span class="op" id="2274316">)</span>&nbsp;<span class="builtintype" id="2274318">float64</span>&nbsp;<span class="op" id="2274326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274329">const</span>&nbsp;<span class="op" id="2274335">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274339">Ln2Hi</span>&nbsp;<span class="op" id="2274345">=</span>&nbsp;<span class="num" id="2274347">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274376">Ln2Lo</span>&nbsp;<span class="op" id="2274382">=</span>&nbsp;<span class="num" id="2274384">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274414">Overflow</span>&nbsp;&nbsp;<span class="op" id="2274424">=</span>&nbsp;<span class="num" id="2274426">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274451">Underflow</span>&nbsp;<span class="op" id="2274461">=</span>&nbsp;<span class="op" id="2274463">-</span><span class="num" id="2274464">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274476">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274480">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274498">switch</span>&nbsp;<span class="op" id="2274505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274508">case</span>&nbsp;<span class="ident" id="2274513"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2274518">(</span><span class="ident" id="2274519"><a href="/math/exp.go.html#2274307">x</a></span><span class="op" id="2274520">)</span>&nbsp;<span class="op" id="2274522">||</span>&nbsp;<span class="ident" id="2274525"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2274530">(</span><span class="ident" id="2274531"><a href="/math/exp.go.html#2274307">x</a></span><span class="op" id="2274532">,</span>&nbsp;<span class="num" id="2274534">1</span><span class="op" id="2274535">)</span><span class="op" id="2274536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274540">return</span>&nbsp;<span class="ident" id="2274547"><a href="/math/exp.go.html#2274307">x</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274550">case</span>&nbsp;<span class="ident" id="2274555"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2274560">(</span><span class="ident" id="2274561"><a href="/math/exp.go.html#2274307">x</a></span><span class="op" id="2274562">,</span>&nbsp;<span class="op" id="2274564">-</span><span class="num" id="2274565">1</span><span class="op" id="2274566">)</span><span class="op" id="2274567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274571">return</span>&nbsp;<span class="num" id="2274578">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274581">case</span>&nbsp;<span class="ident" id="2274586"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274588">&gt;</span>&nbsp;<span class="ident" id="2274590"><a href="/math/exp.go.html#2274414">Overflow</a></span><span class="op" id="2274598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274602">return</span>&nbsp;<span class="ident" id="2274609"><a href="/math/bits.go.html#2251765">Inf</a></span><span class="op" id="2274612">(</span><span class="num" id="2274613">1</span><span class="op" id="2274614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274617">case</span>&nbsp;<span class="ident" id="2274622"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274624">&lt;</span>&nbsp;<span class="ident" id="2274626"><a href="/math/exp.go.html#2274451">Underflow</a></span><span class="op" id="2274635">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274639">return</span>&nbsp;<span class="num" id="2274646">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274653">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274716">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274765">var</span>&nbsp;<span class="ident" id="2274769">k</span>&nbsp;<span class="builtintype" id="2274771">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274776">switch</span>&nbsp;<span class="op" id="2274783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274786">case</span>&nbsp;<span class="ident" id="2274791"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274793">&gt;</span>&nbsp;<span class="num" id="2274795">0</span><span class="op" id="2274796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274800"><a href="/math/exp.go.html#2274769">k</a></span>&nbsp;<span class="op" id="2274802">=</span>&nbsp;<span class="builtintype" id="2274804">int</span><span class="op" id="2274807">(</span><span class="ident" id="2274808"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274810">+</span>&nbsp;<span class="num" id="2274812">0.5</span><span class="op" id="2274815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274818">case</span>&nbsp;<span class="ident" id="2274823"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274825">&lt;</span>&nbsp;<span class="num" id="2274827">0</span><span class="op" id="2274828">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274832"><a href="/math/exp.go.html#2274769">k</a></span>&nbsp;<span class="op" id="2274834">=</span>&nbsp;<span class="builtintype" id="2274836">int</span><span class="op" id="2274839">(</span><span class="ident" id="2274840"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274842">-</span>&nbsp;<span class="num" id="2274844">0.5</span><span class="op" id="2274847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2274850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274853">t</span>&nbsp;<span class="op" id="2274855">:=</span>&nbsp;<span class="ident" id="2274858"><a href="/math/exp.go.html#2274307">x</a></span>&nbsp;<span class="op" id="2274860">-</span>&nbsp;<span class="builtintype" id="2274862">float64</span><span class="op" id="2274869">(</span><span class="ident" id="2274870"><a href="/math/exp.go.html#2274769">k</a></span><span class="op" id="2274871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274874">hi</span>&nbsp;<span class="op" id="2274877">:=</span>&nbsp;<span class="ident" id="2274880"><a href="/math/exp.go.html#2274853">t</a></span>&nbsp;<span class="op" id="2274882">*</span>&nbsp;<span class="ident" id="2274884"><a href="/math/exp.go.html#2274339">Ln2Hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2274891">lo</span>&nbsp;<span class="op" id="2274894">:=</span>&nbsp;<span class="op" id="2274897">-</span><span class="ident" id="2274898"><a href="/math/exp.go.html#2274853">t</a></span>&nbsp;<span class="op" id="2274900">*</span>&nbsp;<span class="ident" id="2274902"><a href="/math/exp.go.html#2274376">Ln2Lo</a></span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2274910">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2274922">return</span>&nbsp;<span class="ident" id="2274929"><a href="/math/exp.go.html#2275025">expmulti</a></span><span class="op" id="2274937">(</span><span class="ident" id="2274938"><a href="/math/exp.go.html#2274874">hi</a></span><span class="op" id="2274940">,</span>&nbsp;<span class="ident" id="2274942"><a href="/math/exp.go.html#2274891">lo</a></span><span class="op" id="2274944">,</span>&nbsp;<span class="ident" id="2274946"><a href="/math/exp.go.html#2274769">k</a></span><span class="op" id="2274947">)</span><br>
<span class="lineno"></span><span class="op" id="2274949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2274952">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2275020">func</span>&nbsp;<span class="ident" id="2275025">expmulti</span><span class="op" id="2275033">(</span><span class="ident" id="2275034">hi</span><span class="op" id="2275036">,</span>&nbsp;<span class="ident" id="2275038">lo</span>&nbsp;<span class="builtintype" id="2275041">float64</span><span class="op" id="2275048">,</span>&nbsp;<span class="ident" id="2275050">k</span>&nbsp;<span class="builtintype" id="2275052">int</span><span class="op" id="2275055">)</span>&nbsp;<span class="builtintype" id="2275057">float64</span>&nbsp;<span class="op" id="2275065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275068">const</span>&nbsp;<span class="op" id="2275074">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275078">P1</span>&nbsp;<span class="op" id="2275081">=</span>&nbsp;<span class="num" id="2275083">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2275111">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275142">P2</span>&nbsp;<span class="op" id="2275145">=</span>&nbsp;<span class="op" id="2275147">-</span><span class="num" id="2275148">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2275175">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275206">P3</span>&nbsp;<span class="op" id="2275209">=</span>&nbsp;<span class="num" id="2275211">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2275239">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275270">P4</span>&nbsp;<span class="op" id="2275273">=</span>&nbsp;<span class="op" id="2275275">-</span><span class="num" id="2275276">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2275303">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275334">P5</span>&nbsp;<span class="op" id="2275337">=</span>&nbsp;<span class="num" id="2275339">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2275367">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2275397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275401">r</span>&nbsp;<span class="op" id="2275403">:=</span>&nbsp;<span class="ident" id="2275406"><a href="/math/exp.go.html#2275034">hi</a></span>&nbsp;<span class="op" id="2275409">-</span>&nbsp;<span class="ident" id="2275411"><a href="/math/exp.go.html#2275038">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275415">t</span>&nbsp;<span class="op" id="2275417">:=</span>&nbsp;<span class="ident" id="2275420"><a href="/math/exp.go.html#2275401">r</a></span>&nbsp;<span class="op" id="2275422">*</span>&nbsp;<span class="ident" id="2275424"><a href="/math/exp.go.html#2275401">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275427">c</span>&nbsp;<span class="op" id="2275429">:=</span>&nbsp;<span class="ident" id="2275432"><a href="/math/exp.go.html#2275401">r</a></span>&nbsp;<span class="op" id="2275434">-</span>&nbsp;<span class="ident" id="2275436"><a href="/math/exp.go.html#2275415">t</a></span><span class="op" id="2275437">*</span><span class="op" id="2275438">(</span><span class="ident" id="2275439"><a href="/math/exp.go.html#2275078">P1</a></span><span class="op" id="2275441">+</span><span class="ident" id="2275442"><a href="/math/exp.go.html#2275415">t</a></span><span class="op" id="2275443">*</span><span class="op" id="2275444">(</span><span class="ident" id="2275445"><a href="/math/exp.go.html#2275142">P2</a></span><span class="op" id="2275447">+</span><span class="ident" id="2275448"><a href="/math/exp.go.html#2275415">t</a></span><span class="op" id="2275449">*</span><span class="op" id="2275450">(</span><span class="ident" id="2275451"><a href="/math/exp.go.html#2275206">P3</a></span><span class="op" id="2275453">+</span><span class="ident" id="2275454"><a href="/math/exp.go.html#2275415">t</a></span><span class="op" id="2275455">*</span><span class="op" id="2275456">(</span><span class="ident" id="2275457"><a href="/math/exp.go.html#2275270">P4</a></span><span class="op" id="2275459">+</span><span class="ident" id="2275460"><a href="/math/exp.go.html#2275415">t</a></span><span class="op" id="2275461">*</span><span class="ident" id="2275462"><a href="/math/exp.go.html#2275334">P5</a></span><span class="op" id="2275464">)</span><span class="op" id="2275465">)</span><span class="op" id="2275466">)</span><span class="op" id="2275467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2275470">y</span>&nbsp;<span class="op" id="2275472">:=</span>&nbsp;<span class="num" id="2275475">1</span>&nbsp;<span class="op" id="2275477">-</span>&nbsp;<span class="op" id="2275479">(</span><span class="op" id="2275480">(</span><span class="ident" id="2275481"><a href="/math/exp.go.html#2275038">lo</a></span>&nbsp;<span class="op" id="2275484">-</span>&nbsp;<span class="op" id="2275486">(</span><span class="ident" id="2275487"><a href="/math/exp.go.html#2275401">r</a></span><span class="op" id="2275488">*</span><span class="ident" id="2275489"><a href="/math/exp.go.html#2275427">c</a></span><span class="op" id="2275490">)</span><span class="op" id="2275491">/</span><span class="op" id="2275492">(</span><span class="num" id="2275493">2</span><span class="op" id="2275494">-</span><span class="ident" id="2275495"><a href="/math/exp.go.html#2275427">c</a></span><span class="op" id="2275496">)</span><span class="op" id="2275497">)</span>&nbsp;<span class="op" id="2275499">-</span>&nbsp;<span class="ident" id="2275501"><a href="/math/exp.go.html#2275034">hi</a></span><span class="op" id="2275503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2275506">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2275559">return</span>&nbsp;<span class="ident" id="2275566"><a href="/math/ldexp.go.html#2326641">Ldexp</a></span><span class="op" id="2275571">(</span><span class="ident" id="2275572"><a href="/math/exp.go.html#2275470">y</a></span><span class="op" id="2275573">,</span>&nbsp;<span class="ident" id="2275575"><a href="/math/exp.go.html#2275050">k</a></span><span class="op" id="2275576">)</span><br>
<span class="lineno"></span><span class="op" id="2275578">}</span>
</div>
</body>
</html>
