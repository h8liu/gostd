<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4416067">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4416122">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4416176">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4416227">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="4416287">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4416348">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416403">package</span>&nbsp;<span class="ident" id="4416411">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4416420">import</span>&nbsp;<span class="op" id="4416427">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4416430">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4416439">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4416449">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4416461">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4416476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4416479">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="4416501">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="4416596">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4416691">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="4416711">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="4416747">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4416826">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4416902">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4416982">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4417004">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="4417081">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="4417159">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="4417235">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4417287">//</span><br>
<span class="lineno"></span><span class="comment" id="4417290">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="4417369">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="4417444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="4417522">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4417600">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4417679">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="4417754">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="4417825">//</span><br>
<span class="lineno"></span><span class="keyword" id="4417828">func</span>&nbsp;<span class="op" id="4417833">(</span><span class="ident" id="4417834">p</span>&nbsp;<span class="op" id="4417836">*</span><span class="ident" id="4417837">printer</span><span class="op" id="4417844">)</span>&nbsp;<span class="ident" id="4417846">linebreak</span><span class="op" id="4417855">(</span><span class="ident" id="4417856">line</span><span class="op" id="4417860">,</span>&nbsp;<span class="ident" id="4417862">min</span>&nbsp;<span class="builtintype" id="4417866">int</span><span class="op" id="4417869">,</span>&nbsp;<span class="ident" id="4417871">ws</span>&nbsp;<span class="ident" id="4417874">whiteSpace</span><span class="op" id="4417884">,</span>&nbsp;<span class="ident" id="4417886">newSection</span>&nbsp;<span class="builtintype" id="4417897">bool</span><span class="op" id="4417901">)</span>&nbsp;<span class="op" id="4417903">(</span><span class="ident" id="4417904">printedBreak</span>&nbsp;<span class="builtintype" id="4417917">bool</span><span class="op" id="4417921">)</span>&nbsp;<span class="op" id="4417923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417926">n</span>&nbsp;<span class="op" id="4417928">:=</span>&nbsp;<span class="ident" id="4417931">nlimit</span><span class="op" id="4417937">(</span><span class="ident" id="4417938">line</span>&nbsp;<span class="op" id="4417943">-</span>&nbsp;<span class="ident" id="4417945">p</span><span class="op" id="4417946">.</span><span class="ident" id="4417947">pos</span><span class="op" id="4417950">.</span><span class="ident" id="4417951">Line</span><span class="op" id="4417955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417958">if</span>&nbsp;<span class="ident" id="4417961">n</span>&nbsp;<span class="op" id="4417963">&lt;</span>&nbsp;<span class="ident" id="4417965">min</span>&nbsp;<span class="op" id="4417969">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417973">n</span>&nbsp;<span class="op" id="4417975">=</span>&nbsp;<span class="ident" id="4417977">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417985">if</span>&nbsp;<span class="ident" id="4417988">n</span>&nbsp;<span class="op" id="4417990">&gt;</span>&nbsp;<span class="num" id="4417992">0</span>&nbsp;<span class="op" id="4417994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417998">p</span><span class="op" id="4417999">.</span><span class="builtinfunc" id="4418000">print</span><span class="op" id="4418005">(</span><span class="ident" id="4418006">ws</span><span class="op" id="4418008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418012">if</span>&nbsp;<span class="ident" id="4418015">newSection</span>&nbsp;<span class="op" id="4418026">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418031">p</span><span class="op" id="4418032">.</span><span class="builtinfunc" id="4418033">print</span><span class="op" id="4418038">(</span><span class="ident" id="4418039">formfeed</span><span class="op" id="4418047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418052">n</span><span class="op" id="4418053">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418062">for</span>&nbsp;<span class="op" id="4418066">;</span>&nbsp;<span class="ident" id="4418068">n</span>&nbsp;<span class="op" id="4418070">&gt;</span>&nbsp;<span class="num" id="4418072">0</span><span class="op" id="4418073">;</span>&nbsp;<span class="ident" id="4418075">n</span><span class="op" id="4418076">--</span>&nbsp;<span class="op" id="4418079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418084">p</span><span class="op" id="4418085">.</span><span class="builtinfunc" id="4418086">print</span><span class="op" id="4418091">(</span><span class="ident" id="4418092">newline</span><span class="op" id="4418099">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418107">printedBreak</span>&nbsp;<span class="op" id="4418120">=</span>&nbsp;<span class="builtintype" id="4418122">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418131">return</span><br>
<span class="lineno"></span><span class="op" id="4418138">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4418141">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="4418215">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4418291">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="4418369">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="4418428">func</span>&nbsp;<span class="op" id="4418433">(</span><span class="ident" id="4418434">p</span>&nbsp;<span class="op" id="4418436">*</span><span class="ident" id="4418437">printer</span><span class="op" id="4418444">)</span>&nbsp;<span class="ident" id="4418446">setComment</span><span class="op" id="4418456">(</span><span class="ident" id="4418457">g</span>&nbsp;<span class="op" id="4418459">*</span><span class="ident" id="4418460">ast</span><span class="op" id="4418463">.</span><span class="ident" id="4418464">CommentGroup</span><span class="op" id="4418476">)</span>&nbsp;<span class="op" id="4418478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418481">if</span>&nbsp;<span class="ident" id="4418484">g</span>&nbsp;<span class="op" id="4418486">==</span>&nbsp;<span class="ident" id="4418489">nil</span>&nbsp;<span class="op" id="4418493">||</span>&nbsp;<span class="op" id="4418496">!</span><span class="ident" id="4418497">p</span><span class="op" id="4418498">.</span><span class="ident" id="4418499">useNodeComments</span>&nbsp;<span class="op" id="4418515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418519">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418530">if</span>&nbsp;<span class="ident" id="4418533">p</span><span class="op" id="4418534">.</span><span class="ident" id="4418535">comments</span>&nbsp;<span class="op" id="4418544">==</span>&nbsp;<span class="ident" id="4418547">nil</span>&nbsp;<span class="op" id="4418551">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4418555">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418589">p</span><span class="op" id="4418590">.</span><span class="ident" id="4418591">comments</span>&nbsp;<span class="op" id="4418600">=</span>&nbsp;<span class="builtinfunc" id="4418602">make</span><span class="op" id="4418606">(</span><span class="op" id="4418607">[</span><span class="op" id="4418608">]</span><span class="op" id="4418609">*</span><span class="ident" id="4418610">ast</span><span class="op" id="4418613">.</span><span class="ident" id="4418614">CommentGroup</span><span class="op" id="4418626">,</span>&nbsp;<span class="num" id="4418628">1</span><span class="op" id="4418629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418632">}</span>&nbsp;<span class="keyword" id="4418634">else</span>&nbsp;<span class="keyword" id="4418639">if</span>&nbsp;<span class="ident" id="4418642">p</span><span class="op" id="4418643">.</span><span class="ident" id="4418644">cindex</span>&nbsp;<span class="op" id="4418651">&lt;</span>&nbsp;<span class="builtinfunc" id="4418653">len</span><span class="op" id="4418656">(</span><span class="ident" id="4418657">p</span><span class="op" id="4418658">.</span><span class="ident" id="4418659">comments</span><span class="op" id="4418667">)</span>&nbsp;<span class="op" id="4418669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4418673">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4418727">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4418782">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418836">p</span><span class="op" id="4418837">.</span><span class="ident" id="4418838">flush</span><span class="op" id="4418843">(</span><span class="ident" id="4418844">p</span><span class="op" id="4418845">.</span><span class="ident" id="4418846">posFor</span><span class="op" id="4418852">(</span><span class="ident" id="4418853">g</span><span class="op" id="4418854">.</span><span class="ident" id="4418855">List</span><span class="op" id="4418859">[</span><span class="num" id="4418860">0</span><span class="op" id="4418861">]</span><span class="op" id="4418862">.</span><span class="ident" id="4418863">Pos</span><span class="op" id="4418866">(</span><span class="op" id="4418867">)</span><span class="op" id="4418868">)</span><span class="op" id="4418869">,</span>&nbsp;<span class="ident" id="4418871">token</span><span class="op" id="4418876">.</span><span class="ident" id="4418877">ILLEGAL</span><span class="op" id="4418884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418888">p</span><span class="op" id="4418889">.</span><span class="ident" id="4418890">comments</span>&nbsp;<span class="op" id="4418899">=</span>&nbsp;<span class="ident" id="4418901">p</span><span class="op" id="4418902">.</span><span class="ident" id="4418903">comments</span><span class="op" id="4418911">[</span><span class="num" id="4418912">0</span><span class="op" id="4418913">:</span><span class="num" id="4418914">1</span><span class="op" id="4418915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4418919">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418952">p</span><span class="op" id="4418953">.</span><span class="ident" id="4418954">internalError</span><span class="op" id="4418967">(</span><span class="string" id="4418968">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="4419003">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419009">p</span><span class="op" id="4419010">.</span><span class="ident" id="4419011">comments</span><span class="op" id="4419019">[</span><span class="num" id="4419020">0</span><span class="op" id="4419021">]</span>&nbsp;<span class="op" id="4419023">=</span>&nbsp;<span class="ident" id="4419025">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419028">p</span><span class="op" id="4419029">.</span><span class="ident" id="4419030">cindex</span>&nbsp;<span class="op" id="4419037">=</span>&nbsp;<span class="num" id="4419039">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419042">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419105">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419164">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419221">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419241">if</span>&nbsp;<span class="ident" id="4419244">p</span><span class="op" id="4419245">.</span><span class="ident" id="4419246">commentOffset</span>&nbsp;<span class="op" id="4419260">==</span>&nbsp;<span class="ident" id="4419263">infinity</span>&nbsp;<span class="op" id="4419272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419276">p</span><span class="op" id="4419277">.</span><span class="ident" id="4419278">nextComment</span><span class="op" id="4419289">(</span><span class="op" id="4419290">)</span>&nbsp;<span class="comment" id="4419292">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419322">}</span><br>
<span class="lineno">90</span><span class="op" id="4419324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419327">type</span>&nbsp;<span class="ident" id="4419332">exprListMode</span>&nbsp;<span class="builtintype" id="4419345">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4419351">const</span>&nbsp;<span class="op" id="4419357">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419360">commaTerm</span>&nbsp;<span class="ident" id="4419370">exprListMode</span>&nbsp;<span class="op" id="4419383">=</span>&nbsp;<span class="num" id="4419385">1</span>&nbsp;<span class="op" id="4419387">&lt;&lt;</span>&nbsp;<span class="ident" id="4419390">iota</span>&nbsp;<span class="comment" id="4419395">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419440">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4419475">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="4419519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419522">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="4419594">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="4419626">func</span>&nbsp;<span class="op" id="4419631">(</span><span class="ident" id="4419632">p</span>&nbsp;<span class="op" id="4419634">*</span><span class="ident" id="4419635">printer</span><span class="op" id="4419642">)</span>&nbsp;<span class="ident" id="4419644">identList</span><span class="op" id="4419653">(</span><span class="ident" id="4419654">list</span>&nbsp;<span class="op" id="4419659">[</span><span class="op" id="4419660">]</span><span class="op" id="4419661">*</span><span class="ident" id="4419662">ast</span><span class="op" id="4419665">.</span><span class="ident" id="4419666">Ident</span><span class="op" id="4419671">,</span>&nbsp;<span class="ident" id="4419673">indent</span>&nbsp;<span class="builtintype" id="4419680">bool</span><span class="op" id="4419684">)</span>&nbsp;<span class="op" id="4419686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419689">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419762">xlist</span>&nbsp;<span class="op" id="4419768">:=</span>&nbsp;<span class="builtinfunc" id="4419771">make</span><span class="op" id="4419775">(</span><span class="op" id="4419776">[</span><span class="op" id="4419777">]</span><span class="ident" id="4419778">ast</span><span class="op" id="4419781">.</span><span class="ident" id="4419782">Expr</span><span class="op" id="4419786">,</span>&nbsp;<span class="builtinfunc" id="4419788">len</span><span class="op" id="4419791">(</span><span class="ident" id="4419792">list</span><span class="op" id="4419796">)</span><span class="op" id="4419797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419800">for</span>&nbsp;<span class="ident" id="4419804">i</span><span class="op" id="4419805">,</span>&nbsp;<span class="ident" id="4419807">x</span>&nbsp;<span class="op" id="4419809">:=</span>&nbsp;<span class="keyword" id="4419812">range</span>&nbsp;<span class="ident" id="4419818">list</span>&nbsp;<span class="op" id="4419823">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419827">xlist</span><span class="op" id="4419832">[</span><span class="ident" id="4419833">i</span><span class="op" id="4419834">]</span>&nbsp;<span class="op" id="4419836">=</span>&nbsp;<span class="ident" id="4419838">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419844">var</span>&nbsp;<span class="ident" id="4419848">mode</span>&nbsp;<span class="ident" id="4419853">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419867">if</span>&nbsp;<span class="op" id="4419870">!</span><span class="ident" id="4419871">indent</span>&nbsp;<span class="op" id="4419878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419882">mode</span>&nbsp;<span class="op" id="4419887">=</span>&nbsp;<span class="ident" id="4419889">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419902">p</span><span class="op" id="4419903">.</span><span class="ident" id="4419904">exprList</span><span class="op" id="4419912">(</span><span class="ident" id="4419913">token</span><span class="op" id="4419918">.</span><span class="ident" id="4419919">NoPos</span><span class="op" id="4419924">,</span>&nbsp;<span class="ident" id="4419926">xlist</span><span class="op" id="4419931">,</span>&nbsp;<span class="num" id="4419933">1</span><span class="op" id="4419934">,</span>&nbsp;<span class="ident" id="4419936">mode</span><span class="op" id="4419940">,</span>&nbsp;<span class="ident" id="4419942">token</span><span class="op" id="4419947">.</span><span class="ident" id="4419948">NoPos</span><span class="op" id="4419953">)</span><br>
<span class="lineno"></span><span class="op" id="4419955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4419958">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="4420017">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="4420081">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="4420097">//</span><br>
<span class="lineno"></span><span class="comment" id="4420100">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="4420169">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="4420236">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="4420302">func</span>&nbsp;<span class="op" id="4420307">(</span><span class="ident" id="4420308">p</span>&nbsp;<span class="op" id="4420310">*</span><span class="ident" id="4420311">printer</span><span class="op" id="4420318">)</span>&nbsp;<span class="ident" id="4420320">exprList</span><span class="op" id="4420328">(</span><span class="ident" id="4420329">prev0</span>&nbsp;<span class="ident" id="4420335">token</span><span class="op" id="4420340">.</span><span class="ident" id="4420341">Pos</span><span class="op" id="4420344">,</span>&nbsp;<span class="ident" id="4420346">list</span>&nbsp;<span class="op" id="4420351">[</span><span class="op" id="4420352">]</span><span class="ident" id="4420353">ast</span><span class="op" id="4420356">.</span><span class="ident" id="4420357">Expr</span><span class="op" id="4420361">,</span>&nbsp;<span class="ident" id="4420363">depth</span>&nbsp;<span class="builtintype" id="4420369">int</span><span class="op" id="4420372">,</span>&nbsp;<span class="ident" id="4420374">mode</span>&nbsp;<span class="ident" id="4420379">exprListMode</span><span class="op" id="4420391">,</span>&nbsp;<span class="ident" id="4420393">next0</span>&nbsp;<span class="ident" id="4420399">token</span><span class="op" id="4420404">.</span><span class="ident" id="4420405">Pos</span><span class="op" id="4420408">)</span>&nbsp;<span class="op" id="4420410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420413">if</span>&nbsp;<span class="builtinfunc" id="4420416">len</span><span class="op" id="4420419">(</span><span class="ident" id="4420420">list</span><span class="op" id="4420424">)</span>&nbsp;<span class="op" id="4420426">==</span>&nbsp;<span class="num" id="4420429">0</span>&nbsp;<span class="op" id="4420431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420435">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420443">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420447">prev</span>&nbsp;<span class="op" id="4420452">:=</span>&nbsp;<span class="ident" id="4420455">p</span><span class="op" id="4420456">.</span><span class="ident" id="4420457">posFor</span><span class="op" id="4420463">(</span><span class="ident" id="4420464">prev0</span><span class="op" id="4420469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420472">next</span>&nbsp;<span class="op" id="4420477">:=</span>&nbsp;<span class="ident" id="4420480">p</span><span class="op" id="4420481">.</span><span class="ident" id="4420482">posFor</span><span class="op" id="4420488">(</span><span class="ident" id="4420489">next0</span><span class="op" id="4420494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420497">line</span>&nbsp;<span class="op" id="4420502">:=</span>&nbsp;<span class="ident" id="4420505">p</span><span class="op" id="4420506">.</span><span class="ident" id="4420507">lineFor</span><span class="op" id="4420514">(</span><span class="ident" id="4420515">list</span><span class="op" id="4420519">[</span><span class="num" id="4420520">0</span><span class="op" id="4420521">]</span><span class="op" id="4420522">.</span><span class="ident" id="4420523">Pos</span><span class="op" id="4420526">(</span><span class="op" id="4420527">)</span><span class="op" id="4420528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420531">endLine</span>&nbsp;<span class="op" id="4420539">:=</span>&nbsp;<span class="ident" id="4420542">p</span><span class="op" id="4420543">.</span><span class="ident" id="4420544">lineFor</span><span class="op" id="4420551">(</span><span class="ident" id="4420552">list</span><span class="op" id="4420556">[</span><span class="builtinfunc" id="4420557">len</span><span class="op" id="4420560">(</span><span class="ident" id="4420561">list</span><span class="op" id="4420565">)</span><span class="op" id="4420566">-</span><span class="num" id="4420567">1</span><span class="op" id="4420568">]</span><span class="op" id="4420569">.</span><span class="ident" id="4420570">End</span><span class="op" id="4420573">(</span><span class="op" id="4420574">)</span><span class="op" id="4420575">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420579">if</span>&nbsp;<span class="ident" id="4420582">prev</span><span class="op" id="4420586">.</span><span class="ident" id="4420587">IsValid</span><span class="op" id="4420594">(</span><span class="op" id="4420595">)</span>&nbsp;<span class="op" id="4420597">&amp;&amp;</span>&nbsp;<span class="ident" id="4420600">prev</span><span class="op" id="4420604">.</span><span class="ident" id="4420605">Line</span>&nbsp;<span class="op" id="4420610">==</span>&nbsp;<span class="ident" id="4420613">line</span>&nbsp;<span class="op" id="4420618">&amp;&amp;</span>&nbsp;<span class="ident" id="4420621">line</span>&nbsp;<span class="op" id="4420626">==</span>&nbsp;<span class="ident" id="4420629">endLine</span>&nbsp;<span class="op" id="4420637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420641">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420680">for</span>&nbsp;<span class="ident" id="4420684">i</span><span class="op" id="4420685">,</span>&nbsp;<span class="ident" id="4420687">x</span>&nbsp;<span class="op" id="4420689">:=</span>&nbsp;<span class="keyword" id="4420692">range</span>&nbsp;<span class="ident" id="4420698">list</span>&nbsp;<span class="op" id="4420703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420708">if</span>&nbsp;<span class="ident" id="4420711">i</span>&nbsp;<span class="op" id="4420713">&gt;</span>&nbsp;<span class="num" id="4420715">0</span>&nbsp;<span class="op" id="4420717">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420723">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420780">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420832">p</span><span class="op" id="4420833">.</span><span class="builtinfunc" id="4420834">print</span><span class="op" id="4420839">(</span><span class="ident" id="4420840">x</span><span class="op" id="4420841">.</span><span class="ident" id="4420842">Pos</span><span class="op" id="4420845">(</span><span class="op" id="4420846">)</span><span class="op" id="4420847">,</span>&nbsp;<span class="ident" id="4420849">token</span><span class="op" id="4420854">.</span><span class="ident" id="4420855">COMMA</span><span class="op" id="4420860">,</span>&nbsp;<span class="ident" id="4420862">blank</span><span class="op" id="4420867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420877">p</span><span class="op" id="4420878">.</span><span class="ident" id="4420879">expr0</span><span class="op" id="4420884">(</span><span class="ident" id="4420885">x</span><span class="op" id="4420886">,</span>&nbsp;<span class="ident" id="4420888">depth</span><span class="op" id="4420893">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420913">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420951">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421003">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421055">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421113">ws</span>&nbsp;<span class="op" id="4421116">:=</span>&nbsp;<span class="ident" id="4421119">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421127">if</span>&nbsp;<span class="ident" id="4421130">mode</span><span class="op" id="4421134">&amp;</span><span class="ident" id="4421135">noIndent</span>&nbsp;<span class="op" id="4421144">==</span>&nbsp;<span class="num" id="4421147">0</span>&nbsp;<span class="op" id="4421149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421153">ws</span>&nbsp;<span class="op" id="4421156">=</span>&nbsp;<span class="ident" id="4421158">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421170">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421243">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421281">prevBreak</span>&nbsp;<span class="op" id="4421291">:=</span>&nbsp;<span class="op" id="4421294">-</span><span class="num" id="4421295">1</span>&nbsp;<span class="comment" id="4421297">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421359">if</span>&nbsp;<span class="ident" id="4421362">prev</span><span class="op" id="4421366">.</span><span class="ident" id="4421367">IsValid</span><span class="op" id="4421374">(</span><span class="op" id="4421375">)</span>&nbsp;<span class="op" id="4421377">&amp;&amp;</span>&nbsp;<span class="ident" id="4421380">prev</span><span class="op" id="4421384">.</span><span class="ident" id="4421385">Line</span>&nbsp;<span class="op" id="4421390">&lt;</span>&nbsp;<span class="ident" id="4421392">line</span>&nbsp;<span class="op" id="4421397">&amp;&amp;</span>&nbsp;<span class="ident" id="4421400">p</span><span class="op" id="4421401">.</span><span class="ident" id="4421402">linebreak</span><span class="op" id="4421411">(</span><span class="ident" id="4421412">line</span><span class="op" id="4421416">,</span>&nbsp;<span class="num" id="4421418">0</span><span class="op" id="4421419">,</span>&nbsp;<span class="ident" id="4421421">ws</span><span class="op" id="4421423">,</span>&nbsp;<span class="builtintype" id="4421425">true</span><span class="op" id="4421429">)</span>&nbsp;<span class="op" id="4421431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421435">ws</span>&nbsp;<span class="op" id="4421438">=</span>&nbsp;<span class="ident" id="4421440">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421449">prevBreak</span>&nbsp;<span class="op" id="4421459">=</span>&nbsp;<span class="num" id="4421461">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421468">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421565">size</span>&nbsp;<span class="op" id="4421570">:=</span>&nbsp;<span class="num" id="4421573">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421577">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421605">prevLine</span>&nbsp;<span class="op" id="4421614">:=</span>&nbsp;<span class="ident" id="4421617">prev</span><span class="op" id="4421621">.</span><span class="ident" id="4421622">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421628">for</span>&nbsp;<span class="ident" id="4421632">i</span><span class="op" id="4421633">,</span>&nbsp;<span class="ident" id="4421635">x</span>&nbsp;<span class="op" id="4421637">:=</span>&nbsp;<span class="keyword" id="4421640">range</span>&nbsp;<span class="ident" id="4421646">list</span>&nbsp;<span class="op" id="4421651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421655">line</span>&nbsp;<span class="op" id="4421660">=</span>&nbsp;<span class="ident" id="4421662">p</span><span class="op" id="4421663">.</span><span class="ident" id="4421664">lineFor</span><span class="op" id="4421671">(</span><span class="ident" id="4421672">x</span><span class="op" id="4421673">.</span><span class="ident" id="4421674">Pos</span><span class="op" id="4421677">(</span><span class="op" id="4421678">)</span><span class="op" id="4421679">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421684">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421753">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421821">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421866">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422002">useFF</span>&nbsp;<span class="op" id="4422008">:=</span>&nbsp;<span class="builtintype" id="4422011">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422019">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422082">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422148">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422217">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422231">prevSize</span>&nbsp;<span class="op" id="4422240">:=</span>&nbsp;<span class="ident" id="4422243">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422250">const</span>&nbsp;<span class="ident" id="4422256">infinity</span>&nbsp;<span class="op" id="4422265">=</span>&nbsp;<span class="num" id="4422267">1e6</span>&nbsp;<span class="comment" id="4422271">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422304">size</span>&nbsp;<span class="op" id="4422309">=</span>&nbsp;<span class="ident" id="4422311">p</span><span class="op" id="4422312">.</span><span class="ident" id="4422313">nodeSize</span><span class="op" id="4422321">(</span><span class="ident" id="4422322">x</span><span class="op" id="4422323">,</span>&nbsp;<span class="ident" id="4422325">infinity</span><span class="op" id="4422333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422337">pair</span><span class="op" id="4422341">,</span>&nbsp;<span class="ident" id="4422343">isPair</span>&nbsp;<span class="op" id="4422350">:=</span>&nbsp;<span class="ident" id="4422353">x</span><span class="op" id="4422354">.</span><span class="op" id="4422355">(</span><span class="op" id="4422356">*</span><span class="ident" id="4422357">ast</span><span class="op" id="4422360">.</span><span class="ident" id="4422361">KeyValueExpr</span><span class="op" id="4422373">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422377">if</span>&nbsp;<span class="ident" id="4422380">size</span>&nbsp;<span class="op" id="4422385">&lt;=</span>&nbsp;<span class="ident" id="4422388">infinity</span>&nbsp;<span class="op" id="4422397">&amp;&amp;</span>&nbsp;<span class="ident" id="4422400">prev</span><span class="op" id="4422404">.</span><span class="ident" id="4422405">IsValid</span><span class="op" id="4422412">(</span><span class="op" id="4422413">)</span>&nbsp;<span class="op" id="4422415">&amp;&amp;</span>&nbsp;<span class="ident" id="4422418">next</span><span class="op" id="4422422">.</span><span class="ident" id="4422423">IsValid</span><span class="op" id="4422430">(</span><span class="op" id="4422431">)</span>&nbsp;<span class="op" id="4422433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422438">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422468">if</span>&nbsp;<span class="ident" id="4422471">isPair</span>&nbsp;<span class="op" id="4422478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422484">size</span>&nbsp;<span class="op" id="4422489">=</span>&nbsp;<span class="ident" id="4422491">p</span><span class="op" id="4422492">.</span><span class="ident" id="4422493">nodeSize</span><span class="op" id="4422501">(</span><span class="ident" id="4422502">pair</span><span class="op" id="4422506">.</span><span class="ident" id="4422507">Key</span><span class="op" id="4422510">,</span>&nbsp;<span class="ident" id="4422512">infinity</span><span class="op" id="4422520">)</span>&nbsp;<span class="comment" id="4422522">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422545">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422549">}</span>&nbsp;<span class="keyword" id="4422551">else</span>&nbsp;<span class="op" id="4422556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422561">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422623">size</span>&nbsp;<span class="op" id="4422628">=</span>&nbsp;<span class="num" id="4422630">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422639">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422698">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422755">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4422810">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422864">if</span>&nbsp;<span class="ident" id="4422867">prevSize</span>&nbsp;<span class="op" id="4422876">&gt;</span>&nbsp;<span class="num" id="4422878">0</span>&nbsp;<span class="op" id="4422880">&amp;&amp;</span>&nbsp;<span class="ident" id="4422883">size</span>&nbsp;<span class="op" id="4422888">&gt;</span>&nbsp;<span class="num" id="4422890">0</span>&nbsp;<span class="op" id="4422892">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422897">const</span>&nbsp;<span class="ident" id="4422903">smallSize</span>&nbsp;<span class="op" id="4422913">=</span>&nbsp;<span class="num" id="4422915">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422921">if</span>&nbsp;<span class="ident" id="4422924">prevSize</span>&nbsp;<span class="op" id="4422933">&lt;=</span>&nbsp;<span class="ident" id="4422936">smallSize</span>&nbsp;<span class="op" id="4422946">&amp;&amp;</span>&nbsp;<span class="ident" id="4422949">size</span>&nbsp;<span class="op" id="4422954">&lt;=</span>&nbsp;<span class="ident" id="4422957">smallSize</span>&nbsp;<span class="op" id="4422967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422973">useFF</span>&nbsp;<span class="op" id="4422979">=</span>&nbsp;<span class="builtintype" id="4422981">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422990">}</span>&nbsp;<span class="keyword" id="4422992">else</span>&nbsp;<span class="op" id="4422997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423003">const</span>&nbsp;<span class="ident" id="4423009">r</span>&nbsp;<span class="op" id="4423011">=</span>&nbsp;<span class="num" id="4423013">4</span>&nbsp;<span class="comment" id="4423015">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423032">ratio</span>&nbsp;<span class="op" id="4423038">:=</span>&nbsp;<span class="builtintype" id="4423041">float64</span><span class="op" id="4423048">(</span><span class="ident" id="4423049">size</span><span class="op" id="4423053">)</span>&nbsp;<span class="op" id="4423055">/</span>&nbsp;<span class="builtintype" id="4423057">float64</span><span class="op" id="4423064">(</span><span class="ident" id="4423065">prevSize</span><span class="op" id="4423073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423079">useFF</span>&nbsp;<span class="op" id="4423085">=</span>&nbsp;<span class="ident" id="4423087">ratio</span>&nbsp;<span class="op" id="4423093">&lt;=</span>&nbsp;<span class="num" id="4423096">1.0</span><span class="op" id="4423099">/</span><span class="ident" id="4423100">r</span>&nbsp;<span class="op" id="4423102">||</span>&nbsp;<span class="ident" id="4423105">r</span>&nbsp;<span class="op" id="4423107">&lt;=</span>&nbsp;<span class="ident" id="4423110">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423128">needsLinebreak</span>&nbsp;<span class="op" id="4423143">:=</span>&nbsp;<span class="num" id="4423146">0</span>&nbsp;<span class="op" id="4423148">&lt;</span>&nbsp;<span class="ident" id="4423150">prevLine</span>&nbsp;<span class="op" id="4423159">&amp;&amp;</span>&nbsp;<span class="ident" id="4423162">prevLine</span>&nbsp;<span class="op" id="4423171">&lt;</span>&nbsp;<span class="ident" id="4423173">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423180">if</span>&nbsp;<span class="ident" id="4423183">i</span>&nbsp;<span class="op" id="4423185">&gt;</span>&nbsp;<span class="num" id="4423187">0</span>&nbsp;<span class="op" id="4423189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423194">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423250">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423306">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423355">if</span>&nbsp;<span class="op" id="4423358">!</span><span class="ident" id="4423359">needsLinebreak</span>&nbsp;<span class="op" id="4423374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423380">p</span><span class="op" id="4423381">.</span><span class="builtinfunc" id="4423382">print</span><span class="op" id="4423387">(</span><span class="ident" id="4423388">x</span><span class="op" id="4423389">.</span><span class="ident" id="4423390">Pos</span><span class="op" id="4423393">(</span><span class="op" id="4423394">)</span><span class="op" id="4423395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423405">p</span><span class="op" id="4423406">.</span><span class="builtinfunc" id="4423407">print</span><span class="op" id="4423412">(</span><span class="ident" id="4423413">token</span><span class="op" id="4423418">.</span><span class="ident" id="4423419">COMMA</span><span class="op" id="4423424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423429">needsBlank</span>&nbsp;<span class="op" id="4423440">:=</span>&nbsp;<span class="builtintype" id="4423443">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423451">if</span>&nbsp;<span class="ident" id="4423454">needsLinebreak</span>&nbsp;<span class="op" id="4423469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423475">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423541">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423607">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423659">if</span>&nbsp;<span class="ident" id="4423662">p</span><span class="op" id="4423663">.</span><span class="ident" id="4423664">linebreak</span><span class="op" id="4423673">(</span><span class="ident" id="4423674">line</span><span class="op" id="4423678">,</span>&nbsp;<span class="num" id="4423680">0</span><span class="op" id="4423681">,</span>&nbsp;<span class="ident" id="4423683">ws</span><span class="op" id="4423685">,</span>&nbsp;<span class="ident" id="4423687">useFF</span>&nbsp;<span class="op" id="4423693">||</span>&nbsp;<span class="ident" id="4423696">prevBreak</span><span class="op" id="4423705">+</span><span class="num" id="4423706">1</span>&nbsp;<span class="op" id="4423708">&lt;</span>&nbsp;<span class="ident" id="4423710">i</span><span class="op" id="4423711">)</span>&nbsp;<span class="op" id="4423713">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423720">ws</span>&nbsp;<span class="op" id="4423723">=</span>&nbsp;<span class="ident" id="4423725">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423737">prevBreak</span>&nbsp;<span class="op" id="4423747">=</span>&nbsp;<span class="ident" id="4423749">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423756">needsBlank</span>&nbsp;<span class="op" id="4423767">=</span>&nbsp;<span class="builtintype" id="4423769">false</span>&nbsp;<span class="comment" id="4423775">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423815">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423820">if</span>&nbsp;<span class="ident" id="4423823">needsBlank</span>&nbsp;<span class="op" id="4423834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423840">p</span><span class="op" id="4423841">.</span><span class="builtinfunc" id="4423842">print</span><span class="op" id="4423847">(</span><span class="ident" id="4423848">blank</span><span class="op" id="4423853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423867">if</span>&nbsp;<span class="builtinfunc" id="4423870">len</span><span class="op" id="4423873">(</span><span class="ident" id="4423874">list</span><span class="op" id="4423878">)</span>&nbsp;<span class="op" id="4423880">&gt;</span>&nbsp;<span class="num" id="4423882">1</span>&nbsp;<span class="op" id="4423884">&amp;&amp;</span>&nbsp;<span class="ident" id="4423887">isPair</span>&nbsp;<span class="op" id="4423894">&amp;&amp;</span>&nbsp;<span class="ident" id="4423897">size</span>&nbsp;<span class="op" id="4423902">&gt;</span>&nbsp;<span class="num" id="4423904">0</span>&nbsp;<span class="op" id="4423906">&amp;&amp;</span>&nbsp;<span class="ident" id="4423909">needsLinebreak</span>&nbsp;<span class="op" id="4423924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423929">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423990">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424051">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424112">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424140">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424202">p</span><span class="op" id="4424203">.</span><span class="ident" id="4424204">expr</span><span class="op" id="4424208">(</span><span class="ident" id="4424209">pair</span><span class="op" id="4424213">.</span><span class="ident" id="4424214">Key</span><span class="op" id="4424217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424222">p</span><span class="op" id="4424223">.</span><span class="builtinfunc" id="4424224">print</span><span class="op" id="4424229">(</span><span class="ident" id="4424230">pair</span><span class="op" id="4424234">.</span><span class="ident" id="4424235">Colon</span><span class="op" id="4424240">,</span>&nbsp;<span class="ident" id="4424242">token</span><span class="op" id="4424247">.</span><span class="ident" id="4424248">COLON</span><span class="op" id="4424253">,</span>&nbsp;<span class="ident" id="4424255">vtab</span><span class="op" id="4424259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424264">p</span><span class="op" id="4424265">.</span><span class="ident" id="4424266">expr</span><span class="op" id="4424270">(</span><span class="ident" id="4424271">pair</span><span class="op" id="4424275">.</span><span class="ident" id="4424276">Value</span><span class="op" id="4424281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424285">}</span>&nbsp;<span class="keyword" id="4424287">else</span>&nbsp;<span class="op" id="4424292">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424297">p</span><span class="op" id="4424298">.</span><span class="ident" id="4424299">expr0</span><span class="op" id="4424304">(</span><span class="ident" id="4424305">x</span><span class="op" id="4424306">,</span>&nbsp;<span class="ident" id="4424308">depth</span><span class="op" id="4424313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424322">prevLine</span>&nbsp;<span class="op" id="4424331">=</span>&nbsp;<span class="ident" id="4424333">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424339">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424343">if</span>&nbsp;<span class="ident" id="4424346">mode</span><span class="op" id="4424350">&amp;</span><span class="ident" id="4424351">commaTerm</span>&nbsp;<span class="op" id="4424361">!=</span>&nbsp;<span class="num" id="4424364">0</span>&nbsp;<span class="op" id="4424366">&amp;&amp;</span>&nbsp;<span class="ident" id="4424369">next</span><span class="op" id="4424373">.</span><span class="ident" id="4424374">IsValid</span><span class="op" id="4424381">(</span><span class="op" id="4424382">)</span>&nbsp;<span class="op" id="4424384">&amp;&amp;</span>&nbsp;<span class="ident" id="4424387">p</span><span class="op" id="4424388">.</span><span class="ident" id="4424389">pos</span><span class="op" id="4424392">.</span><span class="ident" id="4424393">Line</span>&nbsp;<span class="op" id="4424398">&lt;</span>&nbsp;<span class="ident" id="4424400">next</span><span class="op" id="4424404">.</span><span class="ident" id="4424405">Line</span>&nbsp;<span class="op" id="4424410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424414">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424480">p</span><span class="op" id="4424481">.</span><span class="builtinfunc" id="4424482">print</span><span class="op" id="4424487">(</span><span class="ident" id="4424488">token</span><span class="op" id="4424493">.</span><span class="ident" id="4424494">COMMA</span><span class="op" id="4424499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424503">if</span>&nbsp;<span class="ident" id="4424506">ws</span>&nbsp;<span class="op" id="4424509">==</span>&nbsp;<span class="ident" id="4424512">ignore</span>&nbsp;<span class="op" id="4424519">&amp;&amp;</span>&nbsp;<span class="ident" id="4424522">mode</span><span class="op" id="4424526">&amp;</span><span class="ident" id="4424527">noIndent</span>&nbsp;<span class="op" id="4424536">==</span>&nbsp;<span class="num" id="4424539">0</span>&nbsp;<span class="op" id="4424541">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424546">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424576">p</span><span class="op" id="4424577">.</span><span class="builtinfunc" id="4424578">print</span><span class="op" id="4424583">(</span><span class="ident" id="4424584">unindent</span><span class="op" id="4424592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424600">p</span><span class="op" id="4424601">.</span><span class="builtinfunc" id="4424602">print</span><span class="op" id="4424607">(</span><span class="ident" id="4424608">formfeed</span><span class="op" id="4424616">)</span>&nbsp;<span class="comment" id="4424618">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424673">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424685">if</span>&nbsp;<span class="ident" id="4424688">ws</span>&nbsp;<span class="op" id="4424691">==</span>&nbsp;<span class="ident" id="4424694">ignore</span>&nbsp;<span class="op" id="4424701">&amp;&amp;</span>&nbsp;<span class="ident" id="4424704">mode</span><span class="op" id="4424708">&amp;</span><span class="ident" id="4424709">noIndent</span>&nbsp;<span class="op" id="4424718">==</span>&nbsp;<span class="num" id="4424721">0</span>&nbsp;<span class="op" id="4424723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424727">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424756">p</span><span class="op" id="4424757">.</span><span class="builtinfunc" id="4424758">print</span><span class="op" id="4424763">(</span><span class="ident" id="4424764">unindent</span><span class="op" id="4424772">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424775">}</span><br>
<span class="lineno"></span><span class="op" id="4424777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4424780">func</span>&nbsp;<span class="op" id="4424785">(</span><span class="ident" id="4424786">p</span>&nbsp;<span class="op" id="4424788">*</span><span class="ident" id="4424789">printer</span><span class="op" id="4424796">)</span>&nbsp;<span class="ident" id="4424798">parameters</span><span class="op" id="4424808">(</span><span class="ident" id="4424809">fields</span>&nbsp;<span class="op" id="4424816">*</span><span class="ident" id="4424817">ast</span><span class="op" id="4424820">.</span><span class="ident" id="4424821">FieldList</span><span class="op" id="4424830">)</span>&nbsp;<span class="op" id="4424832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424835">p</span><span class="op" id="4424836">.</span><span class="builtinfunc" id="4424837">print</span><span class="op" id="4424842">(</span><span class="ident" id="4424843">fields</span><span class="op" id="4424849">.</span><span class="ident" id="4424850">Opening</span><span class="op" id="4424857">,</span>&nbsp;<span class="ident" id="4424859">token</span><span class="op" id="4424864">.</span><span class="ident" id="4424865">LPAREN</span><span class="op" id="4424871">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424874">if</span>&nbsp;<span class="builtinfunc" id="4424877">len</span><span class="op" id="4424880">(</span><span class="ident" id="4424881">fields</span><span class="op" id="4424887">.</span><span class="ident" id="4424888">List</span><span class="op" id="4424892">)</span>&nbsp;<span class="op" id="4424894">&gt;</span>&nbsp;<span class="num" id="4424896">0</span>&nbsp;<span class="op" id="4424898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424902">prevLine</span>&nbsp;<span class="op" id="4424911">:=</span>&nbsp;<span class="ident" id="4424914">p</span><span class="op" id="4424915">.</span><span class="ident" id="4424916">lineFor</span><span class="op" id="4424923">(</span><span class="ident" id="4424924">fields</span><span class="op" id="4424930">.</span><span class="ident" id="4424931">Opening</span><span class="op" id="4424938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424942">ws</span>&nbsp;<span class="op" id="4424945">:=</span>&nbsp;<span class="ident" id="4424948">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424957">for</span>&nbsp;<span class="ident" id="4424961">i</span><span class="op" id="4424962">,</span>&nbsp;<span class="ident" id="4424964">par</span>&nbsp;<span class="op" id="4424968">:=</span>&nbsp;<span class="keyword" id="4424971">range</span>&nbsp;<span class="ident" id="4424977">fields</span><span class="op" id="4424983">.</span><span class="ident" id="4424984">List</span>&nbsp;<span class="op" id="4424989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424994">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425051">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425108">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425149">var</span>&nbsp;<span class="ident" id="4425153">parLineBeg</span>&nbsp;<span class="builtintype" id="4425164">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425171">if</span>&nbsp;<span class="builtinfunc" id="4425174">len</span><span class="op" id="4425177">(</span><span class="ident" id="4425178">par</span><span class="op" id="4425181">.</span><span class="ident" id="4425182">Names</span><span class="op" id="4425187">)</span>&nbsp;<span class="op" id="4425189">&gt;</span>&nbsp;<span class="num" id="4425191">0</span>&nbsp;<span class="op" id="4425193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425199">parLineBeg</span>&nbsp;<span class="op" id="4425210">=</span>&nbsp;<span class="ident" id="4425212">p</span><span class="op" id="4425213">.</span><span class="ident" id="4425214">lineFor</span><span class="op" id="4425221">(</span><span class="ident" id="4425222">par</span><span class="op" id="4425225">.</span><span class="ident" id="4425226">Names</span><span class="op" id="4425231">[</span><span class="num" id="4425232">0</span><span class="op" id="4425233">]</span><span class="op" id="4425234">.</span><span class="ident" id="4425235">Pos</span><span class="op" id="4425238">(</span><span class="op" id="4425239">)</span><span class="op" id="4425240">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425245">}</span>&nbsp;<span class="keyword" id="4425247">else</span>&nbsp;<span class="op" id="4425252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425258">parLineBeg</span>&nbsp;<span class="op" id="4425269">=</span>&nbsp;<span class="ident" id="4425271">p</span><span class="op" id="4425272">.</span><span class="ident" id="4425273">lineFor</span><span class="op" id="4425280">(</span><span class="ident" id="4425281">par</span><span class="op" id="4425284">.</span><span class="ident" id="4425285">Type</span><span class="op" id="4425289">.</span><span class="ident" id="4425290">Pos</span><span class="op" id="4425293">(</span><span class="op" id="4425294">)</span><span class="op" id="4425295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425305">var</span>&nbsp;<span class="ident" id="4425309">parLineEnd</span>&nbsp;<span class="op" id="4425320">=</span>&nbsp;<span class="ident" id="4425322">p</span><span class="op" id="4425323">.</span><span class="ident" id="4425324">lineFor</span><span class="op" id="4425331">(</span><span class="ident" id="4425332">par</span><span class="op" id="4425335">.</span><span class="ident" id="4425336">Type</span><span class="op" id="4425340">.</span><span class="ident" id="4425341">End</span><span class="op" id="4425344">(</span><span class="op" id="4425345">)</span><span class="op" id="4425346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425351">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425382">needsLinebreak</span>&nbsp;<span class="op" id="4425397">:=</span>&nbsp;<span class="num" id="4425400">0</span>&nbsp;<span class="op" id="4425402">&lt;</span>&nbsp;<span class="ident" id="4425404">prevLine</span>&nbsp;<span class="op" id="4425413">&amp;&amp;</span>&nbsp;<span class="ident" id="4425416">prevLine</span>&nbsp;<span class="op" id="4425425">&lt;</span>&nbsp;<span class="ident" id="4425427">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425441">if</span>&nbsp;<span class="ident" id="4425444">i</span>&nbsp;<span class="op" id="4425446">&gt;</span>&nbsp;<span class="num" id="4425448">0</span>&nbsp;<span class="op" id="4425450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425456">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425512">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425567">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425621">if</span>&nbsp;<span class="op" id="4425624">!</span><span class="ident" id="4425625">needsLinebreak</span>&nbsp;<span class="op" id="4425640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425647">p</span><span class="op" id="4425648">.</span><span class="builtinfunc" id="4425649">print</span><span class="op" id="4425654">(</span><span class="ident" id="4425655">par</span><span class="op" id="4425658">.</span><span class="ident" id="4425659">Pos</span><span class="op" id="4425662">(</span><span class="op" id="4425663">)</span><span class="op" id="4425664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425676">p</span><span class="op" id="4425677">.</span><span class="builtinfunc" id="4425678">print</span><span class="op" id="4425683">(</span><span class="ident" id="4425684">token</span><span class="op" id="4425689">.</span><span class="ident" id="4425690">COMMA</span><span class="op" id="4425695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425700">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425705">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425752">if</span>&nbsp;<span class="ident" id="4425755">needsLinebreak</span>&nbsp;<span class="op" id="4425770">&amp;&amp;</span>&nbsp;<span class="ident" id="4425773">p</span><span class="op" id="4425774">.</span><span class="ident" id="4425775">linebreak</span><span class="op" id="4425784">(</span><span class="ident" id="4425785">parLineBeg</span><span class="op" id="4425795">,</span>&nbsp;<span class="num" id="4425797">0</span><span class="op" id="4425798">,</span>&nbsp;<span class="ident" id="4425800">ws</span><span class="op" id="4425802">,</span>&nbsp;<span class="builtintype" id="4425804">true</span><span class="op" id="4425808">)</span>&nbsp;<span class="op" id="4425810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425816">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425901">ws</span>&nbsp;<span class="op" id="4425904">=</span>&nbsp;<span class="ident" id="4425906">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425916">}</span>&nbsp;<span class="keyword" id="4425918">else</span>&nbsp;<span class="keyword" id="4425923">if</span>&nbsp;<span class="ident" id="4425926">i</span>&nbsp;<span class="op" id="4425928">&gt;</span>&nbsp;<span class="num" id="4425930">0</span>&nbsp;<span class="op" id="4425932">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425938">p</span><span class="op" id="4425939">.</span><span class="builtinfunc" id="4425940">print</span><span class="op" id="4425945">(</span><span class="ident" id="4425946">blank</span><span class="op" id="4425951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425961">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425983">if</span>&nbsp;<span class="builtinfunc" id="4425986">len</span><span class="op" id="4425989">(</span><span class="ident" id="4425990">par</span><span class="op" id="4425993">.</span><span class="ident" id="4425994">Names</span><span class="op" id="4425999">)</span>&nbsp;<span class="op" id="4426001">&gt;</span>&nbsp;<span class="num" id="4426003">0</span>&nbsp;<span class="op" id="4426005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426011">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426079">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426150">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426223">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426299">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426376">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426408">p</span><span class="op" id="4426409">.</span><span class="ident" id="4426410">identList</span><span class="op" id="4426419">(</span><span class="ident" id="4426420">par</span><span class="op" id="4426423">.</span><span class="ident" id="4426424">Names</span><span class="op" id="4426429">,</span>&nbsp;<span class="ident" id="4426431">ws</span>&nbsp;<span class="op" id="4426434">==</span>&nbsp;<span class="ident" id="4426437">indent</span><span class="op" id="4426443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426449">p</span><span class="op" id="4426450">.</span><span class="builtinfunc" id="4426451">print</span><span class="op" id="4426456">(</span><span class="ident" id="4426457">blank</span><span class="op" id="4426462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426472">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426493">p</span><span class="op" id="4426494">.</span><span class="ident" id="4426495">expr</span><span class="op" id="4426499">(</span><span class="ident" id="4426500">stripParensAlways</span><span class="op" id="4426517">(</span><span class="ident" id="4426518">par</span><span class="op" id="4426521">.</span><span class="ident" id="4426522">Type</span><span class="op" id="4426526">)</span><span class="op" id="4426527">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426532">prevLine</span>&nbsp;<span class="op" id="4426541">=</span>&nbsp;<span class="ident" id="4426543">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426560">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426631">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426675">if</span>&nbsp;<span class="ident" id="4426678">closing</span>&nbsp;<span class="op" id="4426686">:=</span>&nbsp;<span class="ident" id="4426689">p</span><span class="op" id="4426690">.</span><span class="ident" id="4426691">lineFor</span><span class="op" id="4426698">(</span><span class="ident" id="4426699">fields</span><span class="op" id="4426705">.</span><span class="ident" id="4426706">Closing</span><span class="op" id="4426713">)</span><span class="op" id="4426714">;</span>&nbsp;<span class="num" id="4426716">0</span>&nbsp;<span class="op" id="4426718">&lt;</span>&nbsp;<span class="ident" id="4426720">prevLine</span>&nbsp;<span class="op" id="4426729">&amp;&amp;</span>&nbsp;<span class="ident" id="4426732">prevLine</span>&nbsp;<span class="op" id="4426741">&lt;</span>&nbsp;<span class="ident" id="4426743">closing</span>&nbsp;<span class="op" id="4426751">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426756">p</span><span class="op" id="4426757">.</span><span class="builtinfunc" id="4426758">print</span><span class="op" id="4426763">(</span><span class="ident" id="4426764">token</span><span class="op" id="4426769">.</span><span class="ident" id="4426770">COMMA</span><span class="op" id="4426775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426780">p</span><span class="op" id="4426781">.</span><span class="ident" id="4426782">linebreak</span><span class="op" id="4426791">(</span><span class="ident" id="4426792">closing</span><span class="op" id="4426799">,</span>&nbsp;<span class="num" id="4426801">0</span><span class="op" id="4426802">,</span>&nbsp;<span class="ident" id="4426804">ignore</span><span class="op" id="4426810">,</span>&nbsp;<span class="builtintype" id="4426812">true</span><span class="op" id="4426816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4426824">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426853">if</span>&nbsp;<span class="ident" id="4426856">ws</span>&nbsp;<span class="op" id="4426859">==</span>&nbsp;<span class="ident" id="4426862">ignore</span>&nbsp;<span class="op" id="4426869">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426874">p</span><span class="op" id="4426875">.</span><span class="builtinfunc" id="4426876">print</span><span class="op" id="4426881">(</span><span class="ident" id="4426882">unindent</span><span class="op" id="4426890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426900">p</span><span class="op" id="4426901">.</span><span class="builtinfunc" id="4426902">print</span><span class="op" id="4426907">(</span><span class="ident" id="4426908">fields</span><span class="op" id="4426914">.</span><span class="ident" id="4426915">Closing</span><span class="op" id="4426922">,</span>&nbsp;<span class="ident" id="4426924">token</span><span class="op" id="4426929">.</span><span class="ident" id="4426930">RPAREN</span><span class="op" id="4426936">)</span><br>
<span class="lineno"></span><span class="op" id="4426938">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4426941">func</span>&nbsp;<span class="op" id="4426946">(</span><span class="ident" id="4426947">p</span>&nbsp;<span class="op" id="4426949">*</span><span class="ident" id="4426950">printer</span><span class="op" id="4426957">)</span>&nbsp;<span class="ident" id="4426959">signature</span><span class="op" id="4426968">(</span><span class="ident" id="4426969">params</span><span class="op" id="4426975">,</span>&nbsp;<span class="ident" id="4426977">result</span>&nbsp;<span class="op" id="4426984">*</span><span class="ident" id="4426985">ast</span><span class="op" id="4426988">.</span><span class="ident" id="4426989">FieldList</span><span class="op" id="4426998">)</span>&nbsp;<span class="op" id="4427000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427003">if</span>&nbsp;<span class="ident" id="4427006">params</span>&nbsp;<span class="op" id="4427013">!=</span>&nbsp;<span class="ident" id="4427016">nil</span>&nbsp;<span class="op" id="4427020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427024">p</span><span class="op" id="4427025">.</span><span class="ident" id="4427026">parameters</span><span class="op" id="4427036">(</span><span class="ident" id="4427037">params</span><span class="op" id="4427043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427046">}</span>&nbsp;<span class="keyword" id="4427048">else</span>&nbsp;<span class="op" id="4427053">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427057">p</span><span class="op" id="4427058">.</span><span class="builtinfunc" id="4427059">print</span><span class="op" id="4427064">(</span><span class="ident" id="4427065">token</span><span class="op" id="4427070">.</span><span class="ident" id="4427071">LPAREN</span><span class="op" id="4427077">,</span>&nbsp;<span class="ident" id="4427079">token</span><span class="op" id="4427084">.</span><span class="ident" id="4427085">RPAREN</span><span class="op" id="4427091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427097">n</span>&nbsp;<span class="op" id="4427099">:=</span>&nbsp;<span class="ident" id="4427102">result</span><span class="op" id="4427108">.</span><span class="ident" id="4427109">NumFields</span><span class="op" id="4427118">(</span><span class="op" id="4427119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427122">if</span>&nbsp;<span class="ident" id="4427125">n</span>&nbsp;<span class="op" id="4427127">&gt;</span>&nbsp;<span class="num" id="4427129">0</span>&nbsp;<span class="op" id="4427131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4427135">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427154">p</span><span class="op" id="4427155">.</span><span class="builtinfunc" id="4427156">print</span><span class="op" id="4427161">(</span><span class="ident" id="4427162">blank</span><span class="op" id="4427167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427171">if</span>&nbsp;<span class="ident" id="4427174">n</span>&nbsp;<span class="op" id="4427176">==</span>&nbsp;<span class="num" id="4427179">1</span>&nbsp;<span class="op" id="4427181">&amp;&amp;</span>&nbsp;<span class="ident" id="4427184">result</span><span class="op" id="4427190">.</span><span class="ident" id="4427191">List</span><span class="op" id="4427195">[</span><span class="num" id="4427196">0</span><span class="op" id="4427197">]</span><span class="op" id="4427198">.</span><span class="ident" id="4427199">Names</span>&nbsp;<span class="op" id="4427205">==</span>&nbsp;<span class="ident" id="4427208">nil</span>&nbsp;<span class="op" id="4427212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4427217">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427256">p</span><span class="op" id="4427257">.</span><span class="ident" id="4427258">expr</span><span class="op" id="4427262">(</span><span class="ident" id="4427263">stripParensAlways</span><span class="op" id="4427280">(</span><span class="ident" id="4427281">result</span><span class="op" id="4427287">.</span><span class="ident" id="4427288">List</span><span class="op" id="4427292">[</span><span class="num" id="4427293">0</span><span class="op" id="4427294">]</span><span class="op" id="4427295">.</span><span class="ident" id="4427296">Type</span><span class="op" id="4427300">)</span><span class="op" id="4427301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427306">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427319">p</span><span class="op" id="4427320">.</span><span class="ident" id="4427321">parameters</span><span class="op" id="4427331">(</span><span class="ident" id="4427332">result</span><span class="op" id="4427338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427341">}</span><br>
<span class="lineno"></span><span class="op" id="4427343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4427346">func</span>&nbsp;<span class="ident" id="4427351">identListSize</span><span class="op" id="4427364">(</span><span class="ident" id="4427365">list</span>&nbsp;<span class="op" id="4427370">[</span><span class="op" id="4427371">]</span><span class="op" id="4427372">*</span><span class="ident" id="4427373">ast</span><span class="op" id="4427376">.</span><span class="ident" id="4427377">Ident</span><span class="op" id="4427382">,</span>&nbsp;<span class="ident" id="4427384">maxSize</span>&nbsp;<span class="builtintype" id="4427392">int</span><span class="op" id="4427395">)</span>&nbsp;<span class="op" id="4427397">(</span><span class="ident" id="4427398">size</span>&nbsp;<span class="builtintype" id="4427403">int</span><span class="op" id="4427406">)</span>&nbsp;<span class="op" id="4427408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427411">for</span>&nbsp;<span class="ident" id="4427415">i</span><span class="op" id="4427416">,</span>&nbsp;<span class="ident" id="4427418">x</span>&nbsp;<span class="op" id="4427420">:=</span>&nbsp;<span class="keyword" id="4427423">range</span>&nbsp;<span class="ident" id="4427429">list</span>&nbsp;<span class="op" id="4427434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427438">if</span>&nbsp;<span class="ident" id="4427441">i</span>&nbsp;<span class="op" id="4427443">&gt;</span>&nbsp;<span class="num" id="4427445">0</span>&nbsp;<span class="op" id="4427447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427452">size</span>&nbsp;<span class="op" id="4427457">+=</span>&nbsp;<span class="builtinfunc" id="4427460">len</span><span class="op" id="4427463">(</span><span class="string" id="4427464">&#34;,&nbsp;&#34;</span><span class="op" id="4427468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427472">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427476">size</span>&nbsp;<span class="op" id="4427481">+=</span>&nbsp;<span class="ident" id="4427484">utf8</span><span class="op" id="4427488">.</span><span class="ident" id="4427489">RuneCountInString</span><span class="op" id="4427506">(</span><span class="ident" id="4427507">x</span><span class="op" id="4427508">.</span><span class="ident" id="4427509">Name</span><span class="op" id="4427513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427517">if</span>&nbsp;<span class="ident" id="4427520">size</span>&nbsp;<span class="op" id="4427525">&gt;=</span>&nbsp;<span class="ident" id="4427528">maxSize</span>&nbsp;<span class="op" id="4427536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427541">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427552">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427555">return</span><br>
<span class="lineno"></span><span class="op" id="4427562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4427565">func</span>&nbsp;<span class="op" id="4427570">(</span><span class="ident" id="4427571">p</span>&nbsp;<span class="op" id="4427573">*</span><span class="ident" id="4427574">printer</span><span class="op" id="4427581">)</span>&nbsp;<span class="ident" id="4427583">isOneLineFieldList</span><span class="op" id="4427601">(</span><span class="ident" id="4427602">list</span>&nbsp;<span class="op" id="4427607">[</span><span class="op" id="4427608">]</span><span class="op" id="4427609">*</span><span class="ident" id="4427610">ast</span><span class="op" id="4427613">.</span><span class="ident" id="4427614">Field</span><span class="op" id="4427619">)</span>&nbsp;<span class="builtintype" id="4427621">bool</span>&nbsp;<span class="op" id="4427626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427629">if</span>&nbsp;<span class="builtinfunc" id="4427632">len</span><span class="op" id="4427635">(</span><span class="ident" id="4427636">list</span><span class="op" id="4427640">)</span>&nbsp;<span class="op" id="4427642">!=</span>&nbsp;<span class="num" id="4427645">1</span>&nbsp;<span class="op" id="4427647">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427651">return</span>&nbsp;<span class="builtintype" id="4427658">false</span>&nbsp;<span class="comment" id="4427664">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427692">f</span>&nbsp;<span class="op" id="4427694">:=</span>&nbsp;<span class="ident" id="4427697">list</span><span class="op" id="4427701">[</span><span class="num" id="4427702">0</span><span class="op" id="4427703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427706">if</span>&nbsp;<span class="ident" id="4427709">f</span><span class="op" id="4427710">.</span><span class="ident" id="4427711">Tag</span>&nbsp;<span class="op" id="4427715">!=</span>&nbsp;<span class="ident" id="4427718">nil</span>&nbsp;<span class="op" id="4427722">||</span>&nbsp;<span class="ident" id="4427725">f</span><span class="op" id="4427726">.</span><span class="ident" id="4427727">Comment</span>&nbsp;<span class="op" id="4427735">!=</span>&nbsp;<span class="ident" id="4427738">nil</span>&nbsp;<span class="op" id="4427742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427746">return</span>&nbsp;<span class="builtintype" id="4427753">false</span>&nbsp;<span class="comment" id="4427759">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4427795">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427821">const</span>&nbsp;<span class="ident" id="4427827">maxSize</span>&nbsp;<span class="op" id="4427835">=</span>&nbsp;<span class="num" id="4427837">30</span>&nbsp;<span class="comment" id="4427840">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427896">namesSize</span>&nbsp;<span class="op" id="4427906">:=</span>&nbsp;<span class="ident" id="4427909">identListSize</span><span class="op" id="4427922">(</span><span class="ident" id="4427923">f</span><span class="op" id="4427924">.</span><span class="ident" id="4427925">Names</span><span class="op" id="4427930">,</span>&nbsp;<span class="ident" id="4427932">maxSize</span><span class="op" id="4427939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427942">if</span>&nbsp;<span class="ident" id="4427945">namesSize</span>&nbsp;<span class="op" id="4427955">&gt;</span>&nbsp;<span class="num" id="4427957">0</span>&nbsp;<span class="op" id="4427959">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427963">namesSize</span>&nbsp;<span class="op" id="4427973">=</span>&nbsp;<span class="num" id="4427975">1</span>&nbsp;<span class="comment" id="4427977">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4428011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428014">typeSize</span>&nbsp;<span class="op" id="4428023">:=</span>&nbsp;<span class="ident" id="4428026">p</span><span class="op" id="4428027">.</span><span class="ident" id="4428028">nodeSize</span><span class="op" id="4428036">(</span><span class="ident" id="4428037">f</span><span class="op" id="4428038">.</span><span class="ident" id="4428039">Type</span><span class="op" id="4428043">,</span>&nbsp;<span class="ident" id="4428045">maxSize</span><span class="op" id="4428052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428055">return</span>&nbsp;<span class="ident" id="4428062">namesSize</span><span class="op" id="4428071">+</span><span class="ident" id="4428072">typeSize</span>&nbsp;<span class="op" id="4428081">&lt;=</span>&nbsp;<span class="ident" id="4428084">maxSize</span><br>
<span class="lineno"></span><span class="op" id="4428092">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="4428095">func</span>&nbsp;<span class="op" id="4428100">(</span><span class="ident" id="4428101">p</span>&nbsp;<span class="op" id="4428103">*</span><span class="ident" id="4428104">printer</span><span class="op" id="4428111">)</span>&nbsp;<span class="ident" id="4428113">setLineComment</span><span class="op" id="4428127">(</span><span class="ident" id="4428128">text</span>&nbsp;<span class="builtintype" id="4428133">string</span><span class="op" id="4428139">)</span>&nbsp;<span class="op" id="4428141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428144">p</span><span class="op" id="4428145">.</span><span class="ident" id="4428146">setComment</span><span class="op" id="4428156">(</span><span class="op" id="4428157">&amp;</span><span class="ident" id="4428158">ast</span><span class="op" id="4428161">.</span><span class="ident" id="4428162">CommentGroup</span><span class="op" id="4428174">{</span><span class="ident" id="4428175">List</span><span class="op" id="4428179">:</span>&nbsp;<span class="op" id="4428181">[</span><span class="op" id="4428182">]</span><span class="op" id="4428183">*</span><span class="ident" id="4428184">ast</span><span class="op" id="4428187">.</span><span class="ident" id="4428188">Comment</span><span class="op" id="4428195">{</span><span class="op" id="4428196">{</span><span class="ident" id="4428197">Slash</span><span class="op" id="4428202">:</span>&nbsp;<span class="ident" id="4428204">token</span><span class="op" id="4428209">.</span><span class="ident" id="4428210">NoPos</span><span class="op" id="4428215">,</span>&nbsp;<span class="ident" id="4428217">Text</span><span class="op" id="4428221">:</span>&nbsp;<span class="ident" id="4428223">text</span><span class="op" id="4428227">}</span><span class="op" id="4428228">}</span><span class="op" id="4428229">}</span><span class="op" id="4428230">)</span><br>
<span class="lineno"></span><span class="op" id="4428232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="4428235">func</span>&nbsp;<span class="op" id="4428240">(</span><span class="ident" id="4428241">p</span>&nbsp;<span class="op" id="4428243">*</span><span class="ident" id="4428244">printer</span><span class="op" id="4428251">)</span>&nbsp;<span class="ident" id="4428253">fieldList</span><span class="op" id="4428262">(</span><span class="ident" id="4428263">fields</span>&nbsp;<span class="op" id="4428270">*</span><span class="ident" id="4428271">ast</span><span class="op" id="4428274">.</span><span class="ident" id="4428275">FieldList</span><span class="op" id="4428284">,</span>&nbsp;<span class="ident" id="4428286">isStruct</span><span class="op" id="4428294">,</span>&nbsp;<span class="ident" id="4428296">isIncomplete</span>&nbsp;<span class="builtintype" id="4428309">bool</span><span class="op" id="4428313">)</span>&nbsp;<span class="op" id="4428315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428318">lbrace</span>&nbsp;<span class="op" id="4428325">:=</span>&nbsp;<span class="ident" id="4428328">fields</span><span class="op" id="4428334">.</span><span class="ident" id="4428335">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428344">list</span>&nbsp;<span class="op" id="4428349">:=</span>&nbsp;<span class="ident" id="4428352">fields</span><span class="op" id="4428358">.</span><span class="ident" id="4428359">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428365">rbrace</span>&nbsp;<span class="op" id="4428372">:=</span>&nbsp;<span class="ident" id="4428375">fields</span><span class="op" id="4428381">.</span><span class="ident" id="4428382">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428391">hasComments</span>&nbsp;<span class="op" id="4428403">:=</span>&nbsp;<span class="ident" id="4428406">isIncomplete</span>&nbsp;<span class="op" id="4428419">||</span>&nbsp;<span class="ident" id="4428422">p</span><span class="op" id="4428423">.</span><span class="ident" id="4428424">commentBefore</span><span class="op" id="4428437">(</span><span class="ident" id="4428438">p</span><span class="op" id="4428439">.</span><span class="ident" id="4428440">posFor</span><span class="op" id="4428446">(</span><span class="ident" id="4428447">rbrace</span><span class="op" id="4428453">)</span><span class="op" id="4428454">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428457">srcIsOneLine</span>&nbsp;<span class="op" id="4428470">:=</span>&nbsp;<span class="ident" id="4428473">lbrace</span><span class="op" id="4428479">.</span><span class="ident" id="4428480">IsValid</span><span class="op" id="4428487">(</span><span class="op" id="4428488">)</span>&nbsp;<span class="op" id="4428490">&amp;&amp;</span>&nbsp;<span class="ident" id="4428493">rbrace</span><span class="op" id="4428499">.</span><span class="ident" id="4428500">IsValid</span><span class="op" id="4428507">(</span><span class="op" id="4428508">)</span>&nbsp;<span class="op" id="4428510">&amp;&amp;</span>&nbsp;<span class="ident" id="4428513">p</span><span class="op" id="4428514">.</span><span class="ident" id="4428515">lineFor</span><span class="op" id="4428522">(</span><span class="ident" id="4428523">lbrace</span><span class="op" id="4428529">)</span>&nbsp;<span class="op" id="4428531">==</span>&nbsp;<span class="ident" id="4428534">p</span><span class="op" id="4428535">.</span><span class="ident" id="4428536">lineFor</span><span class="op" id="4428543">(</span><span class="ident" id="4428544">rbrace</span><span class="op" id="4428550">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428554">if</span>&nbsp;<span class="op" id="4428557">!</span><span class="ident" id="4428558">hasComments</span>&nbsp;<span class="op" id="4428570">&amp;&amp;</span>&nbsp;<span class="ident" id="4428573">srcIsOneLine</span>&nbsp;<span class="op" id="4428586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4428590">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428632">if</span>&nbsp;<span class="builtinfunc" id="4428635">len</span><span class="op" id="4428638">(</span><span class="ident" id="4428639">list</span><span class="op" id="4428643">)</span>&nbsp;<span class="op" id="4428645">==</span>&nbsp;<span class="num" id="4428648">0</span>&nbsp;<span class="op" id="4428650">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4428655">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428706">p</span><span class="op" id="4428707">.</span><span class="builtinfunc" id="4428708">print</span><span class="op" id="4428713">(</span><span class="ident" id="4428714">lbrace</span><span class="op" id="4428720">,</span>&nbsp;<span class="ident" id="4428722">token</span><span class="op" id="4428727">.</span><span class="ident" id="4428728">LBRACE</span><span class="op" id="4428734">,</span>&nbsp;<span class="ident" id="4428736">rbrace</span><span class="op" id="4428742">,</span>&nbsp;<span class="ident" id="4428744">token</span><span class="op" id="4428749">.</span><span class="ident" id="4428750">RBRACE</span><span class="op" id="4428756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4428770">}</span>&nbsp;<span class="keyword" id="4428772">else</span>&nbsp;<span class="keyword" id="4428777">if</span>&nbsp;<span class="ident" id="4428780">isStruct</span>&nbsp;<span class="op" id="4428789">&amp;&amp;</span>&nbsp;<span class="ident" id="4428792">p</span><span class="op" id="4428793">.</span><span class="ident" id="4428794">isOneLineFieldList</span><span class="op" id="4428812">(</span><span class="ident" id="4428813">list</span><span class="op" id="4428817">)</span>&nbsp;<span class="op" id="4428819">{</span>&nbsp;<span class="comment" id="4428821">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4428853">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4428892">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428950">p</span><span class="op" id="4428951">.</span><span class="builtinfunc" id="4428952">print</span><span class="op" id="4428957">(</span><span class="ident" id="4428958">lbrace</span><span class="op" id="4428964">,</span>&nbsp;<span class="ident" id="4428966">token</span><span class="op" id="4428971">.</span><span class="ident" id="4428972">LBRACE</span><span class="op" id="4428978">,</span>&nbsp;<span class="ident" id="4428980">blank</span><span class="op" id="4428985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428990">f</span>&nbsp;<span class="op" id="4428992">:=</span>&nbsp;<span class="ident" id="4428995">list</span><span class="op" id="4428999">[</span><span class="num" id="4429000">0</span><span class="op" id="4429001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429006">for</span>&nbsp;<span class="ident" id="4429010">i</span><span class="op" id="4429011">,</span>&nbsp;<span class="ident" id="4429013">x</span>&nbsp;<span class="op" id="4429015">:=</span>&nbsp;<span class="keyword" id="4429018">range</span>&nbsp;<span class="ident" id="4429024">f</span><span class="op" id="4429025">.</span><span class="ident" id="4429026">Names</span>&nbsp;<span class="op" id="4429032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429038">if</span>&nbsp;<span class="ident" id="4429041">i</span>&nbsp;<span class="op" id="4429043">&gt;</span>&nbsp;<span class="num" id="4429045">0</span>&nbsp;<span class="op" id="4429047">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4429054">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429104">p</span><span class="op" id="4429105">.</span><span class="builtinfunc" id="4429106">print</span><span class="op" id="4429111">(</span><span class="ident" id="4429112">token</span><span class="op" id="4429117">.</span><span class="ident" id="4429118">COMMA</span><span class="op" id="4429123">,</span>&nbsp;<span class="ident" id="4429125">blank</span><span class="op" id="4429130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429142">p</span><span class="op" id="4429143">.</span><span class="ident" id="4429144">expr</span><span class="op" id="4429148">(</span><span class="ident" id="4429149">x</span><span class="op" id="4429150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429155">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429160">if</span>&nbsp;<span class="builtinfunc" id="4429163">len</span><span class="op" id="4429166">(</span><span class="ident" id="4429167">f</span><span class="op" id="4429168">.</span><span class="ident" id="4429169">Names</span><span class="op" id="4429174">)</span>&nbsp;<span class="op" id="4429176">&gt;</span>&nbsp;<span class="num" id="4429178">0</span>&nbsp;<span class="op" id="4429180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429186">p</span><span class="op" id="4429187">.</span><span class="builtinfunc" id="4429188">print</span><span class="op" id="4429193">(</span><span class="ident" id="4429194">blank</span><span class="op" id="4429199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429209">p</span><span class="op" id="4429210">.</span><span class="ident" id="4429211">expr</span><span class="op" id="4429215">(</span><span class="ident" id="4429216">f</span><span class="op" id="4429217">.</span><span class="ident" id="4429218">Type</span><span class="op" id="4429222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429227">p</span><span class="op" id="4429228">.</span><span class="builtinfunc" id="4429229">print</span><span class="op" id="4429234">(</span><span class="ident" id="4429235">blank</span><span class="op" id="4429240">,</span>&nbsp;<span class="ident" id="4429242">rbrace</span><span class="op" id="4429248">,</span>&nbsp;<span class="ident" id="4429250">token</span><span class="op" id="4429255">.</span><span class="ident" id="4429256">RBRACE</span><span class="op" id="4429262">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429267">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4429282">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429316">p</span><span class="op" id="4429317">.</span><span class="builtinfunc" id="4429318">print</span><span class="op" id="4429323">(</span><span class="ident" id="4429324">blank</span><span class="op" id="4429329">,</span>&nbsp;<span class="ident" id="4429331">lbrace</span><span class="op" id="4429337">,</span>&nbsp;<span class="ident" id="4429339">token</span><span class="op" id="4429344">.</span><span class="ident" id="4429345">LBRACE</span><span class="op" id="4429351">,</span>&nbsp;<span class="ident" id="4429353">indent</span><span class="op" id="4429359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429362">if</span>&nbsp;<span class="ident" id="4429365">hasComments</span>&nbsp;<span class="op" id="4429377">||</span>&nbsp;<span class="builtinfunc" id="4429380">len</span><span class="op" id="4429383">(</span><span class="ident" id="4429384">list</span><span class="op" id="4429388">)</span>&nbsp;<span class="op" id="4429390">&gt;</span>&nbsp;<span class="num" id="4429392">0</span>&nbsp;<span class="op" id="4429394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429398">p</span><span class="op" id="4429399">.</span><span class="builtinfunc" id="4429400">print</span><span class="op" id="4429405">(</span><span class="ident" id="4429406">formfeed</span><span class="op" id="4429414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429421">if</span>&nbsp;<span class="ident" id="4429424">isStruct</span>&nbsp;<span class="op" id="4429433">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429438">sep</span>&nbsp;<span class="op" id="4429442">:=</span>&nbsp;<span class="ident" id="4429445">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429452">if</span>&nbsp;<span class="builtinfunc" id="4429455">len</span><span class="op" id="4429458">(</span><span class="ident" id="4429459">list</span><span class="op" id="4429463">)</span>&nbsp;<span class="op" id="4429465">==</span>&nbsp;<span class="num" id="4429468">1</span>&nbsp;<span class="op" id="4429470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429475">sep</span>&nbsp;<span class="op" id="4429479">=</span>&nbsp;<span class="ident" id="4429481">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429493">var</span>&nbsp;<span class="ident" id="4429497">line</span>&nbsp;<span class="builtintype" id="4429502">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429508">for</span>&nbsp;<span class="ident" id="4429512">i</span><span class="op" id="4429513">,</span>&nbsp;<span class="ident" id="4429515">f</span>&nbsp;<span class="op" id="4429517">:=</span>&nbsp;<span class="keyword" id="4429520">range</span>&nbsp;<span class="ident" id="4429526">list</span>&nbsp;<span class="op" id="4429531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429536">if</span>&nbsp;<span class="ident" id="4429539">i</span>&nbsp;<span class="op" id="4429541">&gt;</span>&nbsp;<span class="num" id="4429543">0</span>&nbsp;<span class="op" id="4429545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429551">p</span><span class="op" id="4429552">.</span><span class="ident" id="4429553">linebreak</span><span class="op" id="4429562">(</span><span class="ident" id="4429563">p</span><span class="op" id="4429564">.</span><span class="ident" id="4429565">lineFor</span><span class="op" id="4429572">(</span><span class="ident" id="4429573">f</span><span class="op" id="4429574">.</span><span class="ident" id="4429575">Pos</span><span class="op" id="4429578">(</span><span class="op" id="4429579">)</span><span class="op" id="4429580">)</span><span class="op" id="4429581">,</span>&nbsp;<span class="num" id="4429583">1</span><span class="op" id="4429584">,</span>&nbsp;<span class="ident" id="4429586">ignore</span><span class="op" id="4429592">,</span>&nbsp;<span class="ident" id="4429594">p</span><span class="op" id="4429595">.</span><span class="ident" id="4429596">linesFrom</span><span class="op" id="4429605">(</span><span class="ident" id="4429606">line</span><span class="op" id="4429610">)</span>&nbsp;<span class="op" id="4429612">&gt;</span>&nbsp;<span class="num" id="4429614">0</span><span class="op" id="4429615">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429625">extraTabs</span>&nbsp;<span class="op" id="4429635">:=</span>&nbsp;<span class="num" id="4429638">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429643">p</span><span class="op" id="4429644">.</span><span class="ident" id="4429645">setComment</span><span class="op" id="4429655">(</span><span class="ident" id="4429656">f</span><span class="op" id="4429657">.</span><span class="ident" id="4429658">Doc</span><span class="op" id="4429661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429666">p</span><span class="op" id="4429667">.</span><span class="ident" id="4429668">recordLine</span><span class="op" id="4429678">(</span><span class="op" id="4429679">&amp;</span><span class="ident" id="4429680">line</span><span class="op" id="4429684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429689">if</span>&nbsp;<span class="builtinfunc" id="4429692">len</span><span class="op" id="4429695">(</span><span class="ident" id="4429696">f</span><span class="op" id="4429697">.</span><span class="ident" id="4429698">Names</span><span class="op" id="4429703">)</span>&nbsp;<span class="op" id="4429705">&gt;</span>&nbsp;<span class="num" id="4429707">0</span>&nbsp;<span class="op" id="4429709">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4429715">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429735">p</span><span class="op" id="4429736">.</span><span class="ident" id="4429737">identList</span><span class="op" id="4429746">(</span><span class="ident" id="4429747">f</span><span class="op" id="4429748">.</span><span class="ident" id="4429749">Names</span><span class="op" id="4429754">,</span>&nbsp;<span class="builtintype" id="4429756">false</span><span class="op" id="4429761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429767">p</span><span class="op" id="4429768">.</span><span class="builtinfunc" id="4429769">print</span><span class="op" id="4429774">(</span><span class="ident" id="4429775">sep</span><span class="op" id="4429778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429784">p</span><span class="op" id="4429785">.</span><span class="ident" id="4429786">expr</span><span class="op" id="4429790">(</span><span class="ident" id="4429791">f</span><span class="op" id="4429792">.</span><span class="ident" id="4429793">Type</span><span class="op" id="4429797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429803">extraTabs</span>&nbsp;<span class="op" id="4429813">=</span>&nbsp;<span class="num" id="4429815">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429820">}</span>&nbsp;<span class="keyword" id="4429822">else</span>&nbsp;<span class="op" id="4429827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4429833">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429856">p</span><span class="op" id="4429857">.</span><span class="ident" id="4429858">expr</span><span class="op" id="4429862">(</span><span class="ident" id="4429863">f</span><span class="op" id="4429864">.</span><span class="ident" id="4429865">Type</span><span class="op" id="4429869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429875">extraTabs</span>&nbsp;<span class="op" id="4429885">=</span>&nbsp;<span class="num" id="4429887">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429892">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429897">if</span>&nbsp;<span class="ident" id="4429900">f</span><span class="op" id="4429901">.</span><span class="ident" id="4429902">Tag</span>&nbsp;<span class="op" id="4429906">!=</span>&nbsp;<span class="ident" id="4429909">nil</span>&nbsp;<span class="op" id="4429913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429919">if</span>&nbsp;<span class="builtinfunc" id="4429922">len</span><span class="op" id="4429925">(</span><span class="ident" id="4429926">f</span><span class="op" id="4429927">.</span><span class="ident" id="4429928">Names</span><span class="op" id="4429933">)</span>&nbsp;<span class="op" id="4429935">&gt;</span>&nbsp;<span class="num" id="4429937">0</span>&nbsp;<span class="op" id="4429939">&amp;&amp;</span>&nbsp;<span class="ident" id="4429942">sep</span>&nbsp;<span class="op" id="4429946">==</span>&nbsp;<span class="ident" id="4429949">vtab</span>&nbsp;<span class="op" id="4429954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429961">p</span><span class="op" id="4429962">.</span><span class="builtinfunc" id="4429963">print</span><span class="op" id="4429968">(</span><span class="ident" id="4429969">sep</span><span class="op" id="4429972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429984">p</span><span class="op" id="4429985">.</span><span class="builtinfunc" id="4429986">print</span><span class="op" id="4429991">(</span><span class="ident" id="4429992">sep</span><span class="op" id="4429995">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430001">p</span><span class="op" id="4430002">.</span><span class="ident" id="4430003">expr</span><span class="op" id="4430007">(</span><span class="ident" id="4430008">f</span><span class="op" id="4430009">.</span><span class="ident" id="4430010">Tag</span><span class="op" id="4430013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430019">extraTabs</span>&nbsp;<span class="op" id="4430029">=</span>&nbsp;<span class="num" id="4430031">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430041">if</span>&nbsp;<span class="ident" id="4430044">f</span><span class="op" id="4430045">.</span><span class="ident" id="4430046">Comment</span>&nbsp;<span class="op" id="4430054">!=</span>&nbsp;<span class="ident" id="4430057">nil</span>&nbsp;<span class="op" id="4430061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430067">for</span>&nbsp;<span class="op" id="4430071">;</span>&nbsp;<span class="ident" id="4430073">extraTabs</span>&nbsp;<span class="op" id="4430083">&gt;</span>&nbsp;<span class="num" id="4430085">0</span><span class="op" id="4430086">;</span>&nbsp;<span class="ident" id="4430088">extraTabs</span><span class="op" id="4430097">--</span>&nbsp;<span class="op" id="4430100">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430107">p</span><span class="op" id="4430108">.</span><span class="builtinfunc" id="4430109">print</span><span class="op" id="4430114">(</span><span class="ident" id="4430115">sep</span><span class="op" id="4430118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430130">p</span><span class="op" id="4430131">.</span><span class="ident" id="4430132">setComment</span><span class="op" id="4430142">(</span><span class="ident" id="4430143">f</span><span class="op" id="4430144">.</span><span class="ident" id="4430145">Comment</span><span class="op" id="4430152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430161">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430165">if</span>&nbsp;<span class="ident" id="4430168">isIncomplete</span>&nbsp;<span class="op" id="4430181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430186">if</span>&nbsp;<span class="builtinfunc" id="4430189">len</span><span class="op" id="4430192">(</span><span class="ident" id="4430193">list</span><span class="op" id="4430197">)</span>&nbsp;<span class="op" id="4430199">&gt;</span>&nbsp;<span class="num" id="4430201">0</span>&nbsp;<span class="op" id="4430203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430209">p</span><span class="op" id="4430210">.</span><span class="builtinfunc" id="4430211">print</span><span class="op" id="4430216">(</span><span class="ident" id="4430217">formfeed</span><span class="op" id="4430225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430235">p</span><span class="op" id="4430236">.</span><span class="ident" id="4430237">flush</span><span class="op" id="4430242">(</span><span class="ident" id="4430243">p</span><span class="op" id="4430244">.</span><span class="ident" id="4430245">posFor</span><span class="op" id="4430251">(</span><span class="ident" id="4430252">rbrace</span><span class="op" id="4430258">)</span><span class="op" id="4430259">,</span>&nbsp;<span class="ident" id="4430261">token</span><span class="op" id="4430266">.</span><span class="ident" id="4430267">RBRACE</span><span class="op" id="4430273">)</span>&nbsp;<span class="comment" id="4430275">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430327">p</span><span class="op" id="4430328">.</span><span class="ident" id="4430329">setLineComment</span><span class="op" id="4430343">(</span><span class="string" id="4430344">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="4430387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430395">}</span>&nbsp;<span class="keyword" id="4430397">else</span>&nbsp;<span class="op" id="4430402">{</span>&nbsp;<span class="comment" id="4430404">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430420">var</span>&nbsp;<span class="ident" id="4430424">line</span>&nbsp;<span class="builtintype" id="4430429">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430435">for</span>&nbsp;<span class="ident" id="4430439">i</span><span class="op" id="4430440">,</span>&nbsp;<span class="ident" id="4430442">f</span>&nbsp;<span class="op" id="4430444">:=</span>&nbsp;<span class="keyword" id="4430447">range</span>&nbsp;<span class="ident" id="4430453">list</span>&nbsp;<span class="op" id="4430458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430463">if</span>&nbsp;<span class="ident" id="4430466">i</span>&nbsp;<span class="op" id="4430468">&gt;</span>&nbsp;<span class="num" id="4430470">0</span>&nbsp;<span class="op" id="4430472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430478">p</span><span class="op" id="4430479">.</span><span class="ident" id="4430480">linebreak</span><span class="op" id="4430489">(</span><span class="ident" id="4430490">p</span><span class="op" id="4430491">.</span><span class="ident" id="4430492">lineFor</span><span class="op" id="4430499">(</span><span class="ident" id="4430500">f</span><span class="op" id="4430501">.</span><span class="ident" id="4430502">Pos</span><span class="op" id="4430505">(</span><span class="op" id="4430506">)</span><span class="op" id="4430507">)</span><span class="op" id="4430508">,</span>&nbsp;<span class="num" id="4430510">1</span><span class="op" id="4430511">,</span>&nbsp;<span class="ident" id="4430513">ignore</span><span class="op" id="4430519">,</span>&nbsp;<span class="ident" id="4430521">p</span><span class="op" id="4430522">.</span><span class="ident" id="4430523">linesFrom</span><span class="op" id="4430532">(</span><span class="ident" id="4430533">line</span><span class="op" id="4430537">)</span>&nbsp;<span class="op" id="4430539">&gt;</span>&nbsp;<span class="num" id="4430541">0</span><span class="op" id="4430542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430547">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430552">p</span><span class="op" id="4430553">.</span><span class="ident" id="4430554">setComment</span><span class="op" id="4430564">(</span><span class="ident" id="4430565">f</span><span class="op" id="4430566">.</span><span class="ident" id="4430567">Doc</span><span class="op" id="4430570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430575">p</span><span class="op" id="4430576">.</span><span class="ident" id="4430577">recordLine</span><span class="op" id="4430587">(</span><span class="op" id="4430588">&amp;</span><span class="ident" id="4430589">line</span><span class="op" id="4430593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430598">if</span>&nbsp;<span class="ident" id="4430601">ftyp</span><span class="op" id="4430605">,</span>&nbsp;<span class="ident" id="4430607">isFtyp</span>&nbsp;<span class="op" id="4430614">:=</span>&nbsp;<span class="ident" id="4430617">f</span><span class="op" id="4430618">.</span><span class="ident" id="4430619">Type</span><span class="op" id="4430623">.</span><span class="op" id="4430624">(</span><span class="op" id="4430625">*</span><span class="ident" id="4430626">ast</span><span class="op" id="4430629">.</span><span class="ident" id="4430630">FuncType</span><span class="op" id="4430638">)</span><span class="op" id="4430639">;</span>&nbsp;<span class="ident" id="4430641">isFtyp</span>&nbsp;<span class="op" id="4430648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4430654">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430668">p</span><span class="op" id="4430669">.</span><span class="ident" id="4430670">expr</span><span class="op" id="4430674">(</span><span class="ident" id="4430675">f</span><span class="op" id="4430676">.</span><span class="ident" id="4430677">Names</span><span class="op" id="4430682">[</span><span class="num" id="4430683">0</span><span class="op" id="4430684">]</span><span class="op" id="4430685">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430691">p</span><span class="op" id="4430692">.</span><span class="ident" id="4430693">signature</span><span class="op" id="4430702">(</span><span class="ident" id="4430703">ftyp</span><span class="op" id="4430707">.</span><span class="ident" id="4430708">Params</span><span class="op" id="4430714">,</span>&nbsp;<span class="ident" id="4430716">ftyp</span><span class="op" id="4430720">.</span><span class="ident" id="4430721">Results</span><span class="op" id="4430728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430733">}</span>&nbsp;<span class="keyword" id="4430735">else</span>&nbsp;<span class="op" id="4430740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4430746">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430772">p</span><span class="op" id="4430773">.</span><span class="ident" id="4430774">expr</span><span class="op" id="4430778">(</span><span class="ident" id="4430779">f</span><span class="op" id="4430780">.</span><span class="ident" id="4430781">Type</span><span class="op" id="4430785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430790">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430795">p</span><span class="op" id="4430796">.</span><span class="ident" id="4430797">setComment</span><span class="op" id="4430807">(</span><span class="ident" id="4430808">f</span><span class="op" id="4430809">.</span><span class="ident" id="4430810">Comment</span><span class="op" id="4430817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430825">if</span>&nbsp;<span class="ident" id="4430828">isIncomplete</span>&nbsp;<span class="op" id="4430841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4430846">if</span>&nbsp;<span class="builtinfunc" id="4430849">len</span><span class="op" id="4430852">(</span><span class="ident" id="4430853">list</span><span class="op" id="4430857">)</span>&nbsp;<span class="op" id="4430859">&gt;</span>&nbsp;<span class="num" id="4430861">0</span>&nbsp;<span class="op" id="4430863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430869">p</span><span class="op" id="4430870">.</span><span class="builtinfunc" id="4430871">print</span><span class="op" id="4430876">(</span><span class="ident" id="4430877">formfeed</span><span class="op" id="4430885">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4430890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430895">p</span><span class="op" id="4430896">.</span><span class="ident" id="4430897">flush</span><span class="op" id="4430902">(</span><span class="ident" id="4430903">p</span><span class="op" id="4430904">.</span><span class="ident" id="4430905">posFor</span><span class="op" id="4430911">(</span><span class="ident" id="4430912">rbrace</span><span class="op" id="4430918">)</span><span class="op" id="4430919">,</span>&nbsp;<span class="ident" id="4430921">token</span><span class="op" id="4430926">.</span><span class="ident" id="4430927">RBRACE</span><span class="op" id="4430933">)</span>&nbsp;<span class="comment" id="4430935">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430987">p</span><span class="op" id="4430988">.</span><span class="ident" id="4430989">setLineComment</span><span class="op" id="4431003">(</span><span class="string" id="4431004">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="4431048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431059">p</span><span class="op" id="4431060">.</span><span class="builtinfunc" id="4431061">print</span><span class="op" id="4431066">(</span><span class="ident" id="4431067">unindent</span><span class="op" id="4431075">,</span>&nbsp;<span class="ident" id="4431077">formfeed</span><span class="op" id="4431085">,</span>&nbsp;<span class="ident" id="4431087">rbrace</span><span class="op" id="4431093">,</span>&nbsp;<span class="ident" id="4431095">token</span><span class="op" id="4431100">.</span><span class="ident" id="4431101">RBRACE</span><span class="op" id="4431107">)</span><br>
<span class="lineno"></span><span class="op" id="4431109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4431112">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="4431192">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4431208">func</span>&nbsp;<span class="ident" id="4431213">walkBinary</span><span class="op" id="4431223">(</span><span class="ident" id="4431224">e</span>&nbsp;<span class="op" id="4431226">*</span><span class="ident" id="4431227">ast</span><span class="op" id="4431230">.</span><span class="ident" id="4431231">BinaryExpr</span><span class="op" id="4431241">)</span>&nbsp;<span class="op" id="4431243">(</span><span class="ident" id="4431244">has4</span><span class="op" id="4431248">,</span>&nbsp;<span class="ident" id="4431250">has5</span>&nbsp;<span class="builtintype" id="4431255">bool</span><span class="op" id="4431259">,</span>&nbsp;<span class="ident" id="4431261">maxProblem</span>&nbsp;<span class="builtintype" id="4431272">int</span><span class="op" id="4431275">)</span>&nbsp;<span class="op" id="4431277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431280">switch</span>&nbsp;<span class="ident" id="4431287">e</span><span class="op" id="4431288">.</span><span class="ident" id="4431289">Op</span><span class="op" id="4431291">.</span><span class="ident" id="4431292">Precedence</span><span class="op" id="4431302">(</span><span class="op" id="4431303">)</span>&nbsp;<span class="op" id="4431305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431308">case</span>&nbsp;<span class="num" id="4431313">4</span><span class="op" id="4431314">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431318">has4</span>&nbsp;<span class="op" id="4431323">=</span>&nbsp;<span class="builtintype" id="4431325">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431331">case</span>&nbsp;<span class="num" id="4431336">5</span><span class="op" id="4431337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431341">has5</span>&nbsp;<span class="op" id="4431346">=</span>&nbsp;<span class="builtintype" id="4431348">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431358">switch</span>&nbsp;<span class="ident" id="4431365">l</span>&nbsp;<span class="op" id="4431367">:=</span>&nbsp;<span class="ident" id="4431370">e</span><span class="op" id="4431371">.</span><span class="ident" id="4431372">X</span><span class="op" id="4431373">.</span><span class="op" id="4431374">(</span><span class="keyword" id="4431375">type</span><span class="op" id="4431379">)</span>&nbsp;<span class="op" id="4431381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431384">case</span>&nbsp;<span class="op" id="4431389">*</span><span class="ident" id="4431390">ast</span><span class="op" id="4431393">.</span><span class="ident" id="4431394">BinaryExpr</span><span class="op" id="4431404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431408">if</span>&nbsp;<span class="ident" id="4431411">l</span><span class="op" id="4431412">.</span><span class="ident" id="4431413">Op</span><span class="op" id="4431415">.</span><span class="ident" id="4431416">Precedence</span><span class="op" id="4431426">(</span><span class="op" id="4431427">)</span>&nbsp;<span class="op" id="4431429">&lt;</span>&nbsp;<span class="ident" id="4431431">e</span><span class="op" id="4431432">.</span><span class="ident" id="4431433">Op</span><span class="op" id="4431435">.</span><span class="ident" id="4431436">Precedence</span><span class="op" id="4431446">(</span><span class="op" id="4431447">)</span>&nbsp;<span class="op" id="4431449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4431454">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4431485">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431541">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431553">h4</span><span class="op" id="4431555">,</span>&nbsp;<span class="ident" id="4431557">h5</span><span class="op" id="4431559">,</span>&nbsp;<span class="ident" id="4431561">mp</span>&nbsp;<span class="op" id="4431564">:=</span>&nbsp;<span class="ident" id="4431567">walkBinary</span><span class="op" id="4431577">(</span><span class="ident" id="4431578">l</span><span class="op" id="4431579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431583">has4</span>&nbsp;<span class="op" id="4431588">=</span>&nbsp;<span class="ident" id="4431590">has4</span>&nbsp;<span class="op" id="4431595">||</span>&nbsp;<span class="ident" id="4431598">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431603">has5</span>&nbsp;<span class="op" id="4431608">=</span>&nbsp;<span class="ident" id="4431610">has5</span>&nbsp;<span class="op" id="4431615">||</span>&nbsp;<span class="ident" id="4431618">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431623">if</span>&nbsp;<span class="ident" id="4431626">maxProblem</span>&nbsp;<span class="op" id="4431637">&lt;</span>&nbsp;<span class="ident" id="4431639">mp</span>&nbsp;<span class="op" id="4431642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431647">maxProblem</span>&nbsp;<span class="op" id="4431658">=</span>&nbsp;<span class="ident" id="4431660">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431672">switch</span>&nbsp;<span class="ident" id="4431679">r</span>&nbsp;<span class="op" id="4431681">:=</span>&nbsp;<span class="ident" id="4431684">e</span><span class="op" id="4431685">.</span><span class="ident" id="4431686">Y</span><span class="op" id="4431687">.</span><span class="op" id="4431688">(</span><span class="keyword" id="4431689">type</span><span class="op" id="4431693">)</span>&nbsp;<span class="op" id="4431695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431698">case</span>&nbsp;<span class="op" id="4431703">*</span><span class="ident" id="4431704">ast</span><span class="op" id="4431707">.</span><span class="ident" id="4431708">BinaryExpr</span><span class="op" id="4431718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431722">if</span>&nbsp;<span class="ident" id="4431725">r</span><span class="op" id="4431726">.</span><span class="ident" id="4431727">Op</span><span class="op" id="4431729">.</span><span class="ident" id="4431730">Precedence</span><span class="op" id="4431740">(</span><span class="op" id="4431741">)</span>&nbsp;<span class="op" id="4431743">&lt;=</span>&nbsp;<span class="ident" id="4431746">e</span><span class="op" id="4431747">.</span><span class="ident" id="4431748">Op</span><span class="op" id="4431750">.</span><span class="ident" id="4431751">Precedence</span><span class="op" id="4431761">(</span><span class="op" id="4431762">)</span>&nbsp;<span class="op" id="4431764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4431769">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4431800">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431856">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431868">h4</span><span class="op" id="4431870">,</span>&nbsp;<span class="ident" id="4431872">h5</span><span class="op" id="4431874">,</span>&nbsp;<span class="ident" id="4431876">mp</span>&nbsp;<span class="op" id="4431879">:=</span>&nbsp;<span class="ident" id="4431882">walkBinary</span><span class="op" id="4431892">(</span><span class="ident" id="4431893">r</span><span class="op" id="4431894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431898">has4</span>&nbsp;<span class="op" id="4431903">=</span>&nbsp;<span class="ident" id="4431905">has4</span>&nbsp;<span class="op" id="4431910">||</span>&nbsp;<span class="ident" id="4431913">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431918">has5</span>&nbsp;<span class="op" id="4431923">=</span>&nbsp;<span class="ident" id="4431925">has5</span>&nbsp;<span class="op" id="4431930">||</span>&nbsp;<span class="ident" id="4431933">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431938">if</span>&nbsp;<span class="ident" id="4431941">maxProblem</span>&nbsp;<span class="op" id="4431952">&lt;</span>&nbsp;<span class="ident" id="4431954">mp</span>&nbsp;<span class="op" id="4431957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4431962">maxProblem</span>&nbsp;<span class="op" id="4431973">=</span>&nbsp;<span class="ident" id="4431975">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4431980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4431984">case</span>&nbsp;<span class="op" id="4431989">*</span><span class="ident" id="4431990">ast</span><span class="op" id="4431993">.</span><span class="ident" id="4431994">StarExpr</span><span class="op" id="4432002">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432006">if</span>&nbsp;<span class="ident" id="4432009">e</span><span class="op" id="4432010">.</span><span class="ident" id="4432011">Op</span>&nbsp;<span class="op" id="4432014">==</span>&nbsp;<span class="ident" id="4432017">token</span><span class="op" id="4432022">.</span><span class="ident" id="4432023">QUO</span>&nbsp;<span class="op" id="4432027">{</span>&nbsp;<span class="comment" id="4432029">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432040">maxProblem</span>&nbsp;<span class="op" id="4432051">=</span>&nbsp;<span class="num" id="4432053">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432061">case</span>&nbsp;<span class="op" id="4432066">*</span><span class="ident" id="4432067">ast</span><span class="op" id="4432070">.</span><span class="ident" id="4432071">UnaryExpr</span><span class="op" id="4432080">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432084">switch</span>&nbsp;<span class="ident" id="4432091">e</span><span class="op" id="4432092">.</span><span class="ident" id="4432093">Op</span><span class="op" id="4432095">.</span><span class="ident" id="4432096">String</span><span class="op" id="4432102">(</span><span class="op" id="4432103">)</span>&nbsp;<span class="op" id="4432105">+</span>&nbsp;<span class="ident" id="4432107">r</span><span class="op" id="4432108">.</span><span class="ident" id="4432109">Op</span><span class="op" id="4432111">.</span><span class="ident" id="4432112">String</span><span class="op" id="4432118">(</span><span class="op" id="4432119">)</span>&nbsp;<span class="op" id="4432121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432125">case</span>&nbsp;<span class="string" id="4432130">&#34;/*&#34;</span><span class="op" id="4432134">,</span>&nbsp;<span class="string" id="4432136">&#34;&amp;&amp;&#34;</span><span class="op" id="4432140">,</span>&nbsp;<span class="string" id="4432142">&#34;&amp;^&#34;</span><span class="op" id="4432146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432151">maxProblem</span>&nbsp;<span class="op" id="4432162">=</span>&nbsp;<span class="num" id="4432164">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432168">case</span>&nbsp;<span class="string" id="4432173">&#34;++&#34;</span><span class="op" id="4432177">,</span>&nbsp;<span class="string" id="4432179">&#34;--&#34;</span><span class="op" id="4432183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432188">if</span>&nbsp;<span class="ident" id="4432191">maxProblem</span>&nbsp;<span class="op" id="4432202">&lt;</span>&nbsp;<span class="num" id="4432204">4</span>&nbsp;<span class="op" id="4432206">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432212">maxProblem</span>&nbsp;<span class="op" id="4432223">=</span>&nbsp;<span class="num" id="4432225">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432240">return</span><br>
<span class="lineno">560</span><span class="op" id="4432247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432250">func</span>&nbsp;<span class="ident" id="4432255">cutoff</span><span class="op" id="4432261">(</span><span class="ident" id="4432262">e</span>&nbsp;<span class="op" id="4432264">*</span><span class="ident" id="4432265">ast</span><span class="op" id="4432268">.</span><span class="ident" id="4432269">BinaryExpr</span><span class="op" id="4432279">,</span>&nbsp;<span class="ident" id="4432281">depth</span>&nbsp;<span class="builtintype" id="4432287">int</span><span class="op" id="4432290">)</span>&nbsp;<span class="builtintype" id="4432292">int</span>&nbsp;<span class="op" id="4432296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432299">has4</span><span class="op" id="4432303">,</span>&nbsp;<span class="ident" id="4432305">has5</span><span class="op" id="4432309">,</span>&nbsp;<span class="ident" id="4432311">maxProblem</span>&nbsp;<span class="op" id="4432322">:=</span>&nbsp;<span class="ident" id="4432325">walkBinary</span><span class="op" id="4432335">(</span><span class="ident" id="4432336">e</span><span class="op" id="4432337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432340">if</span>&nbsp;<span class="ident" id="4432343">maxProblem</span>&nbsp;<span class="op" id="4432354">&gt;</span>&nbsp;<span class="num" id="4432356">0</span>&nbsp;<span class="op" id="4432358">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432362">return</span>&nbsp;<span class="ident" id="4432369">maxProblem</span>&nbsp;<span class="op" id="4432380">+</span>&nbsp;<span class="num" id="4432382">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432388">if</span>&nbsp;<span class="ident" id="4432391">has4</span>&nbsp;<span class="op" id="4432396">&amp;&amp;</span>&nbsp;<span class="ident" id="4432399">has5</span>&nbsp;<span class="op" id="4432404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432408">if</span>&nbsp;<span class="ident" id="4432411">depth</span>&nbsp;<span class="op" id="4432417">==</span>&nbsp;<span class="num" id="4432420">1</span>&nbsp;<span class="op" id="4432422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432427">return</span>&nbsp;<span class="num" id="4432434">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432442">return</span>&nbsp;<span class="num" id="4432449">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432455">if</span>&nbsp;<span class="ident" id="4432458">depth</span>&nbsp;<span class="op" id="4432464">==</span>&nbsp;<span class="num" id="4432467">1</span>&nbsp;<span class="op" id="4432469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432473">return</span>&nbsp;<span class="num" id="4432480">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432486">return</span>&nbsp;<span class="num" id="4432493">4</span><br>
<span class="lineno"></span><span class="op" id="4432495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432498">func</span>&nbsp;<span class="ident" id="4432503">diffPrec</span><span class="op" id="4432511">(</span><span class="ident" id="4432512">expr</span>&nbsp;<span class="ident" id="4432517">ast</span><span class="op" id="4432520">.</span><span class="ident" id="4432521">Expr</span><span class="op" id="4432525">,</span>&nbsp;<span class="ident" id="4432527">prec</span>&nbsp;<span class="builtintype" id="4432532">int</span><span class="op" id="4432535">)</span>&nbsp;<span class="builtintype" id="4432537">int</span>&nbsp;<span class="op" id="4432541">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432544">x</span><span class="op" id="4432545">,</span>&nbsp;<span class="ident" id="4432547">ok</span>&nbsp;<span class="op" id="4432550">:=</span>&nbsp;<span class="ident" id="4432553">expr</span><span class="op" id="4432557">.</span><span class="op" id="4432558">(</span><span class="op" id="4432559">*</span><span class="ident" id="4432560">ast</span><span class="op" id="4432563">.</span><span class="ident" id="4432564">BinaryExpr</span><span class="op" id="4432574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432577">if</span>&nbsp;<span class="op" id="4432580">!</span><span class="ident" id="4432581">ok</span>&nbsp;<span class="op" id="4432584">||</span>&nbsp;<span class="ident" id="4432587">prec</span>&nbsp;<span class="op" id="4432592">!=</span>&nbsp;<span class="ident" id="4432595">x</span><span class="op" id="4432596">.</span><span class="ident" id="4432597">Op</span><span class="op" id="4432599">.</span><span class="ident" id="4432600">Precedence</span><span class="op" id="4432610">(</span><span class="op" id="4432611">)</span>&nbsp;<span class="op" id="4432613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432617">return</span>&nbsp;<span class="num" id="4432624">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432630">return</span>&nbsp;<span class="num" id="4432637">0</span><br>
<span class="lineno">585</span><span class="op" id="4432639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4432642">func</span>&nbsp;<span class="ident" id="4432647">reduceDepth</span><span class="op" id="4432658">(</span><span class="ident" id="4432659">depth</span>&nbsp;<span class="builtintype" id="4432665">int</span><span class="op" id="4432668">)</span>&nbsp;<span class="builtintype" id="4432670">int</span>&nbsp;<span class="op" id="4432674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432677">depth</span><span class="op" id="4432682">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432686">if</span>&nbsp;<span class="ident" id="4432689">depth</span>&nbsp;<span class="op" id="4432695">&lt;</span>&nbsp;<span class="num" id="4432697">1</span>&nbsp;<span class="op" id="4432699">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4432703">depth</span>&nbsp;<span class="op" id="4432709">=</span>&nbsp;<span class="num" id="4432711">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4432714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4432717">return</span>&nbsp;<span class="ident" id="4432724">depth</span><br>
<span class="lineno"></span><span class="op" id="4432730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="4432733">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="4432801">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="4432867">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="4432906">//</span><br>
<span class="lineno"></span><span class="comment" id="4432909">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="4432933">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="4432973">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="4433001">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="4433039">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="4433059">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="4433079">//</span><br>
<span class="lineno"></span><span class="comment" id="4433082">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="4433158">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="4433245">//</span><br>
<span class="lineno"></span><span class="comment" id="4433248">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="4433324">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="4433401">//</span><br>
<span class="lineno"></span><span class="comment" id="4433404">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="4433472">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="4433543">//</span><br>
<span class="lineno">615</span><span class="comment" id="4433546">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="4433555">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="4433564">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="4433573">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="4433582">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="4433591">//</span><br>
<span class="lineno"></span><span class="comment" id="4433594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="4433660">//</span><br>
<span class="lineno"></span><span class="comment" id="4433663">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="4433737">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="4433802">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="4433850">//</span><br>
<span class="lineno"></span><span class="comment" id="4433853">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4433927">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="4433980">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="4434028">//</span><br>
<span class="lineno"></span><span class="keyword" id="4434031">func</span>&nbsp;<span class="op" id="4434036">(</span><span class="ident" id="4434037">p</span>&nbsp;<span class="op" id="4434039">*</span><span class="ident" id="4434040">printer</span><span class="op" id="4434047">)</span>&nbsp;<span class="ident" id="4434049">binaryExpr</span><span class="op" id="4434059">(</span><span class="ident" id="4434060">x</span>&nbsp;<span class="op" id="4434062">*</span><span class="ident" id="4434063">ast</span><span class="op" id="4434066">.</span><span class="ident" id="4434067">BinaryExpr</span><span class="op" id="4434077">,</span>&nbsp;<span class="ident" id="4434079">prec1</span><span class="op" id="4434084">,</span>&nbsp;<span class="ident" id="4434086">cutoff</span><span class="op" id="4434092">,</span>&nbsp;<span class="ident" id="4434094">depth</span>&nbsp;<span class="builtintype" id="4434100">int</span><span class="op" id="4434103">)</span>&nbsp;<span class="op" id="4434105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434108">prec</span>&nbsp;<span class="op" id="4434113">:=</span>&nbsp;<span class="ident" id="4434116">x</span><span class="op" id="4434117">.</span><span class="ident" id="4434118">Op</span><span class="op" id="4434120">.</span><span class="ident" id="4434121">Precedence</span><span class="op" id="4434131">(</span><span class="op" id="4434132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434135">if</span>&nbsp;<span class="ident" id="4434138">prec</span>&nbsp;<span class="op" id="4434143">&lt;</span>&nbsp;<span class="ident" id="4434145">prec1</span>&nbsp;<span class="op" id="4434151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4434155">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4434179">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4434247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434315">p</span><span class="op" id="4434316">.</span><span class="builtinfunc" id="4434317">print</span><span class="op" id="4434322">(</span><span class="ident" id="4434323">token</span><span class="op" id="4434328">.</span><span class="ident" id="4434329">LPAREN</span><span class="op" id="4434335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434339">p</span><span class="op" id="4434340">.</span><span class="ident" id="4434341">expr0</span><span class="op" id="4434346">(</span><span class="ident" id="4434347">x</span><span class="op" id="4434348">,</span>&nbsp;<span class="ident" id="4434350">reduceDepth</span><span class="op" id="4434361">(</span><span class="ident" id="4434362">depth</span><span class="op" id="4434367">)</span><span class="op" id="4434368">)</span>&nbsp;<span class="comment" id="4434370">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434411">p</span><span class="op" id="4434412">.</span><span class="builtinfunc" id="4434413">print</span><span class="op" id="4434418">(</span><span class="ident" id="4434419">token</span><span class="op" id="4434424">.</span><span class="ident" id="4434425">RPAREN</span><span class="op" id="4434431">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434435">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434447">printBlank</span>&nbsp;<span class="op" id="4434458">:=</span>&nbsp;<span class="ident" id="4434461">prec</span>&nbsp;<span class="op" id="4434466">&lt;</span>&nbsp;<span class="ident" id="4434468">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434477">ws</span>&nbsp;<span class="op" id="4434480">:=</span>&nbsp;<span class="ident" id="4434483">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434491">p</span><span class="op" id="4434492">.</span><span class="ident" id="4434493">expr1</span><span class="op" id="4434498">(</span><span class="ident" id="4434499">x</span><span class="op" id="4434500">.</span><span class="ident" id="4434501">X</span><span class="op" id="4434502">,</span>&nbsp;<span class="ident" id="4434504">prec</span><span class="op" id="4434508">,</span>&nbsp;<span class="ident" id="4434510">depth</span><span class="op" id="4434515">+</span><span class="ident" id="4434516">diffPrec</span><span class="op" id="4434524">(</span><span class="ident" id="4434525">x</span><span class="op" id="4434526">.</span><span class="ident" id="4434527">X</span><span class="op" id="4434528">,</span>&nbsp;<span class="ident" id="4434530">prec</span><span class="op" id="4434534">)</span><span class="op" id="4434535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434538">if</span>&nbsp;<span class="ident" id="4434541">printBlank</span>&nbsp;<span class="op" id="4434552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434556">p</span><span class="op" id="4434557">.</span><span class="builtinfunc" id="4434558">print</span><span class="op" id="4434563">(</span><span class="ident" id="4434564">blank</span><span class="op" id="4434569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434572">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434575">xline</span>&nbsp;<span class="op" id="4434581">:=</span>&nbsp;<span class="ident" id="4434584">p</span><span class="op" id="4434585">.</span><span class="ident" id="4434586">pos</span><span class="op" id="4434589">.</span><span class="ident" id="4434590">Line</span>&nbsp;<span class="comment" id="4434595">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434649">yline</span>&nbsp;<span class="op" id="4434655">:=</span>&nbsp;<span class="ident" id="4434658">p</span><span class="op" id="4434659">.</span><span class="ident" id="4434660">lineFor</span><span class="op" id="4434667">(</span><span class="ident" id="4434668">x</span><span class="op" id="4434669">.</span><span class="ident" id="4434670">Y</span><span class="op" id="4434671">.</span><span class="ident" id="4434672">Pos</span><span class="op" id="4434675">(</span><span class="op" id="4434676">)</span><span class="op" id="4434677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434680">p</span><span class="op" id="4434681">.</span><span class="builtinfunc" id="4434682">print</span><span class="op" id="4434687">(</span><span class="ident" id="4434688">x</span><span class="op" id="4434689">.</span><span class="ident" id="4434690">OpPos</span><span class="op" id="4434695">,</span>&nbsp;<span class="ident" id="4434697">x</span><span class="op" id="4434698">.</span><span class="ident" id="4434699">Op</span><span class="op" id="4434701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434704">if</span>&nbsp;<span class="ident" id="4434707">xline</span>&nbsp;<span class="op" id="4434713">!=</span>&nbsp;<span class="ident" id="4434716">yline</span>&nbsp;<span class="op" id="4434722">&amp;&amp;</span>&nbsp;<span class="ident" id="4434725">xline</span>&nbsp;<span class="op" id="4434731">&gt;</span>&nbsp;<span class="num" id="4434733">0</span>&nbsp;<span class="op" id="4434735">&amp;&amp;</span>&nbsp;<span class="ident" id="4434738">yline</span>&nbsp;<span class="op" id="4434744">&gt;</span>&nbsp;<span class="num" id="4434746">0</span>&nbsp;<span class="op" id="4434748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4434752">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4434814">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434833">if</span>&nbsp;<span class="ident" id="4434836">p</span><span class="op" id="4434837">.</span><span class="ident" id="4434838">linebreak</span><span class="op" id="4434847">(</span><span class="ident" id="4434848">yline</span><span class="op" id="4434853">,</span>&nbsp;<span class="num" id="4434855">1</span><span class="op" id="4434856">,</span>&nbsp;<span class="ident" id="4434858">ws</span><span class="op" id="4434860">,</span>&nbsp;<span class="builtintype" id="4434862">true</span><span class="op" id="4434866">)</span>&nbsp;<span class="op" id="4434868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434873">ws</span>&nbsp;<span class="op" id="4434876">=</span>&nbsp;<span class="ident" id="4434878">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434888">printBlank</span>&nbsp;<span class="op" id="4434899">=</span>&nbsp;<span class="builtintype" id="4434901">false</span>&nbsp;<span class="comment" id="4434907">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434938">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4434944">if</span>&nbsp;<span class="ident" id="4434947">printBlank</span>&nbsp;<span class="op" id="4434958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434962">p</span><span class="op" id="4434963">.</span><span class="builtinfunc" id="4434964">print</span><span class="op" id="4434969">(</span><span class="ident" id="4434970">blank</span><span class="op" id="4434975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4434978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4434981">p</span><span class="op" id="4434982">.</span><span class="ident" id="4434983">expr1</span><span class="op" id="4434988">(</span><span class="ident" id="4434989">x</span><span class="op" id="4434990">.</span><span class="ident" id="4434991">Y</span><span class="op" id="4434992">,</span>&nbsp;<span class="ident" id="4434994">prec</span><span class="op" id="4434998">+</span><span class="num" id="4434999">1</span><span class="op" id="4435000">,</span>&nbsp;<span class="ident" id="4435002">depth</span><span class="op" id="4435007">+</span><span class="num" id="4435008">1</span><span class="op" id="4435009">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435012">if</span>&nbsp;<span class="ident" id="4435015">ws</span>&nbsp;<span class="op" id="4435018">==</span>&nbsp;<span class="ident" id="4435021">ignore</span>&nbsp;<span class="op" id="4435028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435032">p</span><span class="op" id="4435033">.</span><span class="builtinfunc" id="4435034">print</span><span class="op" id="4435039">(</span><span class="ident" id="4435040">unindent</span><span class="op" id="4435048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435051">}</span><br>
<span class="lineno"></span><span class="op" id="4435053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="4435056">func</span>&nbsp;<span class="ident" id="4435061">isBinary</span><span class="op" id="4435069">(</span><span class="ident" id="4435070">expr</span>&nbsp;<span class="ident" id="4435075">ast</span><span class="op" id="4435078">.</span><span class="ident" id="4435079">Expr</span><span class="op" id="4435083">)</span>&nbsp;<span class="builtintype" id="4435085">bool</span>&nbsp;<span class="op" id="4435090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435093">_</span><span class="op" id="4435094">,</span>&nbsp;<span class="ident" id="4435096">ok</span>&nbsp;<span class="op" id="4435099">:=</span>&nbsp;<span class="ident" id="4435102">expr</span><span class="op" id="4435106">.</span><span class="op" id="4435107">(</span><span class="op" id="4435108">*</span><span class="ident" id="4435109">ast</span><span class="op" id="4435112">.</span><span class="ident" id="4435113">BinaryExpr</span><span class="op" id="4435123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435126">return</span>&nbsp;<span class="ident" id="4435133">ok</span><br>
<span class="lineno"></span><span class="op" id="4435136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="4435139">func</span>&nbsp;<span class="op" id="4435144">(</span><span class="ident" id="4435145">p</span>&nbsp;<span class="op" id="4435147">*</span><span class="ident" id="4435148">printer</span><span class="op" id="4435155">)</span>&nbsp;<span class="ident" id="4435157">expr1</span><span class="op" id="4435162">(</span><span class="ident" id="4435163">expr</span>&nbsp;<span class="ident" id="4435168">ast</span><span class="op" id="4435171">.</span><span class="ident" id="4435172">Expr</span><span class="op" id="4435176">,</span>&nbsp;<span class="ident" id="4435178">prec1</span><span class="op" id="4435183">,</span>&nbsp;<span class="ident" id="4435185">depth</span>&nbsp;<span class="builtintype" id="4435191">int</span><span class="op" id="4435194">)</span>&nbsp;<span class="op" id="4435196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435199">p</span><span class="op" id="4435200">.</span><span class="builtinfunc" id="4435201">print</span><span class="op" id="4435206">(</span><span class="ident" id="4435207">expr</span><span class="op" id="4435211">.</span><span class="ident" id="4435212">Pos</span><span class="op" id="4435215">(</span><span class="op" id="4435216">)</span><span class="op" id="4435217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435221">switch</span>&nbsp;<span class="ident" id="4435228">x</span>&nbsp;<span class="op" id="4435230">:=</span>&nbsp;<span class="ident" id="4435233">expr</span><span class="op" id="4435237">.</span><span class="op" id="4435238">(</span><span class="keyword" id="4435239">type</span><span class="op" id="4435243">)</span>&nbsp;<span class="op" id="4435245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435248">case</span>&nbsp;<span class="op" id="4435253">*</span><span class="ident" id="4435254">ast</span><span class="op" id="4435257">.</span><span class="ident" id="4435258">BadExpr</span><span class="op" id="4435265">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435269">p</span><span class="op" id="4435270">.</span><span class="builtinfunc" id="4435271">print</span><span class="op" id="4435276">(</span><span class="string" id="4435277">&#34;BadExpr&#34;</span><span class="op" id="4435286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435290">case</span>&nbsp;<span class="op" id="4435295">*</span><span class="ident" id="4435296">ast</span><span class="op" id="4435299">.</span><span class="ident" id="4435300">Ident</span><span class="op" id="4435305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435309">p</span><span class="op" id="4435310">.</span><span class="builtinfunc" id="4435311">print</span><span class="op" id="4435316">(</span><span class="ident" id="4435317">x</span><span class="op" id="4435318">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435322">case</span>&nbsp;<span class="op" id="4435327">*</span><span class="ident" id="4435328">ast</span><span class="op" id="4435331">.</span><span class="ident" id="4435332">BinaryExpr</span><span class="op" id="4435342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435346">if</span>&nbsp;<span class="ident" id="4435349">depth</span>&nbsp;<span class="op" id="4435355">&lt;</span>&nbsp;<span class="num" id="4435357">1</span>&nbsp;<span class="op" id="4435359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435364">p</span><span class="op" id="4435365">.</span><span class="ident" id="4435366">internalError</span><span class="op" id="4435379">(</span><span class="string" id="4435380">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="4435392">,</span>&nbsp;<span class="ident" id="4435394">depth</span><span class="op" id="4435399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435404">depth</span>&nbsp;<span class="op" id="4435410">=</span>&nbsp;<span class="num" id="4435412">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435416">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435420">p</span><span class="op" id="4435421">.</span><span class="ident" id="4435422">binaryExpr</span><span class="op" id="4435432">(</span><span class="ident" id="4435433">x</span><span class="op" id="4435434">,</span>&nbsp;<span class="ident" id="4435436">prec1</span><span class="op" id="4435441">,</span>&nbsp;<span class="ident" id="4435443">cutoff</span><span class="op" id="4435449">(</span><span class="ident" id="4435450">x</span><span class="op" id="4435451">,</span>&nbsp;<span class="ident" id="4435453">depth</span><span class="op" id="4435458">)</span><span class="op" id="4435459">,</span>&nbsp;<span class="ident" id="4435461">depth</span><span class="op" id="4435466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435470">case</span>&nbsp;<span class="op" id="4435475">*</span><span class="ident" id="4435476">ast</span><span class="op" id="4435479">.</span><span class="ident" id="4435480">KeyValueExpr</span><span class="op" id="4435492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435496">p</span><span class="op" id="4435497">.</span><span class="ident" id="4435498">expr</span><span class="op" id="4435502">(</span><span class="ident" id="4435503">x</span><span class="op" id="4435504">.</span><span class="ident" id="4435505">Key</span><span class="op" id="4435508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435512">p</span><span class="op" id="4435513">.</span><span class="builtinfunc" id="4435514">print</span><span class="op" id="4435519">(</span><span class="ident" id="4435520">x</span><span class="op" id="4435521">.</span><span class="ident" id="4435522">Colon</span><span class="op" id="4435527">,</span>&nbsp;<span class="ident" id="4435529">token</span><span class="op" id="4435534">.</span><span class="ident" id="4435535">COLON</span><span class="op" id="4435540">,</span>&nbsp;<span class="ident" id="4435542">blank</span><span class="op" id="4435547">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435551">p</span><span class="op" id="4435552">.</span><span class="ident" id="4435553">expr</span><span class="op" id="4435557">(</span><span class="ident" id="4435558">x</span><span class="op" id="4435559">.</span><span class="ident" id="4435560">Value</span><span class="op" id="4435565">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435569">case</span>&nbsp;<span class="op" id="4435574">*</span><span class="ident" id="4435575">ast</span><span class="op" id="4435578">.</span><span class="ident" id="4435579">StarExpr</span><span class="op" id="4435587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435591">const</span>&nbsp;<span class="ident" id="4435597">prec</span>&nbsp;<span class="op" id="4435602">=</span>&nbsp;<span class="ident" id="4435604">token</span><span class="op" id="4435609">.</span><span class="ident" id="4435610">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435622">if</span>&nbsp;<span class="ident" id="4435625">prec</span>&nbsp;<span class="op" id="4435630">&lt;</span>&nbsp;<span class="ident" id="4435632">prec1</span>&nbsp;<span class="op" id="4435638">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4435643">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435668">p</span><span class="op" id="4435669">.</span><span class="builtinfunc" id="4435670">print</span><span class="op" id="4435675">(</span><span class="ident" id="4435676">token</span><span class="op" id="4435681">.</span><span class="ident" id="4435682">LPAREN</span><span class="op" id="4435688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435693">p</span><span class="op" id="4435694">.</span><span class="builtinfunc" id="4435695">print</span><span class="op" id="4435700">(</span><span class="ident" id="4435701">token</span><span class="op" id="4435706">.</span><span class="ident" id="4435707">MUL</span><span class="op" id="4435710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435715">p</span><span class="op" id="4435716">.</span><span class="ident" id="4435717">expr</span><span class="op" id="4435721">(</span><span class="ident" id="4435722">x</span><span class="op" id="4435723">.</span><span class="ident" id="4435724">X</span><span class="op" id="4435725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435730">p</span><span class="op" id="4435731">.</span><span class="builtinfunc" id="4435732">print</span><span class="op" id="4435737">(</span><span class="ident" id="4435738">token</span><span class="op" id="4435743">.</span><span class="ident" id="4435744">RPAREN</span><span class="op" id="4435750">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435754">}</span>&nbsp;<span class="keyword" id="4435756">else</span>&nbsp;<span class="op" id="4435761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4435766">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435794">p</span><span class="op" id="4435795">.</span><span class="builtinfunc" id="4435796">print</span><span class="op" id="4435801">(</span><span class="ident" id="4435802">token</span><span class="op" id="4435807">.</span><span class="ident" id="4435808">MUL</span><span class="op" id="4435811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435816">p</span><span class="op" id="4435817">.</span><span class="ident" id="4435818">expr</span><span class="op" id="4435822">(</span><span class="ident" id="4435823">x</span><span class="op" id="4435824">.</span><span class="ident" id="4435825">X</span><span class="op" id="4435826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435830">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435834">case</span>&nbsp;<span class="op" id="4435839">*</span><span class="ident" id="4435840">ast</span><span class="op" id="4435843">.</span><span class="ident" id="4435844">UnaryExpr</span><span class="op" id="4435853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435857">const</span>&nbsp;<span class="ident" id="4435863">prec</span>&nbsp;<span class="op" id="4435868">=</span>&nbsp;<span class="ident" id="4435870">token</span><span class="op" id="4435875">.</span><span class="ident" id="4435876">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4435888">if</span>&nbsp;<span class="ident" id="4435891">prec</span>&nbsp;<span class="op" id="4435896">&lt;</span>&nbsp;<span class="ident" id="4435898">prec1</span>&nbsp;<span class="op" id="4435904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4435909">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435934">p</span><span class="op" id="4435935">.</span><span class="builtinfunc" id="4435936">print</span><span class="op" id="4435941">(</span><span class="ident" id="4435942">token</span><span class="op" id="4435947">.</span><span class="ident" id="4435948">LPAREN</span><span class="op" id="4435954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435959">p</span><span class="op" id="4435960">.</span><span class="ident" id="4435961">expr</span><span class="op" id="4435965">(</span><span class="ident" id="4435966">x</span><span class="op" id="4435967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4435972">p</span><span class="op" id="4435973">.</span><span class="builtinfunc" id="4435974">print</span><span class="op" id="4435979">(</span><span class="ident" id="4435980">token</span><span class="op" id="4435985">.</span><span class="ident" id="4435986">RPAREN</span><span class="op" id="4435992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4435996">}</span>&nbsp;<span class="keyword" id="4435998">else</span>&nbsp;<span class="op" id="4436003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436008">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436036">p</span><span class="op" id="4436037">.</span><span class="builtinfunc" id="4436038">print</span><span class="op" id="4436043">(</span><span class="ident" id="4436044">x</span><span class="op" id="4436045">.</span><span class="ident" id="4436046">Op</span><span class="op" id="4436048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436053">if</span>&nbsp;<span class="ident" id="4436056">x</span><span class="op" id="4436057">.</span><span class="ident" id="4436058">Op</span>&nbsp;<span class="op" id="4436061">==</span>&nbsp;<span class="ident" id="4436064">token</span><span class="op" id="4436069">.</span><span class="ident" id="4436070">RANGE</span>&nbsp;<span class="op" id="4436076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436082">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436141">p</span><span class="op" id="4436142">.</span><span class="builtinfunc" id="4436143">print</span><span class="op" id="4436148">(</span><span class="ident" id="4436149">blank</span><span class="op" id="4436154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436159">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436164">p</span><span class="op" id="4436165">.</span><span class="ident" id="4436166">expr1</span><span class="op" id="4436171">(</span><span class="ident" id="4436172">x</span><span class="op" id="4436173">.</span><span class="ident" id="4436174">X</span><span class="op" id="4436175">,</span>&nbsp;<span class="ident" id="4436177">prec</span><span class="op" id="4436181">,</span>&nbsp;<span class="ident" id="4436183">depth</span><span class="op" id="4436188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436196">case</span>&nbsp;<span class="op" id="4436201">*</span><span class="ident" id="4436202">ast</span><span class="op" id="4436205">.</span><span class="ident" id="4436206">BasicLit</span><span class="op" id="4436214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436218">p</span><span class="op" id="4436219">.</span><span class="builtinfunc" id="4436220">print</span><span class="op" id="4436225">(</span><span class="ident" id="4436226">x</span><span class="op" id="4436227">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436231">case</span>&nbsp;<span class="op" id="4436236">*</span><span class="ident" id="4436237">ast</span><span class="op" id="4436240">.</span><span class="ident" id="4436241">FuncLit</span><span class="op" id="4436248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436252">p</span><span class="op" id="4436253">.</span><span class="ident" id="4436254">expr</span><span class="op" id="4436258">(</span><span class="ident" id="4436259">x</span><span class="op" id="4436260">.</span><span class="ident" id="4436261">Type</span><span class="op" id="4436265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436269">p</span><span class="op" id="4436270">.</span><span class="ident" id="4436271">adjBlock</span><span class="op" id="4436279">(</span><span class="ident" id="4436280">p</span><span class="op" id="4436281">.</span><span class="ident" id="4436282">distanceFrom</span><span class="op" id="4436294">(</span><span class="ident" id="4436295">x</span><span class="op" id="4436296">.</span><span class="ident" id="4436297">Type</span><span class="op" id="4436301">.</span><span class="ident" id="4436302">Pos</span><span class="op" id="4436305">(</span><span class="op" id="4436306">)</span><span class="op" id="4436307">)</span><span class="op" id="4436308">,</span>&nbsp;<span class="ident" id="4436310">blank</span><span class="op" id="4436315">,</span>&nbsp;<span class="ident" id="4436317">x</span><span class="op" id="4436318">.</span><span class="ident" id="4436319">Body</span><span class="op" id="4436323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436327">case</span>&nbsp;<span class="op" id="4436332">*</span><span class="ident" id="4436333">ast</span><span class="op" id="4436336">.</span><span class="ident" id="4436337">ParenExpr</span><span class="op" id="4436346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436350">if</span>&nbsp;<span class="ident" id="4436353">_</span><span class="op" id="4436354">,</span>&nbsp;<span class="ident" id="4436356">hasParens</span>&nbsp;<span class="op" id="4436366">:=</span>&nbsp;<span class="ident" id="4436369">x</span><span class="op" id="4436370">.</span><span class="ident" id="4436371">X</span><span class="op" id="4436372">.</span><span class="op" id="4436373">(</span><span class="op" id="4436374">*</span><span class="ident" id="4436375">ast</span><span class="op" id="4436378">.</span><span class="ident" id="4436379">ParenExpr</span><span class="op" id="4436388">)</span><span class="op" id="4436389">;</span>&nbsp;<span class="ident" id="4436391">hasParens</span>&nbsp;<span class="op" id="4436401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436406">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436479">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436563">p</span><span class="op" id="4436564">.</span><span class="ident" id="4436565">expr0</span><span class="op" id="4436570">(</span><span class="ident" id="4436571">x</span><span class="op" id="4436572">.</span><span class="ident" id="4436573">X</span><span class="op" id="4436574">,</span>&nbsp;<span class="ident" id="4436576">depth</span><span class="op" id="4436581">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436585">}</span>&nbsp;<span class="keyword" id="4436587">else</span>&nbsp;<span class="op" id="4436592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436597">p</span><span class="op" id="4436598">.</span><span class="builtinfunc" id="4436599">print</span><span class="op" id="4436604">(</span><span class="ident" id="4436605">token</span><span class="op" id="4436610">.</span><span class="ident" id="4436611">LPAREN</span><span class="op" id="4436617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436622">p</span><span class="op" id="4436623">.</span><span class="ident" id="4436624">expr0</span><span class="op" id="4436629">(</span><span class="ident" id="4436630">x</span><span class="op" id="4436631">.</span><span class="ident" id="4436632">X</span><span class="op" id="4436633">,</span>&nbsp;<span class="ident" id="4436635">reduceDepth</span><span class="op" id="4436646">(</span><span class="ident" id="4436647">depth</span><span class="op" id="4436652">)</span><span class="op" id="4436653">)</span>&nbsp;<span class="comment" id="4436655">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436697">p</span><span class="op" id="4436698">.</span><span class="builtinfunc" id="4436699">print</span><span class="op" id="4436704">(</span><span class="ident" id="4436705">x</span><span class="op" id="4436706">.</span><span class="ident" id="4436707">Rparen</span><span class="op" id="4436713">,</span>&nbsp;<span class="ident" id="4436715">token</span><span class="op" id="4436720">.</span><span class="ident" id="4436721">RPAREN</span><span class="op" id="4436727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436731">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436735">case</span>&nbsp;<span class="op" id="4436740">*</span><span class="ident" id="4436741">ast</span><span class="op" id="4436744">.</span><span class="ident" id="4436745">SelectorExpr</span><span class="op" id="4436757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436761">p</span><span class="op" id="4436762">.</span><span class="ident" id="4436763">expr1</span><span class="op" id="4436768">(</span><span class="ident" id="4436769">x</span><span class="op" id="4436770">.</span><span class="ident" id="4436771">X</span><span class="op" id="4436772">,</span>&nbsp;<span class="ident" id="4436774">token</span><span class="op" id="4436779">.</span><span class="ident" id="4436780">HighestPrec</span><span class="op" id="4436791">,</span>&nbsp;<span class="ident" id="4436793">depth</span><span class="op" id="4436798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436802">p</span><span class="op" id="4436803">.</span><span class="builtinfunc" id="4436804">print</span><span class="op" id="4436809">(</span><span class="ident" id="4436810">token</span><span class="op" id="4436815">.</span><span class="ident" id="4436816">PERIOD</span><span class="op" id="4436822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4436826">if</span>&nbsp;<span class="ident" id="4436829">line</span>&nbsp;<span class="op" id="4436834">:=</span>&nbsp;<span class="ident" id="4436837">p</span><span class="op" id="4436838">.</span><span class="ident" id="4436839">lineFor</span><span class="op" id="4436846">(</span><span class="ident" id="4436847">x</span><span class="op" id="4436848">.</span><span class="ident" id="4436849">Sel</span><span class="op" id="4436852">.</span><span class="ident" id="4436853">Pos</span><span class="op" id="4436856">(</span><span class="op" id="4436857">)</span><span class="op" id="4436858">)</span><span class="op" id="4436859">;</span>&nbsp;<span class="ident" id="4436861">p</span><span class="op" id="4436862">.</span><span class="ident" id="4436863">pos</span><span class="op" id="4436866">.</span><span class="ident" id="4436867">IsValid</span><span class="op" id="4436874">(</span><span class="op" id="4436875">)</span>&nbsp;<span class="op" id="4436877">&amp;&amp;</span>&nbsp;<span class="ident" id="4436880">p</span><span class="op" id="4436881">.</span><span class="ident" id="4436882">pos</span><span class="op" id="4436885">.</span><span class="ident" id="4436886">Line</span>&nbsp;<span class="op" id="4436891">&lt;</span>&nbsp;<span class="ident" id="4436893">line</span>&nbsp;<span class="op" id="4436898">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436903">p</span><span class="op" id="4436904">.</span><span class="builtinfunc" id="4436905">print</span><span class="op" id="4436910">(</span><span class="ident" id="4436911">indent</span><span class="op" id="4436917">,</span>&nbsp;<span class="ident" id="4436919">newline</span><span class="op" id="4436926">,</span>&nbsp;<span class="ident" id="4436928">x</span><span class="op" id="4436929">.</span><span class="ident" id="4436930">Sel</span><span class="op" id="4436933">.</span><span class="ident" id="4436934">Pos</span><span class="op" id="4436937">(</span><span class="op" id="4436938">)</span><span class="op" id="4436939">,</span>&nbsp;<span class="ident" id="4436941">x</span><span class="op" id="4436942">.</span><span class="ident" id="4436943">Sel</span><span class="op" id="4436946">,</span>&nbsp;<span class="ident" id="4436948">unindent</span><span class="op" id="4436956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4436960">}</span>&nbsp;<span class="keyword" id="4436962">else</span>&nbsp;<span class="op" id="4436967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436972">p</span><span class="op" id="4436973">.</span><span class="builtinfunc" id="4436974">print</span><span class="op" id="4436979">(</span><span class="ident" id="4436980">x</span><span class="op" id="4436981">.</span><span class="ident" id="4436982">Sel</span><span class="op" id="4436985">.</span><span class="ident" id="4436986">Pos</span><span class="op" id="4436989">(</span><span class="op" id="4436990">)</span><span class="op" id="4436991">,</span>&nbsp;<span class="ident" id="4436993">x</span><span class="op" id="4436994">.</span><span class="ident" id="4436995">Sel</span><span class="op" id="4436998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437006">case</span>&nbsp;<span class="op" id="4437011">*</span><span class="ident" id="4437012">ast</span><span class="op" id="4437015">.</span><span class="ident" id="4437016">TypeAssertExpr</span><span class="op" id="4437030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437034">p</span><span class="op" id="4437035">.</span><span class="ident" id="4437036">expr1</span><span class="op" id="4437041">(</span><span class="ident" id="4437042">x</span><span class="op" id="4437043">.</span><span class="ident" id="4437044">X</span><span class="op" id="4437045">,</span>&nbsp;<span class="ident" id="4437047">token</span><span class="op" id="4437052">.</span><span class="ident" id="4437053">HighestPrec</span><span class="op" id="4437064">,</span>&nbsp;<span class="ident" id="4437066">depth</span><span class="op" id="4437071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437075">p</span><span class="op" id="4437076">.</span><span class="builtinfunc" id="4437077">print</span><span class="op" id="4437082">(</span><span class="ident" id="4437083">token</span><span class="op" id="4437088">.</span><span class="ident" id="4437089">PERIOD</span><span class="op" id="4437095">,</span>&nbsp;<span class="ident" id="4437097">x</span><span class="op" id="4437098">.</span><span class="ident" id="4437099">Lparen</span><span class="op" id="4437105">,</span>&nbsp;<span class="ident" id="4437107">token</span><span class="op" id="4437112">.</span><span class="ident" id="4437113">LPAREN</span><span class="op" id="4437119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437123">if</span>&nbsp;<span class="ident" id="4437126">x</span><span class="op" id="4437127">.</span><span class="ident" id="4437128">Type</span>&nbsp;<span class="op" id="4437133">!=</span>&nbsp;<span class="ident" id="4437136">nil</span>&nbsp;<span class="op" id="4437140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437145">p</span><span class="op" id="4437146">.</span><span class="ident" id="4437147">expr</span><span class="op" id="4437151">(</span><span class="ident" id="4437152">x</span><span class="op" id="4437153">.</span><span class="ident" id="4437154">Type</span><span class="op" id="4437158">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437162">}</span>&nbsp;<span class="keyword" id="4437164">else</span>&nbsp;<span class="op" id="4437169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437174">p</span><span class="op" id="4437175">.</span><span class="builtinfunc" id="4437176">print</span><span class="op" id="4437181">(</span><span class="ident" id="4437182">token</span><span class="op" id="4437187">.</span><span class="ident" id="4437188">TYPE</span><span class="op" id="4437192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437200">p</span><span class="op" id="4437201">.</span><span class="builtinfunc" id="4437202">print</span><span class="op" id="4437207">(</span><span class="ident" id="4437208">x</span><span class="op" id="4437209">.</span><span class="ident" id="4437210">Rparen</span><span class="op" id="4437216">,</span>&nbsp;<span class="ident" id="4437218">token</span><span class="op" id="4437223">.</span><span class="ident" id="4437224">RPAREN</span><span class="op" id="4437230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437234">case</span>&nbsp;<span class="op" id="4437239">*</span><span class="ident" id="4437240">ast</span><span class="op" id="4437243">.</span><span class="ident" id="4437244">IndexExpr</span><span class="op" id="4437253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437257">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437333">p</span><span class="op" id="4437334">.</span><span class="ident" id="4437335">expr1</span><span class="op" id="4437340">(</span><span class="ident" id="4437341">x</span><span class="op" id="4437342">.</span><span class="ident" id="4437343">X</span><span class="op" id="4437344">,</span>&nbsp;<span class="ident" id="4437346">token</span><span class="op" id="4437351">.</span><span class="ident" id="4437352">HighestPrec</span><span class="op" id="4437363">,</span>&nbsp;<span class="num" id="4437365">1</span><span class="op" id="4437366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437370">p</span><span class="op" id="4437371">.</span><span class="builtinfunc" id="4437372">print</span><span class="op" id="4437377">(</span><span class="ident" id="4437378">x</span><span class="op" id="4437379">.</span><span class="ident" id="4437380">Lbrack</span><span class="op" id="4437386">,</span>&nbsp;<span class="ident" id="4437388">token</span><span class="op" id="4437393">.</span><span class="ident" id="4437394">LBRACK</span><span class="op" id="4437400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437404">p</span><span class="op" id="4437405">.</span><span class="ident" id="4437406">expr0</span><span class="op" id="4437411">(</span><span class="ident" id="4437412">x</span><span class="op" id="4437413">.</span><span class="ident" id="4437414">Index</span><span class="op" id="4437419">,</span>&nbsp;<span class="ident" id="4437421">depth</span><span class="op" id="4437426">+</span><span class="num" id="4437427">1</span><span class="op" id="4437428">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437432">p</span><span class="op" id="4437433">.</span><span class="builtinfunc" id="4437434">print</span><span class="op" id="4437439">(</span><span class="ident" id="4437440">x</span><span class="op" id="4437441">.</span><span class="ident" id="4437442">Rbrack</span><span class="op" id="4437448">,</span>&nbsp;<span class="ident" id="4437450">token</span><span class="op" id="4437455">.</span><span class="ident" id="4437456">RBRACK</span><span class="op" id="4437462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437466">case</span>&nbsp;<span class="op" id="4437471">*</span><span class="ident" id="4437472">ast</span><span class="op" id="4437475">.</span><span class="ident" id="4437476">SliceExpr</span><span class="op" id="4437485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437489">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437565">p</span><span class="op" id="4437566">.</span><span class="ident" id="4437567">expr1</span><span class="op" id="4437572">(</span><span class="ident" id="4437573">x</span><span class="op" id="4437574">.</span><span class="ident" id="4437575">X</span><span class="op" id="4437576">,</span>&nbsp;<span class="ident" id="4437578">token</span><span class="op" id="4437583">.</span><span class="ident" id="4437584">HighestPrec</span><span class="op" id="4437595">,</span>&nbsp;<span class="num" id="4437597">1</span><span class="op" id="4437598">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437602">p</span><span class="op" id="4437603">.</span><span class="builtinfunc" id="4437604">print</span><span class="op" id="4437609">(</span><span class="ident" id="4437610">x</span><span class="op" id="4437611">.</span><span class="ident" id="4437612">Lbrack</span><span class="op" id="4437618">,</span>&nbsp;<span class="ident" id="4437620">token</span><span class="op" id="4437625">.</span><span class="ident" id="4437626">LBRACK</span><span class="op" id="4437632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437636">indices</span>&nbsp;<span class="op" id="4437644">:=</span>&nbsp;<span class="op" id="4437647">[</span><span class="op" id="4437648">]</span><span class="ident" id="4437649">ast</span><span class="op" id="4437652">.</span><span class="ident" id="4437653">Expr</span><span class="op" id="4437657">{</span><span class="ident" id="4437658">x</span><span class="op" id="4437659">.</span><span class="ident" id="4437660">Low</span><span class="op" id="4437663">,</span>&nbsp;<span class="ident" id="4437665">x</span><span class="op" id="4437666">.</span><span class="ident" id="4437667">High</span><span class="op" id="4437671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437675">if</span>&nbsp;<span class="ident" id="4437678">x</span><span class="op" id="4437679">.</span><span class="ident" id="4437680">Max</span>&nbsp;<span class="op" id="4437684">!=</span>&nbsp;<span class="ident" id="4437687">nil</span>&nbsp;<span class="op" id="4437691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437696">indices</span>&nbsp;<span class="op" id="4437704">=</span>&nbsp;<span class="builtinfunc" id="4437706">append</span><span class="op" id="4437712">(</span><span class="ident" id="4437713">indices</span><span class="op" id="4437720">,</span>&nbsp;<span class="ident" id="4437722">x</span><span class="op" id="4437723">.</span><span class="ident" id="4437724">Max</span><span class="op" id="4437727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4437731">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437735">for</span>&nbsp;<span class="ident" id="4437739">i</span><span class="op" id="4437740">,</span>&nbsp;<span class="ident" id="4437742">y</span>&nbsp;<span class="op" id="4437744">:=</span>&nbsp;<span class="keyword" id="4437747">range</span>&nbsp;<span class="ident" id="4437753">indices</span>&nbsp;<span class="op" id="4437761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437766">if</span>&nbsp;<span class="ident" id="4437769">i</span>&nbsp;<span class="op" id="4437771">&gt;</span>&nbsp;<span class="num" id="4437773">0</span>&nbsp;<span class="op" id="4437775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437781">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437865">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437948">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437990">x</span>&nbsp;<span class="op" id="4437992">:=</span>&nbsp;<span class="ident" id="4437995">indices</span><span class="op" id="4438002">[</span><span class="ident" id="4438003">i</span><span class="op" id="4438004">-</span><span class="num" id="4438005">1</span><span class="op" id="4438006">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438012">if</span>&nbsp;<span class="ident" id="4438015">depth</span>&nbsp;<span class="op" id="4438021">&lt;=</span>&nbsp;<span class="num" id="4438024">1</span>&nbsp;<span class="op" id="4438026">&amp;&amp;</span>&nbsp;<span class="ident" id="4438029">x</span>&nbsp;<span class="op" id="4438031">!=</span>&nbsp;<span class="ident" id="4438034">nil</span>&nbsp;<span class="op" id="4438038">&amp;&amp;</span>&nbsp;<span class="ident" id="4438041">y</span>&nbsp;<span class="op" id="4438043">!=</span>&nbsp;<span class="ident" id="4438046">nil</span>&nbsp;<span class="op" id="4438050">&amp;&amp;</span>&nbsp;<span class="op" id="4438053">(</span><span class="ident" id="4438054">isBinary</span><span class="op" id="4438062">(</span><span class="ident" id="4438063">x</span><span class="op" id="4438064">)</span>&nbsp;<span class="op" id="4438066">||</span>&nbsp;<span class="ident" id="4438069">isBinary</span><span class="op" id="4438077">(</span><span class="ident" id="4438078">y</span><span class="op" id="4438079">)</span><span class="op" id="4438080">)</span>&nbsp;<span class="op" id="4438082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438089">p</span><span class="op" id="4438090">.</span><span class="builtinfunc" id="4438091">print</span><span class="op" id="4438096">(</span><span class="ident" id="4438097">blank</span><span class="op" id="4438102">,</span>&nbsp;<span class="ident" id="4438104">token</span><span class="op" id="4438109">.</span><span class="ident" id="4438110">COLON</span><span class="op" id="4438115">,</span>&nbsp;<span class="ident" id="4438117">blank</span><span class="op" id="4438122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438128">}</span>&nbsp;<span class="keyword" id="4438130">else</span>&nbsp;<span class="op" id="4438135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438142">p</span><span class="op" id="4438143">.</span><span class="builtinfunc" id="4438144">print</span><span class="op" id="4438149">(</span><span class="ident" id="4438150">token</span><span class="op" id="4438155">.</span><span class="ident" id="4438156">COLON</span><span class="op" id="4438161">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438177">if</span>&nbsp;<span class="ident" id="4438180">y</span>&nbsp;<span class="op" id="4438182">!=</span>&nbsp;<span class="ident" id="4438185">nil</span>&nbsp;<span class="op" id="4438189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438195">p</span><span class="op" id="4438196">.</span><span class="ident" id="4438197">expr0</span><span class="op" id="4438202">(</span><span class="ident" id="4438203">y</span><span class="op" id="4438204">,</span>&nbsp;<span class="ident" id="4438206">depth</span><span class="op" id="4438211">+</span><span class="num" id="4438212">1</span><span class="op" id="4438213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438218">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438226">p</span><span class="op" id="4438227">.</span><span class="builtinfunc" id="4438228">print</span><span class="op" id="4438233">(</span><span class="ident" id="4438234">x</span><span class="op" id="4438235">.</span><span class="ident" id="4438236">Rbrack</span><span class="op" id="4438242">,</span>&nbsp;<span class="ident" id="4438244">token</span><span class="op" id="4438249">.</span><span class="ident" id="4438250">RBRACK</span><span class="op" id="4438256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438260">case</span>&nbsp;<span class="op" id="4438265">*</span><span class="ident" id="4438266">ast</span><span class="op" id="4438269">.</span><span class="ident" id="4438270">CallExpr</span><span class="op" id="4438278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438282">if</span>&nbsp;<span class="builtinfunc" id="4438285">len</span><span class="op" id="4438288">(</span><span class="ident" id="4438289">x</span><span class="op" id="4438290">.</span><span class="ident" id="4438291">Args</span><span class="op" id="4438295">)</span>&nbsp;<span class="op" id="4438297">&gt;</span>&nbsp;<span class="num" id="4438299">1</span>&nbsp;<span class="op" id="4438301">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438306">depth</span><span class="op" id="4438311">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438320">if</span>&nbsp;<span class="ident" id="4438323">_</span><span class="op" id="4438324">,</span>&nbsp;<span class="ident" id="4438326">ok</span>&nbsp;<span class="op" id="4438329">:=</span>&nbsp;<span class="ident" id="4438332">x</span><span class="op" id="4438333">.</span><span class="ident" id="4438334">Fun</span><span class="op" id="4438337">.</span><span class="op" id="4438338">(</span><span class="op" id="4438339">*</span><span class="ident" id="4438340">ast</span><span class="op" id="4438343">.</span><span class="ident" id="4438344">FuncType</span><span class="op" id="4438352">)</span><span class="op" id="4438353">;</span>&nbsp;<span class="ident" id="4438355">ok</span>&nbsp;<span class="op" id="4438358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4438363">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438443">p</span><span class="op" id="4438444">.</span><span class="builtinfunc" id="4438445">print</span><span class="op" id="4438450">(</span><span class="ident" id="4438451">token</span><span class="op" id="4438456">.</span><span class="ident" id="4438457">LPAREN</span><span class="op" id="4438463">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438468">p</span><span class="op" id="4438469">.</span><span class="ident" id="4438470">expr1</span><span class="op" id="4438475">(</span><span class="ident" id="4438476">x</span><span class="op" id="4438477">.</span><span class="ident" id="4438478">Fun</span><span class="op" id="4438481">,</span>&nbsp;<span class="ident" id="4438483">token</span><span class="op" id="4438488">.</span><span class="ident" id="4438489">HighestPrec</span><span class="op" id="4438500">,</span>&nbsp;<span class="ident" id="4438502">depth</span><span class="op" id="4438507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438512">p</span><span class="op" id="4438513">.</span><span class="builtinfunc" id="4438514">print</span><span class="op" id="4438519">(</span><span class="ident" id="4438520">token</span><span class="op" id="4438525">.</span><span class="ident" id="4438526">RPAREN</span><span class="op" id="4438532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438536">}</span>&nbsp;<span class="keyword" id="4438538">else</span>&nbsp;<span class="op" id="4438543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438548">p</span><span class="op" id="4438549">.</span><span class="ident" id="4438550">expr1</span><span class="op" id="4438555">(</span><span class="ident" id="4438556">x</span><span class="op" id="4438557">.</span><span class="ident" id="4438558">Fun</span><span class="op" id="4438561">,</span>&nbsp;<span class="ident" id="4438563">token</span><span class="op" id="4438568">.</span><span class="ident" id="4438569">HighestPrec</span><span class="op" id="4438580">,</span>&nbsp;<span class="ident" id="4438582">depth</span><span class="op" id="4438587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438591">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438595">p</span><span class="op" id="4438596">.</span><span class="builtinfunc" id="4438597">print</span><span class="op" id="4438602">(</span><span class="ident" id="4438603">x</span><span class="op" id="4438604">.</span><span class="ident" id="4438605">Lparen</span><span class="op" id="4438611">,</span>&nbsp;<span class="ident" id="4438613">token</span><span class="op" id="4438618">.</span><span class="ident" id="4438619">LPAREN</span><span class="op" id="4438625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438629">if</span>&nbsp;<span class="ident" id="4438632">x</span><span class="op" id="4438633">.</span><span class="ident" id="4438634">Ellipsis</span><span class="op" id="4438642">.</span><span class="ident" id="4438643">IsValid</span><span class="op" id="4438650">(</span><span class="op" id="4438651">)</span>&nbsp;<span class="op" id="4438653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438658">p</span><span class="op" id="4438659">.</span><span class="ident" id="4438660">exprList</span><span class="op" id="4438668">(</span><span class="ident" id="4438669">x</span><span class="op" id="4438670">.</span><span class="ident" id="4438671">Lparen</span><span class="op" id="4438677">,</span>&nbsp;<span class="ident" id="4438679">x</span><span class="op" id="4438680">.</span><span class="ident" id="4438681">Args</span><span class="op" id="4438685">,</span>&nbsp;<span class="ident" id="4438687">depth</span><span class="op" id="4438692">,</span>&nbsp;<span class="num" id="4438694">0</span><span class="op" id="4438695">,</span>&nbsp;<span class="ident" id="4438697">x</span><span class="op" id="4438698">.</span><span class="ident" id="4438699">Ellipsis</span><span class="op" id="4438707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438712">p</span><span class="op" id="4438713">.</span><span class="builtinfunc" id="4438714">print</span><span class="op" id="4438719">(</span><span class="ident" id="4438720">x</span><span class="op" id="4438721">.</span><span class="ident" id="4438722">Ellipsis</span><span class="op" id="4438730">,</span>&nbsp;<span class="ident" id="4438732">token</span><span class="op" id="4438737">.</span><span class="ident" id="4438738">ELLIPSIS</span><span class="op" id="4438746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438751">if</span>&nbsp;<span class="ident" id="4438754">x</span><span class="op" id="4438755">.</span><span class="ident" id="4438756">Rparen</span><span class="op" id="4438762">.</span><span class="ident" id="4438763">IsValid</span><span class="op" id="4438770">(</span><span class="op" id="4438771">)</span>&nbsp;<span class="op" id="4438773">&amp;&amp;</span>&nbsp;<span class="ident" id="4438776">p</span><span class="op" id="4438777">.</span><span class="ident" id="4438778">lineFor</span><span class="op" id="4438785">(</span><span class="ident" id="4438786">x</span><span class="op" id="4438787">.</span><span class="ident" id="4438788">Ellipsis</span><span class="op" id="4438796">)</span>&nbsp;<span class="op" id="4438798">&lt;</span>&nbsp;<span class="ident" id="4438800">p</span><span class="op" id="4438801">.</span><span class="ident" id="4438802">lineFor</span><span class="op" id="4438809">(</span><span class="ident" id="4438810">x</span><span class="op" id="4438811">.</span><span class="ident" id="4438812">Rparen</span><span class="op" id="4438818">)</span>&nbsp;<span class="op" id="4438820">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438826">p</span><span class="op" id="4438827">.</span><span class="builtinfunc" id="4438828">print</span><span class="op" id="4438833">(</span><span class="ident" id="4438834">token</span><span class="op" id="4438839">.</span><span class="ident" id="4438840">COMMA</span><span class="op" id="4438845">,</span>&nbsp;<span class="ident" id="4438847">formfeed</span><span class="op" id="4438855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438864">}</span>&nbsp;<span class="keyword" id="4438866">else</span>&nbsp;<span class="op" id="4438871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438876">p</span><span class="op" id="4438877">.</span><span class="ident" id="4438878">exprList</span><span class="op" id="4438886">(</span><span class="ident" id="4438887">x</span><span class="op" id="4438888">.</span><span class="ident" id="4438889">Lparen</span><span class="op" id="4438895">,</span>&nbsp;<span class="ident" id="4438897">x</span><span class="op" id="4438898">.</span><span class="ident" id="4438899">Args</span><span class="op" id="4438903">,</span>&nbsp;<span class="ident" id="4438905">depth</span><span class="op" id="4438910">,</span>&nbsp;<span class="ident" id="4438912">commaTerm</span><span class="op" id="4438921">,</span>&nbsp;<span class="ident" id="4438923">x</span><span class="op" id="4438924">.</span><span class="ident" id="4438925">Rparen</span><span class="op" id="4438931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438935">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438939">p</span><span class="op" id="4438940">.</span><span class="builtinfunc" id="4438941">print</span><span class="op" id="4438946">(</span><span class="ident" id="4438947">x</span><span class="op" id="4438948">.</span><span class="ident" id="4438949">Rparen</span><span class="op" id="4438955">,</span>&nbsp;<span class="ident" id="4438957">token</span><span class="op" id="4438962">.</span><span class="ident" id="4438963">RPAREN</span><span class="op" id="4438969">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438973">case</span>&nbsp;<span class="op" id="4438978">*</span><span class="ident" id="4438979">ast</span><span class="op" id="4438982">.</span><span class="ident" id="4438983">CompositeLit</span><span class="op" id="4438995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4438999">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439096">if</span>&nbsp;<span class="ident" id="4439099">x</span><span class="op" id="4439100">.</span><span class="ident" id="4439101">Type</span>&nbsp;<span class="op" id="4439106">!=</span>&nbsp;<span class="ident" id="4439109">nil</span>&nbsp;<span class="op" id="4439113">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439118">p</span><span class="op" id="4439119">.</span><span class="ident" id="4439120">expr1</span><span class="op" id="4439125">(</span><span class="ident" id="4439126">x</span><span class="op" id="4439127">.</span><span class="ident" id="4439128">Type</span><span class="op" id="4439132">,</span>&nbsp;<span class="ident" id="4439134">token</span><span class="op" id="4439139">.</span><span class="ident" id="4439140">HighestPrec</span><span class="op" id="4439151">,</span>&nbsp;<span class="ident" id="4439153">depth</span><span class="op" id="4439158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439166">p</span><span class="op" id="4439167">.</span><span class="builtinfunc" id="4439168">print</span><span class="op" id="4439173">(</span><span class="ident" id="4439174">x</span><span class="op" id="4439175">.</span><span class="ident" id="4439176">Lbrace</span><span class="op" id="4439182">,</span>&nbsp;<span class="ident" id="4439184">token</span><span class="op" id="4439189">.</span><span class="ident" id="4439190">LBRACE</span><span class="op" id="4439196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439200">p</span><span class="op" id="4439201">.</span><span class="ident" id="4439202">exprList</span><span class="op" id="4439210">(</span><span class="ident" id="4439211">x</span><span class="op" id="4439212">.</span><span class="ident" id="4439213">Lbrace</span><span class="op" id="4439219">,</span>&nbsp;<span class="ident" id="4439221">x</span><span class="op" id="4439222">.</span><span class="ident" id="4439223">Elts</span><span class="op" id="4439227">,</span>&nbsp;<span class="num" id="4439229">1</span><span class="op" id="4439230">,</span>&nbsp;<span class="ident" id="4439232">commaTerm</span><span class="op" id="4439241">,</span>&nbsp;<span class="ident" id="4439243">x</span><span class="op" id="4439244">.</span><span class="ident" id="4439245">Rbrace</span><span class="op" id="4439251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439255">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439320">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439384">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439408">mode</span>&nbsp;<span class="op" id="4439413">:=</span>&nbsp;<span class="ident" id="4439416">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439435">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4439495">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439551">if</span>&nbsp;<span class="builtinfunc" id="4439554">len</span><span class="op" id="4439557">(</span><span class="ident" id="4439558">x</span><span class="op" id="4439559">.</span><span class="ident" id="4439560">Elts</span><span class="op" id="4439564">)</span>&nbsp;<span class="op" id="4439566">&gt;</span>&nbsp;<span class="num" id="4439568">0</span>&nbsp;<span class="op" id="4439570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439575">mode</span>&nbsp;<span class="op" id="4439580">|=</span>&nbsp;<span class="ident" id="4439583">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439602">p</span><span class="op" id="4439603">.</span><span class="builtinfunc" id="4439604">print</span><span class="op" id="4439609">(</span><span class="ident" id="4439610">mode</span><span class="op" id="4439614">,</span>&nbsp;<span class="ident" id="4439616">x</span><span class="op" id="4439617">.</span><span class="ident" id="4439618">Rbrace</span><span class="op" id="4439624">,</span>&nbsp;<span class="ident" id="4439626">token</span><span class="op" id="4439631">.</span><span class="ident" id="4439632">RBRACE</span><span class="op" id="4439638">,</span>&nbsp;<span class="ident" id="4439640">mode</span><span class="op" id="4439644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439648">case</span>&nbsp;<span class="op" id="4439653">*</span><span class="ident" id="4439654">ast</span><span class="op" id="4439657">.</span><span class="ident" id="4439658">Ellipsis</span><span class="op" id="4439666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439670">p</span><span class="op" id="4439671">.</span><span class="builtinfunc" id="4439672">print</span><span class="op" id="4439677">(</span><span class="ident" id="4439678">token</span><span class="op" id="4439683">.</span><span class="ident" id="4439684">ELLIPSIS</span><span class="op" id="4439692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439696">if</span>&nbsp;<span class="ident" id="4439699">x</span><span class="op" id="4439700">.</span><span class="ident" id="4439701">Elt</span>&nbsp;<span class="op" id="4439705">!=</span>&nbsp;<span class="ident" id="4439708">nil</span>&nbsp;<span class="op" id="4439712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439717">p</span><span class="op" id="4439718">.</span><span class="ident" id="4439719">expr</span><span class="op" id="4439723">(</span><span class="ident" id="4439724">x</span><span class="op" id="4439725">.</span><span class="ident" id="4439726">Elt</span><span class="op" id="4439729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439733">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439737">case</span>&nbsp;<span class="op" id="4439742">*</span><span class="ident" id="4439743">ast</span><span class="op" id="4439746">.</span><span class="ident" id="4439747">ArrayType</span><span class="op" id="4439756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439760">p</span><span class="op" id="4439761">.</span><span class="builtinfunc" id="4439762">print</span><span class="op" id="4439767">(</span><span class="ident" id="4439768">token</span><span class="op" id="4439773">.</span><span class="ident" id="4439774">LBRACK</span><span class="op" id="4439780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439784">if</span>&nbsp;<span class="ident" id="4439787">x</span><span class="op" id="4439788">.</span><span class="ident" id="4439789">Len</span>&nbsp;<span class="op" id="4439793">!=</span>&nbsp;<span class="ident" id="4439796">nil</span>&nbsp;<span class="op" id="4439800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439805">p</span><span class="op" id="4439806">.</span><span class="ident" id="4439807">expr</span><span class="op" id="4439811">(</span><span class="ident" id="4439812">x</span><span class="op" id="4439813">.</span><span class="ident" id="4439814">Len</span><span class="op" id="4439817">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439825">p</span><span class="op" id="4439826">.</span><span class="builtinfunc" id="4439827">print</span><span class="op" id="4439832">(</span><span class="ident" id="4439833">token</span><span class="op" id="4439838">.</span><span class="ident" id="4439839">RBRACK</span><span class="op" id="4439845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439849">p</span><span class="op" id="4439850">.</span><span class="ident" id="4439851">expr</span><span class="op" id="4439855">(</span><span class="ident" id="4439856">x</span><span class="op" id="4439857">.</span><span class="ident" id="4439858">Elt</span><span class="op" id="4439861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439865">case</span>&nbsp;<span class="op" id="4439870">*</span><span class="ident" id="4439871">ast</span><span class="op" id="4439874">.</span><span class="ident" id="4439875">StructType</span><span class="op" id="4439885">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439889">p</span><span class="op" id="4439890">.</span><span class="builtinfunc" id="4439891">print</span><span class="op" id="4439896">(</span><span class="ident" id="4439897">token</span><span class="op" id="4439902">.</span><span class="ident" id="4439903">STRUCT</span><span class="op" id="4439909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439913">p</span><span class="op" id="4439914">.</span><span class="ident" id="4439915">fieldList</span><span class="op" id="4439924">(</span><span class="ident" id="4439925">x</span><span class="op" id="4439926">.</span><span class="ident" id="4439927">Fields</span><span class="op" id="4439933">,</span>&nbsp;<span class="builtintype" id="4439935">true</span><span class="op" id="4439939">,</span>&nbsp;<span class="ident" id="4439941">x</span><span class="op" id="4439942">.</span><span class="ident" id="4439943">Incomplete</span><span class="op" id="4439953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439957">case</span>&nbsp;<span class="op" id="4439962">*</span><span class="ident" id="4439963">ast</span><span class="op" id="4439966">.</span><span class="ident" id="4439967">FuncType</span><span class="op" id="4439975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439979">p</span><span class="op" id="4439980">.</span><span class="builtinfunc" id="4439981">print</span><span class="op" id="4439986">(</span><span class="ident" id="4439987">token</span><span class="op" id="4439992">.</span><span class="ident" id="4439993">FUNC</span><span class="op" id="4439997">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440001">p</span><span class="op" id="4440002">.</span><span class="ident" id="4440003">signature</span><span class="op" id="4440012">(</span><span class="ident" id="4440013">x</span><span class="op" id="4440014">.</span><span class="ident" id="4440015">Params</span><span class="op" id="4440021">,</span>&nbsp;<span class="ident" id="4440023">x</span><span class="op" id="4440024">.</span><span class="ident" id="4440025">Results</span><span class="op" id="4440032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440036">case</span>&nbsp;<span class="op" id="4440041">*</span><span class="ident" id="4440042">ast</span><span class="op" id="4440045">.</span><span class="ident" id="4440046">InterfaceType</span><span class="op" id="4440059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440063">p</span><span class="op" id="4440064">.</span><span class="builtinfunc" id="4440065">print</span><span class="op" id="4440070">(</span><span class="ident" id="4440071">token</span><span class="op" id="4440076">.</span><span class="ident" id="4440077">INTERFACE</span><span class="op" id="4440086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440090">p</span><span class="op" id="4440091">.</span><span class="ident" id="4440092">fieldList</span><span class="op" id="4440101">(</span><span class="ident" id="4440102">x</span><span class="op" id="4440103">.</span><span class="ident" id="4440104">Methods</span><span class="op" id="4440111">,</span>&nbsp;<span class="builtintype" id="4440113">false</span><span class="op" id="4440118">,</span>&nbsp;<span class="ident" id="4440120">x</span><span class="op" id="4440121">.</span><span class="ident" id="4440122">Incomplete</span><span class="op" id="4440132">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440136">case</span>&nbsp;<span class="op" id="4440141">*</span><span class="ident" id="4440142">ast</span><span class="op" id="4440145">.</span><span class="ident" id="4440146">MapType</span><span class="op" id="4440153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440157">p</span><span class="op" id="4440158">.</span><span class="builtinfunc" id="4440159">print</span><span class="op" id="4440164">(</span><span class="ident" id="4440165">token</span><span class="op" id="4440170">.</span><span class="ident" id="4440171">MAP</span><span class="op" id="4440174">,</span>&nbsp;<span class="ident" id="4440176">token</span><span class="op" id="4440181">.</span><span class="ident" id="4440182">LBRACK</span><span class="op" id="4440188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440192">p</span><span class="op" id="4440193">.</span><span class="ident" id="4440194">expr</span><span class="op" id="4440198">(</span><span class="ident" id="4440199">x</span><span class="op" id="4440200">.</span><span class="ident" id="4440201">Key</span><span class="op" id="4440204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440208">p</span><span class="op" id="4440209">.</span><span class="builtinfunc" id="4440210">print</span><span class="op" id="4440215">(</span><span class="ident" id="4440216">token</span><span class="op" id="4440221">.</span><span class="ident" id="4440222">RBRACK</span><span class="op" id="4440228">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440232">p</span><span class="op" id="4440233">.</span><span class="ident" id="4440234">expr</span><span class="op" id="4440238">(</span><span class="ident" id="4440239">x</span><span class="op" id="4440240">.</span><span class="ident" id="4440241">Value</span><span class="op" id="4440246">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440250">case</span>&nbsp;<span class="op" id="4440255">*</span><span class="ident" id="4440256">ast</span><span class="op" id="4440259">.</span><span class="ident" id="4440260">ChanType</span><span class="op" id="4440268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440272">switch</span>&nbsp;<span class="ident" id="4440279">x</span><span class="op" id="4440280">.</span><span class="ident" id="4440281">Dir</span>&nbsp;<span class="op" id="4440285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440289">case</span>&nbsp;<span class="ident" id="4440294">ast</span><span class="op" id="4440297">.</span><span class="ident" id="4440298">SEND</span>&nbsp;<span class="op" id="4440303">|</span>&nbsp;<span class="ident" id="4440305">ast</span><span class="op" id="4440308">.</span><span class="ident" id="4440309">RECV</span><span class="op" id="4440313">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440318">p</span><span class="op" id="4440319">.</span><span class="builtinfunc" id="4440320">print</span><span class="op" id="4440325">(</span><span class="ident" id="4440326">token</span><span class="op" id="4440331">.</span><span class="ident" id="4440332">CHAN</span><span class="op" id="4440336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440340">case</span>&nbsp;<span class="ident" id="4440345">ast</span><span class="op" id="4440348">.</span><span class="ident" id="4440349">RECV</span><span class="op" id="4440353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440358">p</span><span class="op" id="4440359">.</span><span class="builtinfunc" id="4440360">print</span><span class="op" id="4440365">(</span><span class="ident" id="4440366">token</span><span class="op" id="4440371">.</span><span class="ident" id="4440372">ARROW</span><span class="op" id="4440377">,</span>&nbsp;<span class="ident" id="4440379">token</span><span class="op" id="4440384">.</span><span class="ident" id="4440385">CHAN</span><span class="op" id="4440389">)</span>&nbsp;<span class="comment" id="4440391">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440429">case</span>&nbsp;<span class="ident" id="4440434">ast</span><span class="op" id="4440437">.</span><span class="ident" id="4440438">SEND</span><span class="op" id="4440442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440447">p</span><span class="op" id="4440448">.</span><span class="builtinfunc" id="4440449">print</span><span class="op" id="4440454">(</span><span class="ident" id="4440455">token</span><span class="op" id="4440460">.</span><span class="ident" id="4440461">CHAN</span><span class="op" id="4440465">,</span>&nbsp;<span class="ident" id="4440467">x</span><span class="op" id="4440468">.</span><span class="ident" id="4440469">Arrow</span><span class="op" id="4440474">,</span>&nbsp;<span class="ident" id="4440476">token</span><span class="op" id="4440481">.</span><span class="ident" id="4440482">ARROW</span><span class="op" id="4440487">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440495">p</span><span class="op" id="4440496">.</span><span class="builtinfunc" id="4440497">print</span><span class="op" id="4440502">(</span><span class="ident" id="4440503">blank</span><span class="op" id="4440508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440512">p</span><span class="op" id="4440513">.</span><span class="ident" id="4440514">expr</span><span class="op" id="4440518">(</span><span class="ident" id="4440519">x</span><span class="op" id="4440520">.</span><span class="ident" id="4440521">Value</span><span class="op" id="4440526">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440530">default</span><span class="op" id="4440537">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4440541">panic</span><span class="op" id="4440546">(</span><span class="string" id="4440547">&#34;unreachable&#34;</span><span class="op" id="4440560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440567">return</span><br>
<span class="lineno"></span><span class="op" id="4440574">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="4440577">func</span>&nbsp;<span class="op" id="4440582">(</span><span class="ident" id="4440583">p</span>&nbsp;<span class="op" id="4440585">*</span><span class="ident" id="4440586">printer</span><span class="op" id="4440593">)</span>&nbsp;<span class="ident" id="4440595">expr0</span><span class="op" id="4440600">(</span><span class="ident" id="4440601">x</span>&nbsp;<span class="ident" id="4440603">ast</span><span class="op" id="4440606">.</span><span class="ident" id="4440607">Expr</span><span class="op" id="4440611">,</span>&nbsp;<span class="ident" id="4440613">depth</span>&nbsp;<span class="builtintype" id="4440619">int</span><span class="op" id="4440622">)</span>&nbsp;<span class="op" id="4440624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440627">p</span><span class="op" id="4440628">.</span><span class="ident" id="4440629">expr1</span><span class="op" id="4440634">(</span><span class="ident" id="4440635">x</span><span class="op" id="4440636">,</span>&nbsp;<span class="ident" id="4440638">token</span><span class="op" id="4440643">.</span><span class="ident" id="4440644">LowestPrec</span><span class="op" id="4440654">,</span>&nbsp;<span class="ident" id="4440656">depth</span><span class="op" id="4440661">)</span><br>
<span class="lineno"></span><span class="op" id="4440663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="4440666">func</span>&nbsp;<span class="op" id="4440671">(</span><span class="ident" id="4440672">p</span>&nbsp;<span class="op" id="4440674">*</span><span class="ident" id="4440675">printer</span><span class="op" id="4440682">)</span>&nbsp;<span class="ident" id="4440684">expr</span><span class="op" id="4440688">(</span><span class="ident" id="4440689">x</span>&nbsp;<span class="ident" id="4440691">ast</span><span class="op" id="4440694">.</span><span class="ident" id="4440695">Expr</span><span class="op" id="4440699">)</span>&nbsp;<span class="op" id="4440701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440704">const</span>&nbsp;<span class="ident" id="4440710">depth</span>&nbsp;<span class="op" id="4440716">=</span>&nbsp;<span class="num" id="4440718">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440721">p</span><span class="op" id="4440722">.</span><span class="ident" id="4440723">expr1</span><span class="op" id="4440728">(</span><span class="ident" id="4440729">x</span><span class="op" id="4440730">,</span>&nbsp;<span class="ident" id="4440732">token</span><span class="op" id="4440737">.</span><span class="ident" id="4440738">LowestPrec</span><span class="op" id="4440748">,</span>&nbsp;<span class="ident" id="4440750">depth</span><span class="op" id="4440755">)</span><br>
<span class="lineno"></span><span class="op" id="4440757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="4440760">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4440840">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4440855">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="4440941">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="4441025">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="4441070">func</span>&nbsp;<span class="op" id="4441075">(</span><span class="ident" id="4441076">p</span>&nbsp;<span class="op" id="4441078">*</span><span class="ident" id="4441079">printer</span><span class="op" id="4441086">)</span>&nbsp;<span class="ident" id="4441088">stmtList</span><span class="op" id="4441096">(</span><span class="ident" id="4441097">list</span>&nbsp;<span class="op" id="4441102">[</span><span class="op" id="4441103">]</span><span class="ident" id="4441104">ast</span><span class="op" id="4441107">.</span><span class="ident" id="4441108">Stmt</span><span class="op" id="4441112">,</span>&nbsp;<span class="ident" id="4441114">nindent</span>&nbsp;<span class="builtintype" id="4441122">int</span><span class="op" id="4441125">,</span>&nbsp;<span class="ident" id="4441127">nextIsRBrace</span>&nbsp;<span class="builtintype" id="4441140">bool</span><span class="op" id="4441144">)</span>&nbsp;<span class="op" id="4441146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441149">if</span>&nbsp;<span class="ident" id="4441152">nindent</span>&nbsp;<span class="op" id="4441160">&gt;</span>&nbsp;<span class="num" id="4441162">0</span>&nbsp;<span class="op" id="4441164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441168">p</span><span class="op" id="4441169">.</span><span class="builtinfunc" id="4441170">print</span><span class="op" id="4441175">(</span><span class="ident" id="4441176">indent</span><span class="op" id="4441182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441185">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441188">var</span>&nbsp;<span class="ident" id="4441192">line</span>&nbsp;<span class="builtintype" id="4441197">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441202">i</span>&nbsp;<span class="op" id="4441204">:=</span>&nbsp;<span class="num" id="4441207">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441210">for</span>&nbsp;<span class="ident" id="4441214">_</span><span class="op" id="4441215">,</span>&nbsp;<span class="ident" id="4441217">s</span>&nbsp;<span class="op" id="4441219">:=</span>&nbsp;<span class="keyword" id="4441222">range</span>&nbsp;<span class="ident" id="4441228">list</span>&nbsp;<span class="op" id="4441233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441237">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441283">if</span>&nbsp;<span class="ident" id="4441286">_</span><span class="op" id="4441287">,</span>&nbsp;<span class="ident" id="4441289">isEmpty</span>&nbsp;<span class="op" id="4441297">:=</span>&nbsp;<span class="ident" id="4441300">s</span><span class="op" id="4441301">.</span><span class="op" id="4441302">(</span><span class="op" id="4441303">*</span><span class="ident" id="4441304">ast</span><span class="op" id="4441307">.</span><span class="ident" id="4441308">EmptyStmt</span><span class="op" id="4441317">)</span><span class="op" id="4441318">;</span>&nbsp;<span class="op" id="4441320">!</span><span class="ident" id="4441321">isEmpty</span>&nbsp;<span class="op" id="4441329">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441334">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441399">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441449">if</span>&nbsp;<span class="builtinfunc" id="4441452">len</span><span class="op" id="4441455">(</span><span class="ident" id="4441456">p</span><span class="op" id="4441457">.</span><span class="ident" id="4441458">output</span><span class="op" id="4441464">)</span>&nbsp;<span class="op" id="4441466">&gt;</span>&nbsp;<span class="num" id="4441468">0</span>&nbsp;<span class="op" id="4441470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441476">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441550">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441608">p</span><span class="op" id="4441609">.</span><span class="ident" id="4441610">linebreak</span><span class="op" id="4441619">(</span><span class="ident" id="4441620">p</span><span class="op" id="4441621">.</span><span class="ident" id="4441622">lineFor</span><span class="op" id="4441629">(</span><span class="ident" id="4441630">s</span><span class="op" id="4441631">.</span><span class="ident" id="4441632">Pos</span><span class="op" id="4441635">(</span><span class="op" id="4441636">)</span><span class="op" id="4441637">)</span><span class="op" id="4441638">,</span>&nbsp;<span class="num" id="4441640">1</span><span class="op" id="4441641">,</span>&nbsp;<span class="ident" id="4441643">ignore</span><span class="op" id="4441649">,</span>&nbsp;<span class="ident" id="4441651">i</span>&nbsp;<span class="op" id="4441653">==</span>&nbsp;<span class="num" id="4441656">0</span>&nbsp;<span class="op" id="4441658">||</span>&nbsp;<span class="ident" id="4441661">nindent</span>&nbsp;<span class="op" id="4441669">==</span>&nbsp;<span class="num" id="4441672">0</span>&nbsp;<span class="op" id="4441674">||</span>&nbsp;<span class="ident" id="4441677">p</span><span class="op" id="4441678">.</span><span class="ident" id="4441679">linesFrom</span><span class="op" id="4441688">(</span><span class="ident" id="4441689">line</span><span class="op" id="4441693">)</span>&nbsp;<span class="op" id="4441695">&gt;</span>&nbsp;<span class="num" id="4441697">0</span><span class="op" id="4441698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441708">p</span><span class="op" id="4441709">.</span><span class="ident" id="4441710">recordLine</span><span class="op" id="4441720">(</span><span class="op" id="4441721">&amp;</span><span class="ident" id="4441722">line</span><span class="op" id="4441726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441731">p</span><span class="op" id="4441732">.</span><span class="ident" id="4441733">stmt</span><span class="op" id="4441737">(</span><span class="ident" id="4441738">s</span><span class="op" id="4441739">,</span>&nbsp;<span class="ident" id="4441741">nextIsRBrace</span>&nbsp;<span class="op" id="4441754">&amp;&amp;</span>&nbsp;<span class="ident" id="4441757">i</span>&nbsp;<span class="op" id="4441759">==</span>&nbsp;<span class="builtinfunc" id="4441762">len</span><span class="op" id="4441765">(</span><span class="ident" id="4441766">list</span><span class="op" id="4441770">)</span><span class="op" id="4441771">-</span><span class="num" id="4441772">1</span><span class="op" id="4441773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441778">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441843">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4441907">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441957">for</span>&nbsp;<span class="ident" id="4441961">t</span>&nbsp;<span class="op" id="4441963">:=</span>&nbsp;<span class="ident" id="4441966">s</span><span class="op" id="4441967">;</span>&nbsp;<span class="op" id="4441969">;</span>&nbsp;<span class="op" id="4441971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441977">lt</span><span class="op" id="4441979">,</span>&nbsp;<span class="ident" id="4441981">_</span>&nbsp;<span class="op" id="4441983">:=</span>&nbsp;<span class="ident" id="4441986">t</span><span class="op" id="4441987">.</span><span class="op" id="4441988">(</span><span class="op" id="4441989">*</span><span class="ident" id="4441990">ast</span><span class="op" id="4441993">.</span><span class="ident" id="4441994">LabeledStmt</span><span class="op" id="4442005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442011">if</span>&nbsp;<span class="ident" id="4442014">lt</span>&nbsp;<span class="op" id="4442017">==</span>&nbsp;<span class="ident" id="4442020">nil</span>&nbsp;<span class="op" id="4442024">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442031">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442047">line</span><span class="op" id="4442051">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442058">t</span>&nbsp;<span class="op" id="4442060">=</span>&nbsp;<span class="ident" id="4442062">lt</span><span class="op" id="4442064">.</span><span class="ident" id="4442065">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442073">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442078">i</span><span class="op" id="4442079">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442090">if</span>&nbsp;<span class="ident" id="4442093">nindent</span>&nbsp;<span class="op" id="4442101">&gt;</span>&nbsp;<span class="num" id="4442103">0</span>&nbsp;<span class="op" id="4442105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442109">p</span><span class="op" id="4442110">.</span><span class="builtinfunc" id="4442111">print</span><span class="op" id="4442116">(</span><span class="ident" id="4442117">unindent</span><span class="op" id="4442125">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442128">}</span><br>
<span class="lineno"></span><span class="op" id="4442130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4442133">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="4442204">func</span>&nbsp;<span class="op" id="4442209">(</span><span class="ident" id="4442210">p</span>&nbsp;<span class="op" id="4442212">*</span><span class="ident" id="4442213">printer</span><span class="op" id="4442220">)</span>&nbsp;<span class="ident" id="4442222">block</span><span class="op" id="4442227">(</span><span class="ident" id="4442228">b</span>&nbsp;<span class="op" id="4442230">*</span><span class="ident" id="4442231">ast</span><span class="op" id="4442234">.</span><span class="ident" id="4442235">BlockStmt</span><span class="op" id="4442244">,</span>&nbsp;<span class="ident" id="4442246">nindent</span>&nbsp;<span class="builtintype" id="4442254">int</span><span class="op" id="4442257">)</span>&nbsp;<span class="op" id="4442259">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442262">p</span><span class="op" id="4442263">.</span><span class="builtinfunc" id="4442264">print</span><span class="op" id="4442269">(</span><span class="ident" id="4442270">b</span><span class="op" id="4442271">.</span><span class="ident" id="4442272">Lbrace</span><span class="op" id="4442278">,</span>&nbsp;<span class="ident" id="4442280">token</span><span class="op" id="4442285">.</span><span class="ident" id="4442286">LBRACE</span><span class="op" id="4442292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442295">p</span><span class="op" id="4442296">.</span><span class="ident" id="4442297">stmtList</span><span class="op" id="4442305">(</span><span class="ident" id="4442306">b</span><span class="op" id="4442307">.</span><span class="ident" id="4442308">List</span><span class="op" id="4442312">,</span>&nbsp;<span class="ident" id="4442314">nindent</span><span class="op" id="4442321">,</span>&nbsp;<span class="builtintype" id="4442323">true</span><span class="op" id="4442327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442330">p</span><span class="op" id="4442331">.</span><span class="ident" id="4442332">linebreak</span><span class="op" id="4442341">(</span><span class="ident" id="4442342">p</span><span class="op" id="4442343">.</span><span class="ident" id="4442344">lineFor</span><span class="op" id="4442351">(</span><span class="ident" id="4442352">b</span><span class="op" id="4442353">.</span><span class="ident" id="4442354">Rbrace</span><span class="op" id="4442360">)</span><span class="op" id="4442361">,</span>&nbsp;<span class="num" id="4442363">1</span><span class="op" id="4442364">,</span>&nbsp;<span class="ident" id="4442366">ignore</span><span class="op" id="4442372">,</span>&nbsp;<span class="builtintype" id="4442374">true</span><span class="op" id="4442378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442381">p</span><span class="op" id="4442382">.</span><span class="builtinfunc" id="4442383">print</span><span class="op" id="4442388">(</span><span class="ident" id="4442389">b</span><span class="op" id="4442390">.</span><span class="ident" id="4442391">Rbrace</span><span class="op" id="4442397">,</span>&nbsp;<span class="ident" id="4442399">token</span><span class="op" id="4442404">.</span><span class="ident" id="4442405">RBRACE</span><span class="op" id="4442411">)</span><br>
<span class="lineno"></span><span class="op" id="4442413">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="4442416">func</span>&nbsp;<span class="ident" id="4442421">isTypeName</span><span class="op" id="4442431">(</span><span class="ident" id="4442432">x</span>&nbsp;<span class="ident" id="4442434">ast</span><span class="op" id="4442437">.</span><span class="ident" id="4442438">Expr</span><span class="op" id="4442442">)</span>&nbsp;<span class="builtintype" id="4442444">bool</span>&nbsp;<span class="op" id="4442449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442452">switch</span>&nbsp;<span class="ident" id="4442459">t</span>&nbsp;<span class="op" id="4442461">:=</span>&nbsp;<span class="ident" id="4442464">x</span><span class="op" id="4442465">.</span><span class="op" id="4442466">(</span><span class="keyword" id="4442467">type</span><span class="op" id="4442471">)</span>&nbsp;<span class="op" id="4442473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442476">case</span>&nbsp;<span class="op" id="4442481">*</span><span class="ident" id="4442482">ast</span><span class="op" id="4442485">.</span><span class="ident" id="4442486">Ident</span><span class="op" id="4442491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442495">return</span>&nbsp;<span class="builtintype" id="4442502">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442508">case</span>&nbsp;<span class="op" id="4442513">*</span><span class="ident" id="4442514">ast</span><span class="op" id="4442517">.</span><span class="ident" id="4442518">SelectorExpr</span><span class="op" id="4442530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442534">return</span>&nbsp;<span class="ident" id="4442541">isTypeName</span><span class="op" id="4442551">(</span><span class="ident" id="4442552">t</span><span class="op" id="4442553">.</span><span class="ident" id="4442554">X</span><span class="op" id="4442555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442561">return</span>&nbsp;<span class="builtintype" id="4442568">false</span><br>
<span class="lineno"></span><span class="op" id="4442574">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="4442577">func</span>&nbsp;<span class="ident" id="4442582">stripParens</span><span class="op" id="4442593">(</span><span class="ident" id="4442594">x</span>&nbsp;<span class="ident" id="4442596">ast</span><span class="op" id="4442599">.</span><span class="ident" id="4442600">Expr</span><span class="op" id="4442604">)</span>&nbsp;<span class="ident" id="4442606">ast</span><span class="op" id="4442609">.</span><span class="ident" id="4442610">Expr</span>&nbsp;<span class="op" id="4442615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442618">if</span>&nbsp;<span class="ident" id="4442621">px</span><span class="op" id="4442623">,</span>&nbsp;<span class="ident" id="4442625">strip</span>&nbsp;<span class="op" id="4442631">:=</span>&nbsp;<span class="ident" id="4442634">x</span><span class="op" id="4442635">.</span><span class="op" id="4442636">(</span><span class="op" id="4442637">*</span><span class="ident" id="4442638">ast</span><span class="op" id="4442641">.</span><span class="ident" id="4442642">ParenExpr</span><span class="op" id="4442651">)</span><span class="op" id="4442652">;</span>&nbsp;<span class="ident" id="4442654">strip</span>&nbsp;<span class="op" id="4442660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442664">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442719">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442773">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442790">ast</span><span class="op" id="4442793">.</span><span class="ident" id="4442794">Inspect</span><span class="op" id="4442801">(</span><span class="ident" id="4442802">px</span><span class="op" id="4442804">.</span><span class="ident" id="4442805">X</span><span class="op" id="4442806">,</span>&nbsp;<span class="keyword" id="4442808">func</span><span class="op" id="4442812">(</span><span class="ident" id="4442813">node</span>&nbsp;<span class="ident" id="4442818">ast</span><span class="op" id="4442821">.</span><span class="ident" id="4442822">Node</span><span class="op" id="4442826">)</span>&nbsp;<span class="builtintype" id="4442828">bool</span>&nbsp;<span class="op" id="4442833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442838">switch</span>&nbsp;<span class="ident" id="4442845">x</span>&nbsp;<span class="op" id="4442847">:=</span>&nbsp;<span class="ident" id="4442850">node</span><span class="op" id="4442854">.</span><span class="op" id="4442855">(</span><span class="keyword" id="4442856">type</span><span class="op" id="4442860">)</span>&nbsp;<span class="op" id="4442862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442867">case</span>&nbsp;<span class="op" id="4442872">*</span><span class="ident" id="4442873">ast</span><span class="op" id="4442876">.</span><span class="ident" id="4442877">ParenExpr</span><span class="op" id="4442886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442892">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442947">return</span>&nbsp;<span class="builtintype" id="4442954">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442963">case</span>&nbsp;<span class="op" id="4442968">*</span><span class="ident" id="4442969">ast</span><span class="op" id="4442972">.</span><span class="ident" id="4442973">CompositeLit</span><span class="op" id="4442985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442991">if</span>&nbsp;<span class="ident" id="4442994">isTypeName</span><span class="op" id="4443004">(</span><span class="ident" id="4443005">x</span><span class="op" id="4443006">.</span><span class="ident" id="4443007">Type</span><span class="op" id="4443011">)</span>&nbsp;<span class="op" id="4443013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443020">strip</span>&nbsp;<span class="op" id="4443026">=</span>&nbsp;<span class="builtintype" id="4443028">false</span>&nbsp;<span class="comment" id="4443034">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443066">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443072">return</span>&nbsp;<span class="builtintype" id="4443079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443093">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443135">return</span>&nbsp;<span class="builtintype" id="4443142">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443149">}</span><span class="op" id="4443150">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443154">if</span>&nbsp;<span class="ident" id="4443157">strip</span>&nbsp;<span class="op" id="4443163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443168">return</span>&nbsp;<span class="ident" id="4443175">stripParens</span><span class="op" id="4443186">(</span><span class="ident" id="4443187">px</span><span class="op" id="4443189">.</span><span class="ident" id="4443190">X</span><span class="op" id="4443191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443201">return</span>&nbsp;<span class="ident" id="4443208">x</span><br>
<span class="lineno">985</span><span class="op" id="4443210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4443213">func</span>&nbsp;<span class="ident" id="4443218">stripParensAlways</span><span class="op" id="4443235">(</span><span class="ident" id="4443236">x</span>&nbsp;<span class="ident" id="4443238">ast</span><span class="op" id="4443241">.</span><span class="ident" id="4443242">Expr</span><span class="op" id="4443246">)</span>&nbsp;<span class="ident" id="4443248">ast</span><span class="op" id="4443251">.</span><span class="ident" id="4443252">Expr</span>&nbsp;<span class="op" id="4443257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443260">if</span>&nbsp;<span class="ident" id="4443263">x</span><span class="op" id="4443264">,</span>&nbsp;<span class="ident" id="4443266">ok</span>&nbsp;<span class="op" id="4443269">:=</span>&nbsp;<span class="ident" id="4443272">x</span><span class="op" id="4443273">.</span><span class="op" id="4443274">(</span><span class="op" id="4443275">*</span><span class="ident" id="4443276">ast</span><span class="op" id="4443279">.</span><span class="ident" id="4443280">ParenExpr</span><span class="op" id="4443289">)</span><span class="op" id="4443290">;</span>&nbsp;<span class="ident" id="4443292">ok</span>&nbsp;<span class="op" id="4443295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443299">return</span>&nbsp;<span class="ident" id="4443306">stripParensAlways</span><span class="op" id="4443323">(</span><span class="ident" id="4443324">x</span><span class="op" id="4443325">.</span><span class="ident" id="4443326">X</span><span class="op" id="4443327">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443333">return</span>&nbsp;<span class="ident" id="4443340">x</span><br>
<span class="lineno"></span><span class="op" id="4443342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4443345">func</span>&nbsp;<span class="op" id="4443350">(</span><span class="ident" id="4443351">p</span>&nbsp;<span class="op" id="4443353">*</span><span class="ident" id="4443354">printer</span><span class="op" id="4443361">)</span>&nbsp;<span class="ident" id="4443363">controlClause</span><span class="op" id="4443376">(</span><span class="ident" id="4443377">isForStmt</span>&nbsp;<span class="builtintype" id="4443387">bool</span><span class="op" id="4443391">,</span>&nbsp;<span class="ident" id="4443393">init</span>&nbsp;<span class="ident" id="4443398">ast</span><span class="op" id="4443401">.</span><span class="ident" id="4443402">Stmt</span><span class="op" id="4443406">,</span>&nbsp;<span class="ident" id="4443408">expr</span>&nbsp;<span class="ident" id="4443413">ast</span><span class="op" id="4443416">.</span><span class="ident" id="4443417">Expr</span><span class="op" id="4443421">,</span>&nbsp;<span class="ident" id="4443423">post</span>&nbsp;<span class="ident" id="4443428">ast</span><span class="op" id="4443431">.</span><span class="ident" id="4443432">Stmt</span><span class="op" id="4443436">)</span>&nbsp;<span class="op" id="4443438">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443441">p</span><span class="op" id="4443442">.</span><span class="builtinfunc" id="4443443">print</span><span class="op" id="4443448">(</span><span class="ident" id="4443449">blank</span><span class="op" id="4443454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443457">needsBlank</span>&nbsp;<span class="op" id="4443468">:=</span>&nbsp;<span class="builtintype" id="4443471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443478">if</span>&nbsp;<span class="ident" id="4443481">init</span>&nbsp;<span class="op" id="4443486">==</span>&nbsp;<span class="ident" id="4443489">nil</span>&nbsp;<span class="op" id="4443493">&amp;&amp;</span>&nbsp;<span class="ident" id="4443496">post</span>&nbsp;<span class="op" id="4443501">==</span>&nbsp;<span class="ident" id="4443504">nil</span>&nbsp;<span class="op" id="4443508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443512">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443540">if</span>&nbsp;<span class="ident" id="4443543">expr</span>&nbsp;<span class="op" id="4443548">!=</span>&nbsp;<span class="ident" id="4443551">nil</span>&nbsp;<span class="op" id="4443555">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443560">p</span><span class="op" id="4443561">.</span><span class="ident" id="4443562">expr</span><span class="op" id="4443566">(</span><span class="ident" id="4443567">stripParens</span><span class="op" id="4443578">(</span><span class="ident" id="4443579">expr</span><span class="op" id="4443583">)</span><span class="op" id="4443584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443589">needsBlank</span>&nbsp;<span class="op" id="4443600">=</span>&nbsp;<span class="builtintype" id="4443602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443612">}</span>&nbsp;<span class="keyword" id="4443614">else</span>&nbsp;<span class="op" id="4443619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443623">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443652">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443706">if</span>&nbsp;<span class="ident" id="4443709">init</span>&nbsp;<span class="op" id="4443714">!=</span>&nbsp;<span class="ident" id="4443717">nil</span>&nbsp;<span class="op" id="4443721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443726">p</span><span class="op" id="4443727">.</span><span class="ident" id="4443728">stmt</span><span class="op" id="4443732">(</span><span class="ident" id="4443733">init</span><span class="op" id="4443737">,</span>&nbsp;<span class="builtintype" id="4443739">false</span><span class="op" id="4443744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443752">p</span><span class="op" id="4443753">.</span><span class="builtinfunc" id="4443754">print</span><span class="op" id="4443759">(</span><span class="ident" id="4443760">token</span><span class="op" id="4443765">.</span><span class="ident" id="4443766">SEMICOLON</span><span class="op" id="4443775">,</span>&nbsp;<span class="ident" id="4443777">blank</span><span class="op" id="4443782">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443786">if</span>&nbsp;<span class="ident" id="4443789">expr</span>&nbsp;<span class="op" id="4443794">!=</span>&nbsp;<span class="ident" id="4443797">nil</span>&nbsp;<span class="op" id="4443801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443806">p</span><span class="op" id="4443807">.</span><span class="ident" id="4443808">expr</span><span class="op" id="4443812">(</span><span class="ident" id="4443813">stripParens</span><span class="op" id="4443824">(</span><span class="ident" id="4443825">expr</span><span class="op" id="4443829">)</span><span class="op" id="4443830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443835">needsBlank</span>&nbsp;<span class="op" id="4443846">=</span>&nbsp;<span class="builtintype" id="4443848">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443859">if</span>&nbsp;<span class="ident" id="4443862">isForStmt</span>&nbsp;<span class="op" id="4443872">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443877">p</span><span class="op" id="4443878">.</span><span class="builtinfunc" id="4443879">print</span><span class="op" id="4443884">(</span><span class="ident" id="4443885">token</span><span class="op" id="4443890">.</span><span class="ident" id="4443891">SEMICOLON</span><span class="op" id="4443900">,</span>&nbsp;<span class="ident" id="4443902">blank</span><span class="op" id="4443907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443912">needsBlank</span>&nbsp;<span class="op" id="4443923">=</span>&nbsp;<span class="builtintype" id="4443925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443934">if</span>&nbsp;<span class="ident" id="4443937">post</span>&nbsp;<span class="op" id="4443942">!=</span>&nbsp;<span class="ident" id="4443945">nil</span>&nbsp;<span class="op" id="4443949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443955">p</span><span class="op" id="4443956">.</span><span class="ident" id="4443957">stmt</span><span class="op" id="4443961">(</span><span class="ident" id="4443962">post</span><span class="op" id="4443966">,</span>&nbsp;<span class="builtintype" id="4443968">false</span><span class="op" id="4443973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443979">needsBlank</span>&nbsp;<span class="op" id="4443990">=</span>&nbsp;<span class="builtintype" id="4443992">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444010">if</span>&nbsp;<span class="ident" id="4444013">needsBlank</span>&nbsp;<span class="op" id="4444024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444028">p</span><span class="op" id="4444029">.</span><span class="builtinfunc" id="4444030">print</span><span class="op" id="4444035">(</span><span class="ident" id="4444036">blank</span><span class="op" id="4444041">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444044">}</span><br>
<span class="lineno"></span><span class="op" id="4444046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4444049">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4444122">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="4444195">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="4444238">//</span><br>
<span class="lineno"></span><span class="keyword" id="4444241">func</span>&nbsp;<span class="op" id="4444246">(</span><span class="ident" id="4444247">p</span>&nbsp;<span class="op" id="4444249">*</span><span class="ident" id="4444250">printer</span><span class="op" id="4444257">)</span>&nbsp;<span class="ident" id="4444259">indentList</span><span class="op" id="4444269">(</span><span class="ident" id="4444270">list</span>&nbsp;<span class="op" id="4444275">[</span><span class="op" id="4444276">]</span><span class="ident" id="4444277">ast</span><span class="op" id="4444280">.</span><span class="ident" id="4444281">Expr</span><span class="op" id="4444285">)</span>&nbsp;<span class="builtintype" id="4444287">bool</span>&nbsp;<span class="op" id="4444292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444295">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444368">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444437">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444493">if</span>&nbsp;<span class="builtinfunc" id="4444496">len</span><span class="op" id="4444499">(</span><span class="ident" id="4444500">list</span><span class="op" id="4444504">)</span>&nbsp;<span class="op" id="4444506">&gt;=</span>&nbsp;<span class="num" id="4444509">2</span>&nbsp;<span class="op" id="4444511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444515">var</span>&nbsp;<span class="ident" id="4444519">b</span>&nbsp;<span class="op" id="4444521">=</span>&nbsp;<span class="ident" id="4444523">p</span><span class="op" id="4444524">.</span><span class="ident" id="4444525">lineFor</span><span class="op" id="4444532">(</span><span class="ident" id="4444533">list</span><span class="op" id="4444537">[</span><span class="num" id="4444538">0</span><span class="op" id="4444539">]</span><span class="op" id="4444540">.</span><span class="ident" id="4444541">Pos</span><span class="op" id="4444544">(</span><span class="op" id="4444545">)</span><span class="op" id="4444546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444550">var</span>&nbsp;<span class="ident" id="4444554">e</span>&nbsp;<span class="op" id="4444556">=</span>&nbsp;<span class="ident" id="4444558">p</span><span class="op" id="4444559">.</span><span class="ident" id="4444560">lineFor</span><span class="op" id="4444567">(</span><span class="ident" id="4444568">list</span><span class="op" id="4444572">[</span><span class="builtinfunc" id="4444573">len</span><span class="op" id="4444576">(</span><span class="ident" id="4444577">list</span><span class="op" id="4444581">)</span><span class="op" id="4444582">-</span><span class="num" id="4444583">1</span><span class="op" id="4444584">]</span><span class="op" id="4444585">.</span><span class="ident" id="4444586">End</span><span class="op" id="4444589">(</span><span class="op" id="4444590">)</span><span class="op" id="4444591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444595">if</span>&nbsp;<span class="num" id="4444598">0</span>&nbsp;<span class="op" id="4444600">&lt;</span>&nbsp;<span class="ident" id="4444602">b</span>&nbsp;<span class="op" id="4444604">&amp;&amp;</span>&nbsp;<span class="ident" id="4444607">b</span>&nbsp;<span class="op" id="4444609">&lt;</span>&nbsp;<span class="ident" id="4444611">e</span>&nbsp;<span class="op" id="4444613">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444618">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444650">n</span>&nbsp;<span class="op" id="4444652">:=</span>&nbsp;<span class="num" id="4444655">0</span>&nbsp;<span class="comment" id="4444657">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444688">line</span>&nbsp;<span class="op" id="4444693">:=</span>&nbsp;<span class="ident" id="4444696">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444701">for</span>&nbsp;<span class="ident" id="4444705">_</span><span class="op" id="4444706">,</span>&nbsp;<span class="ident" id="4444708">x</span>&nbsp;<span class="op" id="4444710">:=</span>&nbsp;<span class="keyword" id="4444713">range</span>&nbsp;<span class="ident" id="4444719">list</span>&nbsp;<span class="op" id="4444724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444730">xb</span>&nbsp;<span class="op" id="4444733">:=</span>&nbsp;<span class="ident" id="4444736">p</span><span class="op" id="4444737">.</span><span class="ident" id="4444738">lineFor</span><span class="op" id="4444745">(</span><span class="ident" id="4444746">x</span><span class="op" id="4444747">.</span><span class="ident" id="4444748">Pos</span><span class="op" id="4444751">(</span><span class="op" id="4444752">)</span><span class="op" id="4444753">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444759">xe</span>&nbsp;<span class="op" id="4444762">:=</span>&nbsp;<span class="ident" id="4444765">p</span><span class="op" id="4444766">.</span><span class="ident" id="4444767">lineFor</span><span class="op" id="4444774">(</span><span class="ident" id="4444775">x</span><span class="op" id="4444776">.</span><span class="ident" id="4444777">End</span><span class="op" id="4444780">(</span><span class="op" id="4444781">)</span><span class="op" id="4444782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444788">if</span>&nbsp;<span class="ident" id="4444791">line</span>&nbsp;<span class="op" id="4444796">&lt;</span>&nbsp;<span class="ident" id="4444798">xb</span>&nbsp;<span class="op" id="4444801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444808">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444846">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444885">return</span>&nbsp;<span class="builtintype" id="4444892">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444907">if</span>&nbsp;<span class="ident" id="4444910">xb</span>&nbsp;<span class="op" id="4444913">&lt;</span>&nbsp;<span class="ident" id="4444915">xe</span>&nbsp;<span class="op" id="4444918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444925">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444959">n</span><span class="op" id="4444960">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444967">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444973">line</span>&nbsp;<span class="op" id="4444978">=</span>&nbsp;<span class="ident" id="4444980">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4444986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444991">return</span>&nbsp;<span class="ident" id="4444998">n</span>&nbsp;<span class="op" id="4445000">&gt;</span>&nbsp;<span class="num" id="4445002">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445009">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445012">return</span>&nbsp;<span class="builtintype" id="4445019">false</span><br>
<span class="lineno"></span><span class="op" id="4445025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4445028">func</span>&nbsp;<span class="op" id="4445033">(</span><span class="ident" id="4445034">p</span>&nbsp;<span class="op" id="4445036">*</span><span class="ident" id="4445037">printer</span><span class="op" id="4445044">)</span>&nbsp;<span class="ident" id="4445046">stmt</span><span class="op" id="4445050">(</span><span class="ident" id="4445051">stmt</span>&nbsp;<span class="ident" id="4445056">ast</span><span class="op" id="4445059">.</span><span class="ident" id="4445060">Stmt</span><span class="op" id="4445064">,</span>&nbsp;<span class="ident" id="4445066">nextIsRBrace</span>&nbsp;<span class="builtintype" id="4445079">bool</span><span class="op" id="4445083">)</span>&nbsp;<span class="op" id="4445085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445088">p</span><span class="op" id="4445089">.</span><span class="builtinfunc" id="4445090">print</span><span class="op" id="4445095">(</span><span class="ident" id="4445096">stmt</span><span class="op" id="4445100">.</span><span class="ident" id="4445101">Pos</span><span class="op" id="4445104">(</span><span class="op" id="4445105">)</span><span class="op" id="4445106">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445110">switch</span>&nbsp;<span class="ident" id="4445117">s</span>&nbsp;<span class="op" id="4445119">:=</span>&nbsp;<span class="ident" id="4445122">stmt</span><span class="op" id="4445126">.</span><span class="op" id="4445127">(</span><span class="keyword" id="4445128">type</span><span class="op" id="4445132">)</span>&nbsp;<span class="op" id="4445134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445137">case</span>&nbsp;<span class="op" id="4445142">*</span><span class="ident" id="4445143">ast</span><span class="op" id="4445146">.</span><span class="ident" id="4445147">BadStmt</span><span class="op" id="4445154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445158">p</span><span class="op" id="4445159">.</span><span class="builtinfunc" id="4445160">print</span><span class="op" id="4445165">(</span><span class="string" id="4445166">&#34;BadStmt&#34;</span><span class="op" id="4445175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445179">case</span>&nbsp;<span class="op" id="4445184">*</span><span class="ident" id="4445185">ast</span><span class="op" id="4445188">.</span><span class="ident" id="4445189">DeclStmt</span><span class="op" id="4445197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445201">p</span><span class="op" id="4445202">.</span><span class="ident" id="4445203">decl</span><span class="op" id="4445207">(</span><span class="ident" id="4445208">s</span><span class="op" id="4445209">.</span><span class="ident" id="4445210">Decl</span><span class="op" id="4445214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445218">case</span>&nbsp;<span class="op" id="4445223">*</span><span class="ident" id="4445224">ast</span><span class="op" id="4445227">.</span><span class="ident" id="4445228">EmptyStmt</span><span class="op" id="4445237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445241">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445260">case</span>&nbsp;<span class="op" id="4445265">*</span><span class="ident" id="4445266">ast</span><span class="op" id="4445269">.</span><span class="ident" id="4445270">LabeledStmt</span><span class="op" id="4445281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445285">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445349">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445410">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445445">p</span><span class="op" id="4445446">.</span><span class="builtinfunc" id="4445447">print</span><span class="op" id="4445452">(</span><span class="ident" id="4445453">unindent</span><span class="op" id="4445461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445465">p</span><span class="op" id="4445466">.</span><span class="ident" id="4445467">expr</span><span class="op" id="4445471">(</span><span class="ident" id="4445472">s</span><span class="op" id="4445473">.</span><span class="ident" id="4445474">Label</span><span class="op" id="4445479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445483">p</span><span class="op" id="4445484">.</span><span class="builtinfunc" id="4445485">print</span><span class="op" id="4445490">(</span><span class="ident" id="4445491">s</span><span class="op" id="4445492">.</span><span class="ident" id="4445493">Colon</span><span class="op" id="4445498">,</span>&nbsp;<span class="ident" id="4445500">token</span><span class="op" id="4445505">.</span><span class="ident" id="4445506">COLON</span><span class="op" id="4445511">,</span>&nbsp;<span class="ident" id="4445513">indent</span><span class="op" id="4445519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445523">if</span>&nbsp;<span class="ident" id="4445526">e</span><span class="op" id="4445527">,</span>&nbsp;<span class="ident" id="4445529">isEmpty</span>&nbsp;<span class="op" id="4445537">:=</span>&nbsp;<span class="ident" id="4445540">s</span><span class="op" id="4445541">.</span><span class="ident" id="4445542">Stmt</span><span class="op" id="4445546">.</span><span class="op" id="4445547">(</span><span class="op" id="4445548">*</span><span class="ident" id="4445549">ast</span><span class="op" id="4445552">.</span><span class="ident" id="4445553">EmptyStmt</span><span class="op" id="4445562">)</span><span class="op" id="4445563">;</span>&nbsp;<span class="ident" id="4445565">isEmpty</span>&nbsp;<span class="op" id="4445573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445578">if</span>&nbsp;<span class="op" id="4445581">!</span><span class="ident" id="4445582">nextIsRBrace</span>&nbsp;<span class="op" id="4445595">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445601">p</span><span class="op" id="4445602">.</span><span class="builtinfunc" id="4445603">print</span><span class="op" id="4445608">(</span><span class="ident" id="4445609">newline</span><span class="op" id="4445616">,</span>&nbsp;<span class="ident" id="4445618">e</span><span class="op" id="4445619">.</span><span class="ident" id="4445620">Pos</span><span class="op" id="4445623">(</span><span class="op" id="4445624">)</span><span class="op" id="4445625">,</span>&nbsp;<span class="ident" id="4445627">token</span><span class="op" id="4445632">.</span><span class="ident" id="4445633">SEMICOLON</span><span class="op" id="4445642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445648">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445661">}</span>&nbsp;<span class="keyword" id="4445663">else</span>&nbsp;<span class="op" id="4445668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445673">p</span><span class="op" id="4445674">.</span><span class="ident" id="4445675">linebreak</span><span class="op" id="4445684">(</span><span class="ident" id="4445685">p</span><span class="op" id="4445686">.</span><span class="ident" id="4445687">lineFor</span><span class="op" id="4445694">(</span><span class="ident" id="4445695">s</span><span class="op" id="4445696">.</span><span class="ident" id="4445697">Stmt</span><span class="op" id="4445701">.</span><span class="ident" id="4445702">Pos</span><span class="op" id="4445705">(</span><span class="op" id="4445706">)</span><span class="op" id="4445707">)</span><span class="op" id="4445708">,</span>&nbsp;<span class="num" id="4445710">1</span><span class="op" id="4445711">,</span>&nbsp;<span class="ident" id="4445713">ignore</span><span class="op" id="4445719">,</span>&nbsp;<span class="builtintype" id="4445721">true</span><span class="op" id="4445725">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4445729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445733">p</span><span class="op" id="4445734">.</span><span class="ident" id="4445735">stmt</span><span class="op" id="4445739">(</span><span class="ident" id="4445740">s</span><span class="op" id="4445741">.</span><span class="ident" id="4445742">Stmt</span><span class="op" id="4445746">,</span>&nbsp;<span class="ident" id="4445748">nextIsRBrace</span><span class="op" id="4445760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445764">case</span>&nbsp;<span class="op" id="4445769">*</span><span class="ident" id="4445770">ast</span><span class="op" id="4445773">.</span><span class="ident" id="4445774">ExprStmt</span><span class="op" id="4445782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445786">const</span>&nbsp;<span class="ident" id="4445792">depth</span>&nbsp;<span class="op" id="4445798">=</span>&nbsp;<span class="num" id="4445800">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445804">p</span><span class="op" id="4445805">.</span><span class="ident" id="4445806">expr0</span><span class="op" id="4445811">(</span><span class="ident" id="4445812">s</span><span class="op" id="4445813">.</span><span class="ident" id="4445814">X</span><span class="op" id="4445815">,</span>&nbsp;<span class="ident" id="4445817">depth</span><span class="op" id="4445822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445826">case</span>&nbsp;<span class="op" id="4445831">*</span><span class="ident" id="4445832">ast</span><span class="op" id="4445835">.</span><span class="ident" id="4445836">SendStmt</span><span class="op" id="4445844">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445848">const</span>&nbsp;<span class="ident" id="4445854">depth</span>&nbsp;<span class="op" id="4445860">=</span>&nbsp;<span class="num" id="4445862">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445866">p</span><span class="op" id="4445867">.</span><span class="ident" id="4445868">expr0</span><span class="op" id="4445873">(</span><span class="ident" id="4445874">s</span><span class="op" id="4445875">.</span><span class="ident" id="4445876">Chan</span><span class="op" id="4445880">,</span>&nbsp;<span class="ident" id="4445882">depth</span><span class="op" id="4445887">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445891">p</span><span class="op" id="4445892">.</span><span class="builtinfunc" id="4445893">print</span><span class="op" id="4445898">(</span><span class="ident" id="4445899">blank</span><span class="op" id="4445904">,</span>&nbsp;<span class="ident" id="4445906">s</span><span class="op" id="4445907">.</span><span class="ident" id="4445908">Arrow</span><span class="op" id="4445913">,</span>&nbsp;<span class="ident" id="4445915">token</span><span class="op" id="4445920">.</span><span class="ident" id="4445921">ARROW</span><span class="op" id="4445926">,</span>&nbsp;<span class="ident" id="4445928">blank</span><span class="op" id="4445933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445937">p</span><span class="op" id="4445938">.</span><span class="ident" id="4445939">expr0</span><span class="op" id="4445944">(</span><span class="ident" id="4445945">s</span><span class="op" id="4445946">.</span><span class="ident" id="4445947">Value</span><span class="op" id="4445952">,</span>&nbsp;<span class="ident" id="4445954">depth</span><span class="op" id="4445959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445963">case</span>&nbsp;<span class="op" id="4445968">*</span><span class="ident" id="4445969">ast</span><span class="op" id="4445972">.</span><span class="ident" id="4445973">IncDecStmt</span><span class="op" id="4445983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4445987">const</span>&nbsp;<span class="ident" id="4445993">depth</span>&nbsp;<span class="op" id="4445999">=</span>&nbsp;<span class="num" id="4446001">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446005">p</span><span class="op" id="4446006">.</span><span class="ident" id="4446007">expr0</span><span class="op" id="4446012">(</span><span class="ident" id="4446013">s</span><span class="op" id="4446014">.</span><span class="ident" id="4446015">X</span><span class="op" id="4446016">,</span>&nbsp;<span class="ident" id="4446018">depth</span><span class="op" id="4446023">+</span><span class="num" id="4446024">1</span><span class="op" id="4446025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446029">p</span><span class="op" id="4446030">.</span><span class="builtinfunc" id="4446031">print</span><span class="op" id="4446036">(</span><span class="ident" id="4446037">s</span><span class="op" id="4446038">.</span><span class="ident" id="4446039">TokPos</span><span class="op" id="4446045">,</span>&nbsp;<span class="ident" id="4446047">s</span><span class="op" id="4446048">.</span><span class="ident" id="4446049">Tok</span><span class="op" id="4446052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446056">case</span>&nbsp;<span class="op" id="4446061">*</span><span class="ident" id="4446062">ast</span><span class="op" id="4446065">.</span><span class="ident" id="4446066">AssignStmt</span><span class="op" id="4446076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446080">var</span>&nbsp;<span class="ident" id="4446084">depth</span>&nbsp;<span class="op" id="4446090">=</span>&nbsp;<span class="num" id="4446092">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446096">if</span>&nbsp;<span class="builtinfunc" id="4446099">len</span><span class="op" id="4446102">(</span><span class="ident" id="4446103">s</span><span class="op" id="4446104">.</span><span class="ident" id="4446105">Lhs</span><span class="op" id="4446108">)</span>&nbsp;<span class="op" id="4446110">&gt;</span>&nbsp;<span class="num" id="4446112">1</span>&nbsp;<span class="op" id="4446114">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4446117">len</span><span class="op" id="4446120">(</span><span class="ident" id="4446121">s</span><span class="op" id="4446122">.</span><span class="ident" id="4446123">Rhs</span><span class="op" id="4446126">)</span>&nbsp;<span class="op" id="4446128">&gt;</span>&nbsp;<span class="num" id="4446130">1</span>&nbsp;<span class="op" id="4446132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446137">depth</span><span class="op" id="4446142">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446151">p</span><span class="op" id="4446152">.</span><span class="ident" id="4446153">exprList</span><span class="op" id="4446161">(</span><span class="ident" id="4446162">s</span><span class="op" id="4446163">.</span><span class="ident" id="4446164">Pos</span><span class="op" id="4446167">(</span><span class="op" id="4446168">)</span><span class="op" id="4446169">,</span>&nbsp;<span class="ident" id="4446171">s</span><span class="op" id="4446172">.</span><span class="ident" id="4446173">Lhs</span><span class="op" id="4446176">,</span>&nbsp;<span class="ident" id="4446178">depth</span><span class="op" id="4446183">,</span>&nbsp;<span class="num" id="4446185">0</span><span class="op" id="4446186">,</span>&nbsp;<span class="ident" id="4446188">s</span><span class="op" id="4446189">.</span><span class="ident" id="4446190">TokPos</span><span class="op" id="4446196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446200">p</span><span class="op" id="4446201">.</span><span class="builtinfunc" id="4446202">print</span><span class="op" id="4446207">(</span><span class="ident" id="4446208">blank</span><span class="op" id="4446213">,</span>&nbsp;<span class="ident" id="4446215">s</span><span class="op" id="4446216">.</span><span class="ident" id="4446217">TokPos</span><span class="op" id="4446223">,</span>&nbsp;<span class="ident" id="4446225">s</span><span class="op" id="4446226">.</span><span class="ident" id="4446227">Tok</span><span class="op" id="4446230">,</span>&nbsp;<span class="ident" id="4446232">blank</span><span class="op" id="4446237">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446241">p</span><span class="op" id="4446242">.</span><span class="ident" id="4446243">exprList</span><span class="op" id="4446251">(</span><span class="ident" id="4446252">s</span><span class="op" id="4446253">.</span><span class="ident" id="4446254">TokPos</span><span class="op" id="4446260">,</span>&nbsp;<span class="ident" id="4446262">s</span><span class="op" id="4446263">.</span><span class="ident" id="4446264">Rhs</span><span class="op" id="4446267">,</span>&nbsp;<span class="ident" id="4446269">depth</span><span class="op" id="4446274">,</span>&nbsp;<span class="num" id="4446276">0</span><span class="op" id="4446277">,</span>&nbsp;<span class="ident" id="4446279">token</span><span class="op" id="4446284">.</span><span class="ident" id="4446285">NoPos</span><span class="op" id="4446290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446294">case</span>&nbsp;<span class="op" id="4446299">*</span><span class="ident" id="4446300">ast</span><span class="op" id="4446303">.</span><span class="ident" id="4446304">GoStmt</span><span class="op" id="4446310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446314">p</span><span class="op" id="4446315">.</span><span class="builtinfunc" id="4446316">print</span><span class="op" id="4446321">(</span><span class="ident" id="4446322">token</span><span class="op" id="4446327">.</span><span class="ident" id="4446328">GO</span><span class="op" id="4446330">,</span>&nbsp;<span class="ident" id="4446332">blank</span><span class="op" id="4446337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446341">p</span><span class="op" id="4446342">.</span><span class="ident" id="4446343">expr</span><span class="op" id="4446347">(</span><span class="ident" id="4446348">s</span><span class="op" id="4446349">.</span><span class="ident" id="4446350">Call</span><span class="op" id="4446354">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446358">case</span>&nbsp;<span class="op" id="4446363">*</span><span class="ident" id="4446364">ast</span><span class="op" id="4446367">.</span><span class="ident" id="4446368">DeferStmt</span><span class="op" id="4446377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446381">p</span><span class="op" id="4446382">.</span><span class="builtinfunc" id="4446383">print</span><span class="op" id="4446388">(</span><span class="ident" id="4446389">token</span><span class="op" id="4446394">.</span><span class="ident" id="4446395">DEFER</span><span class="op" id="4446400">,</span>&nbsp;<span class="ident" id="4446402">blank</span><span class="op" id="4446407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446411">p</span><span class="op" id="4446412">.</span><span class="ident" id="4446413">expr</span><span class="op" id="4446417">(</span><span class="ident" id="4446418">s</span><span class="op" id="4446419">.</span><span class="ident" id="4446420">Call</span><span class="op" id="4446424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446428">case</span>&nbsp;<span class="op" id="4446433">*</span><span class="ident" id="4446434">ast</span><span class="op" id="4446437">.</span><span class="ident" id="4446438">ReturnStmt</span><span class="op" id="4446448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446452">p</span><span class="op" id="4446453">.</span><span class="builtinfunc" id="4446454">print</span><span class="op" id="4446459">(</span><span class="ident" id="4446460">token</span><span class="op" id="4446465">.</span><span class="ident" id="4446466">RETURN</span><span class="op" id="4446472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446476">if</span>&nbsp;<span class="ident" id="4446479">s</span><span class="op" id="4446480">.</span><span class="ident" id="4446481">Results</span>&nbsp;<span class="op" id="4446489">!=</span>&nbsp;<span class="ident" id="4446492">nil</span>&nbsp;<span class="op" id="4446496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446501">p</span><span class="op" id="4446502">.</span><span class="builtinfunc" id="4446503">print</span><span class="op" id="4446508">(</span><span class="ident" id="4446509">blank</span><span class="op" id="4446514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446519">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446576">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446636">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446690">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4446746">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446799">if</span>&nbsp;<span class="ident" id="4446802">p</span><span class="op" id="4446803">.</span><span class="ident" id="4446804">indentList</span><span class="op" id="4446814">(</span><span class="ident" id="4446815">s</span><span class="op" id="4446816">.</span><span class="ident" id="4446817">Results</span><span class="op" id="4446824">)</span>&nbsp;<span class="op" id="4446826">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446832">p</span><span class="op" id="4446833">.</span><span class="builtinfunc" id="4446834">print</span><span class="op" id="4446839">(</span><span class="ident" id="4446840">indent</span><span class="op" id="4446846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446852">p</span><span class="op" id="4446853">.</span><span class="ident" id="4446854">exprList</span><span class="op" id="4446862">(</span><span class="ident" id="4446863">s</span><span class="op" id="4446864">.</span><span class="ident" id="4446865">Pos</span><span class="op" id="4446868">(</span><span class="op" id="4446869">)</span><span class="op" id="4446870">,</span>&nbsp;<span class="ident" id="4446872">s</span><span class="op" id="4446873">.</span><span class="ident" id="4446874">Results</span><span class="op" id="4446881">,</span>&nbsp;<span class="num" id="4446883">1</span><span class="op" id="4446884">,</span>&nbsp;<span class="ident" id="4446886">noIndent</span><span class="op" id="4446894">,</span>&nbsp;<span class="ident" id="4446896">token</span><span class="op" id="4446901">.</span><span class="ident" id="4446902">NoPos</span><span class="op" id="4446907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446913">p</span><span class="op" id="4446914">.</span><span class="builtinfunc" id="4446915">print</span><span class="op" id="4446920">(</span><span class="ident" id="4446921">unindent</span><span class="op" id="4446929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4446934">}</span>&nbsp;<span class="keyword" id="4446936">else</span>&nbsp;<span class="op" id="4446941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446947">p</span><span class="op" id="4446948">.</span><span class="ident" id="4446949">exprList</span><span class="op" id="4446957">(</span><span class="ident" id="4446958">s</span><span class="op" id="4446959">.</span><span class="ident" id="4446960">Pos</span><span class="op" id="4446963">(</span><span class="op" id="4446964">)</span><span class="op" id="4446965">,</span>&nbsp;<span class="ident" id="4446967">s</span><span class="op" id="4446968">.</span><span class="ident" id="4446969">Results</span><span class="op" id="4446976">,</span>&nbsp;<span class="num" id="4446978">1</span><span class="op" id="4446979">,</span>&nbsp;<span class="num" id="4446981">0</span><span class="op" id="4446982">,</span>&nbsp;<span class="ident" id="4446984">token</span><span class="op" id="4446989">.</span><span class="ident" id="4446990">NoPos</span><span class="op" id="4446995">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447008">case</span>&nbsp;<span class="op" id="4447013">*</span><span class="ident" id="4447014">ast</span><span class="op" id="4447017">.</span><span class="ident" id="4447018">BranchStmt</span><span class="op" id="4447028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447032">p</span><span class="op" id="4447033">.</span><span class="builtinfunc" id="4447034">print</span><span class="op" id="4447039">(</span><span class="ident" id="4447040">s</span><span class="op" id="4447041">.</span><span class="ident" id="4447042">Tok</span><span class="op" id="4447045">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447049">if</span>&nbsp;<span class="ident" id="4447052">s</span><span class="op" id="4447053">.</span><span class="ident" id="4447054">Label</span>&nbsp;<span class="op" id="4447060">!=</span>&nbsp;<span class="ident" id="4447063">nil</span>&nbsp;<span class="op" id="4447067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447072">p</span><span class="op" id="4447073">.</span><span class="builtinfunc" id="4447074">print</span><span class="op" id="4447079">(</span><span class="ident" id="4447080">blank</span><span class="op" id="4447085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447090">p</span><span class="op" id="4447091">.</span><span class="ident" id="4447092">expr</span><span class="op" id="4447096">(</span><span class="ident" id="4447097">s</span><span class="op" id="4447098">.</span><span class="ident" id="4447099">Label</span><span class="op" id="4447104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447112">case</span>&nbsp;<span class="op" id="4447117">*</span><span class="ident" id="4447118">ast</span><span class="op" id="4447121">.</span><span class="ident" id="4447122">BlockStmt</span><span class="op" id="4447131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447135">p</span><span class="op" id="4447136">.</span><span class="ident" id="4447137">block</span><span class="op" id="4447142">(</span><span class="ident" id="4447143">s</span><span class="op" id="4447144">,</span>&nbsp;<span class="num" id="4447146">1</span><span class="op" id="4447147">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447151">case</span>&nbsp;<span class="op" id="4447156">*</span><span class="ident" id="4447157">ast</span><span class="op" id="4447160">.</span><span class="ident" id="4447161">IfStmt</span><span class="op" id="4447167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447171">p</span><span class="op" id="4447172">.</span><span class="builtinfunc" id="4447173">print</span><span class="op" id="4447178">(</span><span class="ident" id="4447179">token</span><span class="op" id="4447184">.</span><span class="ident" id="4447185">IF</span><span class="op" id="4447187">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447191">p</span><span class="op" id="4447192">.</span><span class="ident" id="4447193">controlClause</span><span class="op" id="4447206">(</span><span class="builtintype" id="4447207">false</span><span class="op" id="4447212">,</span>&nbsp;<span class="ident" id="4447214">s</span><span class="op" id="4447215">.</span><span class="ident" id="4447216">Init</span><span class="op" id="4447220">,</span>&nbsp;<span class="ident" id="4447222">s</span><span class="op" id="4447223">.</span><span class="ident" id="4447224">Cond</span><span class="op" id="4447228">,</span>&nbsp;<span class="ident" id="4447230">nil</span><span class="op" id="4447233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447237">p</span><span class="op" id="4447238">.</span><span class="ident" id="4447239">block</span><span class="op" id="4447244">(</span><span class="ident" id="4447245">s</span><span class="op" id="4447246">.</span><span class="ident" id="4447247">Body</span><span class="op" id="4447251">,</span>&nbsp;<span class="num" id="4447253">1</span><span class="op" id="4447254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447258">if</span>&nbsp;<span class="ident" id="4447261">s</span><span class="op" id="4447262">.</span><span class="ident" id="4447263">Else</span>&nbsp;<span class="op" id="4447268">!=</span>&nbsp;<span class="ident" id="4447271">nil</span>&nbsp;<span class="op" id="4447275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447280">p</span><span class="op" id="4447281">.</span><span class="builtinfunc" id="4447282">print</span><span class="op" id="4447287">(</span><span class="ident" id="4447288">blank</span><span class="op" id="4447293">,</span>&nbsp;<span class="ident" id="4447295">token</span><span class="op" id="4447300">.</span><span class="ident" id="4447301">ELSE</span><span class="op" id="4447305">,</span>&nbsp;<span class="ident" id="4447307">blank</span><span class="op" id="4447312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447317">switch</span>&nbsp;<span class="ident" id="4447324">s</span><span class="op" id="4447325">.</span><span class="ident" id="4447326">Else</span><span class="op" id="4447330">.</span><span class="op" id="4447331">(</span><span class="keyword" id="4447332">type</span><span class="op" id="4447336">)</span>&nbsp;<span class="op" id="4447338">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447343">case</span>&nbsp;<span class="op" id="4447348">*</span><span class="ident" id="4447349">ast</span><span class="op" id="4447352">.</span><span class="ident" id="4447353">BlockStmt</span><span class="op" id="4447362">,</span>&nbsp;<span class="op" id="4447364">*</span><span class="ident" id="4447365">ast</span><span class="op" id="4447368">.</span><span class="ident" id="4447369">IfStmt</span><span class="op" id="4447375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447381">p</span><span class="op" id="4447382">.</span><span class="ident" id="4447383">stmt</span><span class="op" id="4447387">(</span><span class="ident" id="4447388">s</span><span class="op" id="4447389">.</span><span class="ident" id="4447390">Else</span><span class="op" id="4447394">,</span>&nbsp;<span class="ident" id="4447396">nextIsRBrace</span><span class="op" id="4447408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447413">default</span><span class="op" id="4447420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447426">p</span><span class="op" id="4447427">.</span><span class="builtinfunc" id="4447428">print</span><span class="op" id="4447433">(</span><span class="ident" id="4447434">token</span><span class="op" id="4447439">.</span><span class="ident" id="4447440">LBRACE</span><span class="op" id="4447446">,</span>&nbsp;<span class="ident" id="4447448">indent</span><span class="op" id="4447454">,</span>&nbsp;<span class="ident" id="4447456">formfeed</span><span class="op" id="4447464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447470">p</span><span class="op" id="4447471">.</span><span class="ident" id="4447472">stmt</span><span class="op" id="4447476">(</span><span class="ident" id="4447477">s</span><span class="op" id="4447478">.</span><span class="ident" id="4447479">Else</span><span class="op" id="4447483">,</span>&nbsp;<span class="builtintype" id="4447485">true</span><span class="op" id="4447489">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447495">p</span><span class="op" id="4447496">.</span><span class="builtinfunc" id="4447497">print</span><span class="op" id="4447502">(</span><span class="ident" id="4447503">unindent</span><span class="op" id="4447511">,</span>&nbsp;<span class="ident" id="4447513">formfeed</span><span class="op" id="4447521">,</span>&nbsp;<span class="ident" id="4447523">token</span><span class="op" id="4447528">.</span><span class="ident" id="4447529">RBRACE</span><span class="op" id="4447535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447548">case</span>&nbsp;<span class="op" id="4447553">*</span><span class="ident" id="4447554">ast</span><span class="op" id="4447557">.</span><span class="ident" id="4447558">CaseClause</span><span class="op" id="4447568">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447572">if</span>&nbsp;<span class="ident" id="4447575">s</span><span class="op" id="4447576">.</span><span class="ident" id="4447577">List</span>&nbsp;<span class="op" id="4447582">!=</span>&nbsp;<span class="ident" id="4447585">nil</span>&nbsp;<span class="op" id="4447589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447594">p</span><span class="op" id="4447595">.</span><span class="builtinfunc" id="4447596">print</span><span class="op" id="4447601">(</span><span class="ident" id="4447602">token</span><span class="op" id="4447607">.</span><span class="ident" id="4447608">CASE</span><span class="op" id="4447612">,</span>&nbsp;<span class="ident" id="4447614">blank</span><span class="op" id="4447619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447624">p</span><span class="op" id="4447625">.</span><span class="ident" id="4447626">exprList</span><span class="op" id="4447634">(</span><span class="ident" id="4447635">s</span><span class="op" id="4447636">.</span><span class="ident" id="4447637">Pos</span><span class="op" id="4447640">(</span><span class="op" id="4447641">)</span><span class="op" id="4447642">,</span>&nbsp;<span class="ident" id="4447644">s</span><span class="op" id="4447645">.</span><span class="ident" id="4447646">List</span><span class="op" id="4447650">,</span>&nbsp;<span class="num" id="4447652">1</span><span class="op" id="4447653">,</span>&nbsp;<span class="num" id="4447655">0</span><span class="op" id="4447656">,</span>&nbsp;<span class="ident" id="4447658">s</span><span class="op" id="4447659">.</span><span class="ident" id="4447660">Colon</span><span class="op" id="4447665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447669">}</span>&nbsp;<span class="keyword" id="4447671">else</span>&nbsp;<span class="op" id="4447676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447681">p</span><span class="op" id="4447682">.</span><span class="builtinfunc" id="4447683">print</span><span class="op" id="4447688">(</span><span class="ident" id="4447689">token</span><span class="op" id="4447694">.</span><span class="ident" id="4447695">DEFAULT</span><span class="op" id="4447702">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4447706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447710">p</span><span class="op" id="4447711">.</span><span class="builtinfunc" id="4447712">print</span><span class="op" id="4447717">(</span><span class="ident" id="4447718">s</span><span class="op" id="4447719">.</span><span class="ident" id="4447720">Colon</span><span class="op" id="4447725">,</span>&nbsp;<span class="ident" id="4447727">token</span><span class="op" id="4447732">.</span><span class="ident" id="4447733">COLON</span><span class="op" id="4447738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447742">p</span><span class="op" id="4447743">.</span><span class="ident" id="4447744">stmtList</span><span class="op" id="4447752">(</span><span class="ident" id="4447753">s</span><span class="op" id="4447754">.</span><span class="ident" id="4447755">Body</span><span class="op" id="4447759">,</span>&nbsp;<span class="num" id="4447761">1</span><span class="op" id="4447762">,</span>&nbsp;<span class="ident" id="4447764">nextIsRBrace</span><span class="op" id="4447776">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447780">case</span>&nbsp;<span class="op" id="4447785">*</span><span class="ident" id="4447786">ast</span><span class="op" id="4447789">.</span><span class="ident" id="4447790">SwitchStmt</span><span class="op" id="4447800">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447804">p</span><span class="op" id="4447805">.</span><span class="builtinfunc" id="4447806">print</span><span class="op" id="4447811">(</span><span class="ident" id="4447812">token</span><span class="op" id="4447817">.</span><span class="ident" id="4447818">SWITCH</span><span class="op" id="4447824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447828">p</span><span class="op" id="4447829">.</span><span class="ident" id="4447830">controlClause</span><span class="op" id="4447843">(</span><span class="builtintype" id="4447844">false</span><span class="op" id="4447849">,</span>&nbsp;<span class="ident" id="4447851">s</span><span class="op" id="4447852">.</span><span class="ident" id="4447853">Init</span><span class="op" id="4447857">,</span>&nbsp;<span class="ident" id="4447859">s</span><span class="op" id="4447860">.</span><span class="ident" id="4447861">Tag</span><span class="op" id="4447864">,</span>&nbsp;<span class="ident" id="4447866">nil</span><span class="op" id="4447869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447873">p</span><span class="op" id="4447874">.</span><span class="ident" id="4447875">block</span><span class="op" id="4447880">(</span><span class="ident" id="4447881">s</span><span class="op" id="4447882">.</span><span class="ident" id="4447883">Body</span><span class="op" id="4447887">,</span>&nbsp;<span class="num" id="4447889">0</span><span class="op" id="4447890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447894">case</span>&nbsp;<span class="op" id="4447899">*</span><span class="ident" id="4447900">ast</span><span class="op" id="4447903">.</span><span class="ident" id="4447904">TypeSwitchStmt</span><span class="op" id="4447918">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447922">p</span><span class="op" id="4447923">.</span><span class="builtinfunc" id="4447924">print</span><span class="op" id="4447929">(</span><span class="ident" id="4447930">token</span><span class="op" id="4447935">.</span><span class="ident" id="4447936">SWITCH</span><span class="op" id="4447942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4447946">if</span>&nbsp;<span class="ident" id="4447949">s</span><span class="op" id="4447950">.</span><span class="ident" id="4447951">Init</span>&nbsp;<span class="op" id="4447956">!=</span>&nbsp;<span class="ident" id="4447959">nil</span>&nbsp;<span class="op" id="4447963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447968">p</span><span class="op" id="4447969">.</span><span class="builtinfunc" id="4447970">print</span><span class="op" id="4447975">(</span><span class="ident" id="4447976">blank</span><span class="op" id="4447981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4447986">p</span><span class="op" id="4447987">.</span><span class="ident" id="4447988">stmt</span><span class="op" id="4447992">(</span><span class="ident" id="4447993">s</span><span class="op" id="4447994">.</span><span class="ident" id="4447995">Init</span><span class="op" id="4447999">,</span>&nbsp;<span class="builtintype" id="4448001">false</span><span class="op" id="4448006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448011">p</span><span class="op" id="4448012">.</span><span class="builtinfunc" id="4448013">print</span><span class="op" id="4448018">(</span><span class="ident" id="4448019">token</span><span class="op" id="4448024">.</span><span class="ident" id="4448025">SEMICOLON</span><span class="op" id="4448034">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448042">p</span><span class="op" id="4448043">.</span><span class="builtinfunc" id="4448044">print</span><span class="op" id="4448049">(</span><span class="ident" id="4448050">blank</span><span class="op" id="4448055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448059">p</span><span class="op" id="4448060">.</span><span class="ident" id="4448061">stmt</span><span class="op" id="4448065">(</span><span class="ident" id="4448066">s</span><span class="op" id="4448067">.</span><span class="ident" id="4448068">Assign</span><span class="op" id="4448074">,</span>&nbsp;<span class="builtintype" id="4448076">false</span><span class="op" id="4448081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448085">p</span><span class="op" id="4448086">.</span><span class="builtinfunc" id="4448087">print</span><span class="op" id="4448092">(</span><span class="ident" id="4448093">blank</span><span class="op" id="4448098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448102">p</span><span class="op" id="4448103">.</span><span class="ident" id="4448104">block</span><span class="op" id="4448109">(</span><span class="ident" id="4448110">s</span><span class="op" id="4448111">.</span><span class="ident" id="4448112">Body</span><span class="op" id="4448116">,</span>&nbsp;<span class="num" id="4448118">0</span><span class="op" id="4448119">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448123">case</span>&nbsp;<span class="op" id="4448128">*</span><span class="ident" id="4448129">ast</span><span class="op" id="4448132">.</span><span class="ident" id="4448133">CommClause</span><span class="op" id="4448143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448147">if</span>&nbsp;<span class="ident" id="4448150">s</span><span class="op" id="4448151">.</span><span class="ident" id="4448152">Comm</span>&nbsp;<span class="op" id="4448157">!=</span>&nbsp;<span class="ident" id="4448160">nil</span>&nbsp;<span class="op" id="4448164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448169">p</span><span class="op" id="4448170">.</span><span class="builtinfunc" id="4448171">print</span><span class="op" id="4448176">(</span><span class="ident" id="4448177">token</span><span class="op" id="4448182">.</span><span class="ident" id="4448183">CASE</span><span class="op" id="4448187">,</span>&nbsp;<span class="ident" id="4448189">blank</span><span class="op" id="4448194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448199">p</span><span class="op" id="4448200">.</span><span class="ident" id="4448201">stmt</span><span class="op" id="4448205">(</span><span class="ident" id="4448206">s</span><span class="op" id="4448207">.</span><span class="ident" id="4448208">Comm</span><span class="op" id="4448212">,</span>&nbsp;<span class="builtintype" id="4448214">false</span><span class="op" id="4448219">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448223">}</span>&nbsp;<span class="keyword" id="4448225">else</span>&nbsp;<span class="op" id="4448230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448235">p</span><span class="op" id="4448236">.</span><span class="builtinfunc" id="4448237">print</span><span class="op" id="4448242">(</span><span class="ident" id="4448243">token</span><span class="op" id="4448248">.</span><span class="ident" id="4448249">DEFAULT</span><span class="op" id="4448256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448264">p</span><span class="op" id="4448265">.</span><span class="builtinfunc" id="4448266">print</span><span class="op" id="4448271">(</span><span class="ident" id="4448272">s</span><span class="op" id="4448273">.</span><span class="ident" id="4448274">Colon</span><span class="op" id="4448279">,</span>&nbsp;<span class="ident" id="4448281">token</span><span class="op" id="4448286">.</span><span class="ident" id="4448287">COLON</span><span class="op" id="4448292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448296">p</span><span class="op" id="4448297">.</span><span class="ident" id="4448298">stmtList</span><span class="op" id="4448306">(</span><span class="ident" id="4448307">s</span><span class="op" id="4448308">.</span><span class="ident" id="4448309">Body</span><span class="op" id="4448313">,</span>&nbsp;<span class="num" id="4448315">1</span><span class="op" id="4448316">,</span>&nbsp;<span class="ident" id="4448318">nextIsRBrace</span><span class="op" id="4448330">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448334">case</span>&nbsp;<span class="op" id="4448339">*</span><span class="ident" id="4448340">ast</span><span class="op" id="4448343">.</span><span class="ident" id="4448344">SelectStmt</span><span class="op" id="4448354">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448358">p</span><span class="op" id="4448359">.</span><span class="builtinfunc" id="4448360">print</span><span class="op" id="4448365">(</span><span class="ident" id="4448366">token</span><span class="op" id="4448371">.</span><span class="ident" id="4448372">SELECT</span><span class="op" id="4448378">,</span>&nbsp;<span class="ident" id="4448380">blank</span><span class="op" id="4448385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448389">body</span>&nbsp;<span class="op" id="4448394">:=</span>&nbsp;<span class="ident" id="4448397">s</span><span class="op" id="4448398">.</span><span class="ident" id="4448399">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448406">if</span>&nbsp;<span class="builtinfunc" id="4448409">len</span><span class="op" id="4448412">(</span><span class="ident" id="4448413">body</span><span class="op" id="4448417">.</span><span class="ident" id="4448418">List</span><span class="op" id="4448422">)</span>&nbsp;<span class="op" id="4448424">==</span>&nbsp;<span class="num" id="4448427">0</span>&nbsp;<span class="op" id="4448429">&amp;&amp;</span>&nbsp;<span class="op" id="4448432">!</span><span class="ident" id="4448433">p</span><span class="op" id="4448434">.</span><span class="ident" id="4448435">commentBefore</span><span class="op" id="4448448">(</span><span class="ident" id="4448449">p</span><span class="op" id="4448450">.</span><span class="ident" id="4448451">posFor</span><span class="op" id="4448457">(</span><span class="ident" id="4448458">body</span><span class="op" id="4448462">.</span><span class="ident" id="4448463">Rbrace</span><span class="op" id="4448469">)</span><span class="op" id="4448470">)</span>&nbsp;<span class="op" id="4448472">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4448477">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448537">p</span><span class="op" id="4448538">.</span><span class="builtinfunc" id="4448539">print</span><span class="op" id="4448544">(</span><span class="ident" id="4448545">body</span><span class="op" id="4448549">.</span><span class="ident" id="4448550">Lbrace</span><span class="op" id="4448556">,</span>&nbsp;<span class="ident" id="4448558">token</span><span class="op" id="4448563">.</span><span class="ident" id="4448564">LBRACE</span><span class="op" id="4448570">,</span>&nbsp;<span class="ident" id="4448572">body</span><span class="op" id="4448576">.</span><span class="ident" id="4448577">Rbrace</span><span class="op" id="4448583">,</span>&nbsp;<span class="ident" id="4448585">token</span><span class="op" id="4448590">.</span><span class="ident" id="4448591">RBRACE</span><span class="op" id="4448597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448601">}</span>&nbsp;<span class="keyword" id="4448603">else</span>&nbsp;<span class="op" id="4448608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448613">p</span><span class="op" id="4448614">.</span><span class="ident" id="4448615">block</span><span class="op" id="4448620">(</span><span class="ident" id="4448621">body</span><span class="op" id="4448625">,</span>&nbsp;<span class="num" id="4448627">0</span><span class="op" id="4448628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4448632">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448636">case</span>&nbsp;<span class="op" id="4448641">*</span><span class="ident" id="4448642">ast</span><span class="op" id="4448645">.</span><span class="ident" id="4448646">ForStmt</span><span class="op" id="4448653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448657">p</span><span class="op" id="4448658">.</span><span class="builtinfunc" id="4448659">print</span><span class="op" id="4448664">(</span><span class="ident" id="4448665">token</span><span class="op" id="4448670">.</span><span class="ident" id="4448671">FOR</span><span class="op" id="4448674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448678">p</span><span class="op" id="4448679">.</span><span class="ident" id="4448680">controlClause</span><span class="op" id="4448693">(</span><span class="builtintype" id="4448694">true</span><span class="op" id="4448698">,</span>&nbsp;<span class="ident" id="4448700">s</span><span class="op" id="4448701">.</span><span class="ident" id="4448702">Init</span><span class="op" id="4448706">,</span>&nbsp;<span class="ident" id="4448708">s</span><span class="op" id="4448709">.</span><span class="ident" id="4448710">Cond</span><span class="op" id="4448714">,</span>&nbsp;<span class="ident" id="4448716">s</span><span class="op" id="4448717">.</span><span class="ident" id="4448718">Post</span><span class="op" id="4448722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448726">p</span><span class="op" id="4448727">.</span><span class="ident" id="4448728">block</span><span class="op" id="4448733">(</span><span class="ident" id="4448734">s</span><span class="op" id="4448735">.</span><span class="ident" id="4448736">Body</span><span class="op" id="4448740">,</span>&nbsp;<span class="num" id="4448742">1</span><span class="op" id="4448743">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448747">case</span>&nbsp;<span class="op" id="4448752">*</span><span class="ident" id="4448753">ast</span><span class="op" id="4448756">.</span><span class="ident" id="4448757">RangeStmt</span><span class="op" id="4448766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448770">p</span><span class="op" id="4448771">.</span><span class="builtinfunc" id="4448772">print</span><span class="op" id="4448777">(</span><span class="ident" id="4448778">token</span><span class="op" id="4448783">.</span><span class="ident" id="4448784">FOR</span><span class="op" id="4448787">,</span>&nbsp;<span class="ident" id="4448789">blank</span><span class="op" id="4448794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448798">if</span>&nbsp;<span class="ident" id="4448801">s</span><span class="op" id="4448802">.</span><span class="ident" id="4448803">Key</span>&nbsp;<span class="op" id="4448807">!=</span>&nbsp;<span class="ident" id="4448810">nil</span>&nbsp;<span class="op" id="4448814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448819">p</span><span class="op" id="4448820">.</span><span class="ident" id="4448821">expr</span><span class="op" id="4448825">(</span><span class="ident" id="4448826">s</span><span class="op" id="4448827">.</span><span class="ident" id="4448828">Key</span><span class="op" id="4448831">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4448836">if</span>&nbsp;<span class="ident" id="4448839">s</span><span class="op" id="4448840">.</span><span class="ident" id="4448841">Value</span>&nbsp;<span class="op" id="4448847">!=</span>&nbsp;<span class="ident" id="4448850">nil</span>&nbsp;<span class="op" id="4448854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4448860">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4448912">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4448964">p</span><span class="op" id="4448965">.</span><span class="builtinfunc" id="4448966">print</span><span class="op" id="4448971">(</span><span class="ident" id="4448972">s</span><span class="op" id="4448973">.</span><span class="ident" id="4448974">Value</span><span class="op" id="4448979">.</span><span class="ident" id="4448980">Pos</span><span class="op" id="4448983">(</span><span class="op" id="4448984">)</span><span class="op" id="4448985">,</span>&nbsp;<span class="ident" id="4448987">token</span><span class="op" id="4448992">.</span><span class="ident" id="4448993">COMMA</span><span class="op" id="4448998">,</span>&nbsp;<span class="ident" id="4449000">blank</span><span class="op" id="4449005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449011">p</span><span class="op" id="4449012">.</span><span class="ident" id="4449013">expr</span><span class="op" id="4449017">(</span><span class="ident" id="4449018">s</span><span class="op" id="4449019">.</span><span class="ident" id="4449020">Value</span><span class="op" id="4449025">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449035">p</span><span class="op" id="4449036">.</span><span class="builtinfunc" id="4449037">print</span><span class="op" id="4449042">(</span><span class="ident" id="4449043">blank</span><span class="op" id="4449048">,</span>&nbsp;<span class="ident" id="4449050">s</span><span class="op" id="4449051">.</span><span class="ident" id="4449052">TokPos</span><span class="op" id="4449058">,</span>&nbsp;<span class="ident" id="4449060">s</span><span class="op" id="4449061">.</span><span class="ident" id="4449062">Tok</span><span class="op" id="4449065">,</span>&nbsp;<span class="ident" id="4449067">blank</span><span class="op" id="4449072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449080">p</span><span class="op" id="4449081">.</span><span class="builtinfunc" id="4449082">print</span><span class="op" id="4449087">(</span><span class="ident" id="4449088">token</span><span class="op" id="4449093">.</span><span class="ident" id="4449094">RANGE</span><span class="op" id="4449099">,</span>&nbsp;<span class="ident" id="4449101">blank</span><span class="op" id="4449106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449110">p</span><span class="op" id="4449111">.</span><span class="ident" id="4449112">expr</span><span class="op" id="4449116">(</span><span class="ident" id="4449117">stripParens</span><span class="op" id="4449128">(</span><span class="ident" id="4449129">s</span><span class="op" id="4449130">.</span><span class="ident" id="4449131">X</span><span class="op" id="4449132">)</span><span class="op" id="4449133">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449137">p</span><span class="op" id="4449138">.</span><span class="builtinfunc" id="4449139">print</span><span class="op" id="4449144">(</span><span class="ident" id="4449145">blank</span><span class="op" id="4449150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4449154">p</span><span class="op" id="4449155">.</span><span class="ident" id="4449156">block</span><span class="op" id="4449161">(</span><span class="ident" id="4449162">s</span><span class="op" id="4449163">.</span><span class="ident" id="4449164">Body</span><span class="op" id="4449168">,</span>&nbsp;<span class="num" id="4449170">1</span><span class="op" id="4449171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449175">default</span><span class="op" id="4449182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4449186">panic</span><span class="op" id="4449191">(</span><span class="string" id="4449192">&#34;unreachable&#34;</span><span class="op" id="4449205">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4449208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4449212">return</span><br>
<span class="lineno"></span><span class="op" id="4449219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="4449222">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4449302">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4449319">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4449395">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="4449471">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="4449546">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="4449621">//</span><br>
<span class="lineno"></span><span class="comment" id="4449624">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="4449657">//</span><br>
<span class="lineno">1255</span><span class="comment" id="4449660">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="4449671">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="4449702">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="4449733">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="4449741">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="4449767">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="4449772">//</span><br>
<span class="lineno"></span><span class="comment" id="4449775">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4449848">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4449923">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="4450000">//</span><br>
<span class="lineno"></span><span class="comment" id="4450003">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="4450041">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="4450070">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4450140">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="4450201">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="4450238">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="4450304">//</span><br>
<span class="lineno"></span><span class="keyword" id="4450307">func</span>&nbsp;<span class="ident" id="4450312">keepTypeColumn</span><span class="op" id="4450326">(</span><span class="ident" id="4450327">specs</span>&nbsp;<span class="op" id="4450333">[</span><span class="op" id="4450334">]</span><span class="ident" id="4450335">ast</span><span class="op" id="4450338">.</span><span class="ident" id="4450339">Spec</span><span class="op" id="4450343">)</span>&nbsp;<span class="op" id="4450345">[</span><span class="op" id="4450346">]</span><span class="builtintype" id="4450347">bool</span>&nbsp;<span class="op" id="4450352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450355">m</span>&nbsp;<span class="op" id="4450357">:=</span>&nbsp;<span class="builtinfunc" id="4450360">make</span><span class="op" id="4450364">(</span><span class="op" id="4450365">[</span><span class="op" id="4450366">]</span><span class="builtintype" id="4450367">bool</span><span class="op" id="4450371">,</span>&nbsp;<span class="builtinfunc" id="4450373">len</span><span class="op" id="4450376">(</span><span class="ident" id="4450377">specs</span><span class="op" id="4450382">)</span><span class="op" id="4450383">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450387">populate</span>&nbsp;<span class="op" id="4450396">:=</span>&nbsp;<span class="keyword" id="4450399">func</span><span class="op" id="4450403">(</span><span class="ident" id="4450404">i</span><span class="op" id="4450405">,</span>&nbsp;<span class="ident" id="4450407">j</span>&nbsp;<span class="builtintype" id="4450409">int</span><span class="op" id="4450412">,</span>&nbsp;<span class="ident" id="4450414">keepType</span>&nbsp;<span class="builtintype" id="4450423">bool</span><span class="op" id="4450427">)</span>&nbsp;<span class="op" id="4450429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450433">if</span>&nbsp;<span class="ident" id="4450436">keepType</span>&nbsp;<span class="op" id="4450445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450450">for</span>&nbsp;<span class="op" id="4450454">;</span>&nbsp;<span class="ident" id="4450456">i</span>&nbsp;<span class="op" id="4450458">&lt;</span>&nbsp;<span class="ident" id="4450460">j</span><span class="op" id="4450461">;</span>&nbsp;<span class="ident" id="4450463">i</span><span class="op" id="4450464">++</span>&nbsp;<span class="op" id="4450467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450473">m</span><span class="op" id="4450474">[</span><span class="ident" id="4450475">i</span><span class="op" id="4450476">]</span>&nbsp;<span class="op" id="4450478">=</span>&nbsp;<span class="builtintype" id="4450480">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450499">i0</span>&nbsp;<span class="op" id="4450502">:=</span>&nbsp;<span class="op" id="4450505">-</span><span class="num" id="4450506">1</span>&nbsp;<span class="comment" id="4450508">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450570">var</span>&nbsp;<span class="ident" id="4450574">keepType</span>&nbsp;<span class="builtintype" id="4450583">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450589">for</span>&nbsp;<span class="ident" id="4450593">i</span><span class="op" id="4450594">,</span>&nbsp;<span class="ident" id="4450596">s</span>&nbsp;<span class="op" id="4450598">:=</span>&nbsp;<span class="keyword" id="4450601">range</span>&nbsp;<span class="ident" id="4450607">specs</span>&nbsp;<span class="op" id="4450613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450617">t</span>&nbsp;<span class="op" id="4450619">:=</span>&nbsp;<span class="ident" id="4450622">s</span><span class="op" id="4450623">.</span><span class="op" id="4450624">(</span><span class="op" id="4450625">*</span><span class="ident" id="4450626">ast</span><span class="op" id="4450629">.</span><span class="ident" id="4450630">ValueSpec</span><span class="op" id="4450639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450643">if</span>&nbsp;<span class="ident" id="4450646">t</span><span class="op" id="4450647">.</span><span class="ident" id="4450648">Values</span>&nbsp;<span class="op" id="4450655">!=</span>&nbsp;<span class="ident" id="4450658">nil</span>&nbsp;<span class="op" id="4450662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450667">if</span>&nbsp;<span class="ident" id="4450670">i0</span>&nbsp;<span class="op" id="4450673">&lt;</span>&nbsp;<span class="num" id="4450675">0</span>&nbsp;<span class="op" id="4450677">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450683">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450739">i0</span>&nbsp;<span class="op" id="4450742">=</span>&nbsp;<span class="ident" id="4450744">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450750">keepType</span>&nbsp;<span class="op" id="4450759">=</span>&nbsp;<span class="builtintype" id="4450761">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450774">}</span>&nbsp;<span class="keyword" id="4450776">else</span>&nbsp;<span class="op" id="4450781">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450786">if</span>&nbsp;<span class="ident" id="4450789">i0</span>&nbsp;<span class="op" id="4450792">&gt;=</span>&nbsp;<span class="num" id="4450795">0</span>&nbsp;<span class="op" id="4450797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450803">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450823">populate</span><span class="op" id="4450831">(</span><span class="ident" id="4450832">i0</span><span class="op" id="4450834">,</span>&nbsp;<span class="ident" id="4450836">i</span><span class="op" id="4450837">,</span>&nbsp;<span class="ident" id="4450839">keepType</span><span class="op" id="4450847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450853">i0</span>&nbsp;<span class="op" id="4450856">=</span>&nbsp;<span class="op" id="4450858">-</span><span class="num" id="4450859">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450864">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450872">if</span>&nbsp;<span class="ident" id="4450875">t</span><span class="op" id="4450876">.</span><span class="ident" id="4450877">Type</span>&nbsp;<span class="op" id="4450882">!=</span>&nbsp;<span class="ident" id="4450885">nil</span>&nbsp;<span class="op" id="4450889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450894">keepType</span>&nbsp;<span class="op" id="4450903">=</span>&nbsp;<span class="builtintype" id="4450905">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450915">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450918">if</span>&nbsp;<span class="ident" id="4450921">i0</span>&nbsp;<span class="op" id="4450924">&gt;=</span>&nbsp;<span class="num" id="4450927">0</span>&nbsp;<span class="op" id="4450929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4450933">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4450951">populate</span><span class="op" id="4450959">(</span><span class="ident" id="4450960">i0</span><span class="op" id="4450962">,</span>&nbsp;<span class="builtinfunc" id="4450964">len</span><span class="op" id="4450967">(</span><span class="ident" id="4450968">specs</span><span class="op" id="4450973">)</span><span class="op" id="4450974">,</span>&nbsp;<span class="ident" id="4450976">keepType</span><span class="op" id="4450984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4450987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4450991">return</span>&nbsp;<span class="ident" id="4450998">m</span><br>
<span class="lineno"></span><span class="op" id="4451000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4451003">func</span>&nbsp;<span class="op" id="4451008">(</span><span class="ident" id="4451009">p</span>&nbsp;<span class="op" id="4451011">*</span><span class="ident" id="4451012">printer</span><span class="op" id="4451019">)</span>&nbsp;<span class="ident" id="4451021">valueSpec</span><span class="op" id="4451030">(</span><span class="ident" id="4451031">s</span>&nbsp;<span class="op" id="4451033">*</span><span class="ident" id="4451034">ast</span><span class="op" id="4451037">.</span><span class="ident" id="4451038">ValueSpec</span><span class="op" id="4451047">,</span>&nbsp;<span class="ident" id="4451049">keepType</span>&nbsp;<span class="builtintype" id="4451058">bool</span><span class="op" id="4451062">)</span>&nbsp;<span class="op" id="4451064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451067">p</span><span class="op" id="4451068">.</span><span class="ident" id="4451069">setComment</span><span class="op" id="4451079">(</span><span class="ident" id="4451080">s</span><span class="op" id="4451081">.</span><span class="ident" id="4451082">Doc</span><span class="op" id="4451085">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451088">p</span><span class="op" id="4451089">.</span><span class="ident" id="4451090">identList</span><span class="op" id="4451099">(</span><span class="ident" id="4451100">s</span><span class="op" id="4451101">.</span><span class="ident" id="4451102">Names</span><span class="op" id="4451107">,</span>&nbsp;<span class="builtintype" id="4451109">false</span><span class="op" id="4451114">)</span>&nbsp;<span class="comment" id="4451116">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451135">extraTabs</span>&nbsp;<span class="op" id="4451145">:=</span>&nbsp;<span class="num" id="4451148">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451151">if</span>&nbsp;<span class="ident" id="4451154">s</span><span class="op" id="4451155">.</span><span class="ident" id="4451156">Type</span>&nbsp;<span class="op" id="4451161">!=</span>&nbsp;<span class="ident" id="4451164">nil</span>&nbsp;<span class="op" id="4451168">||</span>&nbsp;<span class="ident" id="4451171">keepType</span>&nbsp;<span class="op" id="4451180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451184">p</span><span class="op" id="4451185">.</span><span class="builtinfunc" id="4451186">print</span><span class="op" id="4451191">(</span><span class="ident" id="4451192">vtab</span><span class="op" id="4451196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451200">extraTabs</span><span class="op" id="4451209">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451216">if</span>&nbsp;<span class="ident" id="4451219">s</span><span class="op" id="4451220">.</span><span class="ident" id="4451221">Type</span>&nbsp;<span class="op" id="4451226">!=</span>&nbsp;<span class="ident" id="4451229">nil</span>&nbsp;<span class="op" id="4451233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451237">p</span><span class="op" id="4451238">.</span><span class="ident" id="4451239">expr</span><span class="op" id="4451243">(</span><span class="ident" id="4451244">s</span><span class="op" id="4451245">.</span><span class="ident" id="4451246">Type</span><span class="op" id="4451250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451256">if</span>&nbsp;<span class="ident" id="4451259">s</span><span class="op" id="4451260">.</span><span class="ident" id="4451261">Values</span>&nbsp;<span class="op" id="4451268">!=</span>&nbsp;<span class="ident" id="4451271">nil</span>&nbsp;<span class="op" id="4451275">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451279">p</span><span class="op" id="4451280">.</span><span class="builtinfunc" id="4451281">print</span><span class="op" id="4451286">(</span><span class="ident" id="4451287">vtab</span><span class="op" id="4451291">,</span>&nbsp;<span class="ident" id="4451293">token</span><span class="op" id="4451298">.</span><span class="ident" id="4451299">ASSIGN</span><span class="op" id="4451305">,</span>&nbsp;<span class="ident" id="4451307">blank</span><span class="op" id="4451312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451316">p</span><span class="op" id="4451317">.</span><span class="ident" id="4451318">exprList</span><span class="op" id="4451326">(</span><span class="ident" id="4451327">token</span><span class="op" id="4451332">.</span><span class="ident" id="4451333">NoPos</span><span class="op" id="4451338">,</span>&nbsp;<span class="ident" id="4451340">s</span><span class="op" id="4451341">.</span><span class="ident" id="4451342">Values</span><span class="op" id="4451348">,</span>&nbsp;<span class="num" id="4451350">1</span><span class="op" id="4451351">,</span>&nbsp;<span class="num" id="4451353">0</span><span class="op" id="4451354">,</span>&nbsp;<span class="ident" id="4451356">token</span><span class="op" id="4451361">.</span><span class="ident" id="4451362">NoPos</span><span class="op" id="4451367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451371">extraTabs</span><span class="op" id="4451380">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451387">if</span>&nbsp;<span class="ident" id="4451390">s</span><span class="op" id="4451391">.</span><span class="ident" id="4451392">Comment</span>&nbsp;<span class="op" id="4451400">!=</span>&nbsp;<span class="ident" id="4451403">nil</span>&nbsp;<span class="op" id="4451407">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451411">for</span>&nbsp;<span class="op" id="4451415">;</span>&nbsp;<span class="ident" id="4451417">extraTabs</span>&nbsp;<span class="op" id="4451427">&gt;</span>&nbsp;<span class="num" id="4451429">0</span><span class="op" id="4451430">;</span>&nbsp;<span class="ident" id="4451432">extraTabs</span><span class="op" id="4451441">--</span>&nbsp;<span class="op" id="4451444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451449">p</span><span class="op" id="4451450">.</span><span class="builtinfunc" id="4451451">print</span><span class="op" id="4451456">(</span><span class="ident" id="4451457">vtab</span><span class="op" id="4451461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451469">p</span><span class="op" id="4451470">.</span><span class="ident" id="4451471">setComment</span><span class="op" id="4451481">(</span><span class="ident" id="4451482">s</span><span class="op" id="4451483">.</span><span class="ident" id="4451484">Comment</span><span class="op" id="4451491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451494">}</span><br>
<span class="lineno">1335</span><span class="op" id="4451496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4451499">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="4451575">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="4451646">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="4451675">//</span><br>
<span class="lineno"></span><span class="keyword" id="4451678">func</span>&nbsp;<span class="op" id="4451683">(</span><span class="ident" id="4451684">p</span>&nbsp;<span class="op" id="4451686">*</span><span class="ident" id="4451687">printer</span><span class="op" id="4451694">)</span>&nbsp;<span class="ident" id="4451696">spec</span><span class="op" id="4451700">(</span><span class="ident" id="4451701">spec</span>&nbsp;<span class="ident" id="4451706">ast</span><span class="op" id="4451709">.</span><span class="ident" id="4451710">Spec</span><span class="op" id="4451714">,</span>&nbsp;<span class="ident" id="4451716">n</span>&nbsp;<span class="builtintype" id="4451718">int</span><span class="op" id="4451721">,</span>&nbsp;<span class="ident" id="4451723">doIndent</span>&nbsp;<span class="builtintype" id="4451732">bool</span><span class="op" id="4451736">)</span>&nbsp;<span class="op" id="4451738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451741">switch</span>&nbsp;<span class="ident" id="4451748">s</span>&nbsp;<span class="op" id="4451750">:=</span>&nbsp;<span class="ident" id="4451753">spec</span><span class="op" id="4451757">.</span><span class="op" id="4451758">(</span><span class="keyword" id="4451759">type</span><span class="op" id="4451763">)</span>&nbsp;<span class="op" id="4451765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451768">case</span>&nbsp;<span class="op" id="4451773">*</span><span class="ident" id="4451774">ast</span><span class="op" id="4451777">.</span><span class="ident" id="4451778">ImportSpec</span><span class="op" id="4451788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451792">p</span><span class="op" id="4451793">.</span><span class="ident" id="4451794">setComment</span><span class="op" id="4451804">(</span><span class="ident" id="4451805">s</span><span class="op" id="4451806">.</span><span class="ident" id="4451807">Doc</span><span class="op" id="4451810">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451814">if</span>&nbsp;<span class="ident" id="4451817">s</span><span class="op" id="4451818">.</span><span class="ident" id="4451819">Name</span>&nbsp;<span class="op" id="4451824">!=</span>&nbsp;<span class="ident" id="4451827">nil</span>&nbsp;<span class="op" id="4451831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451836">p</span><span class="op" id="4451837">.</span><span class="ident" id="4451838">expr</span><span class="op" id="4451842">(</span><span class="ident" id="4451843">s</span><span class="op" id="4451844">.</span><span class="ident" id="4451845">Name</span><span class="op" id="4451849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451854">p</span><span class="op" id="4451855">.</span><span class="builtinfunc" id="4451856">print</span><span class="op" id="4451861">(</span><span class="ident" id="4451862">blank</span><span class="op" id="4451867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4451871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451875">p</span><span class="op" id="4451876">.</span><span class="ident" id="4451877">expr</span><span class="op" id="4451881">(</span><span class="ident" id="4451882">s</span><span class="op" id="4451883">.</span><span class="ident" id="4451884">Path</span><span class="op" id="4451888">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451892">p</span><span class="op" id="4451893">.</span><span class="ident" id="4451894">setComment</span><span class="op" id="4451904">(</span><span class="ident" id="4451905">s</span><span class="op" id="4451906">.</span><span class="ident" id="4451907">Comment</span><span class="op" id="4451914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451918">p</span><span class="op" id="4451919">.</span><span class="builtinfunc" id="4451920">print</span><span class="op" id="4451925">(</span><span class="ident" id="4451926">s</span><span class="op" id="4451927">.</span><span class="ident" id="4451928">EndPos</span><span class="op" id="4451934">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451938">case</span>&nbsp;<span class="op" id="4451943">*</span><span class="ident" id="4451944">ast</span><span class="op" id="4451947">.</span><span class="ident" id="4451948">ValueSpec</span><span class="op" id="4451957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4451961">if</span>&nbsp;<span class="ident" id="4451964">n</span>&nbsp;<span class="op" id="4451966">!=</span>&nbsp;<span class="num" id="4451969">1</span>&nbsp;<span class="op" id="4451971">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4451976">p</span><span class="op" id="4451977">.</span><span class="ident" id="4451978">internalError</span><span class="op" id="4451991">(</span><span class="string" id="4451992">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="4452013">,</span>&nbsp;<span class="ident" id="4452015">n</span><span class="op" id="4452016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452024">p</span><span class="op" id="4452025">.</span><span class="ident" id="4452026">setComment</span><span class="op" id="4452036">(</span><span class="ident" id="4452037">s</span><span class="op" id="4452038">.</span><span class="ident" id="4452039">Doc</span><span class="op" id="4452042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452046">p</span><span class="op" id="4452047">.</span><span class="ident" id="4452048">identList</span><span class="op" id="4452057">(</span><span class="ident" id="4452058">s</span><span class="op" id="4452059">.</span><span class="ident" id="4452060">Names</span><span class="op" id="4452065">,</span>&nbsp;<span class="ident" id="4452067">doIndent</span><span class="op" id="4452075">)</span>&nbsp;<span class="comment" id="4452077">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452097">if</span>&nbsp;<span class="ident" id="4452100">s</span><span class="op" id="4452101">.</span><span class="ident" id="4452102">Type</span>&nbsp;<span class="op" id="4452107">!=</span>&nbsp;<span class="ident" id="4452110">nil</span>&nbsp;<span class="op" id="4452114">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452119">p</span><span class="op" id="4452120">.</span><span class="builtinfunc" id="4452121">print</span><span class="op" id="4452126">(</span><span class="ident" id="4452127">blank</span><span class="op" id="4452132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452137">p</span><span class="op" id="4452138">.</span><span class="ident" id="4452139">expr</span><span class="op" id="4452143">(</span><span class="ident" id="4452144">s</span><span class="op" id="4452145">.</span><span class="ident" id="4452146">Type</span><span class="op" id="4452150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452158">if</span>&nbsp;<span class="ident" id="4452161">s</span><span class="op" id="4452162">.</span><span class="ident" id="4452163">Values</span>&nbsp;<span class="op" id="4452170">!=</span>&nbsp;<span class="ident" id="4452173">nil</span>&nbsp;<span class="op" id="4452177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452182">p</span><span class="op" id="4452183">.</span><span class="builtinfunc" id="4452184">print</span><span class="op" id="4452189">(</span><span class="ident" id="4452190">blank</span><span class="op" id="4452195">,</span>&nbsp;<span class="ident" id="4452197">token</span><span class="op" id="4452202">.</span><span class="ident" id="4452203">ASSIGN</span><span class="op" id="4452209">,</span>&nbsp;<span class="ident" id="4452211">blank</span><span class="op" id="4452216">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452221">p</span><span class="op" id="4452222">.</span><span class="ident" id="4452223">exprList</span><span class="op" id="4452231">(</span><span class="ident" id="4452232">token</span><span class="op" id="4452237">.</span><span class="ident" id="4452238">NoPos</span><span class="op" id="4452243">,</span>&nbsp;<span class="ident" id="4452245">s</span><span class="op" id="4452246">.</span><span class="ident" id="4452247">Values</span><span class="op" id="4452253">,</span>&nbsp;<span class="num" id="4452255">1</span><span class="op" id="4452256">,</span>&nbsp;<span class="num" id="4452258">0</span><span class="op" id="4452259">,</span>&nbsp;<span class="ident" id="4452261">token</span><span class="op" id="4452266">.</span><span class="ident" id="4452267">NoPos</span><span class="op" id="4452272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452280">p</span><span class="op" id="4452281">.</span><span class="ident" id="4452282">setComment</span><span class="op" id="4452292">(</span><span class="ident" id="4452293">s</span><span class="op" id="4452294">.</span><span class="ident" id="4452295">Comment</span><span class="op" id="4452302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452306">case</span>&nbsp;<span class="op" id="4452311">*</span><span class="ident" id="4452312">ast</span><span class="op" id="4452315">.</span><span class="ident" id="4452316">TypeSpec</span><span class="op" id="4452324">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452328">p</span><span class="op" id="4452329">.</span><span class="ident" id="4452330">setComment</span><span class="op" id="4452340">(</span><span class="ident" id="4452341">s</span><span class="op" id="4452342">.</span><span class="ident" id="4452343">Doc</span><span class="op" id="4452346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452350">p</span><span class="op" id="4452351">.</span><span class="ident" id="4452352">expr</span><span class="op" id="4452356">(</span><span class="ident" id="4452357">s</span><span class="op" id="4452358">.</span><span class="ident" id="4452359">Name</span><span class="op" id="4452363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452367">if</span>&nbsp;<span class="ident" id="4452370">n</span>&nbsp;<span class="op" id="4452372">==</span>&nbsp;<span class="num" id="4452375">1</span>&nbsp;<span class="op" id="4452377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452382">p</span><span class="op" id="4452383">.</span><span class="builtinfunc" id="4452384">print</span><span class="op" id="4452389">(</span><span class="ident" id="4452390">blank</span><span class="op" id="4452395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452399">}</span>&nbsp;<span class="keyword" id="4452401">else</span>&nbsp;<span class="op" id="4452406">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452411">p</span><span class="op" id="4452412">.</span><span class="builtinfunc" id="4452413">print</span><span class="op" id="4452418">(</span><span class="ident" id="4452419">vtab</span><span class="op" id="4452423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452431">p</span><span class="op" id="4452432">.</span><span class="ident" id="4452433">expr</span><span class="op" id="4452437">(</span><span class="ident" id="4452438">s</span><span class="op" id="4452439">.</span><span class="ident" id="4452440">Type</span><span class="op" id="4452444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452448">p</span><span class="op" id="4452449">.</span><span class="ident" id="4452450">setComment</span><span class="op" id="4452460">(</span><span class="ident" id="4452461">s</span><span class="op" id="4452462">.</span><span class="ident" id="4452463">Comment</span><span class="op" id="4452470">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452474">default</span><span class="op" id="4452481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4452485">panic</span><span class="op" id="4452490">(</span><span class="string" id="4452491">&#34;unreachable&#34;</span><span class="op" id="4452504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4452507">}</span><br>
<span class="lineno"></span><span class="op" id="4452509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="4452512">func</span>&nbsp;<span class="op" id="4452517">(</span><span class="ident" id="4452518">p</span>&nbsp;<span class="op" id="4452520">*</span><span class="ident" id="4452521">printer</span><span class="op" id="4452528">)</span>&nbsp;<span class="ident" id="4452530">genDecl</span><span class="op" id="4452537">(</span><span class="ident" id="4452538">d</span>&nbsp;<span class="op" id="4452540">*</span><span class="ident" id="4452541">ast</span><span class="op" id="4452544">.</span><span class="ident" id="4452545">GenDecl</span><span class="op" id="4452552">)</span>&nbsp;<span class="op" id="4452554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452557">p</span><span class="op" id="4452558">.</span><span class="ident" id="4452559">setComment</span><span class="op" id="4452569">(</span><span class="ident" id="4452570">d</span><span class="op" id="4452571">.</span><span class="ident" id="4452572">Doc</span><span class="op" id="4452575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452578">p</span><span class="op" id="4452579">.</span><span class="builtinfunc" id="4452580">print</span><span class="op" id="4452585">(</span><span class="ident" id="4452586">d</span><span class="op" id="4452587">.</span><span class="ident" id="4452588">Pos</span><span class="op" id="4452591">(</span><span class="op" id="4452592">)</span><span class="op" id="4452593">,</span>&nbsp;<span class="ident" id="4452595">d</span><span class="op" id="4452596">.</span><span class="ident" id="4452597">Tok</span><span class="op" id="4452600">,</span>&nbsp;<span class="ident" id="4452602">blank</span><span class="op" id="4452607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452611">if</span>&nbsp;<span class="ident" id="4452614">d</span><span class="op" id="4452615">.</span><span class="ident" id="4452616">Lparen</span><span class="op" id="4452622">.</span><span class="ident" id="4452623">IsValid</span><span class="op" id="4452630">(</span><span class="op" id="4452631">)</span>&nbsp;<span class="op" id="4452633">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4452637">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452678">p</span><span class="op" id="4452679">.</span><span class="builtinfunc" id="4452680">print</span><span class="op" id="4452685">(</span><span class="ident" id="4452686">d</span><span class="op" id="4452687">.</span><span class="ident" id="4452688">Lparen</span><span class="op" id="4452694">,</span>&nbsp;<span class="ident" id="4452696">token</span><span class="op" id="4452701">.</span><span class="ident" id="4452702">LPAREN</span><span class="op" id="4452708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452712">if</span>&nbsp;<span class="ident" id="4452715">n</span>&nbsp;<span class="op" id="4452717">:=</span>&nbsp;<span class="builtinfunc" id="4452720">len</span><span class="op" id="4452723">(</span><span class="ident" id="4452724">d</span><span class="op" id="4452725">.</span><span class="ident" id="4452726">Specs</span><span class="op" id="4452731">)</span><span class="op" id="4452732">;</span>&nbsp;<span class="ident" id="4452734">n</span>&nbsp;<span class="op" id="4452736">&gt;</span>&nbsp;<span class="num" id="4452738">0</span>&nbsp;<span class="op" id="4452740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452745">p</span><span class="op" id="4452746">.</span><span class="builtinfunc" id="4452747">print</span><span class="op" id="4452752">(</span><span class="ident" id="4452753">indent</span><span class="op" id="4452759">,</span>&nbsp;<span class="ident" id="4452761">formfeed</span><span class="op" id="4452769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452774">if</span>&nbsp;<span class="ident" id="4452777">n</span>&nbsp;<span class="op" id="4452779">&gt;</span>&nbsp;<span class="num" id="4452781">1</span>&nbsp;<span class="op" id="4452783">&amp;&amp;</span>&nbsp;<span class="op" id="4452786">(</span><span class="ident" id="4452787">d</span><span class="op" id="4452788">.</span><span class="ident" id="4452789">Tok</span>&nbsp;<span class="op" id="4452793">==</span>&nbsp;<span class="ident" id="4452796">token</span><span class="op" id="4452801">.</span><span class="ident" id="4452802">CONST</span>&nbsp;<span class="op" id="4452808">||</span>&nbsp;<span class="ident" id="4452811">d</span><span class="op" id="4452812">.</span><span class="ident" id="4452813">Tok</span>&nbsp;<span class="op" id="4452817">==</span>&nbsp;<span class="ident" id="4452820">token</span><span class="op" id="4452825">.</span><span class="ident" id="4452826">VAR</span><span class="op" id="4452829">)</span>&nbsp;<span class="op" id="4452831">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4452837">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4452888">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4452937">keepType</span>&nbsp;<span class="op" id="4452946">:=</span>&nbsp;<span class="ident" id="4452949">keepTypeColumn</span><span class="op" id="4452963">(</span><span class="ident" id="4452964">d</span><span class="op" id="4452965">.</span><span class="ident" id="4452966">Specs</span><span class="op" id="4452971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452977">var</span>&nbsp;<span class="ident" id="4452981">line</span>&nbsp;<span class="builtintype" id="4452986">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4452994">for</span>&nbsp;<span class="ident" id="4452998">i</span><span class="op" id="4452999">,</span>&nbsp;<span class="ident" id="4453001">s</span>&nbsp;<span class="op" id="4453003">:=</span>&nbsp;<span class="keyword" id="4453006">range</span>&nbsp;<span class="ident" id="4453012">d</span><span class="op" id="4453013">.</span><span class="ident" id="4453014">Specs</span>&nbsp;<span class="op" id="4453020">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453027">if</span>&nbsp;<span class="ident" id="4453030">i</span>&nbsp;<span class="op" id="4453032">&gt;</span>&nbsp;<span class="num" id="4453034">0</span>&nbsp;<span class="op" id="4453036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453044">p</span><span class="op" id="4453045">.</span><span class="ident" id="4453046">linebreak</span><span class="op" id="4453055">(</span><span class="ident" id="4453056">p</span><span class="op" id="4453057">.</span><span class="ident" id="4453058">lineFor</span><span class="op" id="4453065">(</span><span class="ident" id="4453066">s</span><span class="op" id="4453067">.</span><span class="ident" id="4453068">Pos</span><span class="op" id="4453071">(</span><span class="op" id="4453072">)</span><span class="op" id="4453073">)</span><span class="op" id="4453074">,</span>&nbsp;<span class="num" id="4453076">1</span><span class="op" id="4453077">,</span>&nbsp;<span class="ident" id="4453079">ignore</span><span class="op" id="4453085">,</span>&nbsp;<span class="ident" id="4453087">p</span><span class="op" id="4453088">.</span><span class="ident" id="4453089">linesFrom</span><span class="op" id="4453098">(</span><span class="ident" id="4453099">line</span><span class="op" id="4453103">)</span>&nbsp;<span class="op" id="4453105">&gt;</span>&nbsp;<span class="num" id="4453107">0</span><span class="op" id="4453108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453122">p</span><span class="op" id="4453123">.</span><span class="ident" id="4453124">recordLine</span><span class="op" id="4453134">(</span><span class="op" id="4453135">&amp;</span><span class="ident" id="4453136">line</span><span class="op" id="4453140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453147">p</span><span class="op" id="4453148">.</span><span class="ident" id="4453149">valueSpec</span><span class="op" id="4453158">(</span><span class="ident" id="4453159">s</span><span class="op" id="4453160">.</span><span class="op" id="4453161">(</span><span class="op" id="4453162">*</span><span class="ident" id="4453163">ast</span><span class="op" id="4453166">.</span><span class="ident" id="4453167">ValueSpec</span><span class="op" id="4453176">)</span><span class="op" id="4453177">,</span>&nbsp;<span class="ident" id="4453179">keepType</span><span class="op" id="4453187">[</span><span class="ident" id="4453188">i</span><span class="op" id="4453189">]</span><span class="op" id="4453190">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453201">}</span>&nbsp;<span class="keyword" id="4453203">else</span>&nbsp;<span class="op" id="4453208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453214">var</span>&nbsp;<span class="ident" id="4453218">line</span>&nbsp;<span class="builtintype" id="4453223">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453231">for</span>&nbsp;<span class="ident" id="4453235">i</span><span class="op" id="4453236">,</span>&nbsp;<span class="ident" id="4453238">s</span>&nbsp;<span class="op" id="4453240">:=</span>&nbsp;<span class="keyword" id="4453243">range</span>&nbsp;<span class="ident" id="4453249">d</span><span class="op" id="4453250">.</span><span class="ident" id="4453251">Specs</span>&nbsp;<span class="op" id="4453257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4453264">if</span>&nbsp;<span class="ident" id="4453267">i</span>&nbsp;<span class="op" id="4453269">&gt;</span>&nbsp;<span class="num" id="4453271">0</span>&nbsp;<span class="op" id="4453273">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453281">p</span><span class="op" id="4453282">.</span><span class="ident" id="4453283">linebreak</span><span class="op" id="4453292">(</span><span class="ident" id="4453293">p</span><span class="op" id="4453294">.</span><span class="ident" id="4453295">lineFor</span><span class="op" id="4453302">(</span><span class="ident" id="4453303">s</span><span class="op" id="4453304">.</span><span class="ident" id="4453305">Pos</span><span class="op" id="4453308">(</span><span class="op" id="4453309">)</span><span class="op" id="4453310">)</span><span class="op" id="4453311">,</span>&nbsp;<span class="num" id="4453313">1</span><span class="op" id="4453314">,</span>&nbsp;<span class="ident" id="4453316">ignore</span><span class="op" id="4453322">,</span>&nbsp;<span class="ident" id="4453324">p</span><span class="op" id="4453325">.</span><span class="ident" id="4453326">linesFrom</span><span class="op" id="4453335">(</span><span class="ident" id="4453336">line</span><span class="op" id="4453340">)</span>&nbsp;<span class="op" id="4453342">&gt;</span>&nbsp;<span class="num" id="4453344">0</span><span class="op" id="4453345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453359">p</span><span class="op" id="4453360">.</span><span class="ident" id="4453361">recordLine</span><span class="op" id="4453371">(</span><span class="op" id="4453372">&amp;</span><span class="ident" id="4453373">line</span><span class="op" id="4453377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453384">p</span><span class="op" id="4453385">.</span><span class="ident" id="4453386">spec</span><span class="op" id="4453390">(</span><span class="ident" id="4453391">s</span><span class="op" id="4453392">,</span>&nbsp;<span class="ident" id="4453394">n</span><span class="op" id="4453395">,</span>&nbsp;<span class="builtintype" id="4453397">false</span><span class="op" id="4453402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453408">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453418">p</span><span class="op" id="4453419">.</span><span class="builtinfunc" id="4453420">print</span><span class="op" id="4453425">(</span><span class="ident" id="4453426">unindent</span><span class="op" id="4453434">,</span>&nbsp;<span class="ident" id="4453436">formfeed</span><span class="op" id="4453444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453452">p</span><span class="op" id="4453453">.</span><span class="builtinfunc" id="4453454">print</span><span class="op" id="4453459">(</span><span class="ident" id="4453460">d</span><span class="op" id="4453461">.</span><span class="ident" id="4453462">Rparen</span><span class="op" id="4453468">,</span>&nbsp;<span class="ident" id="4453470">token</span><span class="op" id="4453475">.</span><span class="ident" id="4453476">RPAREN</span><span class="op" id="4453482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453486">}</span>&nbsp;<span class="keyword" id="4453488">else</span>&nbsp;<span class="op" id="4453493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453497">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453521">p</span><span class="op" id="4453522">.</span><span class="ident" id="4453523">spec</span><span class="op" id="4453527">(</span><span class="ident" id="4453528">d</span><span class="op" id="4453529">.</span><span class="ident" id="4453530">Specs</span><span class="op" id="4453535">[</span><span class="num" id="4453536">0</span><span class="op" id="4453537">]</span><span class="op" id="4453538">,</span>&nbsp;<span class="num" id="4453540">1</span><span class="op" id="4453541">,</span>&nbsp;<span class="builtintype" id="4453543">true</span><span class="op" id="4453547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453550">}</span><br>
<span class="lineno"></span><span class="op" id="4453552">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="4453555">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="4453619">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4453684">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="4453747">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="4453805">//</span><br>
<span class="lineno"></span><span class="keyword" id="4453808">func</span>&nbsp;<span class="op" id="4453813">(</span><span class="ident" id="4453814">p</span>&nbsp;<span class="op" id="4453816">*</span><span class="ident" id="4453817">printer</span><span class="op" id="4453824">)</span>&nbsp;<span class="ident" id="4453826">nodeSize</span><span class="op" id="4453834">(</span><span class="ident" id="4453835">n</span>&nbsp;<span class="ident" id="4453837">ast</span><span class="op" id="4453840">.</span><span class="ident" id="4453841">Node</span><span class="op" id="4453845">,</span>&nbsp;<span class="ident" id="4453847">maxSize</span>&nbsp;<span class="builtintype" id="4453855">int</span><span class="op" id="4453858">)</span>&nbsp;<span class="op" id="4453860">(</span><span class="ident" id="4453861">size</span>&nbsp;<span class="builtintype" id="4453866">int</span><span class="op" id="4453869">)</span>&nbsp;<span class="op" id="4453871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453874">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453934">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453994">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454050">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454103">if</span>&nbsp;<span class="ident" id="4454106">size</span><span class="op" id="4454110">,</span>&nbsp;<span class="ident" id="4454112">found</span>&nbsp;<span class="op" id="4454118">:=</span>&nbsp;<span class="ident" id="4454121">p</span><span class="op" id="4454122">.</span><span class="ident" id="4454123">nodeSizes</span><span class="op" id="4454132">[</span><span class="ident" id="4454133">n</span><span class="op" id="4454134">]</span><span class="op" id="4454135">;</span>&nbsp;<span class="ident" id="4454137">found</span>&nbsp;<span class="op" id="4454143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454147">return</span>&nbsp;<span class="ident" id="4454154">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454164">size</span>&nbsp;<span class="op" id="4454169">=</span>&nbsp;<span class="ident" id="4454171">maxSize</span>&nbsp;<span class="op" id="4454179">+</span>&nbsp;<span class="num" id="4454181">1</span>&nbsp;<span class="comment" id="4454183">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454208">p</span><span class="op" id="4454209">.</span><span class="ident" id="4454210">nodeSizes</span><span class="op" id="4454219">[</span><span class="ident" id="4454220">n</span><span class="op" id="4454221">]</span>&nbsp;<span class="op" id="4454223">=</span>&nbsp;<span class="ident" id="4454225">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454232">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454291">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454348">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454365">cfg</span>&nbsp;<span class="op" id="4454369">:=</span>&nbsp;<span class="ident" id="4454372">Config</span><span class="op" id="4454378">{</span><span class="ident" id="4454379">Mode</span><span class="op" id="4454383">:</span>&nbsp;<span class="ident" id="4454385">RawFormat</span><span class="op" id="4454394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454397">var</span>&nbsp;<span class="ident" id="4454401">buf</span>&nbsp;<span class="ident" id="4454405">bytes</span><span class="op" id="4454410">.</span><span class="ident" id="4454411">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454419">if</span>&nbsp;<span class="ident" id="4454422">err</span>&nbsp;<span class="op" id="4454426">:=</span>&nbsp;<span class="ident" id="4454429">cfg</span><span class="op" id="4454432">.</span><span class="ident" id="4454433">fprint</span><span class="op" id="4454439">(</span><span class="op" id="4454440">&amp;</span><span class="ident" id="4454441">buf</span><span class="op" id="4454444">,</span>&nbsp;<span class="ident" id="4454446">p</span><span class="op" id="4454447">.</span><span class="ident" id="4454448">fset</span><span class="op" id="4454452">,</span>&nbsp;<span class="ident" id="4454454">n</span><span class="op" id="4454455">,</span>&nbsp;<span class="ident" id="4454457">p</span><span class="op" id="4454458">.</span><span class="ident" id="4454459">nodeSizes</span><span class="op" id="4454468">)</span><span class="op" id="4454469">;</span>&nbsp;<span class="ident" id="4454471">err</span>&nbsp;<span class="op" id="4454475">!=</span>&nbsp;<span class="ident" id="4454478">nil</span>&nbsp;<span class="op" id="4454482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454486">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454497">if</span>&nbsp;<span class="ident" id="4454500">buf</span><span class="op" id="4454503">.</span><span class="ident" id="4454504">Len</span><span class="op" id="4454507">(</span><span class="op" id="4454508">)</span>&nbsp;<span class="op" id="4454510">&lt;=</span>&nbsp;<span class="ident" id="4454513">maxSize</span>&nbsp;<span class="op" id="4454521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454525">for</span>&nbsp;<span class="ident" id="4454529">_</span><span class="op" id="4454530">,</span>&nbsp;<span class="ident" id="4454532">ch</span>&nbsp;<span class="op" id="4454535">:=</span>&nbsp;<span class="keyword" id="4454538">range</span>&nbsp;<span class="ident" id="4454544">buf</span><span class="op" id="4454547">.</span><span class="ident" id="4454548">Bytes</span><span class="op" id="4454553">(</span><span class="op" id="4454554">)</span>&nbsp;<span class="op" id="4454556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454561">if</span>&nbsp;<span class="ident" id="4454564">ch</span>&nbsp;<span class="op" id="4454567">&lt;</span>&nbsp;<span class="string" id="4454569">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4454573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454579">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454597">size</span>&nbsp;<span class="op" id="4454602">=</span>&nbsp;<span class="ident" id="4454604">buf</span><span class="op" id="4454607">.</span><span class="ident" id="4454608">Len</span><span class="op" id="4454611">(</span><span class="op" id="4454612">)</span>&nbsp;<span class="comment" id="4454614">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454626">p</span><span class="op" id="4454627">.</span><span class="ident" id="4454628">nodeSizes</span><span class="op" id="4454637">[</span><span class="ident" id="4454638">n</span><span class="op" id="4454639">]</span>&nbsp;<span class="op" id="4454641">=</span>&nbsp;<span class="ident" id="4454643">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454649">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454652">return</span><br>
<span class="lineno"></span><span class="op" id="4454659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4454662">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4454735">func</span>&nbsp;<span class="op" id="4454740">(</span><span class="ident" id="4454741">p</span>&nbsp;<span class="op" id="4454743">*</span><span class="ident" id="4454744">printer</span><span class="op" id="4454751">)</span>&nbsp;<span class="ident" id="4454753">bodySize</span><span class="op" id="4454761">(</span><span class="ident" id="4454762">b</span>&nbsp;<span class="op" id="4454764">*</span><span class="ident" id="4454765">ast</span><span class="op" id="4454768">.</span><span class="ident" id="4454769">BlockStmt</span><span class="op" id="4454778">,</span>&nbsp;<span class="ident" id="4454780">maxSize</span>&nbsp;<span class="builtintype" id="4454788">int</span><span class="op" id="4454791">)</span>&nbsp;<span class="builtintype" id="4454793">int</span>&nbsp;<span class="op" id="4454797">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454800">pos1</span>&nbsp;<span class="op" id="4454805">:=</span>&nbsp;<span class="ident" id="4454808">b</span><span class="op" id="4454809">.</span><span class="ident" id="4454810">Pos</span><span class="op" id="4454813">(</span><span class="op" id="4454814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454817">pos2</span>&nbsp;<span class="op" id="4454822">:=</span>&nbsp;<span class="ident" id="4454825">b</span><span class="op" id="4454826">.</span><span class="ident" id="4454827">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454835">if</span>&nbsp;<span class="ident" id="4454838">pos1</span><span class="op" id="4454842">.</span><span class="ident" id="4454843">IsValid</span><span class="op" id="4454850">(</span><span class="op" id="4454851">)</span>&nbsp;<span class="op" id="4454853">&amp;&amp;</span>&nbsp;<span class="ident" id="4454856">pos2</span><span class="op" id="4454860">.</span><span class="ident" id="4454861">IsValid</span><span class="op" id="4454868">(</span><span class="op" id="4454869">)</span>&nbsp;<span class="op" id="4454871">&amp;&amp;</span>&nbsp;<span class="ident" id="4454874">p</span><span class="op" id="4454875">.</span><span class="ident" id="4454876">lineFor</span><span class="op" id="4454883">(</span><span class="ident" id="4454884">pos1</span><span class="op" id="4454888">)</span>&nbsp;<span class="op" id="4454890">!=</span>&nbsp;<span class="ident" id="4454893">p</span><span class="op" id="4454894">.</span><span class="ident" id="4454895">lineFor</span><span class="op" id="4454902">(</span><span class="ident" id="4454903">pos2</span><span class="op" id="4454907">)</span>&nbsp;<span class="op" id="4454909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454913">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454995">return</span>&nbsp;<span class="ident" id="4455002">maxSize</span>&nbsp;<span class="op" id="4455010">+</span>&nbsp;<span class="num" id="4455012">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455018">if</span>&nbsp;<span class="builtinfunc" id="4455021">len</span><span class="op" id="4455024">(</span><span class="ident" id="4455025">b</span><span class="op" id="4455026">.</span><span class="ident" id="4455027">List</span><span class="op" id="4455031">)</span>&nbsp;<span class="op" id="4455033">&gt;</span>&nbsp;<span class="num" id="4455035">5</span>&nbsp;<span class="op" id="4455037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4455041">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455094">return</span>&nbsp;<span class="ident" id="4455101">maxSize</span>&nbsp;<span class="op" id="4455109">+</span>&nbsp;<span class="num" id="4455111">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455114">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4455117">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455151">bodySize</span>&nbsp;<span class="op" id="4455160">:=</span>&nbsp;<span class="ident" id="4455163">p</span><span class="op" id="4455164">.</span><span class="ident" id="4455165">commentSizeBefore</span><span class="op" id="4455182">(</span><span class="ident" id="4455183">p</span><span class="op" id="4455184">.</span><span class="ident" id="4455185">posFor</span><span class="op" id="4455191">(</span><span class="ident" id="4455192">pos2</span><span class="op" id="4455196">)</span><span class="op" id="4455197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455200">for</span>&nbsp;<span class="ident" id="4455204">i</span><span class="op" id="4455205">,</span>&nbsp;<span class="ident" id="4455207">s</span>&nbsp;<span class="op" id="4455209">:=</span>&nbsp;<span class="keyword" id="4455212">range</span>&nbsp;<span class="ident" id="4455218">b</span><span class="op" id="4455219">.</span><span class="ident" id="4455220">List</span>&nbsp;<span class="op" id="4455225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455229">if</span>&nbsp;<span class="ident" id="4455232">bodySize</span>&nbsp;<span class="op" id="4455241">&gt;</span>&nbsp;<span class="ident" id="4455243">maxSize</span>&nbsp;<span class="op" id="4455251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455256">break</span>&nbsp;<span class="comment" id="4455262">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455291">if</span>&nbsp;<span class="ident" id="4455294">i</span>&nbsp;<span class="op" id="4455296">&gt;</span>&nbsp;<span class="num" id="4455298">0</span>&nbsp;<span class="op" id="4455300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455305">bodySize</span>&nbsp;<span class="op" id="4455314">+=</span>&nbsp;<span class="num" id="4455317">2</span>&nbsp;<span class="comment" id="4455319">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455360">bodySize</span>&nbsp;<span class="op" id="4455369">+=</span>&nbsp;<span class="ident" id="4455372">p</span><span class="op" id="4455373">.</span><span class="ident" id="4455374">nodeSize</span><span class="op" id="4455382">(</span><span class="ident" id="4455383">s</span><span class="op" id="4455384">,</span>&nbsp;<span class="ident" id="4455386">maxSize</span><span class="op" id="4455393">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455399">return</span>&nbsp;<span class="ident" id="4455406">bodySize</span><br>
<span class="lineno"></span><span class="op" id="4455415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4455418">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="4455503">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="4455592">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="4455681">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="4455770">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4455859">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="4455916">//</span><br>
<span class="lineno"></span><span class="keyword" id="4455919">func</span>&nbsp;<span class="op" id="4455924">(</span><span class="ident" id="4455925">p</span>&nbsp;<span class="op" id="4455927">*</span><span class="ident" id="4455928">printer</span><span class="op" id="4455935">)</span>&nbsp;<span class="ident" id="4455937">adjBlock</span><span class="op" id="4455945">(</span><span class="ident" id="4455946">headerSize</span>&nbsp;<span class="builtintype" id="4455957">int</span><span class="op" id="4455960">,</span>&nbsp;<span class="ident" id="4455962">sep</span>&nbsp;<span class="ident" id="4455966">whiteSpace</span><span class="op" id="4455976">,</span>&nbsp;<span class="ident" id="4455978">b</span>&nbsp;<span class="op" id="4455980">*</span><span class="ident" id="4455981">ast</span><span class="op" id="4455984">.</span><span class="ident" id="4455985">BlockStmt</span><span class="op" id="4455994">)</span>&nbsp;<span class="op" id="4455996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455999">if</span>&nbsp;<span class="ident" id="4456002">b</span>&nbsp;<span class="op" id="4456004">==</span>&nbsp;<span class="ident" id="4456007">nil</span>&nbsp;<span class="op" id="4456011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456015">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456023">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456027">const</span>&nbsp;<span class="ident" id="4456033">maxSize</span>&nbsp;<span class="op" id="4456041">=</span>&nbsp;<span class="num" id="4456043">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456048">if</span>&nbsp;<span class="ident" id="4456051">headerSize</span><span class="op" id="4456061">+</span><span class="ident" id="4456062">p</span><span class="op" id="4456063">.</span><span class="ident" id="4456064">bodySize</span><span class="op" id="4456072">(</span><span class="ident" id="4456073">b</span><span class="op" id="4456074">,</span>&nbsp;<span class="ident" id="4456076">maxSize</span><span class="op" id="4456083">)</span>&nbsp;<span class="op" id="4456085">&lt;=</span>&nbsp;<span class="ident" id="4456088">maxSize</span>&nbsp;<span class="op" id="4456096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456100">p</span><span class="op" id="4456101">.</span><span class="builtinfunc" id="4456102">print</span><span class="op" id="4456107">(</span><span class="ident" id="4456108">sep</span><span class="op" id="4456111">,</span>&nbsp;<span class="ident" id="4456113">b</span><span class="op" id="4456114">.</span><span class="ident" id="4456115">Lbrace</span><span class="op" id="4456121">,</span>&nbsp;<span class="ident" id="4456123">token</span><span class="op" id="4456128">.</span><span class="ident" id="4456129">LBRACE</span><span class="op" id="4456135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456139">if</span>&nbsp;<span class="builtinfunc" id="4456142">len</span><span class="op" id="4456145">(</span><span class="ident" id="4456146">b</span><span class="op" id="4456147">.</span><span class="ident" id="4456148">List</span><span class="op" id="4456152">)</span>&nbsp;<span class="op" id="4456154">&gt;</span>&nbsp;<span class="num" id="4456156">0</span>&nbsp;<span class="op" id="4456158">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456163">p</span><span class="op" id="4456164">.</span><span class="builtinfunc" id="4456165">print</span><span class="op" id="4456170">(</span><span class="ident" id="4456171">blank</span><span class="op" id="4456176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456181">for</span>&nbsp;<span class="ident" id="4456185">i</span><span class="op" id="4456186">,</span>&nbsp;<span class="ident" id="4456188">s</span>&nbsp;<span class="op" id="4456190">:=</span>&nbsp;<span class="keyword" id="4456193">range</span>&nbsp;<span class="ident" id="4456199">b</span><span class="op" id="4456200">.</span><span class="ident" id="4456201">List</span>&nbsp;<span class="op" id="4456206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456212">if</span>&nbsp;<span class="ident" id="4456215">i</span>&nbsp;<span class="op" id="4456217">&gt;</span>&nbsp;<span class="num" id="4456219">0</span>&nbsp;<span class="op" id="4456221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456228">p</span><span class="op" id="4456229">.</span><span class="builtinfunc" id="4456230">print</span><span class="op" id="4456235">(</span><span class="ident" id="4456236">token</span><span class="op" id="4456241">.</span><span class="ident" id="4456242">SEMICOLON</span><span class="op" id="4456251">,</span>&nbsp;<span class="ident" id="4456253">blank</span><span class="op" id="4456258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456264">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456270">p</span><span class="op" id="4456271">.</span><span class="ident" id="4456272">stmt</span><span class="op" id="4456276">(</span><span class="ident" id="4456277">s</span><span class="op" id="4456278">,</span>&nbsp;<span class="ident" id="4456280">i</span>&nbsp;<span class="op" id="4456282">==</span>&nbsp;<span class="builtinfunc" id="4456285">len</span><span class="op" id="4456288">(</span><span class="ident" id="4456289">b</span><span class="op" id="4456290">.</span><span class="ident" id="4456291">List</span><span class="op" id="4456295">)</span><span class="op" id="4456296">-</span><span class="num" id="4456297">1</span><span class="op" id="4456298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456308">p</span><span class="op" id="4456309">.</span><span class="builtinfunc" id="4456310">print</span><span class="op" id="4456315">(</span><span class="ident" id="4456316">blank</span><span class="op" id="4456321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456329">p</span><span class="op" id="4456330">.</span><span class="builtinfunc" id="4456331">print</span><span class="op" id="4456336">(</span><span class="ident" id="4456337">noExtraLinebreak</span><span class="op" id="4456353">,</span>&nbsp;<span class="ident" id="4456355">b</span><span class="op" id="4456356">.</span><span class="ident" id="4456357">Rbrace</span><span class="op" id="4456363">,</span>&nbsp;<span class="ident" id="4456365">token</span><span class="op" id="4456370">.</span><span class="ident" id="4456371">RBRACE</span><span class="op" id="4456377">,</span>&nbsp;<span class="ident" id="4456379">noExtraLinebreak</span><span class="op" id="4456395">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456411">if</span>&nbsp;<span class="ident" id="4456414">sep</span>&nbsp;<span class="op" id="4456418">!=</span>&nbsp;<span class="ident" id="4456421">ignore</span>&nbsp;<span class="op" id="4456428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456432">p</span><span class="op" id="4456433">.</span><span class="builtinfunc" id="4456434">print</span><span class="op" id="4456439">(</span><span class="ident" id="4456440">blank</span><span class="op" id="4456445">)</span>&nbsp;<span class="comment" id="4456447">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456471">p</span><span class="op" id="4456472">.</span><span class="ident" id="4456473">block</span><span class="op" id="4456478">(</span><span class="ident" id="4456479">b</span><span class="op" id="4456480">,</span>&nbsp;<span class="num" id="4456482">1</span><span class="op" id="4456483">)</span><br>
<span class="lineno"></span><span class="op" id="4456485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4456488">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="4456570">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="4456654">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="4456694">func</span>&nbsp;<span class="op" id="4456699">(</span><span class="ident" id="4456700">p</span>&nbsp;<span class="op" id="4456702">*</span><span class="ident" id="4456703">printer</span><span class="op" id="4456710">)</span>&nbsp;<span class="ident" id="4456712">distanceFrom</span><span class="op" id="4456724">(</span><span class="ident" id="4456725">from</span>&nbsp;<span class="ident" id="4456730">token</span><span class="op" id="4456735">.</span><span class="ident" id="4456736">Pos</span><span class="op" id="4456739">)</span>&nbsp;<span class="builtintype" id="4456741">int</span>&nbsp;<span class="op" id="4456745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456748">if</span>&nbsp;<span class="ident" id="4456751">from</span><span class="op" id="4456755">.</span><span class="ident" id="4456756">IsValid</span><span class="op" id="4456763">(</span><span class="op" id="4456764">)</span>&nbsp;<span class="op" id="4456766">&amp;&amp;</span>&nbsp;<span class="ident" id="4456769">p</span><span class="op" id="4456770">.</span><span class="ident" id="4456771">pos</span><span class="op" id="4456774">.</span><span class="ident" id="4456775">IsValid</span><span class="op" id="4456782">(</span><span class="op" id="4456783">)</span>&nbsp;<span class="op" id="4456785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456789">if</span>&nbsp;<span class="ident" id="4456792">f</span>&nbsp;<span class="op" id="4456794">:=</span>&nbsp;<span class="ident" id="4456797">p</span><span class="op" id="4456798">.</span><span class="ident" id="4456799">posFor</span><span class="op" id="4456805">(</span><span class="ident" id="4456806">from</span><span class="op" id="4456810">)</span><span class="op" id="4456811">;</span>&nbsp;<span class="ident" id="4456813">f</span><span class="op" id="4456814">.</span><span class="ident" id="4456815">Line</span>&nbsp;<span class="op" id="4456820">==</span>&nbsp;<span class="ident" id="4456823">p</span><span class="op" id="4456824">.</span><span class="ident" id="4456825">pos</span><span class="op" id="4456828">.</span><span class="ident" id="4456829">Line</span>&nbsp;<span class="op" id="4456834">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456839">return</span>&nbsp;<span class="ident" id="4456846">p</span><span class="op" id="4456847">.</span><span class="ident" id="4456848">pos</span><span class="op" id="4456851">.</span><span class="ident" id="4456852">Column</span>&nbsp;<span class="op" id="4456859">-</span>&nbsp;<span class="ident" id="4456861">f</span><span class="op" id="4456862">.</span><span class="ident" id="4456863">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456878">return</span>&nbsp;<span class="ident" id="4456885">infinity</span><br>
<span class="lineno"></span><span class="op" id="4456894">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="4456897">func</span>&nbsp;<span class="op" id="4456902">(</span><span class="ident" id="4456903">p</span>&nbsp;<span class="op" id="4456905">*</span><span class="ident" id="4456906">printer</span><span class="op" id="4456913">)</span>&nbsp;<span class="ident" id="4456915">funcDecl</span><span class="op" id="4456923">(</span><span class="ident" id="4456924">d</span>&nbsp;<span class="op" id="4456926">*</span><span class="ident" id="4456927">ast</span><span class="op" id="4456930">.</span><span class="ident" id="4456931">FuncDecl</span><span class="op" id="4456939">)</span>&nbsp;<span class="op" id="4456941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456944">p</span><span class="op" id="4456945">.</span><span class="ident" id="4456946">setComment</span><span class="op" id="4456956">(</span><span class="ident" id="4456957">d</span><span class="op" id="4456958">.</span><span class="ident" id="4456959">Doc</span><span class="op" id="4456962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456965">p</span><span class="op" id="4456966">.</span><span class="builtinfunc" id="4456967">print</span><span class="op" id="4456972">(</span><span class="ident" id="4456973">d</span><span class="op" id="4456974">.</span><span class="ident" id="4456975">Pos</span><span class="op" id="4456978">(</span><span class="op" id="4456979">)</span><span class="op" id="4456980">,</span>&nbsp;<span class="ident" id="4456982">token</span><span class="op" id="4456987">.</span><span class="ident" id="4456988">FUNC</span><span class="op" id="4456992">,</span>&nbsp;<span class="ident" id="4456994">blank</span><span class="op" id="4456999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457002">if</span>&nbsp;<span class="ident" id="4457005">d</span><span class="op" id="4457006">.</span><span class="ident" id="4457007">Recv</span>&nbsp;<span class="op" id="4457012">!=</span>&nbsp;<span class="ident" id="4457015">nil</span>&nbsp;<span class="op" id="4457019">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457023">p</span><span class="op" id="4457024">.</span><span class="ident" id="4457025">parameters</span><span class="op" id="4457035">(</span><span class="ident" id="4457036">d</span><span class="op" id="4457037">.</span><span class="ident" id="4457038">Recv</span><span class="op" id="4457042">)</span>&nbsp;<span class="comment" id="4457044">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457072">p</span><span class="op" id="4457073">.</span><span class="builtinfunc" id="4457074">print</span><span class="op" id="4457079">(</span><span class="ident" id="4457080">blank</span><span class="op" id="4457085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457091">p</span><span class="op" id="4457092">.</span><span class="ident" id="4457093">expr</span><span class="op" id="4457097">(</span><span class="ident" id="4457098">d</span><span class="op" id="4457099">.</span><span class="ident" id="4457100">Name</span><span class="op" id="4457104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457107">p</span><span class="op" id="4457108">.</span><span class="ident" id="4457109">signature</span><span class="op" id="4457118">(</span><span class="ident" id="4457119">d</span><span class="op" id="4457120">.</span><span class="ident" id="4457121">Type</span><span class="op" id="4457125">.</span><span class="ident" id="4457126">Params</span><span class="op" id="4457132">,</span>&nbsp;<span class="ident" id="4457134">d</span><span class="op" id="4457135">.</span><span class="ident" id="4457136">Type</span><span class="op" id="4457140">.</span><span class="ident" id="4457141">Results</span><span class="op" id="4457148">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457151">p</span><span class="op" id="4457152">.</span><span class="ident" id="4457153">adjBlock</span><span class="op" id="4457161">(</span><span class="ident" id="4457162">p</span><span class="op" id="4457163">.</span><span class="ident" id="4457164">distanceFrom</span><span class="op" id="4457176">(</span><span class="ident" id="4457177">d</span><span class="op" id="4457178">.</span><span class="ident" id="4457179">Pos</span><span class="op" id="4457182">(</span><span class="op" id="4457183">)</span><span class="op" id="4457184">)</span><span class="op" id="4457185">,</span>&nbsp;<span class="ident" id="4457187">vtab</span><span class="op" id="4457191">,</span>&nbsp;<span class="ident" id="4457193">d</span><span class="op" id="4457194">.</span><span class="ident" id="4457195">Body</span><span class="op" id="4457199">)</span><br>
<span class="lineno"></span><span class="op" id="4457201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4457204">func</span>&nbsp;<span class="op" id="4457209">(</span><span class="ident" id="4457210">p</span>&nbsp;<span class="op" id="4457212">*</span><span class="ident" id="4457213">printer</span><span class="op" id="4457220">)</span>&nbsp;<span class="ident" id="4457222">decl</span><span class="op" id="4457226">(</span><span class="ident" id="4457227">decl</span>&nbsp;<span class="ident" id="4457232">ast</span><span class="op" id="4457235">.</span><span class="ident" id="4457236">Decl</span><span class="op" id="4457240">)</span>&nbsp;<span class="op" id="4457242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457245">switch</span>&nbsp;<span class="ident" id="4457252">d</span>&nbsp;<span class="op" id="4457254">:=</span>&nbsp;<span class="ident" id="4457257">decl</span><span class="op" id="4457261">.</span><span class="op" id="4457262">(</span><span class="keyword" id="4457263">type</span><span class="op" id="4457267">)</span>&nbsp;<span class="op" id="4457269">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457272">case</span>&nbsp;<span class="op" id="4457277">*</span><span class="ident" id="4457278">ast</span><span class="op" id="4457281">.</span><span class="ident" id="4457282">BadDecl</span><span class="op" id="4457289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457293">p</span><span class="op" id="4457294">.</span><span class="builtinfunc" id="4457295">print</span><span class="op" id="4457300">(</span><span class="ident" id="4457301">d</span><span class="op" id="4457302">.</span><span class="ident" id="4457303">Pos</span><span class="op" id="4457306">(</span><span class="op" id="4457307">)</span><span class="op" id="4457308">,</span>&nbsp;<span class="string" id="4457310">&#34;BadDecl&#34;</span><span class="op" id="4457319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457322">case</span>&nbsp;<span class="op" id="4457327">*</span><span class="ident" id="4457328">ast</span><span class="op" id="4457331">.</span><span class="ident" id="4457332">GenDecl</span><span class="op" id="4457339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457343">p</span><span class="op" id="4457344">.</span><span class="ident" id="4457345">genDecl</span><span class="op" id="4457352">(</span><span class="ident" id="4457353">d</span><span class="op" id="4457354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457357">case</span>&nbsp;<span class="op" id="4457362">*</span><span class="ident" id="4457363">ast</span><span class="op" id="4457366">.</span><span class="ident" id="4457367">FuncDecl</span><span class="op" id="4457375">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457379">p</span><span class="op" id="4457380">.</span><span class="ident" id="4457381">funcDecl</span><span class="op" id="4457389">(</span><span class="ident" id="4457390">d</span><span class="op" id="4457391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457394">default</span><span class="op" id="4457401">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4457405">panic</span><span class="op" id="4457410">(</span><span class="string" id="4457411">&#34;unreachable&#34;</span><span class="op" id="4457424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457427">}</span><br>
<span class="lineno"></span><span class="op" id="4457429">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="4457432">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4457512">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4457522">func</span>&nbsp;<span class="ident" id="4457527">declToken</span><span class="op" id="4457536">(</span><span class="ident" id="4457537">decl</span>&nbsp;<span class="ident" id="4457542">ast</span><span class="op" id="4457545">.</span><span class="ident" id="4457546">Decl</span><span class="op" id="4457550">)</span>&nbsp;<span class="op" id="4457552">(</span><span class="ident" id="4457553">tok</span>&nbsp;<span class="ident" id="4457557">token</span><span class="op" id="4457562">.</span><span class="ident" id="4457563">Token</span><span class="op" id="4457568">)</span>&nbsp;<span class="op" id="4457570">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457573">tok</span>&nbsp;<span class="op" id="4457577">=</span>&nbsp;<span class="ident" id="4457579">token</span><span class="op" id="4457584">.</span><span class="ident" id="4457585">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457594">switch</span>&nbsp;<span class="ident" id="4457601">d</span>&nbsp;<span class="op" id="4457603">:=</span>&nbsp;<span class="ident" id="4457606">decl</span><span class="op" id="4457610">.</span><span class="op" id="4457611">(</span><span class="keyword" id="4457612">type</span><span class="op" id="4457616">)</span>&nbsp;<span class="op" id="4457618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457621">case</span>&nbsp;<span class="op" id="4457626">*</span><span class="ident" id="4457627">ast</span><span class="op" id="4457630">.</span><span class="ident" id="4457631">GenDecl</span><span class="op" id="4457638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457642">tok</span>&nbsp;<span class="op" id="4457646">=</span>&nbsp;<span class="ident" id="4457648">d</span><span class="op" id="4457649">.</span><span class="ident" id="4457650">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457655">case</span>&nbsp;<span class="op" id="4457660">*</span><span class="ident" id="4457661">ast</span><span class="op" id="4457664">.</span><span class="ident" id="4457665">FuncDecl</span><span class="op" id="4457673">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457677">tok</span>&nbsp;<span class="op" id="4457681">=</span>&nbsp;<span class="ident" id="4457683">token</span><span class="op" id="4457688">.</span><span class="ident" id="4457689">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457698">return</span><br>
<span class="lineno"></span><span class="op" id="4457705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="4457708">func</span>&nbsp;<span class="op" id="4457713">(</span><span class="ident" id="4457714">p</span>&nbsp;<span class="op" id="4457716">*</span><span class="ident" id="4457717">printer</span><span class="op" id="4457724">)</span>&nbsp;<span class="ident" id="4457726">declList</span><span class="op" id="4457734">(</span><span class="ident" id="4457735">list</span>&nbsp;<span class="op" id="4457740">[</span><span class="op" id="4457741">]</span><span class="ident" id="4457742">ast</span><span class="op" id="4457745">.</span><span class="ident" id="4457746">Decl</span><span class="op" id="4457750">)</span>&nbsp;<span class="op" id="4457752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457755">tok</span>&nbsp;<span class="op" id="4457759">:=</span>&nbsp;<span class="ident" id="4457762">token</span><span class="op" id="4457767">.</span><span class="ident" id="4457768">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457777">for</span>&nbsp;<span class="ident" id="4457781">_</span><span class="op" id="4457782">,</span>&nbsp;<span class="ident" id="4457784">d</span>&nbsp;<span class="op" id="4457786">:=</span>&nbsp;<span class="keyword" id="4457789">range</span>&nbsp;<span class="ident" id="4457795">list</span>&nbsp;<span class="op" id="4457800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457804">prev</span>&nbsp;<span class="op" id="4457809">:=</span>&nbsp;<span class="ident" id="4457812">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457818">tok</span>&nbsp;<span class="op" id="4457822">=</span>&nbsp;<span class="ident" id="4457824">declToken</span><span class="op" id="4457833">(</span><span class="ident" id="4457834">d</span><span class="op" id="4457835">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457839">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457904">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457971">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458028">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458094">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458163">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458230">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458287">if</span>&nbsp;<span class="builtinfunc" id="4458290">len</span><span class="op" id="4458293">(</span><span class="ident" id="4458294">p</span><span class="op" id="4458295">.</span><span class="ident" id="4458296">output</span><span class="op" id="4458302">)</span>&nbsp;<span class="op" id="4458304">&gt;</span>&nbsp;<span class="num" id="4458306">0</span>&nbsp;<span class="op" id="4458308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458313">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4458386">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458443">min</span>&nbsp;<span class="op" id="4458447">:=</span>&nbsp;<span class="num" id="4458450">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458455">if</span>&nbsp;<span class="ident" id="4458458">prev</span>&nbsp;<span class="op" id="4458463">!=</span>&nbsp;<span class="ident" id="4458466">tok</span>&nbsp;<span class="op" id="4458470">||</span>&nbsp;<span class="ident" id="4458473">getDoc</span><span class="op" id="4458479">(</span><span class="ident" id="4458480">d</span><span class="op" id="4458481">)</span>&nbsp;<span class="op" id="4458483">!=</span>&nbsp;<span class="ident" id="4458486">nil</span>&nbsp;<span class="op" id="4458490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458496">min</span>&nbsp;<span class="op" id="4458500">=</span>&nbsp;<span class="num" id="4458502">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458512">p</span><span class="op" id="4458513">.</span><span class="ident" id="4458514">linebreak</span><span class="op" id="4458523">(</span><span class="ident" id="4458524">p</span><span class="op" id="4458525">.</span><span class="ident" id="4458526">lineFor</span><span class="op" id="4458533">(</span><span class="ident" id="4458534">d</span><span class="op" id="4458535">.</span><span class="ident" id="4458536">Pos</span><span class="op" id="4458539">(</span><span class="op" id="4458540">)</span><span class="op" id="4458541">)</span><span class="op" id="4458542">,</span>&nbsp;<span class="ident" id="4458544">min</span><span class="op" id="4458547">,</span>&nbsp;<span class="ident" id="4458549">ignore</span><span class="op" id="4458555">,</span>&nbsp;<span class="builtintype" id="4458557">false</span><span class="op" id="4458562">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458570">p</span><span class="op" id="4458571">.</span><span class="ident" id="4458572">decl</span><span class="op" id="4458576">(</span><span class="ident" id="4458577">d</span><span class="op" id="4458578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458581">}</span><br>
<span class="lineno"></span><span class="op" id="4458583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="4458586">func</span>&nbsp;<span class="op" id="4458591">(</span><span class="ident" id="4458592">p</span>&nbsp;<span class="op" id="4458594">*</span><span class="ident" id="4458595">printer</span><span class="op" id="4458602">)</span>&nbsp;<span class="ident" id="4458604">file</span><span class="op" id="4458608">(</span><span class="ident" id="4458609">src</span>&nbsp;<span class="op" id="4458613">*</span><span class="ident" id="4458614">ast</span><span class="op" id="4458617">.</span><span class="ident" id="4458618">File</span><span class="op" id="4458622">)</span>&nbsp;<span class="op" id="4458624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458627">p</span><span class="op" id="4458628">.</span><span class="ident" id="4458629">setComment</span><span class="op" id="4458639">(</span><span class="ident" id="4458640">src</span><span class="op" id="4458643">.</span><span class="ident" id="4458644">Doc</span><span class="op" id="4458647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458650">p</span><span class="op" id="4458651">.</span><span class="builtinfunc" id="4458652">print</span><span class="op" id="4458657">(</span><span class="ident" id="4458658">src</span><span class="op" id="4458661">.</span><span class="ident" id="4458662">Pos</span><span class="op" id="4458665">(</span><span class="op" id="4458666">)</span><span class="op" id="4458667">,</span>&nbsp;<span class="ident" id="4458669">token</span><span class="op" id="4458674">.</span><span class="ident" id="4458675">PACKAGE</span><span class="op" id="4458682">,</span>&nbsp;<span class="ident" id="4458684">blank</span><span class="op" id="4458689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458692">p</span><span class="op" id="4458693">.</span><span class="ident" id="4458694">expr</span><span class="op" id="4458698">(</span><span class="ident" id="4458699">src</span><span class="op" id="4458702">.</span><span class="ident" id="4458703">Name</span><span class="op" id="4458707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458710">p</span><span class="op" id="4458711">.</span><span class="ident" id="4458712">declList</span><span class="op" id="4458720">(</span><span class="ident" id="4458721">src</span><span class="op" id="4458724">.</span><span class="ident" id="4458725">Decls</span><span class="op" id="4458730">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458733">p</span><span class="op" id="4458734">.</span><span class="builtinfunc" id="4458735">print</span><span class="op" id="4458740">(</span><span class="ident" id="4458741">newline</span><span class="op" id="4458748">)</span><br>
<span class="lineno"></span><span class="op" id="4458750">}</span>
</div>
</body>
</html>
