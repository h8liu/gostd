<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2062606">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2062661">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2062715">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2062766">package</span>&nbsp;<span class="ident" id="2062774">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2062780">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2062852">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2062906">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2062958">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2063013">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2063043">//</span><br>
<span class="lineno"></span><span class="comment" id="2063046">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2063102">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2063171">//</span><br>
<span class="lineno"></span><span class="comment" id="2063174">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2063233">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2063289">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2063346">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2063363">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2063419">//</span><br>
<span class="lineno">25</span><span class="comment" id="2063422">//</span><br>
<span class="lineno"></span><span class="comment" id="2063425">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2063449">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2063474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2063505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2063537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2063580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2063611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2063642">//</span><br>
<span class="lineno"></span><span class="comment" id="2063645">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2063672">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2063686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2063720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2063759">//</span><br>
<span class="lineno"></span><span class="comment" id="2063762">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2063773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2063808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2063844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2063910">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2063976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2064040">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2064082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2064138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2064188">//</span><br>
<span class="lineno"></span><span class="comment" id="2064191">//</span><br>
<span class="lineno">50</span><span class="comment" id="2064194">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2064246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2064320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2064340">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2064407">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2064474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2064542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2064612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2064673">//</span><br>
<span class="lineno"></span><span class="comment" id="2064676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2064735">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2064792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2064847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2064903">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2064959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2065011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2065078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2065124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2065173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2065238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2065301">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2065361">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2065378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2065421">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2065464">//</span><br>
<span class="lineno">75</span><span class="comment" id="2065467">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2065513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2065568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2065606">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2065623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2065678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2065721">//</span><br>
<span class="lineno"></span><span class="comment" id="2065724">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2065756">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2065820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2065891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2065952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2066017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2066064">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2066081">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2066136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2066179">//</span><br>
<span class="lineno"></span><span class="comment" id="2066182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2066197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2066259">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2066304">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2066346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2066385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2066448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2066463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2066521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2066557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2066617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2066654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2066710">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2066773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2066828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2066874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2066920">//</span><br>
<span class="lineno"></span><span class="comment" id="2066923">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2066952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2067015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2067078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2067120">//</span><br>
<span class="lineno"></span><span class="comment" id="2067123">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2067148">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2067208">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2067268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2067306">const</span>&nbsp;<span class="op" id="2067312">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067315">erx</span>&nbsp;<span class="op" id="2067319">=</span>&nbsp;<span class="num" id="2067321">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2067348">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2067371">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067430">efx</span>&nbsp;&nbsp;<span class="op" id="2067435">=</span>&nbsp;<span class="num" id="2067437">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2067465">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067488">efx8</span>&nbsp;<span class="op" id="2067493">=</span>&nbsp;<span class="num" id="2067495">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2067523">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067546">pp0</span>&nbsp;&nbsp;<span class="op" id="2067551">=</span>&nbsp;<span class="num" id="2067553">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2067581">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067604">pp1</span>&nbsp;&nbsp;<span class="op" id="2067609">=</span>&nbsp;<span class="op" id="2067611">-</span><span class="num" id="2067612">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2067639">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067662">pp2</span>&nbsp;&nbsp;<span class="op" id="2067667">=</span>&nbsp;<span class="op" id="2067669">-</span><span class="num" id="2067670">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2067697">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067720">pp3</span>&nbsp;&nbsp;<span class="op" id="2067725">=</span>&nbsp;<span class="op" id="2067727">-</span><span class="num" id="2067728">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2067755">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067778">pp4</span>&nbsp;&nbsp;<span class="op" id="2067783">=</span>&nbsp;<span class="op" id="2067785">-</span><span class="num" id="2067786">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2067813">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067836">qq1</span>&nbsp;&nbsp;<span class="op" id="2067841">=</span>&nbsp;<span class="num" id="2067843">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2067871">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067894">qq2</span>&nbsp;&nbsp;<span class="op" id="2067899">=</span>&nbsp;<span class="num" id="2067901">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2067929">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2067952">qq3</span>&nbsp;&nbsp;<span class="op" id="2067957">=</span>&nbsp;<span class="num" id="2067959">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2067987">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068010">qq4</span>&nbsp;&nbsp;<span class="op" id="2068015">=</span>&nbsp;<span class="num" id="2068017">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2068045">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068068">qq5</span>&nbsp;&nbsp;<span class="op" id="2068073">=</span>&nbsp;<span class="op" id="2068075">-</span><span class="num" id="2068076">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2068103">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2068126">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068189">pa0</span>&nbsp;<span class="op" id="2068193">=</span>&nbsp;<span class="op" id="2068195">-</span><span class="num" id="2068196">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2068223">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068246">pa1</span>&nbsp;<span class="op" id="2068250">=</span>&nbsp;<span class="num" id="2068252">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2068280">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068303">pa2</span>&nbsp;<span class="op" id="2068307">=</span>&nbsp;<span class="op" id="2068309">-</span><span class="num" id="2068310">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2068337">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068360">pa3</span>&nbsp;<span class="op" id="2068364">=</span>&nbsp;<span class="num" id="2068366">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2068394">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068417">pa4</span>&nbsp;<span class="op" id="2068421">=</span>&nbsp;<span class="op" id="2068423">-</span><span class="num" id="2068424">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2068451">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068474">pa5</span>&nbsp;<span class="op" id="2068478">=</span>&nbsp;<span class="num" id="2068480">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2068508">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068531">pa6</span>&nbsp;<span class="op" id="2068535">=</span>&nbsp;<span class="op" id="2068537">-</span><span class="num" id="2068538">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2068565">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068588">qa1</span>&nbsp;<span class="op" id="2068592">=</span>&nbsp;<span class="num" id="2068594">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2068622">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068645">qa2</span>&nbsp;<span class="op" id="2068649">=</span>&nbsp;<span class="num" id="2068651">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2068679">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068702">qa3</span>&nbsp;<span class="op" id="2068706">=</span>&nbsp;<span class="num" id="2068708">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2068736">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068759">qa4</span>&nbsp;<span class="op" id="2068763">=</span>&nbsp;<span class="num" id="2068765">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2068793">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068816">qa5</span>&nbsp;<span class="op" id="2068820">=</span>&nbsp;<span class="num" id="2068822">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2068850">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068873">qa6</span>&nbsp;<span class="op" id="2068877">=</span>&nbsp;<span class="num" id="2068879">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2068907">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2068930">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2068992">ra0</span>&nbsp;<span class="op" id="2068996">=</span>&nbsp;<span class="op" id="2068998">-</span><span class="num" id="2068999">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2069026">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069049">ra1</span>&nbsp;<span class="op" id="2069053">=</span>&nbsp;<span class="op" id="2069055">-</span><span class="num" id="2069056">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2069083">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069106">ra2</span>&nbsp;<span class="op" id="2069110">=</span>&nbsp;<span class="op" id="2069112">-</span><span class="num" id="2069113">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2069140">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069163">ra3</span>&nbsp;<span class="op" id="2069167">=</span>&nbsp;<span class="op" id="2069169">-</span><span class="num" id="2069170">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2069197">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069220">ra4</span>&nbsp;<span class="op" id="2069224">=</span>&nbsp;<span class="op" id="2069226">-</span><span class="num" id="2069227">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2069254">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069277">ra5</span>&nbsp;<span class="op" id="2069281">=</span>&nbsp;<span class="op" id="2069283">-</span><span class="num" id="2069284">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2069311">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069334">ra6</span>&nbsp;<span class="op" id="2069338">=</span>&nbsp;<span class="op" id="2069340">-</span><span class="num" id="2069341">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2069368">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069391">ra7</span>&nbsp;<span class="op" id="2069395">=</span>&nbsp;<span class="op" id="2069397">-</span><span class="num" id="2069398">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2069425">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069448">sa1</span>&nbsp;<span class="op" id="2069452">=</span>&nbsp;<span class="num" id="2069454">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2069482">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069505">sa2</span>&nbsp;<span class="op" id="2069509">=</span>&nbsp;<span class="num" id="2069511">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2069539">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069562">sa3</span>&nbsp;<span class="op" id="2069566">=</span>&nbsp;<span class="num" id="2069568">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2069596">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069619">sa4</span>&nbsp;<span class="op" id="2069623">=</span>&nbsp;<span class="num" id="2069625">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2069653">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069676">sa5</span>&nbsp;<span class="op" id="2069680">=</span>&nbsp;<span class="num" id="2069682">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2069710">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069733">sa6</span>&nbsp;<span class="op" id="2069737">=</span>&nbsp;<span class="num" id="2069739">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2069767">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069790">sa7</span>&nbsp;<span class="op" id="2069794">=</span>&nbsp;<span class="num" id="2069796">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2069824">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069847">sa8</span>&nbsp;<span class="op" id="2069851">=</span>&nbsp;<span class="op" id="2069853">-</span><span class="num" id="2069854">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2069881">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2069904">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2069963">rb0</span>&nbsp;<span class="op" id="2069967">=</span>&nbsp;<span class="op" id="2069969">-</span><span class="num" id="2069970">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2069997">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070020">rb1</span>&nbsp;<span class="op" id="2070024">=</span>&nbsp;<span class="op" id="2070026">-</span><span class="num" id="2070027">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2070054">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070077">rb2</span>&nbsp;<span class="op" id="2070081">=</span>&nbsp;<span class="op" id="2070083">-</span><span class="num" id="2070084">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2070111">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070134">rb3</span>&nbsp;<span class="op" id="2070138">=</span>&nbsp;<span class="op" id="2070140">-</span><span class="num" id="2070141">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2070168">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070191">rb4</span>&nbsp;<span class="op" id="2070195">=</span>&nbsp;<span class="op" id="2070197">-</span><span class="num" id="2070198">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2070225">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070248">rb5</span>&nbsp;<span class="op" id="2070252">=</span>&nbsp;<span class="op" id="2070254">-</span><span class="num" id="2070255">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2070282">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070305">rb6</span>&nbsp;<span class="op" id="2070309">=</span>&nbsp;<span class="op" id="2070311">-</span><span class="num" id="2070312">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2070339">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070362">sb1</span>&nbsp;<span class="op" id="2070366">=</span>&nbsp;<span class="num" id="2070368">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2070396">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070419">sb2</span>&nbsp;<span class="op" id="2070423">=</span>&nbsp;<span class="num" id="2070425">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2070453">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070476">sb3</span>&nbsp;<span class="op" id="2070480">=</span>&nbsp;<span class="num" id="2070482">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2070510">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070533">sb4</span>&nbsp;<span class="op" id="2070537">=</span>&nbsp;<span class="num" id="2070539">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2070567">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070590">sb5</span>&nbsp;<span class="op" id="2070594">=</span>&nbsp;<span class="num" id="2070596">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2070624">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070647">sb6</span>&nbsp;<span class="op" id="2070651">=</span>&nbsp;<span class="num" id="2070653">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2070681">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070704">sb7</span>&nbsp;<span class="op" id="2070708">=</span>&nbsp;<span class="op" id="2070710">-</span><span class="num" id="2070711">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2070738">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2070760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2070763">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2070803">//</span><br>
<span class="lineno"></span><span class="comment" id="2070806">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2070828">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2070845">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2070863">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2070881">func</span>&nbsp;<span class="ident" id="2070886">Erf</span><span class="op" id="2070889">(</span><span class="ident" id="2070890">x</span>&nbsp;<span class="builtintype" id="2070892">float64</span><span class="op" id="2070899">)</span>&nbsp;<span class="builtintype" id="2070901">float64</span>&nbsp;<span class="op" id="2070909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2070912">const</span>&nbsp;<span class="op" id="2070918">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070922">VeryTiny</span>&nbsp;<span class="op" id="2070931">=</span>&nbsp;<span class="num" id="2070933">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2070956">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2070980">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2070989">=</span>&nbsp;<span class="num" id="2070991">1.0</span>&nbsp;<span class="op" id="2070995">/</span>&nbsp;<span class="op" id="2070997">(</span><span class="num" id="2070998">1</span>&nbsp;<span class="op" id="2071000">&lt;&lt;</span>&nbsp;<span class="num" id="2071003">28</span><span class="op" id="2071005">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2071014">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2071028">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071046">switch</span>&nbsp;<span class="op" id="2071053">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071056">case</span>&nbsp;<span class="ident" id="2071061">IsNaN</span><span class="op" id="2071066">(</span><span class="ident" id="2071067">x</span><span class="op" id="2071068">)</span><span class="op" id="2071069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071073">return</span>&nbsp;<span class="ident" id="2071080">NaN</span><span class="op" id="2071083">(</span><span class="op" id="2071084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071087">case</span>&nbsp;<span class="ident" id="2071092">IsInf</span><span class="op" id="2071097">(</span><span class="ident" id="2071098">x</span><span class="op" id="2071099">,</span>&nbsp;<span class="num" id="2071101">1</span><span class="op" id="2071102">)</span><span class="op" id="2071103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071107">return</span>&nbsp;<span class="num" id="2071114">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071117">case</span>&nbsp;<span class="ident" id="2071122">IsInf</span><span class="op" id="2071127">(</span><span class="ident" id="2071128">x</span><span class="op" id="2071129">,</span>&nbsp;<span class="op" id="2071131">-</span><span class="num" id="2071132">1</span><span class="op" id="2071133">)</span><span class="op" id="2071134">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071138">return</span>&nbsp;<span class="op" id="2071145">-</span><span class="num" id="2071146">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071152">sign</span>&nbsp;<span class="op" id="2071157">:=</span>&nbsp;<span class="builtintype" id="2071160">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071167">if</span>&nbsp;<span class="ident" id="2071170">x</span>&nbsp;<span class="op" id="2071172">&lt;</span>&nbsp;<span class="num" id="2071174">0</span>&nbsp;<span class="op" id="2071176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071180">x</span>&nbsp;<span class="op" id="2071182">=</span>&nbsp;<span class="op" id="2071184">-</span><span class="ident" id="2071185">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071189">sign</span>&nbsp;<span class="op" id="2071194">=</span>&nbsp;<span class="builtintype" id="2071196">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071205">if</span>&nbsp;<span class="ident" id="2071208">x</span>&nbsp;<span class="op" id="2071210">&lt;</span>&nbsp;<span class="num" id="2071212">0.84375</span>&nbsp;<span class="op" id="2071220">{</span>&nbsp;<span class="comment" id="2071222">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071241">var</span>&nbsp;<span class="ident" id="2071245">temp</span>&nbsp;<span class="builtintype" id="2071250">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071260">if</span>&nbsp;<span class="ident" id="2071263">x</span>&nbsp;<span class="op" id="2071265">&lt;</span>&nbsp;<span class="ident" id="2071267">Small</span>&nbsp;<span class="op" id="2071273">{</span>&nbsp;<span class="comment" id="2071275">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071294">if</span>&nbsp;<span class="ident" id="2071297">x</span>&nbsp;<span class="op" id="2071299">&lt;</span>&nbsp;<span class="ident" id="2071301">VeryTiny</span>&nbsp;<span class="op" id="2071310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071316">temp</span>&nbsp;<span class="op" id="2071321">=</span>&nbsp;<span class="num" id="2071323">0.125</span>&nbsp;<span class="op" id="2071329">*</span>&nbsp;<span class="op" id="2071331">(</span><span class="num" id="2071332">8.0</span><span class="op" id="2071335">*</span><span class="ident" id="2071336">x</span>&nbsp;<span class="op" id="2071338">+</span>&nbsp;<span class="ident" id="2071340">efx8</span><span class="op" id="2071344">*</span><span class="ident" id="2071345">x</span><span class="op" id="2071346">)</span>&nbsp;<span class="comment" id="2071348">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071370">}</span>&nbsp;<span class="keyword" id="2071372">else</span>&nbsp;<span class="op" id="2071377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071383">temp</span>&nbsp;<span class="op" id="2071388">=</span>&nbsp;<span class="ident" id="2071390">x</span>&nbsp;<span class="op" id="2071392">+</span>&nbsp;<span class="ident" id="2071394">efx</span><span class="op" id="2071397">*</span><span class="ident" id="2071398">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071403">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071407">}</span>&nbsp;<span class="keyword" id="2071409">else</span>&nbsp;<span class="op" id="2071414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071419">z</span>&nbsp;<span class="op" id="2071421">:=</span>&nbsp;<span class="ident" id="2071424">x</span>&nbsp;<span class="op" id="2071426">*</span>&nbsp;<span class="ident" id="2071428">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071433">r</span>&nbsp;<span class="op" id="2071435">:=</span>&nbsp;<span class="ident" id="2071438">pp0</span>&nbsp;<span class="op" id="2071442">+</span>&nbsp;<span class="ident" id="2071444">z</span><span class="op" id="2071445">*</span><span class="op" id="2071446">(</span><span class="ident" id="2071447">pp1</span><span class="op" id="2071450">+</span><span class="ident" id="2071451">z</span><span class="op" id="2071452">*</span><span class="op" id="2071453">(</span><span class="ident" id="2071454">pp2</span><span class="op" id="2071457">+</span><span class="ident" id="2071458">z</span><span class="op" id="2071459">*</span><span class="op" id="2071460">(</span><span class="ident" id="2071461">pp3</span><span class="op" id="2071464">+</span><span class="ident" id="2071465">z</span><span class="op" id="2071466">*</span><span class="ident" id="2071467">pp4</span><span class="op" id="2071470">)</span><span class="op" id="2071471">)</span><span class="op" id="2071472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071477">s</span>&nbsp;<span class="op" id="2071479">:=</span>&nbsp;<span class="num" id="2071482">1</span>&nbsp;<span class="op" id="2071484">+</span>&nbsp;<span class="ident" id="2071486">z</span><span class="op" id="2071487">*</span><span class="op" id="2071488">(</span><span class="ident" id="2071489">qq1</span><span class="op" id="2071492">+</span><span class="ident" id="2071493">z</span><span class="op" id="2071494">*</span><span class="op" id="2071495">(</span><span class="ident" id="2071496">qq2</span><span class="op" id="2071499">+</span><span class="ident" id="2071500">z</span><span class="op" id="2071501">*</span><span class="op" id="2071502">(</span><span class="ident" id="2071503">qq3</span><span class="op" id="2071506">+</span><span class="ident" id="2071507">z</span><span class="op" id="2071508">*</span><span class="op" id="2071509">(</span><span class="ident" id="2071510">qq4</span><span class="op" id="2071513">+</span><span class="ident" id="2071514">z</span><span class="op" id="2071515">*</span><span class="ident" id="2071516">qq5</span><span class="op" id="2071519">)</span><span class="op" id="2071520">)</span><span class="op" id="2071521">)</span><span class="op" id="2071522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071527">y</span>&nbsp;<span class="op" id="2071529">:=</span>&nbsp;<span class="ident" id="2071532">r</span>&nbsp;<span class="op" id="2071534">/</span>&nbsp;<span class="ident" id="2071536">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071541">temp</span>&nbsp;<span class="op" id="2071546">=</span>&nbsp;<span class="ident" id="2071548">x</span>&nbsp;<span class="op" id="2071550">+</span>&nbsp;<span class="ident" id="2071552">x</span><span class="op" id="2071553">*</span><span class="ident" id="2071554">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071562">if</span>&nbsp;<span class="ident" id="2071565">sign</span>&nbsp;<span class="op" id="2071570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071575">return</span>&nbsp;<span class="op" id="2071582">-</span><span class="ident" id="2071583">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071590">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071594">return</span>&nbsp;<span class="ident" id="2071601">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071610">if</span>&nbsp;<span class="ident" id="2071613">x</span>&nbsp;<span class="op" id="2071615">&lt;</span>&nbsp;<span class="num" id="2071617">1.25</span>&nbsp;<span class="op" id="2071622">{</span>&nbsp;<span class="comment" id="2071624">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071651">s</span>&nbsp;<span class="op" id="2071653">:=</span>&nbsp;<span class="ident" id="2071656">x</span>&nbsp;<span class="op" id="2071658">-</span>&nbsp;<span class="num" id="2071660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071664">P</span>&nbsp;<span class="op" id="2071666">:=</span>&nbsp;<span class="ident" id="2071669">pa0</span>&nbsp;<span class="op" id="2071673">+</span>&nbsp;<span class="ident" id="2071675">s</span><span class="op" id="2071676">*</span><span class="op" id="2071677">(</span><span class="ident" id="2071678">pa1</span><span class="op" id="2071681">+</span><span class="ident" id="2071682">s</span><span class="op" id="2071683">*</span><span class="op" id="2071684">(</span><span class="ident" id="2071685">pa2</span><span class="op" id="2071688">+</span><span class="ident" id="2071689">s</span><span class="op" id="2071690">*</span><span class="op" id="2071691">(</span><span class="ident" id="2071692">pa3</span><span class="op" id="2071695">+</span><span class="ident" id="2071696">s</span><span class="op" id="2071697">*</span><span class="op" id="2071698">(</span><span class="ident" id="2071699">pa4</span><span class="op" id="2071702">+</span><span class="ident" id="2071703">s</span><span class="op" id="2071704">*</span><span class="op" id="2071705">(</span><span class="ident" id="2071706">pa5</span><span class="op" id="2071709">+</span><span class="ident" id="2071710">s</span><span class="op" id="2071711">*</span><span class="ident" id="2071712">pa6</span><span class="op" id="2071715">)</span><span class="op" id="2071716">)</span><span class="op" id="2071717">)</span><span class="op" id="2071718">)</span><span class="op" id="2071719">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071723">Q</span>&nbsp;<span class="op" id="2071725">:=</span>&nbsp;<span class="num" id="2071728">1</span>&nbsp;<span class="op" id="2071730">+</span>&nbsp;<span class="ident" id="2071732">s</span><span class="op" id="2071733">*</span><span class="op" id="2071734">(</span><span class="ident" id="2071735">qa1</span><span class="op" id="2071738">+</span><span class="ident" id="2071739">s</span><span class="op" id="2071740">*</span><span class="op" id="2071741">(</span><span class="ident" id="2071742">qa2</span><span class="op" id="2071745">+</span><span class="ident" id="2071746">s</span><span class="op" id="2071747">*</span><span class="op" id="2071748">(</span><span class="ident" id="2071749">qa3</span><span class="op" id="2071752">+</span><span class="ident" id="2071753">s</span><span class="op" id="2071754">*</span><span class="op" id="2071755">(</span><span class="ident" id="2071756">qa4</span><span class="op" id="2071759">+</span><span class="ident" id="2071760">s</span><span class="op" id="2071761">*</span><span class="op" id="2071762">(</span><span class="ident" id="2071763">qa5</span><span class="op" id="2071766">+</span><span class="ident" id="2071767">s</span><span class="op" id="2071768">*</span><span class="ident" id="2071769">qa6</span><span class="op" id="2071772">)</span><span class="op" id="2071773">)</span><span class="op" id="2071774">)</span><span class="op" id="2071775">)</span><span class="op" id="2071776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071780">if</span>&nbsp;<span class="ident" id="2071783">sign</span>&nbsp;<span class="op" id="2071788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071793">return</span>&nbsp;<span class="op" id="2071800">-</span><span class="ident" id="2071801">erx</span>&nbsp;<span class="op" id="2071805">-</span>&nbsp;<span class="ident" id="2071807">P</span><span class="op" id="2071808">/</span><span class="ident" id="2071809">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071817">return</span>&nbsp;<span class="ident" id="2071824">erx</span>&nbsp;<span class="op" id="2071828">+</span>&nbsp;<span class="ident" id="2071830">P</span><span class="op" id="2071831">/</span><span class="ident" id="2071832">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071838">if</span>&nbsp;<span class="ident" id="2071841">x</span>&nbsp;<span class="op" id="2071843">&gt;=</span>&nbsp;<span class="num" id="2071846">6</span>&nbsp;<span class="op" id="2071848">{</span>&nbsp;<span class="comment" id="2071850">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071870">if</span>&nbsp;<span class="ident" id="2071873">sign</span>&nbsp;<span class="op" id="2071878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071883">return</span>&nbsp;<span class="op" id="2071890">-</span><span class="num" id="2071891">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071895">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071899">return</span>&nbsp;<span class="num" id="2071906">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2071909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071912">s</span>&nbsp;<span class="op" id="2071914">:=</span>&nbsp;<span class="num" id="2071917">1</span>&nbsp;<span class="op" id="2071919">/</span>&nbsp;<span class="op" id="2071921">(</span><span class="ident" id="2071922">x</span>&nbsp;<span class="op" id="2071924">*</span>&nbsp;<span class="ident" id="2071926">x</span><span class="op" id="2071927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071930">var</span>&nbsp;<span class="ident" id="2071934">R</span><span class="op" id="2071935">,</span>&nbsp;<span class="ident" id="2071937">S</span>&nbsp;<span class="builtintype" id="2071939">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2071948">if</span>&nbsp;<span class="ident" id="2071951">x</span>&nbsp;<span class="op" id="2071953">&lt;</span>&nbsp;<span class="num" id="2071955">1</span><span class="op" id="2071956">/</span><span class="num" id="2071957">0.35</span>&nbsp;<span class="op" id="2071962">{</span>&nbsp;<span class="comment" id="2071964">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2071996">R</span>&nbsp;<span class="op" id="2071998">=</span>&nbsp;<span class="ident" id="2072000">ra0</span>&nbsp;<span class="op" id="2072004">+</span>&nbsp;<span class="ident" id="2072006">s</span><span class="op" id="2072007">*</span><span class="op" id="2072008">(</span><span class="ident" id="2072009">ra1</span><span class="op" id="2072012">+</span><span class="ident" id="2072013">s</span><span class="op" id="2072014">*</span><span class="op" id="2072015">(</span><span class="ident" id="2072016">ra2</span><span class="op" id="2072019">+</span><span class="ident" id="2072020">s</span><span class="op" id="2072021">*</span><span class="op" id="2072022">(</span><span class="ident" id="2072023">ra3</span><span class="op" id="2072026">+</span><span class="ident" id="2072027">s</span><span class="op" id="2072028">*</span><span class="op" id="2072029">(</span><span class="ident" id="2072030">ra4</span><span class="op" id="2072033">+</span><span class="ident" id="2072034">s</span><span class="op" id="2072035">*</span><span class="op" id="2072036">(</span><span class="ident" id="2072037">ra5</span><span class="op" id="2072040">+</span><span class="ident" id="2072041">s</span><span class="op" id="2072042">*</span><span class="op" id="2072043">(</span><span class="ident" id="2072044">ra6</span><span class="op" id="2072047">+</span><span class="ident" id="2072048">s</span><span class="op" id="2072049">*</span><span class="ident" id="2072050">ra7</span><span class="op" id="2072053">)</span><span class="op" id="2072054">)</span><span class="op" id="2072055">)</span><span class="op" id="2072056">)</span><span class="op" id="2072057">)</span><span class="op" id="2072058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072062">S</span>&nbsp;<span class="op" id="2072064">=</span>&nbsp;<span class="num" id="2072066">1</span>&nbsp;<span class="op" id="2072068">+</span>&nbsp;<span class="ident" id="2072070">s</span><span class="op" id="2072071">*</span><span class="op" id="2072072">(</span><span class="ident" id="2072073">sa1</span><span class="op" id="2072076">+</span><span class="ident" id="2072077">s</span><span class="op" id="2072078">*</span><span class="op" id="2072079">(</span><span class="ident" id="2072080">sa2</span><span class="op" id="2072083">+</span><span class="ident" id="2072084">s</span><span class="op" id="2072085">*</span><span class="op" id="2072086">(</span><span class="ident" id="2072087">sa3</span><span class="op" id="2072090">+</span><span class="ident" id="2072091">s</span><span class="op" id="2072092">*</span><span class="op" id="2072093">(</span><span class="ident" id="2072094">sa4</span><span class="op" id="2072097">+</span><span class="ident" id="2072098">s</span><span class="op" id="2072099">*</span><span class="op" id="2072100">(</span><span class="ident" id="2072101">sa5</span><span class="op" id="2072104">+</span><span class="ident" id="2072105">s</span><span class="op" id="2072106">*</span><span class="op" id="2072107">(</span><span class="ident" id="2072108">sa6</span><span class="op" id="2072111">+</span><span class="ident" id="2072112">s</span><span class="op" id="2072113">*</span><span class="op" id="2072114">(</span><span class="ident" id="2072115">sa7</span><span class="op" id="2072118">+</span><span class="ident" id="2072119">s</span><span class="op" id="2072120">*</span><span class="ident" id="2072121">sa8</span><span class="op" id="2072124">)</span><span class="op" id="2072125">)</span><span class="op" id="2072126">)</span><span class="op" id="2072127">)</span><span class="op" id="2072128">)</span><span class="op" id="2072129">)</span><span class="op" id="2072130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072133">}</span>&nbsp;<span class="keyword" id="2072135">else</span>&nbsp;<span class="op" id="2072140">{</span>&nbsp;<span class="comment" id="2072142">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072175">R</span>&nbsp;<span class="op" id="2072177">=</span>&nbsp;<span class="ident" id="2072179">rb0</span>&nbsp;<span class="op" id="2072183">+</span>&nbsp;<span class="ident" id="2072185">s</span><span class="op" id="2072186">*</span><span class="op" id="2072187">(</span><span class="ident" id="2072188">rb1</span><span class="op" id="2072191">+</span><span class="ident" id="2072192">s</span><span class="op" id="2072193">*</span><span class="op" id="2072194">(</span><span class="ident" id="2072195">rb2</span><span class="op" id="2072198">+</span><span class="ident" id="2072199">s</span><span class="op" id="2072200">*</span><span class="op" id="2072201">(</span><span class="ident" id="2072202">rb3</span><span class="op" id="2072205">+</span><span class="ident" id="2072206">s</span><span class="op" id="2072207">*</span><span class="op" id="2072208">(</span><span class="ident" id="2072209">rb4</span><span class="op" id="2072212">+</span><span class="ident" id="2072213">s</span><span class="op" id="2072214">*</span><span class="op" id="2072215">(</span><span class="ident" id="2072216">rb5</span><span class="op" id="2072219">+</span><span class="ident" id="2072220">s</span><span class="op" id="2072221">*</span><span class="ident" id="2072222">rb6</span><span class="op" id="2072225">)</span><span class="op" id="2072226">)</span><span class="op" id="2072227">)</span><span class="op" id="2072228">)</span><span class="op" id="2072229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072233">S</span>&nbsp;<span class="op" id="2072235">=</span>&nbsp;<span class="num" id="2072237">1</span>&nbsp;<span class="op" id="2072239">+</span>&nbsp;<span class="ident" id="2072241">s</span><span class="op" id="2072242">*</span><span class="op" id="2072243">(</span><span class="ident" id="2072244">sb1</span><span class="op" id="2072247">+</span><span class="ident" id="2072248">s</span><span class="op" id="2072249">*</span><span class="op" id="2072250">(</span><span class="ident" id="2072251">sb2</span><span class="op" id="2072254">+</span><span class="ident" id="2072255">s</span><span class="op" id="2072256">*</span><span class="op" id="2072257">(</span><span class="ident" id="2072258">sb3</span><span class="op" id="2072261">+</span><span class="ident" id="2072262">s</span><span class="op" id="2072263">*</span><span class="op" id="2072264">(</span><span class="ident" id="2072265">sb4</span><span class="op" id="2072268">+</span><span class="ident" id="2072269">s</span><span class="op" id="2072270">*</span><span class="op" id="2072271">(</span><span class="ident" id="2072272">sb5</span><span class="op" id="2072275">+</span><span class="ident" id="2072276">s</span><span class="op" id="2072277">*</span><span class="op" id="2072278">(</span><span class="ident" id="2072279">sb6</span><span class="op" id="2072282">+</span><span class="ident" id="2072283">s</span><span class="op" id="2072284">*</span><span class="ident" id="2072285">sb7</span><span class="op" id="2072288">)</span><span class="op" id="2072289">)</span><span class="op" id="2072290">)</span><span class="op" id="2072291">)</span><span class="op" id="2072292">)</span><span class="op" id="2072293">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072299">z</span>&nbsp;<span class="op" id="2072301">:=</span>&nbsp;<span class="ident" id="2072304">Float64frombits</span><span class="op" id="2072319">(</span><span class="ident" id="2072320">Float64bits</span><span class="op" id="2072331">(</span><span class="ident" id="2072332">x</span><span class="op" id="2072333">)</span>&nbsp;<span class="op" id="2072335">&amp;</span>&nbsp;<span class="num" id="2072337">0xffffffff00000000</span><span class="op" id="2072355">)</span>&nbsp;<span class="comment" id="2072357">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072396">r</span>&nbsp;<span class="op" id="2072398">:=</span>&nbsp;<span class="ident" id="2072401">Exp</span><span class="op" id="2072404">(</span><span class="op" id="2072405">-</span><span class="ident" id="2072406">z</span><span class="op" id="2072407">*</span><span class="ident" id="2072408">z</span><span class="op" id="2072409">-</span><span class="num" id="2072410">0.5625</span><span class="op" id="2072416">)</span>&nbsp;<span class="op" id="2072418">*</span>&nbsp;<span class="ident" id="2072420">Exp</span><span class="op" id="2072423">(</span><span class="op" id="2072424">(</span><span class="ident" id="2072425">z</span><span class="op" id="2072426">-</span><span class="ident" id="2072427">x</span><span class="op" id="2072428">)</span><span class="op" id="2072429">*</span><span class="op" id="2072430">(</span><span class="ident" id="2072431">z</span><span class="op" id="2072432">+</span><span class="ident" id="2072433">x</span><span class="op" id="2072434">)</span><span class="op" id="2072435">+</span><span class="ident" id="2072436">R</span><span class="op" id="2072437">/</span><span class="ident" id="2072438">S</span><span class="op" id="2072439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072442">if</span>&nbsp;<span class="ident" id="2072445">sign</span>&nbsp;<span class="op" id="2072450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072454">return</span>&nbsp;<span class="ident" id="2072461">r</span><span class="op" id="2072462">/</span><span class="ident" id="2072463">x</span>&nbsp;<span class="op" id="2072465">-</span>&nbsp;<span class="num" id="2072467">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072473">return</span>&nbsp;<span class="num" id="2072480">1</span>&nbsp;<span class="op" id="2072482">-</span>&nbsp;<span class="ident" id="2072484">r</span><span class="op" id="2072485">/</span><span class="ident" id="2072486">x</span><br>
<span class="lineno"></span><span class="op" id="2072488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2072491">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2072546">//</span><br>
<span class="lineno"></span><span class="comment" id="2072549">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2072571">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2072589">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2072607">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2072626">func</span>&nbsp;<span class="ident" id="2072631">Erfc</span><span class="op" id="2072635">(</span><span class="ident" id="2072636">x</span>&nbsp;<span class="builtintype" id="2072638">float64</span><span class="op" id="2072645">)</span>&nbsp;<span class="builtintype" id="2072647">float64</span>&nbsp;<span class="op" id="2072655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072658">const</span>&nbsp;<span class="ident" id="2072664">Tiny</span>&nbsp;<span class="op" id="2072669">=</span>&nbsp;<span class="num" id="2072671">1.0</span>&nbsp;<span class="op" id="2072675">/</span>&nbsp;<span class="op" id="2072677">(</span><span class="num" id="2072678">1</span>&nbsp;<span class="op" id="2072680">&lt;&lt;</span>&nbsp;<span class="num" id="2072683">56</span><span class="op" id="2072685">)</span>&nbsp;<span class="comment" id="2072687">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2072698">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072716">switch</span>&nbsp;<span class="op" id="2072723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072726">case</span>&nbsp;<span class="ident" id="2072731">IsNaN</span><span class="op" id="2072736">(</span><span class="ident" id="2072737">x</span><span class="op" id="2072738">)</span><span class="op" id="2072739">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072743">return</span>&nbsp;<span class="ident" id="2072750">NaN</span><span class="op" id="2072753">(</span><span class="op" id="2072754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072757">case</span>&nbsp;<span class="ident" id="2072762">IsInf</span><span class="op" id="2072767">(</span><span class="ident" id="2072768">x</span><span class="op" id="2072769">,</span>&nbsp;<span class="num" id="2072771">1</span><span class="op" id="2072772">)</span><span class="op" id="2072773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072777">return</span>&nbsp;<span class="num" id="2072784">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072787">case</span>&nbsp;<span class="ident" id="2072792">IsInf</span><span class="op" id="2072797">(</span><span class="ident" id="2072798">x</span><span class="op" id="2072799">,</span>&nbsp;<span class="op" id="2072801">-</span><span class="num" id="2072802">1</span><span class="op" id="2072803">)</span><span class="op" id="2072804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072808">return</span>&nbsp;<span class="num" id="2072815">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072821">sign</span>&nbsp;<span class="op" id="2072826">:=</span>&nbsp;<span class="builtintype" id="2072829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072836">if</span>&nbsp;<span class="ident" id="2072839">x</span>&nbsp;<span class="op" id="2072841">&lt;</span>&nbsp;<span class="num" id="2072843">0</span>&nbsp;<span class="op" id="2072845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072849">x</span>&nbsp;<span class="op" id="2072851">=</span>&nbsp;<span class="op" id="2072853">-</span><span class="ident" id="2072854">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072858">sign</span>&nbsp;<span class="op" id="2072863">=</span>&nbsp;<span class="builtintype" id="2072865">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072874">if</span>&nbsp;<span class="ident" id="2072877">x</span>&nbsp;<span class="op" id="2072879">&lt;</span>&nbsp;<span class="num" id="2072881">0.84375</span>&nbsp;<span class="op" id="2072889">{</span>&nbsp;<span class="comment" id="2072891">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072910">var</span>&nbsp;<span class="ident" id="2072914">temp</span>&nbsp;<span class="builtintype" id="2072919">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2072929">if</span>&nbsp;<span class="ident" id="2072932">x</span>&nbsp;<span class="op" id="2072934">&lt;</span>&nbsp;<span class="ident" id="2072936">Tiny</span>&nbsp;<span class="op" id="2072941">{</span>&nbsp;<span class="comment" id="2072943">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072962">temp</span>&nbsp;<span class="op" id="2072967">=</span>&nbsp;<span class="ident" id="2072969">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2072973">}</span>&nbsp;<span class="keyword" id="2072975">else</span>&nbsp;<span class="op" id="2072980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072985">z</span>&nbsp;<span class="op" id="2072987">:=</span>&nbsp;<span class="ident" id="2072990">x</span>&nbsp;<span class="op" id="2072992">*</span>&nbsp;<span class="ident" id="2072994">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2072999">r</span>&nbsp;<span class="op" id="2073001">:=</span>&nbsp;<span class="ident" id="2073004">pp0</span>&nbsp;<span class="op" id="2073008">+</span>&nbsp;<span class="ident" id="2073010">z</span><span class="op" id="2073011">*</span><span class="op" id="2073012">(</span><span class="ident" id="2073013">pp1</span><span class="op" id="2073016">+</span><span class="ident" id="2073017">z</span><span class="op" id="2073018">*</span><span class="op" id="2073019">(</span><span class="ident" id="2073020">pp2</span><span class="op" id="2073023">+</span><span class="ident" id="2073024">z</span><span class="op" id="2073025">*</span><span class="op" id="2073026">(</span><span class="ident" id="2073027">pp3</span><span class="op" id="2073030">+</span><span class="ident" id="2073031">z</span><span class="op" id="2073032">*</span><span class="ident" id="2073033">pp4</span><span class="op" id="2073036">)</span><span class="op" id="2073037">)</span><span class="op" id="2073038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073043">s</span>&nbsp;<span class="op" id="2073045">:=</span>&nbsp;<span class="num" id="2073048">1</span>&nbsp;<span class="op" id="2073050">+</span>&nbsp;<span class="ident" id="2073052">z</span><span class="op" id="2073053">*</span><span class="op" id="2073054">(</span><span class="ident" id="2073055">qq1</span><span class="op" id="2073058">+</span><span class="ident" id="2073059">z</span><span class="op" id="2073060">*</span><span class="op" id="2073061">(</span><span class="ident" id="2073062">qq2</span><span class="op" id="2073065">+</span><span class="ident" id="2073066">z</span><span class="op" id="2073067">*</span><span class="op" id="2073068">(</span><span class="ident" id="2073069">qq3</span><span class="op" id="2073072">+</span><span class="ident" id="2073073">z</span><span class="op" id="2073074">*</span><span class="op" id="2073075">(</span><span class="ident" id="2073076">qq4</span><span class="op" id="2073079">+</span><span class="ident" id="2073080">z</span><span class="op" id="2073081">*</span><span class="ident" id="2073082">qq5</span><span class="op" id="2073085">)</span><span class="op" id="2073086">)</span><span class="op" id="2073087">)</span><span class="op" id="2073088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073093">y</span>&nbsp;<span class="op" id="2073095">:=</span>&nbsp;<span class="ident" id="2073098">r</span>&nbsp;<span class="op" id="2073100">/</span>&nbsp;<span class="ident" id="2073102">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073107">if</span>&nbsp;<span class="ident" id="2073110">x</span>&nbsp;<span class="op" id="2073112">&lt;</span>&nbsp;<span class="num" id="2073114">0.25</span>&nbsp;<span class="op" id="2073119">{</span>&nbsp;<span class="comment" id="2073121">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073138">temp</span>&nbsp;<span class="op" id="2073143">=</span>&nbsp;<span class="ident" id="2073145">x</span>&nbsp;<span class="op" id="2073147">+</span>&nbsp;<span class="ident" id="2073149">x</span><span class="op" id="2073150">*</span><span class="ident" id="2073151">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073156">}</span>&nbsp;<span class="keyword" id="2073158">else</span>&nbsp;<span class="op" id="2073163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073169">temp</span>&nbsp;<span class="op" id="2073174">=</span>&nbsp;<span class="num" id="2073176">0.5</span>&nbsp;<span class="op" id="2073180">+</span>&nbsp;<span class="op" id="2073182">(</span><span class="ident" id="2073183">x</span><span class="op" id="2073184">*</span><span class="ident" id="2073185">y</span>&nbsp;<span class="op" id="2073187">+</span>&nbsp;<span class="op" id="2073189">(</span><span class="ident" id="2073190">x</span>&nbsp;<span class="op" id="2073192">-</span>&nbsp;<span class="num" id="2073194">0.5</span><span class="op" id="2073197">)</span><span class="op" id="2073198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073203">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073211">if</span>&nbsp;<span class="ident" id="2073214">sign</span>&nbsp;<span class="op" id="2073219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073224">return</span>&nbsp;<span class="num" id="2073231">1</span>&nbsp;<span class="op" id="2073233">+</span>&nbsp;<span class="ident" id="2073235">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073246">return</span>&nbsp;<span class="num" id="2073253">1</span>&nbsp;<span class="op" id="2073255">-</span>&nbsp;<span class="ident" id="2073257">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073266">if</span>&nbsp;<span class="ident" id="2073269">x</span>&nbsp;<span class="op" id="2073271">&lt;</span>&nbsp;<span class="num" id="2073273">1.25</span>&nbsp;<span class="op" id="2073278">{</span>&nbsp;<span class="comment" id="2073280">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073307">s</span>&nbsp;<span class="op" id="2073309">:=</span>&nbsp;<span class="ident" id="2073312">x</span>&nbsp;<span class="op" id="2073314">-</span>&nbsp;<span class="num" id="2073316">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073320">P</span>&nbsp;<span class="op" id="2073322">:=</span>&nbsp;<span class="ident" id="2073325">pa0</span>&nbsp;<span class="op" id="2073329">+</span>&nbsp;<span class="ident" id="2073331">s</span><span class="op" id="2073332">*</span><span class="op" id="2073333">(</span><span class="ident" id="2073334">pa1</span><span class="op" id="2073337">+</span><span class="ident" id="2073338">s</span><span class="op" id="2073339">*</span><span class="op" id="2073340">(</span><span class="ident" id="2073341">pa2</span><span class="op" id="2073344">+</span><span class="ident" id="2073345">s</span><span class="op" id="2073346">*</span><span class="op" id="2073347">(</span><span class="ident" id="2073348">pa3</span><span class="op" id="2073351">+</span><span class="ident" id="2073352">s</span><span class="op" id="2073353">*</span><span class="op" id="2073354">(</span><span class="ident" id="2073355">pa4</span><span class="op" id="2073358">+</span><span class="ident" id="2073359">s</span><span class="op" id="2073360">*</span><span class="op" id="2073361">(</span><span class="ident" id="2073362">pa5</span><span class="op" id="2073365">+</span><span class="ident" id="2073366">s</span><span class="op" id="2073367">*</span><span class="ident" id="2073368">pa6</span><span class="op" id="2073371">)</span><span class="op" id="2073372">)</span><span class="op" id="2073373">)</span><span class="op" id="2073374">)</span><span class="op" id="2073375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073379">Q</span>&nbsp;<span class="op" id="2073381">:=</span>&nbsp;<span class="num" id="2073384">1</span>&nbsp;<span class="op" id="2073386">+</span>&nbsp;<span class="ident" id="2073388">s</span><span class="op" id="2073389">*</span><span class="op" id="2073390">(</span><span class="ident" id="2073391">qa1</span><span class="op" id="2073394">+</span><span class="ident" id="2073395">s</span><span class="op" id="2073396">*</span><span class="op" id="2073397">(</span><span class="ident" id="2073398">qa2</span><span class="op" id="2073401">+</span><span class="ident" id="2073402">s</span><span class="op" id="2073403">*</span><span class="op" id="2073404">(</span><span class="ident" id="2073405">qa3</span><span class="op" id="2073408">+</span><span class="ident" id="2073409">s</span><span class="op" id="2073410">*</span><span class="op" id="2073411">(</span><span class="ident" id="2073412">qa4</span><span class="op" id="2073415">+</span><span class="ident" id="2073416">s</span><span class="op" id="2073417">*</span><span class="op" id="2073418">(</span><span class="ident" id="2073419">qa5</span><span class="op" id="2073422">+</span><span class="ident" id="2073423">s</span><span class="op" id="2073424">*</span><span class="ident" id="2073425">qa6</span><span class="op" id="2073428">)</span><span class="op" id="2073429">)</span><span class="op" id="2073430">)</span><span class="op" id="2073431">)</span><span class="op" id="2073432">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073436">if</span>&nbsp;<span class="ident" id="2073439">sign</span>&nbsp;<span class="op" id="2073444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073449">return</span>&nbsp;<span class="num" id="2073456">1</span>&nbsp;<span class="op" id="2073458">+</span>&nbsp;<span class="ident" id="2073460">erx</span>&nbsp;<span class="op" id="2073464">+</span>&nbsp;<span class="ident" id="2073466">P</span><span class="op" id="2073467">/</span><span class="ident" id="2073468">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073476">return</span>&nbsp;<span class="num" id="2073483">1</span>&nbsp;<span class="op" id="2073485">-</span>&nbsp;<span class="ident" id="2073487">erx</span>&nbsp;<span class="op" id="2073491">-</span>&nbsp;<span class="ident" id="2073493">P</span><span class="op" id="2073494">/</span><span class="ident" id="2073495">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073502">if</span>&nbsp;<span class="ident" id="2073505">x</span>&nbsp;<span class="op" id="2073507">&lt;</span>&nbsp;<span class="num" id="2073509">28</span>&nbsp;<span class="op" id="2073512">{</span>&nbsp;<span class="comment" id="2073514">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073528">s</span>&nbsp;<span class="op" id="2073530">:=</span>&nbsp;<span class="num" id="2073533">1</span>&nbsp;<span class="op" id="2073535">/</span>&nbsp;<span class="op" id="2073537">(</span><span class="ident" id="2073538">x</span>&nbsp;<span class="op" id="2073540">*</span>&nbsp;<span class="ident" id="2073542">x</span><span class="op" id="2073543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073547">var</span>&nbsp;<span class="ident" id="2073551">R</span><span class="op" id="2073552">,</span>&nbsp;<span class="ident" id="2073554">S</span>&nbsp;<span class="builtintype" id="2073556">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073566">if</span>&nbsp;<span class="ident" id="2073569">x</span>&nbsp;<span class="op" id="2073571">&lt;</span>&nbsp;<span class="num" id="2073573">1</span><span class="op" id="2073574">/</span><span class="num" id="2073575">0.35</span>&nbsp;<span class="op" id="2073580">{</span>&nbsp;<span class="comment" id="2073582">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073614">R</span>&nbsp;<span class="op" id="2073616">=</span>&nbsp;<span class="ident" id="2073618">ra0</span>&nbsp;<span class="op" id="2073622">+</span>&nbsp;<span class="ident" id="2073624">s</span><span class="op" id="2073625">*</span><span class="op" id="2073626">(</span><span class="ident" id="2073627">ra1</span><span class="op" id="2073630">+</span><span class="ident" id="2073631">s</span><span class="op" id="2073632">*</span><span class="op" id="2073633">(</span><span class="ident" id="2073634">ra2</span><span class="op" id="2073637">+</span><span class="ident" id="2073638">s</span><span class="op" id="2073639">*</span><span class="op" id="2073640">(</span><span class="ident" id="2073641">ra3</span><span class="op" id="2073644">+</span><span class="ident" id="2073645">s</span><span class="op" id="2073646">*</span><span class="op" id="2073647">(</span><span class="ident" id="2073648">ra4</span><span class="op" id="2073651">+</span><span class="ident" id="2073652">s</span><span class="op" id="2073653">*</span><span class="op" id="2073654">(</span><span class="ident" id="2073655">ra5</span><span class="op" id="2073658">+</span><span class="ident" id="2073659">s</span><span class="op" id="2073660">*</span><span class="op" id="2073661">(</span><span class="ident" id="2073662">ra6</span><span class="op" id="2073665">+</span><span class="ident" id="2073666">s</span><span class="op" id="2073667">*</span><span class="ident" id="2073668">ra7</span><span class="op" id="2073671">)</span><span class="op" id="2073672">)</span><span class="op" id="2073673">)</span><span class="op" id="2073674">)</span><span class="op" id="2073675">)</span><span class="op" id="2073676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073681">S</span>&nbsp;<span class="op" id="2073683">=</span>&nbsp;<span class="num" id="2073685">1</span>&nbsp;<span class="op" id="2073687">+</span>&nbsp;<span class="ident" id="2073689">s</span><span class="op" id="2073690">*</span><span class="op" id="2073691">(</span><span class="ident" id="2073692">sa1</span><span class="op" id="2073695">+</span><span class="ident" id="2073696">s</span><span class="op" id="2073697">*</span><span class="op" id="2073698">(</span><span class="ident" id="2073699">sa2</span><span class="op" id="2073702">+</span><span class="ident" id="2073703">s</span><span class="op" id="2073704">*</span><span class="op" id="2073705">(</span><span class="ident" id="2073706">sa3</span><span class="op" id="2073709">+</span><span class="ident" id="2073710">s</span><span class="op" id="2073711">*</span><span class="op" id="2073712">(</span><span class="ident" id="2073713">sa4</span><span class="op" id="2073716">+</span><span class="ident" id="2073717">s</span><span class="op" id="2073718">*</span><span class="op" id="2073719">(</span><span class="ident" id="2073720">sa5</span><span class="op" id="2073723">+</span><span class="ident" id="2073724">s</span><span class="op" id="2073725">*</span><span class="op" id="2073726">(</span><span class="ident" id="2073727">sa6</span><span class="op" id="2073730">+</span><span class="ident" id="2073731">s</span><span class="op" id="2073732">*</span><span class="op" id="2073733">(</span><span class="ident" id="2073734">sa7</span><span class="op" id="2073737">+</span><span class="ident" id="2073738">s</span><span class="op" id="2073739">*</span><span class="ident" id="2073740">sa8</span><span class="op" id="2073743">)</span><span class="op" id="2073744">)</span><span class="op" id="2073745">)</span><span class="op" id="2073746">)</span><span class="op" id="2073747">)</span><span class="op" id="2073748">)</span><span class="op" id="2073749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073753">}</span>&nbsp;<span class="keyword" id="2073755">else</span>&nbsp;<span class="op" id="2073760">{</span>&nbsp;<span class="comment" id="2073762">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073795">if</span>&nbsp;<span class="ident" id="2073798">sign</span>&nbsp;<span class="op" id="2073803">&amp;&amp;</span>&nbsp;<span class="ident" id="2073806">x</span>&nbsp;<span class="op" id="2073808">&gt;</span>&nbsp;<span class="num" id="2073810">6</span>&nbsp;<span class="op" id="2073812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2073818">return</span>&nbsp;<span class="num" id="2073825">2</span>&nbsp;<span class="comment" id="2073827">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073845">R</span>&nbsp;<span class="op" id="2073847">=</span>&nbsp;<span class="ident" id="2073849">rb0</span>&nbsp;<span class="op" id="2073853">+</span>&nbsp;<span class="ident" id="2073855">s</span><span class="op" id="2073856">*</span><span class="op" id="2073857">(</span><span class="ident" id="2073858">rb1</span><span class="op" id="2073861">+</span><span class="ident" id="2073862">s</span><span class="op" id="2073863">*</span><span class="op" id="2073864">(</span><span class="ident" id="2073865">rb2</span><span class="op" id="2073868">+</span><span class="ident" id="2073869">s</span><span class="op" id="2073870">*</span><span class="op" id="2073871">(</span><span class="ident" id="2073872">rb3</span><span class="op" id="2073875">+</span><span class="ident" id="2073876">s</span><span class="op" id="2073877">*</span><span class="op" id="2073878">(</span><span class="ident" id="2073879">rb4</span><span class="op" id="2073882">+</span><span class="ident" id="2073883">s</span><span class="op" id="2073884">*</span><span class="op" id="2073885">(</span><span class="ident" id="2073886">rb5</span><span class="op" id="2073889">+</span><span class="ident" id="2073890">s</span><span class="op" id="2073891">*</span><span class="ident" id="2073892">rb6</span><span class="op" id="2073895">)</span><span class="op" id="2073896">)</span><span class="op" id="2073897">)</span><span class="op" id="2073898">)</span><span class="op" id="2073899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073904">S</span>&nbsp;<span class="op" id="2073906">=</span>&nbsp;<span class="num" id="2073908">1</span>&nbsp;<span class="op" id="2073910">+</span>&nbsp;<span class="ident" id="2073912">s</span><span class="op" id="2073913">*</span><span class="op" id="2073914">(</span><span class="ident" id="2073915">sb1</span><span class="op" id="2073918">+</span><span class="ident" id="2073919">s</span><span class="op" id="2073920">*</span><span class="op" id="2073921">(</span><span class="ident" id="2073922">sb2</span><span class="op" id="2073925">+</span><span class="ident" id="2073926">s</span><span class="op" id="2073927">*</span><span class="op" id="2073928">(</span><span class="ident" id="2073929">sb3</span><span class="op" id="2073932">+</span><span class="ident" id="2073933">s</span><span class="op" id="2073934">*</span><span class="op" id="2073935">(</span><span class="ident" id="2073936">sb4</span><span class="op" id="2073939">+</span><span class="ident" id="2073940">s</span><span class="op" id="2073941">*</span><span class="op" id="2073942">(</span><span class="ident" id="2073943">sb5</span><span class="op" id="2073946">+</span><span class="ident" id="2073947">s</span><span class="op" id="2073948">*</span><span class="op" id="2073949">(</span><span class="ident" id="2073950">sb6</span><span class="op" id="2073953">+</span><span class="ident" id="2073954">s</span><span class="op" id="2073955">*</span><span class="ident" id="2073956">sb7</span><span class="op" id="2073959">)</span><span class="op" id="2073960">)</span><span class="op" id="2073961">)</span><span class="op" id="2073962">)</span><span class="op" id="2073963">)</span><span class="op" id="2073964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2073968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2073972">z</span>&nbsp;<span class="op" id="2073974">:=</span>&nbsp;<span class="ident" id="2073977">Float64frombits</span><span class="op" id="2073992">(</span><span class="ident" id="2073993">Float64bits</span><span class="op" id="2074004">(</span><span class="ident" id="2074005">x</span><span class="op" id="2074006">)</span>&nbsp;<span class="op" id="2074008">&amp;</span>&nbsp;<span class="num" id="2074010">0xffffffff00000000</span><span class="op" id="2074028">)</span>&nbsp;<span class="comment" id="2074030">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2074070">r</span>&nbsp;<span class="op" id="2074072">:=</span>&nbsp;<span class="ident" id="2074075">Exp</span><span class="op" id="2074078">(</span><span class="op" id="2074079">-</span><span class="ident" id="2074080">z</span><span class="op" id="2074081">*</span><span class="ident" id="2074082">z</span><span class="op" id="2074083">-</span><span class="num" id="2074084">0.5625</span><span class="op" id="2074090">)</span>&nbsp;<span class="op" id="2074092">*</span>&nbsp;<span class="ident" id="2074094">Exp</span><span class="op" id="2074097">(</span><span class="op" id="2074098">(</span><span class="ident" id="2074099">z</span><span class="op" id="2074100">-</span><span class="ident" id="2074101">x</span><span class="op" id="2074102">)</span><span class="op" id="2074103">*</span><span class="op" id="2074104">(</span><span class="ident" id="2074105">z</span><span class="op" id="2074106">+</span><span class="ident" id="2074107">x</span><span class="op" id="2074108">)</span><span class="op" id="2074109">+</span><span class="ident" id="2074110">R</span><span class="op" id="2074111">/</span><span class="ident" id="2074112">S</span><span class="op" id="2074113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074117">if</span>&nbsp;<span class="ident" id="2074120">sign</span>&nbsp;<span class="op" id="2074125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074130">return</span>&nbsp;<span class="num" id="2074137">2</span>&nbsp;<span class="op" id="2074139">-</span>&nbsp;<span class="ident" id="2074141">r</span><span class="op" id="2074142">/</span><span class="ident" id="2074143">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074151">return</span>&nbsp;<span class="ident" id="2074158">r</span>&nbsp;<span class="op" id="2074160">/</span>&nbsp;<span class="ident" id="2074162">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074168">if</span>&nbsp;<span class="ident" id="2074171">sign</span>&nbsp;<span class="op" id="2074176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074180">return</span>&nbsp;<span class="num" id="2074187">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2074190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2074193">return</span>&nbsp;<span class="num" id="2074200">0</span><br>
<span class="lineno">335</span><span class="op" id="2074202">}</span>
</div>
</body>
</html>
