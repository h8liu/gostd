<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5145112">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5145167">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5145221">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5145272">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5145348">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5145422">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5145438">package</span>&nbsp;<span class="ident" id="5145446">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5145452">import</span>&nbsp;<span class="op" id="5145459">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145462">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145471">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145481">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145487">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145493">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145510">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145521">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145532">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145543">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5145551">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5145561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5145564">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5145629">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5145658">type</span>&nbsp;<span class="ident" id="5145663">Error</span>&nbsp;<span class="keyword" id="5145669">struct</span>&nbsp;<span class="op" id="5145676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145679">Name</span>&nbsp;<span class="builtintype" id="5145684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145692">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5145697">error</span><br>
<span class="lineno"></span><span class="op" id="5145703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5145706">func</span>&nbsp;<span class="op" id="5145711">(</span><span class="ident" id="5145712">e</span>&nbsp;<span class="op" id="5145714">*</span><span class="ident" id="5145715">Error</span><span class="op" id="5145720">)</span>&nbsp;<span class="ident" id="5145722">Error</span><span class="op" id="5145727">(</span><span class="op" id="5145728">)</span>&nbsp;<span class="builtintype" id="5145730">string</span>&nbsp;<span class="op" id="5145737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145740">return</span>&nbsp;<span class="string" id="5145747">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5145756">+</span>&nbsp;<span class="ident" id="5145758">strconv</span><span class="op" id="5145765">.</span><span class="ident" id="5145766">Quote</span><span class="op" id="5145771">(</span><span class="ident" id="5145772">e</span><span class="op" id="5145773">.</span><span class="ident" id="5145774">Name</span><span class="op" id="5145778">)</span>&nbsp;<span class="op" id="5145780">+</span>&nbsp;<span class="string" id="5145782">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5145787">+</span>&nbsp;<span class="ident" id="5145789">e</span><span class="op" id="5145790">.</span><span class="ident" id="5145791">Err</span><span class="op" id="5145794">.</span><span class="ident" id="5145795">Error</span><span class="op" id="5145800">(</span><span class="op" id="5145801">)</span><br>
<span class="lineno"></span><span class="op" id="5145803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5145806">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5145867">type</span>&nbsp;<span class="ident" id="5145872">Cmd</span>&nbsp;<span class="keyword" id="5145876">struct</span>&nbsp;<span class="op" id="5145883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145886">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145930">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145934">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145992">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146049">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146061">Path</span>&nbsp;<span class="builtintype" id="5146066">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146075">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146148">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146204">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146208">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146275">Args</span>&nbsp;<span class="op" id="5146280">[</span><span class="op" id="5146281">]</span><span class="builtintype" id="5146282">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146291">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146341">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146404">Env</span>&nbsp;<span class="op" id="5146408">[</span><span class="op" id="5146409">]</span><span class="builtintype" id="5146410">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146419">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146475">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146535">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146576">Dir</span>&nbsp;<span class="builtintype" id="5146580">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146589">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146639">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146713">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146784">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146811">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146873">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146942">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147016">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147082">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147158">Stdin</span>&nbsp;<span class="ident" id="5147164">io</span><span class="op" id="5147166">.</span><span class="ident" id="5147167">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147176">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147247">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147251">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147320">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147357">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147361">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147419">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147460">Stdout</span>&nbsp;<span class="ident" id="5147467">io</span><span class="op" id="5147469">.</span><span class="ident" id="5147470">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147478">Stderr</span>&nbsp;<span class="ident" id="5147485">io</span><span class="op" id="5147487">.</span><span class="ident" id="5147488">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147497">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147567">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147640">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147709">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147713">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147788">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147821">ExtraFiles</span>&nbsp;<span class="op" id="5147832">[</span><span class="op" id="5147833">]</span><span class="op" id="5147834">*</span><span class="ident" id="5147835">os</span><span class="op" id="5147837">.</span><span class="ident" id="5147838">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147845">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147915">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147984">SysProcAttr</span>&nbsp;<span class="op" id="5147996">*</span><span class="ident" id="5147997">syscall</span><span class="op" id="5148004">.</span><span class="ident" id="5148005">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148019">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148072">Process</span>&nbsp;<span class="op" id="5148080">*</span><span class="ident" id="5148081">os</span><span class="op" id="5148083">.</span><span class="ident" id="5148084">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148094">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148157">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148200">ProcessState</span>&nbsp;<span class="op" id="5148213">*</span><span class="ident" id="5148214">os</span><span class="op" id="5148216">.</span><span class="ident" id="5148217">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148232">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5148248">error</span>&nbsp;<span class="comment" id="5148254">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148282">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5148298">bool</span>&nbsp;&nbsp;<span class="comment" id="5148304">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148329">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5148345">[</span><span class="op" id="5148346">]</span><span class="op" id="5148347">*</span><span class="ident" id="5148348">os</span><span class="op" id="5148350">.</span><span class="ident" id="5148351">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148357">closeAfterStart</span>&nbsp;<span class="op" id="5148373">[</span><span class="op" id="5148374">]</span><span class="ident" id="5148375">io</span><span class="op" id="5148377">.</span><span class="ident" id="5148378">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148386">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5148402">[</span><span class="op" id="5148403">]</span><span class="ident" id="5148404">io</span><span class="op" id="5148406">.</span><span class="ident" id="5148407">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148415">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5148431">[</span><span class="op" id="5148432">]</span><span class="keyword" id="5148433">func</span><span class="op" id="5148437">(</span><span class="op" id="5148438">)</span>&nbsp;<span class="builtintype" id="5148440">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148447">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5148463">chan</span>&nbsp;<span class="builtintype" id="5148468">error</span>&nbsp;<span class="comment" id="5148474">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5148500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5148503">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5148571">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5148595">//</span><br>
<span class="lineno">110</span><span class="comment" id="5148598">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5148659">//</span><br>
<span class="lineno"></span><span class="comment" id="5148662">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5148727">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5148797">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5148815">//</span><br>
<span class="lineno"></span><span class="comment" id="5148818">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5148888">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5148954">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5149016">func</span>&nbsp;<span class="ident" id="5149021">Command</span><span class="op" id="5149028">(</span><span class="ident" id="5149029">name</span>&nbsp;<span class="builtintype" id="5149034">string</span><span class="op" id="5149040">,</span>&nbsp;<span class="ident" id="5149042">arg</span>&nbsp;<span class="op" id="5149046">...</span><span class="builtintype" id="5149049">string</span><span class="op" id="5149055">)</span>&nbsp;<span class="op" id="5149057">*</span><span class="ident" id="5149058">Cmd</span>&nbsp;<span class="op" id="5149062">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149065">cmd</span>&nbsp;<span class="op" id="5149069">:=</span>&nbsp;<span class="op" id="5149072">&amp;</span><span class="ident" id="5149073">Cmd</span><span class="op" id="5149076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149080">Path</span><span class="op" id="5149084">:</span>&nbsp;<span class="ident" id="5149086">name</span><span class="op" id="5149090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149094">Args</span><span class="op" id="5149098">:</span>&nbsp;<span class="builtinfunc" id="5149100">append</span><span class="op" id="5149106">(</span><span class="op" id="5149107">[</span><span class="op" id="5149108">]</span><span class="builtintype" id="5149109">string</span><span class="op" id="5149115">{</span><span class="ident" id="5149116">name</span><span class="op" id="5149120">}</span><span class="op" id="5149121">,</span>&nbsp;<span class="ident" id="5149123">arg</span><span class="op" id="5149126">...</span><span class="op" id="5149129">)</span><span class="op" id="5149130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149136">if</span>&nbsp;<span class="ident" id="5149139">filepath</span><span class="op" id="5149147">.</span><span class="ident" id="5149148">Base</span><span class="op" id="5149152">(</span><span class="ident" id="5149153">name</span><span class="op" id="5149157">)</span>&nbsp;<span class="op" id="5149159">==</span>&nbsp;<span class="ident" id="5149162">name</span>&nbsp;<span class="op" id="5149167">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149171">if</span>&nbsp;<span class="ident" id="5149174">lp</span><span class="op" id="5149176">,</span>&nbsp;<span class="ident" id="5149178">err</span>&nbsp;<span class="op" id="5149182">:=</span>&nbsp;<span class="ident" id="5149185">LookPath</span><span class="op" id="5149193">(</span><span class="ident" id="5149194">name</span><span class="op" id="5149198">)</span><span class="op" id="5149199">;</span>&nbsp;<span class="ident" id="5149201">err</span>&nbsp;<span class="op" id="5149205">!=</span>&nbsp;<span class="ident" id="5149208">nil</span>&nbsp;<span class="op" id="5149212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149217">cmd</span><span class="op" id="5149220">.</span><span class="ident" id="5149221">lookPathErr</span>&nbsp;<span class="op" id="5149233">=</span>&nbsp;<span class="ident" id="5149235">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149241">}</span>&nbsp;<span class="keyword" id="5149243">else</span>&nbsp;<span class="op" id="5149248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149253">cmd</span><span class="op" id="5149256">.</span><span class="ident" id="5149257">Path</span>&nbsp;<span class="op" id="5149262">=</span>&nbsp;<span class="ident" id="5149264">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149269">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149275">return</span>&nbsp;<span class="ident" id="5149282">cmd</span><br>
<span class="lineno"></span><span class="op" id="5149286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5149289">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5149360">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5149416">func</span>&nbsp;<span class="ident" id="5149421">interfaceEqual</span><span class="op" id="5149435">(</span><span class="ident" id="5149436">a</span><span class="op" id="5149437">,</span>&nbsp;<span class="ident" id="5149439">b</span>&nbsp;<span class="keyword" id="5149441">interface</span><span class="op" id="5149450">{</span><span class="op" id="5149451">}</span><span class="op" id="5149452">)</span>&nbsp;<span class="builtintype" id="5149454">bool</span>&nbsp;<span class="op" id="5149459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149462">defer</span>&nbsp;<span class="keyword" id="5149468">func</span><span class="op" id="5149472">(</span><span class="op" id="5149473">)</span>&nbsp;<span class="op" id="5149475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5149479">recover</span><span class="op" id="5149486">(</span><span class="op" id="5149487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149490">}</span><span class="op" id="5149491">(</span><span class="op" id="5149492">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149495">return</span>&nbsp;<span class="ident" id="5149502">a</span>&nbsp;<span class="op" id="5149504">==</span>&nbsp;<span class="ident" id="5149507">b</span><br>
<span class="lineno"></span><span class="op" id="5149509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149512">func</span>&nbsp;<span class="op" id="5149517">(</span><span class="ident" id="5149518">c</span>&nbsp;<span class="op" id="5149520">*</span><span class="ident" id="5149521">Cmd</span><span class="op" id="5149524">)</span>&nbsp;<span class="ident" id="5149526">envv</span><span class="op" id="5149530">(</span><span class="op" id="5149531">)</span>&nbsp;<span class="op" id="5149533">[</span><span class="op" id="5149534">]</span><span class="builtintype" id="5149535">string</span>&nbsp;<span class="op" id="5149542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149545">if</span>&nbsp;<span class="ident" id="5149548">c</span><span class="op" id="5149549">.</span><span class="ident" id="5149550">Env</span>&nbsp;<span class="op" id="5149554">!=</span>&nbsp;<span class="ident" id="5149557">nil</span>&nbsp;<span class="op" id="5149561">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149565">return</span>&nbsp;<span class="ident" id="5149572">c</span><span class="op" id="5149573">.</span><span class="ident" id="5149574">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149582">return</span>&nbsp;<span class="ident" id="5149589">os</span><span class="op" id="5149591">.</span><span class="ident" id="5149592">Environ</span><span class="op" id="5149599">(</span><span class="op" id="5149600">)</span><br>
<span class="lineno"></span><span class="op" id="5149602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5149605">func</span>&nbsp;<span class="op" id="5149610">(</span><span class="ident" id="5149611">c</span>&nbsp;<span class="op" id="5149613">*</span><span class="ident" id="5149614">Cmd</span><span class="op" id="5149617">)</span>&nbsp;<span class="ident" id="5149619">argv</span><span class="op" id="5149623">(</span><span class="op" id="5149624">)</span>&nbsp;<span class="op" id="5149626">[</span><span class="op" id="5149627">]</span><span class="builtintype" id="5149628">string</span>&nbsp;<span class="op" id="5149635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149638">if</span>&nbsp;<span class="builtinfunc" id="5149641">len</span><span class="op" id="5149644">(</span><span class="ident" id="5149645">c</span><span class="op" id="5149646">.</span><span class="ident" id="5149647">Args</span><span class="op" id="5149651">)</span>&nbsp;<span class="op" id="5149653">&gt;</span>&nbsp;<span class="num" id="5149655">0</span>&nbsp;<span class="op" id="5149657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149661">return</span>&nbsp;<span class="ident" id="5149668">c</span><span class="op" id="5149669">.</span><span class="ident" id="5149670">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149679">return</span>&nbsp;<span class="op" id="5149686">[</span><span class="op" id="5149687">]</span><span class="builtintype" id="5149688">string</span><span class="op" id="5149694">{</span><span class="ident" id="5149695">c</span><span class="op" id="5149696">.</span><span class="ident" id="5149697">Path</span><span class="op" id="5149701">}</span><br>
<span class="lineno">155</span><span class="op" id="5149703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149706">func</span>&nbsp;<span class="op" id="5149711">(</span><span class="ident" id="5149712">c</span>&nbsp;<span class="op" id="5149714">*</span><span class="ident" id="5149715">Cmd</span><span class="op" id="5149718">)</span>&nbsp;<span class="ident" id="5149720">stdin</span><span class="op" id="5149725">(</span><span class="op" id="5149726">)</span>&nbsp;<span class="op" id="5149728">(</span><span class="ident" id="5149729">f</span>&nbsp;<span class="op" id="5149731">*</span><span class="ident" id="5149732">os</span><span class="op" id="5149734">.</span><span class="ident" id="5149735">File</span><span class="op" id="5149739">,</span>&nbsp;<span class="ident" id="5149741">err</span>&nbsp;<span class="builtintype" id="5149745">error</span><span class="op" id="5149750">)</span>&nbsp;<span class="op" id="5149752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149755">if</span>&nbsp;<span class="ident" id="5149758">c</span><span class="op" id="5149759">.</span><span class="ident" id="5149760">Stdin</span>&nbsp;<span class="op" id="5149766">==</span>&nbsp;<span class="ident" id="5149769">nil</span>&nbsp;<span class="op" id="5149773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149777">f</span><span class="op" id="5149778">,</span>&nbsp;<span class="ident" id="5149780">err</span>&nbsp;<span class="op" id="5149784">=</span>&nbsp;<span class="ident" id="5149786">os</span><span class="op" id="5149788">.</span><span class="ident" id="5149789">Open</span><span class="op" id="5149793">(</span><span class="ident" id="5149794">os</span><span class="op" id="5149796">.</span><span class="ident" id="5149797">DevNull</span><span class="op" id="5149804">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149808">if</span>&nbsp;<span class="ident" id="5149811">err</span>&nbsp;<span class="op" id="5149815">!=</span>&nbsp;<span class="ident" id="5149818">nil</span>&nbsp;<span class="op" id="5149822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149840">c</span><span class="op" id="5149841">.</span><span class="ident" id="5149842">closeAfterStart</span>&nbsp;<span class="op" id="5149858">=</span>&nbsp;<span class="builtinfunc" id="5149860">append</span><span class="op" id="5149866">(</span><span class="ident" id="5149867">c</span><span class="op" id="5149868">.</span><span class="ident" id="5149869">closeAfterStart</span><span class="op" id="5149884">,</span>&nbsp;<span class="ident" id="5149886">f</span><span class="op" id="5149887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149891">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149903">if</span>&nbsp;<span class="ident" id="5149906">f</span><span class="op" id="5149907">,</span>&nbsp;<span class="ident" id="5149909">ok</span>&nbsp;<span class="op" id="5149912">:=</span>&nbsp;<span class="ident" id="5149915">c</span><span class="op" id="5149916">.</span><span class="ident" id="5149917">Stdin</span><span class="op" id="5149922">.</span><span class="op" id="5149923">(</span><span class="op" id="5149924">*</span><span class="ident" id="5149925">os</span><span class="op" id="5149927">.</span><span class="ident" id="5149928">File</span><span class="op" id="5149932">)</span><span class="op" id="5149933">;</span>&nbsp;<span class="ident" id="5149935">ok</span>&nbsp;<span class="op" id="5149938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149942">return</span>&nbsp;<span class="ident" id="5149949">f</span><span class="op" id="5149950">,</span>&nbsp;<span class="ident" id="5149952">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149957">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149961">pr</span><span class="op" id="5149963">,</span>&nbsp;<span class="ident" id="5149965">pw</span><span class="op" id="5149967">,</span>&nbsp;<span class="ident" id="5149969">err</span>&nbsp;<span class="op" id="5149973">:=</span>&nbsp;<span class="ident" id="5149976">os</span><span class="op" id="5149978">.</span><span class="ident" id="5149979">Pipe</span><span class="op" id="5149983">(</span><span class="op" id="5149984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149987">if</span>&nbsp;<span class="ident" id="5149990">err</span>&nbsp;<span class="op" id="5149994">!=</span>&nbsp;<span class="ident" id="5149997">nil</span>&nbsp;<span class="op" id="5150001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150005">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150013">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150017">c</span><span class="op" id="5150018">.</span><span class="ident" id="5150019">closeAfterStart</span>&nbsp;<span class="op" id="5150035">=</span>&nbsp;<span class="builtinfunc" id="5150037">append</span><span class="op" id="5150043">(</span><span class="ident" id="5150044">c</span><span class="op" id="5150045">.</span><span class="ident" id="5150046">closeAfterStart</span><span class="op" id="5150061">,</span>&nbsp;<span class="ident" id="5150063">pr</span><span class="op" id="5150065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150068">c</span><span class="op" id="5150069">.</span><span class="ident" id="5150070">closeAfterWait</span>&nbsp;<span class="op" id="5150085">=</span>&nbsp;<span class="builtinfunc" id="5150087">append</span><span class="op" id="5150093">(</span><span class="ident" id="5150094">c</span><span class="op" id="5150095">.</span><span class="ident" id="5150096">closeAfterWait</span><span class="op" id="5150110">,</span>&nbsp;<span class="ident" id="5150112">pw</span><span class="op" id="5150114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150117">c</span><span class="op" id="5150118">.</span><span class="ident" id="5150119">goroutine</span>&nbsp;<span class="op" id="5150129">=</span>&nbsp;<span class="builtinfunc" id="5150131">append</span><span class="op" id="5150137">(</span><span class="ident" id="5150138">c</span><span class="op" id="5150139">.</span><span class="ident" id="5150140">goroutine</span><span class="op" id="5150149">,</span>&nbsp;<span class="keyword" id="5150151">func</span><span class="op" id="5150155">(</span><span class="op" id="5150156">)</span>&nbsp;<span class="builtintype" id="5150158">error</span>&nbsp;<span class="op" id="5150164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150168">_</span><span class="op" id="5150169">,</span>&nbsp;<span class="ident" id="5150171">err</span>&nbsp;<span class="op" id="5150175">:=</span>&nbsp;<span class="ident" id="5150178">io</span><span class="op" id="5150180">.</span><span class="ident" id="5150181">Copy</span><span class="op" id="5150185">(</span><span class="ident" id="5150186">pw</span><span class="op" id="5150188">,</span>&nbsp;<span class="ident" id="5150190">c</span><span class="op" id="5150191">.</span><span class="ident" id="5150192">Stdin</span><span class="op" id="5150197">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150201">if</span>&nbsp;<span class="ident" id="5150204">err1</span>&nbsp;<span class="op" id="5150209">:=</span>&nbsp;<span class="ident" id="5150212">pw</span><span class="op" id="5150214">.</span><span class="ident" id="5150215">Close</span><span class="op" id="5150220">(</span><span class="op" id="5150221">)</span><span class="op" id="5150222">;</span>&nbsp;<span class="ident" id="5150224">err</span>&nbsp;<span class="op" id="5150228">==</span>&nbsp;<span class="ident" id="5150231">nil</span>&nbsp;<span class="op" id="5150235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150240">err</span>&nbsp;<span class="op" id="5150244">=</span>&nbsp;<span class="ident" id="5150246">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150257">return</span>&nbsp;<span class="ident" id="5150264">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150269">}</span><span class="op" id="5150270">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150273">return</span>&nbsp;<span class="ident" id="5150280">pr</span><span class="op" id="5150282">,</span>&nbsp;<span class="ident" id="5150284">nil</span><br>
<span class="lineno"></span><span class="op" id="5150288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150291">func</span>&nbsp;<span class="op" id="5150296">(</span><span class="ident" id="5150297">c</span>&nbsp;<span class="op" id="5150299">*</span><span class="ident" id="5150300">Cmd</span><span class="op" id="5150303">)</span>&nbsp;<span class="ident" id="5150305">stdout</span><span class="op" id="5150311">(</span><span class="op" id="5150312">)</span>&nbsp;<span class="op" id="5150314">(</span><span class="ident" id="5150315">f</span>&nbsp;<span class="op" id="5150317">*</span><span class="ident" id="5150318">os</span><span class="op" id="5150320">.</span><span class="ident" id="5150321">File</span><span class="op" id="5150325">,</span>&nbsp;<span class="ident" id="5150327">err</span>&nbsp;<span class="builtintype" id="5150331">error</span><span class="op" id="5150336">)</span>&nbsp;<span class="op" id="5150338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150341">return</span>&nbsp;<span class="ident" id="5150348">c</span><span class="op" id="5150349">.</span><span class="ident" id="5150350">writerDescriptor</span><span class="op" id="5150366">(</span><span class="ident" id="5150367">c</span><span class="op" id="5150368">.</span><span class="ident" id="5150369">Stdout</span><span class="op" id="5150375">)</span><br>
<span class="lineno">190</span><span class="op" id="5150377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150380">func</span>&nbsp;<span class="op" id="5150385">(</span><span class="ident" id="5150386">c</span>&nbsp;<span class="op" id="5150388">*</span><span class="ident" id="5150389">Cmd</span><span class="op" id="5150392">)</span>&nbsp;<span class="ident" id="5150394">stderr</span><span class="op" id="5150400">(</span><span class="op" id="5150401">)</span>&nbsp;<span class="op" id="5150403">(</span><span class="ident" id="5150404">f</span>&nbsp;<span class="op" id="5150406">*</span><span class="ident" id="5150407">os</span><span class="op" id="5150409">.</span><span class="ident" id="5150410">File</span><span class="op" id="5150414">,</span>&nbsp;<span class="ident" id="5150416">err</span>&nbsp;<span class="builtintype" id="5150420">error</span><span class="op" id="5150425">)</span>&nbsp;<span class="op" id="5150427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150430">if</span>&nbsp;<span class="ident" id="5150433">c</span><span class="op" id="5150434">.</span><span class="ident" id="5150435">Stderr</span>&nbsp;<span class="op" id="5150442">!=</span>&nbsp;<span class="ident" id="5150445">nil</span>&nbsp;<span class="op" id="5150449">&amp;&amp;</span>&nbsp;<span class="ident" id="5150452">interfaceEqual</span><span class="op" id="5150466">(</span><span class="ident" id="5150467">c</span><span class="op" id="5150468">.</span><span class="ident" id="5150469">Stderr</span><span class="op" id="5150475">,</span>&nbsp;<span class="ident" id="5150477">c</span><span class="op" id="5150478">.</span><span class="ident" id="5150479">Stdout</span><span class="op" id="5150485">)</span>&nbsp;<span class="op" id="5150487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150491">return</span>&nbsp;<span class="ident" id="5150498">c</span><span class="op" id="5150499">.</span><span class="ident" id="5150500">childFiles</span><span class="op" id="5150510">[</span><span class="num" id="5150511">1</span><span class="op" id="5150512">]</span><span class="op" id="5150513">,</span>&nbsp;<span class="ident" id="5150515">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150523">return</span>&nbsp;<span class="ident" id="5150530">c</span><span class="op" id="5150531">.</span><span class="ident" id="5150532">writerDescriptor</span><span class="op" id="5150548">(</span><span class="ident" id="5150549">c</span><span class="op" id="5150550">.</span><span class="ident" id="5150551">Stderr</span><span class="op" id="5150557">)</span><br>
<span class="lineno"></span><span class="op" id="5150559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150562">func</span>&nbsp;<span class="op" id="5150567">(</span><span class="ident" id="5150568">c</span>&nbsp;<span class="op" id="5150570">*</span><span class="ident" id="5150571">Cmd</span><span class="op" id="5150574">)</span>&nbsp;<span class="ident" id="5150576">writerDescriptor</span><span class="op" id="5150592">(</span><span class="ident" id="5150593">w</span>&nbsp;<span class="ident" id="5150595">io</span><span class="op" id="5150597">.</span><span class="ident" id="5150598">Writer</span><span class="op" id="5150604">)</span>&nbsp;<span class="op" id="5150606">(</span><span class="ident" id="5150607">f</span>&nbsp;<span class="op" id="5150609">*</span><span class="ident" id="5150610">os</span><span class="op" id="5150612">.</span><span class="ident" id="5150613">File</span><span class="op" id="5150617">,</span>&nbsp;<span class="ident" id="5150619">err</span>&nbsp;<span class="builtintype" id="5150623">error</span><span class="op" id="5150628">)</span>&nbsp;<span class="op" id="5150630">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150633">if</span>&nbsp;<span class="ident" id="5150636">w</span>&nbsp;<span class="op" id="5150638">==</span>&nbsp;<span class="ident" id="5150641">nil</span>&nbsp;<span class="op" id="5150645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150649">f</span><span class="op" id="5150650">,</span>&nbsp;<span class="ident" id="5150652">err</span>&nbsp;<span class="op" id="5150656">=</span>&nbsp;<span class="ident" id="5150658">os</span><span class="op" id="5150660">.</span><span class="ident" id="5150661">OpenFile</span><span class="op" id="5150669">(</span><span class="ident" id="5150670">os</span><span class="op" id="5150672">.</span><span class="ident" id="5150673">DevNull</span><span class="op" id="5150680">,</span>&nbsp;<span class="ident" id="5150682">os</span><span class="op" id="5150684">.</span><span class="ident" id="5150685">O_WRONLY</span><span class="op" id="5150693">,</span>&nbsp;<span class="num" id="5150695">0</span><span class="op" id="5150696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150700">if</span>&nbsp;<span class="ident" id="5150703">err</span>&nbsp;<span class="op" id="5150707">!=</span>&nbsp;<span class="ident" id="5150710">nil</span>&nbsp;<span class="op" id="5150714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150728">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150732">c</span><span class="op" id="5150733">.</span><span class="ident" id="5150734">closeAfterStart</span>&nbsp;<span class="op" id="5150750">=</span>&nbsp;<span class="builtinfunc" id="5150752">append</span><span class="op" id="5150758">(</span><span class="ident" id="5150759">c</span><span class="op" id="5150760">.</span><span class="ident" id="5150761">closeAfterStart</span><span class="op" id="5150776">,</span>&nbsp;<span class="ident" id="5150778">f</span><span class="op" id="5150779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150783">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150795">if</span>&nbsp;<span class="ident" id="5150798">f</span><span class="op" id="5150799">,</span>&nbsp;<span class="ident" id="5150801">ok</span>&nbsp;<span class="op" id="5150804">:=</span>&nbsp;<span class="ident" id="5150807">w</span><span class="op" id="5150808">.</span><span class="op" id="5150809">(</span><span class="op" id="5150810">*</span><span class="ident" id="5150811">os</span><span class="op" id="5150813">.</span><span class="ident" id="5150814">File</span><span class="op" id="5150818">)</span><span class="op" id="5150819">;</span>&nbsp;<span class="ident" id="5150821">ok</span>&nbsp;<span class="op" id="5150824">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150828">return</span>&nbsp;<span class="ident" id="5150835">f</span><span class="op" id="5150836">,</span>&nbsp;<span class="ident" id="5150838">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150847">pr</span><span class="op" id="5150849">,</span>&nbsp;<span class="ident" id="5150851">pw</span><span class="op" id="5150853">,</span>&nbsp;<span class="ident" id="5150855">err</span>&nbsp;<span class="op" id="5150859">:=</span>&nbsp;<span class="ident" id="5150862">os</span><span class="op" id="5150864">.</span><span class="ident" id="5150865">Pipe</span><span class="op" id="5150869">(</span><span class="op" id="5150870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150873">if</span>&nbsp;<span class="ident" id="5150876">err</span>&nbsp;<span class="op" id="5150880">!=</span>&nbsp;<span class="ident" id="5150883">nil</span>&nbsp;<span class="op" id="5150887">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150891">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150903">c</span><span class="op" id="5150904">.</span><span class="ident" id="5150905">closeAfterStart</span>&nbsp;<span class="op" id="5150921">=</span>&nbsp;<span class="builtinfunc" id="5150923">append</span><span class="op" id="5150929">(</span><span class="ident" id="5150930">c</span><span class="op" id="5150931">.</span><span class="ident" id="5150932">closeAfterStart</span><span class="op" id="5150947">,</span>&nbsp;<span class="ident" id="5150949">pw</span><span class="op" id="5150951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150954">c</span><span class="op" id="5150955">.</span><span class="ident" id="5150956">closeAfterWait</span>&nbsp;<span class="op" id="5150971">=</span>&nbsp;<span class="builtinfunc" id="5150973">append</span><span class="op" id="5150979">(</span><span class="ident" id="5150980">c</span><span class="op" id="5150981">.</span><span class="ident" id="5150982">closeAfterWait</span><span class="op" id="5150996">,</span>&nbsp;<span class="ident" id="5150998">pr</span><span class="op" id="5151000">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151003">c</span><span class="op" id="5151004">.</span><span class="ident" id="5151005">goroutine</span>&nbsp;<span class="op" id="5151015">=</span>&nbsp;<span class="builtinfunc" id="5151017">append</span><span class="op" id="5151023">(</span><span class="ident" id="5151024">c</span><span class="op" id="5151025">.</span><span class="ident" id="5151026">goroutine</span><span class="op" id="5151035">,</span>&nbsp;<span class="keyword" id="5151037">func</span><span class="op" id="5151041">(</span><span class="op" id="5151042">)</span>&nbsp;<span class="builtintype" id="5151044">error</span>&nbsp;<span class="op" id="5151050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151054">_</span><span class="op" id="5151055">,</span>&nbsp;<span class="ident" id="5151057">err</span>&nbsp;<span class="op" id="5151061">:=</span>&nbsp;<span class="ident" id="5151064">io</span><span class="op" id="5151066">.</span><span class="ident" id="5151067">Copy</span><span class="op" id="5151071">(</span><span class="ident" id="5151072">w</span><span class="op" id="5151073">,</span>&nbsp;<span class="ident" id="5151075">pr</span><span class="op" id="5151077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151081">return</span>&nbsp;<span class="ident" id="5151088">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151093">}</span><span class="op" id="5151094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151097">return</span>&nbsp;<span class="ident" id="5151104">pw</span><span class="op" id="5151106">,</span>&nbsp;<span class="ident" id="5151108">nil</span><br>
<span class="lineno">225</span><span class="op" id="5151112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5151115">func</span>&nbsp;<span class="op" id="5151120">(</span><span class="ident" id="5151121">c</span>&nbsp;<span class="op" id="5151123">*</span><span class="ident" id="5151124">Cmd</span><span class="op" id="5151127">)</span>&nbsp;<span class="ident" id="5151129">closeDescriptors</span><span class="op" id="5151145">(</span><span class="ident" id="5151146">closers</span>&nbsp;<span class="op" id="5151154">[</span><span class="op" id="5151155">]</span><span class="ident" id="5151156">io</span><span class="op" id="5151158">.</span><span class="ident" id="5151159">Closer</span><span class="op" id="5151165">)</span>&nbsp;<span class="op" id="5151167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151170">for</span>&nbsp;<span class="ident" id="5151174">_</span><span class="op" id="5151175">,</span>&nbsp;<span class="ident" id="5151177">fd</span>&nbsp;<span class="op" id="5151180">:=</span>&nbsp;<span class="keyword" id="5151183">range</span>&nbsp;<span class="ident" id="5151189">closers</span>&nbsp;<span class="op" id="5151197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151201">fd</span><span class="op" id="5151203">.</span><span class="ident" id="5151204">Close</span><span class="op" id="5151209">(</span><span class="op" id="5151210">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151213">}</span><br>
<span class="lineno"></span><span class="op" id="5151215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5151218">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5151284">//</span><br>
<span class="lineno">235</span><span class="comment" id="5151287">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5151353">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5151418">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5151429">//</span><br>
<span class="lineno"></span><span class="comment" id="5151432">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5151501">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5151558">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5151588">func</span>&nbsp;<span class="op" id="5151593">(</span><span class="ident" id="5151594">c</span>&nbsp;<span class="op" id="5151596">*</span><span class="ident" id="5151597">Cmd</span><span class="op" id="5151600">)</span>&nbsp;<span class="ident" id="5151602">Run</span><span class="op" id="5151605">(</span><span class="op" id="5151606">)</span>&nbsp;<span class="builtintype" id="5151608">error</span>&nbsp;<span class="op" id="5151614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151617">if</span>&nbsp;<span class="ident" id="5151620">err</span>&nbsp;<span class="op" id="5151624">:=</span>&nbsp;<span class="ident" id="5151627">c</span><span class="op" id="5151628">.</span><span class="ident" id="5151629">Start</span><span class="op" id="5151634">(</span><span class="op" id="5151635">)</span><span class="op" id="5151636">;</span>&nbsp;<span class="ident" id="5151638">err</span>&nbsp;<span class="op" id="5151642">!=</span>&nbsp;<span class="ident" id="5151645">nil</span>&nbsp;<span class="op" id="5151649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151653">return</span>&nbsp;<span class="ident" id="5151660">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151668">return</span>&nbsp;<span class="ident" id="5151675">c</span><span class="op" id="5151676">.</span><span class="ident" id="5151677">Wait</span><span class="op" id="5151681">(</span><span class="op" id="5151682">)</span><br>
<span class="lineno"></span><span class="op" id="5151684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5151687">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5151751">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5151802">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5151884">func</span>&nbsp;<span class="ident" id="5151889">lookExtensions</span><span class="op" id="5151903">(</span><span class="ident" id="5151904">path</span><span class="op" id="5151908">,</span>&nbsp;<span class="ident" id="5151910">dir</span>&nbsp;<span class="builtintype" id="5151914">string</span><span class="op" id="5151920">)</span>&nbsp;<span class="op" id="5151922">(</span><span class="builtintype" id="5151923">string</span><span class="op" id="5151929">,</span>&nbsp;<span class="builtintype" id="5151931">error</span><span class="op" id="5151936">)</span>&nbsp;<span class="op" id="5151938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151941">if</span>&nbsp;<span class="ident" id="5151944">filepath</span><span class="op" id="5151952">.</span><span class="ident" id="5151953">Base</span><span class="op" id="5151957">(</span><span class="ident" id="5151958">path</span><span class="op" id="5151962">)</span>&nbsp;<span class="op" id="5151964">==</span>&nbsp;<span class="ident" id="5151967">path</span>&nbsp;<span class="op" id="5151972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151976">path</span>&nbsp;<span class="op" id="5151981">=</span>&nbsp;<span class="ident" id="5151983">filepath</span><span class="op" id="5151991">.</span><span class="ident" id="5151992">Join</span><span class="op" id="5151996">(</span><span class="string" id="5151997">&#34;.&#34;</span><span class="op" id="5152000">,</span>&nbsp;<span class="ident" id="5152002">path</span><span class="op" id="5152006">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152012">if</span>&nbsp;<span class="ident" id="5152015">dir</span>&nbsp;<span class="op" id="5152019">==</span>&nbsp;<span class="string" id="5152022">&#34;&#34;</span>&nbsp;<span class="op" id="5152025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152029">return</span>&nbsp;<span class="ident" id="5152036">LookPath</span><span class="op" id="5152044">(</span><span class="ident" id="5152045">path</span><span class="op" id="5152049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152055">if</span>&nbsp;<span class="ident" id="5152058">filepath</span><span class="op" id="5152066">.</span><span class="ident" id="5152067">VolumeName</span><span class="op" id="5152077">(</span><span class="ident" id="5152078">path</span><span class="op" id="5152082">)</span>&nbsp;<span class="op" id="5152084">!=</span>&nbsp;<span class="string" id="5152087">&#34;&#34;</span>&nbsp;<span class="op" id="5152090">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152094">return</span>&nbsp;<span class="ident" id="5152101">LookPath</span><span class="op" id="5152109">(</span><span class="ident" id="5152110">path</span><span class="op" id="5152114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152120">if</span>&nbsp;<span class="builtinfunc" id="5152123">len</span><span class="op" id="5152126">(</span><span class="ident" id="5152127">path</span><span class="op" id="5152131">)</span>&nbsp;<span class="op" id="5152133">&gt;</span>&nbsp;<span class="num" id="5152135">1</span>&nbsp;<span class="op" id="5152137">&amp;&amp;</span>&nbsp;<span class="ident" id="5152140">os</span><span class="op" id="5152142">.</span><span class="ident" id="5152143">IsPathSeparator</span><span class="op" id="5152158">(</span><span class="ident" id="5152159">path</span><span class="op" id="5152163">[</span><span class="num" id="5152164">0</span><span class="op" id="5152165">]</span><span class="op" id="5152166">)</span>&nbsp;<span class="op" id="5152168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152172">return</span>&nbsp;<span class="ident" id="5152179">LookPath</span><span class="op" id="5152187">(</span><span class="ident" id="5152188">path</span><span class="op" id="5152192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152195">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152198">dirandpath</span>&nbsp;<span class="op" id="5152209">:=</span>&nbsp;<span class="ident" id="5152212">filepath</span><span class="op" id="5152220">.</span><span class="ident" id="5152221">Join</span><span class="op" id="5152225">(</span><span class="ident" id="5152226">dir</span><span class="op" id="5152229">,</span>&nbsp;<span class="ident" id="5152231">path</span><span class="op" id="5152235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152238">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152296">lp</span><span class="op" id="5152298">,</span>&nbsp;<span class="ident" id="5152300">err</span>&nbsp;<span class="op" id="5152304">:=</span>&nbsp;<span class="ident" id="5152307">LookPath</span><span class="op" id="5152315">(</span><span class="ident" id="5152316">dirandpath</span><span class="op" id="5152326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152329">if</span>&nbsp;<span class="ident" id="5152332">err</span>&nbsp;<span class="op" id="5152336">!=</span>&nbsp;<span class="ident" id="5152339">nil</span>&nbsp;<span class="op" id="5152343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152347">return</span>&nbsp;<span class="string" id="5152354">&#34;&#34;</span><span class="op" id="5152356">,</span>&nbsp;<span class="ident" id="5152358">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152366">ext</span>&nbsp;<span class="op" id="5152370">:=</span>&nbsp;<span class="ident" id="5152373">strings</span><span class="op" id="5152380">.</span><span class="ident" id="5152381">TrimPrefix</span><span class="op" id="5152391">(</span><span class="ident" id="5152392">lp</span><span class="op" id="5152394">,</span>&nbsp;<span class="ident" id="5152396">dirandpath</span><span class="op" id="5152406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152409">return</span>&nbsp;<span class="ident" id="5152416">path</span>&nbsp;<span class="op" id="5152421">+</span>&nbsp;<span class="ident" id="5152423">ext</span><span class="op" id="5152426">,</span>&nbsp;<span class="ident" id="5152428">nil</span><br>
<span class="lineno"></span><span class="op" id="5152432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5152435">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5152511">//</span><br>
<span class="lineno"></span><span class="comment" id="5152514">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5152592">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5152619">func</span>&nbsp;<span class="op" id="5152624">(</span><span class="ident" id="5152625">c</span>&nbsp;<span class="op" id="5152627">*</span><span class="ident" id="5152628">Cmd</span><span class="op" id="5152631">)</span>&nbsp;<span class="ident" id="5152633">Start</span><span class="op" id="5152638">(</span><span class="op" id="5152639">)</span>&nbsp;<span class="builtintype" id="5152641">error</span>&nbsp;<span class="op" id="5152647">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152650">if</span>&nbsp;<span class="ident" id="5152653">c</span><span class="op" id="5152654">.</span><span class="ident" id="5152655">lookPathErr</span>&nbsp;<span class="op" id="5152667">!=</span>&nbsp;<span class="ident" id="5152670">nil</span>&nbsp;<span class="op" id="5152674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152678">c</span><span class="op" id="5152679">.</span><span class="ident" id="5152680">closeDescriptors</span><span class="op" id="5152696">(</span><span class="ident" id="5152697">c</span><span class="op" id="5152698">.</span><span class="ident" id="5152699">closeAfterStart</span><span class="op" id="5152714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152718">c</span><span class="op" id="5152719">.</span><span class="ident" id="5152720">closeDescriptors</span><span class="op" id="5152736">(</span><span class="ident" id="5152737">c</span><span class="op" id="5152738">.</span><span class="ident" id="5152739">closeAfterWait</span><span class="op" id="5152753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152757">return</span>&nbsp;<span class="ident" id="5152764">c</span><span class="op" id="5152765">.</span><span class="ident" id="5152766">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152779">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152782">if</span>&nbsp;<span class="ident" id="5152785">runtime</span><span class="op" id="5152792">.</span><span class="ident" id="5152793">GOOS</span>&nbsp;<span class="op" id="5152798">==</span>&nbsp;<span class="string" id="5152801">&#34;windows&#34;</span>&nbsp;<span class="op" id="5152811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152815">lp</span><span class="op" id="5152817">,</span>&nbsp;<span class="ident" id="5152819">err</span>&nbsp;<span class="op" id="5152823">:=</span>&nbsp;<span class="ident" id="5152826">lookExtensions</span><span class="op" id="5152840">(</span><span class="ident" id="5152841">c</span><span class="op" id="5152842">.</span><span class="ident" id="5152843">Path</span><span class="op" id="5152847">,</span>&nbsp;<span class="ident" id="5152849">c</span><span class="op" id="5152850">.</span><span class="ident" id="5152851">Dir</span><span class="op" id="5152854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152858">if</span>&nbsp;<span class="ident" id="5152861">err</span>&nbsp;<span class="op" id="5152865">!=</span>&nbsp;<span class="ident" id="5152868">nil</span>&nbsp;<span class="op" id="5152872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152877">c</span><span class="op" id="5152878">.</span><span class="ident" id="5152879">closeDescriptors</span><span class="op" id="5152895">(</span><span class="ident" id="5152896">c</span><span class="op" id="5152897">.</span><span class="ident" id="5152898">closeAfterStart</span><span class="op" id="5152913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152918">c</span><span class="op" id="5152919">.</span><span class="ident" id="5152920">closeDescriptors</span><span class="op" id="5152936">(</span><span class="ident" id="5152937">c</span><span class="op" id="5152938">.</span><span class="ident" id="5152939">closeAfterWait</span><span class="op" id="5152953">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152958">return</span>&nbsp;<span class="ident" id="5152965">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152975">c</span><span class="op" id="5152976">.</span><span class="ident" id="5152977">Path</span>&nbsp;<span class="op" id="5152982">=</span>&nbsp;<span class="ident" id="5152984">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152991">if</span>&nbsp;<span class="ident" id="5152994">c</span><span class="op" id="5152995">.</span><span class="ident" id="5152996">Process</span>&nbsp;<span class="op" id="5153004">!=</span>&nbsp;<span class="ident" id="5153007">nil</span>&nbsp;<span class="op" id="5153011">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153015">return</span>&nbsp;<span class="ident" id="5153022">errors</span><span class="op" id="5153028">.</span><span class="ident" id="5153029">New</span><span class="op" id="5153032">(</span><span class="string" id="5153033">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5153056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153063">type</span>&nbsp;<span class="ident" id="5153068">F</span>&nbsp;<span class="keyword" id="5153070">func</span><span class="op" id="5153074">(</span><span class="op" id="5153075">*</span><span class="ident" id="5153076">Cmd</span><span class="op" id="5153079">)</span>&nbsp;<span class="op" id="5153081">(</span><span class="op" id="5153082">*</span><span class="ident" id="5153083">os</span><span class="op" id="5153085">.</span><span class="ident" id="5153086">File</span><span class="op" id="5153090">,</span>&nbsp;<span class="builtintype" id="5153092">error</span><span class="op" id="5153097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153100">for</span>&nbsp;<span class="ident" id="5153104">_</span><span class="op" id="5153105">,</span>&nbsp;<span class="ident" id="5153107">setupFd</span>&nbsp;<span class="op" id="5153115">:=</span>&nbsp;<span class="keyword" id="5153118">range</span>&nbsp;<span class="op" id="5153124">[</span><span class="op" id="5153125">]</span><span class="ident" id="5153126">F</span><span class="op" id="5153127">{</span><span class="op" id="5153128">(</span><span class="op" id="5153129">*</span><span class="ident" id="5153130">Cmd</span><span class="op" id="5153133">)</span><span class="op" id="5153134">.</span><span class="ident" id="5153135">stdin</span><span class="op" id="5153140">,</span>&nbsp;<span class="op" id="5153142">(</span><span class="op" id="5153143">*</span><span class="ident" id="5153144">Cmd</span><span class="op" id="5153147">)</span><span class="op" id="5153148">.</span><span class="ident" id="5153149">stdout</span><span class="op" id="5153155">,</span>&nbsp;<span class="op" id="5153157">(</span><span class="op" id="5153158">*</span><span class="ident" id="5153159">Cmd</span><span class="op" id="5153162">)</span><span class="op" id="5153163">.</span><span class="ident" id="5153164">stderr</span><span class="op" id="5153170">}</span>&nbsp;<span class="op" id="5153172">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153176">fd</span><span class="op" id="5153178">,</span>&nbsp;<span class="ident" id="5153180">err</span>&nbsp;<span class="op" id="5153184">:=</span>&nbsp;<span class="ident" id="5153187">setupFd</span><span class="op" id="5153194">(</span><span class="ident" id="5153195">c</span><span class="op" id="5153196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153200">if</span>&nbsp;<span class="ident" id="5153203">err</span>&nbsp;<span class="op" id="5153207">!=</span>&nbsp;<span class="ident" id="5153210">nil</span>&nbsp;<span class="op" id="5153214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153219">c</span><span class="op" id="5153220">.</span><span class="ident" id="5153221">closeDescriptors</span><span class="op" id="5153237">(</span><span class="ident" id="5153238">c</span><span class="op" id="5153239">.</span><span class="ident" id="5153240">closeAfterStart</span><span class="op" id="5153255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153260">c</span><span class="op" id="5153261">.</span><span class="ident" id="5153262">closeDescriptors</span><span class="op" id="5153278">(</span><span class="ident" id="5153279">c</span><span class="op" id="5153280">.</span><span class="ident" id="5153281">closeAfterWait</span><span class="op" id="5153295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153300">return</span>&nbsp;<span class="ident" id="5153307">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153317">c</span><span class="op" id="5153318">.</span><span class="ident" id="5153319">childFiles</span>&nbsp;<span class="op" id="5153330">=</span>&nbsp;<span class="builtinfunc" id="5153332">append</span><span class="op" id="5153338">(</span><span class="ident" id="5153339">c</span><span class="op" id="5153340">.</span><span class="ident" id="5153341">childFiles</span><span class="op" id="5153351">,</span>&nbsp;<span class="ident" id="5153353">fd</span><span class="op" id="5153355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153361">c</span><span class="op" id="5153362">.</span><span class="ident" id="5153363">childFiles</span>&nbsp;<span class="op" id="5153374">=</span>&nbsp;<span class="builtinfunc" id="5153376">append</span><span class="op" id="5153382">(</span><span class="ident" id="5153383">c</span><span class="op" id="5153384">.</span><span class="ident" id="5153385">childFiles</span><span class="op" id="5153395">,</span>&nbsp;<span class="ident" id="5153397">c</span><span class="op" id="5153398">.</span><span class="ident" id="5153399">ExtraFiles</span><span class="op" id="5153409">...</span><span class="op" id="5153412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153416">var</span>&nbsp;<span class="ident" id="5153420">err</span>&nbsp;<span class="builtintype" id="5153424">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153431">c</span><span class="op" id="5153432">.</span><span class="ident" id="5153433">Process</span><span class="op" id="5153440">,</span>&nbsp;<span class="ident" id="5153442">err</span>&nbsp;<span class="op" id="5153446">=</span>&nbsp;<span class="ident" id="5153448">os</span><span class="op" id="5153450">.</span><span class="ident" id="5153451">StartProcess</span><span class="op" id="5153463">(</span><span class="ident" id="5153464">c</span><span class="op" id="5153465">.</span><span class="ident" id="5153466">Path</span><span class="op" id="5153470">,</span>&nbsp;<span class="ident" id="5153472">c</span><span class="op" id="5153473">.</span><span class="ident" id="5153474">argv</span><span class="op" id="5153478">(</span><span class="op" id="5153479">)</span><span class="op" id="5153480">,</span>&nbsp;<span class="op" id="5153482">&amp;</span><span class="ident" id="5153483">os</span><span class="op" id="5153485">.</span><span class="ident" id="5153486">ProcAttr</span><span class="op" id="5153494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153498">Dir</span><span class="op" id="5153501">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5153505">c</span><span class="op" id="5153506">.</span><span class="ident" id="5153507">Dir</span><span class="op" id="5153510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153514">Files</span><span class="op" id="5153519">:</span>&nbsp;<span class="ident" id="5153521">c</span><span class="op" id="5153522">.</span><span class="ident" id="5153523">childFiles</span><span class="op" id="5153533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153537">Env</span><span class="op" id="5153540">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5153544">c</span><span class="op" id="5153545">.</span><span class="ident" id="5153546">envv</span><span class="op" id="5153550">(</span><span class="op" id="5153551">)</span><span class="op" id="5153552">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153556">Sys</span><span class="op" id="5153559">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5153563">c</span><span class="op" id="5153564">.</span><span class="ident" id="5153565">SysProcAttr</span><span class="op" id="5153576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153579">}</span><span class="op" id="5153580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153583">if</span>&nbsp;<span class="ident" id="5153586">err</span>&nbsp;<span class="op" id="5153590">!=</span>&nbsp;<span class="ident" id="5153593">nil</span>&nbsp;<span class="op" id="5153597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153601">c</span><span class="op" id="5153602">.</span><span class="ident" id="5153603">closeDescriptors</span><span class="op" id="5153619">(</span><span class="ident" id="5153620">c</span><span class="op" id="5153621">.</span><span class="ident" id="5153622">closeAfterStart</span><span class="op" id="5153637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153641">c</span><span class="op" id="5153642">.</span><span class="ident" id="5153643">closeDescriptors</span><span class="op" id="5153659">(</span><span class="ident" id="5153660">c</span><span class="op" id="5153661">.</span><span class="ident" id="5153662">closeAfterWait</span><span class="op" id="5153676">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153680">return</span>&nbsp;<span class="ident" id="5153687">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153696">c</span><span class="op" id="5153697">.</span><span class="ident" id="5153698">closeDescriptors</span><span class="op" id="5153714">(</span><span class="ident" id="5153715">c</span><span class="op" id="5153716">.</span><span class="ident" id="5153717">closeAfterStart</span><span class="op" id="5153732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153736">c</span><span class="op" id="5153737">.</span><span class="ident" id="5153738">errch</span>&nbsp;<span class="op" id="5153744">=</span>&nbsp;<span class="builtinfunc" id="5153746">make</span><span class="op" id="5153750">(</span><span class="keyword" id="5153751">chan</span>&nbsp;<span class="builtintype" id="5153756">error</span><span class="op" id="5153761">,</span>&nbsp;<span class="builtinfunc" id="5153763">len</span><span class="op" id="5153766">(</span><span class="ident" id="5153767">c</span><span class="op" id="5153768">.</span><span class="ident" id="5153769">goroutine</span><span class="op" id="5153778">)</span><span class="op" id="5153779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153782">for</span>&nbsp;<span class="ident" id="5153786">_</span><span class="op" id="5153787">,</span>&nbsp;<span class="ident" id="5153789">fn</span>&nbsp;<span class="op" id="5153792">:=</span>&nbsp;<span class="keyword" id="5153795">range</span>&nbsp;<span class="ident" id="5153801">c</span><span class="op" id="5153802">.</span><span class="ident" id="5153803">goroutine</span>&nbsp;<span class="op" id="5153813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153817">go</span>&nbsp;<span class="keyword" id="5153820">func</span><span class="op" id="5153824">(</span><span class="ident" id="5153825">fn</span>&nbsp;<span class="keyword" id="5153828">func</span><span class="op" id="5153832">(</span><span class="op" id="5153833">)</span>&nbsp;<span class="builtintype" id="5153835">error</span><span class="op" id="5153840">)</span>&nbsp;<span class="op" id="5153842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153847">c</span><span class="op" id="5153848">.</span><span class="ident" id="5153849">errch</span>&nbsp;<span class="op" id="5153855">&lt;-</span>&nbsp;<span class="ident" id="5153858">fn</span><span class="op" id="5153860">(</span><span class="op" id="5153861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153865">}</span><span class="op" id="5153866">(</span><span class="ident" id="5153867">fn</span><span class="op" id="5153869">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153876">return</span>&nbsp;<span class="ident" id="5153883">nil</span><br>
<span class="lineno"></span><span class="op" id="5153887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5153890">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5153949">type</span>&nbsp;<span class="ident" id="5153954">ExitError</span>&nbsp;<span class="keyword" id="5153964">struct</span>&nbsp;<span class="op" id="5153971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153974">*</span><span class="ident" id="5153975">os</span><span class="op" id="5153977">.</span><span class="ident" id="5153978">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5153991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5153994">func</span>&nbsp;<span class="op" id="5153999">(</span><span class="ident" id="5154000">e</span>&nbsp;<span class="op" id="5154002">*</span><span class="ident" id="5154003">ExitError</span><span class="op" id="5154012">)</span>&nbsp;<span class="ident" id="5154014">Error</span><span class="op" id="5154019">(</span><span class="op" id="5154020">)</span>&nbsp;<span class="builtintype" id="5154022">string</span>&nbsp;<span class="op" id="5154029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154032">return</span>&nbsp;<span class="ident" id="5154039">e</span><span class="op" id="5154040">.</span><span class="ident" id="5154041">ProcessState</span><span class="op" id="5154053">.</span><span class="ident" id="5154054">String</span><span class="op" id="5154060">(</span><span class="op" id="5154061">)</span><br>
<span class="lineno"></span><span class="op" id="5154063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5154066">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5154105">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5154144">//</span><br>
<span class="lineno"></span><span class="comment" id="5154147">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5154213">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5154278">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5154289">//</span><br>
<span class="lineno"></span><span class="comment" id="5154292">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5154361">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5154418">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5154448">//</span><br>
<span class="lineno">355</span><span class="comment" id="5154451">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5154507">func</span>&nbsp;<span class="op" id="5154512">(</span><span class="ident" id="5154513">c</span>&nbsp;<span class="op" id="5154515">*</span><span class="ident" id="5154516">Cmd</span><span class="op" id="5154519">)</span>&nbsp;<span class="ident" id="5154521">Wait</span><span class="op" id="5154525">(</span><span class="op" id="5154526">)</span>&nbsp;<span class="builtintype" id="5154528">error</span>&nbsp;<span class="op" id="5154534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154537">if</span>&nbsp;<span class="ident" id="5154540">c</span><span class="op" id="5154541">.</span><span class="ident" id="5154542">Process</span>&nbsp;<span class="op" id="5154550">==</span>&nbsp;<span class="ident" id="5154553">nil</span>&nbsp;<span class="op" id="5154557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154561">return</span>&nbsp;<span class="ident" id="5154568">errors</span><span class="op" id="5154574">.</span><span class="ident" id="5154575">New</span><span class="op" id="5154578">(</span><span class="string" id="5154579">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5154598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154601">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154604">if</span>&nbsp;<span class="ident" id="5154607">c</span><span class="op" id="5154608">.</span><span class="ident" id="5154609">finished</span>&nbsp;<span class="op" id="5154618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154622">return</span>&nbsp;<span class="ident" id="5154629">errors</span><span class="op" id="5154635">.</span><span class="ident" id="5154636">New</span><span class="op" id="5154639">(</span><span class="string" id="5154640">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5154671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154677">c</span><span class="op" id="5154678">.</span><span class="ident" id="5154679">finished</span>&nbsp;<span class="op" id="5154688">=</span>&nbsp;<span class="ident" id="5154690">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154696">state</span><span class="op" id="5154701">,</span>&nbsp;<span class="ident" id="5154703">err</span>&nbsp;<span class="op" id="5154707">:=</span>&nbsp;<span class="ident" id="5154710">c</span><span class="op" id="5154711">.</span><span class="ident" id="5154712">Process</span><span class="op" id="5154719">.</span><span class="ident" id="5154720">Wait</span><span class="op" id="5154724">(</span><span class="op" id="5154725">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154728">c</span><span class="op" id="5154729">.</span><span class="ident" id="5154730">ProcessState</span>&nbsp;<span class="op" id="5154743">=</span>&nbsp;<span class="ident" id="5154745">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154753">var</span>&nbsp;<span class="ident" id="5154757">copyError</span>&nbsp;<span class="builtintype" id="5154767">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154774">for</span>&nbsp;<span class="keyword" id="5154778">range</span>&nbsp;<span class="ident" id="5154784">c</span><span class="op" id="5154785">.</span><span class="ident" id="5154786">goroutine</span>&nbsp;<span class="op" id="5154796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154800">if</span>&nbsp;<span class="ident" id="5154803">err</span>&nbsp;<span class="op" id="5154807">:=</span>&nbsp;<span class="op" id="5154810">&lt;-</span><span class="ident" id="5154812">c</span><span class="op" id="5154813">.</span><span class="ident" id="5154814">errch</span><span class="op" id="5154819">;</span>&nbsp;<span class="ident" id="5154821">err</span>&nbsp;<span class="op" id="5154825">!=</span>&nbsp;<span class="ident" id="5154828">nil</span>&nbsp;<span class="op" id="5154832">&amp;&amp;</span>&nbsp;<span class="ident" id="5154835">copyError</span>&nbsp;<span class="op" id="5154845">==</span>&nbsp;<span class="ident" id="5154848">nil</span>&nbsp;<span class="op" id="5154852">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154857">copyError</span>&nbsp;<span class="op" id="5154867">=</span>&nbsp;<span class="ident" id="5154869">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154882">c</span><span class="op" id="5154883">.</span><span class="ident" id="5154884">closeDescriptors</span><span class="op" id="5154900">(</span><span class="ident" id="5154901">c</span><span class="op" id="5154902">.</span><span class="ident" id="5154903">closeAfterWait</span><span class="op" id="5154917">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154921">if</span>&nbsp;<span class="ident" id="5154924">err</span>&nbsp;<span class="op" id="5154928">!=</span>&nbsp;<span class="ident" id="5154931">nil</span>&nbsp;<span class="op" id="5154935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154939">return</span>&nbsp;<span class="ident" id="5154946">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154951">}</span>&nbsp;<span class="keyword" id="5154953">else</span>&nbsp;<span class="keyword" id="5154958">if</span>&nbsp;<span class="op" id="5154961">!</span><span class="ident" id="5154962">state</span><span class="op" id="5154967">.</span><span class="ident" id="5154968">Success</span><span class="op" id="5154975">(</span><span class="op" id="5154976">)</span>&nbsp;<span class="op" id="5154978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154982">return</span>&nbsp;<span class="op" id="5154989">&amp;</span><span class="ident" id="5154990">ExitError</span><span class="op" id="5154999">{</span><span class="ident" id="5155000">state</span><span class="op" id="5155005">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155012">return</span>&nbsp;<span class="ident" id="5155019">copyError</span><br>
<span class="lineno"></span><span class="op" id="5155029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5155032">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5155092">func</span>&nbsp;<span class="op" id="5155097">(</span><span class="ident" id="5155098">c</span>&nbsp;<span class="op" id="5155100">*</span><span class="ident" id="5155101">Cmd</span><span class="op" id="5155104">)</span>&nbsp;<span class="ident" id="5155106">Output</span><span class="op" id="5155112">(</span><span class="op" id="5155113">)</span>&nbsp;<span class="op" id="5155115">(</span><span class="op" id="5155116">[</span><span class="op" id="5155117">]</span><span class="builtintype" id="5155118">byte</span><span class="op" id="5155122">,</span>&nbsp;<span class="builtintype" id="5155124">error</span><span class="op" id="5155129">)</span>&nbsp;<span class="op" id="5155131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155134">if</span>&nbsp;<span class="ident" id="5155137">c</span><span class="op" id="5155138">.</span><span class="ident" id="5155139">Stdout</span>&nbsp;<span class="op" id="5155146">!=</span>&nbsp;<span class="ident" id="5155149">nil</span>&nbsp;<span class="op" id="5155153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155157">return</span>&nbsp;<span class="ident" id="5155164">nil</span><span class="op" id="5155167">,</span>&nbsp;<span class="ident" id="5155169">errors</span><span class="op" id="5155175">.</span><span class="ident" id="5155176">New</span><span class="op" id="5155179">(</span><span class="string" id="5155180">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5155206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155209">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155212">var</span>&nbsp;<span class="ident" id="5155216">b</span>&nbsp;<span class="ident" id="5155218">bytes</span><span class="op" id="5155223">.</span><span class="ident" id="5155224">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155232">c</span><span class="op" id="5155233">.</span><span class="ident" id="5155234">Stdout</span>&nbsp;<span class="op" id="5155241">=</span>&nbsp;<span class="op" id="5155243">&amp;</span><span class="ident" id="5155244">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155247">err</span>&nbsp;<span class="op" id="5155251">:=</span>&nbsp;<span class="ident" id="5155254">c</span><span class="op" id="5155255">.</span><span class="ident" id="5155256">Run</span><span class="op" id="5155259">(</span><span class="op" id="5155260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155263">return</span>&nbsp;<span class="ident" id="5155270">b</span><span class="op" id="5155271">.</span><span class="ident" id="5155272">Bytes</span><span class="op" id="5155277">(</span><span class="op" id="5155278">)</span><span class="op" id="5155279">,</span>&nbsp;<span class="ident" id="5155281">err</span><br>
<span class="lineno"></span><span class="op" id="5155285">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5155288">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5155357">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5155387">func</span>&nbsp;<span class="op" id="5155392">(</span><span class="ident" id="5155393">c</span>&nbsp;<span class="op" id="5155395">*</span><span class="ident" id="5155396">Cmd</span><span class="op" id="5155399">)</span>&nbsp;<span class="ident" id="5155401">CombinedOutput</span><span class="op" id="5155415">(</span><span class="op" id="5155416">)</span>&nbsp;<span class="op" id="5155418">(</span><span class="op" id="5155419">[</span><span class="op" id="5155420">]</span><span class="builtintype" id="5155421">byte</span><span class="op" id="5155425">,</span>&nbsp;<span class="builtintype" id="5155427">error</span><span class="op" id="5155432">)</span>&nbsp;<span class="op" id="5155434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155437">if</span>&nbsp;<span class="ident" id="5155440">c</span><span class="op" id="5155441">.</span><span class="ident" id="5155442">Stdout</span>&nbsp;<span class="op" id="5155449">!=</span>&nbsp;<span class="ident" id="5155452">nil</span>&nbsp;<span class="op" id="5155456">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155460">return</span>&nbsp;<span class="ident" id="5155467">nil</span><span class="op" id="5155470">,</span>&nbsp;<span class="ident" id="5155472">errors</span><span class="op" id="5155478">.</span><span class="ident" id="5155479">New</span><span class="op" id="5155482">(</span><span class="string" id="5155483">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5155509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155515">if</span>&nbsp;<span class="ident" id="5155518">c</span><span class="op" id="5155519">.</span><span class="ident" id="5155520">Stderr</span>&nbsp;<span class="op" id="5155527">!=</span>&nbsp;<span class="ident" id="5155530">nil</span>&nbsp;<span class="op" id="5155534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155538">return</span>&nbsp;<span class="ident" id="5155545">nil</span><span class="op" id="5155548">,</span>&nbsp;<span class="ident" id="5155550">errors</span><span class="op" id="5155556">.</span><span class="ident" id="5155557">New</span><span class="op" id="5155560">(</span><span class="string" id="5155561">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5155587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155590">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155593">var</span>&nbsp;<span class="ident" id="5155597">b</span>&nbsp;<span class="ident" id="5155599">bytes</span><span class="op" id="5155604">.</span><span class="ident" id="5155605">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155613">c</span><span class="op" id="5155614">.</span><span class="ident" id="5155615">Stdout</span>&nbsp;<span class="op" id="5155622">=</span>&nbsp;<span class="op" id="5155624">&amp;</span><span class="ident" id="5155625">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155628">c</span><span class="op" id="5155629">.</span><span class="ident" id="5155630">Stderr</span>&nbsp;<span class="op" id="5155637">=</span>&nbsp;<span class="op" id="5155639">&amp;</span><span class="ident" id="5155640">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155643">err</span>&nbsp;<span class="op" id="5155647">:=</span>&nbsp;<span class="ident" id="5155650">c</span><span class="op" id="5155651">.</span><span class="ident" id="5155652">Run</span><span class="op" id="5155655">(</span><span class="op" id="5155656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155659">return</span>&nbsp;<span class="ident" id="5155666">b</span><span class="op" id="5155667">.</span><span class="ident" id="5155668">Bytes</span><span class="op" id="5155673">(</span><span class="op" id="5155674">)</span><span class="op" id="5155675">,</span>&nbsp;<span class="ident" id="5155677">err</span><br>
<span class="lineno">410</span><span class="op" id="5155681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5155684">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5155752">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5155795">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5155870">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5155938">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5156014">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5156060">func</span>&nbsp;<span class="op" id="5156065">(</span><span class="ident" id="5156066">c</span>&nbsp;<span class="op" id="5156068">*</span><span class="ident" id="5156069">Cmd</span><span class="op" id="5156072">)</span>&nbsp;<span class="ident" id="5156074">StdinPipe</span><span class="op" id="5156083">(</span><span class="op" id="5156084">)</span>&nbsp;<span class="op" id="5156086">(</span><span class="ident" id="5156087">io</span><span class="op" id="5156089">.</span><span class="ident" id="5156090">WriteCloser</span><span class="op" id="5156101">,</span>&nbsp;<span class="builtintype" id="5156103">error</span><span class="op" id="5156108">)</span>&nbsp;<span class="op" id="5156110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156113">if</span>&nbsp;<span class="ident" id="5156116">c</span><span class="op" id="5156117">.</span><span class="ident" id="5156118">Stdin</span>&nbsp;<span class="op" id="5156124">!=</span>&nbsp;<span class="ident" id="5156127">nil</span>&nbsp;<span class="op" id="5156131">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156135">return</span>&nbsp;<span class="ident" id="5156142">nil</span><span class="op" id="5156145">,</span>&nbsp;<span class="ident" id="5156147">errors</span><span class="op" id="5156153">.</span><span class="ident" id="5156154">New</span><span class="op" id="5156157">(</span><span class="string" id="5156158">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5156183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156189">if</span>&nbsp;<span class="ident" id="5156192">c</span><span class="op" id="5156193">.</span><span class="ident" id="5156194">Process</span>&nbsp;<span class="op" id="5156202">!=</span>&nbsp;<span class="ident" id="5156205">nil</span>&nbsp;<span class="op" id="5156209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156213">return</span>&nbsp;<span class="ident" id="5156220">nil</span><span class="op" id="5156223">,</span>&nbsp;<span class="ident" id="5156225">errors</span><span class="op" id="5156231">.</span><span class="ident" id="5156232">New</span><span class="op" id="5156235">(</span><span class="string" id="5156236">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5156275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156278">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156281">pr</span><span class="op" id="5156283">,</span>&nbsp;<span class="ident" id="5156285">pw</span><span class="op" id="5156287">,</span>&nbsp;<span class="ident" id="5156289">err</span>&nbsp;<span class="op" id="5156293">:=</span>&nbsp;<span class="ident" id="5156296">os</span><span class="op" id="5156298">.</span><span class="ident" id="5156299">Pipe</span><span class="op" id="5156303">(</span><span class="op" id="5156304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156307">if</span>&nbsp;<span class="ident" id="5156310">err</span>&nbsp;<span class="op" id="5156314">!=</span>&nbsp;<span class="ident" id="5156317">nil</span>&nbsp;<span class="op" id="5156321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156325">return</span>&nbsp;<span class="ident" id="5156332">nil</span><span class="op" id="5156335">,</span>&nbsp;<span class="ident" id="5156337">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156345">c</span><span class="op" id="5156346">.</span><span class="ident" id="5156347">Stdin</span>&nbsp;<span class="op" id="5156353">=</span>&nbsp;<span class="ident" id="5156355">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156359">c</span><span class="op" id="5156360">.</span><span class="ident" id="5156361">closeAfterStart</span>&nbsp;<span class="op" id="5156377">=</span>&nbsp;<span class="builtinfunc" id="5156379">append</span><span class="op" id="5156385">(</span><span class="ident" id="5156386">c</span><span class="op" id="5156387">.</span><span class="ident" id="5156388">closeAfterStart</span><span class="op" id="5156403">,</span>&nbsp;<span class="ident" id="5156405">pr</span><span class="op" id="5156407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156410">wc</span>&nbsp;<span class="op" id="5156413">:=</span>&nbsp;<span class="op" id="5156416">&amp;</span><span class="ident" id="5156417">closeOnce</span><span class="op" id="5156426">{</span><span class="ident" id="5156427">File</span><span class="op" id="5156431">:</span>&nbsp;<span class="ident" id="5156433">pw</span><span class="op" id="5156435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156438">c</span><span class="op" id="5156439">.</span><span class="ident" id="5156440">closeAfterWait</span>&nbsp;<span class="op" id="5156455">=</span>&nbsp;<span class="builtinfunc" id="5156457">append</span><span class="op" id="5156463">(</span><span class="ident" id="5156464">c</span><span class="op" id="5156465">.</span><span class="ident" id="5156466">closeAfterWait</span><span class="op" id="5156480">,</span>&nbsp;<span class="ident" id="5156482">wc</span><span class="op" id="5156484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156487">return</span>&nbsp;<span class="ident" id="5156494">wc</span><span class="op" id="5156496">,</span>&nbsp;<span class="ident" id="5156498">nil</span><br>
<span class="lineno"></span><span class="op" id="5156502">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5156505">type</span>&nbsp;<span class="ident" id="5156510">closeOnce</span>&nbsp;<span class="keyword" id="5156520">struct</span>&nbsp;<span class="op" id="5156527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156530">*</span><span class="ident" id="5156531">os</span><span class="op" id="5156533">.</span><span class="ident" id="5156534">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156541">once</span>&nbsp;<span class="ident" id="5156546">sync</span><span class="op" id="5156550">.</span><span class="ident" id="5156551">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156557">err</span>&nbsp;&nbsp;<span class="builtintype" id="5156562">error</span><br>
<span class="lineno"></span><span class="op" id="5156568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5156571">func</span>&nbsp;<span class="op" id="5156576">(</span><span class="ident" id="5156577">c</span>&nbsp;<span class="op" id="5156579">*</span><span class="ident" id="5156580">closeOnce</span><span class="op" id="5156589">)</span>&nbsp;<span class="ident" id="5156591">Close</span><span class="op" id="5156596">(</span><span class="op" id="5156597">)</span>&nbsp;<span class="builtintype" id="5156599">error</span>&nbsp;<span class="op" id="5156605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156608">c</span><span class="op" id="5156609">.</span><span class="ident" id="5156610">once</span><span class="op" id="5156614">.</span><span class="ident" id="5156615">Do</span><span class="op" id="5156617">(</span><span class="ident" id="5156618">c</span><span class="op" id="5156619">.</span><span class="builtinfunc" id="5156620">close</span><span class="op" id="5156625">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156628">return</span>&nbsp;<span class="ident" id="5156635">c</span><span class="op" id="5156636">.</span><span class="ident" id="5156637">err</span><br>
<span class="lineno"></span><span class="op" id="5156641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5156644">func</span>&nbsp;<span class="op" id="5156649">(</span><span class="ident" id="5156650">c</span>&nbsp;<span class="op" id="5156652">*</span><span class="ident" id="5156653">closeOnce</span><span class="op" id="5156662">)</span>&nbsp;<span class="builtinfunc" id="5156664">close</span><span class="op" id="5156669">(</span><span class="op" id="5156670">)</span>&nbsp;<span class="op" id="5156672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156675">c</span><span class="op" id="5156676">.</span><span class="ident" id="5156677">err</span>&nbsp;<span class="op" id="5156681">=</span>&nbsp;<span class="ident" id="5156683">c</span><span class="op" id="5156684">.</span><span class="ident" id="5156685">File</span><span class="op" id="5156689">.</span><span class="ident" id="5156690">Close</span><span class="op" id="5156695">(</span><span class="op" id="5156696">)</span><br>
<span class="lineno">450</span><span class="op" id="5156698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5156701">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5156770">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5156814">//</span><br>
<span class="lineno">455</span><span class="comment" id="5156817">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5156892">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5156963">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5157042">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5157117">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5157157">func</span>&nbsp;<span class="op" id="5157162">(</span><span class="ident" id="5157163">c</span>&nbsp;<span class="op" id="5157165">*</span><span class="ident" id="5157166">Cmd</span><span class="op" id="5157169">)</span>&nbsp;<span class="ident" id="5157171">StdoutPipe</span><span class="op" id="5157181">(</span><span class="op" id="5157182">)</span>&nbsp;<span class="op" id="5157184">(</span><span class="ident" id="5157185">io</span><span class="op" id="5157187">.</span><span class="ident" id="5157188">ReadCloser</span><span class="op" id="5157198">,</span>&nbsp;<span class="builtintype" id="5157200">error</span><span class="op" id="5157205">)</span>&nbsp;<span class="op" id="5157207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157210">if</span>&nbsp;<span class="ident" id="5157213">c</span><span class="op" id="5157214">.</span><span class="ident" id="5157215">Stdout</span>&nbsp;<span class="op" id="5157222">!=</span>&nbsp;<span class="ident" id="5157225">nil</span>&nbsp;<span class="op" id="5157229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157233">return</span>&nbsp;<span class="ident" id="5157240">nil</span><span class="op" id="5157243">,</span>&nbsp;<span class="ident" id="5157245">errors</span><span class="op" id="5157251">.</span><span class="ident" id="5157252">New</span><span class="op" id="5157255">(</span><span class="string" id="5157256">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5157282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157288">if</span>&nbsp;<span class="ident" id="5157291">c</span><span class="op" id="5157292">.</span><span class="ident" id="5157293">Process</span>&nbsp;<span class="op" id="5157301">!=</span>&nbsp;<span class="ident" id="5157304">nil</span>&nbsp;<span class="op" id="5157308">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157312">return</span>&nbsp;<span class="ident" id="5157319">nil</span><span class="op" id="5157322">,</span>&nbsp;<span class="ident" id="5157324">errors</span><span class="op" id="5157330">.</span><span class="ident" id="5157331">New</span><span class="op" id="5157334">(</span><span class="string" id="5157335">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5157375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157381">pr</span><span class="op" id="5157383">,</span>&nbsp;<span class="ident" id="5157385">pw</span><span class="op" id="5157387">,</span>&nbsp;<span class="ident" id="5157389">err</span>&nbsp;<span class="op" id="5157393">:=</span>&nbsp;<span class="ident" id="5157396">os</span><span class="op" id="5157398">.</span><span class="ident" id="5157399">Pipe</span><span class="op" id="5157403">(</span><span class="op" id="5157404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157407">if</span>&nbsp;<span class="ident" id="5157410">err</span>&nbsp;<span class="op" id="5157414">!=</span>&nbsp;<span class="ident" id="5157417">nil</span>&nbsp;<span class="op" id="5157421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157425">return</span>&nbsp;<span class="ident" id="5157432">nil</span><span class="op" id="5157435">,</span>&nbsp;<span class="ident" id="5157437">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157445">c</span><span class="op" id="5157446">.</span><span class="ident" id="5157447">Stdout</span>&nbsp;<span class="op" id="5157454">=</span>&nbsp;<span class="ident" id="5157456">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157460">c</span><span class="op" id="5157461">.</span><span class="ident" id="5157462">closeAfterStart</span>&nbsp;<span class="op" id="5157478">=</span>&nbsp;<span class="builtinfunc" id="5157480">append</span><span class="op" id="5157486">(</span><span class="ident" id="5157487">c</span><span class="op" id="5157488">.</span><span class="ident" id="5157489">closeAfterStart</span><span class="op" id="5157504">,</span>&nbsp;<span class="ident" id="5157506">pw</span><span class="op" id="5157508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157511">c</span><span class="op" id="5157512">.</span><span class="ident" id="5157513">closeAfterWait</span>&nbsp;<span class="op" id="5157528">=</span>&nbsp;<span class="builtinfunc" id="5157530">append</span><span class="op" id="5157536">(</span><span class="ident" id="5157537">c</span><span class="op" id="5157538">.</span><span class="ident" id="5157539">closeAfterWait</span><span class="op" id="5157553">,</span>&nbsp;<span class="ident" id="5157555">pr</span><span class="op" id="5157557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157560">return</span>&nbsp;<span class="ident" id="5157567">pr</span><span class="op" id="5157569">,</span>&nbsp;<span class="ident" id="5157571">nil</span><br>
<span class="lineno">475</span><span class="op" id="5157575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5157578">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5157647">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5157690">//</span><br>
<span class="lineno">480</span><span class="comment" id="5157693">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5157768">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5157839">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5157918">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5157992">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5158043">func</span>&nbsp;<span class="op" id="5158048">(</span><span class="ident" id="5158049">c</span>&nbsp;<span class="op" id="5158051">*</span><span class="ident" id="5158052">Cmd</span><span class="op" id="5158055">)</span>&nbsp;<span class="ident" id="5158057">StderrPipe</span><span class="op" id="5158067">(</span><span class="op" id="5158068">)</span>&nbsp;<span class="op" id="5158070">(</span><span class="ident" id="5158071">io</span><span class="op" id="5158073">.</span><span class="ident" id="5158074">ReadCloser</span><span class="op" id="5158084">,</span>&nbsp;<span class="builtintype" id="5158086">error</span><span class="op" id="5158091">)</span>&nbsp;<span class="op" id="5158093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158096">if</span>&nbsp;<span class="ident" id="5158099">c</span><span class="op" id="5158100">.</span><span class="ident" id="5158101">Stderr</span>&nbsp;<span class="op" id="5158108">!=</span>&nbsp;<span class="ident" id="5158111">nil</span>&nbsp;<span class="op" id="5158115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158119">return</span>&nbsp;<span class="ident" id="5158126">nil</span><span class="op" id="5158129">,</span>&nbsp;<span class="ident" id="5158131">errors</span><span class="op" id="5158137">.</span><span class="ident" id="5158138">New</span><span class="op" id="5158141">(</span><span class="string" id="5158142">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5158168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158174">if</span>&nbsp;<span class="ident" id="5158177">c</span><span class="op" id="5158178">.</span><span class="ident" id="5158179">Process</span>&nbsp;<span class="op" id="5158187">!=</span>&nbsp;<span class="ident" id="5158190">nil</span>&nbsp;<span class="op" id="5158194">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158198">return</span>&nbsp;<span class="ident" id="5158205">nil</span><span class="op" id="5158208">,</span>&nbsp;<span class="ident" id="5158210">errors</span><span class="op" id="5158216">.</span><span class="ident" id="5158217">New</span><span class="op" id="5158220">(</span><span class="string" id="5158221">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5158261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158267">pr</span><span class="op" id="5158269">,</span>&nbsp;<span class="ident" id="5158271">pw</span><span class="op" id="5158273">,</span>&nbsp;<span class="ident" id="5158275">err</span>&nbsp;<span class="op" id="5158279">:=</span>&nbsp;<span class="ident" id="5158282">os</span><span class="op" id="5158284">.</span><span class="ident" id="5158285">Pipe</span><span class="op" id="5158289">(</span><span class="op" id="5158290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158293">if</span>&nbsp;<span class="ident" id="5158296">err</span>&nbsp;<span class="op" id="5158300">!=</span>&nbsp;<span class="ident" id="5158303">nil</span>&nbsp;<span class="op" id="5158307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158311">return</span>&nbsp;<span class="ident" id="5158318">nil</span><span class="op" id="5158321">,</span>&nbsp;<span class="ident" id="5158323">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158331">c</span><span class="op" id="5158332">.</span><span class="ident" id="5158333">Stderr</span>&nbsp;<span class="op" id="5158340">=</span>&nbsp;<span class="ident" id="5158342">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158346">c</span><span class="op" id="5158347">.</span><span class="ident" id="5158348">closeAfterStart</span>&nbsp;<span class="op" id="5158364">=</span>&nbsp;<span class="builtinfunc" id="5158366">append</span><span class="op" id="5158372">(</span><span class="ident" id="5158373">c</span><span class="op" id="5158374">.</span><span class="ident" id="5158375">closeAfterStart</span><span class="op" id="5158390">,</span>&nbsp;<span class="ident" id="5158392">pw</span><span class="op" id="5158394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158397">c</span><span class="op" id="5158398">.</span><span class="ident" id="5158399">closeAfterWait</span>&nbsp;<span class="op" id="5158414">=</span>&nbsp;<span class="builtinfunc" id="5158416">append</span><span class="op" id="5158422">(</span><span class="ident" id="5158423">c</span><span class="op" id="5158424">.</span><span class="ident" id="5158425">closeAfterWait</span><span class="op" id="5158439">,</span>&nbsp;<span class="ident" id="5158441">pr</span><span class="op" id="5158443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158446">return</span>&nbsp;<span class="ident" id="5158453">pr</span><span class="op" id="5158455">,</span>&nbsp;<span class="ident" id="5158457">nil</span><br>
<span class="lineno">500</span><span class="op" id="5158461">}</span>
</div>
</body>
</html>
