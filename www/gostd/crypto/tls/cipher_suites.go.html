<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html" class="current">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4315526">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4315581">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4315635">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4315686">package</span>&nbsp;<span class="ident" id="4315694">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4315699">import</span>&nbsp;<span class="op" id="4315706">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315709">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315723">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315740">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315754">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315769">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315783">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315798">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4315813">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4315820">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4315823">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4315902">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4315966">type</span>&nbsp;<span class="ident" id="4315971">keyAgreement</span>&nbsp;<span class="keyword" id="4315984">interface</span>&nbsp;<span class="op" id="4315994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315997">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316065">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316127">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316200">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316209">generateServerKeyExchange</span><span class="op" id="4316234">(</span><span class="op" id="4316235">*</span><span class="ident" id="4316236">Config</span><span class="op" id="4316242">,</span>&nbsp;<span class="op" id="4316244">*</span><span class="ident" id="4316245">Certificate</span><span class="op" id="4316256">,</span>&nbsp;<span class="op" id="4316258">*</span><span class="ident" id="4316259">clientHelloMsg</span><span class="op" id="4316273">,</span>&nbsp;<span class="op" id="4316275">*</span><span class="ident" id="4316276">serverHelloMsg</span><span class="op" id="4316290">)</span>&nbsp;<span class="op" id="4316292">(</span><span class="op" id="4316293">*</span><span class="ident" id="4316294">serverKeyExchangeMsg</span><span class="op" id="4316314">,</span>&nbsp;<span class="builtintype" id="4316316">error</span><span class="op" id="4316321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316324">processClientKeyExchange</span><span class="op" id="4316348">(</span><span class="op" id="4316349">*</span><span class="ident" id="4316350">Config</span><span class="op" id="4316356">,</span>&nbsp;<span class="op" id="4316358">*</span><span class="ident" id="4316359">Certificate</span><span class="op" id="4316370">,</span>&nbsp;<span class="op" id="4316372">*</span><span class="ident" id="4316373">clientKeyExchangeMsg</span><span class="op" id="4316393">,</span>&nbsp;<span class="builtintype" id="4316395">uint16</span><span class="op" id="4316401">)</span>&nbsp;<span class="op" id="4316403">(</span><span class="op" id="4316404">[</span><span class="op" id="4316405">]</span><span class="builtintype" id="4316406">byte</span><span class="op" id="4316410">,</span>&nbsp;<span class="builtintype" id="4316412">error</span><span class="op" id="4316417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316421">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316488">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316551">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316582">processServerKeyExchange</span><span class="op" id="4316606">(</span><span class="op" id="4316607">*</span><span class="ident" id="4316608">Config</span><span class="op" id="4316614">,</span>&nbsp;<span class="op" id="4316616">*</span><span class="ident" id="4316617">clientHelloMsg</span><span class="op" id="4316631">,</span>&nbsp;<span class="op" id="4316633">*</span><span class="ident" id="4316634">serverHelloMsg</span><span class="op" id="4316648">,</span>&nbsp;<span class="op" id="4316650">*</span><span class="ident" id="4316651">x509</span><span class="op" id="4316655">.</span><span class="ident" id="4316656">Certificate</span><span class="op" id="4316667">,</span>&nbsp;<span class="op" id="4316669">*</span><span class="ident" id="4316670">serverKeyExchangeMsg</span><span class="op" id="4316690">)</span>&nbsp;<span class="builtintype" id="4316692">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316699">generateClientKeyExchange</span><span class="op" id="4316724">(</span><span class="op" id="4316725">*</span><span class="ident" id="4316726">Config</span><span class="op" id="4316732">,</span>&nbsp;<span class="op" id="4316734">*</span><span class="ident" id="4316735">clientHelloMsg</span><span class="op" id="4316749">,</span>&nbsp;<span class="op" id="4316751">*</span><span class="ident" id="4316752">x509</span><span class="op" id="4316756">.</span><span class="ident" id="4316757">Certificate</span><span class="op" id="4316768">)</span>&nbsp;<span class="op" id="4316770">(</span><span class="op" id="4316771">[</span><span class="op" id="4316772">]</span><span class="builtintype" id="4316773">byte</span><span class="op" id="4316777">,</span>&nbsp;<span class="op" id="4316779">*</span><span class="ident" id="4316780">clientKeyExchangeMsg</span><span class="op" id="4316800">,</span>&nbsp;<span class="builtintype" id="4316802">error</span><span class="op" id="4316807">)</span><br>
<span class="lineno">35</span><span class="op" id="4316809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4316812">const</span>&nbsp;<span class="op" id="4316818">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316821">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316891">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316963">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317035">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317062">suiteECDHE</span>&nbsp;<span class="op" id="4317073">=</span>&nbsp;<span class="num" id="4317075">1</span>&nbsp;<span class="op" id="4317077">&lt;&lt;</span>&nbsp;<span class="ident" id="4317080">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317086">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317151">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317218">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317288">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317303">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317315">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317388">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317425">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4317436">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4317439">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4317515">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4317582">type</span>&nbsp;<span class="ident" id="4317587">cipherSuite</span>&nbsp;<span class="keyword" id="4317599">struct</span>&nbsp;<span class="op" id="4317606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317609">id</span>&nbsp;<span class="builtintype" id="4317612">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317620">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317694">keyLen</span>&nbsp;<span class="builtintype" id="4317701">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317706">macLen</span>&nbsp;<span class="builtintype" id="4317713">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317718">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4317725">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317730">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317737">func</span><span class="op" id="4317741">(</span><span class="ident" id="4317742">version</span>&nbsp;<span class="builtintype" id="4317750">uint16</span><span class="op" id="4317756">)</span>&nbsp;<span class="ident" id="4317758">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317772">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317824">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4317831">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317836">cipher</span>&nbsp;<span class="keyword" id="4317843">func</span><span class="op" id="4317847">(</span><span class="ident" id="4317848">key</span><span class="op" id="4317851">,</span>&nbsp;<span class="ident" id="4317853">iv</span>&nbsp;<span class="op" id="4317856">[</span><span class="op" id="4317857">]</span><span class="builtintype" id="4317858">byte</span><span class="op" id="4317862">,</span>&nbsp;<span class="ident" id="4317864">isRead</span>&nbsp;<span class="builtintype" id="4317871">bool</span><span class="op" id="4317875">)</span>&nbsp;<span class="keyword" id="4317877">interface</span><span class="op" id="4317886">{</span><span class="op" id="4317887">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317890">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317897">func</span><span class="op" id="4317901">(</span><span class="ident" id="4317902">version</span>&nbsp;<span class="builtintype" id="4317910">uint16</span><span class="op" id="4317916">,</span>&nbsp;<span class="ident" id="4317918">macKey</span>&nbsp;<span class="op" id="4317925">[</span><span class="op" id="4317926">]</span><span class="builtintype" id="4317927">byte</span><span class="op" id="4317931">)</span>&nbsp;<span class="ident" id="4317933">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317946">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317953">func</span><span class="op" id="4317957">(</span><span class="ident" id="4317958">key</span><span class="op" id="4317961">,</span>&nbsp;<span class="ident" id="4317963">fixedNonce</span>&nbsp;<span class="op" id="4317974">[</span><span class="op" id="4317975">]</span><span class="builtintype" id="4317976">byte</span><span class="op" id="4317980">)</span>&nbsp;<span class="ident" id="4317982">cipher</span><span class="op" id="4317988">.</span><span class="ident" id="4317989">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4317994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4317997">var</span>&nbsp;<span class="ident" id="4318001">cipherSuites</span>&nbsp;<span class="op" id="4318014">=</span>&nbsp;<span class="op" id="4318016">[</span><span class="op" id="4318017">]</span><span class="op" id="4318018">*</span><span class="ident" id="4318019">cipherSuite</span><span class="op" id="4318030">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318033">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318102">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318164">{</span><span class="ident" id="4318165">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4318202">,</span>&nbsp;<span class="num" id="4318204">16</span><span class="op" id="4318206">,</span>&nbsp;<span class="num" id="4318208">0</span><span class="op" id="4318209">,</span>&nbsp;<span class="num" id="4318211">4</span><span class="op" id="4318212">,</span>&nbsp;<span class="ident" id="4318214">ecdheRSAKA</span><span class="op" id="4318224">,</span>&nbsp;<span class="ident" id="4318226">suiteECDHE</span>&nbsp;<span class="op" id="4318237">|</span>&nbsp;<span class="ident" id="4318239">suiteTLS12</span><span class="op" id="4318249">,</span>&nbsp;<span class="builtintype" id="4318251">nil</span><span class="op" id="4318254">,</span>&nbsp;<span class="builtintype" id="4318256">nil</span><span class="op" id="4318259">,</span>&nbsp;<span class="ident" id="4318261">aeadAESGCM</span><span class="op" id="4318271">}</span><span class="op" id="4318272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318275">{</span><span class="ident" id="4318276">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="4318315">,</span>&nbsp;<span class="num" id="4318317">16</span><span class="op" id="4318319">,</span>&nbsp;<span class="num" id="4318321">0</span><span class="op" id="4318322">,</span>&nbsp;<span class="num" id="4318324">4</span><span class="op" id="4318325">,</span>&nbsp;<span class="ident" id="4318327">ecdheECDSAKA</span><span class="op" id="4318339">,</span>&nbsp;<span class="ident" id="4318341">suiteECDHE</span>&nbsp;<span class="op" id="4318352">|</span>&nbsp;<span class="ident" id="4318354">suiteECDSA</span>&nbsp;<span class="op" id="4318365">|</span>&nbsp;<span class="ident" id="4318367">suiteTLS12</span><span class="op" id="4318377">,</span>&nbsp;<span class="builtintype" id="4318379">nil</span><span class="op" id="4318382">,</span>&nbsp;<span class="builtintype" id="4318384">nil</span><span class="op" id="4318387">,</span>&nbsp;<span class="ident" id="4318389">aeadAESGCM</span><span class="op" id="4318399">}</span><span class="op" id="4318400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318403">{</span><span class="ident" id="4318404">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="4318434">,</span>&nbsp;<span class="num" id="4318436">16</span><span class="op" id="4318438">,</span>&nbsp;<span class="num" id="4318440">20</span><span class="op" id="4318442">,</span>&nbsp;<span class="num" id="4318444">0</span><span class="op" id="4318445">,</span>&nbsp;<span class="ident" id="4318447">ecdheRSAKA</span><span class="op" id="4318457">,</span>&nbsp;<span class="ident" id="4318459">suiteECDHE</span><span class="op" id="4318469">,</span>&nbsp;<span class="ident" id="4318471">cipherRC4</span><span class="op" id="4318480">,</span>&nbsp;<span class="ident" id="4318482">macSHA1</span><span class="op" id="4318489">,</span>&nbsp;<span class="builtintype" id="4318491">nil</span><span class="op" id="4318494">}</span><span class="op" id="4318495">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318498">{</span><span class="ident" id="4318499">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="4318531">,</span>&nbsp;<span class="num" id="4318533">16</span><span class="op" id="4318535">,</span>&nbsp;<span class="num" id="4318537">20</span><span class="op" id="4318539">,</span>&nbsp;<span class="num" id="4318541">0</span><span class="op" id="4318542">,</span>&nbsp;<span class="ident" id="4318544">ecdheECDSAKA</span><span class="op" id="4318556">,</span>&nbsp;<span class="ident" id="4318558">suiteECDHE</span>&nbsp;<span class="op" id="4318569">|</span>&nbsp;<span class="ident" id="4318571">suiteECDSA</span><span class="op" id="4318581">,</span>&nbsp;<span class="ident" id="4318583">cipherRC4</span><span class="op" id="4318592">,</span>&nbsp;<span class="ident" id="4318594">macSHA1</span><span class="op" id="4318601">,</span>&nbsp;<span class="builtintype" id="4318603">nil</span><span class="op" id="4318606">}</span><span class="op" id="4318607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318610">{</span><span class="ident" id="4318611">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4318645">,</span>&nbsp;<span class="num" id="4318647">16</span><span class="op" id="4318649">,</span>&nbsp;<span class="num" id="4318651">20</span><span class="op" id="4318653">,</span>&nbsp;<span class="num" id="4318655">16</span><span class="op" id="4318657">,</span>&nbsp;<span class="ident" id="4318659">ecdheRSAKA</span><span class="op" id="4318669">,</span>&nbsp;<span class="ident" id="4318671">suiteECDHE</span><span class="op" id="4318681">,</span>&nbsp;<span class="ident" id="4318683">cipherAES</span><span class="op" id="4318692">,</span>&nbsp;<span class="ident" id="4318694">macSHA1</span><span class="op" id="4318701">,</span>&nbsp;<span class="builtintype" id="4318703">nil</span><span class="op" id="4318706">}</span><span class="op" id="4318707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318710">{</span><span class="ident" id="4318711">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4318747">,</span>&nbsp;<span class="num" id="4318749">16</span><span class="op" id="4318751">,</span>&nbsp;<span class="num" id="4318753">20</span><span class="op" id="4318755">,</span>&nbsp;<span class="num" id="4318757">16</span><span class="op" id="4318759">,</span>&nbsp;<span class="ident" id="4318761">ecdheECDSAKA</span><span class="op" id="4318773">,</span>&nbsp;<span class="ident" id="4318775">suiteECDHE</span>&nbsp;<span class="op" id="4318786">|</span>&nbsp;<span class="ident" id="4318788">suiteECDSA</span><span class="op" id="4318798">,</span>&nbsp;<span class="ident" id="4318800">cipherAES</span><span class="op" id="4318809">,</span>&nbsp;<span class="ident" id="4318811">macSHA1</span><span class="op" id="4318818">,</span>&nbsp;<span class="builtintype" id="4318820">nil</span><span class="op" id="4318823">}</span><span class="op" id="4318824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318827">{</span><span class="ident" id="4318828">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4318862">,</span>&nbsp;<span class="num" id="4318864">32</span><span class="op" id="4318866">,</span>&nbsp;<span class="num" id="4318868">20</span><span class="op" id="4318870">,</span>&nbsp;<span class="num" id="4318872">16</span><span class="op" id="4318874">,</span>&nbsp;<span class="ident" id="4318876">ecdheRSAKA</span><span class="op" id="4318886">,</span>&nbsp;<span class="ident" id="4318888">suiteECDHE</span><span class="op" id="4318898">,</span>&nbsp;<span class="ident" id="4318900">cipherAES</span><span class="op" id="4318909">,</span>&nbsp;<span class="ident" id="4318911">macSHA1</span><span class="op" id="4318918">,</span>&nbsp;<span class="builtintype" id="4318920">nil</span><span class="op" id="4318923">}</span><span class="op" id="4318924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318927">{</span><span class="ident" id="4318928">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4318964">,</span>&nbsp;<span class="num" id="4318966">32</span><span class="op" id="4318968">,</span>&nbsp;<span class="num" id="4318970">20</span><span class="op" id="4318972">,</span>&nbsp;<span class="num" id="4318974">16</span><span class="op" id="4318976">,</span>&nbsp;<span class="ident" id="4318978">ecdheECDSAKA</span><span class="op" id="4318990">,</span>&nbsp;<span class="ident" id="4318992">suiteECDHE</span>&nbsp;<span class="op" id="4319003">|</span>&nbsp;<span class="ident" id="4319005">suiteECDSA</span><span class="op" id="4319015">,</span>&nbsp;<span class="ident" id="4319017">cipherAES</span><span class="op" id="4319026">,</span>&nbsp;<span class="ident" id="4319028">macSHA1</span><span class="op" id="4319035">,</span>&nbsp;<span class="builtintype" id="4319037">nil</span><span class="op" id="4319040">}</span><span class="op" id="4319041">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319044">{</span><span class="ident" id="4319045">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="4319069">,</span>&nbsp;<span class="num" id="4319071">16</span><span class="op" id="4319073">,</span>&nbsp;<span class="num" id="4319075">20</span><span class="op" id="4319077">,</span>&nbsp;<span class="num" id="4319079">0</span><span class="op" id="4319080">,</span>&nbsp;<span class="ident" id="4319082">rsaKA</span><span class="op" id="4319087">,</span>&nbsp;<span class="num" id="4319089">0</span><span class="op" id="4319090">,</span>&nbsp;<span class="ident" id="4319092">cipherRC4</span><span class="op" id="4319101">,</span>&nbsp;<span class="ident" id="4319103">macSHA1</span><span class="op" id="4319110">,</span>&nbsp;<span class="builtintype" id="4319112">nil</span><span class="op" id="4319115">}</span><span class="op" id="4319116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319119">{</span><span class="ident" id="4319120">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="4319148">,</span>&nbsp;<span class="num" id="4319150">16</span><span class="op" id="4319152">,</span>&nbsp;<span class="num" id="4319154">20</span><span class="op" id="4319156">,</span>&nbsp;<span class="num" id="4319158">16</span><span class="op" id="4319160">,</span>&nbsp;<span class="ident" id="4319162">rsaKA</span><span class="op" id="4319167">,</span>&nbsp;<span class="num" id="4319169">0</span><span class="op" id="4319170">,</span>&nbsp;<span class="ident" id="4319172">cipherAES</span><span class="op" id="4319181">,</span>&nbsp;<span class="ident" id="4319183">macSHA1</span><span class="op" id="4319190">,</span>&nbsp;<span class="builtintype" id="4319192">nil</span><span class="op" id="4319195">}</span><span class="op" id="4319196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319199">{</span><span class="ident" id="4319200">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="4319228">,</span>&nbsp;<span class="num" id="4319230">32</span><span class="op" id="4319232">,</span>&nbsp;<span class="num" id="4319234">20</span><span class="op" id="4319236">,</span>&nbsp;<span class="num" id="4319238">16</span><span class="op" id="4319240">,</span>&nbsp;<span class="ident" id="4319242">rsaKA</span><span class="op" id="4319247">,</span>&nbsp;<span class="num" id="4319249">0</span><span class="op" id="4319250">,</span>&nbsp;<span class="ident" id="4319252">cipherAES</span><span class="op" id="4319261">,</span>&nbsp;<span class="ident" id="4319263">macSHA1</span><span class="op" id="4319270">,</span>&nbsp;<span class="builtintype" id="4319272">nil</span><span class="op" id="4319275">}</span><span class="op" id="4319276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319279">{</span><span class="ident" id="4319280">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4319315">,</span>&nbsp;<span class="num" id="4319317">24</span><span class="op" id="4319319">,</span>&nbsp;<span class="num" id="4319321">20</span><span class="op" id="4319323">,</span>&nbsp;<span class="num" id="4319325">8</span><span class="op" id="4319326">,</span>&nbsp;<span class="ident" id="4319328">ecdheRSAKA</span><span class="op" id="4319338">,</span>&nbsp;<span class="ident" id="4319340">suiteECDHE</span><span class="op" id="4319350">,</span>&nbsp;<span class="ident" id="4319352">cipher3DES</span><span class="op" id="4319362">,</span>&nbsp;<span class="ident" id="4319364">macSHA1</span><span class="op" id="4319371">,</span>&nbsp;<span class="builtintype" id="4319373">nil</span><span class="op" id="4319376">}</span><span class="op" id="4319377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319380">{</span><span class="ident" id="4319381">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="4319410">,</span>&nbsp;<span class="num" id="4319412">24</span><span class="op" id="4319414">,</span>&nbsp;<span class="num" id="4319416">20</span><span class="op" id="4319418">,</span>&nbsp;<span class="num" id="4319420">8</span><span class="op" id="4319421">,</span>&nbsp;<span class="ident" id="4319423">rsaKA</span><span class="op" id="4319428">,</span>&nbsp;<span class="num" id="4319430">0</span><span class="op" id="4319431">,</span>&nbsp;<span class="ident" id="4319433">cipher3DES</span><span class="op" id="4319443">,</span>&nbsp;<span class="ident" id="4319445">macSHA1</span><span class="op" id="4319452">,</span>&nbsp;<span class="builtintype" id="4319454">nil</span><span class="op" id="4319457">}</span><span class="op" id="4319458">,</span><br>
<span class="lineno">85</span><span class="op" id="4319460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319463">func</span>&nbsp;<span class="ident" id="4319468">cipherRC4</span><span class="op" id="4319477">(</span><span class="ident" id="4319478">key</span><span class="op" id="4319481">,</span>&nbsp;<span class="ident" id="4319483">iv</span>&nbsp;<span class="op" id="4319486">[</span><span class="op" id="4319487">]</span><span class="builtintype" id="4319488">byte</span><span class="op" id="4319492">,</span>&nbsp;<span class="ident" id="4319494">isRead</span>&nbsp;<span class="builtintype" id="4319501">bool</span><span class="op" id="4319505">)</span>&nbsp;<span class="keyword" id="4319507">interface</span><span class="op" id="4319516">{</span><span class="op" id="4319517">}</span>&nbsp;<span class="op" id="4319519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319522">cipher</span><span class="op" id="4319528">,</span>&nbsp;<span class="ident" id="4319530">_</span>&nbsp;<span class="op" id="4319532">:=</span>&nbsp;<span class="ident" id="4319535">rc4</span><span class="op" id="4319538">.</span><span class="ident" id="4319539">NewCipher</span><span class="op" id="4319548">(</span><span class="ident" id="4319549">key</span><span class="op" id="4319552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319555">return</span>&nbsp;<span class="ident" id="4319562">cipher</span><br>
<span class="lineno">90</span><span class="op" id="4319569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4319572">func</span>&nbsp;<span class="ident" id="4319577">cipher3DES</span><span class="op" id="4319587">(</span><span class="ident" id="4319588">key</span><span class="op" id="4319591">,</span>&nbsp;<span class="ident" id="4319593">iv</span>&nbsp;<span class="op" id="4319596">[</span><span class="op" id="4319597">]</span><span class="builtintype" id="4319598">byte</span><span class="op" id="4319602">,</span>&nbsp;<span class="ident" id="4319604">isRead</span>&nbsp;<span class="builtintype" id="4319611">bool</span><span class="op" id="4319615">)</span>&nbsp;<span class="keyword" id="4319617">interface</span><span class="op" id="4319626">{</span><span class="op" id="4319627">}</span>&nbsp;<span class="op" id="4319629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319632">block</span><span class="op" id="4319637">,</span>&nbsp;<span class="ident" id="4319639">_</span>&nbsp;<span class="op" id="4319641">:=</span>&nbsp;<span class="ident" id="4319644">des</span><span class="op" id="4319647">.</span><span class="ident" id="4319648">NewTripleDESCipher</span><span class="op" id="4319666">(</span><span class="ident" id="4319667">key</span><span class="op" id="4319670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319673">if</span>&nbsp;<span class="ident" id="4319676">isRead</span>&nbsp;<span class="op" id="4319683">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319687">return</span>&nbsp;<span class="ident" id="4319694">cipher</span><span class="op" id="4319700">.</span><span class="ident" id="4319701">NewCBCDecrypter</span><span class="op" id="4319716">(</span><span class="ident" id="4319717">block</span><span class="op" id="4319722">,</span>&nbsp;<span class="ident" id="4319724">iv</span><span class="op" id="4319726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319732">return</span>&nbsp;<span class="ident" id="4319739">cipher</span><span class="op" id="4319745">.</span><span class="ident" id="4319746">NewCBCEncrypter</span><span class="op" id="4319761">(</span><span class="ident" id="4319762">block</span><span class="op" id="4319767">,</span>&nbsp;<span class="ident" id="4319769">iv</span><span class="op" id="4319771">)</span><br>
<span class="lineno"></span><span class="op" id="4319773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4319776">func</span>&nbsp;<span class="ident" id="4319781">cipherAES</span><span class="op" id="4319790">(</span><span class="ident" id="4319791">key</span><span class="op" id="4319794">,</span>&nbsp;<span class="ident" id="4319796">iv</span>&nbsp;<span class="op" id="4319799">[</span><span class="op" id="4319800">]</span><span class="builtintype" id="4319801">byte</span><span class="op" id="4319805">,</span>&nbsp;<span class="ident" id="4319807">isRead</span>&nbsp;<span class="builtintype" id="4319814">bool</span><span class="op" id="4319818">)</span>&nbsp;<span class="keyword" id="4319820">interface</span><span class="op" id="4319829">{</span><span class="op" id="4319830">}</span>&nbsp;<span class="op" id="4319832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319835">block</span><span class="op" id="4319840">,</span>&nbsp;<span class="ident" id="4319842">_</span>&nbsp;<span class="op" id="4319844">:=</span>&nbsp;<span class="ident" id="4319847">aes</span><span class="op" id="4319850">.</span><span class="ident" id="4319851">NewCipher</span><span class="op" id="4319860">(</span><span class="ident" id="4319861">key</span><span class="op" id="4319864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319867">if</span>&nbsp;<span class="ident" id="4319870">isRead</span>&nbsp;<span class="op" id="4319877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319881">return</span>&nbsp;<span class="ident" id="4319888">cipher</span><span class="op" id="4319894">.</span><span class="ident" id="4319895">NewCBCDecrypter</span><span class="op" id="4319910">(</span><span class="ident" id="4319911">block</span><span class="op" id="4319916">,</span>&nbsp;<span class="ident" id="4319918">iv</span><span class="op" id="4319920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319923">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319926">return</span>&nbsp;<span class="ident" id="4319933">cipher</span><span class="op" id="4319939">.</span><span class="ident" id="4319940">NewCBCEncrypter</span><span class="op" id="4319955">(</span><span class="ident" id="4319956">block</span><span class="op" id="4319961">,</span>&nbsp;<span class="ident" id="4319963">iv</span><span class="op" id="4319965">)</span><br>
<span class="lineno"></span><span class="op" id="4319967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4319970">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4320035">func</span>&nbsp;<span class="ident" id="4320040">macSHA1</span><span class="op" id="4320047">(</span><span class="ident" id="4320048">version</span>&nbsp;<span class="builtintype" id="4320056">uint16</span><span class="op" id="4320062">,</span>&nbsp;<span class="ident" id="4320064">key</span>&nbsp;<span class="op" id="4320068">[</span><span class="op" id="4320069">]</span><span class="builtintype" id="4320070">byte</span><span class="op" id="4320074">)</span>&nbsp;<span class="ident" id="4320076">macFunction</span>&nbsp;<span class="op" id="4320088">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320091">if</span>&nbsp;<span class="ident" id="4320094">version</span>&nbsp;<span class="op" id="4320102">==</span>&nbsp;<span class="ident" id="4320105">VersionSSL30</span>&nbsp;<span class="op" id="4320118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320122">mac</span>&nbsp;<span class="op" id="4320126">:=</span>&nbsp;<span class="ident" id="4320129">ssl30MAC</span><span class="op" id="4320137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320142">h</span><span class="op" id="4320143">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4320147">sha1</span><span class="op" id="4320151">.</span><span class="ident" id="4320152">New</span><span class="op" id="4320155">(</span><span class="op" id="4320156">)</span><span class="op" id="4320157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320162">key</span><span class="op" id="4320165">:</span>&nbsp;<span class="builtinfunc" id="4320167">make</span><span class="op" id="4320171">(</span><span class="op" id="4320172">[</span><span class="op" id="4320173">]</span><span class="builtintype" id="4320174">byte</span><span class="op" id="4320178">,</span>&nbsp;<span class="builtinfunc" id="4320180">len</span><span class="op" id="4320183">(</span><span class="ident" id="4320184">key</span><span class="op" id="4320187">)</span><span class="op" id="4320188">)</span><span class="op" id="4320189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320193">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4320197">copy</span><span class="op" id="4320201">(</span><span class="ident" id="4320202">mac</span><span class="op" id="4320205">.</span><span class="ident" id="4320206">key</span><span class="op" id="4320209">,</span>&nbsp;<span class="ident" id="4320211">key</span><span class="op" id="4320214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320218">return</span>&nbsp;<span class="ident" id="4320225">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320233">return</span>&nbsp;<span class="ident" id="4320240">tls10MAC</span><span class="op" id="4320248">{</span><span class="ident" id="4320249">hmac</span><span class="op" id="4320253">.</span><span class="ident" id="4320254">New</span><span class="op" id="4320257">(</span><span class="ident" id="4320258">sha1</span><span class="op" id="4320262">.</span><span class="ident" id="4320263">New</span><span class="op" id="4320266">,</span>&nbsp;<span class="ident" id="4320268">key</span><span class="op" id="4320271">)</span><span class="op" id="4320272">}</span><br>
<span class="lineno"></span><span class="op" id="4320274">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4320277">type</span>&nbsp;<span class="ident" id="4320282">macFunction</span>&nbsp;<span class="keyword" id="4320294">interface</span>&nbsp;<span class="op" id="4320304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320307">Size</span><span class="op" id="4320311">(</span><span class="op" id="4320312">)</span>&nbsp;<span class="builtintype" id="4320314">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320319">MAC</span><span class="op" id="4320322">(</span><span class="ident" id="4320323">digestBuf</span><span class="op" id="4320332">,</span>&nbsp;<span class="ident" id="4320334">seq</span><span class="op" id="4320337">,</span>&nbsp;<span class="ident" id="4320339">header</span><span class="op" id="4320345">,</span>&nbsp;<span class="ident" id="4320347">data</span>&nbsp;<span class="op" id="4320352">[</span><span class="op" id="4320353">]</span><span class="builtintype" id="4320354">byte</span><span class="op" id="4320358">)</span>&nbsp;<span class="op" id="4320360">[</span><span class="op" id="4320361">]</span><span class="builtintype" id="4320362">byte</span><br>
<span class="lineno"></span><span class="op" id="4320367">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4320370">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4320447">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4320461">type</span>&nbsp;<span class="ident" id="4320466">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4320481">struct</span>&nbsp;<span class="op" id="4320488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320491">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320562">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320626">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320681">sealNonce</span><span class="op" id="4320690">,</span>&nbsp;<span class="ident" id="4320692">openNonce</span>&nbsp;<span class="op" id="4320702">[</span><span class="op" id="4320703">]</span><span class="builtintype" id="4320704">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320710">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320731">cipher</span><span class="op" id="4320737">.</span><span class="ident" id="4320738">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4320743">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4320746">func</span>&nbsp;<span class="op" id="4320751">(</span><span class="ident" id="4320752">f</span>&nbsp;<span class="op" id="4320754">*</span><span class="ident" id="4320755">fixedNonceAEAD</span><span class="op" id="4320769">)</span>&nbsp;<span class="ident" id="4320771">NonceSize</span><span class="op" id="4320780">(</span><span class="op" id="4320781">)</span>&nbsp;<span class="builtintype" id="4320783">int</span>&nbsp;<span class="op" id="4320787">{</span>&nbsp;<span class="keyword" id="4320789">return</span>&nbsp;<span class="num" id="4320796">8</span>&nbsp;<span class="op" id="4320798">}</span><br>
<span class="lineno"></span><span class="keyword" id="4320800">func</span>&nbsp;<span class="op" id="4320805">(</span><span class="ident" id="4320806">f</span>&nbsp;<span class="op" id="4320808">*</span><span class="ident" id="4320809">fixedNonceAEAD</span><span class="op" id="4320823">)</span>&nbsp;<span class="ident" id="4320825">Overhead</span><span class="op" id="4320833">(</span><span class="op" id="4320834">)</span>&nbsp;<span class="builtintype" id="4320836">int</span>&nbsp;&nbsp;<span class="op" id="4320841">{</span>&nbsp;<span class="keyword" id="4320843">return</span>&nbsp;<span class="ident" id="4320850">f</span><span class="op" id="4320851">.</span><span class="ident" id="4320852">aead</span><span class="op" id="4320856">.</span><span class="ident" id="4320857">Overhead</span><span class="op" id="4320865">(</span><span class="op" id="4320866">)</span>&nbsp;<span class="op" id="4320868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4320871">func</span>&nbsp;<span class="op" id="4320876">(</span><span class="ident" id="4320877">f</span>&nbsp;<span class="op" id="4320879">*</span><span class="ident" id="4320880">fixedNonceAEAD</span><span class="op" id="4320894">)</span>&nbsp;<span class="ident" id="4320896">Seal</span><span class="op" id="4320900">(</span><span class="ident" id="4320901">out</span><span class="op" id="4320904">,</span>&nbsp;<span class="ident" id="4320906">nonce</span><span class="op" id="4320911">,</span>&nbsp;<span class="ident" id="4320913">plaintext</span><span class="op" id="4320922">,</span>&nbsp;<span class="ident" id="4320924">additionalData</span>&nbsp;<span class="op" id="4320939">[</span><span class="op" id="4320940">]</span><span class="builtintype" id="4320941">byte</span><span class="op" id="4320945">)</span>&nbsp;<span class="op" id="4320947">[</span><span class="op" id="4320948">]</span><span class="builtintype" id="4320949">byte</span>&nbsp;<span class="op" id="4320954">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4320957">copy</span><span class="op" id="4320961">(</span><span class="ident" id="4320962">f</span><span class="op" id="4320963">.</span><span class="ident" id="4320964">sealNonce</span><span class="op" id="4320973">[</span><span class="builtinfunc" id="4320974">len</span><span class="op" id="4320977">(</span><span class="ident" id="4320978">f</span><span class="op" id="4320979">.</span><span class="ident" id="4320980">sealNonce</span><span class="op" id="4320989">)</span><span class="op" id="4320990">-</span><span class="num" id="4320991">8</span><span class="op" id="4320992">:</span><span class="op" id="4320993">]</span><span class="op" id="4320994">,</span>&nbsp;<span class="ident" id="4320996">nonce</span><span class="op" id="4321001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321004">return</span>&nbsp;<span class="ident" id="4321011">f</span><span class="op" id="4321012">.</span><span class="ident" id="4321013">aead</span><span class="op" id="4321017">.</span><span class="ident" id="4321018">Seal</span><span class="op" id="4321022">(</span><span class="ident" id="4321023">out</span><span class="op" id="4321026">,</span>&nbsp;<span class="ident" id="4321028">f</span><span class="op" id="4321029">.</span><span class="ident" id="4321030">sealNonce</span><span class="op" id="4321039">,</span>&nbsp;<span class="ident" id="4321041">plaintext</span><span class="op" id="4321050">,</span>&nbsp;<span class="ident" id="4321052">additionalData</span><span class="op" id="4321066">)</span><br>
<span class="lineno"></span><span class="op" id="4321068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321071">func</span>&nbsp;<span class="op" id="4321076">(</span><span class="ident" id="4321077">f</span>&nbsp;<span class="op" id="4321079">*</span><span class="ident" id="4321080">fixedNonceAEAD</span><span class="op" id="4321094">)</span>&nbsp;<span class="ident" id="4321096">Open</span><span class="op" id="4321100">(</span><span class="ident" id="4321101">out</span><span class="op" id="4321104">,</span>&nbsp;<span class="ident" id="4321106">nonce</span><span class="op" id="4321111">,</span>&nbsp;<span class="ident" id="4321113">plaintext</span><span class="op" id="4321122">,</span>&nbsp;<span class="ident" id="4321124">additionalData</span>&nbsp;<span class="op" id="4321139">[</span><span class="op" id="4321140">]</span><span class="builtintype" id="4321141">byte</span><span class="op" id="4321145">)</span>&nbsp;<span class="op" id="4321147">(</span><span class="op" id="4321148">[</span><span class="op" id="4321149">]</span><span class="builtintype" id="4321150">byte</span><span class="op" id="4321154">,</span>&nbsp;<span class="builtintype" id="4321156">error</span><span class="op" id="4321161">)</span>&nbsp;<span class="op" id="4321163">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4321166">copy</span><span class="op" id="4321170">(</span><span class="ident" id="4321171">f</span><span class="op" id="4321172">.</span><span class="ident" id="4321173">openNonce</span><span class="op" id="4321182">[</span><span class="builtinfunc" id="4321183">len</span><span class="op" id="4321186">(</span><span class="ident" id="4321187">f</span><span class="op" id="4321188">.</span><span class="ident" id="4321189">openNonce</span><span class="op" id="4321198">)</span><span class="op" id="4321199">-</span><span class="num" id="4321200">8</span><span class="op" id="4321201">:</span><span class="op" id="4321202">]</span><span class="op" id="4321203">,</span>&nbsp;<span class="ident" id="4321205">nonce</span><span class="op" id="4321210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321213">return</span>&nbsp;<span class="ident" id="4321220">f</span><span class="op" id="4321221">.</span><span class="ident" id="4321222">aead</span><span class="op" id="4321226">.</span><span class="ident" id="4321227">Open</span><span class="op" id="4321231">(</span><span class="ident" id="4321232">out</span><span class="op" id="4321235">,</span>&nbsp;<span class="ident" id="4321237">f</span><span class="op" id="4321238">.</span><span class="ident" id="4321239">openNonce</span><span class="op" id="4321248">,</span>&nbsp;<span class="ident" id="4321250">plaintext</span><span class="op" id="4321259">,</span>&nbsp;<span class="ident" id="4321261">additionalData</span><span class="op" id="4321275">)</span><br>
<span class="lineno"></span><span class="op" id="4321277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321280">func</span>&nbsp;<span class="ident" id="4321285">aeadAESGCM</span><span class="op" id="4321295">(</span><span class="ident" id="4321296">key</span><span class="op" id="4321299">,</span>&nbsp;<span class="ident" id="4321301">fixedNonce</span>&nbsp;<span class="op" id="4321312">[</span><span class="op" id="4321313">]</span><span class="builtintype" id="4321314">byte</span><span class="op" id="4321318">)</span>&nbsp;<span class="ident" id="4321320">cipher</span><span class="op" id="4321326">.</span><span class="ident" id="4321327">AEAD</span>&nbsp;<span class="op" id="4321332">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321335">aes</span><span class="op" id="4321338">,</span>&nbsp;<span class="ident" id="4321340">err</span>&nbsp;<span class="op" id="4321344">:=</span>&nbsp;<span class="ident" id="4321347">aes</span><span class="op" id="4321350">.</span><span class="ident" id="4321351">NewCipher</span><span class="op" id="4321360">(</span><span class="ident" id="4321361">key</span><span class="op" id="4321364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321367">if</span>&nbsp;<span class="ident" id="4321370">err</span>&nbsp;<span class="op" id="4321374">!=</span>&nbsp;<span class="builtintype" id="4321377">nil</span>&nbsp;<span class="op" id="4321381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4321385">panic</span><span class="op" id="4321390">(</span><span class="ident" id="4321391">err</span><span class="op" id="4321394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321400">aead</span><span class="op" id="4321404">,</span>&nbsp;<span class="ident" id="4321406">err</span>&nbsp;<span class="op" id="4321410">:=</span>&nbsp;<span class="ident" id="4321413">cipher</span><span class="op" id="4321419">.</span><span class="ident" id="4321420">NewGCM</span><span class="op" id="4321426">(</span><span class="ident" id="4321427">aes</span><span class="op" id="4321430">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321433">if</span>&nbsp;<span class="ident" id="4321436">err</span>&nbsp;<span class="op" id="4321440">!=</span>&nbsp;<span class="builtintype" id="4321443">nil</span>&nbsp;<span class="op" id="4321447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4321451">panic</span><span class="op" id="4321456">(</span><span class="ident" id="4321457">err</span><span class="op" id="4321460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321467">nonce1</span><span class="op" id="4321473">,</span>&nbsp;<span class="ident" id="4321475">nonce2</span>&nbsp;<span class="op" id="4321482">:=</span>&nbsp;<span class="builtinfunc" id="4321485">make</span><span class="op" id="4321489">(</span><span class="op" id="4321490">[</span><span class="op" id="4321491">]</span><span class="builtintype" id="4321492">byte</span><span class="op" id="4321496">,</span>&nbsp;<span class="num" id="4321498">12</span><span class="op" id="4321500">)</span><span class="op" id="4321501">,</span>&nbsp;<span class="builtinfunc" id="4321503">make</span><span class="op" id="4321507">(</span><span class="op" id="4321508">[</span><span class="op" id="4321509">]</span><span class="builtintype" id="4321510">byte</span><span class="op" id="4321514">,</span>&nbsp;<span class="num" id="4321516">12</span><span class="op" id="4321518">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4321521">copy</span><span class="op" id="4321525">(</span><span class="ident" id="4321526">nonce1</span><span class="op" id="4321532">,</span>&nbsp;<span class="ident" id="4321534">fixedNonce</span><span class="op" id="4321544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4321547">copy</span><span class="op" id="4321551">(</span><span class="ident" id="4321552">nonce2</span><span class="op" id="4321558">,</span>&nbsp;<span class="ident" id="4321560">fixedNonce</span><span class="op" id="4321570">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321574">return</span>&nbsp;<span class="op" id="4321581">&amp;</span><span class="ident" id="4321582">fixedNonceAEAD</span><span class="op" id="4321596">{</span><span class="ident" id="4321597">nonce1</span><span class="op" id="4321603">,</span>&nbsp;<span class="ident" id="4321605">nonce2</span><span class="op" id="4321611">,</span>&nbsp;<span class="ident" id="4321613">aead</span><span class="op" id="4321617">}</span><br>
<span class="lineno"></span><span class="op" id="4321619">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4321622">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4321683">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4321761">type</span>&nbsp;<span class="ident" id="4321766">ssl30MAC</span>&nbsp;<span class="keyword" id="4321775">struct</span>&nbsp;<span class="op" id="4321782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321785">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4321789">hash</span><span class="op" id="4321793">.</span><span class="ident" id="4321794">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321800">key</span>&nbsp;<span class="op" id="4321804">[</span><span class="op" id="4321805">]</span><span class="builtintype" id="4321806">byte</span><br>
<span class="lineno"></span><span class="op" id="4321811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321814">func</span>&nbsp;<span class="op" id="4321819">(</span><span class="ident" id="4321820">s</span>&nbsp;<span class="ident" id="4321822">ssl30MAC</span><span class="op" id="4321830">)</span>&nbsp;<span class="ident" id="4321832">Size</span><span class="op" id="4321836">(</span><span class="op" id="4321837">)</span>&nbsp;<span class="builtintype" id="4321839">int</span>&nbsp;<span class="op" id="4321843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321846">return</span>&nbsp;<span class="ident" id="4321853">s</span><span class="op" id="4321854">.</span><span class="ident" id="4321855">h</span><span class="op" id="4321856">.</span><span class="ident" id="4321857">Size</span><span class="op" id="4321861">(</span><span class="op" id="4321862">)</span><br>
<span class="lineno">175</span><span class="op" id="4321864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321867">var</span>&nbsp;<span class="ident" id="4321871">ssl30Pad1</span>&nbsp;<span class="op" id="4321881">=</span>&nbsp;<span class="op" id="4321883">[</span><span class="num" id="4321884">48</span><span class="op" id="4321886">]</span><span class="builtintype" id="4321887">byte</span><span class="op" id="4321891">{</span><span class="num" id="4321892">0x36</span><span class="op" id="4321896">,</span>&nbsp;<span class="num" id="4321898">0x36</span><span class="op" id="4321902">,</span>&nbsp;<span class="num" id="4321904">0x36</span><span class="op" id="4321908">,</span>&nbsp;<span class="num" id="4321910">0x36</span><span class="op" id="4321914">,</span>&nbsp;<span class="num" id="4321916">0x36</span><span class="op" id="4321920">,</span>&nbsp;<span class="num" id="4321922">0x36</span><span class="op" id="4321926">,</span>&nbsp;<span class="num" id="4321928">0x36</span><span class="op" id="4321932">,</span>&nbsp;<span class="num" id="4321934">0x36</span><span class="op" id="4321938">,</span>&nbsp;<span class="num" id="4321940">0x36</span><span class="op" id="4321944">,</span>&nbsp;<span class="num" id="4321946">0x36</span><span class="op" id="4321950">,</span>&nbsp;<span class="num" id="4321952">0x36</span><span class="op" id="4321956">,</span>&nbsp;<span class="num" id="4321958">0x36</span><span class="op" id="4321962">,</span>&nbsp;<span class="num" id="4321964">0x36</span><span class="op" id="4321968">,</span>&nbsp;<span class="num" id="4321970">0x36</span><span class="op" id="4321974">,</span>&nbsp;<span class="num" id="4321976">0x36</span><span class="op" id="4321980">,</span>&nbsp;<span class="num" id="4321982">0x36</span><span class="op" id="4321986">,</span>&nbsp;<span class="num" id="4321988">0x36</span><span class="op" id="4321992">,</span>&nbsp;<span class="num" id="4321994">0x36</span><span class="op" id="4321998">,</span>&nbsp;<span class="num" id="4322000">0x36</span><span class="op" id="4322004">,</span>&nbsp;<span class="num" id="4322006">0x36</span><span class="op" id="4322010">,</span>&nbsp;<span class="num" id="4322012">0x36</span><span class="op" id="4322016">,</span>&nbsp;<span class="num" id="4322018">0x36</span><span class="op" id="4322022">,</span>&nbsp;<span class="num" id="4322024">0x36</span><span class="op" id="4322028">,</span>&nbsp;<span class="num" id="4322030">0x36</span><span class="op" id="4322034">,</span>&nbsp;<span class="num" id="4322036">0x36</span><span class="op" id="4322040">,</span>&nbsp;<span class="num" id="4322042">0x36</span><span class="op" id="4322046">,</span>&nbsp;<span class="num" id="4322048">0x36</span><span class="op" id="4322052">,</span>&nbsp;<span class="num" id="4322054">0x36</span><span class="op" id="4322058">,</span>&nbsp;<span class="num" id="4322060">0x36</span><span class="op" id="4322064">,</span>&nbsp;<span class="num" id="4322066">0x36</span><span class="op" id="4322070">,</span>&nbsp;<span class="num" id="4322072">0x36</span><span class="op" id="4322076">,</span>&nbsp;<span class="num" id="4322078">0x36</span><span class="op" id="4322082">,</span>&nbsp;<span class="num" id="4322084">0x36</span><span class="op" id="4322088">,</span>&nbsp;<span class="num" id="4322090">0x36</span><span class="op" id="4322094">,</span>&nbsp;<span class="num" id="4322096">0x36</span><span class="op" id="4322100">,</span>&nbsp;<span class="num" id="4322102">0x36</span><span class="op" id="4322106">,</span>&nbsp;<span class="num" id="4322108">0x36</span><span class="op" id="4322112">,</span>&nbsp;<span class="num" id="4322114">0x36</span><span class="op" id="4322118">,</span>&nbsp;<span class="num" id="4322120">0x36</span><span class="op" id="4322124">,</span>&nbsp;<span class="num" id="4322126">0x36</span><span class="op" id="4322130">,</span>&nbsp;<span class="num" id="4322132">0x36</span><span class="op" id="4322136">,</span>&nbsp;<span class="num" id="4322138">0x36</span><span class="op" id="4322142">,</span>&nbsp;<span class="num" id="4322144">0x36</span><span class="op" id="4322148">,</span>&nbsp;<span class="num" id="4322150">0x36</span><span class="op" id="4322154">,</span>&nbsp;<span class="num" id="4322156">0x36</span><span class="op" id="4322160">,</span>&nbsp;<span class="num" id="4322162">0x36</span><span class="op" id="4322166">,</span>&nbsp;<span class="num" id="4322168">0x36</span><span class="op" id="4322172">,</span>&nbsp;<span class="num" id="4322174">0x36</span><span class="op" id="4322178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4322181">var</span>&nbsp;<span class="ident" id="4322185">ssl30Pad2</span>&nbsp;<span class="op" id="4322195">=</span>&nbsp;<span class="op" id="4322197">[</span><span class="num" id="4322198">48</span><span class="op" id="4322200">]</span><span class="builtintype" id="4322201">byte</span><span class="op" id="4322205">{</span><span class="num" id="4322206">0x5c</span><span class="op" id="4322210">,</span>&nbsp;<span class="num" id="4322212">0x5c</span><span class="op" id="4322216">,</span>&nbsp;<span class="num" id="4322218">0x5c</span><span class="op" id="4322222">,</span>&nbsp;<span class="num" id="4322224">0x5c</span><span class="op" id="4322228">,</span>&nbsp;<span class="num" id="4322230">0x5c</span><span class="op" id="4322234">,</span>&nbsp;<span class="num" id="4322236">0x5c</span><span class="op" id="4322240">,</span>&nbsp;<span class="num" id="4322242">0x5c</span><span class="op" id="4322246">,</span>&nbsp;<span class="num" id="4322248">0x5c</span><span class="op" id="4322252">,</span>&nbsp;<span class="num" id="4322254">0x5c</span><span class="op" id="4322258">,</span>&nbsp;<span class="num" id="4322260">0x5c</span><span class="op" id="4322264">,</span>&nbsp;<span class="num" id="4322266">0x5c</span><span class="op" id="4322270">,</span>&nbsp;<span class="num" id="4322272">0x5c</span><span class="op" id="4322276">,</span>&nbsp;<span class="num" id="4322278">0x5c</span><span class="op" id="4322282">,</span>&nbsp;<span class="num" id="4322284">0x5c</span><span class="op" id="4322288">,</span>&nbsp;<span class="num" id="4322290">0x5c</span><span class="op" id="4322294">,</span>&nbsp;<span class="num" id="4322296">0x5c</span><span class="op" id="4322300">,</span>&nbsp;<span class="num" id="4322302">0x5c</span><span class="op" id="4322306">,</span>&nbsp;<span class="num" id="4322308">0x5c</span><span class="op" id="4322312">,</span>&nbsp;<span class="num" id="4322314">0x5c</span><span class="op" id="4322318">,</span>&nbsp;<span class="num" id="4322320">0x5c</span><span class="op" id="4322324">,</span>&nbsp;<span class="num" id="4322326">0x5c</span><span class="op" id="4322330">,</span>&nbsp;<span class="num" id="4322332">0x5c</span><span class="op" id="4322336">,</span>&nbsp;<span class="num" id="4322338">0x5c</span><span class="op" id="4322342">,</span>&nbsp;<span class="num" id="4322344">0x5c</span><span class="op" id="4322348">,</span>&nbsp;<span class="num" id="4322350">0x5c</span><span class="op" id="4322354">,</span>&nbsp;<span class="num" id="4322356">0x5c</span><span class="op" id="4322360">,</span>&nbsp;<span class="num" id="4322362">0x5c</span><span class="op" id="4322366">,</span>&nbsp;<span class="num" id="4322368">0x5c</span><span class="op" id="4322372">,</span>&nbsp;<span class="num" id="4322374">0x5c</span><span class="op" id="4322378">,</span>&nbsp;<span class="num" id="4322380">0x5c</span><span class="op" id="4322384">,</span>&nbsp;<span class="num" id="4322386">0x5c</span><span class="op" id="4322390">,</span>&nbsp;<span class="num" id="4322392">0x5c</span><span class="op" id="4322396">,</span>&nbsp;<span class="num" id="4322398">0x5c</span><span class="op" id="4322402">,</span>&nbsp;<span class="num" id="4322404">0x5c</span><span class="op" id="4322408">,</span>&nbsp;<span class="num" id="4322410">0x5c</span><span class="op" id="4322414">,</span>&nbsp;<span class="num" id="4322416">0x5c</span><span class="op" id="4322420">,</span>&nbsp;<span class="num" id="4322422">0x5c</span><span class="op" id="4322426">,</span>&nbsp;<span class="num" id="4322428">0x5c</span><span class="op" id="4322432">,</span>&nbsp;<span class="num" id="4322434">0x5c</span><span class="op" id="4322438">,</span>&nbsp;<span class="num" id="4322440">0x5c</span><span class="op" id="4322444">,</span>&nbsp;<span class="num" id="4322446">0x5c</span><span class="op" id="4322450">,</span>&nbsp;<span class="num" id="4322452">0x5c</span><span class="op" id="4322456">,</span>&nbsp;<span class="num" id="4322458">0x5c</span><span class="op" id="4322462">,</span>&nbsp;<span class="num" id="4322464">0x5c</span><span class="op" id="4322468">,</span>&nbsp;<span class="num" id="4322470">0x5c</span><span class="op" id="4322474">,</span>&nbsp;<span class="num" id="4322476">0x5c</span><span class="op" id="4322480">,</span>&nbsp;<span class="num" id="4322482">0x5c</span><span class="op" id="4322486">,</span>&nbsp;<span class="num" id="4322488">0x5c</span><span class="op" id="4322492">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4322495">func</span>&nbsp;<span class="op" id="4322500">(</span><span class="ident" id="4322501">s</span>&nbsp;<span class="ident" id="4322503">ssl30MAC</span><span class="op" id="4322511">)</span>&nbsp;<span class="ident" id="4322513">MAC</span><span class="op" id="4322516">(</span><span class="ident" id="4322517">digestBuf</span><span class="op" id="4322526">,</span>&nbsp;<span class="ident" id="4322528">seq</span><span class="op" id="4322531">,</span>&nbsp;<span class="ident" id="4322533">header</span><span class="op" id="4322539">,</span>&nbsp;<span class="ident" id="4322541">data</span>&nbsp;<span class="op" id="4322546">[</span><span class="op" id="4322547">]</span><span class="builtintype" id="4322548">byte</span><span class="op" id="4322552">)</span>&nbsp;<span class="op" id="4322554">[</span><span class="op" id="4322555">]</span><span class="builtintype" id="4322556">byte</span>&nbsp;<span class="op" id="4322561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322564">padLength</span>&nbsp;<span class="op" id="4322574">:=</span>&nbsp;<span class="num" id="4322577">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322581">if</span>&nbsp;<span class="ident" id="4322584">s</span><span class="op" id="4322585">.</span><span class="ident" id="4322586">h</span><span class="op" id="4322587">.</span><span class="ident" id="4322588">Size</span><span class="op" id="4322592">(</span><span class="op" id="4322593">)</span>&nbsp;<span class="op" id="4322595">==</span>&nbsp;<span class="num" id="4322598">20</span>&nbsp;<span class="op" id="4322601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322605">padLength</span>&nbsp;<span class="op" id="4322615">=</span>&nbsp;<span class="num" id="4322617">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322625">s</span><span class="op" id="4322626">.</span><span class="ident" id="4322627">h</span><span class="op" id="4322628">.</span><span class="ident" id="4322629">Reset</span><span class="op" id="4322634">(</span><span class="op" id="4322635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322638">s</span><span class="op" id="4322639">.</span><span class="ident" id="4322640">h</span><span class="op" id="4322641">.</span><span class="ident" id="4322642">Write</span><span class="op" id="4322647">(</span><span class="ident" id="4322648">s</span><span class="op" id="4322649">.</span><span class="ident" id="4322650">key</span><span class="op" id="4322653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322656">s</span><span class="op" id="4322657">.</span><span class="ident" id="4322658">h</span><span class="op" id="4322659">.</span><span class="ident" id="4322660">Write</span><span class="op" id="4322665">(</span><span class="ident" id="4322666">ssl30Pad1</span><span class="op" id="4322675">[</span><span class="op" id="4322676">:</span><span class="ident" id="4322677">padLength</span><span class="op" id="4322686">]</span><span class="op" id="4322687">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322690">s</span><span class="op" id="4322691">.</span><span class="ident" id="4322692">h</span><span class="op" id="4322693">.</span><span class="ident" id="4322694">Write</span><span class="op" id="4322699">(</span><span class="ident" id="4322700">seq</span><span class="op" id="4322703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322706">s</span><span class="op" id="4322707">.</span><span class="ident" id="4322708">h</span><span class="op" id="4322709">.</span><span class="ident" id="4322710">Write</span><span class="op" id="4322715">(</span><span class="ident" id="4322716">header</span><span class="op" id="4322722">[</span><span class="op" id="4322723">:</span><span class="num" id="4322724">1</span><span class="op" id="4322725">]</span><span class="op" id="4322726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322729">s</span><span class="op" id="4322730">.</span><span class="ident" id="4322731">h</span><span class="op" id="4322732">.</span><span class="ident" id="4322733">Write</span><span class="op" id="4322738">(</span><span class="ident" id="4322739">header</span><span class="op" id="4322745">[</span><span class="num" id="4322746">3</span><span class="op" id="4322747">:</span><span class="num" id="4322748">5</span><span class="op" id="4322749">]</span><span class="op" id="4322750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322753">s</span><span class="op" id="4322754">.</span><span class="ident" id="4322755">h</span><span class="op" id="4322756">.</span><span class="ident" id="4322757">Write</span><span class="op" id="4322762">(</span><span class="ident" id="4322763">data</span><span class="op" id="4322767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322770">digestBuf</span>&nbsp;<span class="op" id="4322780">=</span>&nbsp;<span class="ident" id="4322782">s</span><span class="op" id="4322783">.</span><span class="ident" id="4322784">h</span><span class="op" id="4322785">.</span><span class="ident" id="4322786">Sum</span><span class="op" id="4322789">(</span><span class="ident" id="4322790">digestBuf</span><span class="op" id="4322799">[</span><span class="op" id="4322800">:</span><span class="num" id="4322801">0</span><span class="op" id="4322802">]</span><span class="op" id="4322803">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322807">s</span><span class="op" id="4322808">.</span><span class="ident" id="4322809">h</span><span class="op" id="4322810">.</span><span class="ident" id="4322811">Reset</span><span class="op" id="4322816">(</span><span class="op" id="4322817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322820">s</span><span class="op" id="4322821">.</span><span class="ident" id="4322822">h</span><span class="op" id="4322823">.</span><span class="ident" id="4322824">Write</span><span class="op" id="4322829">(</span><span class="ident" id="4322830">s</span><span class="op" id="4322831">.</span><span class="ident" id="4322832">key</span><span class="op" id="4322835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322838">s</span><span class="op" id="4322839">.</span><span class="ident" id="4322840">h</span><span class="op" id="4322841">.</span><span class="ident" id="4322842">Write</span><span class="op" id="4322847">(</span><span class="ident" id="4322848">ssl30Pad2</span><span class="op" id="4322857">[</span><span class="op" id="4322858">:</span><span class="ident" id="4322859">padLength</span><span class="op" id="4322868">]</span><span class="op" id="4322869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322872">s</span><span class="op" id="4322873">.</span><span class="ident" id="4322874">h</span><span class="op" id="4322875">.</span><span class="ident" id="4322876">Write</span><span class="op" id="4322881">(</span><span class="ident" id="4322882">digestBuf</span><span class="op" id="4322891">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322894">return</span>&nbsp;<span class="ident" id="4322901">s</span><span class="op" id="4322902">.</span><span class="ident" id="4322903">h</span><span class="op" id="4322904">.</span><span class="ident" id="4322905">Sum</span><span class="op" id="4322908">(</span><span class="ident" id="4322909">digestBuf</span><span class="op" id="4322918">[</span><span class="op" id="4322919">:</span><span class="num" id="4322920">0</span><span class="op" id="4322921">]</span><span class="op" id="4322922">)</span><br>
<span class="lineno"></span><span class="op" id="4322924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4322927">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4323001">type</span>&nbsp;<span class="ident" id="4323006">tls10MAC</span>&nbsp;<span class="keyword" id="4323015">struct</span>&nbsp;<span class="op" id="4323022">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323025">h</span>&nbsp;<span class="ident" id="4323027">hash</span><span class="op" id="4323031">.</span><span class="ident" id="4323032">Hash</span><br>
<span class="lineno"></span><span class="op" id="4323037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323040">func</span>&nbsp;<span class="op" id="4323045">(</span><span class="ident" id="4323046">s</span>&nbsp;<span class="ident" id="4323048">tls10MAC</span><span class="op" id="4323056">)</span>&nbsp;<span class="ident" id="4323058">Size</span><span class="op" id="4323062">(</span><span class="op" id="4323063">)</span>&nbsp;<span class="builtintype" id="4323065">int</span>&nbsp;<span class="op" id="4323069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323072">return</span>&nbsp;<span class="ident" id="4323079">s</span><span class="op" id="4323080">.</span><span class="ident" id="4323081">h</span><span class="op" id="4323082">.</span><span class="ident" id="4323083">Size</span><span class="op" id="4323087">(</span><span class="op" id="4323088">)</span><br>
<span class="lineno">210</span><span class="op" id="4323090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323093">func</span>&nbsp;<span class="op" id="4323098">(</span><span class="ident" id="4323099">s</span>&nbsp;<span class="ident" id="4323101">tls10MAC</span><span class="op" id="4323109">)</span>&nbsp;<span class="ident" id="4323111">MAC</span><span class="op" id="4323114">(</span><span class="ident" id="4323115">digestBuf</span><span class="op" id="4323124">,</span>&nbsp;<span class="ident" id="4323126">seq</span><span class="op" id="4323129">,</span>&nbsp;<span class="ident" id="4323131">header</span><span class="op" id="4323137">,</span>&nbsp;<span class="ident" id="4323139">data</span>&nbsp;<span class="op" id="4323144">[</span><span class="op" id="4323145">]</span><span class="builtintype" id="4323146">byte</span><span class="op" id="4323150">)</span>&nbsp;<span class="op" id="4323152">[</span><span class="op" id="4323153">]</span><span class="builtintype" id="4323154">byte</span>&nbsp;<span class="op" id="4323159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323162">s</span><span class="op" id="4323163">.</span><span class="ident" id="4323164">h</span><span class="op" id="4323165">.</span><span class="ident" id="4323166">Reset</span><span class="op" id="4323171">(</span><span class="op" id="4323172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323175">s</span><span class="op" id="4323176">.</span><span class="ident" id="4323177">h</span><span class="op" id="4323178">.</span><span class="ident" id="4323179">Write</span><span class="op" id="4323184">(</span><span class="ident" id="4323185">seq</span><span class="op" id="4323188">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323191">s</span><span class="op" id="4323192">.</span><span class="ident" id="4323193">h</span><span class="op" id="4323194">.</span><span class="ident" id="4323195">Write</span><span class="op" id="4323200">(</span><span class="ident" id="4323201">header</span><span class="op" id="4323207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323210">s</span><span class="op" id="4323211">.</span><span class="ident" id="4323212">h</span><span class="op" id="4323213">.</span><span class="ident" id="4323214">Write</span><span class="op" id="4323219">(</span><span class="ident" id="4323220">data</span><span class="op" id="4323224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323227">return</span>&nbsp;<span class="ident" id="4323234">s</span><span class="op" id="4323235">.</span><span class="ident" id="4323236">h</span><span class="op" id="4323237">.</span><span class="ident" id="4323238">Sum</span><span class="op" id="4323241">(</span><span class="ident" id="4323242">digestBuf</span><span class="op" id="4323251">[</span><span class="op" id="4323252">:</span><span class="num" id="4323253">0</span><span class="op" id="4323254">]</span><span class="op" id="4323255">)</span><br>
<span class="lineno"></span><span class="op" id="4323257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4323260">func</span>&nbsp;<span class="ident" id="4323265">rsaKA</span><span class="op" id="4323270">(</span><span class="ident" id="4323271">version</span>&nbsp;<span class="builtintype" id="4323279">uint16</span><span class="op" id="4323285">)</span>&nbsp;<span class="ident" id="4323287">keyAgreement</span>&nbsp;<span class="op" id="4323300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323303">return</span>&nbsp;<span class="ident" id="4323310">rsaKeyAgreement</span><span class="op" id="4323325">{</span><span class="op" id="4323326">}</span><br>
<span class="lineno"></span><span class="op" id="4323328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323331">func</span>&nbsp;<span class="ident" id="4323336">ecdheECDSAKA</span><span class="op" id="4323348">(</span><span class="ident" id="4323349">version</span>&nbsp;<span class="builtintype" id="4323357">uint16</span><span class="op" id="4323363">)</span>&nbsp;<span class="ident" id="4323365">keyAgreement</span>&nbsp;<span class="op" id="4323378">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323381">return</span>&nbsp;<span class="op" id="4323388">&amp;</span><span class="ident" id="4323389">ecdheKeyAgreement</span><span class="op" id="4323406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323410">sigType</span><span class="op" id="4323417">:</span>&nbsp;<span class="ident" id="4323419">signatureECDSA</span><span class="op" id="4323433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323437">version</span><span class="op" id="4323444">:</span>&nbsp;<span class="ident" id="4323446">version</span><span class="op" id="4323453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323456">}</span><br>
<span class="lineno"></span><span class="op" id="4323458">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4323461">func</span>&nbsp;<span class="ident" id="4323466">ecdheRSAKA</span><span class="op" id="4323476">(</span><span class="ident" id="4323477">version</span>&nbsp;<span class="builtintype" id="4323485">uint16</span><span class="op" id="4323491">)</span>&nbsp;<span class="ident" id="4323493">keyAgreement</span>&nbsp;<span class="op" id="4323506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323509">return</span>&nbsp;<span class="op" id="4323516">&amp;</span><span class="ident" id="4323517">ecdheKeyAgreement</span><span class="op" id="4323534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323538">sigType</span><span class="op" id="4323545">:</span>&nbsp;<span class="ident" id="4323547">signatureRSA</span><span class="op" id="4323559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323563">version</span><span class="op" id="4323570">:</span>&nbsp;<span class="ident" id="4323572">version</span><span class="op" id="4323579">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323582">}</span><br>
<span class="lineno"></span><span class="op" id="4323584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4323587">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4323656">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4323706">func</span>&nbsp;<span class="ident" id="4323711">mutualCipherSuite</span><span class="op" id="4323728">(</span><span class="ident" id="4323729">have</span>&nbsp;<span class="op" id="4323734">[</span><span class="op" id="4323735">]</span><span class="builtintype" id="4323736">uint16</span><span class="op" id="4323742">,</span>&nbsp;<span class="ident" id="4323744">want</span>&nbsp;<span class="builtintype" id="4323749">uint16</span><span class="op" id="4323755">)</span>&nbsp;<span class="op" id="4323757">*</span><span class="ident" id="4323758">cipherSuite</span>&nbsp;<span class="op" id="4323770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323773">for</span>&nbsp;<span class="ident" id="4323777">_</span><span class="op" id="4323778">,</span>&nbsp;<span class="ident" id="4323780">id</span>&nbsp;<span class="op" id="4323783">:=</span>&nbsp;<span class="keyword" id="4323786">range</span>&nbsp;<span class="ident" id="4323792">have</span>&nbsp;<span class="op" id="4323797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323801">if</span>&nbsp;<span class="ident" id="4323804">id</span>&nbsp;<span class="op" id="4323807">==</span>&nbsp;<span class="ident" id="4323810">want</span>&nbsp;<span class="op" id="4323815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323820">for</span>&nbsp;<span class="ident" id="4323824">_</span><span class="op" id="4323825">,</span>&nbsp;<span class="ident" id="4323827">suite</span>&nbsp;<span class="op" id="4323833">:=</span>&nbsp;<span class="keyword" id="4323836">range</span>&nbsp;<span class="ident" id="4323842">cipherSuites</span>&nbsp;<span class="op" id="4323855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323861">if</span>&nbsp;<span class="ident" id="4323864">suite</span><span class="op" id="4323869">.</span><span class="ident" id="4323870">id</span>&nbsp;<span class="op" id="4323873">==</span>&nbsp;<span class="ident" id="4323876">want</span>&nbsp;<span class="op" id="4323881">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323888">return</span>&nbsp;<span class="ident" id="4323895">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323915">return</span>&nbsp;<span class="builtintype" id="4323922">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323928">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323934">return</span>&nbsp;<span class="builtintype" id="4323941">nil</span><br>
<span class="lineno"></span><span class="op" id="4323945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4323948">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4324003">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4324072">const</span>&nbsp;<span class="op" id="4324078">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324081">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324121">uint16</span>&nbsp;<span class="op" id="4324128">=</span>&nbsp;<span class="num" id="4324130">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324138">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324178">uint16</span>&nbsp;<span class="op" id="4324185">=</span>&nbsp;<span class="num" id="4324187">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324195">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324235">uint16</span>&nbsp;<span class="op" id="4324242">=</span>&nbsp;<span class="num" id="4324244">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324252">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324292">uint16</span>&nbsp;<span class="op" id="4324299">=</span>&nbsp;<span class="num" id="4324301">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324309">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324349">uint16</span>&nbsp;<span class="op" id="4324356">=</span>&nbsp;<span class="num" id="4324358">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324366">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324406">uint16</span>&nbsp;<span class="op" id="4324413">=</span>&nbsp;<span class="num" id="4324415">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324423">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324463">uint16</span>&nbsp;<span class="op" id="4324470">=</span>&nbsp;<span class="num" id="4324472">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324480">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324520">uint16</span>&nbsp;<span class="op" id="4324527">=</span>&nbsp;<span class="num" id="4324529">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324537">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324577">uint16</span>&nbsp;<span class="op" id="4324584">=</span>&nbsp;<span class="num" id="4324586">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324594">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324634">uint16</span>&nbsp;<span class="op" id="4324641">=</span>&nbsp;<span class="num" id="4324643">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324651">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324691">uint16</span>&nbsp;<span class="op" id="4324698">=</span>&nbsp;<span class="num" id="4324700">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324708">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4324748">uint16</span>&nbsp;<span class="op" id="4324755">=</span>&nbsp;<span class="num" id="4324757">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324765">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4324805">uint16</span>&nbsp;<span class="op" id="4324812">=</span>&nbsp;<span class="num" id="4324814">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324823">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324892">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324943">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325009">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4325027">uint16</span>&nbsp;<span class="op" id="4325034">=</span>&nbsp;<span class="num" id="4325036">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4325043">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
