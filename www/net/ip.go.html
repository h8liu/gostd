<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1416248">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1416303">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1416357">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1416408">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="1416436">//</span><br>
<span class="lineno"></span><span class="comment" id="1416439">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1416499">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1416557">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="1416607">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="1416668">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1416699">package</span>&nbsp;<span class="ident" id="1416707">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1416712">import</span>&nbsp;<span class="string" id="1416719">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416729">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="1416760">const</span>&nbsp;<span class="op" id="1416766">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416769">IPv4len</span>&nbsp;<span class="op" id="1416777">=</span>&nbsp;<span class="num" id="1416779">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416782">IPv6len</span>&nbsp;<span class="op" id="1416790">=</span>&nbsp;<span class="num" id="1416792">16</span><br>
<span class="lineno"></span><span class="op" id="1416795">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416798">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1416849">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="1416906">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1416944">//</span><br>
<span class="lineno"></span><span class="comment" id="1416947">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="1416999">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="1417051">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="1417106">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="1417161">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1417184">type</span>&nbsp;<span class="ident" id="1417189">IP</span>&nbsp;<span class="op" id="1417192">[</span><span class="op" id="1417193">]</span><span class="builtintype" id="1417194">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417200">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="1417232">type</span>&nbsp;<span class="ident" id="1417237">IPMask</span>&nbsp;<span class="op" id="1417244">[</span><span class="op" id="1417245">]</span><span class="builtintype" id="1417246">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417252">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="1417290">type</span>&nbsp;<span class="ident" id="1417295">IPNet</span>&nbsp;<span class="keyword" id="1417301">struct</span>&nbsp;<span class="op" id="1417308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417311">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1417316"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1417323">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417342">Mask</span>&nbsp;<span class="ident" id="1417347"><a href="/net/ip.go.html#1417237">IPMask</a></span>&nbsp;<span class="comment" id="1417354">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="1417370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417373">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1417429">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="1417454">func</span>&nbsp;<span class="ident" id="1417459">IPv4</span><span class="op" id="1417463">(</span><span class="ident" id="1417464">a</span><span class="op" id="1417465">,</span>&nbsp;<span class="ident" id="1417467">b</span><span class="op" id="1417468">,</span>&nbsp;<span class="ident" id="1417470">c</span><span class="op" id="1417471">,</span>&nbsp;<span class="ident" id="1417473">d</span>&nbsp;<span class="builtintype" id="1417475">byte</span><span class="op" id="1417479">)</span>&nbsp;<span class="ident" id="1417481"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1417484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417487">p</span>&nbsp;<span class="op" id="1417489">:=</span>&nbsp;<span class="builtinfunc" id="1417492">make</span><span class="op" id="1417496">(</span><span class="ident" id="1417497"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1417499">,</span>&nbsp;<span class="ident" id="1417501"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1417508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1417511">copy</span><span class="op" id="1417515">(</span><span class="ident" id="1417516"><a href="/net/ip.go.html#1417487">p</a></span><span class="op" id="1417517">,</span>&nbsp;<span class="ident" id="1417519"><a href="/net/ip.go.html#1417594">v4InV6Prefix</a></span><span class="op" id="1417531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417534"><a href="/net/ip.go.html#1417487">p</a></span><span class="op" id="1417535">[</span><span class="num" id="1417536">12</span><span class="op" id="1417538">]</span>&nbsp;<span class="op" id="1417540">=</span>&nbsp;<span class="ident" id="1417542"><a href="/net/ip.go.html#1417464">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417545"><a href="/net/ip.go.html#1417487">p</a></span><span class="op" id="1417546">[</span><span class="num" id="1417547">13</span><span class="op" id="1417549">]</span>&nbsp;<span class="op" id="1417551">=</span>&nbsp;<span class="ident" id="1417553"><a href="/net/ip.go.html#1417467">b</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417556"><a href="/net/ip.go.html#1417487">p</a></span><span class="op" id="1417557">[</span><span class="num" id="1417558">14</span><span class="op" id="1417560">]</span>&nbsp;<span class="op" id="1417562">=</span>&nbsp;<span class="ident" id="1417564"><a href="/net/ip.go.html#1417470">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417567"><a href="/net/ip.go.html#1417487">p</a></span><span class="op" id="1417568">[</span><span class="num" id="1417569">15</span><span class="op" id="1417571">]</span>&nbsp;<span class="op" id="1417573">=</span>&nbsp;<span class="ident" id="1417575"><a href="/net/ip.go.html#1417473">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1417578">return</span>&nbsp;<span class="ident" id="1417585"><a href="/net/ip.go.html#1417487">p</a></span><br>
<span class="lineno"></span><span class="op" id="1417587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="1417590">var</span>&nbsp;<span class="ident" id="1417594">v4InV6Prefix</span>&nbsp;<span class="op" id="1417607">=</span>&nbsp;<span class="op" id="1417609">[</span><span class="op" id="1417610">]</span><span class="builtintype" id="1417611">byte</span><span class="op" id="1417615">{</span><span class="num" id="1417616">0</span><span class="op" id="1417617">,</span>&nbsp;<span class="num" id="1417619">0</span><span class="op" id="1417620">,</span>&nbsp;<span class="num" id="1417622">0</span><span class="op" id="1417623">,</span>&nbsp;<span class="num" id="1417625">0</span><span class="op" id="1417626">,</span>&nbsp;<span class="num" id="1417628">0</span><span class="op" id="1417629">,</span>&nbsp;<span class="num" id="1417631">0</span><span class="op" id="1417632">,</span>&nbsp;<span class="num" id="1417634">0</span><span class="op" id="1417635">,</span>&nbsp;<span class="num" id="1417637">0</span><span class="op" id="1417638">,</span>&nbsp;<span class="num" id="1417640">0</span><span class="op" id="1417641">,</span>&nbsp;<span class="num" id="1417643">0</span><span class="op" id="1417644">,</span>&nbsp;<span class="num" id="1417646">0xff</span><span class="op" id="1417650">,</span>&nbsp;<span class="num" id="1417652">0xff</span><span class="op" id="1417656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417659">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1417715">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="1417737">func</span>&nbsp;<span class="ident" id="1417742">IPv4Mask</span><span class="op" id="1417750">(</span><span class="ident" id="1417751">a</span><span class="op" id="1417752">,</span>&nbsp;<span class="ident" id="1417754">b</span><span class="op" id="1417755">,</span>&nbsp;<span class="ident" id="1417757">c</span><span class="op" id="1417758">,</span>&nbsp;<span class="ident" id="1417760">d</span>&nbsp;<span class="builtintype" id="1417762">byte</span><span class="op" id="1417766">)</span>&nbsp;<span class="ident" id="1417768"><a href="/net/ip.go.html#1417237">IPMask</a></span>&nbsp;<span class="op" id="1417775">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417778">p</span>&nbsp;<span class="op" id="1417780">:=</span>&nbsp;<span class="builtinfunc" id="1417783">make</span><span class="op" id="1417787">(</span><span class="ident" id="1417788"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1417794">,</span>&nbsp;<span class="ident" id="1417796"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1417803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417806"><a href="/net/ip.go.html#1417778">p</a></span><span class="op" id="1417807">[</span><span class="num" id="1417808">0</span><span class="op" id="1417809">]</span>&nbsp;<span class="op" id="1417811">=</span>&nbsp;<span class="ident" id="1417813"><a href="/net/ip.go.html#1417751">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417816"><a href="/net/ip.go.html#1417778">p</a></span><span class="op" id="1417817">[</span><span class="num" id="1417818">1</span><span class="op" id="1417819">]</span>&nbsp;<span class="op" id="1417821">=</span>&nbsp;<span class="ident" id="1417823"><a href="/net/ip.go.html#1417754">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417826"><a href="/net/ip.go.html#1417778">p</a></span><span class="op" id="1417827">[</span><span class="num" id="1417828">2</span><span class="op" id="1417829">]</span>&nbsp;<span class="op" id="1417831">=</span>&nbsp;<span class="ident" id="1417833"><a href="/net/ip.go.html#1417757">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417836"><a href="/net/ip.go.html#1417778">p</a></span><span class="op" id="1417837">[</span><span class="num" id="1417838">3</span><span class="op" id="1417839">]</span>&nbsp;<span class="op" id="1417841">=</span>&nbsp;<span class="ident" id="1417843"><a href="/net/ip.go.html#1417760">d</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1417846">return</span>&nbsp;<span class="ident" id="1417853"><a href="/net/ip.go.html#1417778">p</a></span><br>
<span class="lineno"></span><span class="op" id="1417855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417858">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="1417916">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="1417971">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="1418039">func</span>&nbsp;<span class="ident" id="1418044">CIDRMask</span><span class="op" id="1418052">(</span><span class="ident" id="1418053">ones</span><span class="op" id="1418057">,</span>&nbsp;<span class="ident" id="1418059">bits</span>&nbsp;<span class="builtintype" id="1418064">int</span><span class="op" id="1418067">)</span>&nbsp;<span class="ident" id="1418069"><a href="/net/ip.go.html#1417237">IPMask</a></span>&nbsp;<span class="op" id="1418076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418079">if</span>&nbsp;<span class="ident" id="1418082"><a href="/net/ip.go.html#1418059">bits</a></span>&nbsp;<span class="op" id="1418087">!=</span>&nbsp;<span class="num" id="1418090">8</span><span class="op" id="1418091">*</span><span class="ident" id="1418092"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1418100">&amp;&amp;</span>&nbsp;<span class="ident" id="1418103"><a href="/net/ip.go.html#1418059">bits</a></span>&nbsp;<span class="op" id="1418108">!=</span>&nbsp;<span class="num" id="1418111">8</span><span class="op" id="1418112">*</span><span class="ident" id="1418113"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1418121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418125">return</span>&nbsp;<span class="ident" id="1418132">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418137">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418140">if</span>&nbsp;<span class="ident" id="1418143"><a href="/net/ip.go.html#1418053">ones</a></span>&nbsp;<span class="op" id="1418148">&lt;</span>&nbsp;<span class="num" id="1418150">0</span>&nbsp;<span class="op" id="1418152">||</span>&nbsp;<span class="ident" id="1418155"><a href="/net/ip.go.html#1418053">ones</a></span>&nbsp;<span class="op" id="1418160">&gt;</span>&nbsp;<span class="ident" id="1418162"><a href="/net/ip.go.html#1418059">bits</a></span>&nbsp;<span class="op" id="1418167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418171">return</span>&nbsp;<span class="ident" id="1418178">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418186">l</span>&nbsp;<span class="op" id="1418188">:=</span>&nbsp;<span class="ident" id="1418191"><a href="/net/ip.go.html#1418059">bits</a></span>&nbsp;<span class="op" id="1418196">/</span>&nbsp;<span class="num" id="1418198">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418201">m</span>&nbsp;<span class="op" id="1418203">:=</span>&nbsp;<span class="builtinfunc" id="1418206">make</span><span class="op" id="1418210">(</span><span class="ident" id="1418211"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1418217">,</span>&nbsp;<span class="ident" id="1418219"><a href="/net/ip.go.html#1418186">l</a></span><span class="op" id="1418220">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418223">n</span>&nbsp;<span class="op" id="1418225">:=</span>&nbsp;<span class="builtintype" id="1418228">uint</span><span class="op" id="1418232">(</span><span class="ident" id="1418233"><a href="/net/ip.go.html#1418053">ones</a></span><span class="op" id="1418237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418240">for</span>&nbsp;<span class="ident" id="1418244">i</span>&nbsp;<span class="op" id="1418246">:=</span>&nbsp;<span class="num" id="1418249">0</span><span class="op" id="1418250">;</span>&nbsp;<span class="ident" id="1418252"><a href="/net/ip.go.html#1418244">i</a></span>&nbsp;<span class="op" id="1418254">&lt;</span>&nbsp;<span class="ident" id="1418256"><a href="/net/ip.go.html#1418186">l</a></span><span class="op" id="1418257">;</span>&nbsp;<span class="ident" id="1418259"><a href="/net/ip.go.html#1418244">i</a></span><span class="op" id="1418260">++</span>&nbsp;<span class="op" id="1418263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418267">if</span>&nbsp;<span class="ident" id="1418270"><a href="/net/ip.go.html#1418223">n</a></span>&nbsp;<span class="op" id="1418272">&gt;=</span>&nbsp;<span class="num" id="1418275">8</span>&nbsp;<span class="op" id="1418277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418282"><a href="/net/ip.go.html#1418201">m</a></span><span class="op" id="1418283">[</span><span class="ident" id="1418284"><a href="/net/ip.go.html#1418244">i</a></span><span class="op" id="1418285">]</span>&nbsp;<span class="op" id="1418287">=</span>&nbsp;<span class="num" id="1418289">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418297"><a href="/net/ip.go.html#1418223">n</a></span>&nbsp;<span class="op" id="1418299">-=</span>&nbsp;<span class="num" id="1418302">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418307">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418322"><a href="/net/ip.go.html#1418201">m</a></span><span class="op" id="1418323">[</span><span class="ident" id="1418324"><a href="/net/ip.go.html#1418244">i</a></span><span class="op" id="1418325">]</span>&nbsp;<span class="op" id="1418327">=</span>&nbsp;<span class="op" id="1418329">^</span><span class="builtintype" id="1418330">byte</span><span class="op" id="1418334">(</span><span class="num" id="1418335">0xff</span>&nbsp;<span class="op" id="1418340">&gt;&gt;</span>&nbsp;<span class="ident" id="1418343"><a href="/net/ip.go.html#1418223">n</a></span><span class="op" id="1418344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418348"><a href="/net/ip.go.html#1418223">n</a></span>&nbsp;<span class="op" id="1418350">=</span>&nbsp;<span class="num" id="1418352">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418355">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418358">return</span>&nbsp;<span class="ident" id="1418365"><a href="/net/ip.go.html#1418201">m</a></span><br>
<span class="lineno"></span><span class="op" id="1418367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1418370">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="1418399">var</span>&nbsp;<span class="op" id="1418403">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418406">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418420">=</span>&nbsp;<span class="ident" id="1418422"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1418426">(</span><span class="num" id="1418427">255</span><span class="op" id="1418430">,</span>&nbsp;<span class="num" id="1418432">255</span><span class="op" id="1418435">,</span>&nbsp;<span class="num" id="1418437">255</span><span class="op" id="1418440">,</span>&nbsp;<span class="num" id="1418442">255</span><span class="op" id="1418445">)</span>&nbsp;<span class="comment" id="1418447">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418461">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418475">=</span>&nbsp;<span class="ident" id="1418477"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1418481">(</span><span class="num" id="1418482">224</span><span class="op" id="1418485">,</span>&nbsp;<span class="num" id="1418487">0</span><span class="op" id="1418488">,</span>&nbsp;<span class="num" id="1418490">0</span><span class="op" id="1418491">,</span>&nbsp;<span class="num" id="1418493">1</span><span class="op" id="1418494">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1418502">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418518">IPv4allrouter</span>&nbsp;<span class="op" id="1418532">=</span>&nbsp;<span class="ident" id="1418534"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1418538">(</span><span class="num" id="1418539">224</span><span class="op" id="1418542">,</span>&nbsp;<span class="num" id="1418544">0</span><span class="op" id="1418545">,</span>&nbsp;<span class="num" id="1418547">0</span><span class="op" id="1418548">,</span>&nbsp;<span class="num" id="1418550">2</span><span class="op" id="1418551">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1418559">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418575">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418589">=</span>&nbsp;<span class="ident" id="1418591"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1418595">(</span><span class="num" id="1418596">0</span><span class="op" id="1418597">,</span>&nbsp;<span class="num" id="1418599">0</span><span class="op" id="1418600">,</span>&nbsp;<span class="num" id="1418602">0</span><span class="op" id="1418603">,</span>&nbsp;<span class="num" id="1418605">0</span><span class="op" id="1418606">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1418616">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="1418629">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="1418632">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="1418661">var</span>&nbsp;<span class="op" id="1418665">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418668">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418695">=</span>&nbsp;<span class="ident" id="1418697"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1418699">{</span><span class="num" id="1418700">0</span><span class="op" id="1418701">,</span>&nbsp;<span class="num" id="1418703">0</span><span class="op" id="1418704">,</span>&nbsp;<span class="num" id="1418706">0</span><span class="op" id="1418707">,</span>&nbsp;<span class="num" id="1418709">0</span><span class="op" id="1418710">,</span>&nbsp;<span class="num" id="1418712">0</span><span class="op" id="1418713">,</span>&nbsp;<span class="num" id="1418715">0</span><span class="op" id="1418716">,</span>&nbsp;<span class="num" id="1418718">0</span><span class="op" id="1418719">,</span>&nbsp;<span class="num" id="1418721">0</span><span class="op" id="1418722">,</span>&nbsp;<span class="num" id="1418724">0</span><span class="op" id="1418725">,</span>&nbsp;<span class="num" id="1418727">0</span><span class="op" id="1418728">,</span>&nbsp;<span class="num" id="1418730">0</span><span class="op" id="1418731">,</span>&nbsp;<span class="num" id="1418733">0</span><span class="op" id="1418734">,</span>&nbsp;<span class="num" id="1418736">0</span><span class="op" id="1418737">,</span>&nbsp;<span class="num" id="1418739">0</span><span class="op" id="1418740">,</span>&nbsp;<span class="num" id="1418742">0</span><span class="op" id="1418743">,</span>&nbsp;<span class="num" id="1418745">0</span><span class="op" id="1418746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418749">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418776">=</span>&nbsp;<span class="ident" id="1418778"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1418780">{</span><span class="num" id="1418781">0</span><span class="op" id="1418782">,</span>&nbsp;<span class="num" id="1418784">0</span><span class="op" id="1418785">,</span>&nbsp;<span class="num" id="1418787">0</span><span class="op" id="1418788">,</span>&nbsp;<span class="num" id="1418790">0</span><span class="op" id="1418791">,</span>&nbsp;<span class="num" id="1418793">0</span><span class="op" id="1418794">,</span>&nbsp;<span class="num" id="1418796">0</span><span class="op" id="1418797">,</span>&nbsp;<span class="num" id="1418799">0</span><span class="op" id="1418800">,</span>&nbsp;<span class="num" id="1418802">0</span><span class="op" id="1418803">,</span>&nbsp;<span class="num" id="1418805">0</span><span class="op" id="1418806">,</span>&nbsp;<span class="num" id="1418808">0</span><span class="op" id="1418809">,</span>&nbsp;<span class="num" id="1418811">0</span><span class="op" id="1418812">,</span>&nbsp;<span class="num" id="1418814">0</span><span class="op" id="1418815">,</span>&nbsp;<span class="num" id="1418817">0</span><span class="op" id="1418818">,</span>&nbsp;<span class="num" id="1418820">0</span><span class="op" id="1418821">,</span>&nbsp;<span class="num" id="1418823">0</span><span class="op" id="1418824">,</span>&nbsp;<span class="num" id="1418826">0</span><span class="op" id="1418827">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418830">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1418857">=</span>&nbsp;<span class="ident" id="1418859"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1418861">{</span><span class="num" id="1418862">0</span><span class="op" id="1418863">,</span>&nbsp;<span class="num" id="1418865">0</span><span class="op" id="1418866">,</span>&nbsp;<span class="num" id="1418868">0</span><span class="op" id="1418869">,</span>&nbsp;<span class="num" id="1418871">0</span><span class="op" id="1418872">,</span>&nbsp;<span class="num" id="1418874">0</span><span class="op" id="1418875">,</span>&nbsp;<span class="num" id="1418877">0</span><span class="op" id="1418878">,</span>&nbsp;<span class="num" id="1418880">0</span><span class="op" id="1418881">,</span>&nbsp;<span class="num" id="1418883">0</span><span class="op" id="1418884">,</span>&nbsp;<span class="num" id="1418886">0</span><span class="op" id="1418887">,</span>&nbsp;<span class="num" id="1418889">0</span><span class="op" id="1418890">,</span>&nbsp;<span class="num" id="1418892">0</span><span class="op" id="1418893">,</span>&nbsp;<span class="num" id="1418895">0</span><span class="op" id="1418896">,</span>&nbsp;<span class="num" id="1418898">0</span><span class="op" id="1418899">,</span>&nbsp;<span class="num" id="1418901">0</span><span class="op" id="1418902">,</span>&nbsp;<span class="num" id="1418904">0</span><span class="op" id="1418905">,</span>&nbsp;<span class="num" id="1418907">1</span><span class="op" id="1418908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418911">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="1418938">=</span>&nbsp;<span class="ident" id="1418940"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1418942">{</span><span class="num" id="1418943">0xff</span><span class="op" id="1418947">,</span>&nbsp;<span class="num" id="1418949">0x01</span><span class="op" id="1418953">,</span>&nbsp;<span class="num" id="1418955">0</span><span class="op" id="1418956">,</span>&nbsp;<span class="num" id="1418958">0</span><span class="op" id="1418959">,</span>&nbsp;<span class="num" id="1418961">0</span><span class="op" id="1418962">,</span>&nbsp;<span class="num" id="1418964">0</span><span class="op" id="1418965">,</span>&nbsp;<span class="num" id="1418967">0</span><span class="op" id="1418968">,</span>&nbsp;<span class="num" id="1418970">0</span><span class="op" id="1418971">,</span>&nbsp;<span class="num" id="1418973">0</span><span class="op" id="1418974">,</span>&nbsp;<span class="num" id="1418976">0</span><span class="op" id="1418977">,</span>&nbsp;<span class="num" id="1418979">0</span><span class="op" id="1418980">,</span>&nbsp;<span class="num" id="1418982">0</span><span class="op" id="1418983">,</span>&nbsp;<span class="num" id="1418985">0</span><span class="op" id="1418986">,</span>&nbsp;<span class="num" id="1418988">0</span><span class="op" id="1418989">,</span>&nbsp;<span class="num" id="1418991">0</span><span class="op" id="1418992">,</span>&nbsp;<span class="num" id="1418994">0x01</span><span class="op" id="1418998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419001">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1419028">=</span>&nbsp;<span class="ident" id="1419030"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419032">{</span><span class="num" id="1419033">0xff</span><span class="op" id="1419037">,</span>&nbsp;<span class="num" id="1419039">0x02</span><span class="op" id="1419043">,</span>&nbsp;<span class="num" id="1419045">0</span><span class="op" id="1419046">,</span>&nbsp;<span class="num" id="1419048">0</span><span class="op" id="1419049">,</span>&nbsp;<span class="num" id="1419051">0</span><span class="op" id="1419052">,</span>&nbsp;<span class="num" id="1419054">0</span><span class="op" id="1419055">,</span>&nbsp;<span class="num" id="1419057">0</span><span class="op" id="1419058">,</span>&nbsp;<span class="num" id="1419060">0</span><span class="op" id="1419061">,</span>&nbsp;<span class="num" id="1419063">0</span><span class="op" id="1419064">,</span>&nbsp;<span class="num" id="1419066">0</span><span class="op" id="1419067">,</span>&nbsp;<span class="num" id="1419069">0</span><span class="op" id="1419070">,</span>&nbsp;<span class="num" id="1419072">0</span><span class="op" id="1419073">,</span>&nbsp;<span class="num" id="1419075">0</span><span class="op" id="1419076">,</span>&nbsp;<span class="num" id="1419078">0</span><span class="op" id="1419079">,</span>&nbsp;<span class="num" id="1419081">0</span><span class="op" id="1419082">,</span>&nbsp;<span class="num" id="1419084">0x01</span><span class="op" id="1419088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419091">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1419118">=</span>&nbsp;<span class="ident" id="1419120"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419122">{</span><span class="num" id="1419123">0xff</span><span class="op" id="1419127">,</span>&nbsp;<span class="num" id="1419129">0x02</span><span class="op" id="1419133">,</span>&nbsp;<span class="num" id="1419135">0</span><span class="op" id="1419136">,</span>&nbsp;<span class="num" id="1419138">0</span><span class="op" id="1419139">,</span>&nbsp;<span class="num" id="1419141">0</span><span class="op" id="1419142">,</span>&nbsp;<span class="num" id="1419144">0</span><span class="op" id="1419145">,</span>&nbsp;<span class="num" id="1419147">0</span><span class="op" id="1419148">,</span>&nbsp;<span class="num" id="1419150">0</span><span class="op" id="1419151">,</span>&nbsp;<span class="num" id="1419153">0</span><span class="op" id="1419154">,</span>&nbsp;<span class="num" id="1419156">0</span><span class="op" id="1419157">,</span>&nbsp;<span class="num" id="1419159">0</span><span class="op" id="1419160">,</span>&nbsp;<span class="num" id="1419162">0</span><span class="op" id="1419163">,</span>&nbsp;<span class="num" id="1419165">0</span><span class="op" id="1419166">,</span>&nbsp;<span class="num" id="1419168">0</span><span class="op" id="1419169">,</span>&nbsp;<span class="num" id="1419171">0</span><span class="op" id="1419172">,</span>&nbsp;<span class="num" id="1419174">0x02</span><span class="op" id="1419178">}</span><br>
<span class="lineno"></span><span class="op" id="1419180">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="1419183">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1419246">func</span>&nbsp;<span class="op" id="1419251">(</span><span class="ident" id="1419252">ip</span>&nbsp;<span class="ident" id="1419255"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419257">)</span>&nbsp;<span class="ident" id="1419259">IsUnspecified</span><span class="op" id="1419272">(</span><span class="op" id="1419273">)</span>&nbsp;<span class="builtintype" id="1419275">bool</span>&nbsp;<span class="op" id="1419280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419283">if</span>&nbsp;<span class="ident" id="1419286"><a href="/net/ip.go.html#1419252">ip</a></span><span class="op" id="1419288">.</span><span class="ident" id="1419289">Equal</span><span class="op" id="1419294">(</span><span class="ident" id="1419295"><a href="/net/ip.go.html#1418575">IPv4zero</a></span><span class="op" id="1419303">)</span>&nbsp;<span class="op" id="1419305">||</span>&nbsp;<span class="ident" id="1419308"><a href="/net/ip.go.html#1419252">ip</a></span><span class="op" id="1419310">.</span><span class="ident" id="1419311">Equal</span><span class="op" id="1419316">(</span><span class="ident" id="1419317"><a href="/net/ip.go.html#1418749">IPv6unspecified</a></span><span class="op" id="1419332">)</span>&nbsp;<span class="op" id="1419334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419338">return</span>&nbsp;<span class="builtintype" id="1419345">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419354">return</span>&nbsp;<span class="builtintype" id="1419361">false</span><br>
<span class="lineno"></span><span class="op" id="1419367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1419370">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="1419426">func</span>&nbsp;<span class="op" id="1419431">(</span><span class="ident" id="1419432">ip</span>&nbsp;<span class="ident" id="1419435"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419437">)</span>&nbsp;<span class="ident" id="1419439">IsLoopback</span><span class="op" id="1419449">(</span><span class="op" id="1419450">)</span>&nbsp;<span class="builtintype" id="1419452">bool</span>&nbsp;<span class="op" id="1419457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419460">if</span>&nbsp;<span class="ident" id="1419463">ip4</span>&nbsp;<span class="op" id="1419467">:=</span>&nbsp;<span class="ident" id="1419470"><a href="/net/ip.go.html#1419432">ip</a></span><span class="op" id="1419472">.</span><span class="ident" id="1419473">To4</span><span class="op" id="1419476">(</span><span class="op" id="1419477">)</span><span class="op" id="1419478">;</span>&nbsp;<span class="ident" id="1419480"><a href="/net/ip.go.html#1419463">ip4</a></span>&nbsp;<span class="op" id="1419484">!=</span>&nbsp;<span class="ident" id="1419487">nil</span>&nbsp;<span class="op" id="1419491">&amp;&amp;</span>&nbsp;<span class="ident" id="1419494"><a href="/net/ip.go.html#1419463">ip4</a></span><span class="op" id="1419497">[</span><span class="num" id="1419498">0</span><span class="op" id="1419499">]</span>&nbsp;<span class="op" id="1419501">==</span>&nbsp;<span class="num" id="1419504">127</span>&nbsp;<span class="op" id="1419508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419512">return</span>&nbsp;<span class="builtintype" id="1419519">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419528">return</span>&nbsp;<span class="ident" id="1419535"><a href="/net/ip.go.html#1419432">ip</a></span><span class="op" id="1419537">.</span><span class="ident" id="1419538">Equal</span><span class="op" id="1419543">(</span><span class="ident" id="1419544"><a href="/net/ip.go.html#1418830">IPv6loopback</a></span><span class="op" id="1419556">)</span><br>
<span class="lineno">125</span><span class="op" id="1419558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1419561">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1419619">func</span>&nbsp;<span class="op" id="1419624">(</span><span class="ident" id="1419625">ip</span>&nbsp;<span class="ident" id="1419628"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419630">)</span>&nbsp;<span class="ident" id="1419632">IsMulticast</span><span class="op" id="1419643">(</span><span class="op" id="1419644">)</span>&nbsp;<span class="builtintype" id="1419646">bool</span>&nbsp;<span class="op" id="1419651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419654">if</span>&nbsp;<span class="ident" id="1419657">ip4</span>&nbsp;<span class="op" id="1419661">:=</span>&nbsp;<span class="ident" id="1419664"><a href="/net/ip.go.html#1419625">ip</a></span><span class="op" id="1419666">.</span><span class="ident" id="1419667">To4</span><span class="op" id="1419670">(</span><span class="op" id="1419671">)</span><span class="op" id="1419672">;</span>&nbsp;<span class="ident" id="1419674"><a href="/net/ip.go.html#1419657">ip4</a></span>&nbsp;<span class="op" id="1419678">!=</span>&nbsp;<span class="ident" id="1419681">nil</span>&nbsp;<span class="op" id="1419685">&amp;&amp;</span>&nbsp;<span class="ident" id="1419688"><a href="/net/ip.go.html#1419657">ip4</a></span><span class="op" id="1419691">[</span><span class="num" id="1419692">0</span><span class="op" id="1419693">]</span><span class="op" id="1419694">&amp;</span><span class="num" id="1419695">0xf0</span>&nbsp;<span class="op" id="1419700">==</span>&nbsp;<span class="num" id="1419703">0xe0</span>&nbsp;<span class="op" id="1419708">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419712">return</span>&nbsp;<span class="builtintype" id="1419719">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419728">return</span>&nbsp;<span class="ident" id="1419735"><a href="/net/ip.go.html#1419625">ip</a></span><span class="op" id="1419737">[</span><span class="num" id="1419738">0</span><span class="op" id="1419739">]</span>&nbsp;<span class="op" id="1419741">==</span>&nbsp;<span class="num" id="1419744">0xff</span><br>
<span class="lineno"></span><span class="op" id="1419749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1419752">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1419807">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1419848">func</span>&nbsp;<span class="op" id="1419853">(</span><span class="ident" id="1419854">ip</span>&nbsp;<span class="ident" id="1419857"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1419859">)</span>&nbsp;<span class="ident" id="1419861">IsInterfaceLocalMulticast</span><span class="op" id="1419886">(</span><span class="op" id="1419887">)</span>&nbsp;<span class="builtintype" id="1419889">bool</span>&nbsp;<span class="op" id="1419894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419897">return</span>&nbsp;<span class="builtinfunc" id="1419904">len</span><span class="op" id="1419907">(</span><span class="ident" id="1419908"><a href="/net/ip.go.html#1419854">ip</a></span><span class="op" id="1419910">)</span>&nbsp;<span class="op" id="1419912">==</span>&nbsp;<span class="ident" id="1419915"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1419923">&amp;&amp;</span>&nbsp;<span class="ident" id="1419926"><a href="/net/ip.go.html#1419854">ip</a></span><span class="op" id="1419928">[</span><span class="num" id="1419929">0</span><span class="op" id="1419930">]</span>&nbsp;<span class="op" id="1419932">==</span>&nbsp;<span class="num" id="1419935">0xff</span>&nbsp;<span class="op" id="1419940">&amp;&amp;</span>&nbsp;<span class="ident" id="1419943"><a href="/net/ip.go.html#1419854">ip</a></span><span class="op" id="1419945">[</span><span class="num" id="1419946">1</span><span class="op" id="1419947">]</span><span class="op" id="1419948">&amp;</span><span class="num" id="1419949">0x0f</span>&nbsp;<span class="op" id="1419954">==</span>&nbsp;<span class="num" id="1419957">0x01</span><br>
<span class="lineno"></span><span class="op" id="1419962">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1419965">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="1420024">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1420046">func</span>&nbsp;<span class="op" id="1420051">(</span><span class="ident" id="1420052">ip</span>&nbsp;<span class="ident" id="1420055"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1420057">)</span>&nbsp;<span class="ident" id="1420059">IsLinkLocalMulticast</span><span class="op" id="1420079">(</span><span class="op" id="1420080">)</span>&nbsp;<span class="builtintype" id="1420082">bool</span>&nbsp;<span class="op" id="1420087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420090">if</span>&nbsp;<span class="ident" id="1420093">ip4</span>&nbsp;<span class="op" id="1420097">:=</span>&nbsp;<span class="ident" id="1420100"><a href="/net/ip.go.html#1420052">ip</a></span><span class="op" id="1420102">.</span><span class="ident" id="1420103">To4</span><span class="op" id="1420106">(</span><span class="op" id="1420107">)</span><span class="op" id="1420108">;</span>&nbsp;<span class="ident" id="1420110"><a href="/net/ip.go.html#1420093">ip4</a></span>&nbsp;<span class="op" id="1420114">!=</span>&nbsp;<span class="ident" id="1420117">nil</span>&nbsp;<span class="op" id="1420121">&amp;&amp;</span>&nbsp;<span class="ident" id="1420124"><a href="/net/ip.go.html#1420093">ip4</a></span><span class="op" id="1420127">[</span><span class="num" id="1420128">0</span><span class="op" id="1420129">]</span>&nbsp;<span class="op" id="1420131">==</span>&nbsp;<span class="num" id="1420134">224</span>&nbsp;<span class="op" id="1420138">&amp;&amp;</span>&nbsp;<span class="ident" id="1420141"><a href="/net/ip.go.html#1420093">ip4</a></span><span class="op" id="1420144">[</span><span class="num" id="1420145">1</span><span class="op" id="1420146">]</span>&nbsp;<span class="op" id="1420148">==</span>&nbsp;<span class="num" id="1420151">0</span>&nbsp;<span class="op" id="1420153">&amp;&amp;</span>&nbsp;<span class="ident" id="1420156"><a href="/net/ip.go.html#1420093">ip4</a></span><span class="op" id="1420159">[</span><span class="num" id="1420160">2</span><span class="op" id="1420161">]</span>&nbsp;<span class="op" id="1420163">==</span>&nbsp;<span class="num" id="1420166">0</span>&nbsp;<span class="op" id="1420168">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420172">return</span>&nbsp;<span class="builtintype" id="1420179">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420188">return</span>&nbsp;<span class="ident" id="1420195"><a href="/net/ip.go.html#1420052">ip</a></span><span class="op" id="1420197">[</span><span class="num" id="1420198">0</span><span class="op" id="1420199">]</span>&nbsp;<span class="op" id="1420201">==</span>&nbsp;<span class="num" id="1420204">0xff</span>&nbsp;<span class="op" id="1420209">&amp;&amp;</span>&nbsp;<span class="ident" id="1420212"><a href="/net/ip.go.html#1420052">ip</a></span><span class="op" id="1420214">[</span><span class="num" id="1420215">1</span><span class="op" id="1420216">]</span><span class="op" id="1420217">&amp;</span><span class="num" id="1420218">0x0f</span>&nbsp;<span class="op" id="1420223">==</span>&nbsp;<span class="num" id="1420226">0x02</span><br>
<span class="lineno"></span><span class="op" id="1420231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="1420234">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="1420291">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1420311">func</span>&nbsp;<span class="op" id="1420316">(</span><span class="ident" id="1420317">ip</span>&nbsp;<span class="ident" id="1420320"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1420322">)</span>&nbsp;<span class="ident" id="1420324">IsLinkLocalUnicast</span><span class="op" id="1420342">(</span><span class="op" id="1420343">)</span>&nbsp;<span class="builtintype" id="1420345">bool</span>&nbsp;<span class="op" id="1420350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420353">if</span>&nbsp;<span class="ident" id="1420356">ip4</span>&nbsp;<span class="op" id="1420360">:=</span>&nbsp;<span class="ident" id="1420363"><a href="/net/ip.go.html#1420317">ip</a></span><span class="op" id="1420365">.</span><span class="ident" id="1420366">To4</span><span class="op" id="1420369">(</span><span class="op" id="1420370">)</span><span class="op" id="1420371">;</span>&nbsp;<span class="ident" id="1420373"><a href="/net/ip.go.html#1420356">ip4</a></span>&nbsp;<span class="op" id="1420377">!=</span>&nbsp;<span class="ident" id="1420380">nil</span>&nbsp;<span class="op" id="1420384">&amp;&amp;</span>&nbsp;<span class="ident" id="1420387"><a href="/net/ip.go.html#1420356">ip4</a></span><span class="op" id="1420390">[</span><span class="num" id="1420391">0</span><span class="op" id="1420392">]</span>&nbsp;<span class="op" id="1420394">==</span>&nbsp;<span class="num" id="1420397">169</span>&nbsp;<span class="op" id="1420401">&amp;&amp;</span>&nbsp;<span class="ident" id="1420404"><a href="/net/ip.go.html#1420356">ip4</a></span><span class="op" id="1420407">[</span><span class="num" id="1420408">1</span><span class="op" id="1420409">]</span>&nbsp;<span class="op" id="1420411">==</span>&nbsp;<span class="num" id="1420414">254</span>&nbsp;<span class="op" id="1420418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420422">return</span>&nbsp;<span class="builtintype" id="1420429">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420438">return</span>&nbsp;<span class="ident" id="1420445"><a href="/net/ip.go.html#1420317">ip</a></span><span class="op" id="1420447">[</span><span class="num" id="1420448">0</span><span class="op" id="1420449">]</span>&nbsp;<span class="op" id="1420451">==</span>&nbsp;<span class="num" id="1420454">0xfe</span>&nbsp;<span class="op" id="1420459">&amp;&amp;</span>&nbsp;<span class="ident" id="1420462"><a href="/net/ip.go.html#1420317">ip</a></span><span class="op" id="1420464">[</span><span class="num" id="1420465">1</span><span class="op" id="1420466">]</span><span class="op" id="1420467">&amp;</span><span class="num" id="1420468">0xc0</span>&nbsp;<span class="op" id="1420473">==</span>&nbsp;<span class="num" id="1420476">0x80</span><br>
<span class="lineno"></span><span class="op" id="1420481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420484">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="1420542">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1420554">func</span>&nbsp;<span class="op" id="1420559">(</span><span class="ident" id="1420560">ip</span>&nbsp;<span class="ident" id="1420563"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1420565">)</span>&nbsp;<span class="ident" id="1420567">IsGlobalUnicast</span><span class="op" id="1420582">(</span><span class="op" id="1420583">)</span>&nbsp;<span class="builtintype" id="1420585">bool</span>&nbsp;<span class="op" id="1420590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420593">return</span>&nbsp;<span class="op" id="1420600">!</span><span class="ident" id="1420601"><a href="/net/ip.go.html#1420560">ip</a></span><span class="op" id="1420603">.</span><span class="ident" id="1420604">IsUnspecified</span><span class="op" id="1420617">(</span><span class="op" id="1420618">)</span>&nbsp;<span class="op" id="1420620">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420625">!</span><span class="ident" id="1420626"><a href="/net/ip.go.html#1420560">ip</a></span><span class="op" id="1420628">.</span><span class="ident" id="1420629">IsLoopback</span><span class="op" id="1420639">(</span><span class="op" id="1420640">)</span>&nbsp;<span class="op" id="1420642">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420647">!</span><span class="ident" id="1420648"><a href="/net/ip.go.html#1420560">ip</a></span><span class="op" id="1420650">.</span><span class="ident" id="1420651">IsMulticast</span><span class="op" id="1420662">(</span><span class="op" id="1420663">)</span>&nbsp;<span class="op" id="1420665">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420670">!</span><span class="ident" id="1420671"><a href="/net/ip.go.html#1420560">ip</a></span><span class="op" id="1420673">.</span><span class="ident" id="1420674">IsLinkLocalUnicast</span><span class="op" id="1420692">(</span><span class="op" id="1420693">)</span><br>
<span class="lineno"></span><span class="op" id="1420695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420698">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="1420717">func</span>&nbsp;<span class="ident" id="1420722">isZeros</span><span class="op" id="1420729">(</span><span class="ident" id="1420730">p</span>&nbsp;<span class="ident" id="1420732"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1420734">)</span>&nbsp;<span class="builtintype" id="1420736">bool</span>&nbsp;<span class="op" id="1420741">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420744">for</span>&nbsp;<span class="ident" id="1420748">i</span>&nbsp;<span class="op" id="1420750">:=</span>&nbsp;<span class="num" id="1420753">0</span><span class="op" id="1420754">;</span>&nbsp;<span class="ident" id="1420756"><a href="/net/ip.go.html#1420748">i</a></span>&nbsp;<span class="op" id="1420758">&lt;</span>&nbsp;<span class="builtinfunc" id="1420760">len</span><span class="op" id="1420763">(</span><span class="ident" id="1420764"><a href="/net/ip.go.html#1420730">p</a></span><span class="op" id="1420765">)</span><span class="op" id="1420766">;</span>&nbsp;<span class="ident" id="1420768"><a href="/net/ip.go.html#1420748">i</a></span><span class="op" id="1420769">++</span>&nbsp;<span class="op" id="1420772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420776">if</span>&nbsp;<span class="ident" id="1420779"><a href="/net/ip.go.html#1420730">p</a></span><span class="op" id="1420780">[</span><span class="ident" id="1420781"><a href="/net/ip.go.html#1420748">i</a></span><span class="op" id="1420782">]</span>&nbsp;<span class="op" id="1420784">!=</span>&nbsp;<span class="num" id="1420787">0</span>&nbsp;<span class="op" id="1420789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420794">return</span>&nbsp;<span class="builtintype" id="1420801">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420812">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420815">return</span>&nbsp;<span class="builtintype" id="1420822">true</span><br>
<span class="lineno"></span><span class="op" id="1420827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420830">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="1420894">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="1420944">func</span>&nbsp;<span class="op" id="1420949">(</span><span class="ident" id="1420950">ip</span>&nbsp;<span class="ident" id="1420953"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1420955">)</span>&nbsp;<span class="ident" id="1420957">To4</span><span class="op" id="1420960">(</span><span class="op" id="1420961">)</span>&nbsp;<span class="ident" id="1420963"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1420966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420969">if</span>&nbsp;<span class="builtinfunc" id="1420972">len</span><span class="op" id="1420975">(</span><span class="ident" id="1420976"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1420978">)</span>&nbsp;<span class="op" id="1420980">==</span>&nbsp;<span class="ident" id="1420983"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1420991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420995">return</span>&nbsp;<span class="ident" id="1421002"><a href="/net/ip.go.html#1420950">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421009">if</span>&nbsp;<span class="builtinfunc" id="1421012">len</span><span class="op" id="1421015">(</span><span class="ident" id="1421016"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1421018">)</span>&nbsp;<span class="op" id="1421020">==</span>&nbsp;<span class="ident" id="1421023"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1421031">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421036"><a href="/net/ip.go.html#1420722">isZeros</a></span><span class="op" id="1421043">(</span><span class="ident" id="1421044"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1421046">[</span><span class="num" id="1421047">0</span><span class="op" id="1421048">:</span><span class="num" id="1421049">10</span><span class="op" id="1421051">]</span><span class="op" id="1421052">)</span>&nbsp;<span class="op" id="1421054">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421059"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1421061">[</span><span class="num" id="1421062">10</span><span class="op" id="1421064">]</span>&nbsp;<span class="op" id="1421066">==</span>&nbsp;<span class="num" id="1421069">0xff</span>&nbsp;<span class="op" id="1421074">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421079"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1421081">[</span><span class="num" id="1421082">11</span><span class="op" id="1421084">]</span>&nbsp;<span class="op" id="1421086">==</span>&nbsp;<span class="num" id="1421089">0xff</span>&nbsp;<span class="op" id="1421094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421098">return</span>&nbsp;<span class="ident" id="1421105"><a href="/net/ip.go.html#1420950">ip</a></span><span class="op" id="1421107">[</span><span class="num" id="1421108">12</span><span class="op" id="1421110">:</span><span class="num" id="1421111">16</span><span class="op" id="1421113">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421116">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421119">return</span>&nbsp;<span class="ident" id="1421126">nil</span><br>
<span class="lineno"></span><span class="op" id="1421130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1421133">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="1421197">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="1421271">func</span>&nbsp;<span class="op" id="1421276">(</span><span class="ident" id="1421277">ip</span>&nbsp;<span class="ident" id="1421280"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1421282">)</span>&nbsp;<span class="ident" id="1421284">To16</span><span class="op" id="1421288">(</span><span class="op" id="1421289">)</span>&nbsp;<span class="ident" id="1421291"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1421294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421297">if</span>&nbsp;<span class="builtinfunc" id="1421300">len</span><span class="op" id="1421303">(</span><span class="ident" id="1421304"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421306">)</span>&nbsp;<span class="op" id="1421308">==</span>&nbsp;<span class="ident" id="1421311"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1421319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421323">return</span>&nbsp;<span class="ident" id="1421330"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1421334">(</span><span class="ident" id="1421335"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421337">[</span><span class="num" id="1421338">0</span><span class="op" id="1421339">]</span><span class="op" id="1421340">,</span>&nbsp;<span class="ident" id="1421342"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421344">[</span><span class="num" id="1421345">1</span><span class="op" id="1421346">]</span><span class="op" id="1421347">,</span>&nbsp;<span class="ident" id="1421349"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421351">[</span><span class="num" id="1421352">2</span><span class="op" id="1421353">]</span><span class="op" id="1421354">,</span>&nbsp;<span class="ident" id="1421356"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421358">[</span><span class="num" id="1421359">3</span><span class="op" id="1421360">]</span><span class="op" id="1421361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421367">if</span>&nbsp;<span class="builtinfunc" id="1421370">len</span><span class="op" id="1421373">(</span><span class="ident" id="1421374"><a href="/net/ip.go.html#1421277">ip</a></span><span class="op" id="1421376">)</span>&nbsp;<span class="op" id="1421378">==</span>&nbsp;<span class="ident" id="1421381"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1421389">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421393">return</span>&nbsp;<span class="ident" id="1421400"><a href="/net/ip.go.html#1421277">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421407">return</span>&nbsp;<span class="ident" id="1421414">nil</span><br>
<span class="lineno"></span><span class="op" id="1421418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="1421421">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="1421454">var</span>&nbsp;<span class="op" id="1421458">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421461">classAMask</span>&nbsp;<span class="op" id="1421472">=</span>&nbsp;<span class="ident" id="1421474"><a href="/net/ip.go.html#1417742">IPv4Mask</a></span><span class="op" id="1421482">(</span><span class="num" id="1421483">0xff</span><span class="op" id="1421487">,</span>&nbsp;<span class="num" id="1421489">0</span><span class="op" id="1421490">,</span>&nbsp;<span class="num" id="1421492">0</span><span class="op" id="1421493">,</span>&nbsp;<span class="num" id="1421495">0</span><span class="op" id="1421496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421499">classBMask</span>&nbsp;<span class="op" id="1421510">=</span>&nbsp;<span class="ident" id="1421512"><a href="/net/ip.go.html#1417742">IPv4Mask</a></span><span class="op" id="1421520">(</span><span class="num" id="1421521">0xff</span><span class="op" id="1421525">,</span>&nbsp;<span class="num" id="1421527">0xff</span><span class="op" id="1421531">,</span>&nbsp;<span class="num" id="1421533">0</span><span class="op" id="1421534">,</span>&nbsp;<span class="num" id="1421536">0</span><span class="op" id="1421537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421540">classCMask</span>&nbsp;<span class="op" id="1421551">=</span>&nbsp;<span class="ident" id="1421553"><a href="/net/ip.go.html#1417742">IPv4Mask</a></span><span class="op" id="1421561">(</span><span class="num" id="1421562">0xff</span><span class="op" id="1421566">,</span>&nbsp;<span class="num" id="1421568">0xff</span><span class="op" id="1421572">,</span>&nbsp;<span class="num" id="1421574">0xff</span><span class="op" id="1421578">,</span>&nbsp;<span class="num" id="1421580">0</span><span class="op" id="1421581">)</span><br>
<span class="lineno">210</span><span class="op" id="1421583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1421586">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="1421652">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1421715">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="1421757">func</span>&nbsp;<span class="op" id="1421762">(</span><span class="ident" id="1421763">ip</span>&nbsp;<span class="ident" id="1421766"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1421768">)</span>&nbsp;<span class="ident" id="1421770">DefaultMask</span><span class="op" id="1421781">(</span><span class="op" id="1421782">)</span>&nbsp;<span class="ident" id="1421784"><a href="/net/ip.go.html#1417237">IPMask</a></span>&nbsp;<span class="op" id="1421791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421794">if</span>&nbsp;<span class="ident" id="1421797"><a href="/net/ip.go.html#1421763">ip</a></span>&nbsp;<span class="op" id="1421800">=</span>&nbsp;<span class="ident" id="1421802"><a href="/net/ip.go.html#1421763">ip</a></span><span class="op" id="1421804">.</span><span class="ident" id="1421805">To4</span><span class="op" id="1421808">(</span><span class="op" id="1421809">)</span><span class="op" id="1421810">;</span>&nbsp;<span class="ident" id="1421812"><a href="/net/ip.go.html#1421763">ip</a></span>&nbsp;<span class="op" id="1421815">==</span>&nbsp;<span class="ident" id="1421818">nil</span>&nbsp;<span class="op" id="1421822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421826">return</span>&nbsp;<span class="ident" id="1421833">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421841">switch</span>&nbsp;<span class="builtintype" id="1421848">true</span>&nbsp;<span class="op" id="1421853">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421856">case</span>&nbsp;<span class="ident" id="1421861"><a href="/net/ip.go.html#1421763">ip</a></span><span class="op" id="1421863">[</span><span class="num" id="1421864">0</span><span class="op" id="1421865">]</span>&nbsp;<span class="op" id="1421867">&lt;</span>&nbsp;<span class="num" id="1421869">0x80</span><span class="op" id="1421873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421877">return</span>&nbsp;<span class="ident" id="1421884"><a href="/net/ip.go.html#1421461">classAMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421896">case</span>&nbsp;<span class="ident" id="1421901"><a href="/net/ip.go.html#1421763">ip</a></span><span class="op" id="1421903">[</span><span class="num" id="1421904">0</span><span class="op" id="1421905">]</span>&nbsp;<span class="op" id="1421907">&lt;</span>&nbsp;<span class="num" id="1421909">0xC0</span><span class="op" id="1421913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421917">return</span>&nbsp;<span class="ident" id="1421924"><a href="/net/ip.go.html#1421499">classBMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421936">default</span><span class="op" id="1421943">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421947">return</span>&nbsp;<span class="ident" id="1421954"><a href="/net/ip.go.html#1421540">classCMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421966">}</span><br>
<span class="lineno"></span><span class="op" id="1421968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1421971">func</span>&nbsp;<span class="ident" id="1421976">allFF</span><span class="op" id="1421981">(</span><span class="ident" id="1421982">b</span>&nbsp;<span class="op" id="1421984">[</span><span class="op" id="1421985">]</span><span class="builtintype" id="1421986">byte</span><span class="op" id="1421990">)</span>&nbsp;<span class="builtintype" id="1421992">bool</span>&nbsp;<span class="op" id="1421997">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422000">for</span>&nbsp;<span class="ident" id="1422004">_</span><span class="op" id="1422005">,</span>&nbsp;<span class="ident" id="1422007">c</span>&nbsp;<span class="op" id="1422009">:=</span>&nbsp;<span class="keyword" id="1422012">range</span>&nbsp;<span class="ident" id="1422018"><a href="/net/ip.go.html#1421982">b</a></span>&nbsp;<span class="op" id="1422020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422024">if</span>&nbsp;<span class="ident" id="1422027"><a href="/net/ip.go.html#1422007">c</a></span>&nbsp;<span class="op" id="1422029">!=</span>&nbsp;<span class="num" id="1422032">0xff</span>&nbsp;<span class="op" id="1422037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422042">return</span>&nbsp;<span class="builtintype" id="1422049">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422060">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422063">return</span>&nbsp;<span class="builtintype" id="1422070">true</span><br>
<span class="lineno"></span><span class="op" id="1422075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1422078">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="1422145">func</span>&nbsp;<span class="op" id="1422150">(</span><span class="ident" id="1422151">ip</span>&nbsp;<span class="ident" id="1422154"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1422156">)</span>&nbsp;<span class="ident" id="1422158">Mask</span><span class="op" id="1422162">(</span><span class="ident" id="1422163">mask</span>&nbsp;<span class="ident" id="1422168"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1422174">)</span>&nbsp;<span class="ident" id="1422176"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1422179">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422182">if</span>&nbsp;<span class="builtinfunc" id="1422185">len</span><span class="op" id="1422188">(</span><span class="ident" id="1422189"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422193">)</span>&nbsp;<span class="op" id="1422195">==</span>&nbsp;<span class="ident" id="1422198"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1422206">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1422209">len</span><span class="op" id="1422212">(</span><span class="ident" id="1422213"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422215">)</span>&nbsp;<span class="op" id="1422217">==</span>&nbsp;<span class="ident" id="1422220"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1422228">&amp;&amp;</span>&nbsp;<span class="ident" id="1422231"><a href="/net/ip.go.html#1421976">allFF</a></span><span class="op" id="1422236">(</span><span class="ident" id="1422237"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422241">[</span><span class="op" id="1422242">:</span><span class="num" id="1422243">12</span><span class="op" id="1422245">]</span><span class="op" id="1422246">)</span>&nbsp;<span class="op" id="1422248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422252"><a href="/net/ip.go.html#1422163">mask</a></span>&nbsp;<span class="op" id="1422257">=</span>&nbsp;<span class="ident" id="1422259"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422263">[</span><span class="num" id="1422264">12</span><span class="op" id="1422266">:</span><span class="op" id="1422267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422273">if</span>&nbsp;<span class="builtinfunc" id="1422276">len</span><span class="op" id="1422279">(</span><span class="ident" id="1422280"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422284">)</span>&nbsp;<span class="op" id="1422286">==</span>&nbsp;<span class="ident" id="1422289"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1422297">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1422300">len</span><span class="op" id="1422303">(</span><span class="ident" id="1422304"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422306">)</span>&nbsp;<span class="op" id="1422308">==</span>&nbsp;<span class="ident" id="1422311"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1422319">&amp;&amp;</span>&nbsp;<span class="ident" id="1422322"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1422332">(</span><span class="ident" id="1422333"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422335">[</span><span class="op" id="1422336">:</span><span class="num" id="1422337">12</span><span class="op" id="1422339">]</span><span class="op" id="1422340">,</span>&nbsp;<span class="ident" id="1422342"><a href="/net/ip.go.html#1417594">v4InV6Prefix</a></span><span class="op" id="1422354">)</span>&nbsp;<span class="op" id="1422356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422360"><a href="/net/ip.go.html#1422151">ip</a></span>&nbsp;<span class="op" id="1422363">=</span>&nbsp;<span class="ident" id="1422365"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422367">[</span><span class="num" id="1422368">12</span><span class="op" id="1422370">:</span><span class="op" id="1422371">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422377">n</span>&nbsp;<span class="op" id="1422379">:=</span>&nbsp;<span class="builtinfunc" id="1422382">len</span><span class="op" id="1422385">(</span><span class="ident" id="1422386"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422391">if</span>&nbsp;<span class="ident" id="1422394"><a href="/net/ip.go.html#1422377">n</a></span>&nbsp;<span class="op" id="1422396">!=</span>&nbsp;<span class="builtinfunc" id="1422399">len</span><span class="op" id="1422402">(</span><span class="ident" id="1422403"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422407">)</span>&nbsp;<span class="op" id="1422409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422413">return</span>&nbsp;<span class="ident" id="1422420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422425">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422428">out</span>&nbsp;<span class="op" id="1422432">:=</span>&nbsp;<span class="builtinfunc" id="1422435">make</span><span class="op" id="1422439">(</span><span class="ident" id="1422440"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1422442">,</span>&nbsp;<span class="ident" id="1422444"><a href="/net/ip.go.html#1422377">n</a></span><span class="op" id="1422445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422448">for</span>&nbsp;<span class="ident" id="1422452">i</span>&nbsp;<span class="op" id="1422454">:=</span>&nbsp;<span class="num" id="1422457">0</span><span class="op" id="1422458">;</span>&nbsp;<span class="ident" id="1422460"><a href="/net/ip.go.html#1422452">i</a></span>&nbsp;<span class="op" id="1422462">&lt;</span>&nbsp;<span class="ident" id="1422464"><a href="/net/ip.go.html#1422377">n</a></span><span class="op" id="1422465">;</span>&nbsp;<span class="ident" id="1422467"><a href="/net/ip.go.html#1422452">i</a></span><span class="op" id="1422468">++</span>&nbsp;<span class="op" id="1422471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422475"><a href="/net/ip.go.html#1422428">out</a></span><span class="op" id="1422478">[</span><span class="ident" id="1422479"><a href="/net/ip.go.html#1422452">i</a></span><span class="op" id="1422480">]</span>&nbsp;<span class="op" id="1422482">=</span>&nbsp;<span class="ident" id="1422484"><a href="/net/ip.go.html#1422151">ip</a></span><span class="op" id="1422486">[</span><span class="ident" id="1422487"><a href="/net/ip.go.html#1422452">i</a></span><span class="op" id="1422488">]</span>&nbsp;<span class="op" id="1422490">&amp;</span>&nbsp;<span class="ident" id="1422492"><a href="/net/ip.go.html#1422163">mask</a></span><span class="op" id="1422496">[</span><span class="ident" id="1422497"><a href="/net/ip.go.html#1422452">i</a></span><span class="op" id="1422498">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422504">return</span>&nbsp;<span class="ident" id="1422511"><a href="/net/ip.go.html#1422428">out</a></span><br>
<span class="lineno">255</span><span class="op" id="1422515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1422518">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="1422574">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="1422638">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="1422707">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="1422744">func</span>&nbsp;<span class="op" id="1422749">(</span><span class="ident" id="1422750">ip</span>&nbsp;<span class="ident" id="1422753"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1422755">)</span>&nbsp;<span class="ident" id="1422757">String</span><span class="op" id="1422763">(</span><span class="op" id="1422764">)</span>&nbsp;<span class="builtintype" id="1422766">string</span>&nbsp;<span class="op" id="1422773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422776">p</span>&nbsp;<span class="op" id="1422778">:=</span>&nbsp;<span class="ident" id="1422781"><a href="/net/ip.go.html#1422750">ip</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422786">if</span>&nbsp;<span class="builtinfunc" id="1422789">len</span><span class="op" id="1422792">(</span><span class="ident" id="1422793"><a href="/net/ip.go.html#1422750">ip</a></span><span class="op" id="1422795">)</span>&nbsp;<span class="op" id="1422797">==</span>&nbsp;<span class="num" id="1422800">0</span>&nbsp;<span class="op" id="1422802">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422806">return</span>&nbsp;<span class="string" id="1422813">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1422826">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422860">if</span>&nbsp;<span class="ident" id="1422863">p4</span>&nbsp;<span class="op" id="1422866">:=</span>&nbsp;<span class="ident" id="1422869"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1422870">.</span><span class="ident" id="1422871">To4</span><span class="op" id="1422874">(</span><span class="op" id="1422875">)</span><span class="op" id="1422876">;</span>&nbsp;<span class="builtinfunc" id="1422878">len</span><span class="op" id="1422881">(</span><span class="ident" id="1422882"><a href="/net/ip.go.html#1422863">p4</a></span><span class="op" id="1422884">)</span>&nbsp;<span class="op" id="1422886">==</span>&nbsp;<span class="ident" id="1422889"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1422897">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422901">return</span>&nbsp;<span class="ident" id="1422908"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1422912">(</span><span class="builtintype" id="1422913">uint</span><span class="op" id="1422917">(</span><span class="ident" id="1422918"><a href="/net/ip.go.html#1422863">p4</a></span><span class="op" id="1422920">[</span><span class="num" id="1422921">0</span><span class="op" id="1422922">]</span><span class="op" id="1422923">)</span><span class="op" id="1422924">)</span>&nbsp;<span class="op" id="1422926">+</span>&nbsp;<span class="string" id="1422928">&#34;.&#34;</span>&nbsp;<span class="op" id="1422932">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422937"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1422941">(</span><span class="builtintype" id="1422942">uint</span><span class="op" id="1422946">(</span><span class="ident" id="1422947"><a href="/net/ip.go.html#1422863">p4</a></span><span class="op" id="1422949">[</span><span class="num" id="1422950">1</span><span class="op" id="1422951">]</span><span class="op" id="1422952">)</span><span class="op" id="1422953">)</span>&nbsp;<span class="op" id="1422955">+</span>&nbsp;<span class="string" id="1422957">&#34;.&#34;</span>&nbsp;<span class="op" id="1422961">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422966"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1422970">(</span><span class="builtintype" id="1422971">uint</span><span class="op" id="1422975">(</span><span class="ident" id="1422976"><a href="/net/ip.go.html#1422863">p4</a></span><span class="op" id="1422978">[</span><span class="num" id="1422979">2</span><span class="op" id="1422980">]</span><span class="op" id="1422981">)</span><span class="op" id="1422982">)</span>&nbsp;<span class="op" id="1422984">+</span>&nbsp;<span class="string" id="1422986">&#34;.&#34;</span>&nbsp;<span class="op" id="1422990">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422995"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1422999">(</span><span class="builtintype" id="1423000">uint</span><span class="op" id="1423004">(</span><span class="ident" id="1423005"><a href="/net/ip.go.html#1422863">p4</a></span><span class="op" id="1423007">[</span><span class="num" id="1423008">3</span><span class="op" id="1423009">]</span><span class="op" id="1423010">)</span><span class="op" id="1423011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423014">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423017">if</span>&nbsp;<span class="builtinfunc" id="1423020">len</span><span class="op" id="1423023">(</span><span class="ident" id="1423024"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1423025">)</span>&nbsp;<span class="op" id="1423027">!=</span>&nbsp;<span class="ident" id="1423030"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1423038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423042">return</span>&nbsp;<span class="string" id="1423049">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1423058">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423089">e0</span>&nbsp;<span class="op" id="1423092">:=</span>&nbsp;<span class="op" id="1423095">-</span><span class="num" id="1423096">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423099">e1</span>&nbsp;<span class="op" id="1423102">:=</span>&nbsp;<span class="op" id="1423105">-</span><span class="num" id="1423106">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423109">for</span>&nbsp;<span class="ident" id="1423113">i</span>&nbsp;<span class="op" id="1423115">:=</span>&nbsp;<span class="num" id="1423118">0</span><span class="op" id="1423119">;</span>&nbsp;<span class="ident" id="1423121"><a href="/net/ip.go.html#1423113">i</a></span>&nbsp;<span class="op" id="1423123">&lt;</span>&nbsp;<span class="ident" id="1423125"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1423132">;</span>&nbsp;<span class="ident" id="1423134"><a href="/net/ip.go.html#1423113">i</a></span>&nbsp;<span class="op" id="1423136">+=</span>&nbsp;<span class="num" id="1423139">2</span>&nbsp;<span class="op" id="1423141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423145">j</span>&nbsp;<span class="op" id="1423147">:=</span>&nbsp;<span class="ident" id="1423150"><a href="/net/ip.go.html#1423113">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423154">for</span>&nbsp;<span class="ident" id="1423158"><a href="/net/ip.go.html#1423145">j</a></span>&nbsp;<span class="op" id="1423160">&lt;</span>&nbsp;<span class="ident" id="1423162"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1423170">&amp;&amp;</span>&nbsp;<span class="ident" id="1423173"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1423174">[</span><span class="ident" id="1423175"><a href="/net/ip.go.html#1423145">j</a></span><span class="op" id="1423176">]</span>&nbsp;<span class="op" id="1423178">==</span>&nbsp;<span class="num" id="1423181">0</span>&nbsp;<span class="op" id="1423183">&amp;&amp;</span>&nbsp;<span class="ident" id="1423186"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1423187">[</span><span class="ident" id="1423188"><a href="/net/ip.go.html#1423145">j</a></span><span class="op" id="1423189">+</span><span class="num" id="1423190">1</span><span class="op" id="1423191">]</span>&nbsp;<span class="op" id="1423193">==</span>&nbsp;<span class="num" id="1423196">0</span>&nbsp;<span class="op" id="1423198">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423203"><a href="/net/ip.go.html#1423145">j</a></span>&nbsp;<span class="op" id="1423205">+=</span>&nbsp;<span class="num" id="1423208">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423216">if</span>&nbsp;<span class="ident" id="1423219"><a href="/net/ip.go.html#1423145">j</a></span>&nbsp;<span class="op" id="1423221">&gt;</span>&nbsp;<span class="ident" id="1423223"><a href="/net/ip.go.html#1423113">i</a></span>&nbsp;<span class="op" id="1423225">&amp;&amp;</span>&nbsp;<span class="ident" id="1423228"><a href="/net/ip.go.html#1423145">j</a></span><span class="op" id="1423229">-</span><span class="ident" id="1423230"><a href="/net/ip.go.html#1423113">i</a></span>&nbsp;<span class="op" id="1423232">&gt;</span>&nbsp;<span class="ident" id="1423234"><a href="/net/ip.go.html#1423099">e1</a></span><span class="op" id="1423236">-</span><span class="ident" id="1423237"><a href="/net/ip.go.html#1423089">e0</a></span>&nbsp;<span class="op" id="1423240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423245"><a href="/net/ip.go.html#1423089">e0</a></span>&nbsp;<span class="op" id="1423248">=</span>&nbsp;<span class="ident" id="1423250"><a href="/net/ip.go.html#1423113">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423255"><a href="/net/ip.go.html#1423099">e1</a></span>&nbsp;<span class="op" id="1423258">=</span>&nbsp;<span class="ident" id="1423260"><a href="/net/ip.go.html#1423145">j</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423265"><a href="/net/ip.go.html#1423113">i</a></span>&nbsp;<span class="op" id="1423267">=</span>&nbsp;<span class="ident" id="1423269"><a href="/net/ip.go.html#1423145">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1423279">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423352">if</span>&nbsp;<span class="ident" id="1423355"><a href="/net/ip.go.html#1423099">e1</a></span><span class="op" id="1423357">-</span><span class="ident" id="1423358"><a href="/net/ip.go.html#1423089">e0</a></span>&nbsp;<span class="op" id="1423361">&lt;=</span>&nbsp;<span class="num" id="1423364">2</span>&nbsp;<span class="op" id="1423366">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423370"><a href="/net/ip.go.html#1423089">e0</a></span>&nbsp;<span class="op" id="1423373">=</span>&nbsp;<span class="op" id="1423375">-</span><span class="num" id="1423376">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423380"><a href="/net/ip.go.html#1423099">e1</a></span>&nbsp;<span class="op" id="1423383">=</span>&nbsp;<span class="op" id="1423385">-</span><span class="num" id="1423386">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423393">const</span>&nbsp;<span class="ident" id="1423399">maxLen</span>&nbsp;<span class="op" id="1423406">=</span>&nbsp;<span class="builtinfunc" id="1423408">len</span><span class="op" id="1423411">(</span><span class="string" id="1423412">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="1423453">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423456">b</span>&nbsp;<span class="op" id="1423458">:=</span>&nbsp;<span class="builtinfunc" id="1423461">make</span><span class="op" id="1423465">(</span><span class="op" id="1423466">[</span><span class="op" id="1423467">]</span><span class="builtintype" id="1423468">byte</span><span class="op" id="1423472">,</span>&nbsp;<span class="num" id="1423474">0</span><span class="op" id="1423475">,</span>&nbsp;<span class="ident" id="1423477"><a href="/net/ip.go.html#1423399">maxLen</a></span><span class="op" id="1423483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1423487">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423539">for</span>&nbsp;<span class="ident" id="1423543">i</span>&nbsp;<span class="op" id="1423545">:=</span>&nbsp;<span class="num" id="1423548">0</span><span class="op" id="1423549">;</span>&nbsp;<span class="ident" id="1423551"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423553">&lt;</span>&nbsp;<span class="ident" id="1423555"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1423562">;</span>&nbsp;<span class="ident" id="1423564"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423566">+=</span>&nbsp;<span class="num" id="1423569">2</span>&nbsp;<span class="op" id="1423571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423575">if</span>&nbsp;<span class="ident" id="1423578"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423580">==</span>&nbsp;<span class="ident" id="1423583"><a href="/net/ip.go.html#1423089">e0</a></span>&nbsp;<span class="op" id="1423586">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423591"><a href="/net/ip.go.html#1423456">b</a></span>&nbsp;<span class="op" id="1423593">=</span>&nbsp;<span class="builtinfunc" id="1423595">append</span><span class="op" id="1423601">(</span><span class="ident" id="1423602"><a href="/net/ip.go.html#1423456">b</a></span><span class="op" id="1423603">,</span>&nbsp;<span class="string" id="1423605">&#39;:&#39;</span><span class="op" id="1423608">,</span>&nbsp;<span class="string" id="1423610">&#39;:&#39;</span><span class="op" id="1423613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423618"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423620">=</span>&nbsp;<span class="ident" id="1423622"><a href="/net/ip.go.html#1423099">e1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423628">if</span>&nbsp;<span class="ident" id="1423631"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423633">&gt;=</span>&nbsp;<span class="ident" id="1423636"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1423644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423650">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423659">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423663">}</span>&nbsp;<span class="keyword" id="1423665">else</span>&nbsp;<span class="keyword" id="1423670">if</span>&nbsp;<span class="ident" id="1423673"><a href="/net/ip.go.html#1423543">i</a></span>&nbsp;<span class="op" id="1423675">&gt;</span>&nbsp;<span class="num" id="1423677">0</span>&nbsp;<span class="op" id="1423679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423684"><a href="/net/ip.go.html#1423456">b</a></span>&nbsp;<span class="op" id="1423686">=</span>&nbsp;<span class="builtinfunc" id="1423688">append</span><span class="op" id="1423694">(</span><span class="ident" id="1423695"><a href="/net/ip.go.html#1423456">b</a></span><span class="op" id="1423696">,</span>&nbsp;<span class="string" id="1423698">&#39;:&#39;</span><span class="op" id="1423701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423709"><a href="/net/ip.go.html#1423456">b</a></span>&nbsp;<span class="op" id="1423711">=</span>&nbsp;<span class="ident" id="1423713"><a href="/net/parse.go.html#1479650">appendHex</a></span><span class="op" id="1423722">(</span><span class="ident" id="1423723"><a href="/net/ip.go.html#1423456">b</a></span><span class="op" id="1423724">,</span>&nbsp;<span class="op" id="1423726">(</span><span class="builtintype" id="1423727">uint32</span><span class="op" id="1423733">(</span><span class="ident" id="1423734"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1423735">[</span><span class="ident" id="1423736"><a href="/net/ip.go.html#1423543">i</a></span><span class="op" id="1423737">]</span><span class="op" id="1423738">)</span><span class="op" id="1423739">&lt;&lt;</span><span class="num" id="1423741">8</span><span class="op" id="1423742">)</span><span class="op" id="1423743">|</span><span class="builtintype" id="1423744">uint32</span><span class="op" id="1423750">(</span><span class="ident" id="1423751"><a href="/net/ip.go.html#1422776">p</a></span><span class="op" id="1423752">[</span><span class="ident" id="1423753"><a href="/net/ip.go.html#1423543">i</a></span><span class="op" id="1423754">+</span><span class="num" id="1423755">1</span><span class="op" id="1423756">]</span><span class="op" id="1423757">)</span><span class="op" id="1423758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423761">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423764">return</span>&nbsp;<span class="builtintype" id="1423771">string</span><span class="op" id="1423777">(</span><span class="ident" id="1423778"><a href="/net/ip.go.html#1423456">b</a></span><span class="op" id="1423779">)</span><br>
<span class="lineno"></span><span class="op" id="1423781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1423784">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1423842">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="1423879">func</span>&nbsp;<span class="ident" id="1423884">ipEmptyString</span><span class="op" id="1423897">(</span><span class="ident" id="1423898">ip</span>&nbsp;<span class="ident" id="1423901"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1423903">)</span>&nbsp;<span class="builtintype" id="1423905">string</span>&nbsp;<span class="op" id="1423912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423915">if</span>&nbsp;<span class="builtinfunc" id="1423918">len</span><span class="op" id="1423921">(</span><span class="ident" id="1423922"><a href="/net/ip.go.html#1423898">ip</a></span><span class="op" id="1423924">)</span>&nbsp;<span class="op" id="1423926">==</span>&nbsp;<span class="num" id="1423929">0</span>&nbsp;<span class="op" id="1423931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423935">return</span>&nbsp;<span class="string" id="1423942">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423949">return</span>&nbsp;<span class="ident" id="1423956"><a href="/net/ip.go.html#1423898">ip</a></span><span class="op" id="1423958">.</span><span class="ident" id="1423959">String</span><span class="op" id="1423965">(</span><span class="op" id="1423966">)</span><br>
<span class="lineno">325</span><span class="op" id="1423968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1423971">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="1424035">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="1424086">func</span>&nbsp;<span class="op" id="1424091">(</span><span class="ident" id="1424092">ip</span>&nbsp;<span class="ident" id="1424095"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1424097">)</span>&nbsp;<span class="ident" id="1424099">MarshalText</span><span class="op" id="1424110">(</span><span class="op" id="1424111">)</span>&nbsp;<span class="op" id="1424113">(</span><span class="op" id="1424114">[</span><span class="op" id="1424115">]</span><span class="builtintype" id="1424116">byte</span><span class="op" id="1424120">,</span>&nbsp;<span class="builtintype" id="1424122">error</span><span class="op" id="1424127">)</span>&nbsp;<span class="op" id="1424129">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424132">if</span>&nbsp;<span class="builtinfunc" id="1424135">len</span><span class="op" id="1424138">(</span><span class="ident" id="1424139"><a href="/net/ip.go.html#1424092">ip</a></span><span class="op" id="1424141">)</span>&nbsp;<span class="op" id="1424143">==</span>&nbsp;<span class="num" id="1424146">0</span>&nbsp;<span class="op" id="1424148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424152">return</span>&nbsp;<span class="op" id="1424159">[</span><span class="op" id="1424160">]</span><span class="builtintype" id="1424161">byte</span><span class="op" id="1424165">(</span><span class="string" id="1424166">&#34;&#34;</span><span class="op" id="1424168">)</span><span class="op" id="1424169">,</span>&nbsp;<span class="ident" id="1424171">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424179">if</span>&nbsp;<span class="builtinfunc" id="1424182">len</span><span class="op" id="1424185">(</span><span class="ident" id="1424186"><a href="/net/ip.go.html#1424092">ip</a></span><span class="op" id="1424188">)</span>&nbsp;<span class="op" id="1424190">!=</span>&nbsp;<span class="ident" id="1424193"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1424201">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1424204">len</span><span class="op" id="1424207">(</span><span class="ident" id="1424208"><a href="/net/ip.go.html#1424092">ip</a></span><span class="op" id="1424210">)</span>&nbsp;<span class="op" id="1424212">!=</span>&nbsp;<span class="ident" id="1424215"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1424223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424227">return</span>&nbsp;<span class="ident" id="1424234">nil</span><span class="op" id="1424237">,</span>&nbsp;<span class="ident" id="1424239"><a href="/net/ip.go.html#1416719">errors</a></span><span class="op" id="1424245">.</span><span class="ident" id="1424246">New</span><span class="op" id="1424249">(</span><span class="string" id="1424250">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="1424270">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424276">return</span>&nbsp;<span class="op" id="1424283">[</span><span class="op" id="1424284">]</span><span class="builtintype" id="1424285">byte</span><span class="op" id="1424289">(</span><span class="ident" id="1424290"><a href="/net/ip.go.html#1424092">ip</a></span><span class="op" id="1424292">.</span><span class="ident" id="1424293">String</span><span class="op" id="1424299">(</span><span class="op" id="1424300">)</span><span class="op" id="1424301">)</span><span class="op" id="1424302">,</span>&nbsp;<span class="ident" id="1424304">nil</span><br>
<span class="lineno"></span><span class="op" id="1424308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1424311">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="1424379">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="1424440">func</span>&nbsp;<span class="op" id="1424445">(</span><span class="ident" id="1424446">ip</span>&nbsp;<span class="op" id="1424449">*</span><span class="ident" id="1424450"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1424452">)</span>&nbsp;<span class="ident" id="1424454">UnmarshalText</span><span class="op" id="1424467">(</span><span class="ident" id="1424468">text</span>&nbsp;<span class="op" id="1424473">[</span><span class="op" id="1424474">]</span><span class="builtintype" id="1424475">byte</span><span class="op" id="1424479">)</span>&nbsp;<span class="builtintype" id="1424481">error</span>&nbsp;<span class="op" id="1424487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424490">if</span>&nbsp;<span class="builtinfunc" id="1424493">len</span><span class="op" id="1424496">(</span><span class="ident" id="1424497"><a href="/net/ip.go.html#1424468">text</a></span><span class="op" id="1424501">)</span>&nbsp;<span class="op" id="1424503">==</span>&nbsp;<span class="num" id="1424506">0</span>&nbsp;<span class="op" id="1424508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424512">*</span><span class="ident" id="1424513"><a href="/net/ip.go.html#1424446">ip</a></span>&nbsp;<span class="op" id="1424516">=</span>&nbsp;<span class="ident" id="1424518">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424524">return</span>&nbsp;<span class="ident" id="1424531">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424539">s</span>&nbsp;<span class="op" id="1424541">:=</span>&nbsp;<span class="builtintype" id="1424544">string</span><span class="op" id="1424550">(</span><span class="ident" id="1424551"><a href="/net/ip.go.html#1424468">text</a></span><span class="op" id="1424555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424558">x</span>&nbsp;<span class="op" id="1424560">:=</span>&nbsp;<span class="ident" id="1424563"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="1424570">(</span><span class="ident" id="1424571"><a href="/net/ip.go.html#1424539">s</a></span><span class="op" id="1424572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424575">if</span>&nbsp;<span class="ident" id="1424578"><a href="/net/ip.go.html#1424558">x</a></span>&nbsp;<span class="op" id="1424580">==</span>&nbsp;<span class="ident" id="1424583">nil</span>&nbsp;<span class="op" id="1424587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424591">return</span>&nbsp;<span class="op" id="1424598">&amp;</span><span class="ident" id="1424599"><a href="/net/ip.go.html#1430388">ParseError</a></span><span class="op" id="1424609">{</span><span class="string" id="1424610">&#34;IP&nbsp;address&#34;</span><span class="op" id="1424622">,</span>&nbsp;<span class="ident" id="1424624"><a href="/net/ip.go.html#1424539">s</a></span><span class="op" id="1424625">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424631">*</span><span class="ident" id="1424632"><a href="/net/ip.go.html#1424446">ip</a></span>&nbsp;<span class="op" id="1424635">=</span>&nbsp;<span class="ident" id="1424637"><a href="/net/ip.go.html#1424558">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424640">return</span>&nbsp;<span class="ident" id="1424647">nil</span><br>
<span class="lineno"></span><span class="op" id="1424651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="1424654">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="1424713">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1424771">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="1424798">func</span>&nbsp;<span class="op" id="1424803">(</span><span class="ident" id="1424804">ip</span>&nbsp;<span class="ident" id="1424807"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1424809">)</span>&nbsp;<span class="ident" id="1424811">Equal</span><span class="op" id="1424816">(</span><span class="ident" id="1424817">x</span>&nbsp;<span class="ident" id="1424819"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1424821">)</span>&nbsp;<span class="builtintype" id="1424823">bool</span>&nbsp;<span class="op" id="1424828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424831">if</span>&nbsp;<span class="builtinfunc" id="1424834">len</span><span class="op" id="1424837">(</span><span class="ident" id="1424838"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1424840">)</span>&nbsp;<span class="op" id="1424842">==</span>&nbsp;<span class="builtinfunc" id="1424845">len</span><span class="op" id="1424848">(</span><span class="ident" id="1424849"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1424850">)</span>&nbsp;<span class="op" id="1424852">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424856">return</span>&nbsp;<span class="ident" id="1424863"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1424873">(</span><span class="ident" id="1424874"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1424876">,</span>&nbsp;<span class="ident" id="1424878"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1424879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424885">if</span>&nbsp;<span class="builtinfunc" id="1424888">len</span><span class="op" id="1424891">(</span><span class="ident" id="1424892"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1424894">)</span>&nbsp;<span class="op" id="1424896">==</span>&nbsp;<span class="ident" id="1424899"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1424907">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1424910">len</span><span class="op" id="1424913">(</span><span class="ident" id="1424914"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1424915">)</span>&nbsp;<span class="op" id="1424917">==</span>&nbsp;<span class="ident" id="1424920"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1424928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424932">return</span>&nbsp;<span class="ident" id="1424939"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1424949">(</span><span class="ident" id="1424950"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1424951">[</span><span class="num" id="1424952">0</span><span class="op" id="1424953">:</span><span class="num" id="1424954">12</span><span class="op" id="1424956">]</span><span class="op" id="1424957">,</span>&nbsp;<span class="ident" id="1424959"><a href="/net/ip.go.html#1417594">v4InV6Prefix</a></span><span class="op" id="1424971">)</span>&nbsp;<span class="op" id="1424973">&amp;&amp;</span>&nbsp;<span class="ident" id="1424976"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1424986">(</span><span class="ident" id="1424987"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1424989">,</span>&nbsp;<span class="ident" id="1424991"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1424992">[</span><span class="num" id="1424993">12</span><span class="op" id="1424995">:</span><span class="op" id="1424996">]</span><span class="op" id="1424997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425000">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425003">if</span>&nbsp;<span class="builtinfunc" id="1425006">len</span><span class="op" id="1425009">(</span><span class="ident" id="1425010"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1425012">)</span>&nbsp;<span class="op" id="1425014">==</span>&nbsp;<span class="ident" id="1425017"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1425025">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1425028">len</span><span class="op" id="1425031">(</span><span class="ident" id="1425032"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1425033">)</span>&nbsp;<span class="op" id="1425035">==</span>&nbsp;<span class="ident" id="1425038"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1425046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425050">return</span>&nbsp;<span class="ident" id="1425057"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1425067">(</span><span class="ident" id="1425068"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1425070">[</span><span class="num" id="1425071">0</span><span class="op" id="1425072">:</span><span class="num" id="1425073">12</span><span class="op" id="1425075">]</span><span class="op" id="1425076">,</span>&nbsp;<span class="ident" id="1425078"><a href="/net/ip.go.html#1417594">v4InV6Prefix</a></span><span class="op" id="1425090">)</span>&nbsp;<span class="op" id="1425092">&amp;&amp;</span>&nbsp;<span class="ident" id="1425095"><a href="/net/ip.go.html#1425143">bytesEqual</a></span><span class="op" id="1425105">(</span><span class="ident" id="1425106"><a href="/net/ip.go.html#1424804">ip</a></span><span class="op" id="1425108">[</span><span class="num" id="1425109">12</span><span class="op" id="1425111">:</span><span class="op" id="1425112">]</span><span class="op" id="1425113">,</span>&nbsp;<span class="ident" id="1425115"><a href="/net/ip.go.html#1424817">x</a></span><span class="op" id="1425116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425122">return</span>&nbsp;<span class="builtintype" id="1425129">false</span><br>
<span class="lineno"></span><span class="op" id="1425135">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="1425138">func</span>&nbsp;<span class="ident" id="1425143">bytesEqual</span><span class="op" id="1425153">(</span><span class="ident" id="1425154">x</span><span class="op" id="1425155">,</span>&nbsp;<span class="ident" id="1425157">y</span>&nbsp;<span class="op" id="1425159">[</span><span class="op" id="1425160">]</span><span class="builtintype" id="1425161">byte</span><span class="op" id="1425165">)</span>&nbsp;<span class="builtintype" id="1425167">bool</span>&nbsp;<span class="op" id="1425172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425175">if</span>&nbsp;<span class="builtinfunc" id="1425178">len</span><span class="op" id="1425181">(</span><span class="ident" id="1425182"><a href="/net/ip.go.html#1425154">x</a></span><span class="op" id="1425183">)</span>&nbsp;<span class="op" id="1425185">!=</span>&nbsp;<span class="builtinfunc" id="1425188">len</span><span class="op" id="1425191">(</span><span class="ident" id="1425192"><a href="/net/ip.go.html#1425157">y</a></span><span class="op" id="1425193">)</span>&nbsp;<span class="op" id="1425195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425199">return</span>&nbsp;<span class="builtintype" id="1425206">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425213">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425216">for</span>&nbsp;<span class="ident" id="1425220">i</span><span class="op" id="1425221">,</span>&nbsp;<span class="ident" id="1425223">b</span>&nbsp;<span class="op" id="1425225">:=</span>&nbsp;<span class="keyword" id="1425228">range</span>&nbsp;<span class="ident" id="1425234"><a href="/net/ip.go.html#1425154">x</a></span>&nbsp;<span class="op" id="1425236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425240">if</span>&nbsp;<span class="ident" id="1425243"><a href="/net/ip.go.html#1425157">y</a></span><span class="op" id="1425244">[</span><span class="ident" id="1425245"><a href="/net/ip.go.html#1425220">i</a></span><span class="op" id="1425246">]</span>&nbsp;<span class="op" id="1425248">!=</span>&nbsp;<span class="ident" id="1425251"><a href="/net/ip.go.html#1425223">b</a></span>&nbsp;<span class="op" id="1425253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425258">return</span>&nbsp;<span class="builtintype" id="1425265">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425276">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425279">return</span>&nbsp;<span class="builtintype" id="1425286">true</span><br>
<span class="lineno"></span><span class="op" id="1425291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1425294">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="1425349">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="1425381">func</span>&nbsp;<span class="ident" id="1425386">simpleMaskLength</span><span class="op" id="1425402">(</span><span class="ident" id="1425403">mask</span>&nbsp;<span class="ident" id="1425408"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1425414">)</span>&nbsp;<span class="builtintype" id="1425416">int</span>&nbsp;<span class="op" id="1425420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425423">var</span>&nbsp;<span class="ident" id="1425427">n</span>&nbsp;<span class="builtintype" id="1425429">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425434">for</span>&nbsp;<span class="ident" id="1425438">i</span><span class="op" id="1425439">,</span>&nbsp;<span class="ident" id="1425441">v</span>&nbsp;<span class="op" id="1425443">:=</span>&nbsp;<span class="keyword" id="1425446">range</span>&nbsp;<span class="ident" id="1425452"><a href="/net/ip.go.html#1425403">mask</a></span>&nbsp;<span class="op" id="1425457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425461">if</span>&nbsp;<span class="ident" id="1425464"><a href="/net/ip.go.html#1425441">v</a></span>&nbsp;<span class="op" id="1425466">==</span>&nbsp;<span class="num" id="1425469">0xff</span>&nbsp;<span class="op" id="1425474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425479"><a href="/net/ip.go.html#1425427">n</a></span>&nbsp;<span class="op" id="1425481">+=</span>&nbsp;<span class="num" id="1425484">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425489">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1425504">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1425527">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425545">for</span>&nbsp;<span class="ident" id="1425549"><a href="/net/ip.go.html#1425441">v</a></span><span class="op" id="1425550">&amp;</span><span class="num" id="1425551">0x80</span>&nbsp;<span class="op" id="1425556">!=</span>&nbsp;<span class="num" id="1425559">0</span>&nbsp;<span class="op" id="1425561">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425566"><a href="/net/ip.go.html#1425427">n</a></span><span class="op" id="1425567">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425573"><a href="/net/ip.go.html#1425441">v</a></span>&nbsp;<span class="op" id="1425575">&lt;&lt;=</span>&nbsp;<span class="num" id="1425579">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1425587">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425612">if</span>&nbsp;<span class="ident" id="1425615"><a href="/net/ip.go.html#1425441">v</a></span>&nbsp;<span class="op" id="1425617">!=</span>&nbsp;<span class="num" id="1425620">0</span>&nbsp;<span class="op" id="1425622">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425627">return</span>&nbsp;<span class="op" id="1425634">-</span><span class="num" id="1425635">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425643">for</span>&nbsp;<span class="ident" id="1425647"><a href="/net/ip.go.html#1425438">i</a></span><span class="op" id="1425648">++</span><span class="op" id="1425650">;</span>&nbsp;<span class="ident" id="1425652"><a href="/net/ip.go.html#1425438">i</a></span>&nbsp;<span class="op" id="1425654">&lt;</span>&nbsp;<span class="builtinfunc" id="1425656">len</span><span class="op" id="1425659">(</span><span class="ident" id="1425660"><a href="/net/ip.go.html#1425403">mask</a></span><span class="op" id="1425664">)</span><span class="op" id="1425665">;</span>&nbsp;<span class="ident" id="1425667"><a href="/net/ip.go.html#1425438">i</a></span><span class="op" id="1425668">++</span>&nbsp;<span class="op" id="1425671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425676">if</span>&nbsp;<span class="ident" id="1425679"><a href="/net/ip.go.html#1425403">mask</a></span><span class="op" id="1425683">[</span><span class="ident" id="1425684"><a href="/net/ip.go.html#1425438">i</a></span><span class="op" id="1425685">]</span>&nbsp;<span class="op" id="1425687">!=</span>&nbsp;<span class="num" id="1425690">0</span>&nbsp;<span class="op" id="1425692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425698">return</span>&nbsp;<span class="op" id="1425705">-</span><span class="num" id="1425706">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425719">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1425726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425729">return</span>&nbsp;<span class="ident" id="1425736"><a href="/net/ip.go.html#1425427">n</a></span><br>
<span class="lineno">410</span><span class="op" id="1425738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1425741">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="1425812">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="1425886">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="1425908">func</span>&nbsp;<span class="op" id="1425913">(</span><span class="ident" id="1425914">m</span>&nbsp;<span class="ident" id="1425916"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1425922">)</span>&nbsp;<span class="ident" id="1425924">Size</span><span class="op" id="1425928">(</span><span class="op" id="1425929">)</span>&nbsp;<span class="op" id="1425931">(</span><span class="ident" id="1425932">ones</span><span class="op" id="1425936">,</span>&nbsp;<span class="ident" id="1425938">bits</span>&nbsp;<span class="builtintype" id="1425943">int</span><span class="op" id="1425946">)</span>&nbsp;<span class="op" id="1425948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1425951"><a href="/net/ip.go.html#1425932">ones</a></span><span class="op" id="1425955">,</span>&nbsp;<span class="ident" id="1425957"><a href="/net/ip.go.html#1425938">bits</a></span>&nbsp;<span class="op" id="1425962">=</span>&nbsp;<span class="ident" id="1425964"><a href="/net/ip.go.html#1425386">simpleMaskLength</a></span><span class="op" id="1425980">(</span><span class="ident" id="1425981"><a href="/net/ip.go.html#1425914">m</a></span><span class="op" id="1425982">)</span><span class="op" id="1425983">,</span>&nbsp;<span class="builtinfunc" id="1425985">len</span><span class="op" id="1425988">(</span><span class="ident" id="1425989"><a href="/net/ip.go.html#1425914">m</a></span><span class="op" id="1425990">)</span><span class="op" id="1425991">*</span><span class="num" id="1425992">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1425995">if</span>&nbsp;<span class="ident" id="1425998"><a href="/net/ip.go.html#1425932">ones</a></span>&nbsp;<span class="op" id="1426003">==</span>&nbsp;<span class="op" id="1426006">-</span><span class="num" id="1426007">1</span>&nbsp;<span class="op" id="1426009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426013">return</span>&nbsp;<span class="num" id="1426020">0</span><span class="op" id="1426021">,</span>&nbsp;<span class="num" id="1426023">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426026">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426029">return</span><br>
<span class="lineno"></span><span class="op" id="1426036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1426039">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="1426105">func</span>&nbsp;<span class="op" id="1426110">(</span><span class="ident" id="1426111">m</span>&nbsp;<span class="ident" id="1426113"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1426119">)</span>&nbsp;<span class="ident" id="1426121">String</span><span class="op" id="1426127">(</span><span class="op" id="1426128">)</span>&nbsp;<span class="builtintype" id="1426130">string</span>&nbsp;<span class="op" id="1426137">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426140">if</span>&nbsp;<span class="builtinfunc" id="1426143">len</span><span class="op" id="1426146">(</span><span class="ident" id="1426147"><a href="/net/ip.go.html#1426111">m</a></span><span class="op" id="1426148">)</span>&nbsp;<span class="op" id="1426150">==</span>&nbsp;<span class="num" id="1426153">0</span>&nbsp;<span class="op" id="1426155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426159">return</span>&nbsp;<span class="string" id="1426166">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426178">buf</span>&nbsp;<span class="op" id="1426182">:=</span>&nbsp;<span class="builtinfunc" id="1426185">make</span><span class="op" id="1426189">(</span><span class="op" id="1426190">[</span><span class="op" id="1426191">]</span><span class="builtintype" id="1426192">byte</span><span class="op" id="1426196">,</span>&nbsp;<span class="builtinfunc" id="1426198">len</span><span class="op" id="1426201">(</span><span class="ident" id="1426202"><a href="/net/ip.go.html#1426111">m</a></span><span class="op" id="1426203">)</span><span class="op" id="1426204">*</span><span class="num" id="1426205">2</span><span class="op" id="1426206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426209">for</span>&nbsp;<span class="ident" id="1426213">i</span><span class="op" id="1426214">,</span>&nbsp;<span class="ident" id="1426216">b</span>&nbsp;<span class="op" id="1426218">:=</span>&nbsp;<span class="keyword" id="1426221">range</span>&nbsp;<span class="ident" id="1426227"><a href="/net/ip.go.html#1426111">m</a></span>&nbsp;<span class="op" id="1426229">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426233"><a href="/net/ip.go.html#1426178">buf</a></span><span class="op" id="1426236">[</span><span class="ident" id="1426237"><a href="/net/ip.go.html#1426213">i</a></span><span class="op" id="1426238">*</span><span class="num" id="1426239">2</span><span class="op" id="1426240">]</span><span class="op" id="1426241">,</span>&nbsp;<span class="ident" id="1426243"><a href="/net/ip.go.html#1426178">buf</a></span><span class="op" id="1426246">[</span><span class="ident" id="1426247"><a href="/net/ip.go.html#1426213">i</a></span><span class="op" id="1426248">*</span><span class="num" id="1426249">2</span><span class="op" id="1426250">+</span><span class="num" id="1426251">1</span><span class="op" id="1426252">]</span>&nbsp;<span class="op" id="1426254">=</span>&nbsp;<span class="ident" id="1426256"><a href="/net/mac.go.html#1462368">hexDigit</a></span><span class="op" id="1426264">[</span><span class="ident" id="1426265"><a href="/net/ip.go.html#1426216">b</a></span><span class="op" id="1426266">&gt;&gt;</span><span class="num" id="1426268">4</span><span class="op" id="1426269">]</span><span class="op" id="1426270">,</span>&nbsp;<span class="ident" id="1426272"><a href="/net/mac.go.html#1462368">hexDigit</a></span><span class="op" id="1426280">[</span><span class="ident" id="1426281"><a href="/net/ip.go.html#1426216">b</a></span><span class="op" id="1426282">&amp;</span><span class="num" id="1426283">0xf</span><span class="op" id="1426286">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426292">return</span>&nbsp;<span class="builtintype" id="1426299">string</span><span class="op" id="1426305">(</span><span class="ident" id="1426306"><a href="/net/ip.go.html#1426178">buf</a></span><span class="op" id="1426309">)</span><br>
<span class="lineno"></span><span class="op" id="1426311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="1426314">func</span>&nbsp;<span class="ident" id="1426319">networkNumberAndMask</span><span class="op" id="1426339">(</span><span class="ident" id="1426340">n</span>&nbsp;<span class="op" id="1426342">*</span><span class="ident" id="1426343"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1426348">)</span>&nbsp;<span class="op" id="1426350">(</span><span class="ident" id="1426351">ip</span>&nbsp;<span class="ident" id="1426354"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1426356">,</span>&nbsp;<span class="ident" id="1426358">m</span>&nbsp;<span class="ident" id="1426360"><a href="/net/ip.go.html#1417237">IPMask</a></span><span class="op" id="1426366">)</span>&nbsp;<span class="op" id="1426368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426371">if</span>&nbsp;<span class="ident" id="1426374"><a href="/net/ip.go.html#1426351">ip</a></span>&nbsp;<span class="op" id="1426377">=</span>&nbsp;<span class="ident" id="1426379"><a href="/net/ip.go.html#1426340">n</a></span><span class="op" id="1426380">.</span><span class="ident" id="1426381">IP</span><span class="op" id="1426383">.</span><span class="ident" id="1426384">To4</span><span class="op" id="1426387">(</span><span class="op" id="1426388">)</span><span class="op" id="1426389">;</span>&nbsp;<span class="ident" id="1426391"><a href="/net/ip.go.html#1426351">ip</a></span>&nbsp;<span class="op" id="1426394">==</span>&nbsp;<span class="ident" id="1426397">nil</span>&nbsp;<span class="op" id="1426401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426405"><a href="/net/ip.go.html#1426351">ip</a></span>&nbsp;<span class="op" id="1426408">=</span>&nbsp;<span class="ident" id="1426410"><a href="/net/ip.go.html#1426340">n</a></span><span class="op" id="1426411">.</span><span class="ident" id="1426412">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426417">if</span>&nbsp;<span class="builtinfunc" id="1426420">len</span><span class="op" id="1426423">(</span><span class="ident" id="1426424"><a href="/net/ip.go.html#1426351">ip</a></span><span class="op" id="1426426">)</span>&nbsp;<span class="op" id="1426428">!=</span>&nbsp;<span class="ident" id="1426431"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1426439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426444">return</span>&nbsp;<span class="ident" id="1426451">nil</span><span class="op" id="1426454">,</span>&nbsp;<span class="ident" id="1426456">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426468"><a href="/net/ip.go.html#1426358">m</a></span>&nbsp;<span class="op" id="1426470">=</span>&nbsp;<span class="ident" id="1426472"><a href="/net/ip.go.html#1426340">n</a></span><span class="op" id="1426473">.</span><span class="ident" id="1426474">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426480">switch</span>&nbsp;<span class="builtinfunc" id="1426487">len</span><span class="op" id="1426490">(</span><span class="ident" id="1426491"><a href="/net/ip.go.html#1426358">m</a></span><span class="op" id="1426492">)</span>&nbsp;<span class="op" id="1426494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426497">case</span>&nbsp;<span class="ident" id="1426502"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1426509">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426513">if</span>&nbsp;<span class="builtinfunc" id="1426516">len</span><span class="op" id="1426519">(</span><span class="ident" id="1426520"><a href="/net/ip.go.html#1426351">ip</a></span><span class="op" id="1426522">)</span>&nbsp;<span class="op" id="1426524">!=</span>&nbsp;<span class="ident" id="1426527"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1426535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426540">return</span>&nbsp;<span class="ident" id="1426547">nil</span><span class="op" id="1426550">,</span>&nbsp;<span class="ident" id="1426552">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426561">case</span>&nbsp;<span class="ident" id="1426566"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1426573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426577">if</span>&nbsp;<span class="builtinfunc" id="1426580">len</span><span class="op" id="1426583">(</span><span class="ident" id="1426584"><a href="/net/ip.go.html#1426351">ip</a></span><span class="op" id="1426586">)</span>&nbsp;<span class="op" id="1426588">==</span>&nbsp;<span class="ident" id="1426591"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1426599">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426604"><a href="/net/ip.go.html#1426358">m</a></span>&nbsp;<span class="op" id="1426606">=</span>&nbsp;<span class="ident" id="1426608"><a href="/net/ip.go.html#1426358">m</a></span><span class="op" id="1426609">[</span><span class="num" id="1426610">12</span><span class="op" id="1426612">:</span><span class="op" id="1426613">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426620">default</span><span class="op" id="1426627">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426631">return</span>&nbsp;<span class="ident" id="1426638">nil</span><span class="op" id="1426641">,</span>&nbsp;<span class="ident" id="1426643">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426648">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426651">return</span><br>
<span class="lineno"></span><span class="op" id="1426658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1426661">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="1426714">func</span>&nbsp;<span class="op" id="1426719">(</span><span class="ident" id="1426720">n</span>&nbsp;<span class="op" id="1426722">*</span><span class="ident" id="1426723"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1426728">)</span>&nbsp;<span class="ident" id="1426730">Contains</span><span class="op" id="1426738">(</span><span class="ident" id="1426739">ip</span>&nbsp;<span class="ident" id="1426742"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1426744">)</span>&nbsp;<span class="builtintype" id="1426746">bool</span>&nbsp;<span class="op" id="1426751">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426754">nn</span><span class="op" id="1426756">,</span>&nbsp;<span class="ident" id="1426758">m</span>&nbsp;<span class="op" id="1426760">:=</span>&nbsp;<span class="ident" id="1426763"><a href="/net/ip.go.html#1426319">networkNumberAndMask</a></span><span class="op" id="1426783">(</span><span class="ident" id="1426784"><a href="/net/ip.go.html#1426720">n</a></span><span class="op" id="1426785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426788">if</span>&nbsp;<span class="ident" id="1426791">x</span>&nbsp;<span class="op" id="1426793">:=</span>&nbsp;<span class="ident" id="1426796"><a href="/net/ip.go.html#1426739">ip</a></span><span class="op" id="1426798">.</span><span class="ident" id="1426799">To4</span><span class="op" id="1426802">(</span><span class="op" id="1426803">)</span><span class="op" id="1426804">;</span>&nbsp;<span class="ident" id="1426806"><a href="/net/ip.go.html#1426791">x</a></span>&nbsp;<span class="op" id="1426808">!=</span>&nbsp;<span class="ident" id="1426811">nil</span>&nbsp;<span class="op" id="1426815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426819"><a href="/net/ip.go.html#1426739">ip</a></span>&nbsp;<span class="op" id="1426822">=</span>&nbsp;<span class="ident" id="1426824"><a href="/net/ip.go.html#1426791">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1426830">l</span>&nbsp;<span class="op" id="1426832">:=</span>&nbsp;<span class="builtinfunc" id="1426835">len</span><span class="op" id="1426838">(</span><span class="ident" id="1426839"><a href="/net/ip.go.html#1426739">ip</a></span><span class="op" id="1426841">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426844">if</span>&nbsp;<span class="ident" id="1426847"><a href="/net/ip.go.html#1426830">l</a></span>&nbsp;<span class="op" id="1426849">!=</span>&nbsp;<span class="builtinfunc" id="1426852">len</span><span class="op" id="1426855">(</span><span class="ident" id="1426856"><a href="/net/ip.go.html#1426754">nn</a></span><span class="op" id="1426858">)</span>&nbsp;<span class="op" id="1426860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426864">return</span>&nbsp;<span class="builtintype" id="1426871">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426881">for</span>&nbsp;<span class="ident" id="1426885">i</span>&nbsp;<span class="op" id="1426887">:=</span>&nbsp;<span class="num" id="1426890">0</span><span class="op" id="1426891">;</span>&nbsp;<span class="ident" id="1426893"><a href="/net/ip.go.html#1426885">i</a></span>&nbsp;<span class="op" id="1426895">&lt;</span>&nbsp;<span class="ident" id="1426897"><a href="/net/ip.go.html#1426830">l</a></span><span class="op" id="1426898">;</span>&nbsp;<span class="ident" id="1426900"><a href="/net/ip.go.html#1426885">i</a></span><span class="op" id="1426901">++</span>&nbsp;<span class="op" id="1426904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426908">if</span>&nbsp;<span class="ident" id="1426911"><a href="/net/ip.go.html#1426754">nn</a></span><span class="op" id="1426913">[</span><span class="ident" id="1426914"><a href="/net/ip.go.html#1426885">i</a></span><span class="op" id="1426915">]</span><span class="op" id="1426916">&amp;</span><span class="ident" id="1426917"><a href="/net/ip.go.html#1426758">m</a></span><span class="op" id="1426918">[</span><span class="ident" id="1426919"><a href="/net/ip.go.html#1426885">i</a></span><span class="op" id="1426920">]</span>&nbsp;<span class="op" id="1426922">!=</span>&nbsp;<span class="ident" id="1426925"><a href="/net/ip.go.html#1426739">ip</a></span><span class="op" id="1426927">[</span><span class="ident" id="1426928"><a href="/net/ip.go.html#1426885">i</a></span><span class="op" id="1426929">]</span><span class="op" id="1426930">&amp;</span><span class="ident" id="1426931"><a href="/net/ip.go.html#1426758">m</a></span><span class="op" id="1426932">[</span><span class="ident" id="1426933"><a href="/net/ip.go.html#1426885">i</a></span><span class="op" id="1426934">]</span>&nbsp;<span class="op" id="1426936">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426941">return</span>&nbsp;<span class="builtintype" id="1426948">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1426959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1426962">return</span>&nbsp;<span class="builtintype" id="1426969">true</span><br>
<span class="lineno"></span><span class="op" id="1426974">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="1426977">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="1427034">func</span>&nbsp;<span class="op" id="1427039">(</span><span class="ident" id="1427040">n</span>&nbsp;<span class="op" id="1427042">*</span><span class="ident" id="1427043"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1427048">)</span>&nbsp;<span class="ident" id="1427050">Network</span><span class="op" id="1427057">(</span><span class="op" id="1427058">)</span>&nbsp;<span class="builtintype" id="1427060">string</span>&nbsp;<span class="op" id="1427067">{</span>&nbsp;<span class="keyword" id="1427069">return</span>&nbsp;<span class="string" id="1427076">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="1427085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1427088">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="1427153">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="1427212">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1427272">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="1427335">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="1427397">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="1427443">func</span>&nbsp;<span class="op" id="1427448">(</span><span class="ident" id="1427449">n</span>&nbsp;<span class="op" id="1427451">*</span><span class="ident" id="1427452"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1427457">)</span>&nbsp;<span class="ident" id="1427459">String</span><span class="op" id="1427465">(</span><span class="op" id="1427466">)</span>&nbsp;<span class="builtintype" id="1427468">string</span>&nbsp;<span class="op" id="1427475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427478">nn</span><span class="op" id="1427480">,</span>&nbsp;<span class="ident" id="1427482">m</span>&nbsp;<span class="op" id="1427484">:=</span>&nbsp;<span class="ident" id="1427487"><a href="/net/ip.go.html#1426319">networkNumberAndMask</a></span><span class="op" id="1427507">(</span><span class="ident" id="1427508"><a href="/net/ip.go.html#1427449">n</a></span><span class="op" id="1427509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427512">if</span>&nbsp;<span class="ident" id="1427515"><a href="/net/ip.go.html#1427478">nn</a></span>&nbsp;<span class="op" id="1427518">==</span>&nbsp;<span class="ident" id="1427521">nil</span>&nbsp;<span class="op" id="1427525">||</span>&nbsp;<span class="ident" id="1427528"><a href="/net/ip.go.html#1427482">m</a></span>&nbsp;<span class="op" id="1427530">==</span>&nbsp;<span class="ident" id="1427533">nil</span>&nbsp;<span class="op" id="1427537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427541">return</span>&nbsp;<span class="string" id="1427548">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427557">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427560">l</span>&nbsp;<span class="op" id="1427562">:=</span>&nbsp;<span class="ident" id="1427565"><a href="/net/ip.go.html#1425386">simpleMaskLength</a></span><span class="op" id="1427581">(</span><span class="ident" id="1427582"><a href="/net/ip.go.html#1427482">m</a></span><span class="op" id="1427583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427586">if</span>&nbsp;<span class="ident" id="1427589"><a href="/net/ip.go.html#1427560">l</a></span>&nbsp;<span class="op" id="1427591">==</span>&nbsp;<span class="op" id="1427594">-</span><span class="num" id="1427595">1</span>&nbsp;<span class="op" id="1427597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427601">return</span>&nbsp;<span class="ident" id="1427608"><a href="/net/ip.go.html#1427478">nn</a></span><span class="op" id="1427610">.</span><span class="ident" id="1427611">String</span><span class="op" id="1427617">(</span><span class="op" id="1427618">)</span>&nbsp;<span class="op" id="1427620">+</span>&nbsp;<span class="string" id="1427622">&#34;/&#34;</span>&nbsp;<span class="op" id="1427626">+</span>&nbsp;<span class="ident" id="1427628"><a href="/net/ip.go.html#1427482">m</a></span><span class="op" id="1427629">.</span><span class="ident" id="1427630">String</span><span class="op" id="1427636">(</span><span class="op" id="1427637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427643">return</span>&nbsp;<span class="ident" id="1427650"><a href="/net/ip.go.html#1427478">nn</a></span><span class="op" id="1427652">.</span><span class="ident" id="1427653">String</span><span class="op" id="1427659">(</span><span class="op" id="1427660">)</span>&nbsp;<span class="op" id="1427662">+</span>&nbsp;<span class="string" id="1427664">&#34;/&#34;</span>&nbsp;<span class="op" id="1427668">+</span>&nbsp;<span class="ident" id="1427670"><a href="/net/parse.go.html#1479367">itod</a></span><span class="op" id="1427674">(</span><span class="builtintype" id="1427675">uint</span><span class="op" id="1427679">(</span><span class="ident" id="1427680"><a href="/net/ip.go.html#1427560">l</a></span><span class="op" id="1427681">)</span><span class="op" id="1427682">)</span><br>
<span class="lineno">495</span><span class="op" id="1427684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1427687">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="1427720">func</span>&nbsp;<span class="ident" id="1427725">parseIPv4</span><span class="op" id="1427734">(</span><span class="ident" id="1427735">s</span>&nbsp;<span class="builtintype" id="1427737">string</span><span class="op" id="1427743">)</span>&nbsp;<span class="ident" id="1427745"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1427748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427751">var</span>&nbsp;<span class="ident" id="1427755">p</span>&nbsp;<span class="op" id="1427757">[</span><span class="ident" id="1427758"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1427765">]</span><span class="builtintype" id="1427766">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427772">i</span>&nbsp;<span class="op" id="1427774">:=</span>&nbsp;<span class="num" id="1427777">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427780">for</span>&nbsp;<span class="ident" id="1427784">j</span>&nbsp;<span class="op" id="1427786">:=</span>&nbsp;<span class="num" id="1427789">0</span><span class="op" id="1427790">;</span>&nbsp;<span class="ident" id="1427792"><a href="/net/ip.go.html#1427784">j</a></span>&nbsp;<span class="op" id="1427794">&lt;</span>&nbsp;<span class="ident" id="1427796"><a href="/net/ip.go.html#1416769">IPv4len</a></span><span class="op" id="1427803">;</span>&nbsp;<span class="ident" id="1427805"><a href="/net/ip.go.html#1427784">j</a></span><span class="op" id="1427806">++</span>&nbsp;<span class="op" id="1427809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427813">if</span>&nbsp;<span class="ident" id="1427816"><a href="/net/ip.go.html#1427772">i</a></span>&nbsp;<span class="op" id="1427818">&gt;=</span>&nbsp;<span class="builtinfunc" id="1427821">len</span><span class="op" id="1427824">(</span><span class="ident" id="1427825"><a href="/net/ip.go.html#1427735">s</a></span><span class="op" id="1427826">)</span>&nbsp;<span class="op" id="1427828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1427833">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427855">return</span>&nbsp;<span class="ident" id="1427862">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427872">if</span>&nbsp;<span class="ident" id="1427875"><a href="/net/ip.go.html#1427784">j</a></span>&nbsp;<span class="op" id="1427877">&gt;</span>&nbsp;<span class="num" id="1427879">0</span>&nbsp;<span class="op" id="1427881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427886">if</span>&nbsp;<span class="ident" id="1427889"><a href="/net/ip.go.html#1427735">s</a></span><span class="op" id="1427890">[</span><span class="ident" id="1427891"><a href="/net/ip.go.html#1427772">i</a></span><span class="op" id="1427892">]</span>&nbsp;<span class="op" id="1427894">!=</span>&nbsp;<span class="string" id="1427897">&#39;.&#39;</span>&nbsp;<span class="op" id="1427901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427907">return</span>&nbsp;<span class="ident" id="1427914">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427921">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427926"><a href="/net/ip.go.html#1427772">i</a></span><span class="op" id="1427927">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427936">var</span>&nbsp;<span class="op" id="1427940">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427945">n</span>&nbsp;&nbsp;<span class="builtintype" id="1427948">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427955">ok</span>&nbsp;<span class="builtintype" id="1427958">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1427965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1427969"><a href="/net/ip.go.html#1427945">n</a></span><span class="op" id="1427970">,</span>&nbsp;<span class="ident" id="1427972"><a href="/net/ip.go.html#1427772">i</a></span><span class="op" id="1427973">,</span>&nbsp;<span class="ident" id="1427975"><a href="/net/ip.go.html#1427955">ok</a></span>&nbsp;<span class="op" id="1427978">=</span>&nbsp;<span class="ident" id="1427980"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1427984">(</span><span class="ident" id="1427985"><a href="/net/ip.go.html#1427735">s</a></span><span class="op" id="1427986">,</span>&nbsp;<span class="ident" id="1427988"><a href="/net/ip.go.html#1427772">i</a></span><span class="op" id="1427989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1427993">if</span>&nbsp;<span class="op" id="1427996">!</span><span class="ident" id="1427997"><a href="/net/ip.go.html#1427955">ok</a></span>&nbsp;<span class="op" id="1428000">||</span>&nbsp;<span class="ident" id="1428003"><a href="/net/ip.go.html#1427945">n</a></span>&nbsp;<span class="op" id="1428005">&gt;</span>&nbsp;<span class="num" id="1428007">0xFF</span>&nbsp;<span class="op" id="1428012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428017">return</span>&nbsp;<span class="ident" id="1428024">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428030">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428034"><a href="/net/ip.go.html#1427755">p</a></span><span class="op" id="1428035">[</span><span class="ident" id="1428036"><a href="/net/ip.go.html#1427784">j</a></span><span class="op" id="1428037">]</span>&nbsp;<span class="op" id="1428039">=</span>&nbsp;<span class="builtintype" id="1428041">byte</span><span class="op" id="1428045">(</span><span class="ident" id="1428046"><a href="/net/ip.go.html#1427945">n</a></span><span class="op" id="1428047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428053">if</span>&nbsp;<span class="ident" id="1428056"><a href="/net/ip.go.html#1427772">i</a></span>&nbsp;<span class="op" id="1428058">!=</span>&nbsp;<span class="builtinfunc" id="1428061">len</span><span class="op" id="1428064">(</span><span class="ident" id="1428065"><a href="/net/ip.go.html#1427735">s</a></span><span class="op" id="1428066">)</span>&nbsp;<span class="op" id="1428068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428072">return</span>&nbsp;<span class="ident" id="1428079">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428084">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428087">return</span>&nbsp;<span class="ident" id="1428094"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="1428098">(</span><span class="ident" id="1428099"><a href="/net/ip.go.html#1427755">p</a></span><span class="op" id="1428100">[</span><span class="num" id="1428101">0</span><span class="op" id="1428102">]</span><span class="op" id="1428103">,</span>&nbsp;<span class="ident" id="1428105"><a href="/net/ip.go.html#1427755">p</a></span><span class="op" id="1428106">[</span><span class="num" id="1428107">1</span><span class="op" id="1428108">]</span><span class="op" id="1428109">,</span>&nbsp;<span class="ident" id="1428111"><a href="/net/ip.go.html#1427755">p</a></span><span class="op" id="1428112">[</span><span class="num" id="1428113">2</span><span class="op" id="1428114">]</span><span class="op" id="1428115">,</span>&nbsp;<span class="ident" id="1428117"><a href="/net/ip.go.html#1427755">p</a></span><span class="op" id="1428118">[</span><span class="num" id="1428119">3</span><span class="op" id="1428120">]</span><span class="op" id="1428121">)</span><br>
<span class="lineno"></span><span class="op" id="1428123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1428126">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="1428196">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="1428267">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1428337">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="1428346">func</span>&nbsp;<span class="ident" id="1428351">parseIPv6</span><span class="op" id="1428360">(</span><span class="ident" id="1428361">s</span>&nbsp;<span class="builtintype" id="1428363">string</span><span class="op" id="1428369">,</span>&nbsp;<span class="ident" id="1428371">zoneAllowed</span>&nbsp;<span class="builtintype" id="1428383">bool</span><span class="op" id="1428387">)</span>&nbsp;<span class="op" id="1428389">(</span><span class="ident" id="1428390">ip</span>&nbsp;<span class="ident" id="1428393"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1428395">,</span>&nbsp;<span class="ident" id="1428397">zone</span>&nbsp;<span class="builtintype" id="1428402">string</span><span class="op" id="1428408">)</span>&nbsp;<span class="op" id="1428410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428413"><a href="/net/ip.go.html#1428390">ip</a></span>&nbsp;<span class="op" id="1428416">=</span>&nbsp;<span class="builtinfunc" id="1428418">make</span><span class="op" id="1428422">(</span><span class="ident" id="1428423"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1428425">,</span>&nbsp;<span class="ident" id="1428427"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1428434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428437">ellipsis</span>&nbsp;<span class="op" id="1428446">:=</span>&nbsp;<span class="op" id="1428449">-</span><span class="num" id="1428450">1</span>&nbsp;<span class="comment" id="1428452">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428482">i</span>&nbsp;<span class="op" id="1428484">:=</span>&nbsp;<span class="num" id="1428487">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1428497">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428520">if</span>&nbsp;<span class="ident" id="1428523"><a href="/net/ip.go.html#1428371">zoneAllowed</a></span>&nbsp;<span class="op" id="1428535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428539"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428540">,</span>&nbsp;<span class="ident" id="1428542"><a href="/net/ip.go.html#1428397">zone</a></span>&nbsp;<span class="op" id="1428547">=</span>&nbsp;<span class="ident" id="1428549"><a href="/net/ipsock.go.html#1445607">splitHostZone</a></span><span class="op" id="1428562">(</span><span class="ident" id="1428563"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428567">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1428571">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428603">if</span>&nbsp;<span class="builtinfunc" id="1428606">len</span><span class="op" id="1428609">(</span><span class="ident" id="1428610"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428611">)</span>&nbsp;<span class="op" id="1428613">&gt;=</span>&nbsp;<span class="num" id="1428616">2</span>&nbsp;<span class="op" id="1428618">&amp;&amp;</span>&nbsp;<span class="ident" id="1428621"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428622">[</span><span class="num" id="1428623">0</span><span class="op" id="1428624">]</span>&nbsp;<span class="op" id="1428626">==</span>&nbsp;<span class="string" id="1428629">&#39;:&#39;</span>&nbsp;<span class="op" id="1428633">&amp;&amp;</span>&nbsp;<span class="ident" id="1428636"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428637">[</span><span class="num" id="1428638">1</span><span class="op" id="1428639">]</span>&nbsp;<span class="op" id="1428641">==</span>&nbsp;<span class="string" id="1428644">&#39;:&#39;</span>&nbsp;<span class="op" id="1428648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428652"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1428661">=</span>&nbsp;<span class="num" id="1428663">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428667"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1428669">=</span>&nbsp;<span class="num" id="1428671">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1428675">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428703">if</span>&nbsp;<span class="ident" id="1428706"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1428708">==</span>&nbsp;<span class="builtinfunc" id="1428711">len</span><span class="op" id="1428714">(</span><span class="ident" id="1428715"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428716">)</span>&nbsp;<span class="op" id="1428718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428723">return</span>&nbsp;<span class="ident" id="1428730"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1428732">,</span>&nbsp;<span class="ident" id="1428734"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428744">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1428748">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428797">j</span>&nbsp;<span class="op" id="1428799">:=</span>&nbsp;<span class="num" id="1428802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428805">for</span>&nbsp;<span class="ident" id="1428809"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1428811">&lt;</span>&nbsp;<span class="ident" id="1428813"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1428821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1428825">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1428842">n</span><span class="op" id="1428843">,</span>&nbsp;<span class="ident" id="1428845">i1</span><span class="op" id="1428847">,</span>&nbsp;<span class="ident" id="1428849">ok</span>&nbsp;<span class="op" id="1428852">:=</span>&nbsp;<span class="ident" id="1428855"><a href="/net/parse.go.html#1478210">xtoi</a></span><span class="op" id="1428859">(</span><span class="ident" id="1428860"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428861">,</span>&nbsp;<span class="ident" id="1428863"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1428864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428868">if</span>&nbsp;<span class="op" id="1428871">!</span><span class="ident" id="1428872"><a href="/net/ip.go.html#1428849">ok</a></span>&nbsp;<span class="op" id="1428875">||</span>&nbsp;<span class="ident" id="1428878"><a href="/net/ip.go.html#1428842">n</a></span>&nbsp;<span class="op" id="1428880">&gt;</span>&nbsp;<span class="num" id="1428882">0xFFFF</span>&nbsp;<span class="op" id="1428889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428894">return</span>&nbsp;<span class="ident" id="1428901">nil</span><span class="op" id="1428904">,</span>&nbsp;<span class="ident" id="1428906"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1428913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1428918">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1428970">if</span>&nbsp;<span class="ident" id="1428973"><a href="/net/ip.go.html#1428845">i1</a></span>&nbsp;<span class="op" id="1428976">&lt;</span>&nbsp;<span class="builtinfunc" id="1428978">len</span><span class="op" id="1428981">(</span><span class="ident" id="1428982"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428983">)</span>&nbsp;<span class="op" id="1428985">&amp;&amp;</span>&nbsp;<span class="ident" id="1428988"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1428989">[</span><span class="ident" id="1428990"><a href="/net/ip.go.html#1428845">i1</a></span><span class="op" id="1428992">]</span>&nbsp;<span class="op" id="1428994">==</span>&nbsp;<span class="string" id="1428997">&#39;.&#39;</span>&nbsp;<span class="op" id="1429001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429006">if</span>&nbsp;<span class="ident" id="1429009"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1429018">&lt;</span>&nbsp;<span class="num" id="1429020">0</span>&nbsp;<span class="op" id="1429022">&amp;&amp;</span>&nbsp;<span class="ident" id="1429025"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1429027">!=</span>&nbsp;<span class="ident" id="1429030"><a href="/net/ip.go.html#1416782">IPv6len</a></span><span class="op" id="1429037">-</span><span class="ident" id="1429038"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1429046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429052">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429080">return</span>&nbsp;<span class="ident" id="1429087">nil</span><span class="op" id="1429090">,</span>&nbsp;<span class="ident" id="1429092"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429105">if</span>&nbsp;<span class="ident" id="1429108"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429109">+</span><span class="ident" id="1429110"><a href="/net/ip.go.html#1416769">IPv4len</a></span>&nbsp;<span class="op" id="1429118">&gt;</span>&nbsp;<span class="ident" id="1429120"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1429128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429134">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429158">return</span>&nbsp;<span class="ident" id="1429165">nil</span><span class="op" id="1429168">,</span>&nbsp;<span class="ident" id="1429170"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429178">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429183">ip4</span>&nbsp;<span class="op" id="1429187">:=</span>&nbsp;<span class="ident" id="1429190"><a href="/net/ip.go.html#1427725">parseIPv4</a></span><span class="op" id="1429199">(</span><span class="ident" id="1429200"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429201">[</span><span class="ident" id="1429202"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429203">:</span><span class="op" id="1429204">]</span><span class="op" id="1429205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429210">if</span>&nbsp;<span class="ident" id="1429213"><a href="/net/ip.go.html#1429183">ip4</a></span>&nbsp;<span class="op" id="1429217">==</span>&nbsp;<span class="ident" id="1429220">nil</span>&nbsp;<span class="op" id="1429224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429230">return</span>&nbsp;<span class="ident" id="1429237">nil</span><span class="op" id="1429240">,</span>&nbsp;<span class="ident" id="1429242"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429255"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429257">[</span><span class="ident" id="1429258"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429259">]</span>&nbsp;<span class="op" id="1429261">=</span>&nbsp;<span class="ident" id="1429263"><a href="/net/ip.go.html#1429183">ip4</a></span><span class="op" id="1429266">[</span><span class="num" id="1429267">12</span><span class="op" id="1429269">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429274"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429276">[</span><span class="ident" id="1429277"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429278">+</span><span class="num" id="1429279">1</span><span class="op" id="1429280">]</span>&nbsp;<span class="op" id="1429282">=</span>&nbsp;<span class="ident" id="1429284"><a href="/net/ip.go.html#1429183">ip4</a></span><span class="op" id="1429287">[</span><span class="num" id="1429288">13</span><span class="op" id="1429290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429295"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429297">[</span><span class="ident" id="1429298"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429299">+</span><span class="num" id="1429300">2</span><span class="op" id="1429301">]</span>&nbsp;<span class="op" id="1429303">=</span>&nbsp;<span class="ident" id="1429305"><a href="/net/ip.go.html#1429183">ip4</a></span><span class="op" id="1429308">[</span><span class="num" id="1429309">14</span><span class="op" id="1429311">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429316"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429318">[</span><span class="ident" id="1429319"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429320">+</span><span class="num" id="1429321">3</span><span class="op" id="1429322">]</span>&nbsp;<span class="op" id="1429324">=</span>&nbsp;<span class="ident" id="1429326"><a href="/net/ip.go.html#1429183">ip4</a></span><span class="op" id="1429329">[</span><span class="num" id="1429330">15</span><span class="op" id="1429332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429337"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1429339">=</span>&nbsp;<span class="builtinfunc" id="1429341">len</span><span class="op" id="1429344">(</span><span class="ident" id="1429345"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429351"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1429353">+=</span>&nbsp;<span class="ident" id="1429356"><a href="/net/ip.go.html#1416769">IPv4len</a></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429367">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429380">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429409"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429411">[</span><span class="ident" id="1429412"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429413">]</span>&nbsp;<span class="op" id="1429415">=</span>&nbsp;<span class="builtintype" id="1429417">byte</span><span class="op" id="1429421">(</span><span class="ident" id="1429422"><a href="/net/ip.go.html#1428842">n</a></span>&nbsp;<span class="op" id="1429424">&gt;&gt;</span>&nbsp;<span class="num" id="1429427">8</span><span class="op" id="1429428">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429432"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1429434">[</span><span class="ident" id="1429435"><a href="/net/ip.go.html#1428797">j</a></span><span class="op" id="1429436">+</span><span class="num" id="1429437">1</span><span class="op" id="1429438">]</span>&nbsp;<span class="op" id="1429440">=</span>&nbsp;<span class="builtintype" id="1429442">byte</span><span class="op" id="1429446">(</span><span class="ident" id="1429447"><a href="/net/ip.go.html#1428842">n</a></span><span class="op" id="1429448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429452"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1429454">+=</span>&nbsp;<span class="num" id="1429457">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429462">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429490"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1429492">=</span>&nbsp;<span class="ident" id="1429494"><a href="/net/ip.go.html#1428845">i1</a></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429499">if</span>&nbsp;<span class="ident" id="1429502"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1429504">==</span>&nbsp;<span class="builtinfunc" id="1429507">len</span><span class="op" id="1429510">(</span><span class="ident" id="1429511"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429512">)</span>&nbsp;<span class="op" id="1429514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429519">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429532">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429583">if</span>&nbsp;<span class="ident" id="1429586"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429587">[</span><span class="ident" id="1429588"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429589">]</span>&nbsp;<span class="op" id="1429591">!=</span>&nbsp;<span class="string" id="1429594">&#39;:&#39;</span>&nbsp;<span class="op" id="1429598">||</span>&nbsp;<span class="ident" id="1429601"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429602">+</span><span class="num" id="1429603">1</span>&nbsp;<span class="op" id="1429605">==</span>&nbsp;<span class="builtinfunc" id="1429608">len</span><span class="op" id="1429611">(</span><span class="ident" id="1429612"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429613">)</span>&nbsp;<span class="op" id="1429615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429620">return</span>&nbsp;<span class="ident" id="1429627">nil</span><span class="op" id="1429630">,</span>&nbsp;<span class="ident" id="1429632"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429643"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429644">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429650">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429674">if</span>&nbsp;<span class="ident" id="1429677"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429678">[</span><span class="ident" id="1429679"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429680">]</span>&nbsp;<span class="op" id="1429682">==</span>&nbsp;<span class="string" id="1429685">&#39;:&#39;</span>&nbsp;<span class="op" id="1429689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429694">if</span>&nbsp;<span class="ident" id="1429697"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1429706">&gt;=</span>&nbsp;<span class="num" id="1429709">0</span>&nbsp;<span class="op" id="1429711">{</span>&nbsp;<span class="comment" id="1429713">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429737">return</span>&nbsp;<span class="ident" id="1429744">nil</span><span class="op" id="1429747">,</span>&nbsp;<span class="ident" id="1429749"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429757">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1429762"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1429771">=</span>&nbsp;<span class="ident" id="1429773"><a href="/net/ip.go.html#1428797">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429778">if</span>&nbsp;<span class="ident" id="1429781"><a href="/net/ip.go.html#1428482">i</a></span><span class="op" id="1429782">++</span><span class="op" id="1429784">;</span>&nbsp;<span class="ident" id="1429786"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1429788">==</span>&nbsp;<span class="builtinfunc" id="1429791">len</span><span class="op" id="1429794">(</span><span class="ident" id="1429795"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429796">)</span>&nbsp;<span class="op" id="1429798">{</span>&nbsp;<span class="comment" id="1429800">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429821">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429834">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429841">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429875">if</span>&nbsp;<span class="ident" id="1429878"><a href="/net/ip.go.html#1428482">i</a></span>&nbsp;<span class="op" id="1429880">!=</span>&nbsp;<span class="builtinfunc" id="1429883">len</span><span class="op" id="1429886">(</span><span class="ident" id="1429887"><a href="/net/ip.go.html#1428361">s</a></span><span class="op" id="1429888">)</span>&nbsp;<span class="op" id="1429890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429894">return</span>&nbsp;<span class="ident" id="1429901">nil</span><span class="op" id="1429904">,</span>&nbsp;<span class="ident" id="1429906"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1429912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1429916">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429961">if</span>&nbsp;<span class="ident" id="1429964"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1429966">&lt;</span>&nbsp;<span class="ident" id="1429968"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1429976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1429980">if</span>&nbsp;<span class="ident" id="1429983"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1429992">&lt;</span>&nbsp;<span class="num" id="1429994">0</span>&nbsp;<span class="op" id="1429996">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430001">return</span>&nbsp;<span class="ident" id="1430008">nil</span><span class="op" id="1430011">,</span>&nbsp;<span class="ident" id="1430013"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430024">n</span>&nbsp;<span class="op" id="1430026">:=</span>&nbsp;<span class="ident" id="1430029"><a href="/net/ip.go.html#1416782">IPv6len</a></span>&nbsp;<span class="op" id="1430037">-</span>&nbsp;<span class="ident" id="1430039"><a href="/net/ip.go.html#1428797">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430043">for</span>&nbsp;<span class="ident" id="1430047">k</span>&nbsp;<span class="op" id="1430049">:=</span>&nbsp;<span class="ident" id="1430052"><a href="/net/ip.go.html#1428797">j</a></span>&nbsp;<span class="op" id="1430054">-</span>&nbsp;<span class="num" id="1430056">1</span><span class="op" id="1430057">;</span>&nbsp;<span class="ident" id="1430059"><a href="/net/ip.go.html#1430047">k</a></span>&nbsp;<span class="op" id="1430061">&gt;=</span>&nbsp;<span class="ident" id="1430064"><a href="/net/ip.go.html#1428437">ellipsis</a></span><span class="op" id="1430072">;</span>&nbsp;<span class="ident" id="1430074"><a href="/net/ip.go.html#1430047">k</a></span><span class="op" id="1430075">--</span>&nbsp;<span class="op" id="1430078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430083"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1430085">[</span><span class="ident" id="1430086"><a href="/net/ip.go.html#1430047">k</a></span><span class="op" id="1430087">+</span><span class="ident" id="1430088"><a href="/net/ip.go.html#1430024">n</a></span><span class="op" id="1430089">]</span>&nbsp;<span class="op" id="1430091">=</span>&nbsp;<span class="ident" id="1430093"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1430095">[</span><span class="ident" id="1430096"><a href="/net/ip.go.html#1430047">k</a></span><span class="op" id="1430097">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430105">for</span>&nbsp;<span class="ident" id="1430109">k</span>&nbsp;<span class="op" id="1430111">:=</span>&nbsp;<span class="ident" id="1430114"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1430123">+</span>&nbsp;<span class="ident" id="1430125"><a href="/net/ip.go.html#1430024">n</a></span>&nbsp;<span class="op" id="1430127">-</span>&nbsp;<span class="num" id="1430129">1</span><span class="op" id="1430130">;</span>&nbsp;<span class="ident" id="1430132"><a href="/net/ip.go.html#1430109">k</a></span>&nbsp;<span class="op" id="1430134">&gt;=</span>&nbsp;<span class="ident" id="1430137"><a href="/net/ip.go.html#1428437">ellipsis</a></span><span class="op" id="1430145">;</span>&nbsp;<span class="ident" id="1430147"><a href="/net/ip.go.html#1430109">k</a></span><span class="op" id="1430148">--</span>&nbsp;<span class="op" id="1430151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430156"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1430158">[</span><span class="ident" id="1430159"><a href="/net/ip.go.html#1430109">k</a></span><span class="op" id="1430160">]</span>&nbsp;<span class="op" id="1430162">=</span>&nbsp;<span class="num" id="1430164">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430171">}</span>&nbsp;<span class="keyword" id="1430173">else</span>&nbsp;<span class="keyword" id="1430178">if</span>&nbsp;<span class="ident" id="1430181"><a href="/net/ip.go.html#1428437">ellipsis</a></span>&nbsp;<span class="op" id="1430190">&gt;=</span>&nbsp;<span class="num" id="1430193">0</span>&nbsp;<span class="op" id="1430195">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1430199">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430250">return</span>&nbsp;<span class="ident" id="1430257">nil</span><span class="op" id="1430260">,</span>&nbsp;<span class="ident" id="1430262"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430271">return</span>&nbsp;<span class="ident" id="1430278"><a href="/net/ip.go.html#1428390">ip</a></span><span class="op" id="1430280">,</span>&nbsp;<span class="ident" id="1430282"><a href="/net/ip.go.html#1428397">zone</a></span><br>
<span class="lineno"></span><span class="op" id="1430287">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="1430290">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="1430383">type</span>&nbsp;<span class="ident" id="1430388">ParseError</span>&nbsp;<span class="keyword" id="1430399">struct</span>&nbsp;<span class="op" id="1430406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430409">Type</span>&nbsp;<span class="builtintype" id="1430414">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430422">Text</span>&nbsp;<span class="builtintype" id="1430427">string</span><br>
<span class="lineno">640</span><span class="op" id="1430434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1430437">func</span>&nbsp;<span class="op" id="1430442">(</span><span class="ident" id="1430443">e</span>&nbsp;<span class="op" id="1430445">*</span><span class="ident" id="1430446"><a href="/net/ip.go.html#1430388">ParseError</a></span><span class="op" id="1430456">)</span>&nbsp;<span class="ident" id="1430458">Error</span><span class="op" id="1430463">(</span><span class="op" id="1430464">)</span>&nbsp;<span class="builtintype" id="1430466">string</span>&nbsp;<span class="op" id="1430473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430476">return</span>&nbsp;<span class="string" id="1430483">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="1430494">+</span>&nbsp;<span class="ident" id="1430496"><a href="/net/ip.go.html#1430443">e</a></span><span class="op" id="1430497">.</span><span class="ident" id="1430498">Type</span>&nbsp;<span class="op" id="1430503">+</span>&nbsp;<span class="string" id="1430505">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="1430510">+</span>&nbsp;<span class="ident" id="1430512"><a href="/net/ip.go.html#1430443">e</a></span><span class="op" id="1430513">.</span><span class="ident" id="1430514">Text</span><br>
<span class="lineno"></span><span class="op" id="1430519">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="1430522">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="1430582">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="1430640">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="1430682">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="1430746">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1430770">func</span>&nbsp;<span class="ident" id="1430775">ParseIP</span><span class="op" id="1430782">(</span><span class="ident" id="1430783">s</span>&nbsp;<span class="builtintype" id="1430785">string</span><span class="op" id="1430791">)</span>&nbsp;<span class="ident" id="1430793"><a href="/net/ip.go.html#1417189">IP</a></span>&nbsp;<span class="op" id="1430796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430799">for</span>&nbsp;<span class="ident" id="1430803">i</span>&nbsp;<span class="op" id="1430805">:=</span>&nbsp;<span class="num" id="1430808">0</span><span class="op" id="1430809">;</span>&nbsp;<span class="ident" id="1430811"><a href="/net/ip.go.html#1430803">i</a></span>&nbsp;<span class="op" id="1430813">&lt;</span>&nbsp;<span class="builtinfunc" id="1430815">len</span><span class="op" id="1430818">(</span><span class="ident" id="1430819"><a href="/net/ip.go.html#1430783">s</a></span><span class="op" id="1430820">)</span><span class="op" id="1430821">;</span>&nbsp;<span class="ident" id="1430823"><a href="/net/ip.go.html#1430803">i</a></span><span class="op" id="1430824">++</span>&nbsp;<span class="op" id="1430827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430831">switch</span>&nbsp;<span class="ident" id="1430838"><a href="/net/ip.go.html#1430783">s</a></span><span class="op" id="1430839">[</span><span class="ident" id="1430840"><a href="/net/ip.go.html#1430803">i</a></span><span class="op" id="1430841">]</span>&nbsp;<span class="op" id="1430843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430847">case</span>&nbsp;<span class="string" id="1430852">&#39;.&#39;</span><span class="op" id="1430855">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430860">return</span>&nbsp;<span class="ident" id="1430867"><a href="/net/ip.go.html#1427725">parseIPv4</a></span><span class="op" id="1430876">(</span><span class="ident" id="1430877"><a href="/net/ip.go.html#1430783">s</a></span><span class="op" id="1430878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430882">case</span>&nbsp;<span class="string" id="1430887">&#39;:&#39;</span><span class="op" id="1430890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1430895">ip</span><span class="op" id="1430897">,</span>&nbsp;<span class="ident" id="1430899">_</span>&nbsp;<span class="op" id="1430901">:=</span>&nbsp;<span class="ident" id="1430904"><a href="/net/ip.go.html#1428351">parseIPv6</a></span><span class="op" id="1430913">(</span><span class="ident" id="1430914"><a href="/net/ip.go.html#1430783">s</a></span><span class="op" id="1430915">,</span>&nbsp;<span class="builtintype" id="1430917">false</span><span class="op" id="1430922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430927">return</span>&nbsp;<span class="ident" id="1430934"><a href="/net/ip.go.html#1430895">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430939">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1430942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1430945">return</span>&nbsp;<span class="ident" id="1430952">nil</span><br>
<span class="lineno"></span><span class="op" id="1430956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1430959">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="1431021">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="1431082">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="1431108">//</span><br>
<span class="lineno"></span><span class="comment" id="1431111">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="1431174">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="1431239">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="1431303">func</span>&nbsp;<span class="ident" id="1431308">ParseCIDR</span><span class="op" id="1431317">(</span><span class="ident" id="1431318">s</span>&nbsp;<span class="builtintype" id="1431320">string</span><span class="op" id="1431326">)</span>&nbsp;<span class="op" id="1431328">(</span><span class="ident" id="1431329"><a href="/net/ip.go.html#1417189">IP</a></span><span class="op" id="1431331">,</span>&nbsp;<span class="op" id="1431333">*</span><span class="ident" id="1431334"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1431339">,</span>&nbsp;<span class="builtintype" id="1431341">error</span><span class="op" id="1431346">)</span>&nbsp;<span class="op" id="1431348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431351">i</span>&nbsp;<span class="op" id="1431353">:=</span>&nbsp;<span class="ident" id="1431356"><a href="/net/parse.go.html#1476969">byteIndex</a></span><span class="op" id="1431365">(</span><span class="ident" id="1431366"><a href="/net/ip.go.html#1431318">s</a></span><span class="op" id="1431367">,</span>&nbsp;<span class="string" id="1431369">&#39;/&#39;</span><span class="op" id="1431372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431375">if</span>&nbsp;<span class="ident" id="1431378"><a href="/net/ip.go.html#1431351">i</a></span>&nbsp;<span class="op" id="1431380">&lt;</span>&nbsp;<span class="num" id="1431382">0</span>&nbsp;<span class="op" id="1431384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431388">return</span>&nbsp;<span class="ident" id="1431395">nil</span><span class="op" id="1431398">,</span>&nbsp;<span class="ident" id="1431400">nil</span><span class="op" id="1431403">,</span>&nbsp;<span class="op" id="1431405">&amp;</span><span class="ident" id="1431406"><a href="/net/ip.go.html#1430388">ParseError</a></span><span class="op" id="1431416">{</span><span class="string" id="1431417">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="1431431">,</span>&nbsp;<span class="ident" id="1431433"><a href="/net/ip.go.html#1431318">s</a></span><span class="op" id="1431434">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1431437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431440">addr</span><span class="op" id="1431444">,</span>&nbsp;<span class="ident" id="1431446">mask</span>&nbsp;<span class="op" id="1431451">:=</span>&nbsp;<span class="ident" id="1431454"><a href="/net/ip.go.html#1431318">s</a></span><span class="op" id="1431455">[</span><span class="op" id="1431456">:</span><span class="ident" id="1431457"><a href="/net/ip.go.html#1431351">i</a></span><span class="op" id="1431458">]</span><span class="op" id="1431459">,</span>&nbsp;<span class="ident" id="1431461"><a href="/net/ip.go.html#1431318">s</a></span><span class="op" id="1431462">[</span><span class="ident" id="1431463"><a href="/net/ip.go.html#1431351">i</a></span><span class="op" id="1431464">+</span><span class="num" id="1431465">1</span><span class="op" id="1431466">:</span><span class="op" id="1431467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431470">iplen</span>&nbsp;<span class="op" id="1431476">:=</span>&nbsp;<span class="ident" id="1431479"><a href="/net/ip.go.html#1416769">IPv4len</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431488">ip</span>&nbsp;<span class="op" id="1431491">:=</span>&nbsp;<span class="ident" id="1431494"><a href="/net/ip.go.html#1427725">parseIPv4</a></span><span class="op" id="1431503">(</span><span class="ident" id="1431504"><a href="/net/ip.go.html#1431440">addr</a></span><span class="op" id="1431508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431511">if</span>&nbsp;<span class="ident" id="1431514"><a href="/net/ip.go.html#1431488">ip</a></span>&nbsp;<span class="op" id="1431517">==</span>&nbsp;<span class="ident" id="1431520">nil</span>&nbsp;<span class="op" id="1431524">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431528"><a href="/net/ip.go.html#1431470">iplen</a></span>&nbsp;<span class="op" id="1431534">=</span>&nbsp;<span class="ident" id="1431536"><a href="/net/ip.go.html#1416782">IPv6len</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431546"><a href="/net/ip.go.html#1431488">ip</a></span><span class="op" id="1431548">,</span>&nbsp;<span class="ident" id="1431550">_</span>&nbsp;<span class="op" id="1431552">=</span>&nbsp;<span class="ident" id="1431554"><a href="/net/ip.go.html#1428351">parseIPv6</a></span><span class="op" id="1431563">(</span><span class="ident" id="1431564"><a href="/net/ip.go.html#1431440">addr</a></span><span class="op" id="1431568">,</span>&nbsp;<span class="builtintype" id="1431570">false</span><span class="op" id="1431575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1431578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431581">n</span><span class="op" id="1431582">,</span>&nbsp;<span class="ident" id="1431584"><a href="/net/ip.go.html#1431351">i</a></span><span class="op" id="1431585">,</span>&nbsp;<span class="ident" id="1431587">ok</span>&nbsp;<span class="op" id="1431590">:=</span>&nbsp;<span class="ident" id="1431593"><a href="/net/parse.go.html#1477870">dtoi</a></span><span class="op" id="1431597">(</span><span class="ident" id="1431598"><a href="/net/ip.go.html#1431446">mask</a></span><span class="op" id="1431602">,</span>&nbsp;<span class="num" id="1431604">0</span><span class="op" id="1431605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431608">if</span>&nbsp;<span class="ident" id="1431611"><a href="/net/ip.go.html#1431488">ip</a></span>&nbsp;<span class="op" id="1431614">==</span>&nbsp;<span class="ident" id="1431617">nil</span>&nbsp;<span class="op" id="1431621">||</span>&nbsp;<span class="op" id="1431624">!</span><span class="ident" id="1431625"><a href="/net/ip.go.html#1431587">ok</a></span>&nbsp;<span class="op" id="1431628">||</span>&nbsp;<span class="ident" id="1431631"><a href="/net/ip.go.html#1431351">i</a></span>&nbsp;<span class="op" id="1431633">!=</span>&nbsp;<span class="builtinfunc" id="1431636">len</span><span class="op" id="1431639">(</span><span class="ident" id="1431640"><a href="/net/ip.go.html#1431446">mask</a></span><span class="op" id="1431644">)</span>&nbsp;<span class="op" id="1431646">||</span>&nbsp;<span class="ident" id="1431649"><a href="/net/ip.go.html#1431581">n</a></span>&nbsp;<span class="op" id="1431651">&lt;</span>&nbsp;<span class="num" id="1431653">0</span>&nbsp;<span class="op" id="1431655">||</span>&nbsp;<span class="ident" id="1431658"><a href="/net/ip.go.html#1431581">n</a></span>&nbsp;<span class="op" id="1431660">&gt;</span>&nbsp;<span class="num" id="1431662">8</span><span class="op" id="1431663">*</span><span class="ident" id="1431664"><a href="/net/ip.go.html#1431470">iplen</a></span>&nbsp;<span class="op" id="1431670">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431674">return</span>&nbsp;<span class="ident" id="1431681">nil</span><span class="op" id="1431684">,</span>&nbsp;<span class="ident" id="1431686">nil</span><span class="op" id="1431689">,</span>&nbsp;<span class="op" id="1431691">&amp;</span><span class="ident" id="1431692"><a href="/net/ip.go.html#1430388">ParseError</a></span><span class="op" id="1431702">{</span><span class="string" id="1431703">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="1431717">,</span>&nbsp;<span class="ident" id="1431719"><a href="/net/ip.go.html#1431318">s</a></span><span class="op" id="1431720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1431723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1431726">m</span>&nbsp;<span class="op" id="1431728">:=</span>&nbsp;<span class="ident" id="1431731"><a href="/net/ip.go.html#1418044">CIDRMask</a></span><span class="op" id="1431739">(</span><span class="ident" id="1431740"><a href="/net/ip.go.html#1431581">n</a></span><span class="op" id="1431741">,</span>&nbsp;<span class="num" id="1431743">8</span><span class="op" id="1431744">*</span><span class="ident" id="1431745"><a href="/net/ip.go.html#1431470">iplen</a></span><span class="op" id="1431750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1431753">return</span>&nbsp;<span class="ident" id="1431760"><a href="/net/ip.go.html#1431488">ip</a></span><span class="op" id="1431762">,</span>&nbsp;<span class="op" id="1431764">&amp;</span><span class="ident" id="1431765"><a href="/net/ip.go.html#1417295">IPNet</a></span><span class="op" id="1431770">{</span><span class="ident" id="1431771">IP</span><span class="op" id="1431773">:</span>&nbsp;<span class="ident" id="1431775"><a href="/net/ip.go.html#1431488">ip</a></span><span class="op" id="1431777">.</span><span class="ident" id="1431778">Mask</span><span class="op" id="1431782">(</span><span class="ident" id="1431783"><a href="/net/ip.go.html#1431726">m</a></span><span class="op" id="1431784">)</span><span class="op" id="1431785">,</span>&nbsp;<span class="ident" id="1431787">Mask</span><span class="op" id="1431791">:</span>&nbsp;<span class="ident" id="1431793"><a href="/net/ip.go.html#1431726">m</a></span><span class="op" id="1431794">}</span><span class="op" id="1431795">,</span>&nbsp;<span class="ident" id="1431797">nil</span><br>
<span class="lineno"></span><span class="op" id="1431801">}</span>
</div>
</body>
</html>
