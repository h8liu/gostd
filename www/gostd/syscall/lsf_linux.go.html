<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2213255">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2213311">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2213365">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2213416">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2213440">package</span>&nbsp;<span class="ident" id="2213448">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2213457">import</span>&nbsp;<span class="op" id="2213464">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2213467">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2213476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2213479">func</span>&nbsp;<span class="ident" id="2213484">LsfStmt</span><span class="op" id="2213491">(</span><span class="ident" id="2213492">code</span><span class="op" id="2213496">,</span>&nbsp;<span class="ident" id="2213498">k</span>&nbsp;<span class="builtintype" id="2213500">int</span><span class="op" id="2213503">)</span>&nbsp;<span class="op" id="2213505">*</span><span class="ident" id="2213506">SockFilter</span>&nbsp;<span class="op" id="2213517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213520">return</span>&nbsp;<span class="op" id="2213527">&amp;</span><span class="ident" id="2213528">SockFilter</span><span class="op" id="2213538">{</span><span class="ident" id="2213539">Code</span><span class="op" id="2213543">:</span>&nbsp;<span class="builtintype" id="2213545">uint16</span><span class="op" id="2213551">(</span><span class="ident" id="2213552">code</span><span class="op" id="2213556">)</span><span class="op" id="2213557">,</span>&nbsp;<span class="ident" id="2213559">K</span><span class="op" id="2213560">:</span>&nbsp;<span class="builtintype" id="2213562">uint32</span><span class="op" id="2213568">(</span><span class="ident" id="2213569">k</span><span class="op" id="2213570">)</span><span class="op" id="2213571">}</span><br>
<span class="lineno">15</span><span class="op" id="2213573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2213576">func</span>&nbsp;<span class="ident" id="2213581">LsfJump</span><span class="op" id="2213588">(</span><span class="ident" id="2213589">code</span><span class="op" id="2213593">,</span>&nbsp;<span class="ident" id="2213595">k</span><span class="op" id="2213596">,</span>&nbsp;<span class="ident" id="2213598">jt</span><span class="op" id="2213600">,</span>&nbsp;<span class="ident" id="2213602">jf</span>&nbsp;<span class="builtintype" id="2213605">int</span><span class="op" id="2213608">)</span>&nbsp;<span class="op" id="2213610">*</span><span class="ident" id="2213611">SockFilter</span>&nbsp;<span class="op" id="2213622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213625">return</span>&nbsp;<span class="op" id="2213632">&amp;</span><span class="ident" id="2213633">SockFilter</span><span class="op" id="2213643">{</span><span class="ident" id="2213644">Code</span><span class="op" id="2213648">:</span>&nbsp;<span class="builtintype" id="2213650">uint16</span><span class="op" id="2213656">(</span><span class="ident" id="2213657">code</span><span class="op" id="2213661">)</span><span class="op" id="2213662">,</span>&nbsp;<span class="ident" id="2213664">Jt</span><span class="op" id="2213666">:</span>&nbsp;<span class="builtintype" id="2213668">uint8</span><span class="op" id="2213673">(</span><span class="ident" id="2213674">jt</span><span class="op" id="2213676">)</span><span class="op" id="2213677">,</span>&nbsp;<span class="ident" id="2213679">Jf</span><span class="op" id="2213681">:</span>&nbsp;<span class="builtintype" id="2213683">uint8</span><span class="op" id="2213688">(</span><span class="ident" id="2213689">jf</span><span class="op" id="2213691">)</span><span class="op" id="2213692">,</span>&nbsp;<span class="ident" id="2213694">K</span><span class="op" id="2213695">:</span>&nbsp;<span class="builtintype" id="2213697">uint32</span><span class="op" id="2213703">(</span><span class="ident" id="2213704">k</span><span class="op" id="2213705">)</span><span class="op" id="2213706">}</span><br>
<span class="lineno"></span><span class="op" id="2213708">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2213711">func</span>&nbsp;<span class="ident" id="2213716">LsfSocket</span><span class="op" id="2213725">(</span><span class="ident" id="2213726">ifindex</span><span class="op" id="2213733">,</span>&nbsp;<span class="ident" id="2213735">proto</span>&nbsp;<span class="builtintype" id="2213741">int</span><span class="op" id="2213744">)</span>&nbsp;<span class="op" id="2213746">(</span><span class="builtintype" id="2213747">int</span><span class="op" id="2213750">,</span>&nbsp;<span class="builtintype" id="2213752">error</span><span class="op" id="2213757">)</span>&nbsp;<span class="op" id="2213759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213762">var</span>&nbsp;<span class="ident" id="2213766">lsall</span>&nbsp;<span class="ident" id="2213772">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213791">s</span><span class="op" id="2213792">,</span>&nbsp;<span class="ident" id="2213794">e</span>&nbsp;<span class="op" id="2213796">:=</span>&nbsp;<span class="ident" id="2213799">Socket</span><span class="op" id="2213805">(</span><span class="ident" id="2213806">AF_PACKET</span><span class="op" id="2213815">,</span>&nbsp;<span class="ident" id="2213817">SOCK_RAW</span><span class="op" id="2213825">,</span>&nbsp;<span class="ident" id="2213827">proto</span><span class="op" id="2213832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213835">if</span>&nbsp;<span class="ident" id="2213838">e</span>&nbsp;<span class="op" id="2213840">!=</span>&nbsp;<span class="ident" id="2213843">nil</span>&nbsp;<span class="op" id="2213847">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213851">return</span>&nbsp;<span class="num" id="2213858">0</span><span class="op" id="2213859">,</span>&nbsp;<span class="ident" id="2213861">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213867">p</span>&nbsp;<span class="op" id="2213869">:=</span>&nbsp;<span class="op" id="2213872">(</span><span class="op" id="2213873">*</span><span class="op" id="2213874">[</span><span class="num" id="2213875">2</span><span class="op" id="2213876">]</span><span class="builtintype" id="2213877">byte</span><span class="op" id="2213881">)</span><span class="op" id="2213882">(</span><span class="ident" id="2213883">unsafe</span><span class="op" id="2213889">.</span><span class="ident" id="2213890">Pointer</span><span class="op" id="2213897">(</span><span class="op" id="2213898">&amp;</span><span class="ident" id="2213899">lsall</span><span class="op" id="2213904">.</span><span class="ident" id="2213905">Protocol</span><span class="op" id="2213913">)</span><span class="op" id="2213914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213917">p</span><span class="op" id="2213918">[</span><span class="num" id="2213919">0</span><span class="op" id="2213920">]</span>&nbsp;<span class="op" id="2213922">=</span>&nbsp;<span class="builtintype" id="2213924">byte</span><span class="op" id="2213928">(</span><span class="ident" id="2213929">proto</span>&nbsp;<span class="op" id="2213935">&gt;&gt;</span>&nbsp;<span class="num" id="2213938">8</span><span class="op" id="2213939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213942">p</span><span class="op" id="2213943">[</span><span class="num" id="2213944">1</span><span class="op" id="2213945">]</span>&nbsp;<span class="op" id="2213947">=</span>&nbsp;<span class="builtintype" id="2213949">byte</span><span class="op" id="2213953">(</span><span class="ident" id="2213954">proto</span><span class="op" id="2213959">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213962">lsall</span><span class="op" id="2213967">.</span><span class="ident" id="2213968">Ifindex</span>&nbsp;<span class="op" id="2213976">=</span>&nbsp;<span class="ident" id="2213978">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213987">e</span>&nbsp;<span class="op" id="2213989">=</span>&nbsp;<span class="ident" id="2213991">Bind</span><span class="op" id="2213995">(</span><span class="ident" id="2213996">s</span><span class="op" id="2213997">,</span>&nbsp;<span class="op" id="2213999">&amp;</span><span class="ident" id="2214000">lsall</span><span class="op" id="2214005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214008">if</span>&nbsp;<span class="ident" id="2214011">e</span>&nbsp;<span class="op" id="2214013">!=</span>&nbsp;<span class="ident" id="2214016">nil</span>&nbsp;<span class="op" id="2214020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214024">Close</span><span class="op" id="2214029">(</span><span class="ident" id="2214030">s</span><span class="op" id="2214031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214035">return</span>&nbsp;<span class="num" id="2214042">0</span><span class="op" id="2214043">,</span>&nbsp;<span class="ident" id="2214045">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214051">return</span>&nbsp;<span class="ident" id="2214058">s</span><span class="op" id="2214059">,</span>&nbsp;<span class="ident" id="2214061">nil</span><br>
<span class="lineno"></span><span class="op" id="2214065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2214068">type</span>&nbsp;<span class="ident" id="2214073">iflags</span>&nbsp;<span class="keyword" id="2214080">struct</span>&nbsp;<span class="op" id="2214087">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214090">name</span>&nbsp;&nbsp;<span class="op" id="2214096">[</span><span class="ident" id="2214097">IFNAMSIZ</span><span class="op" id="2214105">]</span><span class="builtintype" id="2214106">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214112">flags</span>&nbsp;<span class="builtintype" id="2214118">uint16</span><br>
<span class="lineno"></span><span class="op" id="2214125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2214128">func</span>&nbsp;<span class="ident" id="2214133">SetLsfPromisc</span><span class="op" id="2214146">(</span><span class="ident" id="2214147">name</span>&nbsp;<span class="builtintype" id="2214152">string</span><span class="op" id="2214158">,</span>&nbsp;<span class="ident" id="2214160">m</span>&nbsp;<span class="builtintype" id="2214162">bool</span><span class="op" id="2214166">)</span>&nbsp;<span class="builtintype" id="2214168">error</span>&nbsp;<span class="op" id="2214174">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214177">s</span><span class="op" id="2214178">,</span>&nbsp;<span class="ident" id="2214180">e</span>&nbsp;<span class="op" id="2214182">:=</span>&nbsp;<span class="ident" id="2214185">Socket</span><span class="op" id="2214191">(</span><span class="ident" id="2214192">AF_INET</span><span class="op" id="2214199">,</span>&nbsp;<span class="ident" id="2214201">SOCK_DGRAM</span><span class="op" id="2214211">,</span>&nbsp;<span class="num" id="2214213">0</span><span class="op" id="2214214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214217">if</span>&nbsp;<span class="ident" id="2214220">e</span>&nbsp;<span class="op" id="2214222">!=</span>&nbsp;<span class="ident" id="2214225">nil</span>&nbsp;<span class="op" id="2214229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214233">return</span>&nbsp;<span class="ident" id="2214240">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214246">defer</span>&nbsp;<span class="ident" id="2214252">Close</span><span class="op" id="2214257">(</span><span class="ident" id="2214258">s</span><span class="op" id="2214259">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214262">var</span>&nbsp;<span class="ident" id="2214266">ifl</span>&nbsp;<span class="ident" id="2214270">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2214278">copy</span><span class="op" id="2214282">(</span><span class="ident" id="2214283">ifl</span><span class="op" id="2214286">.</span><span class="ident" id="2214287">name</span><span class="op" id="2214291">[</span><span class="op" id="2214292">:</span><span class="op" id="2214293">]</span><span class="op" id="2214294">,</span>&nbsp;<span class="op" id="2214296">[</span><span class="op" id="2214297">]</span><span class="builtintype" id="2214298">byte</span><span class="op" id="2214302">(</span><span class="ident" id="2214303">name</span><span class="op" id="2214307">)</span><span class="op" id="2214308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214311">_</span><span class="op" id="2214312">,</span>&nbsp;<span class="ident" id="2214314">_</span><span class="op" id="2214315">,</span>&nbsp;<span class="ident" id="2214317">ep</span>&nbsp;<span class="op" id="2214320">:=</span>&nbsp;<span class="ident" id="2214323">Syscall</span><span class="op" id="2214330">(</span><span class="ident" id="2214331">SYS_IOCTL</span><span class="op" id="2214340">,</span>&nbsp;<span class="builtintype" id="2214342">uintptr</span><span class="op" id="2214349">(</span><span class="ident" id="2214350">s</span><span class="op" id="2214351">)</span><span class="op" id="2214352">,</span>&nbsp;<span class="ident" id="2214354">SIOCGIFFLAGS</span><span class="op" id="2214366">,</span>&nbsp;<span class="builtintype" id="2214368">uintptr</span><span class="op" id="2214375">(</span><span class="ident" id="2214376">unsafe</span><span class="op" id="2214382">.</span><span class="ident" id="2214383">Pointer</span><span class="op" id="2214390">(</span><span class="op" id="2214391">&amp;</span><span class="ident" id="2214392">ifl</span><span class="op" id="2214395">)</span><span class="op" id="2214396">)</span><span class="op" id="2214397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214400">if</span>&nbsp;<span class="ident" id="2214403">ep</span>&nbsp;<span class="op" id="2214406">!=</span>&nbsp;<span class="num" id="2214409">0</span>&nbsp;<span class="op" id="2214411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214415">return</span>&nbsp;<span class="ident" id="2214422">Errno</span><span class="op" id="2214427">(</span><span class="ident" id="2214428">ep</span><span class="op" id="2214430">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214436">if</span>&nbsp;<span class="ident" id="2214439">m</span>&nbsp;<span class="op" id="2214441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214445">ifl</span><span class="op" id="2214448">.</span><span class="ident" id="2214449">flags</span>&nbsp;<span class="op" id="2214455">|=</span>&nbsp;<span class="builtintype" id="2214458">uint16</span><span class="op" id="2214464">(</span><span class="ident" id="2214465">IFF_PROMISC</span><span class="op" id="2214476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214479">}</span>&nbsp;<span class="keyword" id="2214481">else</span>&nbsp;<span class="op" id="2214486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214490">ifl</span><span class="op" id="2214493">.</span><span class="ident" id="2214494">flags</span>&nbsp;<span class="op" id="2214500">&amp;=</span>&nbsp;<span class="op" id="2214503">^</span><span class="builtintype" id="2214504">uint16</span><span class="op" id="2214510">(</span><span class="ident" id="2214511">IFF_PROMISC</span><span class="op" id="2214522">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214528">_</span><span class="op" id="2214529">,</span>&nbsp;<span class="ident" id="2214531">_</span><span class="op" id="2214532">,</span>&nbsp;<span class="ident" id="2214534">ep</span>&nbsp;<span class="op" id="2214537">=</span>&nbsp;<span class="ident" id="2214539">Syscall</span><span class="op" id="2214546">(</span><span class="ident" id="2214547">SYS_IOCTL</span><span class="op" id="2214556">,</span>&nbsp;<span class="builtintype" id="2214558">uintptr</span><span class="op" id="2214565">(</span><span class="ident" id="2214566">s</span><span class="op" id="2214567">)</span><span class="op" id="2214568">,</span>&nbsp;<span class="ident" id="2214570">SIOCSIFFLAGS</span><span class="op" id="2214582">,</span>&nbsp;<span class="builtintype" id="2214584">uintptr</span><span class="op" id="2214591">(</span><span class="ident" id="2214592">unsafe</span><span class="op" id="2214598">.</span><span class="ident" id="2214599">Pointer</span><span class="op" id="2214606">(</span><span class="op" id="2214607">&amp;</span><span class="ident" id="2214608">ifl</span><span class="op" id="2214611">)</span><span class="op" id="2214612">)</span><span class="op" id="2214613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214616">if</span>&nbsp;<span class="ident" id="2214619">ep</span>&nbsp;<span class="op" id="2214622">!=</span>&nbsp;<span class="num" id="2214625">0</span>&nbsp;<span class="op" id="2214627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214631">return</span>&nbsp;<span class="ident" id="2214638">Errno</span><span class="op" id="2214643">(</span><span class="ident" id="2214644">ep</span><span class="op" id="2214646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214649">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214652">return</span>&nbsp;<span class="ident" id="2214659">nil</span><br>
<span class="lineno"></span><span class="op" id="2214663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2214666">func</span>&nbsp;<span class="ident" id="2214671">AttachLsf</span><span class="op" id="2214680">(</span><span class="ident" id="2214681">fd</span>&nbsp;<span class="builtintype" id="2214684">int</span><span class="op" id="2214687">,</span>&nbsp;<span class="ident" id="2214689">i</span>&nbsp;<span class="op" id="2214691">[</span><span class="op" id="2214692">]</span><span class="ident" id="2214693">SockFilter</span><span class="op" id="2214703">)</span>&nbsp;<span class="builtintype" id="2214705">error</span>&nbsp;<span class="op" id="2214711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214714">var</span>&nbsp;<span class="ident" id="2214718">p</span>&nbsp;<span class="ident" id="2214720">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214731">p</span><span class="op" id="2214732">.</span><span class="ident" id="2214733">Len</span>&nbsp;<span class="op" id="2214737">=</span>&nbsp;<span class="builtintype" id="2214739">uint16</span><span class="op" id="2214745">(</span><span class="builtinfunc" id="2214746">len</span><span class="op" id="2214749">(</span><span class="ident" id="2214750">i</span><span class="op" id="2214751">)</span><span class="op" id="2214752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214755">p</span><span class="op" id="2214756">.</span><span class="ident" id="2214757">Filter</span>&nbsp;<span class="op" id="2214764">=</span>&nbsp;<span class="op" id="2214766">(</span><span class="op" id="2214767">*</span><span class="ident" id="2214768">SockFilter</span><span class="op" id="2214778">)</span><span class="op" id="2214779">(</span><span class="ident" id="2214780">unsafe</span><span class="op" id="2214786">.</span><span class="ident" id="2214787">Pointer</span><span class="op" id="2214794">(</span><span class="op" id="2214795">&amp;</span><span class="ident" id="2214796">i</span><span class="op" id="2214797">[</span><span class="num" id="2214798">0</span><span class="op" id="2214799">]</span><span class="op" id="2214800">)</span><span class="op" id="2214801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214804">return</span>&nbsp;<span class="ident" id="2214811">setsockopt</span><span class="op" id="2214821">(</span><span class="ident" id="2214822">fd</span><span class="op" id="2214824">,</span>&nbsp;<span class="ident" id="2214826">SOL_SOCKET</span><span class="op" id="2214836">,</span>&nbsp;<span class="ident" id="2214838">SO_ATTACH_FILTER</span><span class="op" id="2214854">,</span>&nbsp;<span class="ident" id="2214856">unsafe</span><span class="op" id="2214862">.</span><span class="ident" id="2214863">Pointer</span><span class="op" id="2214870">(</span><span class="op" id="2214871">&amp;</span><span class="ident" id="2214872">p</span><span class="op" id="2214873">)</span><span class="op" id="2214874">,</span>&nbsp;<span class="ident" id="2214876">unsafe</span><span class="op" id="2214882">.</span><span class="ident" id="2214883">Sizeof</span><span class="op" id="2214889">(</span><span class="ident" id="2214890">p</span><span class="op" id="2214891">)</span><span class="op" id="2214892">)</span><br>
<span class="lineno"></span><span class="op" id="2214894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2214897">func</span>&nbsp;<span class="ident" id="2214902">DetachLsf</span><span class="op" id="2214911">(</span><span class="ident" id="2214912">fd</span>&nbsp;<span class="builtintype" id="2214915">int</span><span class="op" id="2214918">)</span>&nbsp;<span class="builtintype" id="2214920">error</span>&nbsp;<span class="op" id="2214926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214929">var</span>&nbsp;<span class="ident" id="2214933">dummy</span>&nbsp;<span class="builtintype" id="2214939">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214944">return</span>&nbsp;<span class="ident" id="2214951">setsockopt</span><span class="op" id="2214961">(</span><span class="ident" id="2214962">fd</span><span class="op" id="2214964">,</span>&nbsp;<span class="ident" id="2214966">SOL_SOCKET</span><span class="op" id="2214976">,</span>&nbsp;<span class="ident" id="2214978">SO_DETACH_FILTER</span><span class="op" id="2214994">,</span>&nbsp;<span class="ident" id="2214996">unsafe</span><span class="op" id="2215002">.</span><span class="ident" id="2215003">Pointer</span><span class="op" id="2215010">(</span><span class="op" id="2215011">&amp;</span><span class="ident" id="2215012">dummy</span><span class="op" id="2215017">)</span><span class="op" id="2215018">,</span>&nbsp;<span class="ident" id="2215020">unsafe</span><span class="op" id="2215026">.</span><span class="ident" id="2215027">Sizeof</span><span class="op" id="2215033">(</span><span class="ident" id="2215034">dummy</span><span class="op" id="2215039">)</span><span class="op" id="2215040">)</span><br>
<span class="lineno"></span><span class="op" id="2215042">}</span>
</div>
</body>
</html>
