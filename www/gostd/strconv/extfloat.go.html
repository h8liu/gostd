<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html" class="current">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2201515">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2201570">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2201624">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2201675">package</span>&nbsp;<span class="ident" id="2201683">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201692">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2201763">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2201826">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2201898">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2201922">type</span>&nbsp;<span class="ident" id="2201927">extFloat</span>&nbsp;<span class="keyword" id="2201936">struct</span>&nbsp;<span class="op" id="2201943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201946">mant</span>&nbsp;<span class="ident" id="2201951">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201959">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2201964">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2201969">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2201974">bool</span><br>
<span class="lineno">15</span><span class="op" id="2201979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201982">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2202037">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2202084">const</span>&nbsp;<span class="op" id="2202090">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2202093">firstPowerOfTen</span>&nbsp;<span class="op" id="2202109">=</span>&nbsp;<span class="op" id="2202111">-</span><span class="num" id="2202112">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2202117">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2202133">=</span>&nbsp;<span class="num" id="2202135">8</span><br>
<span class="lineno"></span><span class="op" id="2202137">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2202140">var</span>&nbsp;<span class="ident" id="2202144">smallPowersOfTen</span>&nbsp;<span class="op" id="2202161">=</span>&nbsp;<span class="op" id="2202163">[</span><span class="op" id="2202164">...</span><span class="op" id="2202167">]</span><span class="ident" id="2202168">extFloat</span><span class="op" id="2202176">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202179">{</span><span class="num" id="2202180">1</span>&nbsp;<span class="op" id="2202182">&lt;&lt;</span>&nbsp;<span class="num" id="2202185">63</span><span class="op" id="2202187">,</span>&nbsp;<span class="op" id="2202189">-</span><span class="num" id="2202190">63</span><span class="op" id="2202192">,</span>&nbsp;<span class="builtintype" id="2202194">false</span><span class="op" id="2202199">}</span><span class="op" id="2202200">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2202209">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202215">{</span><span class="num" id="2202216">0xa</span>&nbsp;<span class="op" id="2202220">&lt;&lt;</span>&nbsp;<span class="num" id="2202223">60</span><span class="op" id="2202225">,</span>&nbsp;<span class="op" id="2202227">-</span><span class="num" id="2202228">60</span><span class="op" id="2202230">,</span>&nbsp;<span class="builtintype" id="2202232">false</span><span class="op" id="2202237">}</span><span class="op" id="2202238">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2202245">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202253">{</span><span class="num" id="2202254">0x64</span>&nbsp;<span class="op" id="2202259">&lt;&lt;</span>&nbsp;<span class="num" id="2202262">57</span><span class="op" id="2202264">,</span>&nbsp;<span class="op" id="2202266">-</span><span class="num" id="2202267">57</span><span class="op" id="2202269">,</span>&nbsp;<span class="builtintype" id="2202271">false</span><span class="op" id="2202276">}</span><span class="op" id="2202277">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2202283">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202291">{</span><span class="num" id="2202292">0x3e8</span>&nbsp;<span class="op" id="2202298">&lt;&lt;</span>&nbsp;<span class="num" id="2202301">54</span><span class="op" id="2202303">,</span>&nbsp;<span class="op" id="2202305">-</span><span class="num" id="2202306">54</span><span class="op" id="2202308">,</span>&nbsp;<span class="builtintype" id="2202310">false</span><span class="op" id="2202315">}</span><span class="op" id="2202316">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2202321">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202329">{</span><span class="num" id="2202330">0x2710</span>&nbsp;<span class="op" id="2202337">&lt;&lt;</span>&nbsp;<span class="num" id="2202340">50</span><span class="op" id="2202342">,</span>&nbsp;<span class="op" id="2202344">-</span><span class="num" id="2202345">50</span><span class="op" id="2202347">,</span>&nbsp;<span class="builtintype" id="2202349">false</span><span class="op" id="2202354">}</span><span class="op" id="2202355">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2202359">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202367">{</span><span class="num" id="2202368">0x186a0</span>&nbsp;<span class="op" id="2202376">&lt;&lt;</span>&nbsp;<span class="num" id="2202379">47</span><span class="op" id="2202381">,</span>&nbsp;<span class="op" id="2202383">-</span><span class="num" id="2202384">47</span><span class="op" id="2202386">,</span>&nbsp;<span class="builtintype" id="2202388">false</span><span class="op" id="2202393">}</span><span class="op" id="2202394">,</span>&nbsp;&nbsp;<span class="comment" id="2202397">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202405">{</span><span class="num" id="2202406">0xf4240</span>&nbsp;<span class="op" id="2202414">&lt;&lt;</span>&nbsp;<span class="num" id="2202417">44</span><span class="op" id="2202419">,</span>&nbsp;<span class="op" id="2202421">-</span><span class="num" id="2202422">44</span><span class="op" id="2202424">,</span>&nbsp;<span class="builtintype" id="2202426">false</span><span class="op" id="2202431">}</span><span class="op" id="2202432">,</span>&nbsp;&nbsp;<span class="comment" id="2202435">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202443">{</span><span class="num" id="2202444">0x989680</span>&nbsp;<span class="op" id="2202453">&lt;&lt;</span>&nbsp;<span class="num" id="2202456">40</span><span class="op" id="2202458">,</span>&nbsp;<span class="op" id="2202460">-</span><span class="num" id="2202461">40</span><span class="op" id="2202463">,</span>&nbsp;<span class="builtintype" id="2202465">false</span><span class="op" id="2202470">}</span><span class="op" id="2202471">,</span>&nbsp;<span class="comment" id="2202473">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2202480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2202483">var</span>&nbsp;<span class="ident" id="2202487">powersOfTen</span>&nbsp;<span class="op" id="2202499">=</span>&nbsp;<span class="op" id="2202501">[</span><span class="op" id="2202502">...</span><span class="op" id="2202505">]</span><span class="ident" id="2202506">extFloat</span><span class="op" id="2202514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202517">{</span><span class="num" id="2202518">0xfa8fd5a0081c0288</span><span class="op" id="2202536">,</span>&nbsp;<span class="op" id="2202538">-</span><span class="num" id="2202539">1220</span><span class="op" id="2202543">,</span>&nbsp;<span class="builtintype" id="2202545">false</span><span class="op" id="2202550">}</span><span class="op" id="2202551">,</span>&nbsp;<span class="comment" id="2202553">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202565">{</span><span class="num" id="2202566">0xbaaee17fa23ebf76</span><span class="op" id="2202584">,</span>&nbsp;<span class="op" id="2202586">-</span><span class="num" id="2202587">1193</span><span class="op" id="2202591">,</span>&nbsp;<span class="builtintype" id="2202593">false</span><span class="op" id="2202598">}</span><span class="op" id="2202599">,</span>&nbsp;<span class="comment" id="2202601">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202613">{</span><span class="num" id="2202614">0x8b16fb203055ac76</span><span class="op" id="2202632">,</span>&nbsp;<span class="op" id="2202634">-</span><span class="num" id="2202635">1166</span><span class="op" id="2202639">,</span>&nbsp;<span class="builtintype" id="2202641">false</span><span class="op" id="2202646">}</span><span class="op" id="2202647">,</span>&nbsp;<span class="comment" id="2202649">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202661">{</span><span class="num" id="2202662">0xcf42894a5dce35ea</span><span class="op" id="2202680">,</span>&nbsp;<span class="op" id="2202682">-</span><span class="num" id="2202683">1140</span><span class="op" id="2202687">,</span>&nbsp;<span class="builtintype" id="2202689">false</span><span class="op" id="2202694">}</span><span class="op" id="2202695">,</span>&nbsp;<span class="comment" id="2202697">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202709">{</span><span class="num" id="2202710">0x9a6bb0aa55653b2d</span><span class="op" id="2202728">,</span>&nbsp;<span class="op" id="2202730">-</span><span class="num" id="2202731">1113</span><span class="op" id="2202735">,</span>&nbsp;<span class="builtintype" id="2202737">false</span><span class="op" id="2202742">}</span><span class="op" id="2202743">,</span>&nbsp;<span class="comment" id="2202745">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202757">{</span><span class="num" id="2202758">0xe61acf033d1a45df</span><span class="op" id="2202776">,</span>&nbsp;<span class="op" id="2202778">-</span><span class="num" id="2202779">1087</span><span class="op" id="2202783">,</span>&nbsp;<span class="builtintype" id="2202785">false</span><span class="op" id="2202790">}</span><span class="op" id="2202791">,</span>&nbsp;<span class="comment" id="2202793">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202805">{</span><span class="num" id="2202806">0xab70fe17c79ac6ca</span><span class="op" id="2202824">,</span>&nbsp;<span class="op" id="2202826">-</span><span class="num" id="2202827">1060</span><span class="op" id="2202831">,</span>&nbsp;<span class="builtintype" id="2202833">false</span><span class="op" id="2202838">}</span><span class="op" id="2202839">,</span>&nbsp;<span class="comment" id="2202841">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202853">{</span><span class="num" id="2202854">0xff77b1fcbebcdc4f</span><span class="op" id="2202872">,</span>&nbsp;<span class="op" id="2202874">-</span><span class="num" id="2202875">1034</span><span class="op" id="2202879">,</span>&nbsp;<span class="builtintype" id="2202881">false</span><span class="op" id="2202886">}</span><span class="op" id="2202887">,</span>&nbsp;<span class="comment" id="2202889">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202901">{</span><span class="num" id="2202902">0xbe5691ef416bd60c</span><span class="op" id="2202920">,</span>&nbsp;<span class="op" id="2202922">-</span><span class="num" id="2202923">1007</span><span class="op" id="2202927">,</span>&nbsp;<span class="builtintype" id="2202929">false</span><span class="op" id="2202934">}</span><span class="op" id="2202935">,</span>&nbsp;<span class="comment" id="2202937">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202949">{</span><span class="num" id="2202950">0x8dd01fad907ffc3c</span><span class="op" id="2202968">,</span>&nbsp;<span class="op" id="2202970">-</span><span class="num" id="2202971">980</span><span class="op" id="2202974">,</span>&nbsp;<span class="builtintype" id="2202976">false</span><span class="op" id="2202981">}</span><span class="op" id="2202982">,</span>&nbsp;&nbsp;<span class="comment" id="2202985">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2202997">{</span><span class="num" id="2202998">0xd3515c2831559a83</span><span class="op" id="2203016">,</span>&nbsp;<span class="op" id="2203018">-</span><span class="num" id="2203019">954</span><span class="op" id="2203022">,</span>&nbsp;<span class="builtintype" id="2203024">false</span><span class="op" id="2203029">}</span><span class="op" id="2203030">,</span>&nbsp;&nbsp;<span class="comment" id="2203033">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203045">{</span><span class="num" id="2203046">0x9d71ac8fada6c9b5</span><span class="op" id="2203064">,</span>&nbsp;<span class="op" id="2203066">-</span><span class="num" id="2203067">927</span><span class="op" id="2203070">,</span>&nbsp;<span class="builtintype" id="2203072">false</span><span class="op" id="2203077">}</span><span class="op" id="2203078">,</span>&nbsp;&nbsp;<span class="comment" id="2203081">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203093">{</span><span class="num" id="2203094">0xea9c227723ee8bcb</span><span class="op" id="2203112">,</span>&nbsp;<span class="op" id="2203114">-</span><span class="num" id="2203115">901</span><span class="op" id="2203118">,</span>&nbsp;<span class="builtintype" id="2203120">false</span><span class="op" id="2203125">}</span><span class="op" id="2203126">,</span>&nbsp;&nbsp;<span class="comment" id="2203129">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203141">{</span><span class="num" id="2203142">0xaecc49914078536d</span><span class="op" id="2203160">,</span>&nbsp;<span class="op" id="2203162">-</span><span class="num" id="2203163">874</span><span class="op" id="2203166">,</span>&nbsp;<span class="builtintype" id="2203168">false</span><span class="op" id="2203173">}</span><span class="op" id="2203174">,</span>&nbsp;&nbsp;<span class="comment" id="2203177">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203189">{</span><span class="num" id="2203190">0x823c12795db6ce57</span><span class="op" id="2203208">,</span>&nbsp;<span class="op" id="2203210">-</span><span class="num" id="2203211">847</span><span class="op" id="2203214">,</span>&nbsp;<span class="builtintype" id="2203216">false</span><span class="op" id="2203221">}</span><span class="op" id="2203222">,</span>&nbsp;&nbsp;<span class="comment" id="2203225">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203237">{</span><span class="num" id="2203238">0xc21094364dfb5637</span><span class="op" id="2203256">,</span>&nbsp;<span class="op" id="2203258">-</span><span class="num" id="2203259">821</span><span class="op" id="2203262">,</span>&nbsp;<span class="builtintype" id="2203264">false</span><span class="op" id="2203269">}</span><span class="op" id="2203270">,</span>&nbsp;&nbsp;<span class="comment" id="2203273">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203285">{</span><span class="num" id="2203286">0x9096ea6f3848984f</span><span class="op" id="2203304">,</span>&nbsp;<span class="op" id="2203306">-</span><span class="num" id="2203307">794</span><span class="op" id="2203310">,</span>&nbsp;<span class="builtintype" id="2203312">false</span><span class="op" id="2203317">}</span><span class="op" id="2203318">,</span>&nbsp;&nbsp;<span class="comment" id="2203321">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203333">{</span><span class="num" id="2203334">0xd77485cb25823ac7</span><span class="op" id="2203352">,</span>&nbsp;<span class="op" id="2203354">-</span><span class="num" id="2203355">768</span><span class="op" id="2203358">,</span>&nbsp;<span class="builtintype" id="2203360">false</span><span class="op" id="2203365">}</span><span class="op" id="2203366">,</span>&nbsp;&nbsp;<span class="comment" id="2203369">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203381">{</span><span class="num" id="2203382">0xa086cfcd97bf97f4</span><span class="op" id="2203400">,</span>&nbsp;<span class="op" id="2203402">-</span><span class="num" id="2203403">741</span><span class="op" id="2203406">,</span>&nbsp;<span class="builtintype" id="2203408">false</span><span class="op" id="2203413">}</span><span class="op" id="2203414">,</span>&nbsp;&nbsp;<span class="comment" id="2203417">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203429">{</span><span class="num" id="2203430">0xef340a98172aace5</span><span class="op" id="2203448">,</span>&nbsp;<span class="op" id="2203450">-</span><span class="num" id="2203451">715</span><span class="op" id="2203454">,</span>&nbsp;<span class="builtintype" id="2203456">false</span><span class="op" id="2203461">}</span><span class="op" id="2203462">,</span>&nbsp;&nbsp;<span class="comment" id="2203465">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203477">{</span><span class="num" id="2203478">0xb23867fb2a35b28e</span><span class="op" id="2203496">,</span>&nbsp;<span class="op" id="2203498">-</span><span class="num" id="2203499">688</span><span class="op" id="2203502">,</span>&nbsp;<span class="builtintype" id="2203504">false</span><span class="op" id="2203509">}</span><span class="op" id="2203510">,</span>&nbsp;&nbsp;<span class="comment" id="2203513">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203525">{</span><span class="num" id="2203526">0x84c8d4dfd2c63f3b</span><span class="op" id="2203544">,</span>&nbsp;<span class="op" id="2203546">-</span><span class="num" id="2203547">661</span><span class="op" id="2203550">,</span>&nbsp;<span class="builtintype" id="2203552">false</span><span class="op" id="2203557">}</span><span class="op" id="2203558">,</span>&nbsp;&nbsp;<span class="comment" id="2203561">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203573">{</span><span class="num" id="2203574">0xc5dd44271ad3cdba</span><span class="op" id="2203592">,</span>&nbsp;<span class="op" id="2203594">-</span><span class="num" id="2203595">635</span><span class="op" id="2203598">,</span>&nbsp;<span class="builtintype" id="2203600">false</span><span class="op" id="2203605">}</span><span class="op" id="2203606">,</span>&nbsp;&nbsp;<span class="comment" id="2203609">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203621">{</span><span class="num" id="2203622">0x936b9fcebb25c996</span><span class="op" id="2203640">,</span>&nbsp;<span class="op" id="2203642">-</span><span class="num" id="2203643">608</span><span class="op" id="2203646">,</span>&nbsp;<span class="builtintype" id="2203648">false</span><span class="op" id="2203653">}</span><span class="op" id="2203654">,</span>&nbsp;&nbsp;<span class="comment" id="2203657">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203669">{</span><span class="num" id="2203670">0xdbac6c247d62a584</span><span class="op" id="2203688">,</span>&nbsp;<span class="op" id="2203690">-</span><span class="num" id="2203691">582</span><span class="op" id="2203694">,</span>&nbsp;<span class="builtintype" id="2203696">false</span><span class="op" id="2203701">}</span><span class="op" id="2203702">,</span>&nbsp;&nbsp;<span class="comment" id="2203705">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203717">{</span><span class="num" id="2203718">0xa3ab66580d5fdaf6</span><span class="op" id="2203736">,</span>&nbsp;<span class="op" id="2203738">-</span><span class="num" id="2203739">555</span><span class="op" id="2203742">,</span>&nbsp;<span class="builtintype" id="2203744">false</span><span class="op" id="2203749">}</span><span class="op" id="2203750">,</span>&nbsp;&nbsp;<span class="comment" id="2203753">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203765">{</span><span class="num" id="2203766">0xf3e2f893dec3f126</span><span class="op" id="2203784">,</span>&nbsp;<span class="op" id="2203786">-</span><span class="num" id="2203787">529</span><span class="op" id="2203790">,</span>&nbsp;<span class="builtintype" id="2203792">false</span><span class="op" id="2203797">}</span><span class="op" id="2203798">,</span>&nbsp;&nbsp;<span class="comment" id="2203801">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203813">{</span><span class="num" id="2203814">0xb5b5ada8aaff80b8</span><span class="op" id="2203832">,</span>&nbsp;<span class="op" id="2203834">-</span><span class="num" id="2203835">502</span><span class="op" id="2203838">,</span>&nbsp;<span class="builtintype" id="2203840">false</span><span class="op" id="2203845">}</span><span class="op" id="2203846">,</span>&nbsp;&nbsp;<span class="comment" id="2203849">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203861">{</span><span class="num" id="2203862">0x87625f056c7c4a8b</span><span class="op" id="2203880">,</span>&nbsp;<span class="op" id="2203882">-</span><span class="num" id="2203883">475</span><span class="op" id="2203886">,</span>&nbsp;<span class="builtintype" id="2203888">false</span><span class="op" id="2203893">}</span><span class="op" id="2203894">,</span>&nbsp;&nbsp;<span class="comment" id="2203897">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203909">{</span><span class="num" id="2203910">0xc9bcff6034c13053</span><span class="op" id="2203928">,</span>&nbsp;<span class="op" id="2203930">-</span><span class="num" id="2203931">449</span><span class="op" id="2203934">,</span>&nbsp;<span class="builtintype" id="2203936">false</span><span class="op" id="2203941">}</span><span class="op" id="2203942">,</span>&nbsp;&nbsp;<span class="comment" id="2203945">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2203957">{</span><span class="num" id="2203958">0x964e858c91ba2655</span><span class="op" id="2203976">,</span>&nbsp;<span class="op" id="2203978">-</span><span class="num" id="2203979">422</span><span class="op" id="2203982">,</span>&nbsp;<span class="builtintype" id="2203984">false</span><span class="op" id="2203989">}</span><span class="op" id="2203990">,</span>&nbsp;&nbsp;<span class="comment" id="2203993">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204005">{</span><span class="num" id="2204006">0xdff9772470297ebd</span><span class="op" id="2204024">,</span>&nbsp;<span class="op" id="2204026">-</span><span class="num" id="2204027">396</span><span class="op" id="2204030">,</span>&nbsp;<span class="builtintype" id="2204032">false</span><span class="op" id="2204037">}</span><span class="op" id="2204038">,</span>&nbsp;&nbsp;<span class="comment" id="2204041">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204053">{</span><span class="num" id="2204054">0xa6dfbd9fb8e5b88f</span><span class="op" id="2204072">,</span>&nbsp;<span class="op" id="2204074">-</span><span class="num" id="2204075">369</span><span class="op" id="2204078">,</span>&nbsp;<span class="builtintype" id="2204080">false</span><span class="op" id="2204085">}</span><span class="op" id="2204086">,</span>&nbsp;&nbsp;<span class="comment" id="2204089">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204100">{</span><span class="num" id="2204101">0xf8a95fcf88747d94</span><span class="op" id="2204119">,</span>&nbsp;<span class="op" id="2204121">-</span><span class="num" id="2204122">343</span><span class="op" id="2204125">,</span>&nbsp;<span class="builtintype" id="2204127">false</span><span class="op" id="2204132">}</span><span class="op" id="2204133">,</span>&nbsp;&nbsp;<span class="comment" id="2204136">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204147">{</span><span class="num" id="2204148">0xb94470938fa89bcf</span><span class="op" id="2204166">,</span>&nbsp;<span class="op" id="2204168">-</span><span class="num" id="2204169">316</span><span class="op" id="2204172">,</span>&nbsp;<span class="builtintype" id="2204174">false</span><span class="op" id="2204179">}</span><span class="op" id="2204180">,</span>&nbsp;&nbsp;<span class="comment" id="2204183">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204194">{</span><span class="num" id="2204195">0x8a08f0f8bf0f156b</span><span class="op" id="2204213">,</span>&nbsp;<span class="op" id="2204215">-</span><span class="num" id="2204216">289</span><span class="op" id="2204219">,</span>&nbsp;<span class="builtintype" id="2204221">false</span><span class="op" id="2204226">}</span><span class="op" id="2204227">,</span>&nbsp;&nbsp;<span class="comment" id="2204230">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204241">{</span><span class="num" id="2204242">0xcdb02555653131b6</span><span class="op" id="2204260">,</span>&nbsp;<span class="op" id="2204262">-</span><span class="num" id="2204263">263</span><span class="op" id="2204266">,</span>&nbsp;<span class="builtintype" id="2204268">false</span><span class="op" id="2204273">}</span><span class="op" id="2204274">,</span>&nbsp;&nbsp;<span class="comment" id="2204277">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204288">{</span><span class="num" id="2204289">0x993fe2c6d07b7fac</span><span class="op" id="2204307">,</span>&nbsp;<span class="op" id="2204309">-</span><span class="num" id="2204310">236</span><span class="op" id="2204313">,</span>&nbsp;<span class="builtintype" id="2204315">false</span><span class="op" id="2204320">}</span><span class="op" id="2204321">,</span>&nbsp;&nbsp;<span class="comment" id="2204324">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204335">{</span><span class="num" id="2204336">0xe45c10c42a2b3b06</span><span class="op" id="2204354">,</span>&nbsp;<span class="op" id="2204356">-</span><span class="num" id="2204357">210</span><span class="op" id="2204360">,</span>&nbsp;<span class="builtintype" id="2204362">false</span><span class="op" id="2204367">}</span><span class="op" id="2204368">,</span>&nbsp;&nbsp;<span class="comment" id="2204371">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204382">{</span><span class="num" id="2204383">0xaa242499697392d3</span><span class="op" id="2204401">,</span>&nbsp;<span class="op" id="2204403">-</span><span class="num" id="2204404">183</span><span class="op" id="2204407">,</span>&nbsp;<span class="builtintype" id="2204409">false</span><span class="op" id="2204414">}</span><span class="op" id="2204415">,</span>&nbsp;&nbsp;<span class="comment" id="2204418">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204429">{</span><span class="num" id="2204430">0xfd87b5f28300ca0e</span><span class="op" id="2204448">,</span>&nbsp;<span class="op" id="2204450">-</span><span class="num" id="2204451">157</span><span class="op" id="2204454">,</span>&nbsp;<span class="builtintype" id="2204456">false</span><span class="op" id="2204461">}</span><span class="op" id="2204462">,</span>&nbsp;&nbsp;<span class="comment" id="2204465">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204476">{</span><span class="num" id="2204477">0xbce5086492111aeb</span><span class="op" id="2204495">,</span>&nbsp;<span class="op" id="2204497">-</span><span class="num" id="2204498">130</span><span class="op" id="2204501">,</span>&nbsp;<span class="builtintype" id="2204503">false</span><span class="op" id="2204508">}</span><span class="op" id="2204509">,</span>&nbsp;&nbsp;<span class="comment" id="2204512">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204523">{</span><span class="num" id="2204524">0x8cbccc096f5088cc</span><span class="op" id="2204542">,</span>&nbsp;<span class="op" id="2204544">-</span><span class="num" id="2204545">103</span><span class="op" id="2204548">,</span>&nbsp;<span class="builtintype" id="2204550">false</span><span class="op" id="2204555">}</span><span class="op" id="2204556">,</span>&nbsp;&nbsp;<span class="comment" id="2204559">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204570">{</span><span class="num" id="2204571">0xd1b71758e219652c</span><span class="op" id="2204589">,</span>&nbsp;<span class="op" id="2204591">-</span><span class="num" id="2204592">77</span><span class="op" id="2204594">,</span>&nbsp;<span class="builtintype" id="2204596">false</span><span class="op" id="2204601">}</span><span class="op" id="2204602">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204606">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204616">{</span><span class="num" id="2204617">0x9c40000000000000</span><span class="op" id="2204635">,</span>&nbsp;<span class="op" id="2204637">-</span><span class="num" id="2204638">50</span><span class="op" id="2204640">,</span>&nbsp;<span class="builtintype" id="2204642">false</span><span class="op" id="2204647">}</span><span class="op" id="2204648">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204652">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204661">{</span><span class="num" id="2204662">0xe8d4a51000000000</span><span class="op" id="2204680">,</span>&nbsp;<span class="op" id="2204682">-</span><span class="num" id="2204683">24</span><span class="op" id="2204685">,</span>&nbsp;<span class="builtintype" id="2204687">false</span><span class="op" id="2204692">}</span><span class="op" id="2204693">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204697">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204707">{</span><span class="num" id="2204708">0xad78ebc5ac620000</span><span class="op" id="2204726">,</span>&nbsp;<span class="num" id="2204728">3</span><span class="op" id="2204729">,</span>&nbsp;<span class="builtintype" id="2204731">false</span><span class="op" id="2204736">}</span><span class="op" id="2204737">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2204743">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204753">{</span><span class="num" id="2204754">0x813f3978f8940984</span><span class="op" id="2204772">,</span>&nbsp;<span class="num" id="2204774">30</span><span class="op" id="2204776">,</span>&nbsp;<span class="builtintype" id="2204778">false</span><span class="op" id="2204783">}</span><span class="op" id="2204784">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2204789">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204799">{</span><span class="num" id="2204800">0xc097ce7bc90715b3</span><span class="op" id="2204818">,</span>&nbsp;<span class="num" id="2204820">56</span><span class="op" id="2204822">,</span>&nbsp;<span class="builtintype" id="2204824">false</span><span class="op" id="2204829">}</span><span class="op" id="2204830">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2204835">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204845">{</span><span class="num" id="2204846">0x8f7e32ce7bea5c70</span><span class="op" id="2204864">,</span>&nbsp;<span class="num" id="2204866">83</span><span class="op" id="2204868">,</span>&nbsp;<span class="builtintype" id="2204870">false</span><span class="op" id="2204875">}</span><span class="op" id="2204876">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2204881">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204891">{</span><span class="num" id="2204892">0xd5d238a4abe98068</span><span class="op" id="2204910">,</span>&nbsp;<span class="num" id="2204912">109</span><span class="op" id="2204915">,</span>&nbsp;<span class="builtintype" id="2204917">false</span><span class="op" id="2204922">}</span><span class="op" id="2204923">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204927">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204937">{</span><span class="num" id="2204938">0x9f4f2726179a2245</span><span class="op" id="2204956">,</span>&nbsp;<span class="num" id="2204958">136</span><span class="op" id="2204961">,</span>&nbsp;<span class="builtintype" id="2204963">false</span><span class="op" id="2204968">}</span><span class="op" id="2204969">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204973">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204983">{</span><span class="num" id="2204984">0xed63a231d4c4fb27</span><span class="op" id="2205002">,</span>&nbsp;<span class="num" id="2205004">162</span><span class="op" id="2205007">,</span>&nbsp;<span class="builtintype" id="2205009">false</span><span class="op" id="2205014">}</span><span class="op" id="2205015">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205019">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205029">{</span><span class="num" id="2205030">0xb0de65388cc8ada8</span><span class="op" id="2205048">,</span>&nbsp;<span class="num" id="2205050">189</span><span class="op" id="2205053">,</span>&nbsp;<span class="builtintype" id="2205055">false</span><span class="op" id="2205060">}</span><span class="op" id="2205061">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205065">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205075">{</span><span class="num" id="2205076">0x83c7088e1aab65db</span><span class="op" id="2205094">,</span>&nbsp;<span class="num" id="2205096">216</span><span class="op" id="2205099">,</span>&nbsp;<span class="builtintype" id="2205101">false</span><span class="op" id="2205106">}</span><span class="op" id="2205107">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205111">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205121">{</span><span class="num" id="2205122">0xc45d1df942711d9a</span><span class="op" id="2205140">,</span>&nbsp;<span class="num" id="2205142">242</span><span class="op" id="2205145">,</span>&nbsp;<span class="builtintype" id="2205147">false</span><span class="op" id="2205152">}</span><span class="op" id="2205153">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205157">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205167">{</span><span class="num" id="2205168">0x924d692ca61be758</span><span class="op" id="2205186">,</span>&nbsp;<span class="num" id="2205188">269</span><span class="op" id="2205191">,</span>&nbsp;<span class="builtintype" id="2205193">false</span><span class="op" id="2205198">}</span><span class="op" id="2205199">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205203">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205214">{</span><span class="num" id="2205215">0xda01ee641a708dea</span><span class="op" id="2205233">,</span>&nbsp;<span class="num" id="2205235">295</span><span class="op" id="2205238">,</span>&nbsp;<span class="builtintype" id="2205240">false</span><span class="op" id="2205245">}</span><span class="op" id="2205246">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205250">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205261">{</span><span class="num" id="2205262">0xa26da3999aef774a</span><span class="op" id="2205280">,</span>&nbsp;<span class="num" id="2205282">322</span><span class="op" id="2205285">,</span>&nbsp;<span class="builtintype" id="2205287">false</span><span class="op" id="2205292">}</span><span class="op" id="2205293">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205297">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205308">{</span><span class="num" id="2205309">0xf209787bb47d6b85</span><span class="op" id="2205327">,</span>&nbsp;<span class="num" id="2205329">348</span><span class="op" id="2205332">,</span>&nbsp;<span class="builtintype" id="2205334">false</span><span class="op" id="2205339">}</span><span class="op" id="2205340">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205344">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205355">{</span><span class="num" id="2205356">0xb454e4a179dd1877</span><span class="op" id="2205374">,</span>&nbsp;<span class="num" id="2205376">375</span><span class="op" id="2205379">,</span>&nbsp;<span class="builtintype" id="2205381">false</span><span class="op" id="2205386">}</span><span class="op" id="2205387">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205391">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205402">{</span><span class="num" id="2205403">0x865b86925b9bc5c2</span><span class="op" id="2205421">,</span>&nbsp;<span class="num" id="2205423">402</span><span class="op" id="2205426">,</span>&nbsp;<span class="builtintype" id="2205428">false</span><span class="op" id="2205433">}</span><span class="op" id="2205434">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205438">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205449">{</span><span class="num" id="2205450">0xc83553c5c8965d3d</span><span class="op" id="2205468">,</span>&nbsp;<span class="num" id="2205470">428</span><span class="op" id="2205473">,</span>&nbsp;<span class="builtintype" id="2205475">false</span><span class="op" id="2205480">}</span><span class="op" id="2205481">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205485">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205496">{</span><span class="num" id="2205497">0x952ab45cfa97a0b3</span><span class="op" id="2205515">,</span>&nbsp;<span class="num" id="2205517">455</span><span class="op" id="2205520">,</span>&nbsp;<span class="builtintype" id="2205522">false</span><span class="op" id="2205527">}</span><span class="op" id="2205528">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205532">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205543">{</span><span class="num" id="2205544">0xde469fbd99a05fe3</span><span class="op" id="2205562">,</span>&nbsp;<span class="num" id="2205564">481</span><span class="op" id="2205567">,</span>&nbsp;<span class="builtintype" id="2205569">false</span><span class="op" id="2205574">}</span><span class="op" id="2205575">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205579">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205590">{</span><span class="num" id="2205591">0xa59bc234db398c25</span><span class="op" id="2205609">,</span>&nbsp;<span class="num" id="2205611">508</span><span class="op" id="2205614">,</span>&nbsp;<span class="builtintype" id="2205616">false</span><span class="op" id="2205621">}</span><span class="op" id="2205622">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205626">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205637">{</span><span class="num" id="2205638">0xf6c69a72a3989f5c</span><span class="op" id="2205656">,</span>&nbsp;<span class="num" id="2205658">534</span><span class="op" id="2205661">,</span>&nbsp;<span class="builtintype" id="2205663">false</span><span class="op" id="2205668">}</span><span class="op" id="2205669">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205673">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205684">{</span><span class="num" id="2205685">0xb7dcbf5354e9bece</span><span class="op" id="2205703">,</span>&nbsp;<span class="num" id="2205705">561</span><span class="op" id="2205708">,</span>&nbsp;<span class="builtintype" id="2205710">false</span><span class="op" id="2205715">}</span><span class="op" id="2205716">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205720">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205731">{</span><span class="num" id="2205732">0x88fcf317f22241e2</span><span class="op" id="2205750">,</span>&nbsp;<span class="num" id="2205752">588</span><span class="op" id="2205755">,</span>&nbsp;<span class="builtintype" id="2205757">false</span><span class="op" id="2205762">}</span><span class="op" id="2205763">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205767">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205778">{</span><span class="num" id="2205779">0xcc20ce9bd35c78a5</span><span class="op" id="2205797">,</span>&nbsp;<span class="num" id="2205799">614</span><span class="op" id="2205802">,</span>&nbsp;<span class="builtintype" id="2205804">false</span><span class="op" id="2205809">}</span><span class="op" id="2205810">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205814">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205825">{</span><span class="num" id="2205826">0x98165af37b2153df</span><span class="op" id="2205844">,</span>&nbsp;<span class="num" id="2205846">641</span><span class="op" id="2205849">,</span>&nbsp;<span class="builtintype" id="2205851">false</span><span class="op" id="2205856">}</span><span class="op" id="2205857">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205861">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205872">{</span><span class="num" id="2205873">0xe2a0b5dc971f303a</span><span class="op" id="2205891">,</span>&nbsp;<span class="num" id="2205893">667</span><span class="op" id="2205896">,</span>&nbsp;<span class="builtintype" id="2205898">false</span><span class="op" id="2205903">}</span><span class="op" id="2205904">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205908">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205919">{</span><span class="num" id="2205920">0xa8d9d1535ce3b396</span><span class="op" id="2205938">,</span>&nbsp;<span class="num" id="2205940">694</span><span class="op" id="2205943">,</span>&nbsp;<span class="builtintype" id="2205945">false</span><span class="op" id="2205950">}</span><span class="op" id="2205951">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205955">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205966">{</span><span class="num" id="2205967">0xfb9b7cd9a4a7443c</span><span class="op" id="2205985">,</span>&nbsp;<span class="num" id="2205987">720</span><span class="op" id="2205990">,</span>&nbsp;<span class="builtintype" id="2205992">false</span><span class="op" id="2205997">}</span><span class="op" id="2205998">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206002">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206013">{</span><span class="num" id="2206014">0xbb764c4ca7a44410</span><span class="op" id="2206032">,</span>&nbsp;<span class="num" id="2206034">747</span><span class="op" id="2206037">,</span>&nbsp;<span class="builtintype" id="2206039">false</span><span class="op" id="2206044">}</span><span class="op" id="2206045">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206049">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206060">{</span><span class="num" id="2206061">0x8bab8eefb6409c1a</span><span class="op" id="2206079">,</span>&nbsp;<span class="num" id="2206081">774</span><span class="op" id="2206084">,</span>&nbsp;<span class="builtintype" id="2206086">false</span><span class="op" id="2206091">}</span><span class="op" id="2206092">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206096">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206107">{</span><span class="num" id="2206108">0xd01fef10a657842c</span><span class="op" id="2206126">,</span>&nbsp;<span class="num" id="2206128">800</span><span class="op" id="2206131">,</span>&nbsp;<span class="builtintype" id="2206133">false</span><span class="op" id="2206138">}</span><span class="op" id="2206139">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206143">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206154">{</span><span class="num" id="2206155">0x9b10a4e5e9913129</span><span class="op" id="2206173">,</span>&nbsp;<span class="num" id="2206175">827</span><span class="op" id="2206178">,</span>&nbsp;<span class="builtintype" id="2206180">false</span><span class="op" id="2206185">}</span><span class="op" id="2206186">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206190">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206201">{</span><span class="num" id="2206202">0xe7109bfba19c0c9d</span><span class="op" id="2206220">,</span>&nbsp;<span class="num" id="2206222">853</span><span class="op" id="2206225">,</span>&nbsp;<span class="builtintype" id="2206227">false</span><span class="op" id="2206232">}</span><span class="op" id="2206233">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206237">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206248">{</span><span class="num" id="2206249">0xac2820d9623bf429</span><span class="op" id="2206267">,</span>&nbsp;<span class="num" id="2206269">880</span><span class="op" id="2206272">,</span>&nbsp;<span class="builtintype" id="2206274">false</span><span class="op" id="2206279">}</span><span class="op" id="2206280">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206284">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206295">{</span><span class="num" id="2206296">0x80444b5e7aa7cf85</span><span class="op" id="2206314">,</span>&nbsp;<span class="num" id="2206316">907</span><span class="op" id="2206319">,</span>&nbsp;<span class="builtintype" id="2206321">false</span><span class="op" id="2206326">}</span><span class="op" id="2206327">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206331">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206342">{</span><span class="num" id="2206343">0xbf21e44003acdd2d</span><span class="op" id="2206361">,</span>&nbsp;<span class="num" id="2206363">933</span><span class="op" id="2206366">,</span>&nbsp;<span class="builtintype" id="2206368">false</span><span class="op" id="2206373">}</span><span class="op" id="2206374">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206378">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206389">{</span><span class="num" id="2206390">0x8e679c2f5e44ff8f</span><span class="op" id="2206408">,</span>&nbsp;<span class="num" id="2206410">960</span><span class="op" id="2206413">,</span>&nbsp;<span class="builtintype" id="2206415">false</span><span class="op" id="2206420">}</span><span class="op" id="2206421">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206425">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206436">{</span><span class="num" id="2206437">0xd433179d9c8cb841</span><span class="op" id="2206455">,</span>&nbsp;<span class="num" id="2206457">986</span><span class="op" id="2206460">,</span>&nbsp;<span class="builtintype" id="2206462">false</span><span class="op" id="2206467">}</span><span class="op" id="2206468">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2206472">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206483">{</span><span class="num" id="2206484">0x9e19db92b4e31ba9</span><span class="op" id="2206502">,</span>&nbsp;<span class="num" id="2206504">1013</span><span class="op" id="2206508">,</span>&nbsp;<span class="builtintype" id="2206510">false</span><span class="op" id="2206515">}</span><span class="op" id="2206516">,</span>&nbsp;&nbsp;<span class="comment" id="2206519">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206530">{</span><span class="num" id="2206531">0xeb96bf6ebadf77d9</span><span class="op" id="2206549">,</span>&nbsp;<span class="num" id="2206551">1039</span><span class="op" id="2206555">,</span>&nbsp;<span class="builtintype" id="2206557">false</span><span class="op" id="2206562">}</span><span class="op" id="2206563">,</span>&nbsp;&nbsp;<span class="comment" id="2206566">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206577">{</span><span class="num" id="2206578">0xaf87023b9bf0ee6b</span><span class="op" id="2206596">,</span>&nbsp;<span class="num" id="2206598">1066</span><span class="op" id="2206602">,</span>&nbsp;<span class="builtintype" id="2206604">false</span><span class="op" id="2206609">}</span><span class="op" id="2206610">,</span>&nbsp;&nbsp;<span class="comment" id="2206613">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2206623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2206626">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2206694">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2206757">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2206792">func</span>&nbsp;<span class="op" id="2206797">(</span><span class="ident" id="2206798">f</span>&nbsp;<span class="op" id="2206800">*</span><span class="ident" id="2206801">extFloat</span><span class="op" id="2206809">)</span>&nbsp;<span class="ident" id="2206811">floatBits</span><span class="op" id="2206820">(</span><span class="ident" id="2206821">flt</span>&nbsp;<span class="op" id="2206825">*</span><span class="ident" id="2206826">floatInfo</span><span class="op" id="2206835">)</span>&nbsp;<span class="op" id="2206837">(</span><span class="ident" id="2206838">bits</span>&nbsp;<span class="ident" id="2206843">uint64</span><span class="op" id="2206849">,</span>&nbsp;<span class="ident" id="2206851">overflow</span>&nbsp;<span class="builtintype" id="2206860">bool</span><span class="op" id="2206864">)</span>&nbsp;<span class="op" id="2206866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206869">f</span><span class="op" id="2206870">.</span><span class="ident" id="2206871">Normalize</span><span class="op" id="2206880">(</span><span class="op" id="2206881">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206885">exp</span>&nbsp;<span class="op" id="2206889">:=</span>&nbsp;<span class="ident" id="2206892">f</span><span class="op" id="2206893">.</span><span class="ident" id="2206894">exp</span>&nbsp;<span class="op" id="2206898">+</span>&nbsp;<span class="num" id="2206900">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2206905">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206929">if</span>&nbsp;<span class="ident" id="2206932">exp</span>&nbsp;<span class="op" id="2206936">&lt;</span>&nbsp;<span class="ident" id="2206938">flt</span><span class="op" id="2206941">.</span><span class="ident" id="2206942">bias</span><span class="op" id="2206946">+</span><span class="num" id="2206947">1</span>&nbsp;<span class="op" id="2206949">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206953">n</span>&nbsp;<span class="op" id="2206955">:=</span>&nbsp;<span class="ident" id="2206958">flt</span><span class="op" id="2206961">.</span><span class="ident" id="2206962">bias</span>&nbsp;<span class="op" id="2206967">+</span>&nbsp;<span class="num" id="2206969">1</span>&nbsp;<span class="op" id="2206971">-</span>&nbsp;<span class="ident" id="2206973">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206979">f</span><span class="op" id="2206980">.</span><span class="ident" id="2206981">mant</span>&nbsp;<span class="op" id="2206986">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2206990">uint</span><span class="op" id="2206994">(</span><span class="ident" id="2206995">n</span><span class="op" id="2206996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207000">exp</span>&nbsp;<span class="op" id="2207004">+=</span>&nbsp;<span class="ident" id="2207007">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207014">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207072">mant</span>&nbsp;<span class="op" id="2207077">:=</span>&nbsp;<span class="ident" id="2207080">f</span><span class="op" id="2207081">.</span><span class="ident" id="2207082">mant</span>&nbsp;<span class="op" id="2207087">&gt;&gt;</span>&nbsp;<span class="op" id="2207090">(</span><span class="num" id="2207091">63</span>&nbsp;<span class="op" id="2207094">-</span>&nbsp;<span class="ident" id="2207096">flt</span><span class="op" id="2207099">.</span><span class="ident" id="2207100">mantbits</span><span class="op" id="2207108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207111">if</span>&nbsp;<span class="ident" id="2207114">f</span><span class="op" id="2207115">.</span><span class="ident" id="2207116">mant</span><span class="op" id="2207120">&amp;</span><span class="op" id="2207121">(</span><span class="num" id="2207122">1</span><span class="op" id="2207123">&lt;&lt;</span><span class="op" id="2207125">(</span><span class="num" id="2207126">62</span><span class="op" id="2207128">-</span><span class="ident" id="2207129">flt</span><span class="op" id="2207132">.</span><span class="ident" id="2207133">mantbits</span><span class="op" id="2207141">)</span><span class="op" id="2207142">)</span>&nbsp;<span class="op" id="2207144">!=</span>&nbsp;<span class="num" id="2207147">0</span>&nbsp;<span class="op" id="2207149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207153">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207168">mant</span>&nbsp;<span class="op" id="2207173">+=</span>&nbsp;<span class="num" id="2207176">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207183">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207232">if</span>&nbsp;<span class="ident" id="2207235">mant</span>&nbsp;<span class="op" id="2207240">==</span>&nbsp;<span class="num" id="2207243">2</span><span class="op" id="2207244">&lt;&lt;</span><span class="ident" id="2207246">flt</span><span class="op" id="2207249">.</span><span class="ident" id="2207250">mantbits</span>&nbsp;<span class="op" id="2207259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207263">mant</span>&nbsp;<span class="op" id="2207268">&gt;&gt;=</span>&nbsp;<span class="num" id="2207272">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207276">exp</span><span class="op" id="2207279">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207287">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207303">if</span>&nbsp;<span class="ident" id="2207306">exp</span><span class="op" id="2207309">-</span><span class="ident" id="2207310">flt</span><span class="op" id="2207313">.</span><span class="ident" id="2207314">bias</span>&nbsp;<span class="op" id="2207319">&gt;=</span>&nbsp;<span class="num" id="2207322">1</span><span class="op" id="2207323">&lt;&lt;</span><span class="ident" id="2207325">flt</span><span class="op" id="2207328">.</span><span class="ident" id="2207329">expbits</span><span class="op" id="2207336">-</span><span class="num" id="2207337">1</span>&nbsp;<span class="op" id="2207339">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207343">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207354">mant</span>&nbsp;<span class="op" id="2207359">=</span>&nbsp;<span class="num" id="2207361">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207365">exp</span>&nbsp;<span class="op" id="2207369">=</span>&nbsp;<span class="num" id="2207371">1</span><span class="op" id="2207372">&lt;&lt;</span><span class="ident" id="2207374">flt</span><span class="op" id="2207377">.</span><span class="ident" id="2207378">expbits</span>&nbsp;<span class="op" id="2207386">-</span>&nbsp;<span class="num" id="2207388">1</span>&nbsp;<span class="op" id="2207390">+</span>&nbsp;<span class="ident" id="2207392">flt</span><span class="op" id="2207395">.</span><span class="ident" id="2207396">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207403">overflow</span>&nbsp;<span class="op" id="2207412">=</span>&nbsp;<span class="builtintype" id="2207414">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207420">}</span>&nbsp;<span class="keyword" id="2207422">else</span>&nbsp;<span class="keyword" id="2207427">if</span>&nbsp;<span class="ident" id="2207430">mant</span><span class="op" id="2207434">&amp;</span><span class="op" id="2207435">(</span><span class="num" id="2207436">1</span><span class="op" id="2207437">&lt;&lt;</span><span class="ident" id="2207439">flt</span><span class="op" id="2207442">.</span><span class="ident" id="2207443">mantbits</span><span class="op" id="2207451">)</span>&nbsp;<span class="op" id="2207453">==</span>&nbsp;<span class="num" id="2207456">0</span>&nbsp;<span class="op" id="2207458">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207462">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207481">exp</span>&nbsp;<span class="op" id="2207485">=</span>&nbsp;<span class="ident" id="2207487">flt</span><span class="op" id="2207490">.</span><span class="ident" id="2207491">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207500">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207519">bits</span>&nbsp;<span class="op" id="2207524">=</span>&nbsp;<span class="ident" id="2207526">mant</span>&nbsp;<span class="op" id="2207531">&amp;</span>&nbsp;<span class="op" id="2207533">(</span><span class="ident" id="2207534">uint64</span><span class="op" id="2207540">(</span><span class="num" id="2207541">1</span><span class="op" id="2207542">)</span><span class="op" id="2207543">&lt;&lt;</span><span class="ident" id="2207545">flt</span><span class="op" id="2207548">.</span><span class="ident" id="2207549">mantbits</span>&nbsp;<span class="op" id="2207558">-</span>&nbsp;<span class="num" id="2207560">1</span><span class="op" id="2207561">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207564">bits</span>&nbsp;<span class="op" id="2207569">|=</span>&nbsp;<span class="ident" id="2207572">uint64</span><span class="op" id="2207578">(</span><span class="op" id="2207579">(</span><span class="ident" id="2207580">exp</span><span class="op" id="2207583">-</span><span class="ident" id="2207584">flt</span><span class="op" id="2207587">.</span><span class="ident" id="2207588">bias</span><span class="op" id="2207592">)</span><span class="op" id="2207593">&amp;</span><span class="op" id="2207594">(</span><span class="num" id="2207595">1</span><span class="op" id="2207596">&lt;&lt;</span><span class="ident" id="2207598">flt</span><span class="op" id="2207601">.</span><span class="ident" id="2207602">expbits</span><span class="op" id="2207609">-</span><span class="num" id="2207610">1</span><span class="op" id="2207611">)</span><span class="op" id="2207612">)</span>&nbsp;<span class="op" id="2207614">&lt;&lt;</span>&nbsp;<span class="ident" id="2207617">flt</span><span class="op" id="2207620">.</span><span class="ident" id="2207621">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207631">if</span>&nbsp;<span class="ident" id="2207634">f</span><span class="op" id="2207635">.</span><span class="ident" id="2207636">neg</span>&nbsp;<span class="op" id="2207640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207644">bits</span>&nbsp;<span class="op" id="2207649">|=</span>&nbsp;<span class="num" id="2207652">1</span>&nbsp;<span class="op" id="2207654">&lt;&lt;</span>&nbsp;<span class="op" id="2207657">(</span><span class="ident" id="2207658">flt</span><span class="op" id="2207661">.</span><span class="ident" id="2207662">mantbits</span>&nbsp;<span class="op" id="2207671">+</span>&nbsp;<span class="ident" id="2207673">flt</span><span class="op" id="2207676">.</span><span class="ident" id="2207677">expbits</span><span class="op" id="2207684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207690">return</span><br>
<span class="lineno">170</span><span class="op" id="2207697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2207700">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2207758">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2207821">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2207881">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2207952">func</span>&nbsp;<span class="op" id="2207957">(</span><span class="ident" id="2207958">f</span>&nbsp;<span class="op" id="2207960">*</span><span class="ident" id="2207961">extFloat</span><span class="op" id="2207969">)</span>&nbsp;<span class="ident" id="2207971">AssignComputeBounds</span><span class="op" id="2207990">(</span><span class="ident" id="2207991">mant</span>&nbsp;<span class="ident" id="2207996">uint64</span><span class="op" id="2208002">,</span>&nbsp;<span class="ident" id="2208004">exp</span>&nbsp;<span class="builtintype" id="2208008">int</span><span class="op" id="2208011">,</span>&nbsp;<span class="ident" id="2208013">neg</span>&nbsp;<span class="builtintype" id="2208017">bool</span><span class="op" id="2208021">,</span>&nbsp;<span class="ident" id="2208023">flt</span>&nbsp;<span class="op" id="2208027">*</span><span class="ident" id="2208028">floatInfo</span><span class="op" id="2208037">)</span>&nbsp;<span class="op" id="2208039">(</span><span class="ident" id="2208040">lower</span><span class="op" id="2208045">,</span>&nbsp;<span class="ident" id="2208047">upper</span>&nbsp;<span class="ident" id="2208053">extFloat</span><span class="op" id="2208061">)</span>&nbsp;<span class="op" id="2208063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208066">f</span><span class="op" id="2208067">.</span><span class="ident" id="2208068">mant</span>&nbsp;<span class="op" id="2208073">=</span>&nbsp;<span class="ident" id="2208075">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208081">f</span><span class="op" id="2208082">.</span><span class="ident" id="2208083">exp</span>&nbsp;<span class="op" id="2208087">=</span>&nbsp;<span class="ident" id="2208089">exp</span>&nbsp;<span class="op" id="2208093">-</span>&nbsp;<span class="builtintype" id="2208095">int</span><span class="op" id="2208098">(</span><span class="ident" id="2208099">flt</span><span class="op" id="2208102">.</span><span class="ident" id="2208103">mantbits</span><span class="op" id="2208111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208114">f</span><span class="op" id="2208115">.</span><span class="ident" id="2208116">neg</span>&nbsp;<span class="op" id="2208120">=</span>&nbsp;<span class="ident" id="2208122">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208127">if</span>&nbsp;<span class="ident" id="2208130">f</span><span class="op" id="2208131">.</span><span class="ident" id="2208132">exp</span>&nbsp;<span class="op" id="2208136">&lt;=</span>&nbsp;<span class="num" id="2208139">0</span>&nbsp;<span class="op" id="2208141">&amp;&amp;</span>&nbsp;<span class="ident" id="2208144">mant</span>&nbsp;<span class="op" id="2208149">==</span>&nbsp;<span class="op" id="2208152">(</span><span class="ident" id="2208153">mant</span><span class="op" id="2208157">&gt;&gt;</span><span class="builtintype" id="2208159">uint</span><span class="op" id="2208163">(</span><span class="op" id="2208164">-</span><span class="ident" id="2208165">f</span><span class="op" id="2208166">.</span><span class="ident" id="2208167">exp</span><span class="op" id="2208170">)</span><span class="op" id="2208171">)</span><span class="op" id="2208172">&lt;&lt;</span><span class="builtintype" id="2208174">uint</span><span class="op" id="2208178">(</span><span class="op" id="2208179">-</span><span class="ident" id="2208180">f</span><span class="op" id="2208181">.</span><span class="ident" id="2208182">exp</span><span class="op" id="2208185">)</span>&nbsp;<span class="op" id="2208187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2208191">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208213">f</span><span class="op" id="2208214">.</span><span class="ident" id="2208215">mant</span>&nbsp;<span class="op" id="2208220">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2208224">uint</span><span class="op" id="2208228">(</span><span class="op" id="2208229">-</span><span class="ident" id="2208230">f</span><span class="op" id="2208231">.</span><span class="ident" id="2208232">exp</span><span class="op" id="2208235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208239">f</span><span class="op" id="2208240">.</span><span class="ident" id="2208241">exp</span>&nbsp;<span class="op" id="2208245">=</span>&nbsp;<span class="num" id="2208247">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208251">return</span>&nbsp;<span class="op" id="2208258">*</span><span class="ident" id="2208259">f</span><span class="op" id="2208260">,</span>&nbsp;<span class="op" id="2208262">*</span><span class="ident" id="2208263">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208269">expBiased</span>&nbsp;<span class="op" id="2208279">:=</span>&nbsp;<span class="ident" id="2208282">exp</span>&nbsp;<span class="op" id="2208286">-</span>&nbsp;<span class="ident" id="2208288">flt</span><span class="op" id="2208291">.</span><span class="ident" id="2208292">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208299">upper</span>&nbsp;<span class="op" id="2208305">=</span>&nbsp;<span class="ident" id="2208307">extFloat</span><span class="op" id="2208315">{</span><span class="ident" id="2208316">mant</span><span class="op" id="2208320">:</span>&nbsp;<span class="num" id="2208322">2</span><span class="op" id="2208323">*</span><span class="ident" id="2208324">f</span><span class="op" id="2208325">.</span><span class="ident" id="2208326">mant</span>&nbsp;<span class="op" id="2208331">+</span>&nbsp;<span class="num" id="2208333">1</span><span class="op" id="2208334">,</span>&nbsp;<span class="ident" id="2208336">exp</span><span class="op" id="2208339">:</span>&nbsp;<span class="ident" id="2208341">f</span><span class="op" id="2208342">.</span><span class="ident" id="2208343">exp</span>&nbsp;<span class="op" id="2208347">-</span>&nbsp;<span class="num" id="2208349">1</span><span class="op" id="2208350">,</span>&nbsp;<span class="ident" id="2208352">neg</span><span class="op" id="2208355">:</span>&nbsp;<span class="ident" id="2208357">f</span><span class="op" id="2208358">.</span><span class="ident" id="2208359">neg</span><span class="op" id="2208362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208365">if</span>&nbsp;<span class="ident" id="2208368">mant</span>&nbsp;<span class="op" id="2208373">!=</span>&nbsp;<span class="num" id="2208376">1</span><span class="op" id="2208377">&lt;&lt;</span><span class="ident" id="2208379">flt</span><span class="op" id="2208382">.</span><span class="ident" id="2208383">mantbits</span>&nbsp;<span class="op" id="2208392">||</span>&nbsp;<span class="ident" id="2208395">expBiased</span>&nbsp;<span class="op" id="2208405">==</span>&nbsp;<span class="num" id="2208408">1</span>&nbsp;<span class="op" id="2208410">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208414">lower</span>&nbsp;<span class="op" id="2208420">=</span>&nbsp;<span class="ident" id="2208422">extFloat</span><span class="op" id="2208430">{</span><span class="ident" id="2208431">mant</span><span class="op" id="2208435">:</span>&nbsp;<span class="num" id="2208437">2</span><span class="op" id="2208438">*</span><span class="ident" id="2208439">f</span><span class="op" id="2208440">.</span><span class="ident" id="2208441">mant</span>&nbsp;<span class="op" id="2208446">-</span>&nbsp;<span class="num" id="2208448">1</span><span class="op" id="2208449">,</span>&nbsp;<span class="ident" id="2208451">exp</span><span class="op" id="2208454">:</span>&nbsp;<span class="ident" id="2208456">f</span><span class="op" id="2208457">.</span><span class="ident" id="2208458">exp</span>&nbsp;<span class="op" id="2208462">-</span>&nbsp;<span class="num" id="2208464">1</span><span class="op" id="2208465">,</span>&nbsp;<span class="ident" id="2208467">neg</span><span class="op" id="2208470">:</span>&nbsp;<span class="ident" id="2208472">f</span><span class="op" id="2208473">.</span><span class="ident" id="2208474">neg</span><span class="op" id="2208477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208480">}</span>&nbsp;<span class="keyword" id="2208482">else</span>&nbsp;<span class="op" id="2208487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208491">lower</span>&nbsp;<span class="op" id="2208497">=</span>&nbsp;<span class="ident" id="2208499">extFloat</span><span class="op" id="2208507">{</span><span class="ident" id="2208508">mant</span><span class="op" id="2208512">:</span>&nbsp;<span class="num" id="2208514">4</span><span class="op" id="2208515">*</span><span class="ident" id="2208516">f</span><span class="op" id="2208517">.</span><span class="ident" id="2208518">mant</span>&nbsp;<span class="op" id="2208523">-</span>&nbsp;<span class="num" id="2208525">1</span><span class="op" id="2208526">,</span>&nbsp;<span class="ident" id="2208528">exp</span><span class="op" id="2208531">:</span>&nbsp;<span class="ident" id="2208533">f</span><span class="op" id="2208534">.</span><span class="ident" id="2208535">exp</span>&nbsp;<span class="op" id="2208539">-</span>&nbsp;<span class="num" id="2208541">2</span><span class="op" id="2208542">,</span>&nbsp;<span class="ident" id="2208544">neg</span><span class="op" id="2208547">:</span>&nbsp;<span class="ident" id="2208549">f</span><span class="op" id="2208550">.</span><span class="ident" id="2208551">neg</span><span class="op" id="2208554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208560">return</span><br>
<span class="lineno">195</span><span class="op" id="2208567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2208570">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2208639">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2208710">func</span>&nbsp;<span class="op" id="2208715">(</span><span class="ident" id="2208716">f</span>&nbsp;<span class="op" id="2208718">*</span><span class="ident" id="2208719">extFloat</span><span class="op" id="2208727">)</span>&nbsp;<span class="ident" id="2208729">Normalize</span><span class="op" id="2208738">(</span><span class="op" id="2208739">)</span>&nbsp;<span class="op" id="2208741">(</span><span class="ident" id="2208742">shift</span>&nbsp;<span class="builtintype" id="2208748">uint</span><span class="op" id="2208752">)</span>&nbsp;<span class="op" id="2208754">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208757">mant</span><span class="op" id="2208761">,</span>&nbsp;<span class="ident" id="2208763">exp</span>&nbsp;<span class="op" id="2208767">:=</span>&nbsp;<span class="ident" id="2208770">f</span><span class="op" id="2208771">.</span><span class="ident" id="2208772">mant</span><span class="op" id="2208776">,</span>&nbsp;<span class="ident" id="2208778">f</span><span class="op" id="2208779">.</span><span class="ident" id="2208780">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208785">if</span>&nbsp;<span class="ident" id="2208788">mant</span>&nbsp;<span class="op" id="2208793">==</span>&nbsp;<span class="num" id="2208796">0</span>&nbsp;<span class="op" id="2208798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208802">return</span>&nbsp;<span class="num" id="2208809">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208815">if</span>&nbsp;<span class="ident" id="2208818">mant</span><span class="op" id="2208822">&gt;&gt;</span><span class="op" id="2208824">(</span><span class="num" id="2208825">64</span><span class="op" id="2208827">-</span><span class="num" id="2208828">32</span><span class="op" id="2208830">)</span>&nbsp;<span class="op" id="2208832">==</span>&nbsp;<span class="num" id="2208835">0</span>&nbsp;<span class="op" id="2208837">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208841">mant</span>&nbsp;<span class="op" id="2208846">&lt;&lt;=</span>&nbsp;<span class="num" id="2208850">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208855">exp</span>&nbsp;<span class="op" id="2208859">-=</span>&nbsp;<span class="num" id="2208862">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208869">if</span>&nbsp;<span class="ident" id="2208872">mant</span><span class="op" id="2208876">&gt;&gt;</span><span class="op" id="2208878">(</span><span class="num" id="2208879">64</span><span class="op" id="2208881">-</span><span class="num" id="2208882">16</span><span class="op" id="2208884">)</span>&nbsp;<span class="op" id="2208886">==</span>&nbsp;<span class="num" id="2208889">0</span>&nbsp;<span class="op" id="2208891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208895">mant</span>&nbsp;<span class="op" id="2208900">&lt;&lt;=</span>&nbsp;<span class="num" id="2208904">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208909">exp</span>&nbsp;<span class="op" id="2208913">-=</span>&nbsp;<span class="num" id="2208916">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208923">if</span>&nbsp;<span class="ident" id="2208926">mant</span><span class="op" id="2208930">&gt;&gt;</span><span class="op" id="2208932">(</span><span class="num" id="2208933">64</span><span class="op" id="2208935">-</span><span class="num" id="2208936">8</span><span class="op" id="2208937">)</span>&nbsp;<span class="op" id="2208939">==</span>&nbsp;<span class="num" id="2208942">0</span>&nbsp;<span class="op" id="2208944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208948">mant</span>&nbsp;<span class="op" id="2208953">&lt;&lt;=</span>&nbsp;<span class="num" id="2208957">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208961">exp</span>&nbsp;<span class="op" id="2208965">-=</span>&nbsp;<span class="num" id="2208968">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2208971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2208974">if</span>&nbsp;<span class="ident" id="2208977">mant</span><span class="op" id="2208981">&gt;&gt;</span><span class="op" id="2208983">(</span><span class="num" id="2208984">64</span><span class="op" id="2208986">-</span><span class="num" id="2208987">4</span><span class="op" id="2208988">)</span>&nbsp;<span class="op" id="2208990">==</span>&nbsp;<span class="num" id="2208993">0</span>&nbsp;<span class="op" id="2208995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2208999">mant</span>&nbsp;<span class="op" id="2209004">&lt;&lt;=</span>&nbsp;<span class="num" id="2209008">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209012">exp</span>&nbsp;<span class="op" id="2209016">-=</span>&nbsp;<span class="num" id="2209019">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209022">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209025">if</span>&nbsp;<span class="ident" id="2209028">mant</span><span class="op" id="2209032">&gt;&gt;</span><span class="op" id="2209034">(</span><span class="num" id="2209035">64</span><span class="op" id="2209037">-</span><span class="num" id="2209038">2</span><span class="op" id="2209039">)</span>&nbsp;<span class="op" id="2209041">==</span>&nbsp;<span class="num" id="2209044">0</span>&nbsp;<span class="op" id="2209046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209050">mant</span>&nbsp;<span class="op" id="2209055">&lt;&lt;=</span>&nbsp;<span class="num" id="2209059">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209063">exp</span>&nbsp;<span class="op" id="2209067">-=</span>&nbsp;<span class="num" id="2209070">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209076">if</span>&nbsp;<span class="ident" id="2209079">mant</span><span class="op" id="2209083">&gt;&gt;</span><span class="op" id="2209085">(</span><span class="num" id="2209086">64</span><span class="op" id="2209088">-</span><span class="num" id="2209089">1</span><span class="op" id="2209090">)</span>&nbsp;<span class="op" id="2209092">==</span>&nbsp;<span class="num" id="2209095">0</span>&nbsp;<span class="op" id="2209097">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209101">mant</span>&nbsp;<span class="op" id="2209106">&lt;&lt;=</span>&nbsp;<span class="num" id="2209110">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209114">exp</span>&nbsp;<span class="op" id="2209118">-=</span>&nbsp;<span class="num" id="2209121">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2209124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209127">shift</span>&nbsp;<span class="op" id="2209133">=</span>&nbsp;<span class="builtintype" id="2209135">uint</span><span class="op" id="2209139">(</span><span class="ident" id="2209140">f</span><span class="op" id="2209141">.</span><span class="ident" id="2209142">exp</span>&nbsp;<span class="op" id="2209146">-</span>&nbsp;<span class="ident" id="2209148">exp</span><span class="op" id="2209151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209154">f</span><span class="op" id="2209155">.</span><span class="ident" id="2209156">mant</span><span class="op" id="2209160">,</span>&nbsp;<span class="ident" id="2209162">f</span><span class="op" id="2209163">.</span><span class="ident" id="2209164">exp</span>&nbsp;<span class="op" id="2209168">=</span>&nbsp;<span class="ident" id="2209170">mant</span><span class="op" id="2209174">,</span>&nbsp;<span class="ident" id="2209176">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2209181">return</span><br>
<span class="lineno"></span><span class="op" id="2209188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209191">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2209263">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2209286">func</span>&nbsp;<span class="op" id="2209291">(</span><span class="ident" id="2209292">f</span>&nbsp;<span class="op" id="2209294">*</span><span class="ident" id="2209295">extFloat</span><span class="op" id="2209303">)</span>&nbsp;<span class="ident" id="2209305">Multiply</span><span class="op" id="2209313">(</span><span class="ident" id="2209314">g</span>&nbsp;<span class="ident" id="2209316">extFloat</span><span class="op" id="2209324">)</span>&nbsp;<span class="op" id="2209326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209329">fhi</span><span class="op" id="2209332">,</span>&nbsp;<span class="ident" id="2209334">flo</span>&nbsp;<span class="op" id="2209338">:=</span>&nbsp;<span class="ident" id="2209341">f</span><span class="op" id="2209342">.</span><span class="ident" id="2209343">mant</span><span class="op" id="2209347">&gt;&gt;</span><span class="num" id="2209349">32</span><span class="op" id="2209351">,</span>&nbsp;<span class="ident" id="2209353">uint64</span><span class="op" id="2209359">(</span><span class="builtintype" id="2209360">uint32</span><span class="op" id="2209366">(</span><span class="ident" id="2209367">f</span><span class="op" id="2209368">.</span><span class="ident" id="2209369">mant</span><span class="op" id="2209373">)</span><span class="op" id="2209374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209377">ghi</span><span class="op" id="2209380">,</span>&nbsp;<span class="ident" id="2209382">glo</span>&nbsp;<span class="op" id="2209386">:=</span>&nbsp;<span class="ident" id="2209389">g</span><span class="op" id="2209390">.</span><span class="ident" id="2209391">mant</span><span class="op" id="2209395">&gt;&gt;</span><span class="num" id="2209397">32</span><span class="op" id="2209399">,</span>&nbsp;<span class="ident" id="2209401">uint64</span><span class="op" id="2209407">(</span><span class="builtintype" id="2209408">uint32</span><span class="op" id="2209414">(</span><span class="ident" id="2209415">g</span><span class="op" id="2209416">.</span><span class="ident" id="2209417">mant</span><span class="op" id="2209421">)</span><span class="op" id="2209422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2209426">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209446">cross1</span>&nbsp;<span class="op" id="2209453">:=</span>&nbsp;<span class="ident" id="2209456">fhi</span>&nbsp;<span class="op" id="2209460">*</span>&nbsp;<span class="ident" id="2209462">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209467">cross2</span>&nbsp;<span class="op" id="2209474">:=</span>&nbsp;<span class="ident" id="2209477">flo</span>&nbsp;<span class="op" id="2209481">*</span>&nbsp;<span class="ident" id="2209483">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2209489">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209558">f</span><span class="op" id="2209559">.</span><span class="ident" id="2209560">mant</span>&nbsp;<span class="op" id="2209565">=</span>&nbsp;<span class="ident" id="2209567">fhi</span><span class="op" id="2209570">*</span><span class="ident" id="2209571">ghi</span>&nbsp;<span class="op" id="2209575">+</span>&nbsp;<span class="op" id="2209577">(</span><span class="ident" id="2209578">cross1</span>&nbsp;<span class="op" id="2209585">&gt;&gt;</span>&nbsp;<span class="num" id="2209588">32</span><span class="op" id="2209590">)</span>&nbsp;<span class="op" id="2209592">+</span>&nbsp;<span class="op" id="2209594">(</span><span class="ident" id="2209595">cross2</span>&nbsp;<span class="op" id="2209602">&gt;&gt;</span>&nbsp;<span class="num" id="2209605">32</span><span class="op" id="2209607">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209610">rem</span>&nbsp;<span class="op" id="2209614">:=</span>&nbsp;<span class="ident" id="2209617">uint64</span><span class="op" id="2209623">(</span><span class="builtintype" id="2209624">uint32</span><span class="op" id="2209630">(</span><span class="ident" id="2209631">cross1</span><span class="op" id="2209637">)</span><span class="op" id="2209638">)</span>&nbsp;<span class="op" id="2209640">+</span>&nbsp;<span class="ident" id="2209642">uint64</span><span class="op" id="2209648">(</span><span class="builtintype" id="2209649">uint32</span><span class="op" id="2209655">(</span><span class="ident" id="2209656">cross2</span><span class="op" id="2209662">)</span><span class="op" id="2209663">)</span>&nbsp;<span class="op" id="2209665">+</span>&nbsp;<span class="op" id="2209667">(</span><span class="op" id="2209668">(</span><span class="ident" id="2209669">flo</span>&nbsp;<span class="op" id="2209673">*</span>&nbsp;<span class="ident" id="2209675">glo</span><span class="op" id="2209678">)</span>&nbsp;<span class="op" id="2209680">&gt;&gt;</span>&nbsp;<span class="num" id="2209683">32</span><span class="op" id="2209685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2209688">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209702">rem</span>&nbsp;<span class="op" id="2209706">+=</span>&nbsp;<span class="op" id="2209709">(</span><span class="num" id="2209710">1</span>&nbsp;<span class="op" id="2209712">&lt;&lt;</span>&nbsp;<span class="num" id="2209715">31</span><span class="op" id="2209717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209721">f</span><span class="op" id="2209722">.</span><span class="ident" id="2209723">mant</span>&nbsp;<span class="op" id="2209728">+=</span>&nbsp;<span class="op" id="2209731">(</span><span class="ident" id="2209732">rem</span>&nbsp;<span class="op" id="2209736">&gt;&gt;</span>&nbsp;<span class="num" id="2209739">32</span><span class="op" id="2209741">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2209744">f</span><span class="op" id="2209745">.</span><span class="ident" id="2209746">exp</span>&nbsp;<span class="op" id="2209750">=</span>&nbsp;<span class="ident" id="2209752">f</span><span class="op" id="2209753">.</span><span class="ident" id="2209754">exp</span>&nbsp;<span class="op" id="2209758">+</span>&nbsp;<span class="ident" id="2209760">g</span><span class="op" id="2209761">.</span><span class="ident" id="2209762">exp</span>&nbsp;<span class="op" id="2209766">+</span>&nbsp;<span class="num" id="2209768">64</span><br>
<span class="lineno"></span><span class="op" id="2209771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2209774">var</span>&nbsp;<span class="ident" id="2209778">uint64pow10</span>&nbsp;<span class="op" id="2209790">=</span>&nbsp;<span class="op" id="2209792">[</span><span class="op" id="2209793">...</span><span class="op" id="2209796">]</span><span class="ident" id="2209797">uint64</span><span class="op" id="2209803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2209806">1</span><span class="op" id="2209807">,</span>&nbsp;<span class="num" id="2209809">1e1</span><span class="op" id="2209812">,</span>&nbsp;<span class="num" id="2209814">1e2</span><span class="op" id="2209817">,</span>&nbsp;<span class="num" id="2209819">1e3</span><span class="op" id="2209822">,</span>&nbsp;<span class="num" id="2209824">1e4</span><span class="op" id="2209827">,</span>&nbsp;<span class="num" id="2209829">1e5</span><span class="op" id="2209832">,</span>&nbsp;<span class="num" id="2209834">1e6</span><span class="op" id="2209837">,</span>&nbsp;<span class="num" id="2209839">1e7</span><span class="op" id="2209842">,</span>&nbsp;<span class="num" id="2209844">1e8</span><span class="op" id="2209847">,</span>&nbsp;<span class="num" id="2209849">1e9</span><span class="op" id="2209852">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2209855">1e10</span><span class="op" id="2209859">,</span>&nbsp;<span class="num" id="2209861">1e11</span><span class="op" id="2209865">,</span>&nbsp;<span class="num" id="2209867">1e12</span><span class="op" id="2209871">,</span>&nbsp;<span class="num" id="2209873">1e13</span><span class="op" id="2209877">,</span>&nbsp;<span class="num" id="2209879">1e14</span><span class="op" id="2209883">,</span>&nbsp;<span class="num" id="2209885">1e15</span><span class="op" id="2209889">,</span>&nbsp;<span class="num" id="2209891">1e16</span><span class="op" id="2209895">,</span>&nbsp;<span class="num" id="2209897">1e17</span><span class="op" id="2209901">,</span>&nbsp;<span class="num" id="2209903">1e18</span><span class="op" id="2209907">,</span>&nbsp;<span class="num" id="2209909">1e19</span><span class="op" id="2209913">,</span><br>
<span class="lineno"></span><span class="op" id="2209915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209918">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2209986">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2210056">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2210119">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2210148">func</span>&nbsp;<span class="op" id="2210153">(</span><span class="ident" id="2210154">f</span>&nbsp;<span class="op" id="2210156">*</span><span class="ident" id="2210157">extFloat</span><span class="op" id="2210165">)</span>&nbsp;<span class="ident" id="2210167">AssignDecimal</span><span class="op" id="2210180">(</span><span class="ident" id="2210181">mantissa</span>&nbsp;<span class="ident" id="2210190">uint64</span><span class="op" id="2210196">,</span>&nbsp;<span class="ident" id="2210198">exp10</span>&nbsp;<span class="builtintype" id="2210204">int</span><span class="op" id="2210207">,</span>&nbsp;<span class="ident" id="2210209">neg</span>&nbsp;<span class="builtintype" id="2210213">bool</span><span class="op" id="2210217">,</span>&nbsp;<span class="ident" id="2210219">trunc</span>&nbsp;<span class="builtintype" id="2210225">bool</span><span class="op" id="2210229">,</span>&nbsp;<span class="ident" id="2210231">flt</span>&nbsp;<span class="op" id="2210235">*</span><span class="ident" id="2210236">floatInfo</span><span class="op" id="2210245">)</span>&nbsp;<span class="op" id="2210247">(</span><span class="ident" id="2210248">ok</span>&nbsp;<span class="builtintype" id="2210251">bool</span><span class="op" id="2210255">)</span>&nbsp;<span class="op" id="2210257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210260">const</span>&nbsp;<span class="ident" id="2210266">uint64digits</span>&nbsp;<span class="op" id="2210279">=</span>&nbsp;<span class="num" id="2210281">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210285">const</span>&nbsp;<span class="ident" id="2210291">errorscale</span>&nbsp;<span class="op" id="2210302">=</span>&nbsp;<span class="num" id="2210304">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210307">errors</span>&nbsp;<span class="op" id="2210314">:=</span>&nbsp;<span class="num" id="2210317">0</span>&nbsp;<span class="comment" id="2210319">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210377">if</span>&nbsp;<span class="ident" id="2210380">trunc</span>&nbsp;<span class="op" id="2210386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2210390">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210429">errors</span>&nbsp;<span class="op" id="2210436">+=</span>&nbsp;<span class="ident" id="2210439">errorscale</span>&nbsp;<span class="op" id="2210450">/</span>&nbsp;<span class="num" id="2210452">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210455">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210459">f</span><span class="op" id="2210460">.</span><span class="ident" id="2210461">mant</span>&nbsp;<span class="op" id="2210466">=</span>&nbsp;<span class="ident" id="2210468">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210478">f</span><span class="op" id="2210479">.</span><span class="ident" id="2210480">exp</span>&nbsp;<span class="op" id="2210484">=</span>&nbsp;<span class="num" id="2210486">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210489">f</span><span class="op" id="2210490">.</span><span class="ident" id="2210491">neg</span>&nbsp;<span class="op" id="2210495">=</span>&nbsp;<span class="ident" id="2210497">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2210503">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210534">i</span>&nbsp;<span class="op" id="2210536">:=</span>&nbsp;<span class="op" id="2210539">(</span><span class="ident" id="2210540">exp10</span>&nbsp;<span class="op" id="2210546">-</span>&nbsp;<span class="ident" id="2210548">firstPowerOfTen</span><span class="op" id="2210563">)</span>&nbsp;<span class="op" id="2210565">/</span>&nbsp;<span class="ident" id="2210567">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210583">if</span>&nbsp;<span class="ident" id="2210586">exp10</span>&nbsp;<span class="op" id="2210592">&lt;</span>&nbsp;<span class="ident" id="2210594">firstPowerOfTen</span>&nbsp;<span class="op" id="2210610">||</span>&nbsp;<span class="ident" id="2210613">i</span>&nbsp;<span class="op" id="2210615">&gt;=</span>&nbsp;<span class="builtinfunc" id="2210618">len</span><span class="op" id="2210621">(</span><span class="ident" id="2210622">powersOfTen</span><span class="op" id="2210633">)</span>&nbsp;<span class="op" id="2210635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210639">return</span>&nbsp;<span class="builtintype" id="2210646">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210653">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210656">adjExp</span>&nbsp;<span class="op" id="2210663">:=</span>&nbsp;<span class="op" id="2210666">(</span><span class="ident" id="2210667">exp10</span>&nbsp;<span class="op" id="2210673">-</span>&nbsp;<span class="ident" id="2210675">firstPowerOfTen</span><span class="op" id="2210690">)</span>&nbsp;<span class="op" id="2210692">%</span>&nbsp;<span class="ident" id="2210694">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2210711">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2210739">if</span>&nbsp;<span class="ident" id="2210742">adjExp</span>&nbsp;<span class="op" id="2210749">&lt;</span>&nbsp;<span class="ident" id="2210751">uint64digits</span>&nbsp;<span class="op" id="2210764">&amp;&amp;</span>&nbsp;<span class="ident" id="2210767">mantissa</span>&nbsp;<span class="op" id="2210776">&lt;</span>&nbsp;<span class="ident" id="2210778">uint64pow10</span><span class="op" id="2210789">[</span><span class="ident" id="2210790">uint64digits</span><span class="op" id="2210802">-</span><span class="ident" id="2210803">adjExp</span><span class="op" id="2210809">]</span>&nbsp;<span class="op" id="2210811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2210815">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210858">f</span><span class="op" id="2210859">.</span><span class="ident" id="2210860">mant</span>&nbsp;<span class="op" id="2210865">*=</span>&nbsp;<span class="ident" id="2210868">uint64pow10</span><span class="op" id="2210879">[</span><span class="ident" id="2210880">adjExp</span><span class="op" id="2210886">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210890">f</span><span class="op" id="2210891">.</span><span class="ident" id="2210892">Normalize</span><span class="op" id="2210901">(</span><span class="op" id="2210902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210905">}</span>&nbsp;<span class="keyword" id="2210907">else</span>&nbsp;<span class="op" id="2210912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210916">f</span><span class="op" id="2210917">.</span><span class="ident" id="2210918">Normalize</span><span class="op" id="2210927">(</span><span class="op" id="2210928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210932">f</span><span class="op" id="2210933">.</span><span class="ident" id="2210934">Multiply</span><span class="op" id="2210942">(</span><span class="ident" id="2210943">smallPowersOfTen</span><span class="op" id="2210959">[</span><span class="ident" id="2210960">adjExp</span><span class="op" id="2210966">]</span><span class="op" id="2210967">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2210971">errors</span>&nbsp;<span class="op" id="2210978">+=</span>&nbsp;<span class="ident" id="2210981">errorscale</span>&nbsp;<span class="op" id="2210992">/</span>&nbsp;<span class="num" id="2210994">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2210997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211001">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211046">f</span><span class="op" id="2211047">.</span><span class="ident" id="2211048">Multiply</span><span class="op" id="2211056">(</span><span class="ident" id="2211057">powersOfTen</span><span class="op" id="2211068">[</span><span class="ident" id="2211069">i</span><span class="op" id="2211070">]</span><span class="op" id="2211071">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2211074">if</span>&nbsp;<span class="ident" id="2211077">errors</span>&nbsp;<span class="op" id="2211084">&gt;</span>&nbsp;<span class="num" id="2211086">0</span>&nbsp;<span class="op" id="2211088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211092">errors</span>&nbsp;<span class="op" id="2211099">+=</span>&nbsp;<span class="num" id="2211102">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211108">errors</span>&nbsp;<span class="op" id="2211115">+=</span>&nbsp;<span class="ident" id="2211118">errorscale</span>&nbsp;<span class="op" id="2211129">/</span>&nbsp;<span class="num" id="2211131">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211135">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211149">shift</span>&nbsp;<span class="op" id="2211155">:=</span>&nbsp;<span class="ident" id="2211158">f</span><span class="op" id="2211159">.</span><span class="ident" id="2211160">Normalize</span><span class="op" id="2211169">(</span><span class="op" id="2211170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211173">errors</span>&nbsp;<span class="op" id="2211180">&lt;&lt;=</span>&nbsp;<span class="ident" id="2211184">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211192">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211242">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211309">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211377">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211446">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211450">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211507">denormalExp</span>&nbsp;<span class="op" id="2211519">:=</span>&nbsp;<span class="ident" id="2211522">flt</span><span class="op" id="2211525">.</span><span class="ident" id="2211526">bias</span>&nbsp;<span class="op" id="2211531">-</span>&nbsp;<span class="num" id="2211533">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2211537">var</span>&nbsp;<span class="ident" id="2211541">extrabits</span>&nbsp;<span class="builtintype" id="2211551">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2211557">if</span>&nbsp;<span class="ident" id="2211560">f</span><span class="op" id="2211561">.</span><span class="ident" id="2211562">exp</span>&nbsp;<span class="op" id="2211566">&lt;=</span>&nbsp;<span class="ident" id="2211569">denormalExp</span>&nbsp;<span class="op" id="2211581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211585">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211639">extrabits</span>&nbsp;<span class="op" id="2211649">=</span>&nbsp;<span class="builtintype" id="2211651">uint</span><span class="op" id="2211655">(</span><span class="num" id="2211656">63</span>&nbsp;<span class="op" id="2211659">-</span>&nbsp;<span class="ident" id="2211661">flt</span><span class="op" id="2211664">.</span><span class="ident" id="2211665">mantbits</span>&nbsp;<span class="op" id="2211674">+</span>&nbsp;<span class="num" id="2211676">1</span>&nbsp;<span class="op" id="2211678">+</span>&nbsp;<span class="builtintype" id="2211680">uint</span><span class="op" id="2211684">(</span><span class="ident" id="2211685">denormalExp</span><span class="op" id="2211696">-</span><span class="ident" id="2211697">f</span><span class="op" id="2211698">.</span><span class="ident" id="2211699">exp</span><span class="op" id="2211702">)</span><span class="op" id="2211703">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211706">}</span>&nbsp;<span class="keyword" id="2211708">else</span>&nbsp;<span class="op" id="2211713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211717">extrabits</span>&nbsp;<span class="op" id="2211727">=</span>&nbsp;<span class="builtintype" id="2211729">uint</span><span class="op" id="2211733">(</span><span class="num" id="2211734">63</span>&nbsp;<span class="op" id="2211737">-</span>&nbsp;<span class="ident" id="2211739">flt</span><span class="op" id="2211742">.</span><span class="ident" id="2211743">mantbits</span><span class="op" id="2211751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2211754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211758">halfway</span>&nbsp;<span class="op" id="2211766">:=</span>&nbsp;<span class="ident" id="2211769">uint64</span><span class="op" id="2211775">(</span><span class="num" id="2211776">1</span><span class="op" id="2211777">)</span>&nbsp;<span class="op" id="2211779">&lt;&lt;</span>&nbsp;<span class="op" id="2211782">(</span><span class="ident" id="2211783">extrabits</span>&nbsp;<span class="op" id="2211793">-</span>&nbsp;<span class="num" id="2211795">1</span><span class="op" id="2211796">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2211799">mant_extra</span>&nbsp;<span class="op" id="2211810">:=</span>&nbsp;<span class="ident" id="2211813">f</span><span class="op" id="2211814">.</span><span class="ident" id="2211815">mant</span>&nbsp;<span class="op" id="2211820">&amp;</span>&nbsp;<span class="op" id="2211822">(</span><span class="num" id="2211823">1</span><span class="op" id="2211824">&lt;&lt;</span><span class="ident" id="2211826">extrabits</span>&nbsp;<span class="op" id="2211836">-</span>&nbsp;<span class="num" id="2211838">1</span><span class="op" id="2211839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211843">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211909">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2211974">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212016">if</span>&nbsp;<span class="ident" id="2212019">int64</span><span class="op" id="2212024">(</span><span class="ident" id="2212025">halfway</span><span class="op" id="2212032">)</span><span class="op" id="2212033">-</span><span class="ident" id="2212034">int64</span><span class="op" id="2212039">(</span><span class="ident" id="2212040">errors</span><span class="op" id="2212046">)</span>&nbsp;<span class="op" id="2212048">&lt;</span>&nbsp;<span class="ident" id="2212050">int64</span><span class="op" id="2212055">(</span><span class="ident" id="2212056">mant_extra</span><span class="op" id="2212066">)</span>&nbsp;<span class="op" id="2212068">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212073">int64</span><span class="op" id="2212078">(</span><span class="ident" id="2212079">mant_extra</span><span class="op" id="2212089">)</span>&nbsp;<span class="op" id="2212091">&lt;</span>&nbsp;<span class="ident" id="2212093">int64</span><span class="op" id="2212098">(</span><span class="ident" id="2212099">halfway</span><span class="op" id="2212106">)</span><span class="op" id="2212107">+</span><span class="ident" id="2212108">int64</span><span class="op" id="2212113">(</span><span class="ident" id="2212114">errors</span><span class="op" id="2212120">)</span>&nbsp;<span class="op" id="2212122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212126">return</span>&nbsp;<span class="builtintype" id="2212133">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2212140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212143">return</span>&nbsp;<span class="builtintype" id="2212150">true</span><br>
<span class="lineno">330</span><span class="op" id="2212155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212158">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2212228">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2212295">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2212361">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2212422">func</span>&nbsp;<span class="op" id="2212427">(</span><span class="ident" id="2212428">f</span>&nbsp;<span class="op" id="2212430">*</span><span class="ident" id="2212431">extFloat</span><span class="op" id="2212439">)</span>&nbsp;<span class="ident" id="2212441">frexp10</span><span class="op" id="2212448">(</span><span class="op" id="2212449">)</span>&nbsp;<span class="op" id="2212451">(</span><span class="ident" id="2212452">exp10</span><span class="op" id="2212457">,</span>&nbsp;<span class="ident" id="2212459">index</span>&nbsp;<span class="builtintype" id="2212465">int</span><span class="op" id="2212468">)</span>&nbsp;<span class="op" id="2212470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212473">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212542">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212612">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212681">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212754">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212765">const</span>&nbsp;<span class="ident" id="2212771">expMin</span>&nbsp;<span class="op" id="2212778">=</span>&nbsp;<span class="op" id="2212780">-</span><span class="num" id="2212781">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2212785">const</span>&nbsp;<span class="ident" id="2212791">expMax</span>&nbsp;<span class="op" id="2212798">=</span>&nbsp;<span class="op" id="2212800">-</span><span class="num" id="2212801">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212805">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2212868">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212899">approxExp10</span>&nbsp;<span class="op" id="2212911">:=</span>&nbsp;<span class="op" id="2212914">(</span><span class="op" id="2212915">(</span><span class="ident" id="2212916">expMin</span><span class="op" id="2212922">+</span><span class="ident" id="2212923">expMax</span><span class="op" id="2212929">)</span><span class="op" id="2212930">/</span><span class="num" id="2212931">2</span>&nbsp;<span class="op" id="2212933">-</span>&nbsp;<span class="ident" id="2212935">f</span><span class="op" id="2212936">.</span><span class="ident" id="2212937">exp</span><span class="op" id="2212940">)</span>&nbsp;<span class="op" id="2212942">*</span>&nbsp;<span class="num" id="2212944">28</span>&nbsp;<span class="op" id="2212947">/</span>&nbsp;<span class="num" id="2212949">93</span>&nbsp;<span class="comment" id="2212952">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2212990">i</span>&nbsp;<span class="op" id="2212992">:=</span>&nbsp;<span class="op" id="2212995">(</span><span class="ident" id="2212996">approxExp10</span>&nbsp;<span class="op" id="2213008">-</span>&nbsp;<span class="ident" id="2213010">firstPowerOfTen</span><span class="op" id="2213025">)</span>&nbsp;<span class="op" id="2213027">/</span>&nbsp;<span class="ident" id="2213029">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2213044">Loop</span><span class="op" id="2213048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213051">for</span>&nbsp;<span class="op" id="2213055">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213059">exp</span>&nbsp;<span class="op" id="2213063">:=</span>&nbsp;<span class="ident" id="2213066">f</span><span class="op" id="2213067">.</span><span class="ident" id="2213068">exp</span>&nbsp;<span class="op" id="2213072">+</span>&nbsp;<span class="ident" id="2213074">powersOfTen</span><span class="op" id="2213085">[</span><span class="ident" id="2213086">i</span><span class="op" id="2213087">]</span><span class="op" id="2213088">.</span><span class="ident" id="2213089">exp</span>&nbsp;<span class="op" id="2213093">+</span>&nbsp;<span class="num" id="2213095">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213100">switch</span>&nbsp;<span class="op" id="2213107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213111">case</span>&nbsp;<span class="ident" id="2213116">exp</span>&nbsp;<span class="op" id="2213120">&lt;</span>&nbsp;<span class="ident" id="2213122">expMin</span><span class="op" id="2213128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213133">i</span><span class="op" id="2213134">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213139">case</span>&nbsp;<span class="ident" id="2213144">exp</span>&nbsp;<span class="op" id="2213148">&gt;</span>&nbsp;<span class="ident" id="2213150">expMax</span><span class="op" id="2213156">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213161">i</span><span class="op" id="2213162">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213167">default</span><span class="op" id="2213174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213179">break</span>&nbsp;<span class="ident" id="2213185">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213195">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2213198">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2213262">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213325">f</span><span class="op" id="2213326">.</span><span class="ident" id="2213327">Multiply</span><span class="op" id="2213335">(</span><span class="ident" id="2213336">powersOfTen</span><span class="op" id="2213347">[</span><span class="ident" id="2213348">i</span><span class="op" id="2213349">]</span><span class="op" id="2213350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213354">return</span>&nbsp;<span class="op" id="2213361">-</span><span class="op" id="2213362">(</span><span class="ident" id="2213363">firstPowerOfTen</span>&nbsp;<span class="op" id="2213379">+</span>&nbsp;<span class="ident" id="2213381">i</span><span class="op" id="2213382">*</span><span class="ident" id="2213383">stepPowerOfTen</span><span class="op" id="2213397">)</span><span class="op" id="2213398">,</span>&nbsp;<span class="ident" id="2213400">i</span><br>
<span class="lineno">365</span><span class="op" id="2213402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2213405">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2213473">func</span>&nbsp;<span class="ident" id="2213478">frexp10Many</span><span class="op" id="2213489">(</span><span class="ident" id="2213490">a</span><span class="op" id="2213491">,</span>&nbsp;<span class="ident" id="2213493">b</span><span class="op" id="2213494">,</span>&nbsp;<span class="ident" id="2213496">c</span>&nbsp;<span class="op" id="2213498">*</span><span class="ident" id="2213499">extFloat</span><span class="op" id="2213507">)</span>&nbsp;<span class="op" id="2213509">(</span><span class="ident" id="2213510">exp10</span>&nbsp;<span class="builtintype" id="2213516">int</span><span class="op" id="2213519">)</span>&nbsp;<span class="op" id="2213521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213524">exp10</span><span class="op" id="2213529">,</span>&nbsp;<span class="ident" id="2213531">i</span>&nbsp;<span class="op" id="2213533">:=</span>&nbsp;<span class="ident" id="2213536">c</span><span class="op" id="2213537">.</span><span class="ident" id="2213538">frexp10</span><span class="op" id="2213545">(</span><span class="op" id="2213546">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213549">a</span><span class="op" id="2213550">.</span><span class="ident" id="2213551">Multiply</span><span class="op" id="2213559">(</span><span class="ident" id="2213560">powersOfTen</span><span class="op" id="2213571">[</span><span class="ident" id="2213572">i</span><span class="op" id="2213573">]</span><span class="op" id="2213574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213577">b</span><span class="op" id="2213578">.</span><span class="ident" id="2213579">Multiply</span><span class="op" id="2213587">(</span><span class="ident" id="2213588">powersOfTen</span><span class="op" id="2213599">[</span><span class="ident" id="2213600">i</span><span class="op" id="2213601">]</span><span class="op" id="2213602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213605">return</span><br>
<span class="lineno"></span><span class="op" id="2213612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2213615">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2213674">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2213730">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2213769">func</span>&nbsp;<span class="op" id="2213774">(</span><span class="ident" id="2213775">f</span>&nbsp;<span class="op" id="2213777">*</span><span class="ident" id="2213778">extFloat</span><span class="op" id="2213786">)</span>&nbsp;<span class="ident" id="2213788">FixedDecimal</span><span class="op" id="2213800">(</span><span class="ident" id="2213801">d</span>&nbsp;<span class="op" id="2213803">*</span><span class="ident" id="2213804">decimalSlice</span><span class="op" id="2213816">,</span>&nbsp;<span class="ident" id="2213818">n</span>&nbsp;<span class="builtintype" id="2213820">int</span><span class="op" id="2213823">)</span>&nbsp;<span class="builtintype" id="2213825">bool</span>&nbsp;<span class="op" id="2213830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213833">if</span>&nbsp;<span class="ident" id="2213836">f</span><span class="op" id="2213837">.</span><span class="ident" id="2213838">mant</span>&nbsp;<span class="op" id="2213843">==</span>&nbsp;<span class="num" id="2213846">0</span>&nbsp;<span class="op" id="2213848">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213852">d</span><span class="op" id="2213853">.</span><span class="ident" id="2213854">nd</span>&nbsp;<span class="op" id="2213857">=</span>&nbsp;<span class="num" id="2213859">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213863">d</span><span class="op" id="2213864">.</span><span class="ident" id="2213865">dp</span>&nbsp;<span class="op" id="2213868">=</span>&nbsp;<span class="num" id="2213870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2213874">d</span><span class="op" id="2213875">.</span><span class="ident" id="2213876">neg</span>&nbsp;<span class="op" id="2213880">=</span>&nbsp;<span class="ident" id="2213882">f</span><span class="op" id="2213883">.</span><span class="ident" id="2213884">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213890">return</span>&nbsp;<span class="builtintype" id="2213897">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213903">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2213906">if</span>&nbsp;<span class="ident" id="2213909">n</span>&nbsp;<span class="op" id="2213911">==</span>&nbsp;<span class="num" id="2213914">0</span>&nbsp;<span class="op" id="2213916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2213920">panic</span><span class="op" id="2213925">(</span><span class="string" id="2213926">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2213993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2213996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2213999">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214064">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214087">f</span><span class="op" id="2214088">.</span><span class="ident" id="2214089">Normalize</span><span class="op" id="2214098">(</span><span class="op" id="2214099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214102">exp10</span><span class="op" id="2214107">,</span>&nbsp;<span class="ident" id="2214109">_</span>&nbsp;<span class="op" id="2214111">:=</span>&nbsp;<span class="ident" id="2214114">f</span><span class="op" id="2214115">.</span><span class="ident" id="2214116">frexp10</span><span class="op" id="2214123">(</span><span class="op" id="2214124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214128">shift</span>&nbsp;<span class="op" id="2214134">:=</span>&nbsp;<span class="builtintype" id="2214137">uint</span><span class="op" id="2214141">(</span><span class="op" id="2214142">-</span><span class="ident" id="2214143">f</span><span class="op" id="2214144">.</span><span class="ident" id="2214145">exp</span><span class="op" id="2214148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214151">integer</span>&nbsp;<span class="op" id="2214159">:=</span>&nbsp;<span class="builtintype" id="2214162">uint32</span><span class="op" id="2214168">(</span><span class="ident" id="2214169">f</span><span class="op" id="2214170">.</span><span class="ident" id="2214171">mant</span>&nbsp;<span class="op" id="2214176">&gt;&gt;</span>&nbsp;<span class="ident" id="2214179">shift</span><span class="op" id="2214184">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214187">fraction</span>&nbsp;<span class="op" id="2214196">:=</span>&nbsp;<span class="ident" id="2214199">f</span><span class="op" id="2214200">.</span><span class="ident" id="2214201">mant</span>&nbsp;<span class="op" id="2214206">-</span>&nbsp;<span class="op" id="2214208">(</span><span class="ident" id="2214209">uint64</span><span class="op" id="2214215">(</span><span class="ident" id="2214216">integer</span><span class="op" id="2214223">)</span>&nbsp;<span class="op" id="2214225">&lt;&lt;</span>&nbsp;<span class="ident" id="2214228">shift</span><span class="op" id="2214233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214236">ε</span>&nbsp;<span class="op" id="2214239">:=</span>&nbsp;<span class="ident" id="2214242">uint64</span><span class="op" id="2214248">(</span><span class="num" id="2214249">1</span><span class="op" id="2214250">)</span>&nbsp;<span class="comment" id="2214252">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214309">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214342">needed</span>&nbsp;<span class="op" id="2214349">:=</span>&nbsp;<span class="ident" id="2214352">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214361">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214400">integerDigits</span>&nbsp;<span class="op" id="2214414">:=</span>&nbsp;<span class="num" id="2214417">0</span>&nbsp;<span class="comment" id="2214419">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214464">pow10</span>&nbsp;<span class="op" id="2214470">:=</span>&nbsp;<span class="ident" id="2214473">uint64</span><span class="op" id="2214479">(</span><span class="num" id="2214480">1</span><span class="op" id="2214481">)</span>&nbsp;<span class="comment" id="2214483">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214527">for</span>&nbsp;<span class="ident" id="2214531">i</span><span class="op" id="2214532">,</span>&nbsp;<span class="ident" id="2214534">pow</span>&nbsp;<span class="op" id="2214538">:=</span>&nbsp;<span class="num" id="2214541">0</span><span class="op" id="2214542">,</span>&nbsp;<span class="ident" id="2214544">uint64</span><span class="op" id="2214550">(</span><span class="num" id="2214551">1</span><span class="op" id="2214552">)</span><span class="op" id="2214553">;</span>&nbsp;<span class="ident" id="2214555">i</span>&nbsp;<span class="op" id="2214557">&lt;</span>&nbsp;<span class="num" id="2214559">20</span><span class="op" id="2214561">;</span>&nbsp;<span class="ident" id="2214563">i</span><span class="op" id="2214564">++</span>&nbsp;<span class="op" id="2214567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214571">if</span>&nbsp;<span class="ident" id="2214574">pow</span>&nbsp;<span class="op" id="2214578">&gt;</span>&nbsp;<span class="ident" id="2214580">uint64</span><span class="op" id="2214586">(</span><span class="ident" id="2214587">integer</span><span class="op" id="2214594">)</span>&nbsp;<span class="op" id="2214596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214601">integerDigits</span>&nbsp;<span class="op" id="2214615">=</span>&nbsp;<span class="ident" id="2214617">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214622">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214634">pow</span>&nbsp;<span class="op" id="2214638">*=</span>&nbsp;<span class="num" id="2214641">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214648">rest</span>&nbsp;<span class="op" id="2214653">:=</span>&nbsp;<span class="ident" id="2214656">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214665">if</span>&nbsp;<span class="ident" id="2214668">integerDigits</span>&nbsp;<span class="op" id="2214682">&gt;</span>&nbsp;<span class="ident" id="2214684">needed</span>&nbsp;<span class="op" id="2214691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214695">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214758">pow10</span>&nbsp;<span class="op" id="2214764">=</span>&nbsp;<span class="ident" id="2214766">uint64pow10</span><span class="op" id="2214777">[</span><span class="ident" id="2214778">integerDigits</span><span class="op" id="2214791">-</span><span class="ident" id="2214792">needed</span><span class="op" id="2214798">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214802">integer</span>&nbsp;<span class="op" id="2214810">/=</span>&nbsp;<span class="builtintype" id="2214813">uint32</span><span class="op" id="2214819">(</span><span class="ident" id="2214820">pow10</span><span class="op" id="2214825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214829">rest</span>&nbsp;<span class="op" id="2214834">-=</span>&nbsp;<span class="ident" id="2214837">integer</span>&nbsp;<span class="op" id="2214845">*</span>&nbsp;<span class="builtintype" id="2214847">uint32</span><span class="op" id="2214853">(</span><span class="ident" id="2214854">pow10</span><span class="op" id="2214859">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214862">}</span>&nbsp;<span class="keyword" id="2214864">else</span>&nbsp;<span class="op" id="2214869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214873">rest</span>&nbsp;<span class="op" id="2214878">=</span>&nbsp;<span class="num" id="2214880">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2214883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2214887">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214952">var</span>&nbsp;<span class="ident" id="2214956">buf</span>&nbsp;<span class="op" id="2214960">[</span><span class="num" id="2214961">32</span><span class="op" id="2214963">]</span><span class="builtintype" id="2214964">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2214970">pos</span>&nbsp;<span class="op" id="2214974">:=</span>&nbsp;<span class="builtinfunc" id="2214977">len</span><span class="op" id="2214980">(</span><span class="ident" id="2214981">buf</span><span class="op" id="2214984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2214987">for</span>&nbsp;<span class="ident" id="2214991">v</span>&nbsp;<span class="op" id="2214993">:=</span>&nbsp;<span class="ident" id="2214996">integer</span><span class="op" id="2215003">;</span>&nbsp;<span class="ident" id="2215005">v</span>&nbsp;<span class="op" id="2215007">&gt;</span>&nbsp;<span class="num" id="2215009">0</span><span class="op" id="2215010">;</span>&nbsp;<span class="op" id="2215012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215016">v1</span>&nbsp;<span class="op" id="2215019">:=</span>&nbsp;<span class="ident" id="2215022">v</span>&nbsp;<span class="op" id="2215024">/</span>&nbsp;<span class="num" id="2215026">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215031">v</span>&nbsp;<span class="op" id="2215033">-=</span>&nbsp;<span class="num" id="2215036">10</span>&nbsp;<span class="op" id="2215039">*</span>&nbsp;<span class="ident" id="2215041">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215046">pos</span><span class="op" id="2215049">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215054">buf</span><span class="op" id="2215057">[</span><span class="ident" id="2215058">pos</span><span class="op" id="2215061">]</span>&nbsp;<span class="op" id="2215063">=</span>&nbsp;<span class="builtintype" id="2215065">byte</span><span class="op" id="2215069">(</span><span class="ident" id="2215070">v</span>&nbsp;<span class="op" id="2215072">+</span>&nbsp;<span class="string" id="2215074">&#39;0&#39;</span><span class="op" id="2215077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215081">v</span>&nbsp;<span class="op" id="2215083">=</span>&nbsp;<span class="ident" id="2215085">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215092">for</span>&nbsp;<span class="ident" id="2215096">i</span>&nbsp;<span class="op" id="2215098">:=</span>&nbsp;<span class="ident" id="2215101">pos</span><span class="op" id="2215104">;</span>&nbsp;<span class="ident" id="2215106">i</span>&nbsp;<span class="op" id="2215108">&lt;</span>&nbsp;<span class="builtinfunc" id="2215110">len</span><span class="op" id="2215113">(</span><span class="ident" id="2215114">buf</span><span class="op" id="2215117">)</span><span class="op" id="2215118">;</span>&nbsp;<span class="ident" id="2215120">i</span><span class="op" id="2215121">++</span>&nbsp;<span class="op" id="2215124">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215128">d</span><span class="op" id="2215129">.</span><span class="ident" id="2215130">d</span><span class="op" id="2215131">[</span><span class="ident" id="2215132">i</span><span class="op" id="2215133">-</span><span class="ident" id="2215134">pos</span><span class="op" id="2215137">]</span>&nbsp;<span class="op" id="2215139">=</span>&nbsp;<span class="ident" id="2215141">buf</span><span class="op" id="2215144">[</span><span class="ident" id="2215145">i</span><span class="op" id="2215146">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215152">nd</span>&nbsp;<span class="op" id="2215155">:=</span>&nbsp;<span class="builtinfunc" id="2215158">len</span><span class="op" id="2215161">(</span><span class="ident" id="2215162">buf</span><span class="op" id="2215165">)</span>&nbsp;<span class="op" id="2215167">-</span>&nbsp;<span class="ident" id="2215169">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215174">d</span><span class="op" id="2215175">.</span><span class="ident" id="2215176">nd</span>&nbsp;<span class="op" id="2215179">=</span>&nbsp;<span class="ident" id="2215181">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215185">d</span><span class="op" id="2215186">.</span><span class="ident" id="2215187">dp</span>&nbsp;<span class="op" id="2215190">=</span>&nbsp;<span class="ident" id="2215192">integerDigits</span>&nbsp;<span class="op" id="2215206">+</span>&nbsp;<span class="ident" id="2215208">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215215">needed</span>&nbsp;<span class="op" id="2215222">-=</span>&nbsp;<span class="ident" id="2215225">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215230">if</span>&nbsp;<span class="ident" id="2215233">needed</span>&nbsp;<span class="op" id="2215240">&gt;</span>&nbsp;<span class="num" id="2215242">0</span>&nbsp;<span class="op" id="2215244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215248">if</span>&nbsp;<span class="ident" id="2215251">rest</span>&nbsp;<span class="op" id="2215256">!=</span>&nbsp;<span class="num" id="2215259">0</span>&nbsp;<span class="op" id="2215261">||</span>&nbsp;<span class="ident" id="2215264">pow10</span>&nbsp;<span class="op" id="2215270">!=</span>&nbsp;<span class="num" id="2215273">1</span>&nbsp;<span class="op" id="2215275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2215280">panic</span><span class="op" id="2215285">(</span><span class="string" id="2215286">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2215337">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215345">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215410">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215450">for</span>&nbsp;<span class="ident" id="2215454">needed</span>&nbsp;<span class="op" id="2215461">&gt;</span>&nbsp;<span class="num" id="2215463">0</span>&nbsp;<span class="op" id="2215465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215470">fraction</span>&nbsp;<span class="op" id="2215479">*=</span>&nbsp;<span class="num" id="2215482">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215488">ε</span>&nbsp;<span class="op" id="2215491">*=</span>&nbsp;<span class="num" id="2215494">10</span>&nbsp;<span class="comment" id="2215497">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215549">if</span>&nbsp;<span class="num" id="2215552">2</span><span class="op" id="2215553">*</span><span class="ident" id="2215554">ε</span>&nbsp;<span class="op" id="2215557">&gt;</span>&nbsp;<span class="num" id="2215559">1</span><span class="op" id="2215560">&lt;&lt;</span><span class="ident" id="2215562">shift</span>&nbsp;<span class="op" id="2215568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215574">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2215648">return</span>&nbsp;<span class="builtintype" id="2215655">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215664">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215669">digit</span>&nbsp;<span class="op" id="2215675">:=</span>&nbsp;<span class="ident" id="2215678">fraction</span>&nbsp;<span class="op" id="2215687">&gt;&gt;</span>&nbsp;<span class="ident" id="2215690">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215699">d</span><span class="op" id="2215700">.</span><span class="ident" id="2215701">d</span><span class="op" id="2215702">[</span><span class="ident" id="2215703">nd</span><span class="op" id="2215705">]</span>&nbsp;<span class="op" id="2215707">=</span>&nbsp;<span class="builtintype" id="2215709">byte</span><span class="op" id="2215713">(</span><span class="ident" id="2215714">digit</span>&nbsp;<span class="op" id="2215720">+</span>&nbsp;<span class="string" id="2215722">&#39;0&#39;</span><span class="op" id="2215725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215730">fraction</span>&nbsp;<span class="op" id="2215739">-=</span>&nbsp;<span class="ident" id="2215742">digit</span>&nbsp;<span class="op" id="2215748">&lt;&lt;</span>&nbsp;<span class="ident" id="2215751">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215760">nd</span><span class="op" id="2215762">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215768">needed</span><span class="op" id="2215774">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2215783">d</span><span class="op" id="2215784">.</span><span class="ident" id="2215785">nd</span>&nbsp;<span class="op" id="2215788">=</span>&nbsp;<span class="ident" id="2215790">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2215794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215798">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215880">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215964">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215979">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2215983">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216015">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216066">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216119">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216205">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216209">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216255">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216286">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216339">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216343">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2216413">ok</span>&nbsp;<span class="op" id="2216416">:=</span>&nbsp;<span class="ident" id="2216419">adjustLastDigitFixed</span><span class="op" id="2216439">(</span><span class="ident" id="2216440">d</span><span class="op" id="2216441">,</span>&nbsp;<span class="ident" id="2216443">uint64</span><span class="op" id="2216449">(</span><span class="ident" id="2216450">rest</span><span class="op" id="2216454">)</span><span class="op" id="2216455">&lt;&lt;</span><span class="ident" id="2216457">shift</span><span class="op" id="2216462">|</span><span class="ident" id="2216463">fraction</span><span class="op" id="2216471">,</span>&nbsp;<span class="ident" id="2216473">pow10</span><span class="op" id="2216478">,</span>&nbsp;<span class="ident" id="2216480">shift</span><span class="op" id="2216485">,</span>&nbsp;<span class="ident" id="2216487">ε</span><span class="op" id="2216489">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216492">if</span>&nbsp;<span class="op" id="2216495">!</span><span class="ident" id="2216496">ok</span>&nbsp;<span class="op" id="2216499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216503">return</span>&nbsp;<span class="builtintype" id="2216510">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2216517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2216520">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216545">for</span>&nbsp;<span class="ident" id="2216549">i</span>&nbsp;<span class="op" id="2216551">:=</span>&nbsp;<span class="ident" id="2216554">d</span><span class="op" id="2216555">.</span><span class="ident" id="2216556">nd</span>&nbsp;<span class="op" id="2216559">-</span>&nbsp;<span class="num" id="2216561">1</span><span class="op" id="2216562">;</span>&nbsp;<span class="ident" id="2216564">i</span>&nbsp;<span class="op" id="2216566">&gt;=</span>&nbsp;<span class="num" id="2216569">0</span><span class="op" id="2216570">;</span>&nbsp;<span class="ident" id="2216572">i</span><span class="op" id="2216573">--</span>&nbsp;<span class="op" id="2216576">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216580">if</span>&nbsp;<span class="ident" id="2216583">d</span><span class="op" id="2216584">.</span><span class="ident" id="2216585">d</span><span class="op" id="2216586">[</span><span class="ident" id="2216587">i</span><span class="op" id="2216588">]</span>&nbsp;<span class="op" id="2216590">!=</span>&nbsp;<span class="string" id="2216593">&#39;0&#39;</span>&nbsp;<span class="op" id="2216597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2216602">d</span><span class="op" id="2216603">.</span><span class="ident" id="2216604">nd</span>&nbsp;<span class="op" id="2216607">=</span>&nbsp;<span class="ident" id="2216609">i</span>&nbsp;<span class="op" id="2216611">+</span>&nbsp;<span class="num" id="2216613">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216618">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2216626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2216629">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2216632">return</span>&nbsp;<span class="builtintype" id="2216639">true</span><br>
<span class="lineno"></span><span class="op" id="2216644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2216647">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2216730">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2216810">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2216888">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2216909">//</span><br>
<span class="lineno"></span><span class="comment" id="2216912">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2216997">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2217082">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2217122">func</span>&nbsp;<span class="ident" id="2217127">adjustLastDigitFixed</span><span class="op" id="2217147">(</span><span class="ident" id="2217148">d</span>&nbsp;<span class="op" id="2217150">*</span><span class="ident" id="2217151">decimalSlice</span><span class="op" id="2217163">,</span>&nbsp;<span class="ident" id="2217165">num</span><span class="op" id="2217168">,</span>&nbsp;<span class="ident" id="2217170">den</span>&nbsp;<span class="ident" id="2217174">uint64</span><span class="op" id="2217180">,</span>&nbsp;<span class="ident" id="2217182">shift</span>&nbsp;<span class="builtintype" id="2217188">uint</span><span class="op" id="2217192">,</span>&nbsp;<span class="ident" id="2217194">ε</span>&nbsp;<span class="ident" id="2217197">uint64</span><span class="op" id="2217203">)</span>&nbsp;<span class="builtintype" id="2217205">bool</span>&nbsp;<span class="op" id="2217210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217213">if</span>&nbsp;<span class="ident" id="2217216">num</span>&nbsp;<span class="op" id="2217220">&gt;</span>&nbsp;<span class="ident" id="2217222">den</span><span class="op" id="2217225">&lt;&lt;</span><span class="ident" id="2217227">shift</span>&nbsp;<span class="op" id="2217233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2217237">panic</span><span class="op" id="2217242">(</span><span class="string" id="2217243">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2217294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217297">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217300">if</span>&nbsp;<span class="num" id="2217303">2</span><span class="op" id="2217304">*</span><span class="ident" id="2217305">ε</span>&nbsp;<span class="op" id="2217308">&gt;</span>&nbsp;<span class="ident" id="2217310">den</span><span class="op" id="2217313">&lt;&lt;</span><span class="ident" id="2217315">shift</span>&nbsp;<span class="op" id="2217321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2217325">panic</span><span class="op" id="2217330">(</span><span class="string" id="2217331">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2217361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217367">if</span>&nbsp;<span class="num" id="2217370">2</span><span class="op" id="2217371">*</span><span class="op" id="2217372">(</span><span class="ident" id="2217373">num</span><span class="op" id="2217376">+</span><span class="ident" id="2217377">ε</span><span class="op" id="2217379">)</span>&nbsp;<span class="op" id="2217381">&lt;</span>&nbsp;<span class="ident" id="2217383">den</span><span class="op" id="2217386">&lt;&lt;</span><span class="ident" id="2217388">shift</span>&nbsp;<span class="op" id="2217394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217398">return</span>&nbsp;<span class="builtintype" id="2217405">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217414">if</span>&nbsp;<span class="num" id="2217417">2</span><span class="op" id="2217418">*</span><span class="op" id="2217419">(</span><span class="ident" id="2217420">num</span><span class="op" id="2217423">-</span><span class="ident" id="2217424">ε</span><span class="op" id="2217426">)</span>&nbsp;<span class="op" id="2217428">&gt;</span>&nbsp;<span class="ident" id="2217430">den</span><span class="op" id="2217433">&lt;&lt;</span><span class="ident" id="2217435">shift</span>&nbsp;<span class="op" id="2217441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2217445">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217468">i</span>&nbsp;<span class="op" id="2217470">:=</span>&nbsp;<span class="ident" id="2217473">d</span><span class="op" id="2217474">.</span><span class="ident" id="2217475">nd</span>&nbsp;<span class="op" id="2217478">-</span>&nbsp;<span class="num" id="2217480">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217484">for</span>&nbsp;<span class="op" id="2217488">;</span>&nbsp;<span class="ident" id="2217490">i</span>&nbsp;<span class="op" id="2217492">&gt;=</span>&nbsp;<span class="num" id="2217495">0</span><span class="op" id="2217496">;</span>&nbsp;<span class="ident" id="2217498">i</span><span class="op" id="2217499">--</span>&nbsp;<span class="op" id="2217502">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217507">if</span>&nbsp;<span class="ident" id="2217510">d</span><span class="op" id="2217511">.</span><span class="ident" id="2217512">d</span><span class="op" id="2217513">[</span><span class="ident" id="2217514">i</span><span class="op" id="2217515">]</span>&nbsp;<span class="op" id="2217517">==</span>&nbsp;<span class="string" id="2217520">&#39;9&#39;</span>&nbsp;<span class="op" id="2217524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217530">d</span><span class="op" id="2217531">.</span><span class="ident" id="2217532">nd</span><span class="op" id="2217534">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217540">}</span>&nbsp;<span class="keyword" id="2217542">else</span>&nbsp;<span class="op" id="2217547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217553">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217562">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217570">if</span>&nbsp;<span class="ident" id="2217573">i</span>&nbsp;<span class="op" id="2217575">&lt;</span>&nbsp;<span class="num" id="2217577">0</span>&nbsp;<span class="op" id="2217579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217584">d</span><span class="op" id="2217585">.</span><span class="ident" id="2217586">d</span><span class="op" id="2217587">[</span><span class="num" id="2217588">0</span><span class="op" id="2217589">]</span>&nbsp;<span class="op" id="2217591">=</span>&nbsp;<span class="string" id="2217593">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217600">d</span><span class="op" id="2217601">.</span><span class="ident" id="2217602">nd</span>&nbsp;<span class="op" id="2217605">=</span>&nbsp;<span class="num" id="2217607">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217612">d</span><span class="op" id="2217613">.</span><span class="ident" id="2217614">dp</span><span class="op" id="2217616">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217621">}</span>&nbsp;<span class="keyword" id="2217623">else</span>&nbsp;<span class="op" id="2217628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2217633">d</span><span class="op" id="2217634">.</span><span class="ident" id="2217635">d</span><span class="op" id="2217636">[</span><span class="ident" id="2217637">i</span><span class="op" id="2217638">]</span><span class="op" id="2217639">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217648">return</span>&nbsp;<span class="builtintype" id="2217655">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2217661">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2217664">return</span>&nbsp;<span class="builtintype" id="2217671">false</span><br>
<span class="lineno"></span><span class="op" id="2217677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2217680">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2217752">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2217826">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2217904">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2217934">func</span>&nbsp;<span class="op" id="2217939">(</span><span class="ident" id="2217940">f</span>&nbsp;<span class="op" id="2217942">*</span><span class="ident" id="2217943">extFloat</span><span class="op" id="2217951">)</span>&nbsp;<span class="ident" id="2217953">ShortestDecimal</span><span class="op" id="2217968">(</span><span class="ident" id="2217969">d</span>&nbsp;<span class="op" id="2217971">*</span><span class="ident" id="2217972">decimalSlice</span><span class="op" id="2217984">,</span>&nbsp;<span class="ident" id="2217986">lower</span><span class="op" id="2217991">,</span>&nbsp;<span class="ident" id="2217993">upper</span>&nbsp;<span class="op" id="2217999">*</span><span class="ident" id="2218000">extFloat</span><span class="op" id="2218008">)</span>&nbsp;<span class="builtintype" id="2218010">bool</span>&nbsp;<span class="op" id="2218015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218018">if</span>&nbsp;<span class="ident" id="2218021">f</span><span class="op" id="2218022">.</span><span class="ident" id="2218023">mant</span>&nbsp;<span class="op" id="2218028">==</span>&nbsp;<span class="num" id="2218031">0</span>&nbsp;<span class="op" id="2218033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218037">d</span><span class="op" id="2218038">.</span><span class="ident" id="2218039">nd</span>&nbsp;<span class="op" id="2218042">=</span>&nbsp;<span class="num" id="2218044">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218048">d</span><span class="op" id="2218049">.</span><span class="ident" id="2218050">dp</span>&nbsp;<span class="op" id="2218053">=</span>&nbsp;<span class="num" id="2218055">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218059">d</span><span class="op" id="2218060">.</span><span class="ident" id="2218061">neg</span>&nbsp;<span class="op" id="2218065">=</span>&nbsp;<span class="ident" id="2218067">f</span><span class="op" id="2218068">.</span><span class="ident" id="2218069">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218075">return</span>&nbsp;<span class="builtintype" id="2218082">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218091">if</span>&nbsp;<span class="ident" id="2218094">f</span><span class="op" id="2218095">.</span><span class="ident" id="2218096">exp</span>&nbsp;<span class="op" id="2218100">==</span>&nbsp;<span class="num" id="2218103">0</span>&nbsp;<span class="op" id="2218105">&amp;&amp;</span>&nbsp;<span class="op" id="2218108">*</span><span class="ident" id="2218109">lower</span>&nbsp;<span class="op" id="2218115">==</span>&nbsp;<span class="op" id="2218118">*</span><span class="ident" id="2218119">f</span>&nbsp;<span class="op" id="2218121">&amp;&amp;</span>&nbsp;<span class="op" id="2218124">*</span><span class="ident" id="2218125">lower</span>&nbsp;<span class="op" id="2218131">==</span>&nbsp;<span class="op" id="2218134">*</span><span class="ident" id="2218135">upper</span>&nbsp;<span class="op" id="2218141">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2218145">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218168">var</span>&nbsp;<span class="ident" id="2218172">buf</span>&nbsp;<span class="op" id="2218176">[</span><span class="num" id="2218177">24</span><span class="op" id="2218179">]</span><span class="builtintype" id="2218180">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218187">n</span>&nbsp;<span class="op" id="2218189">:=</span>&nbsp;<span class="builtinfunc" id="2218192">len</span><span class="op" id="2218195">(</span><span class="ident" id="2218196">buf</span><span class="op" id="2218199">)</span>&nbsp;<span class="op" id="2218201">-</span>&nbsp;<span class="num" id="2218203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218207">for</span>&nbsp;<span class="ident" id="2218211">v</span>&nbsp;<span class="op" id="2218213">:=</span>&nbsp;<span class="ident" id="2218216">f</span><span class="op" id="2218217">.</span><span class="ident" id="2218218">mant</span><span class="op" id="2218222">;</span>&nbsp;<span class="ident" id="2218224">v</span>&nbsp;<span class="op" id="2218226">&gt;</span>&nbsp;<span class="num" id="2218228">0</span><span class="op" id="2218229">;</span>&nbsp;<span class="op" id="2218231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218236">v1</span>&nbsp;<span class="op" id="2218239">:=</span>&nbsp;<span class="ident" id="2218242">v</span>&nbsp;<span class="op" id="2218244">/</span>&nbsp;<span class="num" id="2218246">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218252">v</span>&nbsp;<span class="op" id="2218254">-=</span>&nbsp;<span class="num" id="2218257">10</span>&nbsp;<span class="op" id="2218260">*</span>&nbsp;<span class="ident" id="2218262">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218268">buf</span><span class="op" id="2218271">[</span><span class="ident" id="2218272">n</span><span class="op" id="2218273">]</span>&nbsp;<span class="op" id="2218275">=</span>&nbsp;<span class="builtintype" id="2218277">byte</span><span class="op" id="2218281">(</span><span class="ident" id="2218282">v</span>&nbsp;<span class="op" id="2218284">+</span>&nbsp;<span class="string" id="2218286">&#39;0&#39;</span><span class="op" id="2218289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218294">n</span><span class="op" id="2218295">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218301">v</span>&nbsp;<span class="op" id="2218303">=</span>&nbsp;<span class="ident" id="2218305">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218310">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218314">nd</span>&nbsp;<span class="op" id="2218317">:=</span>&nbsp;<span class="builtinfunc" id="2218320">len</span><span class="op" id="2218323">(</span><span class="ident" id="2218324">buf</span><span class="op" id="2218327">)</span>&nbsp;<span class="op" id="2218329">-</span>&nbsp;<span class="ident" id="2218331">n</span>&nbsp;<span class="op" id="2218333">-</span>&nbsp;<span class="num" id="2218335">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218339">for</span>&nbsp;<span class="ident" id="2218343">i</span>&nbsp;<span class="op" id="2218345">:=</span>&nbsp;<span class="num" id="2218348">0</span><span class="op" id="2218349">;</span>&nbsp;<span class="ident" id="2218351">i</span>&nbsp;<span class="op" id="2218353">&lt;</span>&nbsp;<span class="ident" id="2218355">nd</span><span class="op" id="2218357">;</span>&nbsp;<span class="ident" id="2218359">i</span><span class="op" id="2218360">++</span>&nbsp;<span class="op" id="2218363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218368">d</span><span class="op" id="2218369">.</span><span class="ident" id="2218370">d</span><span class="op" id="2218371">[</span><span class="ident" id="2218372">i</span><span class="op" id="2218373">]</span>&nbsp;<span class="op" id="2218375">=</span>&nbsp;<span class="ident" id="2218377">buf</span><span class="op" id="2218380">[</span><span class="ident" id="2218381">n</span><span class="op" id="2218382">+</span><span class="num" id="2218383">1</span><span class="op" id="2218384">+</span><span class="ident" id="2218385">i</span><span class="op" id="2218386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218394">d</span><span class="op" id="2218395">.</span><span class="ident" id="2218396">nd</span><span class="op" id="2218398">,</span>&nbsp;<span class="ident" id="2218400">d</span><span class="op" id="2218401">.</span><span class="ident" id="2218402">dp</span>&nbsp;<span class="op" id="2218405">=</span>&nbsp;<span class="ident" id="2218407">nd</span><span class="op" id="2218409">,</span>&nbsp;<span class="ident" id="2218411">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218416">for</span>&nbsp;<span class="ident" id="2218420">d</span><span class="op" id="2218421">.</span><span class="ident" id="2218422">nd</span>&nbsp;<span class="op" id="2218425">&gt;</span>&nbsp;<span class="num" id="2218427">0</span>&nbsp;<span class="op" id="2218429">&amp;&amp;</span>&nbsp;<span class="ident" id="2218432">d</span><span class="op" id="2218433">.</span><span class="ident" id="2218434">d</span><span class="op" id="2218435">[</span><span class="ident" id="2218436">d</span><span class="op" id="2218437">.</span><span class="ident" id="2218438">nd</span><span class="op" id="2218440">-</span><span class="num" id="2218441">1</span><span class="op" id="2218442">]</span>&nbsp;<span class="op" id="2218444">==</span>&nbsp;<span class="string" id="2218447">&#39;0&#39;</span>&nbsp;<span class="op" id="2218451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218456">d</span><span class="op" id="2218457">.</span><span class="ident" id="2218458">nd</span><span class="op" id="2218460">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218469">if</span>&nbsp;<span class="ident" id="2218472">d</span><span class="op" id="2218473">.</span><span class="ident" id="2218474">nd</span>&nbsp;<span class="op" id="2218477">==</span>&nbsp;<span class="num" id="2218480">0</span>&nbsp;<span class="op" id="2218482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218487">d</span><span class="op" id="2218488">.</span><span class="ident" id="2218489">dp</span>&nbsp;<span class="op" id="2218492">=</span>&nbsp;<span class="num" id="2218494">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218502">d</span><span class="op" id="2218503">.</span><span class="ident" id="2218504">neg</span>&nbsp;<span class="op" id="2218508">=</span>&nbsp;<span class="ident" id="2218510">f</span><span class="op" id="2218511">.</span><span class="ident" id="2218512">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218518">return</span>&nbsp;<span class="builtintype" id="2218525">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218534">upper</span><span class="op" id="2218539">.</span><span class="ident" id="2218540">Normalize</span><span class="op" id="2218549">(</span><span class="op" id="2218550">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2218553">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218579">if</span>&nbsp;<span class="ident" id="2218582">f</span><span class="op" id="2218583">.</span><span class="ident" id="2218584">exp</span>&nbsp;<span class="op" id="2218588">&gt;</span>&nbsp;<span class="ident" id="2218590">upper</span><span class="op" id="2218595">.</span><span class="ident" id="2218596">exp</span>&nbsp;<span class="op" id="2218600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218604">f</span><span class="op" id="2218605">.</span><span class="ident" id="2218606">mant</span>&nbsp;<span class="op" id="2218611">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2218615">uint</span><span class="op" id="2218619">(</span><span class="ident" id="2218620">f</span><span class="op" id="2218621">.</span><span class="ident" id="2218622">exp</span>&nbsp;<span class="op" id="2218626">-</span>&nbsp;<span class="ident" id="2218628">upper</span><span class="op" id="2218633">.</span><span class="ident" id="2218634">exp</span><span class="op" id="2218637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218641">f</span><span class="op" id="2218642">.</span><span class="ident" id="2218643">exp</span>&nbsp;<span class="op" id="2218647">=</span>&nbsp;<span class="ident" id="2218649">upper</span><span class="op" id="2218654">.</span><span class="ident" id="2218655">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218660">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2218663">if</span>&nbsp;<span class="ident" id="2218666">lower</span><span class="op" id="2218671">.</span><span class="ident" id="2218672">exp</span>&nbsp;<span class="op" id="2218676">&gt;</span>&nbsp;<span class="ident" id="2218678">upper</span><span class="op" id="2218683">.</span><span class="ident" id="2218684">exp</span>&nbsp;<span class="op" id="2218688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218692">lower</span><span class="op" id="2218697">.</span><span class="ident" id="2218698">mant</span>&nbsp;<span class="op" id="2218703">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2218707">uint</span><span class="op" id="2218711">(</span><span class="ident" id="2218712">lower</span><span class="op" id="2218717">.</span><span class="ident" id="2218718">exp</span>&nbsp;<span class="op" id="2218722">-</span>&nbsp;<span class="ident" id="2218724">upper</span><span class="op" id="2218729">.</span><span class="ident" id="2218730">exp</span><span class="op" id="2218733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218737">lower</span><span class="op" id="2218742">.</span><span class="ident" id="2218743">exp</span>&nbsp;<span class="op" id="2218747">=</span>&nbsp;<span class="ident" id="2218749">upper</span><span class="op" id="2218754">.</span><span class="ident" id="2218755">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2218760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218764">exp10</span>&nbsp;<span class="op" id="2218770">:=</span>&nbsp;<span class="ident" id="2218773">frexp10Many</span><span class="op" id="2218784">(</span><span class="ident" id="2218785">lower</span><span class="op" id="2218790">,</span>&nbsp;<span class="ident" id="2218792">f</span><span class="op" id="2218793">,</span>&nbsp;<span class="ident" id="2218795">upper</span><span class="op" id="2218800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2218803">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218883">upper</span><span class="op" id="2218888">.</span><span class="ident" id="2218889">mant</span><span class="op" id="2218893">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2218897">lower</span><span class="op" id="2218902">.</span><span class="ident" id="2218903">mant</span><span class="op" id="2218907">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2218912">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2218983">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219029">shift</span>&nbsp;<span class="op" id="2219035">:=</span>&nbsp;<span class="builtintype" id="2219038">uint</span><span class="op" id="2219042">(</span><span class="op" id="2219043">-</span><span class="ident" id="2219044">upper</span><span class="op" id="2219049">.</span><span class="ident" id="2219050">exp</span><span class="op" id="2219053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219056">integer</span>&nbsp;<span class="op" id="2219064">:=</span>&nbsp;<span class="builtintype" id="2219067">uint32</span><span class="op" id="2219073">(</span><span class="ident" id="2219074">upper</span><span class="op" id="2219079">.</span><span class="ident" id="2219080">mant</span>&nbsp;<span class="op" id="2219085">&gt;&gt;</span>&nbsp;<span class="ident" id="2219088">shift</span><span class="op" id="2219093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219096">fraction</span>&nbsp;<span class="op" id="2219105">:=</span>&nbsp;<span class="ident" id="2219108">upper</span><span class="op" id="2219113">.</span><span class="ident" id="2219114">mant</span>&nbsp;<span class="op" id="2219119">-</span>&nbsp;<span class="op" id="2219121">(</span><span class="ident" id="2219122">uint64</span><span class="op" id="2219128">(</span><span class="ident" id="2219129">integer</span><span class="op" id="2219136">)</span>&nbsp;<span class="op" id="2219138">&lt;&lt;</span>&nbsp;<span class="ident" id="2219141">shift</span><span class="op" id="2219146">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219150">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219215">allowance</span>&nbsp;<span class="op" id="2219225">:=</span>&nbsp;<span class="ident" id="2219228">upper</span><span class="op" id="2219233">.</span><span class="ident" id="2219234">mant</span>&nbsp;<span class="op" id="2219239">-</span>&nbsp;<span class="ident" id="2219241">lower</span><span class="op" id="2219246">.</span><span class="ident" id="2219247">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219253">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219308">targetDiff</span>&nbsp;<span class="op" id="2219319">:=</span>&nbsp;<span class="ident" id="2219322">upper</span><span class="op" id="2219327">.</span><span class="ident" id="2219328">mant</span>&nbsp;<span class="op" id="2219333">-</span>&nbsp;<span class="ident" id="2219335">f</span><span class="op" id="2219336">.</span><span class="ident" id="2219337">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219344">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219393">var</span>&nbsp;<span class="ident" id="2219397">integerDigits</span>&nbsp;<span class="builtintype" id="2219411">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219416">for</span>&nbsp;<span class="ident" id="2219420">i</span><span class="op" id="2219421">,</span>&nbsp;<span class="ident" id="2219423">pow</span>&nbsp;<span class="op" id="2219427">:=</span>&nbsp;<span class="num" id="2219430">0</span><span class="op" id="2219431">,</span>&nbsp;<span class="ident" id="2219433">uint64</span><span class="op" id="2219439">(</span><span class="num" id="2219440">1</span><span class="op" id="2219441">)</span><span class="op" id="2219442">;</span>&nbsp;<span class="ident" id="2219444">i</span>&nbsp;<span class="op" id="2219446">&lt;</span>&nbsp;<span class="num" id="2219448">20</span><span class="op" id="2219450">;</span>&nbsp;<span class="ident" id="2219452">i</span><span class="op" id="2219453">++</span>&nbsp;<span class="op" id="2219456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219460">if</span>&nbsp;<span class="ident" id="2219463">pow</span>&nbsp;<span class="op" id="2219467">&gt;</span>&nbsp;<span class="ident" id="2219469">uint64</span><span class="op" id="2219475">(</span><span class="ident" id="2219476">integer</span><span class="op" id="2219483">)</span>&nbsp;<span class="op" id="2219485">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219490">integerDigits</span>&nbsp;<span class="op" id="2219504">=</span>&nbsp;<span class="ident" id="2219506">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219511">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2219519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219523">pow</span>&nbsp;<span class="op" id="2219527">*=</span>&nbsp;<span class="num" id="2219530">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2219534">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219537">for</span>&nbsp;<span class="ident" id="2219541">i</span>&nbsp;<span class="op" id="2219543">:=</span>&nbsp;<span class="num" id="2219546">0</span><span class="op" id="2219547">;</span>&nbsp;<span class="ident" id="2219549">i</span>&nbsp;<span class="op" id="2219551">&lt;</span>&nbsp;<span class="ident" id="2219553">integerDigits</span><span class="op" id="2219566">;</span>&nbsp;<span class="ident" id="2219568">i</span><span class="op" id="2219569">++</span>&nbsp;<span class="op" id="2219572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219576">pow</span>&nbsp;<span class="op" id="2219580">:=</span>&nbsp;<span class="ident" id="2219583">uint64pow10</span><span class="op" id="2219594">[</span><span class="ident" id="2219595">integerDigits</span><span class="op" id="2219608">-</span><span class="ident" id="2219609">i</span><span class="op" id="2219610">-</span><span class="num" id="2219611">1</span><span class="op" id="2219612">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219616">digit</span>&nbsp;<span class="op" id="2219622">:=</span>&nbsp;<span class="ident" id="2219625">integer</span>&nbsp;<span class="op" id="2219633">/</span>&nbsp;<span class="builtintype" id="2219635">uint32</span><span class="op" id="2219641">(</span><span class="ident" id="2219642">pow</span><span class="op" id="2219645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219649">d</span><span class="op" id="2219650">.</span><span class="ident" id="2219651">d</span><span class="op" id="2219652">[</span><span class="ident" id="2219653">i</span><span class="op" id="2219654">]</span>&nbsp;<span class="op" id="2219656">=</span>&nbsp;<span class="builtintype" id="2219658">byte</span><span class="op" id="2219662">(</span><span class="ident" id="2219663">digit</span>&nbsp;<span class="op" id="2219669">+</span>&nbsp;<span class="string" id="2219671">&#39;0&#39;</span><span class="op" id="2219674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219678">integer</span>&nbsp;<span class="op" id="2219686">-=</span>&nbsp;<span class="ident" id="2219689">digit</span>&nbsp;<span class="op" id="2219695">*</span>&nbsp;<span class="builtintype" id="2219697">uint32</span><span class="op" id="2219703">(</span><span class="ident" id="2219704">pow</span><span class="op" id="2219707">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219711">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2219749">if</span>&nbsp;<span class="ident" id="2219752">currentDiff</span>&nbsp;<span class="op" id="2219764">:=</span>&nbsp;<span class="ident" id="2219767">uint64</span><span class="op" id="2219773">(</span><span class="ident" id="2219774">integer</span><span class="op" id="2219781">)</span><span class="op" id="2219782">&lt;&lt;</span><span class="ident" id="2219784">shift</span>&nbsp;<span class="op" id="2219790">+</span>&nbsp;<span class="ident" id="2219792">fraction</span><span class="op" id="2219800">;</span>&nbsp;<span class="ident" id="2219802">currentDiff</span>&nbsp;<span class="op" id="2219814">&lt;</span>&nbsp;<span class="ident" id="2219816">allowance</span>&nbsp;<span class="op" id="2219826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219831">d</span><span class="op" id="2219832">.</span><span class="ident" id="2219833">nd</span>&nbsp;<span class="op" id="2219836">=</span>&nbsp;<span class="ident" id="2219838">i</span>&nbsp;<span class="op" id="2219840">+</span>&nbsp;<span class="num" id="2219842">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219847">d</span><span class="op" id="2219848">.</span><span class="ident" id="2219849">dp</span>&nbsp;<span class="op" id="2219852">=</span>&nbsp;<span class="ident" id="2219854">integerDigits</span>&nbsp;<span class="op" id="2219868">+</span>&nbsp;<span class="ident" id="2219870">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2219879">d</span><span class="op" id="2219880">.</span><span class="ident" id="2219881">neg</span>&nbsp;<span class="op" id="2219885">=</span>&nbsp;<span class="ident" id="2219887">f</span><span class="op" id="2219888">.</span><span class="ident" id="2219889">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219896">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2219966">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220004">return</span>&nbsp;<span class="ident" id="2220011">adjustLastDigit</span><span class="op" id="2220026">(</span><span class="ident" id="2220027">d</span><span class="op" id="2220028">,</span>&nbsp;<span class="ident" id="2220030">currentDiff</span><span class="op" id="2220041">,</span>&nbsp;<span class="ident" id="2220043">targetDiff</span><span class="op" id="2220053">,</span>&nbsp;<span class="ident" id="2220055">allowance</span><span class="op" id="2220064">,</span>&nbsp;<span class="ident" id="2220066">pow</span><span class="op" id="2220069">&lt;&lt;</span><span class="ident" id="2220071">shift</span><span class="op" id="2220076">,</span>&nbsp;<span class="num" id="2220078">2</span><span class="op" id="2220079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220086">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220089">d</span><span class="op" id="2220090">.</span><span class="ident" id="2220091">nd</span>&nbsp;<span class="op" id="2220094">=</span>&nbsp;<span class="ident" id="2220096">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220111">d</span><span class="op" id="2220112">.</span><span class="ident" id="2220113">dp</span>&nbsp;<span class="op" id="2220116">=</span>&nbsp;<span class="ident" id="2220118">d</span><span class="op" id="2220119">.</span><span class="ident" id="2220120">nd</span>&nbsp;<span class="op" id="2220123">+</span>&nbsp;<span class="ident" id="2220125">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220132">d</span><span class="op" id="2220133">.</span><span class="ident" id="2220134">neg</span>&nbsp;<span class="op" id="2220138">=</span>&nbsp;<span class="ident" id="2220140">f</span><span class="op" id="2220141">.</span><span class="ident" id="2220142">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2220148">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2220222">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220298">var</span>&nbsp;<span class="ident" id="2220302">digit</span>&nbsp;<span class="builtintype" id="2220308">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220313">multiplier</span>&nbsp;<span class="op" id="2220324">:=</span>&nbsp;<span class="ident" id="2220327">uint64</span><span class="op" id="2220333">(</span><span class="num" id="2220334">1</span><span class="op" id="2220335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220338">for</span>&nbsp;<span class="op" id="2220342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220346">fraction</span>&nbsp;<span class="op" id="2220355">*=</span>&nbsp;<span class="num" id="2220358">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220363">multiplier</span>&nbsp;<span class="op" id="2220374">*=</span>&nbsp;<span class="num" id="2220377">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220382">digit</span>&nbsp;<span class="op" id="2220388">=</span>&nbsp;<span class="builtintype" id="2220390">int</span><span class="op" id="2220393">(</span><span class="ident" id="2220394">fraction</span>&nbsp;<span class="op" id="2220403">&gt;&gt;</span>&nbsp;<span class="ident" id="2220406">shift</span><span class="op" id="2220411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220415">d</span><span class="op" id="2220416">.</span><span class="ident" id="2220417">d</span><span class="op" id="2220418">[</span><span class="ident" id="2220419">d</span><span class="op" id="2220420">.</span><span class="ident" id="2220421">nd</span><span class="op" id="2220423">]</span>&nbsp;<span class="op" id="2220425">=</span>&nbsp;<span class="builtintype" id="2220427">byte</span><span class="op" id="2220431">(</span><span class="ident" id="2220432">digit</span>&nbsp;<span class="op" id="2220438">+</span>&nbsp;<span class="string" id="2220440">&#39;0&#39;</span><span class="op" id="2220443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220447">d</span><span class="op" id="2220448">.</span><span class="ident" id="2220449">nd</span><span class="op" id="2220451">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220456">fraction</span>&nbsp;<span class="op" id="2220465">-=</span>&nbsp;<span class="ident" id="2220468">uint64</span><span class="op" id="2220474">(</span><span class="ident" id="2220475">digit</span><span class="op" id="2220480">)</span>&nbsp;<span class="op" id="2220482">&lt;&lt;</span>&nbsp;<span class="ident" id="2220485">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220493">if</span>&nbsp;<span class="ident" id="2220496">fraction</span>&nbsp;<span class="op" id="2220505">&lt;</span>&nbsp;<span class="ident" id="2220507">allowance</span><span class="op" id="2220516">*</span><span class="ident" id="2220517">multiplier</span>&nbsp;<span class="op" id="2220528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2220533">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2220606">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2220683">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2220732">return</span>&nbsp;<span class="ident" id="2220739">adjustLastDigit</span><span class="op" id="2220754">(</span><span class="ident" id="2220755">d</span><span class="op" id="2220756">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2220762">fraction</span><span class="op" id="2220770">,</span>&nbsp;<span class="ident" id="2220772">targetDiff</span><span class="op" id="2220782">*</span><span class="ident" id="2220783">multiplier</span><span class="op" id="2220793">,</span>&nbsp;<span class="ident" id="2220795">allowance</span><span class="op" id="2220804">*</span><span class="ident" id="2220805">multiplier</span><span class="op" id="2220815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2220821">1</span><span class="op" id="2220822">&lt;&lt;</span><span class="ident" id="2220824">shift</span><span class="op" id="2220829">,</span>&nbsp;<span class="ident" id="2220831">multiplier</span><span class="op" id="2220841">*</span><span class="num" id="2220842">2</span><span class="op" id="2220843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2220850">}</span><br>
<span class="lineno"></span><span class="op" id="2220852">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2220855">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2220923">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="2220991">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2221059">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="2221119">func</span>&nbsp;<span class="ident" id="2221124">adjustLastDigit</span><span class="op" id="2221139">(</span><span class="ident" id="2221140">d</span>&nbsp;<span class="op" id="2221142">*</span><span class="ident" id="2221143">decimalSlice</span><span class="op" id="2221155">,</span>&nbsp;<span class="ident" id="2221157">currentDiff</span><span class="op" id="2221168">,</span>&nbsp;<span class="ident" id="2221170">targetDiff</span><span class="op" id="2221180">,</span>&nbsp;<span class="ident" id="2221182">maxDiff</span><span class="op" id="2221189">,</span>&nbsp;<span class="ident" id="2221191">ulpDecimal</span><span class="op" id="2221201">,</span>&nbsp;<span class="ident" id="2221203">ulpBinary</span>&nbsp;<span class="ident" id="2221213">uint64</span><span class="op" id="2221219">)</span>&nbsp;<span class="builtintype" id="2221221">bool</span>&nbsp;<span class="op" id="2221226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221229">if</span>&nbsp;<span class="ident" id="2221232">ulpDecimal</span>&nbsp;<span class="op" id="2221243">&lt;</span>&nbsp;<span class="num" id="2221245">2</span><span class="op" id="2221246">*</span><span class="ident" id="2221247">ulpBinary</span>&nbsp;<span class="op" id="2221257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2221261">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221293">return</span>&nbsp;<span class="builtintype" id="2221300">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221307">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221310">for</span>&nbsp;<span class="ident" id="2221314">currentDiff</span><span class="op" id="2221325">+</span><span class="ident" id="2221326">ulpDecimal</span><span class="op" id="2221336">/</span><span class="num" id="2221337">2</span><span class="op" id="2221338">+</span><span class="ident" id="2221339">ulpBinary</span>&nbsp;<span class="op" id="2221349">&lt;</span>&nbsp;<span class="ident" id="2221351">targetDiff</span>&nbsp;<span class="op" id="2221362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221366">d</span><span class="op" id="2221367">.</span><span class="ident" id="2221368">d</span><span class="op" id="2221369">[</span><span class="ident" id="2221370">d</span><span class="op" id="2221371">.</span><span class="ident" id="2221372">nd</span><span class="op" id="2221374">-</span><span class="num" id="2221375">1</span><span class="op" id="2221376">]</span><span class="op" id="2221377">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221382">currentDiff</span>&nbsp;<span class="op" id="2221394">+=</span>&nbsp;<span class="ident" id="2221397">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221412">if</span>&nbsp;<span class="ident" id="2221415">currentDiff</span><span class="op" id="2221426">+</span><span class="ident" id="2221427">ulpDecimal</span>&nbsp;<span class="op" id="2221438">&lt;=</span>&nbsp;<span class="ident" id="2221441">targetDiff</span><span class="op" id="2221451">+</span><span class="ident" id="2221452">ulpDecimal</span><span class="op" id="2221462">/</span><span class="num" id="2221463">2</span><span class="op" id="2221464">+</span><span class="ident" id="2221465">ulpBinary</span>&nbsp;<span class="op" id="2221475">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2221479">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221532">return</span>&nbsp;<span class="builtintype" id="2221539">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221549">if</span>&nbsp;<span class="ident" id="2221552">currentDiff</span>&nbsp;<span class="op" id="2221564">&lt;</span>&nbsp;<span class="ident" id="2221566">ulpBinary</span>&nbsp;<span class="op" id="2221576">||</span>&nbsp;<span class="ident" id="2221579">currentDiff</span>&nbsp;<span class="op" id="2221591">&gt;</span>&nbsp;<span class="ident" id="2221593">maxDiff</span><span class="op" id="2221600">-</span><span class="ident" id="2221601">ulpBinary</span>&nbsp;<span class="op" id="2221611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2221615">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221636">return</span>&nbsp;<span class="builtintype" id="2221643">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221653">if</span>&nbsp;<span class="ident" id="2221656">d</span><span class="op" id="2221657">.</span><span class="ident" id="2221658">nd</span>&nbsp;<span class="op" id="2221661">==</span>&nbsp;<span class="num" id="2221664">1</span>&nbsp;<span class="op" id="2221666">&amp;&amp;</span>&nbsp;<span class="ident" id="2221669">d</span><span class="op" id="2221670">.</span><span class="ident" id="2221671">d</span><span class="op" id="2221672">[</span><span class="num" id="2221673">0</span><span class="op" id="2221674">]</span>&nbsp;<span class="op" id="2221676">==</span>&nbsp;<span class="string" id="2221679">&#39;0&#39;</span>&nbsp;<span class="op" id="2221683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2221687">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221730">d</span><span class="op" id="2221731">.</span><span class="ident" id="2221732">nd</span>&nbsp;<span class="op" id="2221735">=</span>&nbsp;<span class="num" id="2221737">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2221741">d</span><span class="op" id="2221742">.</span><span class="ident" id="2221743">dp</span>&nbsp;<span class="op" id="2221746">=</span>&nbsp;<span class="num" id="2221748">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2221751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2221754">return</span>&nbsp;<span class="builtintype" id="2221761">true</span><br>
<span class="lineno"></span><span class="op" id="2221766">}</span>
</div>
</body>
</html>
