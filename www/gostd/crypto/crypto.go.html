<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3897784">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3897839">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3897893">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3897944">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3898003">package</span>&nbsp;<span class="ident" id="3898011">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3898019">import</span>&nbsp;<span class="op" id="3898026">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3898029">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3898037">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3898043">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3898053">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3898056">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3898136">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3898148">type</span>&nbsp;<span class="ident" id="3898153">Hash</span>&nbsp;<span class="builtintype" id="3898158">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3898164">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3898242">func</span>&nbsp;<span class="op" id="3898247">(</span><span class="ident" id="3898248">h</span>&nbsp;<span class="ident" id="3898250">Hash</span><span class="op" id="3898254">)</span>&nbsp;<span class="ident" id="3898256">HashFunc</span><span class="op" id="3898264">(</span><span class="op" id="3898265">)</span>&nbsp;<span class="ident" id="3898267">Hash</span>&nbsp;<span class="op" id="3898272">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3898275">return</span>&nbsp;<span class="ident" id="3898282">h</span><br>
<span class="lineno"></span><span class="op" id="3898284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3898287">const</span>&nbsp;<span class="op" id="3898293">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898296">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898306">Hash</span>&nbsp;<span class="op" id="3898311">=</span>&nbsp;<span class="num" id="3898313">1</span>&nbsp;<span class="op" id="3898315">+</span>&nbsp;<span class="ident" id="3898317">iota</span>&nbsp;<span class="comment" id="3898322">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898357">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898383">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898405">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898431">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898454">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898480">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898505">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898531">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898556">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898582">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898607">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898633">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898658">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898684">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898733">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898759">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898800">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898826">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898862">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898888">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898924">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3898950">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3898986">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3899012">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899048">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3899056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3899059">var</span>&nbsp;<span class="ident" id="3899063">digestSizes</span>&nbsp;<span class="op" id="3899075">=</span>&nbsp;<span class="op" id="3899077">[</span><span class="op" id="3899078">]</span><span class="builtintype" id="3899079">uint8</span><span class="op" id="3899084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899087">MD4</span><span class="op" id="3899090">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899098">16</span><span class="op" id="3899100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899103">MD5</span><span class="op" id="3899106">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899114">16</span><span class="op" id="3899116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899119">SHA1</span><span class="op" id="3899123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899130">20</span><span class="op" id="3899132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899135">SHA224</span><span class="op" id="3899141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899146">28</span><span class="op" id="3899148">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899151">SHA256</span><span class="op" id="3899157">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899162">32</span><span class="op" id="3899164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899167">SHA384</span><span class="op" id="3899173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899178">48</span><span class="op" id="3899180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899183">SHA512</span><span class="op" id="3899189">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3899194">64</span><span class="op" id="3899196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899199">SHA3_224</span><span class="op" id="3899207">:</span>&nbsp;&nbsp;<span class="num" id="3899210">28</span><span class="op" id="3899212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899215">SHA3_256</span><span class="op" id="3899223">:</span>&nbsp;&nbsp;<span class="num" id="3899226">32</span><span class="op" id="3899228">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899231">SHA3_384</span><span class="op" id="3899239">:</span>&nbsp;&nbsp;<span class="num" id="3899242">48</span><span class="op" id="3899244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899247">SHA3_512</span><span class="op" id="3899255">:</span>&nbsp;&nbsp;<span class="num" id="3899258">64</span><span class="op" id="3899260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899263">MD5SHA1</span><span class="op" id="3899270">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3899274">36</span><span class="op" id="3899276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899279">RIPEMD160</span><span class="op" id="3899288">:</span>&nbsp;<span class="num" id="3899290">20</span><span class="op" id="3899292">,</span><br>
<span class="lineno"></span><span class="op" id="3899294">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3899297">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3899377">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3899454">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3899475">func</span>&nbsp;<span class="op" id="3899480">(</span><span class="ident" id="3899481">h</span>&nbsp;<span class="ident" id="3899483">Hash</span><span class="op" id="3899487">)</span>&nbsp;<span class="ident" id="3899489">Size</span><span class="op" id="3899493">(</span><span class="op" id="3899494">)</span>&nbsp;<span class="builtintype" id="3899496">int</span>&nbsp;<span class="op" id="3899500">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3899503">if</span>&nbsp;<span class="ident" id="3899506">h</span>&nbsp;<span class="op" id="3899508">&gt;</span>&nbsp;<span class="num" id="3899510">0</span>&nbsp;<span class="op" id="3899512">&amp;&amp;</span>&nbsp;<span class="ident" id="3899515">h</span>&nbsp;<span class="op" id="3899517">&lt;</span>&nbsp;<span class="ident" id="3899519">maxHash</span>&nbsp;<span class="op" id="3899527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3899531">return</span>&nbsp;<span class="builtintype" id="3899538">int</span><span class="op" id="3899541">(</span><span class="ident" id="3899542">digestSizes</span><span class="op" id="3899553">[</span><span class="ident" id="3899554">h</span><span class="op" id="3899555">]</span><span class="op" id="3899556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3899562">panic</span><span class="op" id="3899567">(</span><span class="string" id="3899568">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3899607">)</span><br>
<span class="lineno"></span><span class="op" id="3899609">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3899612">var</span>&nbsp;<span class="ident" id="3899616">hashes</span>&nbsp;<span class="op" id="3899623">=</span>&nbsp;<span class="builtinfunc" id="3899625">make</span><span class="op" id="3899629">(</span><span class="op" id="3899630">[</span><span class="op" id="3899631">]</span><span class="keyword" id="3899632">func</span><span class="op" id="3899636">(</span><span class="op" id="3899637">)</span>&nbsp;<span class="ident" id="3899639">hash</span><span class="op" id="3899643">.</span><span class="ident" id="3899644">Hash</span><span class="op" id="3899648">,</span>&nbsp;<span class="ident" id="3899650">maxHash</span><span class="op" id="3899657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3899660">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3899739">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3899794">func</span>&nbsp;<span class="op" id="3899799">(</span><span class="ident" id="3899800">h</span>&nbsp;<span class="ident" id="3899802">Hash</span><span class="op" id="3899806">)</span>&nbsp;<span class="ident" id="3899808">New</span><span class="op" id="3899811">(</span><span class="op" id="3899812">)</span>&nbsp;<span class="ident" id="3899814">hash</span><span class="op" id="3899818">.</span><span class="ident" id="3899819">Hash</span>&nbsp;<span class="op" id="3899824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3899827">if</span>&nbsp;<span class="ident" id="3899830">h</span>&nbsp;<span class="op" id="3899832">&gt;</span>&nbsp;<span class="num" id="3899834">0</span>&nbsp;<span class="op" id="3899836">&amp;&amp;</span>&nbsp;<span class="ident" id="3899839">h</span>&nbsp;<span class="op" id="3899841">&lt;</span>&nbsp;<span class="ident" id="3899843">maxHash</span>&nbsp;<span class="op" id="3899851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3899855">f</span>&nbsp;<span class="op" id="3899857">:=</span>&nbsp;<span class="ident" id="3899860">hashes</span><span class="op" id="3899866">[</span><span class="ident" id="3899867">h</span><span class="op" id="3899868">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3899872">if</span>&nbsp;<span class="ident" id="3899875">f</span>&nbsp;<span class="op" id="3899877">!=</span>&nbsp;<span class="builtintype" id="3899880">nil</span>&nbsp;<span class="op" id="3899884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3899889">return</span>&nbsp;<span class="ident" id="3899896">f</span><span class="op" id="3899897">(</span><span class="op" id="3899898">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3899908">panic</span><span class="op" id="3899913">(</span><span class="string" id="3899914">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3899950">+</span>&nbsp;<span class="ident" id="3899952">strconv</span><span class="op" id="3899959">.</span><span class="ident" id="3899960">Itoa</span><span class="op" id="3899964">(</span><span class="builtintype" id="3899965">int</span><span class="op" id="3899968">(</span><span class="ident" id="3899969">h</span><span class="op" id="3899970">)</span><span class="op" id="3899971">)</span>&nbsp;<span class="op" id="3899973">+</span>&nbsp;<span class="string" id="3899975">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3899992">)</span><br>
<span class="lineno"></span><span class="op" id="3899994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3899997">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3900077">func</span>&nbsp;<span class="op" id="3900082">(</span><span class="ident" id="3900083">h</span>&nbsp;<span class="ident" id="3900085">Hash</span><span class="op" id="3900089">)</span>&nbsp;<span class="ident" id="3900091">Available</span><span class="op" id="3900100">(</span><span class="op" id="3900101">)</span>&nbsp;<span class="builtintype" id="3900103">bool</span>&nbsp;<span class="op" id="3900108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3900111">return</span>&nbsp;<span class="ident" id="3900118">h</span>&nbsp;<span class="op" id="3900120">&lt;</span>&nbsp;<span class="ident" id="3900122">maxHash</span>&nbsp;<span class="op" id="3900130">&amp;&amp;</span>&nbsp;<span class="ident" id="3900133">hashes</span><span class="op" id="3900139">[</span><span class="ident" id="3900140">h</span><span class="op" id="3900141">]</span>&nbsp;<span class="op" id="3900143">!=</span>&nbsp;<span class="builtintype" id="3900146">nil</span><br>
<span class="lineno"></span><span class="op" id="3900150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3900153">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3900231">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3900305">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3900348">func</span>&nbsp;<span class="ident" id="3900353">RegisterHash</span><span class="op" id="3900365">(</span><span class="ident" id="3900366">h</span>&nbsp;<span class="ident" id="3900368">Hash</span><span class="op" id="3900372">,</span>&nbsp;<span class="ident" id="3900374">f</span>&nbsp;<span class="keyword" id="3900376">func</span><span class="op" id="3900380">(</span><span class="op" id="3900381">)</span>&nbsp;<span class="ident" id="3900383">hash</span><span class="op" id="3900387">.</span><span class="ident" id="3900388">Hash</span><span class="op" id="3900392">)</span>&nbsp;<span class="op" id="3900394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3900397">if</span>&nbsp;<span class="ident" id="3900400">h</span>&nbsp;<span class="op" id="3900402">&gt;=</span>&nbsp;<span class="ident" id="3900405">maxHash</span>&nbsp;<span class="op" id="3900413">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3900417">panic</span><span class="op" id="3900422">(</span><span class="string" id="3900423">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3900470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3900473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3900476">hashes</span><span class="op" id="3900482">[</span><span class="ident" id="3900483">h</span><span class="op" id="3900484">]</span>&nbsp;<span class="op" id="3900486">=</span>&nbsp;<span class="ident" id="3900488">f</span><br>
<span class="lineno"></span><span class="op" id="3900490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3900493">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3900562">type</span>&nbsp;<span class="ident" id="3900567">PublicKey</span>&nbsp;<span class="keyword" id="3900577">interface</span><span class="op" id="3900586">{</span><span class="op" id="3900587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3900590">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3900661">type</span>&nbsp;<span class="ident" id="3900666">PrivateKey</span>&nbsp;<span class="keyword" id="3900677">interface</span><span class="op" id="3900686">{</span><span class="op" id="3900687">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3900690">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3900763">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3900837">type</span>&nbsp;<span class="ident" id="3900842">Signer</span>&nbsp;<span class="keyword" id="3900849">interface</span>&nbsp;<span class="op" id="3900859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3900862">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3900925">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3900942">Public</span><span class="op" id="3900948">(</span><span class="op" id="3900949">)</span>&nbsp;<span class="ident" id="3900951">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3900963">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901032">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901101">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901173">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901240">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901244">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901317">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901390">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901458">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3901530">Sign</span><span class="op" id="3901534">(</span><span class="ident" id="3901535">rand</span>&nbsp;<span class="ident" id="3901540">io</span><span class="op" id="3901542">.</span><span class="ident" id="3901543">Reader</span><span class="op" id="3901549">,</span>&nbsp;<span class="ident" id="3901551">msg</span>&nbsp;<span class="op" id="3901555">[</span><span class="op" id="3901556">]</span><span class="builtintype" id="3901557">byte</span><span class="op" id="3901561">,</span>&nbsp;<span class="ident" id="3901563">opts</span>&nbsp;<span class="ident" id="3901568">SignerOpts</span><span class="op" id="3901578">)</span>&nbsp;<span class="op" id="3901580">(</span><span class="ident" id="3901581">signature</span>&nbsp;<span class="op" id="3901591">[</span><span class="op" id="3901592">]</span><span class="builtintype" id="3901593">byte</span><span class="op" id="3901597">,</span>&nbsp;<span class="ident" id="3901599">err</span>&nbsp;<span class="builtintype" id="3901603">error</span><span class="op" id="3901608">)</span><br>
<span class="lineno"></span><span class="op" id="3901610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3901613">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3901671">type</span>&nbsp;<span class="ident" id="3901676">SignerOpts</span>&nbsp;<span class="keyword" id="3901687">interface</span>&nbsp;<span class="op" id="3901697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901700">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901773">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3901845">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3901867">HashFunc</span><span class="op" id="3901875">(</span><span class="op" id="3901876">)</span>&nbsp;<span class="ident" id="3901878">Hash</span><br>
<span class="lineno"></span><span class="op" id="3901883">}</span>
</div>
</body>
</html>
