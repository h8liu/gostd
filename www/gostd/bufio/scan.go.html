<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2173430">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2173485">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2173539">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2173590">package</span>&nbsp;<span class="ident" id="2173598">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2173605">import</span>&nbsp;<span class="op" id="2173612">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2173615">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2173624">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2173634">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2173640">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2173655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2173658">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="2173726">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2173792">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="2173862">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2173927">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="2173995">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="2174073">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="2174139">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2174208">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2174263">//</span><br>
<span class="lineno"></span><span class="comment" id="2174266">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="2174342">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2174412">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2174485">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="2174562">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="2174611">//</span><br>
<span class="lineno">30</span><span class="keyword" id="2174614">type</span>&nbsp;<span class="ident" id="2174619">Scanner</span>&nbsp;<span class="keyword" id="2174627">struct</span>&nbsp;<span class="op" id="2174634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174637">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174650">io</span><span class="op" id="2174652">.</span><span class="ident" id="2174653">Reader</span>&nbsp;<span class="comment" id="2174660">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174699">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174712">SplitFunc</span>&nbsp;<span class="comment" id="2174722">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174760">maxTokenSize</span>&nbsp;<span class="builtintype" id="2174773">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174783">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174831">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174844">[</span><span class="op" id="2174845">]</span><span class="builtintype" id="2174846">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174854">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174888">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174901">[</span><span class="op" id="2174902">]</span><span class="builtintype" id="2174903">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174911">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174949">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2174962">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174972">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175009">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2175022">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175032">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175056">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2175069">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175079">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175097">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2175110">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175120">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="2175157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2175160">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2175233">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="2175311">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="2175387">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="2175462">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2175537">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2175615">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2175689">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="2175767">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2175811">//</span><br>
<span class="lineno"></span><span class="comment" id="2175814">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2175880">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="2175910">//</span><br>
<span class="lineno">55</span><span class="comment" id="2175913">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="2175983">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="2176049">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="2176087">type</span>&nbsp;<span class="ident" id="2176092">SplitFunc</span>&nbsp;<span class="keyword" id="2176102">func</span><span class="op" id="2176106">(</span><span class="ident" id="2176107">data</span>&nbsp;<span class="op" id="2176112">[</span><span class="op" id="2176113">]</span><span class="builtintype" id="2176114">byte</span><span class="op" id="2176118">,</span>&nbsp;<span class="ident" id="2176120">atEOF</span>&nbsp;<span class="builtintype" id="2176126">bool</span><span class="op" id="2176130">)</span>&nbsp;<span class="op" id="2176132">(</span><span class="ident" id="2176133">advance</span>&nbsp;<span class="builtintype" id="2176141">int</span><span class="op" id="2176144">,</span>&nbsp;<span class="ident" id="2176146">token</span>&nbsp;<span class="op" id="2176152">[</span><span class="op" id="2176153">]</span><span class="builtintype" id="2176154">byte</span><span class="op" id="2176158">,</span>&nbsp;<span class="ident" id="2176160">err</span>&nbsp;<span class="builtintype" id="2176164">error</span><span class="op" id="2176169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="2176172">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="2176203">var</span>&nbsp;<span class="op" id="2176207">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176210">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2176229">=</span>&nbsp;<span class="ident" id="2176231">errors</span><span class="op" id="2176237">.</span><span class="ident" id="2176238">New</span><span class="op" id="2176241">(</span><span class="string" id="2176242">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="2176273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176276">ErrNegativeAdvance</span>&nbsp;<span class="op" id="2176295">=</span>&nbsp;<span class="ident" id="2176297">errors</span><span class="op" id="2176303">.</span><span class="ident" id="2176304">New</span><span class="op" id="2176307">(</span><span class="string" id="2176308">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="2176365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176368">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2176387">=</span>&nbsp;<span class="ident" id="2176389">errors</span><span class="op" id="2176395">.</span><span class="ident" id="2176396">New</span><span class="op" id="2176399">(</span><span class="string" id="2176400">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="2176461">)</span><br>
<span class="lineno">65</span><span class="op" id="2176463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2176466">const</span>&nbsp;<span class="op" id="2176472">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2176475">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2176540">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2176603">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176653">MaxScanTokenSize</span>&nbsp;<span class="op" id="2176670">=</span>&nbsp;<span class="num" id="2176672">64</span>&nbsp;<span class="op" id="2176675">*</span>&nbsp;<span class="num" id="2176677">1024</span><br>
<span class="lineno"></span><span class="op" id="2176682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2176685">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="2176737">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="2176782">func</span>&nbsp;<span class="ident" id="2176787">NewScanner</span><span class="op" id="2176797">(</span><span class="ident" id="2176798">r</span>&nbsp;<span class="ident" id="2176800">io</span><span class="op" id="2176802">.</span><span class="ident" id="2176803">Reader</span><span class="op" id="2176809">)</span>&nbsp;<span class="op" id="2176811">*</span><span class="ident" id="2176812">Scanner</span>&nbsp;<span class="op" id="2176820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2176823">return</span>&nbsp;<span class="op" id="2176830">&amp;</span><span class="ident" id="2176831">Scanner</span><span class="op" id="2176838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176842">r</span><span class="op" id="2176843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176856">r</span><span class="op" id="2176857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176861">split</span><span class="op" id="2176866">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176875">ScanLines</span><span class="op" id="2176884">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176888">maxTokenSize</span><span class="op" id="2176900">:</span>&nbsp;<span class="ident" id="2176902">MaxScanTokenSize</span><span class="op" id="2176918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2176922">buf</span><span class="op" id="2176925">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2176936">make</span><span class="op" id="2176940">(</span><span class="op" id="2176941">[</span><span class="op" id="2176942">]</span><span class="builtintype" id="2176943">byte</span><span class="op" id="2176947">,</span>&nbsp;<span class="num" id="2176949">4096</span><span class="op" id="2176953">)</span><span class="op" id="2176954">,</span>&nbsp;<span class="comment" id="2176956">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177003">}</span><br>
<span class="lineno"></span><span class="op" id="2177005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2177008">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="2177084">func</span>&nbsp;<span class="op" id="2177089">(</span><span class="ident" id="2177090">s</span>&nbsp;<span class="op" id="2177092">*</span><span class="ident" id="2177093">Scanner</span><span class="op" id="2177100">)</span>&nbsp;<span class="ident" id="2177102">Err</span><span class="op" id="2177105">(</span><span class="op" id="2177106">)</span>&nbsp;<span class="builtintype" id="2177108">error</span>&nbsp;<span class="op" id="2177114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177117">if</span>&nbsp;<span class="ident" id="2177120">s</span><span class="op" id="2177121">.</span><span class="ident" id="2177122">err</span>&nbsp;<span class="op" id="2177126">==</span>&nbsp;<span class="ident" id="2177129">io</span><span class="op" id="2177131">.</span><span class="ident" id="2177132">EOF</span>&nbsp;<span class="op" id="2177136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177140">return</span>&nbsp;<span class="ident" id="2177147">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2177152">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177155">return</span>&nbsp;<span class="ident" id="2177162">s</span><span class="op" id="2177163">.</span><span class="ident" id="2177164">err</span><br>
<span class="lineno"></span><span class="op" id="2177168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2177171">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="2177239">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="2177306">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2177362">func</span>&nbsp;<span class="op" id="2177367">(</span><span class="ident" id="2177368">s</span>&nbsp;<span class="op" id="2177370">*</span><span class="ident" id="2177371">Scanner</span><span class="op" id="2177378">)</span>&nbsp;<span class="ident" id="2177380">Bytes</span><span class="op" id="2177385">(</span><span class="op" id="2177386">)</span>&nbsp;<span class="op" id="2177388">[</span><span class="op" id="2177389">]</span><span class="builtintype" id="2177390">byte</span>&nbsp;<span class="op" id="2177395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177398">return</span>&nbsp;<span class="ident" id="2177405">s</span><span class="op" id="2177406">.</span><span class="ident" id="2177407">token</span><br>
<span class="lineno"></span><span class="op" id="2177413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="2177416">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="2177482">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2177532">func</span>&nbsp;<span class="op" id="2177537">(</span><span class="ident" id="2177538">s</span>&nbsp;<span class="op" id="2177540">*</span><span class="ident" id="2177541">Scanner</span><span class="op" id="2177548">)</span>&nbsp;<span class="ident" id="2177550">Text</span><span class="op" id="2177554">(</span><span class="op" id="2177555">)</span>&nbsp;<span class="builtintype" id="2177557">string</span>&nbsp;<span class="op" id="2177564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2177567">return</span>&nbsp;<span class="builtintype" id="2177574">string</span><span class="op" id="2177580">(</span><span class="ident" id="2177581">s</span><span class="op" id="2177582">.</span><span class="ident" id="2177583">token</span><span class="op" id="2177588">)</span><br>
<span class="lineno"></span><span class="op" id="2177590">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2177593">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2177660">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2177733">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="2177801">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="2177872">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="2177935">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="2177955">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="2178026">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="2178092">func</span>&nbsp;<span class="op" id="2178097">(</span><span class="ident" id="2178098">s</span>&nbsp;<span class="op" id="2178100">*</span><span class="ident" id="2178101">Scanner</span><span class="op" id="2178108">)</span>&nbsp;<span class="ident" id="2178110">Scan</span><span class="op" id="2178114">(</span><span class="op" id="2178115">)</span>&nbsp;<span class="builtintype" id="2178117">bool</span>&nbsp;<span class="op" id="2178122">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178125">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178157">for</span>&nbsp;<span class="op" id="2178161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178165">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178223">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178296">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178358">if</span>&nbsp;<span class="ident" id="2178361">s</span><span class="op" id="2178362">.</span><span class="ident" id="2178363">end</span>&nbsp;<span class="op" id="2178367">&gt;</span>&nbsp;<span class="ident" id="2178369">s</span><span class="op" id="2178370">.</span><span class="ident" id="2178371">start</span>&nbsp;<span class="op" id="2178377">||</span>&nbsp;<span class="ident" id="2178380">s</span><span class="op" id="2178381">.</span><span class="ident" id="2178382">err</span>&nbsp;<span class="op" id="2178386">!=</span>&nbsp;<span class="ident" id="2178389">nil</span>&nbsp;<span class="op" id="2178393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178398">advance</span><span class="op" id="2178405">,</span>&nbsp;<span class="ident" id="2178407">token</span><span class="op" id="2178412">,</span>&nbsp;<span class="ident" id="2178414">err</span>&nbsp;<span class="op" id="2178418">:=</span>&nbsp;<span class="ident" id="2178421">s</span><span class="op" id="2178422">.</span><span class="ident" id="2178423">split</span><span class="op" id="2178428">(</span><span class="ident" id="2178429">s</span><span class="op" id="2178430">.</span><span class="ident" id="2178431">buf</span><span class="op" id="2178434">[</span><span class="ident" id="2178435">s</span><span class="op" id="2178436">.</span><span class="ident" id="2178437">start</span><span class="op" id="2178442">:</span><span class="ident" id="2178443">s</span><span class="op" id="2178444">.</span><span class="ident" id="2178445">end</span><span class="op" id="2178448">]</span><span class="op" id="2178449">,</span>&nbsp;<span class="ident" id="2178451">s</span><span class="op" id="2178452">.</span><span class="ident" id="2178453">err</span>&nbsp;<span class="op" id="2178457">!=</span>&nbsp;<span class="ident" id="2178460">nil</span><span class="op" id="2178463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178468">if</span>&nbsp;<span class="ident" id="2178471">err</span>&nbsp;<span class="op" id="2178475">!=</span>&nbsp;<span class="ident" id="2178478">nil</span>&nbsp;<span class="op" id="2178482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178488">s</span><span class="op" id="2178489">.</span><span class="ident" id="2178490">setErr</span><span class="op" id="2178496">(</span><span class="ident" id="2178497">err</span><span class="op" id="2178500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178506">return</span>&nbsp;<span class="builtintype" id="2178513">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178527">if</span>&nbsp;<span class="op" id="2178530">!</span><span class="ident" id="2178531">s</span><span class="op" id="2178532">.</span><span class="ident" id="2178533">advance</span><span class="op" id="2178540">(</span><span class="ident" id="2178541">advance</span><span class="op" id="2178548">)</span>&nbsp;<span class="op" id="2178550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178556">return</span>&nbsp;<span class="builtintype" id="2178563">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178577">s</span><span class="op" id="2178578">.</span><span class="ident" id="2178579">token</span>&nbsp;<span class="op" id="2178585">=</span>&nbsp;<span class="ident" id="2178587">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178596">if</span>&nbsp;<span class="ident" id="2178599">token</span>&nbsp;<span class="op" id="2178605">!=</span>&nbsp;<span class="ident" id="2178608">nil</span>&nbsp;<span class="op" id="2178612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178618">if</span>&nbsp;<span class="ident" id="2178621">s</span><span class="op" id="2178622">.</span><span class="ident" id="2178623">err</span>&nbsp;<span class="op" id="2178627">==</span>&nbsp;<span class="ident" id="2178630">nil</span>&nbsp;<span class="op" id="2178634">||</span>&nbsp;<span class="ident" id="2178637">advance</span>&nbsp;<span class="op" id="2178645">&gt;</span>&nbsp;<span class="num" id="2178647">0</span>&nbsp;<span class="op" id="2178649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178656">s</span><span class="op" id="2178657">.</span><span class="ident" id="2178658">empties</span>&nbsp;<span class="op" id="2178666">=</span>&nbsp;<span class="num" id="2178668">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178674">}</span>&nbsp;<span class="keyword" id="2178676">else</span>&nbsp;<span class="op" id="2178681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178688">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2178741">s</span><span class="op" id="2178742">.</span><span class="ident" id="2178743">empties</span><span class="op" id="2178750">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178758">if</span>&nbsp;<span class="ident" id="2178761">s</span><span class="op" id="2178762">.</span><span class="ident" id="2178763">empties</span>&nbsp;<span class="op" id="2178771">&gt;</span>&nbsp;<span class="num" id="2178773">100</span>&nbsp;<span class="op" id="2178777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2178785">panic</span><span class="op" id="2178790">(</span><span class="string" id="2178791">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="2178841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178854">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2178860">return</span>&nbsp;<span class="builtintype" id="2178867">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2178879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178883">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2178941">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179001">if</span>&nbsp;<span class="ident" id="2179004">s</span><span class="op" id="2179005">.</span><span class="ident" id="2179006">err</span>&nbsp;<span class="op" id="2179010">!=</span>&nbsp;<span class="ident" id="2179013">nil</span>&nbsp;<span class="op" id="2179017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179022">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179042">s</span><span class="op" id="2179043">.</span><span class="ident" id="2179044">start</span>&nbsp;<span class="op" id="2179050">=</span>&nbsp;<span class="num" id="2179052">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179057">s</span><span class="op" id="2179058">.</span><span class="ident" id="2179059">end</span>&nbsp;<span class="op" id="2179063">=</span>&nbsp;<span class="num" id="2179065">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179070">return</span>&nbsp;<span class="builtintype" id="2179077">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179089">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179115">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179192">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179217">if</span>&nbsp;<span class="ident" id="2179220">s</span><span class="op" id="2179221">.</span><span class="ident" id="2179222">start</span>&nbsp;<span class="op" id="2179228">&gt;</span>&nbsp;<span class="num" id="2179230">0</span>&nbsp;<span class="op" id="2179232">&amp;&amp;</span>&nbsp;<span class="op" id="2179235">(</span><span class="ident" id="2179236">s</span><span class="op" id="2179237">.</span><span class="ident" id="2179238">end</span>&nbsp;<span class="op" id="2179242">==</span>&nbsp;<span class="builtinfunc" id="2179245">len</span><span class="op" id="2179248">(</span><span class="ident" id="2179249">s</span><span class="op" id="2179250">.</span><span class="ident" id="2179251">buf</span><span class="op" id="2179254">)</span>&nbsp;<span class="op" id="2179256">||</span>&nbsp;<span class="ident" id="2179259">s</span><span class="op" id="2179260">.</span><span class="ident" id="2179261">start</span>&nbsp;<span class="op" id="2179267">&gt;</span>&nbsp;<span class="builtinfunc" id="2179269">len</span><span class="op" id="2179272">(</span><span class="ident" id="2179273">s</span><span class="op" id="2179274">.</span><span class="ident" id="2179275">buf</span><span class="op" id="2179278">)</span><span class="op" id="2179279">/</span><span class="num" id="2179280">2</span><span class="op" id="2179281">)</span>&nbsp;<span class="op" id="2179283">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2179288">copy</span><span class="op" id="2179292">(</span><span class="ident" id="2179293">s</span><span class="op" id="2179294">.</span><span class="ident" id="2179295">buf</span><span class="op" id="2179298">,</span>&nbsp;<span class="ident" id="2179300">s</span><span class="op" id="2179301">.</span><span class="ident" id="2179302">buf</span><span class="op" id="2179305">[</span><span class="ident" id="2179306">s</span><span class="op" id="2179307">.</span><span class="ident" id="2179308">start</span><span class="op" id="2179313">:</span><span class="ident" id="2179314">s</span><span class="op" id="2179315">.</span><span class="ident" id="2179316">end</span><span class="op" id="2179319">]</span><span class="op" id="2179320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179325">s</span><span class="op" id="2179326">.</span><span class="ident" id="2179327">end</span>&nbsp;<span class="op" id="2179331">-=</span>&nbsp;<span class="ident" id="2179334">s</span><span class="op" id="2179335">.</span><span class="ident" id="2179336">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179345">s</span><span class="op" id="2179346">.</span><span class="ident" id="2179347">start</span>&nbsp;<span class="op" id="2179353">=</span>&nbsp;<span class="num" id="2179355">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179363">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179403">if</span>&nbsp;<span class="ident" id="2179406">s</span><span class="op" id="2179407">.</span><span class="ident" id="2179408">end</span>&nbsp;<span class="op" id="2179412">==</span>&nbsp;<span class="builtinfunc" id="2179415">len</span><span class="op" id="2179418">(</span><span class="ident" id="2179419">s</span><span class="op" id="2179420">.</span><span class="ident" id="2179421">buf</span><span class="op" id="2179424">)</span>&nbsp;<span class="op" id="2179426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179431">if</span>&nbsp;<span class="builtinfunc" id="2179434">len</span><span class="op" id="2179437">(</span><span class="ident" id="2179438">s</span><span class="op" id="2179439">.</span><span class="ident" id="2179440">buf</span><span class="op" id="2179443">)</span>&nbsp;<span class="op" id="2179445">&gt;=</span>&nbsp;<span class="ident" id="2179448">s</span><span class="op" id="2179449">.</span><span class="ident" id="2179450">maxTokenSize</span>&nbsp;<span class="op" id="2179463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179469">s</span><span class="op" id="2179470">.</span><span class="ident" id="2179471">setErr</span><span class="op" id="2179477">(</span><span class="ident" id="2179478">ErrTooLong</span><span class="op" id="2179488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179494">return</span>&nbsp;<span class="builtintype" id="2179501">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179510">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179515">newSize</span>&nbsp;<span class="op" id="2179523">:=</span>&nbsp;<span class="builtinfunc" id="2179526">len</span><span class="op" id="2179529">(</span><span class="ident" id="2179530">s</span><span class="op" id="2179531">.</span><span class="ident" id="2179532">buf</span><span class="op" id="2179535">)</span>&nbsp;<span class="op" id="2179537">*</span>&nbsp;<span class="num" id="2179539">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179544">if</span>&nbsp;<span class="ident" id="2179547">newSize</span>&nbsp;<span class="op" id="2179555">&gt;</span>&nbsp;<span class="ident" id="2179557">s</span><span class="op" id="2179558">.</span><span class="ident" id="2179559">maxTokenSize</span>&nbsp;<span class="op" id="2179572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179578">newSize</span>&nbsp;<span class="op" id="2179586">=</span>&nbsp;<span class="ident" id="2179588">s</span><span class="op" id="2179589">.</span><span class="ident" id="2179590">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179611">newBuf</span>&nbsp;<span class="op" id="2179618">:=</span>&nbsp;<span class="builtinfunc" id="2179621">make</span><span class="op" id="2179625">(</span><span class="op" id="2179626">[</span><span class="op" id="2179627">]</span><span class="builtintype" id="2179628">byte</span><span class="op" id="2179632">,</span>&nbsp;<span class="ident" id="2179634">newSize</span><span class="op" id="2179641">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2179646">copy</span><span class="op" id="2179650">(</span><span class="ident" id="2179651">newBuf</span><span class="op" id="2179657">,</span>&nbsp;<span class="ident" id="2179659">s</span><span class="op" id="2179660">.</span><span class="ident" id="2179661">buf</span><span class="op" id="2179664">[</span><span class="ident" id="2179665">s</span><span class="op" id="2179666">.</span><span class="ident" id="2179667">start</span><span class="op" id="2179672">:</span><span class="ident" id="2179673">s</span><span class="op" id="2179674">.</span><span class="ident" id="2179675">end</span><span class="op" id="2179678">]</span><span class="op" id="2179679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179684">s</span><span class="op" id="2179685">.</span><span class="ident" id="2179686">buf</span>&nbsp;<span class="op" id="2179690">=</span>&nbsp;<span class="ident" id="2179692">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179702">s</span><span class="op" id="2179703">.</span><span class="ident" id="2179704">end</span>&nbsp;<span class="op" id="2179708">-=</span>&nbsp;<span class="ident" id="2179711">s</span><span class="op" id="2179712">.</span><span class="ident" id="2179713">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179722">s</span><span class="op" id="2179723">.</span><span class="ident" id="2179724">start</span>&nbsp;<span class="op" id="2179730">=</span>&nbsp;<span class="num" id="2179732">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179737">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2179748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179752">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179823">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2179897">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2179954">for</span>&nbsp;<span class="ident" id="2179958">loop</span>&nbsp;<span class="op" id="2179963">:=</span>&nbsp;<span class="num" id="2179966">0</span><span class="op" id="2179967">;</span>&nbsp;<span class="op" id="2179969">;</span>&nbsp;<span class="op" id="2179971">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2179976">n</span><span class="op" id="2179977">,</span>&nbsp;<span class="ident" id="2179979">err</span>&nbsp;<span class="op" id="2179983">:=</span>&nbsp;<span class="ident" id="2179986">s</span><span class="op" id="2179987">.</span><span class="ident" id="2179988">r</span><span class="op" id="2179989">.</span><span class="ident" id="2179990">Read</span><span class="op" id="2179994">(</span><span class="ident" id="2179995">s</span><span class="op" id="2179996">.</span><span class="ident" id="2179997">buf</span><span class="op" id="2180000">[</span><span class="ident" id="2180001">s</span><span class="op" id="2180002">.</span><span class="ident" id="2180003">end</span><span class="op" id="2180006">:</span><span class="builtinfunc" id="2180007">len</span><span class="op" id="2180010">(</span><span class="ident" id="2180011">s</span><span class="op" id="2180012">.</span><span class="ident" id="2180013">buf</span><span class="op" id="2180016">)</span><span class="op" id="2180017">]</span><span class="op" id="2180018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180023">s</span><span class="op" id="2180024">.</span><span class="ident" id="2180025">end</span>&nbsp;<span class="op" id="2180029">+=</span>&nbsp;<span class="ident" id="2180032">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180037">if</span>&nbsp;<span class="ident" id="2180040">err</span>&nbsp;<span class="op" id="2180044">!=</span>&nbsp;<span class="ident" id="2180047">nil</span>&nbsp;<span class="op" id="2180051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180057">s</span><span class="op" id="2180058">.</span><span class="ident" id="2180059">setErr</span><span class="op" id="2180065">(</span><span class="ident" id="2180066">err</span><span class="op" id="2180069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180075">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180089">if</span>&nbsp;<span class="ident" id="2180092">n</span>&nbsp;<span class="op" id="2180094">&gt;</span>&nbsp;<span class="num" id="2180096">0</span>&nbsp;<span class="op" id="2180098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180104">s</span><span class="op" id="2180105">.</span><span class="ident" id="2180106">empties</span>&nbsp;<span class="op" id="2180114">=</span>&nbsp;<span class="num" id="2180116">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180122">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180131">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180136">loop</span><span class="op" id="2180140">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180146">if</span>&nbsp;<span class="ident" id="2180149">loop</span>&nbsp;<span class="op" id="2180154">&gt;</span>&nbsp;<span class="ident" id="2180156">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="2180181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180187">s</span><span class="op" id="2180188">.</span><span class="ident" id="2180189">setErr</span><span class="op" id="2180195">(</span><span class="ident" id="2180196">io</span><span class="op" id="2180198">.</span><span class="ident" id="2180199">ErrNoProgress</span><span class="op" id="2180212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180218">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180227">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180234">}</span><br>
<span class="lineno"></span><span class="op" id="2180236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180239">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="2180324">func</span>&nbsp;<span class="op" id="2180329">(</span><span class="ident" id="2180330">s</span>&nbsp;<span class="op" id="2180332">*</span><span class="ident" id="2180333">Scanner</span><span class="op" id="2180340">)</span>&nbsp;<span class="ident" id="2180342">advance</span><span class="op" id="2180349">(</span><span class="ident" id="2180350">n</span>&nbsp;<span class="builtintype" id="2180352">int</span><span class="op" id="2180355">)</span>&nbsp;<span class="builtintype" id="2180357">bool</span>&nbsp;<span class="op" id="2180362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180365">if</span>&nbsp;<span class="ident" id="2180368">n</span>&nbsp;<span class="op" id="2180370">&lt;</span>&nbsp;<span class="num" id="2180372">0</span>&nbsp;<span class="op" id="2180374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180378">s</span><span class="op" id="2180379">.</span><span class="ident" id="2180380">setErr</span><span class="op" id="2180386">(</span><span class="ident" id="2180387">ErrNegativeAdvance</span><span class="op" id="2180405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180409">return</span>&nbsp;<span class="builtintype" id="2180416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180423">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180426">if</span>&nbsp;<span class="ident" id="2180429">n</span>&nbsp;<span class="op" id="2180431">&gt;</span>&nbsp;<span class="ident" id="2180433">s</span><span class="op" id="2180434">.</span><span class="ident" id="2180435">end</span><span class="op" id="2180438">-</span><span class="ident" id="2180439">s</span><span class="op" id="2180440">.</span><span class="ident" id="2180441">start</span>&nbsp;<span class="op" id="2180447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180451">s</span><span class="op" id="2180452">.</span><span class="ident" id="2180453">setErr</span><span class="op" id="2180459">(</span><span class="ident" id="2180460">ErrAdvanceTooFar</span><span class="op" id="2180476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180480">return</span>&nbsp;<span class="builtintype" id="2180487">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180497">s</span><span class="op" id="2180498">.</span><span class="ident" id="2180499">start</span>&nbsp;<span class="op" id="2180505">+=</span>&nbsp;<span class="ident" id="2180508">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180511">return</span>&nbsp;<span class="builtintype" id="2180518">true</span><br>
<span class="lineno"></span><span class="op" id="2180523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180526">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="2180573">func</span>&nbsp;<span class="op" id="2180578">(</span><span class="ident" id="2180579">s</span>&nbsp;<span class="op" id="2180581">*</span><span class="ident" id="2180582">Scanner</span><span class="op" id="2180589">)</span>&nbsp;<span class="ident" id="2180591">setErr</span><span class="op" id="2180597">(</span><span class="ident" id="2180598">err</span>&nbsp;<span class="builtintype" id="2180602">error</span><span class="op" id="2180607">)</span>&nbsp;<span class="op" id="2180609">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2180612">if</span>&nbsp;<span class="ident" id="2180615">s</span><span class="op" id="2180616">.</span><span class="ident" id="2180617">err</span>&nbsp;<span class="op" id="2180621">==</span>&nbsp;<span class="ident" id="2180624">nil</span>&nbsp;<span class="op" id="2180628">||</span>&nbsp;<span class="ident" id="2180631">s</span><span class="op" id="2180632">.</span><span class="ident" id="2180633">err</span>&nbsp;<span class="op" id="2180637">==</span>&nbsp;<span class="ident" id="2180640">io</span><span class="op" id="2180642">.</span><span class="ident" id="2180643">EOF</span>&nbsp;<span class="op" id="2180647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180651">s</span><span class="op" id="2180652">.</span><span class="ident" id="2180653">err</span>&nbsp;<span class="op" id="2180657">=</span>&nbsp;<span class="ident" id="2180659">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2180664">}</span><br>
<span class="lineno"></span><span class="op" id="2180666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2180669">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2180741">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="2180805">func</span>&nbsp;<span class="op" id="2180810">(</span><span class="ident" id="2180811">s</span>&nbsp;<span class="op" id="2180813">*</span><span class="ident" id="2180814">Scanner</span><span class="op" id="2180821">)</span>&nbsp;<span class="ident" id="2180823">Split</span><span class="op" id="2180828">(</span><span class="ident" id="2180829">split</span>&nbsp;<span class="ident" id="2180835">SplitFunc</span><span class="op" id="2180844">)</span>&nbsp;<span class="op" id="2180846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2180849">s</span><span class="op" id="2180850">.</span><span class="ident" id="2180851">split</span>&nbsp;<span class="op" id="2180857">=</span>&nbsp;<span class="ident" id="2180859">split</span><br>
<span class="lineno"></span><span class="op" id="2180865">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="2180868">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2180888">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2180970">func</span>&nbsp;<span class="ident" id="2180975">ScanBytes</span><span class="op" id="2180984">(</span><span class="ident" id="2180985">data</span>&nbsp;<span class="op" id="2180990">[</span><span class="op" id="2180991">]</span><span class="builtintype" id="2180992">byte</span><span class="op" id="2180996">,</span>&nbsp;<span class="ident" id="2180998">atEOF</span>&nbsp;<span class="builtintype" id="2181004">bool</span><span class="op" id="2181008">)</span>&nbsp;<span class="op" id="2181010">(</span><span class="ident" id="2181011">advance</span>&nbsp;<span class="builtintype" id="2181019">int</span><span class="op" id="2181022">,</span>&nbsp;<span class="ident" id="2181024">token</span>&nbsp;<span class="op" id="2181030">[</span><span class="op" id="2181031">]</span><span class="builtintype" id="2181032">byte</span><span class="op" id="2181036">,</span>&nbsp;<span class="ident" id="2181038">err</span>&nbsp;<span class="builtintype" id="2181042">error</span><span class="op" id="2181047">)</span>&nbsp;<span class="op" id="2181049">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181052">if</span>&nbsp;<span class="ident" id="2181055">atEOF</span>&nbsp;<span class="op" id="2181061">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2181064">len</span><span class="op" id="2181067">(</span><span class="ident" id="2181068">data</span><span class="op" id="2181072">)</span>&nbsp;<span class="op" id="2181074">==</span>&nbsp;<span class="num" id="2181077">0</span>&nbsp;<span class="op" id="2181079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181083">return</span>&nbsp;<span class="num" id="2181090">0</span><span class="op" id="2181091">,</span>&nbsp;<span class="ident" id="2181093">nil</span><span class="op" id="2181096">,</span>&nbsp;<span class="ident" id="2181098">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181106">return</span>&nbsp;<span class="num" id="2181113">1</span><span class="op" id="2181114">,</span>&nbsp;<span class="ident" id="2181116">data</span><span class="op" id="2181120">[</span><span class="num" id="2181121">0</span><span class="op" id="2181122">:</span><span class="num" id="2181123">1</span><span class="op" id="2181124">]</span><span class="op" id="2181125">,</span>&nbsp;<span class="ident" id="2181127">nil</span><br>
<span class="lineno"></span><span class="op" id="2181131">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="2181134">var</span>&nbsp;<span class="ident" id="2181138">errorRune</span>&nbsp;<span class="op" id="2181148">=</span>&nbsp;<span class="op" id="2181150">[</span><span class="op" id="2181151">]</span><span class="builtintype" id="2181152">byte</span><span class="op" id="2181156">(</span><span class="builtintype" id="2181157">string</span><span class="op" id="2181163">(</span><span class="ident" id="2181164">utf8</span><span class="op" id="2181168">.</span><span class="ident" id="2181169">RuneError</span><span class="op" id="2181178">)</span><span class="op" id="2181179">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2181182">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="2181247">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="2181315">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2181389">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2181467">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2181544">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="2181617">func</span>&nbsp;<span class="ident" id="2181622">ScanRunes</span><span class="op" id="2181631">(</span><span class="ident" id="2181632">data</span>&nbsp;<span class="op" id="2181637">[</span><span class="op" id="2181638">]</span><span class="builtintype" id="2181639">byte</span><span class="op" id="2181643">,</span>&nbsp;<span class="ident" id="2181645">atEOF</span>&nbsp;<span class="builtintype" id="2181651">bool</span><span class="op" id="2181655">)</span>&nbsp;<span class="op" id="2181657">(</span><span class="ident" id="2181658">advance</span>&nbsp;<span class="builtintype" id="2181666">int</span><span class="op" id="2181669">,</span>&nbsp;<span class="ident" id="2181671">token</span>&nbsp;<span class="op" id="2181677">[</span><span class="op" id="2181678">]</span><span class="builtintype" id="2181679">byte</span><span class="op" id="2181683">,</span>&nbsp;<span class="ident" id="2181685">err</span>&nbsp;<span class="builtintype" id="2181689">error</span><span class="op" id="2181694">)</span>&nbsp;<span class="op" id="2181696">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181699">if</span>&nbsp;<span class="ident" id="2181702">atEOF</span>&nbsp;<span class="op" id="2181708">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2181711">len</span><span class="op" id="2181714">(</span><span class="ident" id="2181715">data</span><span class="op" id="2181719">)</span>&nbsp;<span class="op" id="2181721">==</span>&nbsp;<span class="num" id="2181724">0</span>&nbsp;<span class="op" id="2181726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181730">return</span>&nbsp;<span class="num" id="2181737">0</span><span class="op" id="2181738">,</span>&nbsp;<span class="ident" id="2181740">nil</span><span class="op" id="2181743">,</span>&nbsp;<span class="ident" id="2181745">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181754">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181778">if</span>&nbsp;<span class="ident" id="2181781">data</span><span class="op" id="2181785">[</span><span class="num" id="2181786">0</span><span class="op" id="2181787">]</span>&nbsp;<span class="op" id="2181789">&lt;</span>&nbsp;<span class="ident" id="2181791">utf8</span><span class="op" id="2181795">.</span><span class="ident" id="2181796">RuneSelf</span>&nbsp;<span class="op" id="2181805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181809">return</span>&nbsp;<span class="num" id="2181816">1</span><span class="op" id="2181817">,</span>&nbsp;<span class="ident" id="2181819">data</span><span class="op" id="2181823">[</span><span class="num" id="2181824">0</span><span class="op" id="2181825">:</span><span class="num" id="2181826">1</span><span class="op" id="2181827">]</span><span class="op" id="2181828">,</span>&nbsp;<span class="ident" id="2181830">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2181835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181839">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2181892">_</span><span class="op" id="2181893">,</span>&nbsp;<span class="ident" id="2181895">width</span>&nbsp;<span class="op" id="2181901">:=</span>&nbsp;<span class="ident" id="2181904">utf8</span><span class="op" id="2181908">.</span><span class="ident" id="2181909">DecodeRune</span><span class="op" id="2181919">(</span><span class="ident" id="2181920">data</span><span class="op" id="2181924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2181927">if</span>&nbsp;<span class="ident" id="2181930">width</span>&nbsp;<span class="op" id="2181936">&gt;</span>&nbsp;<span class="num" id="2181938">1</span>&nbsp;<span class="op" id="2181940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2181944">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182016">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182037">return</span>&nbsp;<span class="ident" id="2182044">width</span><span class="op" id="2182049">,</span>&nbsp;<span class="ident" id="2182051">data</span><span class="op" id="2182055">[</span><span class="num" id="2182056">0</span><span class="op" id="2182057">:</span><span class="ident" id="2182058">width</span><span class="op" id="2182063">]</span><span class="op" id="2182064">,</span>&nbsp;<span class="ident" id="2182066">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182075">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182153">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182218">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182299">if</span>&nbsp;<span class="op" id="2182302">!</span><span class="ident" id="2182303">atEOF</span>&nbsp;<span class="op" id="2182309">&amp;&amp;</span>&nbsp;<span class="op" id="2182312">!</span><span class="ident" id="2182313">utf8</span><span class="op" id="2182317">.</span><span class="ident" id="2182318">FullRune</span><span class="op" id="2182326">(</span><span class="ident" id="2182327">data</span><span class="op" id="2182331">)</span>&nbsp;<span class="op" id="2182333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182337">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182370">return</span>&nbsp;<span class="num" id="2182377">0</span><span class="op" id="2182378">,</span>&nbsp;<span class="ident" id="2182380">nil</span><span class="op" id="2182383">,</span>&nbsp;<span class="ident" id="2182385">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182394">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182472">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2182550">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182585">return</span>&nbsp;<span class="num" id="2182592">1</span><span class="op" id="2182593">,</span>&nbsp;<span class="ident" id="2182595">errorRune</span><span class="op" id="2182604">,</span>&nbsp;<span class="ident" id="2182606">nil</span><br>
<span class="lineno"></span><span class="op" id="2182610">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="2182613">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="2182658">func</span>&nbsp;<span class="ident" id="2182663">dropCR</span><span class="op" id="2182669">(</span><span class="ident" id="2182670">data</span>&nbsp;<span class="op" id="2182675">[</span><span class="op" id="2182676">]</span><span class="builtintype" id="2182677">byte</span><span class="op" id="2182681">)</span>&nbsp;<span class="op" id="2182683">[</span><span class="op" id="2182684">]</span><span class="builtintype" id="2182685">byte</span>&nbsp;<span class="op" id="2182690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182693">if</span>&nbsp;<span class="builtinfunc" id="2182696">len</span><span class="op" id="2182699">(</span><span class="ident" id="2182700">data</span><span class="op" id="2182704">)</span>&nbsp;<span class="op" id="2182706">&gt;</span>&nbsp;<span class="num" id="2182708">0</span>&nbsp;<span class="op" id="2182710">&amp;&amp;</span>&nbsp;<span class="ident" id="2182713">data</span><span class="op" id="2182717">[</span><span class="builtinfunc" id="2182718">len</span><span class="op" id="2182721">(</span><span class="ident" id="2182722">data</span><span class="op" id="2182726">)</span><span class="op" id="2182727">-</span><span class="num" id="2182728">1</span><span class="op" id="2182729">]</span>&nbsp;<span class="op" id="2182731">==</span>&nbsp;<span class="string" id="2182734">&#39;\r&#39;</span>&nbsp;<span class="op" id="2182739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182743">return</span>&nbsp;<span class="ident" id="2182750">data</span><span class="op" id="2182754">[</span><span class="num" id="2182755">0</span>&nbsp;<span class="op" id="2182757">:</span>&nbsp;<span class="builtinfunc" id="2182759">len</span><span class="op" id="2182762">(</span><span class="ident" id="2182763">data</span><span class="op" id="2182767">)</span><span class="op" id="2182768">-</span><span class="num" id="2182769">1</span><span class="op" id="2182770">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2182773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2182776">return</span>&nbsp;<span class="ident" id="2182783">data</span><br>
<span class="lineno"></span><span class="op" id="2182788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2182791">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="2182864">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2182940">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="2183017">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="2183093">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="2183164">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="2183176">func</span>&nbsp;<span class="ident" id="2183181">ScanLines</span><span class="op" id="2183190">(</span><span class="ident" id="2183191">data</span>&nbsp;<span class="op" id="2183196">[</span><span class="op" id="2183197">]</span><span class="builtintype" id="2183198">byte</span><span class="op" id="2183202">,</span>&nbsp;<span class="ident" id="2183204">atEOF</span>&nbsp;<span class="builtintype" id="2183210">bool</span><span class="op" id="2183214">)</span>&nbsp;<span class="op" id="2183216">(</span><span class="ident" id="2183217">advance</span>&nbsp;<span class="builtintype" id="2183225">int</span><span class="op" id="2183228">,</span>&nbsp;<span class="ident" id="2183230">token</span>&nbsp;<span class="op" id="2183236">[</span><span class="op" id="2183237">]</span><span class="builtintype" id="2183238">byte</span><span class="op" id="2183242">,</span>&nbsp;<span class="ident" id="2183244">err</span>&nbsp;<span class="builtintype" id="2183248">error</span><span class="op" id="2183253">)</span>&nbsp;<span class="op" id="2183255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183258">if</span>&nbsp;<span class="ident" id="2183261">atEOF</span>&nbsp;<span class="op" id="2183267">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2183270">len</span><span class="op" id="2183273">(</span><span class="ident" id="2183274">data</span><span class="op" id="2183278">)</span>&nbsp;<span class="op" id="2183280">==</span>&nbsp;<span class="num" id="2183283">0</span>&nbsp;<span class="op" id="2183285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183289">return</span>&nbsp;<span class="num" id="2183296">0</span><span class="op" id="2183297">,</span>&nbsp;<span class="ident" id="2183299">nil</span><span class="op" id="2183302">,</span>&nbsp;<span class="ident" id="2183304">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183312">if</span>&nbsp;<span class="ident" id="2183315">i</span>&nbsp;<span class="op" id="2183317">:=</span>&nbsp;<span class="ident" id="2183320">bytes</span><span class="op" id="2183325">.</span><span class="ident" id="2183326">IndexByte</span><span class="op" id="2183335">(</span><span class="ident" id="2183336">data</span><span class="op" id="2183340">,</span>&nbsp;<span class="string" id="2183342">&#39;\n&#39;</span><span class="op" id="2183346">)</span><span class="op" id="2183347">;</span>&nbsp;<span class="ident" id="2183349">i</span>&nbsp;<span class="op" id="2183351">&gt;=</span>&nbsp;<span class="num" id="2183354">0</span>&nbsp;<span class="op" id="2183356">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183360">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183405">return</span>&nbsp;<span class="ident" id="2183412">i</span>&nbsp;<span class="op" id="2183414">+</span>&nbsp;<span class="num" id="2183416">1</span><span class="op" id="2183417">,</span>&nbsp;<span class="ident" id="2183419">dropCR</span><span class="op" id="2183425">(</span><span class="ident" id="2183426">data</span><span class="op" id="2183430">[</span><span class="num" id="2183431">0</span><span class="op" id="2183432">:</span><span class="ident" id="2183433">i</span><span class="op" id="2183434">]</span><span class="op" id="2183435">)</span><span class="op" id="2183436">,</span>&nbsp;<span class="ident" id="2183438">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183446">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183516">if</span>&nbsp;<span class="ident" id="2183519">atEOF</span>&nbsp;<span class="op" id="2183525">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183529">return</span>&nbsp;<span class="builtinfunc" id="2183536">len</span><span class="op" id="2183539">(</span><span class="ident" id="2183540">data</span><span class="op" id="2183544">)</span><span class="op" id="2183545">,</span>&nbsp;<span class="ident" id="2183547">dropCR</span><span class="op" id="2183553">(</span><span class="ident" id="2183554">data</span><span class="op" id="2183558">)</span><span class="op" id="2183559">,</span>&nbsp;<span class="ident" id="2183561">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2183566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183569">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183592">return</span>&nbsp;<span class="num" id="2183599">0</span><span class="op" id="2183600">,</span>&nbsp;<span class="ident" id="2183602">nil</span><span class="op" id="2183605">,</span>&nbsp;<span class="ident" id="2183607">nil</span><br>
<span class="lineno"></span><span class="op" id="2183611">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="2183614">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="2183691">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2183779">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="2183796">func</span>&nbsp;<span class="ident" id="2183801">isSpace</span><span class="op" id="2183808">(</span><span class="ident" id="2183809">r</span>&nbsp;<span class="builtintype" id="2183811">rune</span><span class="op" id="2183815">)</span>&nbsp;<span class="builtintype" id="2183817">bool</span>&nbsp;<span class="op" id="2183822">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183825">if</span>&nbsp;<span class="ident" id="2183828">r</span>&nbsp;<span class="op" id="2183830">&lt;=</span>&nbsp;<span class="string" id="2183833">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="2183842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2183846">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183924">switch</span>&nbsp;<span class="ident" id="2183931">r</span>&nbsp;<span class="op" id="2183933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183937">case</span>&nbsp;<span class="string" id="2183942">&#39;&nbsp;&#39;</span><span class="op" id="2183945">,</span>&nbsp;<span class="string" id="2183947">&#39;\t&#39;</span><span class="op" id="2183951">,</span>&nbsp;<span class="string" id="2183953">&#39;\n&#39;</span><span class="op" id="2183957">,</span>&nbsp;<span class="string" id="2183959">&#39;\v&#39;</span><span class="op" id="2183963">,</span>&nbsp;<span class="string" id="2183965">&#39;\f&#39;</span><span class="op" id="2183969">,</span>&nbsp;<span class="string" id="2183971">&#39;\r&#39;</span><span class="op" id="2183975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183980">return</span>&nbsp;<span class="builtintype" id="2183987">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2183994">case</span>&nbsp;<span class="string" id="2183999">&#39;\u0085&#39;</span><span class="op" id="2184007">,</span>&nbsp;<span class="string" id="2184009">&#39;\u00A0&#39;</span><span class="op" id="2184017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184022">return</span>&nbsp;<span class="builtintype" id="2184029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184040">return</span>&nbsp;<span class="builtintype" id="2184047">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184054">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184057">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184079">if</span>&nbsp;<span class="string" id="2184082">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="2184091">&lt;=</span>&nbsp;<span class="ident" id="2184094">r</span>&nbsp;<span class="op" id="2184096">&amp;&amp;</span>&nbsp;<span class="ident" id="2184099">r</span>&nbsp;<span class="op" id="2184101">&lt;=</span>&nbsp;<span class="string" id="2184104">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="2184113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184117">return</span>&nbsp;<span class="builtintype" id="2184124">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184133">switch</span>&nbsp;<span class="ident" id="2184140">r</span>&nbsp;<span class="op" id="2184142">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184145">case</span>&nbsp;<span class="string" id="2184150">&#39;\u1680&#39;</span><span class="op" id="2184158">,</span>&nbsp;<span class="string" id="2184160">&#39;\u2028&#39;</span><span class="op" id="2184168">,</span>&nbsp;<span class="string" id="2184170">&#39;\u2029&#39;</span><span class="op" id="2184178">,</span>&nbsp;<span class="string" id="2184180">&#39;\u202f&#39;</span><span class="op" id="2184188">,</span>&nbsp;<span class="string" id="2184190">&#39;\u205f&#39;</span><span class="op" id="2184198">,</span>&nbsp;<span class="string" id="2184200">&#39;\u3000&#39;</span><span class="op" id="2184208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184212">return</span>&nbsp;<span class="builtintype" id="2184219">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184228">return</span>&nbsp;<span class="builtintype" id="2184235">false</span><br>
<span class="lineno"></span><span class="op" id="2184241">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="2184244">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="2184309">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="2184383">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2184450">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="2184470">func</span>&nbsp;<span class="ident" id="2184475">ScanWords</span><span class="op" id="2184484">(</span><span class="ident" id="2184485">data</span>&nbsp;<span class="op" id="2184490">[</span><span class="op" id="2184491">]</span><span class="builtintype" id="2184492">byte</span><span class="op" id="2184496">,</span>&nbsp;<span class="ident" id="2184498">atEOF</span>&nbsp;<span class="builtintype" id="2184504">bool</span><span class="op" id="2184508">)</span>&nbsp;<span class="op" id="2184510">(</span><span class="ident" id="2184511">advance</span>&nbsp;<span class="builtintype" id="2184519">int</span><span class="op" id="2184522">,</span>&nbsp;<span class="ident" id="2184524">token</span>&nbsp;<span class="op" id="2184530">[</span><span class="op" id="2184531">]</span><span class="builtintype" id="2184532">byte</span><span class="op" id="2184536">,</span>&nbsp;<span class="ident" id="2184538">err</span>&nbsp;<span class="builtintype" id="2184542">error</span><span class="op" id="2184547">)</span>&nbsp;<span class="op" id="2184549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184552">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184577">start</span>&nbsp;<span class="op" id="2184583">:=</span>&nbsp;<span class="num" id="2184586">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184589">for</span>&nbsp;<span class="ident" id="2184593">width</span>&nbsp;<span class="op" id="2184599">:=</span>&nbsp;<span class="num" id="2184602">0</span><span class="op" id="2184603">;</span>&nbsp;<span class="ident" id="2184605">start</span>&nbsp;<span class="op" id="2184611">&lt;</span>&nbsp;<span class="builtinfunc" id="2184613">len</span><span class="op" id="2184616">(</span><span class="ident" id="2184617">data</span><span class="op" id="2184621">)</span><span class="op" id="2184622">;</span>&nbsp;<span class="ident" id="2184624">start</span>&nbsp;<span class="op" id="2184630">+=</span>&nbsp;<span class="ident" id="2184633">width</span>&nbsp;<span class="op" id="2184639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184643">var</span>&nbsp;<span class="ident" id="2184647">r</span>&nbsp;<span class="builtintype" id="2184649">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184656">r</span><span class="op" id="2184657">,</span>&nbsp;<span class="ident" id="2184659">width</span>&nbsp;<span class="op" id="2184665">=</span>&nbsp;<span class="ident" id="2184667">utf8</span><span class="op" id="2184671">.</span><span class="ident" id="2184672">DecodeRune</span><span class="op" id="2184682">(</span><span class="ident" id="2184683">data</span><span class="op" id="2184687">[</span><span class="ident" id="2184688">start</span><span class="op" id="2184693">:</span><span class="op" id="2184694">]</span><span class="op" id="2184695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184699">if</span>&nbsp;<span class="op" id="2184702">!</span><span class="ident" id="2184703">isSpace</span><span class="op" id="2184710">(</span><span class="ident" id="2184711">r</span><span class="op" id="2184712">)</span>&nbsp;<span class="op" id="2184714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184719">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184730">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184733">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184776">for</span>&nbsp;<span class="ident" id="2184780">width</span><span class="op" id="2184785">,</span>&nbsp;<span class="ident" id="2184787">i</span>&nbsp;<span class="op" id="2184789">:=</span>&nbsp;<span class="num" id="2184792">0</span><span class="op" id="2184793">,</span>&nbsp;<span class="ident" id="2184795">start</span><span class="op" id="2184800">;</span>&nbsp;<span class="ident" id="2184802">i</span>&nbsp;<span class="op" id="2184804">&lt;</span>&nbsp;<span class="builtinfunc" id="2184806">len</span><span class="op" id="2184809">(</span><span class="ident" id="2184810">data</span><span class="op" id="2184814">)</span><span class="op" id="2184815">;</span>&nbsp;<span class="ident" id="2184817">i</span>&nbsp;<span class="op" id="2184819">+=</span>&nbsp;<span class="ident" id="2184822">width</span>&nbsp;<span class="op" id="2184828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184832">var</span>&nbsp;<span class="ident" id="2184836">r</span>&nbsp;<span class="builtintype" id="2184838">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2184845">r</span><span class="op" id="2184846">,</span>&nbsp;<span class="ident" id="2184848">width</span>&nbsp;<span class="op" id="2184854">=</span>&nbsp;<span class="ident" id="2184856">utf8</span><span class="op" id="2184860">.</span><span class="ident" id="2184861">DecodeRune</span><span class="op" id="2184871">(</span><span class="ident" id="2184872">data</span><span class="op" id="2184876">[</span><span class="ident" id="2184877">i</span><span class="op" id="2184878">:</span><span class="op" id="2184879">]</span><span class="op" id="2184880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184884">if</span>&nbsp;<span class="ident" id="2184887">isSpace</span><span class="op" id="2184894">(</span><span class="ident" id="2184895">r</span><span class="op" id="2184896">)</span>&nbsp;<span class="op" id="2184898">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2184903">return</span>&nbsp;<span class="ident" id="2184910">i</span>&nbsp;<span class="op" id="2184912">+</span>&nbsp;<span class="ident" id="2184914">width</span><span class="op" id="2184919">,</span>&nbsp;<span class="ident" id="2184921">data</span><span class="op" id="2184925">[</span><span class="ident" id="2184926">start</span><span class="op" id="2184931">:</span><span class="ident" id="2184932">i</span><span class="op" id="2184933">]</span><span class="op" id="2184934">,</span>&nbsp;<span class="ident" id="2184936">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2184945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2184948">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185029">if</span>&nbsp;<span class="ident" id="2185032">atEOF</span>&nbsp;<span class="op" id="2185038">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2185041">len</span><span class="op" id="2185044">(</span><span class="ident" id="2185045">data</span><span class="op" id="2185049">)</span>&nbsp;<span class="op" id="2185051">&gt;</span>&nbsp;<span class="ident" id="2185053">start</span>&nbsp;<span class="op" id="2185059">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185063">return</span>&nbsp;<span class="builtinfunc" id="2185070">len</span><span class="op" id="2185073">(</span><span class="ident" id="2185074">data</span><span class="op" id="2185078">)</span><span class="op" id="2185079">,</span>&nbsp;<span class="ident" id="2185081">data</span><span class="op" id="2185085">[</span><span class="ident" id="2185086">start</span><span class="op" id="2185091">:</span><span class="op" id="2185092">]</span><span class="op" id="2185093">,</span>&nbsp;<span class="ident" id="2185095">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2185100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2185103">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2185126">return</span>&nbsp;<span class="ident" id="2185133">start</span><span class="op" id="2185138">,</span>&nbsp;<span class="ident" id="2185140">nil</span><span class="op" id="2185143">,</span>&nbsp;<span class="ident" id="2185145">nil</span><br>
<span class="lineno"></span><span class="op" id="2185149">}</span>
</div>
</body>
</html>
