<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3440986">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3441041">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3441095">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3441146">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3441163">package</span>&nbsp;<span class="ident" id="3441171">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3441176">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3441204">func</span>&nbsp;<span class="ident" id="3441209">hasAsm</span><span class="op" id="3441215">(</span><span class="op" id="3441216">)</span>&nbsp;<span class="builtintype" id="3441218">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3441223">func</span>&nbsp;<span class="ident" id="3441228">encryptBlockAsm</span><span class="op" id="3441243">(</span><span class="ident" id="3441244">nr</span>&nbsp;<span class="builtintype" id="3441247">int</span><span class="op" id="3441250">,</span>&nbsp;<span class="ident" id="3441252">xk</span>&nbsp;<span class="op" id="3441255">*</span><span class="builtintype" id="3441256">uint32</span><span class="op" id="3441262">,</span>&nbsp;<span class="ident" id="3441264">dst</span><span class="op" id="3441267">,</span>&nbsp;<span class="ident" id="3441269">src</span>&nbsp;<span class="op" id="3441273">*</span><span class="builtintype" id="3441274">byte</span><span class="op" id="3441278">)</span><br>
<span class="lineno"></span><span class="keyword" id="3441280">func</span>&nbsp;<span class="ident" id="3441285">decryptBlockAsm</span><span class="op" id="3441300">(</span><span class="ident" id="3441301">nr</span>&nbsp;<span class="builtintype" id="3441304">int</span><span class="op" id="3441307">,</span>&nbsp;<span class="ident" id="3441309">xk</span>&nbsp;<span class="op" id="3441312">*</span><span class="builtintype" id="3441313">uint32</span><span class="op" id="3441319">,</span>&nbsp;<span class="ident" id="3441321">dst</span><span class="op" id="3441324">,</span>&nbsp;<span class="ident" id="3441326">src</span>&nbsp;<span class="op" id="3441330">*</span><span class="builtintype" id="3441331">byte</span><span class="op" id="3441335">)</span><br>
<span class="lineno"></span><span class="keyword" id="3441337">func</span>&nbsp;<span class="ident" id="3441342">expandKeyAsm</span><span class="op" id="3441354">(</span><span class="ident" id="3441355">nr</span>&nbsp;<span class="builtintype" id="3441358">int</span><span class="op" id="3441361">,</span>&nbsp;<span class="ident" id="3441363">key</span>&nbsp;<span class="op" id="3441367">*</span><span class="builtintype" id="3441368">byte</span><span class="op" id="3441372">,</span>&nbsp;<span class="ident" id="3441374">enc</span>&nbsp;<span class="op" id="3441378">*</span><span class="builtintype" id="3441379">uint32</span><span class="op" id="3441385">,</span>&nbsp;<span class="ident" id="3441387">dec</span>&nbsp;<span class="op" id="3441391">*</span><span class="builtintype" id="3441392">uint32</span><span class="op" id="3441398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3441401">var</span>&nbsp;<span class="ident" id="3441405">useAsm</span>&nbsp;<span class="op" id="3441412">=</span>&nbsp;<span class="ident" id="3441414">hasAsm</span><span class="op" id="3441420">(</span><span class="op" id="3441421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3441424">func</span>&nbsp;<span class="ident" id="3441429">encryptBlock</span><span class="op" id="3441441">(</span><span class="ident" id="3441442">xk</span>&nbsp;<span class="op" id="3441445">[</span><span class="op" id="3441446">]</span><span class="builtintype" id="3441447">uint32</span><span class="op" id="3441453">,</span>&nbsp;<span class="ident" id="3441455">dst</span><span class="op" id="3441458">,</span>&nbsp;<span class="ident" id="3441460">src</span>&nbsp;<span class="op" id="3441464">[</span><span class="op" id="3441465">]</span><span class="builtintype" id="3441466">byte</span><span class="op" id="3441470">)</span>&nbsp;<span class="op" id="3441472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441475">if</span>&nbsp;<span class="ident" id="3441478">useAsm</span>&nbsp;<span class="op" id="3441485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441489">encryptBlockAsm</span><span class="op" id="3441504">(</span><span class="builtinfunc" id="3441505">len</span><span class="op" id="3441508">(</span><span class="ident" id="3441509">xk</span><span class="op" id="3441511">)</span><span class="op" id="3441512">/</span><span class="num" id="3441513">4</span><span class="op" id="3441514">-</span><span class="num" id="3441515">1</span><span class="op" id="3441516">,</span>&nbsp;<span class="op" id="3441518">&amp;</span><span class="ident" id="3441519">xk</span><span class="op" id="3441521">[</span><span class="num" id="3441522">0</span><span class="op" id="3441523">]</span><span class="op" id="3441524">,</span>&nbsp;<span class="op" id="3441526">&amp;</span><span class="ident" id="3441527">dst</span><span class="op" id="3441530">[</span><span class="num" id="3441531">0</span><span class="op" id="3441532">]</span><span class="op" id="3441533">,</span>&nbsp;<span class="op" id="3441535">&amp;</span><span class="ident" id="3441536">src</span><span class="op" id="3441539">[</span><span class="num" id="3441540">0</span><span class="op" id="3441541">]</span><span class="op" id="3441542">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441545">}</span>&nbsp;<span class="keyword" id="3441547">else</span>&nbsp;<span class="op" id="3441552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441556">encryptBlockGo</span><span class="op" id="3441570">(</span><span class="ident" id="3441571">xk</span><span class="op" id="3441573">,</span>&nbsp;<span class="ident" id="3441575">dst</span><span class="op" id="3441578">,</span>&nbsp;<span class="ident" id="3441580">src</span><span class="op" id="3441583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441586">}</span><br>
<span class="lineno"></span><span class="op" id="3441588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3441591">func</span>&nbsp;<span class="ident" id="3441596">decryptBlock</span><span class="op" id="3441608">(</span><span class="ident" id="3441609">xk</span>&nbsp;<span class="op" id="3441612">[</span><span class="op" id="3441613">]</span><span class="builtintype" id="3441614">uint32</span><span class="op" id="3441620">,</span>&nbsp;<span class="ident" id="3441622">dst</span><span class="op" id="3441625">,</span>&nbsp;<span class="ident" id="3441627">src</span>&nbsp;<span class="op" id="3441631">[</span><span class="op" id="3441632">]</span><span class="builtintype" id="3441633">byte</span><span class="op" id="3441637">)</span>&nbsp;<span class="op" id="3441639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441642">if</span>&nbsp;<span class="ident" id="3441645">useAsm</span>&nbsp;<span class="op" id="3441652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441656">decryptBlockAsm</span><span class="op" id="3441671">(</span><span class="builtinfunc" id="3441672">len</span><span class="op" id="3441675">(</span><span class="ident" id="3441676">xk</span><span class="op" id="3441678">)</span><span class="op" id="3441679">/</span><span class="num" id="3441680">4</span><span class="op" id="3441681">-</span><span class="num" id="3441682">1</span><span class="op" id="3441683">,</span>&nbsp;<span class="op" id="3441685">&amp;</span><span class="ident" id="3441686">xk</span><span class="op" id="3441688">[</span><span class="num" id="3441689">0</span><span class="op" id="3441690">]</span><span class="op" id="3441691">,</span>&nbsp;<span class="op" id="3441693">&amp;</span><span class="ident" id="3441694">dst</span><span class="op" id="3441697">[</span><span class="num" id="3441698">0</span><span class="op" id="3441699">]</span><span class="op" id="3441700">,</span>&nbsp;<span class="op" id="3441702">&amp;</span><span class="ident" id="3441703">src</span><span class="op" id="3441706">[</span><span class="num" id="3441707">0</span><span class="op" id="3441708">]</span><span class="op" id="3441709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441712">}</span>&nbsp;<span class="keyword" id="3441714">else</span>&nbsp;<span class="op" id="3441719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441723">decryptBlockGo</span><span class="op" id="3441737">(</span><span class="ident" id="3441738">xk</span><span class="op" id="3441740">,</span>&nbsp;<span class="ident" id="3441742">dst</span><span class="op" id="3441745">,</span>&nbsp;<span class="ident" id="3441747">src</span><span class="op" id="3441750">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441753">}</span><br>
<span class="lineno"></span><span class="op" id="3441755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3441758">func</span>&nbsp;<span class="ident" id="3441763">expandKey</span><span class="op" id="3441772">(</span><span class="ident" id="3441773">key</span>&nbsp;<span class="op" id="3441777">[</span><span class="op" id="3441778">]</span><span class="builtintype" id="3441779">byte</span><span class="op" id="3441783">,</span>&nbsp;<span class="ident" id="3441785">enc</span><span class="op" id="3441788">,</span>&nbsp;<span class="ident" id="3441790">dec</span>&nbsp;<span class="op" id="3441794">[</span><span class="op" id="3441795">]</span><span class="builtintype" id="3441796">uint32</span><span class="op" id="3441802">)</span>&nbsp;<span class="op" id="3441804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441807">if</span>&nbsp;<span class="ident" id="3441810">useAsm</span>&nbsp;<span class="op" id="3441817">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441821">rounds</span>&nbsp;<span class="op" id="3441828">:=</span>&nbsp;<span class="num" id="3441831">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441836">switch</span>&nbsp;<span class="builtinfunc" id="3441843">len</span><span class="op" id="3441846">(</span><span class="ident" id="3441847">key</span><span class="op" id="3441850">)</span>&nbsp;<span class="op" id="3441852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441856">case</span>&nbsp;<span class="num" id="3441861">128</span>&nbsp;<span class="op" id="3441865">/</span>&nbsp;<span class="num" id="3441867">8</span><span class="op" id="3441868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441873">rounds</span>&nbsp;<span class="op" id="3441880">=</span>&nbsp;<span class="num" id="3441882">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441887">case</span>&nbsp;<span class="num" id="3441892">192</span>&nbsp;<span class="op" id="3441896">/</span>&nbsp;<span class="num" id="3441898">8</span><span class="op" id="3441899">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441904">rounds</span>&nbsp;<span class="op" id="3441911">=</span>&nbsp;<span class="num" id="3441913">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441918">case</span>&nbsp;<span class="num" id="3441923">256</span>&nbsp;<span class="op" id="3441927">/</span>&nbsp;<span class="num" id="3441929">8</span><span class="op" id="3441930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441935">rounds</span>&nbsp;<span class="op" id="3441942">=</span>&nbsp;<span class="num" id="3441944">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441953">expandKeyAsm</span><span class="op" id="3441965">(</span><span class="ident" id="3441966">rounds</span><span class="op" id="3441972">,</span>&nbsp;<span class="op" id="3441974">&amp;</span><span class="ident" id="3441975">key</span><span class="op" id="3441978">[</span><span class="num" id="3441979">0</span><span class="op" id="3441980">]</span><span class="op" id="3441981">,</span>&nbsp;<span class="op" id="3441983">&amp;</span><span class="ident" id="3441984">enc</span><span class="op" id="3441987">[</span><span class="num" id="3441988">0</span><span class="op" id="3441989">]</span><span class="op" id="3441990">,</span>&nbsp;<span class="op" id="3441992">&amp;</span><span class="ident" id="3441993">dec</span><span class="op" id="3441996">[</span><span class="num" id="3441997">0</span><span class="op" id="3441998">]</span><span class="op" id="3441999">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442002">}</span>&nbsp;<span class="keyword" id="3442004">else</span>&nbsp;<span class="op" id="3442009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442013">expandKeyGo</span><span class="op" id="3442024">(</span><span class="ident" id="3442025">key</span><span class="op" id="3442028">,</span>&nbsp;<span class="ident" id="3442030">enc</span><span class="op" id="3442033">,</span>&nbsp;<span class="ident" id="3442035">dec</span><span class="op" id="3442038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442041">}</span><br>
<span class="lineno"></span><span class="op" id="3442043">}</span>
</div>
</body>
</html>
