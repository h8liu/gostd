<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html" class="current">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5572802">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5572857">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5572911">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5572962">package</span>&nbsp;<span class="ident" id="5572970">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5572977">import</span>&nbsp;<span class="string" id="5572984">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5572992">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5573052">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5573122">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5573180">//</span><br>
<span class="lineno"></span><span class="comment" id="5573183">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5573231">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5573295">//</span><br>
<span class="lineno"></span><span class="comment" id="5573298">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5573359">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5573429">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5573504">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5573571">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5573644">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5573716">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5573730">//</span><br>
<span class="lineno"></span><span class="comment" id="5573733">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5573799">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5573865">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5573878">//</span><br>
<span class="lineno"></span><span class="comment" id="5573881">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5573905">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5573935">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5573963">//</span><br>
<span class="lineno"></span><span class="comment" id="5573966">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5573982">//</span><br>
<span class="lineno">35</span><span class="comment" id="5573985">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5573991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="5574010">//</span><br>
<span class="lineno"></span><span class="comment" id="5574013">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5574021">//</span><br>
<span class="lineno">40</span><span class="comment" id="5574024">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5574058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="5574093">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5574126">//</span><br>
<span class="lineno"></span><span class="comment" id="5574129">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="5574190">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="5574246">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="5574275">//</span><br>
<span class="lineno"></span><span class="comment" id="5574278">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="5574305">//</span><br>
<span class="lineno">50</span><span class="comment" id="5574308">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5574321">//</span><br>
<span class="lineno"></span><span class="comment" id="5574324">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5574364">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5574422">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="5574482">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5574542">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5574603">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5574636">func</span>&nbsp;<span class="ident" id="5574641">Tan</span><span class="op" id="5574644">(</span><span class="ident" id="5574645">x</span>&nbsp;<span class="builtintype" id="5574647">complex128</span><span class="op" id="5574657">)</span>&nbsp;<span class="builtintype" id="5574659">complex128</span>&nbsp;<span class="op" id="5574670">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5574673">d</span>&nbsp;<span class="op" id="5574675">:=</span>&nbsp;<span class="ident" id="5574678"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5574682">.</span><span class="ident" id="5574683"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="5574686">(</span><span class="num" id="5574687">2</span><span class="op" id="5574688">*</span><span class="builtinfunc" id="5574689">real</span><span class="op" id="5574693">(</span><span class="ident" id="5574694"><a href="/gostd/math/cmplx/tan.go.html#5574645">x</a></span><span class="op" id="5574695">)</span><span class="op" id="5574696">)</span>&nbsp;<span class="op" id="5574698">+</span>&nbsp;<span class="ident" id="5574700"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5574704">.</span><span class="ident" id="5574705"><a href="/gostd/math/sinh.go.html#2328213">Cosh</a></span><span class="op" id="5574709">(</span><span class="num" id="5574710">2</span><span class="op" id="5574711">*</span><span class="builtinfunc" id="5574712">imag</span><span class="op" id="5574716">(</span><span class="ident" id="5574717"><a href="/gostd/math/cmplx/tan.go.html#5574645">x</a></span><span class="op" id="5574718">)</span><span class="op" id="5574719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5574722">if</span>&nbsp;<span class="ident" id="5574725"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5574729">.</span><span class="ident" id="5574730"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5574733">(</span><span class="ident" id="5574734"><a href="/gostd/math/cmplx/tan.go.html#5574673">d</a></span><span class="op" id="5574735">)</span>&nbsp;<span class="op" id="5574737">&lt;</span>&nbsp;<span class="num" id="5574739">0.25</span>&nbsp;<span class="op" id="5574744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5574748"><a href="/gostd/math/cmplx/tan.go.html#5574673">d</a></span>&nbsp;<span class="op" id="5574750">=</span>&nbsp;<span class="ident" id="5574752"><a href="/gostd/math/cmplx/tan.go.html#5575911">tanSeries</a></span><span class="op" id="5574761">(</span><span class="ident" id="5574762"><a href="/gostd/math/cmplx/tan.go.html#5574645">x</a></span><span class="op" id="5574763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5574766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5574769">if</span>&nbsp;<span class="ident" id="5574772"><a href="/gostd/math/cmplx/tan.go.html#5574673">d</a></span>&nbsp;<span class="op" id="5574774">==</span>&nbsp;<span class="num" id="5574777">0</span>&nbsp;<span class="op" id="5574779">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5574783">return</span>&nbsp;<span class="ident" id="5574790"><a href="/gostd/math/cmplx/isinf.go.html#5560433">Inf</a></span><span class="op" id="5574793">(</span><span class="op" id="5574794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5574797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5574800">return</span>&nbsp;<span class="builtinfunc" id="5574807">complex</span><span class="op" id="5574814">(</span><span class="ident" id="5574815"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5574819">.</span><span class="ident" id="5574820"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="5574823">(</span><span class="num" id="5574824">2</span><span class="op" id="5574825">*</span><span class="builtinfunc" id="5574826">real</span><span class="op" id="5574830">(</span><span class="ident" id="5574831"><a href="/gostd/math/cmplx/tan.go.html#5574645">x</a></span><span class="op" id="5574832">)</span><span class="op" id="5574833">)</span><span class="op" id="5574834">/</span><span class="ident" id="5574835"><a href="/gostd/math/cmplx/tan.go.html#5574673">d</a></span><span class="op" id="5574836">,</span>&nbsp;<span class="ident" id="5574838"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5574842">.</span><span class="ident" id="5574843"><a href="/gostd/math/sinh.go.html#2327366">Sinh</a></span><span class="op" id="5574847">(</span><span class="num" id="5574848">2</span><span class="op" id="5574849">*</span><span class="builtinfunc" id="5574850">imag</span><span class="op" id="5574854">(</span><span class="ident" id="5574855"><a href="/gostd/math/cmplx/tan.go.html#5574645">x</a></span><span class="op" id="5574856">)</span><span class="op" id="5574857">)</span><span class="op" id="5574858">/</span><span class="ident" id="5574859"><a href="/gostd/math/cmplx/tan.go.html#5574673">d</a></span><span class="op" id="5574860">)</span><br>
<span class="lineno"></span><span class="op" id="5574862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="5574865">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="5574895">//</span><br>
<span class="lineno"></span><span class="comment" id="5574898">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5574914">//</span><br>
<span class="lineno"></span><span class="comment" id="5574917">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="5574975">//</span><br>
<span class="lineno"></span><span class="comment" id="5574978">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5574991">//</span><br>
<span class="lineno"></span><span class="comment" id="5574994">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5575034">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="5575092">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5575153">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="5575198">func</span>&nbsp;<span class="ident" id="5575203">Tanh</span><span class="op" id="5575207">(</span><span class="ident" id="5575208">x</span>&nbsp;<span class="builtintype" id="5575210">complex128</span><span class="op" id="5575220">)</span>&nbsp;<span class="builtintype" id="5575222">complex128</span>&nbsp;<span class="op" id="5575233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575236">d</span>&nbsp;<span class="op" id="5575238">:=</span>&nbsp;<span class="ident" id="5575241"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575245">.</span><span class="ident" id="5575246"><a href="/gostd/math/sinh.go.html#2328213">Cosh</a></span><span class="op" id="5575250">(</span><span class="num" id="5575251">2</span><span class="op" id="5575252">*</span><span class="builtinfunc" id="5575253">real</span><span class="op" id="5575257">(</span><span class="ident" id="5575258"><a href="/gostd/math/cmplx/tan.go.html#5575208">x</a></span><span class="op" id="5575259">)</span><span class="op" id="5575260">)</span>&nbsp;<span class="op" id="5575262">+</span>&nbsp;<span class="ident" id="5575264"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575268">.</span><span class="ident" id="5575269"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="5575272">(</span><span class="num" id="5575273">2</span><span class="op" id="5575274">*</span><span class="builtinfunc" id="5575275">imag</span><span class="op" id="5575279">(</span><span class="ident" id="5575280"><a href="/gostd/math/cmplx/tan.go.html#5575208">x</a></span><span class="op" id="5575281">)</span><span class="op" id="5575282">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575285">if</span>&nbsp;<span class="ident" id="5575288"><a href="/gostd/math/cmplx/tan.go.html#5575236">d</a></span>&nbsp;<span class="op" id="5575290">==</span>&nbsp;<span class="num" id="5575293">0</span>&nbsp;<span class="op" id="5575295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575299">return</span>&nbsp;<span class="ident" id="5575306"><a href="/gostd/math/cmplx/isinf.go.html#5560433">Inf</a></span><span class="op" id="5575309">(</span><span class="op" id="5575310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5575313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575316">return</span>&nbsp;<span class="builtinfunc" id="5575323">complex</span><span class="op" id="5575330">(</span><span class="ident" id="5575331"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575335">.</span><span class="ident" id="5575336"><a href="/gostd/math/sinh.go.html#2327366">Sinh</a></span><span class="op" id="5575340">(</span><span class="num" id="5575341">2</span><span class="op" id="5575342">*</span><span class="builtinfunc" id="5575343">real</span><span class="op" id="5575347">(</span><span class="ident" id="5575348"><a href="/gostd/math/cmplx/tan.go.html#5575208">x</a></span><span class="op" id="5575349">)</span><span class="op" id="5575350">)</span><span class="op" id="5575351">/</span><span class="ident" id="5575352"><a href="/gostd/math/cmplx/tan.go.html#5575236">d</a></span><span class="op" id="5575353">,</span>&nbsp;<span class="ident" id="5575355"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575359">.</span><span class="ident" id="5575360"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="5575363">(</span><span class="num" id="5575364">2</span><span class="op" id="5575365">*</span><span class="builtinfunc" id="5575366">imag</span><span class="op" id="5575370">(</span><span class="ident" id="5575371"><a href="/gostd/math/cmplx/tan.go.html#5575208">x</a></span><span class="op" id="5575372">)</span><span class="op" id="5575373">)</span><span class="op" id="5575374">/</span><span class="ident" id="5575375"><a href="/gostd/math/cmplx/tan.go.html#5575236">d</a></span><span class="op" id="5575376">)</span><br>
<span class="lineno"></span><span class="op" id="5575378">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5575381">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="5575435">func</span>&nbsp;<span class="ident" id="5575440">reducePi</span><span class="op" id="5575448">(</span><span class="ident" id="5575449">x</span>&nbsp;<span class="builtintype" id="5575451">float64</span><span class="op" id="5575458">)</span>&nbsp;<span class="builtintype" id="5575460">float64</span>&nbsp;<span class="op" id="5575468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575471">const</span>&nbsp;<span class="op" id="5575477">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5575481">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575518">DP1</span>&nbsp;<span class="op" id="5575522">=</span>&nbsp;<span class="num" id="5575524">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5575551">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575578">DP2</span>&nbsp;<span class="op" id="5575582">=</span>&nbsp;<span class="num" id="5575584">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="5575611">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575638">DP3</span>&nbsp;<span class="op" id="5575642">=</span>&nbsp;<span class="num" id="5575644">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="5575671">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5575697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575700">t</span>&nbsp;<span class="op" id="5575702">:=</span>&nbsp;<span class="ident" id="5575705"><a href="/gostd/math/cmplx/tan.go.html#5575449">x</a></span>&nbsp;<span class="op" id="5575707">/</span>&nbsp;<span class="ident" id="5575709"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575713">.</span><span class="ident" id="5575714"><a href="/gostd/math/const.go.html#2214581">Pi</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575718">if</span>&nbsp;<span class="ident" id="5575721"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span>&nbsp;<span class="op" id="5575723">&gt;=</span>&nbsp;<span class="num" id="5575726">0</span>&nbsp;<span class="op" id="5575728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575732"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span>&nbsp;<span class="op" id="5575734">+=</span>&nbsp;<span class="num" id="5575737">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5575742">}</span>&nbsp;<span class="keyword" id="5575744">else</span>&nbsp;<span class="op" id="5575749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575753"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span>&nbsp;<span class="op" id="5575755">-=</span>&nbsp;<span class="num" id="5575758">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5575763">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575766"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span>&nbsp;<span class="op" id="5575768">=</span>&nbsp;<span class="builtintype" id="5575770">float64</span><span class="op" id="5575777">(</span><span class="builtintype" id="5575778">int64</span><span class="op" id="5575783">(</span><span class="ident" id="5575784"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span><span class="op" id="5575785">)</span><span class="op" id="5575786">)</span>&nbsp;<span class="comment" id="5575788">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575816">return</span>&nbsp;<span class="op" id="5575823">(</span><span class="op" id="5575824">(</span><span class="ident" id="5575825"><a href="/gostd/math/cmplx/tan.go.html#5575449">x</a></span>&nbsp;<span class="op" id="5575827">-</span>&nbsp;<span class="ident" id="5575829"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span><span class="op" id="5575830">*</span><span class="ident" id="5575831"><a href="/gostd/math/cmplx/tan.go.html#5575518">DP1</a></span><span class="op" id="5575834">)</span>&nbsp;<span class="op" id="5575836">-</span>&nbsp;<span class="ident" id="5575838"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span><span class="op" id="5575839">*</span><span class="ident" id="5575840"><a href="/gostd/math/cmplx/tan.go.html#5575578">DP2</a></span><span class="op" id="5575843">)</span>&nbsp;<span class="op" id="5575845">-</span>&nbsp;<span class="ident" id="5575847"><a href="/gostd/math/cmplx/tan.go.html#5575700">t</a></span><span class="op" id="5575848">*</span><span class="ident" id="5575849"><a href="/gostd/math/cmplx/tan.go.html#5575638">DP3</a></span><br>
<span class="lineno"></span><span class="op" id="5575853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5575856">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="5575906">func</span>&nbsp;<span class="ident" id="5575911">tanSeries</span><span class="op" id="5575920">(</span><span class="ident" id="5575921">z</span>&nbsp;<span class="builtintype" id="5575923">complex128</span><span class="op" id="5575933">)</span>&nbsp;<span class="builtintype" id="5575935">float64</span>&nbsp;<span class="op" id="5575943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575946">const</span>&nbsp;<span class="ident" id="5575952">MACHEP</span>&nbsp;<span class="op" id="5575959">=</span>&nbsp;<span class="num" id="5575961">1.0</span>&nbsp;<span class="op" id="5575965">/</span>&nbsp;<span class="op" id="5575967">(</span><span class="num" id="5575968">1</span>&nbsp;<span class="op" id="5575970">&lt;&lt;</span>&nbsp;<span class="num" id="5575973">53</span><span class="op" id="5575975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5575978">x</span>&nbsp;<span class="op" id="5575980">:=</span>&nbsp;<span class="ident" id="5575983"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5575987">.</span><span class="ident" id="5575988"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5575991">(</span><span class="num" id="5575992">2</span>&nbsp;<span class="op" id="5575994">*</span>&nbsp;<span class="builtinfunc" id="5575996">real</span><span class="op" id="5576000">(</span><span class="ident" id="5576001"><a href="/gostd/math/cmplx/tan.go.html#5575921">z</a></span><span class="op" id="5576002">)</span><span class="op" id="5576003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576006">y</span>&nbsp;<span class="op" id="5576008">:=</span>&nbsp;<span class="ident" id="5576011"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5576015">.</span><span class="ident" id="5576016"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5576019">(</span><span class="num" id="5576020">2</span>&nbsp;<span class="op" id="5576022">*</span>&nbsp;<span class="builtinfunc" id="5576024">imag</span><span class="op" id="5576028">(</span><span class="ident" id="5576029"><a href="/gostd/math/cmplx/tan.go.html#5575921">z</a></span><span class="op" id="5576030">)</span><span class="op" id="5576031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576034"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span>&nbsp;<span class="op" id="5576036">=</span>&nbsp;<span class="ident" id="5576038"><a href="/gostd/math/cmplx/tan.go.html#5575440">reducePi</a></span><span class="op" id="5576046">(</span><span class="ident" id="5576047"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span><span class="op" id="5576048">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576051"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span>&nbsp;<span class="op" id="5576053">=</span>&nbsp;<span class="ident" id="5576055"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span>&nbsp;<span class="op" id="5576057">*</span>&nbsp;<span class="ident" id="5576059"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576062"><a href="/gostd/math/cmplx/tan.go.html#5576006">y</a></span>&nbsp;<span class="op" id="5576064">=</span>&nbsp;<span class="ident" id="5576066"><a href="/gostd/math/cmplx/tan.go.html#5576006">y</a></span>&nbsp;<span class="op" id="5576068">*</span>&nbsp;<span class="ident" id="5576070"><a href="/gostd/math/cmplx/tan.go.html#5576006">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576073">x2</span>&nbsp;<span class="op" id="5576076">:=</span>&nbsp;<span class="num" id="5576079">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576084">y2</span>&nbsp;<span class="op" id="5576087">:=</span>&nbsp;<span class="num" id="5576090">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576095">f</span>&nbsp;<span class="op" id="5576097">:=</span>&nbsp;<span class="num" id="5576100">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576105">rn</span>&nbsp;<span class="op" id="5576108">:=</span>&nbsp;<span class="num" id="5576111">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576116">d</span>&nbsp;<span class="op" id="5576118">:=</span>&nbsp;<span class="num" id="5576121">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5576126">for</span>&nbsp;<span class="op" id="5576130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576134"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span>&nbsp;<span class="op" id="5576137">+=</span>&nbsp;<span class="num" id="5576140">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576144"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span>&nbsp;<span class="op" id="5576146">*=</span>&nbsp;<span class="ident" id="5576149"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576154"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span>&nbsp;<span class="op" id="5576157">+=</span>&nbsp;<span class="num" id="5576160">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576164"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span>&nbsp;<span class="op" id="5576166">*=</span>&nbsp;<span class="ident" id="5576169"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576174"><a href="/gostd/math/cmplx/tan.go.html#5576073">x2</a></span>&nbsp;<span class="op" id="5576177">*=</span>&nbsp;<span class="ident" id="5576180"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576184"><a href="/gostd/math/cmplx/tan.go.html#5576084">y2</a></span>&nbsp;<span class="op" id="5576187">*=</span>&nbsp;<span class="ident" id="5576190"><a href="/gostd/math/cmplx/tan.go.html#5576006">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576194">t</span>&nbsp;<span class="op" id="5576196">:=</span>&nbsp;<span class="ident" id="5576199"><a href="/gostd/math/cmplx/tan.go.html#5576084">y2</a></span>&nbsp;<span class="op" id="5576202">+</span>&nbsp;<span class="ident" id="5576204"><a href="/gostd/math/cmplx/tan.go.html#5576073">x2</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576209"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span>&nbsp;<span class="op" id="5576211">/=</span>&nbsp;<span class="ident" id="5576214"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576218"><a href="/gostd/math/cmplx/tan.go.html#5576116">d</a></span>&nbsp;<span class="op" id="5576220">+=</span>&nbsp;<span class="ident" id="5576223"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576228"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span>&nbsp;<span class="op" id="5576231">+=</span>&nbsp;<span class="num" id="5576234">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576238"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span>&nbsp;<span class="op" id="5576240">*=</span>&nbsp;<span class="ident" id="5576243"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576248"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span>&nbsp;<span class="op" id="5576251">+=</span>&nbsp;<span class="num" id="5576254">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576258"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span>&nbsp;<span class="op" id="5576260">*=</span>&nbsp;<span class="ident" id="5576263"><a href="/gostd/math/cmplx/tan.go.html#5576105">rn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576268"><a href="/gostd/math/cmplx/tan.go.html#5576073">x2</a></span>&nbsp;<span class="op" id="5576271">*=</span>&nbsp;<span class="ident" id="5576274"><a href="/gostd/math/cmplx/tan.go.html#5575978">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576278"><a href="/gostd/math/cmplx/tan.go.html#5576084">y2</a></span>&nbsp;<span class="op" id="5576281">*=</span>&nbsp;<span class="ident" id="5576284"><a href="/gostd/math/cmplx/tan.go.html#5576006">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576288"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span>&nbsp;<span class="op" id="5576290">=</span>&nbsp;<span class="ident" id="5576292"><a href="/gostd/math/cmplx/tan.go.html#5576084">y2</a></span>&nbsp;<span class="op" id="5576295">-</span>&nbsp;<span class="ident" id="5576297"><a href="/gostd/math/cmplx/tan.go.html#5576073">x2</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576302"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span>&nbsp;<span class="op" id="5576304">/=</span>&nbsp;<span class="ident" id="5576307"><a href="/gostd/math/cmplx/tan.go.html#5576095">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5576311"><a href="/gostd/math/cmplx/tan.go.html#5576116">d</a></span>&nbsp;<span class="op" id="5576313">+=</span>&nbsp;<span class="ident" id="5576316"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5576320">if</span>&nbsp;<span class="ident" id="5576323"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5576327">.</span><span class="ident" id="5576328"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5576331">(</span><span class="ident" id="5576332"><a href="/gostd/math/cmplx/tan.go.html#5576194">t</a></span><span class="op" id="5576333">/</span><span class="ident" id="5576334"><a href="/gostd/math/cmplx/tan.go.html#5576116">d</a></span><span class="op" id="5576335">)</span>&nbsp;<span class="op" id="5576337">&lt;=</span>&nbsp;<span class="ident" id="5576340"><a href="/gostd/math/cmplx/tan.go.html#5575952">MACHEP</a></span>&nbsp;<span class="op" id="5576347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5576352">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5576360">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5576363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5576366">return</span>&nbsp;<span class="ident" id="5576373"><a href="/gostd/math/cmplx/tan.go.html#5576116">d</a></span><br>
<span class="lineno"></span><span class="op" id="5576375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5576378">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="5576408">//</span><br>
<span class="lineno"></span><span class="comment" id="5576411">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5576427">//</span><br>
<span class="lineno"></span><span class="comment" id="5576430">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="5576436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="5576455">//</span><br>
<span class="lineno"></span><span class="comment" id="5576458">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5576466">//</span><br>
<span class="lineno"></span><span class="comment" id="5576469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="5576503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="5576538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="5576571">//</span><br>
<span class="lineno"></span><span class="comment" id="5576574">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="5576629">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="5576686">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="5576709">//</span><br>
<span class="lineno"></span><span class="comment" id="5576712">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="5576725">//</span><br>
<span class="lineno"></span><span class="comment" id="5576728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5576768">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="5576826">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="5576886">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="5576946">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5576987">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="5577022">func</span>&nbsp;<span class="ident" id="5577027">Cot</span><span class="op" id="5577030">(</span><span class="ident" id="5577031">x</span>&nbsp;<span class="builtintype" id="5577033">complex128</span><span class="op" id="5577043">)</span>&nbsp;<span class="builtintype" id="5577045">complex128</span>&nbsp;<span class="op" id="5577056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5577059">d</span>&nbsp;<span class="op" id="5577061">:=</span>&nbsp;<span class="ident" id="5577064"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5577068">.</span><span class="ident" id="5577069"><a href="/gostd/math/sinh.go.html#2328213">Cosh</a></span><span class="op" id="5577073">(</span><span class="num" id="5577074">2</span><span class="op" id="5577075">*</span><span class="builtinfunc" id="5577076">imag</span><span class="op" id="5577080">(</span><span class="ident" id="5577081"><a href="/gostd/math/cmplx/tan.go.html#5577031">x</a></span><span class="op" id="5577082">)</span><span class="op" id="5577083">)</span>&nbsp;<span class="op" id="5577085">-</span>&nbsp;<span class="ident" id="5577087"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5577091">.</span><span class="ident" id="5577092"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="5577095">(</span><span class="num" id="5577096">2</span><span class="op" id="5577097">*</span><span class="builtinfunc" id="5577098">real</span><span class="op" id="5577102">(</span><span class="ident" id="5577103"><a href="/gostd/math/cmplx/tan.go.html#5577031">x</a></span><span class="op" id="5577104">)</span><span class="op" id="5577105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5577108">if</span>&nbsp;<span class="ident" id="5577111"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5577115">.</span><span class="ident" id="5577116"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="5577119">(</span><span class="ident" id="5577120"><a href="/gostd/math/cmplx/tan.go.html#5577059">d</a></span><span class="op" id="5577121">)</span>&nbsp;<span class="op" id="5577123">&lt;</span>&nbsp;<span class="num" id="5577125">0.25</span>&nbsp;<span class="op" id="5577130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5577134"><a href="/gostd/math/cmplx/tan.go.html#5577059">d</a></span>&nbsp;<span class="op" id="5577136">=</span>&nbsp;<span class="ident" id="5577138"><a href="/gostd/math/cmplx/tan.go.html#5575911">tanSeries</a></span><span class="op" id="5577147">(</span><span class="ident" id="5577148"><a href="/gostd/math/cmplx/tan.go.html#5577031">x</a></span><span class="op" id="5577149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5577152">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5577155">if</span>&nbsp;<span class="ident" id="5577158"><a href="/gostd/math/cmplx/tan.go.html#5577059">d</a></span>&nbsp;<span class="op" id="5577160">==</span>&nbsp;<span class="num" id="5577163">0</span>&nbsp;<span class="op" id="5577165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5577169">return</span>&nbsp;<span class="ident" id="5577176"><a href="/gostd/math/cmplx/isinf.go.html#5560433">Inf</a></span><span class="op" id="5577179">(</span><span class="op" id="5577180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5577183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5577186">return</span>&nbsp;<span class="builtinfunc" id="5577193">complex</span><span class="op" id="5577200">(</span><span class="ident" id="5577201"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5577205">.</span><span class="ident" id="5577206"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="5577209">(</span><span class="num" id="5577210">2</span><span class="op" id="5577211">*</span><span class="builtinfunc" id="5577212">real</span><span class="op" id="5577216">(</span><span class="ident" id="5577217"><a href="/gostd/math/cmplx/tan.go.html#5577031">x</a></span><span class="op" id="5577218">)</span><span class="op" id="5577219">)</span><span class="op" id="5577220">/</span><span class="ident" id="5577221"><a href="/gostd/math/cmplx/tan.go.html#5577059">d</a></span><span class="op" id="5577222">,</span>&nbsp;<span class="op" id="5577224">-</span><span class="ident" id="5577225"><a href="/gostd/math/cmplx/tan.go.html#5572984">math</a></span><span class="op" id="5577229">.</span><span class="ident" id="5577230"><a href="/gostd/math/sinh.go.html#2327366">Sinh</a></span><span class="op" id="5577234">(</span><span class="num" id="5577235">2</span><span class="op" id="5577236">*</span><span class="builtinfunc" id="5577237">imag</span><span class="op" id="5577241">(</span><span class="ident" id="5577242"><a href="/gostd/math/cmplx/tan.go.html#5577031">x</a></span><span class="op" id="5577243">)</span><span class="op" id="5577244">)</span><span class="op" id="5577245">/</span><span class="ident" id="5577246"><a href="/gostd/math/cmplx/tan.go.html#5577059">d</a></span><span class="op" id="5577247">)</span><br>
<span class="lineno"></span><span class="op" id="5577249">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
