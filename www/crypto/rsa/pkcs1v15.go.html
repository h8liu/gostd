<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4395337">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4395392">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4395446">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4395497">package</span>&nbsp;<span class="ident" id="4395505">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4395510">import</span>&nbsp;<span class="op" id="4395517">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4395520">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4395530">&#34;crypto/subtle&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4395547">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4395557">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4395563">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4395574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4395577">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;encryption&nbsp;and&nbsp;decryption&nbsp;using&nbsp;PKCS#1&nbsp;v1.5&nbsp;padding.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4395655">//&nbsp;EncryptPKCS1v15&nbsp;encrypts&nbsp;the&nbsp;given&nbsp;message&nbsp;with&nbsp;RSA&nbsp;and&nbsp;the&nbsp;padding&nbsp;scheme&nbsp;from&nbsp;PKCS#1&nbsp;v1.5.</span><br>
<span class="lineno"></span><span class="comment" id="4395751">//&nbsp;The&nbsp;message&nbsp;must&nbsp;be&nbsp;no&nbsp;longer&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;public&nbsp;modulus&nbsp;minus&nbsp;11&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4395838">//&nbsp;WARNING:&nbsp;use&nbsp;of&nbsp;this&nbsp;function&nbsp;to&nbsp;encrypt&nbsp;plaintexts&nbsp;other&nbsp;than&nbsp;session&nbsp;keys</span><br>
<span class="lineno">20</span><span class="comment" id="4395917">//&nbsp;is&nbsp;dangerous.&nbsp;Use&nbsp;RSA&nbsp;OAEP&nbsp;in&nbsp;new&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="keyword" id="4395965">func</span>&nbsp;<span class="ident" id="4395970">EncryptPKCS1v15</span><span class="op" id="4395985">(</span><span class="ident" id="4395986">rand</span>&nbsp;<span class="ident" id="4395991"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4395993">.</span><span class="ident" id="4395994">Reader</span><span class="op" id="4396000">,</span>&nbsp;<span class="ident" id="4396002">pub</span>&nbsp;<span class="op" id="4396006">*</span><span class="ident" id="4396007"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><span class="op" id="4396016">,</span>&nbsp;<span class="ident" id="4396018">msg</span>&nbsp;<span class="op" id="4396022">[</span><span class="op" id="4396023">]</span><span class="builtintype" id="4396024">byte</span><span class="op" id="4396028">)</span>&nbsp;<span class="op" id="4396030">(</span><span class="ident" id="4396031">out</span>&nbsp;<span class="op" id="4396035">[</span><span class="op" id="4396036">]</span><span class="builtintype" id="4396037">byte</span><span class="op" id="4396041">,</span>&nbsp;<span class="ident" id="4396043">err</span>&nbsp;<span class="builtintype" id="4396047">error</span><span class="op" id="4396052">)</span>&nbsp;<span class="op" id="4396054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396057">if</span>&nbsp;<span class="ident" id="4396060">err</span>&nbsp;<span class="op" id="4396064">:=</span>&nbsp;<span class="ident" id="4396067"><a href="/crypto/rsa/rsa.go.html#4414536">checkPub</a></span><span class="op" id="4396075">(</span><span class="ident" id="4396076"><a href="/crypto/rsa/pkcs1v15.go.html#4396002">pub</a></span><span class="op" id="4396079">)</span><span class="op" id="4396080">;</span>&nbsp;<span class="ident" id="4396082"><a href="/crypto/rsa/pkcs1v15.go.html#4396060">err</a></span>&nbsp;<span class="op" id="4396086">!=</span>&nbsp;<span class="ident" id="4396089">nil</span>&nbsp;<span class="op" id="4396093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396097">return</span>&nbsp;<span class="ident" id="4396104">nil</span><span class="op" id="4396107">,</span>&nbsp;<span class="ident" id="4396109"><a href="/crypto/rsa/pkcs1v15.go.html#4396060">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396114">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396117">k</span>&nbsp;<span class="op" id="4396119">:=</span>&nbsp;<span class="op" id="4396122">(</span><span class="ident" id="4396123"><a href="/crypto/rsa/pkcs1v15.go.html#4396002">pub</a></span><span class="op" id="4396126">.</span><span class="ident" id="4396127">N</span><span class="op" id="4396128">.</span><span class="ident" id="4396129">BitLen</span><span class="op" id="4396135">(</span><span class="op" id="4396136">)</span>&nbsp;<span class="op" id="4396138">+</span>&nbsp;<span class="num" id="4396140">7</span><span class="op" id="4396141">)</span>&nbsp;<span class="op" id="4396143">/</span>&nbsp;<span class="num" id="4396145">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396148">if</span>&nbsp;<span class="builtinfunc" id="4396151">len</span><span class="op" id="4396154">(</span><span class="ident" id="4396155"><a href="/crypto/rsa/pkcs1v15.go.html#4396018">msg</a></span><span class="op" id="4396158">)</span>&nbsp;<span class="op" id="4396160">&gt;</span>&nbsp;<span class="ident" id="4396162"><a href="/crypto/rsa/pkcs1v15.go.html#4396117">k</a></span><span class="op" id="4396163">-</span><span class="num" id="4396164">11</span>&nbsp;<span class="op" id="4396167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396171"><a href="/crypto/rsa/pkcs1v15.go.html#4396043">err</a></span>&nbsp;<span class="op" id="4396175">=</span>&nbsp;<span class="ident" id="4396177"><a href="/crypto/rsa/rsa.go.html#4421567">ErrMessageTooLong</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396197">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396205">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4396209">//&nbsp;EM&nbsp;=&nbsp;0x00&nbsp;||&nbsp;0x02&nbsp;||&nbsp;PS&nbsp;||&nbsp;0x00&nbsp;||&nbsp;M</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396250">em</span>&nbsp;<span class="op" id="4396253">:=</span>&nbsp;<span class="builtinfunc" id="4396256">make</span><span class="op" id="4396260">(</span><span class="op" id="4396261">[</span><span class="op" id="4396262">]</span><span class="builtintype" id="4396263">byte</span><span class="op" id="4396267">,</span>&nbsp;<span class="ident" id="4396269"><a href="/crypto/rsa/pkcs1v15.go.html#4396117">k</a></span><span class="op" id="4396270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396273"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396275">[</span><span class="num" id="4396276">1</span><span class="op" id="4396277">]</span>&nbsp;<span class="op" id="4396279">=</span>&nbsp;<span class="num" id="4396281">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396284">ps</span><span class="op" id="4396286">,</span>&nbsp;<span class="ident" id="4396288">mm</span>&nbsp;<span class="op" id="4396291">:=</span>&nbsp;<span class="ident" id="4396294"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396296">[</span><span class="num" id="4396297">2</span><span class="op" id="4396298">:</span><span class="builtinfunc" id="4396299">len</span><span class="op" id="4396302">(</span><span class="ident" id="4396303"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396305">)</span><span class="op" id="4396306">-</span><span class="builtinfunc" id="4396307">len</span><span class="op" id="4396310">(</span><span class="ident" id="4396311"><a href="/crypto/rsa/pkcs1v15.go.html#4396018">msg</a></span><span class="op" id="4396314">)</span><span class="op" id="4396315">-</span><span class="num" id="4396316">1</span><span class="op" id="4396317">]</span><span class="op" id="4396318">,</span>&nbsp;<span class="ident" id="4396320"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396322">[</span><span class="builtinfunc" id="4396323">len</span><span class="op" id="4396326">(</span><span class="ident" id="4396327"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396329">)</span><span class="op" id="4396330">-</span><span class="builtinfunc" id="4396331">len</span><span class="op" id="4396334">(</span><span class="ident" id="4396335"><a href="/crypto/rsa/pkcs1v15.go.html#4396018">msg</a></span><span class="op" id="4396338">)</span><span class="op" id="4396339">:</span><span class="op" id="4396340">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396343"><a href="/crypto/rsa/pkcs1v15.go.html#4396043">err</a></span>&nbsp;<span class="op" id="4396347">=</span>&nbsp;<span class="ident" id="4396349"><a href="/crypto/rsa/pkcs1v15.go.html#4400407">nonZeroRandomBytes</a></span><span class="op" id="4396367">(</span><span class="ident" id="4396368"><a href="/crypto/rsa/pkcs1v15.go.html#4396284">ps</a></span><span class="op" id="4396370">,</span>&nbsp;<span class="ident" id="4396372"><a href="/crypto/rsa/pkcs1v15.go.html#4395986">rand</a></span><span class="op" id="4396376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396379">if</span>&nbsp;<span class="ident" id="4396382"><a href="/crypto/rsa/pkcs1v15.go.html#4396043">err</a></span>&nbsp;<span class="op" id="4396386">!=</span>&nbsp;<span class="ident" id="4396389">nil</span>&nbsp;<span class="op" id="4396393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396397">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396408"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396410">[</span><span class="builtinfunc" id="4396411">len</span><span class="op" id="4396414">(</span><span class="ident" id="4396415"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396417">)</span><span class="op" id="4396418">-</span><span class="builtinfunc" id="4396419">len</span><span class="op" id="4396422">(</span><span class="ident" id="4396423"><a href="/crypto/rsa/pkcs1v15.go.html#4396018">msg</a></span><span class="op" id="4396426">)</span><span class="op" id="4396427">-</span><span class="num" id="4396428">1</span><span class="op" id="4396429">]</span>&nbsp;<span class="op" id="4396431">=</span>&nbsp;<span class="num" id="4396433">0</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4396436">copy</span><span class="op" id="4396440">(</span><span class="ident" id="4396441"><a href="/crypto/rsa/pkcs1v15.go.html#4396288">mm</a></span><span class="op" id="4396443">,</span>&nbsp;<span class="ident" id="4396445"><a href="/crypto/rsa/pkcs1v15.go.html#4396018">msg</a></span><span class="op" id="4396448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396452">m</span>&nbsp;<span class="op" id="4396454">:=</span>&nbsp;<span class="builtinfunc" id="4396457">new</span><span class="op" id="4396460">(</span><span class="ident" id="4396461"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4396464">.</span><span class="ident" id="4396465">Int</span><span class="op" id="4396468">)</span><span class="op" id="4396469">.</span><span class="ident" id="4396470">SetBytes</span><span class="op" id="4396478">(</span><span class="ident" id="4396479"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396484">c</span>&nbsp;<span class="op" id="4396486">:=</span>&nbsp;<span class="ident" id="4396489"><a href="/crypto/rsa/rsa.go.html#4421660">encrypt</a></span><span class="op" id="4396496">(</span><span class="builtinfunc" id="4396497">new</span><span class="op" id="4396500">(</span><span class="ident" id="4396501"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4396504">.</span><span class="ident" id="4396505">Int</span><span class="op" id="4396508">)</span><span class="op" id="4396509">,</span>&nbsp;<span class="ident" id="4396511"><a href="/crypto/rsa/pkcs1v15.go.html#4396002">pub</a></span><span class="op" id="4396514">,</span>&nbsp;<span class="ident" id="4396516"><a href="/crypto/rsa/pkcs1v15.go.html#4396452">m</a></span><span class="op" id="4396517">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396521"><a href="/crypto/rsa/pkcs1v15.go.html#4404804">copyWithLeftPad</a></span><span class="op" id="4396536">(</span><span class="ident" id="4396537"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><span class="op" id="4396539">,</span>&nbsp;<span class="ident" id="4396541"><a href="/crypto/rsa/pkcs1v15.go.html#4396484">c</a></span><span class="op" id="4396542">.</span><span class="ident" id="4396543">Bytes</span><span class="op" id="4396548">(</span><span class="op" id="4396549">)</span><span class="op" id="4396550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396553"><a href="/crypto/rsa/pkcs1v15.go.html#4396031">out</a></span>&nbsp;<span class="op" id="4396557">=</span>&nbsp;<span class="ident" id="4396559"><a href="/crypto/rsa/pkcs1v15.go.html#4396250">em</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396563">return</span><br>
<span class="lineno"></span><span class="op" id="4396570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4396573">//&nbsp;DecryptPKCS1v15&nbsp;decrypts&nbsp;a&nbsp;plaintext&nbsp;using&nbsp;RSA&nbsp;and&nbsp;the&nbsp;padding&nbsp;scheme&nbsp;from&nbsp;PKCS#1&nbsp;v1.5.</span><br>
<span class="lineno"></span><span class="comment" id="4396664">//&nbsp;If&nbsp;rand&nbsp;!=&nbsp;nil,&nbsp;it&nbsp;uses&nbsp;RSA&nbsp;blinding&nbsp;to&nbsp;avoid&nbsp;timing&nbsp;side-channel&nbsp;attacks.</span><br>
<span class="lineno"></span><span class="keyword" id="4396742">func</span>&nbsp;<span class="ident" id="4396747">DecryptPKCS1v15</span><span class="op" id="4396762">(</span><span class="ident" id="4396763">rand</span>&nbsp;<span class="ident" id="4396768"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4396770">.</span><span class="ident" id="4396771">Reader</span><span class="op" id="4396777">,</span>&nbsp;<span class="ident" id="4396779">priv</span>&nbsp;<span class="op" id="4396784">*</span><span class="ident" id="4396785"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4396795">,</span>&nbsp;<span class="ident" id="4396797">ciphertext</span>&nbsp;<span class="op" id="4396808">[</span><span class="op" id="4396809">]</span><span class="builtintype" id="4396810">byte</span><span class="op" id="4396814">)</span>&nbsp;<span class="op" id="4396816">(</span><span class="ident" id="4396817">out</span>&nbsp;<span class="op" id="4396821">[</span><span class="op" id="4396822">]</span><span class="builtintype" id="4396823">byte</span><span class="op" id="4396827">,</span>&nbsp;<span class="ident" id="4396829">err</span>&nbsp;<span class="builtintype" id="4396833">error</span><span class="op" id="4396838">)</span>&nbsp;<span class="op" id="4396840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396843">if</span>&nbsp;<span class="ident" id="4396846">err</span>&nbsp;<span class="op" id="4396850">:=</span>&nbsp;<span class="ident" id="4396853"><a href="/crypto/rsa/rsa.go.html#4414536">checkPub</a></span><span class="op" id="4396861">(</span><span class="op" id="4396862">&amp;</span><span class="ident" id="4396863"><a href="/crypto/rsa/pkcs1v15.go.html#4396779">priv</a></span><span class="op" id="4396867">.</span><span class="ident" id="4396868">PublicKey</span><span class="op" id="4396877">)</span><span class="op" id="4396878">;</span>&nbsp;<span class="ident" id="4396880"><a href="/crypto/rsa/pkcs1v15.go.html#4396846">err</a></span>&nbsp;<span class="op" id="4396884">!=</span>&nbsp;<span class="ident" id="4396887">nil</span>&nbsp;<span class="op" id="4396891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396895">return</span>&nbsp;<span class="ident" id="4396902">nil</span><span class="op" id="4396905">,</span>&nbsp;<span class="ident" id="4396907"><a href="/crypto/rsa/pkcs1v15.go.html#4396846">err</a></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4396912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4396915">valid</span><span class="op" id="4396920">,</span>&nbsp;<span class="ident" id="4396922"><a href="/crypto/rsa/pkcs1v15.go.html#4396817">out</a></span><span class="op" id="4396925">,</span>&nbsp;<span class="ident" id="4396927">index</span><span class="op" id="4396932">,</span>&nbsp;<span class="ident" id="4396934"><a href="/crypto/rsa/pkcs1v15.go.html#4396829">err</a></span>&nbsp;<span class="op" id="4396938">:=</span>&nbsp;<span class="ident" id="4396941"><a href="/crypto/rsa/pkcs1v15.go.html#4399092">decryptPKCS1v15</a></span><span class="op" id="4396956">(</span><span class="ident" id="4396957"><a href="/crypto/rsa/pkcs1v15.go.html#4396763">rand</a></span><span class="op" id="4396961">,</span>&nbsp;<span class="ident" id="4396963"><a href="/crypto/rsa/pkcs1v15.go.html#4396779">priv</a></span><span class="op" id="4396967">,</span>&nbsp;<span class="ident" id="4396969"><a href="/crypto/rsa/pkcs1v15.go.html#4396797">ciphertext</a></span><span class="op" id="4396979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4396982">if</span>&nbsp;<span class="ident" id="4396985"><a href="/crypto/rsa/pkcs1v15.go.html#4396829">err</a></span>&nbsp;<span class="op" id="4396989">!=</span>&nbsp;<span class="ident" id="4396992">nil</span>&nbsp;<span class="op" id="4396996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397000">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397008">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397011">if</span>&nbsp;<span class="ident" id="4397014"><a href="/crypto/rsa/pkcs1v15.go.html#4396915">valid</a></span>&nbsp;<span class="op" id="4397020">==</span>&nbsp;<span class="num" id="4397023">0</span>&nbsp;<span class="op" id="4397025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397029">return</span>&nbsp;<span class="ident" id="4397036">nil</span><span class="op" id="4397039">,</span>&nbsp;<span class="ident" id="4397041"><a href="/crypto/rsa/rsa.go.html#4422966">ErrDecryption</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4397056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4397059"><a href="/crypto/rsa/pkcs1v15.go.html#4396817">out</a></span>&nbsp;<span class="op" id="4397063">=</span>&nbsp;<span class="ident" id="4397065"><a href="/crypto/rsa/pkcs1v15.go.html#4396817">out</a></span><span class="op" id="4397068">[</span><span class="ident" id="4397069"><a href="/crypto/rsa/pkcs1v15.go.html#4396927">index</a></span><span class="op" id="4397074">:</span><span class="op" id="4397075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4397078">return</span><br>
<span class="lineno">65</span><span class="op" id="4397085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4397088">//&nbsp;DecryptPKCS1v15SessionKey&nbsp;decrypts&nbsp;a&nbsp;session&nbsp;key&nbsp;using&nbsp;RSA&nbsp;and&nbsp;the&nbsp;padding&nbsp;scheme&nbsp;from&nbsp;PKCS#1&nbsp;v1.5.</span><br>
<span class="lineno"></span><span class="comment" id="4397191">//&nbsp;If&nbsp;rand&nbsp;!=&nbsp;nil,&nbsp;it&nbsp;uses&nbsp;RSA&nbsp;blinding&nbsp;to&nbsp;avoid&nbsp;timing&nbsp;side-channel&nbsp;attacks.</span><br>
<span class="lineno"></span><span class="comment" id="4397269">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;the&nbsp;ciphertext&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="4397340">//&nbsp;ciphertext&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;public&nbsp;modulus.&nbsp;Otherwise,&nbsp;no&nbsp;error&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4397413">//&nbsp;returned.&nbsp;If&nbsp;the&nbsp;padding&nbsp;is&nbsp;valid,&nbsp;the&nbsp;resulting&nbsp;plaintext&nbsp;message&nbsp;is&nbsp;copied</span><br>
<span class="lineno"></span><span class="comment" id="4397493">//&nbsp;into&nbsp;key.&nbsp;Otherwise,&nbsp;key&nbsp;is&nbsp;unchanged.&nbsp;These&nbsp;alternatives&nbsp;occur&nbsp;in&nbsp;constant</span><br>
<span class="lineno"></span><span class="comment" id="4397572">//&nbsp;time.&nbsp;It&nbsp;is&nbsp;intended&nbsp;that&nbsp;the&nbsp;user&nbsp;of&nbsp;this&nbsp;function&nbsp;generate&nbsp;a&nbsp;random</span><br>
<span class="lineno"></span><span class="comment" id="4397645">//&nbsp;session&nbsp;key&nbsp;beforehand&nbsp;and&nbsp;continue&nbsp;the&nbsp;protocol&nbsp;with&nbsp;the&nbsp;resulting&nbsp;value.</span><br>
<span class="lineno">75</span><span class="comment" id="4397723">//&nbsp;This&nbsp;will&nbsp;remove&nbsp;any&nbsp;possibility&nbsp;that&nbsp;an&nbsp;attacker&nbsp;can&nbsp;learn&nbsp;any&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="4397802">//&nbsp;about&nbsp;the&nbsp;plaintext.</span><br>
<span class="lineno"></span><span class="comment" id="4397826">//&nbsp;See&nbsp;``Chosen&nbsp;Ciphertext&nbsp;Attacks&nbsp;Against&nbsp;Protocols&nbsp;Based&nbsp;on&nbsp;the&nbsp;RSA</span><br>
<span class="lineno"></span><span class="comment" id="4397896">//&nbsp;Encryption&nbsp;Standard&nbsp;PKCS&nbsp;#1&#39;&#39;,&nbsp;Daniel&nbsp;Bleichenbacher,&nbsp;Advances&nbsp;in&nbsp;Cryptology</span><br>
<span class="lineno"></span><span class="comment" id="4397976">//&nbsp;(Crypto&nbsp;&#39;98).</span><br>
<span class="lineno">80</span><span class="keyword" id="4397993">func</span>&nbsp;<span class="ident" id="4397998">DecryptPKCS1v15SessionKey</span><span class="op" id="4398023">(</span><span class="ident" id="4398024">rand</span>&nbsp;<span class="ident" id="4398029"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4398031">.</span><span class="ident" id="4398032">Reader</span><span class="op" id="4398038">,</span>&nbsp;<span class="ident" id="4398040">priv</span>&nbsp;<span class="op" id="4398045">*</span><span class="ident" id="4398046"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4398056">,</span>&nbsp;<span class="ident" id="4398058">ciphertext</span>&nbsp;<span class="op" id="4398069">[</span><span class="op" id="4398070">]</span><span class="builtintype" id="4398071">byte</span><span class="op" id="4398075">,</span>&nbsp;<span class="ident" id="4398077">key</span>&nbsp;<span class="op" id="4398081">[</span><span class="op" id="4398082">]</span><span class="builtintype" id="4398083">byte</span><span class="op" id="4398087">)</span>&nbsp;<span class="op" id="4398089">(</span><span class="ident" id="4398090">err</span>&nbsp;<span class="builtintype" id="4398094">error</span><span class="op" id="4398099">)</span>&nbsp;<span class="op" id="4398101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398104">if</span>&nbsp;<span class="ident" id="4398107">err</span>&nbsp;<span class="op" id="4398111">:=</span>&nbsp;<span class="ident" id="4398114"><a href="/crypto/rsa/rsa.go.html#4414536">checkPub</a></span><span class="op" id="4398122">(</span><span class="op" id="4398123">&amp;</span><span class="ident" id="4398124"><a href="/crypto/rsa/pkcs1v15.go.html#4398040">priv</a></span><span class="op" id="4398128">.</span><span class="ident" id="4398129">PublicKey</span><span class="op" id="4398138">)</span><span class="op" id="4398139">;</span>&nbsp;<span class="ident" id="4398141"><a href="/crypto/rsa/pkcs1v15.go.html#4398107">err</a></span>&nbsp;<span class="op" id="4398145">!=</span>&nbsp;<span class="ident" id="4398148">nil</span>&nbsp;<span class="op" id="4398152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398156">return</span>&nbsp;<span class="ident" id="4398163"><a href="/crypto/rsa/pkcs1v15.go.html#4398107">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398171">k</span>&nbsp;<span class="op" id="4398173">:=</span>&nbsp;<span class="op" id="4398176">(</span><span class="ident" id="4398177"><a href="/crypto/rsa/pkcs1v15.go.html#4398040">priv</a></span><span class="op" id="4398181">.</span><span class="ident" id="4398182">N</span><span class="op" id="4398183">.</span><span class="ident" id="4398184">BitLen</span><span class="op" id="4398190">(</span><span class="op" id="4398191">)</span>&nbsp;<span class="op" id="4398193">+</span>&nbsp;<span class="num" id="4398195">7</span><span class="op" id="4398196">)</span>&nbsp;<span class="op" id="4398198">/</span>&nbsp;<span class="num" id="4398200">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398203">if</span>&nbsp;<span class="ident" id="4398206"><a href="/crypto/rsa/pkcs1v15.go.html#4398171">k</a></span><span class="op" id="4398207">-</span><span class="op" id="4398208">(</span><span class="builtinfunc" id="4398209">len</span><span class="op" id="4398212">(</span><span class="ident" id="4398213"><a href="/crypto/rsa/pkcs1v15.go.html#4398077">key</a></span><span class="op" id="4398216">)</span><span class="op" id="4398217">+</span><span class="num" id="4398218">3</span><span class="op" id="4398219">+</span><span class="num" id="4398220">8</span><span class="op" id="4398221">)</span>&nbsp;<span class="op" id="4398223">&lt;</span>&nbsp;<span class="num" id="4398225">0</span>&nbsp;<span class="op" id="4398227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398231">return</span>&nbsp;<span class="ident" id="4398238"><a href="/crypto/rsa/rsa.go.html#4422966">ErrDecryption</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398257">valid</span><span class="op" id="4398262">,</span>&nbsp;<span class="ident" id="4398264">em</span><span class="op" id="4398266">,</span>&nbsp;<span class="ident" id="4398268">index</span><span class="op" id="4398273">,</span>&nbsp;<span class="ident" id="4398275"><a href="/crypto/rsa/pkcs1v15.go.html#4398090">err</a></span>&nbsp;<span class="op" id="4398279">:=</span>&nbsp;<span class="ident" id="4398282"><a href="/crypto/rsa/pkcs1v15.go.html#4399092">decryptPKCS1v15</a></span><span class="op" id="4398297">(</span><span class="ident" id="4398298"><a href="/crypto/rsa/pkcs1v15.go.html#4398024">rand</a></span><span class="op" id="4398302">,</span>&nbsp;<span class="ident" id="4398304"><a href="/crypto/rsa/pkcs1v15.go.html#4398040">priv</a></span><span class="op" id="4398308">,</span>&nbsp;<span class="ident" id="4398310"><a href="/crypto/rsa/pkcs1v15.go.html#4398058">ciphertext</a></span><span class="op" id="4398320">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398323">if</span>&nbsp;<span class="ident" id="4398326"><a href="/crypto/rsa/pkcs1v15.go.html#4398090">err</a></span>&nbsp;<span class="op" id="4398330">!=</span>&nbsp;<span class="ident" id="4398333">nil</span>&nbsp;<span class="op" id="4398337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398341">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398353">if</span>&nbsp;<span class="builtinfunc" id="4398356">len</span><span class="op" id="4398359">(</span><span class="ident" id="4398360"><a href="/crypto/rsa/pkcs1v15.go.html#4398264">em</a></span><span class="op" id="4398362">)</span>&nbsp;<span class="op" id="4398364">!=</span>&nbsp;<span class="ident" id="4398367"><a href="/crypto/rsa/pkcs1v15.go.html#4398171">k</a></span>&nbsp;<span class="op" id="4398369">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398373">//&nbsp;This&nbsp;should&nbsp;be&nbsp;impossible&nbsp;because&nbsp;decryptPKCS1v15&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4398435">//&nbsp;returns&nbsp;the&nbsp;full&nbsp;slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398464">return</span>&nbsp;<span class="ident" id="4398471"><a href="/crypto/rsa/rsa.go.html#4422966">ErrDecryption</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4398486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398490"><a href="/crypto/rsa/pkcs1v15.go.html#4398257">valid</a></span>&nbsp;<span class="op" id="4398496">&amp;=</span>&nbsp;<span class="ident" id="4398499"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4398505">.</span><span class="ident" id="4398506">ConstantTimeEq</span><span class="op" id="4398520">(</span><span class="builtintype" id="4398521">int32</span><span class="op" id="4398526">(</span><span class="builtinfunc" id="4398527">len</span><span class="op" id="4398530">(</span><span class="ident" id="4398531"><a href="/crypto/rsa/pkcs1v15.go.html#4398264">em</a></span><span class="op" id="4398533">)</span><span class="op" id="4398534">-</span><span class="ident" id="4398535"><a href="/crypto/rsa/pkcs1v15.go.html#4398268">index</a></span><span class="op" id="4398540">)</span><span class="op" id="4398541">,</span>&nbsp;<span class="builtintype" id="4398543">int32</span><span class="op" id="4398548">(</span><span class="builtinfunc" id="4398549">len</span><span class="op" id="4398552">(</span><span class="ident" id="4398553"><a href="/crypto/rsa/pkcs1v15.go.html#4398077">key</a></span><span class="op" id="4398556">)</span><span class="op" id="4398557">)</span><span class="op" id="4398558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4398561"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4398567">.</span><span class="ident" id="4398568">ConstantTimeCopy</span><span class="op" id="4398584">(</span><span class="ident" id="4398585"><a href="/crypto/rsa/pkcs1v15.go.html#4398257">valid</a></span><span class="op" id="4398590">,</span>&nbsp;<span class="ident" id="4398592"><a href="/crypto/rsa/pkcs1v15.go.html#4398077">key</a></span><span class="op" id="4398595">,</span>&nbsp;<span class="ident" id="4398597"><a href="/crypto/rsa/pkcs1v15.go.html#4398264">em</a></span><span class="op" id="4398599">[</span><span class="builtinfunc" id="4398600">len</span><span class="op" id="4398603">(</span><span class="ident" id="4398604"><a href="/crypto/rsa/pkcs1v15.go.html#4398264">em</a></span><span class="op" id="4398606">)</span><span class="op" id="4398607">-</span><span class="builtinfunc" id="4398608">len</span><span class="op" id="4398611">(</span><span class="ident" id="4398612"><a href="/crypto/rsa/pkcs1v15.go.html#4398077">key</a></span><span class="op" id="4398615">)</span><span class="op" id="4398616">:</span><span class="op" id="4398617">]</span><span class="op" id="4398618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4398621">return</span><br>
<span class="lineno"></span><span class="op" id="4398628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="4398631">//&nbsp;decryptPKCS1v15&nbsp;decrypts&nbsp;ciphertext&nbsp;using&nbsp;priv&nbsp;and&nbsp;blinds&nbsp;the&nbsp;operation&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4398709">//&nbsp;rand&nbsp;is&nbsp;not&nbsp;nil.&nbsp;It&nbsp;returns&nbsp;one&nbsp;or&nbsp;zero&nbsp;in&nbsp;valid&nbsp;that&nbsp;indicates&nbsp;whether&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4398788">//&nbsp;plaintext&nbsp;was&nbsp;correctly&nbsp;structured.&nbsp;In&nbsp;either&nbsp;case,&nbsp;the&nbsp;plaintext&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4398860">//&nbsp;returned&nbsp;in&nbsp;em&nbsp;so&nbsp;that&nbsp;it&nbsp;may&nbsp;be&nbsp;read&nbsp;independently&nbsp;of&nbsp;whether&nbsp;it&nbsp;was&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4398939">//&nbsp;in&nbsp;order&nbsp;to&nbsp;maintain&nbsp;constant&nbsp;memory&nbsp;access&nbsp;patterns.&nbsp;If&nbsp;the&nbsp;plaintext&nbsp;was</span><br>
<span class="lineno">110</span><span class="comment" id="4399017">//&nbsp;valid&nbsp;then&nbsp;index&nbsp;contains&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;original&nbsp;message&nbsp;in&nbsp;em.</span><br>
<span class="lineno"></span><span class="keyword" id="4399087">func</span>&nbsp;<span class="ident" id="4399092">decryptPKCS1v15</span><span class="op" id="4399107">(</span><span class="ident" id="4399108">rand</span>&nbsp;<span class="ident" id="4399113"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4399115">.</span><span class="ident" id="4399116">Reader</span><span class="op" id="4399122">,</span>&nbsp;<span class="ident" id="4399124">priv</span>&nbsp;<span class="op" id="4399129">*</span><span class="ident" id="4399130"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4399140">,</span>&nbsp;<span class="ident" id="4399142">ciphertext</span>&nbsp;<span class="op" id="4399153">[</span><span class="op" id="4399154">]</span><span class="builtintype" id="4399155">byte</span><span class="op" id="4399159">)</span>&nbsp;<span class="op" id="4399161">(</span><span class="ident" id="4399162">valid</span>&nbsp;<span class="builtintype" id="4399168">int</span><span class="op" id="4399171">,</span>&nbsp;<span class="ident" id="4399173">em</span>&nbsp;<span class="op" id="4399176">[</span><span class="op" id="4399177">]</span><span class="builtintype" id="4399178">byte</span><span class="op" id="4399182">,</span>&nbsp;<span class="ident" id="4399184">index</span>&nbsp;<span class="builtintype" id="4399190">int</span><span class="op" id="4399193">,</span>&nbsp;<span class="ident" id="4399195">err</span>&nbsp;<span class="builtintype" id="4399199">error</span><span class="op" id="4399204">)</span>&nbsp;<span class="op" id="4399206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399209">k</span>&nbsp;<span class="op" id="4399211">:=</span>&nbsp;<span class="op" id="4399214">(</span><span class="ident" id="4399215"><a href="/crypto/rsa/pkcs1v15.go.html#4399124">priv</a></span><span class="op" id="4399219">.</span><span class="ident" id="4399220">N</span><span class="op" id="4399221">.</span><span class="ident" id="4399222">BitLen</span><span class="op" id="4399228">(</span><span class="op" id="4399229">)</span>&nbsp;<span class="op" id="4399231">+</span>&nbsp;<span class="num" id="4399233">7</span><span class="op" id="4399234">)</span>&nbsp;<span class="op" id="4399236">/</span>&nbsp;<span class="num" id="4399238">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399241">if</span>&nbsp;<span class="ident" id="4399244"><a href="/crypto/rsa/pkcs1v15.go.html#4399209">k</a></span>&nbsp;<span class="op" id="4399246">&lt;</span>&nbsp;<span class="num" id="4399248">11</span>&nbsp;<span class="op" id="4399251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399255"><a href="/crypto/rsa/pkcs1v15.go.html#4399195">err</a></span>&nbsp;<span class="op" id="4399259">=</span>&nbsp;<span class="ident" id="4399261"><a href="/crypto/rsa/rsa.go.html#4422966">ErrDecryption</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399277">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399289">c</span>&nbsp;<span class="op" id="4399291">:=</span>&nbsp;<span class="builtinfunc" id="4399294">new</span><span class="op" id="4399297">(</span><span class="ident" id="4399298"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4399301">.</span><span class="ident" id="4399302">Int</span><span class="op" id="4399305">)</span><span class="op" id="4399306">.</span><span class="ident" id="4399307">SetBytes</span><span class="op" id="4399315">(</span><span class="ident" id="4399316"><a href="/crypto/rsa/pkcs1v15.go.html#4399142">ciphertext</a></span><span class="op" id="4399326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399329">m</span><span class="op" id="4399330">,</span>&nbsp;<span class="ident" id="4399332"><a href="/crypto/rsa/pkcs1v15.go.html#4399195">err</a></span>&nbsp;<span class="op" id="4399336">:=</span>&nbsp;<span class="ident" id="4399339"><a href="/crypto/rsa/rsa.go.html#4424963">decrypt</a></span><span class="op" id="4399346">(</span><span class="ident" id="4399347"><a href="/crypto/rsa/pkcs1v15.go.html#4399108">rand</a></span><span class="op" id="4399351">,</span>&nbsp;<span class="ident" id="4399353"><a href="/crypto/rsa/pkcs1v15.go.html#4399124">priv</a></span><span class="op" id="4399357">,</span>&nbsp;<span class="ident" id="4399359"><a href="/crypto/rsa/pkcs1v15.go.html#4399289">c</a></span><span class="op" id="4399360">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399363">if</span>&nbsp;<span class="ident" id="4399366"><a href="/crypto/rsa/pkcs1v15.go.html#4399195">err</a></span>&nbsp;<span class="op" id="4399370">!=</span>&nbsp;<span class="ident" id="4399373">nil</span>&nbsp;<span class="op" id="4399377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399381">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4399389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399393"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span>&nbsp;<span class="op" id="4399396">=</span>&nbsp;<span class="ident" id="4399398"><a href="/crypto/rsa/rsa.go.html#4429093">leftPad</a></span><span class="op" id="4399405">(</span><span class="ident" id="4399406"><a href="/crypto/rsa/pkcs1v15.go.html#4399329">m</a></span><span class="op" id="4399407">.</span><span class="ident" id="4399408">Bytes</span><span class="op" id="4399413">(</span><span class="op" id="4399414">)</span><span class="op" id="4399415">,</span>&nbsp;<span class="ident" id="4399417"><a href="/crypto/rsa/pkcs1v15.go.html#4399209">k</a></span><span class="op" id="4399418">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399421">firstByteIsZero</span>&nbsp;<span class="op" id="4399437">:=</span>&nbsp;<span class="ident" id="4399440"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4399446">.</span><span class="ident" id="4399447">ConstantTimeByteEq</span><span class="op" id="4399465">(</span><span class="ident" id="4399466"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span><span class="op" id="4399468">[</span><span class="num" id="4399469">0</span><span class="op" id="4399470">]</span><span class="op" id="4399471">,</span>&nbsp;<span class="num" id="4399473">0</span><span class="op" id="4399474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399477">secondByteIsTwo</span>&nbsp;<span class="op" id="4399493">:=</span>&nbsp;<span class="ident" id="4399496"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4399502">.</span><span class="ident" id="4399503">ConstantTimeByteEq</span><span class="op" id="4399521">(</span><span class="ident" id="4399522"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span><span class="op" id="4399524">[</span><span class="num" id="4399525">1</span><span class="op" id="4399526">]</span><span class="op" id="4399527">,</span>&nbsp;<span class="num" id="4399529">2</span><span class="op" id="4399530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399534">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;plaintext&nbsp;must&nbsp;be&nbsp;a&nbsp;string&nbsp;of&nbsp;non-zero&nbsp;random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399605">//&nbsp;octets,&nbsp;followed&nbsp;by&nbsp;a&nbsp;0,&nbsp;followed&nbsp;by&nbsp;the&nbsp;message.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399659">//&nbsp;&nbsp;&nbsp;lookingForIndex:&nbsp;1&nbsp;iff&nbsp;we&nbsp;are&nbsp;still&nbsp;looking&nbsp;for&nbsp;the&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4399723">//&nbsp;&nbsp;&nbsp;index:&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;first&nbsp;zero&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399771">lookingForIndex</span>&nbsp;<span class="op" id="4399787">:=</span>&nbsp;<span class="num" id="4399790">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4399794">for</span>&nbsp;<span class="ident" id="4399798">i</span>&nbsp;<span class="op" id="4399800">:=</span>&nbsp;<span class="num" id="4399803">2</span><span class="op" id="4399804">;</span>&nbsp;<span class="ident" id="4399806"><a href="/crypto/rsa/pkcs1v15.go.html#4399798">i</a></span>&nbsp;<span class="op" id="4399808">&lt;</span>&nbsp;<span class="builtinfunc" id="4399810">len</span><span class="op" id="4399813">(</span><span class="ident" id="4399814"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span><span class="op" id="4399816">)</span><span class="op" id="4399817">;</span>&nbsp;<span class="ident" id="4399819"><a href="/crypto/rsa/pkcs1v15.go.html#4399798">i</a></span><span class="op" id="4399820">++</span>&nbsp;<span class="op" id="4399823">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399827">equals0</span>&nbsp;<span class="op" id="4399835">:=</span>&nbsp;<span class="ident" id="4399838"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4399844">.</span><span class="ident" id="4399845">ConstantTimeByteEq</span><span class="op" id="4399863">(</span><span class="ident" id="4399864"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span><span class="op" id="4399866">[</span><span class="ident" id="4399867"><a href="/crypto/rsa/pkcs1v15.go.html#4399798">i</a></span><span class="op" id="4399868">]</span><span class="op" id="4399869">,</span>&nbsp;<span class="num" id="4399871">0</span><span class="op" id="4399872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399876"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span>&nbsp;<span class="op" id="4399882">=</span>&nbsp;<span class="ident" id="4399884"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4399890">.</span><span class="ident" id="4399891">ConstantTimeSelect</span><span class="op" id="4399909">(</span><span class="ident" id="4399910"><a href="/crypto/rsa/pkcs1v15.go.html#4399771">lookingForIndex</a></span><span class="op" id="4399925">&amp;</span><span class="ident" id="4399926"><a href="/crypto/rsa/pkcs1v15.go.html#4399827">equals0</a></span><span class="op" id="4399933">,</span>&nbsp;<span class="ident" id="4399935"><a href="/crypto/rsa/pkcs1v15.go.html#4399798">i</a></span><span class="op" id="4399936">,</span>&nbsp;<span class="ident" id="4399938"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span><span class="op" id="4399943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4399947"><a href="/crypto/rsa/pkcs1v15.go.html#4399771">lookingForIndex</a></span>&nbsp;<span class="op" id="4399963">=</span>&nbsp;<span class="ident" id="4399965"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4399971">.</span><span class="ident" id="4399972">ConstantTimeSelect</span><span class="op" id="4399990">(</span><span class="ident" id="4399991"><a href="/crypto/rsa/pkcs1v15.go.html#4399827">equals0</a></span><span class="op" id="4399998">,</span>&nbsp;<span class="num" id="4400000">0</span><span class="op" id="4400001">,</span>&nbsp;<span class="ident" id="4400003"><a href="/crypto/rsa/pkcs1v15.go.html#4399771">lookingForIndex</a></span><span class="op" id="4400018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400025">//&nbsp;The&nbsp;PS&nbsp;padding&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;8&nbsp;bytes&nbsp;long,&nbsp;and&nbsp;it&nbsp;starts&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400093">//&nbsp;bytes&nbsp;into&nbsp;em.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400112">validPS</span>&nbsp;<span class="op" id="4400120">:=</span>&nbsp;<span class="ident" id="4400123"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4400129">.</span><span class="ident" id="4400130">ConstantTimeLessOrEq</span><span class="op" id="4400150">(</span><span class="num" id="4400151">2</span><span class="op" id="4400152">+</span><span class="num" id="4400153">8</span><span class="op" id="4400154">,</span>&nbsp;<span class="ident" id="4400156"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span><span class="op" id="4400161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400165"><a href="/crypto/rsa/pkcs1v15.go.html#4399162">valid</a></span>&nbsp;<span class="op" id="4400171">=</span>&nbsp;<span class="ident" id="4400173"><a href="/crypto/rsa/pkcs1v15.go.html#4399421">firstByteIsZero</a></span>&nbsp;<span class="op" id="4400189">&amp;</span>&nbsp;<span class="ident" id="4400191"><a href="/crypto/rsa/pkcs1v15.go.html#4399477">secondByteIsTwo</a></span>&nbsp;<span class="op" id="4400207">&amp;</span>&nbsp;<span class="op" id="4400209">(</span><span class="op" id="4400210">^</span><span class="ident" id="4400211"><a href="/crypto/rsa/pkcs1v15.go.html#4399771">lookingForIndex</a></span>&nbsp;<span class="op" id="4400227">&amp;</span>&nbsp;<span class="num" id="4400229">1</span><span class="op" id="4400230">)</span>&nbsp;<span class="op" id="4400232">&amp;</span>&nbsp;<span class="ident" id="4400234"><a href="/crypto/rsa/pkcs1v15.go.html#4400112">validPS</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400243"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span>&nbsp;<span class="op" id="4400249">=</span>&nbsp;<span class="ident" id="4400251"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4400257">.</span><span class="ident" id="4400258">ConstantTimeSelect</span><span class="op" id="4400276">(</span><span class="ident" id="4400277"><a href="/crypto/rsa/pkcs1v15.go.html#4399162">valid</a></span><span class="op" id="4400282">,</span>&nbsp;<span class="ident" id="4400284"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span><span class="op" id="4400289">+</span><span class="num" id="4400290">1</span><span class="op" id="4400291">,</span>&nbsp;<span class="num" id="4400293">0</span><span class="op" id="4400294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400297">return</span>&nbsp;<span class="ident" id="4400304"><a href="/crypto/rsa/pkcs1v15.go.html#4399162">valid</a></span><span class="op" id="4400309">,</span>&nbsp;<span class="ident" id="4400311"><a href="/crypto/rsa/pkcs1v15.go.html#4399173">em</a></span><span class="op" id="4400313">,</span>&nbsp;<span class="ident" id="4400315"><a href="/crypto/rsa/pkcs1v15.go.html#4399184">index</a></span><span class="op" id="4400320">,</span>&nbsp;<span class="ident" id="4400322">nil</span><br>
<span class="lineno"></span><span class="op" id="4400326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4400329">//&nbsp;nonZeroRandomBytes&nbsp;fills&nbsp;the&nbsp;given&nbsp;slice&nbsp;with&nbsp;non-zero&nbsp;random&nbsp;octets.</span><br>
<span class="lineno">150</span><span class="keyword" id="4400402">func</span>&nbsp;<span class="ident" id="4400407">nonZeroRandomBytes</span><span class="op" id="4400425">(</span><span class="ident" id="4400426">s</span>&nbsp;<span class="op" id="4400428">[</span><span class="op" id="4400429">]</span><span class="builtintype" id="4400430">byte</span><span class="op" id="4400434">,</span>&nbsp;<span class="ident" id="4400436">rand</span>&nbsp;<span class="ident" id="4400441"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4400443">.</span><span class="ident" id="4400444">Reader</span><span class="op" id="4400450">)</span>&nbsp;<span class="op" id="4400452">(</span><span class="ident" id="4400453">err</span>&nbsp;<span class="builtintype" id="4400457">error</span><span class="op" id="4400462">)</span>&nbsp;<span class="op" id="4400464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400467">_</span><span class="op" id="4400468">,</span>&nbsp;<span class="ident" id="4400470"><a href="/crypto/rsa/pkcs1v15.go.html#4400453">err</a></span>&nbsp;<span class="op" id="4400474">=</span>&nbsp;<span class="ident" id="4400476"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4400478">.</span><span class="ident" id="4400479">ReadFull</span><span class="op" id="4400487">(</span><span class="ident" id="4400488"><a href="/crypto/rsa/pkcs1v15.go.html#4400436">rand</a></span><span class="op" id="4400492">,</span>&nbsp;<span class="ident" id="4400494"><a href="/crypto/rsa/pkcs1v15.go.html#4400426">s</a></span><span class="op" id="4400495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400498">if</span>&nbsp;<span class="ident" id="4400501"><a href="/crypto/rsa/pkcs1v15.go.html#4400453">err</a></span>&nbsp;<span class="op" id="4400505">!=</span>&nbsp;<span class="ident" id="4400508">nil</span>&nbsp;<span class="op" id="4400512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400516">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400524">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400528">for</span>&nbsp;<span class="ident" id="4400532">i</span>&nbsp;<span class="op" id="4400534">:=</span>&nbsp;<span class="num" id="4400537">0</span><span class="op" id="4400538">;</span>&nbsp;<span class="ident" id="4400540"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span>&nbsp;<span class="op" id="4400542">&lt;</span>&nbsp;<span class="builtinfunc" id="4400544">len</span><span class="op" id="4400547">(</span><span class="ident" id="4400548"><a href="/crypto/rsa/pkcs1v15.go.html#4400426">s</a></span><span class="op" id="4400549">)</span><span class="op" id="4400550">;</span>&nbsp;<span class="ident" id="4400552"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span><span class="op" id="4400553">++</span>&nbsp;<span class="op" id="4400556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400560">for</span>&nbsp;<span class="ident" id="4400564"><a href="/crypto/rsa/pkcs1v15.go.html#4400426">s</a></span><span class="op" id="4400565">[</span><span class="ident" id="4400566"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span><span class="op" id="4400567">]</span>&nbsp;<span class="op" id="4400569">==</span>&nbsp;<span class="num" id="4400572">0</span>&nbsp;<span class="op" id="4400574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400579">_</span><span class="op" id="4400580">,</span>&nbsp;<span class="ident" id="4400582"><a href="/crypto/rsa/pkcs1v15.go.html#4400453">err</a></span>&nbsp;<span class="op" id="4400586">=</span>&nbsp;<span class="ident" id="4400588"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4400590">.</span><span class="ident" id="4400591">ReadFull</span><span class="op" id="4400599">(</span><span class="ident" id="4400600"><a href="/crypto/rsa/pkcs1v15.go.html#4400436">rand</a></span><span class="op" id="4400604">,</span>&nbsp;<span class="ident" id="4400606"><a href="/crypto/rsa/pkcs1v15.go.html#4400426">s</a></span><span class="op" id="4400607">[</span><span class="ident" id="4400608"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span><span class="op" id="4400609">:</span><span class="ident" id="4400610"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span><span class="op" id="4400611">+</span><span class="num" id="4400612">1</span><span class="op" id="4400613">]</span><span class="op" id="4400614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400619">if</span>&nbsp;<span class="ident" id="4400622"><a href="/crypto/rsa/pkcs1v15.go.html#4400453">err</a></span>&nbsp;<span class="op" id="4400626">!=</span>&nbsp;<span class="ident" id="4400629">nil</span>&nbsp;<span class="op" id="4400633">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400639">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400654">//&nbsp;In&nbsp;tests,&nbsp;the&nbsp;PRNG&nbsp;may&nbsp;return&nbsp;all&nbsp;zeros&nbsp;so&nbsp;we&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400709">//&nbsp;this&nbsp;to&nbsp;break&nbsp;the&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400739"><a href="/crypto/rsa/pkcs1v15.go.html#4400426">s</a></span><span class="op" id="4400740">[</span><span class="ident" id="4400741"><a href="/crypto/rsa/pkcs1v15.go.html#4400532">i</a></span><span class="op" id="4400742">]</span>&nbsp;<span class="op" id="4400744">^=</span>&nbsp;<span class="num" id="4400747">0x42</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4400757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4400761">return</span><br>
<span class="lineno"></span><span class="op" id="4400768">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="comment" id="4400771">//&nbsp;These&nbsp;are&nbsp;ASN1&nbsp;DER&nbsp;structures:</span><br>
<span class="lineno"></span><span class="comment" id="4400805">//&nbsp;&nbsp;&nbsp;DigestInfo&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4400836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digestAlgorithm&nbsp;AlgorithmIdentifier,</span><br>
<span class="lineno"></span><span class="comment" id="4400880">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digest&nbsp;OCTET&nbsp;STRING</span><br>
<span class="lineno">175</span><span class="comment" id="4400907">//&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4400914">//&nbsp;For&nbsp;performance,&nbsp;we&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;generic&nbsp;ASN1&nbsp;encoder.&nbsp;Rather,&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4400984">//&nbsp;precompute&nbsp;a&nbsp;prefix&nbsp;of&nbsp;the&nbsp;digest&nbsp;value&nbsp;that&nbsp;makes&nbsp;a&nbsp;valid&nbsp;ASN1&nbsp;DER&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="4401062">//&nbsp;with&nbsp;the&nbsp;correct&nbsp;contents.</span><br>
<span class="lineno"></span><span class="keyword" id="4401092">var</span>&nbsp;<span class="ident" id="4401096">hashPrefixes</span>&nbsp;<span class="op" id="4401109">=</span>&nbsp;<span class="keyword" id="4401111">map</span><span class="op" id="4401114">[</span><span class="ident" id="4401115"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401121">.</span><span class="ident" id="4401122">Hash</span><span class="op" id="4401126">]</span><span class="op" id="4401127">[</span><span class="op" id="4401128">]</span><span class="builtintype" id="4401129">byte</span><span class="op" id="4401133">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401136"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401142">.</span><span class="ident" id="4401143">MD5</span><span class="op" id="4401146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401154">{</span><span class="num" id="4401155">0x30</span><span class="op" id="4401159">,</span>&nbsp;<span class="num" id="4401161">0x20</span><span class="op" id="4401165">,</span>&nbsp;<span class="num" id="4401167">0x30</span><span class="op" id="4401171">,</span>&nbsp;<span class="num" id="4401173">0x0c</span><span class="op" id="4401177">,</span>&nbsp;<span class="num" id="4401179">0x06</span><span class="op" id="4401183">,</span>&nbsp;<span class="num" id="4401185">0x08</span><span class="op" id="4401189">,</span>&nbsp;<span class="num" id="4401191">0x2a</span><span class="op" id="4401195">,</span>&nbsp;<span class="num" id="4401197">0x86</span><span class="op" id="4401201">,</span>&nbsp;<span class="num" id="4401203">0x48</span><span class="op" id="4401207">,</span>&nbsp;<span class="num" id="4401209">0x86</span><span class="op" id="4401213">,</span>&nbsp;<span class="num" id="4401215">0xf7</span><span class="op" id="4401219">,</span>&nbsp;<span class="num" id="4401221">0x0d</span><span class="op" id="4401225">,</span>&nbsp;<span class="num" id="4401227">0x02</span><span class="op" id="4401231">,</span>&nbsp;<span class="num" id="4401233">0x05</span><span class="op" id="4401237">,</span>&nbsp;<span class="num" id="4401239">0x05</span><span class="op" id="4401243">,</span>&nbsp;<span class="num" id="4401245">0x00</span><span class="op" id="4401249">,</span>&nbsp;<span class="num" id="4401251">0x04</span><span class="op" id="4401255">,</span>&nbsp;<span class="num" id="4401257">0x10</span><span class="op" id="4401261">}</span><span class="op" id="4401262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401265"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401271">.</span><span class="ident" id="4401272">SHA1</span><span class="op" id="4401276">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401283">{</span><span class="num" id="4401284">0x30</span><span class="op" id="4401288">,</span>&nbsp;<span class="num" id="4401290">0x21</span><span class="op" id="4401294">,</span>&nbsp;<span class="num" id="4401296">0x30</span><span class="op" id="4401300">,</span>&nbsp;<span class="num" id="4401302">0x09</span><span class="op" id="4401306">,</span>&nbsp;<span class="num" id="4401308">0x06</span><span class="op" id="4401312">,</span>&nbsp;<span class="num" id="4401314">0x05</span><span class="op" id="4401318">,</span>&nbsp;<span class="num" id="4401320">0x2b</span><span class="op" id="4401324">,</span>&nbsp;<span class="num" id="4401326">0x0e</span><span class="op" id="4401330">,</span>&nbsp;<span class="num" id="4401332">0x03</span><span class="op" id="4401336">,</span>&nbsp;<span class="num" id="4401338">0x02</span><span class="op" id="4401342">,</span>&nbsp;<span class="num" id="4401344">0x1a</span><span class="op" id="4401348">,</span>&nbsp;<span class="num" id="4401350">0x05</span><span class="op" id="4401354">,</span>&nbsp;<span class="num" id="4401356">0x00</span><span class="op" id="4401360">,</span>&nbsp;<span class="num" id="4401362">0x04</span><span class="op" id="4401366">,</span>&nbsp;<span class="num" id="4401368">0x14</span><span class="op" id="4401372">}</span><span class="op" id="4401373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401376"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401382">.</span><span class="ident" id="4401383">SHA224</span><span class="op" id="4401389">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401394">{</span><span class="num" id="4401395">0x30</span><span class="op" id="4401399">,</span>&nbsp;<span class="num" id="4401401">0x2d</span><span class="op" id="4401405">,</span>&nbsp;<span class="num" id="4401407">0x30</span><span class="op" id="4401411">,</span>&nbsp;<span class="num" id="4401413">0x0d</span><span class="op" id="4401417">,</span>&nbsp;<span class="num" id="4401419">0x06</span><span class="op" id="4401423">,</span>&nbsp;<span class="num" id="4401425">0x09</span><span class="op" id="4401429">,</span>&nbsp;<span class="num" id="4401431">0x60</span><span class="op" id="4401435">,</span>&nbsp;<span class="num" id="4401437">0x86</span><span class="op" id="4401441">,</span>&nbsp;<span class="num" id="4401443">0x48</span><span class="op" id="4401447">,</span>&nbsp;<span class="num" id="4401449">0x01</span><span class="op" id="4401453">,</span>&nbsp;<span class="num" id="4401455">0x65</span><span class="op" id="4401459">,</span>&nbsp;<span class="num" id="4401461">0x03</span><span class="op" id="4401465">,</span>&nbsp;<span class="num" id="4401467">0x04</span><span class="op" id="4401471">,</span>&nbsp;<span class="num" id="4401473">0x02</span><span class="op" id="4401477">,</span>&nbsp;<span class="num" id="4401479">0x04</span><span class="op" id="4401483">,</span>&nbsp;<span class="num" id="4401485">0x05</span><span class="op" id="4401489">,</span>&nbsp;<span class="num" id="4401491">0x00</span><span class="op" id="4401495">,</span>&nbsp;<span class="num" id="4401497">0x04</span><span class="op" id="4401501">,</span>&nbsp;<span class="num" id="4401503">0x1c</span><span class="op" id="4401507">}</span><span class="op" id="4401508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401511"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401517">.</span><span class="ident" id="4401518">SHA256</span><span class="op" id="4401524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401529">{</span><span class="num" id="4401530">0x30</span><span class="op" id="4401534">,</span>&nbsp;<span class="num" id="4401536">0x31</span><span class="op" id="4401540">,</span>&nbsp;<span class="num" id="4401542">0x30</span><span class="op" id="4401546">,</span>&nbsp;<span class="num" id="4401548">0x0d</span><span class="op" id="4401552">,</span>&nbsp;<span class="num" id="4401554">0x06</span><span class="op" id="4401558">,</span>&nbsp;<span class="num" id="4401560">0x09</span><span class="op" id="4401564">,</span>&nbsp;<span class="num" id="4401566">0x60</span><span class="op" id="4401570">,</span>&nbsp;<span class="num" id="4401572">0x86</span><span class="op" id="4401576">,</span>&nbsp;<span class="num" id="4401578">0x48</span><span class="op" id="4401582">,</span>&nbsp;<span class="num" id="4401584">0x01</span><span class="op" id="4401588">,</span>&nbsp;<span class="num" id="4401590">0x65</span><span class="op" id="4401594">,</span>&nbsp;<span class="num" id="4401596">0x03</span><span class="op" id="4401600">,</span>&nbsp;<span class="num" id="4401602">0x04</span><span class="op" id="4401606">,</span>&nbsp;<span class="num" id="4401608">0x02</span><span class="op" id="4401612">,</span>&nbsp;<span class="num" id="4401614">0x01</span><span class="op" id="4401618">,</span>&nbsp;<span class="num" id="4401620">0x05</span><span class="op" id="4401624">,</span>&nbsp;<span class="num" id="4401626">0x00</span><span class="op" id="4401630">,</span>&nbsp;<span class="num" id="4401632">0x04</span><span class="op" id="4401636">,</span>&nbsp;<span class="num" id="4401638">0x20</span><span class="op" id="4401642">}</span><span class="op" id="4401643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401646"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401652">.</span><span class="ident" id="4401653">SHA384</span><span class="op" id="4401659">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401664">{</span><span class="num" id="4401665">0x30</span><span class="op" id="4401669">,</span>&nbsp;<span class="num" id="4401671">0x41</span><span class="op" id="4401675">,</span>&nbsp;<span class="num" id="4401677">0x30</span><span class="op" id="4401681">,</span>&nbsp;<span class="num" id="4401683">0x0d</span><span class="op" id="4401687">,</span>&nbsp;<span class="num" id="4401689">0x06</span><span class="op" id="4401693">,</span>&nbsp;<span class="num" id="4401695">0x09</span><span class="op" id="4401699">,</span>&nbsp;<span class="num" id="4401701">0x60</span><span class="op" id="4401705">,</span>&nbsp;<span class="num" id="4401707">0x86</span><span class="op" id="4401711">,</span>&nbsp;<span class="num" id="4401713">0x48</span><span class="op" id="4401717">,</span>&nbsp;<span class="num" id="4401719">0x01</span><span class="op" id="4401723">,</span>&nbsp;<span class="num" id="4401725">0x65</span><span class="op" id="4401729">,</span>&nbsp;<span class="num" id="4401731">0x03</span><span class="op" id="4401735">,</span>&nbsp;<span class="num" id="4401737">0x04</span><span class="op" id="4401741">,</span>&nbsp;<span class="num" id="4401743">0x02</span><span class="op" id="4401747">,</span>&nbsp;<span class="num" id="4401749">0x02</span><span class="op" id="4401753">,</span>&nbsp;<span class="num" id="4401755">0x05</span><span class="op" id="4401759">,</span>&nbsp;<span class="num" id="4401761">0x00</span><span class="op" id="4401765">,</span>&nbsp;<span class="num" id="4401767">0x04</span><span class="op" id="4401771">,</span>&nbsp;<span class="num" id="4401773">0x30</span><span class="op" id="4401777">}</span><span class="op" id="4401778">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401781"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401787">.</span><span class="ident" id="4401788">SHA512</span><span class="op" id="4401794">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401799">{</span><span class="num" id="4401800">0x30</span><span class="op" id="4401804">,</span>&nbsp;<span class="num" id="4401806">0x51</span><span class="op" id="4401810">,</span>&nbsp;<span class="num" id="4401812">0x30</span><span class="op" id="4401816">,</span>&nbsp;<span class="num" id="4401818">0x0d</span><span class="op" id="4401822">,</span>&nbsp;<span class="num" id="4401824">0x06</span><span class="op" id="4401828">,</span>&nbsp;<span class="num" id="4401830">0x09</span><span class="op" id="4401834">,</span>&nbsp;<span class="num" id="4401836">0x60</span><span class="op" id="4401840">,</span>&nbsp;<span class="num" id="4401842">0x86</span><span class="op" id="4401846">,</span>&nbsp;<span class="num" id="4401848">0x48</span><span class="op" id="4401852">,</span>&nbsp;<span class="num" id="4401854">0x01</span><span class="op" id="4401858">,</span>&nbsp;<span class="num" id="4401860">0x65</span><span class="op" id="4401864">,</span>&nbsp;<span class="num" id="4401866">0x03</span><span class="op" id="4401870">,</span>&nbsp;<span class="num" id="4401872">0x04</span><span class="op" id="4401876">,</span>&nbsp;<span class="num" id="4401878">0x02</span><span class="op" id="4401882">,</span>&nbsp;<span class="num" id="4401884">0x03</span><span class="op" id="4401888">,</span>&nbsp;<span class="num" id="4401890">0x05</span><span class="op" id="4401894">,</span>&nbsp;<span class="num" id="4401896">0x00</span><span class="op" id="4401900">,</span>&nbsp;<span class="num" id="4401902">0x04</span><span class="op" id="4401906">,</span>&nbsp;<span class="num" id="4401908">0x40</span><span class="op" id="4401912">}</span><span class="op" id="4401913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401916"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4401922">.</span><span class="ident" id="4401923">MD5SHA1</span><span class="op" id="4401930">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4401934">{</span><span class="op" id="4401935">}</span><span class="op" id="4401936">,</span>&nbsp;<span class="comment" id="4401938">//&nbsp;A&nbsp;special&nbsp;TLS&nbsp;case&nbsp;which&nbsp;doesn&#39;t&nbsp;use&nbsp;an&nbsp;ASN1&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401995"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4402001">.</span><span class="ident" id="4402002">RIPEMD160</span><span class="op" id="4402011">:</span>&nbsp;<span class="op" id="4402013">{</span><span class="num" id="4402014">0x30</span><span class="op" id="4402018">,</span>&nbsp;<span class="num" id="4402020">0x20</span><span class="op" id="4402024">,</span>&nbsp;<span class="num" id="4402026">0x30</span><span class="op" id="4402030">,</span>&nbsp;<span class="num" id="4402032">0x08</span><span class="op" id="4402036">,</span>&nbsp;<span class="num" id="4402038">0x06</span><span class="op" id="4402042">,</span>&nbsp;<span class="num" id="4402044">0x06</span><span class="op" id="4402048">,</span>&nbsp;<span class="num" id="4402050">0x28</span><span class="op" id="4402054">,</span>&nbsp;<span class="num" id="4402056">0xcf</span><span class="op" id="4402060">,</span>&nbsp;<span class="num" id="4402062">0x06</span><span class="op" id="4402066">,</span>&nbsp;<span class="num" id="4402068">0x03</span><span class="op" id="4402072">,</span>&nbsp;<span class="num" id="4402074">0x00</span><span class="op" id="4402078">,</span>&nbsp;<span class="num" id="4402080">0x31</span><span class="op" id="4402084">,</span>&nbsp;<span class="num" id="4402086">0x04</span><span class="op" id="4402090">,</span>&nbsp;<span class="num" id="4402092">0x14</span><span class="op" id="4402096">}</span><span class="op" id="4402097">,</span><br>
<span class="lineno"></span><span class="op" id="4402099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4402102">//&nbsp;SignPKCS1v15&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;RSASSA-PKCS1-V1_5-SIGN&nbsp;from&nbsp;RSA&nbsp;PKCS#1&nbsp;v1.5.</span><br>
<span class="lineno"></span><span class="comment" id="4402204">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4402282">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;If&nbsp;hash&nbsp;is&nbsp;zero,&nbsp;hashed&nbsp;is&nbsp;signed&nbsp;directly.&nbsp;This&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="4402361">//&nbsp;advisable&nbsp;except&nbsp;for&nbsp;interoperability.</span><br>
<span class="lineno"></span><span class="keyword" id="4402403">func</span>&nbsp;<span class="ident" id="4402408">SignPKCS1v15</span><span class="op" id="4402420">(</span><span class="ident" id="4402421">rand</span>&nbsp;<span class="ident" id="4402426"><a href="/crypto/rsa/pkcs1v15.go.html#4395557">io</a></span><span class="op" id="4402428">.</span><span class="ident" id="4402429">Reader</span><span class="op" id="4402435">,</span>&nbsp;<span class="ident" id="4402437">priv</span>&nbsp;<span class="op" id="4402442">*</span><span class="ident" id="4402443"><a href="/crypto/rsa/rsa.go.html#4414783">PrivateKey</a></span><span class="op" id="4402453">,</span>&nbsp;<span class="ident" id="4402455">hash</span>&nbsp;<span class="ident" id="4402460"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4402466">.</span><span class="ident" id="4402467">Hash</span><span class="op" id="4402471">,</span>&nbsp;<span class="ident" id="4402473">hashed</span>&nbsp;<span class="op" id="4402480">[</span><span class="op" id="4402481">]</span><span class="builtintype" id="4402482">byte</span><span class="op" id="4402486">)</span>&nbsp;<span class="op" id="4402488">(</span><span class="ident" id="4402489">s</span>&nbsp;<span class="op" id="4402491">[</span><span class="op" id="4402492">]</span><span class="builtintype" id="4402493">byte</span><span class="op" id="4402497">,</span>&nbsp;<span class="ident" id="4402499">err</span>&nbsp;<span class="builtintype" id="4402503">error</span><span class="op" id="4402508">)</span>&nbsp;<span class="op" id="4402510">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402513">hashLen</span><span class="op" id="4402520">,</span>&nbsp;<span class="ident" id="4402522">prefix</span><span class="op" id="4402528">,</span>&nbsp;<span class="ident" id="4402530"><a href="/crypto/rsa/pkcs1v15.go.html#4402499">err</a></span>&nbsp;<span class="op" id="4402534">:=</span>&nbsp;<span class="ident" id="4402537"><a href="/crypto/rsa/pkcs1v15.go.html#4404239">pkcs1v15HashInfo</a></span><span class="op" id="4402553">(</span><span class="ident" id="4402554"><a href="/crypto/rsa/pkcs1v15.go.html#4402455">hash</a></span><span class="op" id="4402558">,</span>&nbsp;<span class="builtinfunc" id="4402560">len</span><span class="op" id="4402563">(</span><span class="ident" id="4402564"><a href="/crypto/rsa/pkcs1v15.go.html#4402473">hashed</a></span><span class="op" id="4402570">)</span><span class="op" id="4402571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402574">if</span>&nbsp;<span class="ident" id="4402577"><a href="/crypto/rsa/pkcs1v15.go.html#4402499">err</a></span>&nbsp;<span class="op" id="4402581">!=</span>&nbsp;<span class="ident" id="4402584">nil</span>&nbsp;<span class="op" id="4402588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402592">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402604">tLen</span>&nbsp;<span class="op" id="4402609">:=</span>&nbsp;<span class="builtinfunc" id="4402612">len</span><span class="op" id="4402615">(</span><span class="ident" id="4402616"><a href="/crypto/rsa/pkcs1v15.go.html#4402522">prefix</a></span><span class="op" id="4402622">)</span>&nbsp;<span class="op" id="4402624">+</span>&nbsp;<span class="ident" id="4402626"><a href="/crypto/rsa/pkcs1v15.go.html#4402513">hashLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402635">k</span>&nbsp;<span class="op" id="4402637">:=</span>&nbsp;<span class="op" id="4402640">(</span><span class="ident" id="4402641"><a href="/crypto/rsa/pkcs1v15.go.html#4402437">priv</a></span><span class="op" id="4402645">.</span><span class="ident" id="4402646">N</span><span class="op" id="4402647">.</span><span class="ident" id="4402648">BitLen</span><span class="op" id="4402654">(</span><span class="op" id="4402655">)</span>&nbsp;<span class="op" id="4402657">+</span>&nbsp;<span class="num" id="4402659">7</span><span class="op" id="4402660">)</span>&nbsp;<span class="op" id="4402662">/</span>&nbsp;<span class="num" id="4402664">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402667">if</span>&nbsp;<span class="ident" id="4402670"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span>&nbsp;<span class="op" id="4402672">&lt;</span>&nbsp;<span class="ident" id="4402674"><a href="/crypto/rsa/pkcs1v15.go.html#4402604">tLen</a></span><span class="op" id="4402678">+</span><span class="num" id="4402679">11</span>&nbsp;<span class="op" id="4402682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402686">return</span>&nbsp;<span class="ident" id="4402693">nil</span><span class="op" id="4402696">,</span>&nbsp;<span class="ident" id="4402698"><a href="/crypto/rsa/rsa.go.html#4421567">ErrMessageTooLong</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402717">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402721">//&nbsp;EM&nbsp;=&nbsp;0x00&nbsp;||&nbsp;0x01&nbsp;||&nbsp;PS&nbsp;||&nbsp;0x00&nbsp;||&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402762">em</span>&nbsp;<span class="op" id="4402765">:=</span>&nbsp;<span class="builtinfunc" id="4402768">make</span><span class="op" id="4402772">(</span><span class="op" id="4402773">[</span><span class="op" id="4402774">]</span><span class="builtintype" id="4402775">byte</span><span class="op" id="4402779">,</span>&nbsp;<span class="ident" id="4402781"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402785"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4402787">[</span><span class="num" id="4402788">1</span><span class="op" id="4402789">]</span>&nbsp;<span class="op" id="4402791">=</span>&nbsp;<span class="num" id="4402793">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402796">for</span>&nbsp;<span class="ident" id="4402800">i</span>&nbsp;<span class="op" id="4402802">:=</span>&nbsp;<span class="num" id="4402805">2</span><span class="op" id="4402806">;</span>&nbsp;<span class="ident" id="4402808"><a href="/crypto/rsa/pkcs1v15.go.html#4402800">i</a></span>&nbsp;<span class="op" id="4402810">&lt;</span>&nbsp;<span class="ident" id="4402812"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402813">-</span><span class="ident" id="4402814"><a href="/crypto/rsa/pkcs1v15.go.html#4402604">tLen</a></span><span class="op" id="4402818">-</span><span class="num" id="4402819">1</span><span class="op" id="4402820">;</span>&nbsp;<span class="ident" id="4402822"><a href="/crypto/rsa/pkcs1v15.go.html#4402800">i</a></span><span class="op" id="4402823">++</span>&nbsp;<span class="op" id="4402826">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402830"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4402832">[</span><span class="ident" id="4402833"><a href="/crypto/rsa/pkcs1v15.go.html#4402800">i</a></span><span class="op" id="4402834">]</span>&nbsp;<span class="op" id="4402836">=</span>&nbsp;<span class="num" id="4402838">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4402847">copy</span><span class="op" id="4402851">(</span><span class="ident" id="4402852"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4402854">[</span><span class="ident" id="4402855"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402856">-</span><span class="ident" id="4402857"><a href="/crypto/rsa/pkcs1v15.go.html#4402604">tLen</a></span><span class="op" id="4402861">:</span><span class="ident" id="4402862"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402863">-</span><span class="ident" id="4402864"><a href="/crypto/rsa/pkcs1v15.go.html#4402513">hashLen</a></span><span class="op" id="4402871">]</span><span class="op" id="4402872">,</span>&nbsp;<span class="ident" id="4402874"><a href="/crypto/rsa/pkcs1v15.go.html#4402522">prefix</a></span><span class="op" id="4402880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4402883">copy</span><span class="op" id="4402887">(</span><span class="ident" id="4402888"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4402890">[</span><span class="ident" id="4402891"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402892">-</span><span class="ident" id="4402893"><a href="/crypto/rsa/pkcs1v15.go.html#4402513">hashLen</a></span><span class="op" id="4402900">:</span><span class="ident" id="4402901"><a href="/crypto/rsa/pkcs1v15.go.html#4402635">k</a></span><span class="op" id="4402902">]</span><span class="op" id="4402903">,</span>&nbsp;<span class="ident" id="4402905"><a href="/crypto/rsa/pkcs1v15.go.html#4402473">hashed</a></span><span class="op" id="4402911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402915">m</span>&nbsp;<span class="op" id="4402917">:=</span>&nbsp;<span class="builtinfunc" id="4402920">new</span><span class="op" id="4402923">(</span><span class="ident" id="4402924"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4402927">.</span><span class="ident" id="4402928">Int</span><span class="op" id="4402931">)</span><span class="op" id="4402932">.</span><span class="ident" id="4402933">SetBytes</span><span class="op" id="4402941">(</span><span class="ident" id="4402942"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4402944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402947">c</span><span class="op" id="4402948">,</span>&nbsp;<span class="ident" id="4402950"><a href="/crypto/rsa/pkcs1v15.go.html#4402499">err</a></span>&nbsp;<span class="op" id="4402954">:=</span>&nbsp;<span class="ident" id="4402957"><a href="/crypto/rsa/rsa.go.html#4424963">decrypt</a></span><span class="op" id="4402964">(</span><span class="ident" id="4402965"><a href="/crypto/rsa/pkcs1v15.go.html#4402421">rand</a></span><span class="op" id="4402969">,</span>&nbsp;<span class="ident" id="4402971"><a href="/crypto/rsa/pkcs1v15.go.html#4402437">priv</a></span><span class="op" id="4402975">,</span>&nbsp;<span class="ident" id="4402977"><a href="/crypto/rsa/pkcs1v15.go.html#4402915">m</a></span><span class="op" id="4402978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402981">if</span>&nbsp;<span class="ident" id="4402984"><a href="/crypto/rsa/pkcs1v15.go.html#4402499">err</a></span>&nbsp;<span class="op" id="4402988">!=</span>&nbsp;<span class="ident" id="4402991">nil</span>&nbsp;<span class="op" id="4402995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402999">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403007">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403011"><a href="/crypto/rsa/pkcs1v15.go.html#4404804">copyWithLeftPad</a></span><span class="op" id="4403026">(</span><span class="ident" id="4403027"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><span class="op" id="4403029">,</span>&nbsp;<span class="ident" id="4403031"><a href="/crypto/rsa/pkcs1v15.go.html#4402947">c</a></span><span class="op" id="4403032">.</span><span class="ident" id="4403033">Bytes</span><span class="op" id="4403038">(</span><span class="op" id="4403039">)</span><span class="op" id="4403040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403043"><a href="/crypto/rsa/pkcs1v15.go.html#4402489">s</a></span>&nbsp;<span class="op" id="4403045">=</span>&nbsp;<span class="ident" id="4403047"><a href="/crypto/rsa/pkcs1v15.go.html#4402762">em</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403051">return</span><br>
<span class="lineno"></span><span class="op" id="4403058">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="4403061">//&nbsp;VerifyPKCS1v15&nbsp;verifies&nbsp;an&nbsp;RSA&nbsp;PKCS#1&nbsp;v1.5&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4403118">//&nbsp;hashed&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4403192">//&nbsp;function&nbsp;and&nbsp;sig&nbsp;is&nbsp;the&nbsp;signature.&nbsp;A&nbsp;valid&nbsp;signature&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4403264">//&nbsp;returning&nbsp;a&nbsp;nil&nbsp;error.&nbsp;If&nbsp;hash&nbsp;is&nbsp;zero&nbsp;then&nbsp;hashed&nbsp;is&nbsp;used&nbsp;directly.&nbsp;This</span><br>
<span class="lineno">230</span><span class="comment" id="4403341">//&nbsp;isn&#39;t&nbsp;advisable&nbsp;except&nbsp;for&nbsp;interoperability.</span><br>
<span class="lineno"></span><span class="keyword" id="4403389">func</span>&nbsp;<span class="ident" id="4403394">VerifyPKCS1v15</span><span class="op" id="4403408">(</span><span class="ident" id="4403409">pub</span>&nbsp;<span class="op" id="4403413">*</span><span class="ident" id="4403414"><a href="/crypto/rsa/rsa.go.html#4413952">PublicKey</a></span><span class="op" id="4403423">,</span>&nbsp;<span class="ident" id="4403425">hash</span>&nbsp;<span class="ident" id="4403430"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4403436">.</span><span class="ident" id="4403437">Hash</span><span class="op" id="4403441">,</span>&nbsp;<span class="ident" id="4403443">hashed</span>&nbsp;<span class="op" id="4403450">[</span><span class="op" id="4403451">]</span><span class="builtintype" id="4403452">byte</span><span class="op" id="4403456">,</span>&nbsp;<span class="ident" id="4403458">sig</span>&nbsp;<span class="op" id="4403462">[</span><span class="op" id="4403463">]</span><span class="builtintype" id="4403464">byte</span><span class="op" id="4403468">)</span>&nbsp;<span class="op" id="4403470">(</span><span class="ident" id="4403471">err</span>&nbsp;<span class="builtintype" id="4403475">error</span><span class="op" id="4403480">)</span>&nbsp;<span class="op" id="4403482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403485">hashLen</span><span class="op" id="4403492">,</span>&nbsp;<span class="ident" id="4403494">prefix</span><span class="op" id="4403500">,</span>&nbsp;<span class="ident" id="4403502"><a href="/crypto/rsa/pkcs1v15.go.html#4403471">err</a></span>&nbsp;<span class="op" id="4403506">:=</span>&nbsp;<span class="ident" id="4403509"><a href="/crypto/rsa/pkcs1v15.go.html#4404239">pkcs1v15HashInfo</a></span><span class="op" id="4403525">(</span><span class="ident" id="4403526"><a href="/crypto/rsa/pkcs1v15.go.html#4403425">hash</a></span><span class="op" id="4403530">,</span>&nbsp;<span class="builtinfunc" id="4403532">len</span><span class="op" id="4403535">(</span><span class="ident" id="4403536"><a href="/crypto/rsa/pkcs1v15.go.html#4403443">hashed</a></span><span class="op" id="4403542">)</span><span class="op" id="4403543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403546">if</span>&nbsp;<span class="ident" id="4403549"><a href="/crypto/rsa/pkcs1v15.go.html#4403471">err</a></span>&nbsp;<span class="op" id="4403553">!=</span>&nbsp;<span class="ident" id="4403556">nil</span>&nbsp;<span class="op" id="4403560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403564">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403576">tLen</span>&nbsp;<span class="op" id="4403581">:=</span>&nbsp;<span class="builtinfunc" id="4403584">len</span><span class="op" id="4403587">(</span><span class="ident" id="4403588"><a href="/crypto/rsa/pkcs1v15.go.html#4403494">prefix</a></span><span class="op" id="4403594">)</span>&nbsp;<span class="op" id="4403596">+</span>&nbsp;<span class="ident" id="4403598"><a href="/crypto/rsa/pkcs1v15.go.html#4403485">hashLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403607">k</span>&nbsp;<span class="op" id="4403609">:=</span>&nbsp;<span class="op" id="4403612">(</span><span class="ident" id="4403613"><a href="/crypto/rsa/pkcs1v15.go.html#4403409">pub</a></span><span class="op" id="4403616">.</span><span class="ident" id="4403617">N</span><span class="op" id="4403618">.</span><span class="ident" id="4403619">BitLen</span><span class="op" id="4403625">(</span><span class="op" id="4403626">)</span>&nbsp;<span class="op" id="4403628">+</span>&nbsp;<span class="num" id="4403630">7</span><span class="op" id="4403631">)</span>&nbsp;<span class="op" id="4403633">/</span>&nbsp;<span class="num" id="4403635">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403638">if</span>&nbsp;<span class="ident" id="4403641"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span>&nbsp;<span class="op" id="4403643">&lt;</span>&nbsp;<span class="ident" id="4403645"><a href="/crypto/rsa/pkcs1v15.go.html#4403576">tLen</a></span><span class="op" id="4403649">+</span><span class="num" id="4403650">11</span>&nbsp;<span class="op" id="4403653">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403657"><a href="/crypto/rsa/pkcs1v15.go.html#4403471">err</a></span>&nbsp;<span class="op" id="4403661">=</span>&nbsp;<span class="ident" id="4403663"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4403681">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4403689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403693">c</span>&nbsp;<span class="op" id="4403695">:=</span>&nbsp;<span class="builtinfunc" id="4403698">new</span><span class="op" id="4403701">(</span><span class="ident" id="4403702"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4403705">.</span><span class="ident" id="4403706">Int</span><span class="op" id="4403709">)</span><span class="op" id="4403710">.</span><span class="ident" id="4403711">SetBytes</span><span class="op" id="4403719">(</span><span class="ident" id="4403720"><a href="/crypto/rsa/pkcs1v15.go.html#4403458">sig</a></span><span class="op" id="4403723">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403726">m</span>&nbsp;<span class="op" id="4403728">:=</span>&nbsp;<span class="ident" id="4403731"><a href="/crypto/rsa/rsa.go.html#4421660">encrypt</a></span><span class="op" id="4403738">(</span><span class="builtinfunc" id="4403739">new</span><span class="op" id="4403742">(</span><span class="ident" id="4403743"><a href="/crypto/rsa/pkcs1v15.go.html#4395563">big</a></span><span class="op" id="4403746">.</span><span class="ident" id="4403747">Int</span><span class="op" id="4403750">)</span><span class="op" id="4403751">,</span>&nbsp;<span class="ident" id="4403753"><a href="/crypto/rsa/pkcs1v15.go.html#4403409">pub</a></span><span class="op" id="4403756">,</span>&nbsp;<span class="ident" id="4403758"><a href="/crypto/rsa/pkcs1v15.go.html#4403693">c</a></span><span class="op" id="4403759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403762">em</span>&nbsp;<span class="op" id="4403765">:=</span>&nbsp;<span class="ident" id="4403768"><a href="/crypto/rsa/rsa.go.html#4429093">leftPad</a></span><span class="op" id="4403775">(</span><span class="ident" id="4403776"><a href="/crypto/rsa/pkcs1v15.go.html#4403726">m</a></span><span class="op" id="4403777">.</span><span class="ident" id="4403778">Bytes</span><span class="op" id="4403783">(</span><span class="op" id="4403784">)</span><span class="op" id="4403785">,</span>&nbsp;<span class="ident" id="4403787"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4403788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4403791">//&nbsp;EM&nbsp;=&nbsp;0x00&nbsp;||&nbsp;0x01&nbsp;||&nbsp;PS&nbsp;||&nbsp;0x00&nbsp;||&nbsp;T</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403833">ok</span>&nbsp;<span class="op" id="4403836">:=</span>&nbsp;<span class="ident" id="4403839"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4403845">.</span><span class="ident" id="4403846">ConstantTimeByteEq</span><span class="op" id="4403864">(</span><span class="ident" id="4403865"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4403867">[</span><span class="num" id="4403868">0</span><span class="op" id="4403869">]</span><span class="op" id="4403870">,</span>&nbsp;<span class="num" id="4403872">0</span><span class="op" id="4403873">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403876"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4403879">&amp;=</span>&nbsp;<span class="ident" id="4403882"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4403888">.</span><span class="ident" id="4403889">ConstantTimeByteEq</span><span class="op" id="4403907">(</span><span class="ident" id="4403908"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4403910">[</span><span class="num" id="4403911">1</span><span class="op" id="4403912">]</span><span class="op" id="4403913">,</span>&nbsp;<span class="num" id="4403915">1</span><span class="op" id="4403916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403919"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4403922">&amp;=</span>&nbsp;<span class="ident" id="4403925"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4403931">.</span><span class="ident" id="4403932">ConstantTimeCompare</span><span class="op" id="4403951">(</span><span class="ident" id="4403952"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4403954">[</span><span class="ident" id="4403955"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4403956">-</span><span class="ident" id="4403957"><a href="/crypto/rsa/pkcs1v15.go.html#4403485">hashLen</a></span><span class="op" id="4403964">:</span><span class="ident" id="4403965"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4403966">]</span><span class="op" id="4403967">,</span>&nbsp;<span class="ident" id="4403969"><a href="/crypto/rsa/pkcs1v15.go.html#4403443">hashed</a></span><span class="op" id="4403975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4403978"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4403981">&amp;=</span>&nbsp;<span class="ident" id="4403984"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4403990">.</span><span class="ident" id="4403991">ConstantTimeCompare</span><span class="op" id="4404010">(</span><span class="ident" id="4404011"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4404013">[</span><span class="ident" id="4404014"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4404015">-</span><span class="ident" id="4404016"><a href="/crypto/rsa/pkcs1v15.go.html#4403576">tLen</a></span><span class="op" id="4404020">:</span><span class="ident" id="4404021"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4404022">-</span><span class="ident" id="4404023"><a href="/crypto/rsa/pkcs1v15.go.html#4403485">hashLen</a></span><span class="op" id="4404030">]</span><span class="op" id="4404031">,</span>&nbsp;<span class="ident" id="4404033"><a href="/crypto/rsa/pkcs1v15.go.html#4403494">prefix</a></span><span class="op" id="4404039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404042"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4404045">&amp;=</span>&nbsp;<span class="ident" id="4404048"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4404054">.</span><span class="ident" id="4404055">ConstantTimeByteEq</span><span class="op" id="4404073">(</span><span class="ident" id="4404074"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4404076">[</span><span class="ident" id="4404077"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4404078">-</span><span class="ident" id="4404079"><a href="/crypto/rsa/pkcs1v15.go.html#4403576">tLen</a></span><span class="op" id="4404083">-</span><span class="num" id="4404084">1</span><span class="op" id="4404085">]</span><span class="op" id="4404086">,</span>&nbsp;<span class="num" id="4404088">0</span><span class="op" id="4404089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404093">for</span>&nbsp;<span class="ident" id="4404097">i</span>&nbsp;<span class="op" id="4404099">:=</span>&nbsp;<span class="num" id="4404102">2</span><span class="op" id="4404103">;</span>&nbsp;<span class="ident" id="4404105"><a href="/crypto/rsa/pkcs1v15.go.html#4404097">i</a></span>&nbsp;<span class="op" id="4404107">&lt;</span>&nbsp;<span class="ident" id="4404109"><a href="/crypto/rsa/pkcs1v15.go.html#4403607">k</a></span><span class="op" id="4404110">-</span><span class="ident" id="4404111"><a href="/crypto/rsa/pkcs1v15.go.html#4403576">tLen</a></span><span class="op" id="4404115">-</span><span class="num" id="4404116">1</span><span class="op" id="4404117">;</span>&nbsp;<span class="ident" id="4404119"><a href="/crypto/rsa/pkcs1v15.go.html#4404097">i</a></span><span class="op" id="4404120">++</span>&nbsp;<span class="op" id="4404123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404127"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4404130">&amp;=</span>&nbsp;<span class="ident" id="4404133"><a href="/crypto/rsa/pkcs1v15.go.html#4395530">subtle</a></span><span class="op" id="4404139">.</span><span class="ident" id="4404140">ConstantTimeByteEq</span><span class="op" id="4404158">(</span><span class="ident" id="4404159"><a href="/crypto/rsa/pkcs1v15.go.html#4403762">em</a></span><span class="op" id="4404161">[</span><span class="ident" id="4404162"><a href="/crypto/rsa/pkcs1v15.go.html#4404097">i</a></span><span class="op" id="4404163">]</span><span class="op" id="4404164">,</span>&nbsp;<span class="num" id="4404166">0xff</span><span class="op" id="4404170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404177">if</span>&nbsp;<span class="ident" id="4404180"><a href="/crypto/rsa/pkcs1v15.go.html#4403833">ok</a></span>&nbsp;<span class="op" id="4404183">!=</span>&nbsp;<span class="num" id="4404186">1</span>&nbsp;<span class="op" id="4404188">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404192">return</span>&nbsp;<span class="ident" id="4404199"><a href="/crypto/rsa/rsa.go.html#4423148">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404220">return</span>&nbsp;<span class="ident" id="4404227">nil</span><br>
<span class="lineno"></span><span class="op" id="4404231">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4404234">func</span>&nbsp;<span class="ident" id="4404239">pkcs1v15HashInfo</span><span class="op" id="4404255">(</span><span class="ident" id="4404256">hash</span>&nbsp;<span class="ident" id="4404261"><a href="/crypto/rsa/pkcs1v15.go.html#4395520">crypto</a></span><span class="op" id="4404267">.</span><span class="ident" id="4404268">Hash</span><span class="op" id="4404272">,</span>&nbsp;<span class="ident" id="4404274">inLen</span>&nbsp;<span class="builtintype" id="4404280">int</span><span class="op" id="4404283">)</span>&nbsp;<span class="op" id="4404285">(</span><span class="ident" id="4404286">hashLen</span>&nbsp;<span class="builtintype" id="4404294">int</span><span class="op" id="4404297">,</span>&nbsp;<span class="ident" id="4404299">prefix</span>&nbsp;<span class="op" id="4404306">[</span><span class="op" id="4404307">]</span><span class="builtintype" id="4404308">byte</span><span class="op" id="4404312">,</span>&nbsp;<span class="ident" id="4404314">err</span>&nbsp;<span class="builtintype" id="4404318">error</span><span class="op" id="4404323">)</span>&nbsp;<span class="op" id="4404325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4404328">//&nbsp;Special&nbsp;case:&nbsp;crypto.Hash(0)&nbsp;is&nbsp;used&nbsp;to&nbsp;indicate&nbsp;that&nbsp;the&nbsp;data&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4404398">//&nbsp;signed&nbsp;directly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404419">if</span>&nbsp;<span class="ident" id="4404422"><a href="/crypto/rsa/pkcs1v15.go.html#4404256">hash</a></span>&nbsp;<span class="op" id="4404427">==</span>&nbsp;<span class="num" id="4404430">0</span>&nbsp;<span class="op" id="4404432">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404436">return</span>&nbsp;<span class="ident" id="4404443"><a href="/crypto/rsa/pkcs1v15.go.html#4404274">inLen</a></span><span class="op" id="4404448">,</span>&nbsp;<span class="ident" id="4404450">nil</span><span class="op" id="4404453">,</span>&nbsp;<span class="ident" id="4404455">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404464"><a href="/crypto/rsa/pkcs1v15.go.html#4404286">hashLen</a></span>&nbsp;<span class="op" id="4404472">=</span>&nbsp;<span class="ident" id="4404474"><a href="/crypto/rsa/pkcs1v15.go.html#4404256">hash</a></span><span class="op" id="4404478">.</span><span class="ident" id="4404479">Size</span><span class="op" id="4404483">(</span><span class="op" id="4404484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404487">if</span>&nbsp;<span class="ident" id="4404490"><a href="/crypto/rsa/pkcs1v15.go.html#4404274">inLen</a></span>&nbsp;<span class="op" id="4404496">!=</span>&nbsp;<span class="ident" id="4404499"><a href="/crypto/rsa/pkcs1v15.go.html#4404286">hashLen</a></span>&nbsp;<span class="op" id="4404507">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404511">return</span>&nbsp;<span class="num" id="4404518">0</span><span class="op" id="4404519">,</span>&nbsp;<span class="ident" id="4404521">nil</span><span class="op" id="4404524">,</span>&nbsp;<span class="ident" id="4404526"><a href="/crypto/rsa/pkcs1v15.go.html#4395547">errors</a></span><span class="op" id="4404532">.</span><span class="ident" id="4404533">New</span><span class="op" id="4404536">(</span><span class="string" id="4404537">&#34;crypto/rsa:&nbsp;input&nbsp;must&nbsp;be&nbsp;hashed&nbsp;message&#34;</span><span class="op" id="4404579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404585"><a href="/crypto/rsa/pkcs1v15.go.html#4404299">prefix</a></span><span class="op" id="4404591">,</span>&nbsp;<span class="ident" id="4404593">ok</span>&nbsp;<span class="op" id="4404596">:=</span>&nbsp;<span class="ident" id="4404599"><a href="/crypto/rsa/pkcs1v15.go.html#4401096">hashPrefixes</a></span><span class="op" id="4404611">[</span><span class="ident" id="4404612"><a href="/crypto/rsa/pkcs1v15.go.html#4404256">hash</a></span><span class="op" id="4404616">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404619">if</span>&nbsp;<span class="op" id="4404622">!</span><span class="ident" id="4404623"><a href="/crypto/rsa/pkcs1v15.go.html#4404593">ok</a></span>&nbsp;<span class="op" id="4404626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404630">return</span>&nbsp;<span class="num" id="4404637">0</span><span class="op" id="4404638">,</span>&nbsp;<span class="ident" id="4404640">nil</span><span class="op" id="4404643">,</span>&nbsp;<span class="ident" id="4404645"><a href="/crypto/rsa/pkcs1v15.go.html#4395547">errors</a></span><span class="op" id="4404651">.</span><span class="ident" id="4404652">New</span><span class="op" id="4404655">(</span><span class="string" id="4404656">&#34;crypto/rsa:&nbsp;unsupported&nbsp;hash&nbsp;function&#34;</span><span class="op" id="4404695">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404701">return</span><br>
<span class="lineno"></span><span class="op" id="4404708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4404711">//&nbsp;copyWithLeftPad&nbsp;copies&nbsp;src&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;dest,&nbsp;padding&nbsp;with&nbsp;zero&nbsp;bytes&nbsp;as</span><br>
<span class="lineno">285</span><span class="comment" id="4404788">//&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="4404799">func</span>&nbsp;<span class="ident" id="4404804">copyWithLeftPad</span><span class="op" id="4404819">(</span><span class="ident" id="4404820">dest</span><span class="op" id="4404824">,</span>&nbsp;<span class="ident" id="4404826">src</span>&nbsp;<span class="op" id="4404830">[</span><span class="op" id="4404831">]</span><span class="builtintype" id="4404832">byte</span><span class="op" id="4404836">)</span>&nbsp;<span class="op" id="4404838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404841">numPaddingBytes</span>&nbsp;<span class="op" id="4404857">:=</span>&nbsp;<span class="builtinfunc" id="4404860">len</span><span class="op" id="4404863">(</span><span class="ident" id="4404864"><a href="/crypto/rsa/pkcs1v15.go.html#4404820">dest</a></span><span class="op" id="4404868">)</span>&nbsp;<span class="op" id="4404870">-</span>&nbsp;<span class="builtinfunc" id="4404872">len</span><span class="op" id="4404875">(</span><span class="ident" id="4404876"><a href="/crypto/rsa/pkcs1v15.go.html#4404826">src</a></span><span class="op" id="4404879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404882">for</span>&nbsp;<span class="ident" id="4404886">i</span>&nbsp;<span class="op" id="4404888">:=</span>&nbsp;<span class="num" id="4404891">0</span><span class="op" id="4404892">;</span>&nbsp;<span class="ident" id="4404894"><a href="/crypto/rsa/pkcs1v15.go.html#4404886">i</a></span>&nbsp;<span class="op" id="4404896">&lt;</span>&nbsp;<span class="ident" id="4404898"><a href="/crypto/rsa/pkcs1v15.go.html#4404841">numPaddingBytes</a></span><span class="op" id="4404913">;</span>&nbsp;<span class="ident" id="4404915"><a href="/crypto/rsa/pkcs1v15.go.html#4404886">i</a></span><span class="op" id="4404916">++</span>&nbsp;<span class="op" id="4404919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404923"><a href="/crypto/rsa/pkcs1v15.go.html#4404820">dest</a></span><span class="op" id="4404927">[</span><span class="ident" id="4404928"><a href="/crypto/rsa/pkcs1v15.go.html#4404886">i</a></span><span class="op" id="4404929">]</span>&nbsp;<span class="op" id="4404931">=</span>&nbsp;<span class="num" id="4404933">0</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4404939">copy</span><span class="op" id="4404943">(</span><span class="ident" id="4404944"><a href="/crypto/rsa/pkcs1v15.go.html#4404820">dest</a></span><span class="op" id="4404948">[</span><span class="ident" id="4404949"><a href="/crypto/rsa/pkcs1v15.go.html#4404841">numPaddingBytes</a></span><span class="op" id="4404964">:</span><span class="op" id="4404965">]</span><span class="op" id="4404966">,</span>&nbsp;<span class="ident" id="4404968"><a href="/crypto/rsa/pkcs1v15.go.html#4404826">src</a></span><span class="op" id="4404971">)</span><br>
<span class="lineno"></span><span class="op" id="4404973">}</span>
</div>
</body>
</html>
