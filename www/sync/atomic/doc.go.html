<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1693338">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1693394">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1693448">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1693499">//&nbsp;Package&nbsp;atomic&nbsp;provides&nbsp;low-level&nbsp;atomic&nbsp;memory&nbsp;primitives</span><br>
<span class="lineno"></span><span class="comment" id="1693561">//&nbsp;useful&nbsp;for&nbsp;implementing&nbsp;synchronization&nbsp;algorithms.</span><br>
<span class="lineno"></span><span class="comment" id="1693616">//</span><br>
<span class="lineno"></span><span class="comment" id="1693619">//&nbsp;These&nbsp;functions&nbsp;require&nbsp;great&nbsp;care&nbsp;to&nbsp;be&nbsp;used&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="1693679">//&nbsp;Except&nbsp;for&nbsp;special,&nbsp;low-level&nbsp;applications,&nbsp;synchronization&nbsp;is&nbsp;better</span><br>
<span class="lineno">10</span><span class="comment" id="1693752">//&nbsp;done&nbsp;with&nbsp;channels&nbsp;or&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;sync&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="1693813">//&nbsp;Share&nbsp;memory&nbsp;by&nbsp;communicating;</span><br>
<span class="lineno"></span><span class="comment" id="1693847">//&nbsp;don&#39;t&nbsp;communicate&nbsp;by&nbsp;sharing&nbsp;memory.</span><br>
<span class="lineno"></span><span class="comment" id="1693887">//</span><br>
<span class="lineno"></span><span class="comment" id="1693890">//&nbsp;The&nbsp;swap&nbsp;operation,&nbsp;implemented&nbsp;by&nbsp;the&nbsp;SwapT&nbsp;functions,&nbsp;is&nbsp;the&nbsp;atomic</span><br>
<span class="lineno">15</span><span class="comment" id="1693963">//&nbsp;equivalent&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="1693981">//</span><br>
<span class="lineno"></span><span class="comment" id="1693984">//&nbsp;&nbsp;&nbsp;&nbspold&nbsp;=&nbsp;*addr</span><br>
<span class="lineno"></span><span class="comment" id="1693999">//&nbsp;&nbsp;&nbsp;&nbsp*addr&nbsp;=&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="1694014">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;old</span><br>
<span class="lineno">20</span><span class="comment" id="1694028">//</span><br>
<span class="lineno"></span><span class="comment" id="1694031">//&nbsp;The&nbsp;compare-and-swap&nbsp;operation,&nbsp;implemented&nbsp;by&nbsp;the&nbsp;CompareAndSwapT</span><br>
<span class="lineno"></span><span class="comment" id="1694101">//&nbsp;functions,&nbsp;is&nbsp;the&nbsp;atomic&nbsp;equivalent&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="1694144">//</span><br>
<span class="lineno"></span><span class="comment" id="1694147">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;*addr&nbsp;==&nbsp;old&nbsp;{</span><br>
<span class="lineno">25</span><span class="comment" id="1694168">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp*addr&nbsp;=&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="1694184">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;true</span><br>
<span class="lineno"></span><span class="comment" id="1694200">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="1694205">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1694221">//</span><br>
<span class="lineno">30</span><span class="comment" id="1694224">//&nbsp;The&nbsp;add&nbsp;operation,&nbsp;implemented&nbsp;by&nbsp;the&nbsp;AddT&nbsp;functions,&nbsp;is&nbsp;the&nbsp;atomic</span><br>
<span class="lineno"></span><span class="comment" id="1694295">//&nbsp;equivalent&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="1694313">//</span><br>
<span class="lineno"></span><span class="comment" id="1694316">//&nbsp;&nbsp;&nbsp;&nbsp*addr&nbsp;+=&nbsp;delta</span><br>
<span class="lineno"></span><span class="comment" id="1694334">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;*addr</span><br>
<span class="lineno">35</span><span class="comment" id="1694350">//</span><br>
<span class="lineno"></span><span class="comment" id="1694353">//&nbsp;The&nbsp;load&nbsp;and&nbsp;store&nbsp;operations,&nbsp;implemented&nbsp;by&nbsp;the&nbsp;LoadT&nbsp;and&nbsp;StoreT</span><br>
<span class="lineno"></span><span class="comment" id="1694423">//&nbsp;functions,&nbsp;are&nbsp;the&nbsp;atomic&nbsp;equivalents&nbsp;of&nbsp;&#34;return&nbsp;*addr&#34;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1694486">//&nbsp;&#34;*addr&nbsp;=&nbsp;val&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1694504">//</span><br>
<span class="lineno">40</span><span class="keyword" id="1694507">package</span>&nbsp;<span class="ident" id="1694515">atomic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1694523">import</span>&nbsp;<span class="op" id="1694530">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1694533">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1694542">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1694545">//&nbsp;BUG(rsc):&nbsp;On&nbsp;x86-32,&nbsp;the&nbsp;64-bit&nbsp;functions&nbsp;use&nbsp;instructions&nbsp;unavailable&nbsp;before&nbsp;the&nbsp;Pentium&nbsp;MMX.</span><br>
<span class="lineno"></span><span class="comment" id="1694643">//</span><br>
<span class="lineno"></span><span class="comment" id="1694646">//&nbsp;On&nbsp;non-Linux&nbsp;ARM,&nbsp;the&nbsp;64-bit&nbsp;functions&nbsp;use&nbsp;instructions&nbsp;unavailable&nbsp;before&nbsp;the&nbsp;ARMv6k&nbsp;core.</span><br>
<span class="lineno"></span><span class="comment" id="1694741">//</span><br>
<span class="lineno">50</span><span class="comment" id="1694744">//&nbsp;On&nbsp;both&nbsp;ARM&nbsp;and&nbsp;x86-32,&nbsp;it&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;arrange&nbsp;for&nbsp;64-bit</span><br>
<span class="lineno"></span><span class="comment" id="1694827">//&nbsp;alignment&nbsp;of&nbsp;64-bit&nbsp;words&nbsp;accessed&nbsp;atomically.&nbsp;The&nbsp;first&nbsp;word&nbsp;in&nbsp;a&nbsp;global</span><br>
<span class="lineno"></span><span class="comment" id="1694904">//&nbsp;variable&nbsp;or&nbsp;in&nbsp;an&nbsp;allocated&nbsp;struct&nbsp;or&nbsp;slice&nbsp;can&nbsp;be&nbsp;relied&nbsp;upon&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1694976">//&nbsp;64-bit&nbsp;aligned.</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="1694996">//&nbsp;SwapInt32&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695080">func</span>&nbsp;<span class="ident" id="1695085">SwapInt32</span><span class="op" id="1695094">(</span><span class="ident" id="1695095">addr</span>&nbsp;<span class="op" id="1695100">*</span><span class="builtintype" id="1695101">int32</span><span class="op" id="1695106">,</span>&nbsp;<span class="builtinfunc" id="1695108">new</span>&nbsp;<span class="builtintype" id="1695112">int32</span><span class="op" id="1695117">)</span>&nbsp;<span class="op" id="1695119">(</span><span class="ident" id="1695120">old</span>&nbsp;<span class="builtintype" id="1695124">int32</span><span class="op" id="1695129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1695132">//&nbsp;SwapInt64&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695216">func</span>&nbsp;<span class="ident" id="1695221">SwapInt64</span><span class="op" id="1695230">(</span><span class="ident" id="1695231">addr</span>&nbsp;<span class="op" id="1695236">*</span><span class="ident" id="1695237">int64</span><span class="op" id="1695242">,</span>&nbsp;<span class="builtinfunc" id="1695244">new</span>&nbsp;<span class="ident" id="1695248">int64</span><span class="op" id="1695253">)</span>&nbsp;<span class="op" id="1695255">(</span><span class="ident" id="1695256">old</span>&nbsp;<span class="ident" id="1695260">int64</span><span class="op" id="1695265">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1695268">//&nbsp;SwapUint32&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695353">func</span>&nbsp;<span class="ident" id="1695358">SwapUint32</span><span class="op" id="1695368">(</span><span class="ident" id="1695369">addr</span>&nbsp;<span class="op" id="1695374">*</span><span class="builtintype" id="1695375">uint32</span><span class="op" id="1695381">,</span>&nbsp;<span class="builtinfunc" id="1695383">new</span>&nbsp;<span class="builtintype" id="1695387">uint32</span><span class="op" id="1695393">)</span>&nbsp;<span class="op" id="1695395">(</span><span class="ident" id="1695396">old</span>&nbsp;<span class="builtintype" id="1695400">uint32</span><span class="op" id="1695406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1695409">//&nbsp;SwapUint64&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno">65</span><span class="keyword" id="1695494">func</span>&nbsp;<span class="ident" id="1695499">SwapUint64</span><span class="op" id="1695509">(</span><span class="ident" id="1695510">addr</span>&nbsp;<span class="op" id="1695515">*</span><span class="ident" id="1695516">uint64</span><span class="op" id="1695522">,</span>&nbsp;<span class="builtinfunc" id="1695524">new</span>&nbsp;<span class="ident" id="1695528">uint64</span><span class="op" id="1695534">)</span>&nbsp;<span class="op" id="1695536">(</span><span class="ident" id="1695537">old</span>&nbsp;<span class="ident" id="1695541">uint64</span><span class="op" id="1695547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1695550">//&nbsp;SwapUintptr&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695636">func</span>&nbsp;<span class="ident" id="1695641">SwapUintptr</span><span class="op" id="1695652">(</span><span class="ident" id="1695653">addr</span>&nbsp;<span class="op" id="1695658">*</span><span class="builtintype" id="1695659">uintptr</span><span class="op" id="1695666">,</span>&nbsp;<span class="builtinfunc" id="1695668">new</span>&nbsp;<span class="builtintype" id="1695672">uintptr</span><span class="op" id="1695679">)</span>&nbsp;<span class="op" id="1695681">(</span><span class="ident" id="1695682">old</span>&nbsp;<span class="builtintype" id="1695686">uintptr</span><span class="op" id="1695693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1695696">//&nbsp;SwapPointer&nbsp;atomically&nbsp;stores&nbsp;new&nbsp;into&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;*addr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695782">func</span>&nbsp;<span class="ident" id="1695787">SwapPointer</span><span class="op" id="1695798">(</span><span class="ident" id="1695799">addr</span>&nbsp;<span class="op" id="1695804">*</span><span class="ident" id="1695805"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1695811">.</span><span class="ident" id="1695812">Pointer</span><span class="op" id="1695819">,</span>&nbsp;<span class="builtinfunc" id="1695821">new</span>&nbsp;<span class="ident" id="1695825"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1695831">.</span><span class="ident" id="1695832">Pointer</span><span class="op" id="1695839">)</span>&nbsp;<span class="op" id="1695841">(</span><span class="ident" id="1695842">old</span>&nbsp;<span class="ident" id="1695846"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1695852">.</span><span class="ident" id="1695853">Pointer</span><span class="op" id="1695860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1695863">//&nbsp;CompareAndSwapInt32&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;an&nbsp;int32&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1695946">func</span>&nbsp;<span class="ident" id="1695951">CompareAndSwapInt32</span><span class="op" id="1695970">(</span><span class="ident" id="1695971">addr</span>&nbsp;<span class="op" id="1695976">*</span><span class="builtintype" id="1695977">int32</span><span class="op" id="1695982">,</span>&nbsp;<span class="ident" id="1695984">old</span><span class="op" id="1695987">,</span>&nbsp;<span class="builtinfunc" id="1695989">new</span>&nbsp;<span class="builtintype" id="1695993">int32</span><span class="op" id="1695998">)</span>&nbsp;<span class="op" id="1696000">(</span><span class="ident" id="1696001">swapped</span>&nbsp;<span class="builtintype" id="1696009">bool</span><span class="op" id="1696013">)</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="1696016">//&nbsp;CompareAndSwapInt64&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;an&nbsp;int64&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1696099">func</span>&nbsp;<span class="ident" id="1696104">CompareAndSwapInt64</span><span class="op" id="1696123">(</span><span class="ident" id="1696124">addr</span>&nbsp;<span class="op" id="1696129">*</span><span class="ident" id="1696130">int64</span><span class="op" id="1696135">,</span>&nbsp;<span class="ident" id="1696137">old</span><span class="op" id="1696140">,</span>&nbsp;<span class="builtinfunc" id="1696142">new</span>&nbsp;<span class="ident" id="1696146">int64</span><span class="op" id="1696151">)</span>&nbsp;<span class="op" id="1696153">(</span><span class="ident" id="1696154">swapped</span>&nbsp;<span class="builtintype" id="1696162">bool</span><span class="op" id="1696166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1696169">//&nbsp;CompareAndSwapUint32&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;a&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno">80</span><span class="keyword" id="1696253">func</span>&nbsp;<span class="ident" id="1696258">CompareAndSwapUint32</span><span class="op" id="1696278">(</span><span class="ident" id="1696279">addr</span>&nbsp;<span class="op" id="1696284">*</span><span class="builtintype" id="1696285">uint32</span><span class="op" id="1696291">,</span>&nbsp;<span class="ident" id="1696293">old</span><span class="op" id="1696296">,</span>&nbsp;<span class="builtinfunc" id="1696298">new</span>&nbsp;<span class="builtintype" id="1696302">uint32</span><span class="op" id="1696308">)</span>&nbsp;<span class="op" id="1696310">(</span><span class="ident" id="1696311">swapped</span>&nbsp;<span class="builtintype" id="1696319">bool</span><span class="op" id="1696323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1696326">//&nbsp;CompareAndSwapUint64&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;a&nbsp;uint64&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1696410">func</span>&nbsp;<span class="ident" id="1696415">CompareAndSwapUint64</span><span class="op" id="1696435">(</span><span class="ident" id="1696436">addr</span>&nbsp;<span class="op" id="1696441">*</span><span class="ident" id="1696442">uint64</span><span class="op" id="1696448">,</span>&nbsp;<span class="ident" id="1696450">old</span><span class="op" id="1696453">,</span>&nbsp;<span class="builtinfunc" id="1696455">new</span>&nbsp;<span class="ident" id="1696459">uint64</span><span class="op" id="1696465">)</span>&nbsp;<span class="op" id="1696467">(</span><span class="ident" id="1696468">swapped</span>&nbsp;<span class="builtintype" id="1696476">bool</span><span class="op" id="1696480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1696483">//&nbsp;CompareAndSwapUintptr&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;a&nbsp;uintptr&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1696569">func</span>&nbsp;<span class="ident" id="1696574">CompareAndSwapUintptr</span><span class="op" id="1696595">(</span><span class="ident" id="1696596">addr</span>&nbsp;<span class="op" id="1696601">*</span><span class="builtintype" id="1696602">uintptr</span><span class="op" id="1696609">,</span>&nbsp;<span class="ident" id="1696611">old</span><span class="op" id="1696614">,</span>&nbsp;<span class="builtinfunc" id="1696616">new</span>&nbsp;<span class="builtintype" id="1696620">uintptr</span><span class="op" id="1696627">)</span>&nbsp;<span class="op" id="1696629">(</span><span class="ident" id="1696630">swapped</span>&nbsp;<span class="builtintype" id="1696638">bool</span><span class="op" id="1696642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1696645">//&nbsp;CompareAndSwapPointer&nbsp;executes&nbsp;the&nbsp;compare-and-swap&nbsp;operation&nbsp;for&nbsp;a&nbsp;unsafe.Pointer&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1696738">func</span>&nbsp;<span class="ident" id="1696743">CompareAndSwapPointer</span><span class="op" id="1696764">(</span><span class="ident" id="1696765">addr</span>&nbsp;<span class="op" id="1696770">*</span><span class="ident" id="1696771"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1696777">.</span><span class="ident" id="1696778">Pointer</span><span class="op" id="1696785">,</span>&nbsp;<span class="ident" id="1696787">old</span><span class="op" id="1696790">,</span>&nbsp;<span class="builtinfunc" id="1696792">new</span>&nbsp;<span class="ident" id="1696796"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1696802">.</span><span class="ident" id="1696803">Pointer</span><span class="op" id="1696810">)</span>&nbsp;<span class="op" id="1696812">(</span><span class="ident" id="1696813">swapped</span>&nbsp;<span class="builtintype" id="1696821">bool</span><span class="op" id="1696825">)</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1696828">//&nbsp;AddInt32&nbsp;atomically&nbsp;adds&nbsp;delta&nbsp;to&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1696898">func</span>&nbsp;<span class="ident" id="1696903">AddInt32</span><span class="op" id="1696911">(</span><span class="ident" id="1696912">addr</span>&nbsp;<span class="op" id="1696917">*</span><span class="builtintype" id="1696918">int32</span><span class="op" id="1696923">,</span>&nbsp;<span class="ident" id="1696925">delta</span>&nbsp;<span class="builtintype" id="1696931">int32</span><span class="op" id="1696936">)</span>&nbsp;<span class="op" id="1696938">(</span><span class="builtinfunc" id="1696939">new</span>&nbsp;<span class="builtintype" id="1696943">int32</span><span class="op" id="1696948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1696951">//&nbsp;AddUint32&nbsp;atomically&nbsp;adds&nbsp;delta&nbsp;to&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.</span><br>
<span class="lineno">95</span><span class="comment" id="1697022">//&nbsp;To&nbsp;subtract&nbsp;a&nbsp;signed&nbsp;positive&nbsp;constant&nbsp;value&nbsp;c&nbsp;from&nbsp;x,&nbsp;do&nbsp;AddUint32(&amp;x,&nbsp;^uint32(c-1)).</span><br>
<span class="lineno"></span><span class="comment" id="1697112">//&nbsp;In&nbsp;particular,&nbsp;to&nbsp;decrement&nbsp;x,&nbsp;do&nbsp;AddUint32(&amp;x,&nbsp;^uint32(0)).</span><br>
<span class="lineno"></span><span class="keyword" id="1697176">func</span>&nbsp;<span class="ident" id="1697181">AddUint32</span><span class="op" id="1697190">(</span><span class="ident" id="1697191">addr</span>&nbsp;<span class="op" id="1697196">*</span><span class="builtintype" id="1697197">uint32</span><span class="op" id="1697203">,</span>&nbsp;<span class="ident" id="1697205">delta</span>&nbsp;<span class="builtintype" id="1697211">uint32</span><span class="op" id="1697217">)</span>&nbsp;<span class="op" id="1697219">(</span><span class="builtinfunc" id="1697220">new</span>&nbsp;<span class="builtintype" id="1697224">uint32</span><span class="op" id="1697230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1697233">//&nbsp;AddInt64&nbsp;atomically&nbsp;adds&nbsp;delta&nbsp;to&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.</span><br>
<span class="lineno">100</span><span class="keyword" id="1697303">func</span>&nbsp;<span class="ident" id="1697308">AddInt64</span><span class="op" id="1697316">(</span><span class="ident" id="1697317">addr</span>&nbsp;<span class="op" id="1697322">*</span><span class="ident" id="1697323">int64</span><span class="op" id="1697328">,</span>&nbsp;<span class="ident" id="1697330">delta</span>&nbsp;<span class="ident" id="1697336">int64</span><span class="op" id="1697341">)</span>&nbsp;<span class="op" id="1697343">(</span><span class="builtinfunc" id="1697344">new</span>&nbsp;<span class="ident" id="1697348">int64</span><span class="op" id="1697353">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1697356">//&nbsp;AddUint64&nbsp;atomically&nbsp;adds&nbsp;delta&nbsp;to&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="1697427">//&nbsp;To&nbsp;subtract&nbsp;a&nbsp;signed&nbsp;positive&nbsp;constant&nbsp;value&nbsp;c&nbsp;from&nbsp;x,&nbsp;do&nbsp;AddUint64(&amp;x,&nbsp;^uint64(c-1)).</span><br>
<span class="lineno"></span><span class="comment" id="1697517">//&nbsp;In&nbsp;particular,&nbsp;to&nbsp;decrement&nbsp;x,&nbsp;do&nbsp;AddUint64(&amp;x,&nbsp;^uint64(0)).</span><br>
<span class="lineno">105</span><span class="keyword" id="1697581">func</span>&nbsp;<span class="ident" id="1697586">AddUint64</span><span class="op" id="1697595">(</span><span class="ident" id="1697596">addr</span>&nbsp;<span class="op" id="1697601">*</span><span class="ident" id="1697602">uint64</span><span class="op" id="1697608">,</span>&nbsp;<span class="ident" id="1697610">delta</span>&nbsp;<span class="ident" id="1697616">uint64</span><span class="op" id="1697622">)</span>&nbsp;<span class="op" id="1697624">(</span><span class="builtinfunc" id="1697625">new</span>&nbsp;<span class="ident" id="1697629">uint64</span><span class="op" id="1697635">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1697638">//&nbsp;AddUintptr&nbsp;atomically&nbsp;adds&nbsp;delta&nbsp;to&nbsp;*addr&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1697710">func</span>&nbsp;<span class="ident" id="1697715">AddUintptr</span><span class="op" id="1697725">(</span><span class="ident" id="1697726">addr</span>&nbsp;<span class="op" id="1697731">*</span><span class="builtintype" id="1697732">uintptr</span><span class="op" id="1697739">,</span>&nbsp;<span class="ident" id="1697741">delta</span>&nbsp;<span class="builtintype" id="1697747">uintptr</span><span class="op" id="1697754">)</span>&nbsp;<span class="op" id="1697756">(</span><span class="builtinfunc" id="1697757">new</span>&nbsp;<span class="builtintype" id="1697761">uintptr</span><span class="op" id="1697768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1697771">//&nbsp;LoadInt32&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1697808">func</span>&nbsp;<span class="ident" id="1697813">LoadInt32</span><span class="op" id="1697822">(</span><span class="ident" id="1697823">addr</span>&nbsp;<span class="op" id="1697828">*</span><span class="builtintype" id="1697829">int32</span><span class="op" id="1697834">)</span>&nbsp;<span class="op" id="1697836">(</span><span class="ident" id="1697837">val</span>&nbsp;<span class="builtintype" id="1697841">int32</span><span class="op" id="1697846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1697849">//&nbsp;LoadInt64&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1697886">func</span>&nbsp;<span class="ident" id="1697891">LoadInt64</span><span class="op" id="1697900">(</span><span class="ident" id="1697901">addr</span>&nbsp;<span class="op" id="1697906">*</span><span class="ident" id="1697907">int64</span><span class="op" id="1697912">)</span>&nbsp;<span class="op" id="1697914">(</span><span class="ident" id="1697915">val</span>&nbsp;<span class="ident" id="1697919">int64</span><span class="op" id="1697924">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1697927">//&nbsp;LoadUint32&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1697965">func</span>&nbsp;<span class="ident" id="1697970">LoadUint32</span><span class="op" id="1697980">(</span><span class="ident" id="1697981">addr</span>&nbsp;<span class="op" id="1697986">*</span><span class="builtintype" id="1697987">uint32</span><span class="op" id="1697993">)</span>&nbsp;<span class="op" id="1697995">(</span><span class="ident" id="1697996">val</span>&nbsp;<span class="builtintype" id="1698000">uint32</span><span class="op" id="1698006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698009">//&nbsp;LoadUint64&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno">120</span><span class="keyword" id="1698047">func</span>&nbsp;<span class="ident" id="1698052">LoadUint64</span><span class="op" id="1698062">(</span><span class="ident" id="1698063">addr</span>&nbsp;<span class="op" id="1698068">*</span><span class="ident" id="1698069">uint64</span><span class="op" id="1698075">)</span>&nbsp;<span class="op" id="1698077">(</span><span class="ident" id="1698078">val</span>&nbsp;<span class="ident" id="1698082">uint64</span><span class="op" id="1698088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698091">//&nbsp;LoadUintptr&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698130">func</span>&nbsp;<span class="ident" id="1698135">LoadUintptr</span><span class="op" id="1698146">(</span><span class="ident" id="1698147">addr</span>&nbsp;<span class="op" id="1698152">*</span><span class="builtintype" id="1698153">uintptr</span><span class="op" id="1698160">)</span>&nbsp;<span class="op" id="1698162">(</span><span class="ident" id="1698163">val</span>&nbsp;<span class="builtintype" id="1698167">uintptr</span><span class="op" id="1698174">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1698177">//&nbsp;LoadPointer&nbsp;atomically&nbsp;loads&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698216">func</span>&nbsp;<span class="ident" id="1698221">LoadPointer</span><span class="op" id="1698232">(</span><span class="ident" id="1698233">addr</span>&nbsp;<span class="op" id="1698238">*</span><span class="ident" id="1698239"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1698245">.</span><span class="ident" id="1698246">Pointer</span><span class="op" id="1698253">)</span>&nbsp;<span class="op" id="1698255">(</span><span class="ident" id="1698256">val</span>&nbsp;<span class="ident" id="1698260"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1698266">.</span><span class="ident" id="1698267">Pointer</span><span class="op" id="1698274">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698277">//&nbsp;StoreInt32&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698325">func</span>&nbsp;<span class="ident" id="1698330">StoreInt32</span><span class="op" id="1698340">(</span><span class="ident" id="1698341">addr</span>&nbsp;<span class="op" id="1698346">*</span><span class="builtintype" id="1698347">int32</span><span class="op" id="1698352">,</span>&nbsp;<span class="ident" id="1698354">val</span>&nbsp;<span class="builtintype" id="1698358">int32</span><span class="op" id="1698363">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="1698366">//&nbsp;StoreInt64&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698414">func</span>&nbsp;<span class="ident" id="1698419">StoreInt64</span><span class="op" id="1698429">(</span><span class="ident" id="1698430">addr</span>&nbsp;<span class="op" id="1698435">*</span><span class="ident" id="1698436">int64</span><span class="op" id="1698441">,</span>&nbsp;<span class="ident" id="1698443">val</span>&nbsp;<span class="ident" id="1698447">int64</span><span class="op" id="1698452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698455">//&nbsp;StoreUint32&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno">135</span><span class="keyword" id="1698504">func</span>&nbsp;<span class="ident" id="1698509">StoreUint32</span><span class="op" id="1698520">(</span><span class="ident" id="1698521">addr</span>&nbsp;<span class="op" id="1698526">*</span><span class="builtintype" id="1698527">uint32</span><span class="op" id="1698533">,</span>&nbsp;<span class="ident" id="1698535">val</span>&nbsp;<span class="builtintype" id="1698539">uint32</span><span class="op" id="1698545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698548">//&nbsp;StoreUint64&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698597">func</span>&nbsp;<span class="ident" id="1698602">StoreUint64</span><span class="op" id="1698613">(</span><span class="ident" id="1698614">addr</span>&nbsp;<span class="op" id="1698619">*</span><span class="ident" id="1698620">uint64</span><span class="op" id="1698626">,</span>&nbsp;<span class="ident" id="1698628">val</span>&nbsp;<span class="ident" id="1698632">uint64</span><span class="op" id="1698638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1698641">//&nbsp;StoreUintptr&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698691">func</span>&nbsp;<span class="ident" id="1698696">StoreUintptr</span><span class="op" id="1698708">(</span><span class="ident" id="1698709">addr</span>&nbsp;<span class="op" id="1698714">*</span><span class="builtintype" id="1698715">uintptr</span><span class="op" id="1698722">,</span>&nbsp;<span class="ident" id="1698724">val</span>&nbsp;<span class="builtintype" id="1698728">uintptr</span><span class="op" id="1698735">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1698738">//&nbsp;StorePointer&nbsp;atomically&nbsp;stores&nbsp;val&nbsp;into&nbsp;*addr.</span><br>
<span class="lineno"></span><span class="keyword" id="1698788">func</span>&nbsp;<span class="ident" id="1698793">StorePointer</span><span class="op" id="1698805">(</span><span class="ident" id="1698806">addr</span>&nbsp;<span class="op" id="1698811">*</span><span class="ident" id="1698812"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1698818">.</span><span class="ident" id="1698819">Pointer</span><span class="op" id="1698826">,</span>&nbsp;<span class="ident" id="1698828">val</span>&nbsp;<span class="ident" id="1698832"><a href="/sync/atomic/doc.go.html#1694533">unsafe</a></span><span class="op" id="1698838">.</span><span class="ident" id="1698839">Pointer</span><span class="op" id="1698846">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="1698849">//&nbsp;Helper&nbsp;for&nbsp;ARM.&nbsp;&nbsp;Linker&nbsp;will&nbsp;discard&nbsp;on&nbsp;other&nbsp;systems</span><br>
<span class="lineno"></span><span class="keyword" id="1698906">func</span>&nbsp;<span class="ident" id="1698911">panic64</span><span class="op" id="1698918">(</span><span class="op" id="1698919">)</span>&nbsp;<span class="op" id="1698921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1698924">panic</span><span class="op" id="1698929">(</span><span class="string" id="1698930">&#34;sync/atomic:&nbsp;broken&nbsp;64-bit&nbsp;atomic&nbsp;operations&nbsp;(buggy&nbsp;QEMU)&#34;</span><span class="op" id="1698989">)</span><br>
<span class="lineno"></span><span class="op" id="1698991">}</span>
</div>
</body>
</html>
