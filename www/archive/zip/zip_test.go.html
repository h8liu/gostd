<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8393478">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8393533">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8393587">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="8393638">//&nbsp;Tests&nbsp;that&nbsp;involve&nbsp;both&nbsp;reading&nbsp;and&nbsp;writing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8393687">package</span>&nbsp;<span class="ident" id="8393695">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8393700">import</span>&nbsp;<span class="op" id="8393707">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393710">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393719">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393726">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393734">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393740">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393753">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393761">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393772">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8393783">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8393790">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8393793">func</span>&nbsp;<span class="ident" id="8393798">TestOver65kFiles</span><span class="op" id="8393814">(</span><span class="ident" id="8393815">t</span>&nbsp;<span class="op" id="8393817">*</span><span class="ident" id="8393818"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8393825">.</span><span class="ident" id="8393826">T</span><span class="op" id="8393827">)</span>&nbsp;<span class="op" id="8393829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393832">buf</span>&nbsp;<span class="op" id="8393836">:=</span>&nbsp;<span class="builtinfunc" id="8393839">new</span><span class="op" id="8393842">(</span><span class="ident" id="8393843"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8393848">.</span><span class="ident" id="8393849">Buffer</span><span class="op" id="8393855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393858">w</span>&nbsp;<span class="op" id="8393860">:=</span>&nbsp;<span class="ident" id="8393863"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8393872">(</span><span class="ident" id="8393873"><a href="/archive/zip/zip_test.go.html#8393832">buf</a></span><span class="op" id="8393876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393879">const</span>&nbsp;<span class="ident" id="8393885">nFiles</span>&nbsp;<span class="op" id="8393892">=</span>&nbsp;<span class="op" id="8393894">(</span><span class="num" id="8393895">1</span>&nbsp;<span class="op" id="8393897">&lt;&lt;</span>&nbsp;<span class="num" id="8393900">16</span><span class="op" id="8393902">)</span>&nbsp;<span class="op" id="8393904">+</span>&nbsp;<span class="num" id="8393906">42</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8393910">for</span>&nbsp;<span class="ident" id="8393914">i</span>&nbsp;<span class="op" id="8393916">:=</span>&nbsp;<span class="num" id="8393919">0</span><span class="op" id="8393920">;</span>&nbsp;<span class="ident" id="8393922"><a href="/archive/zip/zip_test.go.html#8393914">i</a></span>&nbsp;<span class="op" id="8393924">&lt;</span>&nbsp;<span class="ident" id="8393926"><a href="/archive/zip/zip_test.go.html#8393885">nFiles</a></span><span class="op" id="8393932">;</span>&nbsp;<span class="ident" id="8393934"><a href="/archive/zip/zip_test.go.html#8393914">i</a></span><span class="op" id="8393935">++</span>&nbsp;<span class="op" id="8393938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393942">_</span><span class="op" id="8393943">,</span>&nbsp;<span class="ident" id="8393945">err</span>&nbsp;<span class="op" id="8393949">:=</span>&nbsp;<span class="ident" id="8393952"><a href="/archive/zip/zip_test.go.html#8393858">w</a></span><span class="op" id="8393953">.</span><span class="ident" id="8393954">CreateHeader</span><span class="op" id="8393966">(</span><span class="op" id="8393967">&amp;</span><span class="ident" id="8393968"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8393978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8393983">Name</span><span class="op" id="8393987">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8393991"><a href="/archive/zip/zip_test.go.html#8393719">fmt</a></span><span class="op" id="8393994">.</span><span class="ident" id="8393995">Sprintf</span><span class="op" id="8394002">(</span><span class="string" id="8394003">&#34;%d.dat&#34;</span><span class="op" id="8394011">,</span>&nbsp;<span class="ident" id="8394013"><a href="/archive/zip/zip_test.go.html#8393914">i</a></span><span class="op" id="8394014">)</span><span class="op" id="8394015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394020">Method</span><span class="op" id="8394026">:</span>&nbsp;<span class="ident" id="8394028"><a href="/archive/zip/struct.go.html#5697026">Store</a></span><span class="op" id="8394033">,</span>&nbsp;<span class="comment" id="8394035">//&nbsp;avoid&nbsp;Issue&nbsp;6136&nbsp;and&nbsp;Issue&nbsp;6138</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394072">}</span><span class="op" id="8394073">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394077">if</span>&nbsp;<span class="ident" id="8394080"><a href="/archive/zip/zip_test.go.html#8393945">err</a></span>&nbsp;<span class="op" id="8394084">!=</span>&nbsp;<span class="ident" id="8394087">nil</span>&nbsp;<span class="op" id="8394091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394096"><a href="/archive/zip/zip_test.go.html#8393815">t</a></span><span class="op" id="8394097">.</span><span class="ident" id="8394098">Fatalf</span><span class="op" id="8394104">(</span><span class="string" id="8394105">&#34;creating&nbsp;file&nbsp;%d:&nbsp;%v&#34;</span><span class="op" id="8394127">,</span>&nbsp;<span class="ident" id="8394129"><a href="/archive/zip/zip_test.go.html#8393914">i</a></span><span class="op" id="8394130">,</span>&nbsp;<span class="ident" id="8394132"><a href="/archive/zip/zip_test.go.html#8393945">err</a></span><span class="op" id="8394135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394145">if</span>&nbsp;<span class="ident" id="8394148">err</span>&nbsp;<span class="op" id="8394152">:=</span>&nbsp;<span class="ident" id="8394155"><a href="/archive/zip/zip_test.go.html#8393858">w</a></span><span class="op" id="8394156">.</span><span class="ident" id="8394157">Close</span><span class="op" id="8394162">(</span><span class="op" id="8394163">)</span><span class="op" id="8394164">;</span>&nbsp;<span class="ident" id="8394166"><a href="/archive/zip/zip_test.go.html#8394148">err</a></span>&nbsp;<span class="op" id="8394170">!=</span>&nbsp;<span class="ident" id="8394173">nil</span>&nbsp;<span class="op" id="8394177">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394181"><a href="/archive/zip/zip_test.go.html#8393815">t</a></span><span class="op" id="8394182">.</span><span class="ident" id="8394183">Fatalf</span><span class="op" id="8394189">(</span><span class="string" id="8394190">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="8394208">,</span>&nbsp;<span class="ident" id="8394210"><a href="/archive/zip/zip_test.go.html#8394148">err</a></span><span class="op" id="8394213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394219">s</span>&nbsp;<span class="op" id="8394221">:=</span>&nbsp;<span class="ident" id="8394224"><a href="/archive/zip/zip_test.go.html#8393832">buf</a></span><span class="op" id="8394227">.</span><span class="ident" id="8394228">String</span><span class="op" id="8394234">(</span><span class="op" id="8394235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394238">zr</span><span class="op" id="8394240">,</span>&nbsp;<span class="ident" id="8394242">err</span>&nbsp;<span class="op" id="8394246">:=</span>&nbsp;<span class="ident" id="8394249"><a href="/archive/zip/reader.go.html#5682445">NewReader</a></span><span class="op" id="8394258">(</span><span class="ident" id="8394259"><a href="/archive/zip/zip_test.go.html#8393761">strings</a></span><span class="op" id="8394266">.</span><span class="ident" id="8394267">NewReader</span><span class="op" id="8394276">(</span><span class="ident" id="8394277"><a href="/archive/zip/zip_test.go.html#8394219">s</a></span><span class="op" id="8394278">)</span><span class="op" id="8394279">,</span>&nbsp;<span class="ident" id="8394281">int64</span><span class="op" id="8394286">(</span><span class="builtinfunc" id="8394287">len</span><span class="op" id="8394290">(</span><span class="ident" id="8394291"><a href="/archive/zip/zip_test.go.html#8394219">s</a></span><span class="op" id="8394292">)</span><span class="op" id="8394293">)</span><span class="op" id="8394294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394297">if</span>&nbsp;<span class="ident" id="8394300"><a href="/archive/zip/zip_test.go.html#8394242">err</a></span>&nbsp;<span class="op" id="8394304">!=</span>&nbsp;<span class="ident" id="8394307">nil</span>&nbsp;<span class="op" id="8394311">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394315"><a href="/archive/zip/zip_test.go.html#8393815">t</a></span><span class="op" id="8394316">.</span><span class="ident" id="8394317">Fatalf</span><span class="op" id="8394323">(</span><span class="string" id="8394324">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="8394339">,</span>&nbsp;<span class="ident" id="8394341"><a href="/archive/zip/zip_test.go.html#8394242">err</a></span><span class="op" id="8394344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394350">if</span>&nbsp;<span class="ident" id="8394353">got</span>&nbsp;<span class="op" id="8394357">:=</span>&nbsp;<span class="builtinfunc" id="8394360">len</span><span class="op" id="8394363">(</span><span class="ident" id="8394364"><a href="/archive/zip/zip_test.go.html#8394238">zr</a></span><span class="op" id="8394366">.</span><span class="ident" id="8394367">File</span><span class="op" id="8394371">)</span><span class="op" id="8394372">;</span>&nbsp;<span class="ident" id="8394374"><a href="/archive/zip/zip_test.go.html#8394353">got</a></span>&nbsp;<span class="op" id="8394378">!=</span>&nbsp;<span class="ident" id="8394381"><a href="/archive/zip/zip_test.go.html#8393885">nFiles</a></span>&nbsp;<span class="op" id="8394388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394392"><a href="/archive/zip/zip_test.go.html#8393815">t</a></span><span class="op" id="8394393">.</span><span class="ident" id="8394394">Fatalf</span><span class="op" id="8394400">(</span><span class="string" id="8394401">&#34;File&nbsp;contains&nbsp;%d&nbsp;files,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8394434">,</span>&nbsp;<span class="ident" id="8394436"><a href="/archive/zip/zip_test.go.html#8394353">got</a></span><span class="op" id="8394439">,</span>&nbsp;<span class="ident" id="8394441"><a href="/archive/zip/zip_test.go.html#8393885">nFiles</a></span><span class="op" id="8394447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394450">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394453">for</span>&nbsp;<span class="ident" id="8394457">i</span>&nbsp;<span class="op" id="8394459">:=</span>&nbsp;<span class="num" id="8394462">0</span><span class="op" id="8394463">;</span>&nbsp;<span class="ident" id="8394465"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span>&nbsp;<span class="op" id="8394467">&lt;</span>&nbsp;<span class="ident" id="8394469"><a href="/archive/zip/zip_test.go.html#8393885">nFiles</a></span><span class="op" id="8394475">;</span>&nbsp;<span class="ident" id="8394477"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span><span class="op" id="8394478">++</span>&nbsp;<span class="op" id="8394481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394485">want</span>&nbsp;<span class="op" id="8394490">:=</span>&nbsp;<span class="ident" id="8394493"><a href="/archive/zip/zip_test.go.html#8393719">fmt</a></span><span class="op" id="8394496">.</span><span class="ident" id="8394497">Sprintf</span><span class="op" id="8394504">(</span><span class="string" id="8394505">&#34;%d.dat&#34;</span><span class="op" id="8394513">,</span>&nbsp;<span class="ident" id="8394515"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span><span class="op" id="8394516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394520">if</span>&nbsp;<span class="ident" id="8394523"><a href="/archive/zip/zip_test.go.html#8394238">zr</a></span><span class="op" id="8394525">.</span><span class="ident" id="8394526">File</span><span class="op" id="8394530">[</span><span class="ident" id="8394531"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span><span class="op" id="8394532">]</span><span class="op" id="8394533">.</span><span class="ident" id="8394534">Name</span>&nbsp;<span class="op" id="8394539">!=</span>&nbsp;<span class="ident" id="8394542"><a href="/archive/zip/zip_test.go.html#8394485">want</a></span>&nbsp;<span class="op" id="8394547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394552"><a href="/archive/zip/zip_test.go.html#8393815">t</a></span><span class="op" id="8394553">.</span><span class="ident" id="8394554">Fatalf</span><span class="op" id="8394560">(</span><span class="string" id="8394561">&#34;File(%d)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8394585">,</span>&nbsp;<span class="ident" id="8394587"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span><span class="op" id="8394588">,</span>&nbsp;<span class="ident" id="8394590"><a href="/archive/zip/zip_test.go.html#8394238">zr</a></span><span class="op" id="8394592">.</span><span class="ident" id="8394593">File</span><span class="op" id="8394597">[</span><span class="ident" id="8394598"><a href="/archive/zip/zip_test.go.html#8394457">i</a></span><span class="op" id="8394599">]</span><span class="op" id="8394600">.</span><span class="ident" id="8394601">Name</span><span class="op" id="8394605">,</span>&nbsp;<span class="ident" id="8394607"><a href="/archive/zip/zip_test.go.html#8394485">want</a></span><span class="op" id="8394611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394615">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394618">}</span><br>
<span class="lineno"></span><span class="op" id="8394620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8394623">func</span>&nbsp;<span class="ident" id="8394628">TestModTime</span><span class="op" id="8394639">(</span><span class="ident" id="8394640">t</span>&nbsp;<span class="op" id="8394642">*</span><span class="ident" id="8394643"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8394650">.</span><span class="ident" id="8394651">T</span><span class="op" id="8394652">)</span>&nbsp;<span class="op" id="8394654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394657">var</span>&nbsp;<span class="ident" id="8394661">testTime</span>&nbsp;<span class="op" id="8394670">=</span>&nbsp;<span class="ident" id="8394672"><a href="/archive/zip/zip_test.go.html#8393783">time</a></span><span class="op" id="8394676">.</span><span class="ident" id="8394677">Date</span><span class="op" id="8394681">(</span><span class="num" id="8394682">2009</span><span class="op" id="8394686">,</span>&nbsp;<span class="ident" id="8394688"><a href="/archive/zip/zip_test.go.html#8393783">time</a></span><span class="op" id="8394692">.</span><span class="ident" id="8394693">November</span><span class="op" id="8394701">,</span>&nbsp;<span class="num" id="8394703">10</span><span class="op" id="8394705">,</span>&nbsp;<span class="num" id="8394707">23</span><span class="op" id="8394709">,</span>&nbsp;<span class="num" id="8394711">45</span><span class="op" id="8394713">,</span>&nbsp;<span class="num" id="8394715">58</span><span class="op" id="8394717">,</span>&nbsp;<span class="num" id="8394719">0</span><span class="op" id="8394720">,</span>&nbsp;<span class="ident" id="8394722"><a href="/archive/zip/zip_test.go.html#8393783">time</a></span><span class="op" id="8394726">.</span><span class="ident" id="8394727">UTC</span><span class="op" id="8394730">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394733">fh</span>&nbsp;<span class="op" id="8394736">:=</span>&nbsp;<span class="builtinfunc" id="8394739">new</span><span class="op" id="8394742">(</span><span class="ident" id="8394743"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8394753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394756"><a href="/archive/zip/zip_test.go.html#8394733">fh</a></span><span class="op" id="8394758">.</span><span class="ident" id="8394759">SetModTime</span><span class="op" id="8394769">(</span><span class="ident" id="8394770"><a href="/archive/zip/zip_test.go.html#8394661">testTime</a></span><span class="op" id="8394778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394781">outTime</span>&nbsp;<span class="op" id="8394789">:=</span>&nbsp;<span class="ident" id="8394792"><a href="/archive/zip/zip_test.go.html#8394733">fh</a></span><span class="op" id="8394794">.</span><span class="ident" id="8394795">ModTime</span><span class="op" id="8394802">(</span><span class="op" id="8394803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8394806">if</span>&nbsp;<span class="op" id="8394809">!</span><span class="ident" id="8394810"><a href="/archive/zip/zip_test.go.html#8394781">outTime</a></span><span class="op" id="8394817">.</span><span class="ident" id="8394818">Equal</span><span class="op" id="8394823">(</span><span class="ident" id="8394824"><a href="/archive/zip/zip_test.go.html#8394661">testTime</a></span><span class="op" id="8394832">)</span>&nbsp;<span class="op" id="8394834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8394838"><a href="/archive/zip/zip_test.go.html#8394640">t</a></span><span class="op" id="8394839">.</span><span class="ident" id="8394840">Errorf</span><span class="op" id="8394846">(</span><span class="string" id="8394847">&#34;times&nbsp;don&#39;t&nbsp;match:&nbsp;got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8394883">,</span>&nbsp;<span class="ident" id="8394885"><a href="/archive/zip/zip_test.go.html#8394781">outTime</a></span><span class="op" id="8394892">,</span>&nbsp;<span class="ident" id="8394894"><a href="/archive/zip/zip_test.go.html#8394661">testTime</a></span><span class="op" id="8394902">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8394905">}</span><br>
<span class="lineno"></span><span class="op" id="8394907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8394910">func</span>&nbsp;<span class="ident" id="8394915">testHeaderRoundTrip</span><span class="op" id="8394934">(</span><span class="ident" id="8394935">fh</span>&nbsp;<span class="op" id="8394938">*</span><span class="ident" id="8394939"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8394949">,</span>&nbsp;<span class="ident" id="8394951">wantUncompressedSize</span>&nbsp;<span class="builtintype" id="8394972">uint32</span><span class="op" id="8394978">,</span>&nbsp;<span class="ident" id="8394980">wantUncompressedSize64</span>&nbsp;<span class="ident" id="8395003">uint64</span><span class="op" id="8395009">,</span>&nbsp;<span class="ident" id="8395011">t</span>&nbsp;<span class="op" id="8395013">*</span><span class="ident" id="8395014"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8395021">.</span><span class="ident" id="8395022">T</span><span class="op" id="8395023">)</span>&nbsp;<span class="op" id="8395025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395028">fi</span>&nbsp;<span class="op" id="8395031">:=</span>&nbsp;<span class="ident" id="8395034"><a href="/archive/zip/zip_test.go.html#8394935">fh</a></span><span class="op" id="8395036">.</span><span class="ident" id="8395037">FileInfo</span><span class="op" id="8395045">(</span><span class="op" id="8395046">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395049">fh2</span><span class="op" id="8395052">,</span>&nbsp;<span class="ident" id="8395054">err</span>&nbsp;<span class="op" id="8395058">:=</span>&nbsp;<span class="ident" id="8395061"><a href="/archive/zip/struct.go.html#5700089">FileInfoHeader</a></span><span class="op" id="8395075">(</span><span class="ident" id="8395076"><a href="/archive/zip/zip_test.go.html#8395028">fi</a></span><span class="op" id="8395078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395081">if</span>&nbsp;<span class="ident" id="8395084"><a href="/archive/zip/zip_test.go.html#8395054">err</a></span>&nbsp;<span class="op" id="8395088">!=</span>&nbsp;<span class="ident" id="8395091">nil</span>&nbsp;<span class="op" id="8395095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395099"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395100">.</span><span class="ident" id="8395101">Fatal</span><span class="op" id="8395106">(</span><span class="ident" id="8395107"><a href="/archive/zip/zip_test.go.html#8395054">err</a></span><span class="op" id="8395110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395116">if</span>&nbsp;<span class="ident" id="8395119">got</span><span class="op" id="8395122">,</span>&nbsp;<span class="ident" id="8395124">want</span>&nbsp;<span class="op" id="8395129">:=</span>&nbsp;<span class="ident" id="8395132"><a href="/archive/zip/zip_test.go.html#8395049">fh2</a></span><span class="op" id="8395135">.</span><span class="ident" id="8395136">Name</span><span class="op" id="8395140">,</span>&nbsp;<span class="ident" id="8395142"><a href="/archive/zip/zip_test.go.html#8394935">fh</a></span><span class="op" id="8395144">.</span><span class="ident" id="8395145">Name</span><span class="op" id="8395149">;</span>&nbsp;<span class="ident" id="8395151"><a href="/archive/zip/zip_test.go.html#8395119">got</a></span>&nbsp;<span class="op" id="8395155">!=</span>&nbsp;<span class="ident" id="8395158"><a href="/archive/zip/zip_test.go.html#8395124">want</a></span>&nbsp;<span class="op" id="8395163">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395167"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395168">.</span><span class="ident" id="8395169">Errorf</span><span class="op" id="8395175">(</span><span class="string" id="8395176">&#34;Name:&nbsp;got&nbsp;%s,&nbsp;want&nbsp;%s\n&#34;</span><span class="op" id="8395201">,</span>&nbsp;<span class="ident" id="8395203"><a href="/archive/zip/zip_test.go.html#8395119">got</a></span><span class="op" id="8395206">,</span>&nbsp;<span class="ident" id="8395208"><a href="/archive/zip/zip_test.go.html#8395124">want</a></span><span class="op" id="8395212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395218">if</span>&nbsp;<span class="ident" id="8395221">got</span><span class="op" id="8395224">,</span>&nbsp;<span class="ident" id="8395226">want</span>&nbsp;<span class="op" id="8395231">:=</span>&nbsp;<span class="ident" id="8395234"><a href="/archive/zip/zip_test.go.html#8395049">fh2</a></span><span class="op" id="8395237">.</span><span class="ident" id="8395238">UncompressedSize</span><span class="op" id="8395254">,</span>&nbsp;<span class="ident" id="8395256"><a href="/archive/zip/zip_test.go.html#8394951">wantUncompressedSize</a></span><span class="op" id="8395276">;</span>&nbsp;<span class="ident" id="8395278"><a href="/archive/zip/zip_test.go.html#8395221">got</a></span>&nbsp;<span class="op" id="8395282">!=</span>&nbsp;<span class="ident" id="8395285"><a href="/archive/zip/zip_test.go.html#8395226">want</a></span>&nbsp;<span class="op" id="8395290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395294"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395295">.</span><span class="ident" id="8395296">Errorf</span><span class="op" id="8395302">(</span><span class="string" id="8395303">&#34;UncompressedSize:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d\n&#34;</span><span class="op" id="8395340">,</span>&nbsp;<span class="ident" id="8395342"><a href="/archive/zip/zip_test.go.html#8395221">got</a></span><span class="op" id="8395345">,</span>&nbsp;<span class="ident" id="8395347"><a href="/archive/zip/zip_test.go.html#8395226">want</a></span><span class="op" id="8395351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395354">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395357">if</span>&nbsp;<span class="ident" id="8395360">got</span><span class="op" id="8395363">,</span>&nbsp;<span class="ident" id="8395365">want</span>&nbsp;<span class="op" id="8395370">:=</span>&nbsp;<span class="ident" id="8395373"><a href="/archive/zip/zip_test.go.html#8395049">fh2</a></span><span class="op" id="8395376">.</span><span class="ident" id="8395377">UncompressedSize64</span><span class="op" id="8395395">,</span>&nbsp;<span class="ident" id="8395397"><a href="/archive/zip/zip_test.go.html#8394980">wantUncompressedSize64</a></span><span class="op" id="8395419">;</span>&nbsp;<span class="ident" id="8395421"><a href="/archive/zip/zip_test.go.html#8395360">got</a></span>&nbsp;<span class="op" id="8395425">!=</span>&nbsp;<span class="ident" id="8395428"><a href="/archive/zip/zip_test.go.html#8395365">want</a></span>&nbsp;<span class="op" id="8395433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395437"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395438">.</span><span class="ident" id="8395439">Errorf</span><span class="op" id="8395445">(</span><span class="string" id="8395446">&#34;UncompressedSize64:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d\n&#34;</span><span class="op" id="8395485">,</span>&nbsp;<span class="ident" id="8395487"><a href="/archive/zip/zip_test.go.html#8395360">got</a></span><span class="op" id="8395490">,</span>&nbsp;<span class="ident" id="8395492"><a href="/archive/zip/zip_test.go.html#8395365">want</a></span><span class="op" id="8395496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395502">if</span>&nbsp;<span class="ident" id="8395505">got</span><span class="op" id="8395508">,</span>&nbsp;<span class="ident" id="8395510">want</span>&nbsp;<span class="op" id="8395515">:=</span>&nbsp;<span class="ident" id="8395518"><a href="/archive/zip/zip_test.go.html#8395049">fh2</a></span><span class="op" id="8395521">.</span><span class="ident" id="8395522">ModifiedTime</span><span class="op" id="8395534">,</span>&nbsp;<span class="ident" id="8395536"><a href="/archive/zip/zip_test.go.html#8394935">fh</a></span><span class="op" id="8395538">.</span><span class="ident" id="8395539">ModifiedTime</span><span class="op" id="8395551">;</span>&nbsp;<span class="ident" id="8395553"><a href="/archive/zip/zip_test.go.html#8395505">got</a></span>&nbsp;<span class="op" id="8395557">!=</span>&nbsp;<span class="ident" id="8395560"><a href="/archive/zip/zip_test.go.html#8395510">want</a></span>&nbsp;<span class="op" id="8395565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395569"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395570">.</span><span class="ident" id="8395571">Errorf</span><span class="op" id="8395577">(</span><span class="string" id="8395578">&#34;ModifiedTime:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d\n&#34;</span><span class="op" id="8395611">,</span>&nbsp;<span class="ident" id="8395613"><a href="/archive/zip/zip_test.go.html#8395505">got</a></span><span class="op" id="8395616">,</span>&nbsp;<span class="ident" id="8395618"><a href="/archive/zip/zip_test.go.html#8395510">want</a></span><span class="op" id="8395622">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395628">if</span>&nbsp;<span class="ident" id="8395631">got</span><span class="op" id="8395634">,</span>&nbsp;<span class="ident" id="8395636">want</span>&nbsp;<span class="op" id="8395641">:=</span>&nbsp;<span class="ident" id="8395644"><a href="/archive/zip/zip_test.go.html#8395049">fh2</a></span><span class="op" id="8395647">.</span><span class="ident" id="8395648">ModifiedDate</span><span class="op" id="8395660">,</span>&nbsp;<span class="ident" id="8395662"><a href="/archive/zip/zip_test.go.html#8394935">fh</a></span><span class="op" id="8395664">.</span><span class="ident" id="8395665">ModifiedDate</span><span class="op" id="8395677">;</span>&nbsp;<span class="ident" id="8395679"><a href="/archive/zip/zip_test.go.html#8395631">got</a></span>&nbsp;<span class="op" id="8395683">!=</span>&nbsp;<span class="ident" id="8395686"><a href="/archive/zip/zip_test.go.html#8395636">want</a></span>&nbsp;<span class="op" id="8395691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395695"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395696">.</span><span class="ident" id="8395697">Errorf</span><span class="op" id="8395703">(</span><span class="string" id="8395704">&#34;ModifiedDate:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d\n&#34;</span><span class="op" id="8395737">,</span>&nbsp;<span class="ident" id="8395739"><a href="/archive/zip/zip_test.go.html#8395631">got</a></span><span class="op" id="8395742">,</span>&nbsp;<span class="ident" id="8395744"><a href="/archive/zip/zip_test.go.html#8395636">want</a></span><span class="op" id="8395748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8395755">if</span>&nbsp;<span class="ident" id="8395758">sysfh</span><span class="op" id="8395763">,</span>&nbsp;<span class="ident" id="8395765">ok</span>&nbsp;<span class="op" id="8395768">:=</span>&nbsp;<span class="ident" id="8395771"><a href="/archive/zip/zip_test.go.html#8395028">fi</a></span><span class="op" id="8395773">.</span><span class="ident" id="8395774">Sys</span><span class="op" id="8395777">(</span><span class="op" id="8395778">)</span><span class="op" id="8395779">.</span><span class="op" id="8395780">(</span><span class="op" id="8395781">*</span><span class="ident" id="8395782"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8395792">)</span><span class="op" id="8395793">;</span>&nbsp;<span class="op" id="8395795">!</span><span class="ident" id="8395796"><a href="/archive/zip/zip_test.go.html#8395765">ok</a></span>&nbsp;<span class="op" id="8395799">&amp;&amp;</span>&nbsp;<span class="ident" id="8395802"><a href="/archive/zip/zip_test.go.html#8395758">sysfh</a></span>&nbsp;<span class="op" id="8395808">!=</span>&nbsp;<span class="ident" id="8395811"><a href="/archive/zip/zip_test.go.html#8394935">fh</a></span>&nbsp;<span class="op" id="8395814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395818"><a href="/archive/zip/zip_test.go.html#8395011">t</a></span><span class="op" id="8395819">.</span><span class="ident" id="8395820">Errorf</span><span class="op" id="8395826">(</span><span class="string" id="8395827">&#34;Sys&nbsp;didn&#39;t&nbsp;return&nbsp;original&nbsp;*FileHeader&#34;</span><span class="op" id="8395867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8395870">}</span><br>
<span class="lineno"></span><span class="op" id="8395872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8395875">func</span>&nbsp;<span class="ident" id="8395880">TestFileHeaderRoundTrip</span><span class="op" id="8395903">(</span><span class="ident" id="8395904">t</span>&nbsp;<span class="op" id="8395906">*</span><span class="ident" id="8395907"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8395914">.</span><span class="ident" id="8395915">T</span><span class="op" id="8395916">)</span>&nbsp;<span class="op" id="8395918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395921">fh</span>&nbsp;<span class="op" id="8395924">:=</span>&nbsp;<span class="op" id="8395927">&amp;</span><span class="ident" id="8395928"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8395938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395942">Name</span><span class="op" id="8395946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8395960">&#34;foo.txt&#34;</span><span class="op" id="8395969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8395973">UncompressedSize</span><span class="op" id="8395989">:</span>&nbsp;<span class="num" id="8395991">987654321</span><span class="op" id="8396000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396004">ModifiedTime</span><span class="op" id="8396016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8396022">1234</span><span class="op" id="8396026">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396030">ModifiedDate</span><span class="op" id="8396042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8396048">5678</span><span class="op" id="8396052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8396055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396058"><a href="/archive/zip/zip_test.go.html#8394915">testHeaderRoundTrip</a></span><span class="op" id="8396077">(</span><span class="ident" id="8396078"><a href="/archive/zip/zip_test.go.html#8395921">fh</a></span><span class="op" id="8396080">,</span>&nbsp;<span class="ident" id="8396082"><a href="/archive/zip/zip_test.go.html#8395921">fh</a></span><span class="op" id="8396084">.</span><span class="ident" id="8396085">UncompressedSize</span><span class="op" id="8396101">,</span>&nbsp;<span class="ident" id="8396103">uint64</span><span class="op" id="8396109">(</span><span class="ident" id="8396110"><a href="/archive/zip/zip_test.go.html#8395921">fh</a></span><span class="op" id="8396112">.</span><span class="ident" id="8396113">UncompressedSize</span><span class="op" id="8396129">)</span><span class="op" id="8396130">,</span>&nbsp;<span class="ident" id="8396132"><a href="/archive/zip/zip_test.go.html#8395904">t</a></span><span class="op" id="8396133">)</span><br>
<span class="lineno"></span><span class="op" id="8396135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8396138">func</span>&nbsp;<span class="ident" id="8396143">TestFileHeaderRoundTrip64</span><span class="op" id="8396168">(</span><span class="ident" id="8396169">t</span>&nbsp;<span class="op" id="8396171">*</span><span class="ident" id="8396172"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8396179">.</span><span class="ident" id="8396180">T</span><span class="op" id="8396181">)</span>&nbsp;<span class="op" id="8396183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396186">fh</span>&nbsp;<span class="op" id="8396189">:=</span>&nbsp;<span class="op" id="8396192">&amp;</span><span class="ident" id="8396193"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8396203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396207">Name</span><span class="op" id="8396211">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8396227">&#34;foo.txt&#34;</span><span class="op" id="8396236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396240">UncompressedSize64</span><span class="op" id="8396258">:</span>&nbsp;<span class="num" id="8396260">9876543210</span><span class="op" id="8396270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396274">ModifiedTime</span><span class="op" id="8396286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8396294">1234</span><span class="op" id="8396298">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396302">ModifiedDate</span><span class="op" id="8396314">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8396322">5678</span><span class="op" id="8396326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8396329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396332"><a href="/archive/zip/zip_test.go.html#8394915">testHeaderRoundTrip</a></span><span class="op" id="8396351">(</span><span class="ident" id="8396352"><a href="/archive/zip/zip_test.go.html#8396186">fh</a></span><span class="op" id="8396354">,</span>&nbsp;<span class="ident" id="8396356"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><span class="op" id="8396365">,</span>&nbsp;<span class="ident" id="8396367"><a href="/archive/zip/zip_test.go.html#8396186">fh</a></span><span class="op" id="8396369">.</span><span class="ident" id="8396370">UncompressedSize64</span><span class="op" id="8396388">,</span>&nbsp;<span class="ident" id="8396390"><a href="/archive/zip/zip_test.go.html#8396169">t</a></span><span class="op" id="8396391">)</span><br>
<span class="lineno"></span><span class="op" id="8396393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8396396">type</span>&nbsp;<span class="ident" id="8396401">repeatedByte</span>&nbsp;<span class="keyword" id="8396414">struct</span>&nbsp;<span class="op" id="8396421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396424">off</span>&nbsp;<span class="ident" id="8396428">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396435">b</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8396439">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396445">n</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8396449">int64</span><br>
<span class="lineno"></span><span class="op" id="8396455">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="8396458">//&nbsp;rleBuffer&nbsp;is&nbsp;a&nbsp;run-length-encoded&nbsp;byte&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="8396508">//&nbsp;It&#39;s&nbsp;an&nbsp;io.Writer&nbsp;(like&nbsp;a&nbsp;bytes.Buffer)&nbsp;and&nbsp;also&nbsp;an&nbsp;io.ReaderAt,</span><br>
<span class="lineno"></span><span class="comment" id="8396576">//&nbsp;allowing&nbsp;random-access&nbsp;reads.</span><br>
<span class="lineno"></span><span class="keyword" id="8396609">type</span>&nbsp;<span class="ident" id="8396614">rleBuffer</span>&nbsp;<span class="keyword" id="8396624">struct</span>&nbsp;<span class="op" id="8396631">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396634">buf</span>&nbsp;<span class="op" id="8396638">[</span><span class="op" id="8396639">]</span><span class="ident" id="8396640"><a href="/archive/zip/zip_test.go.html#8396401">repeatedByte</a></span><br>
<span class="lineno"></span><span class="op" id="8396653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8396656">func</span>&nbsp;<span class="op" id="8396661">(</span><span class="ident" id="8396662">r</span>&nbsp;<span class="op" id="8396664">*</span><span class="ident" id="8396665"><a href="/archive/zip/zip_test.go.html#8396614">rleBuffer</a></span><span class="op" id="8396674">)</span>&nbsp;<span class="ident" id="8396676">Size</span><span class="op" id="8396680">(</span><span class="op" id="8396681">)</span>&nbsp;<span class="ident" id="8396683">int64</span>&nbsp;<span class="op" id="8396689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396692">if</span>&nbsp;<span class="builtinfunc" id="8396695">len</span><span class="op" id="8396698">(</span><span class="ident" id="8396699"><a href="/archive/zip/zip_test.go.html#8396662">r</a></span><span class="op" id="8396700">.</span><span class="ident" id="8396701">buf</span><span class="op" id="8396704">)</span>&nbsp;<span class="op" id="8396706">==</span>&nbsp;<span class="num" id="8396709">0</span>&nbsp;<span class="op" id="8396711">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396715">return</span>&nbsp;<span class="num" id="8396722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8396725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396728">last</span>&nbsp;<span class="op" id="8396733">:=</span>&nbsp;<span class="op" id="8396736">&amp;</span><span class="ident" id="8396737"><a href="/archive/zip/zip_test.go.html#8396662">r</a></span><span class="op" id="8396738">.</span><span class="ident" id="8396739">buf</span><span class="op" id="8396742">[</span><span class="builtinfunc" id="8396743">len</span><span class="op" id="8396746">(</span><span class="ident" id="8396747"><a href="/archive/zip/zip_test.go.html#8396662">r</a></span><span class="op" id="8396748">.</span><span class="ident" id="8396749">buf</span><span class="op" id="8396752">)</span><span class="op" id="8396753">-</span><span class="num" id="8396754">1</span><span class="op" id="8396755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396758">return</span>&nbsp;<span class="ident" id="8396765"><a href="/archive/zip/zip_test.go.html#8396728">last</a></span><span class="op" id="8396769">.</span><span class="ident" id="8396770">off</span>&nbsp;<span class="op" id="8396774">+</span>&nbsp;<span class="ident" id="8396776"><a href="/archive/zip/zip_test.go.html#8396728">last</a></span><span class="op" id="8396780">.</span><span class="ident" id="8396781">n</span><br>
<span class="lineno"></span><span class="op" id="8396783">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="8396786">func</span>&nbsp;<span class="op" id="8396791">(</span><span class="ident" id="8396792">r</span>&nbsp;<span class="op" id="8396794">*</span><span class="ident" id="8396795"><a href="/archive/zip/zip_test.go.html#8396614">rleBuffer</a></span><span class="op" id="8396804">)</span>&nbsp;<span class="ident" id="8396806">Write</span><span class="op" id="8396811">(</span><span class="ident" id="8396812">p</span>&nbsp;<span class="op" id="8396814">[</span><span class="op" id="8396815">]</span><span class="builtintype" id="8396816">byte</span><span class="op" id="8396820">)</span>&nbsp;<span class="op" id="8396822">(</span><span class="ident" id="8396823">n</span>&nbsp;<span class="builtintype" id="8396825">int</span><span class="op" id="8396828">,</span>&nbsp;<span class="ident" id="8396830">err</span>&nbsp;<span class="builtintype" id="8396834">error</span><span class="op" id="8396839">)</span>&nbsp;<span class="op" id="8396841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396844">var</span>&nbsp;<span class="ident" id="8396848">rp</span>&nbsp;<span class="op" id="8396851">*</span><span class="ident" id="8396852"><a href="/archive/zip/zip_test.go.html#8396401">repeatedByte</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396866">if</span>&nbsp;<span class="builtinfunc" id="8396869">len</span><span class="op" id="8396872">(</span><span class="ident" id="8396873"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8396874">.</span><span class="ident" id="8396875">buf</span><span class="op" id="8396878">)</span>&nbsp;<span class="op" id="8396880">&gt;</span>&nbsp;<span class="num" id="8396882">0</span>&nbsp;<span class="op" id="8396884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8396888"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span>&nbsp;<span class="op" id="8396891">=</span>&nbsp;<span class="op" id="8396893">&amp;</span><span class="ident" id="8396894"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8396895">.</span><span class="ident" id="8396896">buf</span><span class="op" id="8396899">[</span><span class="builtinfunc" id="8396900">len</span><span class="op" id="8396903">(</span><span class="ident" id="8396904"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8396905">.</span><span class="ident" id="8396906">buf</span><span class="op" id="8396909">)</span><span class="op" id="8396910">-</span><span class="num" id="8396911">1</span><span class="op" id="8396912">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8396916">//&nbsp;Fast&nbsp;path,&nbsp;if&nbsp;p&nbsp;is&nbsp;entirely&nbsp;the&nbsp;same&nbsp;byte&nbsp;repeated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8396973">if</span>&nbsp;<span class="ident" id="8396976">lastByte</span>&nbsp;<span class="op" id="8396985">:=</span>&nbsp;<span class="ident" id="8396988"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span><span class="op" id="8396990">.</span><span class="ident" id="8396991">b</span><span class="op" id="8396992">;</span>&nbsp;<span class="builtinfunc" id="8396994">len</span><span class="op" id="8396997">(</span><span class="ident" id="8396998"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span><span class="op" id="8396999">)</span>&nbsp;<span class="op" id="8397001">&gt;</span>&nbsp;<span class="num" id="8397003">0</span>&nbsp;<span class="op" id="8397005">&amp;&amp;</span>&nbsp;<span class="ident" id="8397008"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span><span class="op" id="8397009">[</span><span class="num" id="8397010">0</span><span class="op" id="8397011">]</span>&nbsp;<span class="op" id="8397013">==</span>&nbsp;<span class="ident" id="8397016"><a href="/archive/zip/zip_test.go.html#8396976">lastByte</a></span>&nbsp;<span class="op" id="8397025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397030">all</span>&nbsp;<span class="op" id="8397034">:=</span>&nbsp;<span class="builtintype" id="8397037">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397045">for</span>&nbsp;<span class="ident" id="8397049">_</span><span class="op" id="8397050">,</span>&nbsp;<span class="ident" id="8397052">b</span>&nbsp;<span class="op" id="8397054">:=</span>&nbsp;<span class="keyword" id="8397057">range</span>&nbsp;<span class="ident" id="8397063"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span>&nbsp;<span class="op" id="8397065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397071">if</span>&nbsp;<span class="ident" id="8397074"><a href="/archive/zip/zip_test.go.html#8397052">b</a></span>&nbsp;<span class="op" id="8397076">!=</span>&nbsp;<span class="ident" id="8397079"><a href="/archive/zip/zip_test.go.html#8396976">lastByte</a></span>&nbsp;<span class="op" id="8397088">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397095"><a href="/archive/zip/zip_test.go.html#8397030">all</a></span>&nbsp;<span class="op" id="8397099">=</span>&nbsp;<span class="builtintype" id="8397101">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397112">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397132">if</span>&nbsp;<span class="ident" id="8397135"><a href="/archive/zip/zip_test.go.html#8397030">all</a></span>&nbsp;<span class="op" id="8397139">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397145"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span><span class="op" id="8397147">.</span><span class="ident" id="8397148">n</span>&nbsp;<span class="op" id="8397150">+=</span>&nbsp;<span class="ident" id="8397153">int64</span><span class="op" id="8397158">(</span><span class="builtinfunc" id="8397159">len</span><span class="op" id="8397162">(</span><span class="ident" id="8397163"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span><span class="op" id="8397164">)</span><span class="op" id="8397165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397171">return</span>&nbsp;<span class="builtinfunc" id="8397178">len</span><span class="op" id="8397181">(</span><span class="ident" id="8397182"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span><span class="op" id="8397183">)</span><span class="op" id="8397184">,</span>&nbsp;<span class="ident" id="8397186">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397200">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397204">for</span>&nbsp;<span class="ident" id="8397208">_</span><span class="op" id="8397209">,</span>&nbsp;<span class="ident" id="8397211">b</span>&nbsp;<span class="op" id="8397213">:=</span>&nbsp;<span class="keyword" id="8397216">range</span>&nbsp;<span class="ident" id="8397222"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span>&nbsp;<span class="op" id="8397224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397228">if</span>&nbsp;<span class="ident" id="8397231"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span>&nbsp;<span class="op" id="8397234">==</span>&nbsp;<span class="ident" id="8397237">nil</span>&nbsp;<span class="op" id="8397241">||</span>&nbsp;<span class="ident" id="8397244"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span><span class="op" id="8397246">.</span><span class="ident" id="8397247">b</span>&nbsp;<span class="op" id="8397249">!=</span>&nbsp;<span class="ident" id="8397252"><a href="/archive/zip/zip_test.go.html#8397211">b</a></span>&nbsp;<span class="op" id="8397254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397259"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8397260">.</span><span class="ident" id="8397261">buf</span>&nbsp;<span class="op" id="8397265">=</span>&nbsp;<span class="builtinfunc" id="8397267">append</span><span class="op" id="8397273">(</span><span class="ident" id="8397274"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8397275">.</span><span class="ident" id="8397276">buf</span><span class="op" id="8397279">,</span>&nbsp;<span class="ident" id="8397281"><a href="/archive/zip/zip_test.go.html#8396401">repeatedByte</a></span><span class="op" id="8397293">{</span><span class="ident" id="8397294"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8397295">.</span><span class="ident" id="8397296">Size</span><span class="op" id="8397300">(</span><span class="op" id="8397301">)</span><span class="op" id="8397302">,</span>&nbsp;<span class="ident" id="8397304"><a href="/archive/zip/zip_test.go.html#8397211">b</a></span><span class="op" id="8397305">,</span>&nbsp;<span class="num" id="8397307">1</span><span class="op" id="8397308">}</span><span class="op" id="8397309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397314"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span>&nbsp;<span class="op" id="8397317">=</span>&nbsp;<span class="op" id="8397319">&amp;</span><span class="ident" id="8397320"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8397321">.</span><span class="ident" id="8397322">buf</span><span class="op" id="8397325">[</span><span class="builtinfunc" id="8397326">len</span><span class="op" id="8397329">(</span><span class="ident" id="8397330"><a href="/archive/zip/zip_test.go.html#8396792">r</a></span><span class="op" id="8397331">.</span><span class="ident" id="8397332">buf</span><span class="op" id="8397335">)</span><span class="op" id="8397336">-</span><span class="num" id="8397337">1</span><span class="op" id="8397338">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397342">}</span>&nbsp;<span class="keyword" id="8397344">else</span>&nbsp;<span class="op" id="8397349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397354"><a href="/archive/zip/zip_test.go.html#8396848">rp</a></span><span class="op" id="8397356">.</span><span class="ident" id="8397357">n</span><span class="op" id="8397358">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397369">return</span>&nbsp;<span class="builtinfunc" id="8397376">len</span><span class="op" id="8397379">(</span><span class="ident" id="8397380"><a href="/archive/zip/zip_test.go.html#8396812">p</a></span><span class="op" id="8397381">)</span><span class="op" id="8397382">,</span>&nbsp;<span class="ident" id="8397384">nil</span><br>
<span class="lineno">160</span><span class="op" id="8397388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8397391">func</span>&nbsp;<span class="op" id="8397396">(</span><span class="ident" id="8397397">r</span>&nbsp;<span class="op" id="8397399">*</span><span class="ident" id="8397400"><a href="/archive/zip/zip_test.go.html#8396614">rleBuffer</a></span><span class="op" id="8397409">)</span>&nbsp;<span class="ident" id="8397411">ReadAt</span><span class="op" id="8397417">(</span><span class="ident" id="8397418">p</span>&nbsp;<span class="op" id="8397420">[</span><span class="op" id="8397421">]</span><span class="builtintype" id="8397422">byte</span><span class="op" id="8397426">,</span>&nbsp;<span class="ident" id="8397428">off</span>&nbsp;<span class="ident" id="8397432">int64</span><span class="op" id="8397437">)</span>&nbsp;<span class="op" id="8397439">(</span><span class="ident" id="8397440">n</span>&nbsp;<span class="builtintype" id="8397442">int</span><span class="op" id="8397445">,</span>&nbsp;<span class="ident" id="8397447">err</span>&nbsp;<span class="builtintype" id="8397451">error</span><span class="op" id="8397456">)</span>&nbsp;<span class="op" id="8397458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397461">if</span>&nbsp;<span class="builtinfunc" id="8397464">len</span><span class="op" id="8397467">(</span><span class="ident" id="8397468"><a href="/archive/zip/zip_test.go.html#8397418">p</a></span><span class="op" id="8397469">)</span>&nbsp;<span class="op" id="8397471">==</span>&nbsp;<span class="num" id="8397474">0</span>&nbsp;<span class="op" id="8397476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397480">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397491">skipParts</span>&nbsp;<span class="op" id="8397501">:=</span>&nbsp;<span class="ident" id="8397504"><a href="/archive/zip/zip_test.go.html#8393753">sort</a></span><span class="op" id="8397508">.</span><span class="ident" id="8397509">Search</span><span class="op" id="8397515">(</span><span class="builtinfunc" id="8397516">len</span><span class="op" id="8397519">(</span><span class="ident" id="8397520"><a href="/archive/zip/zip_test.go.html#8397397">r</a></span><span class="op" id="8397521">.</span><span class="ident" id="8397522">buf</span><span class="op" id="8397525">)</span><span class="op" id="8397526">,</span>&nbsp;<span class="keyword" id="8397528">func</span><span class="op" id="8397532">(</span><span class="ident" id="8397533">i</span>&nbsp;<span class="builtintype" id="8397535">int</span><span class="op" id="8397538">)</span>&nbsp;<span class="builtintype" id="8397540">bool</span>&nbsp;<span class="op" id="8397545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397549">part</span>&nbsp;<span class="op" id="8397554">:=</span>&nbsp;<span class="op" id="8397557">&amp;</span><span class="ident" id="8397558"><a href="/archive/zip/zip_test.go.html#8397397">r</a></span><span class="op" id="8397559">.</span><span class="ident" id="8397560">buf</span><span class="op" id="8397563">[</span><span class="ident" id="8397564"><a href="/archive/zip/zip_test.go.html#8397533">i</a></span><span class="op" id="8397565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397569">return</span>&nbsp;<span class="ident" id="8397576"><a href="/archive/zip/zip_test.go.html#8397549">part</a></span><span class="op" id="8397580">.</span><span class="ident" id="8397581">off</span><span class="op" id="8397584">+</span><span class="ident" id="8397585"><a href="/archive/zip/zip_test.go.html#8397549">part</a></span><span class="op" id="8397589">.</span><span class="ident" id="8397590">n</span>&nbsp;<span class="op" id="8397592">&gt;</span>&nbsp;<span class="ident" id="8397594"><a href="/archive/zip/zip_test.go.html#8397428">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397599">}</span><span class="op" id="8397600">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397603">parts</span>&nbsp;<span class="op" id="8397609">:=</span>&nbsp;<span class="ident" id="8397612"><a href="/archive/zip/zip_test.go.html#8397397">r</a></span><span class="op" id="8397613">.</span><span class="ident" id="8397614">buf</span><span class="op" id="8397617">[</span><span class="ident" id="8397618"><a href="/archive/zip/zip_test.go.html#8397491">skipParts</a></span><span class="op" id="8397627">:</span><span class="op" id="8397628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397631">if</span>&nbsp;<span class="builtinfunc" id="8397634">len</span><span class="op" id="8397637">(</span><span class="ident" id="8397638"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span><span class="op" id="8397643">)</span>&nbsp;<span class="op" id="8397645">&gt;</span>&nbsp;<span class="num" id="8397647">0</span>&nbsp;<span class="op" id="8397649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397653">skipBytes</span>&nbsp;<span class="op" id="8397663">:=</span>&nbsp;<span class="ident" id="8397666"><a href="/archive/zip/zip_test.go.html#8397428">off</a></span>&nbsp;<span class="op" id="8397670">-</span>&nbsp;<span class="ident" id="8397672"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span><span class="op" id="8397677">[</span><span class="num" id="8397678">0</span><span class="op" id="8397679">]</span><span class="op" id="8397680">.</span><span class="ident" id="8397681">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397687">for</span>&nbsp;<span class="builtinfunc" id="8397691">len</span><span class="op" id="8397694">(</span><span class="ident" id="8397695"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span><span class="op" id="8397700">)</span>&nbsp;<span class="op" id="8397702">&gt;</span>&nbsp;<span class="num" id="8397704">0</span>&nbsp;<span class="op" id="8397706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397711">part</span>&nbsp;<span class="op" id="8397716">:=</span>&nbsp;<span class="ident" id="8397719"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span><span class="op" id="8397724">[</span><span class="num" id="8397725">0</span><span class="op" id="8397726">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397731">for</span>&nbsp;<span class="ident" id="8397735">i</span>&nbsp;<span class="op" id="8397737">:=</span>&nbsp;<span class="ident" id="8397740"><a href="/archive/zip/zip_test.go.html#8397653">skipBytes</a></span><span class="op" id="8397749">;</span>&nbsp;<span class="ident" id="8397751"><a href="/archive/zip/zip_test.go.html#8397735">i</a></span>&nbsp;<span class="op" id="8397753">&lt;</span>&nbsp;<span class="ident" id="8397755"><a href="/archive/zip/zip_test.go.html#8397711">part</a></span><span class="op" id="8397759">.</span><span class="ident" id="8397760">n</span><span class="op" id="8397761">;</span>&nbsp;<span class="ident" id="8397763"><a href="/archive/zip/zip_test.go.html#8397735">i</a></span><span class="op" id="8397764">++</span>&nbsp;<span class="op" id="8397767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397773">if</span>&nbsp;<span class="ident" id="8397776"><a href="/archive/zip/zip_test.go.html#8397440">n</a></span>&nbsp;<span class="op" id="8397778">==</span>&nbsp;<span class="builtinfunc" id="8397781">len</span><span class="op" id="8397784">(</span><span class="ident" id="8397785"><a href="/archive/zip/zip_test.go.html#8397418">p</a></span><span class="op" id="8397786">)</span>&nbsp;<span class="op" id="8397788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397795">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397812"><a href="/archive/zip/zip_test.go.html#8397418">p</a></span><span class="op" id="8397813">[</span><span class="ident" id="8397814"><a href="/archive/zip/zip_test.go.html#8397440">n</a></span><span class="op" id="8397815">]</span>&nbsp;<span class="op" id="8397817">=</span>&nbsp;<span class="ident" id="8397819"><a href="/archive/zip/zip_test.go.html#8397711">part</a></span><span class="op" id="8397823">.</span><span class="ident" id="8397824">b</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397830"><a href="/archive/zip/zip_test.go.html#8397440">n</a></span><span class="op" id="8397831">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397842"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span>&nbsp;<span class="op" id="8397848">=</span>&nbsp;<span class="ident" id="8397850"><a href="/archive/zip/zip_test.go.html#8397603">parts</a></span><span class="op" id="8397855">[</span><span class="num" id="8397856">1</span><span class="op" id="8397857">:</span><span class="op" id="8397858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397863"><a href="/archive/zip/zip_test.go.html#8397653">skipBytes</a></span>&nbsp;<span class="op" id="8397873">=</span>&nbsp;<span class="num" id="8397875">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397879">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397885">if</span>&nbsp;<span class="ident" id="8397888"><a href="/archive/zip/zip_test.go.html#8397440">n</a></span>&nbsp;<span class="op" id="8397890">!=</span>&nbsp;<span class="builtinfunc" id="8397893">len</span><span class="op" id="8397896">(</span><span class="ident" id="8397897"><a href="/archive/zip/zip_test.go.html#8397418">p</a></span><span class="op" id="8397898">)</span>&nbsp;<span class="op" id="8397900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8397904"><a href="/archive/zip/zip_test.go.html#8397447">err</a></span>&nbsp;<span class="op" id="8397908">=</span>&nbsp;<span class="ident" id="8397910"><a href="/archive/zip/zip_test.go.html#8393734">io</a></span><span class="op" id="8397912">.</span><span class="ident" id="8397913">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8397931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8397934">return</span><br>
<span class="lineno">190</span><span class="op" id="8397941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8397944">//&nbsp;Just&nbsp;testing&nbsp;the&nbsp;rleBuffer&nbsp;used&nbsp;in&nbsp;the&nbsp;Zip64&nbsp;test&nbsp;above.&nbsp;Not&nbsp;used&nbsp;by&nbsp;the&nbsp;zip&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="8398030">func</span>&nbsp;<span class="ident" id="8398035">TestRLEBuffer</span><span class="op" id="8398048">(</span><span class="ident" id="8398049">t</span>&nbsp;<span class="op" id="8398051">*</span><span class="ident" id="8398052"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8398059">.</span><span class="ident" id="8398060">T</span><span class="op" id="8398061">)</span>&nbsp;<span class="op" id="8398063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398066">b</span>&nbsp;<span class="op" id="8398068">:=</span>&nbsp;<span class="builtinfunc" id="8398071">new</span><span class="op" id="8398074">(</span><span class="ident" id="8398075"><a href="/archive/zip/zip_test.go.html#8396614">rleBuffer</a></span><span class="op" id="8398084">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398087">var</span>&nbsp;<span class="ident" id="8398091">all</span>&nbsp;<span class="op" id="8398095">[</span><span class="op" id="8398096">]</span><span class="builtintype" id="8398097">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398103">writes</span>&nbsp;<span class="op" id="8398110">:=</span>&nbsp;<span class="op" id="8398113">[</span><span class="op" id="8398114">]</span><span class="builtintype" id="8398115">string</span><span class="op" id="8398121">{</span><span class="string" id="8398122">&#34;abcdeee&#34;</span><span class="op" id="8398131">,</span>&nbsp;<span class="string" id="8398133">&#34;eeeeeee&#34;</span><span class="op" id="8398142">,</span>&nbsp;<span class="string" id="8398144">&#34;eeeefghaaiii&#34;</span><span class="op" id="8398158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398161">for</span>&nbsp;<span class="ident" id="8398165">_</span><span class="op" id="8398166">,</span>&nbsp;<span class="ident" id="8398168">w</span>&nbsp;<span class="op" id="8398170">:=</span>&nbsp;<span class="keyword" id="8398173">range</span>&nbsp;<span class="ident" id="8398179"><a href="/archive/zip/zip_test.go.html#8398103">writes</a></span>&nbsp;<span class="op" id="8398186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398190"><a href="/archive/zip/zip_test.go.html#8398066">b</a></span><span class="op" id="8398191">.</span><span class="ident" id="8398192">Write</span><span class="op" id="8398197">(</span><span class="op" id="8398198">[</span><span class="op" id="8398199">]</span><span class="builtintype" id="8398200">byte</span><span class="op" id="8398204">(</span><span class="ident" id="8398205"><a href="/archive/zip/zip_test.go.html#8398168">w</a></span><span class="op" id="8398206">)</span><span class="op" id="8398207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398211"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span>&nbsp;<span class="op" id="8398215">=</span>&nbsp;<span class="builtinfunc" id="8398217">append</span><span class="op" id="8398223">(</span><span class="ident" id="8398224"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span><span class="op" id="8398227">,</span>&nbsp;<span class="ident" id="8398229"><a href="/archive/zip/zip_test.go.html#8398168">w</a></span><span class="op" id="8398230">...</span><span class="op" id="8398233">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398239">if</span>&nbsp;<span class="builtinfunc" id="8398242">len</span><span class="op" id="8398245">(</span><span class="ident" id="8398246"><a href="/archive/zip/zip_test.go.html#8398066">b</a></span><span class="op" id="8398247">.</span><span class="ident" id="8398248">buf</span><span class="op" id="8398251">)</span>&nbsp;<span class="op" id="8398253">!=</span>&nbsp;<span class="num" id="8398256">10</span>&nbsp;<span class="op" id="8398259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398263"><a href="/archive/zip/zip_test.go.html#8398049">t</a></span><span class="op" id="8398264">.</span><span class="ident" id="8398265">Fatalf</span><span class="op" id="8398271">(</span><span class="string" id="8398272">&#34;len(b.buf)&nbsp;=&nbsp;%d;&nbsp;want&nbsp;10&#34;</span><span class="op" id="8398298">,</span>&nbsp;<span class="builtinfunc" id="8398300">len</span><span class="op" id="8398303">(</span><span class="ident" id="8398304"><a href="/archive/zip/zip_test.go.html#8398066">b</a></span><span class="op" id="8398305">.</span><span class="ident" id="8398306">buf</span><span class="op" id="8398309">)</span><span class="op" id="8398310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398317">for</span>&nbsp;<span class="ident" id="8398321">i</span>&nbsp;<span class="op" id="8398323">:=</span>&nbsp;<span class="num" id="8398326">0</span><span class="op" id="8398327">;</span>&nbsp;<span class="ident" id="8398329"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span>&nbsp;<span class="op" id="8398331">&lt;</span>&nbsp;<span class="builtinfunc" id="8398333">len</span><span class="op" id="8398336">(</span><span class="ident" id="8398337"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span><span class="op" id="8398340">)</span><span class="op" id="8398341">;</span>&nbsp;<span class="ident" id="8398343"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398344">++</span>&nbsp;<span class="op" id="8398347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398351">for</span>&nbsp;<span class="ident" id="8398355">j</span>&nbsp;<span class="op" id="8398357">:=</span>&nbsp;<span class="num" id="8398360">0</span><span class="op" id="8398361">;</span>&nbsp;<span class="ident" id="8398363"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span>&nbsp;<span class="op" id="8398365">&lt;</span>&nbsp;<span class="builtinfunc" id="8398367">len</span><span class="op" id="8398370">(</span><span class="ident" id="8398371"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span><span class="op" id="8398374">)</span><span class="op" id="8398375">-</span><span class="ident" id="8398376"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398377">;</span>&nbsp;<span class="ident" id="8398379"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398380">++</span>&nbsp;<span class="op" id="8398383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398388">buf</span>&nbsp;<span class="op" id="8398392">:=</span>&nbsp;<span class="builtinfunc" id="8398395">make</span><span class="op" id="8398399">(</span><span class="op" id="8398400">[</span><span class="op" id="8398401">]</span><span class="builtintype" id="8398402">byte</span><span class="op" id="8398406">,</span>&nbsp;<span class="ident" id="8398408"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398414">n</span><span class="op" id="8398415">,</span>&nbsp;<span class="ident" id="8398417">err</span>&nbsp;<span class="op" id="8398421">:=</span>&nbsp;<span class="ident" id="8398424"><a href="/archive/zip/zip_test.go.html#8398066">b</a></span><span class="op" id="8398425">.</span><span class="ident" id="8398426">ReadAt</span><span class="op" id="8398432">(</span><span class="ident" id="8398433"><a href="/archive/zip/zip_test.go.html#8398388">buf</a></span><span class="op" id="8398436">,</span>&nbsp;<span class="ident" id="8398438">int64</span><span class="op" id="8398443">(</span><span class="ident" id="8398444"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398445">)</span><span class="op" id="8398446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398451">if</span>&nbsp;<span class="ident" id="8398454"><a href="/archive/zip/zip_test.go.html#8398417">err</a></span>&nbsp;<span class="op" id="8398458">!=</span>&nbsp;<span class="ident" id="8398461">nil</span>&nbsp;<span class="op" id="8398465">||</span>&nbsp;<span class="ident" id="8398468"><a href="/archive/zip/zip_test.go.html#8398414">n</a></span>&nbsp;<span class="op" id="8398470">!=</span>&nbsp;<span class="builtinfunc" id="8398473">len</span><span class="op" id="8398476">(</span><span class="ident" id="8398477"><a href="/archive/zip/zip_test.go.html#8398388">buf</a></span><span class="op" id="8398480">)</span>&nbsp;<span class="op" id="8398482">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398488"><a href="/archive/zip/zip_test.go.html#8398049">t</a></span><span class="op" id="8398489">.</span><span class="ident" id="8398490">Errorf</span><span class="op" id="8398496">(</span><span class="string" id="8398497">&#34;ReadAt(%d,&nbsp;%d)&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="8398536">,</span>&nbsp;<span class="ident" id="8398538"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398539">,</span>&nbsp;<span class="ident" id="8398541"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398542">,</span>&nbsp;<span class="ident" id="8398544"><a href="/archive/zip/zip_test.go.html#8398414">n</a></span><span class="op" id="8398545">,</span>&nbsp;<span class="ident" id="8398547"><a href="/archive/zip/zip_test.go.html#8398417">err</a></span><span class="op" id="8398550">,</span>&nbsp;<span class="builtinfunc" id="8398552">len</span><span class="op" id="8398555">(</span><span class="ident" id="8398556"><a href="/archive/zip/zip_test.go.html#8398388">buf</a></span><span class="op" id="8398559">)</span><span class="op" id="8398560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398570">if</span>&nbsp;<span class="op" id="8398573">!</span><span class="ident" id="8398574"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8398579">.</span><span class="ident" id="8398580">Equal</span><span class="op" id="8398585">(</span><span class="ident" id="8398586"><a href="/archive/zip/zip_test.go.html#8398388">buf</a></span><span class="op" id="8398589">,</span>&nbsp;<span class="ident" id="8398591"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span><span class="op" id="8398594">[</span><span class="ident" id="8398595"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398596">:</span><span class="ident" id="8398597"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398598">+</span><span class="ident" id="8398599"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398600">]</span><span class="op" id="8398601">)</span>&nbsp;<span class="op" id="8398603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398609"><a href="/archive/zip/zip_test.go.html#8398049">t</a></span><span class="op" id="8398610">.</span><span class="ident" id="8398611">Errorf</span><span class="op" id="8398617">(</span><span class="string" id="8398618">&#34;ReadAt(%d,&nbsp;%d)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8398648">,</span>&nbsp;<span class="ident" id="8398650"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398651">,</span>&nbsp;<span class="ident" id="8398653"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398654">,</span>&nbsp;<span class="ident" id="8398656"><a href="/archive/zip/zip_test.go.html#8398388">buf</a></span><span class="op" id="8398659">,</span>&nbsp;<span class="ident" id="8398661"><a href="/archive/zip/zip_test.go.html#8398091">all</a></span><span class="op" id="8398664">[</span><span class="ident" id="8398665"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398666">:</span><span class="ident" id="8398667"><a href="/archive/zip/zip_test.go.html#8398321">i</a></span><span class="op" id="8398668">+</span><span class="ident" id="8398669"><a href="/archive/zip/zip_test.go.html#8398355">j</a></span><span class="op" id="8398670">]</span><span class="op" id="8398671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398676">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8398683">}</span><br>
<span class="lineno"></span><span class="op" id="8398685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8398688">//&nbsp;fakeHash32&nbsp;is&nbsp;a&nbsp;dummy&nbsp;Hash32&nbsp;that&nbsp;always&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">220</span><span class="keyword" id="8398743">type</span>&nbsp;<span class="ident" id="8398748">fakeHash32</span>&nbsp;<span class="keyword" id="8398759">struct</span>&nbsp;<span class="op" id="8398766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398769"><a href="/archive/zip/zip_test.go.html#8393726">hash</a></span><span class="op" id="8398773">.</span><span class="ident" id="8398774">Hash32</span><br>
<span class="lineno"></span><span class="op" id="8398781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8398784">func</span>&nbsp;<span class="op" id="8398789">(</span><span class="ident" id="8398790"><a href="/archive/zip/zip_test.go.html#8398748">fakeHash32</a></span><span class="op" id="8398800">)</span>&nbsp;<span class="ident" id="8398802">Write</span><span class="op" id="8398807">(</span><span class="ident" id="8398808">p</span>&nbsp;<span class="op" id="8398810">[</span><span class="op" id="8398811">]</span><span class="builtintype" id="8398812">byte</span><span class="op" id="8398816">)</span>&nbsp;<span class="op" id="8398818">(</span><span class="builtintype" id="8398819">int</span><span class="op" id="8398822">,</span>&nbsp;<span class="builtintype" id="8398824">error</span><span class="op" id="8398829">)</span>&nbsp;<span class="op" id="8398831">{</span>&nbsp;<span class="keyword" id="8398833">return</span>&nbsp;<span class="builtinfunc" id="8398840">len</span><span class="op" id="8398843">(</span><span class="ident" id="8398844"><a href="/archive/zip/zip_test.go.html#8398808">p</a></span><span class="op" id="8398845">)</span><span class="op" id="8398846">,</span>&nbsp;<span class="ident" id="8398848">nil</span>&nbsp;<span class="op" id="8398852">}</span><br>
<span class="lineno">225</span><span class="keyword" id="8398854">func</span>&nbsp;<span class="op" id="8398859">(</span><span class="ident" id="8398860"><a href="/archive/zip/zip_test.go.html#8398748">fakeHash32</a></span><span class="op" id="8398870">)</span>&nbsp;<span class="ident" id="8398872">Sum32</span><span class="op" id="8398877">(</span><span class="op" id="8398878">)</span>&nbsp;<span class="builtintype" id="8398880">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8398901">{</span>&nbsp;<span class="keyword" id="8398903">return</span>&nbsp;<span class="num" id="8398910">0</span>&nbsp;<span class="op" id="8398912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8398915">func</span>&nbsp;<span class="ident" id="8398920">TestZip64</span><span class="op" id="8398929">(</span><span class="ident" id="8398930">t</span>&nbsp;<span class="op" id="8398932">*</span><span class="ident" id="8398933"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8398940">.</span><span class="ident" id="8398941">T</span><span class="op" id="8398942">)</span>&nbsp;<span class="op" id="8398944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8398947">if</span>&nbsp;<span class="ident" id="8398950"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8398957">.</span><span class="ident" id="8398958">Short</span><span class="op" id="8398963">(</span><span class="op" id="8398964">)</span>&nbsp;<span class="op" id="8398966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8398970"><a href="/archive/zip/zip_test.go.html#8398930">t</a></span><span class="op" id="8398971">.</span><span class="ident" id="8398972">Skip</span><span class="op" id="8398976">(</span><span class="string" id="8398977">&#34;slow&nbsp;test;&nbsp;skipping&#34;</span><span class="op" id="8398998">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399004">const</span>&nbsp;<span class="ident" id="8399010">size</span>&nbsp;<span class="op" id="8399015">=</span>&nbsp;<span class="num" id="8399017">1</span>&nbsp;<span class="op" id="8399019">&lt;&lt;</span>&nbsp;<span class="num" id="8399022">32</span>&nbsp;<span class="comment" id="8399025">//&nbsp;before&nbsp;the&nbsp;&#34;END\n&#34;&nbsp;part</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399053"><a href="/archive/zip/zip_test.go.html#8399080">testZip64</a></span><span class="op" id="8399062">(</span><span class="ident" id="8399063"><a href="/archive/zip/zip_test.go.html#8398930">t</a></span><span class="op" id="8399064">,</span>&nbsp;<span class="ident" id="8399066"><a href="/archive/zip/zip_test.go.html#8399010">size</a></span><span class="op" id="8399070">)</span><br>
<span class="lineno"></span><span class="op" id="8399072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="8399075">func</span>&nbsp;<span class="ident" id="8399080">testZip64</span><span class="op" id="8399089">(</span><span class="ident" id="8399090">t</span>&nbsp;<span class="ident" id="8399092"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8399099">.</span><span class="ident" id="8399100">TB</span><span class="op" id="8399102">,</span>&nbsp;<span class="ident" id="8399104">size</span>&nbsp;<span class="ident" id="8399109">int64</span><span class="op" id="8399114">)</span>&nbsp;<span class="op" id="8399116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399119">const</span>&nbsp;<span class="ident" id="8399125">chunkSize</span>&nbsp;<span class="op" id="8399135">=</span>&nbsp;<span class="num" id="8399137">1024</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399143">chunks</span>&nbsp;<span class="op" id="8399150">:=</span>&nbsp;<span class="builtintype" id="8399153">int</span><span class="op" id="8399156">(</span><span class="ident" id="8399157"><a href="/archive/zip/zip_test.go.html#8399104">size</a></span>&nbsp;<span class="op" id="8399162">/</span>&nbsp;<span class="ident" id="8399164"><a href="/archive/zip/zip_test.go.html#8399125">chunkSize</a></span><span class="op" id="8399173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8399176">//&nbsp;write&nbsp;2^32&nbsp;bytes&nbsp;plus&nbsp;&#34;END\n&#34;&nbsp;to&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399224">buf</span>&nbsp;<span class="op" id="8399228">:=</span>&nbsp;<span class="builtinfunc" id="8399231">new</span><span class="op" id="8399234">(</span><span class="ident" id="8399235"><a href="/archive/zip/zip_test.go.html#8396614">rleBuffer</a></span><span class="op" id="8399244">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399247">w</span>&nbsp;<span class="op" id="8399249">:=</span>&nbsp;<span class="ident" id="8399252"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8399261">(</span><span class="ident" id="8399262"><a href="/archive/zip/zip_test.go.html#8399224">buf</a></span><span class="op" id="8399265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399268">f</span><span class="op" id="8399269">,</span>&nbsp;<span class="ident" id="8399271">err</span>&nbsp;<span class="op" id="8399275">:=</span>&nbsp;<span class="ident" id="8399278"><a href="/archive/zip/zip_test.go.html#8399247">w</a></span><span class="op" id="8399279">.</span><span class="ident" id="8399280">CreateHeader</span><span class="op" id="8399292">(</span><span class="op" id="8399293">&amp;</span><span class="ident" id="8399294"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8399304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399308">Name</span><span class="op" id="8399312">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8399316">&#34;huge.txt&#34;</span><span class="op" id="8399326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399330">Method</span><span class="op" id="8399336">:</span>&nbsp;<span class="ident" id="8399338"><a href="/archive/zip/struct.go.html#5697026">Store</a></span><span class="op" id="8399343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399346">}</span><span class="op" id="8399347">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399350">if</span>&nbsp;<span class="ident" id="8399353"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399357">!=</span>&nbsp;<span class="ident" id="8399360">nil</span>&nbsp;<span class="op" id="8399364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399368"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399369">.</span><span class="ident" id="8399370">Fatal</span><span class="op" id="8399375">(</span><span class="ident" id="8399376"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8399379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399385"><a href="/archive/zip/zip_test.go.html#8399268">f</a></span><span class="op" id="8399386">.</span><span class="op" id="8399387">(</span><span class="op" id="8399388">*</span><span class="ident" id="8399389"><a href="/archive/zip/writer.go.html#5712049">fileWriter</a></span><span class="op" id="8399399">)</span><span class="op" id="8399400">.</span><span class="ident" id="8399401">crc32</span>&nbsp;<span class="op" id="8399407">=</span>&nbsp;<span class="ident" id="8399409"><a href="/archive/zip/zip_test.go.html#8398748">fakeHash32</a></span><span class="op" id="8399419">{</span><span class="op" id="8399420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399423">chunk</span>&nbsp;<span class="op" id="8399429">:=</span>&nbsp;<span class="builtinfunc" id="8399432">make</span><span class="op" id="8399436">(</span><span class="op" id="8399437">[</span><span class="op" id="8399438">]</span><span class="builtintype" id="8399439">byte</span><span class="op" id="8399443">,</span>&nbsp;<span class="ident" id="8399445"><a href="/archive/zip/zip_test.go.html#8399125">chunkSize</a></span><span class="op" id="8399454">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399457">for</span>&nbsp;<span class="ident" id="8399461">i</span>&nbsp;<span class="op" id="8399463">:=</span>&nbsp;<span class="keyword" id="8399466">range</span>&nbsp;<span class="ident" id="8399472"><a href="/archive/zip/zip_test.go.html#8399423">chunk</a></span>&nbsp;<span class="op" id="8399478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399482"><a href="/archive/zip/zip_test.go.html#8399423">chunk</a></span><span class="op" id="8399487">[</span><span class="ident" id="8399488"><a href="/archive/zip/zip_test.go.html#8399461">i</a></span><span class="op" id="8399489">]</span>&nbsp;<span class="op" id="8399491">=</span>&nbsp;<span class="string" id="8399493">&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399501">for</span>&nbsp;<span class="ident" id="8399505">i</span>&nbsp;<span class="op" id="8399507">:=</span>&nbsp;<span class="num" id="8399510">0</span><span class="op" id="8399511">;</span>&nbsp;<span class="ident" id="8399513"><a href="/archive/zip/zip_test.go.html#8399505">i</a></span>&nbsp;<span class="op" id="8399515">&lt;</span>&nbsp;<span class="ident" id="8399517"><a href="/archive/zip/zip_test.go.html#8399143">chunks</a></span><span class="op" id="8399523">;</span>&nbsp;<span class="ident" id="8399525"><a href="/archive/zip/zip_test.go.html#8399505">i</a></span><span class="op" id="8399526">++</span>&nbsp;<span class="op" id="8399529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399533">_</span><span class="op" id="8399534">,</span>&nbsp;<span class="ident" id="8399536">err</span>&nbsp;<span class="op" id="8399540">:=</span>&nbsp;<span class="ident" id="8399543"><a href="/archive/zip/zip_test.go.html#8399268">f</a></span><span class="op" id="8399544">.</span><span class="ident" id="8399545">Write</span><span class="op" id="8399550">(</span><span class="ident" id="8399551"><a href="/archive/zip/zip_test.go.html#8399423">chunk</a></span><span class="op" id="8399556">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399560">if</span>&nbsp;<span class="ident" id="8399563"><a href="/archive/zip/zip_test.go.html#8399536">err</a></span>&nbsp;<span class="op" id="8399567">!=</span>&nbsp;<span class="ident" id="8399570">nil</span>&nbsp;<span class="op" id="8399574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399579"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399580">.</span><span class="ident" id="8399581">Fatal</span><span class="op" id="8399586">(</span><span class="string" id="8399587">&#34;write&nbsp;chunk:&#34;</span><span class="op" id="8399601">,</span>&nbsp;<span class="ident" id="8399603"><a href="/archive/zip/zip_test.go.html#8399536">err</a></span><span class="op" id="8399606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399616">end</span>&nbsp;<span class="op" id="8399620">:=</span>&nbsp;<span class="op" id="8399623">[</span><span class="op" id="8399624">]</span><span class="builtintype" id="8399625">byte</span><span class="op" id="8399629">(</span><span class="string" id="8399630">&#34;END\n&#34;</span><span class="op" id="8399637">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399640">_</span><span class="op" id="8399641">,</span>&nbsp;<span class="ident" id="8399643"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399647">=</span>&nbsp;<span class="ident" id="8399649"><a href="/archive/zip/zip_test.go.html#8399268">f</a></span><span class="op" id="8399650">.</span><span class="ident" id="8399651">Write</span><span class="op" id="8399656">(</span><span class="ident" id="8399657"><a href="/archive/zip/zip_test.go.html#8399616">end</a></span><span class="op" id="8399660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399663">if</span>&nbsp;<span class="ident" id="8399666"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399670">!=</span>&nbsp;<span class="ident" id="8399673">nil</span>&nbsp;<span class="op" id="8399677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399681"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399682">.</span><span class="ident" id="8399683">Fatal</span><span class="op" id="8399688">(</span><span class="string" id="8399689">&#34;write&nbsp;end:&#34;</span><span class="op" id="8399701">,</span>&nbsp;<span class="ident" id="8399703"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8399706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399712">if</span>&nbsp;<span class="ident" id="8399715">err</span>&nbsp;<span class="op" id="8399719">:=</span>&nbsp;<span class="ident" id="8399722"><a href="/archive/zip/zip_test.go.html#8399247">w</a></span><span class="op" id="8399723">.</span><span class="ident" id="8399724">Close</span><span class="op" id="8399729">(</span><span class="op" id="8399730">)</span><span class="op" id="8399731">;</span>&nbsp;<span class="ident" id="8399733"><a href="/archive/zip/zip_test.go.html#8399715">err</a></span>&nbsp;<span class="op" id="8399737">!=</span>&nbsp;<span class="ident" id="8399740">nil</span>&nbsp;<span class="op" id="8399744">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399748"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399749">.</span><span class="ident" id="8399750">Fatal</span><span class="op" id="8399755">(</span><span class="ident" id="8399756"><a href="/archive/zip/zip_test.go.html#8399715">err</a></span><span class="op" id="8399759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8399766">//&nbsp;read&nbsp;back&nbsp;zip&nbsp;file&nbsp;and&nbsp;check&nbsp;that&nbsp;we&nbsp;get&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399828">r</span><span class="op" id="8399829">,</span>&nbsp;<span class="ident" id="8399831"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399835">:=</span>&nbsp;<span class="ident" id="8399838"><a href="/archive/zip/reader.go.html#5682445">NewReader</a></span><span class="op" id="8399847">(</span><span class="ident" id="8399848"><a href="/archive/zip/zip_test.go.html#8399224">buf</a></span><span class="op" id="8399851">,</span>&nbsp;<span class="ident" id="8399853">int64</span><span class="op" id="8399858">(</span><span class="ident" id="8399859"><a href="/archive/zip/zip_test.go.html#8399224">buf</a></span><span class="op" id="8399862">.</span><span class="ident" id="8399863">Size</span><span class="op" id="8399867">(</span><span class="op" id="8399868">)</span><span class="op" id="8399869">)</span><span class="op" id="8399870">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399873">if</span>&nbsp;<span class="ident" id="8399876"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399880">!=</span>&nbsp;<span class="ident" id="8399883">nil</span>&nbsp;<span class="op" id="8399887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399891"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399892">.</span><span class="ident" id="8399893">Fatal</span><span class="op" id="8399898">(</span><span class="string" id="8399899">&#34;reader:&#34;</span><span class="op" id="8399908">,</span>&nbsp;<span class="ident" id="8399910"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8399913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8399916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399919">f0</span>&nbsp;<span class="op" id="8399922">:=</span>&nbsp;<span class="ident" id="8399925"><a href="/archive/zip/zip_test.go.html#8399828">r</a></span><span class="op" id="8399926">.</span><span class="ident" id="8399927">File</span><span class="op" id="8399931">[</span><span class="num" id="8399932">0</span><span class="op" id="8399933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399936">rc</span><span class="op" id="8399938">,</span>&nbsp;<span class="ident" id="8399940"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399944">:=</span>&nbsp;<span class="ident" id="8399947"><a href="/archive/zip/zip_test.go.html#8399919">f0</a></span><span class="op" id="8399949">.</span><span class="ident" id="8399950">Open</span><span class="op" id="8399954">(</span><span class="op" id="8399955">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8399958">if</span>&nbsp;<span class="ident" id="8399961"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8399965">!=</span>&nbsp;<span class="ident" id="8399968">nil</span>&nbsp;<span class="op" id="8399972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8399976"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8399977">.</span><span class="ident" id="8399978">Fatal</span><span class="op" id="8399983">(</span><span class="string" id="8399984">&#34;opening:&#34;</span><span class="op" id="8399994">,</span>&nbsp;<span class="ident" id="8399996"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8399999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400005"><a href="/archive/zip/zip_test.go.html#8399936">rc</a></span><span class="op" id="8400007">.</span><span class="op" id="8400008">(</span><span class="op" id="8400009">*</span><span class="ident" id="8400010"><a href="/archive/zip/reader.go.html#5684818">checksumReader</a></span><span class="op" id="8400024">)</span><span class="op" id="8400025">.</span><span class="ident" id="8400026">hash</span>&nbsp;<span class="op" id="8400031">=</span>&nbsp;<span class="ident" id="8400033"><a href="/archive/zip/zip_test.go.html#8398748">fakeHash32</a></span><span class="op" id="8400043">{</span><span class="op" id="8400044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400047">for</span>&nbsp;<span class="ident" id="8400051">i</span>&nbsp;<span class="op" id="8400053">:=</span>&nbsp;<span class="num" id="8400056">0</span><span class="op" id="8400057">;</span>&nbsp;<span class="ident" id="8400059"><a href="/archive/zip/zip_test.go.html#8400051">i</a></span>&nbsp;<span class="op" id="8400061">&lt;</span>&nbsp;<span class="ident" id="8400063"><a href="/archive/zip/zip_test.go.html#8399143">chunks</a></span><span class="op" id="8400069">;</span>&nbsp;<span class="ident" id="8400071"><a href="/archive/zip/zip_test.go.html#8400051">i</a></span><span class="op" id="8400072">++</span>&nbsp;<span class="op" id="8400075">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400079">_</span><span class="op" id="8400080">,</span>&nbsp;<span class="ident" id="8400082">err</span>&nbsp;<span class="op" id="8400086">:=</span>&nbsp;<span class="ident" id="8400089"><a href="/archive/zip/zip_test.go.html#8393734">io</a></span><span class="op" id="8400091">.</span><span class="ident" id="8400092">ReadFull</span><span class="op" id="8400100">(</span><span class="ident" id="8400101"><a href="/archive/zip/zip_test.go.html#8399936">rc</a></span><span class="op" id="8400103">,</span>&nbsp;<span class="ident" id="8400105"><a href="/archive/zip/zip_test.go.html#8399423">chunk</a></span><span class="op" id="8400110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400114">if</span>&nbsp;<span class="ident" id="8400117"><a href="/archive/zip/zip_test.go.html#8400082">err</a></span>&nbsp;<span class="op" id="8400121">!=</span>&nbsp;<span class="ident" id="8400124">nil</span>&nbsp;<span class="op" id="8400128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400133"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400134">.</span><span class="ident" id="8400135">Fatal</span><span class="op" id="8400140">(</span><span class="string" id="8400141">&#34;read:&#34;</span><span class="op" id="8400148">,</span>&nbsp;<span class="ident" id="8400150"><a href="/archive/zip/zip_test.go.html#8400082">err</a></span><span class="op" id="8400153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400160">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400163">gotEnd</span><span class="op" id="8400169">,</span>&nbsp;<span class="ident" id="8400171"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8400175">:=</span>&nbsp;<span class="ident" id="8400178"><a href="/archive/zip/zip_test.go.html#8393740">ioutil</a></span><span class="op" id="8400184">.</span><span class="ident" id="8400185">ReadAll</span><span class="op" id="8400192">(</span><span class="ident" id="8400193"><a href="/archive/zip/zip_test.go.html#8399936">rc</a></span><span class="op" id="8400195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400198">if</span>&nbsp;<span class="ident" id="8400201"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8400205">!=</span>&nbsp;<span class="ident" id="8400208">nil</span>&nbsp;<span class="op" id="8400212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400216"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400217">.</span><span class="ident" id="8400218">Fatal</span><span class="op" id="8400223">(</span><span class="string" id="8400224">&#34;read&nbsp;end:&#34;</span><span class="op" id="8400235">,</span>&nbsp;<span class="ident" id="8400237"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8400240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400246">if</span>&nbsp;<span class="op" id="8400249">!</span><span class="ident" id="8400250"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8400255">.</span><span class="ident" id="8400256">Equal</span><span class="op" id="8400261">(</span><span class="ident" id="8400262"><a href="/archive/zip/zip_test.go.html#8400163">gotEnd</a></span><span class="op" id="8400268">,</span>&nbsp;<span class="ident" id="8400270"><a href="/archive/zip/zip_test.go.html#8399616">end</a></span><span class="op" id="8400273">)</span>&nbsp;<span class="op" id="8400275">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400279"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400280">.</span><span class="ident" id="8400281">Errorf</span><span class="op" id="8400287">(</span><span class="string" id="8400288">&#34;End&nbsp;of&nbsp;zip64&nbsp;archive&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8400322">,</span>&nbsp;<span class="ident" id="8400324"><a href="/archive/zip/zip_test.go.html#8400163">gotEnd</a></span><span class="op" id="8400330">,</span>&nbsp;<span class="ident" id="8400332"><a href="/archive/zip/zip_test.go.html#8399616">end</a></span><span class="op" id="8400335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400341"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8400345">=</span>&nbsp;<span class="ident" id="8400347"><a href="/archive/zip/zip_test.go.html#8399936">rc</a></span><span class="op" id="8400349">.</span><span class="ident" id="8400350">Close</span><span class="op" id="8400355">(</span><span class="op" id="8400356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400359">if</span>&nbsp;<span class="ident" id="8400362"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span>&nbsp;<span class="op" id="8400366">!=</span>&nbsp;<span class="ident" id="8400369">nil</span>&nbsp;<span class="op" id="8400373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400377"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400378">.</span><span class="ident" id="8400379">Fatal</span><span class="op" id="8400384">(</span><span class="string" id="8400385">&#34;closing:&#34;</span><span class="op" id="8400395">,</span>&nbsp;<span class="ident" id="8400397"><a href="/archive/zip/zip_test.go.html#8399271">err</a></span><span class="op" id="8400400">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400406">if</span>&nbsp;<span class="ident" id="8400409"><a href="/archive/zip/zip_test.go.html#8399104">size</a></span>&nbsp;<span class="op" id="8400414">==</span>&nbsp;<span class="num" id="8400417">1</span><span class="op" id="8400418">&lt;&lt;</span><span class="num" id="8400420">32</span>&nbsp;<span class="op" id="8400423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400427">if</span>&nbsp;<span class="ident" id="8400430">got</span><span class="op" id="8400433">,</span>&nbsp;<span class="ident" id="8400435">want</span>&nbsp;<span class="op" id="8400440">:=</span>&nbsp;<span class="ident" id="8400443"><a href="/archive/zip/zip_test.go.html#8399919">f0</a></span><span class="op" id="8400445">.</span><span class="ident" id="8400446">UncompressedSize</span><span class="op" id="8400462">,</span>&nbsp;<span class="builtintype" id="8400464">uint32</span><span class="op" id="8400470">(</span><span class="ident" id="8400471"><a href="/archive/zip/struct.go.html#5698126">uint32max</a></span><span class="op" id="8400480">)</span><span class="op" id="8400481">;</span>&nbsp;<span class="ident" id="8400483"><a href="/archive/zip/zip_test.go.html#8400430">got</a></span>&nbsp;<span class="op" id="8400487">!=</span>&nbsp;<span class="ident" id="8400490"><a href="/archive/zip/zip_test.go.html#8400435">want</a></span>&nbsp;<span class="op" id="8400495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400500"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400501">.</span><span class="ident" id="8400502">Errorf</span><span class="op" id="8400508">(</span><span class="string" id="8400509">&#34;UncompressedSize&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8400539">,</span>&nbsp;<span class="ident" id="8400541"><a href="/archive/zip/zip_test.go.html#8400430">got</a></span><span class="op" id="8400544">,</span>&nbsp;<span class="ident" id="8400546"><a href="/archive/zip/zip_test.go.html#8400435">want</a></span><span class="op" id="8400550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400554">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400561">if</span>&nbsp;<span class="ident" id="8400564">got</span><span class="op" id="8400567">,</span>&nbsp;<span class="ident" id="8400569">want</span>&nbsp;<span class="op" id="8400574">:=</span>&nbsp;<span class="ident" id="8400577"><a href="/archive/zip/zip_test.go.html#8399919">f0</a></span><span class="op" id="8400579">.</span><span class="ident" id="8400580">UncompressedSize64</span><span class="op" id="8400598">,</span>&nbsp;<span class="ident" id="8400600">uint64</span><span class="op" id="8400606">(</span><span class="ident" id="8400607"><a href="/archive/zip/zip_test.go.html#8399104">size</a></span><span class="op" id="8400611">)</span><span class="op" id="8400612">+</span><span class="ident" id="8400613">uint64</span><span class="op" id="8400619">(</span><span class="builtinfunc" id="8400620">len</span><span class="op" id="8400623">(</span><span class="ident" id="8400624"><a href="/archive/zip/zip_test.go.html#8399616">end</a></span><span class="op" id="8400627">)</span><span class="op" id="8400628">)</span><span class="op" id="8400629">;</span>&nbsp;<span class="ident" id="8400631"><a href="/archive/zip/zip_test.go.html#8400564">got</a></span>&nbsp;<span class="op" id="8400635">!=</span>&nbsp;<span class="ident" id="8400638"><a href="/archive/zip/zip_test.go.html#8400569">want</a></span>&nbsp;<span class="op" id="8400643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400647"><a href="/archive/zip/zip_test.go.html#8399090">t</a></span><span class="op" id="8400648">.</span><span class="ident" id="8400649">Errorf</span><span class="op" id="8400655">(</span><span class="string" id="8400656">&#34;UncompressedSize64&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8400688">,</span>&nbsp;<span class="ident" id="8400690"><a href="/archive/zip/zip_test.go.html#8400564">got</a></span><span class="op" id="8400693">,</span>&nbsp;<span class="ident" id="8400695"><a href="/archive/zip/zip_test.go.html#8400569">want</a></span><span class="op" id="8400699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400702">}</span><br>
<span class="lineno">305</span><span class="op" id="8400704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8400707">func</span>&nbsp;<span class="ident" id="8400712">testInvalidHeader</span><span class="op" id="8400729">(</span><span class="ident" id="8400730">h</span>&nbsp;<span class="op" id="8400732">*</span><span class="ident" id="8400733"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8400743">,</span>&nbsp;<span class="ident" id="8400745">t</span>&nbsp;<span class="op" id="8400747">*</span><span class="ident" id="8400748"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8400755">.</span><span class="ident" id="8400756">T</span><span class="op" id="8400757">)</span>&nbsp;<span class="op" id="8400759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400762">var</span>&nbsp;<span class="ident" id="8400766">buf</span>&nbsp;<span class="ident" id="8400770"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8400775">.</span><span class="ident" id="8400776">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400784">z</span>&nbsp;<span class="op" id="8400786">:=</span>&nbsp;<span class="ident" id="8400789"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8400798">(</span><span class="op" id="8400799">&amp;</span><span class="ident" id="8400800"><a href="/archive/zip/zip_test.go.html#8400766">buf</a></span><span class="op" id="8400803">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400807">f</span><span class="op" id="8400808">,</span>&nbsp;<span class="ident" id="8400810">err</span>&nbsp;<span class="op" id="8400814">:=</span>&nbsp;<span class="ident" id="8400817"><a href="/archive/zip/zip_test.go.html#8400784">z</a></span><span class="op" id="8400818">.</span><span class="ident" id="8400819">CreateHeader</span><span class="op" id="8400831">(</span><span class="ident" id="8400832"><a href="/archive/zip/zip_test.go.html#8400730">h</a></span><span class="op" id="8400833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400836">if</span>&nbsp;<span class="ident" id="8400839"><a href="/archive/zip/zip_test.go.html#8400810">err</a></span>&nbsp;<span class="op" id="8400843">!=</span>&nbsp;<span class="ident" id="8400846">nil</span>&nbsp;<span class="op" id="8400850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400854"><a href="/archive/zip/zip_test.go.html#8400745">t</a></span><span class="op" id="8400855">.</span><span class="ident" id="8400856">Fatalf</span><span class="op" id="8400862">(</span><span class="string" id="8400863">&#34;error&nbsp;creating&nbsp;header:&nbsp;%v&#34;</span><span class="op" id="8400890">,</span>&nbsp;<span class="ident" id="8400892"><a href="/archive/zip/zip_test.go.html#8400810">err</a></span><span class="op" id="8400895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400898">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400901">if</span>&nbsp;<span class="ident" id="8400904">_</span><span class="op" id="8400905">,</span>&nbsp;<span class="ident" id="8400907">err</span>&nbsp;<span class="op" id="8400911">:=</span>&nbsp;<span class="ident" id="8400914"><a href="/archive/zip/zip_test.go.html#8400807">f</a></span><span class="op" id="8400915">.</span><span class="ident" id="8400916">Write</span><span class="op" id="8400921">(</span><span class="op" id="8400922">[</span><span class="op" id="8400923">]</span><span class="builtintype" id="8400924">byte</span><span class="op" id="8400928">(</span><span class="string" id="8400929">&#34;hi&#34;</span><span class="op" id="8400933">)</span><span class="op" id="8400934">)</span><span class="op" id="8400935">;</span>&nbsp;<span class="ident" id="8400937"><a href="/archive/zip/zip_test.go.html#8400907">err</a></span>&nbsp;<span class="op" id="8400941">!=</span>&nbsp;<span class="ident" id="8400944">nil</span>&nbsp;<span class="op" id="8400948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8400952"><a href="/archive/zip/zip_test.go.html#8400745">t</a></span><span class="op" id="8400953">.</span><span class="ident" id="8400954">Fatalf</span><span class="op" id="8400960">(</span><span class="string" id="8400961">&#34;error&nbsp;writing&nbsp;content:&nbsp;%v&#34;</span><span class="op" id="8400988">,</span>&nbsp;<span class="ident" id="8400990"><a href="/archive/zip/zip_test.go.html#8400907">err</a></span><span class="op" id="8400993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8400996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8400999">if</span>&nbsp;<span class="ident" id="8401002">err</span>&nbsp;<span class="op" id="8401006">:=</span>&nbsp;<span class="ident" id="8401009"><a href="/archive/zip/zip_test.go.html#8400784">z</a></span><span class="op" id="8401010">.</span><span class="ident" id="8401011">Close</span><span class="op" id="8401016">(</span><span class="op" id="8401017">)</span><span class="op" id="8401018">;</span>&nbsp;<span class="ident" id="8401020"><a href="/archive/zip/zip_test.go.html#8401002">err</a></span>&nbsp;<span class="op" id="8401024">!=</span>&nbsp;<span class="ident" id="8401027">nil</span>&nbsp;<span class="op" id="8401031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401035"><a href="/archive/zip/zip_test.go.html#8400745">t</a></span><span class="op" id="8401036">.</span><span class="ident" id="8401037">Fatalf</span><span class="op" id="8401043">(</span><span class="string" id="8401044">&#34;error&nbsp;closing&nbsp;zip&nbsp;writer:&nbsp;%v&#34;</span><span class="op" id="8401074">,</span>&nbsp;<span class="ident" id="8401076"><a href="/archive/zip/zip_test.go.html#8401002">err</a></span><span class="op" id="8401079">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401086">b</span>&nbsp;<span class="op" id="8401088">:=</span>&nbsp;<span class="ident" id="8401091"><a href="/archive/zip/zip_test.go.html#8400766">buf</a></span><span class="op" id="8401094">.</span><span class="ident" id="8401095">Bytes</span><span class="op" id="8401100">(</span><span class="op" id="8401101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401104">if</span>&nbsp;<span class="ident" id="8401107">_</span><span class="op" id="8401108">,</span>&nbsp;<span class="ident" id="8401110"><a href="/archive/zip/zip_test.go.html#8400810">err</a></span>&nbsp;<span class="op" id="8401114">=</span>&nbsp;<span class="ident" id="8401116"><a href="/archive/zip/reader.go.html#5682445">NewReader</a></span><span class="op" id="8401125">(</span><span class="ident" id="8401126"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8401131">.</span><span class="ident" id="8401132">NewReader</span><span class="op" id="8401141">(</span><span class="ident" id="8401142"><a href="/archive/zip/zip_test.go.html#8401086">b</a></span><span class="op" id="8401143">)</span><span class="op" id="8401144">,</span>&nbsp;<span class="ident" id="8401146">int64</span><span class="op" id="8401151">(</span><span class="builtinfunc" id="8401152">len</span><span class="op" id="8401155">(</span><span class="ident" id="8401156"><a href="/archive/zip/zip_test.go.html#8401086">b</a></span><span class="op" id="8401157">)</span><span class="op" id="8401158">)</span><span class="op" id="8401159">)</span><span class="op" id="8401160">;</span>&nbsp;<span class="ident" id="8401162"><a href="/archive/zip/zip_test.go.html#8400810">err</a></span>&nbsp;<span class="op" id="8401166">!=</span>&nbsp;<span class="ident" id="8401169"><a href="/archive/zip/reader.go.html#5681470">ErrFormat</a></span>&nbsp;<span class="op" id="8401179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401183"><a href="/archive/zip/zip_test.go.html#8400745">t</a></span><span class="op" id="8401184">.</span><span class="ident" id="8401185">Fatalf</span><span class="op" id="8401191">(</span><span class="string" id="8401192">&#34;got&nbsp;%v,&nbsp;expected&nbsp;ErrFormat&#34;</span><span class="op" id="8401220">,</span>&nbsp;<span class="ident" id="8401222"><a href="/archive/zip/zip_test.go.html#8400810">err</a></span><span class="op" id="8401225">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401228">}</span><br>
<span class="lineno"></span><span class="op" id="8401230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8401233">func</span>&nbsp;<span class="ident" id="8401238">testValidHeader</span><span class="op" id="8401253">(</span><span class="ident" id="8401254">h</span>&nbsp;<span class="op" id="8401256">*</span><span class="ident" id="8401257"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8401267">,</span>&nbsp;<span class="ident" id="8401269">t</span>&nbsp;<span class="op" id="8401271">*</span><span class="ident" id="8401272"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8401279">.</span><span class="ident" id="8401280">T</span><span class="op" id="8401281">)</span>&nbsp;<span class="op" id="8401283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401286">var</span>&nbsp;<span class="ident" id="8401290">buf</span>&nbsp;<span class="ident" id="8401294"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8401299">.</span><span class="ident" id="8401300">Buffer</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401308">z</span>&nbsp;<span class="op" id="8401310">:=</span>&nbsp;<span class="ident" id="8401313"><a href="/archive/zip/writer.go.html#5705354">NewWriter</a></span><span class="op" id="8401322">(</span><span class="op" id="8401323">&amp;</span><span class="ident" id="8401324"><a href="/archive/zip/zip_test.go.html#8401290">buf</a></span><span class="op" id="8401327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401331">f</span><span class="op" id="8401332">,</span>&nbsp;<span class="ident" id="8401334">err</span>&nbsp;<span class="op" id="8401338">:=</span>&nbsp;<span class="ident" id="8401341"><a href="/archive/zip/zip_test.go.html#8401308">z</a></span><span class="op" id="8401342">.</span><span class="ident" id="8401343">CreateHeader</span><span class="op" id="8401355">(</span><span class="ident" id="8401356"><a href="/archive/zip/zip_test.go.html#8401254">h</a></span><span class="op" id="8401357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401360">if</span>&nbsp;<span class="ident" id="8401363"><a href="/archive/zip/zip_test.go.html#8401334">err</a></span>&nbsp;<span class="op" id="8401367">!=</span>&nbsp;<span class="ident" id="8401370">nil</span>&nbsp;<span class="op" id="8401374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401378"><a href="/archive/zip/zip_test.go.html#8401269">t</a></span><span class="op" id="8401379">.</span><span class="ident" id="8401380">Fatalf</span><span class="op" id="8401386">(</span><span class="string" id="8401387">&#34;error&nbsp;creating&nbsp;header:&nbsp;%v&#34;</span><span class="op" id="8401414">,</span>&nbsp;<span class="ident" id="8401416"><a href="/archive/zip/zip_test.go.html#8401334">err</a></span><span class="op" id="8401419">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401425">if</span>&nbsp;<span class="ident" id="8401428">_</span><span class="op" id="8401429">,</span>&nbsp;<span class="ident" id="8401431">err</span>&nbsp;<span class="op" id="8401435">:=</span>&nbsp;<span class="ident" id="8401438"><a href="/archive/zip/zip_test.go.html#8401331">f</a></span><span class="op" id="8401439">.</span><span class="ident" id="8401440">Write</span><span class="op" id="8401445">(</span><span class="op" id="8401446">[</span><span class="op" id="8401447">]</span><span class="builtintype" id="8401448">byte</span><span class="op" id="8401452">(</span><span class="string" id="8401453">&#34;hi&#34;</span><span class="op" id="8401457">)</span><span class="op" id="8401458">)</span><span class="op" id="8401459">;</span>&nbsp;<span class="ident" id="8401461"><a href="/archive/zip/zip_test.go.html#8401431">err</a></span>&nbsp;<span class="op" id="8401465">!=</span>&nbsp;<span class="ident" id="8401468">nil</span>&nbsp;<span class="op" id="8401472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401476"><a href="/archive/zip/zip_test.go.html#8401269">t</a></span><span class="op" id="8401477">.</span><span class="ident" id="8401478">Fatalf</span><span class="op" id="8401484">(</span><span class="string" id="8401485">&#34;error&nbsp;writing&nbsp;content:&nbsp;%v&#34;</span><span class="op" id="8401512">,</span>&nbsp;<span class="ident" id="8401514"><a href="/archive/zip/zip_test.go.html#8401431">err</a></span><span class="op" id="8401517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401523">if</span>&nbsp;<span class="ident" id="8401526">err</span>&nbsp;<span class="op" id="8401530">:=</span>&nbsp;<span class="ident" id="8401533"><a href="/archive/zip/zip_test.go.html#8401308">z</a></span><span class="op" id="8401534">.</span><span class="ident" id="8401535">Close</span><span class="op" id="8401540">(</span><span class="op" id="8401541">)</span><span class="op" id="8401542">;</span>&nbsp;<span class="ident" id="8401544"><a href="/archive/zip/zip_test.go.html#8401526">err</a></span>&nbsp;<span class="op" id="8401548">!=</span>&nbsp;<span class="ident" id="8401551">nil</span>&nbsp;<span class="op" id="8401555">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401559"><a href="/archive/zip/zip_test.go.html#8401269">t</a></span><span class="op" id="8401560">.</span><span class="ident" id="8401561">Fatalf</span><span class="op" id="8401567">(</span><span class="string" id="8401568">&#34;error&nbsp;closing&nbsp;zip&nbsp;writer:&nbsp;%v&#34;</span><span class="op" id="8401598">,</span>&nbsp;<span class="ident" id="8401600"><a href="/archive/zip/zip_test.go.html#8401526">err</a></span><span class="op" id="8401603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401610">b</span>&nbsp;<span class="op" id="8401612">:=</span>&nbsp;<span class="ident" id="8401615"><a href="/archive/zip/zip_test.go.html#8401290">buf</a></span><span class="op" id="8401618">.</span><span class="ident" id="8401619">Bytes</span><span class="op" id="8401624">(</span><span class="op" id="8401625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401628">if</span>&nbsp;<span class="ident" id="8401631">_</span><span class="op" id="8401632">,</span>&nbsp;<span class="ident" id="8401634"><a href="/archive/zip/zip_test.go.html#8401334">err</a></span>&nbsp;<span class="op" id="8401638">=</span>&nbsp;<span class="ident" id="8401640"><a href="/archive/zip/reader.go.html#5682445">NewReader</a></span><span class="op" id="8401649">(</span><span class="ident" id="8401650"><a href="/archive/zip/zip_test.go.html#8393710">bytes</a></span><span class="op" id="8401655">.</span><span class="ident" id="8401656">NewReader</span><span class="op" id="8401665">(</span><span class="ident" id="8401666"><a href="/archive/zip/zip_test.go.html#8401610">b</a></span><span class="op" id="8401667">)</span><span class="op" id="8401668">,</span>&nbsp;<span class="ident" id="8401670">int64</span><span class="op" id="8401675">(</span><span class="builtinfunc" id="8401676">len</span><span class="op" id="8401679">(</span><span class="ident" id="8401680"><a href="/archive/zip/zip_test.go.html#8401610">b</a></span><span class="op" id="8401681">)</span><span class="op" id="8401682">)</span><span class="op" id="8401683">)</span><span class="op" id="8401684">;</span>&nbsp;<span class="ident" id="8401686"><a href="/archive/zip/zip_test.go.html#8401334">err</a></span>&nbsp;<span class="op" id="8401690">!=</span>&nbsp;<span class="ident" id="8401693">nil</span>&nbsp;<span class="op" id="8401697">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401701"><a href="/archive/zip/zip_test.go.html#8401269">t</a></span><span class="op" id="8401702">.</span><span class="ident" id="8401703">Fatalf</span><span class="op" id="8401709">(</span><span class="string" id="8401710">&#34;got&nbsp;%v,&nbsp;expected&nbsp;nil&#34;</span><span class="op" id="8401732">,</span>&nbsp;<span class="ident" id="8401734"><a href="/archive/zip/zip_test.go.html#8401334">err</a></span><span class="op" id="8401737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8401740">}</span><br>
<span class="lineno"></span><span class="op" id="8401742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8401745">//&nbsp;Issue&nbsp;4302.</span><br>
<span class="lineno">350</span><span class="keyword" id="8401760">func</span>&nbsp;<span class="ident" id="8401765">TestHeaderInvalidTagAndSize</span><span class="op" id="8401792">(</span><span class="ident" id="8401793">t</span>&nbsp;<span class="op" id="8401795">*</span><span class="ident" id="8401796"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8401803">.</span><span class="ident" id="8401804">T</span><span class="op" id="8401805">)</span>&nbsp;<span class="op" id="8401807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8401810">const</span>&nbsp;<span class="ident" id="8401816">timeFormat</span>&nbsp;<span class="op" id="8401827">=</span>&nbsp;<span class="string" id="8401829">&#34;20060102T150405.000.txt&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401857">ts</span>&nbsp;<span class="op" id="8401860">:=</span>&nbsp;<span class="ident" id="8401863"><a href="/archive/zip/zip_test.go.html#8393783">time</a></span><span class="op" id="8401867">.</span><span class="ident" id="8401868">Now</span><span class="op" id="8401871">(</span><span class="op" id="8401872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401875">filename</span>&nbsp;<span class="op" id="8401884">:=</span>&nbsp;<span class="ident" id="8401887"><a href="/archive/zip/zip_test.go.html#8401857">ts</a></span><span class="op" id="8401889">.</span><span class="ident" id="8401890">Format</span><span class="op" id="8401896">(</span><span class="ident" id="8401897"><a href="/archive/zip/zip_test.go.html#8401816">timeFormat</a></span><span class="op" id="8401907">)</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401911">h</span>&nbsp;<span class="op" id="8401913">:=</span>&nbsp;<span class="ident" id="8401916"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8401926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401930">Name</span><span class="op" id="8401934">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8401938"><a href="/archive/zip/zip_test.go.html#8401875">filename</a></span><span class="op" id="8401946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401950">Method</span><span class="op" id="8401956">:</span>&nbsp;<span class="ident" id="8401958"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8401965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8401969">Extra</span><span class="op" id="8401974">:</span>&nbsp;&nbsp;<span class="op" id="8401977">[</span><span class="op" id="8401978">]</span><span class="builtintype" id="8401979">byte</span><span class="op" id="8401983">(</span><span class="ident" id="8401984"><a href="/archive/zip/zip_test.go.html#8401857">ts</a></span><span class="op" id="8401986">.</span><span class="ident" id="8401987">Format</span><span class="op" id="8401993">(</span><span class="ident" id="8401994"><a href="/archive/zip/zip_test.go.html#8393783">time</a></span><span class="op" id="8401998">.</span><span class="ident" id="8401999">RFC3339Nano</span><span class="op" id="8402010">)</span><span class="op" id="8402011">)</span><span class="op" id="8402012">,</span>&nbsp;<span class="comment" id="8402014">//&nbsp;missing&nbsp;tag&nbsp;and&nbsp;len</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402041"><a href="/archive/zip/zip_test.go.html#8401911">h</a></span><span class="op" id="8402042">.</span><span class="ident" id="8402043">SetModTime</span><span class="op" id="8402053">(</span><span class="ident" id="8402054"><a href="/archive/zip/zip_test.go.html#8401857">ts</a></span><span class="op" id="8402056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402060"><a href="/archive/zip/zip_test.go.html#8400712">testInvalidHeader</a></span><span class="op" id="8402077">(</span><span class="op" id="8402078">&amp;</span><span class="ident" id="8402079"><a href="/archive/zip/zip_test.go.html#8401911">h</a></span><span class="op" id="8402080">,</span>&nbsp;<span class="ident" id="8402082"><a href="/archive/zip/zip_test.go.html#8401793">t</a></span><span class="op" id="8402083">)</span><br>
<span class="lineno"></span><span class="op" id="8402085">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="8402088">func</span>&nbsp;<span class="ident" id="8402093">TestHeaderTooShort</span><span class="op" id="8402111">(</span><span class="ident" id="8402112">t</span>&nbsp;<span class="op" id="8402114">*</span><span class="ident" id="8402115"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8402122">.</span><span class="ident" id="8402123">T</span><span class="op" id="8402124">)</span>&nbsp;<span class="op" id="8402126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402129">h</span>&nbsp;<span class="op" id="8402131">:=</span>&nbsp;<span class="ident" id="8402134"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8402144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402148">Name</span><span class="op" id="8402152">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8402156">&#34;foo.txt&#34;</span><span class="op" id="8402165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402169">Method</span><span class="op" id="8402175">:</span>&nbsp;<span class="ident" id="8402177"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8402184">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402188">Extra</span><span class="op" id="8402193">:</span>&nbsp;&nbsp;<span class="op" id="8402196">[</span><span class="op" id="8402197">]</span><span class="builtintype" id="8402198">byte</span><span class="op" id="8402202">{</span><span class="ident" id="8402203"><a href="/archive/zip/struct.go.html#5698176">zip64ExtraId</a></span><span class="op" id="8402215">}</span><span class="op" id="8402216">,</span>&nbsp;<span class="comment" id="8402218">//&nbsp;missing&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402238"><a href="/archive/zip/zip_test.go.html#8400712">testInvalidHeader</a></span><span class="op" id="8402255">(</span><span class="op" id="8402256">&amp;</span><span class="ident" id="8402257"><a href="/archive/zip/zip_test.go.html#8402129">h</a></span><span class="op" id="8402258">,</span>&nbsp;<span class="ident" id="8402260"><a href="/archive/zip/zip_test.go.html#8402112">t</a></span><span class="op" id="8402261">)</span><br>
<span class="lineno"></span><span class="op" id="8402263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="8402266">//&nbsp;Issue&nbsp;4393.&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;have&nbsp;an&nbsp;extra&nbsp;data&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="8402322">//&nbsp;which&nbsp;contains&nbsp;no&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8402349">func</span>&nbsp;<span class="ident" id="8402354">TestZeroLengthHeader</span><span class="op" id="8402374">(</span><span class="ident" id="8402375">t</span>&nbsp;<span class="op" id="8402377">*</span><span class="ident" id="8402378"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8402385">.</span><span class="ident" id="8402386">T</span><span class="op" id="8402387">)</span>&nbsp;<span class="op" id="8402389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402392">h</span>&nbsp;<span class="op" id="8402394">:=</span>&nbsp;<span class="ident" id="8402397"><a href="/archive/zip/struct.go.html#5698331">FileHeader</a></span><span class="op" id="8402407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402411">Name</span><span class="op" id="8402415">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8402419">&#34;extadata.txt&#34;</span><span class="op" id="8402433">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402437">Method</span><span class="op" id="8402443">:</span>&nbsp;<span class="ident" id="8402445"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="8402452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402456">Extra</span><span class="op" id="8402461">:</span>&nbsp;<span class="op" id="8402463">[</span><span class="op" id="8402464">]</span><span class="builtintype" id="8402465">byte</span><span class="op" id="8402469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8402474">85</span><span class="op" id="8402476">,</span>&nbsp;<span class="num" id="8402478">84</span><span class="op" id="8402480">,</span>&nbsp;<span class="num" id="8402482">5</span><span class="op" id="8402483">,</span>&nbsp;<span class="num" id="8402485">0</span><span class="op" id="8402486">,</span>&nbsp;<span class="num" id="8402488">3</span><span class="op" id="8402489">,</span>&nbsp;<span class="num" id="8402491">154</span><span class="op" id="8402494">,</span>&nbsp;<span class="num" id="8402496">144</span><span class="op" id="8402499">,</span>&nbsp;<span class="num" id="8402501">195</span><span class="op" id="8402504">,</span>&nbsp;<span class="num" id="8402506">77</span><span class="op" id="8402508">,</span>&nbsp;<span class="comment" id="8402510">//&nbsp;tag&nbsp;21589&nbsp;size&nbsp;5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8402533">85</span><span class="op" id="8402535">,</span>&nbsp;<span class="num" id="8402537">120</span><span class="op" id="8402540">,</span>&nbsp;<span class="num" id="8402542">0</span><span class="op" id="8402543">,</span>&nbsp;<span class="num" id="8402545">0</span><span class="op" id="8402546">,</span>&nbsp;<span class="comment" id="8402548">//&nbsp;tag&nbsp;30805&nbsp;size&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402570">}</span><span class="op" id="8402571">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402577"><a href="/archive/zip/zip_test.go.html#8401238">testValidHeader</a></span><span class="op" id="8402592">(</span><span class="op" id="8402593">&amp;</span><span class="ident" id="8402594"><a href="/archive/zip/zip_test.go.html#8402392">h</a></span><span class="op" id="8402595">,</span>&nbsp;<span class="ident" id="8402597"><a href="/archive/zip/zip_test.go.html#8402375">t</a></span><span class="op" id="8402598">)</span><br>
<span class="lineno"></span><span class="op" id="8402600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8402603">//&nbsp;Just&nbsp;benchmarking&nbsp;how&nbsp;fast&nbsp;the&nbsp;Zip64&nbsp;test&nbsp;above&nbsp;is.&nbsp;Not&nbsp;related&nbsp;to</span><br>
<span class="lineno">390</span><span class="comment" id="8402673">//&nbsp;our&nbsp;zip&nbsp;performance,&nbsp;since&nbsp;the&nbsp;test&nbsp;above&nbsp;disabled&nbsp;CRC32&nbsp;and&nbsp;flate.</span><br>
<span class="lineno"></span><span class="keyword" id="8402744">func</span>&nbsp;<span class="ident" id="8402749">BenchmarkZip64Test</span><span class="op" id="8402767">(</span><span class="ident" id="8402768">b</span>&nbsp;<span class="op" id="8402770">*</span><span class="ident" id="8402771"><a href="/archive/zip/zip_test.go.html#8393772">testing</a></span><span class="op" id="8402778">.</span><span class="ident" id="8402779">B</span><span class="op" id="8402780">)</span>&nbsp;<span class="op" id="8402782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402785">for</span>&nbsp;<span class="ident" id="8402789">i</span>&nbsp;<span class="op" id="8402791">:=</span>&nbsp;<span class="num" id="8402794">0</span><span class="op" id="8402795">;</span>&nbsp;<span class="ident" id="8402797"><a href="/archive/zip/zip_test.go.html#8402789">i</a></span>&nbsp;<span class="op" id="8402799">&lt;</span>&nbsp;<span class="ident" id="8402801"><a href="/archive/zip/zip_test.go.html#8402768">b</a></span><span class="op" id="8402802">.</span><span class="ident" id="8402803">N</span><span class="op" id="8402804">;</span>&nbsp;<span class="ident" id="8402806"><a href="/archive/zip/zip_test.go.html#8402789">i</a></span><span class="op" id="8402807">++</span>&nbsp;<span class="op" id="8402810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402814"><a href="/archive/zip/zip_test.go.html#8399080">testZip64</a></span><span class="op" id="8402823">(</span><span class="ident" id="8402824"><a href="/archive/zip/zip_test.go.html#8402768">b</a></span><span class="op" id="8402825">,</span>&nbsp;<span class="num" id="8402827">1</span><span class="op" id="8402828">&lt;&lt;</span><span class="num" id="8402830">26</span><span class="op" id="8402832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402835">}</span><br>
<span class="lineno">395</span><span class="op" id="8402837">}</span>
</div>
</body>
</html>
