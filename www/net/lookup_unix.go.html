<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3403500">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3403556">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3403610">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3403661">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3403726">package</span>&nbsp;<span class="ident" id="3403734">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3403739">import</span>&nbsp;<span class="op" id="3403746">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3403749">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3403759">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3403766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3403769">var</span>&nbsp;<span class="ident" id="3403773">onceReadProtocols</span>&nbsp;<span class="ident" id="3403791">sync</span><span class="op" id="3403795">.</span><span class="ident" id="3403796">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3403802">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3403871">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3403892">func</span>&nbsp;<span class="ident" id="3403897">readProtocols</span><span class="op" id="3403910">(</span><span class="op" id="3403911">)</span>&nbsp;<span class="op" id="3403913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3403916">if</span>&nbsp;<span class="ident" id="3403919">file</span><span class="op" id="3403923">,</span>&nbsp;<span class="ident" id="3403925">err</span>&nbsp;<span class="op" id="3403929">:=</span>&nbsp;<span class="ident" id="3403932">open</span><span class="op" id="3403936">(</span><span class="string" id="3403937">&#34;/etc/protocols&#34;</span><span class="op" id="3403953">)</span><span class="op" id="3403954">;</span>&nbsp;<span class="ident" id="3403956">err</span>&nbsp;<span class="op" id="3403960">==</span>&nbsp;<span class="ident" id="3403963">nil</span>&nbsp;<span class="op" id="3403967">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3403971">for</span>&nbsp;<span class="ident" id="3403975">line</span><span class="op" id="3403979">,</span>&nbsp;<span class="ident" id="3403981">ok</span>&nbsp;<span class="op" id="3403984">:=</span>&nbsp;<span class="ident" id="3403987">file</span><span class="op" id="3403991">.</span><span class="ident" id="3403992">readLine</span><span class="op" id="3404000">(</span><span class="op" id="3404001">)</span><span class="op" id="3404002">;</span>&nbsp;<span class="ident" id="3404004">ok</span><span class="op" id="3404006">;</span>&nbsp;<span class="ident" id="3404008">line</span><span class="op" id="3404012">,</span>&nbsp;<span class="ident" id="3404014">ok</span>&nbsp;<span class="op" id="3404017">=</span>&nbsp;<span class="ident" id="3404019">file</span><span class="op" id="3404023">.</span><span class="ident" id="3404024">readLine</span><span class="op" id="3404032">(</span><span class="op" id="3404033">)</span>&nbsp;<span class="op" id="3404035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3404040">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404096">if</span>&nbsp;<span class="ident" id="3404099">i</span>&nbsp;<span class="op" id="3404101">:=</span>&nbsp;<span class="ident" id="3404104">byteIndex</span><span class="op" id="3404113">(</span><span class="ident" id="3404114">line</span><span class="op" id="3404118">,</span>&nbsp;<span class="string" id="3404120">&#39;#&#39;</span><span class="op" id="3404123">)</span><span class="op" id="3404124">;</span>&nbsp;<span class="ident" id="3404126">i</span>&nbsp;<span class="op" id="3404128">&gt;=</span>&nbsp;<span class="num" id="3404131">0</span>&nbsp;<span class="op" id="3404133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404139">line</span>&nbsp;<span class="op" id="3404144">=</span>&nbsp;<span class="ident" id="3404146">line</span><span class="op" id="3404150">[</span><span class="num" id="3404151">0</span><span class="op" id="3404152">:</span><span class="ident" id="3404153">i</span><span class="op" id="3404154">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404159">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404164">f</span>&nbsp;<span class="op" id="3404166">:=</span>&nbsp;<span class="ident" id="3404169">getFields</span><span class="op" id="3404178">(</span><span class="ident" id="3404179">line</span><span class="op" id="3404183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404188">if</span>&nbsp;<span class="builtinfunc" id="3404191">len</span><span class="op" id="3404194">(</span><span class="ident" id="3404195">f</span><span class="op" id="3404196">)</span>&nbsp;<span class="op" id="3404198">&lt;</span>&nbsp;<span class="num" id="3404200">2</span>&nbsp;<span class="op" id="3404202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404208">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404225">if</span>&nbsp;<span class="ident" id="3404228">proto</span><span class="op" id="3404233">,</span>&nbsp;<span class="ident" id="3404235">_</span><span class="op" id="3404236">,</span>&nbsp;<span class="ident" id="3404238">ok</span>&nbsp;<span class="op" id="3404241">:=</span>&nbsp;<span class="ident" id="3404244">dtoi</span><span class="op" id="3404248">(</span><span class="ident" id="3404249">f</span><span class="op" id="3404250">[</span><span class="num" id="3404251">1</span><span class="op" id="3404252">]</span><span class="op" id="3404253">,</span>&nbsp;<span class="num" id="3404255">0</span><span class="op" id="3404256">)</span><span class="op" id="3404257">;</span>&nbsp;<span class="ident" id="3404259">ok</span>&nbsp;<span class="op" id="3404262">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404268">if</span>&nbsp;<span class="ident" id="3404271">_</span><span class="op" id="3404272">,</span>&nbsp;<span class="ident" id="3404274">ok</span>&nbsp;<span class="op" id="3404277">:=</span>&nbsp;<span class="ident" id="3404280">protocols</span><span class="op" id="3404289">[</span><span class="ident" id="3404290">f</span><span class="op" id="3404291">[</span><span class="num" id="3404292">0</span><span class="op" id="3404293">]</span><span class="op" id="3404294">]</span><span class="op" id="3404295">;</span>&nbsp;<span class="op" id="3404297">!</span><span class="ident" id="3404298">ok</span>&nbsp;<span class="op" id="3404301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404308">protocols</span><span class="op" id="3404317">[</span><span class="ident" id="3404318">f</span><span class="op" id="3404319">[</span><span class="num" id="3404320">0</span><span class="op" id="3404321">]</span><span class="op" id="3404322">]</span>&nbsp;<span class="op" id="3404324">=</span>&nbsp;<span class="ident" id="3404326">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404342">for</span>&nbsp;<span class="ident" id="3404346">_</span><span class="op" id="3404347">,</span>&nbsp;<span class="ident" id="3404349">alias</span>&nbsp;<span class="op" id="3404355">:=</span>&nbsp;<span class="keyword" id="3404358">range</span>&nbsp;<span class="ident" id="3404364">f</span><span class="op" id="3404365">[</span><span class="num" id="3404366">2</span><span class="op" id="3404367">:</span><span class="op" id="3404368">]</span>&nbsp;<span class="op" id="3404370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404377">if</span>&nbsp;<span class="ident" id="3404380">_</span><span class="op" id="3404381">,</span>&nbsp;<span class="ident" id="3404383">ok</span>&nbsp;<span class="op" id="3404386">:=</span>&nbsp;<span class="ident" id="3404389">protocols</span><span class="op" id="3404398">[</span><span class="ident" id="3404399">alias</span><span class="op" id="3404404">]</span><span class="op" id="3404405">;</span>&nbsp;<span class="op" id="3404407">!</span><span class="ident" id="3404408">ok</span>&nbsp;<span class="op" id="3404411">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404419">protocols</span><span class="op" id="3404428">[</span><span class="ident" id="3404429">alias</span><span class="op" id="3404434">]</span>&nbsp;<span class="op" id="3404436">=</span>&nbsp;<span class="ident" id="3404438">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404464">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404468">file</span><span class="op" id="3404472">.</span><span class="builtinfunc" id="3404473">close</span><span class="op" id="3404478">(</span><span class="op" id="3404479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404482">}</span><br>
<span class="lineno"></span><span class="op" id="3404484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3404487">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3404553">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3404595">func</span>&nbsp;<span class="ident" id="3404600">lookupProtocol</span><span class="op" id="3404614">(</span><span class="ident" id="3404615">name</span>&nbsp;<span class="builtintype" id="3404620">string</span><span class="op" id="3404626">)</span>&nbsp;<span class="op" id="3404628">(</span><span class="ident" id="3404629">proto</span>&nbsp;<span class="builtintype" id="3404635">int</span><span class="op" id="3404638">,</span>&nbsp;<span class="ident" id="3404640">err</span>&nbsp;<span class="builtintype" id="3404644">error</span><span class="op" id="3404649">)</span>&nbsp;<span class="op" id="3404651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404654">onceReadProtocols</span><span class="op" id="3404671">.</span><span class="ident" id="3404672">Do</span><span class="op" id="3404674">(</span><span class="ident" id="3404675">readProtocols</span><span class="op" id="3404688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404691">proto</span><span class="op" id="3404696">,</span>&nbsp;<span class="ident" id="3404698">found</span>&nbsp;<span class="op" id="3404704">:=</span>&nbsp;<span class="ident" id="3404707">protocols</span><span class="op" id="3404716">[</span><span class="ident" id="3404717">name</span><span class="op" id="3404721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404724">if</span>&nbsp;<span class="op" id="3404727">!</span><span class="ident" id="3404728">found</span>&nbsp;<span class="op" id="3404734">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404738">return</span>&nbsp;<span class="num" id="3404745">0</span><span class="op" id="3404746">,</span>&nbsp;<span class="ident" id="3404748">errors</span><span class="op" id="3404754">.</span><span class="ident" id="3404755">New</span><span class="op" id="3404758">(</span><span class="string" id="3404759">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3404793">+</span>&nbsp;<span class="ident" id="3404795">name</span><span class="op" id="3404799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404805">return</span><br>
<span class="lineno"></span><span class="op" id="3404812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3404815">func</span>&nbsp;<span class="ident" id="3404820">lookupHost</span><span class="op" id="3404830">(</span><span class="ident" id="3404831">host</span>&nbsp;<span class="builtintype" id="3404836">string</span><span class="op" id="3404842">)</span>&nbsp;<span class="op" id="3404844">(</span><span class="ident" id="3404845">addrs</span>&nbsp;<span class="op" id="3404851">[</span><span class="op" id="3404852">]</span><span class="builtintype" id="3404853">string</span><span class="op" id="3404859">,</span>&nbsp;<span class="ident" id="3404861">err</span>&nbsp;<span class="builtintype" id="3404865">error</span><span class="op" id="3404870">)</span>&nbsp;<span class="op" id="3404872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404875">addrs</span><span class="op" id="3404880">,</span>&nbsp;<span class="ident" id="3404882">err</span><span class="op" id="3404885">,</span>&nbsp;<span class="ident" id="3404887">ok</span>&nbsp;<span class="op" id="3404890">:=</span>&nbsp;<span class="ident" id="3404893">cgoLookupHost</span><span class="op" id="3404906">(</span><span class="ident" id="3404907">host</span><span class="op" id="3404911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404914">if</span>&nbsp;<span class="op" id="3404917">!</span><span class="ident" id="3404918">ok</span>&nbsp;<span class="op" id="3404921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3404925">addrs</span><span class="op" id="3404930">,</span>&nbsp;<span class="ident" id="3404932">err</span>&nbsp;<span class="op" id="3404936">=</span>&nbsp;<span class="ident" id="3404938">goLookupHost</span><span class="op" id="3404950">(</span><span class="ident" id="3404951">host</span><span class="op" id="3404955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3404958">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3404961">return</span><br>
<span class="lineno"></span><span class="op" id="3404968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3404971">func</span>&nbsp;<span class="ident" id="3404976">lookupIP</span><span class="op" id="3404984">(</span><span class="ident" id="3404985">host</span>&nbsp;<span class="builtintype" id="3404990">string</span><span class="op" id="3404996">)</span>&nbsp;<span class="op" id="3404998">(</span><span class="ident" id="3404999">addrs</span>&nbsp;<span class="op" id="3405005">[</span><span class="op" id="3405006">]</span><span class="ident" id="3405007">IP</span><span class="op" id="3405009">,</span>&nbsp;<span class="ident" id="3405011">err</span>&nbsp;<span class="builtintype" id="3405015">error</span><span class="op" id="3405020">)</span>&nbsp;<span class="op" id="3405022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405025">addrs</span><span class="op" id="3405030">,</span>&nbsp;<span class="ident" id="3405032">err</span><span class="op" id="3405035">,</span>&nbsp;<span class="ident" id="3405037">ok</span>&nbsp;<span class="op" id="3405040">:=</span>&nbsp;<span class="ident" id="3405043">cgoLookupIP</span><span class="op" id="3405054">(</span><span class="ident" id="3405055">host</span><span class="op" id="3405059">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405062">if</span>&nbsp;<span class="op" id="3405065">!</span><span class="ident" id="3405066">ok</span>&nbsp;<span class="op" id="3405069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405073">addrs</span><span class="op" id="3405078">,</span>&nbsp;<span class="ident" id="3405080">err</span>&nbsp;<span class="op" id="3405084">=</span>&nbsp;<span class="ident" id="3405086">goLookupIP</span><span class="op" id="3405096">(</span><span class="ident" id="3405097">host</span><span class="op" id="3405101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405107">return</span><br>
<span class="lineno"></span><span class="op" id="3405114">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3405117">func</span>&nbsp;<span class="ident" id="3405122">lookupPort</span><span class="op" id="3405132">(</span><span class="ident" id="3405133">network</span><span class="op" id="3405140">,</span>&nbsp;<span class="ident" id="3405142">service</span>&nbsp;<span class="builtintype" id="3405150">string</span><span class="op" id="3405156">)</span>&nbsp;<span class="op" id="3405158">(</span><span class="ident" id="3405159">port</span>&nbsp;<span class="builtintype" id="3405164">int</span><span class="op" id="3405167">,</span>&nbsp;<span class="ident" id="3405169">err</span>&nbsp;<span class="builtintype" id="3405173">error</span><span class="op" id="3405178">)</span>&nbsp;<span class="op" id="3405180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405183">port</span><span class="op" id="3405187">,</span>&nbsp;<span class="ident" id="3405189">err</span><span class="op" id="3405192">,</span>&nbsp;<span class="ident" id="3405194">ok</span>&nbsp;<span class="op" id="3405197">:=</span>&nbsp;<span class="ident" id="3405200">cgoLookupPort</span><span class="op" id="3405213">(</span><span class="ident" id="3405214">network</span><span class="op" id="3405221">,</span>&nbsp;<span class="ident" id="3405223">service</span><span class="op" id="3405230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405233">if</span>&nbsp;<span class="op" id="3405236">!</span><span class="ident" id="3405237">ok</span>&nbsp;<span class="op" id="3405240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405244">port</span><span class="op" id="3405248">,</span>&nbsp;<span class="ident" id="3405250">err</span>&nbsp;<span class="op" id="3405254">=</span>&nbsp;<span class="ident" id="3405256">goLookupPort</span><span class="op" id="3405268">(</span><span class="ident" id="3405269">network</span><span class="op" id="3405276">,</span>&nbsp;<span class="ident" id="3405278">service</span><span class="op" id="3405285">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405291">return</span><br>
<span class="lineno"></span><span class="op" id="3405298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3405301">func</span>&nbsp;<span class="ident" id="3405306">lookupCNAME</span><span class="op" id="3405317">(</span><span class="ident" id="3405318">name</span>&nbsp;<span class="builtintype" id="3405323">string</span><span class="op" id="3405329">)</span>&nbsp;<span class="op" id="3405331">(</span><span class="ident" id="3405332">cname</span>&nbsp;<span class="builtintype" id="3405338">string</span><span class="op" id="3405344">,</span>&nbsp;<span class="ident" id="3405346">err</span>&nbsp;<span class="builtintype" id="3405350">error</span><span class="op" id="3405355">)</span>&nbsp;<span class="op" id="3405357">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405360">cname</span><span class="op" id="3405365">,</span>&nbsp;<span class="ident" id="3405367">err</span><span class="op" id="3405370">,</span>&nbsp;<span class="ident" id="3405372">ok</span>&nbsp;<span class="op" id="3405375">:=</span>&nbsp;<span class="ident" id="3405378">cgoLookupCNAME</span><span class="op" id="3405392">(</span><span class="ident" id="3405393">name</span><span class="op" id="3405397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405400">if</span>&nbsp;<span class="op" id="3405403">!</span><span class="ident" id="3405404">ok</span>&nbsp;<span class="op" id="3405407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405411">cname</span><span class="op" id="3405416">,</span>&nbsp;<span class="ident" id="3405418">err</span>&nbsp;<span class="op" id="3405422">=</span>&nbsp;<span class="ident" id="3405424">goLookupCNAME</span><span class="op" id="3405437">(</span><span class="ident" id="3405438">name</span><span class="op" id="3405442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405448">return</span><br>
<span class="lineno">85</span><span class="op" id="3405455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3405458">func</span>&nbsp;<span class="ident" id="3405463">lookupSRV</span><span class="op" id="3405472">(</span><span class="ident" id="3405473">service</span><span class="op" id="3405480">,</span>&nbsp;<span class="ident" id="3405482">proto</span><span class="op" id="3405487">,</span>&nbsp;<span class="ident" id="3405489">name</span>&nbsp;<span class="builtintype" id="3405494">string</span><span class="op" id="3405500">)</span>&nbsp;<span class="op" id="3405502">(</span><span class="ident" id="3405503">cname</span>&nbsp;<span class="builtintype" id="3405509">string</span><span class="op" id="3405515">,</span>&nbsp;<span class="ident" id="3405517">addrs</span>&nbsp;<span class="op" id="3405523">[</span><span class="op" id="3405524">]</span><span class="op" id="3405525">*</span><span class="ident" id="3405526">SRV</span><span class="op" id="3405529">,</span>&nbsp;<span class="ident" id="3405531">err</span>&nbsp;<span class="builtintype" id="3405535">error</span><span class="op" id="3405540">)</span>&nbsp;<span class="op" id="3405542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405545">var</span>&nbsp;<span class="ident" id="3405549">target</span>&nbsp;<span class="builtintype" id="3405556">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405564">if</span>&nbsp;<span class="ident" id="3405567">service</span>&nbsp;<span class="op" id="3405575">==</span>&nbsp;<span class="string" id="3405578">&#34;&#34;</span>&nbsp;<span class="op" id="3405581">&amp;&amp;</span>&nbsp;<span class="ident" id="3405584">proto</span>&nbsp;<span class="op" id="3405590">==</span>&nbsp;<span class="string" id="3405593">&#34;&#34;</span>&nbsp;<span class="op" id="3405596">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405600">target</span>&nbsp;<span class="op" id="3405607">=</span>&nbsp;<span class="ident" id="3405609">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405615">}</span>&nbsp;<span class="keyword" id="3405617">else</span>&nbsp;<span class="op" id="3405622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405626">target</span>&nbsp;<span class="op" id="3405633">=</span>&nbsp;<span class="string" id="3405635">&#34;_&#34;</span>&nbsp;<span class="op" id="3405639">+</span>&nbsp;<span class="ident" id="3405641">service</span>&nbsp;<span class="op" id="3405649">+</span>&nbsp;<span class="string" id="3405651">&#34;._&#34;</span>&nbsp;<span class="op" id="3405656">+</span>&nbsp;<span class="ident" id="3405658">proto</span>&nbsp;<span class="op" id="3405664">+</span>&nbsp;<span class="string" id="3405666">&#34;.&#34;</span>&nbsp;<span class="op" id="3405670">+</span>&nbsp;<span class="ident" id="3405672">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405681">var</span>&nbsp;<span class="ident" id="3405685">records</span>&nbsp;<span class="op" id="3405693">[</span><span class="op" id="3405694">]</span><span class="ident" id="3405695">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405702">cname</span><span class="op" id="3405707">,</span>&nbsp;<span class="ident" id="3405709">records</span><span class="op" id="3405716">,</span>&nbsp;<span class="ident" id="3405718">err</span>&nbsp;<span class="op" id="3405722">=</span>&nbsp;<span class="ident" id="3405724">lookup</span><span class="op" id="3405730">(</span><span class="ident" id="3405731">target</span><span class="op" id="3405737">,</span>&nbsp;<span class="ident" id="3405739">dnsTypeSRV</span><span class="op" id="3405749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405752">if</span>&nbsp;<span class="ident" id="3405755">err</span>&nbsp;<span class="op" id="3405759">!=</span>&nbsp;<span class="ident" id="3405762">nil</span>&nbsp;<span class="op" id="3405766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405770">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405781">addrs</span>&nbsp;<span class="op" id="3405787">=</span>&nbsp;<span class="builtinfunc" id="3405789">make</span><span class="op" id="3405793">(</span><span class="op" id="3405794">[</span><span class="op" id="3405795">]</span><span class="op" id="3405796">*</span><span class="ident" id="3405797">SRV</span><span class="op" id="3405800">,</span>&nbsp;<span class="builtinfunc" id="3405802">len</span><span class="op" id="3405805">(</span><span class="ident" id="3405806">records</span><span class="op" id="3405813">)</span><span class="op" id="3405814">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405817">for</span>&nbsp;<span class="ident" id="3405821">i</span><span class="op" id="3405822">,</span>&nbsp;<span class="ident" id="3405824">rr</span>&nbsp;<span class="op" id="3405827">:=</span>&nbsp;<span class="keyword" id="3405830">range</span>&nbsp;<span class="ident" id="3405836">records</span>&nbsp;<span class="op" id="3405844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405848">r</span>&nbsp;<span class="op" id="3405850">:=</span>&nbsp;<span class="ident" id="3405853">rr</span><span class="op" id="3405855">.</span><span class="op" id="3405856">(</span><span class="op" id="3405857">*</span><span class="ident" id="3405858">dnsRR_SRV</span><span class="op" id="3405867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405871">addrs</span><span class="op" id="3405876">[</span><span class="ident" id="3405877">i</span><span class="op" id="3405878">]</span>&nbsp;<span class="op" id="3405880">=</span>&nbsp;<span class="op" id="3405882">&amp;</span><span class="ident" id="3405883">SRV</span><span class="op" id="3405886">{</span><span class="ident" id="3405887">r</span><span class="op" id="3405888">.</span><span class="ident" id="3405889">Target</span><span class="op" id="3405895">,</span>&nbsp;<span class="ident" id="3405897">r</span><span class="op" id="3405898">.</span><span class="ident" id="3405899">Port</span><span class="op" id="3405903">,</span>&nbsp;<span class="ident" id="3405905">r</span><span class="op" id="3405906">.</span><span class="ident" id="3405907">Priority</span><span class="op" id="3405915">,</span>&nbsp;<span class="ident" id="3405917">r</span><span class="op" id="3405918">.</span><span class="ident" id="3405919">Weight</span><span class="op" id="3405925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3405928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3405931">byPriorityWeight</span><span class="op" id="3405947">(</span><span class="ident" id="3405948">addrs</span><span class="op" id="3405953">)</span><span class="op" id="3405954">.</span><span class="ident" id="3405955">sort</span><span class="op" id="3405959">(</span><span class="op" id="3405960">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3405963">return</span><br>
<span class="lineno"></span><span class="op" id="3405970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3405973">func</span>&nbsp;<span class="ident" id="3405978">lookupMX</span><span class="op" id="3405986">(</span><span class="ident" id="3405987">name</span>&nbsp;<span class="builtintype" id="3405992">string</span><span class="op" id="3405998">)</span>&nbsp;<span class="op" id="3406000">(</span><span class="ident" id="3406001">mx</span>&nbsp;<span class="op" id="3406004">[</span><span class="op" id="3406005">]</span><span class="op" id="3406006">*</span><span class="ident" id="3406007">MX</span><span class="op" id="3406009">,</span>&nbsp;<span class="ident" id="3406011">err</span>&nbsp;<span class="builtintype" id="3406015">error</span><span class="op" id="3406020">)</span>&nbsp;<span class="op" id="3406022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406025">_</span><span class="op" id="3406026">,</span>&nbsp;<span class="ident" id="3406028">records</span><span class="op" id="3406035">,</span>&nbsp;<span class="ident" id="3406037">err</span>&nbsp;<span class="op" id="3406041">:=</span>&nbsp;<span class="ident" id="3406044">lookup</span><span class="op" id="3406050">(</span><span class="ident" id="3406051">name</span><span class="op" id="3406055">,</span>&nbsp;<span class="ident" id="3406057">dnsTypeMX</span><span class="op" id="3406066">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406069">if</span>&nbsp;<span class="ident" id="3406072">err</span>&nbsp;<span class="op" id="3406076">!=</span>&nbsp;<span class="ident" id="3406079">nil</span>&nbsp;<span class="op" id="3406083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406087">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406098">mx</span>&nbsp;<span class="op" id="3406101">=</span>&nbsp;<span class="builtinfunc" id="3406103">make</span><span class="op" id="3406107">(</span><span class="op" id="3406108">[</span><span class="op" id="3406109">]</span><span class="op" id="3406110">*</span><span class="ident" id="3406111">MX</span><span class="op" id="3406113">,</span>&nbsp;<span class="builtinfunc" id="3406115">len</span><span class="op" id="3406118">(</span><span class="ident" id="3406119">records</span><span class="op" id="3406126">)</span><span class="op" id="3406127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406130">for</span>&nbsp;<span class="ident" id="3406134">i</span><span class="op" id="3406135">,</span>&nbsp;<span class="ident" id="3406137">rr</span>&nbsp;<span class="op" id="3406140">:=</span>&nbsp;<span class="keyword" id="3406143">range</span>&nbsp;<span class="ident" id="3406149">records</span>&nbsp;<span class="op" id="3406157">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406161">r</span>&nbsp;<span class="op" id="3406163">:=</span>&nbsp;<span class="ident" id="3406166">rr</span><span class="op" id="3406168">.</span><span class="op" id="3406169">(</span><span class="op" id="3406170">*</span><span class="ident" id="3406171">dnsRR_MX</span><span class="op" id="3406179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406183">mx</span><span class="op" id="3406185">[</span><span class="ident" id="3406186">i</span><span class="op" id="3406187">]</span>&nbsp;<span class="op" id="3406189">=</span>&nbsp;<span class="op" id="3406191">&amp;</span><span class="ident" id="3406192">MX</span><span class="op" id="3406194">{</span><span class="ident" id="3406195">r</span><span class="op" id="3406196">.</span><span class="ident" id="3406197">Mx</span><span class="op" id="3406199">,</span>&nbsp;<span class="ident" id="3406201">r</span><span class="op" id="3406202">.</span><span class="ident" id="3406203">Pref</span><span class="op" id="3406207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406213">byPref</span><span class="op" id="3406219">(</span><span class="ident" id="3406220">mx</span><span class="op" id="3406222">)</span><span class="op" id="3406223">.</span><span class="ident" id="3406224">sort</span><span class="op" id="3406228">(</span><span class="op" id="3406229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406232">return</span><br>
<span class="lineno">120</span><span class="op" id="3406239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3406242">func</span>&nbsp;<span class="ident" id="3406247">lookupNS</span><span class="op" id="3406255">(</span><span class="ident" id="3406256">name</span>&nbsp;<span class="builtintype" id="3406261">string</span><span class="op" id="3406267">)</span>&nbsp;<span class="op" id="3406269">(</span><span class="ident" id="3406270">ns</span>&nbsp;<span class="op" id="3406273">[</span><span class="op" id="3406274">]</span><span class="op" id="3406275">*</span><span class="ident" id="3406276">NS</span><span class="op" id="3406278">,</span>&nbsp;<span class="ident" id="3406280">err</span>&nbsp;<span class="builtintype" id="3406284">error</span><span class="op" id="3406289">)</span>&nbsp;<span class="op" id="3406291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406294">_</span><span class="op" id="3406295">,</span>&nbsp;<span class="ident" id="3406297">records</span><span class="op" id="3406304">,</span>&nbsp;<span class="ident" id="3406306">err</span>&nbsp;<span class="op" id="3406310">:=</span>&nbsp;<span class="ident" id="3406313">lookup</span><span class="op" id="3406319">(</span><span class="ident" id="3406320">name</span><span class="op" id="3406324">,</span>&nbsp;<span class="ident" id="3406326">dnsTypeNS</span><span class="op" id="3406335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406338">if</span>&nbsp;<span class="ident" id="3406341">err</span>&nbsp;<span class="op" id="3406345">!=</span>&nbsp;<span class="ident" id="3406348">nil</span>&nbsp;<span class="op" id="3406352">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406356">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406367">ns</span>&nbsp;<span class="op" id="3406370">=</span>&nbsp;<span class="builtinfunc" id="3406372">make</span><span class="op" id="3406376">(</span><span class="op" id="3406377">[</span><span class="op" id="3406378">]</span><span class="op" id="3406379">*</span><span class="ident" id="3406380">NS</span><span class="op" id="3406382">,</span>&nbsp;<span class="builtinfunc" id="3406384">len</span><span class="op" id="3406387">(</span><span class="ident" id="3406388">records</span><span class="op" id="3406395">)</span><span class="op" id="3406396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406399">for</span>&nbsp;<span class="ident" id="3406403">i</span><span class="op" id="3406404">,</span>&nbsp;<span class="ident" id="3406406">r</span>&nbsp;<span class="op" id="3406408">:=</span>&nbsp;<span class="keyword" id="3406411">range</span>&nbsp;<span class="ident" id="3406417">records</span>&nbsp;<span class="op" id="3406425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406429">r</span>&nbsp;<span class="op" id="3406431">:=</span>&nbsp;<span class="ident" id="3406434">r</span><span class="op" id="3406435">.</span><span class="op" id="3406436">(</span><span class="op" id="3406437">*</span><span class="ident" id="3406438">dnsRR_NS</span><span class="op" id="3406446">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406450">ns</span><span class="op" id="3406452">[</span><span class="ident" id="3406453">i</span><span class="op" id="3406454">]</span>&nbsp;<span class="op" id="3406456">=</span>&nbsp;<span class="op" id="3406458">&amp;</span><span class="ident" id="3406459">NS</span><span class="op" id="3406461">{</span><span class="ident" id="3406462">r</span><span class="op" id="3406463">.</span><span class="ident" id="3406464">Ns</span><span class="op" id="3406466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406472">return</span><br>
<span class="lineno"></span><span class="op" id="3406479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3406482">func</span>&nbsp;<span class="ident" id="3406487">lookupTXT</span><span class="op" id="3406496">(</span><span class="ident" id="3406497">name</span>&nbsp;<span class="builtintype" id="3406502">string</span><span class="op" id="3406508">)</span>&nbsp;<span class="op" id="3406510">(</span><span class="ident" id="3406511">txt</span>&nbsp;<span class="op" id="3406515">[</span><span class="op" id="3406516">]</span><span class="builtintype" id="3406517">string</span><span class="op" id="3406523">,</span>&nbsp;<span class="ident" id="3406525">err</span>&nbsp;<span class="builtintype" id="3406529">error</span><span class="op" id="3406534">)</span>&nbsp;<span class="op" id="3406536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406539">_</span><span class="op" id="3406540">,</span>&nbsp;<span class="ident" id="3406542">records</span><span class="op" id="3406549">,</span>&nbsp;<span class="ident" id="3406551">err</span>&nbsp;<span class="op" id="3406555">:=</span>&nbsp;<span class="ident" id="3406558">lookup</span><span class="op" id="3406564">(</span><span class="ident" id="3406565">name</span><span class="op" id="3406569">,</span>&nbsp;<span class="ident" id="3406571">dnsTypeTXT</span><span class="op" id="3406581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406584">if</span>&nbsp;<span class="ident" id="3406587">err</span>&nbsp;<span class="op" id="3406591">!=</span>&nbsp;<span class="ident" id="3406594">nil</span>&nbsp;<span class="op" id="3406598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406602">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406610">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406613">txt</span>&nbsp;<span class="op" id="3406617">=</span>&nbsp;<span class="builtinfunc" id="3406619">make</span><span class="op" id="3406623">(</span><span class="op" id="3406624">[</span><span class="op" id="3406625">]</span><span class="builtintype" id="3406626">string</span><span class="op" id="3406632">,</span>&nbsp;<span class="builtinfunc" id="3406634">len</span><span class="op" id="3406637">(</span><span class="ident" id="3406638">records</span><span class="op" id="3406645">)</span><span class="op" id="3406646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406649">for</span>&nbsp;<span class="ident" id="3406653">i</span><span class="op" id="3406654">,</span>&nbsp;<span class="ident" id="3406656">r</span>&nbsp;<span class="op" id="3406658">:=</span>&nbsp;<span class="keyword" id="3406661">range</span>&nbsp;<span class="ident" id="3406667">records</span>&nbsp;<span class="op" id="3406675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406679">txt</span><span class="op" id="3406682">[</span><span class="ident" id="3406683">i</span><span class="op" id="3406684">]</span>&nbsp;<span class="op" id="3406686">=</span>&nbsp;<span class="ident" id="3406688">r</span><span class="op" id="3406689">.</span><span class="op" id="3406690">(</span><span class="op" id="3406691">*</span><span class="ident" id="3406692">dnsRR_TXT</span><span class="op" id="3406701">)</span><span class="op" id="3406702">.</span><span class="ident" id="3406703">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406711">return</span><br>
<span class="lineno">145</span><span class="op" id="3406718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3406721">func</span>&nbsp;<span class="ident" id="3406726">lookupAddr</span><span class="op" id="3406736">(</span><span class="ident" id="3406737">addr</span>&nbsp;<span class="builtintype" id="3406742">string</span><span class="op" id="3406748">)</span>&nbsp;<span class="op" id="3406750">(</span><span class="ident" id="3406751">name</span>&nbsp;<span class="op" id="3406756">[</span><span class="op" id="3406757">]</span><span class="builtintype" id="3406758">string</span><span class="op" id="3406764">,</span>&nbsp;<span class="ident" id="3406766">err</span>&nbsp;<span class="builtintype" id="3406770">error</span><span class="op" id="3406775">)</span>&nbsp;<span class="op" id="3406777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406780">name</span>&nbsp;<span class="op" id="3406785">=</span>&nbsp;<span class="ident" id="3406787">lookupStaticAddr</span><span class="op" id="3406803">(</span><span class="ident" id="3406804">addr</span><span class="op" id="3406808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406811">if</span>&nbsp;<span class="builtinfunc" id="3406814">len</span><span class="op" id="3406817">(</span><span class="ident" id="3406818">name</span><span class="op" id="3406822">)</span>&nbsp;<span class="op" id="3406824">&gt;</span>&nbsp;<span class="num" id="3406826">0</span>&nbsp;<span class="op" id="3406828">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406843">var</span>&nbsp;<span class="ident" id="3406847">arpa</span>&nbsp;<span class="builtintype" id="3406852">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406860">arpa</span><span class="op" id="3406864">,</span>&nbsp;<span class="ident" id="3406866">err</span>&nbsp;<span class="op" id="3406870">=</span>&nbsp;<span class="ident" id="3406872">reverseaddr</span><span class="op" id="3406883">(</span><span class="ident" id="3406884">addr</span><span class="op" id="3406888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406891">if</span>&nbsp;<span class="ident" id="3406894">err</span>&nbsp;<span class="op" id="3406898">!=</span>&nbsp;<span class="ident" id="3406901">nil</span>&nbsp;<span class="op" id="3406905">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406909">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3406917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406920">var</span>&nbsp;<span class="ident" id="3406924">records</span>&nbsp;<span class="op" id="3406932">[</span><span class="op" id="3406933">]</span><span class="ident" id="3406934">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3406941">_</span><span class="op" id="3406942">,</span>&nbsp;<span class="ident" id="3406944">records</span><span class="op" id="3406951">,</span>&nbsp;<span class="ident" id="3406953">err</span>&nbsp;<span class="op" id="3406957">=</span>&nbsp;<span class="ident" id="3406959">lookup</span><span class="op" id="3406965">(</span><span class="ident" id="3406966">arpa</span><span class="op" id="3406970">,</span>&nbsp;<span class="ident" id="3406972">dnsTypePTR</span><span class="op" id="3406982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3406985">if</span>&nbsp;<span class="ident" id="3406988">err</span>&nbsp;<span class="op" id="3406992">!=</span>&nbsp;<span class="ident" id="3406995">nil</span>&nbsp;<span class="op" id="3406999">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407003">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407014">name</span>&nbsp;<span class="op" id="3407019">=</span>&nbsp;<span class="builtinfunc" id="3407021">make</span><span class="op" id="3407025">(</span><span class="op" id="3407026">[</span><span class="op" id="3407027">]</span><span class="builtintype" id="3407028">string</span><span class="op" id="3407034">,</span>&nbsp;<span class="builtinfunc" id="3407036">len</span><span class="op" id="3407039">(</span><span class="ident" id="3407040">records</span><span class="op" id="3407047">)</span><span class="op" id="3407048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407051">for</span>&nbsp;<span class="ident" id="3407055">i</span>&nbsp;<span class="op" id="3407057">:=</span>&nbsp;<span class="keyword" id="3407060">range</span>&nbsp;<span class="ident" id="3407066">records</span>&nbsp;<span class="op" id="3407074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407078">r</span>&nbsp;<span class="op" id="3407080">:=</span>&nbsp;<span class="ident" id="3407083">records</span><span class="op" id="3407090">[</span><span class="ident" id="3407091">i</span><span class="op" id="3407092">]</span><span class="op" id="3407093">.</span><span class="op" id="3407094">(</span><span class="op" id="3407095">*</span><span class="ident" id="3407096">dnsRR_PTR</span><span class="op" id="3407105">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407109">name</span><span class="op" id="3407113">[</span><span class="ident" id="3407114">i</span><span class="op" id="3407115">]</span>&nbsp;<span class="op" id="3407117">=</span>&nbsp;<span class="ident" id="3407119">r</span><span class="op" id="3407120">.</span><span class="ident" id="3407121">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3407126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3407129">return</span><br>
<span class="lineno"></span><span class="op" id="3407136">}</span>
</div>
</body>
</html>
