<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3886088">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3886144">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3886198">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3886249">package</span>&nbsp;<span class="ident" id="3886257">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3886263">import</span>&nbsp;<span class="op" id="3886270">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3886273">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3886282">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3886300">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3886303">//&nbsp;The&nbsp;algorithm&nbsp;uses&nbsp;at&nbsp;most&nbsp;sniffLen&nbsp;bytes&nbsp;to&nbsp;make&nbsp;its&nbsp;decision.</span><br>
<span class="lineno"></span><span class="keyword" id="3886370">const</span>&nbsp;<span class="ident" id="3886376">sniffLen</span>&nbsp;<span class="op" id="3886385">=</span>&nbsp;<span class="num" id="3886387">512</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3886392">//&nbsp;DetectContentType&nbsp;implements&nbsp;the&nbsp;algorithm&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="3886448">//&nbsp;at&nbsp;http://mimesniff.spec.whatwg.org/&nbsp;to&nbsp;determine&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3886505">//&nbsp;Content-Type&nbsp;of&nbsp;the&nbsp;given&nbsp;data.&nbsp;&nbsp;It&nbsp;considers&nbsp;at&nbsp;most&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3886566">//&nbsp;first&nbsp;512&nbsp;bytes&nbsp;of&nbsp;data.&nbsp;&nbsp;DetectContentType&nbsp;always&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3886628">//&nbsp;a&nbsp;valid&nbsp;MIME&nbsp;type:&nbsp;if&nbsp;it&nbsp;cannot&nbsp;determine&nbsp;a&nbsp;more&nbsp;specific&nbsp;one,&nbsp;it</span><br>
<span class="lineno">20</span><span class="comment" id="3886697">//&nbsp;returns&nbsp;&#34;application/octet-stream&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3886736">func</span>&nbsp;<span class="ident" id="3886741">DetectContentType</span><span class="op" id="3886758">(</span><span class="ident" id="3886759">data</span>&nbsp;<span class="op" id="3886764">[</span><span class="op" id="3886765">]</span><span class="builtintype" id="3886766">byte</span><span class="op" id="3886770">)</span>&nbsp;<span class="builtintype" id="3886772">string</span>&nbsp;<span class="op" id="3886779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886782">if</span>&nbsp;<span class="builtinfunc" id="3886785">len</span><span class="op" id="3886788">(</span><span class="ident" id="3886789"><a href="/net/http/sniff.go.html#3886759">data</a></span><span class="op" id="3886793">)</span>&nbsp;<span class="op" id="3886795">&gt;</span>&nbsp;<span class="ident" id="3886797"><a href="/net/http/sniff.go.html#3886376">sniffLen</a></span>&nbsp;<span class="op" id="3886806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886810"><a href="/net/http/sniff.go.html#3886759">data</a></span>&nbsp;<span class="op" id="3886815">=</span>&nbsp;<span class="ident" id="3886817"><a href="/net/http/sniff.go.html#3886759">data</a></span><span class="op" id="3886821">[</span><span class="op" id="3886822">:</span><span class="ident" id="3886823"><a href="/net/http/sniff.go.html#3886376">sniffLen</a></span><span class="op" id="3886831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886834">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3886838">//&nbsp;Index&nbsp;of&nbsp;the&nbsp;first&nbsp;non-whitespace&nbsp;byte&nbsp;in&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3886890">firstNonWS</span>&nbsp;<span class="op" id="3886901">:=</span>&nbsp;<span class="num" id="3886904">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886907">for</span>&nbsp;<span class="op" id="3886911">;</span>&nbsp;<span class="ident" id="3886913"><a href="/net/http/sniff.go.html#3886890">firstNonWS</a></span>&nbsp;<span class="op" id="3886924">&lt;</span>&nbsp;<span class="builtinfunc" id="3886926">len</span><span class="op" id="3886929">(</span><span class="ident" id="3886930"><a href="/net/http/sniff.go.html#3886759">data</a></span><span class="op" id="3886934">)</span>&nbsp;<span class="op" id="3886936">&amp;&amp;</span>&nbsp;<span class="ident" id="3886939"><a href="/net/http/sniff.go.html#3887148">isWS</a></span><span class="op" id="3886943">(</span><span class="ident" id="3886944"><a href="/net/http/sniff.go.html#3886759">data</a></span><span class="op" id="3886948">[</span><span class="ident" id="3886949"><a href="/net/http/sniff.go.html#3886890">firstNonWS</a></span><span class="op" id="3886959">]</span><span class="op" id="3886960">)</span><span class="op" id="3886961">;</span>&nbsp;<span class="ident" id="3886963"><a href="/net/http/sniff.go.html#3886890">firstNonWS</a></span><span class="op" id="3886973">++</span>&nbsp;<span class="op" id="3886976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3886979">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3886983">for</span>&nbsp;<span class="ident" id="3886987">_</span><span class="op" id="3886988">,</span>&nbsp;<span class="ident" id="3886990">sig</span>&nbsp;<span class="op" id="3886994">:=</span>&nbsp;<span class="keyword" id="3886997">range</span>&nbsp;<span class="ident" id="3887003"><a href="/net/http/sniff.go.html#3887407">sniffSignatures</a></span>&nbsp;<span class="op" id="3887019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887023">if</span>&nbsp;<span class="ident" id="3887026">ct</span>&nbsp;<span class="op" id="3887029">:=</span>&nbsp;<span class="ident" id="3887032"><a href="/net/http/sniff.go.html#3886990">sig</a></span><span class="op" id="3887035">.</span><span class="ident" id="3887036">match</span><span class="op" id="3887041">(</span><span class="ident" id="3887042"><a href="/net/http/sniff.go.html#3886759">data</a></span><span class="op" id="3887046">,</span>&nbsp;<span class="ident" id="3887048"><a href="/net/http/sniff.go.html#3886890">firstNonWS</a></span><span class="op" id="3887058">)</span><span class="op" id="3887059">;</span>&nbsp;<span class="ident" id="3887061"><a href="/net/http/sniff.go.html#3887026">ct</a></span>&nbsp;<span class="op" id="3887064">!=</span>&nbsp;<span class="string" id="3887067">&#34;&#34;</span>&nbsp;<span class="op" id="3887070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887075">return</span>&nbsp;<span class="ident" id="3887082"><a href="/net/http/sniff.go.html#3887026">ct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887087">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887094">return</span>&nbsp;<span class="string" id="3887101">&#34;application/octet-stream&#34;</span>&nbsp;<span class="comment" id="3887128">//&nbsp;fallback</span><br>
<span class="lineno"></span><span class="op" id="3887140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3887143">func</span>&nbsp;<span class="ident" id="3887148">isWS</span><span class="op" id="3887152">(</span><span class="ident" id="3887153">b</span>&nbsp;<span class="builtintype" id="3887155">byte</span><span class="op" id="3887159">)</span>&nbsp;<span class="builtintype" id="3887161">bool</span>&nbsp;<span class="op" id="3887166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3887169">return</span>&nbsp;<span class="ident" id="3887176"><a href="/net/http/sniff.go.html#3886273">bytes</a></span><span class="op" id="3887181">.</span><span class="ident" id="3887182">IndexByte</span><span class="op" id="3887191">(</span><span class="op" id="3887192">[</span><span class="op" id="3887193">]</span><span class="builtintype" id="3887194">byte</span><span class="op" id="3887198">(</span><span class="string" id="3887199">&#34;\t\n\x0C\r&nbsp;&#34;</span><span class="op" id="3887212">)</span><span class="op" id="3887213">,</span>&nbsp;<span class="ident" id="3887215"><a href="/net/http/sniff.go.html#3887153">b</a></span><span class="op" id="3887216">)</span>&nbsp;<span class="op" id="3887218">!=</span>&nbsp;<span class="op" id="3887221">-</span><span class="num" id="3887222">1</span><br>
<span class="lineno"></span><span class="op" id="3887224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3887227">type</span>&nbsp;<span class="ident" id="3887232">sniffSig</span>&nbsp;<span class="keyword" id="3887241">interface</span>&nbsp;<span class="op" id="3887251">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3887254">//&nbsp;match&nbsp;returns&nbsp;the&nbsp;MIME&nbsp;type&nbsp;of&nbsp;the&nbsp;data,&nbsp;or&nbsp;&#34;&#34;&nbsp;if&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887317">match</span><span class="op" id="3887322">(</span><span class="ident" id="3887323">data</span>&nbsp;<span class="op" id="3887328">[</span><span class="op" id="3887329">]</span><span class="builtintype" id="3887330">byte</span><span class="op" id="3887334">,</span>&nbsp;<span class="ident" id="3887336">firstNonWS</span>&nbsp;<span class="builtintype" id="3887347">int</span><span class="op" id="3887350">)</span>&nbsp;<span class="builtintype" id="3887352">string</span><br>
<span class="lineno"></span><span class="op" id="3887359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3887362">//&nbsp;Data&nbsp;matching&nbsp;the&nbsp;table&nbsp;in&nbsp;section&nbsp;6.</span><br>
<span class="lineno">50</span><span class="keyword" id="3887403">var</span>&nbsp;<span class="ident" id="3887407">sniffSignatures</span>&nbsp;<span class="op" id="3887423">=</span>&nbsp;<span class="op" id="3887425">[</span><span class="op" id="3887426">]</span><span class="ident" id="3887427"><a href="/net/http/sniff.go.html#3887232">sniffSig</a></span><span class="op" id="3887435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887438"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887445">(</span><span class="string" id="3887446">&#34;&lt;!DOCTYPE&nbsp;HTML&#34;</span><span class="op" id="3887462">)</span><span class="op" id="3887463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887466"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887473">(</span><span class="string" id="3887474">&#34;&lt;HTML&#34;</span><span class="op" id="3887481">)</span><span class="op" id="3887482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887485"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887492">(</span><span class="string" id="3887493">&#34;&lt;HEAD&#34;</span><span class="op" id="3887500">)</span><span class="op" id="3887501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887504"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887511">(</span><span class="string" id="3887512">&#34;&lt;SCRIPT&#34;</span><span class="op" id="3887521">)</span><span class="op" id="3887522">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887525"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887532">(</span><span class="string" id="3887533">&#34;&lt;IFRAME&#34;</span><span class="op" id="3887542">)</span><span class="op" id="3887543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887546"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887553">(</span><span class="string" id="3887554">&#34;&lt;H1&#34;</span><span class="op" id="3887559">)</span><span class="op" id="3887560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887563"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887570">(</span><span class="string" id="3887571">&#34;&lt;DIV&#34;</span><span class="op" id="3887577">)</span><span class="op" id="3887578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887581"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887588">(</span><span class="string" id="3887589">&#34;&lt;FONT&#34;</span><span class="op" id="3887596">)</span><span class="op" id="3887597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887600"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887607">(</span><span class="string" id="3887608">&#34;&lt;TABLE&#34;</span><span class="op" id="3887616">)</span><span class="op" id="3887617">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887620"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887627">(</span><span class="string" id="3887628">&#34;&lt;A&#34;</span><span class="op" id="3887632">)</span><span class="op" id="3887633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887636"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887643">(</span><span class="string" id="3887644">&#34;&lt;STYLE&#34;</span><span class="op" id="3887652">)</span><span class="op" id="3887653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887656"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887663">(</span><span class="string" id="3887664">&#34;&lt;TITLE&#34;</span><span class="op" id="3887672">)</span><span class="op" id="3887673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887676"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887683">(</span><span class="string" id="3887684">&#34;&lt;B&#34;</span><span class="op" id="3887688">)</span><span class="op" id="3887689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887692"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887699">(</span><span class="string" id="3887700">&#34;&lt;BODY&#34;</span><span class="op" id="3887707">)</span><span class="op" id="3887708">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887711"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887718">(</span><span class="string" id="3887719">&#34;&lt;BR&#34;</span><span class="op" id="3887724">)</span><span class="op" id="3887725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887728"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887735">(</span><span class="string" id="3887736">&#34;&lt;P&#34;</span><span class="op" id="3887740">)</span><span class="op" id="3887741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3887744"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3887751">(</span><span class="string" id="3887752">&#34;&lt;!--&#34;</span><span class="op" id="3887758">)</span><span class="op" id="3887759">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887763">&amp;</span><span class="ident" id="3887764"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3887773">{</span><span class="ident" id="3887774">mask</span><span class="op" id="3887778">:</span>&nbsp;<span class="op" id="3887780">[</span><span class="op" id="3887781">]</span><span class="builtintype" id="3887782">byte</span><span class="op" id="3887786">(</span><span class="string" id="3887787">&#34;\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3887809">)</span><span class="op" id="3887810">,</span>&nbsp;<span class="ident" id="3887812">pat</span><span class="op" id="3887815">:</span>&nbsp;<span class="op" id="3887817">[</span><span class="op" id="3887818">]</span><span class="builtintype" id="3887819">byte</span><span class="op" id="3887823">(</span><span class="string" id="3887824">&#34;&lt;?xml&#34;</span><span class="op" id="3887831">)</span><span class="op" id="3887832">,</span>&nbsp;<span class="ident" id="3887834">skipWS</span><span class="op" id="3887840">:</span>&nbsp;<span class="ident" id="3887842">true</span><span class="op" id="3887846">,</span>&nbsp;<span class="ident" id="3887848">ct</span><span class="op" id="3887850">:</span>&nbsp;<span class="string" id="3887852">&#34;text/xml;&nbsp;charset=utf-8&#34;</span><span class="op" id="3887877">}</span><span class="op" id="3887878">,</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887882">&amp;</span><span class="ident" id="3887883"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3887891">{</span><span class="op" id="3887892">[</span><span class="op" id="3887893">]</span><span class="builtintype" id="3887894">byte</span><span class="op" id="3887898">(</span><span class="string" id="3887899">&#34;%PDF-&#34;</span><span class="op" id="3887906">)</span><span class="op" id="3887907">,</span>&nbsp;<span class="string" id="3887909">&#34;application/pdf&#34;</span><span class="op" id="3887926">}</span><span class="op" id="3887927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3887930">&amp;</span><span class="ident" id="3887931"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3887939">{</span><span class="op" id="3887940">[</span><span class="op" id="3887941">]</span><span class="builtintype" id="3887942">byte</span><span class="op" id="3887946">(</span><span class="string" id="3887947">&#34;%!PS-Adobe-&#34;</span><span class="op" id="3887960">)</span><span class="op" id="3887961">,</span>&nbsp;<span class="string" id="3887963">&#34;application/postscript&#34;</span><span class="op" id="3887987">}</span><span class="op" id="3887988">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3887992">//&nbsp;UTF&nbsp;BOMs.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888006">&amp;</span><span class="ident" id="3888007"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3888016">{</span><span class="ident" id="3888017">mask</span><span class="op" id="3888021">:</span>&nbsp;<span class="op" id="3888023">[</span><span class="op" id="3888024">]</span><span class="builtintype" id="3888025">byte</span><span class="op" id="3888029">(</span><span class="string" id="3888030">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="3888048">)</span><span class="op" id="3888049">,</span>&nbsp;<span class="ident" id="3888051">pat</span><span class="op" id="3888054">:</span>&nbsp;<span class="op" id="3888056">[</span><span class="op" id="3888057">]</span><span class="builtintype" id="3888058">byte</span><span class="op" id="3888062">(</span><span class="string" id="3888063">&#34;\xFE\xFF\x00\x00&#34;</span><span class="op" id="3888081">)</span><span class="op" id="3888082">,</span>&nbsp;<span class="ident" id="3888084">ct</span><span class="op" id="3888086">:</span>&nbsp;<span class="string" id="3888088">&#34;text/plain;&nbsp;charset=utf-16be&#34;</span><span class="op" id="3888118">}</span><span class="op" id="3888119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888122">&amp;</span><span class="ident" id="3888123"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3888132">{</span><span class="ident" id="3888133">mask</span><span class="op" id="3888137">:</span>&nbsp;<span class="op" id="3888139">[</span><span class="op" id="3888140">]</span><span class="builtintype" id="3888141">byte</span><span class="op" id="3888145">(</span><span class="string" id="3888146">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="3888164">)</span><span class="op" id="3888165">,</span>&nbsp;<span class="ident" id="3888167">pat</span><span class="op" id="3888170">:</span>&nbsp;<span class="op" id="3888172">[</span><span class="op" id="3888173">]</span><span class="builtintype" id="3888174">byte</span><span class="op" id="3888178">(</span><span class="string" id="3888179">&#34;\xFF\xFE\x00\x00&#34;</span><span class="op" id="3888197">)</span><span class="op" id="3888198">,</span>&nbsp;<span class="ident" id="3888200">ct</span><span class="op" id="3888202">:</span>&nbsp;<span class="string" id="3888204">&#34;text/plain;&nbsp;charset=utf-16le&#34;</span><span class="op" id="3888234">}</span><span class="op" id="3888235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888238">&amp;</span><span class="ident" id="3888239"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3888248">{</span><span class="ident" id="3888249">mask</span><span class="op" id="3888253">:</span>&nbsp;<span class="op" id="3888255">[</span><span class="op" id="3888256">]</span><span class="builtintype" id="3888257">byte</span><span class="op" id="3888261">(</span><span class="string" id="3888262">&#34;\xFF\xFF\xFF\x00&#34;</span><span class="op" id="3888280">)</span><span class="op" id="3888281">,</span>&nbsp;<span class="ident" id="3888283">pat</span><span class="op" id="3888286">:</span>&nbsp;<span class="op" id="3888288">[</span><span class="op" id="3888289">]</span><span class="builtintype" id="3888290">byte</span><span class="op" id="3888294">(</span><span class="string" id="3888295">&#34;\xEF\xBB\xBF\x00&#34;</span><span class="op" id="3888313">)</span><span class="op" id="3888314">,</span>&nbsp;<span class="ident" id="3888316">ct</span><span class="op" id="3888318">:</span>&nbsp;<span class="string" id="3888320">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="3888347">}</span><span class="op" id="3888348">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888352">&amp;</span><span class="ident" id="3888353"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888361">{</span><span class="op" id="3888362">[</span><span class="op" id="3888363">]</span><span class="builtintype" id="3888364">byte</span><span class="op" id="3888368">(</span><span class="string" id="3888369">&#34;GIF87a&#34;</span><span class="op" id="3888377">)</span><span class="op" id="3888378">,</span>&nbsp;<span class="string" id="3888380">&#34;image/gif&#34;</span><span class="op" id="3888391">}</span><span class="op" id="3888392">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888395">&amp;</span><span class="ident" id="3888396"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888404">{</span><span class="op" id="3888405">[</span><span class="op" id="3888406">]</span><span class="builtintype" id="3888407">byte</span><span class="op" id="3888411">(</span><span class="string" id="3888412">&#34;GIF89a&#34;</span><span class="op" id="3888420">)</span><span class="op" id="3888421">,</span>&nbsp;<span class="string" id="3888423">&#34;image/gif&#34;</span><span class="op" id="3888434">}</span><span class="op" id="3888435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888438">&amp;</span><span class="ident" id="3888439"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888447">{</span><span class="op" id="3888448">[</span><span class="op" id="3888449">]</span><span class="builtintype" id="3888450">byte</span><span class="op" id="3888454">(</span><span class="string" id="3888455">&#34;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A&#34;</span><span class="op" id="3888489">)</span><span class="op" id="3888490">,</span>&nbsp;<span class="string" id="3888492">&#34;image/png&#34;</span><span class="op" id="3888503">}</span><span class="op" id="3888504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888507">&amp;</span><span class="ident" id="3888508"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888516">{</span><span class="op" id="3888517">[</span><span class="op" id="3888518">]</span><span class="builtintype" id="3888519">byte</span><span class="op" id="3888523">(</span><span class="string" id="3888524">&#34;\xFF\xD8\xFF&#34;</span><span class="op" id="3888538">)</span><span class="op" id="3888539">,</span>&nbsp;<span class="string" id="3888541">&#34;image/jpeg&#34;</span><span class="op" id="3888553">}</span><span class="op" id="3888554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888557">&amp;</span><span class="ident" id="3888558"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888566">{</span><span class="op" id="3888567">[</span><span class="op" id="3888568">]</span><span class="builtintype" id="3888569">byte</span><span class="op" id="3888573">(</span><span class="string" id="3888574">&#34;BM&#34;</span><span class="op" id="3888578">)</span><span class="op" id="3888579">,</span>&nbsp;<span class="string" id="3888581">&#34;image/bmp&#34;</span><span class="op" id="3888592">}</span><span class="op" id="3888593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888596">&amp;</span><span class="ident" id="3888597"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3888606">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888610">mask</span><span class="op" id="3888614">:</span>&nbsp;<span class="op" id="3888616">[</span><span class="op" id="3888617">]</span><span class="builtintype" id="3888618">byte</span><span class="op" id="3888622">(</span><span class="string" id="3888623">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3888681">)</span><span class="op" id="3888682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888686">pat</span><span class="op" id="3888689">:</span>&nbsp;&nbsp;<span class="op" id="3888692">[</span><span class="op" id="3888693">]</span><span class="builtintype" id="3888694">byte</span><span class="op" id="3888698">(</span><span class="string" id="3888699">&#34;RIFF\x00\x00\x00\x00WEBPVP&#34;</span><span class="op" id="3888727">)</span><span class="op" id="3888728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888732">ct</span><span class="op" id="3888734">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3888738">&#34;image/webp&#34;</span><span class="op" id="3888750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888753">}</span><span class="op" id="3888754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888757">&amp;</span><span class="ident" id="3888758"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888766">{</span><span class="op" id="3888767">[</span><span class="op" id="3888768">]</span><span class="builtintype" id="3888769">byte</span><span class="op" id="3888773">(</span><span class="string" id="3888774">&#34;\x00\x00\x01\x00&#34;</span><span class="op" id="3888792">)</span><span class="op" id="3888793">,</span>&nbsp;<span class="string" id="3888795">&#34;image/vnd.microsoft.icon&#34;</span><span class="op" id="3888821">}</span><span class="op" id="3888822">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888825">&amp;</span><span class="ident" id="3888826"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3888834">{</span><span class="op" id="3888835">[</span><span class="op" id="3888836">]</span><span class="builtintype" id="3888837">byte</span><span class="op" id="3888841">(</span><span class="string" id="3888842">&#34;\x4F\x67\x67\x53\x00&#34;</span><span class="op" id="3888864">)</span><span class="op" id="3888865">,</span>&nbsp;<span class="string" id="3888867">&#34;application/ogg&#34;</span><span class="op" id="3888884">}</span><span class="op" id="3888885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888888">&amp;</span><span class="ident" id="3888889"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3888898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888902">mask</span><span class="op" id="3888906">:</span>&nbsp;<span class="op" id="3888908">[</span><span class="op" id="3888909">]</span><span class="builtintype" id="3888910">byte</span><span class="op" id="3888914">(</span><span class="string" id="3888915">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3888965">)</span><span class="op" id="3888966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888970">pat</span><span class="op" id="3888973">:</span>&nbsp;&nbsp;<span class="op" id="3888976">[</span><span class="op" id="3888977">]</span><span class="builtintype" id="3888978">byte</span><span class="op" id="3888982">(</span><span class="string" id="3888983">&#34;RIFF\x00\x00\x00\x00WAVE&#34;</span><span class="op" id="3889009">)</span><span class="op" id="3889010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889014">ct</span><span class="op" id="3889016">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3889020">&#34;audio/wave&#34;</span><span class="op" id="3889032">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889035">}</span><span class="op" id="3889036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889039">&amp;</span><span class="ident" id="3889040"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3889048">{</span><span class="op" id="3889049">[</span><span class="op" id="3889050">]</span><span class="builtintype" id="3889051">byte</span><span class="op" id="3889055">(</span><span class="string" id="3889056">&#34;\x1A\x45\xDF\xA3&#34;</span><span class="op" id="3889074">)</span><span class="op" id="3889075">,</span>&nbsp;<span class="string" id="3889077">&#34;video/webm&#34;</span><span class="op" id="3889089">}</span><span class="op" id="3889090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889093">&amp;</span><span class="ident" id="3889094"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3889102">{</span><span class="op" id="3889103">[</span><span class="op" id="3889104">]</span><span class="builtintype" id="3889105">byte</span><span class="op" id="3889109">(</span><span class="string" id="3889110">&#34;\x52\x61\x72\x20\x1A\x07\x00&#34;</span><span class="op" id="3889140">)</span><span class="op" id="3889141">,</span>&nbsp;<span class="string" id="3889143">&#34;application/x-rar-compressed&#34;</span><span class="op" id="3889173">}</span><span class="op" id="3889174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889177">&amp;</span><span class="ident" id="3889178"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3889186">{</span><span class="op" id="3889187">[</span><span class="op" id="3889188">]</span><span class="builtintype" id="3889189">byte</span><span class="op" id="3889193">(</span><span class="string" id="3889194">&#34;\x50\x4B\x03\x04&#34;</span><span class="op" id="3889212">)</span><span class="op" id="3889213">,</span>&nbsp;<span class="string" id="3889215">&#34;application/zip&#34;</span><span class="op" id="3889232">}</span><span class="op" id="3889233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889236">&amp;</span><span class="ident" id="3889237"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3889245">{</span><span class="op" id="3889246">[</span><span class="op" id="3889247">]</span><span class="builtintype" id="3889248">byte</span><span class="op" id="3889252">(</span><span class="string" id="3889253">&#34;\x1F\x8B\x08&#34;</span><span class="op" id="3889267">)</span><span class="op" id="3889268">,</span>&nbsp;<span class="string" id="3889270">&#34;application/x-gzip&#34;</span><span class="op" id="3889290">}</span><span class="op" id="3889291">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3889295">//&nbsp;TODO(dsymonds):&nbsp;Re-enable&nbsp;this&nbsp;when&nbsp;the&nbsp;spec&nbsp;is&nbsp;sorted&nbsp;w.r.t.&nbsp;MP4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3889366">//mp4Sig(0),</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889381"><a href="/net/http/sniff.go.html#3891075">textSig</a></span><span class="op" id="3889388">(</span><span class="num" id="3889389">0</span><span class="op" id="3889390">)</span><span class="op" id="3889391">,</span>&nbsp;<span class="comment" id="3889393">//&nbsp;should&nbsp;be&nbsp;last</span><br>
<span class="lineno">105</span><span class="op" id="3889411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889414">type</span>&nbsp;<span class="ident" id="3889419">exactSig</span>&nbsp;<span class="keyword" id="3889428">struct</span>&nbsp;<span class="op" id="3889435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889438">sig</span>&nbsp;<span class="op" id="3889442">[</span><span class="op" id="3889443">]</span><span class="builtintype" id="3889444">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889450">ct</span>&nbsp;&nbsp;<span class="builtintype" id="3889454">string</span><br>
<span class="lineno">110</span><span class="op" id="3889461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889464">func</span>&nbsp;<span class="op" id="3889469">(</span><span class="ident" id="3889470">e</span>&nbsp;<span class="op" id="3889472">*</span><span class="ident" id="3889473"><a href="/net/http/sniff.go.html#3889419">exactSig</a></span><span class="op" id="3889481">)</span>&nbsp;<span class="ident" id="3889483">match</span><span class="op" id="3889488">(</span><span class="ident" id="3889489">data</span>&nbsp;<span class="op" id="3889494">[</span><span class="op" id="3889495">]</span><span class="builtintype" id="3889496">byte</span><span class="op" id="3889500">,</span>&nbsp;<span class="ident" id="3889502">firstNonWS</span>&nbsp;<span class="builtintype" id="3889513">int</span><span class="op" id="3889516">)</span>&nbsp;<span class="builtintype" id="3889518">string</span>&nbsp;<span class="op" id="3889525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889528">if</span>&nbsp;<span class="ident" id="3889531"><a href="/net/http/sniff.go.html#3886273">bytes</a></span><span class="op" id="3889536">.</span><span class="ident" id="3889537">HasPrefix</span><span class="op" id="3889546">(</span><span class="ident" id="3889547"><a href="/net/http/sniff.go.html#3889489">data</a></span><span class="op" id="3889551">,</span>&nbsp;<span class="ident" id="3889553"><a href="/net/http/sniff.go.html#3889470">e</a></span><span class="op" id="3889554">.</span><span class="ident" id="3889555">sig</span><span class="op" id="3889558">)</span>&nbsp;<span class="op" id="3889560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889564">return</span>&nbsp;<span class="ident" id="3889571"><a href="/net/http/sniff.go.html#3889470">e</a></span><span class="op" id="3889572">.</span><span class="ident" id="3889573">ct</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889580">return</span>&nbsp;<span class="string" id="3889587">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3889590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889593">type</span>&nbsp;<span class="ident" id="3889598">maskedSig</span>&nbsp;<span class="keyword" id="3889608">struct</span>&nbsp;<span class="op" id="3889615">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889618">mask</span><span class="op" id="3889622">,</span>&nbsp;<span class="ident" id="3889624">pat</span>&nbsp;<span class="op" id="3889628">[</span><span class="op" id="3889629">]</span><span class="builtintype" id="3889630">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889636">skipWS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3889646">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889652">ct</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3889662">string</span><br>
<span class="lineno"></span><span class="op" id="3889669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3889672">func</span>&nbsp;<span class="op" id="3889677">(</span><span class="ident" id="3889678">m</span>&nbsp;<span class="op" id="3889680">*</span><span class="ident" id="3889681"><a href="/net/http/sniff.go.html#3889598">maskedSig</a></span><span class="op" id="3889690">)</span>&nbsp;<span class="ident" id="3889692">match</span><span class="op" id="3889697">(</span><span class="ident" id="3889698">data</span>&nbsp;<span class="op" id="3889703">[</span><span class="op" id="3889704">]</span><span class="builtintype" id="3889705">byte</span><span class="op" id="3889709">,</span>&nbsp;<span class="ident" id="3889711">firstNonWS</span>&nbsp;<span class="builtintype" id="3889722">int</span><span class="op" id="3889725">)</span>&nbsp;<span class="builtintype" id="3889727">string</span>&nbsp;<span class="op" id="3889734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889737">if</span>&nbsp;<span class="ident" id="3889740"><a href="/net/http/sniff.go.html#3889678">m</a></span><span class="op" id="3889741">.</span><span class="ident" id="3889742">skipWS</span>&nbsp;<span class="op" id="3889749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889753"><a href="/net/http/sniff.go.html#3889698">data</a></span>&nbsp;<span class="op" id="3889758">=</span>&nbsp;<span class="ident" id="3889760"><a href="/net/http/sniff.go.html#3889698">data</a></span><span class="op" id="3889764">[</span><span class="ident" id="3889765"><a href="/net/http/sniff.go.html#3889711">firstNonWS</a></span><span class="op" id="3889775">:</span><span class="op" id="3889776">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889782">if</span>&nbsp;<span class="builtinfunc" id="3889785">len</span><span class="op" id="3889788">(</span><span class="ident" id="3889789"><a href="/net/http/sniff.go.html#3889698">data</a></span><span class="op" id="3889793">)</span>&nbsp;<span class="op" id="3889795">&lt;</span>&nbsp;<span class="builtinfunc" id="3889797">len</span><span class="op" id="3889800">(</span><span class="ident" id="3889801"><a href="/net/http/sniff.go.html#3889678">m</a></span><span class="op" id="3889802">.</span><span class="ident" id="3889803">mask</span><span class="op" id="3889807">)</span>&nbsp;<span class="op" id="3889809">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889813">return</span>&nbsp;<span class="string" id="3889820">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889827">for</span>&nbsp;<span class="ident" id="3889831">i</span><span class="op" id="3889832">,</span>&nbsp;<span class="ident" id="3889834">mask</span>&nbsp;<span class="op" id="3889839">:=</span>&nbsp;<span class="keyword" id="3889842">range</span>&nbsp;<span class="ident" id="3889848"><a href="/net/http/sniff.go.html#3889678">m</a></span><span class="op" id="3889849">.</span><span class="ident" id="3889850">mask</span>&nbsp;<span class="op" id="3889855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889859">db</span>&nbsp;<span class="op" id="3889862">:=</span>&nbsp;<span class="ident" id="3889865"><a href="/net/http/sniff.go.html#3889698">data</a></span><span class="op" id="3889869">[</span><span class="ident" id="3889870"><a href="/net/http/sniff.go.html#3889831">i</a></span><span class="op" id="3889871">]</span>&nbsp;<span class="op" id="3889873">&amp;</span>&nbsp;<span class="ident" id="3889875"><a href="/net/http/sniff.go.html#3889834">mask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889882">if</span>&nbsp;<span class="ident" id="3889885"><a href="/net/http/sniff.go.html#3889859">db</a></span>&nbsp;<span class="op" id="3889888">!=</span>&nbsp;<span class="ident" id="3889891"><a href="/net/http/sniff.go.html#3889678">m</a></span><span class="op" id="3889892">.</span><span class="ident" id="3889893">pat</span><span class="op" id="3889896">[</span><span class="ident" id="3889897"><a href="/net/http/sniff.go.html#3889831">i</a></span><span class="op" id="3889898">]</span>&nbsp;<span class="op" id="3889900">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889905">return</span>&nbsp;<span class="string" id="3889912">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889923">return</span>&nbsp;<span class="ident" id="3889930"><a href="/net/http/sniff.go.html#3889678">m</a></span><span class="op" id="3889931">.</span><span class="ident" id="3889932">ct</span><br>
<span class="lineno"></span><span class="op" id="3889935">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="3889938">type</span>&nbsp;<span class="ident" id="3889943">htmlSig</span>&nbsp;<span class="op" id="3889951">[</span><span class="op" id="3889952">]</span><span class="builtintype" id="3889953">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889959">func</span>&nbsp;<span class="op" id="3889964">(</span><span class="ident" id="3889965">h</span>&nbsp;<span class="ident" id="3889967"><a href="/net/http/sniff.go.html#3889943">htmlSig</a></span><span class="op" id="3889974">)</span>&nbsp;<span class="ident" id="3889976">match</span><span class="op" id="3889981">(</span><span class="ident" id="3889982">data</span>&nbsp;<span class="op" id="3889987">[</span><span class="op" id="3889988">]</span><span class="builtintype" id="3889989">byte</span><span class="op" id="3889993">,</span>&nbsp;<span class="ident" id="3889995">firstNonWS</span>&nbsp;<span class="builtintype" id="3890006">int</span><span class="op" id="3890009">)</span>&nbsp;<span class="builtintype" id="3890011">string</span>&nbsp;<span class="op" id="3890018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890021"><a href="/net/http/sniff.go.html#3889982">data</a></span>&nbsp;<span class="op" id="3890026">=</span>&nbsp;<span class="ident" id="3890028"><a href="/net/http/sniff.go.html#3889982">data</a></span><span class="op" id="3890032">[</span><span class="ident" id="3890033"><a href="/net/http/sniff.go.html#3889995">firstNonWS</a></span><span class="op" id="3890043">:</span><span class="op" id="3890044">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890047">if</span>&nbsp;<span class="builtinfunc" id="3890050">len</span><span class="op" id="3890053">(</span><span class="ident" id="3890054"><a href="/net/http/sniff.go.html#3889982">data</a></span><span class="op" id="3890058">)</span>&nbsp;<span class="op" id="3890060">&lt;</span>&nbsp;<span class="builtinfunc" id="3890062">len</span><span class="op" id="3890065">(</span><span class="ident" id="3890066"><a href="/net/http/sniff.go.html#3889965">h</a></span><span class="op" id="3890067">)</span><span class="op" id="3890068">+</span><span class="num" id="3890069">1</span>&nbsp;<span class="op" id="3890071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890075">return</span>&nbsp;<span class="string" id="3890082">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890089">for</span>&nbsp;<span class="ident" id="3890093">i</span><span class="op" id="3890094">,</span>&nbsp;<span class="ident" id="3890096">b</span>&nbsp;<span class="op" id="3890098">:=</span>&nbsp;<span class="keyword" id="3890101">range</span>&nbsp;<span class="ident" id="3890107"><a href="/net/http/sniff.go.html#3889965">h</a></span>&nbsp;<span class="op" id="3890109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890113">db</span>&nbsp;<span class="op" id="3890116">:=</span>&nbsp;<span class="ident" id="3890119"><a href="/net/http/sniff.go.html#3889982">data</a></span><span class="op" id="3890123">[</span><span class="ident" id="3890124"><a href="/net/http/sniff.go.html#3890093">i</a></span><span class="op" id="3890125">]</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890129">if</span>&nbsp;<span class="string" id="3890132">&#39;A&#39;</span>&nbsp;<span class="op" id="3890136">&lt;=</span>&nbsp;<span class="ident" id="3890139"><a href="/net/http/sniff.go.html#3890096">b</a></span>&nbsp;<span class="op" id="3890141">&amp;&amp;</span>&nbsp;<span class="ident" id="3890144"><a href="/net/http/sniff.go.html#3890096">b</a></span>&nbsp;<span class="op" id="3890146">&lt;=</span>&nbsp;<span class="string" id="3890149">&#39;Z&#39;</span>&nbsp;<span class="op" id="3890153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890158"><a href="/net/http/sniff.go.html#3890113">db</a></span>&nbsp;<span class="op" id="3890161">&amp;=</span>&nbsp;<span class="num" id="3890164">0xDF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890175">if</span>&nbsp;<span class="ident" id="3890178"><a href="/net/http/sniff.go.html#3890096">b</a></span>&nbsp;<span class="op" id="3890180">!=</span>&nbsp;<span class="ident" id="3890183"><a href="/net/http/sniff.go.html#3890113">db</a></span>&nbsp;<span class="op" id="3890186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890191">return</span>&nbsp;<span class="string" id="3890198">&#34;&#34;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3890209">//&nbsp;Next&nbsp;byte&nbsp;must&nbsp;be&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890261">if</span>&nbsp;<span class="ident" id="3890264">db</span>&nbsp;<span class="op" id="3890267">:=</span>&nbsp;<span class="ident" id="3890270"><a href="/net/http/sniff.go.html#3889982">data</a></span><span class="op" id="3890274">[</span><span class="builtinfunc" id="3890275">len</span><span class="op" id="3890278">(</span><span class="ident" id="3890279"><a href="/net/http/sniff.go.html#3889965">h</a></span><span class="op" id="3890280">)</span><span class="op" id="3890281">]</span><span class="op" id="3890282">;</span>&nbsp;<span class="ident" id="3890284"><a href="/net/http/sniff.go.html#3890264">db</a></span>&nbsp;<span class="op" id="3890287">!=</span>&nbsp;<span class="string" id="3890290">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3890294">&amp;&amp;</span>&nbsp;<span class="ident" id="3890297"><a href="/net/http/sniff.go.html#3890264">db</a></span>&nbsp;<span class="op" id="3890300">!=</span>&nbsp;<span class="string" id="3890303">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3890307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890311">return</span>&nbsp;<span class="string" id="3890318">&#34;&#34;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890325">return</span>&nbsp;<span class="string" id="3890332">&#34;text/html;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3890359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3890362">type</span>&nbsp;<span class="ident" id="3890367">mp4Sig</span>&nbsp;<span class="builtintype" id="3890374">int</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3890379">func</span>&nbsp;<span class="op" id="3890384">(</span><span class="ident" id="3890385"><a href="/net/http/sniff.go.html#3890367">mp4Sig</a></span><span class="op" id="3890391">)</span>&nbsp;<span class="ident" id="3890393">match</span><span class="op" id="3890398">(</span><span class="ident" id="3890399">data</span>&nbsp;<span class="op" id="3890404">[</span><span class="op" id="3890405">]</span><span class="builtintype" id="3890406">byte</span><span class="op" id="3890410">,</span>&nbsp;<span class="ident" id="3890412">firstNonWS</span>&nbsp;<span class="builtintype" id="3890423">int</span><span class="op" id="3890426">)</span>&nbsp;<span class="builtintype" id="3890428">string</span>&nbsp;<span class="op" id="3890435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3890438">//&nbsp;c.f.&nbsp;section&nbsp;6.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890460">if</span>&nbsp;<span class="builtinfunc" id="3890463">len</span><span class="op" id="3890466">(</span><span class="ident" id="3890467"><a href="/net/http/sniff.go.html#3890399">data</a></span><span class="op" id="3890471">)</span>&nbsp;<span class="op" id="3890473">&lt;</span>&nbsp;<span class="num" id="3890475">8</span>&nbsp;<span class="op" id="3890477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890481">return</span>&nbsp;<span class="string" id="3890488">&#34;&#34;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890495">boxSize</span>&nbsp;<span class="op" id="3890503">:=</span>&nbsp;<span class="builtintype" id="3890506">int</span><span class="op" id="3890509">(</span><span class="ident" id="3890510"><a href="/net/http/sniff.go.html#3886282">binary</a></span><span class="op" id="3890516">.</span><span class="ident" id="3890517">BigEndian</span><span class="op" id="3890526">.</span><span class="ident" id="3890527">Uint32</span><span class="op" id="3890533">(</span><span class="ident" id="3890534"><a href="/net/http/sniff.go.html#3890399">data</a></span><span class="op" id="3890538">[</span><span class="op" id="3890539">:</span><span class="num" id="3890540">4</span><span class="op" id="3890541">]</span><span class="op" id="3890542">)</span><span class="op" id="3890543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890546">if</span>&nbsp;<span class="ident" id="3890549"><a href="/net/http/sniff.go.html#3890495">boxSize</a></span><span class="op" id="3890556">%</span><span class="num" id="3890557">4</span>&nbsp;<span class="op" id="3890559">!=</span>&nbsp;<span class="num" id="3890562">0</span>&nbsp;<span class="op" id="3890564">||</span>&nbsp;<span class="builtinfunc" id="3890567">len</span><span class="op" id="3890570">(</span><span class="ident" id="3890571"><a href="/net/http/sniff.go.html#3890399">data</a></span><span class="op" id="3890575">)</span>&nbsp;<span class="op" id="3890577">&lt;</span>&nbsp;<span class="ident" id="3890579"><a href="/net/http/sniff.go.html#3890495">boxSize</a></span>&nbsp;<span class="op" id="3890587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890591">return</span>&nbsp;<span class="string" id="3890598">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890602">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890605">if</span>&nbsp;<span class="op" id="3890608">!</span><span class="ident" id="3890609"><a href="/net/http/sniff.go.html#3886273">bytes</a></span><span class="op" id="3890614">.</span><span class="ident" id="3890615">Equal</span><span class="op" id="3890620">(</span><span class="ident" id="3890621"><a href="/net/http/sniff.go.html#3890399">data</a></span><span class="op" id="3890625">[</span><span class="num" id="3890626">4</span><span class="op" id="3890627">:</span><span class="num" id="3890628">8</span><span class="op" id="3890629">]</span><span class="op" id="3890630">,</span>&nbsp;<span class="op" id="3890632">[</span><span class="op" id="3890633">]</span><span class="builtintype" id="3890634">byte</span><span class="op" id="3890638">(</span><span class="string" id="3890639">&#34;ftyp&#34;</span><span class="op" id="3890645">)</span><span class="op" id="3890646">)</span>&nbsp;<span class="op" id="3890648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890652">return</span>&nbsp;<span class="string" id="3890659">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890666">for</span>&nbsp;<span class="ident" id="3890670">st</span>&nbsp;<span class="op" id="3890673">:=</span>&nbsp;<span class="num" id="3890676">8</span><span class="op" id="3890677">;</span>&nbsp;<span class="ident" id="3890679"><a href="/net/http/sniff.go.html#3890670">st</a></span>&nbsp;<span class="op" id="3890682">&lt;</span>&nbsp;<span class="ident" id="3890684"><a href="/net/http/sniff.go.html#3890495">boxSize</a></span><span class="op" id="3890691">;</span>&nbsp;<span class="ident" id="3890693"><a href="/net/http/sniff.go.html#3890670">st</a></span>&nbsp;<span class="op" id="3890696">+=</span>&nbsp;<span class="num" id="3890699">4</span>&nbsp;<span class="op" id="3890701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890705">if</span>&nbsp;<span class="ident" id="3890708"><a href="/net/http/sniff.go.html#3890670">st</a></span>&nbsp;<span class="op" id="3890711">==</span>&nbsp;<span class="num" id="3890714">12</span>&nbsp;<span class="op" id="3890717">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3890722">//&nbsp;minor&nbsp;version&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890749">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890764">seg</span>&nbsp;<span class="op" id="3890768">:=</span>&nbsp;<span class="builtintype" id="3890771">string</span><span class="op" id="3890777">(</span><span class="ident" id="3890778"><a href="/net/http/sniff.go.html#3890399">data</a></span><span class="op" id="3890782">[</span><span class="ident" id="3890783"><a href="/net/http/sniff.go.html#3890670">st</a></span>&nbsp;<span class="op" id="3890786">:</span>&nbsp;<span class="ident" id="3890788"><a href="/net/http/sniff.go.html#3890670">st</a></span><span class="op" id="3890790">+</span><span class="num" id="3890791">3</span><span class="op" id="3890792">]</span><span class="op" id="3890793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890797">switch</span>&nbsp;<span class="ident" id="3890804"><a href="/net/http/sniff.go.html#3890764">seg</a></span>&nbsp;<span class="op" id="3890808">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890812">case</span>&nbsp;<span class="string" id="3890817">&#34;mp4&#34;</span><span class="op" id="3890822">,</span>&nbsp;<span class="string" id="3890824">&#34;iso&#34;</span><span class="op" id="3890829">,</span>&nbsp;<span class="string" id="3890831">&#34;M4V&#34;</span><span class="op" id="3890836">,</span>&nbsp;<span class="string" id="3890838">&#34;M4P&#34;</span><span class="op" id="3890843">,</span>&nbsp;<span class="string" id="3890845">&#34;M4B&#34;</span><span class="op" id="3890850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890855">return</span>&nbsp;<span class="string" id="3890862">&#34;video/mp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3890877">/*&nbsp;The&nbsp;remainder&nbsp;are&nbsp;not&nbsp;in&nbsp;the&nbsp;spec.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;M4A&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;audio/mp4&#34;<br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;3gp&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;video/3gpp&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;jp2&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;image/jp2&#34;&nbsp;//&nbsp;JPEG&nbsp;2000<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891057">return</span>&nbsp;<span class="string" id="3891064">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3891067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3891070">type</span>&nbsp;<span class="ident" id="3891075">textSig</span>&nbsp;<span class="builtintype" id="3891083">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3891088">func</span>&nbsp;<span class="op" id="3891093">(</span><span class="ident" id="3891094"><a href="/net/http/sniff.go.html#3891075">textSig</a></span><span class="op" id="3891101">)</span>&nbsp;<span class="ident" id="3891103">match</span><span class="op" id="3891108">(</span><span class="ident" id="3891109">data</span>&nbsp;<span class="op" id="3891114">[</span><span class="op" id="3891115">]</span><span class="builtintype" id="3891116">byte</span><span class="op" id="3891120">,</span>&nbsp;<span class="ident" id="3891122">firstNonWS</span>&nbsp;<span class="builtintype" id="3891133">int</span><span class="op" id="3891136">)</span>&nbsp;<span class="builtintype" id="3891138">string</span>&nbsp;<span class="op" id="3891145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3891148">//&nbsp;c.f.&nbsp;section&nbsp;5,&nbsp;step&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891176">for</span>&nbsp;<span class="ident" id="3891180">_</span><span class="op" id="3891181">,</span>&nbsp;<span class="ident" id="3891183">b</span>&nbsp;<span class="op" id="3891185">:=</span>&nbsp;<span class="keyword" id="3891188">range</span>&nbsp;<span class="ident" id="3891194"><a href="/net/http/sniff.go.html#3891109">data</a></span><span class="op" id="3891198">[</span><span class="ident" id="3891199"><a href="/net/http/sniff.go.html#3891122">firstNonWS</a></span><span class="op" id="3891209">:</span><span class="op" id="3891210">]</span>&nbsp;<span class="op" id="3891212">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891216">switch</span>&nbsp;<span class="op" id="3891223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891227">case</span>&nbsp;<span class="num" id="3891232">0x00</span>&nbsp;<span class="op" id="3891237">&lt;=</span>&nbsp;<span class="ident" id="3891240"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891242">&amp;&amp;</span>&nbsp;<span class="ident" id="3891245"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891247">&lt;=</span>&nbsp;<span class="num" id="3891250">0x08</span><span class="op" id="3891254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891259"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891261">==</span>&nbsp;<span class="num" id="3891264">0x0B</span><span class="op" id="3891268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3891273">0x0E</span>&nbsp;<span class="op" id="3891278">&lt;=</span>&nbsp;<span class="ident" id="3891281"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891283">&amp;&amp;</span>&nbsp;<span class="ident" id="3891286"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891288">&lt;=</span>&nbsp;<span class="num" id="3891291">0x1A</span><span class="op" id="3891295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3891300">0x1C</span>&nbsp;<span class="op" id="3891305">&lt;=</span>&nbsp;<span class="ident" id="3891308"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891310">&amp;&amp;</span>&nbsp;<span class="ident" id="3891313"><a href="/net/http/sniff.go.html#3891183">b</a></span>&nbsp;<span class="op" id="3891315">&lt;=</span>&nbsp;<span class="num" id="3891318">0x1F</span><span class="op" id="3891322">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891327">return</span>&nbsp;<span class="string" id="3891334">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891345">return</span>&nbsp;<span class="string" id="3891352">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3891380">}</span>
</div>
</body>
</html>
