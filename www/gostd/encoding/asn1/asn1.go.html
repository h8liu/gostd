<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3087617">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3087672">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3087726">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3087777">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="3087850">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="3087884">//</span><br>
<span class="lineno"></span><span class="comment" id="3087887">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3087956">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="3088008">package</span>&nbsp;<span class="ident" id="3088016">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3088022">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="3088102">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="3088178">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="3088254">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3088333">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="3088408">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3088480">//</span><br>
<span class="lineno"></span><span class="comment" id="3088483">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="3088554">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3088583">import</span>&nbsp;<span class="op" id="3088590">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3088593">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3088600">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3088612">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3088623">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3088634">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3088641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3088644">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="3088720">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3088760">type</span>&nbsp;<span class="ident" id="3088765">StructuralError</span>&nbsp;<span class="keyword" id="3088781">struct</span>&nbsp;<span class="op" id="3088788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088791">Msg</span>&nbsp;<span class="builtintype" id="3088795">string</span><br>
<span class="lineno"></span><span class="op" id="3088802">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3088805">func</span>&nbsp;<span class="op" id="3088810">(</span><span class="ident" id="3088811">e</span>&nbsp;<span class="ident" id="3088813"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3088828">)</span>&nbsp;<span class="ident" id="3088830">Error</span><span class="op" id="3088835">(</span><span class="op" id="3088836">)</span>&nbsp;<span class="builtintype" id="3088838">string</span>&nbsp;<span class="op" id="3088845">{</span>&nbsp;<span class="keyword" id="3088847">return</span>&nbsp;<span class="string" id="3088854">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3088880">+</span>&nbsp;<span class="ident" id="3088882"><a href="/gostd/encoding/asn1/asn1.go.html#3088811">e</a></span><span class="op" id="3088883">.</span><span class="ident" id="3088884"><a href="/gostd/encoding/asn1/asn1.go.html#3088791">Msg</a></span>&nbsp;<span class="op" id="3088888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3088891">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="3088949">type</span>&nbsp;<span class="ident" id="3088954">SyntaxError</span>&nbsp;<span class="keyword" id="3088966">struct</span>&nbsp;<span class="op" id="3088973">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088976">Msg</span>&nbsp;<span class="builtintype" id="3088980">string</span><br>
<span class="lineno"></span><span class="op" id="3088987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3088990">func</span>&nbsp;<span class="op" id="3088995">(</span><span class="ident" id="3088996">e</span>&nbsp;<span class="ident" id="3088998"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3089009">)</span>&nbsp;<span class="ident" id="3089011">Error</span><span class="op" id="3089016">(</span><span class="op" id="3089017">)</span>&nbsp;<span class="builtintype" id="3089019">string</span>&nbsp;<span class="op" id="3089026">{</span>&nbsp;<span class="keyword" id="3089028">return</span>&nbsp;<span class="string" id="3089035">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3089058">+</span>&nbsp;<span class="ident" id="3089060"><a href="/gostd/encoding/asn1/asn1.go.html#3088996">e</a></span><span class="op" id="3089061">.</span><span class="ident" id="3089062"><a href="/gostd/encoding/asn1/asn1.go.html#3088976">Msg</a></span>&nbsp;<span class="op" id="3089066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3089069">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3089135">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3089147">func</span>&nbsp;<span class="ident" id="3089152">parseBool</span><span class="op" id="3089161">(</span><span class="ident" id="3089162">bytes</span>&nbsp;<span class="op" id="3089168">[</span><span class="op" id="3089169">]</span><span class="builtintype" id="3089170">byte</span><span class="op" id="3089174">)</span>&nbsp;<span class="op" id="3089176">(</span><span class="ident" id="3089177">ret</span>&nbsp;<span class="builtintype" id="3089181">bool</span><span class="op" id="3089185">,</span>&nbsp;<span class="ident" id="3089187">err</span>&nbsp;<span class="builtintype" id="3089191">error</span><span class="op" id="3089196">)</span>&nbsp;<span class="op" id="3089198">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089201">if</span>&nbsp;<span class="builtinfunc" id="3089204">len</span><span class="op" id="3089207">(</span><span class="ident" id="3089208"><a href="/gostd/encoding/asn1/asn1.go.html#3089162">bytes</a></span><span class="op" id="3089213">)</span>&nbsp;<span class="op" id="3089215">!=</span>&nbsp;<span class="num" id="3089218">1</span>&nbsp;<span class="op" id="3089220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089224"><a href="/gostd/encoding/asn1/asn1.go.html#3089187">err</a></span>&nbsp;<span class="op" id="3089228">=</span>&nbsp;<span class="ident" id="3089230"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3089241">{</span><span class="string" id="3089242">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3089259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089263">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089275">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089348">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089417">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089467">switch</span>&nbsp;<span class="ident" id="3089474"><a href="/gostd/encoding/asn1/asn1.go.html#3089162">bytes</a></span><span class="op" id="3089479">[</span><span class="num" id="3089480">0</span><span class="op" id="3089481">]</span>&nbsp;<span class="op" id="3089483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089486">case</span>&nbsp;<span class="num" id="3089491">0</span><span class="op" id="3089492">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089496"><a href="/gostd/encoding/asn1/asn1.go.html#3089177">ret</a></span>&nbsp;<span class="op" id="3089500">=</span>&nbsp;<span class="builtintype" id="3089502">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089509">case</span>&nbsp;<span class="num" id="3089514">0xff</span><span class="op" id="3089518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089522"><a href="/gostd/encoding/asn1/asn1.go.html#3089177">ret</a></span>&nbsp;<span class="op" id="3089526">=</span>&nbsp;<span class="builtintype" id="3089528">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089534">default</span><span class="op" id="3089541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089545"><a href="/gostd/encoding/asn1/asn1.go.html#3089187">err</a></span>&nbsp;<span class="op" id="3089549">=</span>&nbsp;<span class="ident" id="3089551"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3089562">{</span><span class="string" id="3089563">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3089580">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089587">return</span><br>
<span class="lineno"></span><span class="op" id="3089594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3089597">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3089609">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3089682">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3089705">func</span>&nbsp;<span class="ident" id="3089710">parseInt64</span><span class="op" id="3089720">(</span><span class="ident" id="3089721">bytes</span>&nbsp;<span class="op" id="3089727">[</span><span class="op" id="3089728">]</span><span class="builtintype" id="3089729">byte</span><span class="op" id="3089733">)</span>&nbsp;<span class="op" id="3089735">(</span><span class="ident" id="3089736">ret</span>&nbsp;<span class="builtintype" id="3089740">int64</span><span class="op" id="3089745">,</span>&nbsp;<span class="ident" id="3089747">err</span>&nbsp;<span class="builtintype" id="3089751">error</span><span class="op" id="3089756">)</span>&nbsp;<span class="op" id="3089758">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089761">if</span>&nbsp;<span class="builtinfunc" id="3089764">len</span><span class="op" id="3089767">(</span><span class="ident" id="3089768"><a href="/gostd/encoding/asn1/asn1.go.html#3089721">bytes</a></span><span class="op" id="3089773">)</span>&nbsp;<span class="op" id="3089775">&gt;</span>&nbsp;<span class="num" id="3089777">8</span>&nbsp;<span class="op" id="3089779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089783">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089826"><a href="/gostd/encoding/asn1/asn1.go.html#3089747">err</a></span>&nbsp;<span class="op" id="3089830">=</span>&nbsp;<span class="ident" id="3089832"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3089847">{</span><span class="string" id="3089848">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3089867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089871">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089879">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089882">for</span>&nbsp;<span class="ident" id="3089886">bytesRead</span>&nbsp;<span class="op" id="3089896">:=</span>&nbsp;<span class="num" id="3089899">0</span><span class="op" id="3089900">;</span>&nbsp;<span class="ident" id="3089902"><a href="/gostd/encoding/asn1/asn1.go.html#3089886">bytesRead</a></span>&nbsp;<span class="op" id="3089912">&lt;</span>&nbsp;<span class="builtinfunc" id="3089914">len</span><span class="op" id="3089917">(</span><span class="ident" id="3089918"><a href="/gostd/encoding/asn1/asn1.go.html#3089721">bytes</a></span><span class="op" id="3089923">)</span><span class="op" id="3089924">;</span>&nbsp;<span class="ident" id="3089926"><a href="/gostd/encoding/asn1/asn1.go.html#3089886">bytesRead</a></span><span class="op" id="3089935">++</span>&nbsp;<span class="op" id="3089938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089942"><a href="/gostd/encoding/asn1/asn1.go.html#3089736">ret</a></span>&nbsp;<span class="op" id="3089946">&lt;&lt;=</span>&nbsp;<span class="num" id="3089950">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089954"><a href="/gostd/encoding/asn1/asn1.go.html#3089736">ret</a></span>&nbsp;<span class="op" id="3089958">|=</span>&nbsp;<span class="builtintype" id="3089961">int64</span><span class="op" id="3089966">(</span><span class="ident" id="3089967"><a href="/gostd/encoding/asn1/asn1.go.html#3089721">bytes</a></span><span class="op" id="3089972">[</span><span class="ident" id="3089973"><a href="/gostd/encoding/asn1/asn1.go.html#3089886">bytesRead</a></span><span class="op" id="3089982">]</span><span class="op" id="3089983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089990">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090048"><a href="/gostd/encoding/asn1/asn1.go.html#3089736">ret</a></span>&nbsp;<span class="op" id="3090052">&lt;&lt;=</span>&nbsp;<span class="num" id="3090056">64</span>&nbsp;<span class="op" id="3090059">-</span>&nbsp;<span class="builtintype" id="3090061">uint8</span><span class="op" id="3090066">(</span><span class="builtinfunc" id="3090067">len</span><span class="op" id="3090070">(</span><span class="ident" id="3090071"><a href="/gostd/encoding/asn1/asn1.go.html#3089721">bytes</a></span><span class="op" id="3090076">)</span><span class="op" id="3090077">)</span><span class="op" id="3090078">*</span><span class="num" id="3090079">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090082"><a href="/gostd/encoding/asn1/asn1.go.html#3089736">ret</a></span>&nbsp;<span class="op" id="3090086">&gt;&gt;=</span>&nbsp;<span class="num" id="3090090">64</span>&nbsp;<span class="op" id="3090093">-</span>&nbsp;<span class="builtintype" id="3090095">uint8</span><span class="op" id="3090100">(</span><span class="builtinfunc" id="3090101">len</span><span class="op" id="3090104">(</span><span class="ident" id="3090105"><a href="/gostd/encoding/asn1/asn1.go.html#3089721">bytes</a></span><span class="op" id="3090110">)</span><span class="op" id="3090111">)</span><span class="op" id="3090112">*</span><span class="num" id="3090113">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090116">return</span><br>
<span class="lineno"></span><span class="op" id="3090123">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="3090126">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3090205">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3090220">func</span>&nbsp;<span class="ident" id="3090225">parseInt32</span><span class="op" id="3090235">(</span><span class="ident" id="3090236">bytes</span>&nbsp;<span class="op" id="3090242">[</span><span class="op" id="3090243">]</span><span class="builtintype" id="3090244">byte</span><span class="op" id="3090248">)</span>&nbsp;<span class="op" id="3090250">(</span><span class="builtintype" id="3090251">int32</span><span class="op" id="3090256">,</span>&nbsp;<span class="builtintype" id="3090258">error</span><span class="op" id="3090263">)</span>&nbsp;<span class="op" id="3090265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090268">ret64</span><span class="op" id="3090273">,</span>&nbsp;<span class="ident" id="3090275">err</span>&nbsp;<span class="op" id="3090279">:=</span>&nbsp;<span class="ident" id="3090282"><a href="/gostd/encoding/asn1/asn1.go.html#3089710">parseInt64</a></span><span class="op" id="3090292">(</span><span class="ident" id="3090293"><a href="/gostd/encoding/asn1/asn1.go.html#3090236">bytes</a></span><span class="op" id="3090298">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090301">if</span>&nbsp;<span class="ident" id="3090304"><a href="/gostd/encoding/asn1/asn1.go.html#3090275">err</a></span>&nbsp;<span class="op" id="3090308">!=</span>&nbsp;<span class="builtintype" id="3090311">nil</span>&nbsp;<span class="op" id="3090315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090319">return</span>&nbsp;<span class="num" id="3090326">0</span><span class="op" id="3090327">,</span>&nbsp;<span class="ident" id="3090329"><a href="/gostd/encoding/asn1/asn1.go.html#3090275">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090337">if</span>&nbsp;<span class="ident" id="3090340"><a href="/gostd/encoding/asn1/asn1.go.html#3090268">ret64</a></span>&nbsp;<span class="op" id="3090346">!=</span>&nbsp;<span class="builtintype" id="3090349">int64</span><span class="op" id="3090354">(</span><span class="builtintype" id="3090355">int32</span><span class="op" id="3090360">(</span><span class="ident" id="3090361"><a href="/gostd/encoding/asn1/asn1.go.html#3090268">ret64</a></span><span class="op" id="3090366">)</span><span class="op" id="3090367">)</span>&nbsp;<span class="op" id="3090369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090373">return</span>&nbsp;<span class="num" id="3090380">0</span><span class="op" id="3090381">,</span>&nbsp;<span class="ident" id="3090383"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3090398">{</span><span class="string" id="3090399">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3090418">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090424">return</span>&nbsp;<span class="builtintype" id="3090431">int32</span><span class="op" id="3090436">(</span><span class="ident" id="3090437"><a href="/gostd/encoding/asn1/asn1.go.html#3090268">ret64</a></span><span class="op" id="3090442">)</span><span class="op" id="3090443">,</span>&nbsp;<span class="builtintype" id="3090445">nil</span><br>
<span class="lineno"></span><span class="op" id="3090449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3090452">var</span>&nbsp;<span class="ident" id="3090456">bigOne</span>&nbsp;<span class="op" id="3090463">=</span>&nbsp;<span class="ident" id="3090465"><a href="/gostd/encoding/asn1/asn1.go.html#3088600">big</a></span><span class="op" id="3090468">.</span><span class="ident" id="3090469"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="3090475">(</span><span class="num" id="3090476">1</span><span class="op" id="3090477">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3090480">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3090562">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3090577">func</span>&nbsp;<span class="ident" id="3090582">parseBigInt</span><span class="op" id="3090593">(</span><span class="ident" id="3090594">bytes</span>&nbsp;<span class="op" id="3090600">[</span><span class="op" id="3090601">]</span><span class="builtintype" id="3090602">byte</span><span class="op" id="3090606">)</span>&nbsp;<span class="op" id="3090608">*</span><span class="ident" id="3090609"><a href="/gostd/encoding/asn1/asn1.go.html#3088600">big</a></span><span class="op" id="3090612">.</span><span class="ident" id="3090613"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="3090617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090620">ret</span>&nbsp;<span class="op" id="3090624">:=</span>&nbsp;<span class="builtinfunc" id="3090627">new</span><span class="op" id="3090630">(</span><span class="ident" id="3090631"><a href="/gostd/encoding/asn1/asn1.go.html#3088600">big</a></span><span class="op" id="3090634">.</span><span class="ident" id="3090635"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3090638">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090641">if</span>&nbsp;<span class="builtinfunc" id="3090644">len</span><span class="op" id="3090647">(</span><span class="ident" id="3090648"><a href="/gostd/encoding/asn1/asn1.go.html#3090594">bytes</a></span><span class="op" id="3090653">)</span>&nbsp;<span class="op" id="3090655">&gt;</span>&nbsp;<span class="num" id="3090657">0</span>&nbsp;<span class="op" id="3090659">&amp;&amp;</span>&nbsp;<span class="ident" id="3090662"><a href="/gostd/encoding/asn1/asn1.go.html#3090594">bytes</a></span><span class="op" id="3090667">[</span><span class="num" id="3090668">0</span><span class="op" id="3090669">]</span><span class="op" id="3090670">&amp;</span><span class="num" id="3090671">0x80</span>&nbsp;<span class="op" id="3090676">==</span>&nbsp;<span class="num" id="3090679">0x80</span>&nbsp;<span class="op" id="3090684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3090688">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090720">notBytes</span>&nbsp;<span class="op" id="3090729">:=</span>&nbsp;<span class="builtinfunc" id="3090732">make</span><span class="op" id="3090736">(</span><span class="op" id="3090737">[</span><span class="op" id="3090738">]</span><span class="builtintype" id="3090739">byte</span><span class="op" id="3090743">,</span>&nbsp;<span class="builtinfunc" id="3090745">len</span><span class="op" id="3090748">(</span><span class="ident" id="3090749"><a href="/gostd/encoding/asn1/asn1.go.html#3090594">bytes</a></span><span class="op" id="3090754">)</span><span class="op" id="3090755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090759">for</span>&nbsp;<span class="ident" id="3090763">i</span>&nbsp;<span class="op" id="3090765">:=</span>&nbsp;<span class="keyword" id="3090768">range</span>&nbsp;<span class="ident" id="3090774"><a href="/gostd/encoding/asn1/asn1.go.html#3090720">notBytes</a></span>&nbsp;<span class="op" id="3090783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090788"><a href="/gostd/encoding/asn1/asn1.go.html#3090720">notBytes</a></span><span class="op" id="3090796">[</span><span class="ident" id="3090797"><a href="/gostd/encoding/asn1/asn1.go.html#3090763">i</a></span><span class="op" id="3090798">]</span>&nbsp;<span class="op" id="3090800">=</span>&nbsp;<span class="op" id="3090802">^</span><span class="ident" id="3090803"><a href="/gostd/encoding/asn1/asn1.go.html#3090594">bytes</a></span><span class="op" id="3090808">[</span><span class="ident" id="3090809"><a href="/gostd/encoding/asn1/asn1.go.html#3090763">i</a></span><span class="op" id="3090810">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090818"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090821">.</span><span class="ident" id="3090822"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3090830">(</span><span class="ident" id="3090831"><a href="/gostd/encoding/asn1/asn1.go.html#3090720">notBytes</a></span><span class="op" id="3090839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090843"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090846">.</span><span class="ident" id="3090847"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="3090850">(</span><span class="ident" id="3090851"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090854">,</span>&nbsp;<span class="ident" id="3090856"><a href="/gostd/encoding/asn1/asn1.go.html#3090456">bigOne</a></span><span class="op" id="3090862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090866"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090869">.</span><span class="ident" id="3090870"><a href="/gostd/math/big/int.go.html#2037836">Neg</a></span><span class="op" id="3090873">(</span><span class="ident" id="3090874"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090881">return</span>&nbsp;<span class="ident" id="3090888"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090896"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><span class="op" id="3090899">.</span><span class="ident" id="3090900"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="3090908">(</span><span class="ident" id="3090909"><a href="/gostd/encoding/asn1/asn1.go.html#3090594">bytes</a></span><span class="op" id="3090914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090917">return</span>&nbsp;<span class="ident" id="3090924"><a href="/gostd/encoding/asn1/asn1.go.html#3090620">ret</a></span><br>
<span class="lineno"></span><span class="op" id="3090928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3090931">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090946">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="3091025">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3091100">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="3091154">type</span>&nbsp;<span class="ident" id="3091159">BitString</span>&nbsp;<span class="keyword" id="3091169">struct</span>&nbsp;<span class="op" id="3091176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091179">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091189">[</span><span class="op" id="3091190">]</span><span class="builtintype" id="3091191">byte</span>&nbsp;<span class="comment" id="3091196">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091224">BitLength</span>&nbsp;<span class="builtintype" id="3091234">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091241">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="3091260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3091263">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3091337">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="3091355">func</span>&nbsp;<span class="op" id="3091360">(</span><span class="ident" id="3091361">b</span>&nbsp;<span class="ident" id="3091363"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="3091372">)</span>&nbsp;<span class="ident" id="3091374">At</span><span class="op" id="3091376">(</span><span class="ident" id="3091377">i</span>&nbsp;<span class="builtintype" id="3091379">int</span><span class="op" id="3091382">)</span>&nbsp;<span class="builtintype" id="3091384">int</span>&nbsp;<span class="op" id="3091388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091391">if</span>&nbsp;<span class="ident" id="3091394"><a href="/gostd/encoding/asn1/asn1.go.html#3091377">i</a></span>&nbsp;<span class="op" id="3091396">&lt;</span>&nbsp;<span class="num" id="3091398">0</span>&nbsp;<span class="op" id="3091400">||</span>&nbsp;<span class="ident" id="3091403"><a href="/gostd/encoding/asn1/asn1.go.html#3091377">i</a></span>&nbsp;<span class="op" id="3091405">&gt;=</span>&nbsp;<span class="ident" id="3091408"><a href="/gostd/encoding/asn1/asn1.go.html#3091361">b</a></span><span class="op" id="3091409">.</span><span class="ident" id="3091410"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span>&nbsp;<span class="op" id="3091420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091424">return</span>&nbsp;<span class="num" id="3091431">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091437">x</span>&nbsp;<span class="op" id="3091439">:=</span>&nbsp;<span class="ident" id="3091442"><a href="/gostd/encoding/asn1/asn1.go.html#3091377">i</a></span>&nbsp;<span class="op" id="3091444">/</span>&nbsp;<span class="num" id="3091446">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091449">y</span>&nbsp;<span class="op" id="3091451">:=</span>&nbsp;<span class="num" id="3091454">7</span>&nbsp;<span class="op" id="3091456">-</span>&nbsp;<span class="builtintype" id="3091458">uint</span><span class="op" id="3091462">(</span><span class="ident" id="3091463"><a href="/gostd/encoding/asn1/asn1.go.html#3091377">i</a></span><span class="op" id="3091464">%</span><span class="num" id="3091465">8</span><span class="op" id="3091466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091469">return</span>&nbsp;<span class="builtintype" id="3091476">int</span><span class="op" id="3091479">(</span><span class="ident" id="3091480"><a href="/gostd/encoding/asn1/asn1.go.html#3091361">b</a></span><span class="op" id="3091481">.</span><span class="ident" id="3091482"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091487">[</span><span class="ident" id="3091488"><a href="/gostd/encoding/asn1/asn1.go.html#3091437">x</a></span><span class="op" id="3091489">]</span><span class="op" id="3091490">&gt;&gt;</span><span class="ident" id="3091492"><a href="/gostd/encoding/asn1/asn1.go.html#3091449">y</a></span><span class="op" id="3091493">)</span>&nbsp;<span class="op" id="3091495">&amp;</span>&nbsp;<span class="num" id="3091497">1</span><br>
<span class="lineno"></span><span class="op" id="3091499">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3091502">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3091581">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="3091627">func</span>&nbsp;<span class="op" id="3091632">(</span><span class="ident" id="3091633">b</span>&nbsp;<span class="ident" id="3091635"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="3091644">)</span>&nbsp;<span class="ident" id="3091646">RightAlign</span><span class="op" id="3091656">(</span><span class="op" id="3091657">)</span>&nbsp;<span class="op" id="3091659">[</span><span class="op" id="3091660">]</span><span class="builtintype" id="3091661">byte</span>&nbsp;<span class="op" id="3091666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091669">shift</span>&nbsp;<span class="op" id="3091675">:=</span>&nbsp;<span class="builtintype" id="3091678">uint</span><span class="op" id="3091682">(</span><span class="num" id="3091683">8</span>&nbsp;<span class="op" id="3091685">-</span>&nbsp;<span class="op" id="3091687">(</span><span class="ident" id="3091688"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091689">.</span><span class="ident" id="3091690"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span>&nbsp;<span class="op" id="3091700">%</span>&nbsp;<span class="num" id="3091702">8</span><span class="op" id="3091703">)</span><span class="op" id="3091704">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091707">if</span>&nbsp;<span class="ident" id="3091710"><a href="/gostd/encoding/asn1/asn1.go.html#3091669">shift</a></span>&nbsp;<span class="op" id="3091716">==</span>&nbsp;<span class="num" id="3091719">8</span>&nbsp;<span class="op" id="3091721">||</span>&nbsp;<span class="builtinfunc" id="3091724">len</span><span class="op" id="3091727">(</span><span class="ident" id="3091728"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091729">.</span><span class="ident" id="3091730"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091735">)</span>&nbsp;<span class="op" id="3091737">==</span>&nbsp;<span class="num" id="3091740">0</span>&nbsp;<span class="op" id="3091742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091746">return</span>&nbsp;<span class="ident" id="3091753"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091754">.</span><span class="ident" id="3091755"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091766">a</span>&nbsp;<span class="op" id="3091768">:=</span>&nbsp;<span class="builtinfunc" id="3091771">make</span><span class="op" id="3091775">(</span><span class="op" id="3091776">[</span><span class="op" id="3091777">]</span><span class="builtintype" id="3091778">byte</span><span class="op" id="3091782">,</span>&nbsp;<span class="builtinfunc" id="3091784">len</span><span class="op" id="3091787">(</span><span class="ident" id="3091788"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091789">.</span><span class="ident" id="3091790"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091795">)</span><span class="op" id="3091796">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091799"><a href="/gostd/encoding/asn1/asn1.go.html#3091766">a</a></span><span class="op" id="3091800">[</span><span class="num" id="3091801">0</span><span class="op" id="3091802">]</span>&nbsp;<span class="op" id="3091804">=</span>&nbsp;<span class="ident" id="3091806"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091807">.</span><span class="ident" id="3091808"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091813">[</span><span class="num" id="3091814">0</span><span class="op" id="3091815">]</span>&nbsp;<span class="op" id="3091817">&gt;&gt;</span>&nbsp;<span class="ident" id="3091820"><a href="/gostd/encoding/asn1/asn1.go.html#3091669">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091827">for</span>&nbsp;<span class="ident" id="3091831">i</span>&nbsp;<span class="op" id="3091833">:=</span>&nbsp;<span class="num" id="3091836">1</span><span class="op" id="3091837">;</span>&nbsp;<span class="ident" id="3091839"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span>&nbsp;<span class="op" id="3091841">&lt;</span>&nbsp;<span class="builtinfunc" id="3091843">len</span><span class="op" id="3091846">(</span><span class="ident" id="3091847"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091848">.</span><span class="ident" id="3091849"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091854">)</span><span class="op" id="3091855">;</span>&nbsp;<span class="ident" id="3091857"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span><span class="op" id="3091858">++</span>&nbsp;<span class="op" id="3091861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091865"><a href="/gostd/encoding/asn1/asn1.go.html#3091766">a</a></span><span class="op" id="3091866">[</span><span class="ident" id="3091867"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span><span class="op" id="3091868">]</span>&nbsp;<span class="op" id="3091870">=</span>&nbsp;<span class="ident" id="3091872"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091873">.</span><span class="ident" id="3091874"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091879">[</span><span class="ident" id="3091880"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span><span class="op" id="3091881">-</span><span class="num" id="3091882">1</span><span class="op" id="3091883">]</span>&nbsp;<span class="op" id="3091885">&lt;&lt;</span>&nbsp;<span class="op" id="3091888">(</span><span class="num" id="3091889">8</span>&nbsp;<span class="op" id="3091891">-</span>&nbsp;<span class="ident" id="3091893"><a href="/gostd/encoding/asn1/asn1.go.html#3091669">shift</a></span><span class="op" id="3091898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091902"><a href="/gostd/encoding/asn1/asn1.go.html#3091766">a</a></span><span class="op" id="3091903">[</span><span class="ident" id="3091904"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span><span class="op" id="3091905">]</span>&nbsp;<span class="op" id="3091907">|=</span>&nbsp;<span class="ident" id="3091910"><a href="/gostd/encoding/asn1/asn1.go.html#3091633">b</a></span><span class="op" id="3091911">.</span><span class="ident" id="3091912"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span><span class="op" id="3091917">[</span><span class="ident" id="3091918"><a href="/gostd/encoding/asn1/asn1.go.html#3091831">i</a></span><span class="op" id="3091919">]</span>&nbsp;<span class="op" id="3091921">&gt;&gt;</span>&nbsp;<span class="ident" id="3091924"><a href="/gostd/encoding/asn1/asn1.go.html#3091669">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3091931">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091935">return</span>&nbsp;<span class="ident" id="3091942"><a href="/gostd/encoding/asn1/asn1.go.html#3091766">a</a></span><br>
<span class="lineno"></span><span class="op" id="3091944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3091947">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="3092034">func</span>&nbsp;<span class="ident" id="3092039">parseBitString</span><span class="op" id="3092053">(</span><span class="ident" id="3092054">bytes</span>&nbsp;<span class="op" id="3092060">[</span><span class="op" id="3092061">]</span><span class="builtintype" id="3092062">byte</span><span class="op" id="3092066">)</span>&nbsp;<span class="op" id="3092068">(</span><span class="ident" id="3092069">ret</span>&nbsp;<span class="ident" id="3092073"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="3092082">,</span>&nbsp;<span class="ident" id="3092084">err</span>&nbsp;<span class="builtintype" id="3092088">error</span><span class="op" id="3092093">)</span>&nbsp;<span class="op" id="3092095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092098">if</span>&nbsp;<span class="builtinfunc" id="3092101">len</span><span class="op" id="3092104">(</span><span class="ident" id="3092105"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092110">)</span>&nbsp;<span class="op" id="3092112">==</span>&nbsp;<span class="num" id="3092115">0</span>&nbsp;<span class="op" id="3092117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092121"><a href="/gostd/encoding/asn1/asn1.go.html#3092084">err</a></span>&nbsp;<span class="op" id="3092125">=</span>&nbsp;<span class="ident" id="3092127"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3092138">{</span><span class="string" id="3092139">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3092163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092175">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092178">paddingBits</span>&nbsp;<span class="op" id="3092190">:=</span>&nbsp;<span class="builtintype" id="3092193">int</span><span class="op" id="3092196">(</span><span class="ident" id="3092197"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092202">[</span><span class="num" id="3092203">0</span><span class="op" id="3092204">]</span><span class="op" id="3092205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092208">if</span>&nbsp;<span class="ident" id="3092211"><a href="/gostd/encoding/asn1/asn1.go.html#3092178">paddingBits</a></span>&nbsp;<span class="op" id="3092223">&gt;</span>&nbsp;<span class="num" id="3092225">7</span>&nbsp;<span class="op" id="3092227">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3092232">len</span><span class="op" id="3092235">(</span><span class="ident" id="3092236"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092241">)</span>&nbsp;<span class="op" id="3092243">==</span>&nbsp;<span class="num" id="3092246">1</span>&nbsp;<span class="op" id="3092248">&amp;&amp;</span>&nbsp;<span class="ident" id="3092251"><a href="/gostd/encoding/asn1/asn1.go.html#3092178">paddingBits</a></span>&nbsp;<span class="op" id="3092263">&gt;</span>&nbsp;<span class="num" id="3092265">0</span>&nbsp;<span class="op" id="3092267">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092272"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092277">[</span><span class="builtinfunc" id="3092278">len</span><span class="op" id="3092281">(</span><span class="ident" id="3092282"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092287">)</span><span class="op" id="3092288">-</span><span class="num" id="3092289">1</span><span class="op" id="3092290">]</span><span class="op" id="3092291">&amp;</span><span class="op" id="3092292">(</span><span class="op" id="3092293">(</span><span class="num" id="3092294">1</span><span class="op" id="3092295">&lt;&lt;</span><span class="ident" id="3092297"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092302">[</span><span class="num" id="3092303">0</span><span class="op" id="3092304">]</span><span class="op" id="3092305">)</span><span class="op" id="3092306">-</span><span class="num" id="3092307">1</span><span class="op" id="3092308">)</span>&nbsp;<span class="op" id="3092310">!=</span>&nbsp;<span class="num" id="3092313">0</span>&nbsp;<span class="op" id="3092315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092319"><a href="/gostd/encoding/asn1/asn1.go.html#3092084">err</a></span>&nbsp;<span class="op" id="3092323">=</span>&nbsp;<span class="ident" id="3092325"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3092336">{</span><span class="string" id="3092337">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3092373">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092377">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092388"><a href="/gostd/encoding/asn1/asn1.go.html#3092069">ret</a></span><span class="op" id="3092391">.</span><span class="ident" id="3092392"><a href="/gostd/encoding/asn1/asn1.go.html#3091224">BitLength</a></span>&nbsp;<span class="op" id="3092402">=</span>&nbsp;<span class="op" id="3092404">(</span><span class="builtinfunc" id="3092405">len</span><span class="op" id="3092408">(</span><span class="ident" id="3092409"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092414">)</span><span class="op" id="3092415">-</span><span class="num" id="3092416">1</span><span class="op" id="3092417">)</span><span class="op" id="3092418">*</span><span class="num" id="3092419">8</span>&nbsp;<span class="op" id="3092421">-</span>&nbsp;<span class="ident" id="3092423"><a href="/gostd/encoding/asn1/asn1.go.html#3092178">paddingBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092436"><a href="/gostd/encoding/asn1/asn1.go.html#3092069">ret</a></span><span class="op" id="3092439">.</span><span class="ident" id="3092440"><a href="/gostd/encoding/asn1/asn1.go.html#3091179">Bytes</a></span>&nbsp;<span class="op" id="3092446">=</span>&nbsp;<span class="ident" id="3092448"><a href="/gostd/encoding/asn1/asn1.go.html#3092054">bytes</a></span><span class="op" id="3092453">[</span><span class="num" id="3092454">1</span><span class="op" id="3092455">:</span><span class="op" id="3092456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092459">return</span><br>
<span class="lineno">180</span><span class="op" id="3092466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092469">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092491">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="3092553">type</span>&nbsp;<span class="ident" id="3092558">ObjectIdentifier</span>&nbsp;<span class="op" id="3092575">[</span><span class="op" id="3092576">]</span><span class="builtintype" id="3092577">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092582">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="3092651">func</span>&nbsp;<span class="op" id="3092656">(</span><span class="ident" id="3092657">oi</span>&nbsp;<span class="ident" id="3092660"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="3092676">)</span>&nbsp;<span class="ident" id="3092678">Equal</span><span class="op" id="3092683">(</span><span class="ident" id="3092684">other</span>&nbsp;<span class="ident" id="3092690"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="3092706">)</span>&nbsp;<span class="builtintype" id="3092708">bool</span>&nbsp;<span class="op" id="3092713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092716">if</span>&nbsp;<span class="builtinfunc" id="3092719">len</span><span class="op" id="3092722">(</span><span class="ident" id="3092723"><a href="/gostd/encoding/asn1/asn1.go.html#3092657">oi</a></span><span class="op" id="3092725">)</span>&nbsp;<span class="op" id="3092727">!=</span>&nbsp;<span class="builtinfunc" id="3092730">len</span><span class="op" id="3092733">(</span><span class="ident" id="3092734"><a href="/gostd/encoding/asn1/asn1.go.html#3092684">other</a></span><span class="op" id="3092739">)</span>&nbsp;<span class="op" id="3092741">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092745">return</span>&nbsp;<span class="builtintype" id="3092752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092762">for</span>&nbsp;<span class="ident" id="3092766">i</span>&nbsp;<span class="op" id="3092768">:=</span>&nbsp;<span class="num" id="3092771">0</span><span class="op" id="3092772">;</span>&nbsp;<span class="ident" id="3092774"><a href="/gostd/encoding/asn1/asn1.go.html#3092766">i</a></span>&nbsp;<span class="op" id="3092776">&lt;</span>&nbsp;<span class="builtinfunc" id="3092778">len</span><span class="op" id="3092781">(</span><span class="ident" id="3092782"><a href="/gostd/encoding/asn1/asn1.go.html#3092657">oi</a></span><span class="op" id="3092784">)</span><span class="op" id="3092785">;</span>&nbsp;<span class="ident" id="3092787"><a href="/gostd/encoding/asn1/asn1.go.html#3092766">i</a></span><span class="op" id="3092788">++</span>&nbsp;<span class="op" id="3092791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092795">if</span>&nbsp;<span class="ident" id="3092798"><a href="/gostd/encoding/asn1/asn1.go.html#3092657">oi</a></span><span class="op" id="3092800">[</span><span class="ident" id="3092801"><a href="/gostd/encoding/asn1/asn1.go.html#3092766">i</a></span><span class="op" id="3092802">]</span>&nbsp;<span class="op" id="3092804">!=</span>&nbsp;<span class="ident" id="3092807"><a href="/gostd/encoding/asn1/asn1.go.html#3092684">other</a></span><span class="op" id="3092812">[</span><span class="ident" id="3092813"><a href="/gostd/encoding/asn1/asn1.go.html#3092766">i</a></span><span class="op" id="3092814">]</span>&nbsp;<span class="op" id="3092816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092821">return</span>&nbsp;<span class="builtintype" id="3092828">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092843">return</span>&nbsp;<span class="builtintype" id="3092850">true</span><br>
<span class="lineno"></span><span class="op" id="3092855">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="3092858">func</span>&nbsp;<span class="op" id="3092863">(</span><span class="ident" id="3092864">oi</span>&nbsp;<span class="ident" id="3092867"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="3092883">)</span>&nbsp;<span class="ident" id="3092885">String</span><span class="op" id="3092891">(</span><span class="op" id="3092892">)</span>&nbsp;<span class="builtintype" id="3092894">string</span>&nbsp;<span class="op" id="3092901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092904">var</span>&nbsp;<span class="ident" id="3092908">s</span>&nbsp;<span class="builtintype" id="3092910">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092919">for</span>&nbsp;<span class="ident" id="3092923">i</span><span class="op" id="3092924">,</span>&nbsp;<span class="ident" id="3092926">v</span>&nbsp;<span class="op" id="3092928">:=</span>&nbsp;<span class="keyword" id="3092931">range</span>&nbsp;<span class="ident" id="3092937"><a href="/gostd/encoding/asn1/asn1.go.html#3092864">oi</a></span>&nbsp;<span class="op" id="3092940">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092944">if</span>&nbsp;<span class="ident" id="3092947"><a href="/gostd/encoding/asn1/asn1.go.html#3092923">i</a></span>&nbsp;<span class="op" id="3092949">&gt;</span>&nbsp;<span class="num" id="3092951">0</span>&nbsp;<span class="op" id="3092953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092958"><a href="/gostd/encoding/asn1/asn1.go.html#3092908">s</a></span>&nbsp;<span class="op" id="3092960">+=</span>&nbsp;<span class="string" id="3092963">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092973"><a href="/gostd/encoding/asn1/asn1.go.html#3092908">s</a></span>&nbsp;<span class="op" id="3092975">+=</span>&nbsp;<span class="ident" id="3092978"><a href="/gostd/encoding/asn1/asn1.go.html#3088623">strconv</a></span><span class="op" id="3092985">.</span><span class="ident" id="3092986"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="3092990">(</span><span class="ident" id="3092991"><a href="/gostd/encoding/asn1/asn1.go.html#3092926">v</a></span><span class="op" id="3092992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3092995">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092999">return</span>&nbsp;<span class="ident" id="3093006"><a href="/gostd/encoding/asn1/asn1.go.html#3092908">s</a></span><br>
<span class="lineno"></span><span class="op" id="3093008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3093011">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="3093089">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="3093167">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="3093204">func</span>&nbsp;<span class="ident" id="3093209">parseObjectIdentifier</span><span class="op" id="3093230">(</span><span class="ident" id="3093231">bytes</span>&nbsp;<span class="op" id="3093237">[</span><span class="op" id="3093238">]</span><span class="builtintype" id="3093239">byte</span><span class="op" id="3093243">)</span>&nbsp;<span class="op" id="3093245">(</span><span class="ident" id="3093246">s</span>&nbsp;<span class="op" id="3093248">[</span><span class="op" id="3093249">]</span><span class="builtintype" id="3093250">int</span><span class="op" id="3093253">,</span>&nbsp;<span class="ident" id="3093255">err</span>&nbsp;<span class="builtintype" id="3093259">error</span><span class="op" id="3093264">)</span>&nbsp;<span class="op" id="3093266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093269">if</span>&nbsp;<span class="builtinfunc" id="3093272">len</span><span class="op" id="3093275">(</span><span class="ident" id="3093276"><a href="/gostd/encoding/asn1/asn1.go.html#3093231">bytes</a></span><span class="op" id="3093281">)</span>&nbsp;<span class="op" id="3093283">==</span>&nbsp;<span class="num" id="3093286">0</span>&nbsp;<span class="op" id="3093288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093292"><a href="/gostd/encoding/asn1/asn1.go.html#3093255">err</a></span>&nbsp;<span class="op" id="3093296">=</span>&nbsp;<span class="ident" id="3093298"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3093309">{</span><span class="string" id="3093310">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="3093341">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093345">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093357">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093430">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093500"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span>&nbsp;<span class="op" id="3093502">=</span>&nbsp;<span class="builtinfunc" id="3093504">make</span><span class="op" id="3093508">(</span><span class="op" id="3093509">[</span><span class="op" id="3093510">]</span><span class="builtintype" id="3093511">int</span><span class="op" id="3093514">,</span>&nbsp;<span class="builtinfunc" id="3093516">len</span><span class="op" id="3093519">(</span><span class="ident" id="3093520"><a href="/gostd/encoding/asn1/asn1.go.html#3093231">bytes</a></span><span class="op" id="3093525">)</span><span class="op" id="3093526">+</span><span class="num" id="3093527">1</span><span class="op" id="3093528">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093532">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093576">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093651">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093725">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093771">v</span><span class="op" id="3093772">,</span>&nbsp;<span class="ident" id="3093774">offset</span><span class="op" id="3093780">,</span>&nbsp;<span class="ident" id="3093782"><a href="/gostd/encoding/asn1/asn1.go.html#3093255">err</a></span>&nbsp;<span class="op" id="3093786">:=</span>&nbsp;<span class="ident" id="3093789"><a href="/gostd/encoding/asn1/asn1.go.html#3094403">parseBase128Int</a></span><span class="op" id="3093804">(</span><span class="ident" id="3093805"><a href="/gostd/encoding/asn1/asn1.go.html#3093231">bytes</a></span><span class="op" id="3093810">,</span>&nbsp;<span class="num" id="3093812">0</span><span class="op" id="3093813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093816">if</span>&nbsp;<span class="ident" id="3093819"><a href="/gostd/encoding/asn1/asn1.go.html#3093255">err</a></span>&nbsp;<span class="op" id="3093823">!=</span>&nbsp;<span class="builtintype" id="3093826">nil</span>&nbsp;<span class="op" id="3093830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093834">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093842">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093845">if</span>&nbsp;<span class="ident" id="3093848"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span>&nbsp;<span class="op" id="3093850">&lt;</span>&nbsp;<span class="num" id="3093852">80</span>&nbsp;<span class="op" id="3093855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093859"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3093860">[</span><span class="num" id="3093861">0</span><span class="op" id="3093862">]</span>&nbsp;<span class="op" id="3093864">=</span>&nbsp;<span class="ident" id="3093866"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span>&nbsp;<span class="op" id="3093868">/</span>&nbsp;<span class="num" id="3093870">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093875"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3093876">[</span><span class="num" id="3093877">1</span><span class="op" id="3093878">]</span>&nbsp;<span class="op" id="3093880">=</span>&nbsp;<span class="ident" id="3093882"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span>&nbsp;<span class="op" id="3093884">%</span>&nbsp;<span class="num" id="3093886">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093890">}</span>&nbsp;<span class="keyword" id="3093892">else</span>&nbsp;<span class="op" id="3093897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093901"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3093902">[</span><span class="num" id="3093903">0</span><span class="op" id="3093904">]</span>&nbsp;<span class="op" id="3093906">=</span>&nbsp;<span class="num" id="3093908">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093912"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3093913">[</span><span class="num" id="3093914">1</span><span class="op" id="3093915">]</span>&nbsp;<span class="op" id="3093917">=</span>&nbsp;<span class="ident" id="3093919"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span>&nbsp;<span class="op" id="3093921">-</span>&nbsp;<span class="num" id="3093923">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093931">i</span>&nbsp;<span class="op" id="3093933">:=</span>&nbsp;<span class="num" id="3093936">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093939">for</span>&nbsp;<span class="op" id="3093943">;</span>&nbsp;<span class="ident" id="3093945"><a href="/gostd/encoding/asn1/asn1.go.html#3093774">offset</a></span>&nbsp;<span class="op" id="3093952">&lt;</span>&nbsp;<span class="builtinfunc" id="3093954">len</span><span class="op" id="3093957">(</span><span class="ident" id="3093958"><a href="/gostd/encoding/asn1/asn1.go.html#3093231">bytes</a></span><span class="op" id="3093963">)</span><span class="op" id="3093964">;</span>&nbsp;<span class="ident" id="3093966"><a href="/gostd/encoding/asn1/asn1.go.html#3093931">i</a></span><span class="op" id="3093967">++</span>&nbsp;<span class="op" id="3093970">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093974"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span><span class="op" id="3093975">,</span>&nbsp;<span class="ident" id="3093977"><a href="/gostd/encoding/asn1/asn1.go.html#3093774">offset</a></span><span class="op" id="3093983">,</span>&nbsp;<span class="ident" id="3093985"><a href="/gostd/encoding/asn1/asn1.go.html#3093255">err</a></span>&nbsp;<span class="op" id="3093989">=</span>&nbsp;<span class="ident" id="3093991"><a href="/gostd/encoding/asn1/asn1.go.html#3094403">parseBase128Int</a></span><span class="op" id="3094006">(</span><span class="ident" id="3094007"><a href="/gostd/encoding/asn1/asn1.go.html#3093231">bytes</a></span><span class="op" id="3094012">,</span>&nbsp;<span class="ident" id="3094014"><a href="/gostd/encoding/asn1/asn1.go.html#3093774">offset</a></span><span class="op" id="3094020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094024">if</span>&nbsp;<span class="ident" id="3094027"><a href="/gostd/encoding/asn1/asn1.go.html#3093255">err</a></span>&nbsp;<span class="op" id="3094031">!=</span>&nbsp;<span class="builtintype" id="3094034">nil</span>&nbsp;<span class="op" id="3094038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094043">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094056"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3094057">[</span><span class="ident" id="3094058"><a href="/gostd/encoding/asn1/asn1.go.html#3093931">i</a></span><span class="op" id="3094059">]</span>&nbsp;<span class="op" id="3094061">=</span>&nbsp;<span class="ident" id="3094063"><a href="/gostd/encoding/asn1/asn1.go.html#3093771">v</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094069"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span>&nbsp;<span class="op" id="3094071">=</span>&nbsp;<span class="ident" id="3094073"><a href="/gostd/encoding/asn1/asn1.go.html#3093246">s</a></span><span class="op" id="3094074">[</span><span class="num" id="3094075">0</span><span class="op" id="3094076">:</span><span class="ident" id="3094077"><a href="/gostd/encoding/asn1/asn1.go.html#3093931">i</a></span><span class="op" id="3094078">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094081">return</span><br>
<span class="lineno"></span><span class="op" id="3094088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="3094091">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094106">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="3094154">type</span>&nbsp;<span class="ident" id="3094159">Enumerated</span>&nbsp;<span class="builtintype" id="3094170">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3094175">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094184">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3094242">type</span>&nbsp;<span class="ident" id="3094247">Flag</span>&nbsp;<span class="builtintype" id="3094252">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="3094258">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3094336">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="3094398">func</span>&nbsp;<span class="ident" id="3094403">parseBase128Int</span><span class="op" id="3094418">(</span><span class="ident" id="3094419">bytes</span>&nbsp;<span class="op" id="3094425">[</span><span class="op" id="3094426">]</span><span class="builtintype" id="3094427">byte</span><span class="op" id="3094431">,</span>&nbsp;<span class="ident" id="3094433">initOffset</span>&nbsp;<span class="builtintype" id="3094444">int</span><span class="op" id="3094447">)</span>&nbsp;<span class="op" id="3094449">(</span><span class="ident" id="3094450">ret</span><span class="op" id="3094453">,</span>&nbsp;<span class="ident" id="3094455">offset</span>&nbsp;<span class="builtintype" id="3094462">int</span><span class="op" id="3094465">,</span>&nbsp;<span class="ident" id="3094467">err</span>&nbsp;<span class="builtintype" id="3094471">error</span><span class="op" id="3094476">)</span>&nbsp;<span class="op" id="3094478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094481"><a href="/gostd/encoding/asn1/asn1.go.html#3094455">offset</a></span>&nbsp;<span class="op" id="3094488">=</span>&nbsp;<span class="ident" id="3094490"><a href="/gostd/encoding/asn1/asn1.go.html#3094433">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094502">for</span>&nbsp;<span class="ident" id="3094506">shifted</span>&nbsp;<span class="op" id="3094514">:=</span>&nbsp;<span class="num" id="3094517">0</span><span class="op" id="3094518">;</span>&nbsp;<span class="ident" id="3094520"><a href="/gostd/encoding/asn1/asn1.go.html#3094455">offset</a></span>&nbsp;<span class="op" id="3094527">&lt;</span>&nbsp;<span class="builtinfunc" id="3094529">len</span><span class="op" id="3094532">(</span><span class="ident" id="3094533"><a href="/gostd/encoding/asn1/asn1.go.html#3094419">bytes</a></span><span class="op" id="3094538">)</span><span class="op" id="3094539">;</span>&nbsp;<span class="ident" id="3094541"><a href="/gostd/encoding/asn1/asn1.go.html#3094506">shifted</a></span><span class="op" id="3094548">++</span>&nbsp;<span class="op" id="3094551">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094555">if</span>&nbsp;<span class="ident" id="3094558"><a href="/gostd/encoding/asn1/asn1.go.html#3094506">shifted</a></span>&nbsp;<span class="op" id="3094566">&gt;</span>&nbsp;<span class="num" id="3094568">4</span>&nbsp;<span class="op" id="3094570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094575"><a href="/gostd/encoding/asn1/asn1.go.html#3094467">err</a></span>&nbsp;<span class="op" id="3094579">=</span>&nbsp;<span class="ident" id="3094581"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3094596">{</span><span class="string" id="3094597">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3094625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094630">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094643"><a href="/gostd/encoding/asn1/asn1.go.html#3094450">ret</a></span>&nbsp;<span class="op" id="3094647">&lt;&lt;=</span>&nbsp;<span class="num" id="3094651">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094655">b</span>&nbsp;<span class="op" id="3094657">:=</span>&nbsp;<span class="ident" id="3094660"><a href="/gostd/encoding/asn1/asn1.go.html#3094419">bytes</a></span><span class="op" id="3094665">[</span><span class="ident" id="3094666"><a href="/gostd/encoding/asn1/asn1.go.html#3094455">offset</a></span><span class="op" id="3094672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094676"><a href="/gostd/encoding/asn1/asn1.go.html#3094450">ret</a></span>&nbsp;<span class="op" id="3094680">|=</span>&nbsp;<span class="builtintype" id="3094683">int</span><span class="op" id="3094686">(</span><span class="ident" id="3094687"><a href="/gostd/encoding/asn1/asn1.go.html#3094655">b</a></span>&nbsp;<span class="op" id="3094689">&amp;</span>&nbsp;<span class="num" id="3094691">0x7f</span><span class="op" id="3094695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094699"><a href="/gostd/encoding/asn1/asn1.go.html#3094455">offset</a></span><span class="op" id="3094705">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094710">if</span>&nbsp;<span class="ident" id="3094713"><a href="/gostd/encoding/asn1/asn1.go.html#3094655">b</a></span><span class="op" id="3094714">&amp;</span><span class="num" id="3094715">0x80</span>&nbsp;<span class="op" id="3094720">==</span>&nbsp;<span class="num" id="3094723">0</span>&nbsp;<span class="op" id="3094725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094730">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094745"><a href="/gostd/encoding/asn1/asn1.go.html#3094467">err</a></span>&nbsp;<span class="op" id="3094749">=</span>&nbsp;<span class="ident" id="3094751"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3094762">{</span><span class="string" id="3094763">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="3094791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094794">return</span><br>
<span class="lineno"></span><span class="op" id="3094801">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="3094804">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3094816">func</span>&nbsp;<span class="ident" id="3094821">parseUTCTime</span><span class="op" id="3094833">(</span><span class="ident" id="3094834">bytes</span>&nbsp;<span class="op" id="3094840">[</span><span class="op" id="3094841">]</span><span class="builtintype" id="3094842">byte</span><span class="op" id="3094846">)</span>&nbsp;<span class="op" id="3094848">(</span><span class="ident" id="3094849">ret</span>&nbsp;<span class="ident" id="3094853"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3094857">.</span><span class="ident" id="3094858"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3094862">,</span>&nbsp;<span class="ident" id="3094864">err</span>&nbsp;<span class="builtintype" id="3094868">error</span><span class="op" id="3094873">)</span>&nbsp;<span class="op" id="3094875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094878">s</span>&nbsp;<span class="op" id="3094880">:=</span>&nbsp;<span class="builtintype" id="3094883">string</span><span class="op" id="3094889">(</span><span class="ident" id="3094890"><a href="/gostd/encoding/asn1/asn1.go.html#3094834">bytes</a></span><span class="op" id="3094895">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094898"><a href="/gostd/encoding/asn1/asn1.go.html#3094849">ret</a></span><span class="op" id="3094901">,</span>&nbsp;<span class="ident" id="3094903"><a href="/gostd/encoding/asn1/asn1.go.html#3094864">err</a></span>&nbsp;<span class="op" id="3094907">=</span>&nbsp;<span class="ident" id="3094909"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3094913">.</span><span class="ident" id="3094914"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="3094919">(</span><span class="string" id="3094920">&#34;0601021504Z0700&#34;</span><span class="op" id="3094937">,</span>&nbsp;<span class="ident" id="3094939"><a href="/gostd/encoding/asn1/asn1.go.html#3094878">s</a></span><span class="op" id="3094940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094943">if</span>&nbsp;<span class="ident" id="3094946"><a href="/gostd/encoding/asn1/asn1.go.html#3094864">err</a></span>&nbsp;<span class="op" id="3094950">!=</span>&nbsp;<span class="builtintype" id="3094953">nil</span>&nbsp;<span class="op" id="3094957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094961"><a href="/gostd/encoding/asn1/asn1.go.html#3094849">ret</a></span><span class="op" id="3094964">,</span>&nbsp;<span class="ident" id="3094966"><a href="/gostd/encoding/asn1/asn1.go.html#3094864">err</a></span>&nbsp;<span class="op" id="3094970">=</span>&nbsp;<span class="ident" id="3094972"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3094976">.</span><span class="ident" id="3094977"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="3094982">(</span><span class="string" id="3094983">&#34;060102150405Z0700&#34;</span><span class="op" id="3095002">,</span>&nbsp;<span class="ident" id="3095004"><a href="/gostd/encoding/asn1/asn1.go.html#3094878">s</a></span><span class="op" id="3095005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095011">if</span>&nbsp;<span class="ident" id="3095014"><a href="/gostd/encoding/asn1/asn1.go.html#3094864">err</a></span>&nbsp;<span class="op" id="3095018">==</span>&nbsp;<span class="builtintype" id="3095021">nil</span>&nbsp;<span class="op" id="3095025">&amp;&amp;</span>&nbsp;<span class="ident" id="3095028"><a href="/gostd/encoding/asn1/asn1.go.html#3094849">ret</a></span><span class="op" id="3095031">.</span><span class="ident" id="3095032"><a href="/gostd/time/time.go.html#2730250">Year</a></span><span class="op" id="3095036">(</span><span class="op" id="3095037">)</span>&nbsp;<span class="op" id="3095039">&gt;=</span>&nbsp;<span class="num" id="3095042">2050</span>&nbsp;<span class="op" id="3095047">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3095051">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095156"><a href="/gostd/encoding/asn1/asn1.go.html#3094849">ret</a></span>&nbsp;<span class="op" id="3095160">=</span>&nbsp;<span class="ident" id="3095162"><a href="/gostd/encoding/asn1/asn1.go.html#3094849">ret</a></span><span class="op" id="3095165">.</span><span class="ident" id="3095166"><a href="/gostd/time/time.go.html#2739928">AddDate</a></span><span class="op" id="3095173">(</span><span class="op" id="3095174">-</span><span class="num" id="3095175">100</span><span class="op" id="3095178">,</span>&nbsp;<span class="num" id="3095180">0</span><span class="op" id="3095181">,</span>&nbsp;<span class="num" id="3095183">0</span><span class="op" id="3095184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095191">return</span><br>
<span class="lineno">300</span><span class="op" id="3095198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3095201">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3095278">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="3095313">func</span>&nbsp;<span class="ident" id="3095318">parseGeneralizedTime</span><span class="op" id="3095338">(</span><span class="ident" id="3095339">bytes</span>&nbsp;<span class="op" id="3095345">[</span><span class="op" id="3095346">]</span><span class="builtintype" id="3095347">byte</span><span class="op" id="3095351">)</span>&nbsp;<span class="op" id="3095353">(</span><span class="ident" id="3095354">ret</span>&nbsp;<span class="ident" id="3095358"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3095362">.</span><span class="ident" id="3095363"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3095367">,</span>&nbsp;<span class="ident" id="3095369">err</span>&nbsp;<span class="builtintype" id="3095373">error</span><span class="op" id="3095378">)</span>&nbsp;<span class="op" id="3095380">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095383">return</span>&nbsp;<span class="ident" id="3095390"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3095394">.</span><span class="ident" id="3095395"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="3095400">(</span><span class="string" id="3095401">&#34;20060102150405Z0700&#34;</span><span class="op" id="3095422">,</span>&nbsp;<span class="builtintype" id="3095424">string</span><span class="op" id="3095430">(</span><span class="ident" id="3095431"><a href="/gostd/encoding/asn1/asn1.go.html#3095339">bytes</a></span><span class="op" id="3095436">)</span><span class="op" id="3095437">)</span><br>
<span class="lineno"></span><span class="op" id="3095439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3095442">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3095462">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3095537">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3095562">func</span>&nbsp;<span class="ident" id="3095567">parsePrintableString</span><span class="op" id="3095587">(</span><span class="ident" id="3095588">bytes</span>&nbsp;<span class="op" id="3095594">[</span><span class="op" id="3095595">]</span><span class="builtintype" id="3095596">byte</span><span class="op" id="3095600">)</span>&nbsp;<span class="op" id="3095602">(</span><span class="ident" id="3095603">ret</span>&nbsp;<span class="builtintype" id="3095607">string</span><span class="op" id="3095613">,</span>&nbsp;<span class="ident" id="3095615">err</span>&nbsp;<span class="builtintype" id="3095619">error</span><span class="op" id="3095624">)</span>&nbsp;<span class="op" id="3095626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095629">for</span>&nbsp;<span class="ident" id="3095633">_</span><span class="op" id="3095634">,</span>&nbsp;<span class="ident" id="3095636">b</span>&nbsp;<span class="op" id="3095638">:=</span>&nbsp;<span class="keyword" id="3095641">range</span>&nbsp;<span class="ident" id="3095647"><a href="/gostd/encoding/asn1/asn1.go.html#3095588">bytes</a></span>&nbsp;<span class="op" id="3095653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095657">if</span>&nbsp;<span class="op" id="3095660">!</span><span class="ident" id="3095661"><a href="/gostd/encoding/asn1/asn1.go.html#3095880">isPrintable</a></span><span class="op" id="3095672">(</span><span class="ident" id="3095673"><a href="/gostd/encoding/asn1/asn1.go.html#3095636">b</a></span><span class="op" id="3095674">)</span>&nbsp;<span class="op" id="3095676">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095681"><a href="/gostd/encoding/asn1/asn1.go.html#3095615">err</a></span>&nbsp;<span class="op" id="3095685">=</span>&nbsp;<span class="ident" id="3095687"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3095698">{</span><span class="string" id="3095699">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3095743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095748">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095763"><a href="/gostd/encoding/asn1/asn1.go.html#3095603">ret</a></span>&nbsp;<span class="op" id="3095767">=</span>&nbsp;<span class="builtintype" id="3095769">string</span><span class="op" id="3095775">(</span><span class="ident" id="3095776"><a href="/gostd/encoding/asn1/asn1.go.html#3095588">bytes</a></span><span class="op" id="3095781">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095784">return</span><br>
<span class="lineno"></span><span class="op" id="3095791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3095794">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3095875">func</span>&nbsp;<span class="ident" id="3095880">isPrintable</span><span class="op" id="3095891">(</span><span class="ident" id="3095892">b</span>&nbsp;<span class="builtintype" id="3095894">byte</span><span class="op" id="3095898">)</span>&nbsp;<span class="builtintype" id="3095900">bool</span>&nbsp;<span class="op" id="3095905">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095908">return</span>&nbsp;<span class="string" id="3095915">&#39;a&#39;</span>&nbsp;<span class="op" id="3095919">&lt;=</span>&nbsp;<span class="ident" id="3095922"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095924">&amp;&amp;</span>&nbsp;<span class="ident" id="3095927"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095929">&lt;=</span>&nbsp;<span class="string" id="3095932">&#39;z&#39;</span>&nbsp;<span class="op" id="3095936">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3095941">&#39;A&#39;</span>&nbsp;<span class="op" id="3095945">&lt;=</span>&nbsp;<span class="ident" id="3095948"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095950">&amp;&amp;</span>&nbsp;<span class="ident" id="3095953"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095955">&lt;=</span>&nbsp;<span class="string" id="3095958">&#39;Z&#39;</span>&nbsp;<span class="op" id="3095962">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3095967">&#39;0&#39;</span>&nbsp;<span class="op" id="3095971">&lt;=</span>&nbsp;<span class="ident" id="3095974"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095976">&amp;&amp;</span>&nbsp;<span class="ident" id="3095979"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3095981">&lt;=</span>&nbsp;<span class="string" id="3095984">&#39;9&#39;</span>&nbsp;<span class="op" id="3095988">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3095993">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3095998">&lt;=</span>&nbsp;<span class="ident" id="3096001"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096003">&amp;&amp;</span>&nbsp;<span class="ident" id="3096006"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096008">&lt;=</span>&nbsp;<span class="string" id="3096011">&#39;)&#39;</span>&nbsp;<span class="op" id="3096015">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3096020">&#39;+&#39;</span>&nbsp;<span class="op" id="3096024">&lt;=</span>&nbsp;<span class="ident" id="3096027"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096029">&amp;&amp;</span>&nbsp;<span class="ident" id="3096032"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096034">&lt;=</span>&nbsp;<span class="string" id="3096037">&#39;/&#39;</span>&nbsp;<span class="op" id="3096041">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096046"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096048">==</span>&nbsp;<span class="string" id="3096051">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3096055">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096060"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096062">==</span>&nbsp;<span class="string" id="3096065">&#39;:&#39;</span>&nbsp;<span class="op" id="3096069">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096074"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096076">==</span>&nbsp;<span class="string" id="3096079">&#39;=&#39;</span>&nbsp;<span class="op" id="3096083">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096088"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096090">==</span>&nbsp;<span class="string" id="3096093">&#39;?&#39;</span>&nbsp;<span class="op" id="3096097">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3096102">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3096161">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3096221">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096278"><a href="/gostd/encoding/asn1/asn1.go.html#3095892">b</a></span>&nbsp;<span class="op" id="3096280">==</span>&nbsp;<span class="string" id="3096283">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="3096287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="3096290">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096304">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3096377">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3096407">func</span>&nbsp;<span class="ident" id="3096412">parseIA5String</span><span class="op" id="3096426">(</span><span class="ident" id="3096427">bytes</span>&nbsp;<span class="op" id="3096433">[</span><span class="op" id="3096434">]</span><span class="builtintype" id="3096435">byte</span><span class="op" id="3096439">)</span>&nbsp;<span class="op" id="3096441">(</span><span class="ident" id="3096442">ret</span>&nbsp;<span class="builtintype" id="3096446">string</span><span class="op" id="3096452">,</span>&nbsp;<span class="ident" id="3096454">err</span>&nbsp;<span class="builtintype" id="3096458">error</span><span class="op" id="3096463">)</span>&nbsp;<span class="op" id="3096465">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096468">for</span>&nbsp;<span class="ident" id="3096472">_</span><span class="op" id="3096473">,</span>&nbsp;<span class="ident" id="3096475">b</span>&nbsp;<span class="op" id="3096477">:=</span>&nbsp;<span class="keyword" id="3096480">range</span>&nbsp;<span class="ident" id="3096486"><a href="/gostd/encoding/asn1/asn1.go.html#3096427">bytes</a></span>&nbsp;<span class="op" id="3096492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096496">if</span>&nbsp;<span class="ident" id="3096499"><a href="/gostd/encoding/asn1/asn1.go.html#3096475">b</a></span>&nbsp;<span class="op" id="3096501">&gt;=</span>&nbsp;<span class="num" id="3096504">0x80</span>&nbsp;<span class="op" id="3096509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096514"><a href="/gostd/encoding/asn1/asn1.go.html#3096454">err</a></span>&nbsp;<span class="op" id="3096518">=</span>&nbsp;<span class="ident" id="3096520"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3096531">{</span><span class="string" id="3096532">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3096570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096575">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096584">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096590"><a href="/gostd/encoding/asn1/asn1.go.html#3096442">ret</a></span>&nbsp;<span class="op" id="3096594">=</span>&nbsp;<span class="builtintype" id="3096596">string</span><span class="op" id="3096602">(</span><span class="ident" id="3096603"><a href="/gostd/encoding/asn1/asn1.go.html#3096427">bytes</a></span><span class="op" id="3096608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096611">return</span><br>
<span class="lineno"></span><span class="op" id="3096618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3096621">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096635">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3096714">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3096744">func</span>&nbsp;<span class="ident" id="3096749">parseT61String</span><span class="op" id="3096763">(</span><span class="ident" id="3096764">bytes</span>&nbsp;<span class="op" id="3096770">[</span><span class="op" id="3096771">]</span><span class="builtintype" id="3096772">byte</span><span class="op" id="3096776">)</span>&nbsp;<span class="op" id="3096778">(</span><span class="ident" id="3096779">ret</span>&nbsp;<span class="builtintype" id="3096783">string</span><span class="op" id="3096789">,</span>&nbsp;<span class="ident" id="3096791">err</span>&nbsp;<span class="builtintype" id="3096795">error</span><span class="op" id="3096800">)</span>&nbsp;<span class="op" id="3096802">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096805">return</span>&nbsp;<span class="builtintype" id="3096812">string</span><span class="op" id="3096818">(</span><span class="ident" id="3096819"><a href="/gostd/encoding/asn1/asn1.go.html#3096764">bytes</a></span><span class="op" id="3096824">)</span><span class="op" id="3096825">,</span>&nbsp;<span class="builtintype" id="3096827">nil</span><br>
<span class="lineno"></span><span class="op" id="3096831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096834">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3096849">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3096926">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3096951">func</span>&nbsp;<span class="ident" id="3096956">parseUTF8String</span><span class="op" id="3096971">(</span><span class="ident" id="3096972">bytes</span>&nbsp;<span class="op" id="3096978">[</span><span class="op" id="3096979">]</span><span class="builtintype" id="3096980">byte</span><span class="op" id="3096984">)</span>&nbsp;<span class="op" id="3096986">(</span><span class="ident" id="3096987">ret</span>&nbsp;<span class="builtintype" id="3096991">string</span><span class="op" id="3096997">,</span>&nbsp;<span class="ident" id="3096999">err</span>&nbsp;<span class="builtintype" id="3097003">error</span><span class="op" id="3097008">)</span>&nbsp;<span class="op" id="3097010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097013">return</span>&nbsp;<span class="builtintype" id="3097020">string</span><span class="op" id="3097026">(</span><span class="ident" id="3097027"><a href="/gostd/encoding/asn1/asn1.go.html#3096972">bytes</a></span><span class="op" id="3097032">)</span><span class="op" id="3097033">,</span>&nbsp;<span class="builtintype" id="3097035">nil</span><br>
<span class="lineno"></span><span class="op" id="3097039">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="3097042">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3097094">type</span>&nbsp;<span class="ident" id="3097099">RawValue</span>&nbsp;<span class="keyword" id="3097108">struct</span>&nbsp;<span class="op" id="3097115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097118">Class</span><span class="op" id="3097123">,</span>&nbsp;<span class="ident" id="3097125">Tag</span>&nbsp;<span class="builtintype" id="3097129">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097134">IsCompound</span>&nbsp;<span class="builtintype" id="3097145">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097151">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097162">[</span><span class="op" id="3097163">]</span><span class="builtintype" id="3097164">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097170">FullBytes</span>&nbsp;&nbsp;<span class="op" id="3097181">[</span><span class="op" id="3097182">]</span><span class="builtintype" id="3097183">byte</span>&nbsp;<span class="comment" id="3097188">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="3097219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097222">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="3097295">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3097373">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3097448">type</span>&nbsp;<span class="ident" id="3097453">RawContent</span>&nbsp;<span class="op" id="3097464">[</span><span class="op" id="3097465">]</span><span class="builtintype" id="3097466">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097472">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="3097484">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="3097563">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3097640">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="3097716">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="3097789">func</span>&nbsp;<span class="ident" id="3097794">parseTagAndLength</span><span class="op" id="3097811">(</span><span class="ident" id="3097812">bytes</span>&nbsp;<span class="op" id="3097818">[</span><span class="op" id="3097819">]</span><span class="builtintype" id="3097820">byte</span><span class="op" id="3097824">,</span>&nbsp;<span class="ident" id="3097826">initOffset</span>&nbsp;<span class="builtintype" id="3097837">int</span><span class="op" id="3097840">)</span>&nbsp;<span class="op" id="3097842">(</span><span class="ident" id="3097843">ret</span>&nbsp;<span class="ident" id="3097847"><a href="/gostd/encoding/asn1/common.go.html#3114470">tagAndLength</a></span><span class="op" id="3097859">,</span>&nbsp;<span class="ident" id="3097861">offset</span>&nbsp;<span class="builtintype" id="3097868">int</span><span class="op" id="3097871">,</span>&nbsp;<span class="ident" id="3097873">err</span>&nbsp;<span class="builtintype" id="3097877">error</span><span class="op" id="3097882">)</span>&nbsp;<span class="op" id="3097884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097887"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span>&nbsp;<span class="op" id="3097894">=</span>&nbsp;<span class="ident" id="3097896"><a href="/gostd/encoding/asn1/asn1.go.html#3097826">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097908">b</span>&nbsp;<span class="op" id="3097910">:=</span>&nbsp;<span class="ident" id="3097913"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3097918">[</span><span class="ident" id="3097919"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3097925">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097928"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3097934">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097938"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3097941">.</span><span class="ident" id="3097942"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3097948">=</span>&nbsp;<span class="builtintype" id="3097950">int</span><span class="op" id="3097953">(</span><span class="ident" id="3097954"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3097956">&gt;&gt;</span>&nbsp;<span class="num" id="3097959">6</span><span class="op" id="3097960">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097963"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3097966">.</span><span class="ident" id="3097967"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span>&nbsp;<span class="op" id="3097978">=</span>&nbsp;<span class="ident" id="3097980"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span><span class="op" id="3097981">&amp;</span><span class="num" id="3097982">0x20</span>&nbsp;<span class="op" id="3097987">==</span>&nbsp;<span class="num" id="3097990">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097996"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3097999">.</span><span class="ident" id="3098000"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3098004">=</span>&nbsp;<span class="builtintype" id="3098006">int</span><span class="op" id="3098009">(</span><span class="ident" id="3098010"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3098012">&amp;</span>&nbsp;<span class="num" id="3098014">0x1f</span><span class="op" id="3098018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098022">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098100">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098123">if</span>&nbsp;<span class="ident" id="3098126"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098129">.</span><span class="ident" id="3098130"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3098134">==</span>&nbsp;<span class="num" id="3098137">0x1f</span>&nbsp;<span class="op" id="3098142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098146"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098149">.</span><span class="ident" id="3098150"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span><span class="op" id="3098153">,</span>&nbsp;<span class="ident" id="3098155"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098161">,</span>&nbsp;<span class="ident" id="3098163"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098167">=</span>&nbsp;<span class="ident" id="3098169"><a href="/gostd/encoding/asn1/asn1.go.html#3094403">parseBase128Int</a></span><span class="op" id="3098184">(</span><span class="ident" id="3098185"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3098190">,</span>&nbsp;<span class="ident" id="3098192"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098202">if</span>&nbsp;<span class="ident" id="3098205"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098209">!=</span>&nbsp;<span class="builtintype" id="3098212">nil</span>&nbsp;<span class="op" id="3098216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098221">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098230">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098236">if</span>&nbsp;<span class="ident" id="3098239"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span>&nbsp;<span class="op" id="3098246">&gt;=</span>&nbsp;<span class="builtinfunc" id="3098249">len</span><span class="op" id="3098252">(</span><span class="ident" id="3098253"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3098258">)</span>&nbsp;<span class="op" id="3098260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098264"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098268">=</span>&nbsp;<span class="ident" id="3098270"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3098281">{</span><span class="string" id="3098282">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3098307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098311">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098319">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098322"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3098324">=</span>&nbsp;<span class="ident" id="3098326"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3098331">[</span><span class="ident" id="3098332"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098338">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098341"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098347">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098351">if</span>&nbsp;<span class="ident" id="3098354"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span><span class="op" id="3098355">&amp;</span><span class="num" id="3098356">0x80</span>&nbsp;<span class="op" id="3098361">==</span>&nbsp;<span class="num" id="3098364">0</span>&nbsp;<span class="op" id="3098366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098370">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098419"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098422">.</span><span class="ident" id="3098423"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3098430">=</span>&nbsp;<span class="builtintype" id="3098432">int</span><span class="op" id="3098435">(</span><span class="ident" id="3098436"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3098438">&amp;</span>&nbsp;<span class="num" id="3098440">0x7f</span><span class="op" id="3098444">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098447">}</span>&nbsp;<span class="keyword" id="3098449">else</span>&nbsp;<span class="op" id="3098454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098458">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098520">numBytes</span>&nbsp;<span class="op" id="3098529">:=</span>&nbsp;<span class="builtintype" id="3098532">int</span><span class="op" id="3098535">(</span><span class="ident" id="3098536"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3098538">&amp;</span>&nbsp;<span class="num" id="3098540">0x7f</span><span class="op" id="3098544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098548">if</span>&nbsp;<span class="ident" id="3098551"><a href="/gostd/encoding/asn1/asn1.go.html#3098520">numBytes</a></span>&nbsp;<span class="op" id="3098560">==</span>&nbsp;<span class="num" id="3098563">0</span>&nbsp;<span class="op" id="3098565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098570"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098574">=</span>&nbsp;<span class="ident" id="3098576"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3098587">{</span><span class="string" id="3098588">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="3098623">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098628">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098641"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098644">.</span><span class="ident" id="3098645"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3098652">=</span>&nbsp;<span class="num" id="3098654">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098658">for</span>&nbsp;<span class="ident" id="3098662">i</span>&nbsp;<span class="op" id="3098664">:=</span>&nbsp;<span class="num" id="3098667">0</span><span class="op" id="3098668">;</span>&nbsp;<span class="ident" id="3098670"><a href="/gostd/encoding/asn1/asn1.go.html#3098662">i</a></span>&nbsp;<span class="op" id="3098672">&lt;</span>&nbsp;<span class="ident" id="3098674"><a href="/gostd/encoding/asn1/asn1.go.html#3098520">numBytes</a></span><span class="op" id="3098682">;</span>&nbsp;<span class="ident" id="3098684"><a href="/gostd/encoding/asn1/asn1.go.html#3098662">i</a></span><span class="op" id="3098685">++</span>&nbsp;<span class="op" id="3098688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098693">if</span>&nbsp;<span class="ident" id="3098696"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span>&nbsp;<span class="op" id="3098703">&gt;=</span>&nbsp;<span class="builtinfunc" id="3098706">len</span><span class="op" id="3098709">(</span><span class="ident" id="3098710"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3098715">)</span>&nbsp;<span class="op" id="3098717">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098723"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098727">=</span>&nbsp;<span class="ident" id="3098729"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3098740">{</span><span class="string" id="3098741">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3098766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098772">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098787"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span>&nbsp;<span class="op" id="3098789">=</span>&nbsp;<span class="ident" id="3098791"><a href="/gostd/encoding/asn1/asn1.go.html#3097812">bytes</a></span><span class="op" id="3098796">[</span><span class="ident" id="3098797"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098803">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098808"><a href="/gostd/encoding/asn1/asn1.go.html#3097861">offset</a></span><span class="op" id="3098814">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098820">if</span>&nbsp;<span class="ident" id="3098823"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098826">.</span><span class="ident" id="3098827"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3098834">&gt;=</span>&nbsp;<span class="num" id="3098837">1</span><span class="op" id="3098838">&lt;&lt;</span><span class="num" id="3098840">23</span>&nbsp;<span class="op" id="3098843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098849">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098893">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098913"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3098917">=</span>&nbsp;<span class="ident" id="3098919"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3098934">{</span><span class="string" id="3098935">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="3098953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098959">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098974"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098977">.</span><span class="ident" id="3098978"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3098985">&lt;&lt;=</span>&nbsp;<span class="num" id="3098989">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098994"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3098997">.</span><span class="ident" id="3098998"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3099005">|=</span>&nbsp;<span class="builtintype" id="3099008">int</span><span class="op" id="3099011">(</span><span class="ident" id="3099012"><a href="/gostd/encoding/asn1/asn1.go.html#3097908">b</a></span><span class="op" id="3099013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099018">if</span>&nbsp;<span class="ident" id="3099021"><a href="/gostd/encoding/asn1/asn1.go.html#3097843">ret</a></span><span class="op" id="3099024">.</span><span class="ident" id="3099025"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3099032">==</span>&nbsp;<span class="num" id="3099035">0</span>&nbsp;<span class="op" id="3099037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099043">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099088"><a href="/gostd/encoding/asn1/asn1.go.html#3097873">err</a></span>&nbsp;<span class="op" id="3099092">=</span>&nbsp;<span class="ident" id="3099094"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3099109">{</span><span class="string" id="3099110">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="3099147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099153">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099170">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099174">return</span><br>
<span class="lineno"></span><span class="op" id="3099181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099184">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="3099264">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3099340">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3099381">func</span>&nbsp;<span class="ident" id="3099386">parseSequenceOf</span><span class="op" id="3099401">(</span><span class="ident" id="3099402">bytes</span>&nbsp;<span class="op" id="3099408">[</span><span class="op" id="3099409">]</span><span class="builtintype" id="3099410">byte</span><span class="op" id="3099414">,</span>&nbsp;<span class="ident" id="3099416">sliceType</span>&nbsp;<span class="ident" id="3099426"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3099433">.</span><span class="ident" id="3099434"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="3099438">,</span>&nbsp;<span class="ident" id="3099440">elemType</span>&nbsp;<span class="ident" id="3099449"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3099456">.</span><span class="ident" id="3099457"><a href="/gostd/reflect/type.go.html#2781467">Type</a></span><span class="op" id="3099461">)</span>&nbsp;<span class="op" id="3099463">(</span><span class="ident" id="3099464">ret</span>&nbsp;<span class="ident" id="3099468"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3099475">.</span><span class="ident" id="3099476"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3099481">,</span>&nbsp;<span class="ident" id="3099483">err</span>&nbsp;<span class="builtintype" id="3099487">error</span><span class="op" id="3099492">)</span>&nbsp;<span class="op" id="3099494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099497">expectedTag</span><span class="op" id="3099508">,</span>&nbsp;<span class="ident" id="3099510">compoundType</span><span class="op" id="3099522">,</span>&nbsp;<span class="ident" id="3099524">ok</span>&nbsp;<span class="op" id="3099527">:=</span>&nbsp;<span class="ident" id="3099530"><a href="/gostd/encoding/asn1/common.go.html#3117431">getUniversalType</a></span><span class="op" id="3099546">(</span><span class="ident" id="3099547"><a href="/gostd/encoding/asn1/asn1.go.html#3099440">elemType</a></span><span class="op" id="3099555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099558">if</span>&nbsp;<span class="op" id="3099561">!</span><span class="ident" id="3099562"><a href="/gostd/encoding/asn1/asn1.go.html#3099524">ok</a></span>&nbsp;<span class="op" id="3099565">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099569"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3099573">=</span>&nbsp;<span class="ident" id="3099575"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3099590">{</span><span class="string" id="3099591">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="3099618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099622">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099634">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099704">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099758">numElements</span>&nbsp;<span class="op" id="3099770">:=</span>&nbsp;<span class="num" id="3099773">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099776">for</span>&nbsp;<span class="ident" id="3099780">offset</span>&nbsp;<span class="op" id="3099787">:=</span>&nbsp;<span class="num" id="3099790">0</span><span class="op" id="3099791">;</span>&nbsp;<span class="ident" id="3099793"><a href="/gostd/encoding/asn1/asn1.go.html#3099780">offset</a></span>&nbsp;<span class="op" id="3099800">&lt;</span>&nbsp;<span class="builtinfunc" id="3099802">len</span><span class="op" id="3099805">(</span><span class="ident" id="3099806"><a href="/gostd/encoding/asn1/asn1.go.html#3099402">bytes</a></span><span class="op" id="3099811">)</span><span class="op" id="3099812">;</span>&nbsp;<span class="op" id="3099814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099818">var</span>&nbsp;<span class="ident" id="3099822">t</span>&nbsp;<span class="ident" id="3099824"><a href="/gostd/encoding/asn1/common.go.html#3114470">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099839"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3099840">,</span>&nbsp;<span class="ident" id="3099842"><a href="/gostd/encoding/asn1/asn1.go.html#3099780">offset</a></span><span class="op" id="3099848">,</span>&nbsp;<span class="ident" id="3099850"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3099854">=</span>&nbsp;<span class="ident" id="3099856"><a href="/gostd/encoding/asn1/asn1.go.html#3097794">parseTagAndLength</a></span><span class="op" id="3099873">(</span><span class="ident" id="3099874"><a href="/gostd/encoding/asn1/asn1.go.html#3099402">bytes</a></span><span class="op" id="3099879">,</span>&nbsp;<span class="ident" id="3099881"><a href="/gostd/encoding/asn1/asn1.go.html#3099780">offset</a></span><span class="op" id="3099887">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099891">if</span>&nbsp;<span class="ident" id="3099894"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3099898">!=</span>&nbsp;<span class="builtintype" id="3099901">nil</span>&nbsp;<span class="op" id="3099905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099910">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099923">switch</span>&nbsp;<span class="ident" id="3099930"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3099931">.</span><span class="ident" id="3099932"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3099936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099940">case</span>&nbsp;<span class="ident" id="3099945"><a href="/gostd/encoding/asn1/common.go.html#3114248">tagIA5String</a></span><span class="op" id="3099957">,</span>&nbsp;<span class="ident" id="3099959"><a href="/gostd/encoding/asn1/common.go.html#3114323">tagGeneralString</a></span><span class="op" id="3099975">,</span>&nbsp;<span class="ident" id="3099977"><a href="/gostd/encoding/asn1/common.go.html#3114223">tagT61String</a></span><span class="op" id="3099989">,</span>&nbsp;<span class="ident" id="3099991"><a href="/gostd/encoding/asn1/common.go.html#3114123">tagUTF8String</a></span><span class="op" id="3100004">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100009">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100062">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100120">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100150"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100151">.</span><span class="ident" id="3100152"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3100156">=</span>&nbsp;<span class="ident" id="3100158"><a href="/gostd/encoding/asn1/common.go.html#3114198">tagPrintableString</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100179">case</span>&nbsp;<span class="ident" id="3100184"><a href="/gostd/encoding/asn1/common.go.html#3114298">tagGeneralizedTime</a></span><span class="op" id="3100202">,</span>&nbsp;<span class="ident" id="3100204"><a href="/gostd/encoding/asn1/common.go.html#3114273">tagUTCTime</a></span><span class="op" id="3100214">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100219">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100273"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100274">.</span><span class="ident" id="3100275"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3100279">=</span>&nbsp;<span class="ident" id="3100281"><a href="/gostd/encoding/asn1/common.go.html#3114273">tagUTCTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100299">if</span>&nbsp;<span class="ident" id="3100302"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100303">.</span><span class="ident" id="3100304"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3100310">!=</span>&nbsp;<span class="ident" id="3100313"><a href="/gostd/encoding/asn1/common.go.html#3114359">classUniversal</a></span>&nbsp;<span class="op" id="3100328">||</span>&nbsp;<span class="ident" id="3100331"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100332">.</span><span class="ident" id="3100333"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span>&nbsp;<span class="op" id="3100344">!=</span>&nbsp;<span class="ident" id="3100347"><a href="/gostd/encoding/asn1/asn1.go.html#3099510">compoundType</a></span>&nbsp;<span class="op" id="3100360">||</span>&nbsp;<span class="ident" id="3100363"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100364">.</span><span class="ident" id="3100365"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3100369">!=</span>&nbsp;<span class="ident" id="3100372"><a href="/gostd/encoding/asn1/asn1.go.html#3099497">expectedTag</a></span>&nbsp;<span class="op" id="3100384">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100389"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3100393">=</span>&nbsp;<span class="ident" id="3100395"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3100410">{</span><span class="string" id="3100411">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="3100434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100452">if</span>&nbsp;<span class="ident" id="3100455"><a href="/gostd/encoding/asn1/asn1.go.html#3101394">invalidLength</a></span><span class="op" id="3100468">(</span><span class="ident" id="3100469"><a href="/gostd/encoding/asn1/asn1.go.html#3099780">offset</a></span><span class="op" id="3100475">,</span>&nbsp;<span class="ident" id="3100477"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100478">.</span><span class="ident" id="3100479"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3100485">,</span>&nbsp;<span class="builtinfunc" id="3100487">len</span><span class="op" id="3100490">(</span><span class="ident" id="3100491"><a href="/gostd/encoding/asn1/asn1.go.html#3099402">bytes</a></span><span class="op" id="3100496">)</span><span class="op" id="3100497">)</span>&nbsp;<span class="op" id="3100499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100504"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3100508">=</span>&nbsp;<span class="ident" id="3100510"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3100521">{</span><span class="string" id="3100522">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="3100542">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100547">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100560"><a href="/gostd/encoding/asn1/asn1.go.html#3099780">offset</a></span>&nbsp;<span class="op" id="3100567">+=</span>&nbsp;<span class="ident" id="3100570"><a href="/gostd/encoding/asn1/asn1.go.html#3099822">t</a></span><span class="op" id="3100571">.</span><span class="ident" id="3100572"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100581"><a href="/gostd/encoding/asn1/asn1.go.html#3099758">numElements</a></span><span class="op" id="3100592">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100596">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100599"><a href="/gostd/encoding/asn1/asn1.go.html#3099464">ret</a></span>&nbsp;<span class="op" id="3100603">=</span>&nbsp;<span class="ident" id="3100605"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3100612">.</span><span class="ident" id="3100613"><a href="/gostd/reflect/value.go.html#2891043">MakeSlice</a></span><span class="op" id="3100622">(</span><span class="ident" id="3100623"><a href="/gostd/encoding/asn1/asn1.go.html#3099416">sliceType</a></span><span class="op" id="3100632">,</span>&nbsp;<span class="ident" id="3100634"><a href="/gostd/encoding/asn1/asn1.go.html#3099758">numElements</a></span><span class="op" id="3100645">,</span>&nbsp;<span class="ident" id="3100647"><a href="/gostd/encoding/asn1/asn1.go.html#3099758">numElements</a></span><span class="op" id="3100658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100661">params</span>&nbsp;<span class="op" id="3100668">:=</span>&nbsp;<span class="ident" id="3100671"><a href="/gostd/encoding/asn1/common.go.html#3115529">fieldParameters</a></span><span class="op" id="3100686">{</span><span class="op" id="3100687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100690">offset</span>&nbsp;<span class="op" id="3100697">:=</span>&nbsp;<span class="num" id="3100700">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100703">for</span>&nbsp;<span class="ident" id="3100707">i</span>&nbsp;<span class="op" id="3100709">:=</span>&nbsp;<span class="num" id="3100712">0</span><span class="op" id="3100713">;</span>&nbsp;<span class="ident" id="3100715"><a href="/gostd/encoding/asn1/asn1.go.html#3100707">i</a></span>&nbsp;<span class="op" id="3100717">&lt;</span>&nbsp;<span class="ident" id="3100719"><a href="/gostd/encoding/asn1/asn1.go.html#3099758">numElements</a></span><span class="op" id="3100730">;</span>&nbsp;<span class="ident" id="3100732"><a href="/gostd/encoding/asn1/asn1.go.html#3100707">i</a></span><span class="op" id="3100733">++</span>&nbsp;<span class="op" id="3100736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100740"><a href="/gostd/encoding/asn1/asn1.go.html#3100690">offset</a></span><span class="op" id="3100746">,</span>&nbsp;<span class="ident" id="3100748"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3100752">=</span>&nbsp;<span class="ident" id="3100754"><a href="/gostd/encoding/asn1/asn1.go.html#3101698">parseField</a></span><span class="op" id="3100764">(</span><span class="ident" id="3100765"><a href="/gostd/encoding/asn1/asn1.go.html#3099464">ret</a></span><span class="op" id="3100768">.</span><span class="ident" id="3100769"><a href="/gostd/reflect/value.go.html#2856377">Index</a></span><span class="op" id="3100774">(</span><span class="ident" id="3100775"><a href="/gostd/encoding/asn1/asn1.go.html#3100707">i</a></span><span class="op" id="3100776">)</span><span class="op" id="3100777">,</span>&nbsp;<span class="ident" id="3100779"><a href="/gostd/encoding/asn1/asn1.go.html#3099402">bytes</a></span><span class="op" id="3100784">,</span>&nbsp;<span class="ident" id="3100786"><a href="/gostd/encoding/asn1/asn1.go.html#3100690">offset</a></span><span class="op" id="3100792">,</span>&nbsp;<span class="ident" id="3100794"><a href="/gostd/encoding/asn1/asn1.go.html#3100661">params</a></span><span class="op" id="3100800">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100804">if</span>&nbsp;<span class="ident" id="3100807"><a href="/gostd/encoding/asn1/asn1.go.html#3099483">err</a></span>&nbsp;<span class="op" id="3100811">!=</span>&nbsp;<span class="builtintype" id="3100814">nil</span>&nbsp;<span class="op" id="3100818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100823">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100838">return</span><br>
<span class="lineno">500</span><span class="op" id="3100845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100848">var</span>&nbsp;<span class="op" id="3100852">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100855">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100876">=</span>&nbsp;<span class="ident" id="3100878"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3100885">.</span><span class="ident" id="3100886"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3100892">(</span><span class="ident" id="3100893"><a href="/gostd/encoding/asn1/asn1.go.html#3091159">BitString</a></span><span class="op" id="3100902">{</span><span class="op" id="3100903">}</span><span class="op" id="3100904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100907">objectIdentifierType</span>&nbsp;<span class="op" id="3100928">=</span>&nbsp;<span class="ident" id="3100930"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3100937">.</span><span class="ident" id="3100938"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3100944">(</span><span class="ident" id="3100945"><a href="/gostd/encoding/asn1/asn1.go.html#3092558">ObjectIdentifier</a></span><span class="op" id="3100961">{</span><span class="op" id="3100962">}</span><span class="op" id="3100963">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100966">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100987">=</span>&nbsp;<span class="ident" id="3100989"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3100996">.</span><span class="ident" id="3100997"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101003">(</span><span class="ident" id="3101004"><a href="/gostd/encoding/asn1/asn1.go.html#3094159">Enumerated</a></span><span class="op" id="3101014">(</span><span class="num" id="3101015">0</span><span class="op" id="3101016">)</span><span class="op" id="3101017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101020">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101041">=</span>&nbsp;<span class="ident" id="3101043"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101050">.</span><span class="ident" id="3101051"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101057">(</span><span class="ident" id="3101058"><a href="/gostd/encoding/asn1/asn1.go.html#3094247">Flag</a></span><span class="op" id="3101062">(</span><span class="builtintype" id="3101063">false</span><span class="op" id="3101068">)</span><span class="op" id="3101069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101072">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101093">=</span>&nbsp;<span class="ident" id="3101095"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101102">.</span><span class="ident" id="3101103"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101109">(</span><span class="ident" id="3101110"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3101114">.</span><span class="ident" id="3101115"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="3101119">{</span><span class="op" id="3101120">}</span><span class="op" id="3101121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101124">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101145">=</span>&nbsp;<span class="ident" id="3101147"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101154">.</span><span class="ident" id="3101155"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101161">(</span><span class="ident" id="3101162"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="3101170">{</span><span class="op" id="3101171">}</span><span class="op" id="3101172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101175">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101196">=</span>&nbsp;<span class="ident" id="3101198"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101205">.</span><span class="ident" id="3101206"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101212">(</span><span class="ident" id="3101213"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><span class="op" id="3101223">(</span><span class="builtintype" id="3101224">nil</span><span class="op" id="3101227">)</span><span class="op" id="3101228">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101231">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101252">=</span>&nbsp;<span class="ident" id="3101254"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101261">.</span><span class="ident" id="3101262"><a href="/gostd/reflect/type.go.html#2808718">TypeOf</a></span><span class="op" id="3101268">(</span><span class="builtinfunc" id="3101269">new</span><span class="op" id="3101272">(</span><span class="ident" id="3101273"><a href="/gostd/encoding/asn1/asn1.go.html#3088600">big</a></span><span class="op" id="3101276">.</span><span class="ident" id="3101277"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="3101280">)</span><span class="op" id="3101281">)</span><br>
<span class="lineno"></span><span class="op" id="3101283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101286">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3101361">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="3101389">func</span>&nbsp;<span class="ident" id="3101394">invalidLength</span><span class="op" id="3101407">(</span><span class="ident" id="3101408">offset</span><span class="op" id="3101414">,</span>&nbsp;<span class="ident" id="3101416">length</span><span class="op" id="3101422">,</span>&nbsp;<span class="ident" id="3101424">sliceLength</span>&nbsp;<span class="builtintype" id="3101436">int</span><span class="op" id="3101439">)</span>&nbsp;<span class="builtintype" id="3101441">bool</span>&nbsp;<span class="op" id="3101446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101449">return</span>&nbsp;<span class="ident" id="3101456"><a href="/gostd/encoding/asn1/asn1.go.html#3101408">offset</a></span><span class="op" id="3101462">+</span><span class="ident" id="3101463"><a href="/gostd/encoding/asn1/asn1.go.html#3101416">length</a></span>&nbsp;<span class="op" id="3101470">&lt;</span>&nbsp;<span class="ident" id="3101472"><a href="/gostd/encoding/asn1/asn1.go.html#3101408">offset</a></span>&nbsp;<span class="op" id="3101479">||</span>&nbsp;<span class="ident" id="3101482"><a href="/gostd/encoding/asn1/asn1.go.html#3101408">offset</a></span><span class="op" id="3101488">+</span><span class="ident" id="3101489"><a href="/gostd/encoding/asn1/asn1.go.html#3101416">length</a></span>&nbsp;<span class="op" id="3101496">&gt;</span>&nbsp;<span class="ident" id="3101498"><a href="/gostd/encoding/asn1/asn1.go.html#3101424">sliceLength</a></span><br>
<span class="lineno"></span><span class="op" id="3101510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101513">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="3101590">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3101670">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3101693">func</span>&nbsp;<span class="ident" id="3101698">parseField</span><span class="op" id="3101708">(</span><span class="ident" id="3101709">v</span>&nbsp;<span class="ident" id="3101711"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3101718">.</span><span class="ident" id="3101719"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3101724">,</span>&nbsp;<span class="ident" id="3101726">bytes</span>&nbsp;<span class="op" id="3101732">[</span><span class="op" id="3101733">]</span><span class="builtintype" id="3101734">byte</span><span class="op" id="3101738">,</span>&nbsp;<span class="ident" id="3101740">initOffset</span>&nbsp;<span class="builtintype" id="3101751">int</span><span class="op" id="3101754">,</span>&nbsp;<span class="ident" id="3101756">params</span>&nbsp;<span class="ident" id="3101763"><a href="/gostd/encoding/asn1/common.go.html#3115529">fieldParameters</a></span><span class="op" id="3101778">)</span>&nbsp;<span class="op" id="3101780">(</span><span class="ident" id="3101781">offset</span>&nbsp;<span class="builtintype" id="3101788">int</span><span class="op" id="3101791">,</span>&nbsp;<span class="ident" id="3101793">err</span>&nbsp;<span class="builtintype" id="3101797">error</span><span class="op" id="3101802">)</span>&nbsp;<span class="op" id="3101804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101807"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3101814">=</span>&nbsp;<span class="ident" id="3101816"><a href="/gostd/encoding/asn1/asn1.go.html#3101740">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101828">fieldType</span>&nbsp;<span class="op" id="3101838">:=</span>&nbsp;<span class="ident" id="3101841"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3101842">.</span><span class="ident" id="3101843"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="3101847">(</span><span class="op" id="3101848">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3101852">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101939">if</span>&nbsp;<span class="ident" id="3101942"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3101949">==</span>&nbsp;<span class="builtinfunc" id="3101952">len</span><span class="op" id="3101955">(</span><span class="ident" id="3101956"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3101961">)</span>&nbsp;<span class="op" id="3101963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101967">if</span>&nbsp;<span class="op" id="3101970">!</span><span class="ident" id="3101971"><a href="/gostd/encoding/asn1/asn1.go.html#3110534">setDefaultValue</a></span><span class="op" id="3101986">(</span><span class="ident" id="3101987"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3101988">,</span>&nbsp;<span class="ident" id="3101990"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3101996">)</span>&nbsp;<span class="op" id="3101998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102003"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102007">=</span>&nbsp;<span class="ident" id="3102009"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3102020">{</span><span class="string" id="3102021">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="3102041">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102049">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3102061">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102087">if</span>&nbsp;<span class="ident" id="3102090"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span>&nbsp;<span class="op" id="3102100">==</span>&nbsp;<span class="ident" id="3102103"><a href="/gostd/encoding/asn1/asn1.go.html#3101124">rawValueType</a></span>&nbsp;<span class="op" id="3102116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102120">var</span>&nbsp;<span class="ident" id="3102124">t</span>&nbsp;<span class="ident" id="3102126"><a href="/gostd/encoding/asn1/common.go.html#3114470">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102141"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102142">,</span>&nbsp;<span class="ident" id="3102144"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102150">,</span>&nbsp;<span class="ident" id="3102152"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102156">=</span>&nbsp;<span class="ident" id="3102158"><a href="/gostd/encoding/asn1/asn1.go.html#3097794">parseTagAndLength</a></span><span class="op" id="3102175">(</span><span class="ident" id="3102176"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102181">,</span>&nbsp;<span class="ident" id="3102183"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102193">if</span>&nbsp;<span class="ident" id="3102196"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102200">!=</span>&nbsp;<span class="builtintype" id="3102203">nil</span>&nbsp;<span class="op" id="3102207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102212">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102225">if</span>&nbsp;<span class="ident" id="3102228"><a href="/gostd/encoding/asn1/asn1.go.html#3101394">invalidLength</a></span><span class="op" id="3102241">(</span><span class="ident" id="3102242"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102248">,</span>&nbsp;<span class="ident" id="3102250"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102251">.</span><span class="ident" id="3102252"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3102258">,</span>&nbsp;<span class="builtinfunc" id="3102260">len</span><span class="op" id="3102263">(</span><span class="ident" id="3102264"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102269">)</span><span class="op" id="3102270">)</span>&nbsp;<span class="op" id="3102272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102277"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102281">=</span>&nbsp;<span class="ident" id="3102283"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3102294">{</span><span class="string" id="3102295">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3102311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102316">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102325">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102329">result</span>&nbsp;<span class="op" id="3102336">:=</span>&nbsp;<span class="ident" id="3102339"><a href="/gostd/encoding/asn1/asn1.go.html#3097099">RawValue</a></span><span class="op" id="3102347">{</span><span class="ident" id="3102348"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102349">.</span><span class="ident" id="3102350"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span><span class="op" id="3102355">,</span>&nbsp;<span class="ident" id="3102357"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102358">.</span><span class="ident" id="3102359"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span><span class="op" id="3102362">,</span>&nbsp;<span class="ident" id="3102364"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102365">.</span><span class="ident" id="3102366"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span><span class="op" id="3102376">,</span>&nbsp;<span class="ident" id="3102378"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102383">[</span><span class="ident" id="3102384"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3102391">:</span>&nbsp;<span class="ident" id="3102393"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102399">+</span><span class="ident" id="3102400"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102401">.</span><span class="ident" id="3102402"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3102408">]</span><span class="op" id="3102409">,</span>&nbsp;<span class="ident" id="3102411"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102416">[</span><span class="ident" id="3102417"><a href="/gostd/encoding/asn1/asn1.go.html#3101740">initOffset</a></span>&nbsp;<span class="op" id="3102428">:</span>&nbsp;<span class="ident" id="3102430"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102436">+</span><span class="ident" id="3102437"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102438">.</span><span class="ident" id="3102439"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3102445">]</span><span class="op" id="3102446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102450"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3102457">+=</span>&nbsp;<span class="ident" id="3102460"><a href="/gostd/encoding/asn1/asn1.go.html#3102124">t</a></span><span class="op" id="3102461">.</span><span class="ident" id="3102462"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102471"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3102472">.</span><span class="ident" id="3102473"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3102476">(</span><span class="ident" id="3102477"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3102484">.</span><span class="ident" id="3102485"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3102492">(</span><span class="ident" id="3102493"><a href="/gostd/encoding/asn1/asn1.go.html#3102329">result</a></span><span class="op" id="3102499">)</span><span class="op" id="3102500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102504">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102512">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3102516">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102544">if</span>&nbsp;<span class="ident" id="3102547">ifaceType</span>&nbsp;<span class="op" id="3102557">:=</span>&nbsp;<span class="ident" id="3102560"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><span class="op" id="3102569">;</span>&nbsp;<span class="ident" id="3102571"><a href="/gostd/encoding/asn1/asn1.go.html#3102547">ifaceType</a></span><span class="op" id="3102580">.</span><span class="ident" id="3102581"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="3102585">(</span><span class="op" id="3102586">)</span>&nbsp;<span class="op" id="3102588">==</span>&nbsp;<span class="ident" id="3102591"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3102598">.</span><span class="ident" id="3102599"><a href="/gostd/reflect/type.go.html#2788041">Interface</a></span>&nbsp;<span class="op" id="3102609">&amp;&amp;</span>&nbsp;<span class="ident" id="3102612"><a href="/gostd/encoding/asn1/asn1.go.html#3102547">ifaceType</a></span><span class="op" id="3102621">.</span><span class="ident" id="3102622"><a href="/gostd/reflect/type.go.html#2782716">NumMethod</a></span><span class="op" id="3102631">(</span><span class="op" id="3102632">)</span>&nbsp;<span class="op" id="3102634">==</span>&nbsp;<span class="num" id="3102637">0</span>&nbsp;<span class="op" id="3102639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102643">var</span>&nbsp;<span class="ident" id="3102647">t</span>&nbsp;<span class="ident" id="3102649"><a href="/gostd/encoding/asn1/common.go.html#3114470">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102664"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102665">,</span>&nbsp;<span class="ident" id="3102667"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102673">,</span>&nbsp;<span class="ident" id="3102675"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102679">=</span>&nbsp;<span class="ident" id="3102681"><a href="/gostd/encoding/asn1/asn1.go.html#3097794">parseTagAndLength</a></span><span class="op" id="3102698">(</span><span class="ident" id="3102699"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102704">,</span>&nbsp;<span class="ident" id="3102706"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102712">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102716">if</span>&nbsp;<span class="ident" id="3102719"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102723">!=</span>&nbsp;<span class="builtintype" id="3102726">nil</span>&nbsp;<span class="op" id="3102730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102735">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102748">if</span>&nbsp;<span class="ident" id="3102751"><a href="/gostd/encoding/asn1/asn1.go.html#3101394">invalidLength</a></span><span class="op" id="3102764">(</span><span class="ident" id="3102765"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102771">,</span>&nbsp;<span class="ident" id="3102773"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102774">.</span><span class="ident" id="3102775"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3102781">,</span>&nbsp;<span class="builtinfunc" id="3102783">len</span><span class="op" id="3102786">(</span><span class="ident" id="3102787"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102792">)</span><span class="op" id="3102793">)</span>&nbsp;<span class="op" id="3102795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102800"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3102804">=</span>&nbsp;<span class="ident" id="3102806"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3102817">{</span><span class="string" id="3102818">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3102834">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102839">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102852">var</span>&nbsp;<span class="ident" id="3102856">result</span>&nbsp;<span class="keyword" id="3102863">interface</span><span class="op" id="3102872">{</span><span class="op" id="3102873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102877">if</span>&nbsp;<span class="op" id="3102880">!</span><span class="ident" id="3102881"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102882">.</span><span class="ident" id="3102883"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span>&nbsp;<span class="op" id="3102894">&amp;&amp;</span>&nbsp;<span class="ident" id="3102897"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102898">.</span><span class="ident" id="3102899"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3102905">==</span>&nbsp;<span class="ident" id="3102908"><a href="/gostd/encoding/asn1/common.go.html#3114359">classUniversal</a></span>&nbsp;<span class="op" id="3102923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102928">innerBytes</span>&nbsp;<span class="op" id="3102939">:=</span>&nbsp;<span class="ident" id="3102942"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3102947">[</span><span class="ident" id="3102948"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3102955">:</span>&nbsp;<span class="ident" id="3102957"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3102963">+</span><span class="ident" id="3102964"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102965">.</span><span class="ident" id="3102966"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3102972">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102977">switch</span>&nbsp;<span class="ident" id="3102984"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3102985">.</span><span class="ident" id="3102986"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3102990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102995">case</span>&nbsp;<span class="ident" id="3103000"><a href="/gostd/encoding/asn1/common.go.html#3114198">tagPrintableString</a></span><span class="op" id="3103018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103024"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103030">,</span>&nbsp;<span class="ident" id="3103032"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103036">=</span>&nbsp;<span class="ident" id="3103038"><a href="/gostd/encoding/asn1/asn1.go.html#3095567">parsePrintableString</a></span><span class="op" id="3103058">(</span><span class="ident" id="3103059"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103074">case</span>&nbsp;<span class="ident" id="3103079"><a href="/gostd/encoding/asn1/common.go.html#3114248">tagIA5String</a></span><span class="op" id="3103091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103097"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103103">,</span>&nbsp;<span class="ident" id="3103105"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103109">=</span>&nbsp;<span class="ident" id="3103111"><a href="/gostd/encoding/asn1/asn1.go.html#3096412">parseIA5String</a></span><span class="op" id="3103125">(</span><span class="ident" id="3103126"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103136">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103141">case</span>&nbsp;<span class="ident" id="3103146"><a href="/gostd/encoding/asn1/common.go.html#3114223">tagT61String</a></span><span class="op" id="3103158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103164"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103170">,</span>&nbsp;<span class="ident" id="3103172"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103176">=</span>&nbsp;<span class="ident" id="3103178"><a href="/gostd/encoding/asn1/asn1.go.html#3096749">parseT61String</a></span><span class="op" id="3103192">(</span><span class="ident" id="3103193"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103208">case</span>&nbsp;<span class="ident" id="3103213"><a href="/gostd/encoding/asn1/common.go.html#3114123">tagUTF8String</a></span><span class="op" id="3103226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103232"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103238">,</span>&nbsp;<span class="ident" id="3103240"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103244">=</span>&nbsp;<span class="ident" id="3103246"><a href="/gostd/encoding/asn1/asn1.go.html#3096956">parseUTF8String</a></span><span class="op" id="3103261">(</span><span class="ident" id="3103262"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103277">case</span>&nbsp;<span class="ident" id="3103282"><a href="/gostd/encoding/asn1/common.go.html#3114002">tagInteger</a></span><span class="op" id="3103292">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103298"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103304">,</span>&nbsp;<span class="ident" id="3103306"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103310">=</span>&nbsp;<span class="ident" id="3103312"><a href="/gostd/encoding/asn1/asn1.go.html#3089710">parseInt64</a></span><span class="op" id="3103322">(</span><span class="ident" id="3103323"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103338">case</span>&nbsp;<span class="ident" id="3103343"><a href="/gostd/encoding/asn1/common.go.html#3114026">tagBitString</a></span><span class="op" id="3103355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103361"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103367">,</span>&nbsp;<span class="ident" id="3103369"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103373">=</span>&nbsp;<span class="ident" id="3103375"><a href="/gostd/encoding/asn1/asn1.go.html#3092039">parseBitString</a></span><span class="op" id="3103389">(</span><span class="ident" id="3103390"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103405">case</span>&nbsp;<span class="ident" id="3103410"><a href="/gostd/encoding/asn1/common.go.html#3114074">tagOID</a></span><span class="op" id="3103416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103422"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103428">,</span>&nbsp;<span class="ident" id="3103430"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103434">=</span>&nbsp;<span class="ident" id="3103436"><a href="/gostd/encoding/asn1/asn1.go.html#3093209">parseObjectIdentifier</a></span><span class="op" id="3103457">(</span><span class="ident" id="3103458"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103468">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103473">case</span>&nbsp;<span class="ident" id="3103478"><a href="/gostd/encoding/asn1/common.go.html#3114273">tagUTCTime</a></span><span class="op" id="3103488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103494"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103500">,</span>&nbsp;<span class="ident" id="3103502"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103506">=</span>&nbsp;<span class="ident" id="3103508"><a href="/gostd/encoding/asn1/asn1.go.html#3094821">parseUTCTime</a></span><span class="op" id="3103520">(</span><span class="ident" id="3103521"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><span class="op" id="3103531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103536">case</span>&nbsp;<span class="ident" id="3103541"><a href="/gostd/encoding/asn1/common.go.html#3114050">tagOctetString</a></span><span class="op" id="3103555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103561"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span>&nbsp;<span class="op" id="3103568">=</span>&nbsp;<span class="ident" id="3103570"><a href="/gostd/encoding/asn1/asn1.go.html#3102928">innerBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103584">default</span><span class="op" id="3103591">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103597">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103680"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3103687">+=</span>&nbsp;<span class="ident" id="3103690"><a href="/gostd/encoding/asn1/asn1.go.html#3102647">t</a></span><span class="op" id="3103691">.</span><span class="ident" id="3103692"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103701">if</span>&nbsp;<span class="ident" id="3103704"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103708">!=</span>&nbsp;<span class="builtintype" id="3103711">nil</span>&nbsp;<span class="op" id="3103715">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103720">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103733">if</span>&nbsp;<span class="ident" id="3103736"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span>&nbsp;<span class="op" id="3103743">!=</span>&nbsp;<span class="builtintype" id="3103746">nil</span>&nbsp;<span class="op" id="3103750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103755"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3103756">.</span><span class="ident" id="3103757"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3103760">(</span><span class="ident" id="3103761"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3103768">.</span><span class="ident" id="3103769"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3103776">(</span><span class="ident" id="3103777"><a href="/gostd/encoding/asn1/asn1.go.html#3102856">result</a></span><span class="op" id="3103783">)</span><span class="op" id="3103784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103788">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103792">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103803">universalTag</span><span class="op" id="3103815">,</span>&nbsp;<span class="ident" id="3103817">compoundType</span><span class="op" id="3103829">,</span>&nbsp;<span class="ident" id="3103831">ok1</span>&nbsp;<span class="op" id="3103835">:=</span>&nbsp;<span class="ident" id="3103838"><a href="/gostd/encoding/asn1/common.go.html#3117431">getUniversalType</a></span><span class="op" id="3103854">(</span><span class="ident" id="3103855"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><span class="op" id="3103864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103867">if</span>&nbsp;<span class="op" id="3103870">!</span><span class="ident" id="3103871"><a href="/gostd/encoding/asn1/asn1.go.html#3103831">ok1</a></span>&nbsp;<span class="op" id="3103875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103879"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103883">=</span>&nbsp;<span class="ident" id="3103885"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3103900">{</span><span class="ident" id="3103901"><a href="/gostd/encoding/asn1/asn1.go.html#3088593">fmt</a></span><span class="op" id="3103904">.</span><span class="ident" id="3103905"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3103912">(</span><span class="string" id="3103913">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="3103934">,</span>&nbsp;<span class="ident" id="3103936"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><span class="op" id="3103945">)</span><span class="op" id="3103946">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103950">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103962">t</span><span class="op" id="3103963">,</span>&nbsp;<span class="ident" id="3103965"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3103971">,</span>&nbsp;<span class="ident" id="3103973"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3103977">:=</span>&nbsp;<span class="ident" id="3103980"><a href="/gostd/encoding/asn1/asn1.go.html#3097794">parseTagAndLength</a></span><span class="op" id="3103997">(</span><span class="ident" id="3103998"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3104003">,</span>&nbsp;<span class="ident" id="3104005"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3104011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104014">if</span>&nbsp;<span class="ident" id="3104017"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3104021">!=</span>&nbsp;<span class="builtintype" id="3104024">nil</span>&nbsp;<span class="op" id="3104028">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104032">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104043">if</span>&nbsp;<span class="ident" id="3104046"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3104052">.</span><span class="ident" id="3104053"><a href="/gostd/encoding/asn1/common.go.html#3115610">explicit</a></span>&nbsp;<span class="op" id="3104062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104066">expectedClass</span>&nbsp;<span class="op" id="3104080">:=</span>&nbsp;<span class="ident" id="3104083"><a href="/gostd/encoding/asn1/common.go.html#3114411">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104106">if</span>&nbsp;<span class="ident" id="3104109"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3104115">.</span><span class="ident" id="3104116"><a href="/gostd/encoding/asn1/common.go.html#3115670">application</a></span>&nbsp;<span class="op" id="3104128">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104133"><a href="/gostd/encoding/asn1/asn1.go.html#3104066">expectedClass</a></span>&nbsp;<span class="op" id="3104147">=</span>&nbsp;<span class="ident" id="3104149"><a href="/gostd/encoding/asn1/common.go.html#3114385">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104172">if</span>&nbsp;<span class="ident" id="3104175"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104176">.</span><span class="ident" id="3104177"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3104183">==</span>&nbsp;<span class="ident" id="3104186"><a href="/gostd/encoding/asn1/asn1.go.html#3104066">expectedClass</a></span>&nbsp;<span class="op" id="3104200">&amp;&amp;</span>&nbsp;<span class="ident" id="3104203"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104204">.</span><span class="ident" id="3104205"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3104209">==</span>&nbsp;<span class="op" id="3104212">*</span><span class="ident" id="3104213"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3104219">.</span><span class="ident" id="3104220"><a href="/gostd/encoding/asn1/common.go.html#3115811">tag</a></span>&nbsp;<span class="op" id="3104224">&amp;&amp;</span>&nbsp;<span class="op" id="3104227">(</span><span class="ident" id="3104228"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104229">.</span><span class="ident" id="3104230"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3104237">==</span>&nbsp;<span class="num" id="3104240">0</span>&nbsp;<span class="op" id="3104242">||</span>&nbsp;<span class="ident" id="3104245"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104246">.</span><span class="ident" id="3104247"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span><span class="op" id="3104257">)</span>&nbsp;<span class="op" id="3104259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104264">if</span>&nbsp;<span class="ident" id="3104267"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104268">.</span><span class="ident" id="3104269"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span>&nbsp;<span class="op" id="3104276">&gt;</span>&nbsp;<span class="num" id="3104278">0</span>&nbsp;<span class="op" id="3104280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104286"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3104287">,</span>&nbsp;<span class="ident" id="3104289"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3104295">,</span>&nbsp;<span class="ident" id="3104297"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3104301">=</span>&nbsp;<span class="ident" id="3104303"><a href="/gostd/encoding/asn1/asn1.go.html#3097794">parseTagAndLength</a></span><span class="op" id="3104320">(</span><span class="ident" id="3104321"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3104326">,</span>&nbsp;<span class="ident" id="3104328"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3104334">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104340">if</span>&nbsp;<span class="ident" id="3104343"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3104347">!=</span>&nbsp;<span class="builtintype" id="3104350">nil</span>&nbsp;<span class="op" id="3104354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104361">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104377">}</span>&nbsp;<span class="keyword" id="3104379">else</span>&nbsp;<span class="op" id="3104384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104390">if</span>&nbsp;<span class="ident" id="3104393"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span>&nbsp;<span class="op" id="3104403">!=</span>&nbsp;<span class="ident" id="3104406"><a href="/gostd/encoding/asn1/asn1.go.html#3101020">flagType</a></span>&nbsp;<span class="op" id="3104415">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104422"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3104426">=</span>&nbsp;<span class="ident" id="3104428"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3104443">{</span><span class="string" id="3104444">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="3104491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104498">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104515"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3104516">.</span><span class="ident" id="3104517"><a href="/gostd/reflect/value.go.html#2871885">SetBool</a></span><span class="op" id="3104524">(</span><span class="builtintype" id="3104525">true</span><span class="op" id="3104529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104535">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104549">}</span>&nbsp;<span class="keyword" id="3104551">else</span>&nbsp;<span class="op" id="3104556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104561">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104623">ok</span>&nbsp;<span class="op" id="3104626">:=</span>&nbsp;<span class="ident" id="3104629"><a href="/gostd/encoding/asn1/asn1.go.html#3110534">setDefaultValue</a></span><span class="op" id="3104644">(</span><span class="ident" id="3104645"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3104646">,</span>&nbsp;<span class="ident" id="3104648"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3104654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104659">if</span>&nbsp;<span class="ident" id="3104662"><a href="/gostd/encoding/asn1/asn1.go.html#3104623">ok</a></span>&nbsp;<span class="op" id="3104665">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104671"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3104678">=</span>&nbsp;<span class="ident" id="3104680"><a href="/gostd/encoding/asn1/asn1.go.html#3101740">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104694">}</span>&nbsp;<span class="keyword" id="3104696">else</span>&nbsp;<span class="op" id="3104701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104707"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3104711">=</span>&nbsp;<span class="ident" id="3104713"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3104728">{</span><span class="string" id="3104729">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="3104768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104778">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104794">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104865">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104935">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105006">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105055">if</span>&nbsp;<span class="ident" id="3105058"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105071">==</span>&nbsp;<span class="ident" id="3105074"><a href="/gostd/encoding/asn1/common.go.html#3114198">tagPrintableString</a></span>&nbsp;<span class="op" id="3105093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105097">if</span>&nbsp;<span class="ident" id="3105100"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105101">.</span><span class="ident" id="3105102"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3105108">==</span>&nbsp;<span class="ident" id="3105111"><a href="/gostd/encoding/asn1/common.go.html#3114359">classUniversal</a></span>&nbsp;<span class="op" id="3105126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105131">switch</span>&nbsp;<span class="ident" id="3105138"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105139">.</span><span class="ident" id="3105140"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3105144">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105149">case</span>&nbsp;<span class="ident" id="3105154"><a href="/gostd/encoding/asn1/common.go.html#3114248">tagIA5String</a></span><span class="op" id="3105166">,</span>&nbsp;<span class="ident" id="3105168"><a href="/gostd/encoding/asn1/common.go.html#3114323">tagGeneralString</a></span><span class="op" id="3105184">,</span>&nbsp;<span class="ident" id="3105186"><a href="/gostd/encoding/asn1/common.go.html#3114223">tagT61String</a></span><span class="op" id="3105198">,</span>&nbsp;<span class="ident" id="3105200"><a href="/gostd/encoding/asn1/common.go.html#3114123">tagUTF8String</a></span><span class="op" id="3105213">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105219"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105232">=</span>&nbsp;<span class="ident" id="3105234"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105235">.</span><span class="ident" id="3105236"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105247">}</span>&nbsp;<span class="keyword" id="3105249">else</span>&nbsp;<span class="keyword" id="3105254">if</span>&nbsp;<span class="ident" id="3105257"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105263">.</span><span class="ident" id="3105264"><a href="/gostd/encoding/asn1/common.go.html#3115877">stringType</a></span>&nbsp;<span class="op" id="3105275">!=</span>&nbsp;<span class="num" id="3105278">0</span>&nbsp;<span class="op" id="3105280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105285"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105298">=</span>&nbsp;<span class="ident" id="3105300"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105306">.</span><span class="ident" id="3105307"><a href="/gostd/encoding/asn1/common.go.html#3115877">stringType</a></span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105327">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105398">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105421">if</span>&nbsp;<span class="ident" id="3105424"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105437">==</span>&nbsp;<span class="ident" id="3105440"><a href="/gostd/encoding/asn1/common.go.html#3114273">tagUTCTime</a></span>&nbsp;<span class="op" id="3105451">&amp;&amp;</span>&nbsp;<span class="ident" id="3105454"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105455">.</span><span class="ident" id="3105456"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3105460">==</span>&nbsp;<span class="ident" id="3105463"><a href="/gostd/encoding/asn1/common.go.html#3114298">tagGeneralizedTime</a></span>&nbsp;<span class="op" id="3105482">&amp;&amp;</span>&nbsp;<span class="ident" id="3105485"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105486">.</span><span class="ident" id="3105487"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3105493">==</span>&nbsp;<span class="ident" id="3105496"><a href="/gostd/encoding/asn1/common.go.html#3114359">classUniversal</a></span>&nbsp;<span class="op" id="3105511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105515"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105528">=</span>&nbsp;<span class="ident" id="3105530"><a href="/gostd/encoding/asn1/common.go.html#3114298">tagGeneralizedTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105554">if</span>&nbsp;<span class="ident" id="3105557"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105563">.</span><span class="ident" id="3105564"><a href="/gostd/encoding/asn1/common.go.html#3115940">set</a></span>&nbsp;<span class="op" id="3105568">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105572"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3105585">=</span>&nbsp;<span class="ident" id="3105587"><a href="/gostd/encoding/asn1/common.go.html#3114173">tagSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105599">expectedClass</span>&nbsp;<span class="op" id="3105613">:=</span>&nbsp;<span class="ident" id="3105616"><a href="/gostd/encoding/asn1/common.go.html#3114359">classUniversal</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105632">expectedTag</span>&nbsp;<span class="op" id="3105644">:=</span>&nbsp;<span class="ident" id="3105647"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105662">if</span>&nbsp;<span class="op" id="3105665">!</span><span class="ident" id="3105666"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105672">.</span><span class="ident" id="3105673"><a href="/gostd/encoding/asn1/common.go.html#3115610">explicit</a></span>&nbsp;<span class="op" id="3105682">&amp;&amp;</span>&nbsp;<span class="ident" id="3105685"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105691">.</span><span class="ident" id="3105692"><a href="/gostd/encoding/asn1/common.go.html#3115811">tag</a></span>&nbsp;<span class="op" id="3105696">!=</span>&nbsp;<span class="builtintype" id="3105699">nil</span>&nbsp;<span class="op" id="3105703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105707"><a href="/gostd/encoding/asn1/asn1.go.html#3105599">expectedClass</a></span>&nbsp;<span class="op" id="3105721">=</span>&nbsp;<span class="ident" id="3105723"><a href="/gostd/encoding/asn1/common.go.html#3114411">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105746"><a href="/gostd/encoding/asn1/asn1.go.html#3105632">expectedTag</a></span>&nbsp;<span class="op" id="3105758">=</span>&nbsp;<span class="op" id="3105760">*</span><span class="ident" id="3105761"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105767">.</span><span class="ident" id="3105768"><a href="/gostd/encoding/asn1/common.go.html#3115811">tag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105773">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105777">if</span>&nbsp;<span class="op" id="3105780">!</span><span class="ident" id="3105781"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105787">.</span><span class="ident" id="3105788"><a href="/gostd/encoding/asn1/common.go.html#3115610">explicit</a></span>&nbsp;<span class="op" id="3105797">&amp;&amp;</span>&nbsp;<span class="ident" id="3105800"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105806">.</span><span class="ident" id="3105807"><a href="/gostd/encoding/asn1/common.go.html#3115670">application</a></span>&nbsp;<span class="op" id="3105819">&amp;&amp;</span>&nbsp;<span class="ident" id="3105822"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105828">.</span><span class="ident" id="3105829"><a href="/gostd/encoding/asn1/common.go.html#3115811">tag</a></span>&nbsp;<span class="op" id="3105833">!=</span>&nbsp;<span class="builtintype" id="3105836">nil</span>&nbsp;<span class="op" id="3105840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105844"><a href="/gostd/encoding/asn1/asn1.go.html#3105599">expectedClass</a></span>&nbsp;<span class="op" id="3105858">=</span>&nbsp;<span class="ident" id="3105860"><a href="/gostd/encoding/asn1/common.go.html#3114385">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105879"><a href="/gostd/encoding/asn1/asn1.go.html#3105632">expectedTag</a></span>&nbsp;<span class="op" id="3105891">=</span>&nbsp;<span class="op" id="3105893">*</span><span class="ident" id="3105894"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3105900">.</span><span class="ident" id="3105901"><a href="/gostd/encoding/asn1/common.go.html#3115811">tag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105906">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105910">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105968">if</span>&nbsp;<span class="ident" id="3105971"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3105972">.</span><span class="ident" id="3105973"><a href="/gostd/encoding/asn1/common.go.html#3114493">class</a></span>&nbsp;<span class="op" id="3105979">!=</span>&nbsp;<span class="ident" id="3105982"><a href="/gostd/encoding/asn1/asn1.go.html#3105599">expectedClass</a></span>&nbsp;<span class="op" id="3105996">||</span>&nbsp;<span class="ident" id="3105999"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106000">.</span><span class="ident" id="3106001"><a href="/gostd/encoding/asn1/common.go.html#3114500">tag</a></span>&nbsp;<span class="op" id="3106005">!=</span>&nbsp;<span class="ident" id="3106008"><a href="/gostd/encoding/asn1/asn1.go.html#3105632">expectedTag</a></span>&nbsp;<span class="op" id="3106020">||</span>&nbsp;<span class="ident" id="3106023"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106024">.</span><span class="ident" id="3106025"><a href="/gostd/encoding/asn1/common.go.html#3114517">isCompound</a></span>&nbsp;<span class="op" id="3106036">!=</span>&nbsp;<span class="ident" id="3106039"><a href="/gostd/encoding/asn1/asn1.go.html#3103817">compoundType</a></span>&nbsp;<span class="op" id="3106052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3106056">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106119">ok</span>&nbsp;<span class="op" id="3106122">:=</span>&nbsp;<span class="ident" id="3106125"><a href="/gostd/encoding/asn1/asn1.go.html#3110534">setDefaultValue</a></span><span class="op" id="3106140">(</span><span class="ident" id="3106141"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3106142">,</span>&nbsp;<span class="ident" id="3106144"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3106150">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106154">if</span>&nbsp;<span class="ident" id="3106157"><a href="/gostd/encoding/asn1/asn1.go.html#3106119">ok</a></span>&nbsp;<span class="op" id="3106160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106165"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3106172">=</span>&nbsp;<span class="ident" id="3106174"><a href="/gostd/encoding/asn1/asn1.go.html#3101740">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106187">}</span>&nbsp;<span class="keyword" id="3106189">else</span>&nbsp;<span class="op" id="3106194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106199"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3106203">=</span>&nbsp;<span class="ident" id="3106205"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3106220">{</span><span class="ident" id="3106221"><a href="/gostd/encoding/asn1/asn1.go.html#3088593">fmt</a></span><span class="op" id="3106224">.</span><span class="ident" id="3106225"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3106232">(</span><span class="string" id="3106233">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="3106274">,</span>&nbsp;<span class="ident" id="3106276"><a href="/gostd/encoding/asn1/asn1.go.html#3105632">expectedTag</a></span><span class="op" id="3106287">,</span>&nbsp;<span class="ident" id="3106289"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106290">,</span>&nbsp;<span class="ident" id="3106292"><a href="/gostd/encoding/asn1/asn1.go.html#3101756">params</a></span><span class="op" id="3106298">,</span>&nbsp;<span class="ident" id="3106300"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><span class="op" id="3106309">.</span><span class="ident" id="3106310"><a href="/gostd/reflect/type.go.html#2782837">Name</a></span><span class="op" id="3106314">(</span><span class="op" id="3106315">)</span><span class="op" id="3106316">,</span>&nbsp;<span class="ident" id="3106318"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3106324">)</span><span class="op" id="3106325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106329">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106333">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106344">if</span>&nbsp;<span class="ident" id="3106347"><a href="/gostd/encoding/asn1/asn1.go.html#3101394">invalidLength</a></span><span class="op" id="3106360">(</span><span class="ident" id="3106361"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3106367">,</span>&nbsp;<span class="ident" id="3106369"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106370">.</span><span class="ident" id="3106371"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3106377">,</span>&nbsp;<span class="builtinfunc" id="3106379">len</span><span class="op" id="3106382">(</span><span class="ident" id="3106383"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3106388">)</span><span class="op" id="3106389">)</span>&nbsp;<span class="op" id="3106391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106395"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3106399">=</span>&nbsp;<span class="ident" id="3106401"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3106412">{</span><span class="string" id="3106413">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3106429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106433">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106444">innerBytes</span>&nbsp;<span class="op" id="3106455">:=</span>&nbsp;<span class="ident" id="3106458"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3106463">[</span><span class="ident" id="3106464"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3106471">:</span>&nbsp;<span class="ident" id="3106473"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3106479">+</span><span class="ident" id="3106480"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106481">.</span><span class="ident" id="3106482"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><span class="op" id="3106488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106491"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span>&nbsp;<span class="op" id="3106498">+=</span>&nbsp;<span class="ident" id="3106501"><a href="/gostd/encoding/asn1/asn1.go.html#3103962">t</a></span><span class="op" id="3106502">.</span><span class="ident" id="3106503"><a href="/gostd/encoding/asn1/common.go.html#3114505">length</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3106512">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106575">switch</span>&nbsp;<span class="ident" id="3106582"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span>&nbsp;<span class="op" id="3106592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106595">case</span>&nbsp;<span class="ident" id="3106600"><a href="/gostd/encoding/asn1/asn1.go.html#3100907">objectIdentifierType</a></span><span class="op" id="3106620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106624">newSlice</span><span class="op" id="3106632">,</span>&nbsp;<span class="ident" id="3106634">err1</span>&nbsp;<span class="op" id="3106639">:=</span>&nbsp;<span class="ident" id="3106642"><a href="/gostd/encoding/asn1/asn1.go.html#3093209">parseObjectIdentifier</a></span><span class="op" id="3106663">(</span><span class="ident" id="3106664"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3106674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106678"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3106679">.</span><span class="ident" id="3106680"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3106683">(</span><span class="ident" id="3106684"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3106691">.</span><span class="ident" id="3106692"><a href="/gostd/reflect/value.go.html#2891043">MakeSlice</a></span><span class="op" id="3106701">(</span><span class="ident" id="3106702"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3106703">.</span><span class="ident" id="3106704"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="3106708">(</span><span class="op" id="3106709">)</span><span class="op" id="3106710">,</span>&nbsp;<span class="builtinfunc" id="3106712">len</span><span class="op" id="3106715">(</span><span class="ident" id="3106716"><a href="/gostd/encoding/asn1/asn1.go.html#3106624">newSlice</a></span><span class="op" id="3106724">)</span><span class="op" id="3106725">,</span>&nbsp;<span class="builtinfunc" id="3106727">len</span><span class="op" id="3106730">(</span><span class="ident" id="3106731"><a href="/gostd/encoding/asn1/asn1.go.html#3106624">newSlice</a></span><span class="op" id="3106739">)</span><span class="op" id="3106740">)</span><span class="op" id="3106741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106745">if</span>&nbsp;<span class="ident" id="3106748"><a href="/gostd/encoding/asn1/asn1.go.html#3106634">err1</a></span>&nbsp;<span class="op" id="3106753">==</span>&nbsp;<span class="builtintype" id="3106756">nil</span>&nbsp;<span class="op" id="3106760">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106765"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3106772">.</span><span class="ident" id="3106773"><a href="/gostd/reflect/value.go.html#2885267">Copy</a></span><span class="op" id="3106777">(</span><span class="ident" id="3106778"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3106779">,</span>&nbsp;<span class="ident" id="3106781"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3106788">.</span><span class="ident" id="3106789"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3106796">(</span><span class="ident" id="3106797"><a href="/gostd/encoding/asn1/asn1.go.html#3106624">newSlice</a></span><span class="op" id="3106805">)</span><span class="op" id="3106806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106814"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3106818">=</span>&nbsp;<span class="ident" id="3106820"><a href="/gostd/encoding/asn1/asn1.go.html#3106634">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106835">case</span>&nbsp;<span class="ident" id="3106840"><a href="/gostd/encoding/asn1/asn1.go.html#3100855">bitStringType</a></span><span class="op" id="3106853">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106857">bs</span><span class="op" id="3106859">,</span>&nbsp;<span class="ident" id="3106861">err1</span>&nbsp;<span class="op" id="3106866">:=</span>&nbsp;<span class="ident" id="3106869"><a href="/gostd/encoding/asn1/asn1.go.html#3092039">parseBitString</a></span><span class="op" id="3106883">(</span><span class="ident" id="3106884"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3106894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106898">if</span>&nbsp;<span class="ident" id="3106901"><a href="/gostd/encoding/asn1/asn1.go.html#3106861">err1</a></span>&nbsp;<span class="op" id="3106906">==</span>&nbsp;<span class="builtintype" id="3106909">nil</span>&nbsp;<span class="op" id="3106913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106918"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3106919">.</span><span class="ident" id="3106920"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3106923">(</span><span class="ident" id="3106924"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3106931">.</span><span class="ident" id="3106932"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3106939">(</span><span class="ident" id="3106940"><a href="/gostd/encoding/asn1/asn1.go.html#3106857">bs</a></span><span class="op" id="3106942">)</span><span class="op" id="3106943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106951"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3106955">=</span>&nbsp;<span class="ident" id="3106957"><a href="/gostd/encoding/asn1/asn1.go.html#3106861">err1</a></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106964">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106972">case</span>&nbsp;<span class="ident" id="3106977"><a href="/gostd/encoding/asn1/asn1.go.html#3101072">timeType</a></span><span class="op" id="3106985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106989">var</span>&nbsp;<span class="ident" id="3106993">time</span>&nbsp;<span class="ident" id="3106998"><a href="/gostd/encoding/asn1/asn1.go.html#3088634">time</a></span><span class="op" id="3107002">.</span><span class="ident" id="3107003"><a href="/gostd/time/time.go.html#2722087">Time</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107010">var</span>&nbsp;<span class="ident" id="3107014">err1</span>&nbsp;<span class="builtintype" id="3107019">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107027">if</span>&nbsp;<span class="ident" id="3107030"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3107043">==</span>&nbsp;<span class="ident" id="3107046"><a href="/gostd/encoding/asn1/common.go.html#3114273">tagUTCTime</a></span>&nbsp;<span class="op" id="3107057">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107062"><a href="/gostd/encoding/asn1/asn1.go.html#3106993">time</a></span><span class="op" id="3107066">,</span>&nbsp;<span class="ident" id="3107068"><a href="/gostd/encoding/asn1/asn1.go.html#3107014">err1</a></span>&nbsp;<span class="op" id="3107073">=</span>&nbsp;<span class="ident" id="3107075"><a href="/gostd/encoding/asn1/asn1.go.html#3094821">parseUTCTime</a></span><span class="op" id="3107087">(</span><span class="ident" id="3107088"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107102">}</span>&nbsp;<span class="keyword" id="3107104">else</span>&nbsp;<span class="op" id="3107109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107114"><a href="/gostd/encoding/asn1/asn1.go.html#3106993">time</a></span><span class="op" id="3107118">,</span>&nbsp;<span class="ident" id="3107120"><a href="/gostd/encoding/asn1/asn1.go.html#3107014">err1</a></span>&nbsp;<span class="op" id="3107125">=</span>&nbsp;<span class="ident" id="3107127"><a href="/gostd/encoding/asn1/asn1.go.html#3095318">parseGeneralizedTime</a></span><span class="op" id="3107147">(</span><span class="ident" id="3107148"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107166">if</span>&nbsp;<span class="ident" id="3107169"><a href="/gostd/encoding/asn1/asn1.go.html#3107014">err1</a></span>&nbsp;<span class="op" id="3107174">==</span>&nbsp;<span class="builtintype" id="3107177">nil</span>&nbsp;<span class="op" id="3107181">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107186"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3107187">.</span><span class="ident" id="3107188"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3107191">(</span><span class="ident" id="3107192"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107199">.</span><span class="ident" id="3107200"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3107207">(</span><span class="ident" id="3107208"><a href="/gostd/encoding/asn1/asn1.go.html#3106993">time</a></span><span class="op" id="3107212">)</span><span class="op" id="3107213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107221"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3107225">=</span>&nbsp;<span class="ident" id="3107227"><a href="/gostd/encoding/asn1/asn1.go.html#3107014">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107234">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107242">case</span>&nbsp;<span class="ident" id="3107247"><a href="/gostd/encoding/asn1/asn1.go.html#3100966">enumeratedType</a></span><span class="op" id="3107261">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107265">parsedInt</span><span class="op" id="3107274">,</span>&nbsp;<span class="ident" id="3107276">err1</span>&nbsp;<span class="op" id="3107281">:=</span>&nbsp;<span class="ident" id="3107284"><a href="/gostd/encoding/asn1/asn1.go.html#3090225">parseInt32</a></span><span class="op" id="3107294">(</span><span class="ident" id="3107295"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107309">if</span>&nbsp;<span class="ident" id="3107312"><a href="/gostd/encoding/asn1/asn1.go.html#3107276">err1</a></span>&nbsp;<span class="op" id="3107317">==</span>&nbsp;<span class="builtintype" id="3107320">nil</span>&nbsp;<span class="op" id="3107324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107329"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3107330">.</span><span class="ident" id="3107331"><a href="/gostd/reflect/value.go.html#2873471">SetInt</a></span><span class="op" id="3107337">(</span><span class="builtintype" id="3107338">int64</span><span class="op" id="3107343">(</span><span class="ident" id="3107344"><a href="/gostd/encoding/asn1/asn1.go.html#3107265">parsedInt</a></span><span class="op" id="3107353">)</span><span class="op" id="3107354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107362"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3107366">=</span>&nbsp;<span class="ident" id="3107368"><a href="/gostd/encoding/asn1/asn1.go.html#3107276">err1</a></span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107375">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107383">case</span>&nbsp;<span class="ident" id="3107388"><a href="/gostd/encoding/asn1/asn1.go.html#3101020">flagType</a></span><span class="op" id="3107396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107400"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3107401">.</span><span class="ident" id="3107402"><a href="/gostd/reflect/value.go.html#2871885">SetBool</a></span><span class="op" id="3107409">(</span><span class="builtintype" id="3107410">true</span><span class="op" id="3107414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107426">case</span>&nbsp;<span class="ident" id="3107431"><a href="/gostd/encoding/asn1/asn1.go.html#3101231">bigIntType</a></span><span class="op" id="3107441">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107445">parsedInt</span>&nbsp;<span class="op" id="3107455">:=</span>&nbsp;<span class="ident" id="3107458"><a href="/gostd/encoding/asn1/asn1.go.html#3090582">parseBigInt</a></span><span class="op" id="3107469">(</span><span class="ident" id="3107470"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107484"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3107485">.</span><span class="ident" id="3107486"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3107489">(</span><span class="ident" id="3107490"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107497">.</span><span class="ident" id="3107498"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3107505">(</span><span class="ident" id="3107506"><a href="/gostd/encoding/asn1/asn1.go.html#3107445">parsedInt</a></span><span class="op" id="3107515">)</span><span class="op" id="3107516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107520">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107531">switch</span>&nbsp;<span class="ident" id="3107538">val</span>&nbsp;<span class="op" id="3107542">:=</span>&nbsp;<span class="ident" id="3107545"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3107546">;</span>&nbsp;<span class="ident" id="3107548"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3107551">.</span><span class="ident" id="3107552"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="3107556">(</span><span class="op" id="3107557">)</span>&nbsp;<span class="op" id="3107559">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107562">case</span>&nbsp;<span class="ident" id="3107567"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107574">.</span><span class="ident" id="3107575"><a href="/gostd/reflect/type.go.html#2787897">Bool</a></span><span class="op" id="3107579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107583">parsedBool</span><span class="op" id="3107593">,</span>&nbsp;<span class="ident" id="3107595">err1</span>&nbsp;<span class="op" id="3107600">:=</span>&nbsp;<span class="ident" id="3107603"><a href="/gostd/encoding/asn1/asn1.go.html#3089152">parseBool</a></span><span class="op" id="3107612">(</span><span class="ident" id="3107613"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107627">if</span>&nbsp;<span class="ident" id="3107630"><a href="/gostd/encoding/asn1/asn1.go.html#3107595">err1</a></span>&nbsp;<span class="op" id="3107635">==</span>&nbsp;<span class="builtintype" id="3107638">nil</span>&nbsp;<span class="op" id="3107642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107647"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3107650">.</span><span class="ident" id="3107651"><a href="/gostd/reflect/value.go.html#2871885">SetBool</a></span><span class="op" id="3107658">(</span><span class="ident" id="3107659"><a href="/gostd/encoding/asn1/asn1.go.html#3107583">parsedBool</a></span><span class="op" id="3107669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107673">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107677"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3107681">=</span>&nbsp;<span class="ident" id="3107683"><a href="/gostd/encoding/asn1/asn1.go.html#3107595">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107698">case</span>&nbsp;<span class="ident" id="3107703"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107710">.</span><span class="ident" id="3107711"><a href="/gostd/reflect/type.go.html#2787903">Int</a></span><span class="op" id="3107714">,</span>&nbsp;<span class="ident" id="3107716"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107723">.</span><span class="ident" id="3107724"><a href="/gostd/reflect/type.go.html#2787921">Int32</a></span><span class="op" id="3107729">,</span>&nbsp;<span class="ident" id="3107731"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3107738">.</span><span class="ident" id="3107739"><a href="/gostd/reflect/type.go.html#2787928">Int64</a></span><span class="op" id="3107744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107748">if</span>&nbsp;<span class="ident" id="3107751"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3107754">.</span><span class="ident" id="3107755"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="3107759">(</span><span class="op" id="3107760">)</span><span class="op" id="3107761">.</span><span class="ident" id="3107762"><a href="/gostd/reflect/type.go.html#2783262">Size</a></span><span class="op" id="3107766">(</span><span class="op" id="3107767">)</span>&nbsp;<span class="op" id="3107769">==</span>&nbsp;<span class="num" id="3107772">4</span>&nbsp;<span class="op" id="3107774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107779">parsedInt</span><span class="op" id="3107788">,</span>&nbsp;<span class="ident" id="3107790">err1</span>&nbsp;<span class="op" id="3107795">:=</span>&nbsp;<span class="ident" id="3107798"><a href="/gostd/encoding/asn1/asn1.go.html#3090225">parseInt32</a></span><span class="op" id="3107808">(</span><span class="ident" id="3107809"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107819">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107824">if</span>&nbsp;<span class="ident" id="3107827"><a href="/gostd/encoding/asn1/asn1.go.html#3107790">err1</a></span>&nbsp;<span class="op" id="3107832">==</span>&nbsp;<span class="builtintype" id="3107835">nil</span>&nbsp;<span class="op" id="3107839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107845"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3107848">.</span><span class="ident" id="3107849"><a href="/gostd/reflect/value.go.html#2873471">SetInt</a></span><span class="op" id="3107855">(</span><span class="builtintype" id="3107856">int64</span><span class="op" id="3107861">(</span><span class="ident" id="3107862"><a href="/gostd/encoding/asn1/asn1.go.html#3107779">parsedInt</a></span><span class="op" id="3107871">)</span><span class="op" id="3107872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107882"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3107886">=</span>&nbsp;<span class="ident" id="3107888"><a href="/gostd/encoding/asn1/asn1.go.html#3107790">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107895">}</span>&nbsp;<span class="keyword" id="3107897">else</span>&nbsp;<span class="op" id="3107902">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107907">parsedInt</span><span class="op" id="3107916">,</span>&nbsp;<span class="ident" id="3107918">err1</span>&nbsp;<span class="op" id="3107923">:=</span>&nbsp;<span class="ident" id="3107926"><a href="/gostd/encoding/asn1/asn1.go.html#3089710">parseInt64</a></span><span class="op" id="3107936">(</span><span class="ident" id="3107937"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3107947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107952">if</span>&nbsp;<span class="ident" id="3107955"><a href="/gostd/encoding/asn1/asn1.go.html#3107918">err1</a></span>&nbsp;<span class="op" id="3107960">==</span>&nbsp;<span class="builtintype" id="3107963">nil</span>&nbsp;<span class="op" id="3107967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107973"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3107976">.</span><span class="ident" id="3107977"><a href="/gostd/reflect/value.go.html#2873471">SetInt</a></span><span class="op" id="3107983">(</span><span class="ident" id="3107984"><a href="/gostd/encoding/asn1/asn1.go.html#3107907">parsedInt</a></span><span class="op" id="3107993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3107998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108003"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3108007">=</span>&nbsp;<span class="ident" id="3108009"><a href="/gostd/encoding/asn1/asn1.go.html#3107918">err1</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108020">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108028">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108086">case</span>&nbsp;<span class="ident" id="3108091"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108098">.</span><span class="ident" id="3108099"><a href="/gostd/reflect/type.go.html#2788077">Struct</a></span><span class="op" id="3108105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108109">structType</span>&nbsp;<span class="op" id="3108120">:=</span>&nbsp;<span class="ident" id="3108123"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108136">if</span>&nbsp;<span class="ident" id="3108139"><a href="/gostd/encoding/asn1/asn1.go.html#3108109">structType</a></span><span class="op" id="3108149">.</span><span class="ident" id="3108150"><a href="/gostd/reflect/type.go.html#2786550">NumField</a></span><span class="op" id="3108158">(</span><span class="op" id="3108159">)</span>&nbsp;<span class="op" id="3108161">&gt;</span>&nbsp;<span class="num" id="3108163">0</span>&nbsp;<span class="op" id="3108165">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108171"><a href="/gostd/encoding/asn1/asn1.go.html#3108109">structType</a></span><span class="op" id="3108181">.</span><span class="ident" id="3108182"><a href="/gostd/reflect/type.go.html#2785427">Field</a></span><span class="op" id="3108187">(</span><span class="num" id="3108188">0</span><span class="op" id="3108189">)</span><span class="op" id="3108190">.</span><span class="ident" id="3108191"><a href="/gostd/reflect/type.go.html#2801034">Type</a></span>&nbsp;<span class="op" id="3108196">==</span>&nbsp;<span class="ident" id="3108199"><a href="/gostd/encoding/asn1/asn1.go.html#3101175">rawContentsType</a></span>&nbsp;<span class="op" id="3108215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108220">bytes</span>&nbsp;<span class="op" id="3108226">:=</span>&nbsp;<span class="ident" id="3108229"><a href="/gostd/encoding/asn1/asn1.go.html#3101726">bytes</a></span><span class="op" id="3108234">[</span><span class="ident" id="3108235"><a href="/gostd/encoding/asn1/asn1.go.html#3101740">initOffset</a></span><span class="op" id="3108245">:</span><span class="ident" id="3108246"><a href="/gostd/encoding/asn1/asn1.go.html#3101781">offset</a></span><span class="op" id="3108252">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108257"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3108260">.</span><span class="ident" id="3108261"><a href="/gostd/reflect/value.go.html#2853921">Field</a></span><span class="op" id="3108266">(</span><span class="num" id="3108267">0</span><span class="op" id="3108268">)</span><span class="op" id="3108269">.</span><span class="ident" id="3108270"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3108273">(</span><span class="ident" id="3108274"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108281">.</span><span class="ident" id="3108282"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3108289">(</span><span class="ident" id="3108290"><a href="/gostd/encoding/asn1/asn1.go.html#3097453">RawContent</a></span><span class="op" id="3108300">(</span><span class="ident" id="3108301"><a href="/gostd/encoding/asn1/asn1.go.html#3108220">bytes</a></span><span class="op" id="3108306">)</span><span class="op" id="3108307">)</span><span class="op" id="3108308">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108317">innerOffset</span>&nbsp;<span class="op" id="3108329">:=</span>&nbsp;<span class="num" id="3108332">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108336">for</span>&nbsp;<span class="ident" id="3108340">i</span>&nbsp;<span class="op" id="3108342">:=</span>&nbsp;<span class="num" id="3108345">0</span><span class="op" id="3108346">;</span>&nbsp;<span class="ident" id="3108348"><a href="/gostd/encoding/asn1/asn1.go.html#3108340">i</a></span>&nbsp;<span class="op" id="3108350">&lt;</span>&nbsp;<span class="ident" id="3108352"><a href="/gostd/encoding/asn1/asn1.go.html#3108109">structType</a></span><span class="op" id="3108362">.</span><span class="ident" id="3108363"><a href="/gostd/reflect/type.go.html#2786550">NumField</a></span><span class="op" id="3108371">(</span><span class="op" id="3108372">)</span><span class="op" id="3108373">;</span>&nbsp;<span class="ident" id="3108375"><a href="/gostd/encoding/asn1/asn1.go.html#3108340">i</a></span><span class="op" id="3108376">++</span>&nbsp;<span class="op" id="3108379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108384">field</span>&nbsp;<span class="op" id="3108390">:=</span>&nbsp;<span class="ident" id="3108393"><a href="/gostd/encoding/asn1/asn1.go.html#3108109">structType</a></span><span class="op" id="3108403">.</span><span class="ident" id="3108404"><a href="/gostd/reflect/type.go.html#2785427">Field</a></span><span class="op" id="3108409">(</span><span class="ident" id="3108410"><a href="/gostd/encoding/asn1/asn1.go.html#3108340">i</a></span><span class="op" id="3108411">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108416">if</span>&nbsp;<span class="ident" id="3108419"><a href="/gostd/encoding/asn1/asn1.go.html#3108340">i</a></span>&nbsp;<span class="op" id="3108421">==</span>&nbsp;<span class="num" id="3108424">0</span>&nbsp;<span class="op" id="3108426">&amp;&amp;</span>&nbsp;<span class="ident" id="3108429"><a href="/gostd/encoding/asn1/asn1.go.html#3108384">field</a></span><span class="op" id="3108434">.</span><span class="ident" id="3108435"><a href="/gostd/reflect/type.go.html#2801034">Type</a></span>&nbsp;<span class="op" id="3108440">==</span>&nbsp;<span class="ident" id="3108443"><a href="/gostd/encoding/asn1/asn1.go.html#3101175">rawContentsType</a></span>&nbsp;<span class="op" id="3108459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108465">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108482"><a href="/gostd/encoding/asn1/asn1.go.html#3108317">innerOffset</a></span><span class="op" id="3108493">,</span>&nbsp;<span class="ident" id="3108495"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3108499">=</span>&nbsp;<span class="ident" id="3108501"><a href="/gostd/encoding/asn1/asn1.go.html#3101698">parseField</a></span><span class="op" id="3108511">(</span><span class="ident" id="3108512"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3108515">.</span><span class="ident" id="3108516"><a href="/gostd/reflect/value.go.html#2853921">Field</a></span><span class="op" id="3108521">(</span><span class="ident" id="3108522"><a href="/gostd/encoding/asn1/asn1.go.html#3108340">i</a></span><span class="op" id="3108523">)</span><span class="op" id="3108524">,</span>&nbsp;<span class="ident" id="3108526"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3108536">,</span>&nbsp;<span class="ident" id="3108538"><a href="/gostd/encoding/asn1/asn1.go.html#3108317">innerOffset</a></span><span class="op" id="3108549">,</span>&nbsp;<span class="ident" id="3108551"><a href="/gostd/encoding/asn1/common.go.html#3116338">parseFieldParameters</a></span><span class="op" id="3108571">(</span><span class="ident" id="3108572"><a href="/gostd/encoding/asn1/asn1.go.html#3108384">field</a></span><span class="op" id="3108577">.</span><span class="ident" id="3108578"><a href="/gostd/reflect/type.go.html#2801069">Tag</a></span><span class="op" id="3108581">.</span><span class="ident" id="3108582"><a href="/gostd/reflect/type.go.html#2801940">Get</a></span><span class="op" id="3108585">(</span><span class="string" id="3108586">&#34;asn1&#34;</span><span class="op" id="3108592">)</span><span class="op" id="3108593">)</span><span class="op" id="3108594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108599">if</span>&nbsp;<span class="ident" id="3108602"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3108606">!=</span>&nbsp;<span class="builtintype" id="3108609">nil</span>&nbsp;<span class="op" id="3108613">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108619">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108637">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108698">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108760">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108805">case</span>&nbsp;<span class="ident" id="3108810"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108817">.</span><span class="ident" id="3108818"><a href="/gostd/reflect/type.go.html#2788062">Slice</a></span><span class="op" id="3108823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108827">sliceType</span>&nbsp;<span class="op" id="3108837">:=</span>&nbsp;<span class="ident" id="3108840"><a href="/gostd/encoding/asn1/asn1.go.html#3101828">fieldType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108852">if</span>&nbsp;<span class="ident" id="3108855"><a href="/gostd/encoding/asn1/asn1.go.html#3108827">sliceType</a></span><span class="op" id="3108864">.</span><span class="ident" id="3108865"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="3108869">(</span><span class="op" id="3108870">)</span><span class="op" id="3108871">.</span><span class="ident" id="3108872"><a href="/gostd/reflect/type.go.html#2783619">Kind</a></span><span class="op" id="3108876">(</span><span class="op" id="3108877">)</span>&nbsp;<span class="op" id="3108879">==</span>&nbsp;<span class="ident" id="3108882"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108889">.</span><span class="ident" id="3108890"><a href="/gostd/reflect/type.go.html#2787941">Uint8</a></span>&nbsp;<span class="op" id="3108896">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108901"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3108904">.</span><span class="ident" id="3108905"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3108908">(</span><span class="ident" id="3108909"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108916">.</span><span class="ident" id="3108917"><a href="/gostd/reflect/value.go.html#2891043">MakeSlice</a></span><span class="op" id="3108926">(</span><span class="ident" id="3108927"><a href="/gostd/encoding/asn1/asn1.go.html#3108827">sliceType</a></span><span class="op" id="3108936">,</span>&nbsp;<span class="builtinfunc" id="3108938">len</span><span class="op" id="3108941">(</span><span class="ident" id="3108942"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3108952">)</span><span class="op" id="3108953">,</span>&nbsp;<span class="builtinfunc" id="3108955">len</span><span class="op" id="3108958">(</span><span class="ident" id="3108959"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3108969">)</span><span class="op" id="3108970">)</span><span class="op" id="3108971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108976"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3108983">.</span><span class="ident" id="3108984"><a href="/gostd/reflect/value.go.html#2885267">Copy</a></span><span class="op" id="3108988">(</span><span class="ident" id="3108989"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3108992">,</span>&nbsp;<span class="ident" id="3108994"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3109001">.</span><span class="ident" id="3109002"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3109009">(</span><span class="ident" id="3109010"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109020">)</span><span class="op" id="3109021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109039">newSlice</span><span class="op" id="3109047">,</span>&nbsp;<span class="ident" id="3109049">err1</span>&nbsp;<span class="op" id="3109054">:=</span>&nbsp;<span class="ident" id="3109057"><a href="/gostd/encoding/asn1/asn1.go.html#3099386">parseSequenceOf</a></span><span class="op" id="3109072">(</span><span class="ident" id="3109073"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109083">,</span>&nbsp;<span class="ident" id="3109085"><a href="/gostd/encoding/asn1/asn1.go.html#3108827">sliceType</a></span><span class="op" id="3109094">,</span>&nbsp;<span class="ident" id="3109096"><a href="/gostd/encoding/asn1/asn1.go.html#3108827">sliceType</a></span><span class="op" id="3109105">.</span><span class="ident" id="3109106"><a href="/gostd/reflect/type.go.html#2785263">Elem</a></span><span class="op" id="3109110">(</span><span class="op" id="3109111">)</span><span class="op" id="3109112">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109116">if</span>&nbsp;<span class="ident" id="3109119"><a href="/gostd/encoding/asn1/asn1.go.html#3109049">err1</a></span>&nbsp;<span class="op" id="3109124">==</span>&nbsp;<span class="builtintype" id="3109127">nil</span>&nbsp;<span class="op" id="3109131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109136"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3109139">.</span><span class="ident" id="3109140"><a href="/gostd/reflect/value.go.html#2871444">Set</a></span><span class="op" id="3109143">(</span><span class="ident" id="3109144"><a href="/gostd/encoding/asn1/asn1.go.html#3109039">newSlice</a></span><span class="op" id="3109152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109160"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109164">=</span>&nbsp;<span class="ident" id="3109166"><a href="/gostd/encoding/asn1/asn1.go.html#3109049">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109173">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109181">case</span>&nbsp;<span class="ident" id="3109186"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3109193">.</span><span class="ident" id="3109194"><a href="/gostd/reflect/type.go.html#2788069">String</a></span><span class="op" id="3109200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109204">var</span>&nbsp;<span class="ident" id="3109208">v</span>&nbsp;<span class="builtintype" id="3109210">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109219">switch</span>&nbsp;<span class="ident" id="3109226"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span>&nbsp;<span class="op" id="3109239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109243">case</span>&nbsp;<span class="ident" id="3109248"><a href="/gostd/encoding/asn1/common.go.html#3114198">tagPrintableString</a></span><span class="op" id="3109266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109271"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109272">,</span>&nbsp;<span class="ident" id="3109274"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109278">=</span>&nbsp;<span class="ident" id="3109280"><a href="/gostd/encoding/asn1/asn1.go.html#3095567">parsePrintableString</a></span><span class="op" id="3109300">(</span><span class="ident" id="3109301"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109311">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109315">case</span>&nbsp;<span class="ident" id="3109320"><a href="/gostd/encoding/asn1/common.go.html#3114248">tagIA5String</a></span><span class="op" id="3109332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109337"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109338">,</span>&nbsp;<span class="ident" id="3109340"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109344">=</span>&nbsp;<span class="ident" id="3109346"><a href="/gostd/encoding/asn1/asn1.go.html#3096412">parseIA5String</a></span><span class="op" id="3109360">(</span><span class="ident" id="3109361"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109375">case</span>&nbsp;<span class="ident" id="3109380"><a href="/gostd/encoding/asn1/common.go.html#3114223">tagT61String</a></span><span class="op" id="3109392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109397"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109398">,</span>&nbsp;<span class="ident" id="3109400"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109404">=</span>&nbsp;<span class="ident" id="3109406"><a href="/gostd/encoding/asn1/asn1.go.html#3096749">parseT61String</a></span><span class="op" id="3109420">(</span><span class="ident" id="3109421"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109435">case</span>&nbsp;<span class="ident" id="3109440"><a href="/gostd/encoding/asn1/common.go.html#3114123">tagUTF8String</a></span><span class="op" id="3109453">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109458"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109459">,</span>&nbsp;<span class="ident" id="3109461"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109465">=</span>&nbsp;<span class="ident" id="3109467"><a href="/gostd/encoding/asn1/asn1.go.html#3096956">parseUTF8String</a></span><span class="op" id="3109482">(</span><span class="ident" id="3109483"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109497">case</span>&nbsp;<span class="ident" id="3109502"><a href="/gostd/encoding/asn1/common.go.html#3114323">tagGeneralString</a></span><span class="op" id="3109518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109523">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109577">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109635">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3109689">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109744"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109745">,</span>&nbsp;<span class="ident" id="3109747"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109751">=</span>&nbsp;<span class="ident" id="3109753"><a href="/gostd/encoding/asn1/asn1.go.html#3096749">parseT61String</a></span><span class="op" id="3109767">(</span><span class="ident" id="3109768"><a href="/gostd/encoding/asn1/asn1.go.html#3106444">innerBytes</a></span><span class="op" id="3109778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109782">default</span><span class="op" id="3109789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109794"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109798">=</span>&nbsp;<span class="ident" id="3109800"><a href="/gostd/encoding/asn1/asn1.go.html#3088954">SyntaxError</a></span><span class="op" id="3109811">{</span><span class="ident" id="3109812"><a href="/gostd/encoding/asn1/asn1.go.html#3088593">fmt</a></span><span class="op" id="3109815">.</span><span class="ident" id="3109816"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3109823">(</span><span class="string" id="3109824">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="3109864">,</span>&nbsp;<span class="ident" id="3109866"><a href="/gostd/encoding/asn1/asn1.go.html#3103803">universalTag</a></span><span class="op" id="3109878">)</span><span class="op" id="3109879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109883">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109887">if</span>&nbsp;<span class="ident" id="3109890"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109894">==</span>&nbsp;<span class="builtintype" id="3109897">nil</span>&nbsp;<span class="op" id="3109901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109906"><a href="/gostd/encoding/asn1/asn1.go.html#3107538">val</a></span><span class="op" id="3109909">.</span><span class="ident" id="3109910"><a href="/gostd/reflect/value.go.html#2876411">SetString</a></span><span class="op" id="3109919">(</span><span class="ident" id="3109920"><a href="/gostd/encoding/asn1/asn1.go.html#3109208">v</a></span><span class="op" id="3109921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109929">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109937">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109940"><a href="/gostd/encoding/asn1/asn1.go.html#3101793">err</a></span>&nbsp;<span class="op" id="3109944">=</span>&nbsp;<span class="ident" id="3109946"><a href="/gostd/encoding/asn1/asn1.go.html#3088765">StructuralError</a></span><span class="op" id="3109961">{</span><span class="string" id="3109962">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="3109978">+</span>&nbsp;<span class="ident" id="3109980"><a href="/gostd/encoding/asn1/asn1.go.html#3101709">v</a></span><span class="op" id="3109981">.</span><span class="ident" id="3109982"><a href="/gostd/reflect/value.go.html#2880910">Type</a></span><span class="op" id="3109986">(</span><span class="op" id="3109987">)</span><span class="op" id="3109988">.</span><span class="ident" id="3109989"><a href="/gostd/reflect/type.go.html#2783552">String</a></span><span class="op" id="3109995">(</span><span class="op" id="3109996">)</span><span class="op" id="3109997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110000">return</span><br>
<span class="lineno"></span><span class="op" id="3110007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3110010">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="3110088">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="3110135">func</span>&nbsp;<span class="ident" id="3110140">canHaveDefaultValue</span><span class="op" id="3110159">(</span><span class="ident" id="3110160">k</span>&nbsp;<span class="ident" id="3110162"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110169">.</span><span class="ident" id="3110170"><a href="/gostd/reflect/type.go.html#2787856">Kind</a></span><span class="op" id="3110174">)</span>&nbsp;<span class="builtintype" id="3110176">bool</span>&nbsp;<span class="op" id="3110181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110184">switch</span>&nbsp;<span class="ident" id="3110191"><a href="/gostd/encoding/asn1/asn1.go.html#3110160">k</a></span>&nbsp;<span class="op" id="3110193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110196">case</span>&nbsp;<span class="ident" id="3110201"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110208">.</span><span class="ident" id="3110209"><a href="/gostd/reflect/type.go.html#2787903">Int</a></span><span class="op" id="3110212">,</span>&nbsp;<span class="ident" id="3110214"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110221">.</span><span class="ident" id="3110222"><a href="/gostd/reflect/type.go.html#2787908">Int8</a></span><span class="op" id="3110226">,</span>&nbsp;<span class="ident" id="3110228"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110235">.</span><span class="ident" id="3110236"><a href="/gostd/reflect/type.go.html#2787914">Int16</a></span><span class="op" id="3110241">,</span>&nbsp;<span class="ident" id="3110243"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110250">.</span><span class="ident" id="3110251"><a href="/gostd/reflect/type.go.html#2787921">Int32</a></span><span class="op" id="3110256">,</span>&nbsp;<span class="ident" id="3110258"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110265">.</span><span class="ident" id="3110266"><a href="/gostd/reflect/type.go.html#2787928">Int64</a></span><span class="op" id="3110271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110275">return</span>&nbsp;<span class="builtintype" id="3110282">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3110288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110292">return</span>&nbsp;<span class="builtintype" id="3110299">false</span><br>
<span class="lineno"></span><span class="op" id="3110305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="3110308">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3110387">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3110467">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3110529">func</span>&nbsp;<span class="ident" id="3110534">setDefaultValue</span><span class="op" id="3110549">(</span><span class="ident" id="3110550">v</span>&nbsp;<span class="ident" id="3110552"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3110559">.</span><span class="ident" id="3110560"><a href="/gostd/reflect/value.go.html#2833557">Value</a></span><span class="op" id="3110565">,</span>&nbsp;<span class="ident" id="3110567">params</span>&nbsp;<span class="ident" id="3110574"><a href="/gostd/encoding/asn1/common.go.html#3115529">fieldParameters</a></span><span class="op" id="3110589">)</span>&nbsp;<span class="op" id="3110591">(</span><span class="ident" id="3110592">ok</span>&nbsp;<span class="builtintype" id="3110595">bool</span><span class="op" id="3110599">)</span>&nbsp;<span class="op" id="3110601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110604">if</span>&nbsp;<span class="op" id="3110607">!</span><span class="ident" id="3110608"><a href="/gostd/encoding/asn1/asn1.go.html#3110567">params</a></span><span class="op" id="3110614">.</span><span class="ident" id="3110615"><a href="/gostd/encoding/asn1/common.go.html#3115555">optional</a></span>&nbsp;<span class="op" id="3110624">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110628">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3110636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110639"><a href="/gostd/encoding/asn1/asn1.go.html#3110592">ok</a></span>&nbsp;<span class="op" id="3110642">=</span>&nbsp;<span class="builtintype" id="3110644">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110650">if</span>&nbsp;<span class="ident" id="3110653"><a href="/gostd/encoding/asn1/asn1.go.html#3110567">params</a></span><span class="op" id="3110659">.</span><span class="ident" id="3110660"><a href="/gostd/encoding/asn1/common.go.html#3115733">defaultValue</a></span>&nbsp;<span class="op" id="3110673">==</span>&nbsp;<span class="builtintype" id="3110676">nil</span>&nbsp;<span class="op" id="3110680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110684">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3110692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110695">if</span>&nbsp;<span class="ident" id="3110698"><a href="/gostd/encoding/asn1/asn1.go.html#3110140">canHaveDefaultValue</a></span><span class="op" id="3110717">(</span><span class="ident" id="3110718"><a href="/gostd/encoding/asn1/asn1.go.html#3110550">v</a></span><span class="op" id="3110719">.</span><span class="ident" id="3110720"><a href="/gostd/reflect/value.go.html#2861487">Kind</a></span><span class="op" id="3110724">(</span><span class="op" id="3110725">)</span><span class="op" id="3110726">)</span>&nbsp;<span class="op" id="3110728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110732"><a href="/gostd/encoding/asn1/asn1.go.html#3110550">v</a></span><span class="op" id="3110733">.</span><span class="ident" id="3110734"><a href="/gostd/reflect/value.go.html#2873471">SetInt</a></span><span class="op" id="3110740">(</span><span class="op" id="3110741">*</span><span class="ident" id="3110742"><a href="/gostd/encoding/asn1/asn1.go.html#3110567">params</a></span><span class="op" id="3110748">.</span><span class="ident" id="3110749"><a href="/gostd/encoding/asn1/common.go.html#3115733">defaultValue</a></span><span class="op" id="3110761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3110764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110767">return</span><br>
<span class="lineno">855</span><span class="op" id="3110774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3110777">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="3110836">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="3110917">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="3110976">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="3111029">//</span><br>
<span class="lineno"></span><span class="comment" id="3111032">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="3111092">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="3111136">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="3111189">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3111225">//</span><br>
<span class="lineno"></span><span class="comment" id="3111228">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="3111282">//</span><br>
<span class="lineno"></span><span class="comment" id="3111285">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="3111338">//</span><br>
<span class="lineno"></span><span class="comment" id="3111341">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3111392">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="3111413">//</span><br>
<span class="lineno"></span><span class="comment" id="3111416">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="3111472">//</span><br>
<span class="lineno"></span><span class="comment" id="3111475">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="3111545">//</span><br>
<span class="lineno"></span><span class="comment" id="3111548">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3111617">//</span><br>
<span class="lineno">880</span><span class="comment" id="3111620">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="3111687">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3111755">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="3111792">//</span><br>
<span class="lineno"></span><span class="comment" id="3111795">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="3111848">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3111914">//</span><br>
<span class="lineno"></span><span class="comment" id="3111917">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="3111972">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3112022">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="3112077">//</span><br>
<span class="lineno"></span><span class="comment" id="3112080">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="3112154">//</span><br>
<span class="lineno"></span><span class="comment" id="3112157">//&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3112213">//&nbsp;&nbsp;&nbsp;&nbsp;default:x&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="3112277">//&nbsp;&nbsp;&nbsp;&nbsp;explicit&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3112355">//&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;&nbsp;&nbsp;&nbsp;marks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="3112401">//&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;causes&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="3112466">//&nbsp;&nbsp;&nbsp;&nbsp;tag:x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="3112539">//</span><br>
<span class="lineno">900</span><span class="comment" id="3112542">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="3112618">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3112671">//</span><br>
<span class="lineno"></span><span class="comment" id="3112674">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3112753">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="3112829">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="3112860">//</span><br>
<span class="lineno"></span><span class="comment" id="3112863">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="3112926">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3112962">func</span>&nbsp;<span class="ident" id="3112967">Unmarshal</span><span class="op" id="3112976">(</span><span class="ident" id="3112977">b</span>&nbsp;<span class="op" id="3112979">[</span><span class="op" id="3112980">]</span><span class="builtintype" id="3112981">byte</span><span class="op" id="3112985">,</span>&nbsp;<span class="ident" id="3112987">val</span>&nbsp;<span class="keyword" id="3112991">interface</span><span class="op" id="3113000">{</span><span class="op" id="3113001">}</span><span class="op" id="3113002">)</span>&nbsp;<span class="op" id="3113004">(</span><span class="ident" id="3113005">rest</span>&nbsp;<span class="op" id="3113010">[</span><span class="op" id="3113011">]</span><span class="builtintype" id="3113012">byte</span><span class="op" id="3113016">,</span>&nbsp;<span class="ident" id="3113018">err</span>&nbsp;<span class="builtintype" id="3113022">error</span><span class="op" id="3113027">)</span>&nbsp;<span class="op" id="3113029">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3113032">return</span>&nbsp;<span class="ident" id="3113039"><a href="/gostd/encoding/asn1/asn1.go.html#3113226">UnmarshalWithParams</a></span><span class="op" id="3113058">(</span><span class="ident" id="3113059"><a href="/gostd/encoding/asn1/asn1.go.html#3112977">b</a></span><span class="op" id="3113060">,</span>&nbsp;<span class="ident" id="3113062"><a href="/gostd/encoding/asn1/asn1.go.html#3112987">val</a></span><span class="op" id="3113065">,</span>&nbsp;<span class="string" id="3113067">&#34;&#34;</span><span class="op" id="3113069">)</span><br>
<span class="lineno"></span><span class="op" id="3113071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3113074">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3113145">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="3113221">func</span>&nbsp;<span class="ident" id="3113226">UnmarshalWithParams</span><span class="op" id="3113245">(</span><span class="ident" id="3113246">b</span>&nbsp;<span class="op" id="3113248">[</span><span class="op" id="3113249">]</span><span class="builtintype" id="3113250">byte</span><span class="op" id="3113254">,</span>&nbsp;<span class="ident" id="3113256">val</span>&nbsp;<span class="keyword" id="3113260">interface</span><span class="op" id="3113269">{</span><span class="op" id="3113270">}</span><span class="op" id="3113271">,</span>&nbsp;<span class="ident" id="3113273">params</span>&nbsp;<span class="builtintype" id="3113280">string</span><span class="op" id="3113286">)</span>&nbsp;<span class="op" id="3113288">(</span><span class="ident" id="3113289">rest</span>&nbsp;<span class="op" id="3113294">[</span><span class="op" id="3113295">]</span><span class="builtintype" id="3113296">byte</span><span class="op" id="3113300">,</span>&nbsp;<span class="ident" id="3113302">err</span>&nbsp;<span class="builtintype" id="3113306">error</span><span class="op" id="3113311">)</span>&nbsp;<span class="op" id="3113313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3113316">v</span>&nbsp;<span class="op" id="3113318">:=</span>&nbsp;<span class="ident" id="3113321"><a href="/gostd/encoding/asn1/asn1.go.html#3088612">reflect</a></span><span class="op" id="3113328">.</span><span class="ident" id="3113329"><a href="/gostd/reflect/value.go.html#2892536">ValueOf</a></span><span class="op" id="3113336">(</span><span class="ident" id="3113337"><a href="/gostd/encoding/asn1/asn1.go.html#3113256">val</a></span><span class="op" id="3113340">)</span><span class="op" id="3113341">.</span><span class="ident" id="3113342"><a href="/gostd/reflect/value.go.html#2853087">Elem</a></span><span class="op" id="3113346">(</span><span class="op" id="3113347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3113350">offset</span><span class="op" id="3113356">,</span>&nbsp;<span class="ident" id="3113358"><a href="/gostd/encoding/asn1/asn1.go.html#3113302">err</a></span>&nbsp;<span class="op" id="3113362">:=</span>&nbsp;<span class="ident" id="3113365"><a href="/gostd/encoding/asn1/asn1.go.html#3101698">parseField</a></span><span class="op" id="3113375">(</span><span class="ident" id="3113376"><a href="/gostd/encoding/asn1/asn1.go.html#3113316">v</a></span><span class="op" id="3113377">,</span>&nbsp;<span class="ident" id="3113379"><a href="/gostd/encoding/asn1/asn1.go.html#3113246">b</a></span><span class="op" id="3113380">,</span>&nbsp;<span class="num" id="3113382">0</span><span class="op" id="3113383">,</span>&nbsp;<span class="ident" id="3113385"><a href="/gostd/encoding/asn1/common.go.html#3116338">parseFieldParameters</a></span><span class="op" id="3113405">(</span><span class="ident" id="3113406"><a href="/gostd/encoding/asn1/asn1.go.html#3113273">params</a></span><span class="op" id="3113412">)</span><span class="op" id="3113413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3113416">if</span>&nbsp;<span class="ident" id="3113419"><a href="/gostd/encoding/asn1/asn1.go.html#3113302">err</a></span>&nbsp;<span class="op" id="3113423">!=</span>&nbsp;<span class="builtintype" id="3113426">nil</span>&nbsp;<span class="op" id="3113430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3113434">return</span>&nbsp;<span class="builtintype" id="3113441">nil</span><span class="op" id="3113444">,</span>&nbsp;<span class="ident" id="3113446"><a href="/gostd/encoding/asn1/asn1.go.html#3113302">err</a></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3113451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3113454">return</span>&nbsp;<span class="ident" id="3113461"><a href="/gostd/encoding/asn1/asn1.go.html#3113246">b</a></span><span class="op" id="3113462">[</span><span class="ident" id="3113463"><a href="/gostd/encoding/asn1/asn1.go.html#3113350">offset</a></span><span class="op" id="3113469">:</span><span class="op" id="3113470">]</span><span class="op" id="3113471">,</span>&nbsp;<span class="builtintype" id="3113473">nil</span><br>
<span class="lineno"></span><span class="op" id="3113477">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
