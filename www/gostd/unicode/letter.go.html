<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html" class="current">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1786292">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1786347">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1786401">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1786452">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1786526">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1786550">package</span>&nbsp;<span class="ident" id="1786558">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786567">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1786634">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1786700">const</span>&nbsp;<span class="op" id="1786706">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786709">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786725">=</span>&nbsp;<span class="string" id="1786727">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1786740">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786778">ReplacementChar</span>&nbsp;<span class="op" id="1786794">=</span>&nbsp;<span class="string" id="1786796">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786809">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786845">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786861">=</span>&nbsp;<span class="string" id="1786863">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786876">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786901">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786917">=</span>&nbsp;<span class="string" id="1786919">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786932">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1786958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786961">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1787037">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1787104">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1787177">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1787240">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1787300">type</span>&nbsp;<span class="ident" id="1787305">RangeTable</span>&nbsp;<span class="keyword" id="1787316">struct</span>&nbsp;<span class="op" id="1787323">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787326">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787338">[</span><span class="op" id="1787339">]</span><span class="ident" id="1787340">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787349">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787361">[</span><span class="op" id="1787362">]</span><span class="ident" id="1787363">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787372">LatinOffset</span>&nbsp;<span class="builtintype" id="1787384">int</span>&nbsp;<span class="comment" id="1787388">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1787437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1787440">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1787534">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1787577">type</span>&nbsp;<span class="ident" id="1787582">Range16</span>&nbsp;<span class="keyword" id="1787590">struct</span>&nbsp;<span class="op" id="1787597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787600">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1787607">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787615">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1787622">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787630">Stride</span>&nbsp;<span class="builtintype" id="1787637">uint16</span><br>
<span class="lineno"></span><span class="op" id="1787644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1787647">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1787727">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1787804">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1787882">type</span>&nbsp;<span class="ident" id="1787887">Range32</span>&nbsp;<span class="keyword" id="1787895">struct</span>&nbsp;<span class="op" id="1787902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787905">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1787912">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787920">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1787927">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787935">Stride</span>&nbsp;<span class="builtintype" id="1787942">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1787949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1787952">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1788023">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1788073">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1788150">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1788223">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1788297">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1788369">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1788445">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1788489">//&nbsp;&nbsp;&nbsp;&nbsp;{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1788529">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1788597">type</span>&nbsp;<span class="ident" id="1788602">CaseRange</span>&nbsp;<span class="keyword" id="1788612">struct</span>&nbsp;<span class="op" id="1788619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788622">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1788628">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788636">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1788642">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788650">Delta</span>&nbsp;<span class="ident" id="1788656">d</span><br>
<span class="lineno"></span><span class="op" id="1788658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788661">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1788736">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1788811">type</span>&nbsp;<span class="ident" id="1788816">SpecialCase</span>&nbsp;<span class="op" id="1788828">[</span><span class="op" id="1788829">]</span><span class="ident" id="1788830">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788841">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1788910">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1788977">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1789046">const</span>&nbsp;<span class="op" id="1789052">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789055">UpperCase</span>&nbsp;<span class="op" id="1789065">=</span>&nbsp;<span class="ident" id="1789067">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789073">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789084">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789095">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1789103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1789106">type</span>&nbsp;<span class="ident" id="1789111">d</span>&nbsp;<span class="op" id="1789113">[</span><span class="ident" id="1789114">MaxCase</span><span class="op" id="1789121">]</span><span class="builtintype" id="1789122">rune</span>&nbsp;<span class="comment" id="1789127">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1789167">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1789228">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1789286">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1789314">const</span>&nbsp;<span class="op" id="1789320">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789323">UpperLower</span>&nbsp;<span class="op" id="1789334">=</span>&nbsp;<span class="ident" id="1789336">MaxRune</span>&nbsp;<span class="op" id="1789344">+</span>&nbsp;<span class="num" id="1789346">1</span>&nbsp;<span class="comment" id="1789348">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1789378">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1789381">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1789459">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1789503">const</span>&nbsp;<span class="ident" id="1789509">linearMax</span>&nbsp;<span class="op" id="1789519">=</span>&nbsp;<span class="num" id="1789521">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1789525">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1789592">func</span>&nbsp;<span class="ident" id="1789597">is16</span><span class="op" id="1789601">(</span><span class="ident" id="1789602">ranges</span>&nbsp;<span class="op" id="1789609">[</span><span class="op" id="1789610">]</span><span class="ident" id="1789611">Range16</span><span class="op" id="1789618">,</span>&nbsp;<span class="ident" id="1789620">r</span>&nbsp;<span class="builtintype" id="1789622">uint16</span><span class="op" id="1789628">)</span>&nbsp;<span class="builtintype" id="1789630">bool</span>&nbsp;<span class="op" id="1789635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789638">if</span>&nbsp;<span class="builtinfunc" id="1789641">len</span><span class="op" id="1789644">(</span><span class="ident" id="1789645">ranges</span><span class="op" id="1789651">)</span>&nbsp;<span class="op" id="1789653">&lt;=</span>&nbsp;<span class="ident" id="1789656">linearMax</span>&nbsp;<span class="op" id="1789666">||</span>&nbsp;<span class="ident" id="1789669">r</span>&nbsp;<span class="op" id="1789671">&lt;=</span>&nbsp;<span class="ident" id="1789674">MaxLatin1</span>&nbsp;<span class="op" id="1789684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789688">for</span>&nbsp;<span class="ident" id="1789692">i</span>&nbsp;<span class="op" id="1789694">:=</span>&nbsp;<span class="keyword" id="1789697">range</span>&nbsp;<span class="ident" id="1789703">ranges</span>&nbsp;<span class="op" id="1789710">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789715">range_</span>&nbsp;<span class="op" id="1789722">:=</span>&nbsp;<span class="op" id="1789725">&amp;</span><span class="ident" id="1789726">ranges</span><span class="op" id="1789732">[</span><span class="ident" id="1789733">i</span><span class="op" id="1789734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789739">if</span>&nbsp;<span class="ident" id="1789742">r</span>&nbsp;<span class="op" id="1789744">&lt;</span>&nbsp;<span class="ident" id="1789746">range_</span><span class="op" id="1789752">.</span><span class="ident" id="1789753">Lo</span>&nbsp;<span class="op" id="1789756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789762">return</span>&nbsp;<span class="builtintype" id="1789769">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789783">if</span>&nbsp;<span class="ident" id="1789786">r</span>&nbsp;<span class="op" id="1789788">&lt;=</span>&nbsp;<span class="ident" id="1789791">range_</span><span class="op" id="1789797">.</span><span class="ident" id="1789798">Hi</span>&nbsp;<span class="op" id="1789801">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789807">return</span>&nbsp;<span class="op" id="1789814">(</span><span class="ident" id="1789815">r</span><span class="op" id="1789816">-</span><span class="ident" id="1789817">range_</span><span class="op" id="1789823">.</span><span class="ident" id="1789824">Lo</span><span class="op" id="1789826">)</span><span class="op" id="1789827">%</span><span class="ident" id="1789828">range_</span><span class="op" id="1789834">.</span><span class="ident" id="1789835">Stride</span>&nbsp;<span class="op" id="1789842">==</span>&nbsp;<span class="num" id="1789845">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789858">return</span>&nbsp;<span class="builtintype" id="1789865">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789872">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1789876">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789906">lo</span>&nbsp;<span class="op" id="1789909">:=</span>&nbsp;<span class="num" id="1789912">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789915">hi</span>&nbsp;<span class="op" id="1789918">:=</span>&nbsp;<span class="builtinfunc" id="1789921">len</span><span class="op" id="1789924">(</span><span class="ident" id="1789925">ranges</span><span class="op" id="1789931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789934">for</span>&nbsp;<span class="ident" id="1789938">lo</span>&nbsp;<span class="op" id="1789941">&lt;</span>&nbsp;<span class="ident" id="1789943">hi</span>&nbsp;<span class="op" id="1789946">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789950">m</span>&nbsp;<span class="op" id="1789952">:=</span>&nbsp;<span class="ident" id="1789955">lo</span>&nbsp;<span class="op" id="1789958">+</span>&nbsp;<span class="op" id="1789960">(</span><span class="ident" id="1789961">hi</span><span class="op" id="1789963">-</span><span class="ident" id="1789964">lo</span><span class="op" id="1789966">)</span><span class="op" id="1789967">/</span><span class="num" id="1789968">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789972">range_</span>&nbsp;<span class="op" id="1789979">:=</span>&nbsp;<span class="op" id="1789982">&amp;</span><span class="ident" id="1789983">ranges</span><span class="op" id="1789989">[</span><span class="ident" id="1789990">m</span><span class="op" id="1789991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789995">if</span>&nbsp;<span class="ident" id="1789998">range_</span><span class="op" id="1790004">.</span><span class="ident" id="1790005">Lo</span>&nbsp;<span class="op" id="1790008">&lt;=</span>&nbsp;<span class="ident" id="1790011">r</span>&nbsp;<span class="op" id="1790013">&amp;&amp;</span>&nbsp;<span class="ident" id="1790016">r</span>&nbsp;<span class="op" id="1790018">&lt;=</span>&nbsp;<span class="ident" id="1790021">range_</span><span class="op" id="1790027">.</span><span class="ident" id="1790028">Hi</span>&nbsp;<span class="op" id="1790031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790036">return</span>&nbsp;<span class="op" id="1790043">(</span><span class="ident" id="1790044">r</span><span class="op" id="1790045">-</span><span class="ident" id="1790046">range_</span><span class="op" id="1790052">.</span><span class="ident" id="1790053">Lo</span><span class="op" id="1790055">)</span><span class="op" id="1790056">%</span><span class="ident" id="1790057">range_</span><span class="op" id="1790063">.</span><span class="ident" id="1790064">Stride</span>&nbsp;<span class="op" id="1790071">==</span>&nbsp;<span class="num" id="1790074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790078">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790082">if</span>&nbsp;<span class="ident" id="1790085">r</span>&nbsp;<span class="op" id="1790087">&lt;</span>&nbsp;<span class="ident" id="1790089">range_</span><span class="op" id="1790095">.</span><span class="ident" id="1790096">Lo</span>&nbsp;<span class="op" id="1790099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790104">hi</span>&nbsp;<span class="op" id="1790107">=</span>&nbsp;<span class="ident" id="1790109">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790113">}</span>&nbsp;<span class="keyword" id="1790115">else</span>&nbsp;<span class="op" id="1790120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790125">lo</span>&nbsp;<span class="op" id="1790128">=</span>&nbsp;<span class="ident" id="1790130">m</span>&nbsp;<span class="op" id="1790132">+</span>&nbsp;<span class="num" id="1790134">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790138">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790144">return</span>&nbsp;<span class="builtintype" id="1790151">false</span><br>
<span class="lineno"></span><span class="op" id="1790157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1790160">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1790227">func</span>&nbsp;<span class="ident" id="1790232">is32</span><span class="op" id="1790236">(</span><span class="ident" id="1790237">ranges</span>&nbsp;<span class="op" id="1790244">[</span><span class="op" id="1790245">]</span><span class="ident" id="1790246">Range32</span><span class="op" id="1790253">,</span>&nbsp;<span class="ident" id="1790255">r</span>&nbsp;<span class="builtintype" id="1790257">uint32</span><span class="op" id="1790263">)</span>&nbsp;<span class="builtintype" id="1790265">bool</span>&nbsp;<span class="op" id="1790270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790273">if</span>&nbsp;<span class="builtinfunc" id="1790276">len</span><span class="op" id="1790279">(</span><span class="ident" id="1790280">ranges</span><span class="op" id="1790286">)</span>&nbsp;<span class="op" id="1790288">&lt;=</span>&nbsp;<span class="ident" id="1790291">linearMax</span>&nbsp;<span class="op" id="1790301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790305">for</span>&nbsp;<span class="ident" id="1790309">i</span>&nbsp;<span class="op" id="1790311">:=</span>&nbsp;<span class="keyword" id="1790314">range</span>&nbsp;<span class="ident" id="1790320">ranges</span>&nbsp;<span class="op" id="1790327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790332">range_</span>&nbsp;<span class="op" id="1790339">:=</span>&nbsp;<span class="op" id="1790342">&amp;</span><span class="ident" id="1790343">ranges</span><span class="op" id="1790349">[</span><span class="ident" id="1790350">i</span><span class="op" id="1790351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790356">if</span>&nbsp;<span class="ident" id="1790359">r</span>&nbsp;<span class="op" id="1790361">&lt;</span>&nbsp;<span class="ident" id="1790363">range_</span><span class="op" id="1790369">.</span><span class="ident" id="1790370">Lo</span>&nbsp;<span class="op" id="1790373">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790379">return</span>&nbsp;<span class="builtintype" id="1790386">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790400">if</span>&nbsp;<span class="ident" id="1790403">r</span>&nbsp;<span class="op" id="1790405">&lt;=</span>&nbsp;<span class="ident" id="1790408">range_</span><span class="op" id="1790414">.</span><span class="ident" id="1790415">Hi</span>&nbsp;<span class="op" id="1790418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790424">return</span>&nbsp;<span class="op" id="1790431">(</span><span class="ident" id="1790432">r</span><span class="op" id="1790433">-</span><span class="ident" id="1790434">range_</span><span class="op" id="1790440">.</span><span class="ident" id="1790441">Lo</span><span class="op" id="1790443">)</span><span class="op" id="1790444">%</span><span class="ident" id="1790445">range_</span><span class="op" id="1790451">.</span><span class="ident" id="1790452">Stride</span>&nbsp;<span class="op" id="1790459">==</span>&nbsp;<span class="num" id="1790462">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790467">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790475">return</span>&nbsp;<span class="builtintype" id="1790482">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1790493">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790523">lo</span>&nbsp;<span class="op" id="1790526">:=</span>&nbsp;<span class="num" id="1790529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790532">hi</span>&nbsp;<span class="op" id="1790535">:=</span>&nbsp;<span class="builtinfunc" id="1790538">len</span><span class="op" id="1790541">(</span><span class="ident" id="1790542">ranges</span><span class="op" id="1790548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790551">for</span>&nbsp;<span class="ident" id="1790555">lo</span>&nbsp;<span class="op" id="1790558">&lt;</span>&nbsp;<span class="ident" id="1790560">hi</span>&nbsp;<span class="op" id="1790563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790567">m</span>&nbsp;<span class="op" id="1790569">:=</span>&nbsp;<span class="ident" id="1790572">lo</span>&nbsp;<span class="op" id="1790575">+</span>&nbsp;<span class="op" id="1790577">(</span><span class="ident" id="1790578">hi</span><span class="op" id="1790580">-</span><span class="ident" id="1790581">lo</span><span class="op" id="1790583">)</span><span class="op" id="1790584">/</span><span class="num" id="1790585">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790589">range_</span>&nbsp;<span class="op" id="1790596">:=</span>&nbsp;<span class="ident" id="1790599">ranges</span><span class="op" id="1790605">[</span><span class="ident" id="1790606">m</span><span class="op" id="1790607">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790611">if</span>&nbsp;<span class="ident" id="1790614">range_</span><span class="op" id="1790620">.</span><span class="ident" id="1790621">Lo</span>&nbsp;<span class="op" id="1790624">&lt;=</span>&nbsp;<span class="ident" id="1790627">r</span>&nbsp;<span class="op" id="1790629">&amp;&amp;</span>&nbsp;<span class="ident" id="1790632">r</span>&nbsp;<span class="op" id="1790634">&lt;=</span>&nbsp;<span class="ident" id="1790637">range_</span><span class="op" id="1790643">.</span><span class="ident" id="1790644">Hi</span>&nbsp;<span class="op" id="1790647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790652">return</span>&nbsp;<span class="op" id="1790659">(</span><span class="ident" id="1790660">r</span><span class="op" id="1790661">-</span><span class="ident" id="1790662">range_</span><span class="op" id="1790668">.</span><span class="ident" id="1790669">Lo</span><span class="op" id="1790671">)</span><span class="op" id="1790672">%</span><span class="ident" id="1790673">range_</span><span class="op" id="1790679">.</span><span class="ident" id="1790680">Stride</span>&nbsp;<span class="op" id="1790687">==</span>&nbsp;<span class="num" id="1790690">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790698">if</span>&nbsp;<span class="ident" id="1790701">r</span>&nbsp;<span class="op" id="1790703">&lt;</span>&nbsp;<span class="ident" id="1790705">range_</span><span class="op" id="1790711">.</span><span class="ident" id="1790712">Lo</span>&nbsp;<span class="op" id="1790715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790720">hi</span>&nbsp;<span class="op" id="1790723">=</span>&nbsp;<span class="ident" id="1790725">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790729">}</span>&nbsp;<span class="keyword" id="1790731">else</span>&nbsp;<span class="op" id="1790736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790741">lo</span>&nbsp;<span class="op" id="1790744">=</span>&nbsp;<span class="ident" id="1790746">m</span>&nbsp;<span class="op" id="1790748">+</span>&nbsp;<span class="num" id="1790750">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790760">return</span>&nbsp;<span class="builtintype" id="1790767">false</span><br>
<span class="lineno">155</span><span class="op" id="1790773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1790776">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1790844">func</span>&nbsp;<span class="ident" id="1790849">Is</span><span class="op" id="1790851">(</span><span class="ident" id="1790852">rangeTab</span>&nbsp;<span class="op" id="1790861">*</span><span class="ident" id="1790862">RangeTable</span><span class="op" id="1790872">,</span>&nbsp;<span class="ident" id="1790874">r</span>&nbsp;<span class="builtintype" id="1790876">rune</span><span class="op" id="1790880">)</span>&nbsp;<span class="builtintype" id="1790882">bool</span>&nbsp;<span class="op" id="1790887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790890">r16</span>&nbsp;<span class="op" id="1790894">:=</span>&nbsp;<span class="ident" id="1790897">rangeTab</span><span class="op" id="1790905">.</span><span class="ident" id="1790906">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790911">if</span>&nbsp;<span class="builtinfunc" id="1790914">len</span><span class="op" id="1790917">(</span><span class="ident" id="1790918">r16</span><span class="op" id="1790921">)</span>&nbsp;<span class="op" id="1790923">&gt;</span>&nbsp;<span class="num" id="1790925">0</span>&nbsp;<span class="op" id="1790927">&amp;&amp;</span>&nbsp;<span class="ident" id="1790930">r</span>&nbsp;<span class="op" id="1790932">&lt;=</span>&nbsp;<span class="builtintype" id="1790935">rune</span><span class="op" id="1790939">(</span><span class="ident" id="1790940">r16</span><span class="op" id="1790943">[</span><span class="builtinfunc" id="1790944">len</span><span class="op" id="1790947">(</span><span class="ident" id="1790948">r16</span><span class="op" id="1790951">)</span><span class="op" id="1790952">-</span><span class="num" id="1790953">1</span><span class="op" id="1790954">]</span><span class="op" id="1790955">.</span><span class="ident" id="1790956">Hi</span><span class="op" id="1790958">)</span>&nbsp;<span class="op" id="1790960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790964">return</span>&nbsp;<span class="ident" id="1790971">is16</span><span class="op" id="1790975">(</span><span class="ident" id="1790976">r16</span><span class="op" id="1790979">,</span>&nbsp;<span class="builtintype" id="1790981">uint16</span><span class="op" id="1790987">(</span><span class="ident" id="1790988">r</span><span class="op" id="1790989">)</span><span class="op" id="1790990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1790996">r32</span>&nbsp;<span class="op" id="1791000">:=</span>&nbsp;<span class="ident" id="1791003">rangeTab</span><span class="op" id="1791011">.</span><span class="ident" id="1791012">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791017">if</span>&nbsp;<span class="builtinfunc" id="1791020">len</span><span class="op" id="1791023">(</span><span class="ident" id="1791024">r32</span><span class="op" id="1791027">)</span>&nbsp;<span class="op" id="1791029">&gt;</span>&nbsp;<span class="num" id="1791031">0</span>&nbsp;<span class="op" id="1791033">&amp;&amp;</span>&nbsp;<span class="ident" id="1791036">r</span>&nbsp;<span class="op" id="1791038">&gt;=</span>&nbsp;<span class="builtintype" id="1791041">rune</span><span class="op" id="1791045">(</span><span class="ident" id="1791046">r32</span><span class="op" id="1791049">[</span><span class="num" id="1791050">0</span><span class="op" id="1791051">]</span><span class="op" id="1791052">.</span><span class="ident" id="1791053">Lo</span><span class="op" id="1791055">)</span>&nbsp;<span class="op" id="1791057">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791061">return</span>&nbsp;<span class="ident" id="1791068">is32</span><span class="op" id="1791072">(</span><span class="ident" id="1791073">r32</span><span class="op" id="1791076">,</span>&nbsp;<span class="builtintype" id="1791078">uint32</span><span class="op" id="1791084">(</span><span class="ident" id="1791085">r</span><span class="op" id="1791086">)</span><span class="op" id="1791087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1791090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791093">return</span>&nbsp;<span class="builtintype" id="1791100">false</span><br>
<span class="lineno"></span><span class="op" id="1791106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1791109">func</span>&nbsp;<span class="ident" id="1791114">isExcludingLatin</span><span class="op" id="1791130">(</span><span class="ident" id="1791131">rangeTab</span>&nbsp;<span class="op" id="1791140">*</span><span class="ident" id="1791141">RangeTable</span><span class="op" id="1791151">,</span>&nbsp;<span class="ident" id="1791153">r</span>&nbsp;<span class="builtintype" id="1791155">rune</span><span class="op" id="1791159">)</span>&nbsp;<span class="builtintype" id="1791161">bool</span>&nbsp;<span class="op" id="1791166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1791169">r16</span>&nbsp;<span class="op" id="1791173">:=</span>&nbsp;<span class="ident" id="1791176">rangeTab</span><span class="op" id="1791184">.</span><span class="ident" id="1791185">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791190">if</span>&nbsp;<span class="ident" id="1791193">off</span>&nbsp;<span class="op" id="1791197">:=</span>&nbsp;<span class="ident" id="1791200">rangeTab</span><span class="op" id="1791208">.</span><span class="ident" id="1791209">LatinOffset</span><span class="op" id="1791220">;</span>&nbsp;<span class="builtinfunc" id="1791222">len</span><span class="op" id="1791225">(</span><span class="ident" id="1791226">r16</span><span class="op" id="1791229">)</span>&nbsp;<span class="op" id="1791231">&gt;</span>&nbsp;<span class="ident" id="1791233">off</span>&nbsp;<span class="op" id="1791237">&amp;&amp;</span>&nbsp;<span class="ident" id="1791240">r</span>&nbsp;<span class="op" id="1791242">&lt;=</span>&nbsp;<span class="builtintype" id="1791245">rune</span><span class="op" id="1791249">(</span><span class="ident" id="1791250">r16</span><span class="op" id="1791253">[</span><span class="builtinfunc" id="1791254">len</span><span class="op" id="1791257">(</span><span class="ident" id="1791258">r16</span><span class="op" id="1791261">)</span><span class="op" id="1791262">-</span><span class="num" id="1791263">1</span><span class="op" id="1791264">]</span><span class="op" id="1791265">.</span><span class="ident" id="1791266">Hi</span><span class="op" id="1791268">)</span>&nbsp;<span class="op" id="1791270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791274">return</span>&nbsp;<span class="ident" id="1791281">is16</span><span class="op" id="1791285">(</span><span class="ident" id="1791286">r16</span><span class="op" id="1791289">[</span><span class="ident" id="1791290">off</span><span class="op" id="1791293">:</span><span class="op" id="1791294">]</span><span class="op" id="1791295">,</span>&nbsp;<span class="builtintype" id="1791297">uint16</span><span class="op" id="1791303">(</span><span class="ident" id="1791304">r</span><span class="op" id="1791305">)</span><span class="op" id="1791306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1791309">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1791312">r32</span>&nbsp;<span class="op" id="1791316">:=</span>&nbsp;<span class="ident" id="1791319">rangeTab</span><span class="op" id="1791327">.</span><span class="ident" id="1791328">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791333">if</span>&nbsp;<span class="builtinfunc" id="1791336">len</span><span class="op" id="1791339">(</span><span class="ident" id="1791340">r32</span><span class="op" id="1791343">)</span>&nbsp;<span class="op" id="1791345">&gt;</span>&nbsp;<span class="num" id="1791347">0</span>&nbsp;<span class="op" id="1791349">&amp;&amp;</span>&nbsp;<span class="ident" id="1791352">r</span>&nbsp;<span class="op" id="1791354">&gt;=</span>&nbsp;<span class="builtintype" id="1791357">rune</span><span class="op" id="1791361">(</span><span class="ident" id="1791362">r32</span><span class="op" id="1791365">[</span><span class="num" id="1791366">0</span><span class="op" id="1791367">]</span><span class="op" id="1791368">.</span><span class="ident" id="1791369">Lo</span><span class="op" id="1791371">)</span>&nbsp;<span class="op" id="1791373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791377">return</span>&nbsp;<span class="ident" id="1791384">is32</span><span class="op" id="1791388">(</span><span class="ident" id="1791389">r32</span><span class="op" id="1791392">,</span>&nbsp;<span class="builtintype" id="1791394">uint32</span><span class="op" id="1791400">(</span><span class="ident" id="1791401">r</span><span class="op" id="1791402">)</span><span class="op" id="1791403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1791406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791409">return</span>&nbsp;<span class="builtintype" id="1791416">false</span><br>
<span class="lineno">180</span><span class="op" id="1791422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1791425">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1791486">func</span>&nbsp;<span class="ident" id="1791491">IsUpper</span><span class="op" id="1791498">(</span><span class="ident" id="1791499">r</span>&nbsp;<span class="builtintype" id="1791501">rune</span><span class="op" id="1791505">)</span>&nbsp;<span class="builtintype" id="1791507">bool</span>&nbsp;<span class="op" id="1791512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1791515">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791545">if</span>&nbsp;<span class="builtintype" id="1791548">uint32</span><span class="op" id="1791554">(</span><span class="ident" id="1791555">r</span><span class="op" id="1791556">)</span>&nbsp;<span class="op" id="1791558">&lt;=</span>&nbsp;<span class="ident" id="1791561">MaxLatin1</span>&nbsp;<span class="op" id="1791571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791575">return</span>&nbsp;<span class="ident" id="1791582">properties</span><span class="op" id="1791592">[</span><span class="builtintype" id="1791593">uint8</span><span class="op" id="1791598">(</span><span class="ident" id="1791599">r</span><span class="op" id="1791600">)</span><span class="op" id="1791601">]</span><span class="op" id="1791602">&amp;</span><span class="ident" id="1791603">pLmask</span>&nbsp;<span class="op" id="1791610">==</span>&nbsp;<span class="ident" id="1791613">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1791618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791621">return</span>&nbsp;<span class="ident" id="1791628">isExcludingLatin</span><span class="op" id="1791644">(</span><span class="ident" id="1791645">Upper</span><span class="op" id="1791650">,</span>&nbsp;<span class="ident" id="1791652">r</span><span class="op" id="1791653">)</span><br>
<span class="lineno"></span><span class="op" id="1791655">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1791658">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1791718">func</span>&nbsp;<span class="ident" id="1791723">IsLower</span><span class="op" id="1791730">(</span><span class="ident" id="1791731">r</span>&nbsp;<span class="builtintype" id="1791733">rune</span><span class="op" id="1791737">)</span>&nbsp;<span class="builtintype" id="1791739">bool</span>&nbsp;<span class="op" id="1791744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1791747">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791777">if</span>&nbsp;<span class="builtintype" id="1791780">uint32</span><span class="op" id="1791786">(</span><span class="ident" id="1791787">r</span><span class="op" id="1791788">)</span>&nbsp;<span class="op" id="1791790">&lt;=</span>&nbsp;<span class="ident" id="1791793">MaxLatin1</span>&nbsp;<span class="op" id="1791803">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791807">return</span>&nbsp;<span class="ident" id="1791814">properties</span><span class="op" id="1791824">[</span><span class="builtintype" id="1791825">uint8</span><span class="op" id="1791830">(</span><span class="ident" id="1791831">r</span><span class="op" id="1791832">)</span><span class="op" id="1791833">]</span><span class="op" id="1791834">&amp;</span><span class="ident" id="1791835">pLmask</span>&nbsp;<span class="op" id="1791842">==</span>&nbsp;<span class="ident" id="1791845">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1791850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791853">return</span>&nbsp;<span class="ident" id="1791860">isExcludingLatin</span><span class="op" id="1791876">(</span><span class="ident" id="1791877">Lower</span><span class="op" id="1791882">,</span>&nbsp;<span class="ident" id="1791884">r</span><span class="op" id="1791885">)</span><br>
<span class="lineno"></span><span class="op" id="1791887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1791890">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1791950">func</span>&nbsp;<span class="ident" id="1791955">IsTitle</span><span class="op" id="1791962">(</span><span class="ident" id="1791963">r</span>&nbsp;<span class="builtintype" id="1791965">rune</span><span class="op" id="1791969">)</span>&nbsp;<span class="builtintype" id="1791971">bool</span>&nbsp;<span class="op" id="1791976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1791979">if</span>&nbsp;<span class="ident" id="1791982">r</span>&nbsp;<span class="op" id="1791984">&lt;=</span>&nbsp;<span class="ident" id="1791987">MaxLatin1</span>&nbsp;<span class="op" id="1791997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792001">return</span>&nbsp;<span class="builtintype" id="1792008">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1792015">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792018">return</span>&nbsp;<span class="ident" id="1792025">isExcludingLatin</span><span class="op" id="1792041">(</span><span class="ident" id="1792042">Title</span><span class="op" id="1792047">,</span>&nbsp;<span class="ident" id="1792049">r</span><span class="op" id="1792050">)</span><br>
<span class="lineno"></span><span class="op" id="1792052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1792055">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1792109">func</span>&nbsp;<span class="ident" id="1792114">to</span><span class="op" id="1792116">(</span><span class="ident" id="1792117">_case</span>&nbsp;<span class="builtintype" id="1792123">int</span><span class="op" id="1792126">,</span>&nbsp;<span class="ident" id="1792128">r</span>&nbsp;<span class="builtintype" id="1792130">rune</span><span class="op" id="1792134">,</span>&nbsp;<span class="ident" id="1792136">caseRange</span>&nbsp;<span class="op" id="1792146">[</span><span class="op" id="1792147">]</span><span class="ident" id="1792148">CaseRange</span><span class="op" id="1792157">)</span>&nbsp;<span class="builtintype" id="1792159">rune</span>&nbsp;<span class="op" id="1792164">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792167">if</span>&nbsp;<span class="ident" id="1792170">_case</span>&nbsp;<span class="op" id="1792176">&lt;</span>&nbsp;<span class="num" id="1792178">0</span>&nbsp;<span class="op" id="1792180">||</span>&nbsp;<span class="ident" id="1792183">MaxCase</span>&nbsp;<span class="op" id="1792191">&lt;=</span>&nbsp;<span class="ident" id="1792194">_case</span>&nbsp;<span class="op" id="1792200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792204">return</span>&nbsp;<span class="ident" id="1792211">ReplacementChar</span>&nbsp;<span class="comment" id="1792227">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1792261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792264">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1792294">lo</span>&nbsp;<span class="op" id="1792297">:=</span>&nbsp;<span class="num" id="1792300">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1792303">hi</span>&nbsp;<span class="op" id="1792306">:=</span>&nbsp;<span class="builtinfunc" id="1792309">len</span><span class="op" id="1792312">(</span><span class="ident" id="1792313">caseRange</span><span class="op" id="1792322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792325">for</span>&nbsp;<span class="ident" id="1792329">lo</span>&nbsp;<span class="op" id="1792332">&lt;</span>&nbsp;<span class="ident" id="1792334">hi</span>&nbsp;<span class="op" id="1792337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1792341">m</span>&nbsp;<span class="op" id="1792343">:=</span>&nbsp;<span class="ident" id="1792346">lo</span>&nbsp;<span class="op" id="1792349">+</span>&nbsp;<span class="op" id="1792351">(</span><span class="ident" id="1792352">hi</span><span class="op" id="1792354">-</span><span class="ident" id="1792355">lo</span><span class="op" id="1792357">)</span><span class="op" id="1792358">/</span><span class="num" id="1792359">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1792363">cr</span>&nbsp;<span class="op" id="1792366">:=</span>&nbsp;<span class="ident" id="1792369">caseRange</span><span class="op" id="1792378">[</span><span class="ident" id="1792379">m</span><span class="op" id="1792380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792384">if</span>&nbsp;<span class="builtintype" id="1792387">rune</span><span class="op" id="1792391">(</span><span class="ident" id="1792392">cr</span><span class="op" id="1792394">.</span><span class="ident" id="1792395">Lo</span><span class="op" id="1792397">)</span>&nbsp;<span class="op" id="1792399">&lt;=</span>&nbsp;<span class="ident" id="1792402">r</span>&nbsp;<span class="op" id="1792404">&amp;&amp;</span>&nbsp;<span class="ident" id="1792407">r</span>&nbsp;<span class="op" id="1792409">&lt;=</span>&nbsp;<span class="builtintype" id="1792412">rune</span><span class="op" id="1792416">(</span><span class="ident" id="1792417">cr</span><span class="op" id="1792419">.</span><span class="ident" id="1792420">Hi</span><span class="op" id="1792422">)</span>&nbsp;<span class="op" id="1792424">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1792429">delta</span>&nbsp;<span class="op" id="1792435">:=</span>&nbsp;<span class="builtintype" id="1792438">rune</span><span class="op" id="1792442">(</span><span class="ident" id="1792443">cr</span><span class="op" id="1792445">.</span><span class="ident" id="1792446">Delta</span><span class="op" id="1792451">[</span><span class="ident" id="1792452">_case</span><span class="op" id="1792457">]</span><span class="op" id="1792458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1792463">if</span>&nbsp;<span class="ident" id="1792466">delta</span>&nbsp;<span class="op" id="1792472">&gt;</span>&nbsp;<span class="ident" id="1792474">MaxRune</span>&nbsp;<span class="op" id="1792482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792488">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792548">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792610">//&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792656">//&nbsp;&nbsp;&nbsp;&nbsp;{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792714">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792778">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792845">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792915">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1792950">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1793020">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793069">return</span>&nbsp;<span class="builtintype" id="1793076">rune</span><span class="op" id="1793080">(</span><span class="ident" id="1793081">cr</span><span class="op" id="1793083">.</span><span class="ident" id="1793084">Lo</span><span class="op" id="1793086">)</span>&nbsp;<span class="op" id="1793088">+</span>&nbsp;<span class="op" id="1793090">(</span><span class="op" id="1793091">(</span><span class="ident" id="1793092">r</span><span class="op" id="1793093">-</span><span class="builtintype" id="1793094">rune</span><span class="op" id="1793098">(</span><span class="ident" id="1793099">cr</span><span class="op" id="1793101">.</span><span class="ident" id="1793102">Lo</span><span class="op" id="1793104">)</span><span class="op" id="1793105">)</span><span class="op" id="1793106">&amp;^</span><span class="num" id="1793108">1</span>&nbsp;<span class="op" id="1793110">|</span>&nbsp;<span class="builtintype" id="1793112">rune</span><span class="op" id="1793116">(</span><span class="ident" id="1793117">_case</span><span class="op" id="1793122">&amp;</span><span class="num" id="1793123">1</span><span class="op" id="1793124">)</span><span class="op" id="1793125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793135">return</span>&nbsp;<span class="ident" id="1793142">r</span>&nbsp;<span class="op" id="1793144">+</span>&nbsp;<span class="ident" id="1793146">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793158">if</span>&nbsp;<span class="ident" id="1793161">r</span>&nbsp;<span class="op" id="1793163">&lt;</span>&nbsp;<span class="builtintype" id="1793165">rune</span><span class="op" id="1793169">(</span><span class="ident" id="1793170">cr</span><span class="op" id="1793172">.</span><span class="ident" id="1793173">Lo</span><span class="op" id="1793175">)</span>&nbsp;<span class="op" id="1793177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1793182">hi</span>&nbsp;<span class="op" id="1793185">=</span>&nbsp;<span class="ident" id="1793187">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793191">}</span>&nbsp;<span class="keyword" id="1793193">else</span>&nbsp;<span class="op" id="1793198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1793203">lo</span>&nbsp;<span class="op" id="1793206">=</span>&nbsp;<span class="ident" id="1793208">m</span>&nbsp;<span class="op" id="1793210">+</span>&nbsp;<span class="num" id="1793212">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793222">return</span>&nbsp;<span class="ident" id="1793229">r</span><br>
<span class="lineno"></span><span class="op" id="1793231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1793234">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1793313">func</span>&nbsp;<span class="ident" id="1793318">To</span><span class="op" id="1793320">(</span><span class="ident" id="1793321">_case</span>&nbsp;<span class="builtintype" id="1793327">int</span><span class="op" id="1793330">,</span>&nbsp;<span class="ident" id="1793332">r</span>&nbsp;<span class="builtintype" id="1793334">rune</span><span class="op" id="1793338">)</span>&nbsp;<span class="builtintype" id="1793340">rune</span>&nbsp;<span class="op" id="1793345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793348">return</span>&nbsp;<span class="ident" id="1793355">to</span><span class="op" id="1793357">(</span><span class="ident" id="1793358">_case</span><span class="op" id="1793363">,</span>&nbsp;<span class="ident" id="1793365">r</span><span class="op" id="1793366">,</span>&nbsp;<span class="ident" id="1793368">CaseRanges</span><span class="op" id="1793378">)</span><br>
<span class="lineno"></span><span class="op" id="1793380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1793383">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1793423">func</span>&nbsp;<span class="ident" id="1793428">ToUpper</span><span class="op" id="1793435">(</span><span class="ident" id="1793436">r</span>&nbsp;<span class="builtintype" id="1793438">rune</span><span class="op" id="1793442">)</span>&nbsp;<span class="builtintype" id="1793444">rune</span>&nbsp;<span class="op" id="1793449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793452">if</span>&nbsp;<span class="ident" id="1793455">r</span>&nbsp;<span class="op" id="1793457">&lt;=</span>&nbsp;<span class="ident" id="1793460">MaxASCII</span>&nbsp;<span class="op" id="1793469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793473">if</span>&nbsp;<span class="string" id="1793476">&#39;a&#39;</span>&nbsp;<span class="op" id="1793480">&lt;=</span>&nbsp;<span class="ident" id="1793483">r</span>&nbsp;<span class="op" id="1793485">&amp;&amp;</span>&nbsp;<span class="ident" id="1793488">r</span>&nbsp;<span class="op" id="1793490">&lt;=</span>&nbsp;<span class="string" id="1793493">&#39;z&#39;</span>&nbsp;<span class="op" id="1793497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1793502">r</span>&nbsp;<span class="op" id="1793504">-=</span>&nbsp;<span class="string" id="1793507">&#39;a&#39;</span>&nbsp;<span class="op" id="1793511">-</span>&nbsp;<span class="string" id="1793513">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793523">return</span>&nbsp;<span class="ident" id="1793530">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793536">return</span>&nbsp;<span class="ident" id="1793543">To</span><span class="op" id="1793545">(</span><span class="ident" id="1793546">UpperCase</span><span class="op" id="1793555">,</span>&nbsp;<span class="ident" id="1793557">r</span><span class="op" id="1793558">)</span><br>
<span class="lineno"></span><span class="op" id="1793560">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1793563">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1793603">func</span>&nbsp;<span class="ident" id="1793608">ToLower</span><span class="op" id="1793615">(</span><span class="ident" id="1793616">r</span>&nbsp;<span class="builtintype" id="1793618">rune</span><span class="op" id="1793622">)</span>&nbsp;<span class="builtintype" id="1793624">rune</span>&nbsp;<span class="op" id="1793629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793632">if</span>&nbsp;<span class="ident" id="1793635">r</span>&nbsp;<span class="op" id="1793637">&lt;=</span>&nbsp;<span class="ident" id="1793640">MaxASCII</span>&nbsp;<span class="op" id="1793649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793653">if</span>&nbsp;<span class="string" id="1793656">&#39;A&#39;</span>&nbsp;<span class="op" id="1793660">&lt;=</span>&nbsp;<span class="ident" id="1793663">r</span>&nbsp;<span class="op" id="1793665">&amp;&amp;</span>&nbsp;<span class="ident" id="1793668">r</span>&nbsp;<span class="op" id="1793670">&lt;=</span>&nbsp;<span class="string" id="1793673">&#39;Z&#39;</span>&nbsp;<span class="op" id="1793677">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1793682">r</span>&nbsp;<span class="op" id="1793684">+=</span>&nbsp;<span class="string" id="1793687">&#39;a&#39;</span>&nbsp;<span class="op" id="1793691">-</span>&nbsp;<span class="string" id="1793693">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793703">return</span>&nbsp;<span class="ident" id="1793710">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793716">return</span>&nbsp;<span class="ident" id="1793723">To</span><span class="op" id="1793725">(</span><span class="ident" id="1793726">LowerCase</span><span class="op" id="1793735">,</span>&nbsp;<span class="ident" id="1793737">r</span><span class="op" id="1793738">)</span><br>
<span class="lineno">270</span><span class="op" id="1793740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1793743">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1793783">func</span>&nbsp;<span class="ident" id="1793788">ToTitle</span><span class="op" id="1793795">(</span><span class="ident" id="1793796">r</span>&nbsp;<span class="builtintype" id="1793798">rune</span><span class="op" id="1793802">)</span>&nbsp;<span class="builtintype" id="1793804">rune</span>&nbsp;<span class="op" id="1793809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793812">if</span>&nbsp;<span class="ident" id="1793815">r</span>&nbsp;<span class="op" id="1793817">&lt;=</span>&nbsp;<span class="ident" id="1793820">MaxASCII</span>&nbsp;<span class="op" id="1793829">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793833">if</span>&nbsp;<span class="string" id="1793836">&#39;a&#39;</span>&nbsp;<span class="op" id="1793840">&lt;=</span>&nbsp;<span class="ident" id="1793843">r</span>&nbsp;<span class="op" id="1793845">&amp;&amp;</span>&nbsp;<span class="ident" id="1793848">r</span>&nbsp;<span class="op" id="1793850">&lt;=</span>&nbsp;<span class="string" id="1793853">&#39;z&#39;</span>&nbsp;<span class="op" id="1793857">{</span>&nbsp;<span class="comment" id="1793859">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1793900">r</span>&nbsp;<span class="op" id="1793902">-=</span>&nbsp;<span class="string" id="1793905">&#39;a&#39;</span>&nbsp;<span class="op" id="1793909">-</span>&nbsp;<span class="string" id="1793911">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793921">return</span>&nbsp;<span class="ident" id="1793928">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1793931">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1793934">return</span>&nbsp;<span class="ident" id="1793941">To</span><span class="op" id="1793943">(</span><span class="ident" id="1793944">TitleCase</span><span class="op" id="1793953">,</span>&nbsp;<span class="ident" id="1793955">r</span><span class="op" id="1793956">)</span><br>
<span class="lineno"></span><span class="op" id="1793958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1793961">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1794040">func</span>&nbsp;<span class="op" id="1794045">(</span><span class="ident" id="1794046">special</span>&nbsp;<span class="ident" id="1794054">SpecialCase</span><span class="op" id="1794065">)</span>&nbsp;<span class="ident" id="1794067">ToUpper</span><span class="op" id="1794074">(</span><span class="ident" id="1794075">r</span>&nbsp;<span class="builtintype" id="1794077">rune</span><span class="op" id="1794081">)</span>&nbsp;<span class="builtintype" id="1794083">rune</span>&nbsp;<span class="op" id="1794088">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794091">r1</span>&nbsp;<span class="op" id="1794094">:=</span>&nbsp;<span class="ident" id="1794097">to</span><span class="op" id="1794099">(</span><span class="ident" id="1794100">UpperCase</span><span class="op" id="1794109">,</span>&nbsp;<span class="ident" id="1794111">r</span><span class="op" id="1794112">,</span>&nbsp;<span class="op" id="1794114">[</span><span class="op" id="1794115">]</span><span class="ident" id="1794116">CaseRange</span><span class="op" id="1794125">(</span><span class="ident" id="1794126">special</span><span class="op" id="1794133">)</span><span class="op" id="1794134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794137">if</span>&nbsp;<span class="ident" id="1794140">r1</span>&nbsp;<span class="op" id="1794143">==</span>&nbsp;<span class="ident" id="1794146">r</span>&nbsp;<span class="op" id="1794148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794152">r1</span>&nbsp;<span class="op" id="1794155">=</span>&nbsp;<span class="ident" id="1794157">ToUpper</span><span class="op" id="1794164">(</span><span class="ident" id="1794165">r</span><span class="op" id="1794166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1794169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794172">return</span>&nbsp;<span class="ident" id="1794179">r1</span><br>
<span class="lineno">290</span><span class="op" id="1794182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1794185">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1794264">func</span>&nbsp;<span class="op" id="1794269">(</span><span class="ident" id="1794270">special</span>&nbsp;<span class="ident" id="1794278">SpecialCase</span><span class="op" id="1794289">)</span>&nbsp;<span class="ident" id="1794291">ToTitle</span><span class="op" id="1794298">(</span><span class="ident" id="1794299">r</span>&nbsp;<span class="builtintype" id="1794301">rune</span><span class="op" id="1794305">)</span>&nbsp;<span class="builtintype" id="1794307">rune</span>&nbsp;<span class="op" id="1794312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794315">r1</span>&nbsp;<span class="op" id="1794318">:=</span>&nbsp;<span class="ident" id="1794321">to</span><span class="op" id="1794323">(</span><span class="ident" id="1794324">TitleCase</span><span class="op" id="1794333">,</span>&nbsp;<span class="ident" id="1794335">r</span><span class="op" id="1794336">,</span>&nbsp;<span class="op" id="1794338">[</span><span class="op" id="1794339">]</span><span class="ident" id="1794340">CaseRange</span><span class="op" id="1794349">(</span><span class="ident" id="1794350">special</span><span class="op" id="1794357">)</span><span class="op" id="1794358">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794361">if</span>&nbsp;<span class="ident" id="1794364">r1</span>&nbsp;<span class="op" id="1794367">==</span>&nbsp;<span class="ident" id="1794370">r</span>&nbsp;<span class="op" id="1794372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794376">r1</span>&nbsp;<span class="op" id="1794379">=</span>&nbsp;<span class="ident" id="1794381">ToTitle</span><span class="op" id="1794388">(</span><span class="ident" id="1794389">r</span><span class="op" id="1794390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1794393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794396">return</span>&nbsp;<span class="ident" id="1794403">r1</span><br>
<span class="lineno"></span><span class="op" id="1794406">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1794409">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1794488">func</span>&nbsp;<span class="op" id="1794493">(</span><span class="ident" id="1794494">special</span>&nbsp;<span class="ident" id="1794502">SpecialCase</span><span class="op" id="1794513">)</span>&nbsp;<span class="ident" id="1794515">ToLower</span><span class="op" id="1794522">(</span><span class="ident" id="1794523">r</span>&nbsp;<span class="builtintype" id="1794525">rune</span><span class="op" id="1794529">)</span>&nbsp;<span class="builtintype" id="1794531">rune</span>&nbsp;<span class="op" id="1794536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794539">r1</span>&nbsp;<span class="op" id="1794542">:=</span>&nbsp;<span class="ident" id="1794545">to</span><span class="op" id="1794547">(</span><span class="ident" id="1794548">LowerCase</span><span class="op" id="1794557">,</span>&nbsp;<span class="ident" id="1794559">r</span><span class="op" id="1794560">,</span>&nbsp;<span class="op" id="1794562">[</span><span class="op" id="1794563">]</span><span class="ident" id="1794564">CaseRange</span><span class="op" id="1794573">(</span><span class="ident" id="1794574">special</span><span class="op" id="1794581">)</span><span class="op" id="1794582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794585">if</span>&nbsp;<span class="ident" id="1794588">r1</span>&nbsp;<span class="op" id="1794591">==</span>&nbsp;<span class="ident" id="1794594">r</span>&nbsp;<span class="op" id="1794596">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794600">r1</span>&nbsp;<span class="op" id="1794603">=</span>&nbsp;<span class="ident" id="1794605">ToLower</span><span class="op" id="1794612">(</span><span class="ident" id="1794613">r</span><span class="op" id="1794614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1794617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1794620">return</span>&nbsp;<span class="ident" id="1794627">r1</span><br>
<span class="lineno"></span><span class="op" id="1794630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1794633">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1794704">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1794775">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1794852">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1794896">type</span>&nbsp;<span class="ident" id="1794901">foldPair</span>&nbsp;<span class="keyword" id="1794910">struct</span>&nbsp;<span class="op" id="1794917">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794920">From</span>&nbsp;<span class="builtintype" id="1794925">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1794933">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1794938">uint16</span><br>
<span class="lineno"></span><span class="op" id="1794945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1794948">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1795013">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1795080">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1795150">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1795218">//</span><br>
<span class="lineno"></span><span class="comment" id="1795221">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1795237">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1795262">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1795287">//</span><br>
<span class="lineno"></span><span class="comment" id="1795290">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1795315">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;)</span><br>
<span class="lineno">330</span><span class="comment" id="1795366">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1795396">//</span><br>
<span class="lineno"></span><span class="comment" id="1795399">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1795424">//</span><br>
<span class="lineno"></span><span class="keyword" id="1795427">func</span>&nbsp;<span class="ident" id="1795432">SimpleFold</span><span class="op" id="1795442">(</span><span class="ident" id="1795443">r</span>&nbsp;<span class="builtintype" id="1795445">rune</span><span class="op" id="1795449">)</span>&nbsp;<span class="builtintype" id="1795451">rune</span>&nbsp;<span class="op" id="1795456">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1795459">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1795506">lo</span>&nbsp;<span class="op" id="1795509">:=</span>&nbsp;<span class="num" id="1795512">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1795515">hi</span>&nbsp;<span class="op" id="1795518">:=</span>&nbsp;<span class="builtinfunc" id="1795521">len</span><span class="op" id="1795524">(</span><span class="ident" id="1795525">caseOrbit</span><span class="op" id="1795534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795537">for</span>&nbsp;<span class="ident" id="1795541">lo</span>&nbsp;<span class="op" id="1795544">&lt;</span>&nbsp;<span class="ident" id="1795546">hi</span>&nbsp;<span class="op" id="1795549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1795553">m</span>&nbsp;<span class="op" id="1795555">:=</span>&nbsp;<span class="ident" id="1795558">lo</span>&nbsp;<span class="op" id="1795561">+</span>&nbsp;<span class="op" id="1795563">(</span><span class="ident" id="1795564">hi</span><span class="op" id="1795566">-</span><span class="ident" id="1795567">lo</span><span class="op" id="1795569">)</span><span class="op" id="1795570">/</span><span class="num" id="1795571">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795575">if</span>&nbsp;<span class="builtintype" id="1795578">rune</span><span class="op" id="1795582">(</span><span class="ident" id="1795583">caseOrbit</span><span class="op" id="1795592">[</span><span class="ident" id="1795593">m</span><span class="op" id="1795594">]</span><span class="op" id="1795595">.</span><span class="ident" id="1795596">From</span><span class="op" id="1795600">)</span>&nbsp;<span class="op" id="1795602">&lt;</span>&nbsp;<span class="ident" id="1795604">r</span>&nbsp;<span class="op" id="1795606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1795611">lo</span>&nbsp;<span class="op" id="1795614">=</span>&nbsp;<span class="ident" id="1795616">m</span>&nbsp;<span class="op" id="1795618">+</span>&nbsp;<span class="num" id="1795620">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1795624">}</span>&nbsp;<span class="keyword" id="1795626">else</span>&nbsp;<span class="op" id="1795631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1795636">hi</span>&nbsp;<span class="op" id="1795639">=</span>&nbsp;<span class="ident" id="1795641">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1795645">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1795648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795651">if</span>&nbsp;<span class="ident" id="1795654">lo</span>&nbsp;<span class="op" id="1795657">&lt;</span>&nbsp;<span class="builtinfunc" id="1795659">len</span><span class="op" id="1795662">(</span><span class="ident" id="1795663">caseOrbit</span><span class="op" id="1795672">)</span>&nbsp;<span class="op" id="1795674">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1795677">rune</span><span class="op" id="1795681">(</span><span class="ident" id="1795682">caseOrbit</span><span class="op" id="1795691">[</span><span class="ident" id="1795692">lo</span><span class="op" id="1795694">]</span><span class="op" id="1795695">.</span><span class="ident" id="1795696">From</span><span class="op" id="1795700">)</span>&nbsp;<span class="op" id="1795702">==</span>&nbsp;<span class="ident" id="1795705">r</span>&nbsp;<span class="op" id="1795707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795711">return</span>&nbsp;<span class="builtintype" id="1795718">rune</span><span class="op" id="1795722">(</span><span class="ident" id="1795723">caseOrbit</span><span class="op" id="1795732">[</span><span class="ident" id="1795733">lo</span><span class="op" id="1795735">]</span><span class="op" id="1795736">.</span><span class="ident" id="1795737">To</span><span class="op" id="1795739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1795742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1795746">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1795803">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1795859">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795914">if</span>&nbsp;<span class="ident" id="1795917">l</span>&nbsp;<span class="op" id="1795919">:=</span>&nbsp;<span class="ident" id="1795922">ToLower</span><span class="op" id="1795929">(</span><span class="ident" id="1795930">r</span><span class="op" id="1795931">)</span><span class="op" id="1795932">;</span>&nbsp;<span class="ident" id="1795934">l</span>&nbsp;<span class="op" id="1795936">!=</span>&nbsp;<span class="ident" id="1795939">r</span>&nbsp;<span class="op" id="1795941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795945">return</span>&nbsp;<span class="ident" id="1795952">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1795955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1795958">return</span>&nbsp;<span class="ident" id="1795965">ToUpper</span><span class="op" id="1795972">(</span><span class="ident" id="1795973">r</span><span class="op" id="1795974">)</span><br>
<span class="lineno"></span><span class="op" id="1795976">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
