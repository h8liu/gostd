<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html" class="current">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2303458">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2303513">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2303567">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2303618">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2303674">package</span>&nbsp;<span class="ident" id="2303682">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2303691">import</span>&nbsp;<span class="op" id="2303698">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2303701">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2303716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2303719">const</span>&nbsp;<span class="ident" id="2303725">lowerhex</span>&nbsp;<span class="op" id="2303734">=</span>&nbsp;<span class="string" id="2303736">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2303756">func</span>&nbsp;<span class="ident" id="2303761">quoteWith</span><span class="op" id="2303770">(</span><span class="ident" id="2303771">s</span>&nbsp;<span class="builtintype" id="2303773">string</span><span class="op" id="2303779">,</span>&nbsp;<span class="ident" id="2303781">quote</span>&nbsp;<span class="builtintype" id="2303787">byte</span><span class="op" id="2303791">,</span>&nbsp;<span class="ident" id="2303793">ASCIIonly</span>&nbsp;<span class="builtintype" id="2303803">bool</span><span class="op" id="2303807">)</span>&nbsp;<span class="builtintype" id="2303809">string</span>&nbsp;<span class="op" id="2303816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2303819">var</span>&nbsp;<span class="ident" id="2303823">runeTmp</span>&nbsp;<span class="op" id="2303831">[</span><span class="ident" id="2303832">utf8</span><span class="op" id="2303836">.</span><span class="ident" id="2303837">UTFMax</span><span class="op" id="2303843">]</span><span class="builtintype" id="2303844">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2303850">buf</span>&nbsp;<span class="op" id="2303854">:=</span>&nbsp;<span class="builtinfunc" id="2303857">make</span><span class="op" id="2303861">(</span><span class="op" id="2303862">[</span><span class="op" id="2303863">]</span><span class="builtintype" id="2303864">byte</span><span class="op" id="2303868">,</span>&nbsp;<span class="num" id="2303870">0</span><span class="op" id="2303871">,</span>&nbsp;<span class="num" id="2303873">3</span><span class="op" id="2303874">*</span><span class="builtinfunc" id="2303875">len</span><span class="op" id="2303878">(</span><span class="ident" id="2303879">s</span><span class="op" id="2303880">)</span><span class="op" id="2303881">/</span><span class="num" id="2303882">2</span><span class="op" id="2303883">)</span>&nbsp;<span class="comment" id="2303885">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2303920">buf</span>&nbsp;<span class="op" id="2303924">=</span>&nbsp;<span class="builtinfunc" id="2303926">append</span><span class="op" id="2303932">(</span><span class="ident" id="2303933">buf</span><span class="op" id="2303936">,</span>&nbsp;<span class="ident" id="2303938">quote</span><span class="op" id="2303943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2303946">for</span>&nbsp;<span class="ident" id="2303950">width</span>&nbsp;<span class="op" id="2303956">:=</span>&nbsp;<span class="num" id="2303959">0</span><span class="op" id="2303960">;</span>&nbsp;<span class="builtinfunc" id="2303962">len</span><span class="op" id="2303965">(</span><span class="ident" id="2303966">s</span><span class="op" id="2303967">)</span>&nbsp;<span class="op" id="2303969">&gt;</span>&nbsp;<span class="num" id="2303971">0</span><span class="op" id="2303972">;</span>&nbsp;<span class="ident" id="2303974">s</span>&nbsp;<span class="op" id="2303976">=</span>&nbsp;<span class="ident" id="2303978">s</span><span class="op" id="2303979">[</span><span class="ident" id="2303980">width</span><span class="op" id="2303985">:</span><span class="op" id="2303986">]</span>&nbsp;<span class="op" id="2303988">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2303992">r</span>&nbsp;<span class="op" id="2303994">:=</span>&nbsp;<span class="builtintype" id="2303997">rune</span><span class="op" id="2304001">(</span><span class="ident" id="2304002">s</span><span class="op" id="2304003">[</span><span class="num" id="2304004">0</span><span class="op" id="2304005">]</span><span class="op" id="2304006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304010">width</span>&nbsp;<span class="op" id="2304016">=</span>&nbsp;<span class="num" id="2304018">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304022">if</span>&nbsp;<span class="ident" id="2304025">r</span>&nbsp;<span class="op" id="2304027">&gt;=</span>&nbsp;<span class="ident" id="2304030">utf8</span><span class="op" id="2304034">.</span><span class="ident" id="2304035">RuneSelf</span>&nbsp;<span class="op" id="2304044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304049">r</span><span class="op" id="2304050">,</span>&nbsp;<span class="ident" id="2304052">width</span>&nbsp;<span class="op" id="2304058">=</span>&nbsp;<span class="ident" id="2304060">utf8</span><span class="op" id="2304064">.</span><span class="ident" id="2304065">DecodeRuneInString</span><span class="op" id="2304083">(</span><span class="ident" id="2304084">s</span><span class="op" id="2304085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304089">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304093">if</span>&nbsp;<span class="ident" id="2304096">width</span>&nbsp;<span class="op" id="2304102">==</span>&nbsp;<span class="num" id="2304105">1</span>&nbsp;<span class="op" id="2304107">&amp;&amp;</span>&nbsp;<span class="ident" id="2304110">r</span>&nbsp;<span class="op" id="2304112">==</span>&nbsp;<span class="ident" id="2304115">utf8</span><span class="op" id="2304119">.</span><span class="ident" id="2304120">RuneError</span>&nbsp;<span class="op" id="2304130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304135">buf</span>&nbsp;<span class="op" id="2304139">=</span>&nbsp;<span class="builtinfunc" id="2304141">append</span><span class="op" id="2304147">(</span><span class="ident" id="2304148">buf</span><span class="op" id="2304151">,</span>&nbsp;<span class="string" id="2304153">`\x`</span><span class="op" id="2304157">...</span><span class="op" id="2304160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304165">buf</span>&nbsp;<span class="op" id="2304169">=</span>&nbsp;<span class="builtinfunc" id="2304171">append</span><span class="op" id="2304177">(</span><span class="ident" id="2304178">buf</span><span class="op" id="2304181">,</span>&nbsp;<span class="ident" id="2304183">lowerhex</span><span class="op" id="2304191">[</span><span class="ident" id="2304192">s</span><span class="op" id="2304193">[</span><span class="num" id="2304194">0</span><span class="op" id="2304195">]</span><span class="op" id="2304196">&gt;&gt;</span><span class="num" id="2304198">4</span><span class="op" id="2304199">]</span><span class="op" id="2304200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304205">buf</span>&nbsp;<span class="op" id="2304209">=</span>&nbsp;<span class="builtinfunc" id="2304211">append</span><span class="op" id="2304217">(</span><span class="ident" id="2304218">buf</span><span class="op" id="2304221">,</span>&nbsp;<span class="ident" id="2304223">lowerhex</span><span class="op" id="2304231">[</span><span class="ident" id="2304232">s</span><span class="op" id="2304233">[</span><span class="num" id="2304234">0</span><span class="op" id="2304235">]</span><span class="op" id="2304236">&amp;</span><span class="num" id="2304237">0xF</span><span class="op" id="2304240">]</span><span class="op" id="2304241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304246">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304261">if</span>&nbsp;<span class="ident" id="2304264">r</span>&nbsp;<span class="op" id="2304266">==</span>&nbsp;<span class="builtintype" id="2304269">rune</span><span class="op" id="2304273">(</span><span class="ident" id="2304274">quote</span><span class="op" id="2304279">)</span>&nbsp;<span class="op" id="2304281">||</span>&nbsp;<span class="ident" id="2304284">r</span>&nbsp;<span class="op" id="2304286">==</span>&nbsp;<span class="string" id="2304289">&#39;\\&#39;</span>&nbsp;<span class="op" id="2304294">{</span>&nbsp;<span class="comment" id="2304296">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304321">buf</span>&nbsp;<span class="op" id="2304325">=</span>&nbsp;<span class="builtinfunc" id="2304327">append</span><span class="op" id="2304333">(</span><span class="ident" id="2304334">buf</span><span class="op" id="2304337">,</span>&nbsp;<span class="string" id="2304339">&#39;\\&#39;</span><span class="op" id="2304343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304348">buf</span>&nbsp;<span class="op" id="2304352">=</span>&nbsp;<span class="builtinfunc" id="2304354">append</span><span class="op" id="2304360">(</span><span class="ident" id="2304361">buf</span><span class="op" id="2304364">,</span>&nbsp;<span class="builtintype" id="2304366">byte</span><span class="op" id="2304370">(</span><span class="ident" id="2304371">r</span><span class="op" id="2304372">)</span><span class="op" id="2304373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304378">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304393">if</span>&nbsp;<span class="ident" id="2304396">ASCIIonly</span>&nbsp;<span class="op" id="2304406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304411">if</span>&nbsp;<span class="ident" id="2304414">r</span>&nbsp;<span class="op" id="2304416">&lt;</span>&nbsp;<span class="ident" id="2304418">utf8</span><span class="op" id="2304422">.</span><span class="ident" id="2304423">RuneSelf</span>&nbsp;<span class="op" id="2304432">&amp;&amp;</span>&nbsp;<span class="ident" id="2304435">IsPrint</span><span class="op" id="2304442">(</span><span class="ident" id="2304443">r</span><span class="op" id="2304444">)</span>&nbsp;<span class="op" id="2304446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304452">buf</span>&nbsp;<span class="op" id="2304456">=</span>&nbsp;<span class="builtinfunc" id="2304458">append</span><span class="op" id="2304464">(</span><span class="ident" id="2304465">buf</span><span class="op" id="2304468">,</span>&nbsp;<span class="builtintype" id="2304470">byte</span><span class="op" id="2304474">(</span><span class="ident" id="2304475">r</span><span class="op" id="2304476">)</span><span class="op" id="2304477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304483">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304499">}</span>&nbsp;<span class="keyword" id="2304501">else</span>&nbsp;<span class="keyword" id="2304506">if</span>&nbsp;<span class="ident" id="2304509">IsPrint</span><span class="op" id="2304516">(</span><span class="ident" id="2304517">r</span><span class="op" id="2304518">)</span>&nbsp;<span class="op" id="2304520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304525">n</span>&nbsp;<span class="op" id="2304527">:=</span>&nbsp;<span class="ident" id="2304530">utf8</span><span class="op" id="2304534">.</span><span class="ident" id="2304535">EncodeRune</span><span class="op" id="2304545">(</span><span class="ident" id="2304546">runeTmp</span><span class="op" id="2304553">[</span><span class="op" id="2304554">:</span><span class="op" id="2304555">]</span><span class="op" id="2304556">,</span>&nbsp;<span class="ident" id="2304558">r</span><span class="op" id="2304559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304564">buf</span>&nbsp;<span class="op" id="2304568">=</span>&nbsp;<span class="builtinfunc" id="2304570">append</span><span class="op" id="2304576">(</span><span class="ident" id="2304577">buf</span><span class="op" id="2304580">,</span>&nbsp;<span class="ident" id="2304582">runeTmp</span><span class="op" id="2304589">[</span><span class="op" id="2304590">:</span><span class="ident" id="2304591">n</span><span class="op" id="2304592">]</span><span class="op" id="2304593">...</span><span class="op" id="2304596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304601">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2304612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304616">switch</span>&nbsp;<span class="ident" id="2304623">r</span>&nbsp;<span class="op" id="2304625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304629">case</span>&nbsp;<span class="string" id="2304634">&#39;\a&#39;</span><span class="op" id="2304638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304643">buf</span>&nbsp;<span class="op" id="2304647">=</span>&nbsp;<span class="builtinfunc" id="2304649">append</span><span class="op" id="2304655">(</span><span class="ident" id="2304656">buf</span><span class="op" id="2304659">,</span>&nbsp;<span class="string" id="2304661">`\a`</span><span class="op" id="2304665">...</span><span class="op" id="2304668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304672">case</span>&nbsp;<span class="string" id="2304677">&#39;\b&#39;</span><span class="op" id="2304681">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304686">buf</span>&nbsp;<span class="op" id="2304690">=</span>&nbsp;<span class="builtinfunc" id="2304692">append</span><span class="op" id="2304698">(</span><span class="ident" id="2304699">buf</span><span class="op" id="2304702">,</span>&nbsp;<span class="string" id="2304704">`\b`</span><span class="op" id="2304708">...</span><span class="op" id="2304711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304715">case</span>&nbsp;<span class="string" id="2304720">&#39;\f&#39;</span><span class="op" id="2304724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304729">buf</span>&nbsp;<span class="op" id="2304733">=</span>&nbsp;<span class="builtinfunc" id="2304735">append</span><span class="op" id="2304741">(</span><span class="ident" id="2304742">buf</span><span class="op" id="2304745">,</span>&nbsp;<span class="string" id="2304747">`\f`</span><span class="op" id="2304751">...</span><span class="op" id="2304754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304758">case</span>&nbsp;<span class="string" id="2304763">&#39;\n&#39;</span><span class="op" id="2304767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304772">buf</span>&nbsp;<span class="op" id="2304776">=</span>&nbsp;<span class="builtinfunc" id="2304778">append</span><span class="op" id="2304784">(</span><span class="ident" id="2304785">buf</span><span class="op" id="2304788">,</span>&nbsp;<span class="string" id="2304790">`\n`</span><span class="op" id="2304794">...</span><span class="op" id="2304797">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304801">case</span>&nbsp;<span class="string" id="2304806">&#39;\r&#39;</span><span class="op" id="2304810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304815">buf</span>&nbsp;<span class="op" id="2304819">=</span>&nbsp;<span class="builtinfunc" id="2304821">append</span><span class="op" id="2304827">(</span><span class="ident" id="2304828">buf</span><span class="op" id="2304831">,</span>&nbsp;<span class="string" id="2304833">`\r`</span><span class="op" id="2304837">...</span><span class="op" id="2304840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304844">case</span>&nbsp;<span class="string" id="2304849">&#39;\t&#39;</span><span class="op" id="2304853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304858">buf</span>&nbsp;<span class="op" id="2304862">=</span>&nbsp;<span class="builtinfunc" id="2304864">append</span><span class="op" id="2304870">(</span><span class="ident" id="2304871">buf</span><span class="op" id="2304874">,</span>&nbsp;<span class="string" id="2304876">`\t`</span><span class="op" id="2304880">...</span><span class="op" id="2304883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304887">case</span>&nbsp;<span class="string" id="2304892">&#39;\v&#39;</span><span class="op" id="2304896">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304901">buf</span>&nbsp;<span class="op" id="2304905">=</span>&nbsp;<span class="builtinfunc" id="2304907">append</span><span class="op" id="2304913">(</span><span class="ident" id="2304914">buf</span><span class="op" id="2304917">,</span>&nbsp;<span class="string" id="2304919">`\v`</span><span class="op" id="2304923">...</span><span class="op" id="2304926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304930">default</span><span class="op" id="2304937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304942">switch</span>&nbsp;<span class="op" id="2304949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2304954">case</span>&nbsp;<span class="ident" id="2304959">r</span>&nbsp;<span class="op" id="2304961">&lt;</span>&nbsp;<span class="string" id="2304963">&#39;&nbsp;&#39;</span><span class="op" id="2304966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2304972">buf</span>&nbsp;<span class="op" id="2304976">=</span>&nbsp;<span class="builtinfunc" id="2304978">append</span><span class="op" id="2304984">(</span><span class="ident" id="2304985">buf</span><span class="op" id="2304988">,</span>&nbsp;<span class="string" id="2304990">`\x`</span><span class="op" id="2304994">...</span><span class="op" id="2304997">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305003">buf</span>&nbsp;<span class="op" id="2305007">=</span>&nbsp;<span class="builtinfunc" id="2305009">append</span><span class="op" id="2305015">(</span><span class="ident" id="2305016">buf</span><span class="op" id="2305019">,</span>&nbsp;<span class="ident" id="2305021">lowerhex</span><span class="op" id="2305029">[</span><span class="ident" id="2305030">s</span><span class="op" id="2305031">[</span><span class="num" id="2305032">0</span><span class="op" id="2305033">]</span><span class="op" id="2305034">&gt;&gt;</span><span class="num" id="2305036">4</span><span class="op" id="2305037">]</span><span class="op" id="2305038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305044">buf</span>&nbsp;<span class="op" id="2305048">=</span>&nbsp;<span class="builtinfunc" id="2305050">append</span><span class="op" id="2305056">(</span><span class="ident" id="2305057">buf</span><span class="op" id="2305060">,</span>&nbsp;<span class="ident" id="2305062">lowerhex</span><span class="op" id="2305070">[</span><span class="ident" id="2305071">s</span><span class="op" id="2305072">[</span><span class="num" id="2305073">0</span><span class="op" id="2305074">]</span><span class="op" id="2305075">&amp;</span><span class="num" id="2305076">0xF</span><span class="op" id="2305079">]</span><span class="op" id="2305080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305085">case</span>&nbsp;<span class="ident" id="2305090">r</span>&nbsp;<span class="op" id="2305092">&gt;</span>&nbsp;<span class="ident" id="2305094">utf8</span><span class="op" id="2305098">.</span><span class="ident" id="2305099">MaxRune</span><span class="op" id="2305106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305112">r</span>&nbsp;<span class="op" id="2305114">=</span>&nbsp;<span class="num" id="2305116">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305127">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305142">case</span>&nbsp;<span class="ident" id="2305147">r</span>&nbsp;<span class="op" id="2305149">&lt;</span>&nbsp;<span class="num" id="2305151">0x10000</span><span class="op" id="2305158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305164">buf</span>&nbsp;<span class="op" id="2305168">=</span>&nbsp;<span class="builtinfunc" id="2305170">append</span><span class="op" id="2305176">(</span><span class="ident" id="2305177">buf</span><span class="op" id="2305180">,</span>&nbsp;<span class="string" id="2305182">`\u`</span><span class="op" id="2305186">...</span><span class="op" id="2305189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305195">for</span>&nbsp;<span class="ident" id="2305199">s</span>&nbsp;<span class="op" id="2305201">:=</span>&nbsp;<span class="num" id="2305204">12</span><span class="op" id="2305206">;</span>&nbsp;<span class="ident" id="2305208">s</span>&nbsp;<span class="op" id="2305210">&gt;=</span>&nbsp;<span class="num" id="2305213">0</span><span class="op" id="2305214">;</span>&nbsp;<span class="ident" id="2305216">s</span>&nbsp;<span class="op" id="2305218">-=</span>&nbsp;<span class="num" id="2305221">4</span>&nbsp;<span class="op" id="2305223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305230">buf</span>&nbsp;<span class="op" id="2305234">=</span>&nbsp;<span class="builtinfunc" id="2305236">append</span><span class="op" id="2305242">(</span><span class="ident" id="2305243">buf</span><span class="op" id="2305246">,</span>&nbsp;<span class="ident" id="2305248">lowerhex</span><span class="op" id="2305256">[</span><span class="ident" id="2305257">r</span><span class="op" id="2305258">&gt;&gt;</span><span class="builtintype" id="2305260">uint</span><span class="op" id="2305264">(</span><span class="ident" id="2305265">s</span><span class="op" id="2305266">)</span><span class="op" id="2305267">&amp;</span><span class="num" id="2305268">0xF</span><span class="op" id="2305271">]</span><span class="op" id="2305272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2305278">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305283">default</span><span class="op" id="2305290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305296">buf</span>&nbsp;<span class="op" id="2305300">=</span>&nbsp;<span class="builtinfunc" id="2305302">append</span><span class="op" id="2305308">(</span><span class="ident" id="2305309">buf</span><span class="op" id="2305312">,</span>&nbsp;<span class="string" id="2305314">`\U`</span><span class="op" id="2305318">...</span><span class="op" id="2305321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305327">for</span>&nbsp;<span class="ident" id="2305331">s</span>&nbsp;<span class="op" id="2305333">:=</span>&nbsp;<span class="num" id="2305336">28</span><span class="op" id="2305338">;</span>&nbsp;<span class="ident" id="2305340">s</span>&nbsp;<span class="op" id="2305342">&gt;=</span>&nbsp;<span class="num" id="2305345">0</span><span class="op" id="2305346">;</span>&nbsp;<span class="ident" id="2305348">s</span>&nbsp;<span class="op" id="2305350">-=</span>&nbsp;<span class="num" id="2305353">4</span>&nbsp;<span class="op" id="2305355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305362">buf</span>&nbsp;<span class="op" id="2305366">=</span>&nbsp;<span class="builtinfunc" id="2305368">append</span><span class="op" id="2305374">(</span><span class="ident" id="2305375">buf</span><span class="op" id="2305378">,</span>&nbsp;<span class="ident" id="2305380">lowerhex</span><span class="op" id="2305388">[</span><span class="ident" id="2305389">r</span><span class="op" id="2305390">&gt;&gt;</span><span class="builtintype" id="2305392">uint</span><span class="op" id="2305396">(</span><span class="ident" id="2305397">s</span><span class="op" id="2305398">)</span><span class="op" id="2305399">&amp;</span><span class="num" id="2305400">0xF</span><span class="op" id="2305403">]</span><span class="op" id="2305404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2305410">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2305415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2305419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2305422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2305425">buf</span>&nbsp;<span class="op" id="2305429">=</span>&nbsp;<span class="builtinfunc" id="2305431">append</span><span class="op" id="2305437">(</span><span class="ident" id="2305438">buf</span><span class="op" id="2305441">,</span>&nbsp;<span class="ident" id="2305443">quote</span><span class="op" id="2305448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305451">return</span>&nbsp;<span class="builtintype" id="2305458">string</span><span class="op" id="2305464">(</span><span class="ident" id="2305465">buf</span><span class="op" id="2305468">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2305471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2305474">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2305546">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2305617">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2305682">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2305694">func</span>&nbsp;<span class="ident" id="2305699">Quote</span><span class="op" id="2305704">(</span><span class="ident" id="2305705">s</span>&nbsp;<span class="builtintype" id="2305707">string</span><span class="op" id="2305713">)</span>&nbsp;<span class="builtintype" id="2305715">string</span>&nbsp;<span class="op" id="2305722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305725">return</span>&nbsp;<span class="ident" id="2305732">quoteWith</span><span class="op" id="2305741">(</span><span class="ident" id="2305742">s</span><span class="op" id="2305743">,</span>&nbsp;<span class="string" id="2305745">&#39;&#34;&#39;</span><span class="op" id="2305748">,</span>&nbsp;<span class="builtintype" id="2305750">false</span><span class="op" id="2305755">)</span><br>
<span class="lineno"></span><span class="op" id="2305757">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2305760">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2305833">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2305899">func</span>&nbsp;<span class="ident" id="2305904">AppendQuote</span><span class="op" id="2305915">(</span><span class="ident" id="2305916">dst</span>&nbsp;<span class="op" id="2305920">[</span><span class="op" id="2305921">]</span><span class="builtintype" id="2305922">byte</span><span class="op" id="2305926">,</span>&nbsp;<span class="ident" id="2305928">s</span>&nbsp;<span class="builtintype" id="2305930">string</span><span class="op" id="2305936">)</span>&nbsp;<span class="op" id="2305938">[</span><span class="op" id="2305939">]</span><span class="builtintype" id="2305940">byte</span>&nbsp;<span class="op" id="2305945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2305948">return</span>&nbsp;<span class="builtinfunc" id="2305955">append</span><span class="op" id="2305961">(</span><span class="ident" id="2305962">dst</span><span class="op" id="2305965">,</span>&nbsp;<span class="ident" id="2305967">Quote</span><span class="op" id="2305972">(</span><span class="ident" id="2305973">s</span><span class="op" id="2305974">)</span><span class="op" id="2305975">...</span><span class="op" id="2305978">)</span><br>
<span class="lineno">100</span><span class="op" id="2305980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2305983">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2306057">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2306132">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2306208">func</span>&nbsp;<span class="ident" id="2306213">QuoteToASCII</span><span class="op" id="2306225">(</span><span class="ident" id="2306226">s</span>&nbsp;<span class="builtintype" id="2306228">string</span><span class="op" id="2306234">)</span>&nbsp;<span class="builtintype" id="2306236">string</span>&nbsp;<span class="op" id="2306243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2306246">return</span>&nbsp;<span class="ident" id="2306253">quoteWith</span><span class="op" id="2306262">(</span><span class="ident" id="2306263">s</span><span class="op" id="2306264">,</span>&nbsp;<span class="string" id="2306266">&#39;&#34;&#39;</span><span class="op" id="2306269">,</span>&nbsp;<span class="builtintype" id="2306271">true</span><span class="op" id="2306275">)</span><br>
<span class="lineno"></span><span class="op" id="2306277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2306280">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2306360">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2306433">func</span>&nbsp;<span class="ident" id="2306438">AppendQuoteToASCII</span><span class="op" id="2306456">(</span><span class="ident" id="2306457">dst</span>&nbsp;<span class="op" id="2306461">[</span><span class="op" id="2306462">]</span><span class="builtintype" id="2306463">byte</span><span class="op" id="2306467">,</span>&nbsp;<span class="ident" id="2306469">s</span>&nbsp;<span class="builtintype" id="2306471">string</span><span class="op" id="2306477">)</span>&nbsp;<span class="op" id="2306479">[</span><span class="op" id="2306480">]</span><span class="builtintype" id="2306481">byte</span>&nbsp;<span class="op" id="2306486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2306489">return</span>&nbsp;<span class="builtinfunc" id="2306496">append</span><span class="op" id="2306502">(</span><span class="ident" id="2306503">dst</span><span class="op" id="2306506">,</span>&nbsp;<span class="ident" id="2306508">QuoteToASCII</span><span class="op" id="2306520">(</span><span class="ident" id="2306521">s</span><span class="op" id="2306522">)</span><span class="op" id="2306523">...</span><span class="op" id="2306526">)</span><br>
<span class="lineno"></span><span class="op" id="2306528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2306531">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2306606">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2306684">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2306762">func</span>&nbsp;<span class="ident" id="2306767">QuoteRune</span><span class="op" id="2306776">(</span><span class="ident" id="2306777">r</span>&nbsp;<span class="builtintype" id="2306779">rune</span><span class="op" id="2306783">)</span>&nbsp;<span class="builtintype" id="2306785">string</span>&nbsp;<span class="op" id="2306792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2306795">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2306832">return</span>&nbsp;<span class="ident" id="2306839">quoteWith</span><span class="op" id="2306848">(</span><span class="builtintype" id="2306849">string</span><span class="op" id="2306855">(</span><span class="ident" id="2306856">r</span><span class="op" id="2306857">)</span><span class="op" id="2306858">,</span>&nbsp;<span class="string" id="2306860">&#39;\&#39;&#39;</span><span class="op" id="2306864">,</span>&nbsp;<span class="builtintype" id="2306866">false</span><span class="op" id="2306871">)</span><br>
<span class="lineno"></span><span class="op" id="2306873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2306876">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2306963">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2307033">func</span>&nbsp;<span class="ident" id="2307038">AppendQuoteRune</span><span class="op" id="2307053">(</span><span class="ident" id="2307054">dst</span>&nbsp;<span class="op" id="2307058">[</span><span class="op" id="2307059">]</span><span class="builtintype" id="2307060">byte</span><span class="op" id="2307064">,</span>&nbsp;<span class="ident" id="2307066">r</span>&nbsp;<span class="builtintype" id="2307068">rune</span><span class="op" id="2307072">)</span>&nbsp;<span class="op" id="2307074">[</span><span class="op" id="2307075">]</span><span class="builtintype" id="2307076">byte</span>&nbsp;<span class="op" id="2307081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2307084">return</span>&nbsp;<span class="builtinfunc" id="2307091">append</span><span class="op" id="2307097">(</span><span class="ident" id="2307098">dst</span><span class="op" id="2307101">,</span>&nbsp;<span class="ident" id="2307103">QuoteRune</span><span class="op" id="2307112">(</span><span class="ident" id="2307113">r</span><span class="op" id="2307114">)</span><span class="op" id="2307115">...</span><span class="op" id="2307118">)</span><br>
<span class="lineno"></span><span class="op" id="2307120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2307123">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2307201">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2307275">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2307351">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2307366">func</span>&nbsp;<span class="ident" id="2307371">QuoteRuneToASCII</span><span class="op" id="2307387">(</span><span class="ident" id="2307388">r</span>&nbsp;<span class="builtintype" id="2307390">rune</span><span class="op" id="2307394">)</span>&nbsp;<span class="builtintype" id="2307396">string</span>&nbsp;<span class="op" id="2307403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2307406">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2307443">return</span>&nbsp;<span class="ident" id="2307450">quoteWith</span><span class="op" id="2307459">(</span><span class="builtintype" id="2307460">string</span><span class="op" id="2307466">(</span><span class="ident" id="2307467">r</span><span class="op" id="2307468">)</span><span class="op" id="2307469">,</span>&nbsp;<span class="string" id="2307471">&#39;\&#39;&#39;</span><span class="op" id="2307475">,</span>&nbsp;<span class="builtintype" id="2307477">true</span><span class="op" id="2307481">)</span><br>
<span class="lineno"></span><span class="op" id="2307483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2307486">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2307580">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2307657">func</span>&nbsp;<span class="ident" id="2307662">AppendQuoteRuneToASCII</span><span class="op" id="2307684">(</span><span class="ident" id="2307685">dst</span>&nbsp;<span class="op" id="2307689">[</span><span class="op" id="2307690">]</span><span class="builtintype" id="2307691">byte</span><span class="op" id="2307695">,</span>&nbsp;<span class="ident" id="2307697">r</span>&nbsp;<span class="builtintype" id="2307699">rune</span><span class="op" id="2307703">)</span>&nbsp;<span class="op" id="2307705">[</span><span class="op" id="2307706">]</span><span class="builtintype" id="2307707">byte</span>&nbsp;<span class="op" id="2307712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2307715">return</span>&nbsp;<span class="builtinfunc" id="2307722">append</span><span class="op" id="2307728">(</span><span class="ident" id="2307729">dst</span><span class="op" id="2307732">,</span>&nbsp;<span class="ident" id="2307734">QuoteRuneToASCII</span><span class="op" id="2307750">(</span><span class="ident" id="2307751">r</span><span class="op" id="2307752">)</span><span class="op" id="2307753">...</span><span class="op" id="2307756">)</span><br>
<span class="lineno"></span><span class="op" id="2307758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2307761">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2307825">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2307889">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2307919">func</span>&nbsp;<span class="ident" id="2307924">CanBackquote</span><span class="op" id="2307936">(</span><span class="ident" id="2307937">s</span>&nbsp;<span class="builtintype" id="2307939">string</span><span class="op" id="2307945">)</span>&nbsp;<span class="builtintype" id="2307947">bool</span>&nbsp;<span class="op" id="2307952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2307955">for</span>&nbsp;<span class="builtinfunc" id="2307959">len</span><span class="op" id="2307962">(</span><span class="ident" id="2307963">s</span><span class="op" id="2307964">)</span>&nbsp;<span class="op" id="2307966">&gt;</span>&nbsp;<span class="num" id="2307968">0</span>&nbsp;<span class="op" id="2307970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2307974">r</span><span class="op" id="2307975">,</span>&nbsp;<span class="ident" id="2307977">wid</span>&nbsp;<span class="op" id="2307981">:=</span>&nbsp;<span class="ident" id="2307984">utf8</span><span class="op" id="2307988">.</span><span class="ident" id="2307989">DecodeRuneInString</span><span class="op" id="2308007">(</span><span class="ident" id="2308008">s</span><span class="op" id="2308009">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2308013">s</span>&nbsp;<span class="op" id="2308015">=</span>&nbsp;<span class="ident" id="2308017">s</span><span class="op" id="2308018">[</span><span class="ident" id="2308019">wid</span><span class="op" id="2308022">:</span><span class="op" id="2308023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308027">if</span>&nbsp;<span class="ident" id="2308030">wid</span>&nbsp;<span class="op" id="2308034">&gt;</span>&nbsp;<span class="num" id="2308036">1</span>&nbsp;<span class="op" id="2308038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308043">if</span>&nbsp;<span class="ident" id="2308046">r</span>&nbsp;<span class="op" id="2308048">==</span>&nbsp;<span class="string" id="2308051">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2308060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308066">return</span>&nbsp;<span class="builtintype" id="2308073">false</span>&nbsp;<span class="comment" id="2308079">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308130">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308135">continue</span>&nbsp;<span class="comment" id="2308144">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308224">if</span>&nbsp;<span class="ident" id="2308227">r</span>&nbsp;<span class="op" id="2308229">==</span>&nbsp;<span class="ident" id="2308232">utf8</span><span class="op" id="2308236">.</span><span class="ident" id="2308237">RuneError</span>&nbsp;<span class="op" id="2308247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308252">return</span>&nbsp;<span class="builtintype" id="2308259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308267">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308271">if</span>&nbsp;<span class="op" id="2308274">(</span><span class="ident" id="2308275">r</span>&nbsp;<span class="op" id="2308277">&lt;</span>&nbsp;<span class="string" id="2308279">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2308283">&amp;&amp;</span>&nbsp;<span class="ident" id="2308286">r</span>&nbsp;<span class="op" id="2308288">!=</span>&nbsp;<span class="string" id="2308291">&#39;\t&#39;</span><span class="op" id="2308295">)</span>&nbsp;<span class="op" id="2308297">||</span>&nbsp;<span class="ident" id="2308300">r</span>&nbsp;<span class="op" id="2308302">==</span>&nbsp;<span class="string" id="2308305">&#39;`&#39;</span>&nbsp;<span class="op" id="2308309">||</span>&nbsp;<span class="ident" id="2308312">r</span>&nbsp;<span class="op" id="2308314">==</span>&nbsp;<span class="string" id="2308317">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2308326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308331">return</span>&nbsp;<span class="builtintype" id="2308338">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308352">return</span>&nbsp;<span class="builtintype" id="2308359">true</span><br>
<span class="lineno">165</span><span class="op" id="2308364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2308367">func</span>&nbsp;<span class="ident" id="2308372">unhex</span><span class="op" id="2308377">(</span><span class="ident" id="2308378">b</span>&nbsp;<span class="builtintype" id="2308380">byte</span><span class="op" id="2308384">)</span>&nbsp;<span class="op" id="2308386">(</span><span class="ident" id="2308387">v</span>&nbsp;<span class="builtintype" id="2308389">rune</span><span class="op" id="2308393">,</span>&nbsp;<span class="ident" id="2308395">ok</span>&nbsp;<span class="builtintype" id="2308398">bool</span><span class="op" id="2308402">)</span>&nbsp;<span class="op" id="2308404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2308407">c</span>&nbsp;<span class="op" id="2308409">:=</span>&nbsp;<span class="builtintype" id="2308412">rune</span><span class="op" id="2308416">(</span><span class="ident" id="2308417">b</span><span class="op" id="2308418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308421">switch</span>&nbsp;<span class="op" id="2308428">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308431">case</span>&nbsp;<span class="string" id="2308436">&#39;0&#39;</span>&nbsp;<span class="op" id="2308440">&lt;=</span>&nbsp;<span class="ident" id="2308443">c</span>&nbsp;<span class="op" id="2308445">&amp;&amp;</span>&nbsp;<span class="ident" id="2308448">c</span>&nbsp;<span class="op" id="2308450">&lt;=</span>&nbsp;<span class="string" id="2308453">&#39;9&#39;</span><span class="op" id="2308456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308460">return</span>&nbsp;<span class="ident" id="2308467">c</span>&nbsp;<span class="op" id="2308469">-</span>&nbsp;<span class="string" id="2308471">&#39;0&#39;</span><span class="op" id="2308474">,</span>&nbsp;<span class="builtintype" id="2308476">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308482">case</span>&nbsp;<span class="string" id="2308487">&#39;a&#39;</span>&nbsp;<span class="op" id="2308491">&lt;=</span>&nbsp;<span class="ident" id="2308494">c</span>&nbsp;<span class="op" id="2308496">&amp;&amp;</span>&nbsp;<span class="ident" id="2308499">c</span>&nbsp;<span class="op" id="2308501">&lt;=</span>&nbsp;<span class="string" id="2308504">&#39;f&#39;</span><span class="op" id="2308507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308511">return</span>&nbsp;<span class="ident" id="2308518">c</span>&nbsp;<span class="op" id="2308520">-</span>&nbsp;<span class="string" id="2308522">&#39;a&#39;</span>&nbsp;<span class="op" id="2308526">+</span>&nbsp;<span class="num" id="2308528">10</span><span class="op" id="2308530">,</span>&nbsp;<span class="builtintype" id="2308532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308538">case</span>&nbsp;<span class="string" id="2308543">&#39;A&#39;</span>&nbsp;<span class="op" id="2308547">&lt;=</span>&nbsp;<span class="ident" id="2308550">c</span>&nbsp;<span class="op" id="2308552">&amp;&amp;</span>&nbsp;<span class="ident" id="2308555">c</span>&nbsp;<span class="op" id="2308557">&lt;=</span>&nbsp;<span class="string" id="2308560">&#39;F&#39;</span><span class="op" id="2308563">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308567">return</span>&nbsp;<span class="ident" id="2308574">c</span>&nbsp;<span class="op" id="2308576">-</span>&nbsp;<span class="string" id="2308578">&#39;A&#39;</span>&nbsp;<span class="op" id="2308582">+</span>&nbsp;<span class="num" id="2308584">10</span><span class="op" id="2308586">,</span>&nbsp;<span class="builtintype" id="2308588">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2308594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2308597">return</span><br>
<span class="lineno"></span><span class="op" id="2308604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2308607">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2308680">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2308733">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2308760">//</span><br>
<span class="lineno"></span><span class="comment" id="2308763">//&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2308822">//&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2308933">//&nbsp;&nbsp;&nbsp;&nbsp;3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2308998">//&nbsp;&nbsp;&nbsp;&nbsp;4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2309071">//</span><br>
<span class="lineno"></span><span class="comment" id="2309074">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2309148">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2309209">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2309292">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2309362">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2309468">func</span>&nbsp;<span class="ident" id="2309473">UnquoteChar</span><span class="op" id="2309484">(</span><span class="ident" id="2309485">s</span>&nbsp;<span class="builtintype" id="2309487">string</span><span class="op" id="2309493">,</span>&nbsp;<span class="ident" id="2309495">quote</span>&nbsp;<span class="builtintype" id="2309501">byte</span><span class="op" id="2309505">)</span>&nbsp;<span class="op" id="2309507">(</span><span class="ident" id="2309508">value</span>&nbsp;<span class="builtintype" id="2309514">rune</span><span class="op" id="2309518">,</span>&nbsp;<span class="ident" id="2309520">multibyte</span>&nbsp;<span class="builtintype" id="2309530">bool</span><span class="op" id="2309534">,</span>&nbsp;<span class="ident" id="2309536">tail</span>&nbsp;<span class="builtintype" id="2309541">string</span><span class="op" id="2309547">,</span>&nbsp;<span class="ident" id="2309549">err</span>&nbsp;<span class="builtintype" id="2309553">error</span><span class="op" id="2309558">)</span>&nbsp;<span class="op" id="2309560">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2309563">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309578">switch</span>&nbsp;<span class="ident" id="2309585">c</span>&nbsp;<span class="op" id="2309587">:=</span>&nbsp;<span class="ident" id="2309590">s</span><span class="op" id="2309591">[</span><span class="num" id="2309592">0</span><span class="op" id="2309593">]</span><span class="op" id="2309594">;</span>&nbsp;<span class="op" id="2309596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309599">case</span>&nbsp;<span class="ident" id="2309604">c</span>&nbsp;<span class="op" id="2309606">==</span>&nbsp;<span class="ident" id="2309609">quote</span>&nbsp;<span class="op" id="2309615">&amp;&amp;</span>&nbsp;<span class="op" id="2309618">(</span><span class="ident" id="2309619">quote</span>&nbsp;<span class="op" id="2309625">==</span>&nbsp;<span class="string" id="2309628">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2309633">||</span>&nbsp;<span class="ident" id="2309636">quote</span>&nbsp;<span class="op" id="2309642">==</span>&nbsp;<span class="string" id="2309645">&#39;&#34;&#39;</span><span class="op" id="2309648">)</span><span class="op" id="2309649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309653">err</span>&nbsp;<span class="op" id="2309657">=</span>&nbsp;<span class="ident" id="2309659">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309671">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309679">case</span>&nbsp;<span class="ident" id="2309684">c</span>&nbsp;<span class="op" id="2309686">&gt;=</span>&nbsp;<span class="ident" id="2309689">utf8</span><span class="op" id="2309693">.</span><span class="ident" id="2309694">RuneSelf</span><span class="op" id="2309702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309706">r</span><span class="op" id="2309707">,</span>&nbsp;<span class="ident" id="2309709">size</span>&nbsp;<span class="op" id="2309714">:=</span>&nbsp;<span class="ident" id="2309717">utf8</span><span class="op" id="2309721">.</span><span class="ident" id="2309722">DecodeRuneInString</span><span class="op" id="2309740">(</span><span class="ident" id="2309741">s</span><span class="op" id="2309742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309746">return</span>&nbsp;<span class="ident" id="2309753">r</span><span class="op" id="2309754">,</span>&nbsp;<span class="builtintype" id="2309756">true</span><span class="op" id="2309760">,</span>&nbsp;<span class="ident" id="2309762">s</span><span class="op" id="2309763">[</span><span class="ident" id="2309764">size</span><span class="op" id="2309768">:</span><span class="op" id="2309769">]</span><span class="op" id="2309770">,</span>&nbsp;<span class="builtintype" id="2309772">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309777">case</span>&nbsp;<span class="ident" id="2309782">c</span>&nbsp;<span class="op" id="2309784">!=</span>&nbsp;<span class="string" id="2309787">&#39;\\&#39;</span><span class="op" id="2309791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309795">return</span>&nbsp;<span class="builtintype" id="2309802">rune</span><span class="op" id="2309806">(</span><span class="ident" id="2309807">s</span><span class="op" id="2309808">[</span><span class="num" id="2309809">0</span><span class="op" id="2309810">]</span><span class="op" id="2309811">)</span><span class="op" id="2309812">,</span>&nbsp;<span class="builtintype" id="2309814">false</span><span class="op" id="2309819">,</span>&nbsp;<span class="ident" id="2309821">s</span><span class="op" id="2309822">[</span><span class="num" id="2309823">1</span><span class="op" id="2309824">:</span><span class="op" id="2309825">]</span><span class="op" id="2309826">,</span>&nbsp;<span class="builtintype" id="2309828">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2309833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2309837">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309867">if</span>&nbsp;<span class="builtinfunc" id="2309870">len</span><span class="op" id="2309873">(</span><span class="ident" id="2309874">s</span><span class="op" id="2309875">)</span>&nbsp;<span class="op" id="2309877">&lt;=</span>&nbsp;<span class="num" id="2309880">1</span>&nbsp;<span class="op" id="2309882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309886">err</span>&nbsp;<span class="op" id="2309890">=</span>&nbsp;<span class="ident" id="2309892">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309904">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2309912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309915">c</span>&nbsp;<span class="op" id="2309917">:=</span>&nbsp;<span class="ident" id="2309920">s</span><span class="op" id="2309921">[</span><span class="num" id="2309922">1</span><span class="op" id="2309923">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309926">s</span>&nbsp;<span class="op" id="2309928">=</span>&nbsp;<span class="ident" id="2309930">s</span><span class="op" id="2309931">[</span><span class="num" id="2309932">2</span><span class="op" id="2309933">:</span><span class="op" id="2309934">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309938">switch</span>&nbsp;<span class="ident" id="2309945">c</span>&nbsp;<span class="op" id="2309947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309950">case</span>&nbsp;<span class="string" id="2309955">&#39;a&#39;</span><span class="op" id="2309958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309962">value</span>&nbsp;<span class="op" id="2309968">=</span>&nbsp;<span class="string" id="2309970">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2309976">case</span>&nbsp;<span class="string" id="2309981">&#39;b&#39;</span><span class="op" id="2309984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2309988">value</span>&nbsp;<span class="op" id="2309994">=</span>&nbsp;<span class="string" id="2309996">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310002">case</span>&nbsp;<span class="string" id="2310007">&#39;f&#39;</span><span class="op" id="2310010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310014">value</span>&nbsp;<span class="op" id="2310020">=</span>&nbsp;<span class="string" id="2310022">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310028">case</span>&nbsp;<span class="string" id="2310033">&#39;n&#39;</span><span class="op" id="2310036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310040">value</span>&nbsp;<span class="op" id="2310046">=</span>&nbsp;<span class="string" id="2310048">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310054">case</span>&nbsp;<span class="string" id="2310059">&#39;r&#39;</span><span class="op" id="2310062">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310066">value</span>&nbsp;<span class="op" id="2310072">=</span>&nbsp;<span class="string" id="2310074">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310080">case</span>&nbsp;<span class="string" id="2310085">&#39;t&#39;</span><span class="op" id="2310088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310092">value</span>&nbsp;<span class="op" id="2310098">=</span>&nbsp;<span class="string" id="2310100">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310106">case</span>&nbsp;<span class="string" id="2310111">&#39;v&#39;</span><span class="op" id="2310114">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310118">value</span>&nbsp;<span class="op" id="2310124">=</span>&nbsp;<span class="string" id="2310126">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310132">case</span>&nbsp;<span class="string" id="2310137">&#39;x&#39;</span><span class="op" id="2310140">,</span>&nbsp;<span class="string" id="2310142">&#39;u&#39;</span><span class="op" id="2310145">,</span>&nbsp;<span class="string" id="2310147">&#39;U&#39;</span><span class="op" id="2310150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310154">n</span>&nbsp;<span class="op" id="2310156">:=</span>&nbsp;<span class="num" id="2310159">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310163">switch</span>&nbsp;<span class="ident" id="2310170">c</span>&nbsp;<span class="op" id="2310172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310176">case</span>&nbsp;<span class="string" id="2310181">&#39;x&#39;</span><span class="op" id="2310184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310189">n</span>&nbsp;<span class="op" id="2310191">=</span>&nbsp;<span class="num" id="2310193">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310197">case</span>&nbsp;<span class="string" id="2310202">&#39;u&#39;</span><span class="op" id="2310205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310210">n</span>&nbsp;<span class="op" id="2310212">=</span>&nbsp;<span class="num" id="2310214">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310218">case</span>&nbsp;<span class="string" id="2310223">&#39;U&#39;</span><span class="op" id="2310226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310231">n</span>&nbsp;<span class="op" id="2310233">=</span>&nbsp;<span class="num" id="2310235">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310239">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310243">var</span>&nbsp;<span class="ident" id="2310247">v</span>&nbsp;<span class="builtintype" id="2310249">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310256">if</span>&nbsp;<span class="builtinfunc" id="2310259">len</span><span class="op" id="2310262">(</span><span class="ident" id="2310263">s</span><span class="op" id="2310264">)</span>&nbsp;<span class="op" id="2310266">&lt;</span>&nbsp;<span class="ident" id="2310268">n</span>&nbsp;<span class="op" id="2310270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310275">err</span>&nbsp;<span class="op" id="2310279">=</span>&nbsp;<span class="ident" id="2310281">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310294">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310303">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310307">for</span>&nbsp;<span class="ident" id="2310311">j</span>&nbsp;<span class="op" id="2310313">:=</span>&nbsp;<span class="num" id="2310316">0</span><span class="op" id="2310317">;</span>&nbsp;<span class="ident" id="2310319">j</span>&nbsp;<span class="op" id="2310321">&lt;</span>&nbsp;<span class="ident" id="2310323">n</span><span class="op" id="2310324">;</span>&nbsp;<span class="ident" id="2310326">j</span><span class="op" id="2310327">++</span>&nbsp;<span class="op" id="2310330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310335">x</span><span class="op" id="2310336">,</span>&nbsp;<span class="ident" id="2310338">ok</span>&nbsp;<span class="op" id="2310341">:=</span>&nbsp;<span class="ident" id="2310344">unhex</span><span class="op" id="2310349">(</span><span class="ident" id="2310350">s</span><span class="op" id="2310351">[</span><span class="ident" id="2310352">j</span><span class="op" id="2310353">]</span><span class="op" id="2310354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310359">if</span>&nbsp;<span class="op" id="2310362">!</span><span class="ident" id="2310363">ok</span>&nbsp;<span class="op" id="2310366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310372">err</span>&nbsp;<span class="op" id="2310376">=</span>&nbsp;<span class="ident" id="2310378">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310392">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310407">v</span>&nbsp;<span class="op" id="2310409">=</span>&nbsp;<span class="ident" id="2310411">v</span><span class="op" id="2310412">&lt;&lt;</span><span class="num" id="2310414">4</span>&nbsp;<span class="op" id="2310416">|</span>&nbsp;<span class="ident" id="2310418">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310426">s</span>&nbsp;<span class="op" id="2310428">=</span>&nbsp;<span class="ident" id="2310430">s</span><span class="op" id="2310431">[</span><span class="ident" id="2310432">n</span><span class="op" id="2310433">:</span><span class="op" id="2310434">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310438">if</span>&nbsp;<span class="ident" id="2310441">c</span>&nbsp;<span class="op" id="2310443">==</span>&nbsp;<span class="string" id="2310446">&#39;x&#39;</span>&nbsp;<span class="op" id="2310450">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2310455">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310500">value</span>&nbsp;<span class="op" id="2310506">=</span>&nbsp;<span class="ident" id="2310508">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310513">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310525">if</span>&nbsp;<span class="ident" id="2310528">v</span>&nbsp;<span class="op" id="2310530">&gt;</span>&nbsp;<span class="ident" id="2310532">utf8</span><span class="op" id="2310536">.</span><span class="ident" id="2310537">MaxRune</span>&nbsp;<span class="op" id="2310545">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310550">err</span>&nbsp;<span class="op" id="2310554">=</span>&nbsp;<span class="ident" id="2310556">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310569">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310582">value</span>&nbsp;<span class="op" id="2310588">=</span>&nbsp;<span class="ident" id="2310590">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310594">multibyte</span>&nbsp;<span class="op" id="2310604">=</span>&nbsp;<span class="builtintype" id="2310606">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310612">case</span>&nbsp;<span class="string" id="2310617">&#39;0&#39;</span><span class="op" id="2310620">,</span>&nbsp;<span class="string" id="2310622">&#39;1&#39;</span><span class="op" id="2310625">,</span>&nbsp;<span class="string" id="2310627">&#39;2&#39;</span><span class="op" id="2310630">,</span>&nbsp;<span class="string" id="2310632">&#39;3&#39;</span><span class="op" id="2310635">,</span>&nbsp;<span class="string" id="2310637">&#39;4&#39;</span><span class="op" id="2310640">,</span>&nbsp;<span class="string" id="2310642">&#39;5&#39;</span><span class="op" id="2310645">,</span>&nbsp;<span class="string" id="2310647">&#39;6&#39;</span><span class="op" id="2310650">,</span>&nbsp;<span class="string" id="2310652">&#39;7&#39;</span><span class="op" id="2310655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310659">v</span>&nbsp;<span class="op" id="2310661">:=</span>&nbsp;<span class="builtintype" id="2310664">rune</span><span class="op" id="2310668">(</span><span class="ident" id="2310669">c</span><span class="op" id="2310670">)</span>&nbsp;<span class="op" id="2310672">-</span>&nbsp;<span class="string" id="2310674">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310680">if</span>&nbsp;<span class="builtinfunc" id="2310683">len</span><span class="op" id="2310686">(</span><span class="ident" id="2310687">s</span><span class="op" id="2310688">)</span>&nbsp;<span class="op" id="2310690">&lt;</span>&nbsp;<span class="num" id="2310692">2</span>&nbsp;<span class="op" id="2310694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310699">err</span>&nbsp;<span class="op" id="2310703">=</span>&nbsp;<span class="ident" id="2310705">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310718">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310731">for</span>&nbsp;<span class="ident" id="2310735">j</span>&nbsp;<span class="op" id="2310737">:=</span>&nbsp;<span class="num" id="2310740">0</span><span class="op" id="2310741">;</span>&nbsp;<span class="ident" id="2310743">j</span>&nbsp;<span class="op" id="2310745">&lt;</span>&nbsp;<span class="num" id="2310747">2</span><span class="op" id="2310748">;</span>&nbsp;<span class="ident" id="2310750">j</span><span class="op" id="2310751">++</span>&nbsp;<span class="op" id="2310754">{</span>&nbsp;<span class="comment" id="2310756">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310790">x</span>&nbsp;<span class="op" id="2310792">:=</span>&nbsp;<span class="builtintype" id="2310795">rune</span><span class="op" id="2310799">(</span><span class="ident" id="2310800">s</span><span class="op" id="2310801">[</span><span class="ident" id="2310802">j</span><span class="op" id="2310803">]</span><span class="op" id="2310804">)</span>&nbsp;<span class="op" id="2310806">-</span>&nbsp;<span class="string" id="2310808">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310815">if</span>&nbsp;<span class="ident" id="2310818">x</span>&nbsp;<span class="op" id="2310820">&lt;</span>&nbsp;<span class="num" id="2310822">0</span>&nbsp;<span class="op" id="2310824">||</span>&nbsp;<span class="ident" id="2310827">x</span>&nbsp;<span class="op" id="2310829">&gt;</span>&nbsp;<span class="num" id="2310831">7</span>&nbsp;<span class="op" id="2310833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310839">err</span>&nbsp;<span class="op" id="2310843">=</span>&nbsp;<span class="ident" id="2310845">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310874">v</span>&nbsp;<span class="op" id="2310876">=</span>&nbsp;<span class="op" id="2310878">(</span><span class="ident" id="2310879">v</span>&nbsp;<span class="op" id="2310881">&lt;&lt;</span>&nbsp;<span class="num" id="2310884">3</span><span class="op" id="2310885">)</span>&nbsp;<span class="op" id="2310887">|</span>&nbsp;<span class="ident" id="2310889">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310897">s</span>&nbsp;<span class="op" id="2310899">=</span>&nbsp;<span class="ident" id="2310901">s</span><span class="op" id="2310902">[</span><span class="num" id="2310903">2</span><span class="op" id="2310904">:</span><span class="op" id="2310905">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310909">if</span>&nbsp;<span class="ident" id="2310912">v</span>&nbsp;<span class="op" id="2310914">&gt;</span>&nbsp;<span class="num" id="2310916">255</span>&nbsp;<span class="op" id="2310920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310925">err</span>&nbsp;<span class="op" id="2310929">=</span>&nbsp;<span class="ident" id="2310931">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310944">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2310953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310957">value</span>&nbsp;<span class="op" id="2310963">=</span>&nbsp;<span class="ident" id="2310965">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310968">case</span>&nbsp;<span class="string" id="2310973">&#39;\\&#39;</span><span class="op" id="2310977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2310981">value</span>&nbsp;<span class="op" id="2310987">=</span>&nbsp;<span class="string" id="2310989">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2310995">case</span>&nbsp;<span class="string" id="2311000">&#39;\&#39;&#39;</span><span class="op" id="2311004">,</span>&nbsp;<span class="string" id="2311006">&#39;&#34;&#39;</span><span class="op" id="2311009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311013">if</span>&nbsp;<span class="ident" id="2311016">c</span>&nbsp;<span class="op" id="2311018">!=</span>&nbsp;<span class="ident" id="2311021">quote</span>&nbsp;<span class="op" id="2311027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311032">err</span>&nbsp;<span class="op" id="2311036">=</span>&nbsp;<span class="ident" id="2311038">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311051">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311064">value</span>&nbsp;<span class="op" id="2311070">=</span>&nbsp;<span class="builtintype" id="2311072">rune</span><span class="op" id="2311076">(</span><span class="ident" id="2311077">c</span><span class="op" id="2311078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311081">default</span><span class="op" id="2311088">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311092">err</span>&nbsp;<span class="op" id="2311096">=</span>&nbsp;<span class="ident" id="2311098">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311110">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311121">tail</span>&nbsp;<span class="op" id="2311126">=</span>&nbsp;<span class="ident" id="2311128">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311131">return</span><br>
<span class="lineno"></span><span class="op" id="2311138">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2311141">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2311200">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2311263">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2311323">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2311379">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2311405">func</span>&nbsp;<span class="ident" id="2311410">Unquote</span><span class="op" id="2311417">(</span><span class="ident" id="2311418">s</span>&nbsp;<span class="builtintype" id="2311420">string</span><span class="op" id="2311426">)</span>&nbsp;<span class="op" id="2311428">(</span><span class="ident" id="2311429">t</span>&nbsp;<span class="builtintype" id="2311431">string</span><span class="op" id="2311437">,</span>&nbsp;<span class="ident" id="2311439">err</span>&nbsp;<span class="builtintype" id="2311443">error</span><span class="op" id="2311448">)</span>&nbsp;<span class="op" id="2311450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311453">n</span>&nbsp;<span class="op" id="2311455">:=</span>&nbsp;<span class="builtinfunc" id="2311458">len</span><span class="op" id="2311461">(</span><span class="ident" id="2311462">s</span><span class="op" id="2311463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311466">if</span>&nbsp;<span class="ident" id="2311469">n</span>&nbsp;<span class="op" id="2311471">&lt;</span>&nbsp;<span class="num" id="2311473">2</span>&nbsp;<span class="op" id="2311475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311479">return</span>&nbsp;<span class="string" id="2311486">&#34;&#34;</span><span class="op" id="2311488">,</span>&nbsp;<span class="ident" id="2311490">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311504">quote</span>&nbsp;<span class="op" id="2311510">:=</span>&nbsp;<span class="ident" id="2311513">s</span><span class="op" id="2311514">[</span><span class="num" id="2311515">0</span><span class="op" id="2311516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311519">if</span>&nbsp;<span class="ident" id="2311522">quote</span>&nbsp;<span class="op" id="2311528">!=</span>&nbsp;<span class="ident" id="2311531">s</span><span class="op" id="2311532">[</span><span class="ident" id="2311533">n</span><span class="op" id="2311534">-</span><span class="num" id="2311535">1</span><span class="op" id="2311536">]</span>&nbsp;<span class="op" id="2311538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311542">return</span>&nbsp;<span class="string" id="2311549">&#34;&#34;</span><span class="op" id="2311551">,</span>&nbsp;<span class="ident" id="2311553">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311564">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311567">s</span>&nbsp;<span class="op" id="2311569">=</span>&nbsp;<span class="ident" id="2311571">s</span><span class="op" id="2311572">[</span><span class="num" id="2311573">1</span>&nbsp;<span class="op" id="2311575">:</span>&nbsp;<span class="ident" id="2311577">n</span><span class="op" id="2311578">-</span><span class="num" id="2311579">1</span><span class="op" id="2311580">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311584">if</span>&nbsp;<span class="ident" id="2311587">quote</span>&nbsp;<span class="op" id="2311593">==</span>&nbsp;<span class="string" id="2311596">&#39;`&#39;</span>&nbsp;<span class="op" id="2311600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311604">if</span>&nbsp;<span class="ident" id="2311607">contains</span><span class="op" id="2311615">(</span><span class="ident" id="2311616">s</span><span class="op" id="2311617">,</span>&nbsp;<span class="string" id="2311619">&#39;`&#39;</span><span class="op" id="2311622">)</span>&nbsp;<span class="op" id="2311624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311629">return</span>&nbsp;<span class="string" id="2311636">&#34;&#34;</span><span class="op" id="2311638">,</span>&nbsp;<span class="ident" id="2311640">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311656">return</span>&nbsp;<span class="ident" id="2311663">s</span><span class="op" id="2311664">,</span>&nbsp;<span class="builtintype" id="2311666">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311674">if</span>&nbsp;<span class="ident" id="2311677">quote</span>&nbsp;<span class="op" id="2311683">!=</span>&nbsp;<span class="string" id="2311686">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2311690">&amp;&amp;</span>&nbsp;<span class="ident" id="2311693">quote</span>&nbsp;<span class="op" id="2311699">!=</span>&nbsp;<span class="string" id="2311702">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2311707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311711">return</span>&nbsp;<span class="string" id="2311718">&#34;&#34;</span><span class="op" id="2311720">,</span>&nbsp;<span class="ident" id="2311722">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311736">if</span>&nbsp;<span class="ident" id="2311739">contains</span><span class="op" id="2311747">(</span><span class="ident" id="2311748">s</span><span class="op" id="2311749">,</span>&nbsp;<span class="string" id="2311751">&#39;\n&#39;</span><span class="op" id="2311755">)</span>&nbsp;<span class="op" id="2311757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311761">return</span>&nbsp;<span class="string" id="2311768">&#34;&#34;</span><span class="op" id="2311770">,</span>&nbsp;<span class="ident" id="2311772">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2311783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2311787">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311825">if</span>&nbsp;<span class="op" id="2311828">!</span><span class="ident" id="2311829">contains</span><span class="op" id="2311837">(</span><span class="ident" id="2311838">s</span><span class="op" id="2311839">,</span>&nbsp;<span class="string" id="2311841">&#39;\\&#39;</span><span class="op" id="2311845">)</span>&nbsp;<span class="op" id="2311847">&amp;&amp;</span>&nbsp;<span class="op" id="2311850">!</span><span class="ident" id="2311851">contains</span><span class="op" id="2311859">(</span><span class="ident" id="2311860">s</span><span class="op" id="2311861">,</span>&nbsp;<span class="ident" id="2311863">quote</span><span class="op" id="2311868">)</span>&nbsp;<span class="op" id="2311870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311874">switch</span>&nbsp;<span class="ident" id="2311881">quote</span>&nbsp;<span class="op" id="2311887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311891">case</span>&nbsp;<span class="string" id="2311896">&#39;&#34;&#39;</span><span class="op" id="2311899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311904">return</span>&nbsp;<span class="ident" id="2311911">s</span><span class="op" id="2311912">,</span>&nbsp;<span class="builtintype" id="2311914">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311920">case</span>&nbsp;<span class="string" id="2311925">&#39;\&#39;&#39;</span><span class="op" id="2311929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2311934">r</span><span class="op" id="2311935">,</span>&nbsp;<span class="ident" id="2311937">size</span>&nbsp;<span class="op" id="2311942">:=</span>&nbsp;<span class="ident" id="2311945">utf8</span><span class="op" id="2311949">.</span><span class="ident" id="2311950">DecodeRuneInString</span><span class="op" id="2311968">(</span><span class="ident" id="2311969">s</span><span class="op" id="2311970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2311975">if</span>&nbsp;<span class="ident" id="2311978">size</span>&nbsp;<span class="op" id="2311983">==</span>&nbsp;<span class="builtinfunc" id="2311986">len</span><span class="op" id="2311989">(</span><span class="ident" id="2311990">s</span><span class="op" id="2311991">)</span>&nbsp;<span class="op" id="2311993">&amp;&amp;</span>&nbsp;<span class="op" id="2311996">(</span><span class="ident" id="2311997">r</span>&nbsp;<span class="op" id="2311999">!=</span>&nbsp;<span class="ident" id="2312002">utf8</span><span class="op" id="2312006">.</span><span class="ident" id="2312007">RuneError</span>&nbsp;<span class="op" id="2312017">||</span>&nbsp;<span class="ident" id="2312020">size</span>&nbsp;<span class="op" id="2312025">!=</span>&nbsp;<span class="num" id="2312028">1</span><span class="op" id="2312029">)</span>&nbsp;<span class="op" id="2312031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312037">return</span>&nbsp;<span class="ident" id="2312044">s</span><span class="op" id="2312045">,</span>&nbsp;<span class="builtintype" id="2312047">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312054">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312065">var</span>&nbsp;<span class="ident" id="2312069">runeTmp</span>&nbsp;<span class="op" id="2312077">[</span><span class="ident" id="2312078">utf8</span><span class="op" id="2312082">.</span><span class="ident" id="2312083">UTFMax</span><span class="op" id="2312089">]</span><span class="builtintype" id="2312090">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312096">buf</span>&nbsp;<span class="op" id="2312100">:=</span>&nbsp;<span class="builtinfunc" id="2312103">make</span><span class="op" id="2312107">(</span><span class="op" id="2312108">[</span><span class="op" id="2312109">]</span><span class="builtintype" id="2312110">byte</span><span class="op" id="2312114">,</span>&nbsp;<span class="num" id="2312116">0</span><span class="op" id="2312117">,</span>&nbsp;<span class="num" id="2312119">3</span><span class="op" id="2312120">*</span><span class="builtinfunc" id="2312121">len</span><span class="op" id="2312124">(</span><span class="ident" id="2312125">s</span><span class="op" id="2312126">)</span><span class="op" id="2312127">/</span><span class="num" id="2312128">2</span><span class="op" id="2312129">)</span>&nbsp;<span class="comment" id="2312131">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312166">for</span>&nbsp;<span class="builtinfunc" id="2312170">len</span><span class="op" id="2312173">(</span><span class="ident" id="2312174">s</span><span class="op" id="2312175">)</span>&nbsp;<span class="op" id="2312177">&gt;</span>&nbsp;<span class="num" id="2312179">0</span>&nbsp;<span class="op" id="2312181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312185">c</span><span class="op" id="2312186">,</span>&nbsp;<span class="ident" id="2312188">multibyte</span><span class="op" id="2312197">,</span>&nbsp;<span class="ident" id="2312199">ss</span><span class="op" id="2312201">,</span>&nbsp;<span class="ident" id="2312203">err</span>&nbsp;<span class="op" id="2312207">:=</span>&nbsp;<span class="ident" id="2312210">UnquoteChar</span><span class="op" id="2312221">(</span><span class="ident" id="2312222">s</span><span class="op" id="2312223">,</span>&nbsp;<span class="ident" id="2312225">quote</span><span class="op" id="2312230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312234">if</span>&nbsp;<span class="ident" id="2312237">err</span>&nbsp;<span class="op" id="2312241">!=</span>&nbsp;<span class="builtintype" id="2312244">nil</span>&nbsp;<span class="op" id="2312248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312253">return</span>&nbsp;<span class="string" id="2312260">&#34;&#34;</span><span class="op" id="2312262">,</span>&nbsp;<span class="ident" id="2312264">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312270">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312274">s</span>&nbsp;<span class="op" id="2312276">=</span>&nbsp;<span class="ident" id="2312278">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312283">if</span>&nbsp;<span class="ident" id="2312286">c</span>&nbsp;<span class="op" id="2312288">&lt;</span>&nbsp;<span class="ident" id="2312290">utf8</span><span class="op" id="2312294">.</span><span class="ident" id="2312295">RuneSelf</span>&nbsp;<span class="op" id="2312304">||</span>&nbsp;<span class="op" id="2312307">!</span><span class="ident" id="2312308">multibyte</span>&nbsp;<span class="op" id="2312318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312323">buf</span>&nbsp;<span class="op" id="2312327">=</span>&nbsp;<span class="builtinfunc" id="2312329">append</span><span class="op" id="2312335">(</span><span class="ident" id="2312336">buf</span><span class="op" id="2312339">,</span>&nbsp;<span class="builtintype" id="2312341">byte</span><span class="op" id="2312345">(</span><span class="ident" id="2312346">c</span><span class="op" id="2312347">)</span><span class="op" id="2312348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312352">}</span>&nbsp;<span class="keyword" id="2312354">else</span>&nbsp;<span class="op" id="2312359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312364">n</span>&nbsp;<span class="op" id="2312366">:=</span>&nbsp;<span class="ident" id="2312369">utf8</span><span class="op" id="2312373">.</span><span class="ident" id="2312374">EncodeRune</span><span class="op" id="2312384">(</span><span class="ident" id="2312385">runeTmp</span><span class="op" id="2312392">[</span><span class="op" id="2312393">:</span><span class="op" id="2312394">]</span><span class="op" id="2312395">,</span>&nbsp;<span class="ident" id="2312397">c</span><span class="op" id="2312398">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312403">buf</span>&nbsp;<span class="op" id="2312407">=</span>&nbsp;<span class="builtinfunc" id="2312409">append</span><span class="op" id="2312415">(</span><span class="ident" id="2312416">buf</span><span class="op" id="2312419">,</span>&nbsp;<span class="ident" id="2312421">runeTmp</span><span class="op" id="2312428">[</span><span class="op" id="2312429">:</span><span class="ident" id="2312430">n</span><span class="op" id="2312431">]</span><span class="op" id="2312432">...</span><span class="op" id="2312435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312443">if</span>&nbsp;<span class="ident" id="2312446">quote</span>&nbsp;<span class="op" id="2312452">==</span>&nbsp;<span class="string" id="2312455">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2312460">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2312463">len</span><span class="op" id="2312466">(</span><span class="ident" id="2312467">s</span><span class="op" id="2312468">)</span>&nbsp;<span class="op" id="2312470">!=</span>&nbsp;<span class="num" id="2312473">0</span>&nbsp;<span class="op" id="2312475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2312480">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312525">return</span>&nbsp;<span class="string" id="2312532">&#34;&#34;</span><span class="op" id="2312534">,</span>&nbsp;<span class="ident" id="2312536">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312554">return</span>&nbsp;<span class="builtintype" id="2312561">string</span><span class="op" id="2312567">(</span><span class="ident" id="2312568">buf</span><span class="op" id="2312571">)</span><span class="op" id="2312572">,</span>&nbsp;<span class="builtintype" id="2312574">nil</span><br>
<span class="lineno"></span><span class="op" id="2312578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2312581">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2312641">func</span>&nbsp;<span class="ident" id="2312646">contains</span><span class="op" id="2312654">(</span><span class="ident" id="2312655">s</span>&nbsp;<span class="builtintype" id="2312657">string</span><span class="op" id="2312663">,</span>&nbsp;<span class="ident" id="2312665">c</span>&nbsp;<span class="builtintype" id="2312667">byte</span><span class="op" id="2312671">)</span>&nbsp;<span class="builtintype" id="2312673">bool</span>&nbsp;<span class="op" id="2312678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312681">for</span>&nbsp;<span class="ident" id="2312685">i</span>&nbsp;<span class="op" id="2312687">:=</span>&nbsp;<span class="num" id="2312690">0</span><span class="op" id="2312691">;</span>&nbsp;<span class="ident" id="2312693">i</span>&nbsp;<span class="op" id="2312695">&lt;</span>&nbsp;<span class="builtinfunc" id="2312697">len</span><span class="op" id="2312700">(</span><span class="ident" id="2312701">s</span><span class="op" id="2312702">)</span><span class="op" id="2312703">;</span>&nbsp;<span class="ident" id="2312705">i</span><span class="op" id="2312706">++</span>&nbsp;<span class="op" id="2312709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312713">if</span>&nbsp;<span class="ident" id="2312716">s</span><span class="op" id="2312717">[</span><span class="ident" id="2312718">i</span><span class="op" id="2312719">]</span>&nbsp;<span class="op" id="2312721">==</span>&nbsp;<span class="ident" id="2312724">c</span>&nbsp;<span class="op" id="2312726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312731">return</span>&nbsp;<span class="builtintype" id="2312738">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2312748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312751">return</span>&nbsp;<span class="builtintype" id="2312758">false</span><br>
<span class="lineno"></span><span class="op" id="2312764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2312767">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2312824">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2312876">func</span>&nbsp;<span class="ident" id="2312881">bsearch16</span><span class="op" id="2312890">(</span><span class="ident" id="2312891">a</span>&nbsp;<span class="op" id="2312893">[</span><span class="op" id="2312894">]</span><span class="builtintype" id="2312895">uint16</span><span class="op" id="2312901">,</span>&nbsp;<span class="ident" id="2312903">x</span>&nbsp;<span class="builtintype" id="2312905">uint16</span><span class="op" id="2312911">)</span>&nbsp;<span class="builtintype" id="2312913">int</span>&nbsp;<span class="op" id="2312917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312920">i</span><span class="op" id="2312921">,</span>&nbsp;<span class="ident" id="2312923">j</span>&nbsp;<span class="op" id="2312925">:=</span>&nbsp;<span class="num" id="2312928">0</span><span class="op" id="2312929">,</span>&nbsp;<span class="builtinfunc" id="2312931">len</span><span class="op" id="2312934">(</span><span class="ident" id="2312935">a</span><span class="op" id="2312936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312939">for</span>&nbsp;<span class="ident" id="2312943">i</span>&nbsp;<span class="op" id="2312945">&lt;</span>&nbsp;<span class="ident" id="2312947">j</span>&nbsp;<span class="op" id="2312949">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312953">h</span>&nbsp;<span class="op" id="2312955">:=</span>&nbsp;<span class="ident" id="2312958">i</span>&nbsp;<span class="op" id="2312960">+</span>&nbsp;<span class="op" id="2312962">(</span><span class="ident" id="2312963">j</span><span class="op" id="2312964">-</span><span class="ident" id="2312965">i</span><span class="op" id="2312966">)</span><span class="op" id="2312967">/</span><span class="num" id="2312968">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2312972">if</span>&nbsp;<span class="ident" id="2312975">a</span><span class="op" id="2312976">[</span><span class="ident" id="2312977">h</span><span class="op" id="2312978">]</span>&nbsp;<span class="op" id="2312980">&lt;</span>&nbsp;<span class="ident" id="2312982">x</span>&nbsp;<span class="op" id="2312984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2312989">i</span>&nbsp;<span class="op" id="2312991">=</span>&nbsp;<span class="ident" id="2312993">h</span>&nbsp;<span class="op" id="2312995">+</span>&nbsp;<span class="num" id="2312997">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313001">}</span>&nbsp;<span class="keyword" id="2313003">else</span>&nbsp;<span class="op" id="2313008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313013">j</span>&nbsp;<span class="op" id="2313015">=</span>&nbsp;<span class="ident" id="2313017">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313027">return</span>&nbsp;<span class="ident" id="2313034">i</span><br>
<span class="lineno"></span><span class="op" id="2313036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2313039">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2313096">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2313148">func</span>&nbsp;<span class="ident" id="2313153">bsearch32</span><span class="op" id="2313162">(</span><span class="ident" id="2313163">a</span>&nbsp;<span class="op" id="2313165">[</span><span class="op" id="2313166">]</span><span class="builtintype" id="2313167">uint32</span><span class="op" id="2313173">,</span>&nbsp;<span class="ident" id="2313175">x</span>&nbsp;<span class="builtintype" id="2313177">uint32</span><span class="op" id="2313183">)</span>&nbsp;<span class="builtintype" id="2313185">int</span>&nbsp;<span class="op" id="2313189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313192">i</span><span class="op" id="2313193">,</span>&nbsp;<span class="ident" id="2313195">j</span>&nbsp;<span class="op" id="2313197">:=</span>&nbsp;<span class="num" id="2313200">0</span><span class="op" id="2313201">,</span>&nbsp;<span class="builtinfunc" id="2313203">len</span><span class="op" id="2313206">(</span><span class="ident" id="2313207">a</span><span class="op" id="2313208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313211">for</span>&nbsp;<span class="ident" id="2313215">i</span>&nbsp;<span class="op" id="2313217">&lt;</span>&nbsp;<span class="ident" id="2313219">j</span>&nbsp;<span class="op" id="2313221">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313225">h</span>&nbsp;<span class="op" id="2313227">:=</span>&nbsp;<span class="ident" id="2313230">i</span>&nbsp;<span class="op" id="2313232">+</span>&nbsp;<span class="op" id="2313234">(</span><span class="ident" id="2313235">j</span><span class="op" id="2313236">-</span><span class="ident" id="2313237">i</span><span class="op" id="2313238">)</span><span class="op" id="2313239">/</span><span class="num" id="2313240">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313244">if</span>&nbsp;<span class="ident" id="2313247">a</span><span class="op" id="2313248">[</span><span class="ident" id="2313249">h</span><span class="op" id="2313250">]</span>&nbsp;<span class="op" id="2313252">&lt;</span>&nbsp;<span class="ident" id="2313254">x</span>&nbsp;<span class="op" id="2313256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313261">i</span>&nbsp;<span class="op" id="2313263">=</span>&nbsp;<span class="ident" id="2313265">h</span>&nbsp;<span class="op" id="2313267">+</span>&nbsp;<span class="num" id="2313269">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313273">}</span>&nbsp;<span class="keyword" id="2313275">else</span>&nbsp;<span class="op" id="2313280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2313285">j</span>&nbsp;<span class="op" id="2313287">=</span>&nbsp;<span class="ident" id="2313289">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313299">return</span>&nbsp;<span class="ident" id="2313306">i</span><br>
<span class="lineno"></span><span class="op" id="2313308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2313311">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2313396">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2313473">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2313552">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2313622">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2313646">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2313718">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2313792">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2313820">func</span>&nbsp;<span class="ident" id="2313825">IsPrint</span><span class="op" id="2313832">(</span><span class="ident" id="2313833">r</span>&nbsp;<span class="builtintype" id="2313835">rune</span><span class="op" id="2313839">)</span>&nbsp;<span class="builtintype" id="2313841">bool</span>&nbsp;<span class="op" id="2313846">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2313849">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313876">if</span>&nbsp;<span class="ident" id="2313879">r</span>&nbsp;<span class="op" id="2313881">&lt;=</span>&nbsp;<span class="num" id="2313884">0xFF</span>&nbsp;<span class="op" id="2313889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313893">if</span>&nbsp;<span class="num" id="2313896">0x20</span>&nbsp;<span class="op" id="2313901">&lt;=</span>&nbsp;<span class="ident" id="2313904">r</span>&nbsp;<span class="op" id="2313906">&amp;&amp;</span>&nbsp;<span class="ident" id="2313909">r</span>&nbsp;<span class="op" id="2313911">&lt;=</span>&nbsp;<span class="num" id="2313914">0x7E</span>&nbsp;<span class="op" id="2313919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2313924">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2313983">return</span>&nbsp;<span class="builtintype" id="2313990">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2313997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314001">if</span>&nbsp;<span class="num" id="2314004">0xA1</span>&nbsp;<span class="op" id="2314009">&lt;=</span>&nbsp;<span class="ident" id="2314012">r</span>&nbsp;<span class="op" id="2314014">&amp;&amp;</span>&nbsp;<span class="ident" id="2314017">r</span>&nbsp;<span class="op" id="2314019">&lt;=</span>&nbsp;<span class="num" id="2314022">0xFF</span>&nbsp;<span class="op" id="2314027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314032">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314069">return</span>&nbsp;<span class="ident" id="2314076">r</span>&nbsp;<span class="op" id="2314078">!=</span>&nbsp;<span class="num" id="2314081">0xAD</span>&nbsp;<span class="comment" id="2314086">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314130">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314134">return</span>&nbsp;<span class="builtintype" id="2314141">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314152">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314206">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314257">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314335">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2314408">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314477">if</span>&nbsp;<span class="num" id="2314480">0</span>&nbsp;<span class="op" id="2314482">&lt;=</span>&nbsp;<span class="ident" id="2314485">r</span>&nbsp;<span class="op" id="2314487">&amp;&amp;</span>&nbsp;<span class="ident" id="2314490">r</span>&nbsp;<span class="op" id="2314492">&lt;</span>&nbsp;<span class="num" id="2314494">1</span><span class="op" id="2314495">&lt;&lt;</span><span class="num" id="2314497">16</span>&nbsp;<span class="op" id="2314500">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314504">rr</span><span class="op" id="2314506">,</span>&nbsp;<span class="ident" id="2314508">isPrint</span><span class="op" id="2314515">,</span>&nbsp;<span class="ident" id="2314517">isNotPrint</span>&nbsp;<span class="op" id="2314528">:=</span>&nbsp;<span class="builtintype" id="2314531">uint16</span><span class="op" id="2314537">(</span><span class="ident" id="2314538">r</span><span class="op" id="2314539">)</span><span class="op" id="2314540">,</span>&nbsp;<span class="ident" id="2314542">isPrint16</span><span class="op" id="2314551">,</span>&nbsp;<span class="ident" id="2314553">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314568">i</span>&nbsp;<span class="op" id="2314570">:=</span>&nbsp;<span class="ident" id="2314573">bsearch16</span><span class="op" id="2314582">(</span><span class="ident" id="2314583">isPrint</span><span class="op" id="2314590">,</span>&nbsp;<span class="ident" id="2314592">rr</span><span class="op" id="2314594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314598">if</span>&nbsp;<span class="ident" id="2314601">i</span>&nbsp;<span class="op" id="2314603">&gt;=</span>&nbsp;<span class="builtinfunc" id="2314606">len</span><span class="op" id="2314609">(</span><span class="ident" id="2314610">isPrint</span><span class="op" id="2314617">)</span>&nbsp;<span class="op" id="2314619">||</span>&nbsp;<span class="ident" id="2314622">rr</span>&nbsp;<span class="op" id="2314625">&lt;</span>&nbsp;<span class="ident" id="2314627">isPrint</span><span class="op" id="2314634">[</span><span class="ident" id="2314635">i</span><span class="op" id="2314636">&amp;^</span><span class="num" id="2314638">1</span><span class="op" id="2314639">]</span>&nbsp;<span class="op" id="2314641">||</span>&nbsp;<span class="ident" id="2314644">isPrint</span><span class="op" id="2314651">[</span><span class="ident" id="2314652">i</span><span class="op" id="2314653">|</span><span class="num" id="2314654">1</span><span class="op" id="2314655">]</span>&nbsp;<span class="op" id="2314657">&lt;</span>&nbsp;<span class="ident" id="2314659">rr</span>&nbsp;<span class="op" id="2314662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314667">return</span>&nbsp;<span class="builtintype" id="2314674">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314682">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314686">j</span>&nbsp;<span class="op" id="2314688">:=</span>&nbsp;<span class="ident" id="2314691">bsearch16</span><span class="op" id="2314700">(</span><span class="ident" id="2314701">isNotPrint</span><span class="op" id="2314711">,</span>&nbsp;<span class="ident" id="2314713">rr</span><span class="op" id="2314715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314719">return</span>&nbsp;<span class="ident" id="2314726">j</span>&nbsp;<span class="op" id="2314728">&gt;=</span>&nbsp;<span class="builtinfunc" id="2314731">len</span><span class="op" id="2314734">(</span><span class="ident" id="2314735">isNotPrint</span><span class="op" id="2314745">)</span>&nbsp;<span class="op" id="2314747">||</span>&nbsp;<span class="ident" id="2314750">isNotPrint</span><span class="op" id="2314760">[</span><span class="ident" id="2314761">j</span><span class="op" id="2314762">]</span>&nbsp;<span class="op" id="2314764">!=</span>&nbsp;<span class="ident" id="2314767">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314775">rr</span><span class="op" id="2314777">,</span>&nbsp;<span class="ident" id="2314779">isPrint</span><span class="op" id="2314786">,</span>&nbsp;<span class="ident" id="2314788">isNotPrint</span>&nbsp;<span class="op" id="2314799">:=</span>&nbsp;<span class="builtintype" id="2314802">uint32</span><span class="op" id="2314808">(</span><span class="ident" id="2314809">r</span><span class="op" id="2314810">)</span><span class="op" id="2314811">,</span>&nbsp;<span class="ident" id="2314813">isPrint32</span><span class="op" id="2314822">,</span>&nbsp;<span class="ident" id="2314824">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314838">i</span>&nbsp;<span class="op" id="2314840">:=</span>&nbsp;<span class="ident" id="2314843">bsearch32</span><span class="op" id="2314852">(</span><span class="ident" id="2314853">isPrint</span><span class="op" id="2314860">,</span>&nbsp;<span class="ident" id="2314862">rr</span><span class="op" id="2314864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314867">if</span>&nbsp;<span class="ident" id="2314870">i</span>&nbsp;<span class="op" id="2314872">&gt;=</span>&nbsp;<span class="builtinfunc" id="2314875">len</span><span class="op" id="2314878">(</span><span class="ident" id="2314879">isPrint</span><span class="op" id="2314886">)</span>&nbsp;<span class="op" id="2314888">||</span>&nbsp;<span class="ident" id="2314891">rr</span>&nbsp;<span class="op" id="2314894">&lt;</span>&nbsp;<span class="ident" id="2314896">isPrint</span><span class="op" id="2314903">[</span><span class="ident" id="2314904">i</span><span class="op" id="2314905">&amp;^</span><span class="num" id="2314907">1</span><span class="op" id="2314908">]</span>&nbsp;<span class="op" id="2314910">||</span>&nbsp;<span class="ident" id="2314913">isPrint</span><span class="op" id="2314920">[</span><span class="ident" id="2314921">i</span><span class="op" id="2314922">|</span><span class="num" id="2314923">1</span><span class="op" id="2314924">]</span>&nbsp;<span class="op" id="2314926">&lt;</span>&nbsp;<span class="ident" id="2314928">rr</span>&nbsp;<span class="op" id="2314931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314935">return</span>&nbsp;<span class="builtintype" id="2314942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314952">if</span>&nbsp;<span class="ident" id="2314955">r</span>&nbsp;<span class="op" id="2314957">&gt;=</span>&nbsp;<span class="num" id="2314960">0x20000</span>&nbsp;<span class="op" id="2314968">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2314972">return</span>&nbsp;<span class="builtintype" id="2314979">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2314985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2314988">r</span>&nbsp;<span class="op" id="2314990">-=</span>&nbsp;<span class="num" id="2314993">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2315002">j</span>&nbsp;<span class="op" id="2315004">:=</span>&nbsp;<span class="ident" id="2315007">bsearch16</span><span class="op" id="2315016">(</span><span class="ident" id="2315017">isNotPrint</span><span class="op" id="2315027">,</span>&nbsp;<span class="builtintype" id="2315029">uint16</span><span class="op" id="2315035">(</span><span class="ident" id="2315036">r</span><span class="op" id="2315037">)</span><span class="op" id="2315038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2315041">return</span>&nbsp;<span class="ident" id="2315048">j</span>&nbsp;<span class="op" id="2315050">&gt;=</span>&nbsp;<span class="builtinfunc" id="2315053">len</span><span class="op" id="2315056">(</span><span class="ident" id="2315057">isNotPrint</span><span class="op" id="2315067">)</span>&nbsp;<span class="op" id="2315069">||</span>&nbsp;<span class="ident" id="2315072">isNotPrint</span><span class="op" id="2315082">[</span><span class="ident" id="2315083">j</span><span class="op" id="2315084">]</span>&nbsp;<span class="op" id="2315086">!=</span>&nbsp;<span class="builtintype" id="2315089">uint16</span><span class="op" id="2315095">(</span><span class="ident" id="2315096">r</span><span class="op" id="2315097">)</span><br>
<span class="lineno">455</span><span class="op" id="2315099">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
