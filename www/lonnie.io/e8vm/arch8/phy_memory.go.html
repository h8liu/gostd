<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5984368">package</span>&nbsp;<span class="ident" id="5984376">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5984383">//&nbsp;PhyMemory&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;contiguous&nbsp;pages.</span><br>
<span class="lineno"></span><span class="keyword" id="5984433">type</span>&nbsp;<span class="ident" id="5984438">phyMemory</span>&nbsp;<span class="keyword" id="5984448">struct</span>&nbsp;<span class="op" id="5984455">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984458">npage</span>&nbsp;<span class="builtintype" id="5984464">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984472">pages</span>&nbsp;<span class="keyword" id="5984478">map</span><span class="op" id="5984481">[</span><span class="builtintype" id="5984482">uint32</span><span class="op" id="5984488">]</span><span class="op" id="5984489">*</span><span class="ident" id="5984490"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979913">page</a></span><br>
<span class="lineno"></span><span class="op" id="5984495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5984498">const</span>&nbsp;<span class="op" id="5984504">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984507">pageVoid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5984521">=</span>&nbsp;<span class="num" id="5984523">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984526">pageInterrupt</span>&nbsp;<span class="op" id="5984540">=</span>&nbsp;<span class="num" id="5984542">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984545">pageBasicIO</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5984559">=</span>&nbsp;<span class="num" id="5984561">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984565">pageBootImage</span>&nbsp;<span class="op" id="5984579">=</span>&nbsp;<span class="num" id="5984581">8</span><br>
<span class="lineno">15</span><span class="op" id="5984583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5984586">//&nbsp;NewPhyMemory&nbsp;creates&nbsp;a&nbsp;physical&nbsp;memory&nbsp;of&nbsp;size&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5984643">func</span>&nbsp;<span class="ident" id="5984648">newPhyMemory</span><span class="op" id="5984660">(</span><span class="ident" id="5984661">size</span>&nbsp;<span class="builtintype" id="5984666">uint32</span><span class="op" id="5984672">)</span>&nbsp;<span class="op" id="5984674">*</span><span class="ident" id="5984675"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span>&nbsp;<span class="op" id="5984685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984688">if</span>&nbsp;<span class="ident" id="5984691"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984661">size</a></span><span class="op" id="5984695">%</span><span class="ident" id="5984696"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span>&nbsp;<span class="op" id="5984705">!=</span>&nbsp;<span class="num" id="5984708">0</span>&nbsp;<span class="op" id="5984710">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5984714">panic</span><span class="op" id="5984719">(</span><span class="string" id="5984720">&#34;size&nbsp;misaligned&#34;</span><span class="op" id="5984737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984744">ret</span>&nbsp;<span class="op" id="5984748">:=</span>&nbsp;<span class="builtinfunc" id="5984751">new</span><span class="op" id="5984754">(</span><span class="ident" id="5984755"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5984764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984767"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984744">ret</a></span><span class="op" id="5984770">.</span><span class="ident" id="5984771">pages</span>&nbsp;<span class="op" id="5984777">=</span>&nbsp;<span class="builtinfunc" id="5984779">make</span><span class="op" id="5984783">(</span><span class="keyword" id="5984784">map</span><span class="op" id="5984787">[</span><span class="builtintype" id="5984788">uint32</span><span class="op" id="5984794">]</span><span class="op" id="5984795">*</span><span class="ident" id="5984796"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979913">page</a></span><span class="op" id="5984800">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984803"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984744">ret</a></span><span class="op" id="5984806">.</span><span class="ident" id="5984807">npage</span>&nbsp;<span class="op" id="5984813">=</span>&nbsp;<span class="ident" id="5984815"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984661">size</a></span>&nbsp;<span class="op" id="5984820">/</span>&nbsp;<span class="ident" id="5984822"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984833">return</span>&nbsp;<span class="ident" id="5984840"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984744">ret</a></span><br>
<span class="lineno"></span><span class="op" id="5984844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5984847">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="keyword" id="5984896">func</span>&nbsp;<span class="op" id="5984901">(</span><span class="ident" id="5984902">pm</span>&nbsp;<span class="op" id="5984905">*</span><span class="ident" id="5984906"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5984915">)</span>&nbsp;<span class="ident" id="5984917">Size</span><span class="op" id="5984921">(</span><span class="op" id="5984922">)</span>&nbsp;<span class="builtintype" id="5984924">uint32</span>&nbsp;<span class="op" id="5984931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984934">return</span>&nbsp;<span class="ident" id="5984941"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984902">pm</a></span><span class="op" id="5984943">.</span><span class="ident" id="5984944">npage</span>&nbsp;<span class="op" id="5984950">*</span>&nbsp;<span class="ident" id="5984952"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span><span class="op" id="5984961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5984964">//&nbsp;Page&nbsp;returns&nbsp;the&nbsp;page&nbsp;for&nbsp;the&nbsp;particular&nbsp;page&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5985020">//&nbsp;Returns&nbsp;nil&nbsp;when&nbsp;the&nbsp;page&nbsp;number&nbsp;is&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span><span class="keyword" id="5985072">func</span>&nbsp;<span class="op" id="5985077">(</span><span class="ident" id="5985078">pm</span>&nbsp;<span class="op" id="5985081">*</span><span class="ident" id="5985082"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5985091">)</span>&nbsp;<span class="ident" id="5985093">Page</span><span class="op" id="5985097">(</span><span class="ident" id="5985098">pn</span>&nbsp;<span class="builtintype" id="5985101">uint32</span><span class="op" id="5985107">)</span>&nbsp;<span class="op" id="5985109">*</span><span class="ident" id="5985110"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979913">page</a></span>&nbsp;<span class="op" id="5985115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985118">if</span>&nbsp;<span class="ident" id="5985121"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985098">pn</a></span>&nbsp;<span class="op" id="5985124">&gt;=</span>&nbsp;<span class="ident" id="5985127"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985078">pm</a></span><span class="op" id="5985129">.</span><span class="ident" id="5985130">npage</span>&nbsp;<span class="op" id="5985136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985140">return</span>&nbsp;<span class="ident" id="5985147">nil</span>&nbsp;<span class="comment" id="5985151">//&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985172">ret</span><span class="op" id="5985175">,</span>&nbsp;<span class="ident" id="5985177">found</span>&nbsp;<span class="op" id="5985183">:=</span>&nbsp;<span class="ident" id="5985186"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985078">pm</a></span><span class="op" id="5985188">.</span><span class="ident" id="5985189">pages</span><span class="op" id="5985194">[</span><span class="ident" id="5985195"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985098">pn</a></span><span class="op" id="5985197">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985200">if</span>&nbsp;<span class="op" id="5985203">!</span><span class="ident" id="5985204"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985177">found</a></span>&nbsp;<span class="op" id="5985210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5985214">//&nbsp;create&nbsp;an&nbsp;empty&nbsp;page&nbsp;on&nbsp;demand</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985250"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985172">ret</a></span>&nbsp;<span class="op" id="5985254">=</span>&nbsp;<span class="ident" id="5985256"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979986">newPage</a></span><span class="op" id="5985263">(</span><span class="op" id="5985264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985268"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985078">pm</a></span><span class="op" id="5985270">.</span><span class="ident" id="5985271">pages</span><span class="op" id="5985276">[</span><span class="ident" id="5985277"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985098">pn</a></span><span class="op" id="5985279">]</span>&nbsp;<span class="op" id="5985281">=</span>&nbsp;<span class="ident" id="5985283"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985172">ret</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985292">return</span>&nbsp;<span class="ident" id="5985299"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985172">ret</a></span><br>
<span class="lineno">50</span><span class="op" id="5985303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5985306">func</span>&nbsp;<span class="op" id="5985311">(</span><span class="ident" id="5985312">pm</span>&nbsp;<span class="op" id="5985315">*</span><span class="ident" id="5985316"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5985325">)</span>&nbsp;<span class="ident" id="5985327">pageForByte</span><span class="op" id="5985338">(</span><span class="ident" id="5985339">addr</span>&nbsp;<span class="builtintype" id="5985344">uint32</span><span class="op" id="5985350">)</span>&nbsp;<span class="op" id="5985352">(</span><span class="op" id="5985353">*</span><span class="ident" id="5985354"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979913">page</a></span><span class="op" id="5985358">,</span>&nbsp;<span class="op" id="5985360">*</span><span class="ident" id="5985361"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5985366">)</span>&nbsp;<span class="op" id="5985368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985371">p</span>&nbsp;<span class="op" id="5985373">:=</span>&nbsp;<span class="ident" id="5985376"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985312">pm</a></span><span class="op" id="5985378">.</span><span class="ident" id="5985379">Page</span><span class="op" id="5985383">(</span><span class="ident" id="5985384"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985339">addr</a></span>&nbsp;<span class="op" id="5985389">/</span>&nbsp;<span class="ident" id="5985391"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><span class="op" id="5985399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985402">if</span>&nbsp;<span class="ident" id="5985405"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985371">p</a></span>&nbsp;<span class="op" id="5985407">==</span>&nbsp;<span class="ident" id="5985410">nil</span>&nbsp;<span class="op" id="5985414">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985418">return</span>&nbsp;<span class="ident" id="5985425">nil</span><span class="op" id="5985428">,</span>&nbsp;<span class="ident" id="5985430"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966189">errOutOfRange</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985448">return</span>&nbsp;<span class="ident" id="5985455"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985371">p</a></span><span class="op" id="5985456">,</span>&nbsp;<span class="ident" id="5985458">nil</span><br>
<span class="lineno"></span><span class="op" id="5985462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="5985465">func</span>&nbsp;<span class="op" id="5985470">(</span><span class="ident" id="5985471">pm</span>&nbsp;<span class="op" id="5985474">*</span><span class="ident" id="5985475"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5985484">)</span>&nbsp;<span class="ident" id="5985486">pageForWord</span><span class="op" id="5985497">(</span><span class="ident" id="5985498">addr</span>&nbsp;<span class="builtintype" id="5985503">uint32</span><span class="op" id="5985509">)</span>&nbsp;<span class="op" id="5985511">(</span><span class="op" id="5985512">*</span><span class="ident" id="5985513"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979913">page</a></span><span class="op" id="5985517">,</span>&nbsp;<span class="op" id="5985519">*</span><span class="ident" id="5985520"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5985525">)</span>&nbsp;<span class="op" id="5985527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985530">if</span>&nbsp;<span class="ident" id="5985533"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985498">addr</a></span><span class="op" id="5985537">%</span><span class="num" id="5985538">4</span>&nbsp;<span class="op" id="5985540">!=</span>&nbsp;<span class="num" id="5985543">0</span>&nbsp;<span class="op" id="5985545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985549">return</span>&nbsp;<span class="ident" id="5985556">nil</span><span class="op" id="5985559">,</span>&nbsp;<span class="ident" id="5985561"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966246">errMisalign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985577">return</span>&nbsp;<span class="ident" id="5985584"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985471">pm</a></span><span class="op" id="5985586">.</span><span class="ident" id="5985587">pageForByte</span><span class="op" id="5985598">(</span><span class="ident" id="5985599"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985498">addr</a></span><span class="op" id="5985603">)</span><br>
<span class="lineno">65</span><span class="op" id="5985605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5985608">//&nbsp;ReadByte&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5985657">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5985713">func</span>&nbsp;<span class="op" id="5985718">(</span><span class="ident" id="5985719">pm</span>&nbsp;<span class="op" id="5985722">*</span><span class="ident" id="5985723"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5985732">)</span>&nbsp;<span class="ident" id="5985734">ReadByte</span><span class="op" id="5985742">(</span><span class="ident" id="5985743">addr</span>&nbsp;<span class="builtintype" id="5985748">uint32</span><span class="op" id="5985754">)</span>&nbsp;<span class="op" id="5985756">(</span><span class="builtintype" id="5985757">byte</span><span class="op" id="5985761">,</span>&nbsp;<span class="op" id="5985763">*</span><span class="ident" id="5985764"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5985769">)</span>&nbsp;<span class="op" id="5985771">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985774">p</span><span class="op" id="5985775">,</span>&nbsp;<span class="ident" id="5985777">e</span>&nbsp;<span class="op" id="5985779">:=</span>&nbsp;<span class="ident" id="5985782"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985719">pm</a></span><span class="op" id="5985784">.</span><span class="ident" id="5985785">pageForByte</span><span class="op" id="5985796">(</span><span class="ident" id="5985797"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985743">addr</a></span><span class="op" id="5985801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985804">if</span>&nbsp;<span class="ident" id="5985807"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985777">e</a></span>&nbsp;<span class="op" id="5985809">!=</span>&nbsp;<span class="ident" id="5985812">nil</span>&nbsp;<span class="op" id="5985816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985820">return</span>&nbsp;<span class="num" id="5985827">0</span><span class="op" id="5985828">,</span>&nbsp;<span class="ident" id="5985830"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985777">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985836">return</span>&nbsp;<span class="ident" id="5985843"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985774">p</a></span><span class="op" id="5985844">.</span><span class="ident" id="5985845">ReadByte</span><span class="op" id="5985853">(</span><span class="ident" id="5985854"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985743">addr</a></span><span class="op" id="5985858">)</span><span class="op" id="5985859">,</span>&nbsp;<span class="ident" id="5985861">nil</span><br>
<span class="lineno">75</span><span class="op" id="5985865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5985868">//&nbsp;WriteByte&nbsp;writes&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5985919">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5985975">func</span>&nbsp;<span class="op" id="5985980">(</span><span class="ident" id="5985981">pm</span>&nbsp;<span class="op" id="5985984">*</span><span class="ident" id="5985985"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5985994">)</span>&nbsp;<span class="ident" id="5985996">WriteByte</span><span class="op" id="5986005">(</span><span class="ident" id="5986006">addr</span>&nbsp;<span class="builtintype" id="5986011">uint32</span><span class="op" id="5986017">,</span>&nbsp;<span class="ident" id="5986019">v</span>&nbsp;<span class="builtintype" id="5986021">byte</span><span class="op" id="5986025">)</span>&nbsp;<span class="op" id="5986027">*</span><span class="ident" id="5986028"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span>&nbsp;<span class="op" id="5986034">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986037">p</span><span class="op" id="5986038">,</span>&nbsp;<span class="ident" id="5986040">e</span>&nbsp;<span class="op" id="5986042">:=</span>&nbsp;<span class="ident" id="5986045"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5985981">pm</a></span><span class="op" id="5986047">.</span><span class="ident" id="5986048">pageForByte</span><span class="op" id="5986059">(</span><span class="ident" id="5986060"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986006">addr</a></span><span class="op" id="5986064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986067">if</span>&nbsp;<span class="ident" id="5986070"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986040">e</a></span>&nbsp;<span class="op" id="5986072">!=</span>&nbsp;<span class="ident" id="5986075">nil</span>&nbsp;<span class="op" id="5986079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986083">return</span>&nbsp;<span class="ident" id="5986090"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986040">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986096"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986037">p</a></span><span class="op" id="5986097">.</span><span class="ident" id="5986098">WriteByte</span><span class="op" id="5986107">(</span><span class="ident" id="5986108"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986006">addr</a></span><span class="op" id="5986112">,</span>&nbsp;<span class="ident" id="5986114"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986019">v</a></span><span class="op" id="5986115">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986118">return</span>&nbsp;<span class="ident" id="5986125"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986040">e</a></span><br>
<span class="lineno"></span><span class="op" id="5986127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5986130">//&nbsp;ReadWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5986179">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">90</span><span class="keyword" id="5986257">func</span>&nbsp;<span class="op" id="5986262">(</span><span class="ident" id="5986263">pm</span>&nbsp;<span class="op" id="5986266">*</span><span class="ident" id="5986267"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5986276">)</span>&nbsp;<span class="ident" id="5986278">ReadWord</span><span class="op" id="5986286">(</span><span class="ident" id="5986287">addr</span>&nbsp;<span class="builtintype" id="5986292">uint32</span><span class="op" id="5986298">)</span>&nbsp;<span class="op" id="5986300">(</span><span class="builtintype" id="5986301">uint32</span><span class="op" id="5986307">,</span>&nbsp;<span class="op" id="5986309">*</span><span class="ident" id="5986310"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span><span class="op" id="5986315">)</span>&nbsp;<span class="op" id="5986317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986320">p</span><span class="op" id="5986321">,</span>&nbsp;<span class="ident" id="5986323">e</span>&nbsp;<span class="op" id="5986325">:=</span>&nbsp;<span class="ident" id="5986328"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986263">pm</a></span><span class="op" id="5986330">.</span><span class="ident" id="5986331">pageForWord</span><span class="op" id="5986342">(</span><span class="ident" id="5986343"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986287">addr</a></span><span class="op" id="5986347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986350">if</span>&nbsp;<span class="ident" id="5986353"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986323">e</a></span>&nbsp;<span class="op" id="5986355">!=</span>&nbsp;<span class="ident" id="5986358">nil</span>&nbsp;<span class="op" id="5986362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986366">return</span>&nbsp;<span class="num" id="5986373">0</span><span class="op" id="5986374">,</span>&nbsp;<span class="ident" id="5986376"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986323">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986379">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986382">return</span>&nbsp;<span class="ident" id="5986389"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986320">p</a></span><span class="op" id="5986390">.</span><span class="ident" id="5986391">ReadWord</span><span class="op" id="5986399">(</span><span class="ident" id="5986400"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986287">addr</a></span><span class="op" id="5986404">)</span><span class="op" id="5986405">,</span>&nbsp;<span class="ident" id="5986407">nil</span><br>
<span class="lineno"></span><span class="op" id="5986411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5986414">//&nbsp;WriteWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="5986464">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">100</span><span class="keyword" id="5986542">func</span>&nbsp;<span class="op" id="5986547">(</span><span class="ident" id="5986548">pm</span>&nbsp;<span class="op" id="5986551">*</span><span class="ident" id="5986552"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><span class="op" id="5986561">)</span>&nbsp;<span class="ident" id="5986563">WriteWord</span><span class="op" id="5986572">(</span><span class="ident" id="5986573">addr</span>&nbsp;<span class="builtintype" id="5986578">uint32</span><span class="op" id="5986584">,</span>&nbsp;<span class="ident" id="5986586">v</span>&nbsp;<span class="builtintype" id="5986588">uint32</span><span class="op" id="5986594">)</span>&nbsp;<span class="op" id="5986596">*</span><span class="ident" id="5986597"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5965541">Excep</a></span>&nbsp;<span class="op" id="5986603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986606">p</span><span class="op" id="5986607">,</span>&nbsp;<span class="ident" id="5986609">e</span>&nbsp;<span class="op" id="5986611">:=</span>&nbsp;<span class="ident" id="5986614"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986548">pm</a></span><span class="op" id="5986616">.</span><span class="ident" id="5986617">pageForWord</span><span class="op" id="5986628">(</span><span class="ident" id="5986629"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986573">addr</a></span><span class="op" id="5986633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986636">if</span>&nbsp;<span class="ident" id="5986639"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986609">e</a></span>&nbsp;<span class="op" id="5986641">!=</span>&nbsp;<span class="ident" id="5986644">nil</span>&nbsp;<span class="op" id="5986648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986652">return</span>&nbsp;<span class="ident" id="5986659"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986609">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5986662">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5986665"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986606">p</a></span><span class="op" id="5986666">.</span><span class="ident" id="5986667">WriteWord</span><span class="op" id="5986676">(</span><span class="ident" id="5986677"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986573">addr</a></span><span class="op" id="5986681">,</span>&nbsp;<span class="ident" id="5986683"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5986586">v</a></span><span class="op" id="5986684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5986687">return</span>&nbsp;<span class="ident" id="5986694">nil</span><br>
<span class="lineno"></span><span class="op" id="5986698">}</span>
</div>
</body>
</html>
