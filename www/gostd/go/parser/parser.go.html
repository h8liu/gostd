<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/parser</h2>
<ul>
<li><a href="/gostd/go/parser/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/go/parser/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/parser/interface.go.html">interface.go</a></li>
<li><a href="/gostd/go/parser/parser.go.html" class="current">parser.go</a></li>
<li><a href="/gostd/go/parser/parser_test.go.html">parser_test.go</a></li>
<li><a href="/gostd/go/parser/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/parser/short_test.go.html">short_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4831745">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4831800">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4831854">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4831905">//&nbsp;Package&nbsp;parser&nbsp;implements&nbsp;a&nbsp;parser&nbsp;for&nbsp;Go&nbsp;source&nbsp;files.&nbsp;Input&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4831977">//&nbsp;provided&nbsp;in&nbsp;a&nbsp;variety&nbsp;of&nbsp;forms&nbsp;(see&nbsp;the&nbsp;various&nbsp;Parse*&nbsp;functions);&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4832051">//&nbsp;output&nbsp;is&nbsp;an&nbsp;abstract&nbsp;syntax&nbsp;tree&nbsp;(AST)&nbsp;representing&nbsp;the&nbsp;Go&nbsp;source.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4832126">//&nbsp;parser&nbsp;is&nbsp;invoked&nbsp;through&nbsp;one&nbsp;of&nbsp;the&nbsp;Parse*&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4832184">//</span><br>
<span class="lineno">10</span><span class="keyword" id="4832187">package</span>&nbsp;<span class="ident" id="4832195">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4832203">import</span>&nbsp;<span class="op" id="4832210">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832213">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832220">&#34;go/ast&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832230">&#34;go/scanner&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832244">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832256">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832267">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4832278">&#34;unicode&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4832288">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4832291">//&nbsp;The&nbsp;parser&nbsp;structure&nbsp;holds&nbsp;the&nbsp;parser&#39;s&nbsp;internal&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="4832350">type</span>&nbsp;<span class="ident" id="4832355">parser</span>&nbsp;<span class="keyword" id="4832362">struct</span>&nbsp;<span class="op" id="4832369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832372">file</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4832380">*</span><span class="ident" id="4832381">token</span><span class="op" id="4832386">.</span><span class="ident" id="4832387">File</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832393">errors</span>&nbsp;&nbsp;<span class="ident" id="4832401">scanner</span><span class="op" id="4832408">.</span><span class="ident" id="4832409">ErrorList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832420">scanner</span>&nbsp;<span class="ident" id="4832428">scanner</span><span class="op" id="4832435">.</span><span class="ident" id="4832436">Scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832446">//&nbsp;Tracing/debugging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832468">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4832475">Mode</span>&nbsp;<span class="comment" id="4832480">//&nbsp;parsing&nbsp;mode</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832497">trace</span>&nbsp;&nbsp;<span class="builtintype" id="4832504">bool</span>&nbsp;<span class="comment" id="4832509">//&nbsp;==&nbsp;(mode&nbsp;&amp;&nbsp;Trace&nbsp;!=&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832536">indent</span>&nbsp;<span class="builtintype" id="4832543">int</span>&nbsp;&nbsp;<span class="comment" id="4832548">//&nbsp;indentation&nbsp;used&nbsp;for&nbsp;tracing&nbsp;output</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832589">//&nbsp;Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832602">comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4832614">[</span><span class="op" id="4832615">]</span><span class="op" id="4832616">*</span><span class="ident" id="4832617">ast</span><span class="op" id="4832620">.</span><span class="ident" id="4832621">CommentGroup</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832635">leadComment</span>&nbsp;<span class="op" id="4832647">*</span><span class="ident" id="4832648">ast</span><span class="op" id="4832651">.</span><span class="ident" id="4832652">CommentGroup</span>&nbsp;<span class="comment" id="4832665">//&nbsp;last&nbsp;lead&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832687">lineComment</span>&nbsp;<span class="op" id="4832699">*</span><span class="ident" id="4832700">ast</span><span class="op" id="4832703">.</span><span class="ident" id="4832704">CommentGroup</span>&nbsp;<span class="comment" id="4832717">//&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832740">//&nbsp;Next&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832755">pos</span>&nbsp;<span class="ident" id="4832759">token</span><span class="op" id="4832764">.</span><span class="ident" id="4832765">Pos</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4832771">//&nbsp;token&nbsp;position</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832790">tok</span>&nbsp;<span class="ident" id="4832794">token</span><span class="op" id="4832799">.</span><span class="ident" id="4832800">Token</span>&nbsp;<span class="comment" id="4832806">//&nbsp;one&nbsp;token&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4832831">lit</span>&nbsp;<span class="builtintype" id="4832835">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832847">//&nbsp;token&nbsp;literal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832866">//&nbsp;Error&nbsp;recovery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832885">//&nbsp;(used&nbsp;to&nbsp;limit&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;to&nbsp;syncXXX&nbsp;functions</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4832945">//&nbsp;w/o&nbsp;making&nbsp;scanning&nbsp;progress&nbsp;-&nbsp;avoids&nbsp;potential&nbsp;endless</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833005">//&nbsp;loops&nbsp;across&nbsp;multiple&nbsp;parser&nbsp;functions&nbsp;during&nbsp;error&nbsp;recovery)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833071">syncPos</span>&nbsp;<span class="ident" id="4833079">token</span><span class="op" id="4833084">.</span><span class="ident" id="4833085">Pos</span>&nbsp;<span class="comment" id="4833089">//&nbsp;last&nbsp;synchronization&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833123">syncCnt</span>&nbsp;<span class="builtintype" id="4833131">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833141">//&nbsp;number&nbsp;of&nbsp;calls&nbsp;to&nbsp;syncXXX&nbsp;without&nbsp;progress</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833190">//&nbsp;Non-syntactic&nbsp;parser&nbsp;control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833223">exprLev</span>&nbsp;<span class="builtintype" id="4833231">int</span>&nbsp;&nbsp;<span class="comment" id="4833236">//&nbsp;&lt;&nbsp;0:&nbsp;in&nbsp;control&nbsp;clause,&nbsp;&gt;=&nbsp;0:&nbsp;in&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833284">inRhs</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4833292">bool</span>&nbsp;<span class="comment" id="4833297">//&nbsp;if&nbsp;set,&nbsp;the&nbsp;parser&nbsp;is&nbsp;parsing&nbsp;a&nbsp;rhs&nbsp;expression</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833349">//&nbsp;Ordinary&nbsp;identifier&nbsp;scopes</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833380">pkgScope</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4833391">*</span><span class="ident" id="4833392">ast</span><span class="op" id="4833395">.</span><span class="ident" id="4833396">Scope</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833409">//&nbsp;pkgScope.Outer&nbsp;==&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833435">topScope</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4833446">*</span><span class="ident" id="4833447">ast</span><span class="op" id="4833450">.</span><span class="ident" id="4833451">Scope</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833464">//&nbsp;top-most&nbsp;scope;&nbsp;may&nbsp;be&nbsp;pkgScope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833500">unresolved</span>&nbsp;<span class="op" id="4833511">[</span><span class="op" id="4833512">]</span><span class="op" id="4833513">*</span><span class="ident" id="4833514">ast</span><span class="op" id="4833517">.</span><span class="ident" id="4833518">Ident</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833529">//&nbsp;unresolved&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833556">imports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4833567">[</span><span class="op" id="4833568">]</span><span class="op" id="4833569">*</span><span class="ident" id="4833570">ast</span><span class="op" id="4833573">.</span><span class="ident" id="4833574">ImportSpec</span>&nbsp;<span class="comment" id="4833585">//&nbsp;list&nbsp;of&nbsp;imports</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833606">//&nbsp;Label&nbsp;scopes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833623">//&nbsp;(maintained&nbsp;by&nbsp;open/close&nbsp;LabelScope)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833665">labelScope</span>&nbsp;&nbsp;<span class="op" id="4833677">*</span><span class="ident" id="4833678">ast</span><span class="op" id="4833681">.</span><span class="ident" id="4833682">Scope</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4833692">//&nbsp;label&nbsp;scope&nbsp;for&nbsp;current&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833729">targetStack</span>&nbsp;<span class="op" id="4833741">[</span><span class="op" id="4833742">]</span><span class="op" id="4833743">[</span><span class="op" id="4833744">]</span><span class="op" id="4833745">*</span><span class="ident" id="4833746">ast</span><span class="op" id="4833749">.</span><span class="ident" id="4833750">Ident</span>&nbsp;<span class="comment" id="4833756">//&nbsp;stack&nbsp;of&nbsp;unresolved&nbsp;labels</span><br>
<span class="lineno"></span><span class="op" id="4833786">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4833789">func</span>&nbsp;<span class="op" id="4833794">(</span><span class="ident" id="4833795">p</span>&nbsp;<span class="op" id="4833797">*</span><span class="ident" id="4833798">parser</span><span class="op" id="4833804">)</span>&nbsp;<span class="ident" id="4833806">init</span><span class="op" id="4833810">(</span><span class="ident" id="4833811">fset</span>&nbsp;<span class="op" id="4833816">*</span><span class="ident" id="4833817">token</span><span class="op" id="4833822">.</span><span class="ident" id="4833823">FileSet</span><span class="op" id="4833830">,</span>&nbsp;<span class="ident" id="4833832">filename</span>&nbsp;<span class="builtintype" id="4833841">string</span><span class="op" id="4833847">,</span>&nbsp;<span class="ident" id="4833849">src</span>&nbsp;<span class="op" id="4833853">[</span><span class="op" id="4833854">]</span><span class="builtintype" id="4833855">byte</span><span class="op" id="4833859">,</span>&nbsp;<span class="ident" id="4833861">mode</span>&nbsp;<span class="ident" id="4833866">Mode</span><span class="op" id="4833870">)</span>&nbsp;<span class="op" id="4833872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833875">p</span><span class="op" id="4833876">.</span><span class="ident" id="4833877">file</span>&nbsp;<span class="op" id="4833882">=</span>&nbsp;<span class="ident" id="4833884">fset</span><span class="op" id="4833888">.</span><span class="ident" id="4833889">AddFile</span><span class="op" id="4833896">(</span><span class="ident" id="4833897">filename</span><span class="op" id="4833905">,</span>&nbsp;<span class="op" id="4833907">-</span><span class="num" id="4833908">1</span><span class="op" id="4833909">,</span>&nbsp;<span class="builtinfunc" id="4833911">len</span><span class="op" id="4833914">(</span><span class="ident" id="4833915">src</span><span class="op" id="4833918">)</span><span class="op" id="4833919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4833922">var</span>&nbsp;<span class="ident" id="4833926">m</span>&nbsp;<span class="ident" id="4833928">scanner</span><span class="op" id="4833935">.</span><span class="ident" id="4833936">Mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4833942">if</span>&nbsp;<span class="ident" id="4833945">mode</span><span class="op" id="4833949">&amp;</span><span class="ident" id="4833950">ParseComments</span>&nbsp;<span class="op" id="4833964">!=</span>&nbsp;<span class="num" id="4833967">0</span>&nbsp;<span class="op" id="4833969">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4833973">m</span>&nbsp;<span class="op" id="4833975">=</span>&nbsp;<span class="ident" id="4833977">scanner</span><span class="op" id="4833984">.</span><span class="ident" id="4833985">ScanComments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4833999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834002">eh</span>&nbsp;<span class="op" id="4834005">:=</span>&nbsp;<span class="keyword" id="4834008">func</span><span class="op" id="4834012">(</span><span class="ident" id="4834013">pos</span>&nbsp;<span class="ident" id="4834017">token</span><span class="op" id="4834022">.</span><span class="ident" id="4834023">Position</span><span class="op" id="4834031">,</span>&nbsp;<span class="ident" id="4834033">msg</span>&nbsp;<span class="builtintype" id="4834037">string</span><span class="op" id="4834043">)</span>&nbsp;<span class="op" id="4834045">{</span>&nbsp;<span class="ident" id="4834047">p</span><span class="op" id="4834048">.</span><span class="ident" id="4834049">errors</span><span class="op" id="4834055">.</span><span class="ident" id="4834056">Add</span><span class="op" id="4834059">(</span><span class="ident" id="4834060">pos</span><span class="op" id="4834063">,</span>&nbsp;<span class="ident" id="4834065">msg</span><span class="op" id="4834068">)</span>&nbsp;<span class="op" id="4834070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834073">p</span><span class="op" id="4834074">.</span><span class="ident" id="4834075">scanner</span><span class="op" id="4834082">.</span><span class="ident" id="4834083">Init</span><span class="op" id="4834087">(</span><span class="ident" id="4834088">p</span><span class="op" id="4834089">.</span><span class="ident" id="4834090">file</span><span class="op" id="4834094">,</span>&nbsp;<span class="ident" id="4834096">src</span><span class="op" id="4834099">,</span>&nbsp;<span class="ident" id="4834101">eh</span><span class="op" id="4834103">,</span>&nbsp;<span class="ident" id="4834105">m</span><span class="op" id="4834106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834110">p</span><span class="op" id="4834111">.</span><span class="ident" id="4834112">mode</span>&nbsp;<span class="op" id="4834117">=</span>&nbsp;<span class="ident" id="4834119">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834125">p</span><span class="op" id="4834126">.</span><span class="ident" id="4834127">trace</span>&nbsp;<span class="op" id="4834133">=</span>&nbsp;<span class="ident" id="4834135">mode</span><span class="op" id="4834139">&amp;</span><span class="ident" id="4834140">Trace</span>&nbsp;<span class="op" id="4834146">!=</span>&nbsp;<span class="num" id="4834149">0</span>&nbsp;<span class="comment" id="4834151">//&nbsp;for&nbsp;convenience&nbsp;(p.trace&nbsp;is&nbsp;used&nbsp;frequently)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834201">p</span><span class="op" id="4834202">.</span><span class="ident" id="4834203">next</span><span class="op" id="4834207">(</span><span class="op" id="4834208">)</span><br>
<span class="lineno"></span><span class="op" id="4834210">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4834213">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4834293">//&nbsp;Scoping&nbsp;support</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4834313">func</span>&nbsp;<span class="op" id="4834318">(</span><span class="ident" id="4834319">p</span>&nbsp;<span class="op" id="4834321">*</span><span class="ident" id="4834322">parser</span><span class="op" id="4834328">)</span>&nbsp;<span class="ident" id="4834330">openScope</span><span class="op" id="4834339">(</span><span class="op" id="4834340">)</span>&nbsp;<span class="op" id="4834342">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834345">p</span><span class="op" id="4834346">.</span><span class="ident" id="4834347">topScope</span>&nbsp;<span class="op" id="4834356">=</span>&nbsp;<span class="ident" id="4834358">ast</span><span class="op" id="4834361">.</span><span class="ident" id="4834362">NewScope</span><span class="op" id="4834370">(</span><span class="ident" id="4834371">p</span><span class="op" id="4834372">.</span><span class="ident" id="4834373">topScope</span><span class="op" id="4834381">)</span><br>
<span class="lineno"></span><span class="op" id="4834383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4834386">func</span>&nbsp;<span class="op" id="4834391">(</span><span class="ident" id="4834392">p</span>&nbsp;<span class="op" id="4834394">*</span><span class="ident" id="4834395">parser</span><span class="op" id="4834401">)</span>&nbsp;<span class="ident" id="4834403">closeScope</span><span class="op" id="4834413">(</span><span class="op" id="4834414">)</span>&nbsp;<span class="op" id="4834416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834419">p</span><span class="op" id="4834420">.</span><span class="ident" id="4834421">topScope</span>&nbsp;<span class="op" id="4834430">=</span>&nbsp;<span class="ident" id="4834432">p</span><span class="op" id="4834433">.</span><span class="ident" id="4834434">topScope</span><span class="op" id="4834442">.</span><span class="ident" id="4834443">Outer</span><br>
<span class="lineno">90</span><span class="op" id="4834449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4834452">func</span>&nbsp;<span class="op" id="4834457">(</span><span class="ident" id="4834458">p</span>&nbsp;<span class="op" id="4834460">*</span><span class="ident" id="4834461">parser</span><span class="op" id="4834467">)</span>&nbsp;<span class="ident" id="4834469">openLabelScope</span><span class="op" id="4834483">(</span><span class="op" id="4834484">)</span>&nbsp;<span class="op" id="4834486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834489">p</span><span class="op" id="4834490">.</span><span class="ident" id="4834491">labelScope</span>&nbsp;<span class="op" id="4834502">=</span>&nbsp;<span class="ident" id="4834504">ast</span><span class="op" id="4834507">.</span><span class="ident" id="4834508">NewScope</span><span class="op" id="4834516">(</span><span class="ident" id="4834517">p</span><span class="op" id="4834518">.</span><span class="ident" id="4834519">labelScope</span><span class="op" id="4834529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834532">p</span><span class="op" id="4834533">.</span><span class="ident" id="4834534">targetStack</span>&nbsp;<span class="op" id="4834546">=</span>&nbsp;<span class="builtinfunc" id="4834548">append</span><span class="op" id="4834554">(</span><span class="ident" id="4834555">p</span><span class="op" id="4834556">.</span><span class="ident" id="4834557">targetStack</span><span class="op" id="4834568">,</span>&nbsp;<span class="builtintype" id="4834570">nil</span><span class="op" id="4834573">)</span><br>
<span class="lineno">95</span><span class="op" id="4834575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4834578">func</span>&nbsp;<span class="op" id="4834583">(</span><span class="ident" id="4834584">p</span>&nbsp;<span class="op" id="4834586">*</span><span class="ident" id="4834587">parser</span><span class="op" id="4834593">)</span>&nbsp;<span class="ident" id="4834595">closeLabelScope</span><span class="op" id="4834610">(</span><span class="op" id="4834611">)</span>&nbsp;<span class="op" id="4834613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4834616">//&nbsp;resolve&nbsp;labels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834635">n</span>&nbsp;<span class="op" id="4834637">:=</span>&nbsp;<span class="builtinfunc" id="4834640">len</span><span class="op" id="4834643">(</span><span class="ident" id="4834644">p</span><span class="op" id="4834645">.</span><span class="ident" id="4834646">targetStack</span><span class="op" id="4834657">)</span>&nbsp;<span class="op" id="4834659">-</span>&nbsp;<span class="num" id="4834661">1</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834664">scope</span>&nbsp;<span class="op" id="4834670">:=</span>&nbsp;<span class="ident" id="4834673">p</span><span class="op" id="4834674">.</span><span class="ident" id="4834675">labelScope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4834687">for</span>&nbsp;<span class="ident" id="4834691">_</span><span class="op" id="4834692">,</span>&nbsp;<span class="ident" id="4834694">ident</span>&nbsp;<span class="op" id="4834700">:=</span>&nbsp;<span class="keyword" id="4834703">range</span>&nbsp;<span class="ident" id="4834709">p</span><span class="op" id="4834710">.</span><span class="ident" id="4834711">targetStack</span><span class="op" id="4834722">[</span><span class="ident" id="4834723">n</span><span class="op" id="4834724">]</span>&nbsp;<span class="op" id="4834726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834730">ident</span><span class="op" id="4834735">.</span><span class="ident" id="4834736">Obj</span>&nbsp;<span class="op" id="4834740">=</span>&nbsp;<span class="ident" id="4834742">scope</span><span class="op" id="4834747">.</span><span class="ident" id="4834748">Lookup</span><span class="op" id="4834754">(</span><span class="ident" id="4834755">ident</span><span class="op" id="4834760">.</span><span class="ident" id="4834761">Name</span><span class="op" id="4834765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4834769">if</span>&nbsp;<span class="ident" id="4834772">ident</span><span class="op" id="4834777">.</span><span class="ident" id="4834778">Obj</span>&nbsp;<span class="op" id="4834782">==</span>&nbsp;<span class="builtintype" id="4834785">nil</span>&nbsp;<span class="op" id="4834789">&amp;&amp;</span>&nbsp;<span class="ident" id="4834792">p</span><span class="op" id="4834793">.</span><span class="ident" id="4834794">mode</span><span class="op" id="4834798">&amp;</span><span class="ident" id="4834799">DeclarationErrors</span>&nbsp;<span class="op" id="4834817">!=</span>&nbsp;<span class="num" id="4834820">0</span>&nbsp;<span class="op" id="4834822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834827">p</span><span class="op" id="4834828">.</span><span class="builtintype" id="4834829">error</span><span class="op" id="4834834">(</span><span class="ident" id="4834835">ident</span><span class="op" id="4834840">.</span><span class="ident" id="4834841">Pos</span><span class="op" id="4834844">(</span><span class="op" id="4834845">)</span><span class="op" id="4834846">,</span>&nbsp;<span class="ident" id="4834848">fmt</span><span class="op" id="4834851">.</span><span class="ident" id="4834852">Sprintf</span><span class="op" id="4834859">(</span><span class="string" id="4834860">&#34;label&nbsp;%s&nbsp;undefined&#34;</span><span class="op" id="4834880">,</span>&nbsp;<span class="ident" id="4834882">ident</span><span class="op" id="4834887">.</span><span class="ident" id="4834888">Name</span><span class="op" id="4834892">)</span><span class="op" id="4834893">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4834897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4834900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4834903">//&nbsp;pop&nbsp;label&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834923">p</span><span class="op" id="4834924">.</span><span class="ident" id="4834925">targetStack</span>&nbsp;<span class="op" id="4834937">=</span>&nbsp;<span class="ident" id="4834939">p</span><span class="op" id="4834940">.</span><span class="ident" id="4834941">targetStack</span><span class="op" id="4834952">[</span><span class="num" id="4834953">0</span><span class="op" id="4834954">:</span><span class="ident" id="4834955">n</span><span class="op" id="4834956">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4834959">p</span><span class="op" id="4834960">.</span><span class="ident" id="4834961">labelScope</span>&nbsp;<span class="op" id="4834972">=</span>&nbsp;<span class="ident" id="4834974">p</span><span class="op" id="4834975">.</span><span class="ident" id="4834976">labelScope</span><span class="op" id="4834986">.</span><span class="ident" id="4834987">Outer</span><br>
<span class="lineno">110</span><span class="op" id="4834993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4834996">func</span>&nbsp;<span class="op" id="4835001">(</span><span class="ident" id="4835002">p</span>&nbsp;<span class="op" id="4835004">*</span><span class="ident" id="4835005">parser</span><span class="op" id="4835011">)</span>&nbsp;<span class="ident" id="4835013">declare</span><span class="op" id="4835020">(</span><span class="ident" id="4835021">decl</span><span class="op" id="4835025">,</span>&nbsp;<span class="ident" id="4835027">data</span>&nbsp;<span class="keyword" id="4835032">interface</span><span class="op" id="4835041">{</span><span class="op" id="4835042">}</span><span class="op" id="4835043">,</span>&nbsp;<span class="ident" id="4835045">scope</span>&nbsp;<span class="op" id="4835051">*</span><span class="ident" id="4835052">ast</span><span class="op" id="4835055">.</span><span class="ident" id="4835056">Scope</span><span class="op" id="4835061">,</span>&nbsp;<span class="ident" id="4835063">kind</span>&nbsp;<span class="ident" id="4835068">ast</span><span class="op" id="4835071">.</span><span class="ident" id="4835072">ObjKind</span><span class="op" id="4835079">,</span>&nbsp;<span class="ident" id="4835081">idents</span>&nbsp;<span class="op" id="4835088">...</span><span class="op" id="4835091">*</span><span class="ident" id="4835092">ast</span><span class="op" id="4835095">.</span><span class="ident" id="4835096">Ident</span><span class="op" id="4835101">)</span>&nbsp;<span class="op" id="4835103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4835106">for</span>&nbsp;<span class="ident" id="4835110">_</span><span class="op" id="4835111">,</span>&nbsp;<span class="ident" id="4835113">ident</span>&nbsp;<span class="op" id="4835119">:=</span>&nbsp;<span class="keyword" id="4835122">range</span>&nbsp;<span class="ident" id="4835128">idents</span>&nbsp;<span class="op" id="4835135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835139">assert</span><span class="op" id="4835145">(</span><span class="ident" id="4835146">ident</span><span class="op" id="4835151">.</span><span class="ident" id="4835152">Obj</span>&nbsp;<span class="op" id="4835156">==</span>&nbsp;<span class="builtintype" id="4835159">nil</span><span class="op" id="4835162">,</span>&nbsp;<span class="string" id="4835164">&#34;identifier&nbsp;already&nbsp;declared&nbsp;or&nbsp;resolved&#34;</span><span class="op" id="4835205">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835209">obj</span>&nbsp;<span class="op" id="4835213">:=</span>&nbsp;<span class="ident" id="4835216">ast</span><span class="op" id="4835219">.</span><span class="ident" id="4835220">NewObj</span><span class="op" id="4835226">(</span><span class="ident" id="4835227">kind</span><span class="op" id="4835231">,</span>&nbsp;<span class="ident" id="4835233">ident</span><span class="op" id="4835238">.</span><span class="ident" id="4835239">Name</span><span class="op" id="4835243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4835247">//&nbsp;remember&nbsp;the&nbsp;corresponding&nbsp;declaration&nbsp;for&nbsp;redeclaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4835309">//&nbsp;errors&nbsp;and&nbsp;global&nbsp;variable&nbsp;resolution/typechecking&nbsp;phase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835371">obj</span><span class="op" id="4835374">.</span><span class="ident" id="4835375">Decl</span>&nbsp;<span class="op" id="4835380">=</span>&nbsp;<span class="ident" id="4835382">decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835389">obj</span><span class="op" id="4835392">.</span><span class="ident" id="4835393">Data</span>&nbsp;<span class="op" id="4835398">=</span>&nbsp;<span class="ident" id="4835400">data</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835407">ident</span><span class="op" id="4835412">.</span><span class="ident" id="4835413">Obj</span>&nbsp;<span class="op" id="4835417">=</span>&nbsp;<span class="ident" id="4835419">obj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4835425">if</span>&nbsp;<span class="ident" id="4835428">ident</span><span class="op" id="4835433">.</span><span class="ident" id="4835434">Name</span>&nbsp;<span class="op" id="4835439">!=</span>&nbsp;<span class="string" id="4835442">&#34;_&#34;</span>&nbsp;<span class="op" id="4835446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4835451">if</span>&nbsp;<span class="ident" id="4835454">alt</span>&nbsp;<span class="op" id="4835458">:=</span>&nbsp;<span class="ident" id="4835461">scope</span><span class="op" id="4835466">.</span><span class="ident" id="4835467">Insert</span><span class="op" id="4835473">(</span><span class="ident" id="4835474">obj</span><span class="op" id="4835477">)</span><span class="op" id="4835478">;</span>&nbsp;<span class="ident" id="4835480">alt</span>&nbsp;<span class="op" id="4835484">!=</span>&nbsp;<span class="builtintype" id="4835487">nil</span>&nbsp;<span class="op" id="4835491">&amp;&amp;</span>&nbsp;<span class="ident" id="4835494">p</span><span class="op" id="4835495">.</span><span class="ident" id="4835496">mode</span><span class="op" id="4835500">&amp;</span><span class="ident" id="4835501">DeclarationErrors</span>&nbsp;<span class="op" id="4835519">!=</span>&nbsp;<span class="num" id="4835522">0</span>&nbsp;<span class="op" id="4835524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835530">prevDecl</span>&nbsp;<span class="op" id="4835539">:=</span>&nbsp;<span class="string" id="4835542">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4835549">if</span>&nbsp;<span class="ident" id="4835552">pos</span>&nbsp;<span class="op" id="4835556">:=</span>&nbsp;<span class="ident" id="4835559">alt</span><span class="op" id="4835562">.</span><span class="ident" id="4835563">Pos</span><span class="op" id="4835566">(</span><span class="op" id="4835567">)</span><span class="op" id="4835568">;</span>&nbsp;<span class="ident" id="4835570">pos</span><span class="op" id="4835573">.</span><span class="ident" id="4835574">IsValid</span><span class="op" id="4835581">(</span><span class="op" id="4835582">)</span>&nbsp;<span class="op" id="4835584">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835591">prevDecl</span>&nbsp;<span class="op" id="4835600">=</span>&nbsp;<span class="ident" id="4835602">fmt</span><span class="op" id="4835605">.</span><span class="ident" id="4835606">Sprintf</span><span class="op" id="4835613">(</span><span class="string" id="4835614">&#34;\n\tprevious&nbsp;declaration&nbsp;at&nbsp;%s&#34;</span><span class="op" id="4835646">,</span>&nbsp;<span class="ident" id="4835648">p</span><span class="op" id="4835649">.</span><span class="ident" id="4835650">file</span><span class="op" id="4835654">.</span><span class="ident" id="4835655">Position</span><span class="op" id="4835663">(</span><span class="ident" id="4835664">pos</span><span class="op" id="4835667">)</span><span class="op" id="4835668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4835674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4835680">p</span><span class="op" id="4835681">.</span><span class="builtintype" id="4835682">error</span><span class="op" id="4835687">(</span><span class="ident" id="4835688">ident</span><span class="op" id="4835693">.</span><span class="ident" id="4835694">Pos</span><span class="op" id="4835697">(</span><span class="op" id="4835698">)</span><span class="op" id="4835699">,</span>&nbsp;<span class="ident" id="4835701">fmt</span><span class="op" id="4835704">.</span><span class="ident" id="4835705">Sprintf</span><span class="op" id="4835712">(</span><span class="string" id="4835713">&#34;%s&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;block%s&#34;</span><span class="op" id="4835744">,</span>&nbsp;<span class="ident" id="4835746">ident</span><span class="op" id="4835751">.</span><span class="ident" id="4835752">Name</span><span class="op" id="4835756">,</span>&nbsp;<span class="ident" id="4835758">prevDecl</span><span class="op" id="4835766">)</span><span class="op" id="4835767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4835772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4835776">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4835779">}</span><br>
<span class="lineno"></span><span class="op" id="4835781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4835784">func</span>&nbsp;<span class="op" id="4835789">(</span><span class="ident" id="4835790">p</span>&nbsp;<span class="op" id="4835792">*</span><span class="ident" id="4835793">parser</span><span class="op" id="4835799">)</span>&nbsp;<span class="ident" id="4835801">shortVarDecl</span><span class="op" id="4835813">(</span><span class="ident" id="4835814">decl</span>&nbsp;<span class="op" id="4835819">*</span><span class="ident" id="4835820">ast</span><span class="op" id="4835823">.</span><span class="ident" id="4835824">AssignStmt</span><span class="op" id="4835834">,</span>&nbsp;<span class="ident" id="4835836">list</span>&nbsp;<span class="op" id="4835841">[</span><span class="op" id="4835842">]</span><span class="ident" id="4835843">ast</span><span class="op" id="4835846">.</span><span class="ident" id="4835847">Expr</span><span class="op" id="4835851">)</span>&nbsp;<span class="op" id="4835853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4835856">//&nbsp;Go&nbsp;spec:&nbsp;A&nbsp;short&nbsp;variable&nbsp;declaration&nbsp;may&nbsp;redeclare&nbsp;variables</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4835922">//&nbsp;provided&nbsp;they&nbsp;were&nbsp;originally&nbsp;declared&nbsp;in&nbsp;the&nbsp;same&nbsp;block&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4835988">//&nbsp;the&nbsp;same&nbsp;type,&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;non-blank&nbsp;variables&nbsp;is&nbsp;new.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836059">n</span>&nbsp;<span class="op" id="4836061">:=</span>&nbsp;<span class="num" id="4836064">0</span>&nbsp;<span class="comment" id="4836066">//&nbsp;number&nbsp;of&nbsp;new&nbsp;variables</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4836094">for</span>&nbsp;<span class="ident" id="4836098">_</span><span class="op" id="4836099">,</span>&nbsp;<span class="ident" id="4836101">x</span>&nbsp;<span class="op" id="4836103">:=</span>&nbsp;<span class="keyword" id="4836106">range</span>&nbsp;<span class="ident" id="4836112">list</span>&nbsp;<span class="op" id="4836117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4836121">if</span>&nbsp;<span class="ident" id="4836124">ident</span><span class="op" id="4836129">,</span>&nbsp;<span class="ident" id="4836131">isIdent</span>&nbsp;<span class="op" id="4836139">:=</span>&nbsp;<span class="ident" id="4836142">x</span><span class="op" id="4836143">.</span><span class="op" id="4836144">(</span><span class="op" id="4836145">*</span><span class="ident" id="4836146">ast</span><span class="op" id="4836149">.</span><span class="ident" id="4836150">Ident</span><span class="op" id="4836155">)</span><span class="op" id="4836156">;</span>&nbsp;<span class="ident" id="4836158">isIdent</span>&nbsp;<span class="op" id="4836166">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836171">assert</span><span class="op" id="4836177">(</span><span class="ident" id="4836178">ident</span><span class="op" id="4836183">.</span><span class="ident" id="4836184">Obj</span>&nbsp;<span class="op" id="4836188">==</span>&nbsp;<span class="builtintype" id="4836191">nil</span><span class="op" id="4836194">,</span>&nbsp;<span class="string" id="4836196">&#34;identifier&nbsp;already&nbsp;declared&nbsp;or&nbsp;resolved&#34;</span><span class="op" id="4836237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836242">obj</span>&nbsp;<span class="op" id="4836246">:=</span>&nbsp;<span class="ident" id="4836249">ast</span><span class="op" id="4836252">.</span><span class="ident" id="4836253">NewObj</span><span class="op" id="4836259">(</span><span class="ident" id="4836260">ast</span><span class="op" id="4836263">.</span><span class="ident" id="4836264">Var</span><span class="op" id="4836267">,</span>&nbsp;<span class="ident" id="4836269">ident</span><span class="op" id="4836274">.</span><span class="ident" id="4836275">Name</span><span class="op" id="4836279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4836284">//&nbsp;remember&nbsp;corresponding&nbsp;assignment&nbsp;for&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836340">obj</span><span class="op" id="4836343">.</span><span class="ident" id="4836344">Decl</span>&nbsp;<span class="op" id="4836349">=</span>&nbsp;<span class="ident" id="4836351">decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836359">ident</span><span class="op" id="4836364">.</span><span class="ident" id="4836365">Obj</span>&nbsp;<span class="op" id="4836369">=</span>&nbsp;<span class="ident" id="4836371">obj</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4836378">if</span>&nbsp;<span class="ident" id="4836381">ident</span><span class="op" id="4836386">.</span><span class="ident" id="4836387">Name</span>&nbsp;<span class="op" id="4836392">!=</span>&nbsp;<span class="string" id="4836395">&#34;_&#34;</span>&nbsp;<span class="op" id="4836399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4836405">if</span>&nbsp;<span class="ident" id="4836408">alt</span>&nbsp;<span class="op" id="4836412">:=</span>&nbsp;<span class="ident" id="4836415">p</span><span class="op" id="4836416">.</span><span class="ident" id="4836417">topScope</span><span class="op" id="4836425">.</span><span class="ident" id="4836426">Insert</span><span class="op" id="4836432">(</span><span class="ident" id="4836433">obj</span><span class="op" id="4836436">)</span><span class="op" id="4836437">;</span>&nbsp;<span class="ident" id="4836439">alt</span>&nbsp;<span class="op" id="4836443">!=</span>&nbsp;<span class="builtintype" id="4836446">nil</span>&nbsp;<span class="op" id="4836450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836457">ident</span><span class="op" id="4836462">.</span><span class="ident" id="4836463">Obj</span>&nbsp;<span class="op" id="4836467">=</span>&nbsp;<span class="ident" id="4836469">alt</span>&nbsp;<span class="comment" id="4836473">//&nbsp;redeclaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836494">}</span>&nbsp;<span class="keyword" id="4836496">else</span>&nbsp;<span class="op" id="4836501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836508">n</span><span class="op" id="4836509">++</span>&nbsp;<span class="comment" id="4836512">//&nbsp;new&nbsp;declaration</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836544">}</span>&nbsp;<span class="keyword" id="4836546">else</span>&nbsp;<span class="op" id="4836551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836556">p</span><span class="op" id="4836557">.</span><span class="ident" id="4836558">errorExpected</span><span class="op" id="4836571">(</span><span class="ident" id="4836572">x</span><span class="op" id="4836573">.</span><span class="ident" id="4836574">Pos</span><span class="op" id="4836577">(</span><span class="op" id="4836578">)</span><span class="op" id="4836579">,</span>&nbsp;<span class="string" id="4836581">&#34;identifier&nbsp;on&nbsp;left&nbsp;side&nbsp;of&nbsp;:=&#34;</span><span class="op" id="4836612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836616">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4836622">if</span>&nbsp;<span class="ident" id="4836625">n</span>&nbsp;<span class="op" id="4836627">==</span>&nbsp;<span class="num" id="4836630">0</span>&nbsp;<span class="op" id="4836632">&amp;&amp;</span>&nbsp;<span class="ident" id="4836635">p</span><span class="op" id="4836636">.</span><span class="ident" id="4836637">mode</span><span class="op" id="4836641">&amp;</span><span class="ident" id="4836642">DeclarationErrors</span>&nbsp;<span class="op" id="4836660">!=</span>&nbsp;<span class="num" id="4836663">0</span>&nbsp;<span class="op" id="4836665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4836669">p</span><span class="op" id="4836670">.</span><span class="builtintype" id="4836671">error</span><span class="op" id="4836676">(</span><span class="ident" id="4836677">list</span><span class="op" id="4836681">[</span><span class="num" id="4836682">0</span><span class="op" id="4836683">]</span><span class="op" id="4836684">.</span><span class="ident" id="4836685">Pos</span><span class="op" id="4836688">(</span><span class="op" id="4836689">)</span><span class="op" id="4836690">,</span>&nbsp;<span class="string" id="4836692">&#34;no&nbsp;new&nbsp;variables&nbsp;on&nbsp;left&nbsp;side&nbsp;of&nbsp;:=&#34;</span><span class="op" id="4836729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4836732">}</span><br>
<span class="lineno"></span><span class="op" id="4836734">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="4836737">//&nbsp;The&nbsp;unresolved&nbsp;object&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;to&nbsp;mark&nbsp;identifiers&nbsp;that&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span><span class="comment" id="4836817">//&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;unresolved&nbsp;identifiers.&nbsp;The&nbsp;sentinel&nbsp;is&nbsp;only&nbsp;used&nbsp;for&nbsp;verifying</span><br>
<span class="lineno"></span><span class="comment" id="4836899">//&nbsp;internal&nbsp;consistency.</span><br>
<span class="lineno"></span><span class="keyword" id="4836924">var</span>&nbsp;<span class="ident" id="4836928">unresolved</span>&nbsp;<span class="op" id="4836939">=</span>&nbsp;<span class="builtinfunc" id="4836941">new</span><span class="op" id="4836944">(</span><span class="ident" id="4836945">ast</span><span class="op" id="4836948">.</span><span class="ident" id="4836949">Object</span><span class="op" id="4836955">)</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4836958">//&nbsp;If&nbsp;x&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;tryResolve&nbsp;attempts&nbsp;to&nbsp;resolve&nbsp;x&nbsp;by&nbsp;looking&nbsp;up</span><br>
<span class="lineno"></span><span class="comment" id="4837031">//&nbsp;the&nbsp;object&nbsp;it&nbsp;denotes.&nbsp;If&nbsp;no&nbsp;object&nbsp;is&nbsp;found&nbsp;and&nbsp;collectUnresolved&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4837104">//&nbsp;set,&nbsp;x&nbsp;is&nbsp;marked&nbsp;as&nbsp;unresolved&nbsp;and&nbsp;collected&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;unresolved</span><br>
<span class="lineno"></span><span class="comment" id="4837178">//&nbsp;identifiers.</span><br>
<span class="lineno">170</span><span class="comment" id="4837194">//</span><br>
<span class="lineno"></span><span class="keyword" id="4837197">func</span>&nbsp;<span class="op" id="4837202">(</span><span class="ident" id="4837203">p</span>&nbsp;<span class="op" id="4837205">*</span><span class="ident" id="4837206">parser</span><span class="op" id="4837212">)</span>&nbsp;<span class="ident" id="4837214">tryResolve</span><span class="op" id="4837224">(</span><span class="ident" id="4837225">x</span>&nbsp;<span class="ident" id="4837227">ast</span><span class="op" id="4837230">.</span><span class="ident" id="4837231">Expr</span><span class="op" id="4837235">,</span>&nbsp;<span class="ident" id="4837237">collectUnresolved</span>&nbsp;<span class="builtintype" id="4837255">bool</span><span class="op" id="4837259">)</span>&nbsp;<span class="op" id="4837261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837264">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;if&nbsp;x&nbsp;is&nbsp;not&nbsp;an&nbsp;identifier&nbsp;or&nbsp;the&nbsp;blank&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837332">ident</span><span class="op" id="4837337">,</span>&nbsp;<span class="ident" id="4837339">_</span>&nbsp;<span class="op" id="4837341">:=</span>&nbsp;<span class="ident" id="4837344">x</span><span class="op" id="4837345">.</span><span class="op" id="4837346">(</span><span class="op" id="4837347">*</span><span class="ident" id="4837348">ast</span><span class="op" id="4837351">.</span><span class="ident" id="4837352">Ident</span><span class="op" id="4837357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837360">if</span>&nbsp;<span class="ident" id="4837363">ident</span>&nbsp;<span class="op" id="4837369">==</span>&nbsp;<span class="builtintype" id="4837372">nil</span>&nbsp;<span class="op" id="4837376">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837380">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837391">assert</span><span class="op" id="4837397">(</span><span class="ident" id="4837398">ident</span><span class="op" id="4837403">.</span><span class="ident" id="4837404">Obj</span>&nbsp;<span class="op" id="4837408">==</span>&nbsp;<span class="builtintype" id="4837411">nil</span><span class="op" id="4837414">,</span>&nbsp;<span class="string" id="4837416">&#34;identifier&nbsp;already&nbsp;declared&nbsp;or&nbsp;resolved&#34;</span><span class="op" id="4837457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837460">if</span>&nbsp;<span class="ident" id="4837463">ident</span><span class="op" id="4837468">.</span><span class="ident" id="4837469">Name</span>&nbsp;<span class="op" id="4837474">==</span>&nbsp;<span class="string" id="4837477">&#34;_&#34;</span>&nbsp;<span class="op" id="4837481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837485">return</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837496">//&nbsp;try&nbsp;to&nbsp;resolve&nbsp;the&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837530">for</span>&nbsp;<span class="ident" id="4837534">s</span>&nbsp;<span class="op" id="4837536">:=</span>&nbsp;<span class="ident" id="4837539">p</span><span class="op" id="4837540">.</span><span class="ident" id="4837541">topScope</span><span class="op" id="4837549">;</span>&nbsp;<span class="ident" id="4837551">s</span>&nbsp;<span class="op" id="4837553">!=</span>&nbsp;<span class="builtintype" id="4837556">nil</span><span class="op" id="4837559">;</span>&nbsp;<span class="ident" id="4837561">s</span>&nbsp;<span class="op" id="4837563">=</span>&nbsp;<span class="ident" id="4837565">s</span><span class="op" id="4837566">.</span><span class="ident" id="4837567">Outer</span>&nbsp;<span class="op" id="4837573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837577">if</span>&nbsp;<span class="ident" id="4837580">obj</span>&nbsp;<span class="op" id="4837584">:=</span>&nbsp;<span class="ident" id="4837587">s</span><span class="op" id="4837588">.</span><span class="ident" id="4837589">Lookup</span><span class="op" id="4837595">(</span><span class="ident" id="4837596">ident</span><span class="op" id="4837601">.</span><span class="ident" id="4837602">Name</span><span class="op" id="4837606">)</span><span class="op" id="4837607">;</span>&nbsp;<span class="ident" id="4837609">obj</span>&nbsp;<span class="op" id="4837613">!=</span>&nbsp;<span class="builtintype" id="4837616">nil</span>&nbsp;<span class="op" id="4837620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837625">ident</span><span class="op" id="4837630">.</span><span class="ident" id="4837631">Obj</span>&nbsp;<span class="op" id="4837635">=</span>&nbsp;<span class="ident" id="4837637">obj</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837659">//&nbsp;all&nbsp;local&nbsp;scopes&nbsp;are&nbsp;known,&nbsp;so&nbsp;any&nbsp;unresolved&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837720">//&nbsp;must&nbsp;be&nbsp;found&nbsp;either&nbsp;in&nbsp;the&nbsp;file&nbsp;scope,&nbsp;package&nbsp;scope</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837778">//&nbsp;(perhaps&nbsp;in&nbsp;another&nbsp;file),&nbsp;or&nbsp;universe&nbsp;scope&nbsp;---&nbsp;collect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837839">//&nbsp;them&nbsp;so&nbsp;that&nbsp;they&nbsp;can&nbsp;be&nbsp;resolved&nbsp;later</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4837883">if</span>&nbsp;<span class="ident" id="4837886">collectUnresolved</span>&nbsp;<span class="op" id="4837904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837908">ident</span><span class="op" id="4837913">.</span><span class="ident" id="4837914">Obj</span>&nbsp;<span class="op" id="4837918">=</span>&nbsp;<span class="ident" id="4837920">unresolved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837933">p</span><span class="op" id="4837934">.</span><span class="ident" id="4837935">unresolved</span>&nbsp;<span class="op" id="4837946">=</span>&nbsp;<span class="builtinfunc" id="4837948">append</span><span class="op" id="4837954">(</span><span class="ident" id="4837955">p</span><span class="op" id="4837956">.</span><span class="ident" id="4837957">unresolved</span><span class="op" id="4837967">,</span>&nbsp;<span class="ident" id="4837969">ident</span><span class="op" id="4837974">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837977">}</span><br>
<span class="lineno"></span><span class="op" id="4837979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4837982">func</span>&nbsp;<span class="op" id="4837987">(</span><span class="ident" id="4837988">p</span>&nbsp;<span class="op" id="4837990">*</span><span class="ident" id="4837991">parser</span><span class="op" id="4837997">)</span>&nbsp;<span class="ident" id="4837999">resolve</span><span class="op" id="4838006">(</span><span class="ident" id="4838007">x</span>&nbsp;<span class="ident" id="4838009">ast</span><span class="op" id="4838012">.</span><span class="ident" id="4838013">Expr</span><span class="op" id="4838017">)</span>&nbsp;<span class="op" id="4838019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838022">p</span><span class="op" id="4838023">.</span><span class="ident" id="4838024">tryResolve</span><span class="op" id="4838034">(</span><span class="ident" id="4838035">x</span><span class="op" id="4838036">,</span>&nbsp;<span class="builtintype" id="4838038">true</span><span class="op" id="4838042">)</span><br>
<span class="lineno">200</span><span class="op" id="4838044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838047">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4838127">//&nbsp;Parsing&nbsp;support</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="4838147">func</span>&nbsp;<span class="op" id="4838152">(</span><span class="ident" id="4838153">p</span>&nbsp;<span class="op" id="4838155">*</span><span class="ident" id="4838156">parser</span><span class="op" id="4838162">)</span>&nbsp;<span class="ident" id="4838164">printTrace</span><span class="op" id="4838174">(</span><span class="ident" id="4838175">a</span>&nbsp;<span class="op" id="4838177">...</span><span class="keyword" id="4838180">interface</span><span class="op" id="4838189">{</span><span class="op" id="4838190">}</span><span class="op" id="4838191">)</span>&nbsp;<span class="op" id="4838193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838196">const</span>&nbsp;<span class="ident" id="4838202">dots</span>&nbsp;<span class="op" id="4838207">=</span>&nbsp;<span class="string" id="4838209">&#34;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838277">const</span>&nbsp;<span class="ident" id="4838283">n</span>&nbsp;<span class="op" id="4838285">=</span>&nbsp;<span class="builtinfunc" id="4838287">len</span><span class="op" id="4838290">(</span><span class="ident" id="4838291">dots</span><span class="op" id="4838295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838298">pos</span>&nbsp;<span class="op" id="4838302">:=</span>&nbsp;<span class="ident" id="4838305">p</span><span class="op" id="4838306">.</span><span class="ident" id="4838307">file</span><span class="op" id="4838311">.</span><span class="ident" id="4838312">Position</span><span class="op" id="4838320">(</span><span class="ident" id="4838321">p</span><span class="op" id="4838322">.</span><span class="ident" id="4838323">pos</span><span class="op" id="4838326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838329">fmt</span><span class="op" id="4838332">.</span><span class="ident" id="4838333">Printf</span><span class="op" id="4838339">(</span><span class="string" id="4838340">&#34;%5d:%3d:&nbsp;&#34;</span><span class="op" id="4838351">,</span>&nbsp;<span class="ident" id="4838353">pos</span><span class="op" id="4838356">.</span><span class="ident" id="4838357">Line</span><span class="op" id="4838361">,</span>&nbsp;<span class="ident" id="4838363">pos</span><span class="op" id="4838366">.</span><span class="ident" id="4838367">Column</span><span class="op" id="4838373">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838376">i</span>&nbsp;<span class="op" id="4838378">:=</span>&nbsp;<span class="num" id="4838381">2</span>&nbsp;<span class="op" id="4838383">*</span>&nbsp;<span class="ident" id="4838385">p</span><span class="op" id="4838386">.</span><span class="ident" id="4838387">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838395">for</span>&nbsp;<span class="ident" id="4838399">i</span>&nbsp;<span class="op" id="4838401">&gt;</span>&nbsp;<span class="ident" id="4838403">n</span>&nbsp;<span class="op" id="4838405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838409">fmt</span><span class="op" id="4838412">.</span><span class="ident" id="4838413">Print</span><span class="op" id="4838418">(</span><span class="ident" id="4838419">dots</span><span class="op" id="4838423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838427">i</span>&nbsp;<span class="op" id="4838429">-=</span>&nbsp;<span class="ident" id="4838432">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4838435">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838438">//&nbsp;i&nbsp;&lt;=&nbsp;n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838449">fmt</span><span class="op" id="4838452">.</span><span class="ident" id="4838453">Print</span><span class="op" id="4838458">(</span><span class="ident" id="4838459">dots</span><span class="op" id="4838463">[</span><span class="num" id="4838464">0</span><span class="op" id="4838465">:</span><span class="ident" id="4838466">i</span><span class="op" id="4838467">]</span><span class="op" id="4838468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838471">fmt</span><span class="op" id="4838474">.</span><span class="ident" id="4838475">Println</span><span class="op" id="4838482">(</span><span class="ident" id="4838483">a</span><span class="op" id="4838484">...</span><span class="op" id="4838487">)</span><br>
<span class="lineno"></span><span class="op" id="4838489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4838492">func</span>&nbsp;<span class="ident" id="4838497">trace</span><span class="op" id="4838502">(</span><span class="ident" id="4838503">p</span>&nbsp;<span class="op" id="4838505">*</span><span class="ident" id="4838506">parser</span><span class="op" id="4838512">,</span>&nbsp;<span class="ident" id="4838514">msg</span>&nbsp;<span class="builtintype" id="4838518">string</span><span class="op" id="4838524">)</span>&nbsp;<span class="op" id="4838526">*</span><span class="ident" id="4838527">parser</span>&nbsp;<span class="op" id="4838534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838537">p</span><span class="op" id="4838538">.</span><span class="ident" id="4838539">printTrace</span><span class="op" id="4838549">(</span><span class="ident" id="4838550">msg</span><span class="op" id="4838553">,</span>&nbsp;<span class="string" id="4838555">&#34;(&#34;</span><span class="op" id="4838558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838561">p</span><span class="op" id="4838562">.</span><span class="ident" id="4838563">indent</span><span class="op" id="4838569">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838573">return</span>&nbsp;<span class="ident" id="4838580">p</span><br>
<span class="lineno"></span><span class="op" id="4838582">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="4838585">//&nbsp;Usage&nbsp;pattern:&nbsp;defer&nbsp;un(trace(p,&nbsp;&#34;...&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="4838629">func</span>&nbsp;<span class="ident" id="4838634">un</span><span class="op" id="4838636">(</span><span class="ident" id="4838637">p</span>&nbsp;<span class="op" id="4838639">*</span><span class="ident" id="4838640">parser</span><span class="op" id="4838646">)</span>&nbsp;<span class="op" id="4838648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838651">p</span><span class="op" id="4838652">.</span><span class="ident" id="4838653">indent</span><span class="op" id="4838659">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838663">p</span><span class="op" id="4838664">.</span><span class="ident" id="4838665">printTrace</span><span class="op" id="4838675">(</span><span class="string" id="4838676">&#34;)&#34;</span><span class="op" id="4838679">)</span><br>
<span class="lineno">230</span><span class="op" id="4838681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838684">//&nbsp;Advance&nbsp;to&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="4838714">func</span>&nbsp;<span class="op" id="4838719">(</span><span class="ident" id="4838720">p</span>&nbsp;<span class="op" id="4838722">*</span><span class="ident" id="4838723">parser</span><span class="op" id="4838729">)</span>&nbsp;<span class="ident" id="4838731">next0</span><span class="op" id="4838736">(</span><span class="op" id="4838737">)</span>&nbsp;<span class="op" id="4838739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838742">//&nbsp;Because&nbsp;of&nbsp;one-token&nbsp;look-ahead,&nbsp;print&nbsp;the&nbsp;previous&nbsp;token</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838804">//&nbsp;when&nbsp;tracing&nbsp;as&nbsp;it&nbsp;provides&nbsp;a&nbsp;more&nbsp;readable&nbsp;output.&nbsp;The</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838864">//&nbsp;very&nbsp;first&nbsp;token&nbsp;(!p.pos.IsValid())&nbsp;is&nbsp;not&nbsp;initialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838923">//&nbsp;(it&nbsp;is&nbsp;token.ILLEGAL),&nbsp;so&nbsp;don&#39;t&nbsp;print&nbsp;it&nbsp;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838970">if</span>&nbsp;<span class="ident" id="4838973">p</span><span class="op" id="4838974">.</span><span class="ident" id="4838975">trace</span>&nbsp;<span class="op" id="4838981">&amp;&amp;</span>&nbsp;<span class="ident" id="4838984">p</span><span class="op" id="4838985">.</span><span class="ident" id="4838986">pos</span><span class="op" id="4838989">.</span><span class="ident" id="4838990">IsValid</span><span class="op" id="4838997">(</span><span class="op" id="4838998">)</span>&nbsp;<span class="op" id="4839000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839004">s</span>&nbsp;<span class="op" id="4839006">:=</span>&nbsp;<span class="ident" id="4839009">p</span><span class="op" id="4839010">.</span><span class="ident" id="4839011">tok</span><span class="op" id="4839014">.</span><span class="ident" id="4839015">String</span><span class="op" id="4839021">(</span><span class="op" id="4839022">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839026">switch</span>&nbsp;<span class="op" id="4839033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839037">case</span>&nbsp;<span class="ident" id="4839042">p</span><span class="op" id="4839043">.</span><span class="ident" id="4839044">tok</span><span class="op" id="4839047">.</span><span class="ident" id="4839048">IsLiteral</span><span class="op" id="4839057">(</span><span class="op" id="4839058">)</span><span class="op" id="4839059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839064">p</span><span class="op" id="4839065">.</span><span class="ident" id="4839066">printTrace</span><span class="op" id="4839076">(</span><span class="ident" id="4839077">s</span><span class="op" id="4839078">,</span>&nbsp;<span class="ident" id="4839080">p</span><span class="op" id="4839081">.</span><span class="ident" id="4839082">lit</span><span class="op" id="4839085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839089">case</span>&nbsp;<span class="ident" id="4839094">p</span><span class="op" id="4839095">.</span><span class="ident" id="4839096">tok</span><span class="op" id="4839099">.</span><span class="ident" id="4839100">IsOperator</span><span class="op" id="4839110">(</span><span class="op" id="4839111">)</span><span class="op" id="4839112">,</span>&nbsp;<span class="ident" id="4839114">p</span><span class="op" id="4839115">.</span><span class="ident" id="4839116">tok</span><span class="op" id="4839119">.</span><span class="ident" id="4839120">IsKeyword</span><span class="op" id="4839129">(</span><span class="op" id="4839130">)</span><span class="op" id="4839131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839136">p</span><span class="op" id="4839137">.</span><span class="ident" id="4839138">printTrace</span><span class="op" id="4839148">(</span><span class="string" id="4839149">&#34;\&#34;&#34;</span>&nbsp;<span class="op" id="4839154">+</span>&nbsp;<span class="ident" id="4839156">s</span>&nbsp;<span class="op" id="4839158">+</span>&nbsp;<span class="string" id="4839160">&#34;\&#34;&#34;</span><span class="op" id="4839164">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839168">default</span><span class="op" id="4839175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839180">p</span><span class="op" id="4839181">.</span><span class="ident" id="4839182">printTrace</span><span class="op" id="4839192">(</span><span class="ident" id="4839193">s</span><span class="op" id="4839194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839205">p</span><span class="op" id="4839206">.</span><span class="ident" id="4839207">pos</span><span class="op" id="4839210">,</span>&nbsp;<span class="ident" id="4839212">p</span><span class="op" id="4839213">.</span><span class="ident" id="4839214">tok</span><span class="op" id="4839217">,</span>&nbsp;<span class="ident" id="4839219">p</span><span class="op" id="4839220">.</span><span class="ident" id="4839221">lit</span>&nbsp;<span class="op" id="4839225">=</span>&nbsp;<span class="ident" id="4839227">p</span><span class="op" id="4839228">.</span><span class="ident" id="4839229">scanner</span><span class="op" id="4839236">.</span><span class="ident" id="4839237">Scan</span><span class="op" id="4839241">(</span><span class="op" id="4839242">)</span><br>
<span class="lineno"></span><span class="op" id="4839244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4839247">//&nbsp;Consume&nbsp;a&nbsp;comment&nbsp;and&nbsp;return&nbsp;it&nbsp;and&nbsp;the&nbsp;line&nbsp;on&nbsp;which&nbsp;it&nbsp;ends.</span><br>
<span class="lineno"></span><span class="keyword" id="4839313">func</span>&nbsp;<span class="op" id="4839318">(</span><span class="ident" id="4839319">p</span>&nbsp;<span class="op" id="4839321">*</span><span class="ident" id="4839322">parser</span><span class="op" id="4839328">)</span>&nbsp;<span class="ident" id="4839330">consumeComment</span><span class="op" id="4839344">(</span><span class="op" id="4839345">)</span>&nbsp;<span class="op" id="4839347">(</span><span class="ident" id="4839348">comment</span>&nbsp;<span class="op" id="4839356">*</span><span class="ident" id="4839357">ast</span><span class="op" id="4839360">.</span><span class="ident" id="4839361">Comment</span><span class="op" id="4839368">,</span>&nbsp;<span class="ident" id="4839370">endline</span>&nbsp;<span class="builtintype" id="4839378">int</span><span class="op" id="4839381">)</span>&nbsp;<span class="op" id="4839383">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4839386">//&nbsp;/*-style&nbsp;comments&nbsp;may&nbsp;end&nbsp;on&nbsp;a&nbsp;different&nbsp;line&nbsp;than&nbsp;where&nbsp;they&nbsp;start.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4839459">//&nbsp;Scan&nbsp;the&nbsp;comment&nbsp;for&nbsp;&#39;\n&#39;&nbsp;chars&nbsp;and&nbsp;adjust&nbsp;endline&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839527">endline</span>&nbsp;<span class="op" id="4839535">=</span>&nbsp;<span class="ident" id="4839537">p</span><span class="op" id="4839538">.</span><span class="ident" id="4839539">file</span><span class="op" id="4839543">.</span><span class="ident" id="4839544">Line</span><span class="op" id="4839548">(</span><span class="ident" id="4839549">p</span><span class="op" id="4839550">.</span><span class="ident" id="4839551">pos</span><span class="op" id="4839554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839557">if</span>&nbsp;<span class="ident" id="4839560">p</span><span class="op" id="4839561">.</span><span class="ident" id="4839562">lit</span><span class="op" id="4839565">[</span><span class="num" id="4839566">1</span><span class="op" id="4839567">]</span>&nbsp;<span class="op" id="4839569">==</span>&nbsp;<span class="string" id="4839572">&#39;*&#39;</span>&nbsp;<span class="op" id="4839576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4839580">//&nbsp;don&#39;t&nbsp;use&nbsp;range&nbsp;here&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;decode&nbsp;Unicode&nbsp;code&nbsp;points</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839646">for</span>&nbsp;<span class="ident" id="4839650">i</span>&nbsp;<span class="op" id="4839652">:=</span>&nbsp;<span class="num" id="4839655">0</span><span class="op" id="4839656">;</span>&nbsp;<span class="ident" id="4839658">i</span>&nbsp;<span class="op" id="4839660">&lt;</span>&nbsp;<span class="builtinfunc" id="4839662">len</span><span class="op" id="4839665">(</span><span class="ident" id="4839666">p</span><span class="op" id="4839667">.</span><span class="ident" id="4839668">lit</span><span class="op" id="4839671">)</span><span class="op" id="4839672">;</span>&nbsp;<span class="ident" id="4839674">i</span><span class="op" id="4839675">++</span>&nbsp;<span class="op" id="4839678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839683">if</span>&nbsp;<span class="ident" id="4839686">p</span><span class="op" id="4839687">.</span><span class="ident" id="4839688">lit</span><span class="op" id="4839691">[</span><span class="ident" id="4839692">i</span><span class="op" id="4839693">]</span>&nbsp;<span class="op" id="4839695">==</span>&nbsp;<span class="string" id="4839698">&#39;\n&#39;</span>&nbsp;<span class="op" id="4839703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839709">endline</span><span class="op" id="4839716">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839726">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839733">comment</span>&nbsp;<span class="op" id="4839741">=</span>&nbsp;<span class="op" id="4839743">&amp;</span><span class="ident" id="4839744">ast</span><span class="op" id="4839747">.</span><span class="ident" id="4839748">Comment</span><span class="op" id="4839755">{</span><span class="ident" id="4839756">Slash</span><span class="op" id="4839761">:</span>&nbsp;<span class="ident" id="4839763">p</span><span class="op" id="4839764">.</span><span class="ident" id="4839765">pos</span><span class="op" id="4839768">,</span>&nbsp;<span class="ident" id="4839770">Text</span><span class="op" id="4839774">:</span>&nbsp;<span class="ident" id="4839776">p</span><span class="op" id="4839777">.</span><span class="ident" id="4839778">lit</span><span class="op" id="4839781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839784">p</span><span class="op" id="4839785">.</span><span class="ident" id="4839786">next0</span><span class="op" id="4839791">(</span><span class="op" id="4839792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839796">return</span><br>
<span class="lineno"></span><span class="op" id="4839803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4839806">//&nbsp;Consume&nbsp;a&nbsp;group&nbsp;of&nbsp;adjacent&nbsp;comments,&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;parser&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4839870">//&nbsp;comments&nbsp;list,&nbsp;and&nbsp;return&nbsp;it&nbsp;together&nbsp;with&nbsp;the&nbsp;line&nbsp;at&nbsp;which</span><br>
<span class="lineno">275</span><span class="comment" id="4839934">//&nbsp;the&nbsp;last&nbsp;comment&nbsp;in&nbsp;the&nbsp;group&nbsp;ends.&nbsp;A&nbsp;non-comment&nbsp;token&nbsp;or&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="4839998">//&nbsp;empty&nbsp;lines&nbsp;terminate&nbsp;a&nbsp;comment&nbsp;group.</span><br>
<span class="lineno"></span><span class="comment" id="4840040">//</span><br>
<span class="lineno"></span><span class="keyword" id="4840043">func</span>&nbsp;<span class="op" id="4840048">(</span><span class="ident" id="4840049">p</span>&nbsp;<span class="op" id="4840051">*</span><span class="ident" id="4840052">parser</span><span class="op" id="4840058">)</span>&nbsp;<span class="ident" id="4840060">consumeCommentGroup</span><span class="op" id="4840079">(</span><span class="ident" id="4840080">n</span>&nbsp;<span class="builtintype" id="4840082">int</span><span class="op" id="4840085">)</span>&nbsp;<span class="op" id="4840087">(</span><span class="ident" id="4840088">comments</span>&nbsp;<span class="op" id="4840097">*</span><span class="ident" id="4840098">ast</span><span class="op" id="4840101">.</span><span class="ident" id="4840102">CommentGroup</span><span class="op" id="4840114">,</span>&nbsp;<span class="ident" id="4840116">endline</span>&nbsp;<span class="builtintype" id="4840124">int</span><span class="op" id="4840127">)</span>&nbsp;<span class="op" id="4840129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840132">var</span>&nbsp;<span class="ident" id="4840136">list</span>&nbsp;<span class="op" id="4840141">[</span><span class="op" id="4840142">]</span><span class="op" id="4840143">*</span><span class="ident" id="4840144">ast</span><span class="op" id="4840147">.</span><span class="ident" id="4840148">Comment</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840157">endline</span>&nbsp;<span class="op" id="4840165">=</span>&nbsp;<span class="ident" id="4840167">p</span><span class="op" id="4840168">.</span><span class="ident" id="4840169">file</span><span class="op" id="4840173">.</span><span class="ident" id="4840174">Line</span><span class="op" id="4840178">(</span><span class="ident" id="4840179">p</span><span class="op" id="4840180">.</span><span class="ident" id="4840181">pos</span><span class="op" id="4840184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840187">for</span>&nbsp;<span class="ident" id="4840191">p</span><span class="op" id="4840192">.</span><span class="ident" id="4840193">tok</span>&nbsp;<span class="op" id="4840197">==</span>&nbsp;<span class="ident" id="4840200">token</span><span class="op" id="4840205">.</span><span class="ident" id="4840206">COMMENT</span>&nbsp;<span class="op" id="4840214">&amp;&amp;</span>&nbsp;<span class="ident" id="4840217">p</span><span class="op" id="4840218">.</span><span class="ident" id="4840219">file</span><span class="op" id="4840223">.</span><span class="ident" id="4840224">Line</span><span class="op" id="4840228">(</span><span class="ident" id="4840229">p</span><span class="op" id="4840230">.</span><span class="ident" id="4840231">pos</span><span class="op" id="4840234">)</span>&nbsp;<span class="op" id="4840236">&lt;=</span>&nbsp;<span class="ident" id="4840239">endline</span><span class="op" id="4840246">+</span><span class="ident" id="4840247">n</span>&nbsp;<span class="op" id="4840249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840253">var</span>&nbsp;<span class="ident" id="4840257">comment</span>&nbsp;<span class="op" id="4840265">*</span><span class="ident" id="4840266">ast</span><span class="op" id="4840269">.</span><span class="ident" id="4840270">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840280">comment</span><span class="op" id="4840287">,</span>&nbsp;<span class="ident" id="4840289">endline</span>&nbsp;<span class="op" id="4840297">=</span>&nbsp;<span class="ident" id="4840299">p</span><span class="op" id="4840300">.</span><span class="ident" id="4840301">consumeComment</span><span class="op" id="4840315">(</span><span class="op" id="4840316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840320">list</span>&nbsp;<span class="op" id="4840325">=</span>&nbsp;<span class="builtinfunc" id="4840327">append</span><span class="op" id="4840333">(</span><span class="ident" id="4840334">list</span><span class="op" id="4840338">,</span>&nbsp;<span class="ident" id="4840340">comment</span><span class="op" id="4840347">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4840350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840354">//&nbsp;add&nbsp;comment&nbsp;group&nbsp;to&nbsp;the&nbsp;comments&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840397">comments</span>&nbsp;<span class="op" id="4840406">=</span>&nbsp;<span class="op" id="4840408">&amp;</span><span class="ident" id="4840409">ast</span><span class="op" id="4840412">.</span><span class="ident" id="4840413">CommentGroup</span><span class="op" id="4840425">{</span><span class="ident" id="4840426">List</span><span class="op" id="4840430">:</span>&nbsp;<span class="ident" id="4840432">list</span><span class="op" id="4840436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840439">p</span><span class="op" id="4840440">.</span><span class="ident" id="4840441">comments</span>&nbsp;<span class="op" id="4840450">=</span>&nbsp;<span class="builtinfunc" id="4840452">append</span><span class="op" id="4840458">(</span><span class="ident" id="4840459">p</span><span class="op" id="4840460">.</span><span class="ident" id="4840461">comments</span><span class="op" id="4840469">,</span>&nbsp;<span class="ident" id="4840471">comments</span><span class="op" id="4840479">)</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840483">return</span><br>
<span class="lineno"></span><span class="op" id="4840490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4840493">//&nbsp;Advance&nbsp;to&nbsp;the&nbsp;next&nbsp;non-comment&nbsp;token.&nbsp;In&nbsp;the&nbsp;process,&nbsp;collect</span><br>
<span class="lineno">295</span><span class="comment" id="4840559">//&nbsp;any&nbsp;comment&nbsp;groups&nbsp;encountered,&nbsp;and&nbsp;remember&nbsp;the&nbsp;last&nbsp;lead&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4840625">//&nbsp;and&nbsp;line&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="4840647">//</span><br>
<span class="lineno"></span><span class="comment" id="4840650">//&nbsp;A&nbsp;lead&nbsp;comment&nbsp;is&nbsp;a&nbsp;comment&nbsp;group&nbsp;that&nbsp;starts&nbsp;and&nbsp;ends&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4840713">//&nbsp;line&nbsp;without&nbsp;any&nbsp;other&nbsp;tokens&nbsp;and&nbsp;that&nbsp;is&nbsp;followed&nbsp;by&nbsp;a&nbsp;non-comment</span><br>
<span class="lineno">300</span><span class="comment" id="4840784">//&nbsp;token&nbsp;on&nbsp;the&nbsp;line&nbsp;immediately&nbsp;after&nbsp;the&nbsp;comment&nbsp;group.</span><br>
<span class="lineno"></span><span class="comment" id="4840842">//</span><br>
<span class="lineno"></span><span class="comment" id="4840845">//&nbsp;A&nbsp;line&nbsp;comment&nbsp;is&nbsp;a&nbsp;comment&nbsp;group&nbsp;that&nbsp;follows&nbsp;a&nbsp;non-comment</span><br>
<span class="lineno"></span><span class="comment" id="4840909">//&nbsp;token&nbsp;on&nbsp;the&nbsp;same&nbsp;line,&nbsp;and&nbsp;that&nbsp;has&nbsp;no&nbsp;tokens&nbsp;after&nbsp;it&nbsp;on&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4840980">//&nbsp;where&nbsp;it&nbsp;ends.</span><br>
<span class="lineno">305</span><span class="comment" id="4840998">//</span><br>
<span class="lineno"></span><span class="comment" id="4841001">//&nbsp;Lead&nbsp;and&nbsp;line&nbsp;comments&nbsp;may&nbsp;be&nbsp;considered&nbsp;documentation&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4841067">//&nbsp;stored&nbsp;in&nbsp;the&nbsp;AST.</span><br>
<span class="lineno"></span><span class="comment" id="4841089">//</span><br>
<span class="lineno"></span><span class="keyword" id="4841092">func</span>&nbsp;<span class="op" id="4841097">(</span><span class="ident" id="4841098">p</span>&nbsp;<span class="op" id="4841100">*</span><span class="ident" id="4841101">parser</span><span class="op" id="4841107">)</span>&nbsp;<span class="ident" id="4841109">next</span><span class="op" id="4841113">(</span><span class="op" id="4841114">)</span>&nbsp;<span class="op" id="4841116">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841119">p</span><span class="op" id="4841120">.</span><span class="ident" id="4841121">leadComment</span>&nbsp;<span class="op" id="4841133">=</span>&nbsp;<span class="builtintype" id="4841135">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841140">p</span><span class="op" id="4841141">.</span><span class="ident" id="4841142">lineComment</span>&nbsp;<span class="op" id="4841154">=</span>&nbsp;<span class="builtintype" id="4841156">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841161">prev</span>&nbsp;<span class="op" id="4841166">:=</span>&nbsp;<span class="ident" id="4841169">p</span><span class="op" id="4841170">.</span><span class="ident" id="4841171">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841176">p</span><span class="op" id="4841177">.</span><span class="ident" id="4841178">next0</span><span class="op" id="4841183">(</span><span class="op" id="4841184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841188">if</span>&nbsp;<span class="ident" id="4841191">p</span><span class="op" id="4841192">.</span><span class="ident" id="4841193">tok</span>&nbsp;<span class="op" id="4841197">==</span>&nbsp;<span class="ident" id="4841200">token</span><span class="op" id="4841205">.</span><span class="ident" id="4841206">COMMENT</span>&nbsp;<span class="op" id="4841214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841218">var</span>&nbsp;<span class="ident" id="4841222">comment</span>&nbsp;<span class="op" id="4841230">*</span><span class="ident" id="4841231">ast</span><span class="op" id="4841234">.</span><span class="ident" id="4841235">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841250">var</span>&nbsp;<span class="ident" id="4841254">endline</span>&nbsp;<span class="builtintype" id="4841262">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841269">if</span>&nbsp;<span class="ident" id="4841272">p</span><span class="op" id="4841273">.</span><span class="ident" id="4841274">file</span><span class="op" id="4841278">.</span><span class="ident" id="4841279">Line</span><span class="op" id="4841283">(</span><span class="ident" id="4841284">p</span><span class="op" id="4841285">.</span><span class="ident" id="4841286">pos</span><span class="op" id="4841289">)</span>&nbsp;<span class="op" id="4841291">==</span>&nbsp;<span class="ident" id="4841294">p</span><span class="op" id="4841295">.</span><span class="ident" id="4841296">file</span><span class="op" id="4841300">.</span><span class="ident" id="4841301">Line</span><span class="op" id="4841305">(</span><span class="ident" id="4841306">prev</span><span class="op" id="4841310">)</span>&nbsp;<span class="op" id="4841312">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841317">//&nbsp;The&nbsp;comment&nbsp;is&nbsp;on&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;token;&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841377">//&nbsp;cannot&nbsp;be&nbsp;a&nbsp;lead&nbsp;comment&nbsp;but&nbsp;may&nbsp;be&nbsp;a&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841435">comment</span><span class="op" id="4841442">,</span>&nbsp;<span class="ident" id="4841444">endline</span>&nbsp;<span class="op" id="4841452">=</span>&nbsp;<span class="ident" id="4841454">p</span><span class="op" id="4841455">.</span><span class="ident" id="4841456">consumeCommentGroup</span><span class="op" id="4841475">(</span><span class="num" id="4841476">0</span><span class="op" id="4841477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841482">if</span>&nbsp;<span class="ident" id="4841485">p</span><span class="op" id="4841486">.</span><span class="ident" id="4841487">file</span><span class="op" id="4841491">.</span><span class="ident" id="4841492">Line</span><span class="op" id="4841496">(</span><span class="ident" id="4841497">p</span><span class="op" id="4841498">.</span><span class="ident" id="4841499">pos</span><span class="op" id="4841502">)</span>&nbsp;<span class="op" id="4841504">!=</span>&nbsp;<span class="ident" id="4841507">endline</span>&nbsp;<span class="op" id="4841515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841521">//&nbsp;The&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;different&nbsp;line,&nbsp;thus</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841572">//&nbsp;the&nbsp;last&nbsp;comment&nbsp;group&nbsp;is&nbsp;a&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841621">p</span><span class="op" id="4841622">.</span><span class="ident" id="4841623">lineComment</span>&nbsp;<span class="op" id="4841635">=</span>&nbsp;<span class="ident" id="4841637">comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841657">//&nbsp;consume&nbsp;successor&nbsp;comments,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841697">endline</span>&nbsp;<span class="op" id="4841705">=</span>&nbsp;<span class="op" id="4841707">-</span><span class="num" id="4841708">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841712">for</span>&nbsp;<span class="ident" id="4841716">p</span><span class="op" id="4841717">.</span><span class="ident" id="4841718">tok</span>&nbsp;<span class="op" id="4841722">==</span>&nbsp;<span class="ident" id="4841725">token</span><span class="op" id="4841730">.</span><span class="ident" id="4841731">COMMENT</span>&nbsp;<span class="op" id="4841739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841744">comment</span><span class="op" id="4841751">,</span>&nbsp;<span class="ident" id="4841753">endline</span>&nbsp;<span class="op" id="4841761">=</span>&nbsp;<span class="ident" id="4841763">p</span><span class="op" id="4841764">.</span><span class="ident" id="4841765">consumeCommentGroup</span><span class="op" id="4841784">(</span><span class="num" id="4841785">1</span><span class="op" id="4841786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841790">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841795">if</span>&nbsp;<span class="ident" id="4841798">endline</span><span class="op" id="4841805">+</span><span class="num" id="4841806">1</span>&nbsp;<span class="op" id="4841808">==</span>&nbsp;<span class="ident" id="4841811">p</span><span class="op" id="4841812">.</span><span class="ident" id="4841813">file</span><span class="op" id="4841817">.</span><span class="ident" id="4841818">Line</span><span class="op" id="4841822">(</span><span class="ident" id="4841823">p</span><span class="op" id="4841824">.</span><span class="ident" id="4841825">pos</span><span class="op" id="4841828">)</span>&nbsp;<span class="op" id="4841830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841835">//&nbsp;The&nbsp;next&nbsp;token&nbsp;is&nbsp;following&nbsp;on&nbsp;the&nbsp;line&nbsp;immediately&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4841903">//&nbsp;comment&nbsp;group,&nbsp;thus&nbsp;the&nbsp;last&nbsp;comment&nbsp;group&nbsp;is&nbsp;a&nbsp;lead&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841971">p</span><span class="op" id="4841972">.</span><span class="ident" id="4841973">leadComment</span>&nbsp;<span class="op" id="4841985">=</span>&nbsp;<span class="ident" id="4841987">comment</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842000">}</span><br>
<span class="lineno"></span><span class="op" id="4842002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4842005">//&nbsp;A&nbsp;bailout&nbsp;panic&nbsp;is&nbsp;raised&nbsp;to&nbsp;indicate&nbsp;early&nbsp;termination.</span><br>
<span class="lineno">345</span><span class="keyword" id="4842065">type</span>&nbsp;<span class="ident" id="4842070">bailout</span>&nbsp;<span class="keyword" id="4842078">struct</span><span class="op" id="4842084">{</span><span class="op" id="4842085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842088">func</span>&nbsp;<span class="op" id="4842093">(</span><span class="ident" id="4842094">p</span>&nbsp;<span class="op" id="4842096">*</span><span class="ident" id="4842097">parser</span><span class="op" id="4842103">)</span>&nbsp;<span class="builtintype" id="4842105">error</span><span class="op" id="4842110">(</span><span class="ident" id="4842111">pos</span>&nbsp;<span class="ident" id="4842115">token</span><span class="op" id="4842120">.</span><span class="ident" id="4842121">Pos</span><span class="op" id="4842124">,</span>&nbsp;<span class="ident" id="4842126">msg</span>&nbsp;<span class="builtintype" id="4842130">string</span><span class="op" id="4842136">)</span>&nbsp;<span class="op" id="4842138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842141">epos</span>&nbsp;<span class="op" id="4842146">:=</span>&nbsp;<span class="ident" id="4842149">p</span><span class="op" id="4842150">.</span><span class="ident" id="4842151">file</span><span class="op" id="4842155">.</span><span class="ident" id="4842156">Position</span><span class="op" id="4842164">(</span><span class="ident" id="4842165">pos</span><span class="op" id="4842168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4842172">//&nbsp;If&nbsp;AllErrors&nbsp;is&nbsp;not&nbsp;set,&nbsp;discard&nbsp;errors&nbsp;reported&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4842242">//&nbsp;as&nbsp;the&nbsp;last&nbsp;recorded&nbsp;error&nbsp;and&nbsp;stop&nbsp;parsing&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4842313">//&nbsp;10&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842328">if</span>&nbsp;<span class="ident" id="4842331">p</span><span class="op" id="4842332">.</span><span class="ident" id="4842333">mode</span><span class="op" id="4842337">&amp;</span><span class="ident" id="4842338">AllErrors</span>&nbsp;<span class="op" id="4842348">==</span>&nbsp;<span class="num" id="4842351">0</span>&nbsp;<span class="op" id="4842353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842357">n</span>&nbsp;<span class="op" id="4842359">:=</span>&nbsp;<span class="builtinfunc" id="4842362">len</span><span class="op" id="4842365">(</span><span class="ident" id="4842366">p</span><span class="op" id="4842367">.</span><span class="ident" id="4842368">errors</span><span class="op" id="4842374">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842378">if</span>&nbsp;<span class="ident" id="4842381">n</span>&nbsp;<span class="op" id="4842383">&gt;</span>&nbsp;<span class="num" id="4842385">0</span>&nbsp;<span class="op" id="4842387">&amp;&amp;</span>&nbsp;<span class="ident" id="4842390">p</span><span class="op" id="4842391">.</span><span class="ident" id="4842392">errors</span><span class="op" id="4842398">[</span><span class="ident" id="4842399">n</span><span class="op" id="4842400">-</span><span class="num" id="4842401">1</span><span class="op" id="4842402">]</span><span class="op" id="4842403">.</span><span class="ident" id="4842404">Pos</span><span class="op" id="4842407">.</span><span class="ident" id="4842408">Line</span>&nbsp;<span class="op" id="4842413">==</span>&nbsp;<span class="ident" id="4842416">epos</span><span class="op" id="4842420">.</span><span class="ident" id="4842421">Line</span>&nbsp;<span class="op" id="4842426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842431">return</span>&nbsp;<span class="comment" id="4842438">//&nbsp;discard&nbsp;-&nbsp;likely&nbsp;a&nbsp;spurious&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842481">if</span>&nbsp;<span class="ident" id="4842484">n</span>&nbsp;<span class="op" id="4842486">&gt;</span>&nbsp;<span class="num" id="4842488">10</span>&nbsp;<span class="op" id="4842491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4842496">panic</span><span class="op" id="4842501">(</span><span class="ident" id="4842502">bailout</span><span class="op" id="4842509">{</span><span class="op" id="4842510">}</span><span class="op" id="4842511">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842522">p</span><span class="op" id="4842523">.</span><span class="ident" id="4842524">errors</span><span class="op" id="4842530">.</span><span class="ident" id="4842531">Add</span><span class="op" id="4842534">(</span><span class="ident" id="4842535">epos</span><span class="op" id="4842539">,</span>&nbsp;<span class="ident" id="4842541">msg</span><span class="op" id="4842544">)</span><br>
<span class="lineno"></span><span class="op" id="4842546">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="4842549">func</span>&nbsp;<span class="op" id="4842554">(</span><span class="ident" id="4842555">p</span>&nbsp;<span class="op" id="4842557">*</span><span class="ident" id="4842558">parser</span><span class="op" id="4842564">)</span>&nbsp;<span class="ident" id="4842566">errorExpected</span><span class="op" id="4842579">(</span><span class="ident" id="4842580">pos</span>&nbsp;<span class="ident" id="4842584">token</span><span class="op" id="4842589">.</span><span class="ident" id="4842590">Pos</span><span class="op" id="4842593">,</span>&nbsp;<span class="ident" id="4842595">msg</span>&nbsp;<span class="builtintype" id="4842599">string</span><span class="op" id="4842605">)</span>&nbsp;<span class="op" id="4842607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842610">msg</span>&nbsp;<span class="op" id="4842614">=</span>&nbsp;<span class="string" id="4842616">&#34;expected&nbsp;&#34;</span>&nbsp;<span class="op" id="4842628">+</span>&nbsp;<span class="ident" id="4842630">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842635">if</span>&nbsp;<span class="ident" id="4842638">pos</span>&nbsp;<span class="op" id="4842642">==</span>&nbsp;<span class="ident" id="4842645">p</span><span class="op" id="4842646">.</span><span class="ident" id="4842647">pos</span>&nbsp;<span class="op" id="4842651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4842655">//&nbsp;the&nbsp;error&nbsp;happened&nbsp;at&nbsp;the&nbsp;current&nbsp;position;</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4842704">//&nbsp;make&nbsp;the&nbsp;error&nbsp;message&nbsp;more&nbsp;specific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842746">if</span>&nbsp;<span class="ident" id="4842749">p</span><span class="op" id="4842750">.</span><span class="ident" id="4842751">tok</span>&nbsp;<span class="op" id="4842755">==</span>&nbsp;<span class="ident" id="4842758">token</span><span class="op" id="4842763">.</span><span class="ident" id="4842764">SEMICOLON</span>&nbsp;<span class="op" id="4842774">&amp;&amp;</span>&nbsp;<span class="ident" id="4842777">p</span><span class="op" id="4842778">.</span><span class="ident" id="4842779">lit</span>&nbsp;<span class="op" id="4842783">==</span>&nbsp;<span class="string" id="4842786">&#34;\n&#34;</span>&nbsp;<span class="op" id="4842791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842796">msg</span>&nbsp;<span class="op" id="4842800">+=</span>&nbsp;<span class="string" id="4842803">&#34;,&nbsp;found&nbsp;newline&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842823">}</span>&nbsp;<span class="keyword" id="4842825">else</span>&nbsp;<span class="op" id="4842830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842835">msg</span>&nbsp;<span class="op" id="4842839">+=</span>&nbsp;<span class="string" id="4842842">&#34;,&nbsp;found&nbsp;&#39;&#34;</span>&nbsp;<span class="op" id="4842854">+</span>&nbsp;<span class="ident" id="4842856">p</span><span class="op" id="4842857">.</span><span class="ident" id="4842858">tok</span><span class="op" id="4842861">.</span><span class="ident" id="4842862">String</span><span class="op" id="4842868">(</span><span class="op" id="4842869">)</span>&nbsp;<span class="op" id="4842871">+</span>&nbsp;<span class="string" id="4842873">&#34;&#39;&#34;</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842880">if</span>&nbsp;<span class="ident" id="4842883">p</span><span class="op" id="4842884">.</span><span class="ident" id="4842885">tok</span><span class="op" id="4842888">.</span><span class="ident" id="4842889">IsLiteral</span><span class="op" id="4842898">(</span><span class="op" id="4842899">)</span>&nbsp;<span class="op" id="4842901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842907">msg</span>&nbsp;<span class="op" id="4842911">+=</span>&nbsp;<span class="string" id="4842914">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4842918">+</span>&nbsp;<span class="ident" id="4842920">p</span><span class="op" id="4842921">.</span><span class="ident" id="4842922">lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842936">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842939">p</span><span class="op" id="4842940">.</span><span class="builtintype" id="4842941">error</span><span class="op" id="4842946">(</span><span class="ident" id="4842947">pos</span><span class="op" id="4842950">,</span>&nbsp;<span class="ident" id="4842952">msg</span><span class="op" id="4842955">)</span><br>
<span class="lineno"></span><span class="op" id="4842957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842960">func</span>&nbsp;<span class="op" id="4842965">(</span><span class="ident" id="4842966">p</span>&nbsp;<span class="op" id="4842968">*</span><span class="ident" id="4842969">parser</span><span class="op" id="4842975">)</span>&nbsp;<span class="ident" id="4842977">expect</span><span class="op" id="4842983">(</span><span class="ident" id="4842984">tok</span>&nbsp;<span class="ident" id="4842988">token</span><span class="op" id="4842993">.</span><span class="ident" id="4842994">Token</span><span class="op" id="4842999">)</span>&nbsp;<span class="ident" id="4843001">token</span><span class="op" id="4843006">.</span><span class="ident" id="4843007">Pos</span>&nbsp;<span class="op" id="4843011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843014">pos</span>&nbsp;<span class="op" id="4843018">:=</span>&nbsp;<span class="ident" id="4843021">p</span><span class="op" id="4843022">.</span><span class="ident" id="4843023">pos</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843028">if</span>&nbsp;<span class="ident" id="4843031">p</span><span class="op" id="4843032">.</span><span class="ident" id="4843033">tok</span>&nbsp;<span class="op" id="4843037">!=</span>&nbsp;<span class="ident" id="4843040">tok</span>&nbsp;<span class="op" id="4843044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843048">p</span><span class="op" id="4843049">.</span><span class="ident" id="4843050">errorExpected</span><span class="op" id="4843063">(</span><span class="ident" id="4843064">pos</span><span class="op" id="4843067">,</span>&nbsp;<span class="string" id="4843069">&#34;&#39;&#34;</span><span class="op" id="4843072">+</span><span class="ident" id="4843073">tok</span><span class="op" id="4843076">.</span><span class="ident" id="4843077">String</span><span class="op" id="4843083">(</span><span class="op" id="4843084">)</span><span class="op" id="4843085">+</span><span class="string" id="4843086">&#34;&#39;&#34;</span><span class="op" id="4843089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843095">p</span><span class="op" id="4843096">.</span><span class="ident" id="4843097">next</span><span class="op" id="4843101">(</span><span class="op" id="4843102">)</span>&nbsp;<span class="comment" id="4843104">//&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843122">return</span>&nbsp;<span class="ident" id="4843129">pos</span><br>
<span class="lineno">390</span><span class="op" id="4843133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4843136">//&nbsp;expectClosing&nbsp;is&nbsp;like&nbsp;expect&nbsp;but&nbsp;provides&nbsp;a&nbsp;better&nbsp;error&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="4843204">//&nbsp;for&nbsp;the&nbsp;common&nbsp;case&nbsp;of&nbsp;a&nbsp;missing&nbsp;comma&nbsp;before&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span><span class="comment" id="4843264">//</span><br>
<span class="lineno">395</span><span class="keyword" id="4843267">func</span>&nbsp;<span class="op" id="4843272">(</span><span class="ident" id="4843273">p</span>&nbsp;<span class="op" id="4843275">*</span><span class="ident" id="4843276">parser</span><span class="op" id="4843282">)</span>&nbsp;<span class="ident" id="4843284">expectClosing</span><span class="op" id="4843297">(</span><span class="ident" id="4843298">tok</span>&nbsp;<span class="ident" id="4843302">token</span><span class="op" id="4843307">.</span><span class="ident" id="4843308">Token</span><span class="op" id="4843313">,</span>&nbsp;<span class="ident" id="4843315">context</span>&nbsp;<span class="builtintype" id="4843323">string</span><span class="op" id="4843329">)</span>&nbsp;<span class="ident" id="4843331">token</span><span class="op" id="4843336">.</span><span class="ident" id="4843337">Pos</span>&nbsp;<span class="op" id="4843341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843344">if</span>&nbsp;<span class="ident" id="4843347">p</span><span class="op" id="4843348">.</span><span class="ident" id="4843349">tok</span>&nbsp;<span class="op" id="4843353">!=</span>&nbsp;<span class="ident" id="4843356">tok</span>&nbsp;<span class="op" id="4843360">&amp;&amp;</span>&nbsp;<span class="ident" id="4843363">p</span><span class="op" id="4843364">.</span><span class="ident" id="4843365">tok</span>&nbsp;<span class="op" id="4843369">==</span>&nbsp;<span class="ident" id="4843372">token</span><span class="op" id="4843377">.</span><span class="ident" id="4843378">SEMICOLON</span>&nbsp;<span class="op" id="4843388">&amp;&amp;</span>&nbsp;<span class="ident" id="4843391">p</span><span class="op" id="4843392">.</span><span class="ident" id="4843393">lit</span>&nbsp;<span class="op" id="4843397">==</span>&nbsp;<span class="string" id="4843400">&#34;\n&#34;</span>&nbsp;<span class="op" id="4843405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843409">p</span><span class="op" id="4843410">.</span><span class="builtintype" id="4843411">error</span><span class="op" id="4843416">(</span><span class="ident" id="4843417">p</span><span class="op" id="4843418">.</span><span class="ident" id="4843419">pos</span><span class="op" id="4843422">,</span>&nbsp;<span class="string" id="4843424">&#34;missing&nbsp;&#39;,&#39;&nbsp;before&nbsp;newline&nbsp;in&nbsp;&#34;</span><span class="op" id="4843456">+</span><span class="ident" id="4843457">context</span><span class="op" id="4843464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843468">p</span><span class="op" id="4843469">.</span><span class="ident" id="4843470">next</span><span class="op" id="4843474">(</span><span class="op" id="4843475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843478">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843481">return</span>&nbsp;<span class="ident" id="4843488">p</span><span class="op" id="4843489">.</span><span class="ident" id="4843490">expect</span><span class="op" id="4843496">(</span><span class="ident" id="4843497">tok</span><span class="op" id="4843500">)</span><br>
<span class="lineno"></span><span class="op" id="4843502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4843505">func</span>&nbsp;<span class="op" id="4843510">(</span><span class="ident" id="4843511">p</span>&nbsp;<span class="op" id="4843513">*</span><span class="ident" id="4843514">parser</span><span class="op" id="4843520">)</span>&nbsp;<span class="ident" id="4843522">expectSemi</span><span class="op" id="4843532">(</span><span class="op" id="4843533">)</span>&nbsp;<span class="op" id="4843535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4843538">//&nbsp;semicolon&nbsp;is&nbsp;optional&nbsp;before&nbsp;a&nbsp;closing&nbsp;&#39;)&#39;&nbsp;or&nbsp;&#39;}&#39;</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843592">if</span>&nbsp;<span class="ident" id="4843595">p</span><span class="op" id="4843596">.</span><span class="ident" id="4843597">tok</span>&nbsp;<span class="op" id="4843601">!=</span>&nbsp;<span class="ident" id="4843604">token</span><span class="op" id="4843609">.</span><span class="ident" id="4843610">RPAREN</span>&nbsp;<span class="op" id="4843617">&amp;&amp;</span>&nbsp;<span class="ident" id="4843620">p</span><span class="op" id="4843621">.</span><span class="ident" id="4843622">tok</span>&nbsp;<span class="op" id="4843626">!=</span>&nbsp;<span class="ident" id="4843629">token</span><span class="op" id="4843634">.</span><span class="ident" id="4843635">RBRACE</span>&nbsp;<span class="op" id="4843642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843646">if</span>&nbsp;<span class="ident" id="4843649">p</span><span class="op" id="4843650">.</span><span class="ident" id="4843651">tok</span>&nbsp;<span class="op" id="4843655">==</span>&nbsp;<span class="ident" id="4843658">token</span><span class="op" id="4843663">.</span><span class="ident" id="4843664">SEMICOLON</span>&nbsp;<span class="op" id="4843674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843679">p</span><span class="op" id="4843680">.</span><span class="ident" id="4843681">next</span><span class="op" id="4843685">(</span><span class="op" id="4843686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843690">}</span>&nbsp;<span class="keyword" id="4843692">else</span>&nbsp;<span class="op" id="4843697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843702">p</span><span class="op" id="4843703">.</span><span class="ident" id="4843704">errorExpected</span><span class="op" id="4843717">(</span><span class="ident" id="4843718">p</span><span class="op" id="4843719">.</span><span class="ident" id="4843720">pos</span><span class="op" id="4843723">,</span>&nbsp;<span class="string" id="4843725">&#34;&#39;;&#39;&#34;</span><span class="op" id="4843730">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843735">syncStmt</span><span class="op" id="4843743">(</span><span class="ident" id="4843744">p</span><span class="op" id="4843745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843752">}</span><br>
<span class="lineno"></span><span class="op" id="4843754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="keyword" id="4843757">func</span>&nbsp;<span class="op" id="4843762">(</span><span class="ident" id="4843763">p</span>&nbsp;<span class="op" id="4843765">*</span><span class="ident" id="4843766">parser</span><span class="op" id="4843772">)</span>&nbsp;<span class="ident" id="4843774">atComma</span><span class="op" id="4843781">(</span><span class="ident" id="4843782">context</span>&nbsp;<span class="builtintype" id="4843790">string</span><span class="op" id="4843796">)</span>&nbsp;<span class="builtintype" id="4843798">bool</span>&nbsp;<span class="op" id="4843803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843806">if</span>&nbsp;<span class="ident" id="4843809">p</span><span class="op" id="4843810">.</span><span class="ident" id="4843811">tok</span>&nbsp;<span class="op" id="4843815">==</span>&nbsp;<span class="ident" id="4843818">token</span><span class="op" id="4843823">.</span><span class="ident" id="4843824">COMMA</span>&nbsp;<span class="op" id="4843830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843834">return</span>&nbsp;<span class="builtintype" id="4843841">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4843847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843850">if</span>&nbsp;<span class="ident" id="4843853">p</span><span class="op" id="4843854">.</span><span class="ident" id="4843855">tok</span>&nbsp;<span class="op" id="4843859">==</span>&nbsp;<span class="ident" id="4843862">token</span><span class="op" id="4843867">.</span><span class="ident" id="4843868">SEMICOLON</span>&nbsp;<span class="op" id="4843878">&amp;&amp;</span>&nbsp;<span class="ident" id="4843881">p</span><span class="op" id="4843882">.</span><span class="ident" id="4843883">lit</span>&nbsp;<span class="op" id="4843887">==</span>&nbsp;<span class="string" id="4843890">&#34;\n&#34;</span>&nbsp;<span class="op" id="4843895">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4843899">p</span><span class="op" id="4843900">.</span><span class="builtintype" id="4843901">error</span><span class="op" id="4843906">(</span><span class="ident" id="4843907">p</span><span class="op" id="4843908">.</span><span class="ident" id="4843909">pos</span><span class="op" id="4843912">,</span>&nbsp;<span class="string" id="4843914">&#34;missing&nbsp;&#39;,&#39;&nbsp;before&nbsp;newline&nbsp;in&nbsp;&#34;</span><span class="op" id="4843946">+</span><span class="ident" id="4843947">context</span><span class="op" id="4843954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4843958">return</span>&nbsp;<span class="builtintype" id="4843965">true</span>&nbsp;<span class="comment" id="4843970">//&nbsp;&#34;insert&#34;&nbsp;the&nbsp;comma&nbsp;and&nbsp;continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4844007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844010">return</span>&nbsp;<span class="builtintype" id="4844017">false</span><br>
<span class="lineno">425</span><span class="op" id="4844023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4844026">func</span>&nbsp;<span class="ident" id="4844031">assert</span><span class="op" id="4844037">(</span><span class="ident" id="4844038">cond</span>&nbsp;<span class="builtintype" id="4844043">bool</span><span class="op" id="4844047">,</span>&nbsp;<span class="ident" id="4844049">msg</span>&nbsp;<span class="builtintype" id="4844053">string</span><span class="op" id="4844059">)</span>&nbsp;<span class="op" id="4844061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844064">if</span>&nbsp;<span class="op" id="4844067">!</span><span class="ident" id="4844068">cond</span>&nbsp;<span class="op" id="4844073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4844077">panic</span><span class="op" id="4844082">(</span><span class="string" id="4844083">&#34;go/parser&nbsp;internal&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4844112">+</span>&nbsp;<span class="ident" id="4844114">msg</span><span class="op" id="4844117">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4844120">}</span><br>
<span class="lineno"></span><span class="op" id="4844122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844125">//&nbsp;syncStmt&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="4844169">//&nbsp;Used&nbsp;for&nbsp;synchronization&nbsp;after&nbsp;an&nbsp;error.</span><br>
<span class="lineno">435</span><span class="comment" id="4844213">//</span><br>
<span class="lineno"></span><span class="keyword" id="4844216">func</span>&nbsp;<span class="ident" id="4844221">syncStmt</span><span class="op" id="4844229">(</span><span class="ident" id="4844230">p</span>&nbsp;<span class="op" id="4844232">*</span><span class="ident" id="4844233">parser</span><span class="op" id="4844239">)</span>&nbsp;<span class="op" id="4844241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844244">for</span>&nbsp;<span class="op" id="4844248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844252">switch</span>&nbsp;<span class="ident" id="4844259">p</span><span class="op" id="4844260">.</span><span class="ident" id="4844261">tok</span>&nbsp;<span class="op" id="4844265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844269">case</span>&nbsp;<span class="ident" id="4844274">token</span><span class="op" id="4844279">.</span><span class="ident" id="4844280">BREAK</span><span class="op" id="4844285">,</span>&nbsp;<span class="ident" id="4844287">token</span><span class="op" id="4844292">.</span><span class="ident" id="4844293">CONST</span><span class="op" id="4844298">,</span>&nbsp;<span class="ident" id="4844300">token</span><span class="op" id="4844305">.</span><span class="ident" id="4844306">CONTINUE</span><span class="op" id="4844314">,</span>&nbsp;<span class="ident" id="4844316">token</span><span class="op" id="4844321">.</span><span class="ident" id="4844322">DEFER</span><span class="op" id="4844327">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844332">token</span><span class="op" id="4844337">.</span><span class="ident" id="4844338">FALLTHROUGH</span><span class="op" id="4844349">,</span>&nbsp;<span class="ident" id="4844351">token</span><span class="op" id="4844356">.</span><span class="ident" id="4844357">FOR</span><span class="op" id="4844360">,</span>&nbsp;<span class="ident" id="4844362">token</span><span class="op" id="4844367">.</span><span class="ident" id="4844368">GO</span><span class="op" id="4844370">,</span>&nbsp;<span class="ident" id="4844372">token</span><span class="op" id="4844377">.</span><span class="ident" id="4844378">GOTO</span><span class="op" id="4844382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844387">token</span><span class="op" id="4844392">.</span><span class="ident" id="4844393">IF</span><span class="op" id="4844395">,</span>&nbsp;<span class="ident" id="4844397">token</span><span class="op" id="4844402">.</span><span class="ident" id="4844403">RETURN</span><span class="op" id="4844409">,</span>&nbsp;<span class="ident" id="4844411">token</span><span class="op" id="4844416">.</span><span class="ident" id="4844417">SELECT</span><span class="op" id="4844423">,</span>&nbsp;<span class="ident" id="4844425">token</span><span class="op" id="4844430">.</span><span class="ident" id="4844431">SWITCH</span><span class="op" id="4844437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844442">token</span><span class="op" id="4844447">.</span><span class="ident" id="4844448">TYPE</span><span class="op" id="4844452">,</span>&nbsp;<span class="ident" id="4844454">token</span><span class="op" id="4844459">.</span><span class="ident" id="4844460">VAR</span><span class="op" id="4844463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844468">//&nbsp;Return&nbsp;only&nbsp;if&nbsp;parser&nbsp;made&nbsp;some&nbsp;progress&nbsp;since&nbsp;last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844526">//&nbsp;sync&nbsp;or&nbsp;if&nbsp;it&nbsp;has&nbsp;not&nbsp;reached&nbsp;10&nbsp;sync&nbsp;calls&nbsp;without</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844584">//&nbsp;progress.&nbsp;Otherwise&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;token&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844640">//&nbsp;avoid&nbsp;an&nbsp;endless&nbsp;parser&nbsp;loop&nbsp;(it&nbsp;is&nbsp;possible&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844696">//&nbsp;both&nbsp;parseOperand&nbsp;and&nbsp;parseStmt&nbsp;call&nbsp;syncStmt&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844752">//&nbsp;correctly&nbsp;do&nbsp;not&nbsp;advance,&nbsp;thus&nbsp;the&nbsp;need&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4844806">//&nbsp;invocation&nbsp;limit&nbsp;p.syncCnt).</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844841">if</span>&nbsp;<span class="ident" id="4844844">p</span><span class="op" id="4844845">.</span><span class="ident" id="4844846">pos</span>&nbsp;<span class="op" id="4844850">==</span>&nbsp;<span class="ident" id="4844853">p</span><span class="op" id="4844854">.</span><span class="ident" id="4844855">syncPos</span>&nbsp;<span class="op" id="4844863">&amp;&amp;</span>&nbsp;<span class="ident" id="4844866">p</span><span class="op" id="4844867">.</span><span class="ident" id="4844868">syncCnt</span>&nbsp;<span class="op" id="4844876">&lt;</span>&nbsp;<span class="num" id="4844878">10</span>&nbsp;<span class="op" id="4844881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844887">p</span><span class="op" id="4844888">.</span><span class="ident" id="4844889">syncCnt</span><span class="op" id="4844896">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844903">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4844913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844918">if</span>&nbsp;<span class="ident" id="4844921">p</span><span class="op" id="4844922">.</span><span class="ident" id="4844923">pos</span>&nbsp;<span class="op" id="4844927">&gt;</span>&nbsp;<span class="ident" id="4844929">p</span><span class="op" id="4844930">.</span><span class="ident" id="4844931">syncPos</span>&nbsp;<span class="op" id="4844939">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844945">p</span><span class="op" id="4844946">.</span><span class="ident" id="4844947">syncPos</span>&nbsp;<span class="op" id="4844955">=</span>&nbsp;<span class="ident" id="4844957">p</span><span class="op" id="4844958">.</span><span class="ident" id="4844959">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4844967">p</span><span class="op" id="4844968">.</span><span class="ident" id="4844969">syncCnt</span>&nbsp;<span class="op" id="4844977">=</span>&nbsp;<span class="num" id="4844979">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4844985">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4844995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845000">//&nbsp;Reaching&nbsp;here&nbsp;indicates&nbsp;a&nbsp;parser&nbsp;bug,&nbsp;likely&nbsp;an</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845054">//&nbsp;incorrect&nbsp;token&nbsp;list&nbsp;in&nbsp;this&nbsp;function,&nbsp;but&nbsp;it&nbsp;only</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845111">//&nbsp;leads&nbsp;to&nbsp;skipping&nbsp;of&nbsp;possibly&nbsp;correct&nbsp;code&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845165">//&nbsp;previous&nbsp;error&nbsp;is&nbsp;present,&nbsp;and&nbsp;thus&nbsp;is&nbsp;preferred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845220">//&nbsp;over&nbsp;a&nbsp;non-terminating&nbsp;parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845255">case</span>&nbsp;<span class="ident" id="4845260">token</span><span class="op" id="4845265">.</span><span class="ident" id="4845266">EOF</span><span class="op" id="4845269">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845274">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4845287">p</span><span class="op" id="4845288">.</span><span class="ident" id="4845289">next</span><span class="op" id="4845293">(</span><span class="op" id="4845294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845297">}</span><br>
<span class="lineno"></span><span class="op" id="4845299">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="4845302">//&nbsp;syncDecl&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="4845348">//&nbsp;Used&nbsp;for&nbsp;synchronization&nbsp;after&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4845392">//</span><br>
<span class="lineno"></span><span class="keyword" id="4845395">func</span>&nbsp;<span class="ident" id="4845400">syncDecl</span><span class="op" id="4845408">(</span><span class="ident" id="4845409">p</span>&nbsp;<span class="op" id="4845411">*</span><span class="ident" id="4845412">parser</span><span class="op" id="4845418">)</span>&nbsp;<span class="op" id="4845420">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845423">for</span>&nbsp;<span class="op" id="4845427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845431">switch</span>&nbsp;<span class="ident" id="4845438">p</span><span class="op" id="4845439">.</span><span class="ident" id="4845440">tok</span>&nbsp;<span class="op" id="4845444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845448">case</span>&nbsp;<span class="ident" id="4845453">token</span><span class="op" id="4845458">.</span><span class="ident" id="4845459">CONST</span><span class="op" id="4845464">,</span>&nbsp;<span class="ident" id="4845466">token</span><span class="op" id="4845471">.</span><span class="ident" id="4845472">TYPE</span><span class="op" id="4845476">,</span>&nbsp;<span class="ident" id="4845478">token</span><span class="op" id="4845483">.</span><span class="ident" id="4845484">VAR</span><span class="op" id="4845487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4845492">//&nbsp;see&nbsp;comments&nbsp;in&nbsp;syncStmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845523">if</span>&nbsp;<span class="ident" id="4845526">p</span><span class="op" id="4845527">.</span><span class="ident" id="4845528">pos</span>&nbsp;<span class="op" id="4845532">==</span>&nbsp;<span class="ident" id="4845535">p</span><span class="op" id="4845536">.</span><span class="ident" id="4845537">syncPos</span>&nbsp;<span class="op" id="4845545">&amp;&amp;</span>&nbsp;<span class="ident" id="4845548">p</span><span class="op" id="4845549">.</span><span class="ident" id="4845550">syncCnt</span>&nbsp;<span class="op" id="4845558">&lt;</span>&nbsp;<span class="num" id="4845560">10</span>&nbsp;<span class="op" id="4845563">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4845569">p</span><span class="op" id="4845570">.</span><span class="ident" id="4845571">syncCnt</span><span class="op" id="4845578">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845600">if</span>&nbsp;<span class="ident" id="4845603">p</span><span class="op" id="4845604">.</span><span class="ident" id="4845605">pos</span>&nbsp;<span class="op" id="4845609">&gt;</span>&nbsp;<span class="ident" id="4845611">p</span><span class="op" id="4845612">.</span><span class="ident" id="4845613">syncPos</span>&nbsp;<span class="op" id="4845621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4845627">p</span><span class="op" id="4845628">.</span><span class="ident" id="4845629">syncPos</span>&nbsp;<span class="op" id="4845637">=</span>&nbsp;<span class="ident" id="4845639">p</span><span class="op" id="4845640">.</span><span class="ident" id="4845641">pos</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4845649">p</span><span class="op" id="4845650">.</span><span class="ident" id="4845651">syncCnt</span>&nbsp;<span class="op" id="4845659">=</span>&nbsp;<span class="num" id="4845661">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845667">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845681">case</span>&nbsp;<span class="ident" id="4845686">token</span><span class="op" id="4845691">.</span><span class="ident" id="4845692">EOF</span><span class="op" id="4845695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4845700">return</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4845713">p</span><span class="op" id="4845714">.</span><span class="ident" id="4845715">next</span><span class="op" id="4845719">(</span><span class="op" id="4845720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4845723">}</span><br>
<span class="lineno"></span><span class="op" id="4845725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="comment" id="4845728">//&nbsp;safePos&nbsp;returns&nbsp;a&nbsp;valid&nbsp;file&nbsp;position&nbsp;for&nbsp;a&nbsp;given&nbsp;position:&nbsp;If&nbsp;pos</span><br>
<span class="lineno"></span><span class="comment" id="4845798">//&nbsp;is&nbsp;valid&nbsp;to&nbsp;begin&nbsp;with,&nbsp;safePos&nbsp;returns&nbsp;pos.&nbsp;If&nbsp;pos&nbsp;is&nbsp;out-of-range,</span><br>
<span class="lineno"></span><span class="comment" id="4845870">//&nbsp;safePos&nbsp;returns&nbsp;the&nbsp;EOF&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="4845907">//</span><br>
<span class="lineno"></span><span class="comment" id="4845910">//&nbsp;This&nbsp;is&nbsp;hack&nbsp;to&nbsp;work&nbsp;around&nbsp;&#34;artificial&#34;&nbsp;end&nbsp;positions&nbsp;in&nbsp;the&nbsp;AST&nbsp;which</span><br>
<span class="lineno">500</span><span class="comment" id="4845985">//&nbsp;are&nbsp;computed&nbsp;by&nbsp;adding&nbsp;1&nbsp;to&nbsp;(presumably&nbsp;valid)&nbsp;token&nbsp;positions.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4846059">//&nbsp;token&nbsp;positions&nbsp;are&nbsp;invalid&nbsp;due&nbsp;to&nbsp;parse&nbsp;errors,&nbsp;the&nbsp;resulting&nbsp;end&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="4846138">//&nbsp;may&nbsp;be&nbsp;past&nbsp;the&nbsp;file&#39;s&nbsp;EOF&nbsp;position,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to&nbsp;panics&nbsp;if&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4846213">//&nbsp;later&nbsp;on.</span><br>
<span class="lineno"></span><span class="comment" id="4846226">//</span><br>
<span class="lineno">505</span><span class="keyword" id="4846229">func</span>&nbsp;<span class="op" id="4846234">(</span><span class="ident" id="4846235">p</span>&nbsp;<span class="op" id="4846237">*</span><span class="ident" id="4846238">parser</span><span class="op" id="4846244">)</span>&nbsp;<span class="ident" id="4846246">safePos</span><span class="op" id="4846253">(</span><span class="ident" id="4846254">pos</span>&nbsp;<span class="ident" id="4846258">token</span><span class="op" id="4846263">.</span><span class="ident" id="4846264">Pos</span><span class="op" id="4846267">)</span>&nbsp;<span class="op" id="4846269">(</span><span class="ident" id="4846270">res</span>&nbsp;<span class="ident" id="4846274">token</span><span class="op" id="4846279">.</span><span class="ident" id="4846280">Pos</span><span class="op" id="4846283">)</span>&nbsp;<span class="op" id="4846285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846288">defer</span>&nbsp;<span class="keyword" id="4846294">func</span><span class="op" id="4846298">(</span><span class="op" id="4846299">)</span>&nbsp;<span class="op" id="4846301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846305">if</span>&nbsp;<span class="builtinfunc" id="4846308">recover</span><span class="op" id="4846315">(</span><span class="op" id="4846316">)</span>&nbsp;<span class="op" id="4846318">!=</span>&nbsp;<span class="builtintype" id="4846321">nil</span>&nbsp;<span class="op" id="4846325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846330">res</span>&nbsp;<span class="op" id="4846334">=</span>&nbsp;<span class="ident" id="4846336">token</span><span class="op" id="4846341">.</span><span class="ident" id="4846342">Pos</span><span class="op" id="4846345">(</span><span class="ident" id="4846346">p</span><span class="op" id="4846347">.</span><span class="ident" id="4846348">file</span><span class="op" id="4846352">.</span><span class="ident" id="4846353">Base</span><span class="op" id="4846357">(</span><span class="op" id="4846358">)</span>&nbsp;<span class="op" id="4846360">+</span>&nbsp;<span class="ident" id="4846362">p</span><span class="op" id="4846363">.</span><span class="ident" id="4846364">file</span><span class="op" id="4846368">.</span><span class="ident" id="4846369">Size</span><span class="op" id="4846373">(</span><span class="op" id="4846374">)</span><span class="op" id="4846375">)</span>&nbsp;<span class="comment" id="4846377">//&nbsp;EOF&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4846395">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4846398">}</span><span class="op" id="4846399">(</span><span class="op" id="4846400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846403">_</span>&nbsp;<span class="op" id="4846405">=</span>&nbsp;<span class="ident" id="4846407">p</span><span class="op" id="4846408">.</span><span class="ident" id="4846409">file</span><span class="op" id="4846413">.</span><span class="ident" id="4846414">Offset</span><span class="op" id="4846420">(</span><span class="ident" id="4846421">pos</span><span class="op" id="4846424">)</span>&nbsp;<span class="comment" id="4846426">//&nbsp;trigger&nbsp;a&nbsp;panic&nbsp;if&nbsp;position&nbsp;is&nbsp;out-of-range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846474">return</span>&nbsp;<span class="ident" id="4846481">pos</span><br>
<span class="lineno"></span><span class="op" id="4846485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4846488">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4846568">//&nbsp;Identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4846584">func</span>&nbsp;<span class="op" id="4846589">(</span><span class="ident" id="4846590">p</span>&nbsp;<span class="op" id="4846592">*</span><span class="ident" id="4846593">parser</span><span class="op" id="4846599">)</span>&nbsp;<span class="ident" id="4846601">parseIdent</span><span class="op" id="4846611">(</span><span class="op" id="4846612">)</span>&nbsp;<span class="op" id="4846614">*</span><span class="ident" id="4846615">ast</span><span class="op" id="4846618">.</span><span class="ident" id="4846619">Ident</span>&nbsp;<span class="op" id="4846625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846628">pos</span>&nbsp;<span class="op" id="4846632">:=</span>&nbsp;<span class="ident" id="4846635">p</span><span class="op" id="4846636">.</span><span class="ident" id="4846637">pos</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846642">name</span>&nbsp;<span class="op" id="4846647">:=</span>&nbsp;<span class="string" id="4846650">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846655">if</span>&nbsp;<span class="ident" id="4846658">p</span><span class="op" id="4846659">.</span><span class="ident" id="4846660">tok</span>&nbsp;<span class="op" id="4846664">==</span>&nbsp;<span class="ident" id="4846667">token</span><span class="op" id="4846672">.</span><span class="ident" id="4846673">IDENT</span>&nbsp;<span class="op" id="4846679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846683">name</span>&nbsp;<span class="op" id="4846688">=</span>&nbsp;<span class="ident" id="4846690">p</span><span class="op" id="4846691">.</span><span class="ident" id="4846692">lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846698">p</span><span class="op" id="4846699">.</span><span class="ident" id="4846700">next</span><span class="op" id="4846704">(</span><span class="op" id="4846705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4846708">}</span>&nbsp;<span class="keyword" id="4846710">else</span>&nbsp;<span class="op" id="4846715">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846719">p</span><span class="op" id="4846720">.</span><span class="ident" id="4846721">expect</span><span class="op" id="4846727">(</span><span class="ident" id="4846728">token</span><span class="op" id="4846733">.</span><span class="ident" id="4846734">IDENT</span><span class="op" id="4846739">)</span>&nbsp;<span class="comment" id="4846741">//&nbsp;use&nbsp;expect()&nbsp;error&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4846773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846776">return</span>&nbsp;<span class="op" id="4846783">&amp;</span><span class="ident" id="4846784">ast</span><span class="op" id="4846787">.</span><span class="ident" id="4846788">Ident</span><span class="op" id="4846793">{</span><span class="ident" id="4846794">NamePos</span><span class="op" id="4846801">:</span>&nbsp;<span class="ident" id="4846803">pos</span><span class="op" id="4846806">,</span>&nbsp;<span class="ident" id="4846808">Name</span><span class="op" id="4846812">:</span>&nbsp;<span class="ident" id="4846814">name</span><span class="op" id="4846818">}</span><br>
<span class="lineno"></span><span class="op" id="4846820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span><span class="keyword" id="4846823">func</span>&nbsp;<span class="op" id="4846828">(</span><span class="ident" id="4846829">p</span>&nbsp;<span class="op" id="4846831">*</span><span class="ident" id="4846832">parser</span><span class="op" id="4846838">)</span>&nbsp;<span class="ident" id="4846840">parseIdentList</span><span class="op" id="4846854">(</span><span class="op" id="4846855">)</span>&nbsp;<span class="op" id="4846857">(</span><span class="ident" id="4846858">list</span>&nbsp;<span class="op" id="4846863">[</span><span class="op" id="4846864">]</span><span class="op" id="4846865">*</span><span class="ident" id="4846866">ast</span><span class="op" id="4846869">.</span><span class="ident" id="4846870">Ident</span><span class="op" id="4846875">)</span>&nbsp;<span class="op" id="4846877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846880">if</span>&nbsp;<span class="ident" id="4846883">p</span><span class="op" id="4846884">.</span><span class="ident" id="4846885">trace</span>&nbsp;<span class="op" id="4846891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846895">defer</span>&nbsp;<span class="ident" id="4846901">un</span><span class="op" id="4846903">(</span><span class="ident" id="4846904">trace</span><span class="op" id="4846909">(</span><span class="ident" id="4846910">p</span><span class="op" id="4846911">,</span>&nbsp;<span class="string" id="4846913">&#34;IdentList&#34;</span><span class="op" id="4846924">)</span><span class="op" id="4846925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4846928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846932">list</span>&nbsp;<span class="op" id="4846937">=</span>&nbsp;<span class="builtinfunc" id="4846939">append</span><span class="op" id="4846945">(</span><span class="ident" id="4846946">list</span><span class="op" id="4846950">,</span>&nbsp;<span class="ident" id="4846952">p</span><span class="op" id="4846953">.</span><span class="ident" id="4846954">parseIdent</span><span class="op" id="4846964">(</span><span class="op" id="4846965">)</span><span class="op" id="4846966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4846969">for</span>&nbsp;<span class="ident" id="4846973">p</span><span class="op" id="4846974">.</span><span class="ident" id="4846975">tok</span>&nbsp;<span class="op" id="4846979">==</span>&nbsp;<span class="ident" id="4846982">token</span><span class="op" id="4846987">.</span><span class="ident" id="4846988">COMMA</span>&nbsp;<span class="op" id="4846994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4846998">p</span><span class="op" id="4846999">.</span><span class="ident" id="4847000">next</span><span class="op" id="4847004">(</span><span class="op" id="4847005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847009">list</span>&nbsp;<span class="op" id="4847014">=</span>&nbsp;<span class="builtinfunc" id="4847016">append</span><span class="op" id="4847022">(</span><span class="ident" id="4847023">list</span><span class="op" id="4847027">,</span>&nbsp;<span class="ident" id="4847029">p</span><span class="op" id="4847030">.</span><span class="ident" id="4847031">parseIdent</span><span class="op" id="4847041">(</span><span class="op" id="4847042">)</span><span class="op" id="4847043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4847046">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847050">return</span><br>
<span class="lineno"></span><span class="op" id="4847057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4847060">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">545</span><span class="comment" id="4847140">//&nbsp;Common&nbsp;productions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4847163">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set,&nbsp;result&nbsp;list&nbsp;elements&nbsp;which&nbsp;are&nbsp;identifiers&nbsp;are&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4847242">func</span>&nbsp;<span class="op" id="4847247">(</span><span class="ident" id="4847248">p</span>&nbsp;<span class="op" id="4847250">*</span><span class="ident" id="4847251">parser</span><span class="op" id="4847257">)</span>&nbsp;<span class="ident" id="4847259">parseExprList</span><span class="op" id="4847272">(</span><span class="ident" id="4847273">lhs</span>&nbsp;<span class="builtintype" id="4847277">bool</span><span class="op" id="4847281">)</span>&nbsp;<span class="op" id="4847283">(</span><span class="ident" id="4847284">list</span>&nbsp;<span class="op" id="4847289">[</span><span class="op" id="4847290">]</span><span class="ident" id="4847291">ast</span><span class="op" id="4847294">.</span><span class="ident" id="4847295">Expr</span><span class="op" id="4847299">)</span>&nbsp;<span class="op" id="4847301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847304">if</span>&nbsp;<span class="ident" id="4847307">p</span><span class="op" id="4847308">.</span><span class="ident" id="4847309">trace</span>&nbsp;<span class="op" id="4847315">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847319">defer</span>&nbsp;<span class="ident" id="4847325">un</span><span class="op" id="4847327">(</span><span class="ident" id="4847328">trace</span><span class="op" id="4847333">(</span><span class="ident" id="4847334">p</span><span class="op" id="4847335">,</span>&nbsp;<span class="string" id="4847337">&#34;ExpressionList&#34;</span><span class="op" id="4847353">)</span><span class="op" id="4847354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4847357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847361">list</span>&nbsp;<span class="op" id="4847366">=</span>&nbsp;<span class="builtinfunc" id="4847368">append</span><span class="op" id="4847374">(</span><span class="ident" id="4847375">list</span><span class="op" id="4847379">,</span>&nbsp;<span class="ident" id="4847381">p</span><span class="op" id="4847382">.</span><span class="ident" id="4847383">checkExpr</span><span class="op" id="4847392">(</span><span class="ident" id="4847393">p</span><span class="op" id="4847394">.</span><span class="ident" id="4847395">parseExpr</span><span class="op" id="4847404">(</span><span class="ident" id="4847405">lhs</span><span class="op" id="4847408">)</span><span class="op" id="4847409">)</span><span class="op" id="4847410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847413">for</span>&nbsp;<span class="ident" id="4847417">p</span><span class="op" id="4847418">.</span><span class="ident" id="4847419">tok</span>&nbsp;<span class="op" id="4847423">==</span>&nbsp;<span class="ident" id="4847426">token</span><span class="op" id="4847431">.</span><span class="ident" id="4847432">COMMA</span>&nbsp;<span class="op" id="4847438">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847442">p</span><span class="op" id="4847443">.</span><span class="ident" id="4847444">next</span><span class="op" id="4847448">(</span><span class="op" id="4847449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847453">list</span>&nbsp;<span class="op" id="4847458">=</span>&nbsp;<span class="builtinfunc" id="4847460">append</span><span class="op" id="4847466">(</span><span class="ident" id="4847467">list</span><span class="op" id="4847471">,</span>&nbsp;<span class="ident" id="4847473">p</span><span class="op" id="4847474">.</span><span class="ident" id="4847475">checkExpr</span><span class="op" id="4847484">(</span><span class="ident" id="4847485">p</span><span class="op" id="4847486">.</span><span class="ident" id="4847487">parseExpr</span><span class="op" id="4847496">(</span><span class="ident" id="4847497">lhs</span><span class="op" id="4847500">)</span><span class="op" id="4847501">)</span><span class="op" id="4847502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4847505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847509">return</span><br>
<span class="lineno">560</span><span class="op" id="4847516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4847519">func</span>&nbsp;<span class="op" id="4847524">(</span><span class="ident" id="4847525">p</span>&nbsp;<span class="op" id="4847527">*</span><span class="ident" id="4847528">parser</span><span class="op" id="4847534">)</span>&nbsp;<span class="ident" id="4847536">parseLhsList</span><span class="op" id="4847548">(</span><span class="op" id="4847549">)</span>&nbsp;<span class="op" id="4847551">[</span><span class="op" id="4847552">]</span><span class="ident" id="4847553">ast</span><span class="op" id="4847556">.</span><span class="ident" id="4847557">Expr</span>&nbsp;<span class="op" id="4847562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847565">old</span>&nbsp;<span class="op" id="4847569">:=</span>&nbsp;<span class="ident" id="4847572">p</span><span class="op" id="4847573">.</span><span class="ident" id="4847574">inRhs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847581">p</span><span class="op" id="4847582">.</span><span class="ident" id="4847583">inRhs</span>&nbsp;<span class="op" id="4847589">=</span>&nbsp;<span class="builtintype" id="4847591">false</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4847598">list</span>&nbsp;<span class="op" id="4847603">:=</span>&nbsp;<span class="ident" id="4847606">p</span><span class="op" id="4847607">.</span><span class="ident" id="4847608">parseExprList</span><span class="op" id="4847621">(</span><span class="builtintype" id="4847622">true</span><span class="op" id="4847626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847629">switch</span>&nbsp;<span class="ident" id="4847636">p</span><span class="op" id="4847637">.</span><span class="ident" id="4847638">tok</span>&nbsp;<span class="op" id="4847642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847645">case</span>&nbsp;<span class="ident" id="4847650">token</span><span class="op" id="4847655">.</span><span class="ident" id="4847656">DEFINE</span><span class="op" id="4847662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847666">//&nbsp;lhs&nbsp;of&nbsp;a&nbsp;short&nbsp;variable&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847707">//&nbsp;but&nbsp;doesn&#39;t&nbsp;enter&nbsp;scope&nbsp;until&nbsp;later:</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847749">//&nbsp;caller&nbsp;must&nbsp;call&nbsp;p.shortVarDecl(p.makeIdentList(list))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847809">//&nbsp;at&nbsp;appropriate&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4847834">case</span>&nbsp;<span class="ident" id="4847839">token</span><span class="op" id="4847844">.</span><span class="ident" id="4847845">COLON</span><span class="op" id="4847850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847854">//&nbsp;lhs&nbsp;of&nbsp;a&nbsp;label&nbsp;declaration&nbsp;or&nbsp;a&nbsp;communication&nbsp;clause&nbsp;of&nbsp;a&nbsp;select</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847924">//&nbsp;statement&nbsp;(parseLhsList&nbsp;is&nbsp;not&nbsp;called&nbsp;when&nbsp;parsing&nbsp;the&nbsp;case&nbsp;clause</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4847996">//&nbsp;of&nbsp;a&nbsp;switch&nbsp;statement):</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4848025">//&nbsp;-&nbsp;labels&nbsp;are&nbsp;declared&nbsp;by&nbsp;the&nbsp;caller&nbsp;of&nbsp;parseLhsList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4848082">//&nbsp;-&nbsp;for&nbsp;communication&nbsp;clauses,&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;stand-alone&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4848153">//&nbsp;&nbsp;&nbsp;followed&nbsp;by&nbsp;a&nbsp;colon,&nbsp;we&nbsp;have&nbsp;a&nbsp;syntax&nbsp;error;&nbsp;there&nbsp;is&nbsp;no&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4848222">//&nbsp;&nbsp;&nbsp;to&nbsp;resolve&nbsp;the&nbsp;identifier&nbsp;in&nbsp;that&nbsp;case</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848267">default</span><span class="op" id="4848274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4848278">//&nbsp;identifiers&nbsp;must&nbsp;be&nbsp;declared&nbsp;elsewhere</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848322">for</span>&nbsp;<span class="ident" id="4848326">_</span><span class="op" id="4848327">,</span>&nbsp;<span class="ident" id="4848329">x</span>&nbsp;<span class="op" id="4848331">:=</span>&nbsp;<span class="keyword" id="4848334">range</span>&nbsp;<span class="ident" id="4848340">list</span>&nbsp;<span class="op" id="4848345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848350">p</span><span class="op" id="4848351">.</span><span class="ident" id="4848352">resolve</span><span class="op" id="4848359">(</span><span class="ident" id="4848360">x</span><span class="op" id="4848361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4848365">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4848368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848371">p</span><span class="op" id="4848372">.</span><span class="ident" id="4848373">inRhs</span>&nbsp;<span class="op" id="4848379">=</span>&nbsp;<span class="ident" id="4848381">old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848386">return</span>&nbsp;<span class="ident" id="4848393">list</span><br>
<span class="lineno"></span><span class="op" id="4848398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="keyword" id="4848401">func</span>&nbsp;<span class="op" id="4848406">(</span><span class="ident" id="4848407">p</span>&nbsp;<span class="op" id="4848409">*</span><span class="ident" id="4848410">parser</span><span class="op" id="4848416">)</span>&nbsp;<span class="ident" id="4848418">parseRhsList</span><span class="op" id="4848430">(</span><span class="op" id="4848431">)</span>&nbsp;<span class="op" id="4848433">[</span><span class="op" id="4848434">]</span><span class="ident" id="4848435">ast</span><span class="op" id="4848438">.</span><span class="ident" id="4848439">Expr</span>&nbsp;<span class="op" id="4848444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848447">old</span>&nbsp;<span class="op" id="4848451">:=</span>&nbsp;<span class="ident" id="4848454">p</span><span class="op" id="4848455">.</span><span class="ident" id="4848456">inRhs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848463">p</span><span class="op" id="4848464">.</span><span class="ident" id="4848465">inRhs</span>&nbsp;<span class="op" id="4848471">=</span>&nbsp;<span class="builtintype" id="4848473">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848479">list</span>&nbsp;<span class="op" id="4848484">:=</span>&nbsp;<span class="ident" id="4848487">p</span><span class="op" id="4848488">.</span><span class="ident" id="4848489">parseExprList</span><span class="op" id="4848502">(</span><span class="builtintype" id="4848503">false</span><span class="op" id="4848508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848511">p</span><span class="op" id="4848512">.</span><span class="ident" id="4848513">inRhs</span>&nbsp;<span class="op" id="4848519">=</span>&nbsp;<span class="ident" id="4848521">old</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848526">return</span>&nbsp;<span class="ident" id="4848533">list</span><br>
<span class="lineno"></span><span class="op" id="4848538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4848541">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4848621">//&nbsp;Types</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span><span class="keyword" id="4848631">func</span>&nbsp;<span class="op" id="4848636">(</span><span class="ident" id="4848637">p</span>&nbsp;<span class="op" id="4848639">*</span><span class="ident" id="4848640">parser</span><span class="op" id="4848646">)</span>&nbsp;<span class="ident" id="4848648">parseType</span><span class="op" id="4848657">(</span><span class="op" id="4848658">)</span>&nbsp;<span class="ident" id="4848660">ast</span><span class="op" id="4848663">.</span><span class="ident" id="4848664">Expr</span>&nbsp;<span class="op" id="4848669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848672">if</span>&nbsp;<span class="ident" id="4848675">p</span><span class="op" id="4848676">.</span><span class="ident" id="4848677">trace</span>&nbsp;<span class="op" id="4848683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848687">defer</span>&nbsp;<span class="ident" id="4848693">un</span><span class="op" id="4848695">(</span><span class="ident" id="4848696">trace</span><span class="op" id="4848701">(</span><span class="ident" id="4848702">p</span><span class="op" id="4848703">,</span>&nbsp;<span class="string" id="4848705">&#34;Type&#34;</span><span class="op" id="4848711">)</span><span class="op" id="4848712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4848715">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848719">typ</span>&nbsp;<span class="op" id="4848723">:=</span>&nbsp;<span class="ident" id="4848726">p</span><span class="op" id="4848727">.</span><span class="ident" id="4848728">tryType</span><span class="op" id="4848735">(</span><span class="op" id="4848736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848740">if</span>&nbsp;<span class="ident" id="4848743">typ</span>&nbsp;<span class="op" id="4848747">==</span>&nbsp;<span class="builtintype" id="4848750">nil</span>&nbsp;<span class="op" id="4848754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848758">pos</span>&nbsp;<span class="op" id="4848762">:=</span>&nbsp;<span class="ident" id="4848765">p</span><span class="op" id="4848766">.</span><span class="ident" id="4848767">pos</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848773">p</span><span class="op" id="4848774">.</span><span class="ident" id="4848775">errorExpected</span><span class="op" id="4848788">(</span><span class="ident" id="4848789">pos</span><span class="op" id="4848792">,</span>&nbsp;<span class="string" id="4848794">&#34;type&#34;</span><span class="op" id="4848800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4848804">p</span><span class="op" id="4848805">.</span><span class="ident" id="4848806">next</span><span class="op" id="4848810">(</span><span class="op" id="4848811">)</span>&nbsp;<span class="comment" id="4848813">//&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848832">return</span>&nbsp;<span class="op" id="4848839">&amp;</span><span class="ident" id="4848840">ast</span><span class="op" id="4848843">.</span><span class="ident" id="4848844">BadExpr</span><span class="op" id="4848851">{</span><span class="ident" id="4848852">From</span><span class="op" id="4848856">:</span>&nbsp;<span class="ident" id="4848858">pos</span><span class="op" id="4848861">,</span>&nbsp;<span class="ident" id="4848863">To</span><span class="op" id="4848865">:</span>&nbsp;<span class="ident" id="4848867">p</span><span class="op" id="4848868">.</span><span class="ident" id="4848869">pos</span><span class="op" id="4848872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4848875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848879">return</span>&nbsp;<span class="ident" id="4848886">typ</span><br>
<span class="lineno"></span><span class="op" id="4848890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4848893">//&nbsp;If&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4848948">func</span>&nbsp;<span class="op" id="4848953">(</span><span class="ident" id="4848954">p</span>&nbsp;<span class="op" id="4848956">*</span><span class="ident" id="4848957">parser</span><span class="op" id="4848963">)</span>&nbsp;<span class="ident" id="4848965">parseTypeName</span><span class="op" id="4848978">(</span><span class="op" id="4848979">)</span>&nbsp;<span class="ident" id="4848981">ast</span><span class="op" id="4848984">.</span><span class="ident" id="4848985">Expr</span>&nbsp;<span class="op" id="4848990">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4848993">if</span>&nbsp;<span class="ident" id="4848996">p</span><span class="op" id="4848997">.</span><span class="ident" id="4848998">trace</span>&nbsp;<span class="op" id="4849004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849008">defer</span>&nbsp;<span class="ident" id="4849014">un</span><span class="op" id="4849016">(</span><span class="ident" id="4849017">trace</span><span class="op" id="4849022">(</span><span class="ident" id="4849023">p</span><span class="op" id="4849024">,</span>&nbsp;<span class="string" id="4849026">&#34;TypeName&#34;</span><span class="op" id="4849036">)</span><span class="op" id="4849037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849044">ident</span>&nbsp;<span class="op" id="4849050">:=</span>&nbsp;<span class="ident" id="4849053">p</span><span class="op" id="4849054">.</span><span class="ident" id="4849055">parseIdent</span><span class="op" id="4849065">(</span><span class="op" id="4849066">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4849069">//&nbsp;don&#39;t&nbsp;resolve&nbsp;ident&nbsp;yet&nbsp;-&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;parameter&nbsp;or&nbsp;field&nbsp;name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849136">if</span>&nbsp;<span class="ident" id="4849139">p</span><span class="op" id="4849140">.</span><span class="ident" id="4849141">tok</span>&nbsp;<span class="op" id="4849145">==</span>&nbsp;<span class="ident" id="4849148">token</span><span class="op" id="4849153">.</span><span class="ident" id="4849154">PERIOD</span>&nbsp;<span class="op" id="4849161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4849165">//&nbsp;ident&nbsp;is&nbsp;a&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849194">p</span><span class="op" id="4849195">.</span><span class="ident" id="4849196">next</span><span class="op" id="4849200">(</span><span class="op" id="4849201">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849205">p</span><span class="op" id="4849206">.</span><span class="ident" id="4849207">resolve</span><span class="op" id="4849214">(</span><span class="ident" id="4849215">ident</span><span class="op" id="4849220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849224">sel</span>&nbsp;<span class="op" id="4849228">:=</span>&nbsp;<span class="ident" id="4849231">p</span><span class="op" id="4849232">.</span><span class="ident" id="4849233">parseIdent</span><span class="op" id="4849243">(</span><span class="op" id="4849244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849248">return</span>&nbsp;<span class="op" id="4849255">&amp;</span><span class="ident" id="4849256">ast</span><span class="op" id="4849259">.</span><span class="ident" id="4849260">SelectorExpr</span><span class="op" id="4849272">{</span><span class="ident" id="4849273">X</span><span class="op" id="4849274">:</span>&nbsp;<span class="ident" id="4849276">ident</span><span class="op" id="4849281">,</span>&nbsp;<span class="ident" id="4849283">Sel</span><span class="op" id="4849286">:</span>&nbsp;<span class="ident" id="4849288">sel</span><span class="op" id="4849291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849298">return</span>&nbsp;<span class="ident" id="4849305">ident</span><br>
<span class="lineno"></span><span class="op" id="4849311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849314">func</span>&nbsp;<span class="op" id="4849319">(</span><span class="ident" id="4849320">p</span>&nbsp;<span class="op" id="4849322">*</span><span class="ident" id="4849323">parser</span><span class="op" id="4849329">)</span>&nbsp;<span class="ident" id="4849331">parseArrayType</span><span class="op" id="4849345">(</span><span class="op" id="4849346">)</span>&nbsp;<span class="ident" id="4849348">ast</span><span class="op" id="4849351">.</span><span class="ident" id="4849352">Expr</span>&nbsp;<span class="op" id="4849357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849360">if</span>&nbsp;<span class="ident" id="4849363">p</span><span class="op" id="4849364">.</span><span class="ident" id="4849365">trace</span>&nbsp;<span class="op" id="4849371">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849375">defer</span>&nbsp;<span class="ident" id="4849381">un</span><span class="op" id="4849383">(</span><span class="ident" id="4849384">trace</span><span class="op" id="4849389">(</span><span class="ident" id="4849390">p</span><span class="op" id="4849391">,</span>&nbsp;<span class="string" id="4849393">&#34;ArrayType&#34;</span><span class="op" id="4849404">)</span><span class="op" id="4849405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849412">lbrack</span>&nbsp;<span class="op" id="4849419">:=</span>&nbsp;<span class="ident" id="4849422">p</span><span class="op" id="4849423">.</span><span class="ident" id="4849424">expect</span><span class="op" id="4849430">(</span><span class="ident" id="4849431">token</span><span class="op" id="4849436">.</span><span class="ident" id="4849437">LBRACK</span><span class="op" id="4849443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849446">p</span><span class="op" id="4849447">.</span><span class="ident" id="4849448">exprLev</span><span class="op" id="4849455">++</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849459">var</span>&nbsp;<span class="builtinfunc" id="4849463">len</span>&nbsp;<span class="ident" id="4849467">ast</span><span class="op" id="4849470">.</span><span class="ident" id="4849471">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4849477">//&nbsp;always&nbsp;permit&nbsp;ellipsis&nbsp;for&nbsp;more&nbsp;fault-tolerant&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849536">if</span>&nbsp;<span class="ident" id="4849539">p</span><span class="op" id="4849540">.</span><span class="ident" id="4849541">tok</span>&nbsp;<span class="op" id="4849545">==</span>&nbsp;<span class="ident" id="4849548">token</span><span class="op" id="4849553">.</span><span class="ident" id="4849554">ELLIPSIS</span>&nbsp;<span class="op" id="4849563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4849567">len</span>&nbsp;<span class="op" id="4849571">=</span>&nbsp;<span class="op" id="4849573">&amp;</span><span class="ident" id="4849574">ast</span><span class="op" id="4849577">.</span><span class="ident" id="4849578">Ellipsis</span><span class="op" id="4849586">{</span><span class="ident" id="4849587">Ellipsis</span><span class="op" id="4849595">:</span>&nbsp;<span class="ident" id="4849597">p</span><span class="op" id="4849598">.</span><span class="ident" id="4849599">pos</span><span class="op" id="4849602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849606">p</span><span class="op" id="4849607">.</span><span class="ident" id="4849608">next</span><span class="op" id="4849612">(</span><span class="op" id="4849613">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849616">}</span>&nbsp;<span class="keyword" id="4849618">else</span>&nbsp;<span class="keyword" id="4849623">if</span>&nbsp;<span class="ident" id="4849626">p</span><span class="op" id="4849627">.</span><span class="ident" id="4849628">tok</span>&nbsp;<span class="op" id="4849632">!=</span>&nbsp;<span class="ident" id="4849635">token</span><span class="op" id="4849640">.</span><span class="ident" id="4849641">RBRACK</span>&nbsp;<span class="op" id="4849648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4849652">len</span>&nbsp;<span class="op" id="4849656">=</span>&nbsp;<span class="ident" id="4849658">p</span><span class="op" id="4849659">.</span><span class="ident" id="4849660">parseRhs</span><span class="op" id="4849668">(</span><span class="op" id="4849669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4849672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849675">p</span><span class="op" id="4849676">.</span><span class="ident" id="4849677">exprLev</span><span class="op" id="4849684">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849688">p</span><span class="op" id="4849689">.</span><span class="ident" id="4849690">expect</span><span class="op" id="4849696">(</span><span class="ident" id="4849697">token</span><span class="op" id="4849702">.</span><span class="ident" id="4849703">RBRACK</span><span class="op" id="4849709">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849712">elt</span>&nbsp;<span class="op" id="4849716">:=</span>&nbsp;<span class="ident" id="4849719">p</span><span class="op" id="4849720">.</span><span class="ident" id="4849721">parseType</span><span class="op" id="4849730">(</span><span class="op" id="4849731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849735">return</span>&nbsp;<span class="op" id="4849742">&amp;</span><span class="ident" id="4849743">ast</span><span class="op" id="4849746">.</span><span class="ident" id="4849747">ArrayType</span><span class="op" id="4849756">{</span><span class="ident" id="4849757">Lbrack</span><span class="op" id="4849763">:</span>&nbsp;<span class="ident" id="4849765">lbrack</span><span class="op" id="4849771">,</span>&nbsp;<span class="ident" id="4849773">Len</span><span class="op" id="4849776">:</span>&nbsp;<span class="builtinfunc" id="4849778">len</span><span class="op" id="4849781">,</span>&nbsp;<span class="ident" id="4849783">Elt</span><span class="op" id="4849786">:</span>&nbsp;<span class="ident" id="4849788">elt</span><span class="op" id="4849791">}</span><br>
<span class="lineno"></span><span class="op" id="4849793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">660</span><span class="keyword" id="4849796">func</span>&nbsp;<span class="op" id="4849801">(</span><span class="ident" id="4849802">p</span>&nbsp;<span class="op" id="4849804">*</span><span class="ident" id="4849805">parser</span><span class="op" id="4849811">)</span>&nbsp;<span class="ident" id="4849813">makeIdentList</span><span class="op" id="4849826">(</span><span class="ident" id="4849827">list</span>&nbsp;<span class="op" id="4849832">[</span><span class="op" id="4849833">]</span><span class="ident" id="4849834">ast</span><span class="op" id="4849837">.</span><span class="ident" id="4849838">Expr</span><span class="op" id="4849842">)</span>&nbsp;<span class="op" id="4849844">[</span><span class="op" id="4849845">]</span><span class="op" id="4849846">*</span><span class="ident" id="4849847">ast</span><span class="op" id="4849850">.</span><span class="ident" id="4849851">Ident</span>&nbsp;<span class="op" id="4849857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849860">idents</span>&nbsp;<span class="op" id="4849867">:=</span>&nbsp;<span class="builtinfunc" id="4849870">make</span><span class="op" id="4849874">(</span><span class="op" id="4849875">[</span><span class="op" id="4849876">]</span><span class="op" id="4849877">*</span><span class="ident" id="4849878">ast</span><span class="op" id="4849881">.</span><span class="ident" id="4849882">Ident</span><span class="op" id="4849887">,</span>&nbsp;<span class="builtinfunc" id="4849889">len</span><span class="op" id="4849892">(</span><span class="ident" id="4849893">list</span><span class="op" id="4849897">)</span><span class="op" id="4849898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849901">for</span>&nbsp;<span class="ident" id="4849905">i</span><span class="op" id="4849906">,</span>&nbsp;<span class="ident" id="4849908">x</span>&nbsp;<span class="op" id="4849910">:=</span>&nbsp;<span class="keyword" id="4849913">range</span>&nbsp;<span class="ident" id="4849919">list</span>&nbsp;<span class="op" id="4849924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4849928">ident</span><span class="op" id="4849933">,</span>&nbsp;<span class="ident" id="4849935">isIdent</span>&nbsp;<span class="op" id="4849943">:=</span>&nbsp;<span class="ident" id="4849946">x</span><span class="op" id="4849947">.</span><span class="op" id="4849948">(</span><span class="op" id="4849949">*</span><span class="ident" id="4849950">ast</span><span class="op" id="4849953">.</span><span class="ident" id="4849954">Ident</span><span class="op" id="4849959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849963">if</span>&nbsp;<span class="op" id="4849966">!</span><span class="ident" id="4849967">isIdent</span>&nbsp;<span class="op" id="4849975">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4849980">if</span>&nbsp;<span class="ident" id="4849983">_</span><span class="op" id="4849984">,</span>&nbsp;<span class="ident" id="4849986">isBad</span>&nbsp;<span class="op" id="4849992">:=</span>&nbsp;<span class="ident" id="4849995">x</span><span class="op" id="4849996">.</span><span class="op" id="4849997">(</span><span class="op" id="4849998">*</span><span class="ident" id="4849999">ast</span><span class="op" id="4850002">.</span><span class="ident" id="4850003">BadExpr</span><span class="op" id="4850010">)</span><span class="op" id="4850011">;</span>&nbsp;<span class="op" id="4850013">!</span><span class="ident" id="4850014">isBad</span>&nbsp;<span class="op" id="4850020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850026">//&nbsp;only&nbsp;report&nbsp;error&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;new&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850069">p</span><span class="op" id="4850070">.</span><span class="ident" id="4850071">errorExpected</span><span class="op" id="4850084">(</span><span class="ident" id="4850085">x</span><span class="op" id="4850086">.</span><span class="ident" id="4850087">Pos</span><span class="op" id="4850090">(</span><span class="op" id="4850091">)</span><span class="op" id="4850092">,</span>&nbsp;<span class="string" id="4850094">&#34;identifier&#34;</span><span class="op" id="4850106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850116">ident</span>&nbsp;<span class="op" id="4850122">=</span>&nbsp;<span class="op" id="4850124">&amp;</span><span class="ident" id="4850125">ast</span><span class="op" id="4850128">.</span><span class="ident" id="4850129">Ident</span><span class="op" id="4850134">{</span><span class="ident" id="4850135">NamePos</span><span class="op" id="4850142">:</span>&nbsp;<span class="ident" id="4850144">x</span><span class="op" id="4850145">.</span><span class="ident" id="4850146">Pos</span><span class="op" id="4850149">(</span><span class="op" id="4850150">)</span><span class="op" id="4850151">,</span>&nbsp;<span class="ident" id="4850153">Name</span><span class="op" id="4850157">:</span>&nbsp;<span class="string" id="4850159">&#34;_&#34;</span><span class="op" id="4850162">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850170">idents</span><span class="op" id="4850176">[</span><span class="ident" id="4850177">i</span><span class="op" id="4850178">]</span>&nbsp;<span class="op" id="4850180">=</span>&nbsp;<span class="ident" id="4850182">ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850192">return</span>&nbsp;<span class="ident" id="4850199">idents</span><br>
<span class="lineno"></span><span class="op" id="4850206">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="keyword" id="4850209">func</span>&nbsp;<span class="op" id="4850214">(</span><span class="ident" id="4850215">p</span>&nbsp;<span class="op" id="4850217">*</span><span class="ident" id="4850218">parser</span><span class="op" id="4850224">)</span>&nbsp;<span class="ident" id="4850226">parseFieldDecl</span><span class="op" id="4850240">(</span><span class="ident" id="4850241">scope</span>&nbsp;<span class="op" id="4850247">*</span><span class="ident" id="4850248">ast</span><span class="op" id="4850251">.</span><span class="ident" id="4850252">Scope</span><span class="op" id="4850257">)</span>&nbsp;<span class="op" id="4850259">*</span><span class="ident" id="4850260">ast</span><span class="op" id="4850263">.</span><span class="ident" id="4850264">Field</span>&nbsp;<span class="op" id="4850270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850273">if</span>&nbsp;<span class="ident" id="4850276">p</span><span class="op" id="4850277">.</span><span class="ident" id="4850278">trace</span>&nbsp;<span class="op" id="4850284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850288">defer</span>&nbsp;<span class="ident" id="4850294">un</span><span class="op" id="4850296">(</span><span class="ident" id="4850297">trace</span><span class="op" id="4850302">(</span><span class="ident" id="4850303">p</span><span class="op" id="4850304">,</span>&nbsp;<span class="string" id="4850306">&#34;FieldDecl&#34;</span><span class="op" id="4850317">)</span><span class="op" id="4850318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850321">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850325">doc</span>&nbsp;<span class="op" id="4850329">:=</span>&nbsp;<span class="ident" id="4850332">p</span><span class="op" id="4850333">.</span><span class="ident" id="4850334">leadComment</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850348">//&nbsp;FieldDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850362">list</span><span class="op" id="4850366">,</span>&nbsp;<span class="ident" id="4850368">typ</span>&nbsp;<span class="op" id="4850372">:=</span>&nbsp;<span class="ident" id="4850375">p</span><span class="op" id="4850376">.</span><span class="ident" id="4850377">parseVarList</span><span class="op" id="4850389">(</span><span class="builtintype" id="4850390">false</span><span class="op" id="4850395">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850399">//&nbsp;Tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850407">var</span>&nbsp;<span class="ident" id="4850411">tag</span>&nbsp;<span class="op" id="4850415">*</span><span class="ident" id="4850416">ast</span><span class="op" id="4850419">.</span><span class="ident" id="4850420">BasicLit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850430">if</span>&nbsp;<span class="ident" id="4850433">p</span><span class="op" id="4850434">.</span><span class="ident" id="4850435">tok</span>&nbsp;<span class="op" id="4850439">==</span>&nbsp;<span class="ident" id="4850442">token</span><span class="op" id="4850447">.</span><span class="ident" id="4850448">STRING</span>&nbsp;<span class="op" id="4850455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850459">tag</span>&nbsp;<span class="op" id="4850463">=</span>&nbsp;<span class="op" id="4850465">&amp;</span><span class="ident" id="4850466">ast</span><span class="op" id="4850469">.</span><span class="ident" id="4850470">BasicLit</span><span class="op" id="4850478">{</span><span class="ident" id="4850479">ValuePos</span><span class="op" id="4850487">:</span>&nbsp;<span class="ident" id="4850489">p</span><span class="op" id="4850490">.</span><span class="ident" id="4850491">pos</span><span class="op" id="4850494">,</span>&nbsp;<span class="ident" id="4850496">Kind</span><span class="op" id="4850500">:</span>&nbsp;<span class="ident" id="4850502">p</span><span class="op" id="4850503">.</span><span class="ident" id="4850504">tok</span><span class="op" id="4850507">,</span>&nbsp;<span class="ident" id="4850509">Value</span><span class="op" id="4850514">:</span>&nbsp;<span class="ident" id="4850516">p</span><span class="op" id="4850517">.</span><span class="ident" id="4850518">lit</span><span class="op" id="4850521">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850525">p</span><span class="op" id="4850526">.</span><span class="ident" id="4850527">next</span><span class="op" id="4850531">(</span><span class="op" id="4850532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850539">//&nbsp;analyze&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850556">var</span>&nbsp;<span class="ident" id="4850560">idents</span>&nbsp;<span class="op" id="4850567">[</span><span class="op" id="4850568">]</span><span class="op" id="4850569">*</span><span class="ident" id="4850570">ast</span><span class="op" id="4850573">.</span><span class="ident" id="4850574">Ident</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850581">if</span>&nbsp;<span class="ident" id="4850584">typ</span>&nbsp;<span class="op" id="4850588">!=</span>&nbsp;<span class="builtintype" id="4850591">nil</span>&nbsp;<span class="op" id="4850595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850599">//&nbsp;IdentifierList&nbsp;Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850624">idents</span>&nbsp;<span class="op" id="4850631">=</span>&nbsp;<span class="ident" id="4850633">p</span><span class="op" id="4850634">.</span><span class="ident" id="4850635">makeIdentList</span><span class="op" id="4850648">(</span><span class="ident" id="4850649">list</span><span class="op" id="4850653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850656">}</span>&nbsp;<span class="keyword" id="4850658">else</span>&nbsp;<span class="op" id="4850663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4850667">//&nbsp;[&#34;*&#34;]&nbsp;TypeName&nbsp;(AnonymousField)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850704">typ</span>&nbsp;<span class="op" id="4850708">=</span>&nbsp;<span class="ident" id="4850710">list</span><span class="op" id="4850714">[</span><span class="num" id="4850715">0</span><span class="op" id="4850716">]</span>&nbsp;<span class="comment" id="4850718">//&nbsp;we&nbsp;always&nbsp;have&nbsp;at&nbsp;least&nbsp;one&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4850759">if</span>&nbsp;<span class="ident" id="4850762">n</span>&nbsp;<span class="op" id="4850764">:=</span>&nbsp;<span class="builtinfunc" id="4850767">len</span><span class="op" id="4850770">(</span><span class="ident" id="4850771">list</span><span class="op" id="4850775">)</span><span class="op" id="4850776">;</span>&nbsp;<span class="ident" id="4850778">n</span>&nbsp;<span class="op" id="4850780">&gt;</span>&nbsp;<span class="num" id="4850782">1</span>&nbsp;<span class="op" id="4850784">||</span>&nbsp;<span class="op" id="4850787">!</span><span class="ident" id="4850788">isTypeName</span><span class="op" id="4850798">(</span><span class="ident" id="4850799">deref</span><span class="op" id="4850804">(</span><span class="ident" id="4850805">typ</span><span class="op" id="4850808">)</span><span class="op" id="4850809">)</span>&nbsp;<span class="op" id="4850811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850816">pos</span>&nbsp;<span class="op" id="4850820">:=</span>&nbsp;<span class="ident" id="4850823">typ</span><span class="op" id="4850826">.</span><span class="ident" id="4850827">Pos</span><span class="op" id="4850830">(</span><span class="op" id="4850831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850836">p</span><span class="op" id="4850837">.</span><span class="ident" id="4850838">errorExpected</span><span class="op" id="4850851">(</span><span class="ident" id="4850852">pos</span><span class="op" id="4850855">,</span>&nbsp;<span class="string" id="4850857">&#34;anonymous&nbsp;field&#34;</span><span class="op" id="4850874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850879">typ</span>&nbsp;<span class="op" id="4850883">=</span>&nbsp;<span class="op" id="4850885">&amp;</span><span class="ident" id="4850886">ast</span><span class="op" id="4850889">.</span><span class="ident" id="4850890">BadExpr</span><span class="op" id="4850897">{</span><span class="ident" id="4850898">From</span><span class="op" id="4850902">:</span>&nbsp;<span class="ident" id="4850904">pos</span><span class="op" id="4850907">,</span>&nbsp;<span class="ident" id="4850909">To</span><span class="op" id="4850911">:</span>&nbsp;<span class="ident" id="4850913">p</span><span class="op" id="4850914">.</span><span class="ident" id="4850915">safePos</span><span class="op" id="4850922">(</span><span class="ident" id="4850923">list</span><span class="op" id="4850927">[</span><span class="ident" id="4850928">n</span><span class="op" id="4850929">-</span><span class="num" id="4850930">1</span><span class="op" id="4850931">]</span><span class="op" id="4850932">.</span><span class="ident" id="4850933">End</span><span class="op" id="4850936">(</span><span class="op" id="4850937">)</span><span class="op" id="4850938">)</span><span class="op" id="4850939">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4850946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4850950">p</span><span class="op" id="4850951">.</span><span class="ident" id="4850952">expectSemi</span><span class="op" id="4850962">(</span><span class="op" id="4850963">)</span>&nbsp;<span class="comment" id="4850965">//&nbsp;call&nbsp;before&nbsp;accessing&nbsp;p.linecomment</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851006">field</span>&nbsp;<span class="op" id="4851012">:=</span>&nbsp;<span class="op" id="4851015">&amp;</span><span class="ident" id="4851016">ast</span><span class="op" id="4851019">.</span><span class="ident" id="4851020">Field</span><span class="op" id="4851025">{</span><span class="ident" id="4851026">Doc</span><span class="op" id="4851029">:</span>&nbsp;<span class="ident" id="4851031">doc</span><span class="op" id="4851034">,</span>&nbsp;<span class="ident" id="4851036">Names</span><span class="op" id="4851041">:</span>&nbsp;<span class="ident" id="4851043">idents</span><span class="op" id="4851049">,</span>&nbsp;<span class="ident" id="4851051">Type</span><span class="op" id="4851055">:</span>&nbsp;<span class="ident" id="4851057">typ</span><span class="op" id="4851060">,</span>&nbsp;<span class="ident" id="4851062">Tag</span><span class="op" id="4851065">:</span>&nbsp;<span class="ident" id="4851067">tag</span><span class="op" id="4851070">,</span>&nbsp;<span class="ident" id="4851072">Comment</span><span class="op" id="4851079">:</span>&nbsp;<span class="ident" id="4851081">p</span><span class="op" id="4851082">.</span><span class="ident" id="4851083">lineComment</span><span class="op" id="4851094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851097">p</span><span class="op" id="4851098">.</span><span class="ident" id="4851099">declare</span><span class="op" id="4851106">(</span><span class="ident" id="4851107">field</span><span class="op" id="4851112">,</span>&nbsp;<span class="builtintype" id="4851114">nil</span><span class="op" id="4851117">,</span>&nbsp;<span class="ident" id="4851119">scope</span><span class="op" id="4851124">,</span>&nbsp;<span class="ident" id="4851126">ast</span><span class="op" id="4851129">.</span><span class="ident" id="4851130">Var</span><span class="op" id="4851133">,</span>&nbsp;<span class="ident" id="4851135">idents</span><span class="op" id="4851141">...</span><span class="op" id="4851144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851147">p</span><span class="op" id="4851148">.</span><span class="ident" id="4851149">resolve</span><span class="op" id="4851156">(</span><span class="ident" id="4851157">typ</span><span class="op" id="4851160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851164">return</span>&nbsp;<span class="ident" id="4851171">field</span><br>
<span class="lineno">715</span><span class="op" id="4851177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4851180">func</span>&nbsp;<span class="op" id="4851185">(</span><span class="ident" id="4851186">p</span>&nbsp;<span class="op" id="4851188">*</span><span class="ident" id="4851189">parser</span><span class="op" id="4851195">)</span>&nbsp;<span class="ident" id="4851197">parseStructType</span><span class="op" id="4851212">(</span><span class="op" id="4851213">)</span>&nbsp;<span class="op" id="4851215">*</span><span class="ident" id="4851216">ast</span><span class="op" id="4851219">.</span><span class="ident" id="4851220">StructType</span>&nbsp;<span class="op" id="4851231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851234">if</span>&nbsp;<span class="ident" id="4851237">p</span><span class="op" id="4851238">.</span><span class="ident" id="4851239">trace</span>&nbsp;<span class="op" id="4851245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851249">defer</span>&nbsp;<span class="ident" id="4851255">un</span><span class="op" id="4851257">(</span><span class="ident" id="4851258">trace</span><span class="op" id="4851263">(</span><span class="ident" id="4851264">p</span><span class="op" id="4851265">,</span>&nbsp;<span class="string" id="4851267">&#34;StructType&#34;</span><span class="op" id="4851279">)</span><span class="op" id="4851280">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4851283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851287">pos</span>&nbsp;<span class="op" id="4851291">:=</span>&nbsp;<span class="ident" id="4851294">p</span><span class="op" id="4851295">.</span><span class="ident" id="4851296">expect</span><span class="op" id="4851302">(</span><span class="ident" id="4851303">token</span><span class="op" id="4851308">.</span><span class="ident" id="4851309">STRUCT</span><span class="op" id="4851315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851318">lbrace</span>&nbsp;<span class="op" id="4851325">:=</span>&nbsp;<span class="ident" id="4851328">p</span><span class="op" id="4851329">.</span><span class="ident" id="4851330">expect</span><span class="op" id="4851336">(</span><span class="ident" id="4851337">token</span><span class="op" id="4851342">.</span><span class="ident" id="4851343">LBRACE</span><span class="op" id="4851349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851352">scope</span>&nbsp;<span class="op" id="4851358">:=</span>&nbsp;<span class="ident" id="4851361">ast</span><span class="op" id="4851364">.</span><span class="ident" id="4851365">NewScope</span><span class="op" id="4851373">(</span><span class="builtintype" id="4851374">nil</span><span class="op" id="4851377">)</span>&nbsp;<span class="comment" id="4851379">//&nbsp;struct&nbsp;scope</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851396">var</span>&nbsp;<span class="ident" id="4851400">list</span>&nbsp;<span class="op" id="4851405">[</span><span class="op" id="4851406">]</span><span class="op" id="4851407">*</span><span class="ident" id="4851408">ast</span><span class="op" id="4851411">.</span><span class="ident" id="4851412">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851419">for</span>&nbsp;<span class="ident" id="4851423">p</span><span class="op" id="4851424">.</span><span class="ident" id="4851425">tok</span>&nbsp;<span class="op" id="4851429">==</span>&nbsp;<span class="ident" id="4851432">token</span><span class="op" id="4851437">.</span><span class="ident" id="4851438">IDENT</span>&nbsp;<span class="op" id="4851444">||</span>&nbsp;<span class="ident" id="4851447">p</span><span class="op" id="4851448">.</span><span class="ident" id="4851449">tok</span>&nbsp;<span class="op" id="4851453">==</span>&nbsp;<span class="ident" id="4851456">token</span><span class="op" id="4851461">.</span><span class="ident" id="4851462">MUL</span>&nbsp;<span class="op" id="4851466">||</span>&nbsp;<span class="ident" id="4851469">p</span><span class="op" id="4851470">.</span><span class="ident" id="4851471">tok</span>&nbsp;<span class="op" id="4851475">==</span>&nbsp;<span class="ident" id="4851478">token</span><span class="op" id="4851483">.</span><span class="ident" id="4851484">LPAREN</span>&nbsp;<span class="op" id="4851491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4851495">//&nbsp;a&nbsp;field&nbsp;declaration&nbsp;cannot&nbsp;start&nbsp;with&nbsp;a&nbsp;&#39;(&#39;&nbsp;but&nbsp;we&nbsp;accept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4851558">//&nbsp;it&nbsp;here&nbsp;for&nbsp;more&nbsp;robust&nbsp;parsing&nbsp;and&nbsp;better&nbsp;error&nbsp;messages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4851621">//&nbsp;(parseFieldDecl&nbsp;will&nbsp;check&nbsp;and&nbsp;complain&nbsp;if&nbsp;necessary)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851680">list</span>&nbsp;<span class="op" id="4851685">=</span>&nbsp;<span class="builtinfunc" id="4851687">append</span><span class="op" id="4851693">(</span><span class="ident" id="4851694">list</span><span class="op" id="4851698">,</span>&nbsp;<span class="ident" id="4851700">p</span><span class="op" id="4851701">.</span><span class="ident" id="4851702">parseFieldDecl</span><span class="op" id="4851716">(</span><span class="ident" id="4851717">scope</span><span class="op" id="4851722">)</span><span class="op" id="4851723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4851726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851729">rbrace</span>&nbsp;<span class="op" id="4851736">:=</span>&nbsp;<span class="ident" id="4851739">p</span><span class="op" id="4851740">.</span><span class="ident" id="4851741">expect</span><span class="op" id="4851747">(</span><span class="ident" id="4851748">token</span><span class="op" id="4851753">.</span><span class="ident" id="4851754">RBRACE</span><span class="op" id="4851760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851764">return</span>&nbsp;<span class="op" id="4851771">&amp;</span><span class="ident" id="4851772">ast</span><span class="op" id="4851775">.</span><span class="ident" id="4851776">StructType</span><span class="op" id="4851786">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851790">Struct</span><span class="op" id="4851796">:</span>&nbsp;<span class="ident" id="4851798">pos</span><span class="op" id="4851801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851805">Fields</span><span class="op" id="4851811">:</span>&nbsp;<span class="op" id="4851813">&amp;</span><span class="ident" id="4851814">ast</span><span class="op" id="4851817">.</span><span class="ident" id="4851818">FieldList</span><span class="op" id="4851827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851832">Opening</span><span class="op" id="4851839">:</span>&nbsp;<span class="ident" id="4851841">lbrace</span><span class="op" id="4851847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851852">List</span><span class="op" id="4851856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851861">list</span><span class="op" id="4851865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4851870">Closing</span><span class="op" id="4851877">:</span>&nbsp;<span class="ident" id="4851879">rbrace</span><span class="op" id="4851885">,</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4851889">}</span><span class="op" id="4851890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4851893">}</span><br>
<span class="lineno"></span><span class="op" id="4851895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4851898">func</span>&nbsp;<span class="op" id="4851903">(</span><span class="ident" id="4851904">p</span>&nbsp;<span class="op" id="4851906">*</span><span class="ident" id="4851907">parser</span><span class="op" id="4851913">)</span>&nbsp;<span class="ident" id="4851915">parsePointerType</span><span class="op" id="4851931">(</span><span class="op" id="4851932">)</span>&nbsp;<span class="op" id="4851934">*</span><span class="ident" id="4851935">ast</span><span class="op" id="4851938">.</span><span class="ident" id="4851939">StarExpr</span>&nbsp;<span class="op" id="4851948">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851951">if</span>&nbsp;<span class="ident" id="4851954">p</span><span class="op" id="4851955">.</span><span class="ident" id="4851956">trace</span>&nbsp;<span class="op" id="4851962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4851966">defer</span>&nbsp;<span class="ident" id="4851972">un</span><span class="op" id="4851974">(</span><span class="ident" id="4851975">trace</span><span class="op" id="4851980">(</span><span class="ident" id="4851981">p</span><span class="op" id="4851982">,</span>&nbsp;<span class="string" id="4851984">&#34;PointerType&#34;</span><span class="op" id="4851997">)</span><span class="op" id="4851998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852005">star</span>&nbsp;<span class="op" id="4852010">:=</span>&nbsp;<span class="ident" id="4852013">p</span><span class="op" id="4852014">.</span><span class="ident" id="4852015">expect</span><span class="op" id="4852021">(</span><span class="ident" id="4852022">token</span><span class="op" id="4852027">.</span><span class="ident" id="4852028">MUL</span><span class="op" id="4852031">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852034">base</span>&nbsp;<span class="op" id="4852039">:=</span>&nbsp;<span class="ident" id="4852042">p</span><span class="op" id="4852043">.</span><span class="ident" id="4852044">parseType</span><span class="op" id="4852053">(</span><span class="op" id="4852054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852058">return</span>&nbsp;<span class="op" id="4852065">&amp;</span><span class="ident" id="4852066">ast</span><span class="op" id="4852069">.</span><span class="ident" id="4852070">StarExpr</span><span class="op" id="4852078">{</span><span class="ident" id="4852079">Star</span><span class="op" id="4852083">:</span>&nbsp;<span class="ident" id="4852085">star</span><span class="op" id="4852089">,</span>&nbsp;<span class="ident" id="4852091">X</span><span class="op" id="4852092">:</span>&nbsp;<span class="ident" id="4852094">base</span><span class="op" id="4852098">}</span><br>
<span class="lineno"></span><span class="op" id="4852100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="comment" id="4852103">//&nbsp;If&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4852158">func</span>&nbsp;<span class="op" id="4852163">(</span><span class="ident" id="4852164">p</span>&nbsp;<span class="op" id="4852166">*</span><span class="ident" id="4852167">parser</span><span class="op" id="4852173">)</span>&nbsp;<span class="ident" id="4852175">tryVarType</span><span class="op" id="4852185">(</span><span class="ident" id="4852186">isParam</span>&nbsp;<span class="builtintype" id="4852194">bool</span><span class="op" id="4852198">)</span>&nbsp;<span class="ident" id="4852200">ast</span><span class="op" id="4852203">.</span><span class="ident" id="4852204">Expr</span>&nbsp;<span class="op" id="4852209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852212">if</span>&nbsp;<span class="ident" id="4852215">isParam</span>&nbsp;<span class="op" id="4852223">&amp;&amp;</span>&nbsp;<span class="ident" id="4852226">p</span><span class="op" id="4852227">.</span><span class="ident" id="4852228">tok</span>&nbsp;<span class="op" id="4852232">==</span>&nbsp;<span class="ident" id="4852235">token</span><span class="op" id="4852240">.</span><span class="ident" id="4852241">ELLIPSIS</span>&nbsp;<span class="op" id="4852250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852254">pos</span>&nbsp;<span class="op" id="4852258">:=</span>&nbsp;<span class="ident" id="4852261">p</span><span class="op" id="4852262">.</span><span class="ident" id="4852263">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852269">p</span><span class="op" id="4852270">.</span><span class="ident" id="4852271">next</span><span class="op" id="4852275">(</span><span class="op" id="4852276">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852280">typ</span>&nbsp;<span class="op" id="4852284">:=</span>&nbsp;<span class="ident" id="4852287">p</span><span class="op" id="4852288">.</span><span class="ident" id="4852289">tryIdentOrType</span><span class="op" id="4852303">(</span><span class="op" id="4852304">)</span>&nbsp;<span class="comment" id="4852306">//&nbsp;don&#39;t&nbsp;use&nbsp;parseType&nbsp;so&nbsp;we&nbsp;can&nbsp;provide&nbsp;better&nbsp;error&nbsp;message</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852370">if</span>&nbsp;<span class="ident" id="4852373">typ</span>&nbsp;<span class="op" id="4852377">!=</span>&nbsp;<span class="builtintype" id="4852380">nil</span>&nbsp;<span class="op" id="4852384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852389">p</span><span class="op" id="4852390">.</span><span class="ident" id="4852391">resolve</span><span class="op" id="4852398">(</span><span class="ident" id="4852399">typ</span><span class="op" id="4852402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852406">}</span>&nbsp;<span class="keyword" id="4852408">else</span>&nbsp;<span class="op" id="4852413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852418">p</span><span class="op" id="4852419">.</span><span class="builtintype" id="4852420">error</span><span class="op" id="4852425">(</span><span class="ident" id="4852426">pos</span><span class="op" id="4852429">,</span>&nbsp;<span class="string" id="4852431">&#34;&#39;...&#39;&nbsp;parameter&nbsp;is&nbsp;missing&nbsp;type&#34;</span><span class="op" id="4852464">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852469">typ</span>&nbsp;<span class="op" id="4852473">=</span>&nbsp;<span class="op" id="4852475">&amp;</span><span class="ident" id="4852476">ast</span><span class="op" id="4852479">.</span><span class="ident" id="4852480">BadExpr</span><span class="op" id="4852487">{</span><span class="ident" id="4852488">From</span><span class="op" id="4852492">:</span>&nbsp;<span class="ident" id="4852494">pos</span><span class="op" id="4852497">,</span>&nbsp;<span class="ident" id="4852499">To</span><span class="op" id="4852501">:</span>&nbsp;<span class="ident" id="4852503">p</span><span class="op" id="4852504">.</span><span class="ident" id="4852505">pos</span><span class="op" id="4852508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852516">return</span>&nbsp;<span class="op" id="4852523">&amp;</span><span class="ident" id="4852524">ast</span><span class="op" id="4852527">.</span><span class="ident" id="4852528">Ellipsis</span><span class="op" id="4852536">{</span><span class="ident" id="4852537">Ellipsis</span><span class="op" id="4852545">:</span>&nbsp;<span class="ident" id="4852547">pos</span><span class="op" id="4852550">,</span>&nbsp;<span class="ident" id="4852552">Elt</span><span class="op" id="4852555">:</span>&nbsp;<span class="ident" id="4852557">typ</span><span class="op" id="4852560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852566">return</span>&nbsp;<span class="ident" id="4852573">p</span><span class="op" id="4852574">.</span><span class="ident" id="4852575">tryIdentOrType</span><span class="op" id="4852589">(</span><span class="op" id="4852590">)</span><br>
<span class="lineno">770</span><span class="op" id="4852592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852595">//&nbsp;If&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4852650">func</span>&nbsp;<span class="op" id="4852655">(</span><span class="ident" id="4852656">p</span>&nbsp;<span class="op" id="4852658">*</span><span class="ident" id="4852659">parser</span><span class="op" id="4852665">)</span>&nbsp;<span class="ident" id="4852667">parseVarType</span><span class="op" id="4852679">(</span><span class="ident" id="4852680">isParam</span>&nbsp;<span class="builtintype" id="4852688">bool</span><span class="op" id="4852692">)</span>&nbsp;<span class="ident" id="4852694">ast</span><span class="op" id="4852697">.</span><span class="ident" id="4852698">Expr</span>&nbsp;<span class="op" id="4852703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852706">typ</span>&nbsp;<span class="op" id="4852710">:=</span>&nbsp;<span class="ident" id="4852713">p</span><span class="op" id="4852714">.</span><span class="ident" id="4852715">tryVarType</span><span class="op" id="4852725">(</span><span class="ident" id="4852726">isParam</span><span class="op" id="4852733">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852736">if</span>&nbsp;<span class="ident" id="4852739">typ</span>&nbsp;<span class="op" id="4852743">==</span>&nbsp;<span class="builtintype" id="4852746">nil</span>&nbsp;<span class="op" id="4852750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852754">pos</span>&nbsp;<span class="op" id="4852758">:=</span>&nbsp;<span class="ident" id="4852761">p</span><span class="op" id="4852762">.</span><span class="ident" id="4852763">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852769">p</span><span class="op" id="4852770">.</span><span class="ident" id="4852771">errorExpected</span><span class="op" id="4852784">(</span><span class="ident" id="4852785">pos</span><span class="op" id="4852788">,</span>&nbsp;<span class="string" id="4852790">&#34;type&#34;</span><span class="op" id="4852796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852800">p</span><span class="op" id="4852801">.</span><span class="ident" id="4852802">next</span><span class="op" id="4852806">(</span><span class="op" id="4852807">)</span>&nbsp;<span class="comment" id="4852809">//&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852828">typ</span>&nbsp;<span class="op" id="4852832">=</span>&nbsp;<span class="op" id="4852834">&amp;</span><span class="ident" id="4852835">ast</span><span class="op" id="4852838">.</span><span class="ident" id="4852839">BadExpr</span><span class="op" id="4852846">{</span><span class="ident" id="4852847">From</span><span class="op" id="4852851">:</span>&nbsp;<span class="ident" id="4852853">pos</span><span class="op" id="4852856">,</span>&nbsp;<span class="ident" id="4852858">To</span><span class="op" id="4852860">:</span>&nbsp;<span class="ident" id="4852862">p</span><span class="op" id="4852863">.</span><span class="ident" id="4852864">pos</span><span class="op" id="4852867">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852873">return</span>&nbsp;<span class="ident" id="4852880">typ</span><br>
<span class="lineno"></span><span class="op" id="4852884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852887">//&nbsp;If&nbsp;any&nbsp;of&nbsp;the&nbsp;results&nbsp;are&nbsp;identifiers,&nbsp;they&nbsp;are&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno">785</span><span class="keyword" id="4852952">func</span>&nbsp;<span class="op" id="4852957">(</span><span class="ident" id="4852958">p</span>&nbsp;<span class="op" id="4852960">*</span><span class="ident" id="4852961">parser</span><span class="op" id="4852967">)</span>&nbsp;<span class="ident" id="4852969">parseVarList</span><span class="op" id="4852981">(</span><span class="ident" id="4852982">isParam</span>&nbsp;<span class="builtintype" id="4852990">bool</span><span class="op" id="4852994">)</span>&nbsp;<span class="op" id="4852996">(</span><span class="ident" id="4852997">list</span>&nbsp;<span class="op" id="4853002">[</span><span class="op" id="4853003">]</span><span class="ident" id="4853004">ast</span><span class="op" id="4853007">.</span><span class="ident" id="4853008">Expr</span><span class="op" id="4853012">,</span>&nbsp;<span class="ident" id="4853014">typ</span>&nbsp;<span class="ident" id="4853018">ast</span><span class="op" id="4853021">.</span><span class="ident" id="4853022">Expr</span><span class="op" id="4853026">)</span>&nbsp;<span class="op" id="4853028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853031">if</span>&nbsp;<span class="ident" id="4853034">p</span><span class="op" id="4853035">.</span><span class="ident" id="4853036">trace</span>&nbsp;<span class="op" id="4853042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853046">defer</span>&nbsp;<span class="ident" id="4853052">un</span><span class="op" id="4853054">(</span><span class="ident" id="4853055">trace</span><span class="op" id="4853060">(</span><span class="ident" id="4853061">p</span><span class="op" id="4853062">,</span>&nbsp;<span class="string" id="4853064">&#34;VarList&#34;</span><span class="op" id="4853073">)</span><span class="op" id="4853074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853081">//&nbsp;a&nbsp;list&nbsp;of&nbsp;identifiers&nbsp;looks&nbsp;like&nbsp;a&nbsp;list&nbsp;of&nbsp;type&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853139">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853143">//&nbsp;parse/tryVarType&nbsp;accepts&nbsp;any&nbsp;type&nbsp;(including&nbsp;parenthesized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853206">//&nbsp;ones)&nbsp;even&nbsp;though&nbsp;the&nbsp;syntax&nbsp;does&nbsp;not&nbsp;permit&nbsp;them&nbsp;here:&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853269">//&nbsp;accept&nbsp;them&nbsp;all&nbsp;for&nbsp;more&nbsp;robust&nbsp;parsing&nbsp;and&nbsp;complain&nbsp;later</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853332">for</span>&nbsp;<span class="ident" id="4853336">typ</span>&nbsp;<span class="op" id="4853340">:=</span>&nbsp;<span class="ident" id="4853343">p</span><span class="op" id="4853344">.</span><span class="ident" id="4853345">parseVarType</span><span class="op" id="4853357">(</span><span class="ident" id="4853358">isParam</span><span class="op" id="4853365">)</span><span class="op" id="4853366">;</span>&nbsp;<span class="ident" id="4853368">typ</span>&nbsp;<span class="op" id="4853372">!=</span>&nbsp;<span class="builtintype" id="4853375">nil</span><span class="op" id="4853378">;</span>&nbsp;<span class="op" id="4853380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853384">list</span>&nbsp;<span class="op" id="4853389">=</span>&nbsp;<span class="builtinfunc" id="4853391">append</span><span class="op" id="4853397">(</span><span class="ident" id="4853398">list</span><span class="op" id="4853402">,</span>&nbsp;<span class="ident" id="4853404">typ</span><span class="op" id="4853407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853411">if</span>&nbsp;<span class="ident" id="4853414">p</span><span class="op" id="4853415">.</span><span class="ident" id="4853416">tok</span>&nbsp;<span class="op" id="4853420">!=</span>&nbsp;<span class="ident" id="4853423">token</span><span class="op" id="4853428">.</span><span class="ident" id="4853429">COMMA</span>&nbsp;<span class="op" id="4853435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853440">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853448">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853452">p</span><span class="op" id="4853453">.</span><span class="ident" id="4853454">next</span><span class="op" id="4853458">(</span><span class="op" id="4853459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853463">typ</span>&nbsp;<span class="op" id="4853467">=</span>&nbsp;<span class="ident" id="4853469">p</span><span class="op" id="4853470">.</span><span class="ident" id="4853471">tryVarType</span><span class="op" id="4853481">(</span><span class="ident" id="4853482">isParam</span><span class="op" id="4853489">)</span>&nbsp;<span class="comment" id="4853491">//&nbsp;maybe&nbsp;nil&nbsp;as&nbsp;in:&nbsp;func&nbsp;f(int,)&nbsp;{}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853532">//&nbsp;if&nbsp;we&nbsp;had&nbsp;a&nbsp;list&nbsp;of&nbsp;identifiers,&nbsp;it&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;type</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853599">typ</span>&nbsp;<span class="op" id="4853603">=</span>&nbsp;<span class="ident" id="4853605">p</span><span class="op" id="4853606">.</span><span class="ident" id="4853607">tryVarType</span><span class="op" id="4853617">(</span><span class="ident" id="4853618">isParam</span><span class="op" id="4853625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853629">return</span><br>
<span class="lineno"></span><span class="op" id="4853636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span><span class="keyword" id="4853639">func</span>&nbsp;<span class="op" id="4853644">(</span><span class="ident" id="4853645">p</span>&nbsp;<span class="op" id="4853647">*</span><span class="ident" id="4853648">parser</span><span class="op" id="4853654">)</span>&nbsp;<span class="ident" id="4853656">parseParameterList</span><span class="op" id="4853674">(</span><span class="ident" id="4853675">scope</span>&nbsp;<span class="op" id="4853681">*</span><span class="ident" id="4853682">ast</span><span class="op" id="4853685">.</span><span class="ident" id="4853686">Scope</span><span class="op" id="4853691">,</span>&nbsp;<span class="ident" id="4853693">ellipsisOk</span>&nbsp;<span class="builtintype" id="4853704">bool</span><span class="op" id="4853708">)</span>&nbsp;<span class="op" id="4853710">(</span><span class="ident" id="4853711">params</span>&nbsp;<span class="op" id="4853718">[</span><span class="op" id="4853719">]</span><span class="op" id="4853720">*</span><span class="ident" id="4853721">ast</span><span class="op" id="4853724">.</span><span class="ident" id="4853725">Field</span><span class="op" id="4853730">)</span>&nbsp;<span class="op" id="4853732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853735">if</span>&nbsp;<span class="ident" id="4853738">p</span><span class="op" id="4853739">.</span><span class="ident" id="4853740">trace</span>&nbsp;<span class="op" id="4853746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853750">defer</span>&nbsp;<span class="ident" id="4853756">un</span><span class="op" id="4853758">(</span><span class="ident" id="4853759">trace</span><span class="op" id="4853764">(</span><span class="ident" id="4853765">p</span><span class="op" id="4853766">,</span>&nbsp;<span class="string" id="4853768">&#34;ParameterList&#34;</span><span class="op" id="4853783">)</span><span class="op" id="4853784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853791">//&nbsp;ParameterDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853809">list</span><span class="op" id="4853813">,</span>&nbsp;<span class="ident" id="4853815">typ</span>&nbsp;<span class="op" id="4853819">:=</span>&nbsp;<span class="ident" id="4853822">p</span><span class="op" id="4853823">.</span><span class="ident" id="4853824">parseVarList</span><span class="op" id="4853836">(</span><span class="ident" id="4853837">ellipsisOk</span><span class="op" id="4853847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853851">//&nbsp;analyze&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4853868">if</span>&nbsp;<span class="ident" id="4853871">typ</span>&nbsp;<span class="op" id="4853875">!=</span>&nbsp;<span class="builtintype" id="4853878">nil</span>&nbsp;<span class="op" id="4853882">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4853886">//&nbsp;IdentifierList&nbsp;Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853911">idents</span>&nbsp;<span class="op" id="4853918">:=</span>&nbsp;<span class="ident" id="4853921">p</span><span class="op" id="4853922">.</span><span class="ident" id="4853923">makeIdentList</span><span class="op" id="4853936">(</span><span class="ident" id="4853937">list</span><span class="op" id="4853941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853945">field</span>&nbsp;<span class="op" id="4853951">:=</span>&nbsp;<span class="op" id="4853954">&amp;</span><span class="ident" id="4853955">ast</span><span class="op" id="4853958">.</span><span class="ident" id="4853959">Field</span><span class="op" id="4853964">{</span><span class="ident" id="4853965">Names</span><span class="op" id="4853970">:</span>&nbsp;<span class="ident" id="4853972">idents</span><span class="op" id="4853978">,</span>&nbsp;<span class="ident" id="4853980">Type</span><span class="op" id="4853984">:</span>&nbsp;<span class="ident" id="4853986">typ</span><span class="op" id="4853989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853993">params</span>&nbsp;<span class="op" id="4854000">=</span>&nbsp;<span class="builtinfunc" id="4854002">append</span><span class="op" id="4854008">(</span><span class="ident" id="4854009">params</span><span class="op" id="4854015">,</span>&nbsp;<span class="ident" id="4854017">field</span><span class="op" id="4854022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854026">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;an&nbsp;identifier&nbsp;denoting&nbsp;a&nbsp;function</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854087">//&nbsp;parameter&nbsp;or&nbsp;result&nbsp;variable&nbsp;is&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854143">p</span><span class="op" id="4854144">.</span><span class="ident" id="4854145">declare</span><span class="op" id="4854152">(</span><span class="ident" id="4854153">field</span><span class="op" id="4854158">,</span>&nbsp;<span class="builtintype" id="4854160">nil</span><span class="op" id="4854163">,</span>&nbsp;<span class="ident" id="4854165">scope</span><span class="op" id="4854170">,</span>&nbsp;<span class="ident" id="4854172">ast</span><span class="op" id="4854175">.</span><span class="ident" id="4854176">Var</span><span class="op" id="4854179">,</span>&nbsp;<span class="ident" id="4854181">idents</span><span class="op" id="4854187">...</span><span class="op" id="4854190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854194">p</span><span class="op" id="4854195">.</span><span class="ident" id="4854196">resolve</span><span class="op" id="4854203">(</span><span class="ident" id="4854204">typ</span><span class="op" id="4854207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854211">if</span>&nbsp;<span class="op" id="4854214">!</span><span class="ident" id="4854215">p</span><span class="op" id="4854216">.</span><span class="ident" id="4854217">atComma</span><span class="op" id="4854224">(</span><span class="string" id="4854225">&#34;parameter&nbsp;list&#34;</span><span class="op" id="4854241">)</span>&nbsp;<span class="op" id="4854243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854248">return</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854261">p</span><span class="op" id="4854262">.</span><span class="ident" id="4854263">next</span><span class="op" id="4854267">(</span><span class="op" id="4854268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854272">for</span>&nbsp;<span class="ident" id="4854276">p</span><span class="op" id="4854277">.</span><span class="ident" id="4854278">tok</span>&nbsp;<span class="op" id="4854282">!=</span>&nbsp;<span class="ident" id="4854285">token</span><span class="op" id="4854290">.</span><span class="ident" id="4854291">RPAREN</span>&nbsp;<span class="op" id="4854298">&amp;&amp;</span>&nbsp;<span class="ident" id="4854301">p</span><span class="op" id="4854302">.</span><span class="ident" id="4854303">tok</span>&nbsp;<span class="op" id="4854307">!=</span>&nbsp;<span class="ident" id="4854310">token</span><span class="op" id="4854315">.</span><span class="ident" id="4854316">EOF</span>&nbsp;<span class="op" id="4854320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854325">idents</span>&nbsp;<span class="op" id="4854332">:=</span>&nbsp;<span class="ident" id="4854335">p</span><span class="op" id="4854336">.</span><span class="ident" id="4854337">parseIdentList</span><span class="op" id="4854351">(</span><span class="op" id="4854352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854357">typ</span>&nbsp;<span class="op" id="4854361">:=</span>&nbsp;<span class="ident" id="4854364">p</span><span class="op" id="4854365">.</span><span class="ident" id="4854366">parseVarType</span><span class="op" id="4854378">(</span><span class="ident" id="4854379">ellipsisOk</span><span class="op" id="4854389">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854394">field</span>&nbsp;<span class="op" id="4854400">:=</span>&nbsp;<span class="op" id="4854403">&amp;</span><span class="ident" id="4854404">ast</span><span class="op" id="4854407">.</span><span class="ident" id="4854408">Field</span><span class="op" id="4854413">{</span><span class="ident" id="4854414">Names</span><span class="op" id="4854419">:</span>&nbsp;<span class="ident" id="4854421">idents</span><span class="op" id="4854427">,</span>&nbsp;<span class="ident" id="4854429">Type</span><span class="op" id="4854433">:</span>&nbsp;<span class="ident" id="4854435">typ</span><span class="op" id="4854438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854443">params</span>&nbsp;<span class="op" id="4854450">=</span>&nbsp;<span class="builtinfunc" id="4854452">append</span><span class="op" id="4854458">(</span><span class="ident" id="4854459">params</span><span class="op" id="4854465">,</span>&nbsp;<span class="ident" id="4854467">field</span><span class="op" id="4854472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854477">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;an&nbsp;identifier&nbsp;denoting&nbsp;a&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854539">//&nbsp;parameter&nbsp;or&nbsp;result&nbsp;variable&nbsp;is&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854596">p</span><span class="op" id="4854597">.</span><span class="ident" id="4854598">declare</span><span class="op" id="4854605">(</span><span class="ident" id="4854606">field</span><span class="op" id="4854611">,</span>&nbsp;<span class="builtintype" id="4854613">nil</span><span class="op" id="4854616">,</span>&nbsp;<span class="ident" id="4854618">scope</span><span class="op" id="4854623">,</span>&nbsp;<span class="ident" id="4854625">ast</span><span class="op" id="4854628">.</span><span class="ident" id="4854629">Var</span><span class="op" id="4854632">,</span>&nbsp;<span class="ident" id="4854634">idents</span><span class="op" id="4854640">...</span><span class="op" id="4854643">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854648">p</span><span class="op" id="4854649">.</span><span class="ident" id="4854650">resolve</span><span class="op" id="4854657">(</span><span class="ident" id="4854658">typ</span><span class="op" id="4854661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854666">if</span>&nbsp;<span class="op" id="4854669">!</span><span class="ident" id="4854670">p</span><span class="op" id="4854671">.</span><span class="ident" id="4854672">atComma</span><span class="op" id="4854679">(</span><span class="string" id="4854680">&#34;parameter&nbsp;list&#34;</span><span class="op" id="4854696">)</span>&nbsp;<span class="op" id="4854698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854704">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854718">p</span><span class="op" id="4854719">.</span><span class="ident" id="4854720">next</span><span class="op" id="4854724">(</span><span class="op" id="4854725">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854733">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854745">//&nbsp;Type&nbsp;{&nbsp;&#34;,&#34;&nbsp;Type&nbsp;}&nbsp;(anonymous&nbsp;parameters)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854790">params</span>&nbsp;<span class="op" id="4854797">=</span>&nbsp;<span class="builtinfunc" id="4854799">make</span><span class="op" id="4854803">(</span><span class="op" id="4854804">[</span><span class="op" id="4854805">]</span><span class="op" id="4854806">*</span><span class="ident" id="4854807">ast</span><span class="op" id="4854810">.</span><span class="ident" id="4854811">Field</span><span class="op" id="4854816">,</span>&nbsp;<span class="builtinfunc" id="4854818">len</span><span class="op" id="4854821">(</span><span class="ident" id="4854822">list</span><span class="op" id="4854826">)</span><span class="op" id="4854827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854830">for</span>&nbsp;<span class="ident" id="4854834">i</span><span class="op" id="4854835">,</span>&nbsp;<span class="ident" id="4854837">typ</span>&nbsp;<span class="op" id="4854841">:=</span>&nbsp;<span class="keyword" id="4854844">range</span>&nbsp;<span class="ident" id="4854850">list</span>&nbsp;<span class="op" id="4854855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854859">p</span><span class="op" id="4854860">.</span><span class="ident" id="4854861">resolve</span><span class="op" id="4854868">(</span><span class="ident" id="4854869">typ</span><span class="op" id="4854872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854876">params</span><span class="op" id="4854882">[</span><span class="ident" id="4854883">i</span><span class="op" id="4854884">]</span>&nbsp;<span class="op" id="4854886">=</span>&nbsp;<span class="op" id="4854888">&amp;</span><span class="ident" id="4854889">ast</span><span class="op" id="4854892">.</span><span class="ident" id="4854893">Field</span><span class="op" id="4854898">{</span><span class="ident" id="4854899">Type</span><span class="op" id="4854903">:</span>&nbsp;<span class="ident" id="4854905">typ</span><span class="op" id="4854908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854911">}</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854914">return</span><br>
<span class="lineno"></span><span class="op" id="4854921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854924">func</span>&nbsp;<span class="op" id="4854929">(</span><span class="ident" id="4854930">p</span>&nbsp;<span class="op" id="4854932">*</span><span class="ident" id="4854933">parser</span><span class="op" id="4854939">)</span>&nbsp;<span class="ident" id="4854941">parseParameters</span><span class="op" id="4854956">(</span><span class="ident" id="4854957">scope</span>&nbsp;<span class="op" id="4854963">*</span><span class="ident" id="4854964">ast</span><span class="op" id="4854967">.</span><span class="ident" id="4854968">Scope</span><span class="op" id="4854973">,</span>&nbsp;<span class="ident" id="4854975">ellipsisOk</span>&nbsp;<span class="builtintype" id="4854986">bool</span><span class="op" id="4854990">)</span>&nbsp;<span class="op" id="4854992">*</span><span class="ident" id="4854993">ast</span><span class="op" id="4854996">.</span><span class="ident" id="4854997">FieldList</span>&nbsp;<span class="op" id="4855007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855010">if</span>&nbsp;<span class="ident" id="4855013">p</span><span class="op" id="4855014">.</span><span class="ident" id="4855015">trace</span>&nbsp;<span class="op" id="4855021">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855025">defer</span>&nbsp;<span class="ident" id="4855031">un</span><span class="op" id="4855033">(</span><span class="ident" id="4855034">trace</span><span class="op" id="4855039">(</span><span class="ident" id="4855040">p</span><span class="op" id="4855041">,</span>&nbsp;<span class="string" id="4855043">&#34;Parameters&#34;</span><span class="op" id="4855055">)</span><span class="op" id="4855056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855063">var</span>&nbsp;<span class="ident" id="4855067">params</span>&nbsp;<span class="op" id="4855074">[</span><span class="op" id="4855075">]</span><span class="op" id="4855076">*</span><span class="ident" id="4855077">ast</span><span class="op" id="4855080">.</span><span class="ident" id="4855081">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855088">lparen</span>&nbsp;<span class="op" id="4855095">:=</span>&nbsp;<span class="ident" id="4855098">p</span><span class="op" id="4855099">.</span><span class="ident" id="4855100">expect</span><span class="op" id="4855106">(</span><span class="ident" id="4855107">token</span><span class="op" id="4855112">.</span><span class="ident" id="4855113">LPAREN</span><span class="op" id="4855119">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855122">if</span>&nbsp;<span class="ident" id="4855125">p</span><span class="op" id="4855126">.</span><span class="ident" id="4855127">tok</span>&nbsp;<span class="op" id="4855131">!=</span>&nbsp;<span class="ident" id="4855134">token</span><span class="op" id="4855139">.</span><span class="ident" id="4855140">RPAREN</span>&nbsp;<span class="op" id="4855147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855151">params</span>&nbsp;<span class="op" id="4855158">=</span>&nbsp;<span class="ident" id="4855160">p</span><span class="op" id="4855161">.</span><span class="ident" id="4855162">parseParameterList</span><span class="op" id="4855180">(</span><span class="ident" id="4855181">scope</span><span class="op" id="4855186">,</span>&nbsp;<span class="ident" id="4855188">ellipsisOk</span><span class="op" id="4855198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855204">rparen</span>&nbsp;<span class="op" id="4855211">:=</span>&nbsp;<span class="ident" id="4855214">p</span><span class="op" id="4855215">.</span><span class="ident" id="4855216">expect</span><span class="op" id="4855222">(</span><span class="ident" id="4855223">token</span><span class="op" id="4855228">.</span><span class="ident" id="4855229">RPAREN</span><span class="op" id="4855235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855239">return</span>&nbsp;<span class="op" id="4855246">&amp;</span><span class="ident" id="4855247">ast</span><span class="op" id="4855250">.</span><span class="ident" id="4855251">FieldList</span><span class="op" id="4855260">{</span><span class="ident" id="4855261">Opening</span><span class="op" id="4855268">:</span>&nbsp;<span class="ident" id="4855270">lparen</span><span class="op" id="4855276">,</span>&nbsp;<span class="ident" id="4855278">List</span><span class="op" id="4855282">:</span>&nbsp;<span class="ident" id="4855284">params</span><span class="op" id="4855290">,</span>&nbsp;<span class="ident" id="4855292">Closing</span><span class="op" id="4855299">:</span>&nbsp;<span class="ident" id="4855301">rparen</span><span class="op" id="4855307">}</span><br>
<span class="lineno"></span><span class="op" id="4855309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855312">func</span>&nbsp;<span class="op" id="4855317">(</span><span class="ident" id="4855318">p</span>&nbsp;<span class="op" id="4855320">*</span><span class="ident" id="4855321">parser</span><span class="op" id="4855327">)</span>&nbsp;<span class="ident" id="4855329">parseResult</span><span class="op" id="4855340">(</span><span class="ident" id="4855341">scope</span>&nbsp;<span class="op" id="4855347">*</span><span class="ident" id="4855348">ast</span><span class="op" id="4855351">.</span><span class="ident" id="4855352">Scope</span><span class="op" id="4855357">)</span>&nbsp;<span class="op" id="4855359">*</span><span class="ident" id="4855360">ast</span><span class="op" id="4855363">.</span><span class="ident" id="4855364">FieldList</span>&nbsp;<span class="op" id="4855374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855377">if</span>&nbsp;<span class="ident" id="4855380">p</span><span class="op" id="4855381">.</span><span class="ident" id="4855382">trace</span>&nbsp;<span class="op" id="4855388">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855392">defer</span>&nbsp;<span class="ident" id="4855398">un</span><span class="op" id="4855400">(</span><span class="ident" id="4855401">trace</span><span class="op" id="4855406">(</span><span class="ident" id="4855407">p</span><span class="op" id="4855408">,</span>&nbsp;<span class="string" id="4855410">&#34;Result&#34;</span><span class="op" id="4855418">)</span><span class="op" id="4855419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855426">if</span>&nbsp;<span class="ident" id="4855429">p</span><span class="op" id="4855430">.</span><span class="ident" id="4855431">tok</span>&nbsp;<span class="op" id="4855435">==</span>&nbsp;<span class="ident" id="4855438">token</span><span class="op" id="4855443">.</span><span class="ident" id="4855444">LPAREN</span>&nbsp;<span class="op" id="4855451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855455">return</span>&nbsp;<span class="ident" id="4855462">p</span><span class="op" id="4855463">.</span><span class="ident" id="4855464">parseParameters</span><span class="op" id="4855479">(</span><span class="ident" id="4855480">scope</span><span class="op" id="4855485">,</span>&nbsp;<span class="builtintype" id="4855487">false</span><span class="op" id="4855492">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855499">typ</span>&nbsp;<span class="op" id="4855503">:=</span>&nbsp;<span class="ident" id="4855506">p</span><span class="op" id="4855507">.</span><span class="ident" id="4855508">tryType</span><span class="op" id="4855515">(</span><span class="op" id="4855516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855519">if</span>&nbsp;<span class="ident" id="4855522">typ</span>&nbsp;<span class="op" id="4855526">!=</span>&nbsp;<span class="builtintype" id="4855529">nil</span>&nbsp;<span class="op" id="4855533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855537">list</span>&nbsp;<span class="op" id="4855542">:=</span>&nbsp;<span class="builtinfunc" id="4855545">make</span><span class="op" id="4855549">(</span><span class="op" id="4855550">[</span><span class="op" id="4855551">]</span><span class="op" id="4855552">*</span><span class="ident" id="4855553">ast</span><span class="op" id="4855556">.</span><span class="ident" id="4855557">Field</span><span class="op" id="4855562">,</span>&nbsp;<span class="num" id="4855564">1</span><span class="op" id="4855565">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855569">list</span><span class="op" id="4855573">[</span><span class="num" id="4855574">0</span><span class="op" id="4855575">]</span>&nbsp;<span class="op" id="4855577">=</span>&nbsp;<span class="op" id="4855579">&amp;</span><span class="ident" id="4855580">ast</span><span class="op" id="4855583">.</span><span class="ident" id="4855584">Field</span><span class="op" id="4855589">{</span><span class="ident" id="4855590">Type</span><span class="op" id="4855594">:</span>&nbsp;<span class="ident" id="4855596">typ</span><span class="op" id="4855599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855603">return</span>&nbsp;<span class="op" id="4855610">&amp;</span><span class="ident" id="4855611">ast</span><span class="op" id="4855614">.</span><span class="ident" id="4855615">FieldList</span><span class="op" id="4855624">{</span><span class="ident" id="4855625">List</span><span class="op" id="4855629">:</span>&nbsp;<span class="ident" id="4855631">list</span><span class="op" id="4855635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855642">return</span>&nbsp;<span class="builtintype" id="4855649">nil</span><br>
<span class="lineno">890</span><span class="op" id="4855653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855656">func</span>&nbsp;<span class="op" id="4855661">(</span><span class="ident" id="4855662">p</span>&nbsp;<span class="op" id="4855664">*</span><span class="ident" id="4855665">parser</span><span class="op" id="4855671">)</span>&nbsp;<span class="ident" id="4855673">parseSignature</span><span class="op" id="4855687">(</span><span class="ident" id="4855688">scope</span>&nbsp;<span class="op" id="4855694">*</span><span class="ident" id="4855695">ast</span><span class="op" id="4855698">.</span><span class="ident" id="4855699">Scope</span><span class="op" id="4855704">)</span>&nbsp;<span class="op" id="4855706">(</span><span class="ident" id="4855707">params</span><span class="op" id="4855713">,</span>&nbsp;<span class="ident" id="4855715">results</span>&nbsp;<span class="op" id="4855723">*</span><span class="ident" id="4855724">ast</span><span class="op" id="4855727">.</span><span class="ident" id="4855728">FieldList</span><span class="op" id="4855737">)</span>&nbsp;<span class="op" id="4855739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855742">if</span>&nbsp;<span class="ident" id="4855745">p</span><span class="op" id="4855746">.</span><span class="ident" id="4855747">trace</span>&nbsp;<span class="op" id="4855753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855757">defer</span>&nbsp;<span class="ident" id="4855763">un</span><span class="op" id="4855765">(</span><span class="ident" id="4855766">trace</span><span class="op" id="4855771">(</span><span class="ident" id="4855772">p</span><span class="op" id="4855773">,</span>&nbsp;<span class="string" id="4855775">&#34;Signature&#34;</span><span class="op" id="4855786">)</span><span class="op" id="4855787">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855794">params</span>&nbsp;<span class="op" id="4855801">=</span>&nbsp;<span class="ident" id="4855803">p</span><span class="op" id="4855804">.</span><span class="ident" id="4855805">parseParameters</span><span class="op" id="4855820">(</span><span class="ident" id="4855821">scope</span><span class="op" id="4855826">,</span>&nbsp;<span class="builtintype" id="4855828">true</span><span class="op" id="4855832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855835">results</span>&nbsp;<span class="op" id="4855843">=</span>&nbsp;<span class="ident" id="4855845">p</span><span class="op" id="4855846">.</span><span class="ident" id="4855847">parseResult</span><span class="op" id="4855858">(</span><span class="ident" id="4855859">scope</span><span class="op" id="4855864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855868">return</span><br>
<span class="lineno"></span><span class="op" id="4855875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4855878">func</span>&nbsp;<span class="op" id="4855883">(</span><span class="ident" id="4855884">p</span>&nbsp;<span class="op" id="4855886">*</span><span class="ident" id="4855887">parser</span><span class="op" id="4855893">)</span>&nbsp;<span class="ident" id="4855895">parseFuncType</span><span class="op" id="4855908">(</span><span class="op" id="4855909">)</span>&nbsp;<span class="op" id="4855911">(</span><span class="op" id="4855912">*</span><span class="ident" id="4855913">ast</span><span class="op" id="4855916">.</span><span class="ident" id="4855917">FuncType</span><span class="op" id="4855925">,</span>&nbsp;<span class="op" id="4855927">*</span><span class="ident" id="4855928">ast</span><span class="op" id="4855931">.</span><span class="ident" id="4855932">Scope</span><span class="op" id="4855937">)</span>&nbsp;<span class="op" id="4855939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855942">if</span>&nbsp;<span class="ident" id="4855945">p</span><span class="op" id="4855946">.</span><span class="ident" id="4855947">trace</span>&nbsp;<span class="op" id="4855953">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4855957">defer</span>&nbsp;<span class="ident" id="4855963">un</span><span class="op" id="4855965">(</span><span class="ident" id="4855966">trace</span><span class="op" id="4855971">(</span><span class="ident" id="4855972">p</span><span class="op" id="4855973">,</span>&nbsp;<span class="string" id="4855975">&#34;FuncType&#34;</span><span class="op" id="4855985">)</span><span class="op" id="4855986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4855989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855993">pos</span>&nbsp;<span class="op" id="4855997">:=</span>&nbsp;<span class="ident" id="4856000">p</span><span class="op" id="4856001">.</span><span class="ident" id="4856002">expect</span><span class="op" id="4856008">(</span><span class="ident" id="4856009">token</span><span class="op" id="4856014">.</span><span class="ident" id="4856015">FUNC</span><span class="op" id="4856019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856022">scope</span>&nbsp;<span class="op" id="4856028">:=</span>&nbsp;<span class="ident" id="4856031">ast</span><span class="op" id="4856034">.</span><span class="ident" id="4856035">NewScope</span><span class="op" id="4856043">(</span><span class="ident" id="4856044">p</span><span class="op" id="4856045">.</span><span class="ident" id="4856046">topScope</span><span class="op" id="4856054">)</span>&nbsp;<span class="comment" id="4856056">//&nbsp;function&nbsp;scope</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856075">params</span><span class="op" id="4856081">,</span>&nbsp;<span class="ident" id="4856083">results</span>&nbsp;<span class="op" id="4856091">:=</span>&nbsp;<span class="ident" id="4856094">p</span><span class="op" id="4856095">.</span><span class="ident" id="4856096">parseSignature</span><span class="op" id="4856110">(</span><span class="ident" id="4856111">scope</span><span class="op" id="4856116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856120">return</span>&nbsp;<span class="op" id="4856127">&amp;</span><span class="ident" id="4856128">ast</span><span class="op" id="4856131">.</span><span class="ident" id="4856132">FuncType</span><span class="op" id="4856140">{</span><span class="ident" id="4856141">Func</span><span class="op" id="4856145">:</span>&nbsp;<span class="ident" id="4856147">pos</span><span class="op" id="4856150">,</span>&nbsp;<span class="ident" id="4856152">Params</span><span class="op" id="4856158">:</span>&nbsp;<span class="ident" id="4856160">params</span><span class="op" id="4856166">,</span>&nbsp;<span class="ident" id="4856168">Results</span><span class="op" id="4856175">:</span>&nbsp;<span class="ident" id="4856177">results</span><span class="op" id="4856184">}</span><span class="op" id="4856185">,</span>&nbsp;<span class="ident" id="4856187">scope</span><br>
<span class="lineno"></span><span class="op" id="4856193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="4856196">func</span>&nbsp;<span class="op" id="4856201">(</span><span class="ident" id="4856202">p</span>&nbsp;<span class="op" id="4856204">*</span><span class="ident" id="4856205">parser</span><span class="op" id="4856211">)</span>&nbsp;<span class="ident" id="4856213">parseMethodSpec</span><span class="op" id="4856228">(</span><span class="ident" id="4856229">scope</span>&nbsp;<span class="op" id="4856235">*</span><span class="ident" id="4856236">ast</span><span class="op" id="4856239">.</span><span class="ident" id="4856240">Scope</span><span class="op" id="4856245">)</span>&nbsp;<span class="op" id="4856247">*</span><span class="ident" id="4856248">ast</span><span class="op" id="4856251">.</span><span class="ident" id="4856252">Field</span>&nbsp;<span class="op" id="4856258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856261">if</span>&nbsp;<span class="ident" id="4856264">p</span><span class="op" id="4856265">.</span><span class="ident" id="4856266">trace</span>&nbsp;<span class="op" id="4856272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856276">defer</span>&nbsp;<span class="ident" id="4856282">un</span><span class="op" id="4856284">(</span><span class="ident" id="4856285">trace</span><span class="op" id="4856290">(</span><span class="ident" id="4856291">p</span><span class="op" id="4856292">,</span>&nbsp;<span class="string" id="4856294">&#34;MethodSpec&#34;</span><span class="op" id="4856306">)</span><span class="op" id="4856307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4856310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856314">doc</span>&nbsp;<span class="op" id="4856318">:=</span>&nbsp;<span class="ident" id="4856321">p</span><span class="op" id="4856322">.</span><span class="ident" id="4856323">leadComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856336">var</span>&nbsp;<span class="ident" id="4856340">idents</span>&nbsp;<span class="op" id="4856347">[</span><span class="op" id="4856348">]</span><span class="op" id="4856349">*</span><span class="ident" id="4856350">ast</span><span class="op" id="4856353">.</span><span class="ident" id="4856354">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856361">var</span>&nbsp;<span class="ident" id="4856365">typ</span>&nbsp;<span class="ident" id="4856369">ast</span><span class="op" id="4856372">.</span><span class="ident" id="4856373">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856379">x</span>&nbsp;<span class="op" id="4856381">:=</span>&nbsp;<span class="ident" id="4856384">p</span><span class="op" id="4856385">.</span><span class="ident" id="4856386">parseTypeName</span><span class="op" id="4856399">(</span><span class="op" id="4856400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856403">if</span>&nbsp;<span class="ident" id="4856406">ident</span><span class="op" id="4856411">,</span>&nbsp;<span class="ident" id="4856413">isIdent</span>&nbsp;<span class="op" id="4856421">:=</span>&nbsp;<span class="ident" id="4856424">x</span><span class="op" id="4856425">.</span><span class="op" id="4856426">(</span><span class="op" id="4856427">*</span><span class="ident" id="4856428">ast</span><span class="op" id="4856431">.</span><span class="ident" id="4856432">Ident</span><span class="op" id="4856437">)</span><span class="op" id="4856438">;</span>&nbsp;<span class="ident" id="4856440">isIdent</span>&nbsp;<span class="op" id="4856448">&amp;&amp;</span>&nbsp;<span class="ident" id="4856451">p</span><span class="op" id="4856452">.</span><span class="ident" id="4856453">tok</span>&nbsp;<span class="op" id="4856457">==</span>&nbsp;<span class="ident" id="4856460">token</span><span class="op" id="4856465">.</span><span class="ident" id="4856466">LPAREN</span>&nbsp;<span class="op" id="4856473">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856477">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856489">idents</span>&nbsp;<span class="op" id="4856496">=</span>&nbsp;<span class="op" id="4856498">[</span><span class="op" id="4856499">]</span><span class="op" id="4856500">*</span><span class="ident" id="4856501">ast</span><span class="op" id="4856504">.</span><span class="ident" id="4856505">Ident</span><span class="op" id="4856510">{</span><span class="ident" id="4856511">ident</span><span class="op" id="4856516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856520">scope</span>&nbsp;<span class="op" id="4856526">:=</span>&nbsp;<span class="ident" id="4856529">ast</span><span class="op" id="4856532">.</span><span class="ident" id="4856533">NewScope</span><span class="op" id="4856541">(</span><span class="builtintype" id="4856542">nil</span><span class="op" id="4856545">)</span>&nbsp;<span class="comment" id="4856547">//&nbsp;method&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856565">params</span><span class="op" id="4856571">,</span>&nbsp;<span class="ident" id="4856573">results</span>&nbsp;<span class="op" id="4856581">:=</span>&nbsp;<span class="ident" id="4856584">p</span><span class="op" id="4856585">.</span><span class="ident" id="4856586">parseSignature</span><span class="op" id="4856600">(</span><span class="ident" id="4856601">scope</span><span class="op" id="4856606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856610">typ</span>&nbsp;<span class="op" id="4856614">=</span>&nbsp;<span class="op" id="4856616">&amp;</span><span class="ident" id="4856617">ast</span><span class="op" id="4856620">.</span><span class="ident" id="4856621">FuncType</span><span class="op" id="4856629">{</span><span class="ident" id="4856630">Func</span><span class="op" id="4856634">:</span>&nbsp;<span class="ident" id="4856636">token</span><span class="op" id="4856641">.</span><span class="ident" id="4856642">NoPos</span><span class="op" id="4856647">,</span>&nbsp;<span class="ident" id="4856649">Params</span><span class="op" id="4856655">:</span>&nbsp;<span class="ident" id="4856657">params</span><span class="op" id="4856663">,</span>&nbsp;<span class="ident" id="4856665">Results</span><span class="op" id="4856672">:</span>&nbsp;<span class="ident" id="4856674">results</span><span class="op" id="4856681">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4856684">}</span>&nbsp;<span class="keyword" id="4856686">else</span>&nbsp;<span class="op" id="4856691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856695">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856719">typ</span>&nbsp;<span class="op" id="4856723">=</span>&nbsp;<span class="ident" id="4856725">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856729">p</span><span class="op" id="4856730">.</span><span class="ident" id="4856731">resolve</span><span class="op" id="4856738">(</span><span class="ident" id="4856739">typ</span><span class="op" id="4856742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4856745">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856748">p</span><span class="op" id="4856749">.</span><span class="ident" id="4856750">expectSemi</span><span class="op" id="4856760">(</span><span class="op" id="4856761">)</span>&nbsp;<span class="comment" id="4856763">//&nbsp;call&nbsp;before&nbsp;accessing&nbsp;p.linecomment</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856804">spec</span>&nbsp;<span class="op" id="4856809">:=</span>&nbsp;<span class="op" id="4856812">&amp;</span><span class="ident" id="4856813">ast</span><span class="op" id="4856816">.</span><span class="ident" id="4856817">Field</span><span class="op" id="4856822">{</span><span class="ident" id="4856823">Doc</span><span class="op" id="4856826">:</span>&nbsp;<span class="ident" id="4856828">doc</span><span class="op" id="4856831">,</span>&nbsp;<span class="ident" id="4856833">Names</span><span class="op" id="4856838">:</span>&nbsp;<span class="ident" id="4856840">idents</span><span class="op" id="4856846">,</span>&nbsp;<span class="ident" id="4856848">Type</span><span class="op" id="4856852">:</span>&nbsp;<span class="ident" id="4856854">typ</span><span class="op" id="4856857">,</span>&nbsp;<span class="ident" id="4856859">Comment</span><span class="op" id="4856866">:</span>&nbsp;<span class="ident" id="4856868">p</span><span class="op" id="4856869">.</span><span class="ident" id="4856870">lineComment</span><span class="op" id="4856881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856884">p</span><span class="op" id="4856885">.</span><span class="ident" id="4856886">declare</span><span class="op" id="4856893">(</span><span class="ident" id="4856894">spec</span><span class="op" id="4856898">,</span>&nbsp;<span class="builtintype" id="4856900">nil</span><span class="op" id="4856903">,</span>&nbsp;<span class="ident" id="4856905">scope</span><span class="op" id="4856910">,</span>&nbsp;<span class="ident" id="4856912">ast</span><span class="op" id="4856915">.</span><span class="ident" id="4856916">Fun</span><span class="op" id="4856919">,</span>&nbsp;<span class="ident" id="4856921">idents</span><span class="op" id="4856927">...</span><span class="op" id="4856930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4856934">return</span>&nbsp;<span class="ident" id="4856941">spec</span><br>
<span class="lineno"></span><span class="op" id="4856946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4856949">func</span>&nbsp;<span class="op" id="4856954">(</span><span class="ident" id="4856955">p</span>&nbsp;<span class="op" id="4856957">*</span><span class="ident" id="4856958">parser</span><span class="op" id="4856964">)</span>&nbsp;<span class="ident" id="4856966">parseInterfaceType</span><span class="op" id="4856984">(</span><span class="op" id="4856985">)</span>&nbsp;<span class="op" id="4856987">*</span><span class="ident" id="4856988">ast</span><span class="op" id="4856991">.</span><span class="ident" id="4856992">InterfaceType</span>&nbsp;<span class="op" id="4857006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857009">if</span>&nbsp;<span class="ident" id="4857012">p</span><span class="op" id="4857013">.</span><span class="ident" id="4857014">trace</span>&nbsp;<span class="op" id="4857020">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857024">defer</span>&nbsp;<span class="ident" id="4857030">un</span><span class="op" id="4857032">(</span><span class="ident" id="4857033">trace</span><span class="op" id="4857038">(</span><span class="ident" id="4857039">p</span><span class="op" id="4857040">,</span>&nbsp;<span class="string" id="4857042">&#34;InterfaceType&#34;</span><span class="op" id="4857057">)</span><span class="op" id="4857058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857065">pos</span>&nbsp;<span class="op" id="4857069">:=</span>&nbsp;<span class="ident" id="4857072">p</span><span class="op" id="4857073">.</span><span class="ident" id="4857074">expect</span><span class="op" id="4857080">(</span><span class="ident" id="4857081">token</span><span class="op" id="4857086">.</span><span class="ident" id="4857087">INTERFACE</span><span class="op" id="4857096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857099">lbrace</span>&nbsp;<span class="op" id="4857106">:=</span>&nbsp;<span class="ident" id="4857109">p</span><span class="op" id="4857110">.</span><span class="ident" id="4857111">expect</span><span class="op" id="4857117">(</span><span class="ident" id="4857118">token</span><span class="op" id="4857123">.</span><span class="ident" id="4857124">LBRACE</span><span class="op" id="4857130">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857133">scope</span>&nbsp;<span class="op" id="4857139">:=</span>&nbsp;<span class="ident" id="4857142">ast</span><span class="op" id="4857145">.</span><span class="ident" id="4857146">NewScope</span><span class="op" id="4857154">(</span><span class="builtintype" id="4857155">nil</span><span class="op" id="4857158">)</span>&nbsp;<span class="comment" id="4857160">//&nbsp;interface&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857180">var</span>&nbsp;<span class="ident" id="4857184">list</span>&nbsp;<span class="op" id="4857189">[</span><span class="op" id="4857190">]</span><span class="op" id="4857191">*</span><span class="ident" id="4857192">ast</span><span class="op" id="4857195">.</span><span class="ident" id="4857196">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857203">for</span>&nbsp;<span class="ident" id="4857207">p</span><span class="op" id="4857208">.</span><span class="ident" id="4857209">tok</span>&nbsp;<span class="op" id="4857213">==</span>&nbsp;<span class="ident" id="4857216">token</span><span class="op" id="4857221">.</span><span class="ident" id="4857222">IDENT</span>&nbsp;<span class="op" id="4857228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857232">list</span>&nbsp;<span class="op" id="4857237">=</span>&nbsp;<span class="builtinfunc" id="4857239">append</span><span class="op" id="4857245">(</span><span class="ident" id="4857246">list</span><span class="op" id="4857250">,</span>&nbsp;<span class="ident" id="4857252">p</span><span class="op" id="4857253">.</span><span class="ident" id="4857254">parseMethodSpec</span><span class="op" id="4857269">(</span><span class="ident" id="4857270">scope</span><span class="op" id="4857275">)</span><span class="op" id="4857276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857279">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857282">rbrace</span>&nbsp;<span class="op" id="4857289">:=</span>&nbsp;<span class="ident" id="4857292">p</span><span class="op" id="4857293">.</span><span class="ident" id="4857294">expect</span><span class="op" id="4857300">(</span><span class="ident" id="4857301">token</span><span class="op" id="4857306">.</span><span class="ident" id="4857307">RBRACE</span><span class="op" id="4857313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857317">return</span>&nbsp;<span class="op" id="4857324">&amp;</span><span class="ident" id="4857325">ast</span><span class="op" id="4857328">.</span><span class="ident" id="4857329">InterfaceType</span><span class="op" id="4857342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857346">Interface</span><span class="op" id="4857355">:</span>&nbsp;<span class="ident" id="4857357">pos</span><span class="op" id="4857360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857364">Methods</span><span class="op" id="4857371">:</span>&nbsp;<span class="op" id="4857373">&amp;</span><span class="ident" id="4857374">ast</span><span class="op" id="4857377">.</span><span class="ident" id="4857378">FieldList</span><span class="op" id="4857387">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857392">Opening</span><span class="op" id="4857399">:</span>&nbsp;<span class="ident" id="4857401">lbrace</span><span class="op" id="4857407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857412">List</span><span class="op" id="4857416">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857421">list</span><span class="op" id="4857425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857430">Closing</span><span class="op" id="4857437">:</span>&nbsp;<span class="ident" id="4857439">rbrace</span><span class="op" id="4857445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857449">}</span><span class="op" id="4857450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857453">}</span><br>
<span class="lineno">965</span><span class="op" id="4857455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4857458">func</span>&nbsp;<span class="op" id="4857463">(</span><span class="ident" id="4857464">p</span>&nbsp;<span class="op" id="4857466">*</span><span class="ident" id="4857467">parser</span><span class="op" id="4857473">)</span>&nbsp;<span class="ident" id="4857475">parseMapType</span><span class="op" id="4857487">(</span><span class="op" id="4857488">)</span>&nbsp;<span class="op" id="4857490">*</span><span class="ident" id="4857491">ast</span><span class="op" id="4857494">.</span><span class="ident" id="4857495">MapType</span>&nbsp;<span class="op" id="4857503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857506">if</span>&nbsp;<span class="ident" id="4857509">p</span><span class="op" id="4857510">.</span><span class="ident" id="4857511">trace</span>&nbsp;<span class="op" id="4857517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857521">defer</span>&nbsp;<span class="ident" id="4857527">un</span><span class="op" id="4857529">(</span><span class="ident" id="4857530">trace</span><span class="op" id="4857535">(</span><span class="ident" id="4857536">p</span><span class="op" id="4857537">,</span>&nbsp;<span class="string" id="4857539">&#34;MapType&#34;</span><span class="op" id="4857548">)</span><span class="op" id="4857549">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857556">pos</span>&nbsp;<span class="op" id="4857560">:=</span>&nbsp;<span class="ident" id="4857563">p</span><span class="op" id="4857564">.</span><span class="ident" id="4857565">expect</span><span class="op" id="4857571">(</span><span class="ident" id="4857572">token</span><span class="op" id="4857577">.</span><span class="ident" id="4857578">MAP</span><span class="op" id="4857581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857584">p</span><span class="op" id="4857585">.</span><span class="ident" id="4857586">expect</span><span class="op" id="4857592">(</span><span class="ident" id="4857593">token</span><span class="op" id="4857598">.</span><span class="ident" id="4857599">LBRACK</span><span class="op" id="4857605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857608">key</span>&nbsp;<span class="op" id="4857612">:=</span>&nbsp;<span class="ident" id="4857615">p</span><span class="op" id="4857616">.</span><span class="ident" id="4857617">parseType</span><span class="op" id="4857626">(</span><span class="op" id="4857627">)</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857630">p</span><span class="op" id="4857631">.</span><span class="ident" id="4857632">expect</span><span class="op" id="4857638">(</span><span class="ident" id="4857639">token</span><span class="op" id="4857644">.</span><span class="ident" id="4857645">RBRACK</span><span class="op" id="4857651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857654">value</span>&nbsp;<span class="op" id="4857660">:=</span>&nbsp;<span class="ident" id="4857663">p</span><span class="op" id="4857664">.</span><span class="ident" id="4857665">parseType</span><span class="op" id="4857674">(</span><span class="op" id="4857675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857679">return</span>&nbsp;<span class="op" id="4857686">&amp;</span><span class="ident" id="4857687">ast</span><span class="op" id="4857690">.</span><span class="ident" id="4857691">MapType</span><span class="op" id="4857698">{</span><span class="ident" id="4857699">Map</span><span class="op" id="4857702">:</span>&nbsp;<span class="ident" id="4857704">pos</span><span class="op" id="4857707">,</span>&nbsp;<span class="ident" id="4857709">Key</span><span class="op" id="4857712">:</span>&nbsp;<span class="ident" id="4857714">key</span><span class="op" id="4857717">,</span>&nbsp;<span class="ident" id="4857719">Value</span><span class="op" id="4857724">:</span>&nbsp;<span class="ident" id="4857726">value</span><span class="op" id="4857731">}</span><br>
<span class="lineno"></span><span class="op" id="4857733">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span><span class="keyword" id="4857736">func</span>&nbsp;<span class="op" id="4857741">(</span><span class="ident" id="4857742">p</span>&nbsp;<span class="op" id="4857744">*</span><span class="ident" id="4857745">parser</span><span class="op" id="4857751">)</span>&nbsp;<span class="ident" id="4857753">parseChanType</span><span class="op" id="4857766">(</span><span class="op" id="4857767">)</span>&nbsp;<span class="op" id="4857769">*</span><span class="ident" id="4857770">ast</span><span class="op" id="4857773">.</span><span class="ident" id="4857774">ChanType</span>&nbsp;<span class="op" id="4857783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857786">if</span>&nbsp;<span class="ident" id="4857789">p</span><span class="op" id="4857790">.</span><span class="ident" id="4857791">trace</span>&nbsp;<span class="op" id="4857797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857801">defer</span>&nbsp;<span class="ident" id="4857807">un</span><span class="op" id="4857809">(</span><span class="ident" id="4857810">trace</span><span class="op" id="4857815">(</span><span class="ident" id="4857816">p</span><span class="op" id="4857817">,</span>&nbsp;<span class="string" id="4857819">&#34;ChanType&#34;</span><span class="op" id="4857829">)</span><span class="op" id="4857830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4857833">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857837">pos</span>&nbsp;<span class="op" id="4857841">:=</span>&nbsp;<span class="ident" id="4857844">p</span><span class="op" id="4857845">.</span><span class="ident" id="4857846">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857851">dir</span>&nbsp;<span class="op" id="4857855">:=</span>&nbsp;<span class="ident" id="4857858">ast</span><span class="op" id="4857861">.</span><span class="ident" id="4857862">SEND</span>&nbsp;<span class="op" id="4857867">|</span>&nbsp;<span class="ident" id="4857869">ast</span><span class="op" id="4857872">.</span><span class="ident" id="4857873">RECV</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857879">var</span>&nbsp;<span class="ident" id="4857883">arrow</span>&nbsp;<span class="ident" id="4857889">token</span><span class="op" id="4857894">.</span><span class="ident" id="4857895">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857900">if</span>&nbsp;<span class="ident" id="4857903">p</span><span class="op" id="4857904">.</span><span class="ident" id="4857905">tok</span>&nbsp;<span class="op" id="4857909">==</span>&nbsp;<span class="ident" id="4857912">token</span><span class="op" id="4857917">.</span><span class="ident" id="4857918">CHAN</span>&nbsp;<span class="op" id="4857923">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857927">p</span><span class="op" id="4857928">.</span><span class="ident" id="4857929">next</span><span class="op" id="4857933">(</span><span class="op" id="4857934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4857938">if</span>&nbsp;<span class="ident" id="4857941">p</span><span class="op" id="4857942">.</span><span class="ident" id="4857943">tok</span>&nbsp;<span class="op" id="4857947">==</span>&nbsp;<span class="ident" id="4857950">token</span><span class="op" id="4857955">.</span><span class="ident" id="4857956">ARROW</span>&nbsp;<span class="op" id="4857962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857967">arrow</span>&nbsp;<span class="op" id="4857973">=</span>&nbsp;<span class="ident" id="4857975">p</span><span class="op" id="4857976">.</span><span class="ident" id="4857977">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857984">p</span><span class="op" id="4857985">.</span><span class="ident" id="4857986">next</span><span class="op" id="4857990">(</span><span class="op" id="4857991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857996">dir</span>&nbsp;<span class="op" id="4858000">=</span>&nbsp;<span class="ident" id="4858002">ast</span><span class="op" id="4858005">.</span><span class="ident" id="4858006">SEND</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4858013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4858016">}</span>&nbsp;<span class="keyword" id="4858018">else</span>&nbsp;<span class="op" id="4858023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858027">arrow</span>&nbsp;<span class="op" id="4858033">=</span>&nbsp;<span class="ident" id="4858035">p</span><span class="op" id="4858036">.</span><span class="ident" id="4858037">expect</span><span class="op" id="4858043">(</span><span class="ident" id="4858044">token</span><span class="op" id="4858049">.</span><span class="ident" id="4858050">ARROW</span><span class="op" id="4858055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858059">p</span><span class="op" id="4858060">.</span><span class="ident" id="4858061">expect</span><span class="op" id="4858067">(</span><span class="ident" id="4858068">token</span><span class="op" id="4858073">.</span><span class="ident" id="4858074">CHAN</span><span class="op" id="4858078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858082">dir</span>&nbsp;<span class="op" id="4858086">=</span>&nbsp;<span class="ident" id="4858088">ast</span><span class="op" id="4858091">.</span><span class="ident" id="4858092">RECV</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4858098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858101">value</span>&nbsp;<span class="op" id="4858107">:=</span>&nbsp;<span class="ident" id="4858110">p</span><span class="op" id="4858111">.</span><span class="ident" id="4858112">parseType</span><span class="op" id="4858121">(</span><span class="op" id="4858122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858126">return</span>&nbsp;<span class="op" id="4858133">&amp;</span><span class="ident" id="4858134">ast</span><span class="op" id="4858137">.</span><span class="ident" id="4858138">ChanType</span><span class="op" id="4858146">{</span><span class="ident" id="4858147">Begin</span><span class="op" id="4858152">:</span>&nbsp;<span class="ident" id="4858154">pos</span><span class="op" id="4858157">,</span>&nbsp;<span class="ident" id="4858159">Arrow</span><span class="op" id="4858164">:</span>&nbsp;<span class="ident" id="4858166">arrow</span><span class="op" id="4858171">,</span>&nbsp;<span class="ident" id="4858173">Dir</span><span class="op" id="4858176">:</span>&nbsp;<span class="ident" id="4858178">dir</span><span class="op" id="4858181">,</span>&nbsp;<span class="ident" id="4858183">Value</span><span class="op" id="4858188">:</span>&nbsp;<span class="ident" id="4858190">value</span><span class="op" id="4858195">}</span><br>
<span class="lineno"></span><span class="op" id="4858197">}</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span><span class="comment" id="4858200">//&nbsp;If&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4858255">func</span>&nbsp;<span class="op" id="4858260">(</span><span class="ident" id="4858261">p</span>&nbsp;<span class="op" id="4858263">*</span><span class="ident" id="4858264">parser</span><span class="op" id="4858270">)</span>&nbsp;<span class="ident" id="4858272">tryIdentOrType</span><span class="op" id="4858286">(</span><span class="op" id="4858287">)</span>&nbsp;<span class="ident" id="4858289">ast</span><span class="op" id="4858292">.</span><span class="ident" id="4858293">Expr</span>&nbsp;<span class="op" id="4858298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858301">switch</span>&nbsp;<span class="ident" id="4858308">p</span><span class="op" id="4858309">.</span><span class="ident" id="4858310">tok</span>&nbsp;<span class="op" id="4858314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858317">case</span>&nbsp;<span class="ident" id="4858322">token</span><span class="op" id="4858327">.</span><span class="ident" id="4858328">IDENT</span><span class="op" id="4858333">:</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858337">return</span>&nbsp;<span class="ident" id="4858344">p</span><span class="op" id="4858345">.</span><span class="ident" id="4858346">parseTypeName</span><span class="op" id="4858359">(</span><span class="op" id="4858360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858363">case</span>&nbsp;<span class="ident" id="4858368">token</span><span class="op" id="4858373">.</span><span class="ident" id="4858374">LBRACK</span><span class="op" id="4858380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858384">return</span>&nbsp;<span class="ident" id="4858391">p</span><span class="op" id="4858392">.</span><span class="ident" id="4858393">parseArrayType</span><span class="op" id="4858407">(</span><span class="op" id="4858408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858411">case</span>&nbsp;<span class="ident" id="4858416">token</span><span class="op" id="4858421">.</span><span class="ident" id="4858422">STRUCT</span><span class="op" id="4858428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858432">return</span>&nbsp;<span class="ident" id="4858439">p</span><span class="op" id="4858440">.</span><span class="ident" id="4858441">parseStructType</span><span class="op" id="4858456">(</span><span class="op" id="4858457">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858460">case</span>&nbsp;<span class="ident" id="4858465">token</span><span class="op" id="4858470">.</span><span class="ident" id="4858471">MUL</span><span class="op" id="4858474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858478">return</span>&nbsp;<span class="ident" id="4858485">p</span><span class="op" id="4858486">.</span><span class="ident" id="4858487">parsePointerType</span><span class="op" id="4858503">(</span><span class="op" id="4858504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858507">case</span>&nbsp;<span class="ident" id="4858512">token</span><span class="op" id="4858517">.</span><span class="ident" id="4858518">FUNC</span><span class="op" id="4858522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858526">typ</span><span class="op" id="4858529">,</span>&nbsp;<span class="ident" id="4858531">_</span>&nbsp;<span class="op" id="4858533">:=</span>&nbsp;<span class="ident" id="4858536">p</span><span class="op" id="4858537">.</span><span class="ident" id="4858538">parseFuncType</span><span class="op" id="4858551">(</span><span class="op" id="4858552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858556">return</span>&nbsp;<span class="ident" id="4858563">typ</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858568">case</span>&nbsp;<span class="ident" id="4858573">token</span><span class="op" id="4858578">.</span><span class="ident" id="4858579">INTERFACE</span><span class="op" id="4858588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858592">return</span>&nbsp;<span class="ident" id="4858599">p</span><span class="op" id="4858600">.</span><span class="ident" id="4858601">parseInterfaceType</span><span class="op" id="4858619">(</span><span class="op" id="4858620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858623">case</span>&nbsp;<span class="ident" id="4858628">token</span><span class="op" id="4858633">.</span><span class="ident" id="4858634">MAP</span><span class="op" id="4858637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858641">return</span>&nbsp;<span class="ident" id="4858648">p</span><span class="op" id="4858649">.</span><span class="ident" id="4858650">parseMapType</span><span class="op" id="4858662">(</span><span class="op" id="4858663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858666">case</span>&nbsp;<span class="ident" id="4858671">token</span><span class="op" id="4858676">.</span><span class="ident" id="4858677">CHAN</span><span class="op" id="4858681">,</span>&nbsp;<span class="ident" id="4858683">token</span><span class="op" id="4858688">.</span><span class="ident" id="4858689">ARROW</span><span class="op" id="4858694">:</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858698">return</span>&nbsp;<span class="ident" id="4858705">p</span><span class="op" id="4858706">.</span><span class="ident" id="4858707">parseChanType</span><span class="op" id="4858720">(</span><span class="op" id="4858721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858724">case</span>&nbsp;<span class="ident" id="4858729">token</span><span class="op" id="4858734">.</span><span class="ident" id="4858735">LPAREN</span><span class="op" id="4858741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858745">lparen</span>&nbsp;<span class="op" id="4858752">:=</span>&nbsp;<span class="ident" id="4858755">p</span><span class="op" id="4858756">.</span><span class="ident" id="4858757">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858763">p</span><span class="op" id="4858764">.</span><span class="ident" id="4858765">next</span><span class="op" id="4858769">(</span><span class="op" id="4858770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858774">typ</span>&nbsp;<span class="op" id="4858778">:=</span>&nbsp;<span class="ident" id="4858781">p</span><span class="op" id="4858782">.</span><span class="ident" id="4858783">parseType</span><span class="op" id="4858792">(</span><span class="op" id="4858793">)</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858797">rparen</span>&nbsp;<span class="op" id="4858804">:=</span>&nbsp;<span class="ident" id="4858807">p</span><span class="op" id="4858808">.</span><span class="ident" id="4858809">expect</span><span class="op" id="4858815">(</span><span class="ident" id="4858816">token</span><span class="op" id="4858821">.</span><span class="ident" id="4858822">RPAREN</span><span class="op" id="4858828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858832">return</span>&nbsp;<span class="op" id="4858839">&amp;</span><span class="ident" id="4858840">ast</span><span class="op" id="4858843">.</span><span class="ident" id="4858844">ParenExpr</span><span class="op" id="4858853">{</span><span class="ident" id="4858854">Lparen</span><span class="op" id="4858860">:</span>&nbsp;<span class="ident" id="4858862">lparen</span><span class="op" id="4858868">,</span>&nbsp;<span class="ident" id="4858870">X</span><span class="op" id="4858871">:</span>&nbsp;<span class="ident" id="4858873">typ</span><span class="op" id="4858876">,</span>&nbsp;<span class="ident" id="4858878">Rparen</span><span class="op" id="4858884">:</span>&nbsp;<span class="ident" id="4858886">rparen</span><span class="op" id="4858892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4858895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858899">//&nbsp;no&nbsp;type&nbsp;found</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858917">return</span>&nbsp;<span class="builtintype" id="4858924">nil</span><br>
<span class="lineno"></span><span class="op" id="4858928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4858931">func</span>&nbsp;<span class="op" id="4858936">(</span><span class="ident" id="4858937">p</span>&nbsp;<span class="op" id="4858939">*</span><span class="ident" id="4858940">parser</span><span class="op" id="4858946">)</span>&nbsp;<span class="ident" id="4858948">tryType</span><span class="op" id="4858955">(</span><span class="op" id="4858956">)</span>&nbsp;<span class="ident" id="4858958">ast</span><span class="op" id="4858961">.</span><span class="ident" id="4858962">Expr</span>&nbsp;<span class="op" id="4858967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858970">typ</span>&nbsp;<span class="op" id="4858974">:=</span>&nbsp;<span class="ident" id="4858977">p</span><span class="op" id="4858978">.</span><span class="ident" id="4858979">tryIdentOrType</span><span class="op" id="4858993">(</span><span class="op" id="4858994">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858997">if</span>&nbsp;<span class="ident" id="4859000">typ</span>&nbsp;<span class="op" id="4859004">!=</span>&nbsp;<span class="builtintype" id="4859007">nil</span>&nbsp;<span class="op" id="4859011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859015">p</span><span class="op" id="4859016">.</span><span class="ident" id="4859017">resolve</span><span class="op" id="4859024">(</span><span class="ident" id="4859025">typ</span><span class="op" id="4859028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859034">return</span>&nbsp;<span class="ident" id="4859041">typ</span><br>
<span class="lineno"></span><span class="op" id="4859045">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="4859048">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4859128">//&nbsp;Blocks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4859139">func</span>&nbsp;<span class="op" id="4859144">(</span><span class="ident" id="4859145">p</span>&nbsp;<span class="op" id="4859147">*</span><span class="ident" id="4859148">parser</span><span class="op" id="4859154">)</span>&nbsp;<span class="ident" id="4859156">parseStmtList</span><span class="op" id="4859169">(</span><span class="op" id="4859170">)</span>&nbsp;<span class="op" id="4859172">(</span><span class="ident" id="4859173">list</span>&nbsp;<span class="op" id="4859178">[</span><span class="op" id="4859179">]</span><span class="ident" id="4859180">ast</span><span class="op" id="4859183">.</span><span class="ident" id="4859184">Stmt</span><span class="op" id="4859188">)</span>&nbsp;<span class="op" id="4859190">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859193">if</span>&nbsp;<span class="ident" id="4859196">p</span><span class="op" id="4859197">.</span><span class="ident" id="4859198">trace</span>&nbsp;<span class="op" id="4859204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859208">defer</span>&nbsp;<span class="ident" id="4859214">un</span><span class="op" id="4859216">(</span><span class="ident" id="4859217">trace</span><span class="op" id="4859222">(</span><span class="ident" id="4859223">p</span><span class="op" id="4859224">,</span>&nbsp;<span class="string" id="4859226">&#34;StatementList&#34;</span><span class="op" id="4859241">)</span><span class="op" id="4859242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859249">for</span>&nbsp;<span class="ident" id="4859253">p</span><span class="op" id="4859254">.</span><span class="ident" id="4859255">tok</span>&nbsp;<span class="op" id="4859259">!=</span>&nbsp;<span class="ident" id="4859262">token</span><span class="op" id="4859267">.</span><span class="ident" id="4859268">CASE</span>&nbsp;<span class="op" id="4859273">&amp;&amp;</span>&nbsp;<span class="ident" id="4859276">p</span><span class="op" id="4859277">.</span><span class="ident" id="4859278">tok</span>&nbsp;<span class="op" id="4859282">!=</span>&nbsp;<span class="ident" id="4859285">token</span><span class="op" id="4859290">.</span><span class="ident" id="4859291">DEFAULT</span>&nbsp;<span class="op" id="4859299">&amp;&amp;</span>&nbsp;<span class="ident" id="4859302">p</span><span class="op" id="4859303">.</span><span class="ident" id="4859304">tok</span>&nbsp;<span class="op" id="4859308">!=</span>&nbsp;<span class="ident" id="4859311">token</span><span class="op" id="4859316">.</span><span class="ident" id="4859317">RBRACE</span>&nbsp;<span class="op" id="4859324">&amp;&amp;</span>&nbsp;<span class="ident" id="4859327">p</span><span class="op" id="4859328">.</span><span class="ident" id="4859329">tok</span>&nbsp;<span class="op" id="4859333">!=</span>&nbsp;<span class="ident" id="4859336">token</span><span class="op" id="4859341">.</span><span class="ident" id="4859342">EOF</span>&nbsp;<span class="op" id="4859346">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859350">list</span>&nbsp;<span class="op" id="4859355">=</span>&nbsp;<span class="builtinfunc" id="4859357">append</span><span class="op" id="4859363">(</span><span class="ident" id="4859364">list</span><span class="op" id="4859368">,</span>&nbsp;<span class="ident" id="4859370">p</span><span class="op" id="4859371">.</span><span class="ident" id="4859372">parseStmt</span><span class="op" id="4859381">(</span><span class="op" id="4859382">)</span><span class="op" id="4859383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859390">return</span><br>
<span class="lineno"></span><span class="op" id="4859397">}</span><br>
<span class="lineno">1060</span><br>
<span class="lineno"></span><span class="keyword" id="4859400">func</span>&nbsp;<span class="op" id="4859405">(</span><span class="ident" id="4859406">p</span>&nbsp;<span class="op" id="4859408">*</span><span class="ident" id="4859409">parser</span><span class="op" id="4859415">)</span>&nbsp;<span class="ident" id="4859417">parseBody</span><span class="op" id="4859426">(</span><span class="ident" id="4859427">scope</span>&nbsp;<span class="op" id="4859433">*</span><span class="ident" id="4859434">ast</span><span class="op" id="4859437">.</span><span class="ident" id="4859438">Scope</span><span class="op" id="4859443">)</span>&nbsp;<span class="op" id="4859445">*</span><span class="ident" id="4859446">ast</span><span class="op" id="4859449">.</span><span class="ident" id="4859450">BlockStmt</span>&nbsp;<span class="op" id="4859460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859463">if</span>&nbsp;<span class="ident" id="4859466">p</span><span class="op" id="4859467">.</span><span class="ident" id="4859468">trace</span>&nbsp;<span class="op" id="4859474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859478">defer</span>&nbsp;<span class="ident" id="4859484">un</span><span class="op" id="4859486">(</span><span class="ident" id="4859487">trace</span><span class="op" id="4859492">(</span><span class="ident" id="4859493">p</span><span class="op" id="4859494">,</span>&nbsp;<span class="string" id="4859496">&#34;Body&#34;</span><span class="op" id="4859502">)</span><span class="op" id="4859503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859506">}</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859510">lbrace</span>&nbsp;<span class="op" id="4859517">:=</span>&nbsp;<span class="ident" id="4859520">p</span><span class="op" id="4859521">.</span><span class="ident" id="4859522">expect</span><span class="op" id="4859528">(</span><span class="ident" id="4859529">token</span><span class="op" id="4859534">.</span><span class="ident" id="4859535">LBRACE</span><span class="op" id="4859541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859544">p</span><span class="op" id="4859545">.</span><span class="ident" id="4859546">topScope</span>&nbsp;<span class="op" id="4859555">=</span>&nbsp;<span class="ident" id="4859557">scope</span>&nbsp;<span class="comment" id="4859563">//&nbsp;open&nbsp;function&nbsp;scope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859587">p</span><span class="op" id="4859588">.</span><span class="ident" id="4859589">openLabelScope</span><span class="op" id="4859603">(</span><span class="op" id="4859604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859607">list</span>&nbsp;<span class="op" id="4859612">:=</span>&nbsp;<span class="ident" id="4859615">p</span><span class="op" id="4859616">.</span><span class="ident" id="4859617">parseStmtList</span><span class="op" id="4859630">(</span><span class="op" id="4859631">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859634">p</span><span class="op" id="4859635">.</span><span class="ident" id="4859636">closeLabelScope</span><span class="op" id="4859651">(</span><span class="op" id="4859652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859655">p</span><span class="op" id="4859656">.</span><span class="ident" id="4859657">closeScope</span><span class="op" id="4859667">(</span><span class="op" id="4859668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859671">rbrace</span>&nbsp;<span class="op" id="4859678">:=</span>&nbsp;<span class="ident" id="4859681">p</span><span class="op" id="4859682">.</span><span class="ident" id="4859683">expect</span><span class="op" id="4859689">(</span><span class="ident" id="4859690">token</span><span class="op" id="4859695">.</span><span class="ident" id="4859696">RBRACE</span><span class="op" id="4859702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859706">return</span>&nbsp;<span class="op" id="4859713">&amp;</span><span class="ident" id="4859714">ast</span><span class="op" id="4859717">.</span><span class="ident" id="4859718">BlockStmt</span><span class="op" id="4859727">{</span><span class="ident" id="4859728">Lbrace</span><span class="op" id="4859734">:</span>&nbsp;<span class="ident" id="4859736">lbrace</span><span class="op" id="4859742">,</span>&nbsp;<span class="ident" id="4859744">List</span><span class="op" id="4859748">:</span>&nbsp;<span class="ident" id="4859750">list</span><span class="op" id="4859754">,</span>&nbsp;<span class="ident" id="4859756">Rbrace</span><span class="op" id="4859762">:</span>&nbsp;<span class="ident" id="4859764">rbrace</span><span class="op" id="4859770">}</span><br>
<span class="lineno">1075</span><span class="op" id="4859772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4859775">func</span>&nbsp;<span class="op" id="4859780">(</span><span class="ident" id="4859781">p</span>&nbsp;<span class="op" id="4859783">*</span><span class="ident" id="4859784">parser</span><span class="op" id="4859790">)</span>&nbsp;<span class="ident" id="4859792">parseBlockStmt</span><span class="op" id="4859806">(</span><span class="op" id="4859807">)</span>&nbsp;<span class="op" id="4859809">*</span><span class="ident" id="4859810">ast</span><span class="op" id="4859813">.</span><span class="ident" id="4859814">BlockStmt</span>&nbsp;<span class="op" id="4859824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859827">if</span>&nbsp;<span class="ident" id="4859830">p</span><span class="op" id="4859831">.</span><span class="ident" id="4859832">trace</span>&nbsp;<span class="op" id="4859838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859842">defer</span>&nbsp;<span class="ident" id="4859848">un</span><span class="op" id="4859850">(</span><span class="ident" id="4859851">trace</span><span class="op" id="4859856">(</span><span class="ident" id="4859857">p</span><span class="op" id="4859858">,</span>&nbsp;<span class="string" id="4859860">&#34;BlockStmt&#34;</span><span class="op" id="4859871">)</span><span class="op" id="4859872">)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859879">lbrace</span>&nbsp;<span class="op" id="4859886">:=</span>&nbsp;<span class="ident" id="4859889">p</span><span class="op" id="4859890">.</span><span class="ident" id="4859891">expect</span><span class="op" id="4859897">(</span><span class="ident" id="4859898">token</span><span class="op" id="4859903">.</span><span class="ident" id="4859904">LBRACE</span><span class="op" id="4859910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859913">p</span><span class="op" id="4859914">.</span><span class="ident" id="4859915">openScope</span><span class="op" id="4859924">(</span><span class="op" id="4859925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859928">list</span>&nbsp;<span class="op" id="4859933">:=</span>&nbsp;<span class="ident" id="4859936">p</span><span class="op" id="4859937">.</span><span class="ident" id="4859938">parseStmtList</span><span class="op" id="4859951">(</span><span class="op" id="4859952">)</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859955">p</span><span class="op" id="4859956">.</span><span class="ident" id="4859957">closeScope</span><span class="op" id="4859967">(</span><span class="op" id="4859968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859971">rbrace</span>&nbsp;<span class="op" id="4859978">:=</span>&nbsp;<span class="ident" id="4859981">p</span><span class="op" id="4859982">.</span><span class="ident" id="4859983">expect</span><span class="op" id="4859989">(</span><span class="ident" id="4859990">token</span><span class="op" id="4859995">.</span><span class="ident" id="4859996">RBRACE</span><span class="op" id="4860002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860006">return</span>&nbsp;<span class="op" id="4860013">&amp;</span><span class="ident" id="4860014">ast</span><span class="op" id="4860017">.</span><span class="ident" id="4860018">BlockStmt</span><span class="op" id="4860027">{</span><span class="ident" id="4860028">Lbrace</span><span class="op" id="4860034">:</span>&nbsp;<span class="ident" id="4860036">lbrace</span><span class="op" id="4860042">,</span>&nbsp;<span class="ident" id="4860044">List</span><span class="op" id="4860048">:</span>&nbsp;<span class="ident" id="4860050">list</span><span class="op" id="4860054">,</span>&nbsp;<span class="ident" id="4860056">Rbrace</span><span class="op" id="4860062">:</span>&nbsp;<span class="ident" id="4860064">rbrace</span><span class="op" id="4860070">}</span><br>
<span class="lineno"></span><span class="op" id="4860072">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="4860075">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4860155">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4860171">func</span>&nbsp;<span class="op" id="4860176">(</span><span class="ident" id="4860177">p</span>&nbsp;<span class="op" id="4860179">*</span><span class="ident" id="4860180">parser</span><span class="op" id="4860186">)</span>&nbsp;<span class="ident" id="4860188">parseFuncTypeOrLit</span><span class="op" id="4860206">(</span><span class="op" id="4860207">)</span>&nbsp;<span class="ident" id="4860209">ast</span><span class="op" id="4860212">.</span><span class="ident" id="4860213">Expr</span>&nbsp;<span class="op" id="4860218">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860221">if</span>&nbsp;<span class="ident" id="4860224">p</span><span class="op" id="4860225">.</span><span class="ident" id="4860226">trace</span>&nbsp;<span class="op" id="4860232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860236">defer</span>&nbsp;<span class="ident" id="4860242">un</span><span class="op" id="4860244">(</span><span class="ident" id="4860245">trace</span><span class="op" id="4860250">(</span><span class="ident" id="4860251">p</span><span class="op" id="4860252">,</span>&nbsp;<span class="string" id="4860254">&#34;FuncTypeOrLit&#34;</span><span class="op" id="4860269">)</span><span class="op" id="4860270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860277">typ</span><span class="op" id="4860280">,</span>&nbsp;<span class="ident" id="4860282">scope</span>&nbsp;<span class="op" id="4860288">:=</span>&nbsp;<span class="ident" id="4860291">p</span><span class="op" id="4860292">.</span><span class="ident" id="4860293">parseFuncType</span><span class="op" id="4860306">(</span><span class="op" id="4860307">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860310">if</span>&nbsp;<span class="ident" id="4860313">p</span><span class="op" id="4860314">.</span><span class="ident" id="4860315">tok</span>&nbsp;<span class="op" id="4860319">!=</span>&nbsp;<span class="ident" id="4860322">token</span><span class="op" id="4860327">.</span><span class="ident" id="4860328">LBRACE</span>&nbsp;<span class="op" id="4860335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4860339">//&nbsp;function&nbsp;type&nbsp;only</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860363">return</span>&nbsp;<span class="ident" id="4860370">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860379">p</span><span class="op" id="4860380">.</span><span class="ident" id="4860381">exprLev</span><span class="op" id="4860388">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860392">body</span>&nbsp;<span class="op" id="4860397">:=</span>&nbsp;<span class="ident" id="4860400">p</span><span class="op" id="4860401">.</span><span class="ident" id="4860402">parseBody</span><span class="op" id="4860411">(</span><span class="ident" id="4860412">scope</span><span class="op" id="4860417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860420">p</span><span class="op" id="4860421">.</span><span class="ident" id="4860422">exprLev</span><span class="op" id="4860429">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860434">return</span>&nbsp;<span class="op" id="4860441">&amp;</span><span class="ident" id="4860442">ast</span><span class="op" id="4860445">.</span><span class="ident" id="4860446">FuncLit</span><span class="op" id="4860453">{</span><span class="ident" id="4860454">Type</span><span class="op" id="4860458">:</span>&nbsp;<span class="ident" id="4860460">typ</span><span class="op" id="4860463">,</span>&nbsp;<span class="ident" id="4860465">Body</span><span class="op" id="4860469">:</span>&nbsp;<span class="ident" id="4860471">body</span><span class="op" id="4860475">}</span><br>
<span class="lineno">1110</span><span class="op" id="4860477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4860480">//&nbsp;parseOperand&nbsp;may&nbsp;return&nbsp;an&nbsp;expression&nbsp;or&nbsp;a&nbsp;raw&nbsp;type&nbsp;(incl.&nbsp;array</span><br>
<span class="lineno"></span><span class="comment" id="4860548">//&nbsp;types&nbsp;of&nbsp;the&nbsp;form&nbsp;[...]T.&nbsp;Callers&nbsp;must&nbsp;verify&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="4860609">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno">1115</span><span class="comment" id="4860679">//</span><br>
<span class="lineno"></span><span class="keyword" id="4860682">func</span>&nbsp;<span class="op" id="4860687">(</span><span class="ident" id="4860688">p</span>&nbsp;<span class="op" id="4860690">*</span><span class="ident" id="4860691">parser</span><span class="op" id="4860697">)</span>&nbsp;<span class="ident" id="4860699">parseOperand</span><span class="op" id="4860711">(</span><span class="ident" id="4860712">lhs</span>&nbsp;<span class="builtintype" id="4860716">bool</span><span class="op" id="4860720">)</span>&nbsp;<span class="ident" id="4860722">ast</span><span class="op" id="4860725">.</span><span class="ident" id="4860726">Expr</span>&nbsp;<span class="op" id="4860731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860734">if</span>&nbsp;<span class="ident" id="4860737">p</span><span class="op" id="4860738">.</span><span class="ident" id="4860739">trace</span>&nbsp;<span class="op" id="4860745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860749">defer</span>&nbsp;<span class="ident" id="4860755">un</span><span class="op" id="4860757">(</span><span class="ident" id="4860758">trace</span><span class="op" id="4860763">(</span><span class="ident" id="4860764">p</span><span class="op" id="4860765">,</span>&nbsp;<span class="string" id="4860767">&#34;Operand&#34;</span><span class="op" id="4860776">)</span><span class="op" id="4860777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860780">}</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860784">switch</span>&nbsp;<span class="ident" id="4860791">p</span><span class="op" id="4860792">.</span><span class="ident" id="4860793">tok</span>&nbsp;<span class="op" id="4860797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860800">case</span>&nbsp;<span class="ident" id="4860805">token</span><span class="op" id="4860810">.</span><span class="ident" id="4860811">IDENT</span><span class="op" id="4860816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860820">x</span>&nbsp;<span class="op" id="4860822">:=</span>&nbsp;<span class="ident" id="4860825">p</span><span class="op" id="4860826">.</span><span class="ident" id="4860827">parseIdent</span><span class="op" id="4860837">(</span><span class="op" id="4860838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860842">if</span>&nbsp;<span class="op" id="4860845">!</span><span class="ident" id="4860846">lhs</span>&nbsp;<span class="op" id="4860850">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860855">p</span><span class="op" id="4860856">.</span><span class="ident" id="4860857">resolve</span><span class="op" id="4860864">(</span><span class="ident" id="4860865">x</span><span class="op" id="4860866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860874">return</span>&nbsp;<span class="ident" id="4860881">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860885">case</span>&nbsp;<span class="ident" id="4860890">token</span><span class="op" id="4860895">.</span><span class="ident" id="4860896">INT</span><span class="op" id="4860899">,</span>&nbsp;<span class="ident" id="4860901">token</span><span class="op" id="4860906">.</span><span class="ident" id="4860907">FLOAT</span><span class="op" id="4860912">,</span>&nbsp;<span class="ident" id="4860914">token</span><span class="op" id="4860919">.</span><span class="ident" id="4860920">IMAG</span><span class="op" id="4860924">,</span>&nbsp;<span class="ident" id="4860926">token</span><span class="op" id="4860931">.</span><span class="ident" id="4860932">CHAR</span><span class="op" id="4860936">,</span>&nbsp;<span class="ident" id="4860938">token</span><span class="op" id="4860943">.</span><span class="ident" id="4860944">STRING</span><span class="op" id="4860950">:</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860954">x</span>&nbsp;<span class="op" id="4860956">:=</span>&nbsp;<span class="op" id="4860959">&amp;</span><span class="ident" id="4860960">ast</span><span class="op" id="4860963">.</span><span class="ident" id="4860964">BasicLit</span><span class="op" id="4860972">{</span><span class="ident" id="4860973">ValuePos</span><span class="op" id="4860981">:</span>&nbsp;<span class="ident" id="4860983">p</span><span class="op" id="4860984">.</span><span class="ident" id="4860985">pos</span><span class="op" id="4860988">,</span>&nbsp;<span class="ident" id="4860990">Kind</span><span class="op" id="4860994">:</span>&nbsp;<span class="ident" id="4860996">p</span><span class="op" id="4860997">.</span><span class="ident" id="4860998">tok</span><span class="op" id="4861001">,</span>&nbsp;<span class="ident" id="4861003">Value</span><span class="op" id="4861008">:</span>&nbsp;<span class="ident" id="4861010">p</span><span class="op" id="4861011">.</span><span class="ident" id="4861012">lit</span><span class="op" id="4861015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861019">p</span><span class="op" id="4861020">.</span><span class="ident" id="4861021">next</span><span class="op" id="4861025">(</span><span class="op" id="4861026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861030">return</span>&nbsp;<span class="ident" id="4861037">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861041">case</span>&nbsp;<span class="ident" id="4861046">token</span><span class="op" id="4861051">.</span><span class="ident" id="4861052">LPAREN</span><span class="op" id="4861058">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861062">lparen</span>&nbsp;<span class="op" id="4861069">:=</span>&nbsp;<span class="ident" id="4861072">p</span><span class="op" id="4861073">.</span><span class="ident" id="4861074">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861080">p</span><span class="op" id="4861081">.</span><span class="ident" id="4861082">next</span><span class="op" id="4861086">(</span><span class="op" id="4861087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861091">p</span><span class="op" id="4861092">.</span><span class="ident" id="4861093">exprLev</span><span class="op" id="4861100">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861105">x</span>&nbsp;<span class="op" id="4861107">:=</span>&nbsp;<span class="ident" id="4861110">p</span><span class="op" id="4861111">.</span><span class="ident" id="4861112">parseRhsOrType</span><span class="op" id="4861126">(</span><span class="op" id="4861127">)</span>&nbsp;<span class="comment" id="4861129">//&nbsp;types&nbsp;may&nbsp;be&nbsp;parenthesized:&nbsp;(some&nbsp;type)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861174">p</span><span class="op" id="4861175">.</span><span class="ident" id="4861176">exprLev</span><span class="op" id="4861183">--</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861188">rparen</span>&nbsp;<span class="op" id="4861195">:=</span>&nbsp;<span class="ident" id="4861198">p</span><span class="op" id="4861199">.</span><span class="ident" id="4861200">expect</span><span class="op" id="4861206">(</span><span class="ident" id="4861207">token</span><span class="op" id="4861212">.</span><span class="ident" id="4861213">RPAREN</span><span class="op" id="4861219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861223">return</span>&nbsp;<span class="op" id="4861230">&amp;</span><span class="ident" id="4861231">ast</span><span class="op" id="4861234">.</span><span class="ident" id="4861235">ParenExpr</span><span class="op" id="4861244">{</span><span class="ident" id="4861245">Lparen</span><span class="op" id="4861251">:</span>&nbsp;<span class="ident" id="4861253">lparen</span><span class="op" id="4861259">,</span>&nbsp;<span class="ident" id="4861261">X</span><span class="op" id="4861262">:</span>&nbsp;<span class="ident" id="4861264">x</span><span class="op" id="4861265">,</span>&nbsp;<span class="ident" id="4861267">Rparen</span><span class="op" id="4861273">:</span>&nbsp;<span class="ident" id="4861275">rparen</span><span class="op" id="4861281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861285">case</span>&nbsp;<span class="ident" id="4861290">token</span><span class="op" id="4861295">.</span><span class="ident" id="4861296">FUNC</span><span class="op" id="4861300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861304">return</span>&nbsp;<span class="ident" id="4861311">p</span><span class="op" id="4861312">.</span><span class="ident" id="4861313">parseFuncTypeOrLit</span><span class="op" id="4861331">(</span><span class="op" id="4861332">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861339">if</span>&nbsp;<span class="ident" id="4861342">typ</span>&nbsp;<span class="op" id="4861346">:=</span>&nbsp;<span class="ident" id="4861349">p</span><span class="op" id="4861350">.</span><span class="ident" id="4861351">tryIdentOrType</span><span class="op" id="4861365">(</span><span class="op" id="4861366">)</span><span class="op" id="4861367">;</span>&nbsp;<span class="ident" id="4861369">typ</span>&nbsp;<span class="op" id="4861373">!=</span>&nbsp;<span class="builtintype" id="4861376">nil</span>&nbsp;<span class="op" id="4861380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4861384">//&nbsp;could&nbsp;be&nbsp;type&nbsp;for&nbsp;composite&nbsp;literal&nbsp;or&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861439">_</span><span class="op" id="4861440">,</span>&nbsp;<span class="ident" id="4861442">isIdent</span>&nbsp;<span class="op" id="4861450">:=</span>&nbsp;<span class="ident" id="4861453">typ</span><span class="op" id="4861456">.</span><span class="op" id="4861457">(</span><span class="op" id="4861458">*</span><span class="ident" id="4861459">ast</span><span class="op" id="4861462">.</span><span class="ident" id="4861463">Ident</span><span class="op" id="4861468">)</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861472">assert</span><span class="op" id="4861478">(</span><span class="op" id="4861479">!</span><span class="ident" id="4861480">isIdent</span><span class="op" id="4861487">,</span>&nbsp;<span class="string" id="4861489">&#34;type&nbsp;cannot&nbsp;be&nbsp;identifier&#34;</span><span class="op" id="4861516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861520">return</span>&nbsp;<span class="ident" id="4861527">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4861536">//&nbsp;we&nbsp;have&nbsp;an&nbsp;error</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861557">pos</span>&nbsp;<span class="op" id="4861561">:=</span>&nbsp;<span class="ident" id="4861564">p</span><span class="op" id="4861565">.</span><span class="ident" id="4861566">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861571">p</span><span class="op" id="4861572">.</span><span class="ident" id="4861573">errorExpected</span><span class="op" id="4861586">(</span><span class="ident" id="4861587">pos</span><span class="op" id="4861590">,</span>&nbsp;<span class="string" id="4861592">&#34;operand&#34;</span><span class="op" id="4861601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861604">syncStmt</span><span class="op" id="4861612">(</span><span class="ident" id="4861613">p</span><span class="op" id="4861614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861617">return</span>&nbsp;<span class="op" id="4861624">&amp;</span><span class="ident" id="4861625">ast</span><span class="op" id="4861628">.</span><span class="ident" id="4861629">BadExpr</span><span class="op" id="4861636">{</span><span class="ident" id="4861637">From</span><span class="op" id="4861641">:</span>&nbsp;<span class="ident" id="4861643">pos</span><span class="op" id="4861646">,</span>&nbsp;<span class="ident" id="4861648">To</span><span class="op" id="4861650">:</span>&nbsp;<span class="ident" id="4861652">p</span><span class="op" id="4861653">.</span><span class="ident" id="4861654">pos</span><span class="op" id="4861657">}</span><br>
<span class="lineno"></span><span class="op" id="4861659">}</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span><span class="keyword" id="4861662">func</span>&nbsp;<span class="op" id="4861667">(</span><span class="ident" id="4861668">p</span>&nbsp;<span class="op" id="4861670">*</span><span class="ident" id="4861671">parser</span><span class="op" id="4861677">)</span>&nbsp;<span class="ident" id="4861679">parseSelector</span><span class="op" id="4861692">(</span><span class="ident" id="4861693">x</span>&nbsp;<span class="ident" id="4861695">ast</span><span class="op" id="4861698">.</span><span class="ident" id="4861699">Expr</span><span class="op" id="4861703">)</span>&nbsp;<span class="ident" id="4861705">ast</span><span class="op" id="4861708">.</span><span class="ident" id="4861709">Expr</span>&nbsp;<span class="op" id="4861714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861717">if</span>&nbsp;<span class="ident" id="4861720">p</span><span class="op" id="4861721">.</span><span class="ident" id="4861722">trace</span>&nbsp;<span class="op" id="4861728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861732">defer</span>&nbsp;<span class="ident" id="4861738">un</span><span class="op" id="4861740">(</span><span class="ident" id="4861741">trace</span><span class="op" id="4861746">(</span><span class="ident" id="4861747">p</span><span class="op" id="4861748">,</span>&nbsp;<span class="string" id="4861750">&#34;Selector&#34;</span><span class="op" id="4861760">)</span><span class="op" id="4861761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861764">}</span><br>
<span class="lineno">1165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861768">sel</span>&nbsp;<span class="op" id="4861772">:=</span>&nbsp;<span class="ident" id="4861775">p</span><span class="op" id="4861776">.</span><span class="ident" id="4861777">parseIdent</span><span class="op" id="4861787">(</span><span class="op" id="4861788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861792">return</span>&nbsp;<span class="op" id="4861799">&amp;</span><span class="ident" id="4861800">ast</span><span class="op" id="4861803">.</span><span class="ident" id="4861804">SelectorExpr</span><span class="op" id="4861816">{</span><span class="ident" id="4861817">X</span><span class="op" id="4861818">:</span>&nbsp;<span class="ident" id="4861820">x</span><span class="op" id="4861821">,</span>&nbsp;<span class="ident" id="4861823">Sel</span><span class="op" id="4861826">:</span>&nbsp;<span class="ident" id="4861828">sel</span><span class="op" id="4861831">}</span><br>
<span class="lineno"></span><span class="op" id="4861833">}</span><br>
<span class="lineno">1170</span><br>
<span class="lineno"></span><span class="keyword" id="4861836">func</span>&nbsp;<span class="op" id="4861841">(</span><span class="ident" id="4861842">p</span>&nbsp;<span class="op" id="4861844">*</span><span class="ident" id="4861845">parser</span><span class="op" id="4861851">)</span>&nbsp;<span class="ident" id="4861853">parseTypeAssertion</span><span class="op" id="4861871">(</span><span class="ident" id="4861872">x</span>&nbsp;<span class="ident" id="4861874">ast</span><span class="op" id="4861877">.</span><span class="ident" id="4861878">Expr</span><span class="op" id="4861882">)</span>&nbsp;<span class="ident" id="4861884">ast</span><span class="op" id="4861887">.</span><span class="ident" id="4861888">Expr</span>&nbsp;<span class="op" id="4861893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861896">if</span>&nbsp;<span class="ident" id="4861899">p</span><span class="op" id="4861900">.</span><span class="ident" id="4861901">trace</span>&nbsp;<span class="op" id="4861907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861911">defer</span>&nbsp;<span class="ident" id="4861917">un</span><span class="op" id="4861919">(</span><span class="ident" id="4861920">trace</span><span class="op" id="4861925">(</span><span class="ident" id="4861926">p</span><span class="op" id="4861927">,</span>&nbsp;<span class="string" id="4861929">&#34;TypeAssertion&#34;</span><span class="op" id="4861944">)</span><span class="op" id="4861945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861948">}</span><br>
<span class="lineno">1175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861952">lparen</span>&nbsp;<span class="op" id="4861959">:=</span>&nbsp;<span class="ident" id="4861962">p</span><span class="op" id="4861963">.</span><span class="ident" id="4861964">expect</span><span class="op" id="4861970">(</span><span class="ident" id="4861971">token</span><span class="op" id="4861976">.</span><span class="ident" id="4861977">LPAREN</span><span class="op" id="4861983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861986">var</span>&nbsp;<span class="ident" id="4861990">typ</span>&nbsp;<span class="ident" id="4861994">ast</span><span class="op" id="4861997">.</span><span class="ident" id="4861998">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862004">if</span>&nbsp;<span class="ident" id="4862007">p</span><span class="op" id="4862008">.</span><span class="ident" id="4862009">tok</span>&nbsp;<span class="op" id="4862013">==</span>&nbsp;<span class="ident" id="4862016">token</span><span class="op" id="4862021">.</span><span class="ident" id="4862022">TYPE</span>&nbsp;<span class="op" id="4862027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862031">//&nbsp;type&nbsp;switch:&nbsp;typ&nbsp;==&nbsp;nil</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862060">p</span><span class="op" id="4862061">.</span><span class="ident" id="4862062">next</span><span class="op" id="4862066">(</span><span class="op" id="4862067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862070">}</span>&nbsp;<span class="keyword" id="4862072">else</span>&nbsp;<span class="op" id="4862077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862081">typ</span>&nbsp;<span class="op" id="4862085">=</span>&nbsp;<span class="ident" id="4862087">p</span><span class="op" id="4862088">.</span><span class="ident" id="4862089">parseType</span><span class="op" id="4862098">(</span><span class="op" id="4862099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862105">rparen</span>&nbsp;<span class="op" id="4862112">:=</span>&nbsp;<span class="ident" id="4862115">p</span><span class="op" id="4862116">.</span><span class="ident" id="4862117">expect</span><span class="op" id="4862123">(</span><span class="ident" id="4862124">token</span><span class="op" id="4862129">.</span><span class="ident" id="4862130">RPAREN</span><span class="op" id="4862136">)</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862140">return</span>&nbsp;<span class="op" id="4862147">&amp;</span><span class="ident" id="4862148">ast</span><span class="op" id="4862151">.</span><span class="ident" id="4862152">TypeAssertExpr</span><span class="op" id="4862166">{</span><span class="ident" id="4862167">X</span><span class="op" id="4862168">:</span>&nbsp;<span class="ident" id="4862170">x</span><span class="op" id="4862171">,</span>&nbsp;<span class="ident" id="4862173">Type</span><span class="op" id="4862177">:</span>&nbsp;<span class="ident" id="4862179">typ</span><span class="op" id="4862182">,</span>&nbsp;<span class="ident" id="4862184">Lparen</span><span class="op" id="4862190">:</span>&nbsp;<span class="ident" id="4862192">lparen</span><span class="op" id="4862198">,</span>&nbsp;<span class="ident" id="4862200">Rparen</span><span class="op" id="4862206">:</span>&nbsp;<span class="ident" id="4862208">rparen</span><span class="op" id="4862214">}</span><br>
<span class="lineno"></span><span class="op" id="4862216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4862219">func</span>&nbsp;<span class="op" id="4862224">(</span><span class="ident" id="4862225">p</span>&nbsp;<span class="op" id="4862227">*</span><span class="ident" id="4862228">parser</span><span class="op" id="4862234">)</span>&nbsp;<span class="ident" id="4862236">parseIndexOrSlice</span><span class="op" id="4862253">(</span><span class="ident" id="4862254">x</span>&nbsp;<span class="ident" id="4862256">ast</span><span class="op" id="4862259">.</span><span class="ident" id="4862260">Expr</span><span class="op" id="4862264">)</span>&nbsp;<span class="ident" id="4862266">ast</span><span class="op" id="4862269">.</span><span class="ident" id="4862270">Expr</span>&nbsp;<span class="op" id="4862275">{</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862278">if</span>&nbsp;<span class="ident" id="4862281">p</span><span class="op" id="4862282">.</span><span class="ident" id="4862283">trace</span>&nbsp;<span class="op" id="4862289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862293">defer</span>&nbsp;<span class="ident" id="4862299">un</span><span class="op" id="4862301">(</span><span class="ident" id="4862302">trace</span><span class="op" id="4862307">(</span><span class="ident" id="4862308">p</span><span class="op" id="4862309">,</span>&nbsp;<span class="string" id="4862311">&#34;IndexOrSlice&#34;</span><span class="op" id="4862325">)</span><span class="op" id="4862326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862333">const</span>&nbsp;<span class="ident" id="4862339">N</span>&nbsp;<span class="op" id="4862341">=</span>&nbsp;<span class="num" id="4862343">3</span>&nbsp;<span class="comment" id="4862345">//&nbsp;change&nbsp;the&nbsp;3&nbsp;to&nbsp;2&nbsp;to&nbsp;disable&nbsp;3-index&nbsp;slices</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862393">lbrack</span>&nbsp;<span class="op" id="4862400">:=</span>&nbsp;<span class="ident" id="4862403">p</span><span class="op" id="4862404">.</span><span class="ident" id="4862405">expect</span><span class="op" id="4862411">(</span><span class="ident" id="4862412">token</span><span class="op" id="4862417">.</span><span class="ident" id="4862418">LBRACK</span><span class="op" id="4862424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862427">p</span><span class="op" id="4862428">.</span><span class="ident" id="4862429">exprLev</span><span class="op" id="4862436">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862440">var</span>&nbsp;<span class="ident" id="4862444">index</span>&nbsp;<span class="op" id="4862450">[</span><span class="ident" id="4862451">N</span><span class="op" id="4862452">]</span><span class="ident" id="4862453">ast</span><span class="op" id="4862456">.</span><span class="ident" id="4862457">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862463">var</span>&nbsp;<span class="ident" id="4862467">colons</span>&nbsp;<span class="op" id="4862474">[</span><span class="ident" id="4862475">N</span>&nbsp;<span class="op" id="4862477">-</span>&nbsp;<span class="num" id="4862479">1</span><span class="op" id="4862480">]</span><span class="ident" id="4862481">token</span><span class="op" id="4862486">.</span><span class="ident" id="4862487">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862492">if</span>&nbsp;<span class="ident" id="4862495">p</span><span class="op" id="4862496">.</span><span class="ident" id="4862497">tok</span>&nbsp;<span class="op" id="4862501">!=</span>&nbsp;<span class="ident" id="4862504">token</span><span class="op" id="4862509">.</span><span class="ident" id="4862510">COLON</span>&nbsp;<span class="op" id="4862516">{</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862520">index</span><span class="op" id="4862525">[</span><span class="num" id="4862526">0</span><span class="op" id="4862527">]</span>&nbsp;<span class="op" id="4862529">=</span>&nbsp;<span class="ident" id="4862531">p</span><span class="op" id="4862532">.</span><span class="ident" id="4862533">parseRhs</span><span class="op" id="4862541">(</span><span class="op" id="4862542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862548">ncolons</span>&nbsp;<span class="op" id="4862556">:=</span>&nbsp;<span class="num" id="4862559">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862562">for</span>&nbsp;<span class="ident" id="4862566">p</span><span class="op" id="4862567">.</span><span class="ident" id="4862568">tok</span>&nbsp;<span class="op" id="4862572">==</span>&nbsp;<span class="ident" id="4862575">token</span><span class="op" id="4862580">.</span><span class="ident" id="4862581">COLON</span>&nbsp;<span class="op" id="4862587">&amp;&amp;</span>&nbsp;<span class="ident" id="4862590">ncolons</span>&nbsp;<span class="op" id="4862598">&lt;</span>&nbsp;<span class="builtinfunc" id="4862600">len</span><span class="op" id="4862603">(</span><span class="ident" id="4862604">colons</span><span class="op" id="4862610">)</span>&nbsp;<span class="op" id="4862612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862616">colons</span><span class="op" id="4862622">[</span><span class="ident" id="4862623">ncolons</span><span class="op" id="4862630">]</span>&nbsp;<span class="op" id="4862632">=</span>&nbsp;<span class="ident" id="4862634">p</span><span class="op" id="4862635">.</span><span class="ident" id="4862636">pos</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862642">ncolons</span><span class="op" id="4862649">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862654">p</span><span class="op" id="4862655">.</span><span class="ident" id="4862656">next</span><span class="op" id="4862660">(</span><span class="op" id="4862661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862665">if</span>&nbsp;<span class="ident" id="4862668">p</span><span class="op" id="4862669">.</span><span class="ident" id="4862670">tok</span>&nbsp;<span class="op" id="4862674">!=</span>&nbsp;<span class="ident" id="4862677">token</span><span class="op" id="4862682">.</span><span class="ident" id="4862683">COLON</span>&nbsp;<span class="op" id="4862689">&amp;&amp;</span>&nbsp;<span class="ident" id="4862692">p</span><span class="op" id="4862693">.</span><span class="ident" id="4862694">tok</span>&nbsp;<span class="op" id="4862698">!=</span>&nbsp;<span class="ident" id="4862701">token</span><span class="op" id="4862706">.</span><span class="ident" id="4862707">RBRACK</span>&nbsp;<span class="op" id="4862714">&amp;&amp;</span>&nbsp;<span class="ident" id="4862717">p</span><span class="op" id="4862718">.</span><span class="ident" id="4862719">tok</span>&nbsp;<span class="op" id="4862723">!=</span>&nbsp;<span class="ident" id="4862726">token</span><span class="op" id="4862731">.</span><span class="ident" id="4862732">EOF</span>&nbsp;<span class="op" id="4862736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862741">index</span><span class="op" id="4862746">[</span><span class="ident" id="4862747">ncolons</span><span class="op" id="4862754">]</span>&nbsp;<span class="op" id="4862756">=</span>&nbsp;<span class="ident" id="4862758">p</span><span class="op" id="4862759">.</span><span class="ident" id="4862760">parseRhs</span><span class="op" id="4862768">(</span><span class="op" id="4862769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862773">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862779">p</span><span class="op" id="4862780">.</span><span class="ident" id="4862781">exprLev</span><span class="op" id="4862788">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862792">rbrack</span>&nbsp;<span class="op" id="4862799">:=</span>&nbsp;<span class="ident" id="4862802">p</span><span class="op" id="4862803">.</span><span class="ident" id="4862804">expect</span><span class="op" id="4862810">(</span><span class="ident" id="4862811">token</span><span class="op" id="4862816">.</span><span class="ident" id="4862817">RBRACK</span><span class="op" id="4862823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862827">if</span>&nbsp;<span class="ident" id="4862830">ncolons</span>&nbsp;<span class="op" id="4862838">&gt;</span>&nbsp;<span class="num" id="4862840">0</span>&nbsp;<span class="op" id="4862842">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862846">//&nbsp;slice&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862868">slice3</span>&nbsp;<span class="op" id="4862875">:=</span>&nbsp;<span class="builtintype" id="4862878">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862886">if</span>&nbsp;<span class="ident" id="4862889">ncolons</span>&nbsp;<span class="op" id="4862897">==</span>&nbsp;<span class="num" id="4862900">2</span>&nbsp;<span class="op" id="4862902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862907">slice3</span>&nbsp;<span class="op" id="4862914">=</span>&nbsp;<span class="builtintype" id="4862916">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862924">//&nbsp;Check&nbsp;presence&nbsp;of&nbsp;2nd&nbsp;and&nbsp;3rd&nbsp;index&nbsp;here&nbsp;rather&nbsp;than&nbsp;during&nbsp;type-checking</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863004">//&nbsp;to&nbsp;prevent&nbsp;erroneous&nbsp;programs&nbsp;from&nbsp;passing&nbsp;through&nbsp;gofmt&nbsp;(was&nbsp;issue&nbsp;7305).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863085">if</span>&nbsp;<span class="ident" id="4863088">index</span><span class="op" id="4863093">[</span><span class="num" id="4863094">1</span><span class="op" id="4863095">]</span>&nbsp;<span class="op" id="4863097">==</span>&nbsp;<span class="builtintype" id="4863100">nil</span>&nbsp;<span class="op" id="4863104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863110">p</span><span class="op" id="4863111">.</span><span class="builtintype" id="4863112">error</span><span class="op" id="4863117">(</span><span class="ident" id="4863118">colons</span><span class="op" id="4863124">[</span><span class="num" id="4863125">0</span><span class="op" id="4863126">]</span><span class="op" id="4863127">,</span>&nbsp;<span class="string" id="4863129">&#34;2nd&nbsp;index&nbsp;required&nbsp;in&nbsp;3-index&nbsp;slice&#34;</span><span class="op" id="4863166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863172">index</span><span class="op" id="4863177">[</span><span class="num" id="4863178">1</span><span class="op" id="4863179">]</span>&nbsp;<span class="op" id="4863181">=</span>&nbsp;<span class="op" id="4863183">&amp;</span><span class="ident" id="4863184">ast</span><span class="op" id="4863187">.</span><span class="ident" id="4863188">BadExpr</span><span class="op" id="4863195">{</span><span class="ident" id="4863196">From</span><span class="op" id="4863200">:</span>&nbsp;<span class="ident" id="4863202">colons</span><span class="op" id="4863208">[</span><span class="num" id="4863209">0</span><span class="op" id="4863210">]</span>&nbsp;<span class="op" id="4863212">+</span>&nbsp;<span class="num" id="4863214">1</span><span class="op" id="4863215">,</span>&nbsp;<span class="ident" id="4863217">To</span><span class="op" id="4863219">:</span>&nbsp;<span class="ident" id="4863221">colons</span><span class="op" id="4863227">[</span><span class="num" id="4863228">1</span><span class="op" id="4863229">]</span><span class="op" id="4863230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863235">}</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863240">if</span>&nbsp;<span class="ident" id="4863243">index</span><span class="op" id="4863248">[</span><span class="num" id="4863249">2</span><span class="op" id="4863250">]</span>&nbsp;<span class="op" id="4863252">==</span>&nbsp;<span class="builtintype" id="4863255">nil</span>&nbsp;<span class="op" id="4863259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863265">p</span><span class="op" id="4863266">.</span><span class="builtintype" id="4863267">error</span><span class="op" id="4863272">(</span><span class="ident" id="4863273">colons</span><span class="op" id="4863279">[</span><span class="num" id="4863280">1</span><span class="op" id="4863281">]</span><span class="op" id="4863282">,</span>&nbsp;<span class="string" id="4863284">&#34;3rd&nbsp;index&nbsp;required&nbsp;in&nbsp;3-index&nbsp;slice&#34;</span><span class="op" id="4863321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863327">index</span><span class="op" id="4863332">[</span><span class="num" id="4863333">2</span><span class="op" id="4863334">]</span>&nbsp;<span class="op" id="4863336">=</span>&nbsp;<span class="op" id="4863338">&amp;</span><span class="ident" id="4863339">ast</span><span class="op" id="4863342">.</span><span class="ident" id="4863343">BadExpr</span><span class="op" id="4863350">{</span><span class="ident" id="4863351">From</span><span class="op" id="4863355">:</span>&nbsp;<span class="ident" id="4863357">colons</span><span class="op" id="4863363">[</span><span class="num" id="4863364">1</span><span class="op" id="4863365">]</span>&nbsp;<span class="op" id="4863367">+</span>&nbsp;<span class="num" id="4863369">1</span><span class="op" id="4863370">,</span>&nbsp;<span class="ident" id="4863372">To</span><span class="op" id="4863374">:</span>&nbsp;<span class="ident" id="4863376">rbrack</span><span class="op" id="4863382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863391">}</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863395">return</span>&nbsp;<span class="op" id="4863402">&amp;</span><span class="ident" id="4863403">ast</span><span class="op" id="4863406">.</span><span class="ident" id="4863407">SliceExpr</span><span class="op" id="4863416">{</span><span class="ident" id="4863417">X</span><span class="op" id="4863418">:</span>&nbsp;<span class="ident" id="4863420">x</span><span class="op" id="4863421">,</span>&nbsp;<span class="ident" id="4863423">Lbrack</span><span class="op" id="4863429">:</span>&nbsp;<span class="ident" id="4863431">lbrack</span><span class="op" id="4863437">,</span>&nbsp;<span class="ident" id="4863439">Low</span><span class="op" id="4863442">:</span>&nbsp;<span class="ident" id="4863444">index</span><span class="op" id="4863449">[</span><span class="num" id="4863450">0</span><span class="op" id="4863451">]</span><span class="op" id="4863452">,</span>&nbsp;<span class="ident" id="4863454">High</span><span class="op" id="4863458">:</span>&nbsp;<span class="ident" id="4863460">index</span><span class="op" id="4863465">[</span><span class="num" id="4863466">1</span><span class="op" id="4863467">]</span><span class="op" id="4863468">,</span>&nbsp;<span class="ident" id="4863470">Max</span><span class="op" id="4863473">:</span>&nbsp;<span class="ident" id="4863475">index</span><span class="op" id="4863480">[</span><span class="num" id="4863481">2</span><span class="op" id="4863482">]</span><span class="op" id="4863483">,</span>&nbsp;<span class="ident" id="4863485">Slice3</span><span class="op" id="4863491">:</span>&nbsp;<span class="ident" id="4863493">slice3</span><span class="op" id="4863499">,</span>&nbsp;<span class="ident" id="4863501">Rbrack</span><span class="op" id="4863507">:</span>&nbsp;<span class="ident" id="4863509">rbrack</span><span class="op" id="4863515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863522">return</span>&nbsp;<span class="op" id="4863529">&amp;</span><span class="ident" id="4863530">ast</span><span class="op" id="4863533">.</span><span class="ident" id="4863534">IndexExpr</span><span class="op" id="4863543">{</span><span class="ident" id="4863544">X</span><span class="op" id="4863545">:</span>&nbsp;<span class="ident" id="4863547">x</span><span class="op" id="4863548">,</span>&nbsp;<span class="ident" id="4863550">Lbrack</span><span class="op" id="4863556">:</span>&nbsp;<span class="ident" id="4863558">lbrack</span><span class="op" id="4863564">,</span>&nbsp;<span class="ident" id="4863566">Index</span><span class="op" id="4863571">:</span>&nbsp;<span class="ident" id="4863573">index</span><span class="op" id="4863578">[</span><span class="num" id="4863579">0</span><span class="op" id="4863580">]</span><span class="op" id="4863581">,</span>&nbsp;<span class="ident" id="4863583">Rbrack</span><span class="op" id="4863589">:</span>&nbsp;<span class="ident" id="4863591">rbrack</span><span class="op" id="4863597">}</span><br>
<span class="lineno"></span><span class="op" id="4863599">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4863602">func</span>&nbsp;<span class="op" id="4863607">(</span><span class="ident" id="4863608">p</span>&nbsp;<span class="op" id="4863610">*</span><span class="ident" id="4863611">parser</span><span class="op" id="4863617">)</span>&nbsp;<span class="ident" id="4863619">parseCallOrConversion</span><span class="op" id="4863640">(</span><span class="ident" id="4863641">fun</span>&nbsp;<span class="ident" id="4863645">ast</span><span class="op" id="4863648">.</span><span class="ident" id="4863649">Expr</span><span class="op" id="4863653">)</span>&nbsp;<span class="op" id="4863655">*</span><span class="ident" id="4863656">ast</span><span class="op" id="4863659">.</span><span class="ident" id="4863660">CallExpr</span>&nbsp;<span class="op" id="4863669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863672">if</span>&nbsp;<span class="ident" id="4863675">p</span><span class="op" id="4863676">.</span><span class="ident" id="4863677">trace</span>&nbsp;<span class="op" id="4863683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863687">defer</span>&nbsp;<span class="ident" id="4863693">un</span><span class="op" id="4863695">(</span><span class="ident" id="4863696">trace</span><span class="op" id="4863701">(</span><span class="ident" id="4863702">p</span><span class="op" id="4863703">,</span>&nbsp;<span class="string" id="4863705">&#34;CallOrConversion&#34;</span><span class="op" id="4863723">)</span><span class="op" id="4863724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863727">}</span><br>
<span class="lineno">1240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863731">lparen</span>&nbsp;<span class="op" id="4863738">:=</span>&nbsp;<span class="ident" id="4863741">p</span><span class="op" id="4863742">.</span><span class="ident" id="4863743">expect</span><span class="op" id="4863749">(</span><span class="ident" id="4863750">token</span><span class="op" id="4863755">.</span><span class="ident" id="4863756">LPAREN</span><span class="op" id="4863762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863765">p</span><span class="op" id="4863766">.</span><span class="ident" id="4863767">exprLev</span><span class="op" id="4863774">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863778">var</span>&nbsp;<span class="ident" id="4863782">list</span>&nbsp;<span class="op" id="4863787">[</span><span class="op" id="4863788">]</span><span class="ident" id="4863789">ast</span><span class="op" id="4863792">.</span><span class="ident" id="4863793">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863799">var</span>&nbsp;<span class="ident" id="4863803">ellipsis</span>&nbsp;<span class="ident" id="4863812">token</span><span class="op" id="4863817">.</span><span class="ident" id="4863818">Pos</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863823">for</span>&nbsp;<span class="ident" id="4863827">p</span><span class="op" id="4863828">.</span><span class="ident" id="4863829">tok</span>&nbsp;<span class="op" id="4863833">!=</span>&nbsp;<span class="ident" id="4863836">token</span><span class="op" id="4863841">.</span><span class="ident" id="4863842">RPAREN</span>&nbsp;<span class="op" id="4863849">&amp;&amp;</span>&nbsp;<span class="ident" id="4863852">p</span><span class="op" id="4863853">.</span><span class="ident" id="4863854">tok</span>&nbsp;<span class="op" id="4863858">!=</span>&nbsp;<span class="ident" id="4863861">token</span><span class="op" id="4863866">.</span><span class="ident" id="4863867">EOF</span>&nbsp;<span class="op" id="4863871">&amp;&amp;</span>&nbsp;<span class="op" id="4863874">!</span><span class="ident" id="4863875">ellipsis</span><span class="op" id="4863883">.</span><span class="ident" id="4863884">IsValid</span><span class="op" id="4863891">(</span><span class="op" id="4863892">)</span>&nbsp;<span class="op" id="4863894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863898">list</span>&nbsp;<span class="op" id="4863903">=</span>&nbsp;<span class="builtinfunc" id="4863905">append</span><span class="op" id="4863911">(</span><span class="ident" id="4863912">list</span><span class="op" id="4863916">,</span>&nbsp;<span class="ident" id="4863918">p</span><span class="op" id="4863919">.</span><span class="ident" id="4863920">parseRhsOrType</span><span class="op" id="4863934">(</span><span class="op" id="4863935">)</span><span class="op" id="4863936">)</span>&nbsp;<span class="comment" id="4863938">//&nbsp;builtins&nbsp;may&nbsp;expect&nbsp;a&nbsp;type:&nbsp;make(some&nbsp;type,&nbsp;...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863992">if</span>&nbsp;<span class="ident" id="4863995">p</span><span class="op" id="4863996">.</span><span class="ident" id="4863997">tok</span>&nbsp;<span class="op" id="4864001">==</span>&nbsp;<span class="ident" id="4864004">token</span><span class="op" id="4864009">.</span><span class="ident" id="4864010">ELLIPSIS</span>&nbsp;<span class="op" id="4864019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864024">ellipsis</span>&nbsp;<span class="op" id="4864033">=</span>&nbsp;<span class="ident" id="4864035">p</span><span class="op" id="4864036">.</span><span class="ident" id="4864037">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864044">p</span><span class="op" id="4864045">.</span><span class="ident" id="4864046">next</span><span class="op" id="4864050">(</span><span class="op" id="4864051">)</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864059">if</span>&nbsp;<span class="op" id="4864062">!</span><span class="ident" id="4864063">p</span><span class="op" id="4864064">.</span><span class="ident" id="4864065">atComma</span><span class="op" id="4864072">(</span><span class="string" id="4864073">&#34;argument&nbsp;list&#34;</span><span class="op" id="4864088">)</span>&nbsp;<span class="op" id="4864090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864095">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864107">p</span><span class="op" id="4864108">.</span><span class="ident" id="4864109">next</span><span class="op" id="4864113">(</span><span class="op" id="4864114">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864120">p</span><span class="op" id="4864121">.</span><span class="ident" id="4864122">exprLev</span><span class="op" id="4864129">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864133">rparen</span>&nbsp;<span class="op" id="4864140">:=</span>&nbsp;<span class="ident" id="4864143">p</span><span class="op" id="4864144">.</span><span class="ident" id="4864145">expectClosing</span><span class="op" id="4864158">(</span><span class="ident" id="4864159">token</span><span class="op" id="4864164">.</span><span class="ident" id="4864165">RPAREN</span><span class="op" id="4864171">,</span>&nbsp;<span class="string" id="4864173">&#34;argument&nbsp;list&#34;</span><span class="op" id="4864188">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864192">return</span>&nbsp;<span class="op" id="4864199">&amp;</span><span class="ident" id="4864200">ast</span><span class="op" id="4864203">.</span><span class="ident" id="4864204">CallExpr</span><span class="op" id="4864212">{</span><span class="ident" id="4864213">Fun</span><span class="op" id="4864216">:</span>&nbsp;<span class="ident" id="4864218">fun</span><span class="op" id="4864221">,</span>&nbsp;<span class="ident" id="4864223">Lparen</span><span class="op" id="4864229">:</span>&nbsp;<span class="ident" id="4864231">lparen</span><span class="op" id="4864237">,</span>&nbsp;<span class="ident" id="4864239">Args</span><span class="op" id="4864243">:</span>&nbsp;<span class="ident" id="4864245">list</span><span class="op" id="4864249">,</span>&nbsp;<span class="ident" id="4864251">Ellipsis</span><span class="op" id="4864259">:</span>&nbsp;<span class="ident" id="4864261">ellipsis</span><span class="op" id="4864269">,</span>&nbsp;<span class="ident" id="4864271">Rparen</span><span class="op" id="4864277">:</span>&nbsp;<span class="ident" id="4864279">rparen</span><span class="op" id="4864285">}</span><br>
<span class="lineno">1260</span><span class="op" id="4864287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4864290">func</span>&nbsp;<span class="op" id="4864295">(</span><span class="ident" id="4864296">p</span>&nbsp;<span class="op" id="4864298">*</span><span class="ident" id="4864299">parser</span><span class="op" id="4864305">)</span>&nbsp;<span class="ident" id="4864307">parseElement</span><span class="op" id="4864319">(</span><span class="ident" id="4864320">keyOk</span>&nbsp;<span class="builtintype" id="4864326">bool</span><span class="op" id="4864330">)</span>&nbsp;<span class="ident" id="4864332">ast</span><span class="op" id="4864335">.</span><span class="ident" id="4864336">Expr</span>&nbsp;<span class="op" id="4864341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864344">if</span>&nbsp;<span class="ident" id="4864347">p</span><span class="op" id="4864348">.</span><span class="ident" id="4864349">trace</span>&nbsp;<span class="op" id="4864355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864359">defer</span>&nbsp;<span class="ident" id="4864365">un</span><span class="op" id="4864367">(</span><span class="ident" id="4864368">trace</span><span class="op" id="4864373">(</span><span class="ident" id="4864374">p</span><span class="op" id="4864375">,</span>&nbsp;<span class="string" id="4864377">&#34;Element&#34;</span><span class="op" id="4864386">)</span><span class="op" id="4864387">)</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864394">if</span>&nbsp;<span class="ident" id="4864397">p</span><span class="op" id="4864398">.</span><span class="ident" id="4864399">tok</span>&nbsp;<span class="op" id="4864403">==</span>&nbsp;<span class="ident" id="4864406">token</span><span class="op" id="4864411">.</span><span class="ident" id="4864412">LBRACE</span>&nbsp;<span class="op" id="4864419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864423">return</span>&nbsp;<span class="ident" id="4864430">p</span><span class="op" id="4864431">.</span><span class="ident" id="4864432">parseLiteralValue</span><span class="op" id="4864449">(</span><span class="builtintype" id="4864450">nil</span><span class="op" id="4864453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864456">}</span><br>
<span class="lineno">1270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864460">//&nbsp;Because&nbsp;the&nbsp;parser&nbsp;doesn&#39;t&nbsp;know&nbsp;the&nbsp;composite&nbsp;literal&nbsp;type,&nbsp;it&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864534">//&nbsp;know&nbsp;if&nbsp;a&nbsp;key&nbsp;that&#39;s&nbsp;an&nbsp;identifier&nbsp;is&nbsp;a&nbsp;struct&nbsp;field&nbsp;name&nbsp;or&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864606">//&nbsp;denoting&nbsp;a&nbsp;value.&nbsp;The&nbsp;former&nbsp;is&nbsp;not&nbsp;resolved&nbsp;by&nbsp;the&nbsp;parser&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864676">//&nbsp;resolver.</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864690">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864694">//&nbsp;Instead,&nbsp;_try_&nbsp;to&nbsp;resolve&nbsp;such&nbsp;a&nbsp;key&nbsp;if&nbsp;possible.&nbsp;If&nbsp;it&nbsp;resolves,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864764">//&nbsp;it&nbsp;a)&nbsp;has&nbsp;correctly&nbsp;resolved,&nbsp;or&nbsp;b)&nbsp;incorrectly&nbsp;resolved&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864833">//&nbsp;the&nbsp;key&nbsp;is&nbsp;a&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;matching&nbsp;another&nbsp;identifier.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864904">//&nbsp;In&nbsp;the&nbsp;former&nbsp;case&nbsp;we&nbsp;are&nbsp;done,&nbsp;and&nbsp;in&nbsp;the&nbsp;latter&nbsp;case&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864972">//&nbsp;care&nbsp;because&nbsp;the&nbsp;type&nbsp;checker&nbsp;will&nbsp;do&nbsp;a&nbsp;separate&nbsp;field&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865039">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865043">//&nbsp;If&nbsp;the&nbsp;key&nbsp;does&nbsp;not&nbsp;resolve,&nbsp;it&nbsp;a)&nbsp;must&nbsp;be&nbsp;defined&nbsp;at&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865109">//&nbsp;level&nbsp;in&nbsp;another&nbsp;file&nbsp;of&nbsp;the&nbsp;same&nbsp;package,&nbsp;the&nbsp;universe&nbsp;scope,&nbsp;or&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865182">//&nbsp;undeclared;&nbsp;or&nbsp;b)&nbsp;it&nbsp;is&nbsp;a&nbsp;struct&nbsp;field.&nbsp;In&nbsp;the&nbsp;former&nbsp;case,&nbsp;the&nbsp;type</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865255">//&nbsp;checker&nbsp;can&nbsp;do&nbsp;a&nbsp;top-level&nbsp;lookup,&nbsp;and&nbsp;in&nbsp;the&nbsp;latter&nbsp;case&nbsp;it&nbsp;will&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865328">//&nbsp;a&nbsp;separate&nbsp;field&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865357">x</span>&nbsp;<span class="op" id="4865359">:=</span>&nbsp;<span class="ident" id="4865362">p</span><span class="op" id="4865363">.</span><span class="ident" id="4865364">checkExpr</span><span class="op" id="4865373">(</span><span class="ident" id="4865374">p</span><span class="op" id="4865375">.</span><span class="ident" id="4865376">parseExpr</span><span class="op" id="4865385">(</span><span class="ident" id="4865386">keyOk</span><span class="op" id="4865391">)</span><span class="op" id="4865392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865395">if</span>&nbsp;<span class="ident" id="4865398">keyOk</span>&nbsp;<span class="op" id="4865404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865408">if</span>&nbsp;<span class="ident" id="4865411">p</span><span class="op" id="4865412">.</span><span class="ident" id="4865413">tok</span>&nbsp;<span class="op" id="4865417">==</span>&nbsp;<span class="ident" id="4865420">token</span><span class="op" id="4865425">.</span><span class="ident" id="4865426">COLON</span>&nbsp;<span class="op" id="4865432">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865437">colon</span>&nbsp;<span class="op" id="4865443">:=</span>&nbsp;<span class="ident" id="4865446">p</span><span class="op" id="4865447">.</span><span class="ident" id="4865448">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865455">p</span><span class="op" id="4865456">.</span><span class="ident" id="4865457">next</span><span class="op" id="4865461">(</span><span class="op" id="4865462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865467">//&nbsp;Try&nbsp;to&nbsp;resolve&nbsp;the&nbsp;key&nbsp;but&nbsp;don&#39;t&nbsp;collect&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865517">//&nbsp;as&nbsp;unresolved&nbsp;identifier&nbsp;if&nbsp;it&nbsp;fails&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865568">//&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;(possibly&nbsp;false)&nbsp;errors&nbsp;about</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865617">//&nbsp;undeclared&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865641">p</span><span class="op" id="4865642">.</span><span class="ident" id="4865643">tryResolve</span><span class="op" id="4865653">(</span><span class="ident" id="4865654">x</span><span class="op" id="4865655">,</span>&nbsp;<span class="builtintype" id="4865657">false</span><span class="op" id="4865662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865667">return</span>&nbsp;<span class="op" id="4865674">&amp;</span><span class="ident" id="4865675">ast</span><span class="op" id="4865678">.</span><span class="ident" id="4865679">KeyValueExpr</span><span class="op" id="4865691">{</span><span class="ident" id="4865692">Key</span><span class="op" id="4865695">:</span>&nbsp;<span class="ident" id="4865697">x</span><span class="op" id="4865698">,</span>&nbsp;<span class="ident" id="4865700">Colon</span><span class="op" id="4865705">:</span>&nbsp;<span class="ident" id="4865707">colon</span><span class="op" id="4865712">,</span>&nbsp;<span class="ident" id="4865714">Value</span><span class="op" id="4865719">:</span>&nbsp;<span class="ident" id="4865721">p</span><span class="op" id="4865722">.</span><span class="ident" id="4865723">parseElement</span><span class="op" id="4865735">(</span><span class="builtintype" id="4865736">false</span><span class="op" id="4865741">)</span><span class="op" id="4865742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865750">p</span><span class="op" id="4865751">.</span><span class="ident" id="4865752">resolve</span><span class="op" id="4865759">(</span><span class="ident" id="4865760">x</span><span class="op" id="4865761">)</span>&nbsp;<span class="comment" id="4865763">//&nbsp;not&nbsp;a&nbsp;key</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865781">return</span>&nbsp;<span class="ident" id="4865788">x</span><br>
<span class="lineno"></span><span class="op" id="4865790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1305</span><span class="keyword" id="4865793">func</span>&nbsp;<span class="op" id="4865798">(</span><span class="ident" id="4865799">p</span>&nbsp;<span class="op" id="4865801">*</span><span class="ident" id="4865802">parser</span><span class="op" id="4865808">)</span>&nbsp;<span class="ident" id="4865810">parseElementList</span><span class="op" id="4865826">(</span><span class="op" id="4865827">)</span>&nbsp;<span class="op" id="4865829">(</span><span class="ident" id="4865830">list</span>&nbsp;<span class="op" id="4865835">[</span><span class="op" id="4865836">]</span><span class="ident" id="4865837">ast</span><span class="op" id="4865840">.</span><span class="ident" id="4865841">Expr</span><span class="op" id="4865845">)</span>&nbsp;<span class="op" id="4865847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865850">if</span>&nbsp;<span class="ident" id="4865853">p</span><span class="op" id="4865854">.</span><span class="ident" id="4865855">trace</span>&nbsp;<span class="op" id="4865861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865865">defer</span>&nbsp;<span class="ident" id="4865871">un</span><span class="op" id="4865873">(</span><span class="ident" id="4865874">trace</span><span class="op" id="4865879">(</span><span class="ident" id="4865880">p</span><span class="op" id="4865881">,</span>&nbsp;<span class="string" id="4865883">&#34;ElementList&#34;</span><span class="op" id="4865896">)</span><span class="op" id="4865897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865904">for</span>&nbsp;<span class="ident" id="4865908">p</span><span class="op" id="4865909">.</span><span class="ident" id="4865910">tok</span>&nbsp;<span class="op" id="4865914">!=</span>&nbsp;<span class="ident" id="4865917">token</span><span class="op" id="4865922">.</span><span class="ident" id="4865923">RBRACE</span>&nbsp;<span class="op" id="4865930">&amp;&amp;</span>&nbsp;<span class="ident" id="4865933">p</span><span class="op" id="4865934">.</span><span class="ident" id="4865935">tok</span>&nbsp;<span class="op" id="4865939">!=</span>&nbsp;<span class="ident" id="4865942">token</span><span class="op" id="4865947">.</span><span class="ident" id="4865948">EOF</span>&nbsp;<span class="op" id="4865952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865956">list</span>&nbsp;<span class="op" id="4865961">=</span>&nbsp;<span class="builtinfunc" id="4865963">append</span><span class="op" id="4865969">(</span><span class="ident" id="4865970">list</span><span class="op" id="4865974">,</span>&nbsp;<span class="ident" id="4865976">p</span><span class="op" id="4865977">.</span><span class="ident" id="4865978">parseElement</span><span class="op" id="4865990">(</span><span class="builtintype" id="4865991">true</span><span class="op" id="4865995">)</span><span class="op" id="4865996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866000">if</span>&nbsp;<span class="op" id="4866003">!</span><span class="ident" id="4866004">p</span><span class="op" id="4866005">.</span><span class="ident" id="4866006">atComma</span><span class="op" id="4866013">(</span><span class="string" id="4866014">&#34;composite&nbsp;literal&#34;</span><span class="op" id="4866033">)</span>&nbsp;<span class="op" id="4866035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866040">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866048">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866052">p</span><span class="op" id="4866053">.</span><span class="ident" id="4866054">next</span><span class="op" id="4866058">(</span><span class="op" id="4866059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866066">return</span><br>
<span class="lineno"></span><span class="op" id="4866073">}</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span><span class="keyword" id="4866076">func</span>&nbsp;<span class="op" id="4866081">(</span><span class="ident" id="4866082">p</span>&nbsp;<span class="op" id="4866084">*</span><span class="ident" id="4866085">parser</span><span class="op" id="4866091">)</span>&nbsp;<span class="ident" id="4866093">parseLiteralValue</span><span class="op" id="4866110">(</span><span class="ident" id="4866111">typ</span>&nbsp;<span class="ident" id="4866115">ast</span><span class="op" id="4866118">.</span><span class="ident" id="4866119">Expr</span><span class="op" id="4866123">)</span>&nbsp;<span class="ident" id="4866125">ast</span><span class="op" id="4866128">.</span><span class="ident" id="4866129">Expr</span>&nbsp;<span class="op" id="4866134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866137">if</span>&nbsp;<span class="ident" id="4866140">p</span><span class="op" id="4866141">.</span><span class="ident" id="4866142">trace</span>&nbsp;<span class="op" id="4866148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866152">defer</span>&nbsp;<span class="ident" id="4866158">un</span><span class="op" id="4866160">(</span><span class="ident" id="4866161">trace</span><span class="op" id="4866166">(</span><span class="ident" id="4866167">p</span><span class="op" id="4866168">,</span>&nbsp;<span class="string" id="4866170">&#34;LiteralValue&#34;</span><span class="op" id="4866184">)</span><span class="op" id="4866185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866188">}</span><br>
<span class="lineno">1325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866192">lbrace</span>&nbsp;<span class="op" id="4866199">:=</span>&nbsp;<span class="ident" id="4866202">p</span><span class="op" id="4866203">.</span><span class="ident" id="4866204">expect</span><span class="op" id="4866210">(</span><span class="ident" id="4866211">token</span><span class="op" id="4866216">.</span><span class="ident" id="4866217">LBRACE</span><span class="op" id="4866223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866226">var</span>&nbsp;<span class="ident" id="4866230">elts</span>&nbsp;<span class="op" id="4866235">[</span><span class="op" id="4866236">]</span><span class="ident" id="4866237">ast</span><span class="op" id="4866240">.</span><span class="ident" id="4866241">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866247">p</span><span class="op" id="4866248">.</span><span class="ident" id="4866249">exprLev</span><span class="op" id="4866256">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866260">if</span>&nbsp;<span class="ident" id="4866263">p</span><span class="op" id="4866264">.</span><span class="ident" id="4866265">tok</span>&nbsp;<span class="op" id="4866269">!=</span>&nbsp;<span class="ident" id="4866272">token</span><span class="op" id="4866277">.</span><span class="ident" id="4866278">RBRACE</span>&nbsp;<span class="op" id="4866285">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866289">elts</span>&nbsp;<span class="op" id="4866294">=</span>&nbsp;<span class="ident" id="4866296">p</span><span class="op" id="4866297">.</span><span class="ident" id="4866298">parseElementList</span><span class="op" id="4866314">(</span><span class="op" id="4866315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866321">p</span><span class="op" id="4866322">.</span><span class="ident" id="4866323">exprLev</span><span class="op" id="4866330">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866334">rbrace</span>&nbsp;<span class="op" id="4866341">:=</span>&nbsp;<span class="ident" id="4866344">p</span><span class="op" id="4866345">.</span><span class="ident" id="4866346">expectClosing</span><span class="op" id="4866359">(</span><span class="ident" id="4866360">token</span><span class="op" id="4866365">.</span><span class="ident" id="4866366">RBRACE</span><span class="op" id="4866372">,</span>&nbsp;<span class="string" id="4866374">&#34;composite&nbsp;literal&#34;</span><span class="op" id="4866393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866396">return</span>&nbsp;<span class="op" id="4866403">&amp;</span><span class="ident" id="4866404">ast</span><span class="op" id="4866407">.</span><span class="ident" id="4866408">CompositeLit</span><span class="op" id="4866420">{</span><span class="ident" id="4866421">Type</span><span class="op" id="4866425">:</span>&nbsp;<span class="ident" id="4866427">typ</span><span class="op" id="4866430">,</span>&nbsp;<span class="ident" id="4866432">Lbrace</span><span class="op" id="4866438">:</span>&nbsp;<span class="ident" id="4866440">lbrace</span><span class="op" id="4866446">,</span>&nbsp;<span class="ident" id="4866448">Elts</span><span class="op" id="4866452">:</span>&nbsp;<span class="ident" id="4866454">elts</span><span class="op" id="4866458">,</span>&nbsp;<span class="ident" id="4866460">Rbrace</span><span class="op" id="4866466">:</span>&nbsp;<span class="ident" id="4866468">rbrace</span><span class="op" id="4866474">}</span><br>
<span class="lineno">1335</span><span class="op" id="4866476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4866479">//&nbsp;checkExpr&nbsp;checks&nbsp;that&nbsp;x&nbsp;is&nbsp;an&nbsp;expression&nbsp;(and&nbsp;not&nbsp;a&nbsp;type).</span><br>
<span class="lineno"></span><span class="keyword" id="4866541">func</span>&nbsp;<span class="op" id="4866546">(</span><span class="ident" id="4866547">p</span>&nbsp;<span class="op" id="4866549">*</span><span class="ident" id="4866550">parser</span><span class="op" id="4866556">)</span>&nbsp;<span class="ident" id="4866558">checkExpr</span><span class="op" id="4866567">(</span><span class="ident" id="4866568">x</span>&nbsp;<span class="ident" id="4866570">ast</span><span class="op" id="4866573">.</span><span class="ident" id="4866574">Expr</span><span class="op" id="4866578">)</span>&nbsp;<span class="ident" id="4866580">ast</span><span class="op" id="4866583">.</span><span class="ident" id="4866584">Expr</span>&nbsp;<span class="op" id="4866589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866592">switch</span>&nbsp;<span class="ident" id="4866599">unparen</span><span class="op" id="4866606">(</span><span class="ident" id="4866607">x</span><span class="op" id="4866608">)</span><span class="op" id="4866609">.</span><span class="op" id="4866610">(</span><span class="keyword" id="4866611">type</span><span class="op" id="4866615">)</span>&nbsp;<span class="op" id="4866617">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866620">case</span>&nbsp;<span class="op" id="4866625">*</span><span class="ident" id="4866626">ast</span><span class="op" id="4866629">.</span><span class="ident" id="4866630">BadExpr</span><span class="op" id="4866637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866640">case</span>&nbsp;<span class="op" id="4866645">*</span><span class="ident" id="4866646">ast</span><span class="op" id="4866649">.</span><span class="ident" id="4866650">Ident</span><span class="op" id="4866655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866658">case</span>&nbsp;<span class="op" id="4866663">*</span><span class="ident" id="4866664">ast</span><span class="op" id="4866667">.</span><span class="ident" id="4866668">BasicLit</span><span class="op" id="4866676">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866679">case</span>&nbsp;<span class="op" id="4866684">*</span><span class="ident" id="4866685">ast</span><span class="op" id="4866688">.</span><span class="ident" id="4866689">FuncLit</span><span class="op" id="4866696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866699">case</span>&nbsp;<span class="op" id="4866704">*</span><span class="ident" id="4866705">ast</span><span class="op" id="4866708">.</span><span class="ident" id="4866709">CompositeLit</span><span class="op" id="4866721">:</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866724">case</span>&nbsp;<span class="op" id="4866729">*</span><span class="ident" id="4866730">ast</span><span class="op" id="4866733">.</span><span class="ident" id="4866734">ParenExpr</span><span class="op" id="4866743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4866747">panic</span><span class="op" id="4866752">(</span><span class="string" id="4866753">&#34;unreachable&#34;</span><span class="op" id="4866766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866769">case</span>&nbsp;<span class="op" id="4866774">*</span><span class="ident" id="4866775">ast</span><span class="op" id="4866778">.</span><span class="ident" id="4866779">SelectorExpr</span><span class="op" id="4866791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866794">case</span>&nbsp;<span class="op" id="4866799">*</span><span class="ident" id="4866800">ast</span><span class="op" id="4866803">.</span><span class="ident" id="4866804">IndexExpr</span><span class="op" id="4866813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866816">case</span>&nbsp;<span class="op" id="4866821">*</span><span class="ident" id="4866822">ast</span><span class="op" id="4866825">.</span><span class="ident" id="4866826">SliceExpr</span><span class="op" id="4866835">:</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866838">case</span>&nbsp;<span class="op" id="4866843">*</span><span class="ident" id="4866844">ast</span><span class="op" id="4866847">.</span><span class="ident" id="4866848">TypeAssertExpr</span><span class="op" id="4866862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866866">//&nbsp;If&nbsp;t.Type&nbsp;==&nbsp;nil&nbsp;we&nbsp;have&nbsp;a&nbsp;type&nbsp;assertion&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866925">//&nbsp;y.(type),&nbsp;which&nbsp;is&nbsp;only&nbsp;allowed&nbsp;in&nbsp;type&nbsp;switch&nbsp;expressions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866990">//&nbsp;It&#39;s&nbsp;hard&nbsp;to&nbsp;exclude&nbsp;those&nbsp;but&nbsp;for&nbsp;the&nbsp;case&nbsp;where&nbsp;we&nbsp;are&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867055">//&nbsp;a&nbsp;type&nbsp;switch.&nbsp;Instead&nbsp;be&nbsp;lenient&nbsp;and&nbsp;test&nbsp;this&nbsp;in&nbsp;the&nbsp;type</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867120">//&nbsp;checker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867133">case</span>&nbsp;<span class="op" id="4867138">*</span><span class="ident" id="4867139">ast</span><span class="op" id="4867142">.</span><span class="ident" id="4867143">CallExpr</span><span class="op" id="4867151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867154">case</span>&nbsp;<span class="op" id="4867159">*</span><span class="ident" id="4867160">ast</span><span class="op" id="4867163">.</span><span class="ident" id="4867164">StarExpr</span><span class="op" id="4867172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867175">case</span>&nbsp;<span class="op" id="4867180">*</span><span class="ident" id="4867181">ast</span><span class="op" id="4867184">.</span><span class="ident" id="4867185">UnaryExpr</span><span class="op" id="4867194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867197">case</span>&nbsp;<span class="op" id="4867202">*</span><span class="ident" id="4867203">ast</span><span class="op" id="4867206">.</span><span class="ident" id="4867207">BinaryExpr</span><span class="op" id="4867217">:</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867220">default</span><span class="op" id="4867227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867231">//&nbsp;all&nbsp;other&nbsp;nodes&nbsp;are&nbsp;not&nbsp;proper&nbsp;expressions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867279">p</span><span class="op" id="4867280">.</span><span class="ident" id="4867281">errorExpected</span><span class="op" id="4867294">(</span><span class="ident" id="4867295">x</span><span class="op" id="4867296">.</span><span class="ident" id="4867297">Pos</span><span class="op" id="4867300">(</span><span class="op" id="4867301">)</span><span class="op" id="4867302">,</span>&nbsp;<span class="string" id="4867304">&#34;expression&#34;</span><span class="op" id="4867316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867320">x</span>&nbsp;<span class="op" id="4867322">=</span>&nbsp;<span class="op" id="4867324">&amp;</span><span class="ident" id="4867325">ast</span><span class="op" id="4867328">.</span><span class="ident" id="4867329">BadExpr</span><span class="op" id="4867336">{</span><span class="ident" id="4867337">From</span><span class="op" id="4867341">:</span>&nbsp;<span class="ident" id="4867343">x</span><span class="op" id="4867344">.</span><span class="ident" id="4867345">Pos</span><span class="op" id="4867348">(</span><span class="op" id="4867349">)</span><span class="op" id="4867350">,</span>&nbsp;<span class="ident" id="4867352">To</span><span class="op" id="4867354">:</span>&nbsp;<span class="ident" id="4867356">p</span><span class="op" id="4867357">.</span><span class="ident" id="4867358">safePos</span><span class="op" id="4867365">(</span><span class="ident" id="4867366">x</span><span class="op" id="4867367">.</span><span class="ident" id="4867368">End</span><span class="op" id="4867371">(</span><span class="op" id="4867372">)</span><span class="op" id="4867373">)</span><span class="op" id="4867374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867377">}</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867380">return</span>&nbsp;<span class="ident" id="4867387">x</span><br>
<span class="lineno"></span><span class="op" id="4867389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4867392">//&nbsp;isTypeName&nbsp;returns&nbsp;true&nbsp;iff&nbsp;x&nbsp;is&nbsp;a&nbsp;(qualified)&nbsp;TypeName.</span><br>
<span class="lineno"></span><span class="keyword" id="4867452">func</span>&nbsp;<span class="ident" id="4867457">isTypeName</span><span class="op" id="4867467">(</span><span class="ident" id="4867468">x</span>&nbsp;<span class="ident" id="4867470">ast</span><span class="op" id="4867473">.</span><span class="ident" id="4867474">Expr</span><span class="op" id="4867478">)</span>&nbsp;<span class="builtintype" id="4867480">bool</span>&nbsp;<span class="op" id="4867485">{</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867488">switch</span>&nbsp;<span class="ident" id="4867495">t</span>&nbsp;<span class="op" id="4867497">:=</span>&nbsp;<span class="ident" id="4867500">x</span><span class="op" id="4867501">.</span><span class="op" id="4867502">(</span><span class="keyword" id="4867503">type</span><span class="op" id="4867507">)</span>&nbsp;<span class="op" id="4867509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867512">case</span>&nbsp;<span class="op" id="4867517">*</span><span class="ident" id="4867518">ast</span><span class="op" id="4867521">.</span><span class="ident" id="4867522">BadExpr</span><span class="op" id="4867529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867532">case</span>&nbsp;<span class="op" id="4867537">*</span><span class="ident" id="4867538">ast</span><span class="op" id="4867541">.</span><span class="ident" id="4867542">Ident</span><span class="op" id="4867547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867550">case</span>&nbsp;<span class="op" id="4867555">*</span><span class="ident" id="4867556">ast</span><span class="op" id="4867559">.</span><span class="ident" id="4867560">SelectorExpr</span><span class="op" id="4867572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867576">_</span><span class="op" id="4867577">,</span>&nbsp;<span class="ident" id="4867579">isIdent</span>&nbsp;<span class="op" id="4867587">:=</span>&nbsp;<span class="ident" id="4867590">t</span><span class="op" id="4867591">.</span><span class="ident" id="4867592">X</span><span class="op" id="4867593">.</span><span class="op" id="4867594">(</span><span class="op" id="4867595">*</span><span class="ident" id="4867596">ast</span><span class="op" id="4867599">.</span><span class="ident" id="4867600">Ident</span><span class="op" id="4867605">)</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867609">return</span>&nbsp;<span class="ident" id="4867616">isIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867625">default</span><span class="op" id="4867632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867636">return</span>&nbsp;<span class="builtintype" id="4867643">false</span>&nbsp;<span class="comment" id="4867649">//&nbsp;all&nbsp;other&nbsp;nodes&nbsp;are&nbsp;not&nbsp;type&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867691">return</span>&nbsp;<span class="builtintype" id="4867698">true</span><br>
<span class="lineno">1380</span><span class="op" id="4867703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4867706">//&nbsp;isLiteralType&nbsp;returns&nbsp;true&nbsp;iff&nbsp;x&nbsp;is&nbsp;a&nbsp;legal&nbsp;composite&nbsp;literal&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4867777">func</span>&nbsp;<span class="ident" id="4867782">isLiteralType</span><span class="op" id="4867795">(</span><span class="ident" id="4867796">x</span>&nbsp;<span class="ident" id="4867798">ast</span><span class="op" id="4867801">.</span><span class="ident" id="4867802">Expr</span><span class="op" id="4867806">)</span>&nbsp;<span class="builtintype" id="4867808">bool</span>&nbsp;<span class="op" id="4867813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867816">switch</span>&nbsp;<span class="ident" id="4867823">t</span>&nbsp;<span class="op" id="4867825">:=</span>&nbsp;<span class="ident" id="4867828">x</span><span class="op" id="4867829">.</span><span class="op" id="4867830">(</span><span class="keyword" id="4867831">type</span><span class="op" id="4867835">)</span>&nbsp;<span class="op" id="4867837">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867840">case</span>&nbsp;<span class="op" id="4867845">*</span><span class="ident" id="4867846">ast</span><span class="op" id="4867849">.</span><span class="ident" id="4867850">BadExpr</span><span class="op" id="4867857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867860">case</span>&nbsp;<span class="op" id="4867865">*</span><span class="ident" id="4867866">ast</span><span class="op" id="4867869">.</span><span class="ident" id="4867870">Ident</span><span class="op" id="4867875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867878">case</span>&nbsp;<span class="op" id="4867883">*</span><span class="ident" id="4867884">ast</span><span class="op" id="4867887">.</span><span class="ident" id="4867888">SelectorExpr</span><span class="op" id="4867900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867904">_</span><span class="op" id="4867905">,</span>&nbsp;<span class="ident" id="4867907">isIdent</span>&nbsp;<span class="op" id="4867915">:=</span>&nbsp;<span class="ident" id="4867918">t</span><span class="op" id="4867919">.</span><span class="ident" id="4867920">X</span><span class="op" id="4867921">.</span><span class="op" id="4867922">(</span><span class="op" id="4867923">*</span><span class="ident" id="4867924">ast</span><span class="op" id="4867927">.</span><span class="ident" id="4867928">Ident</span><span class="op" id="4867933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867937">return</span>&nbsp;<span class="ident" id="4867944">isIdent</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867953">case</span>&nbsp;<span class="op" id="4867958">*</span><span class="ident" id="4867959">ast</span><span class="op" id="4867962">.</span><span class="ident" id="4867963">ArrayType</span><span class="op" id="4867972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867975">case</span>&nbsp;<span class="op" id="4867980">*</span><span class="ident" id="4867981">ast</span><span class="op" id="4867984">.</span><span class="ident" id="4867985">StructType</span><span class="op" id="4867995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867998">case</span>&nbsp;<span class="op" id="4868003">*</span><span class="ident" id="4868004">ast</span><span class="op" id="4868007">.</span><span class="ident" id="4868008">MapType</span><span class="op" id="4868015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868018">default</span><span class="op" id="4868025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868029">return</span>&nbsp;<span class="builtintype" id="4868036">false</span>&nbsp;<span class="comment" id="4868042">//&nbsp;all&nbsp;other&nbsp;nodes&nbsp;are&nbsp;not&nbsp;legal&nbsp;composite&nbsp;literal&nbsp;types</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868103">return</span>&nbsp;<span class="builtintype" id="4868110">true</span><br>
<span class="lineno"></span><span class="op" id="4868115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4868118">//&nbsp;If&nbsp;x&nbsp;is&nbsp;of&nbsp;the&nbsp;form&nbsp;*T,&nbsp;deref&nbsp;returns&nbsp;T,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;x.</span><br>
<span class="lineno">1400</span><span class="keyword" id="4868186">func</span>&nbsp;<span class="ident" id="4868191">deref</span><span class="op" id="4868196">(</span><span class="ident" id="4868197">x</span>&nbsp;<span class="ident" id="4868199">ast</span><span class="op" id="4868202">.</span><span class="ident" id="4868203">Expr</span><span class="op" id="4868207">)</span>&nbsp;<span class="ident" id="4868209">ast</span><span class="op" id="4868212">.</span><span class="ident" id="4868213">Expr</span>&nbsp;<span class="op" id="4868218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868221">if</span>&nbsp;<span class="ident" id="4868224">p</span><span class="op" id="4868225">,</span>&nbsp;<span class="ident" id="4868227">isPtr</span>&nbsp;<span class="op" id="4868233">:=</span>&nbsp;<span class="ident" id="4868236">x</span><span class="op" id="4868237">.</span><span class="op" id="4868238">(</span><span class="op" id="4868239">*</span><span class="ident" id="4868240">ast</span><span class="op" id="4868243">.</span><span class="ident" id="4868244">StarExpr</span><span class="op" id="4868252">)</span><span class="op" id="4868253">;</span>&nbsp;<span class="ident" id="4868255">isPtr</span>&nbsp;<span class="op" id="4868261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868265">x</span>&nbsp;<span class="op" id="4868267">=</span>&nbsp;<span class="ident" id="4868269">p</span><span class="op" id="4868270">.</span><span class="ident" id="4868271">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868277">return</span>&nbsp;<span class="ident" id="4868284">x</span><br>
<span class="lineno">1405</span><span class="op" id="4868286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4868289">//&nbsp;If&nbsp;x&nbsp;is&nbsp;of&nbsp;the&nbsp;form&nbsp;(T),&nbsp;unparen&nbsp;returns&nbsp;unparen(T),&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="4868369">func</span>&nbsp;<span class="ident" id="4868374">unparen</span><span class="op" id="4868381">(</span><span class="ident" id="4868382">x</span>&nbsp;<span class="ident" id="4868384">ast</span><span class="op" id="4868387">.</span><span class="ident" id="4868388">Expr</span><span class="op" id="4868392">)</span>&nbsp;<span class="ident" id="4868394">ast</span><span class="op" id="4868397">.</span><span class="ident" id="4868398">Expr</span>&nbsp;<span class="op" id="4868403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868406">if</span>&nbsp;<span class="ident" id="4868409">p</span><span class="op" id="4868410">,</span>&nbsp;<span class="ident" id="4868412">isParen</span>&nbsp;<span class="op" id="4868420">:=</span>&nbsp;<span class="ident" id="4868423">x</span><span class="op" id="4868424">.</span><span class="op" id="4868425">(</span><span class="op" id="4868426">*</span><span class="ident" id="4868427">ast</span><span class="op" id="4868430">.</span><span class="ident" id="4868431">ParenExpr</span><span class="op" id="4868440">)</span><span class="op" id="4868441">;</span>&nbsp;<span class="ident" id="4868443">isParen</span>&nbsp;<span class="op" id="4868451">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868455">x</span>&nbsp;<span class="op" id="4868457">=</span>&nbsp;<span class="ident" id="4868459">unparen</span><span class="op" id="4868466">(</span><span class="ident" id="4868467">p</span><span class="op" id="4868468">.</span><span class="ident" id="4868469">X</span><span class="op" id="4868470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868476">return</span>&nbsp;<span class="ident" id="4868483">x</span><br>
<span class="lineno"></span><span class="op" id="4868485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="comment" id="4868488">//&nbsp;checkExprOrType&nbsp;checks&nbsp;that&nbsp;x&nbsp;is&nbsp;an&nbsp;expression&nbsp;or&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4868548">//&nbsp;(and&nbsp;not&nbsp;a&nbsp;raw&nbsp;type&nbsp;such&nbsp;as&nbsp;[...]T).</span><br>
<span class="lineno"></span><span class="comment" id="4868588">//</span><br>
<span class="lineno"></span><span class="keyword" id="4868591">func</span>&nbsp;<span class="op" id="4868596">(</span><span class="ident" id="4868597">p</span>&nbsp;<span class="op" id="4868599">*</span><span class="ident" id="4868600">parser</span><span class="op" id="4868606">)</span>&nbsp;<span class="ident" id="4868608">checkExprOrType</span><span class="op" id="4868623">(</span><span class="ident" id="4868624">x</span>&nbsp;<span class="ident" id="4868626">ast</span><span class="op" id="4868629">.</span><span class="ident" id="4868630">Expr</span><span class="op" id="4868634">)</span>&nbsp;<span class="ident" id="4868636">ast</span><span class="op" id="4868639">.</span><span class="ident" id="4868640">Expr</span>&nbsp;<span class="op" id="4868645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868648">switch</span>&nbsp;<span class="ident" id="4868655">t</span>&nbsp;<span class="op" id="4868657">:=</span>&nbsp;<span class="ident" id="4868660">unparen</span><span class="op" id="4868667">(</span><span class="ident" id="4868668">x</span><span class="op" id="4868669">)</span><span class="op" id="4868670">.</span><span class="op" id="4868671">(</span><span class="keyword" id="4868672">type</span><span class="op" id="4868676">)</span>&nbsp;<span class="op" id="4868678">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868681">case</span>&nbsp;<span class="op" id="4868686">*</span><span class="ident" id="4868687">ast</span><span class="op" id="4868690">.</span><span class="ident" id="4868691">ParenExpr</span><span class="op" id="4868700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4868704">panic</span><span class="op" id="4868709">(</span><span class="string" id="4868710">&#34;unreachable&#34;</span><span class="op" id="4868723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868726">case</span>&nbsp;<span class="op" id="4868731">*</span><span class="ident" id="4868732">ast</span><span class="op" id="4868735">.</span><span class="ident" id="4868736">UnaryExpr</span><span class="op" id="4868745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868748">case</span>&nbsp;<span class="op" id="4868753">*</span><span class="ident" id="4868754">ast</span><span class="op" id="4868757">.</span><span class="ident" id="4868758">ArrayType</span><span class="op" id="4868767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868771">if</span>&nbsp;<span class="builtinfunc" id="4868774">len</span><span class="op" id="4868777">,</span>&nbsp;<span class="ident" id="4868779">isEllipsis</span>&nbsp;<span class="op" id="4868790">:=</span>&nbsp;<span class="ident" id="4868793">t</span><span class="op" id="4868794">.</span><span class="ident" id="4868795">Len</span><span class="op" id="4868798">.</span><span class="op" id="4868799">(</span><span class="op" id="4868800">*</span><span class="ident" id="4868801">ast</span><span class="op" id="4868804">.</span><span class="ident" id="4868805">Ellipsis</span><span class="op" id="4868813">)</span><span class="op" id="4868814">;</span>&nbsp;<span class="ident" id="4868816">isEllipsis</span>&nbsp;<span class="op" id="4868827">{</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868832">p</span><span class="op" id="4868833">.</span><span class="builtintype" id="4868834">error</span><span class="op" id="4868839">(</span><span class="builtinfunc" id="4868840">len</span><span class="op" id="4868843">.</span><span class="ident" id="4868844">Pos</span><span class="op" id="4868847">(</span><span class="op" id="4868848">)</span><span class="op" id="4868849">,</span>&nbsp;<span class="string" id="4868851">&#34;expected&nbsp;array&nbsp;length,&nbsp;found&nbsp;&#39;...&#39;&#34;</span><span class="op" id="4868887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868892">x</span>&nbsp;<span class="op" id="4868894">=</span>&nbsp;<span class="op" id="4868896">&amp;</span><span class="ident" id="4868897">ast</span><span class="op" id="4868900">.</span><span class="ident" id="4868901">BadExpr</span><span class="op" id="4868908">{</span><span class="ident" id="4868909">From</span><span class="op" id="4868913">:</span>&nbsp;<span class="ident" id="4868915">x</span><span class="op" id="4868916">.</span><span class="ident" id="4868917">Pos</span><span class="op" id="4868920">(</span><span class="op" id="4868921">)</span><span class="op" id="4868922">,</span>&nbsp;<span class="ident" id="4868924">To</span><span class="op" id="4868926">:</span>&nbsp;<span class="ident" id="4868928">p</span><span class="op" id="4868929">.</span><span class="ident" id="4868930">safePos</span><span class="op" id="4868937">(</span><span class="ident" id="4868938">x</span><span class="op" id="4868939">.</span><span class="ident" id="4868940">End</span><span class="op" id="4868943">(</span><span class="op" id="4868944">)</span><span class="op" id="4868945">)</span><span class="op" id="4868946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868957">//&nbsp;all&nbsp;other&nbsp;nodes&nbsp;are&nbsp;expressions&nbsp;or&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869002">return</span>&nbsp;<span class="ident" id="4869009">x</span><br>
<span class="lineno"></span><span class="op" id="4869011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4869014">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno">1435</span><span class="keyword" id="4869084">func</span>&nbsp;<span class="op" id="4869089">(</span><span class="ident" id="4869090">p</span>&nbsp;<span class="op" id="4869092">*</span><span class="ident" id="4869093">parser</span><span class="op" id="4869099">)</span>&nbsp;<span class="ident" id="4869101">parsePrimaryExpr</span><span class="op" id="4869117">(</span><span class="ident" id="4869118">lhs</span>&nbsp;<span class="builtintype" id="4869122">bool</span><span class="op" id="4869126">)</span>&nbsp;<span class="ident" id="4869128">ast</span><span class="op" id="4869131">.</span><span class="ident" id="4869132">Expr</span>&nbsp;<span class="op" id="4869137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869140">if</span>&nbsp;<span class="ident" id="4869143">p</span><span class="op" id="4869144">.</span><span class="ident" id="4869145">trace</span>&nbsp;<span class="op" id="4869151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869155">defer</span>&nbsp;<span class="ident" id="4869161">un</span><span class="op" id="4869163">(</span><span class="ident" id="4869164">trace</span><span class="op" id="4869169">(</span><span class="ident" id="4869170">p</span><span class="op" id="4869171">,</span>&nbsp;<span class="string" id="4869173">&#34;PrimaryExpr&#34;</span><span class="op" id="4869186">)</span><span class="op" id="4869187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869194">x</span>&nbsp;<span class="op" id="4869196">:=</span>&nbsp;<span class="ident" id="4869199">p</span><span class="op" id="4869200">.</span><span class="ident" id="4869201">parseOperand</span><span class="op" id="4869213">(</span><span class="ident" id="4869214">lhs</span><span class="op" id="4869217">)</span><br>
<span class="lineno"></span><span class="ident" id="4869219">L</span><span class="op" id="4869220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869223">for</span>&nbsp;<span class="op" id="4869227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869231">switch</span>&nbsp;<span class="ident" id="4869238">p</span><span class="op" id="4869239">.</span><span class="ident" id="4869240">tok</span>&nbsp;<span class="op" id="4869244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869248">case</span>&nbsp;<span class="ident" id="4869253">token</span><span class="op" id="4869258">.</span><span class="ident" id="4869259">PERIOD</span><span class="op" id="4869265">:</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869270">p</span><span class="op" id="4869271">.</span><span class="ident" id="4869272">next</span><span class="op" id="4869276">(</span><span class="op" id="4869277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869282">if</span>&nbsp;<span class="ident" id="4869285">lhs</span>&nbsp;<span class="op" id="4869289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869295">p</span><span class="op" id="4869296">.</span><span class="ident" id="4869297">resolve</span><span class="op" id="4869304">(</span><span class="ident" id="4869305">x</span><span class="op" id="4869306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869316">switch</span>&nbsp;<span class="ident" id="4869323">p</span><span class="op" id="4869324">.</span><span class="ident" id="4869325">tok</span>&nbsp;<span class="op" id="4869329">{</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869334">case</span>&nbsp;<span class="ident" id="4869339">token</span><span class="op" id="4869344">.</span><span class="ident" id="4869345">IDENT</span><span class="op" id="4869350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869356">x</span>&nbsp;<span class="op" id="4869358">=</span>&nbsp;<span class="ident" id="4869360">p</span><span class="op" id="4869361">.</span><span class="ident" id="4869362">parseSelector</span><span class="op" id="4869375">(</span><span class="ident" id="4869376">p</span><span class="op" id="4869377">.</span><span class="ident" id="4869378">checkExprOrType</span><span class="op" id="4869393">(</span><span class="ident" id="4869394">x</span><span class="op" id="4869395">)</span><span class="op" id="4869396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869401">case</span>&nbsp;<span class="ident" id="4869406">token</span><span class="op" id="4869411">.</span><span class="ident" id="4869412">LPAREN</span><span class="op" id="4869418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869424">x</span>&nbsp;<span class="op" id="4869426">=</span>&nbsp;<span class="ident" id="4869428">p</span><span class="op" id="4869429">.</span><span class="ident" id="4869430">parseTypeAssertion</span><span class="op" id="4869448">(</span><span class="ident" id="4869449">p</span><span class="op" id="4869450">.</span><span class="ident" id="4869451">checkExpr</span><span class="op" id="4869460">(</span><span class="ident" id="4869461">x</span><span class="op" id="4869462">)</span><span class="op" id="4869463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869468">default</span><span class="op" id="4869475">:</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869481">pos</span>&nbsp;<span class="op" id="4869485">:=</span>&nbsp;<span class="ident" id="4869488">p</span><span class="op" id="4869489">.</span><span class="ident" id="4869490">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869498">p</span><span class="op" id="4869499">.</span><span class="ident" id="4869500">errorExpected</span><span class="op" id="4869513">(</span><span class="ident" id="4869514">pos</span><span class="op" id="4869517">,</span>&nbsp;<span class="string" id="4869519">&#34;selector&nbsp;or&nbsp;type&nbsp;assertion&#34;</span><span class="op" id="4869547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869553">p</span><span class="op" id="4869554">.</span><span class="ident" id="4869555">next</span><span class="op" id="4869559">(</span><span class="op" id="4869560">)</span>&nbsp;<span class="comment" id="4869562">//&nbsp;make&nbsp;progress</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869583">x</span>&nbsp;<span class="op" id="4869585">=</span>&nbsp;<span class="op" id="4869587">&amp;</span><span class="ident" id="4869588">ast</span><span class="op" id="4869591">.</span><span class="ident" id="4869592">BadExpr</span><span class="op" id="4869599">{</span><span class="ident" id="4869600">From</span><span class="op" id="4869604">:</span>&nbsp;<span class="ident" id="4869606">pos</span><span class="op" id="4869609">,</span>&nbsp;<span class="ident" id="4869611">To</span><span class="op" id="4869613">:</span>&nbsp;<span class="ident" id="4869615">p</span><span class="op" id="4869616">.</span><span class="ident" id="4869617">pos</span><span class="op" id="4869620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869625">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869629">case</span>&nbsp;<span class="ident" id="4869634">token</span><span class="op" id="4869639">.</span><span class="ident" id="4869640">LBRACK</span><span class="op" id="4869646">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869651">if</span>&nbsp;<span class="ident" id="4869654">lhs</span>&nbsp;<span class="op" id="4869658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869664">p</span><span class="op" id="4869665">.</span><span class="ident" id="4869666">resolve</span><span class="op" id="4869673">(</span><span class="ident" id="4869674">x</span><span class="op" id="4869675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869685">x</span>&nbsp;<span class="op" id="4869687">=</span>&nbsp;<span class="ident" id="4869689">p</span><span class="op" id="4869690">.</span><span class="ident" id="4869691">parseIndexOrSlice</span><span class="op" id="4869708">(</span><span class="ident" id="4869709">p</span><span class="op" id="4869710">.</span><span class="ident" id="4869711">checkExpr</span><span class="op" id="4869720">(</span><span class="ident" id="4869721">x</span><span class="op" id="4869722">)</span><span class="op" id="4869723">)</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869727">case</span>&nbsp;<span class="ident" id="4869732">token</span><span class="op" id="4869737">.</span><span class="ident" id="4869738">LPAREN</span><span class="op" id="4869744">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869749">if</span>&nbsp;<span class="ident" id="4869752">lhs</span>&nbsp;<span class="op" id="4869756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869762">p</span><span class="op" id="4869763">.</span><span class="ident" id="4869764">resolve</span><span class="op" id="4869771">(</span><span class="ident" id="4869772">x</span><span class="op" id="4869773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869783">x</span>&nbsp;<span class="op" id="4869785">=</span>&nbsp;<span class="ident" id="4869787">p</span><span class="op" id="4869788">.</span><span class="ident" id="4869789">parseCallOrConversion</span><span class="op" id="4869810">(</span><span class="ident" id="4869811">p</span><span class="op" id="4869812">.</span><span class="ident" id="4869813">checkExprOrType</span><span class="op" id="4869828">(</span><span class="ident" id="4869829">x</span><span class="op" id="4869830">)</span><span class="op" id="4869831">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869835">case</span>&nbsp;<span class="ident" id="4869840">token</span><span class="op" id="4869845">.</span><span class="ident" id="4869846">LBRACE</span><span class="op" id="4869852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869857">if</span>&nbsp;<span class="ident" id="4869860">isLiteralType</span><span class="op" id="4869873">(</span><span class="ident" id="4869874">x</span><span class="op" id="4869875">)</span>&nbsp;<span class="op" id="4869877">&amp;&amp;</span>&nbsp;<span class="op" id="4869880">(</span><span class="ident" id="4869881">p</span><span class="op" id="4869882">.</span><span class="ident" id="4869883">exprLev</span>&nbsp;<span class="op" id="4869891">&gt;=</span>&nbsp;<span class="num" id="4869894">0</span>&nbsp;<span class="op" id="4869896">||</span>&nbsp;<span class="op" id="4869899">!</span><span class="ident" id="4869900">isTypeName</span><span class="op" id="4869910">(</span><span class="ident" id="4869911">x</span><span class="op" id="4869912">)</span><span class="op" id="4869913">)</span>&nbsp;<span class="op" id="4869915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4869921">if</span>&nbsp;<span class="ident" id="4869924">lhs</span>&nbsp;<span class="op" id="4869928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869935">p</span><span class="op" id="4869936">.</span><span class="ident" id="4869937">resolve</span><span class="op" id="4869944">(</span><span class="ident" id="4869945">x</span><span class="op" id="4869946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869952">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4869958">x</span>&nbsp;<span class="op" id="4869960">=</span>&nbsp;<span class="ident" id="4869962">p</span><span class="op" id="4869963">.</span><span class="ident" id="4869964">parseLiteralValue</span><span class="op" id="4869981">(</span><span class="ident" id="4869982">x</span><span class="op" id="4869983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4869988">}</span>&nbsp;<span class="keyword" id="4869990">else</span>&nbsp;<span class="op" id="4869995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870001">break</span>&nbsp;<span class="ident" id="4870007">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870016">default</span><span class="op" id="4870023">:</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870028">break</span>&nbsp;<span class="ident" id="4870034">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870042">lhs</span>&nbsp;<span class="op" id="4870046">=</span>&nbsp;<span class="builtintype" id="4870048">false</span>&nbsp;<span class="comment" id="4870054">//&nbsp;no&nbsp;need&nbsp;to&nbsp;try&nbsp;to&nbsp;resolve&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870094">return</span>&nbsp;<span class="ident" id="4870101">x</span><br>
<span class="lineno"></span><span class="op" id="4870103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4870106">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4870176">func</span>&nbsp;<span class="op" id="4870181">(</span><span class="ident" id="4870182">p</span>&nbsp;<span class="op" id="4870184">*</span><span class="ident" id="4870185">parser</span><span class="op" id="4870191">)</span>&nbsp;<span class="ident" id="4870193">parseUnaryExpr</span><span class="op" id="4870207">(</span><span class="ident" id="4870208">lhs</span>&nbsp;<span class="builtintype" id="4870212">bool</span><span class="op" id="4870216">)</span>&nbsp;<span class="ident" id="4870218">ast</span><span class="op" id="4870221">.</span><span class="ident" id="4870222">Expr</span>&nbsp;<span class="op" id="4870227">{</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870230">if</span>&nbsp;<span class="ident" id="4870233">p</span><span class="op" id="4870234">.</span><span class="ident" id="4870235">trace</span>&nbsp;<span class="op" id="4870241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870245">defer</span>&nbsp;<span class="ident" id="4870251">un</span><span class="op" id="4870253">(</span><span class="ident" id="4870254">trace</span><span class="op" id="4870259">(</span><span class="ident" id="4870260">p</span><span class="op" id="4870261">,</span>&nbsp;<span class="string" id="4870263">&#34;UnaryExpr&#34;</span><span class="op" id="4870274">)</span><span class="op" id="4870275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4870278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870282">switch</span>&nbsp;<span class="ident" id="4870289">p</span><span class="op" id="4870290">.</span><span class="ident" id="4870291">tok</span>&nbsp;<span class="op" id="4870295">{</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870298">case</span>&nbsp;<span class="ident" id="4870303">token</span><span class="op" id="4870308">.</span><span class="ident" id="4870309">ADD</span><span class="op" id="4870312">,</span>&nbsp;<span class="ident" id="4870314">token</span><span class="op" id="4870319">.</span><span class="ident" id="4870320">SUB</span><span class="op" id="4870323">,</span>&nbsp;<span class="ident" id="4870325">token</span><span class="op" id="4870330">.</span><span class="ident" id="4870331">NOT</span><span class="op" id="4870334">,</span>&nbsp;<span class="ident" id="4870336">token</span><span class="op" id="4870341">.</span><span class="ident" id="4870342">XOR</span><span class="op" id="4870345">,</span>&nbsp;<span class="ident" id="4870347">token</span><span class="op" id="4870352">.</span><span class="ident" id="4870353">AND</span><span class="op" id="4870356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870360">pos</span><span class="op" id="4870363">,</span>&nbsp;<span class="ident" id="4870365">op</span>&nbsp;<span class="op" id="4870368">:=</span>&nbsp;<span class="ident" id="4870371">p</span><span class="op" id="4870372">.</span><span class="ident" id="4870373">pos</span><span class="op" id="4870376">,</span>&nbsp;<span class="ident" id="4870378">p</span><span class="op" id="4870379">.</span><span class="ident" id="4870380">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870386">p</span><span class="op" id="4870387">.</span><span class="ident" id="4870388">next</span><span class="op" id="4870392">(</span><span class="op" id="4870393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870397">x</span>&nbsp;<span class="op" id="4870399">:=</span>&nbsp;<span class="ident" id="4870402">p</span><span class="op" id="4870403">.</span><span class="ident" id="4870404">parseUnaryExpr</span><span class="op" id="4870418">(</span><span class="builtintype" id="4870419">false</span><span class="op" id="4870424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870428">return</span>&nbsp;<span class="op" id="4870435">&amp;</span><span class="ident" id="4870436">ast</span><span class="op" id="4870439">.</span><span class="ident" id="4870440">UnaryExpr</span><span class="op" id="4870449">{</span><span class="ident" id="4870450">OpPos</span><span class="op" id="4870455">:</span>&nbsp;<span class="ident" id="4870457">pos</span><span class="op" id="4870460">,</span>&nbsp;<span class="ident" id="4870462">Op</span><span class="op" id="4870464">:</span>&nbsp;<span class="ident" id="4870466">op</span><span class="op" id="4870468">,</span>&nbsp;<span class="ident" id="4870470">X</span><span class="op" id="4870471">:</span>&nbsp;<span class="ident" id="4870473">p</span><span class="op" id="4870474">.</span><span class="ident" id="4870475">checkExpr</span><span class="op" id="4870484">(</span><span class="ident" id="4870485">x</span><span class="op" id="4870486">)</span><span class="op" id="4870487">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4870491">case</span>&nbsp;<span class="ident" id="4870496">token</span><span class="op" id="4870501">.</span><span class="ident" id="4870502">ARROW</span><span class="op" id="4870507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870511">//&nbsp;channel&nbsp;type&nbsp;or&nbsp;receive&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870551">arrow</span>&nbsp;<span class="op" id="4870557">:=</span>&nbsp;<span class="ident" id="4870560">p</span><span class="op" id="4870561">.</span><span class="ident" id="4870562">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4870568">p</span><span class="op" id="4870569">.</span><span class="ident" id="4870570">next</span><span class="op" id="4870574">(</span><span class="op" id="4870575">)</span><br>
<span class="lineno">1505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870580">//&nbsp;If&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;token.CHAN&nbsp;we&nbsp;still&nbsp;don&#39;t&nbsp;know&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870643">//&nbsp;is&nbsp;a&nbsp;channel&nbsp;type&nbsp;or&nbsp;a&nbsp;receive&nbsp;operation&nbsp;-&nbsp;we&nbsp;only&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870704">//&nbsp;once&nbsp;we&nbsp;have&nbsp;found&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;unary&nbsp;expression.&nbsp;There</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870767">//&nbsp;are&nbsp;two&nbsp;cases:</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870787">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870792">//&nbsp;&nbsp;&nbsp;&lt;-&nbsp;type&nbsp;&nbsp;=&gt;&nbsp;(&lt;-type)&nbsp;must&nbsp;be&nbsp;channel&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870841">//&nbsp;&nbsp;&nbsp;&lt;-&nbsp;expr&nbsp;&nbsp;=&gt;&nbsp;&lt;-(expr)&nbsp;is&nbsp;a&nbsp;receive&nbsp;from&nbsp;an&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870901">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870906">//&nbsp;In&nbsp;the&nbsp;first&nbsp;case,&nbsp;the&nbsp;arrow&nbsp;must&nbsp;be&nbsp;re-associated&nbsp;with</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4870967">//&nbsp;the&nbsp;channel&nbsp;type&nbsp;parsed&nbsp;already:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871005">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871010">//&nbsp;&nbsp;&nbsp;&lt;-&nbsp;(chan&nbsp;type)&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;(&lt;-chan&nbsp;type)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871053">//&nbsp;&nbsp;&nbsp;&lt;-&nbsp;(chan&lt;-&nbsp;type)&nbsp;&nbsp;=&gt;&nbsp;&nbsp;(&lt;-chan&nbsp;(&lt;-type))</span><br>
<span class="lineno"></span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871101">x</span>&nbsp;<span class="op" id="4871103">:=</span>&nbsp;<span class="ident" id="4871106">p</span><span class="op" id="4871107">.</span><span class="ident" id="4871108">parseUnaryExpr</span><span class="op" id="4871122">(</span><span class="builtintype" id="4871123">false</span><span class="op" id="4871128">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871133">//&nbsp;determine&nbsp;which&nbsp;case&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871167">if</span>&nbsp;<span class="ident" id="4871170">typ</span><span class="op" id="4871173">,</span>&nbsp;<span class="ident" id="4871175">ok</span>&nbsp;<span class="op" id="4871178">:=</span>&nbsp;<span class="ident" id="4871181">x</span><span class="op" id="4871182">.</span><span class="op" id="4871183">(</span><span class="op" id="4871184">*</span><span class="ident" id="4871185">ast</span><span class="op" id="4871188">.</span><span class="ident" id="4871189">ChanType</span><span class="op" id="4871197">)</span><span class="op" id="4871198">;</span>&nbsp;<span class="ident" id="4871200">ok</span>&nbsp;<span class="op" id="4871203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871208">//&nbsp;(&lt;-type)</span><br>
<span class="lineno">1525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871224">//&nbsp;re-associate&nbsp;position&nbsp;info&nbsp;and&nbsp;&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871264">dir</span>&nbsp;<span class="op" id="4871268">:=</span>&nbsp;<span class="ident" id="4871271">ast</span><span class="op" id="4871274">.</span><span class="ident" id="4871275">SEND</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871283">for</span>&nbsp;<span class="ident" id="4871287">ok</span>&nbsp;<span class="op" id="4871290">&amp;&amp;</span>&nbsp;<span class="ident" id="4871293">dir</span>&nbsp;<span class="op" id="4871297">==</span>&nbsp;<span class="ident" id="4871300">ast</span><span class="op" id="4871303">.</span><span class="ident" id="4871304">SEND</span>&nbsp;<span class="op" id="4871309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871315">if</span>&nbsp;<span class="ident" id="4871318">typ</span><span class="op" id="4871321">.</span><span class="ident" id="4871322">Dir</span>&nbsp;<span class="op" id="4871326">==</span>&nbsp;<span class="ident" id="4871329">ast</span><span class="op" id="4871332">.</span><span class="ident" id="4871333">RECV</span>&nbsp;<span class="op" id="4871338">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871345">//&nbsp;error:&nbsp;(&lt;-type)&nbsp;is&nbsp;(&lt;-(&lt;-chan&nbsp;T))</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871387">p</span><span class="op" id="4871388">.</span><span class="ident" id="4871389">errorExpected</span><span class="op" id="4871402">(</span><span class="ident" id="4871403">typ</span><span class="op" id="4871406">.</span><span class="ident" id="4871407">Arrow</span><span class="op" id="4871412">,</span>&nbsp;<span class="string" id="4871414">&#34;&#39;chan&#39;&#34;</span><span class="op" id="4871422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4871428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871434">arrow</span><span class="op" id="4871439">,</span>&nbsp;<span class="ident" id="4871441">typ</span><span class="op" id="4871444">.</span><span class="ident" id="4871445">Begin</span><span class="op" id="4871450">,</span>&nbsp;<span class="ident" id="4871452">typ</span><span class="op" id="4871455">.</span><span class="ident" id="4871456">Arrow</span>&nbsp;<span class="op" id="4871462">=</span>&nbsp;<span class="ident" id="4871464">typ</span><span class="op" id="4871467">.</span><span class="ident" id="4871468">Arrow</span><span class="op" id="4871473">,</span>&nbsp;<span class="ident" id="4871475">arrow</span><span class="op" id="4871480">,</span>&nbsp;<span class="ident" id="4871482">arrow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871492">dir</span><span class="op" id="4871495">,</span>&nbsp;<span class="ident" id="4871497">typ</span><span class="op" id="4871500">.</span><span class="ident" id="4871501">Dir</span>&nbsp;<span class="op" id="4871505">=</span>&nbsp;<span class="ident" id="4871507">typ</span><span class="op" id="4871510">.</span><span class="ident" id="4871511">Dir</span><span class="op" id="4871514">,</span>&nbsp;<span class="ident" id="4871516">ast</span><span class="op" id="4871519">.</span><span class="ident" id="4871520">RECV</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871529">typ</span><span class="op" id="4871532">,</span>&nbsp;<span class="ident" id="4871534">ok</span>&nbsp;<span class="op" id="4871537">=</span>&nbsp;<span class="ident" id="4871539">typ</span><span class="op" id="4871542">.</span><span class="ident" id="4871543">Value</span><span class="op" id="4871548">.</span><span class="op" id="4871549">(</span><span class="op" id="4871550">*</span><span class="ident" id="4871551">ast</span><span class="op" id="4871554">.</span><span class="ident" id="4871555">ChanType</span><span class="op" id="4871563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4871568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871573">if</span>&nbsp;<span class="ident" id="4871576">dir</span>&nbsp;<span class="op" id="4871580">==</span>&nbsp;<span class="ident" id="4871583">ast</span><span class="op" id="4871586">.</span><span class="ident" id="4871587">SEND</span>&nbsp;<span class="op" id="4871592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871598">p</span><span class="op" id="4871599">.</span><span class="ident" id="4871600">errorExpected</span><span class="op" id="4871613">(</span><span class="ident" id="4871614">arrow</span><span class="op" id="4871619">,</span>&nbsp;<span class="string" id="4871621">&#34;channel&nbsp;type&#34;</span><span class="op" id="4871635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4871640">}</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871646">return</span>&nbsp;<span class="ident" id="4871653">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4871657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871662">//&nbsp;&lt;-(expr)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871676">return</span>&nbsp;<span class="op" id="4871683">&amp;</span><span class="ident" id="4871684">ast</span><span class="op" id="4871687">.</span><span class="ident" id="4871688">UnaryExpr</span><span class="op" id="4871697">{</span><span class="ident" id="4871698">OpPos</span><span class="op" id="4871703">:</span>&nbsp;<span class="ident" id="4871705">arrow</span><span class="op" id="4871710">,</span>&nbsp;<span class="ident" id="4871712">Op</span><span class="op" id="4871714">:</span>&nbsp;<span class="ident" id="4871716">token</span><span class="op" id="4871721">.</span><span class="ident" id="4871722">ARROW</span><span class="op" id="4871727">,</span>&nbsp;<span class="ident" id="4871729">X</span><span class="op" id="4871730">:</span>&nbsp;<span class="ident" id="4871732">p</span><span class="op" id="4871733">.</span><span class="ident" id="4871734">checkExpr</span><span class="op" id="4871743">(</span><span class="ident" id="4871744">x</span><span class="op" id="4871745">)</span><span class="op" id="4871746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871750">case</span>&nbsp;<span class="ident" id="4871755">token</span><span class="op" id="4871760">.</span><span class="ident" id="4871761">MUL</span><span class="op" id="4871764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4871768">//&nbsp;pointer&nbsp;type&nbsp;or&nbsp;unary&nbsp;&#34;*&#34;&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871810">pos</span>&nbsp;<span class="op" id="4871814">:=</span>&nbsp;<span class="ident" id="4871817">p</span><span class="op" id="4871818">.</span><span class="ident" id="4871819">pos</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871825">p</span><span class="op" id="4871826">.</span><span class="ident" id="4871827">next</span><span class="op" id="4871831">(</span><span class="op" id="4871832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4871836">x</span>&nbsp;<span class="op" id="4871838">:=</span>&nbsp;<span class="ident" id="4871841">p</span><span class="op" id="4871842">.</span><span class="ident" id="4871843">parseUnaryExpr</span><span class="op" id="4871857">(</span><span class="builtintype" id="4871858">false</span><span class="op" id="4871863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871867">return</span>&nbsp;<span class="op" id="4871874">&amp;</span><span class="ident" id="4871875">ast</span><span class="op" id="4871878">.</span><span class="ident" id="4871879">StarExpr</span><span class="op" id="4871887">{</span><span class="ident" id="4871888">Star</span><span class="op" id="4871892">:</span>&nbsp;<span class="ident" id="4871894">pos</span><span class="op" id="4871897">,</span>&nbsp;<span class="ident" id="4871899">X</span><span class="op" id="4871900">:</span>&nbsp;<span class="ident" id="4871902">p</span><span class="op" id="4871903">.</span><span class="ident" id="4871904">checkExprOrType</span><span class="op" id="4871919">(</span><span class="ident" id="4871920">x</span><span class="op" id="4871921">)</span><span class="op" id="4871922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4871925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4871929">return</span>&nbsp;<span class="ident" id="4871936">p</span><span class="op" id="4871937">.</span><span class="ident" id="4871938">parsePrimaryExpr</span><span class="op" id="4871954">(</span><span class="ident" id="4871955">lhs</span><span class="op" id="4871958">)</span><br>
<span class="lineno"></span><span class="op" id="4871960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871963">func</span>&nbsp;<span class="op" id="4871968">(</span><span class="ident" id="4871969">p</span>&nbsp;<span class="op" id="4871971">*</span><span class="ident" id="4871972">parser</span><span class="op" id="4871978">)</span>&nbsp;<span class="ident" id="4871980">tokPrec</span><span class="op" id="4871987">(</span><span class="op" id="4871988">)</span>&nbsp;<span class="op" id="4871990">(</span><span class="ident" id="4871991">token</span><span class="op" id="4871996">.</span><span class="ident" id="4871997">Token</span><span class="op" id="4872002">,</span>&nbsp;<span class="builtintype" id="4872004">int</span><span class="op" id="4872007">)</span>&nbsp;<span class="op" id="4872009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872012">tok</span>&nbsp;<span class="op" id="4872016">:=</span>&nbsp;<span class="ident" id="4872019">p</span><span class="op" id="4872020">.</span><span class="ident" id="4872021">tok</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872026">if</span>&nbsp;<span class="ident" id="4872029">p</span><span class="op" id="4872030">.</span><span class="ident" id="4872031">inRhs</span>&nbsp;<span class="op" id="4872037">&amp;&amp;</span>&nbsp;<span class="ident" id="4872040">tok</span>&nbsp;<span class="op" id="4872044">==</span>&nbsp;<span class="ident" id="4872047">token</span><span class="op" id="4872052">.</span><span class="ident" id="4872053">ASSIGN</span>&nbsp;<span class="op" id="4872060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872064">tok</span>&nbsp;<span class="op" id="4872068">=</span>&nbsp;<span class="ident" id="4872070">token</span><span class="op" id="4872075">.</span><span class="ident" id="4872076">EQL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872084">return</span>&nbsp;<span class="ident" id="4872091">tok</span><span class="op" id="4872094">,</span>&nbsp;<span class="ident" id="4872096">tok</span><span class="op" id="4872099">.</span><span class="ident" id="4872100">Precedence</span><span class="op" id="4872110">(</span><span class="op" id="4872111">)</span><br>
<span class="lineno"></span><span class="op" id="4872113">}</span><br>
<span class="lineno">1565</span><br>
<span class="lineno"></span><span class="comment" id="4872116">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="keyword" id="4872186">func</span>&nbsp;<span class="op" id="4872191">(</span><span class="ident" id="4872192">p</span>&nbsp;<span class="op" id="4872194">*</span><span class="ident" id="4872195">parser</span><span class="op" id="4872201">)</span>&nbsp;<span class="ident" id="4872203">parseBinaryExpr</span><span class="op" id="4872218">(</span><span class="ident" id="4872219">lhs</span>&nbsp;<span class="builtintype" id="4872223">bool</span><span class="op" id="4872227">,</span>&nbsp;<span class="ident" id="4872229">prec1</span>&nbsp;<span class="builtintype" id="4872235">int</span><span class="op" id="4872238">)</span>&nbsp;<span class="ident" id="4872240">ast</span><span class="op" id="4872243">.</span><span class="ident" id="4872244">Expr</span>&nbsp;<span class="op" id="4872249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872252">if</span>&nbsp;<span class="ident" id="4872255">p</span><span class="op" id="4872256">.</span><span class="ident" id="4872257">trace</span>&nbsp;<span class="op" id="4872263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872267">defer</span>&nbsp;<span class="ident" id="4872273">un</span><span class="op" id="4872275">(</span><span class="ident" id="4872276">trace</span><span class="op" id="4872281">(</span><span class="ident" id="4872282">p</span><span class="op" id="4872283">,</span>&nbsp;<span class="string" id="4872285">&#34;BinaryExpr&#34;</span><span class="op" id="4872297">)</span><span class="op" id="4872298">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872305">x</span>&nbsp;<span class="op" id="4872307">:=</span>&nbsp;<span class="ident" id="4872310">p</span><span class="op" id="4872311">.</span><span class="ident" id="4872312">parseUnaryExpr</span><span class="op" id="4872326">(</span><span class="ident" id="4872327">lhs</span><span class="op" id="4872330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872333">for</span>&nbsp;<span class="ident" id="4872337">_</span><span class="op" id="4872338">,</span>&nbsp;<span class="ident" id="4872340">prec</span>&nbsp;<span class="op" id="4872345">:=</span>&nbsp;<span class="ident" id="4872348">p</span><span class="op" id="4872349">.</span><span class="ident" id="4872350">tokPrec</span><span class="op" id="4872357">(</span><span class="op" id="4872358">)</span><span class="op" id="4872359">;</span>&nbsp;<span class="ident" id="4872361">prec</span>&nbsp;<span class="op" id="4872366">&gt;=</span>&nbsp;<span class="ident" id="4872369">prec1</span><span class="op" id="4872374">;</span>&nbsp;<span class="ident" id="4872376">prec</span><span class="op" id="4872380">--</span>&nbsp;<span class="op" id="4872383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872387">for</span>&nbsp;<span class="op" id="4872391">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872396">op</span><span class="op" id="4872398">,</span>&nbsp;<span class="ident" id="4872400">oprec</span>&nbsp;<span class="op" id="4872406">:=</span>&nbsp;<span class="ident" id="4872409">p</span><span class="op" id="4872410">.</span><span class="ident" id="4872411">tokPrec</span><span class="op" id="4872418">(</span><span class="op" id="4872419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872424">if</span>&nbsp;<span class="ident" id="4872427">oprec</span>&nbsp;<span class="op" id="4872433">!=</span>&nbsp;<span class="ident" id="4872436">prec</span>&nbsp;<span class="op" id="4872441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872447">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872461">pos</span>&nbsp;<span class="op" id="4872465">:=</span>&nbsp;<span class="ident" id="4872468">p</span><span class="op" id="4872469">.</span><span class="ident" id="4872470">expect</span><span class="op" id="4872476">(</span><span class="ident" id="4872477">op</span><span class="op" id="4872479">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872484">if</span>&nbsp;<span class="ident" id="4872487">lhs</span>&nbsp;<span class="op" id="4872491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872497">p</span><span class="op" id="4872498">.</span><span class="ident" id="4872499">resolve</span><span class="op" id="4872506">(</span><span class="ident" id="4872507">x</span><span class="op" id="4872508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872514">lhs</span>&nbsp;<span class="op" id="4872518">=</span>&nbsp;<span class="builtintype" id="4872520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872534">y</span>&nbsp;<span class="op" id="4872536">:=</span>&nbsp;<span class="ident" id="4872539">p</span><span class="op" id="4872540">.</span><span class="ident" id="4872541">parseBinaryExpr</span><span class="op" id="4872556">(</span><span class="builtintype" id="4872557">false</span><span class="op" id="4872562">,</span>&nbsp;<span class="ident" id="4872564">prec</span><span class="op" id="4872568">+</span><span class="num" id="4872569">1</span><span class="op" id="4872570">)</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4872575">x</span>&nbsp;<span class="op" id="4872577">=</span>&nbsp;<span class="op" id="4872579">&amp;</span><span class="ident" id="4872580">ast</span><span class="op" id="4872583">.</span><span class="ident" id="4872584">BinaryExpr</span><span class="op" id="4872594">{</span><span class="ident" id="4872595">X</span><span class="op" id="4872596">:</span>&nbsp;<span class="ident" id="4872598">p</span><span class="op" id="4872599">.</span><span class="ident" id="4872600">checkExpr</span><span class="op" id="4872609">(</span><span class="ident" id="4872610">x</span><span class="op" id="4872611">)</span><span class="op" id="4872612">,</span>&nbsp;<span class="ident" id="4872614">OpPos</span><span class="op" id="4872619">:</span>&nbsp;<span class="ident" id="4872621">pos</span><span class="op" id="4872624">,</span>&nbsp;<span class="ident" id="4872626">Op</span><span class="op" id="4872628">:</span>&nbsp;<span class="ident" id="4872630">op</span><span class="op" id="4872632">,</span>&nbsp;<span class="ident" id="4872634">Y</span><span class="op" id="4872635">:</span>&nbsp;<span class="ident" id="4872637">p</span><span class="op" id="4872638">.</span><span class="ident" id="4872639">checkExpr</span><span class="op" id="4872648">(</span><span class="ident" id="4872649">y</span><span class="op" id="4872650">)</span><span class="op" id="4872651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872662">return</span>&nbsp;<span class="ident" id="4872669">x</span><br>
<span class="lineno">1590</span><span class="op" id="4872671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4872674">//&nbsp;If&nbsp;lhs&nbsp;is&nbsp;set&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;an&nbsp;identifier,&nbsp;it&nbsp;is&nbsp;not&nbsp;resolved.</span><br>
<span class="lineno"></span><span class="comment" id="4872744">//&nbsp;The&nbsp;result&nbsp;may&nbsp;be&nbsp;a&nbsp;type&nbsp;or&nbsp;even&nbsp;a&nbsp;raw&nbsp;type&nbsp;([...]int).&nbsp;Callers&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="4872816">//&nbsp;check&nbsp;the&nbsp;result&nbsp;(using&nbsp;checkExpr&nbsp;or&nbsp;checkExprOrType),&nbsp;depending&nbsp;on</span><br>
<span class="lineno">1595</span><span class="comment" id="4872887">//&nbsp;context.</span><br>
<span class="lineno"></span><span class="keyword" id="4872899">func</span>&nbsp;<span class="op" id="4872904">(</span><span class="ident" id="4872905">p</span>&nbsp;<span class="op" id="4872907">*</span><span class="ident" id="4872908">parser</span><span class="op" id="4872914">)</span>&nbsp;<span class="ident" id="4872916">parseExpr</span><span class="op" id="4872925">(</span><span class="ident" id="4872926">lhs</span>&nbsp;<span class="builtintype" id="4872930">bool</span><span class="op" id="4872934">)</span>&nbsp;<span class="ident" id="4872936">ast</span><span class="op" id="4872939">.</span><span class="ident" id="4872940">Expr</span>&nbsp;<span class="op" id="4872945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872948">if</span>&nbsp;<span class="ident" id="4872951">p</span><span class="op" id="4872952">.</span><span class="ident" id="4872953">trace</span>&nbsp;<span class="op" id="4872959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4872963">defer</span>&nbsp;<span class="ident" id="4872969">un</span><span class="op" id="4872971">(</span><span class="ident" id="4872972">trace</span><span class="op" id="4872977">(</span><span class="ident" id="4872978">p</span><span class="op" id="4872979">,</span>&nbsp;<span class="string" id="4872981">&#34;Expression&#34;</span><span class="op" id="4872993">)</span><span class="op" id="4872994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4872997">}</span><br>
<span class="lineno">1600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873001">return</span>&nbsp;<span class="ident" id="4873008">p</span><span class="op" id="4873009">.</span><span class="ident" id="4873010">parseBinaryExpr</span><span class="op" id="4873025">(</span><span class="ident" id="4873026">lhs</span><span class="op" id="4873029">,</span>&nbsp;<span class="ident" id="4873031">token</span><span class="op" id="4873036">.</span><span class="ident" id="4873037">LowestPrec</span><span class="op" id="4873047">+</span><span class="num" id="4873048">1</span><span class="op" id="4873049">)</span><br>
<span class="lineno"></span><span class="op" id="4873051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4873054">func</span>&nbsp;<span class="op" id="4873059">(</span><span class="ident" id="4873060">p</span>&nbsp;<span class="op" id="4873062">*</span><span class="ident" id="4873063">parser</span><span class="op" id="4873069">)</span>&nbsp;<span class="ident" id="4873071">parseRhs</span><span class="op" id="4873079">(</span><span class="op" id="4873080">)</span>&nbsp;<span class="ident" id="4873082">ast</span><span class="op" id="4873085">.</span><span class="ident" id="4873086">Expr</span>&nbsp;<span class="op" id="4873091">{</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873094">old</span>&nbsp;<span class="op" id="4873098">:=</span>&nbsp;<span class="ident" id="4873101">p</span><span class="op" id="4873102">.</span><span class="ident" id="4873103">inRhs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873110">p</span><span class="op" id="4873111">.</span><span class="ident" id="4873112">inRhs</span>&nbsp;<span class="op" id="4873118">=</span>&nbsp;<span class="builtintype" id="4873120">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873126">x</span>&nbsp;<span class="op" id="4873128">:=</span>&nbsp;<span class="ident" id="4873131">p</span><span class="op" id="4873132">.</span><span class="ident" id="4873133">checkExpr</span><span class="op" id="4873142">(</span><span class="ident" id="4873143">p</span><span class="op" id="4873144">.</span><span class="ident" id="4873145">parseExpr</span><span class="op" id="4873154">(</span><span class="builtintype" id="4873155">false</span><span class="op" id="4873160">)</span><span class="op" id="4873161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873164">p</span><span class="op" id="4873165">.</span><span class="ident" id="4873166">inRhs</span>&nbsp;<span class="op" id="4873172">=</span>&nbsp;<span class="ident" id="4873174">old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873179">return</span>&nbsp;<span class="ident" id="4873186">x</span><br>
<span class="lineno">1610</span><span class="op" id="4873188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4873191">func</span>&nbsp;<span class="op" id="4873196">(</span><span class="ident" id="4873197">p</span>&nbsp;<span class="op" id="4873199">*</span><span class="ident" id="4873200">parser</span><span class="op" id="4873206">)</span>&nbsp;<span class="ident" id="4873208">parseRhsOrType</span><span class="op" id="4873222">(</span><span class="op" id="4873223">)</span>&nbsp;<span class="ident" id="4873225">ast</span><span class="op" id="4873228">.</span><span class="ident" id="4873229">Expr</span>&nbsp;<span class="op" id="4873234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873237">old</span>&nbsp;<span class="op" id="4873241">:=</span>&nbsp;<span class="ident" id="4873244">p</span><span class="op" id="4873245">.</span><span class="ident" id="4873246">inRhs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873253">p</span><span class="op" id="4873254">.</span><span class="ident" id="4873255">inRhs</span>&nbsp;<span class="op" id="4873261">=</span>&nbsp;<span class="builtintype" id="4873263">true</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873269">x</span>&nbsp;<span class="op" id="4873271">:=</span>&nbsp;<span class="ident" id="4873274">p</span><span class="op" id="4873275">.</span><span class="ident" id="4873276">checkExprOrType</span><span class="op" id="4873291">(</span><span class="ident" id="4873292">p</span><span class="op" id="4873293">.</span><span class="ident" id="4873294">parseExpr</span><span class="op" id="4873303">(</span><span class="builtintype" id="4873304">false</span><span class="op" id="4873309">)</span><span class="op" id="4873310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873313">p</span><span class="op" id="4873314">.</span><span class="ident" id="4873315">inRhs</span>&nbsp;<span class="op" id="4873321">=</span>&nbsp;<span class="ident" id="4873323">old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873328">return</span>&nbsp;<span class="ident" id="4873335">x</span><br>
<span class="lineno"></span><span class="op" id="4873337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1620</span><span class="comment" id="4873340">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4873420">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4873435">//&nbsp;Parsing&nbsp;modes&nbsp;for&nbsp;parseSimpleStmt.</span><br>
<span class="lineno"></span><span class="keyword" id="4873473">const</span>&nbsp;<span class="op" id="4873479">(</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873482">basic</span>&nbsp;<span class="op" id="4873488">=</span>&nbsp;<span class="ident" id="4873490">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873496">labelOk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873505">rangeOk</span><br>
<span class="lineno"></span><span class="op" id="4873513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1630</span><span class="comment" id="4873516">//&nbsp;parseSimpleStmt&nbsp;returns&nbsp;true&nbsp;as&nbsp;2nd&nbsp;result&nbsp;if&nbsp;it&nbsp;parsed&nbsp;the&nbsp;assignment</span><br>
<span class="lineno"></span><span class="comment" id="4873590">//&nbsp;of&nbsp;a&nbsp;range&nbsp;clause&nbsp;(with&nbsp;mode&nbsp;==&nbsp;rangeOk).&nbsp;The&nbsp;returned&nbsp;statement&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4873664">//&nbsp;assignment&nbsp;with&nbsp;a&nbsp;right-hand&nbsp;side&nbsp;that&nbsp;is&nbsp;a&nbsp;single&nbsp;unary&nbsp;expression&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4873738">//&nbsp;the&nbsp;form&nbsp;&#34;range&nbsp;x&#34;.&nbsp;No&nbsp;guarantees&nbsp;are&nbsp;given&nbsp;for&nbsp;the&nbsp;left-hand&nbsp;side.</span><br>
<span class="lineno"></span><span class="keyword" id="4873809">func</span>&nbsp;<span class="op" id="4873814">(</span><span class="ident" id="4873815">p</span>&nbsp;<span class="op" id="4873817">*</span><span class="ident" id="4873818">parser</span><span class="op" id="4873824">)</span>&nbsp;<span class="ident" id="4873826">parseSimpleStmt</span><span class="op" id="4873841">(</span><span class="ident" id="4873842">mode</span>&nbsp;<span class="builtintype" id="4873847">int</span><span class="op" id="4873850">)</span>&nbsp;<span class="op" id="4873852">(</span><span class="ident" id="4873853">ast</span><span class="op" id="4873856">.</span><span class="ident" id="4873857">Stmt</span><span class="op" id="4873861">,</span>&nbsp;<span class="builtintype" id="4873863">bool</span><span class="op" id="4873867">)</span>&nbsp;<span class="op" id="4873869">{</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873872">if</span>&nbsp;<span class="ident" id="4873875">p</span><span class="op" id="4873876">.</span><span class="ident" id="4873877">trace</span>&nbsp;<span class="op" id="4873883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873887">defer</span>&nbsp;<span class="ident" id="4873893">un</span><span class="op" id="4873895">(</span><span class="ident" id="4873896">trace</span><span class="op" id="4873901">(</span><span class="ident" id="4873902">p</span><span class="op" id="4873903">,</span>&nbsp;<span class="string" id="4873905">&#34;SimpleStmt&#34;</span><span class="op" id="4873917">)</span><span class="op" id="4873918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4873921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873925">x</span>&nbsp;<span class="op" id="4873927">:=</span>&nbsp;<span class="ident" id="4873930">p</span><span class="op" id="4873931">.</span><span class="ident" id="4873932">parseLhsList</span><span class="op" id="4873944">(</span><span class="op" id="4873945">)</span><br>
<span class="lineno">1640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873949">switch</span>&nbsp;<span class="ident" id="4873956">p</span><span class="op" id="4873957">.</span><span class="ident" id="4873958">tok</span>&nbsp;<span class="op" id="4873962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4873965">case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4873972">token</span><span class="op" id="4873977">.</span><span class="ident" id="4873978">DEFINE</span><span class="op" id="4873984">,</span>&nbsp;<span class="ident" id="4873986">token</span><span class="op" id="4873991">.</span><span class="ident" id="4873992">ASSIGN</span><span class="op" id="4873998">,</span>&nbsp;<span class="ident" id="4874000">token</span><span class="op" id="4874005">.</span><span class="ident" id="4874006">ADD_ASSIGN</span><span class="op" id="4874016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874020">token</span><span class="op" id="4874025">.</span><span class="ident" id="4874026">SUB_ASSIGN</span><span class="op" id="4874036">,</span>&nbsp;<span class="ident" id="4874038">token</span><span class="op" id="4874043">.</span><span class="ident" id="4874044">MUL_ASSIGN</span><span class="op" id="4874054">,</span>&nbsp;<span class="ident" id="4874056">token</span><span class="op" id="4874061">.</span><span class="ident" id="4874062">QUO_ASSIGN</span><span class="op" id="4874072">,</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874076">token</span><span class="op" id="4874081">.</span><span class="ident" id="4874082">REM_ASSIGN</span><span class="op" id="4874092">,</span>&nbsp;<span class="ident" id="4874094">token</span><span class="op" id="4874099">.</span><span class="ident" id="4874100">AND_ASSIGN</span><span class="op" id="4874110">,</span>&nbsp;<span class="ident" id="4874112">token</span><span class="op" id="4874117">.</span><span class="ident" id="4874118">OR_ASSIGN</span><span class="op" id="4874127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874131">token</span><span class="op" id="4874136">.</span><span class="ident" id="4874137">XOR_ASSIGN</span><span class="op" id="4874147">,</span>&nbsp;<span class="ident" id="4874149">token</span><span class="op" id="4874154">.</span><span class="ident" id="4874155">SHL_ASSIGN</span><span class="op" id="4874165">,</span>&nbsp;<span class="ident" id="4874167">token</span><span class="op" id="4874172">.</span><span class="ident" id="4874173">SHR_ASSIGN</span><span class="op" id="4874183">,</span>&nbsp;<span class="ident" id="4874185">token</span><span class="op" id="4874190">.</span><span class="ident" id="4874191">AND_NOT_ASSIGN</span><span class="op" id="4874205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4874209">//&nbsp;assignment&nbsp;statement,&nbsp;possibly&nbsp;part&nbsp;of&nbsp;a&nbsp;range&nbsp;clause</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874268">pos</span><span class="op" id="4874271">,</span>&nbsp;<span class="ident" id="4874273">tok</span>&nbsp;<span class="op" id="4874277">:=</span>&nbsp;<span class="ident" id="4874280">p</span><span class="op" id="4874281">.</span><span class="ident" id="4874282">pos</span><span class="op" id="4874285">,</span>&nbsp;<span class="ident" id="4874287">p</span><span class="op" id="4874288">.</span><span class="ident" id="4874289">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874295">p</span><span class="op" id="4874296">.</span><span class="ident" id="4874297">next</span><span class="op" id="4874301">(</span><span class="op" id="4874302">)</span><br>
<span class="lineno">1650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874306">var</span>&nbsp;<span class="ident" id="4874310">y</span>&nbsp;<span class="op" id="4874312">[</span><span class="op" id="4874313">]</span><span class="ident" id="4874314">ast</span><span class="op" id="4874317">.</span><span class="ident" id="4874318">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874325">isRange</span>&nbsp;<span class="op" id="4874333">:=</span>&nbsp;<span class="builtintype" id="4874336">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874344">if</span>&nbsp;<span class="ident" id="4874347">mode</span>&nbsp;<span class="op" id="4874352">==</span>&nbsp;<span class="ident" id="4874355">rangeOk</span>&nbsp;<span class="op" id="4874363">&amp;&amp;</span>&nbsp;<span class="ident" id="4874366">p</span><span class="op" id="4874367">.</span><span class="ident" id="4874368">tok</span>&nbsp;<span class="op" id="4874372">==</span>&nbsp;<span class="ident" id="4874375">token</span><span class="op" id="4874380">.</span><span class="ident" id="4874381">RANGE</span>&nbsp;<span class="op" id="4874387">&amp;&amp;</span>&nbsp;<span class="op" id="4874390">(</span><span class="ident" id="4874391">tok</span>&nbsp;<span class="op" id="4874395">==</span>&nbsp;<span class="ident" id="4874398">token</span><span class="op" id="4874403">.</span><span class="ident" id="4874404">DEFINE</span>&nbsp;<span class="op" id="4874411">||</span>&nbsp;<span class="ident" id="4874414">tok</span>&nbsp;<span class="op" id="4874418">==</span>&nbsp;<span class="ident" id="4874421">token</span><span class="op" id="4874426">.</span><span class="ident" id="4874427">ASSIGN</span><span class="op" id="4874433">)</span>&nbsp;<span class="op" id="4874435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874440">pos</span>&nbsp;<span class="op" id="4874444">:=</span>&nbsp;<span class="ident" id="4874447">p</span><span class="op" id="4874448">.</span><span class="ident" id="4874449">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874456">p</span><span class="op" id="4874457">.</span><span class="ident" id="4874458">next</span><span class="op" id="4874462">(</span><span class="op" id="4874463">)</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874468">y</span>&nbsp;<span class="op" id="4874470">=</span>&nbsp;<span class="op" id="4874472">[</span><span class="op" id="4874473">]</span><span class="ident" id="4874474">ast</span><span class="op" id="4874477">.</span><span class="ident" id="4874478">Expr</span><span class="op" id="4874482">{</span><span class="op" id="4874483">&amp;</span><span class="ident" id="4874484">ast</span><span class="op" id="4874487">.</span><span class="ident" id="4874488">UnaryExpr</span><span class="op" id="4874497">{</span><span class="ident" id="4874498">OpPos</span><span class="op" id="4874503">:</span>&nbsp;<span class="ident" id="4874505">pos</span><span class="op" id="4874508">,</span>&nbsp;<span class="ident" id="4874510">Op</span><span class="op" id="4874512">:</span>&nbsp;<span class="ident" id="4874514">token</span><span class="op" id="4874519">.</span><span class="ident" id="4874520">RANGE</span><span class="op" id="4874525">,</span>&nbsp;<span class="ident" id="4874527">X</span><span class="op" id="4874528">:</span>&nbsp;<span class="ident" id="4874530">p</span><span class="op" id="4874531">.</span><span class="ident" id="4874532">parseRhs</span><span class="op" id="4874540">(</span><span class="op" id="4874541">)</span><span class="op" id="4874542">}</span><span class="op" id="4874543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874548">isRange</span>&nbsp;<span class="op" id="4874556">=</span>&nbsp;<span class="builtintype" id="4874558">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874565">}</span>&nbsp;<span class="keyword" id="4874567">else</span>&nbsp;<span class="op" id="4874572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874577">y</span>&nbsp;<span class="op" id="4874579">=</span>&nbsp;<span class="ident" id="4874581">p</span><span class="op" id="4874582">.</span><span class="ident" id="4874583">parseRhsList</span><span class="op" id="4874595">(</span><span class="op" id="4874596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874600">}</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874604">as</span>&nbsp;<span class="op" id="4874607">:=</span>&nbsp;<span class="op" id="4874610">&amp;</span><span class="ident" id="4874611">ast</span><span class="op" id="4874614">.</span><span class="ident" id="4874615">AssignStmt</span><span class="op" id="4874625">{</span><span class="ident" id="4874626">Lhs</span><span class="op" id="4874629">:</span>&nbsp;<span class="ident" id="4874631">x</span><span class="op" id="4874632">,</span>&nbsp;<span class="ident" id="4874634">TokPos</span><span class="op" id="4874640">:</span>&nbsp;<span class="ident" id="4874642">pos</span><span class="op" id="4874645">,</span>&nbsp;<span class="ident" id="4874647">Tok</span><span class="op" id="4874650">:</span>&nbsp;<span class="ident" id="4874652">tok</span><span class="op" id="4874655">,</span>&nbsp;<span class="ident" id="4874657">Rhs</span><span class="op" id="4874660">:</span>&nbsp;<span class="ident" id="4874662">y</span><span class="op" id="4874663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874667">if</span>&nbsp;<span class="ident" id="4874670">tok</span>&nbsp;<span class="op" id="4874674">==</span>&nbsp;<span class="ident" id="4874677">token</span><span class="op" id="4874682">.</span><span class="ident" id="4874683">DEFINE</span>&nbsp;<span class="op" id="4874690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874695">p</span><span class="op" id="4874696">.</span><span class="ident" id="4874697">shortVarDecl</span><span class="op" id="4874709">(</span><span class="ident" id="4874710">as</span><span class="op" id="4874712">,</span>&nbsp;<span class="ident" id="4874714">x</span><span class="op" id="4874715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874723">return</span>&nbsp;<span class="ident" id="4874730">as</span><span class="op" id="4874732">,</span>&nbsp;<span class="ident" id="4874734">isRange</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874747">if</span>&nbsp;<span class="builtinfunc" id="4874750">len</span><span class="op" id="4874753">(</span><span class="ident" id="4874754">x</span><span class="op" id="4874755">)</span>&nbsp;<span class="op" id="4874757">&gt;</span>&nbsp;<span class="num" id="4874759">1</span>&nbsp;<span class="op" id="4874761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874765">p</span><span class="op" id="4874766">.</span><span class="ident" id="4874767">errorExpected</span><span class="op" id="4874780">(</span><span class="ident" id="4874781">x</span><span class="op" id="4874782">[</span><span class="num" id="4874783">0</span><span class="op" id="4874784">]</span><span class="op" id="4874785">.</span><span class="ident" id="4874786">Pos</span><span class="op" id="4874789">(</span><span class="op" id="4874790">)</span><span class="op" id="4874791">,</span>&nbsp;<span class="string" id="4874793">&#34;1&nbsp;expression&#34;</span><span class="op" id="4874807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4874811">//&nbsp;continue&nbsp;with&nbsp;first&nbsp;expression</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4874846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874850">switch</span>&nbsp;<span class="ident" id="4874857">p</span><span class="op" id="4874858">.</span><span class="ident" id="4874859">tok</span>&nbsp;<span class="op" id="4874863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874866">case</span>&nbsp;<span class="ident" id="4874871">token</span><span class="op" id="4874876">.</span><span class="ident" id="4874877">COLON</span><span class="op" id="4874882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4874886">//&nbsp;labeled&nbsp;statement</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874909">colon</span>&nbsp;<span class="op" id="4874915">:=</span>&nbsp;<span class="ident" id="4874918">p</span><span class="op" id="4874919">.</span><span class="ident" id="4874920">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4874926">p</span><span class="op" id="4874927">.</span><span class="ident" id="4874928">next</span><span class="op" id="4874932">(</span><span class="op" id="4874933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4874937">if</span>&nbsp;<span class="ident" id="4874940">label</span><span class="op" id="4874945">,</span>&nbsp;<span class="ident" id="4874947">isIdent</span>&nbsp;<span class="op" id="4874955">:=</span>&nbsp;<span class="ident" id="4874958">x</span><span class="op" id="4874959">[</span><span class="num" id="4874960">0</span><span class="op" id="4874961">]</span><span class="op" id="4874962">.</span><span class="op" id="4874963">(</span><span class="op" id="4874964">*</span><span class="ident" id="4874965">ast</span><span class="op" id="4874968">.</span><span class="ident" id="4874969">Ident</span><span class="op" id="4874974">)</span><span class="op" id="4874975">;</span>&nbsp;<span class="ident" id="4874977">mode</span>&nbsp;<span class="op" id="4874982">==</span>&nbsp;<span class="ident" id="4874985">labelOk</span>&nbsp;<span class="op" id="4874993">&amp;&amp;</span>&nbsp;<span class="ident" id="4874996">isIdent</span>&nbsp;<span class="op" id="4875004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875009">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;a&nbsp;label&nbsp;is&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875073">//&nbsp;in&nbsp;which&nbsp;it&nbsp;is&nbsp;declared&nbsp;and&nbsp;excludes&nbsp;the&nbsp;body&nbsp;of&nbsp;any&nbsp;nested</span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875139">//&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875155">stmt</span>&nbsp;<span class="op" id="4875160">:=</span>&nbsp;<span class="op" id="4875163">&amp;</span><span class="ident" id="4875164">ast</span><span class="op" id="4875167">.</span><span class="ident" id="4875168">LabeledStmt</span><span class="op" id="4875179">{</span><span class="ident" id="4875180">Label</span><span class="op" id="4875185">:</span>&nbsp;<span class="ident" id="4875187">label</span><span class="op" id="4875192">,</span>&nbsp;<span class="ident" id="4875194">Colon</span><span class="op" id="4875199">:</span>&nbsp;<span class="ident" id="4875201">colon</span><span class="op" id="4875206">,</span>&nbsp;<span class="ident" id="4875208">Stmt</span><span class="op" id="4875212">:</span>&nbsp;<span class="ident" id="4875214">p</span><span class="op" id="4875215">.</span><span class="ident" id="4875216">parseStmt</span><span class="op" id="4875225">(</span><span class="op" id="4875226">)</span><span class="op" id="4875227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875232">p</span><span class="op" id="4875233">.</span><span class="ident" id="4875234">declare</span><span class="op" id="4875241">(</span><span class="ident" id="4875242">stmt</span><span class="op" id="4875246">,</span>&nbsp;<span class="builtintype" id="4875248">nil</span><span class="op" id="4875251">,</span>&nbsp;<span class="ident" id="4875253">p</span><span class="op" id="4875254">.</span><span class="ident" id="4875255">labelScope</span><span class="op" id="4875265">,</span>&nbsp;<span class="ident" id="4875267">ast</span><span class="op" id="4875270">.</span><span class="ident" id="4875271">Lbl</span><span class="op" id="4875274">,</span>&nbsp;<span class="ident" id="4875276">label</span><span class="op" id="4875281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875286">return</span>&nbsp;<span class="ident" id="4875293">stmt</span><span class="op" id="4875297">,</span>&nbsp;<span class="builtintype" id="4875299">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4875307">}</span><br>
<span class="lineno">1685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875311">//&nbsp;The&nbsp;label&nbsp;declaration&nbsp;typically&nbsp;starts&nbsp;at&nbsp;x[0].Pos(),&nbsp;but&nbsp;the&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875384">//&nbsp;declaration&nbsp;may&nbsp;be&nbsp;erroneous&nbsp;due&nbsp;to&nbsp;a&nbsp;token&nbsp;after&nbsp;that&nbsp;position&nbsp;(and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875458">//&nbsp;before&nbsp;the&nbsp;&#39;:&#39;).&nbsp;If&nbsp;SpuriousErrors&nbsp;is&nbsp;not&nbsp;set,&nbsp;the&nbsp;(only)&nbsp;error&nbsp;re-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875531">//&nbsp;ported&nbsp;for&nbsp;the&nbsp;line&nbsp;is&nbsp;the&nbsp;illegal&nbsp;label&nbsp;error&nbsp;instead&nbsp;of&nbsp;the&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875604">//&nbsp;before&nbsp;the&nbsp;&#39;:&#39;&nbsp;that&nbsp;caused&nbsp;the&nbsp;problem.&nbsp;Thus,&nbsp;use&nbsp;the&nbsp;(latest)&nbsp;colon</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875678">//&nbsp;position&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875713">p</span><span class="op" id="4875714">.</span><span class="builtintype" id="4875715">error</span><span class="op" id="4875720">(</span><span class="ident" id="4875721">colon</span><span class="op" id="4875726">,</span>&nbsp;<span class="string" id="4875728">&#34;illegal&nbsp;label&nbsp;declaration&#34;</span><span class="op" id="4875755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875759">return</span>&nbsp;<span class="op" id="4875766">&amp;</span><span class="ident" id="4875767">ast</span><span class="op" id="4875770">.</span><span class="ident" id="4875771">BadStmt</span><span class="op" id="4875778">{</span><span class="ident" id="4875779">From</span><span class="op" id="4875783">:</span>&nbsp;<span class="ident" id="4875785">x</span><span class="op" id="4875786">[</span><span class="num" id="4875787">0</span><span class="op" id="4875788">]</span><span class="op" id="4875789">.</span><span class="ident" id="4875790">Pos</span><span class="op" id="4875793">(</span><span class="op" id="4875794">)</span><span class="op" id="4875795">,</span>&nbsp;<span class="ident" id="4875797">To</span><span class="op" id="4875799">:</span>&nbsp;<span class="ident" id="4875801">colon</span>&nbsp;<span class="op" id="4875807">+</span>&nbsp;<span class="num" id="4875809">1</span><span class="op" id="4875810">}</span><span class="op" id="4875811">,</span>&nbsp;<span class="builtintype" id="4875813">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875821">case</span>&nbsp;<span class="ident" id="4875826">token</span><span class="op" id="4875831">.</span><span class="ident" id="4875832">ARROW</span><span class="op" id="4875837">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4875841">//&nbsp;send&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875861">arrow</span>&nbsp;<span class="op" id="4875867">:=</span>&nbsp;<span class="ident" id="4875870">p</span><span class="op" id="4875871">.</span><span class="ident" id="4875872">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875878">p</span><span class="op" id="4875879">.</span><span class="ident" id="4875880">next</span><span class="op" id="4875884">(</span><span class="op" id="4875885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4875889">y</span>&nbsp;<span class="op" id="4875891">:=</span>&nbsp;<span class="ident" id="4875894">p</span><span class="op" id="4875895">.</span><span class="ident" id="4875896">parseRhs</span><span class="op" id="4875904">(</span><span class="op" id="4875905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875909">return</span>&nbsp;<span class="op" id="4875916">&amp;</span><span class="ident" id="4875917">ast</span><span class="op" id="4875920">.</span><span class="ident" id="4875921">SendStmt</span><span class="op" id="4875929">{</span><span class="ident" id="4875930">Chan</span><span class="op" id="4875934">:</span>&nbsp;<span class="ident" id="4875936">x</span><span class="op" id="4875937">[</span><span class="num" id="4875938">0</span><span class="op" id="4875939">]</span><span class="op" id="4875940">,</span>&nbsp;<span class="ident" id="4875942">Arrow</span><span class="op" id="4875947">:</span>&nbsp;<span class="ident" id="4875949">arrow</span><span class="op" id="4875954">,</span>&nbsp;<span class="ident" id="4875956">Value</span><span class="op" id="4875961">:</span>&nbsp;<span class="ident" id="4875963">y</span><span class="op" id="4875964">}</span><span class="op" id="4875965">,</span>&nbsp;<span class="builtintype" id="4875967">false</span><br>
<span class="lineno">1700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4875975">case</span>&nbsp;<span class="ident" id="4875980">token</span><span class="op" id="4875985">.</span><span class="ident" id="4875986">INC</span><span class="op" id="4875989">,</span>&nbsp;<span class="ident" id="4875991">token</span><span class="op" id="4875996">.</span><span class="ident" id="4875997">DEC</span><span class="op" id="4876000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4876004">//&nbsp;increment&nbsp;or&nbsp;decrement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876032">s</span>&nbsp;<span class="op" id="4876034">:=</span>&nbsp;<span class="op" id="4876037">&amp;</span><span class="ident" id="4876038">ast</span><span class="op" id="4876041">.</span><span class="ident" id="4876042">IncDecStmt</span><span class="op" id="4876052">{</span><span class="ident" id="4876053">X</span><span class="op" id="4876054">:</span>&nbsp;<span class="ident" id="4876056">x</span><span class="op" id="4876057">[</span><span class="num" id="4876058">0</span><span class="op" id="4876059">]</span><span class="op" id="4876060">,</span>&nbsp;<span class="ident" id="4876062">TokPos</span><span class="op" id="4876068">:</span>&nbsp;<span class="ident" id="4876070">p</span><span class="op" id="4876071">.</span><span class="ident" id="4876072">pos</span><span class="op" id="4876075">,</span>&nbsp;<span class="ident" id="4876077">Tok</span><span class="op" id="4876080">:</span>&nbsp;<span class="ident" id="4876082">p</span><span class="op" id="4876083">.</span><span class="ident" id="4876084">tok</span><span class="op" id="4876087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876091">p</span><span class="op" id="4876092">.</span><span class="ident" id="4876093">next</span><span class="op" id="4876097">(</span><span class="op" id="4876098">)</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876102">return</span>&nbsp;<span class="ident" id="4876109">s</span><span class="op" id="4876110">,</span>&nbsp;<span class="builtintype" id="4876112">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4876123">//&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876138">return</span>&nbsp;<span class="op" id="4876145">&amp;</span><span class="ident" id="4876146">ast</span><span class="op" id="4876149">.</span><span class="ident" id="4876150">ExprStmt</span><span class="op" id="4876158">{</span><span class="ident" id="4876159">X</span><span class="op" id="4876160">:</span>&nbsp;<span class="ident" id="4876162">x</span><span class="op" id="4876163">[</span><span class="num" id="4876164">0</span><span class="op" id="4876165">]</span><span class="op" id="4876166">}</span><span class="op" id="4876167">,</span>&nbsp;<span class="builtintype" id="4876169">false</span><br>
<span class="lineno">1710</span><span class="op" id="4876175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876178">func</span>&nbsp;<span class="op" id="4876183">(</span><span class="ident" id="4876184">p</span>&nbsp;<span class="op" id="4876186">*</span><span class="ident" id="4876187">parser</span><span class="op" id="4876193">)</span>&nbsp;<span class="ident" id="4876195">parseCallExpr</span><span class="op" id="4876208">(</span><span class="ident" id="4876209">callType</span>&nbsp;<span class="builtintype" id="4876218">string</span><span class="op" id="4876224">)</span>&nbsp;<span class="op" id="4876226">*</span><span class="ident" id="4876227">ast</span><span class="op" id="4876230">.</span><span class="ident" id="4876231">CallExpr</span>&nbsp;<span class="op" id="4876240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876243">x</span>&nbsp;<span class="op" id="4876245">:=</span>&nbsp;<span class="ident" id="4876248">p</span><span class="op" id="4876249">.</span><span class="ident" id="4876250">parseRhsOrType</span><span class="op" id="4876264">(</span><span class="op" id="4876265">)</span>&nbsp;<span class="comment" id="4876267">//&nbsp;could&nbsp;be&nbsp;a&nbsp;conversion:&nbsp;(some&nbsp;type)(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876309">if</span>&nbsp;<span class="ident" id="4876312">call</span><span class="op" id="4876316">,</span>&nbsp;<span class="ident" id="4876318">isCall</span>&nbsp;<span class="op" id="4876325">:=</span>&nbsp;<span class="ident" id="4876328">x</span><span class="op" id="4876329">.</span><span class="op" id="4876330">(</span><span class="op" id="4876331">*</span><span class="ident" id="4876332">ast</span><span class="op" id="4876335">.</span><span class="ident" id="4876336">CallExpr</span><span class="op" id="4876344">)</span><span class="op" id="4876345">;</span>&nbsp;<span class="ident" id="4876347">isCall</span>&nbsp;<span class="op" id="4876354">{</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876358">return</span>&nbsp;<span class="ident" id="4876365">call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876374">if</span>&nbsp;<span class="ident" id="4876377">_</span><span class="op" id="4876378">,</span>&nbsp;<span class="ident" id="4876380">isBad</span>&nbsp;<span class="op" id="4876386">:=</span>&nbsp;<span class="ident" id="4876389">x</span><span class="op" id="4876390">.</span><span class="op" id="4876391">(</span><span class="op" id="4876392">*</span><span class="ident" id="4876393">ast</span><span class="op" id="4876396">.</span><span class="ident" id="4876397">BadExpr</span><span class="op" id="4876404">)</span><span class="op" id="4876405">;</span>&nbsp;<span class="op" id="4876407">!</span><span class="ident" id="4876408">isBad</span>&nbsp;<span class="op" id="4876414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4876418">//&nbsp;only&nbsp;report&nbsp;error&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;new&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876459">p</span><span class="op" id="4876460">.</span><span class="builtintype" id="4876461">error</span><span class="op" id="4876466">(</span><span class="ident" id="4876467">p</span><span class="op" id="4876468">.</span><span class="ident" id="4876469">safePos</span><span class="op" id="4876476">(</span><span class="ident" id="4876477">x</span><span class="op" id="4876478">.</span><span class="ident" id="4876479">End</span><span class="op" id="4876482">(</span><span class="op" id="4876483">)</span><span class="op" id="4876484">)</span><span class="op" id="4876485">,</span>&nbsp;<span class="ident" id="4876487">fmt</span><span class="op" id="4876490">.</span><span class="ident" id="4876491">Sprintf</span><span class="op" id="4876498">(</span><span class="string" id="4876499">&#34;function&nbsp;must&nbsp;be&nbsp;invoked&nbsp;in&nbsp;%s&nbsp;statement&#34;</span><span class="op" id="4876541">,</span>&nbsp;<span class="ident" id="4876543">callType</span><span class="op" id="4876551">)</span><span class="op" id="4876552">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876558">return</span>&nbsp;<span class="builtintype" id="4876565">nil</span><br>
<span class="lineno"></span><span class="op" id="4876569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876572">func</span>&nbsp;<span class="op" id="4876577">(</span><span class="ident" id="4876578">p</span>&nbsp;<span class="op" id="4876580">*</span><span class="ident" id="4876581">parser</span><span class="op" id="4876587">)</span>&nbsp;<span class="ident" id="4876589">parseGoStmt</span><span class="op" id="4876600">(</span><span class="op" id="4876601">)</span>&nbsp;<span class="ident" id="4876603">ast</span><span class="op" id="4876606">.</span><span class="ident" id="4876607">Stmt</span>&nbsp;<span class="op" id="4876612">{</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876615">if</span>&nbsp;<span class="ident" id="4876618">p</span><span class="op" id="4876619">.</span><span class="ident" id="4876620">trace</span>&nbsp;<span class="op" id="4876626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876630">defer</span>&nbsp;<span class="ident" id="4876636">un</span><span class="op" id="4876638">(</span><span class="ident" id="4876639">trace</span><span class="op" id="4876644">(</span><span class="ident" id="4876645">p</span><span class="op" id="4876646">,</span>&nbsp;<span class="string" id="4876648">&#34;GoStmt&#34;</span><span class="op" id="4876656">)</span><span class="op" id="4876657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876664">pos</span>&nbsp;<span class="op" id="4876668">:=</span>&nbsp;<span class="ident" id="4876671">p</span><span class="op" id="4876672">.</span><span class="ident" id="4876673">expect</span><span class="op" id="4876679">(</span><span class="ident" id="4876680">token</span><span class="op" id="4876685">.</span><span class="ident" id="4876686">GO</span><span class="op" id="4876688">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876691">call</span>&nbsp;<span class="op" id="4876696">:=</span>&nbsp;<span class="ident" id="4876699">p</span><span class="op" id="4876700">.</span><span class="ident" id="4876701">parseCallExpr</span><span class="op" id="4876714">(</span><span class="string" id="4876715">&#34;go&#34;</span><span class="op" id="4876719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876722">p</span><span class="op" id="4876723">.</span><span class="ident" id="4876724">expectSemi</span><span class="op" id="4876734">(</span><span class="op" id="4876735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876738">if</span>&nbsp;<span class="ident" id="4876741">call</span>&nbsp;<span class="op" id="4876746">==</span>&nbsp;<span class="builtintype" id="4876749">nil</span>&nbsp;<span class="op" id="4876753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876757">return</span>&nbsp;<span class="op" id="4876764">&amp;</span><span class="ident" id="4876765">ast</span><span class="op" id="4876768">.</span><span class="ident" id="4876769">BadStmt</span><span class="op" id="4876776">{</span><span class="ident" id="4876777">From</span><span class="op" id="4876781">:</span>&nbsp;<span class="ident" id="4876783">pos</span><span class="op" id="4876786">,</span>&nbsp;<span class="ident" id="4876788">To</span><span class="op" id="4876790">:</span>&nbsp;<span class="ident" id="4876792">pos</span>&nbsp;<span class="op" id="4876796">+</span>&nbsp;<span class="num" id="4876798">2</span><span class="op" id="4876799">}</span>&nbsp;<span class="comment" id="4876801">//&nbsp;len(&#34;go&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876815">}</span><br>
<span class="lineno">1735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876819">return</span>&nbsp;<span class="op" id="4876826">&amp;</span><span class="ident" id="4876827">ast</span><span class="op" id="4876830">.</span><span class="ident" id="4876831">GoStmt</span><span class="op" id="4876837">{</span><span class="ident" id="4876838">Go</span><span class="op" id="4876840">:</span>&nbsp;<span class="ident" id="4876842">pos</span><span class="op" id="4876845">,</span>&nbsp;<span class="ident" id="4876847">Call</span><span class="op" id="4876851">:</span>&nbsp;<span class="ident" id="4876853">call</span><span class="op" id="4876857">}</span><br>
<span class="lineno"></span><span class="op" id="4876859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4876862">func</span>&nbsp;<span class="op" id="4876867">(</span><span class="ident" id="4876868">p</span>&nbsp;<span class="op" id="4876870">*</span><span class="ident" id="4876871">parser</span><span class="op" id="4876877">)</span>&nbsp;<span class="ident" id="4876879">parseDeferStmt</span><span class="op" id="4876893">(</span><span class="op" id="4876894">)</span>&nbsp;<span class="ident" id="4876896">ast</span><span class="op" id="4876899">.</span><span class="ident" id="4876900">Stmt</span>&nbsp;<span class="op" id="4876905">{</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876908">if</span>&nbsp;<span class="ident" id="4876911">p</span><span class="op" id="4876912">.</span><span class="ident" id="4876913">trace</span>&nbsp;<span class="op" id="4876919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4876923">defer</span>&nbsp;<span class="ident" id="4876929">un</span><span class="op" id="4876931">(</span><span class="ident" id="4876932">trace</span><span class="op" id="4876937">(</span><span class="ident" id="4876938">p</span><span class="op" id="4876939">,</span>&nbsp;<span class="string" id="4876941">&#34;DeferStmt&#34;</span><span class="op" id="4876952">)</span><span class="op" id="4876953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4876956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876960">pos</span>&nbsp;<span class="op" id="4876964">:=</span>&nbsp;<span class="ident" id="4876967">p</span><span class="op" id="4876968">.</span><span class="ident" id="4876969">expect</span><span class="op" id="4876975">(</span><span class="ident" id="4876976">token</span><span class="op" id="4876981">.</span><span class="ident" id="4876982">DEFER</span><span class="op" id="4876987">)</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4876990">call</span>&nbsp;<span class="op" id="4876995">:=</span>&nbsp;<span class="ident" id="4876998">p</span><span class="op" id="4876999">.</span><span class="ident" id="4877000">parseCallExpr</span><span class="op" id="4877013">(</span><span class="string" id="4877014">&#34;defer&#34;</span><span class="op" id="4877021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877024">p</span><span class="op" id="4877025">.</span><span class="ident" id="4877026">expectSemi</span><span class="op" id="4877036">(</span><span class="op" id="4877037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877040">if</span>&nbsp;<span class="ident" id="4877043">call</span>&nbsp;<span class="op" id="4877048">==</span>&nbsp;<span class="builtintype" id="4877051">nil</span>&nbsp;<span class="op" id="4877055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877059">return</span>&nbsp;<span class="op" id="4877066">&amp;</span><span class="ident" id="4877067">ast</span><span class="op" id="4877070">.</span><span class="ident" id="4877071">BadStmt</span><span class="op" id="4877078">{</span><span class="ident" id="4877079">From</span><span class="op" id="4877083">:</span>&nbsp;<span class="ident" id="4877085">pos</span><span class="op" id="4877088">,</span>&nbsp;<span class="ident" id="4877090">To</span><span class="op" id="4877092">:</span>&nbsp;<span class="ident" id="4877094">pos</span>&nbsp;<span class="op" id="4877098">+</span>&nbsp;<span class="num" id="4877100">5</span><span class="op" id="4877101">}</span>&nbsp;<span class="comment" id="4877103">//&nbsp;len(&#34;defer&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4877120">}</span><br>
<span class="lineno">1750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877124">return</span>&nbsp;<span class="op" id="4877131">&amp;</span><span class="ident" id="4877132">ast</span><span class="op" id="4877135">.</span><span class="ident" id="4877136">DeferStmt</span><span class="op" id="4877145">{</span><span class="ident" id="4877146">Defer</span><span class="op" id="4877151">:</span>&nbsp;<span class="ident" id="4877153">pos</span><span class="op" id="4877156">,</span>&nbsp;<span class="ident" id="4877158">Call</span><span class="op" id="4877162">:</span>&nbsp;<span class="ident" id="4877164">call</span><span class="op" id="4877168">}</span><br>
<span class="lineno"></span><span class="op" id="4877170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4877173">func</span>&nbsp;<span class="op" id="4877178">(</span><span class="ident" id="4877179">p</span>&nbsp;<span class="op" id="4877181">*</span><span class="ident" id="4877182">parser</span><span class="op" id="4877188">)</span>&nbsp;<span class="ident" id="4877190">parseReturnStmt</span><span class="op" id="4877205">(</span><span class="op" id="4877206">)</span>&nbsp;<span class="op" id="4877208">*</span><span class="ident" id="4877209">ast</span><span class="op" id="4877212">.</span><span class="ident" id="4877213">ReturnStmt</span>&nbsp;<span class="op" id="4877224">{</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877227">if</span>&nbsp;<span class="ident" id="4877230">p</span><span class="op" id="4877231">.</span><span class="ident" id="4877232">trace</span>&nbsp;<span class="op" id="4877238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877242">defer</span>&nbsp;<span class="ident" id="4877248">un</span><span class="op" id="4877250">(</span><span class="ident" id="4877251">trace</span><span class="op" id="4877256">(</span><span class="ident" id="4877257">p</span><span class="op" id="4877258">,</span>&nbsp;<span class="string" id="4877260">&#34;ReturnStmt&#34;</span><span class="op" id="4877272">)</span><span class="op" id="4877273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4877276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877280">pos</span>&nbsp;<span class="op" id="4877284">:=</span>&nbsp;<span class="ident" id="4877287">p</span><span class="op" id="4877288">.</span><span class="ident" id="4877289">pos</span><br>
<span class="lineno">1760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877294">p</span><span class="op" id="4877295">.</span><span class="ident" id="4877296">expect</span><span class="op" id="4877302">(</span><span class="ident" id="4877303">token</span><span class="op" id="4877308">.</span><span class="ident" id="4877309">RETURN</span><span class="op" id="4877315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877318">var</span>&nbsp;<span class="ident" id="4877322">x</span>&nbsp;<span class="op" id="4877324">[</span><span class="op" id="4877325">]</span><span class="ident" id="4877326">ast</span><span class="op" id="4877329">.</span><span class="ident" id="4877330">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877336">if</span>&nbsp;<span class="ident" id="4877339">p</span><span class="op" id="4877340">.</span><span class="ident" id="4877341">tok</span>&nbsp;<span class="op" id="4877345">!=</span>&nbsp;<span class="ident" id="4877348">token</span><span class="op" id="4877353">.</span><span class="ident" id="4877354">SEMICOLON</span>&nbsp;<span class="op" id="4877364">&amp;&amp;</span>&nbsp;<span class="ident" id="4877367">p</span><span class="op" id="4877368">.</span><span class="ident" id="4877369">tok</span>&nbsp;<span class="op" id="4877373">!=</span>&nbsp;<span class="ident" id="4877376">token</span><span class="op" id="4877381">.</span><span class="ident" id="4877382">RBRACE</span>&nbsp;<span class="op" id="4877389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877393">x</span>&nbsp;<span class="op" id="4877395">=</span>&nbsp;<span class="ident" id="4877397">p</span><span class="op" id="4877398">.</span><span class="ident" id="4877399">parseRhsList</span><span class="op" id="4877411">(</span><span class="op" id="4877412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4877415">}</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877418">p</span><span class="op" id="4877419">.</span><span class="ident" id="4877420">expectSemi</span><span class="op" id="4877430">(</span><span class="op" id="4877431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877435">return</span>&nbsp;<span class="op" id="4877442">&amp;</span><span class="ident" id="4877443">ast</span><span class="op" id="4877446">.</span><span class="ident" id="4877447">ReturnStmt</span><span class="op" id="4877457">{</span><span class="ident" id="4877458">Return</span><span class="op" id="4877464">:</span>&nbsp;<span class="ident" id="4877466">pos</span><span class="op" id="4877469">,</span>&nbsp;<span class="ident" id="4877471">Results</span><span class="op" id="4877478">:</span>&nbsp;<span class="ident" id="4877480">x</span><span class="op" id="4877481">}</span><br>
<span class="lineno"></span><span class="op" id="4877483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1770</span><span class="keyword" id="4877486">func</span>&nbsp;<span class="op" id="4877491">(</span><span class="ident" id="4877492">p</span>&nbsp;<span class="op" id="4877494">*</span><span class="ident" id="4877495">parser</span><span class="op" id="4877501">)</span>&nbsp;<span class="ident" id="4877503">parseBranchStmt</span><span class="op" id="4877518">(</span><span class="ident" id="4877519">tok</span>&nbsp;<span class="ident" id="4877523">token</span><span class="op" id="4877528">.</span><span class="ident" id="4877529">Token</span><span class="op" id="4877534">)</span>&nbsp;<span class="op" id="4877536">*</span><span class="ident" id="4877537">ast</span><span class="op" id="4877540">.</span><span class="ident" id="4877541">BranchStmt</span>&nbsp;<span class="op" id="4877552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877555">if</span>&nbsp;<span class="ident" id="4877558">p</span><span class="op" id="4877559">.</span><span class="ident" id="4877560">trace</span>&nbsp;<span class="op" id="4877566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877570">defer</span>&nbsp;<span class="ident" id="4877576">un</span><span class="op" id="4877578">(</span><span class="ident" id="4877579">trace</span><span class="op" id="4877584">(</span><span class="ident" id="4877585">p</span><span class="op" id="4877586">,</span>&nbsp;<span class="string" id="4877588">&#34;BranchStmt&#34;</span><span class="op" id="4877600">)</span><span class="op" id="4877601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4877604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877608">pos</span>&nbsp;<span class="op" id="4877612">:=</span>&nbsp;<span class="ident" id="4877615">p</span><span class="op" id="4877616">.</span><span class="ident" id="4877617">expect</span><span class="op" id="4877623">(</span><span class="ident" id="4877624">tok</span><span class="op" id="4877627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877630">var</span>&nbsp;<span class="ident" id="4877634">label</span>&nbsp;<span class="op" id="4877640">*</span><span class="ident" id="4877641">ast</span><span class="op" id="4877644">.</span><span class="ident" id="4877645">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877652">if</span>&nbsp;<span class="ident" id="4877655">tok</span>&nbsp;<span class="op" id="4877659">!=</span>&nbsp;<span class="ident" id="4877662">token</span><span class="op" id="4877667">.</span><span class="ident" id="4877668">FALLTHROUGH</span>&nbsp;<span class="op" id="4877680">&amp;&amp;</span>&nbsp;<span class="ident" id="4877683">p</span><span class="op" id="4877684">.</span><span class="ident" id="4877685">tok</span>&nbsp;<span class="op" id="4877689">==</span>&nbsp;<span class="ident" id="4877692">token</span><span class="op" id="4877697">.</span><span class="ident" id="4877698">IDENT</span>&nbsp;<span class="op" id="4877704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877708">label</span>&nbsp;<span class="op" id="4877714">=</span>&nbsp;<span class="ident" id="4877716">p</span><span class="op" id="4877717">.</span><span class="ident" id="4877718">parseIdent</span><span class="op" id="4877728">(</span><span class="op" id="4877729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4877733">//&nbsp;add&nbsp;to&nbsp;list&nbsp;of&nbsp;unresolved&nbsp;targets</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877772">n</span>&nbsp;<span class="op" id="4877774">:=</span>&nbsp;<span class="builtinfunc" id="4877777">len</span><span class="op" id="4877780">(</span><span class="ident" id="4877781">p</span><span class="op" id="4877782">.</span><span class="ident" id="4877783">targetStack</span><span class="op" id="4877794">)</span>&nbsp;<span class="op" id="4877796">-</span>&nbsp;<span class="num" id="4877798">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877802">p</span><span class="op" id="4877803">.</span><span class="ident" id="4877804">targetStack</span><span class="op" id="4877815">[</span><span class="ident" id="4877816">n</span><span class="op" id="4877817">]</span>&nbsp;<span class="op" id="4877819">=</span>&nbsp;<span class="builtinfunc" id="4877821">append</span><span class="op" id="4877827">(</span><span class="ident" id="4877828">p</span><span class="op" id="4877829">.</span><span class="ident" id="4877830">targetStack</span><span class="op" id="4877841">[</span><span class="ident" id="4877842">n</span><span class="op" id="4877843">]</span><span class="op" id="4877844">,</span>&nbsp;<span class="ident" id="4877846">label</span><span class="op" id="4877851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4877854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4877857">p</span><span class="op" id="4877858">.</span><span class="ident" id="4877859">expectSemi</span><span class="op" id="4877869">(</span><span class="op" id="4877870">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4877874">return</span>&nbsp;<span class="op" id="4877881">&amp;</span><span class="ident" id="4877882">ast</span><span class="op" id="4877885">.</span><span class="ident" id="4877886">BranchStmt</span><span class="op" id="4877896">{</span><span class="ident" id="4877897">TokPos</span><span class="op" id="4877903">:</span>&nbsp;<span class="ident" id="4877905">pos</span><span class="op" id="4877908">,</span>&nbsp;<span class="ident" id="4877910">Tok</span><span class="op" id="4877913">:</span>&nbsp;<span class="ident" id="4877915">tok</span><span class="op" id="4877918">,</span>&nbsp;<span class="ident" id="4877920">Label</span><span class="op" id="4877925">:</span>&nbsp;<span class="ident" id="4877927">label</span><span class="op" id="4877932">}</span><br>
<span class="lineno"></span><span class="op" id="4877934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4877937">func</span>&nbsp;<span class="op" id="4877942">(</span><span class="ident" id="4877943">p</span>&nbsp;<span class="op" id="4877945">*</span><span class="ident" id="4877946">parser</span><span class="op" id="4877952">)</span>&nbsp;<span class="ident" id="4877954">makeExpr</span><span class="op" id="4877962">(</span><span class="ident" id="4877963">s</span>&nbsp;<span class="ident" id="4877965">ast</span><span class="op" id="4877968">.</span><span class="ident" id="4877969">Stmt</span><span class="op" id="4877973">,</span>&nbsp;<span class="ident" id="4877975">kind</span>&nbsp;<span class="builtintype" id="4877980">string</span><span class="op" id="4877986">)</span>&nbsp;<span class="ident" id="4877988">ast</span><span class="op" id="4877991">.</span><span class="ident" id="4877992">Expr</span>&nbsp;<span class="op" id="4877997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878000">if</span>&nbsp;<span class="ident" id="4878003">s</span>&nbsp;<span class="op" id="4878005">==</span>&nbsp;<span class="builtintype" id="4878008">nil</span>&nbsp;<span class="op" id="4878012">{</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878016">return</span>&nbsp;<span class="builtintype" id="4878023">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878031">if</span>&nbsp;<span class="ident" id="4878034">es</span><span class="op" id="4878036">,</span>&nbsp;<span class="ident" id="4878038">isExpr</span>&nbsp;<span class="op" id="4878045">:=</span>&nbsp;<span class="ident" id="4878048">s</span><span class="op" id="4878049">.</span><span class="op" id="4878050">(</span><span class="op" id="4878051">*</span><span class="ident" id="4878052">ast</span><span class="op" id="4878055">.</span><span class="ident" id="4878056">ExprStmt</span><span class="op" id="4878064">)</span><span class="op" id="4878065">;</span>&nbsp;<span class="ident" id="4878067">isExpr</span>&nbsp;<span class="op" id="4878074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878078">return</span>&nbsp;<span class="ident" id="4878085">p</span><span class="op" id="4878086">.</span><span class="ident" id="4878087">checkExpr</span><span class="op" id="4878096">(</span><span class="ident" id="4878097">es</span><span class="op" id="4878099">.</span><span class="ident" id="4878100">X</span><span class="op" id="4878101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878104">}</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878107">p</span><span class="op" id="4878108">.</span><span class="builtintype" id="4878109">error</span><span class="op" id="4878114">(</span><span class="ident" id="4878115">s</span><span class="op" id="4878116">.</span><span class="ident" id="4878117">Pos</span><span class="op" id="4878120">(</span><span class="op" id="4878121">)</span><span class="op" id="4878122">,</span>&nbsp;<span class="ident" id="4878124">fmt</span><span class="op" id="4878127">.</span><span class="ident" id="4878128">Sprintf</span><span class="op" id="4878135">(</span><span class="string" id="4878136">&#34;expected&nbsp;%s,&nbsp;found&nbsp;simple&nbsp;statement&nbsp;(missing&nbsp;parentheses&nbsp;around&nbsp;composite&nbsp;literal?)&#34;</span><span class="op" id="4878221">,</span>&nbsp;<span class="ident" id="4878223">kind</span><span class="op" id="4878227">)</span><span class="op" id="4878228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878231">return</span>&nbsp;<span class="op" id="4878238">&amp;</span><span class="ident" id="4878239">ast</span><span class="op" id="4878242">.</span><span class="ident" id="4878243">BadExpr</span><span class="op" id="4878250">{</span><span class="ident" id="4878251">From</span><span class="op" id="4878255">:</span>&nbsp;<span class="ident" id="4878257">s</span><span class="op" id="4878258">.</span><span class="ident" id="4878259">Pos</span><span class="op" id="4878262">(</span><span class="op" id="4878263">)</span><span class="op" id="4878264">,</span>&nbsp;<span class="ident" id="4878266">To</span><span class="op" id="4878268">:</span>&nbsp;<span class="ident" id="4878270">p</span><span class="op" id="4878271">.</span><span class="ident" id="4878272">safePos</span><span class="op" id="4878279">(</span><span class="ident" id="4878280">s</span><span class="op" id="4878281">.</span><span class="ident" id="4878282">End</span><span class="op" id="4878285">(</span><span class="op" id="4878286">)</span><span class="op" id="4878287">)</span><span class="op" id="4878288">}</span><br>
<span class="lineno"></span><span class="op" id="4878290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4878293">func</span>&nbsp;<span class="op" id="4878298">(</span><span class="ident" id="4878299">p</span>&nbsp;<span class="op" id="4878301">*</span><span class="ident" id="4878302">parser</span><span class="op" id="4878308">)</span>&nbsp;<span class="ident" id="4878310">parseIfStmt</span><span class="op" id="4878321">(</span><span class="op" id="4878322">)</span>&nbsp;<span class="op" id="4878324">*</span><span class="ident" id="4878325">ast</span><span class="op" id="4878328">.</span><span class="ident" id="4878329">IfStmt</span>&nbsp;<span class="op" id="4878336">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878339">if</span>&nbsp;<span class="ident" id="4878342">p</span><span class="op" id="4878343">.</span><span class="ident" id="4878344">trace</span>&nbsp;<span class="op" id="4878350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878354">defer</span>&nbsp;<span class="ident" id="4878360">un</span><span class="op" id="4878362">(</span><span class="ident" id="4878363">trace</span><span class="op" id="4878368">(</span><span class="ident" id="4878369">p</span><span class="op" id="4878370">,</span>&nbsp;<span class="string" id="4878372">&#34;IfStmt&#34;</span><span class="op" id="4878380">)</span><span class="op" id="4878381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878388">pos</span>&nbsp;<span class="op" id="4878392">:=</span>&nbsp;<span class="ident" id="4878395">p</span><span class="op" id="4878396">.</span><span class="ident" id="4878397">expect</span><span class="op" id="4878403">(</span><span class="ident" id="4878404">token</span><span class="op" id="4878409">.</span><span class="ident" id="4878410">IF</span><span class="op" id="4878412">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878415">p</span><span class="op" id="4878416">.</span><span class="ident" id="4878417">openScope</span><span class="op" id="4878426">(</span><span class="op" id="4878427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878430">defer</span>&nbsp;<span class="ident" id="4878436">p</span><span class="op" id="4878437">.</span><span class="ident" id="4878438">closeScope</span><span class="op" id="4878448">(</span><span class="op" id="4878449">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878453">var</span>&nbsp;<span class="ident" id="4878457">s</span>&nbsp;<span class="ident" id="4878459">ast</span><span class="op" id="4878462">.</span><span class="ident" id="4878463">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878469">var</span>&nbsp;<span class="ident" id="4878473">x</span>&nbsp;<span class="ident" id="4878475">ast</span><span class="op" id="4878478">.</span><span class="ident" id="4878479">Expr</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878489">prevLev</span>&nbsp;<span class="op" id="4878497">:=</span>&nbsp;<span class="ident" id="4878500">p</span><span class="op" id="4878501">.</span><span class="ident" id="4878502">exprLev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878512">p</span><span class="op" id="4878513">.</span><span class="ident" id="4878514">exprLev</span>&nbsp;<span class="op" id="4878522">=</span>&nbsp;<span class="op" id="4878524">-</span><span class="num" id="4878525">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878529">if</span>&nbsp;<span class="ident" id="4878532">p</span><span class="op" id="4878533">.</span><span class="ident" id="4878534">tok</span>&nbsp;<span class="op" id="4878538">==</span>&nbsp;<span class="ident" id="4878541">token</span><span class="op" id="4878546">.</span><span class="ident" id="4878547">SEMICOLON</span>&nbsp;<span class="op" id="4878557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878562">p</span><span class="op" id="4878563">.</span><span class="ident" id="4878564">next</span><span class="op" id="4878568">(</span><span class="op" id="4878569">)</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878574">x</span>&nbsp;<span class="op" id="4878576">=</span>&nbsp;<span class="ident" id="4878578">p</span><span class="op" id="4878579">.</span><span class="ident" id="4878580">parseRhs</span><span class="op" id="4878588">(</span><span class="op" id="4878589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878593">}</span>&nbsp;<span class="keyword" id="4878595">else</span>&nbsp;<span class="op" id="4878600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878605">s</span><span class="op" id="4878606">,</span>&nbsp;<span class="ident" id="4878608">_</span>&nbsp;<span class="op" id="4878610">=</span>&nbsp;<span class="ident" id="4878612">p</span><span class="op" id="4878613">.</span><span class="ident" id="4878614">parseSimpleStmt</span><span class="op" id="4878629">(</span><span class="ident" id="4878630">basic</span><span class="op" id="4878635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878640">if</span>&nbsp;<span class="ident" id="4878643">p</span><span class="op" id="4878644">.</span><span class="ident" id="4878645">tok</span>&nbsp;<span class="op" id="4878649">==</span>&nbsp;<span class="ident" id="4878652">token</span><span class="op" id="4878657">.</span><span class="ident" id="4878658">SEMICOLON</span>&nbsp;<span class="op" id="4878668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878674">p</span><span class="op" id="4878675">.</span><span class="ident" id="4878676">next</span><span class="op" id="4878680">(</span><span class="op" id="4878681">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878687">x</span>&nbsp;<span class="op" id="4878689">=</span>&nbsp;<span class="ident" id="4878691">p</span><span class="op" id="4878692">.</span><span class="ident" id="4878693">parseRhs</span><span class="op" id="4878701">(</span><span class="op" id="4878702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878707">}</span>&nbsp;<span class="keyword" id="4878709">else</span>&nbsp;<span class="op" id="4878714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878720">x</span>&nbsp;<span class="op" id="4878722">=</span>&nbsp;<span class="ident" id="4878724">p</span><span class="op" id="4878725">.</span><span class="ident" id="4878726">makeExpr</span><span class="op" id="4878734">(</span><span class="ident" id="4878735">s</span><span class="op" id="4878736">,</span>&nbsp;<span class="string" id="4878738">&#34;boolean&nbsp;expression&#34;</span><span class="op" id="4878758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878764">s</span>&nbsp;<span class="op" id="4878766">=</span>&nbsp;<span class="builtintype" id="4878768">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878775">}</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878783">p</span><span class="op" id="4878784">.</span><span class="ident" id="4878785">exprLev</span>&nbsp;<span class="op" id="4878793">=</span>&nbsp;<span class="ident" id="4878795">prevLev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878808">body</span>&nbsp;<span class="op" id="4878813">:=</span>&nbsp;<span class="ident" id="4878816">p</span><span class="op" id="4878817">.</span><span class="ident" id="4878818">parseBlockStmt</span><span class="op" id="4878832">(</span><span class="op" id="4878833">)</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878836">var</span>&nbsp;<span class="ident" id="4878840">else_</span>&nbsp;<span class="ident" id="4878846">ast</span><span class="op" id="4878849">.</span><span class="ident" id="4878850">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878856">if</span>&nbsp;<span class="ident" id="4878859">p</span><span class="op" id="4878860">.</span><span class="ident" id="4878861">tok</span>&nbsp;<span class="op" id="4878865">==</span>&nbsp;<span class="ident" id="4878868">token</span><span class="op" id="4878873">.</span><span class="ident" id="4878874">ELSE</span>&nbsp;<span class="op" id="4878879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878883">p</span><span class="op" id="4878884">.</span><span class="ident" id="4878885">next</span><span class="op" id="4878889">(</span><span class="op" id="4878890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878894">else_</span>&nbsp;<span class="op" id="4878900">=</span>&nbsp;<span class="ident" id="4878902">p</span><span class="op" id="4878903">.</span><span class="ident" id="4878904">parseStmt</span><span class="op" id="4878913">(</span><span class="op" id="4878914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878917">}</span>&nbsp;<span class="keyword" id="4878919">else</span>&nbsp;<span class="op" id="4878924">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4878928">p</span><span class="op" id="4878929">.</span><span class="ident" id="4878930">expectSemi</span><span class="op" id="4878940">(</span><span class="op" id="4878941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4878944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4878948">return</span>&nbsp;<span class="op" id="4878955">&amp;</span><span class="ident" id="4878956">ast</span><span class="op" id="4878959">.</span><span class="ident" id="4878960">IfStmt</span><span class="op" id="4878966">{</span><span class="ident" id="4878967">If</span><span class="op" id="4878969">:</span>&nbsp;<span class="ident" id="4878971">pos</span><span class="op" id="4878974">,</span>&nbsp;<span class="ident" id="4878976">Init</span><span class="op" id="4878980">:</span>&nbsp;<span class="ident" id="4878982">s</span><span class="op" id="4878983">,</span>&nbsp;<span class="ident" id="4878985">Cond</span><span class="op" id="4878989">:</span>&nbsp;<span class="ident" id="4878991">x</span><span class="op" id="4878992">,</span>&nbsp;<span class="ident" id="4878994">Body</span><span class="op" id="4878998">:</span>&nbsp;<span class="ident" id="4879000">body</span><span class="op" id="4879004">,</span>&nbsp;<span class="ident" id="4879006">Else</span><span class="op" id="4879010">:</span>&nbsp;<span class="ident" id="4879012">else_</span><span class="op" id="4879017">}</span><br>
<span class="lineno"></span><span class="op" id="4879019">}</span><br>
<span class="lineno">1840</span><br>
<span class="lineno"></span><span class="keyword" id="4879022">func</span>&nbsp;<span class="op" id="4879027">(</span><span class="ident" id="4879028">p</span>&nbsp;<span class="op" id="4879030">*</span><span class="ident" id="4879031">parser</span><span class="op" id="4879037">)</span>&nbsp;<span class="ident" id="4879039">parseTypeList</span><span class="op" id="4879052">(</span><span class="op" id="4879053">)</span>&nbsp;<span class="op" id="4879055">(</span><span class="ident" id="4879056">list</span>&nbsp;<span class="op" id="4879061">[</span><span class="op" id="4879062">]</span><span class="ident" id="4879063">ast</span><span class="op" id="4879066">.</span><span class="ident" id="4879067">Expr</span><span class="op" id="4879071">)</span>&nbsp;<span class="op" id="4879073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879076">if</span>&nbsp;<span class="ident" id="4879079">p</span><span class="op" id="4879080">.</span><span class="ident" id="4879081">trace</span>&nbsp;<span class="op" id="4879087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879091">defer</span>&nbsp;<span class="ident" id="4879097">un</span><span class="op" id="4879099">(</span><span class="ident" id="4879100">trace</span><span class="op" id="4879105">(</span><span class="ident" id="4879106">p</span><span class="op" id="4879107">,</span>&nbsp;<span class="string" id="4879109">&#34;TypeList&#34;</span><span class="op" id="4879119">)</span><span class="op" id="4879120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879123">}</span><br>
<span class="lineno">1845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879127">list</span>&nbsp;<span class="op" id="4879132">=</span>&nbsp;<span class="builtinfunc" id="4879134">append</span><span class="op" id="4879140">(</span><span class="ident" id="4879141">list</span><span class="op" id="4879145">,</span>&nbsp;<span class="ident" id="4879147">p</span><span class="op" id="4879148">.</span><span class="ident" id="4879149">parseType</span><span class="op" id="4879158">(</span><span class="op" id="4879159">)</span><span class="op" id="4879160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879163">for</span>&nbsp;<span class="ident" id="4879167">p</span><span class="op" id="4879168">.</span><span class="ident" id="4879169">tok</span>&nbsp;<span class="op" id="4879173">==</span>&nbsp;<span class="ident" id="4879176">token</span><span class="op" id="4879181">.</span><span class="ident" id="4879182">COMMA</span>&nbsp;<span class="op" id="4879188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879192">p</span><span class="op" id="4879193">.</span><span class="ident" id="4879194">next</span><span class="op" id="4879198">(</span><span class="op" id="4879199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879203">list</span>&nbsp;<span class="op" id="4879208">=</span>&nbsp;<span class="builtinfunc" id="4879210">append</span><span class="op" id="4879216">(</span><span class="ident" id="4879217">list</span><span class="op" id="4879221">,</span>&nbsp;<span class="ident" id="4879223">p</span><span class="op" id="4879224">.</span><span class="ident" id="4879225">parseType</span><span class="op" id="4879234">(</span><span class="op" id="4879235">)</span><span class="op" id="4879236">)</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879243">return</span><br>
<span class="lineno"></span><span class="op" id="4879250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1855</span><span class="keyword" id="4879253">func</span>&nbsp;<span class="op" id="4879258">(</span><span class="ident" id="4879259">p</span>&nbsp;<span class="op" id="4879261">*</span><span class="ident" id="4879262">parser</span><span class="op" id="4879268">)</span>&nbsp;<span class="ident" id="4879270">parseCaseClause</span><span class="op" id="4879285">(</span><span class="ident" id="4879286">typeSwitch</span>&nbsp;<span class="builtintype" id="4879297">bool</span><span class="op" id="4879301">)</span>&nbsp;<span class="op" id="4879303">*</span><span class="ident" id="4879304">ast</span><span class="op" id="4879307">.</span><span class="ident" id="4879308">CaseClause</span>&nbsp;<span class="op" id="4879319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879322">if</span>&nbsp;<span class="ident" id="4879325">p</span><span class="op" id="4879326">.</span><span class="ident" id="4879327">trace</span>&nbsp;<span class="op" id="4879333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879337">defer</span>&nbsp;<span class="ident" id="4879343">un</span><span class="op" id="4879345">(</span><span class="ident" id="4879346">trace</span><span class="op" id="4879351">(</span><span class="ident" id="4879352">p</span><span class="op" id="4879353">,</span>&nbsp;<span class="string" id="4879355">&#34;CaseClause&#34;</span><span class="op" id="4879367">)</span><span class="op" id="4879368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879375">pos</span>&nbsp;<span class="op" id="4879379">:=</span>&nbsp;<span class="ident" id="4879382">p</span><span class="op" id="4879383">.</span><span class="ident" id="4879384">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879389">var</span>&nbsp;<span class="ident" id="4879393">list</span>&nbsp;<span class="op" id="4879398">[</span><span class="op" id="4879399">]</span><span class="ident" id="4879400">ast</span><span class="op" id="4879403">.</span><span class="ident" id="4879404">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879410">if</span>&nbsp;<span class="ident" id="4879413">p</span><span class="op" id="4879414">.</span><span class="ident" id="4879415">tok</span>&nbsp;<span class="op" id="4879419">==</span>&nbsp;<span class="ident" id="4879422">token</span><span class="op" id="4879427">.</span><span class="ident" id="4879428">CASE</span>&nbsp;<span class="op" id="4879433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879437">p</span><span class="op" id="4879438">.</span><span class="ident" id="4879439">next</span><span class="op" id="4879443">(</span><span class="op" id="4879444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879448">if</span>&nbsp;<span class="ident" id="4879451">typeSwitch</span>&nbsp;<span class="op" id="4879462">{</span><br>
<span class="lineno">1865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879467">list</span>&nbsp;<span class="op" id="4879472">=</span>&nbsp;<span class="ident" id="4879474">p</span><span class="op" id="4879475">.</span><span class="ident" id="4879476">parseTypeList</span><span class="op" id="4879489">(</span><span class="op" id="4879490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879494">}</span>&nbsp;<span class="keyword" id="4879496">else</span>&nbsp;<span class="op" id="4879501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879506">list</span>&nbsp;<span class="op" id="4879511">=</span>&nbsp;<span class="ident" id="4879513">p</span><span class="op" id="4879514">.</span><span class="ident" id="4879515">parseRhsList</span><span class="op" id="4879527">(</span><span class="op" id="4879528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879535">}</span>&nbsp;<span class="keyword" id="4879537">else</span>&nbsp;<span class="op" id="4879542">{</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879546">p</span><span class="op" id="4879547">.</span><span class="ident" id="4879548">expect</span><span class="op" id="4879554">(</span><span class="ident" id="4879555">token</span><span class="op" id="4879560">.</span><span class="ident" id="4879561">DEFAULT</span><span class="op" id="4879568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4879571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879575">colon</span>&nbsp;<span class="op" id="4879581">:=</span>&nbsp;<span class="ident" id="4879584">p</span><span class="op" id="4879585">.</span><span class="ident" id="4879586">expect</span><span class="op" id="4879592">(</span><span class="ident" id="4879593">token</span><span class="op" id="4879598">.</span><span class="ident" id="4879599">COLON</span><span class="op" id="4879604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879607">p</span><span class="op" id="4879608">.</span><span class="ident" id="4879609">openScope</span><span class="op" id="4879618">(</span><span class="op" id="4879619">)</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879622">body</span>&nbsp;<span class="op" id="4879627">:=</span>&nbsp;<span class="ident" id="4879630">p</span><span class="op" id="4879631">.</span><span class="ident" id="4879632">parseStmtList</span><span class="op" id="4879645">(</span><span class="op" id="4879646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879649">p</span><span class="op" id="4879650">.</span><span class="ident" id="4879651">closeScope</span><span class="op" id="4879661">(</span><span class="op" id="4879662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879666">return</span>&nbsp;<span class="op" id="4879673">&amp;</span><span class="ident" id="4879674">ast</span><span class="op" id="4879677">.</span><span class="ident" id="4879678">CaseClause</span><span class="op" id="4879688">{</span><span class="ident" id="4879689">Case</span><span class="op" id="4879693">:</span>&nbsp;<span class="ident" id="4879695">pos</span><span class="op" id="4879698">,</span>&nbsp;<span class="ident" id="4879700">List</span><span class="op" id="4879704">:</span>&nbsp;<span class="ident" id="4879706">list</span><span class="op" id="4879710">,</span>&nbsp;<span class="ident" id="4879712">Colon</span><span class="op" id="4879717">:</span>&nbsp;<span class="ident" id="4879719">colon</span><span class="op" id="4879724">,</span>&nbsp;<span class="ident" id="4879726">Body</span><span class="op" id="4879730">:</span>&nbsp;<span class="ident" id="4879732">body</span><span class="op" id="4879736">}</span><br>
<span class="lineno"></span><span class="op" id="4879738">}</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span><span class="keyword" id="4879741">func</span>&nbsp;<span class="ident" id="4879746">isTypeSwitchAssert</span><span class="op" id="4879764">(</span><span class="ident" id="4879765">x</span>&nbsp;<span class="ident" id="4879767">ast</span><span class="op" id="4879770">.</span><span class="ident" id="4879771">Expr</span><span class="op" id="4879775">)</span>&nbsp;<span class="builtintype" id="4879777">bool</span>&nbsp;<span class="op" id="4879782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4879785">a</span><span class="op" id="4879786">,</span>&nbsp;<span class="ident" id="4879788">ok</span>&nbsp;<span class="op" id="4879791">:=</span>&nbsp;<span class="ident" id="4879794">x</span><span class="op" id="4879795">.</span><span class="op" id="4879796">(</span><span class="op" id="4879797">*</span><span class="ident" id="4879798">ast</span><span class="op" id="4879801">.</span><span class="ident" id="4879802">TypeAssertExpr</span><span class="op" id="4879816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879819">return</span>&nbsp;<span class="ident" id="4879826">ok</span>&nbsp;<span class="op" id="4879829">&amp;&amp;</span>&nbsp;<span class="ident" id="4879832">a</span><span class="op" id="4879833">.</span><span class="ident" id="4879834">Type</span>&nbsp;<span class="op" id="4879839">==</span>&nbsp;<span class="builtintype" id="4879842">nil</span><br>
<span class="lineno"></span><span class="op" id="4879846">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span><span class="keyword" id="4879849">func</span>&nbsp;<span class="ident" id="4879854">isTypeSwitchGuard</span><span class="op" id="4879871">(</span><span class="ident" id="4879872">s</span>&nbsp;<span class="ident" id="4879874">ast</span><span class="op" id="4879877">.</span><span class="ident" id="4879878">Stmt</span><span class="op" id="4879882">)</span>&nbsp;<span class="builtintype" id="4879884">bool</span>&nbsp;<span class="op" id="4879889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879892">switch</span>&nbsp;<span class="ident" id="4879899">t</span>&nbsp;<span class="op" id="4879901">:=</span>&nbsp;<span class="ident" id="4879904">s</span><span class="op" id="4879905">.</span><span class="op" id="4879906">(</span><span class="keyword" id="4879907">type</span><span class="op" id="4879911">)</span>&nbsp;<span class="op" id="4879913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879916">case</span>&nbsp;<span class="op" id="4879921">*</span><span class="ident" id="4879922">ast</span><span class="op" id="4879925">.</span><span class="ident" id="4879926">ExprStmt</span><span class="op" id="4879934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4879938">//&nbsp;x.(nil)</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879951">return</span>&nbsp;<span class="ident" id="4879958">isTypeSwitchAssert</span><span class="op" id="4879976">(</span><span class="ident" id="4879977">t</span><span class="op" id="4879978">.</span><span class="ident" id="4879979">X</span><span class="op" id="4879980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4879983">case</span>&nbsp;<span class="op" id="4879988">*</span><span class="ident" id="4879989">ast</span><span class="op" id="4879992">.</span><span class="ident" id="4879993">AssignStmt</span><span class="op" id="4880003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880007">//&nbsp;v&nbsp;:=&nbsp;x.(nil)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880025">return</span>&nbsp;<span class="builtinfunc" id="4880032">len</span><span class="op" id="4880035">(</span><span class="ident" id="4880036">t</span><span class="op" id="4880037">.</span><span class="ident" id="4880038">Lhs</span><span class="op" id="4880041">)</span>&nbsp;<span class="op" id="4880043">==</span>&nbsp;<span class="num" id="4880046">1</span>&nbsp;<span class="op" id="4880048">&amp;&amp;</span>&nbsp;<span class="ident" id="4880051">t</span><span class="op" id="4880052">.</span><span class="ident" id="4880053">Tok</span>&nbsp;<span class="op" id="4880057">==</span>&nbsp;<span class="ident" id="4880060">token</span><span class="op" id="4880065">.</span><span class="ident" id="4880066">DEFINE</span>&nbsp;<span class="op" id="4880073">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4880076">len</span><span class="op" id="4880079">(</span><span class="ident" id="4880080">t</span><span class="op" id="4880081">.</span><span class="ident" id="4880082">Rhs</span><span class="op" id="4880085">)</span>&nbsp;<span class="op" id="4880087">==</span>&nbsp;<span class="num" id="4880090">1</span>&nbsp;<span class="op" id="4880092">&amp;&amp;</span>&nbsp;<span class="ident" id="4880095">isTypeSwitchAssert</span><span class="op" id="4880113">(</span><span class="ident" id="4880114">t</span><span class="op" id="4880115">.</span><span class="ident" id="4880116">Rhs</span><span class="op" id="4880119">[</span><span class="num" id="4880120">0</span><span class="op" id="4880121">]</span><span class="op" id="4880122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4880125">}</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880128">return</span>&nbsp;<span class="builtintype" id="4880135">false</span><br>
<span class="lineno"></span><span class="op" id="4880141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4880144">func</span>&nbsp;<span class="op" id="4880149">(</span><span class="ident" id="4880150">p</span>&nbsp;<span class="op" id="4880152">*</span><span class="ident" id="4880153">parser</span><span class="op" id="4880159">)</span>&nbsp;<span class="ident" id="4880161">parseSwitchStmt</span><span class="op" id="4880176">(</span><span class="op" id="4880177">)</span>&nbsp;<span class="ident" id="4880179">ast</span><span class="op" id="4880182">.</span><span class="ident" id="4880183">Stmt</span>&nbsp;<span class="op" id="4880188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880191">if</span>&nbsp;<span class="ident" id="4880194">p</span><span class="op" id="4880195">.</span><span class="ident" id="4880196">trace</span>&nbsp;<span class="op" id="4880202">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880206">defer</span>&nbsp;<span class="ident" id="4880212">un</span><span class="op" id="4880214">(</span><span class="ident" id="4880215">trace</span><span class="op" id="4880220">(</span><span class="ident" id="4880221">p</span><span class="op" id="4880222">,</span>&nbsp;<span class="string" id="4880224">&#34;SwitchStmt&#34;</span><span class="op" id="4880236">)</span><span class="op" id="4880237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4880240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880244">pos</span>&nbsp;<span class="op" id="4880248">:=</span>&nbsp;<span class="ident" id="4880251">p</span><span class="op" id="4880252">.</span><span class="ident" id="4880253">expect</span><span class="op" id="4880259">(</span><span class="ident" id="4880260">token</span><span class="op" id="4880265">.</span><span class="ident" id="4880266">SWITCH</span><span class="op" id="4880272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880275">p</span><span class="op" id="4880276">.</span><span class="ident" id="4880277">openScope</span><span class="op" id="4880286">(</span><span class="op" id="4880287">)</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880290">defer</span>&nbsp;<span class="ident" id="4880296">p</span><span class="op" id="4880297">.</span><span class="ident" id="4880298">closeScope</span><span class="op" id="4880308">(</span><span class="op" id="4880309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880313">var</span>&nbsp;<span class="ident" id="4880317">s1</span><span class="op" id="4880319">,</span>&nbsp;<span class="ident" id="4880321">s2</span>&nbsp;<span class="ident" id="4880324">ast</span><span class="op" id="4880327">.</span><span class="ident" id="4880328">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880334">if</span>&nbsp;<span class="ident" id="4880337">p</span><span class="op" id="4880338">.</span><span class="ident" id="4880339">tok</span>&nbsp;<span class="op" id="4880343">!=</span>&nbsp;<span class="ident" id="4880346">token</span><span class="op" id="4880351">.</span><span class="ident" id="4880352">LBRACE</span>&nbsp;<span class="op" id="4880359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880363">prevLev</span>&nbsp;<span class="op" id="4880371">:=</span>&nbsp;<span class="ident" id="4880374">p</span><span class="op" id="4880375">.</span><span class="ident" id="4880376">exprLev</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880386">p</span><span class="op" id="4880387">.</span><span class="ident" id="4880388">exprLev</span>&nbsp;<span class="op" id="4880396">=</span>&nbsp;<span class="op" id="4880398">-</span><span class="num" id="4880399">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880403">if</span>&nbsp;<span class="ident" id="4880406">p</span><span class="op" id="4880407">.</span><span class="ident" id="4880408">tok</span>&nbsp;<span class="op" id="4880412">!=</span>&nbsp;<span class="ident" id="4880415">token</span><span class="op" id="4880420">.</span><span class="ident" id="4880421">SEMICOLON</span>&nbsp;<span class="op" id="4880431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880436">s2</span><span class="op" id="4880438">,</span>&nbsp;<span class="ident" id="4880440">_</span>&nbsp;<span class="op" id="4880442">=</span>&nbsp;<span class="ident" id="4880444">p</span><span class="op" id="4880445">.</span><span class="ident" id="4880446">parseSimpleStmt</span><span class="op" id="4880461">(</span><span class="ident" id="4880462">basic</span><span class="op" id="4880467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4880471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880475">if</span>&nbsp;<span class="ident" id="4880478">p</span><span class="op" id="4880479">.</span><span class="ident" id="4880480">tok</span>&nbsp;<span class="op" id="4880484">==</span>&nbsp;<span class="ident" id="4880487">token</span><span class="op" id="4880492">.</span><span class="ident" id="4880493">SEMICOLON</span>&nbsp;<span class="op" id="4880503">{</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880508">p</span><span class="op" id="4880509">.</span><span class="ident" id="4880510">next</span><span class="op" id="4880514">(</span><span class="op" id="4880515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880520">s1</span>&nbsp;<span class="op" id="4880523">=</span>&nbsp;<span class="ident" id="4880525">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4880531">s2</span>&nbsp;<span class="op" id="4880534">=</span>&nbsp;<span class="builtintype" id="4880536">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4880543">if</span>&nbsp;<span class="ident" id="4880546">p</span><span class="op" id="4880547">.</span><span class="ident" id="4880548">tok</span>&nbsp;<span class="op" id="4880552">!=</span>&nbsp;<span class="ident" id="4880555">token</span><span class="op" id="4880560">.</span><span class="ident" id="4880561">LBRACE</span>&nbsp;<span class="op" id="4880568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880574">//&nbsp;A&nbsp;TypeSwitchGuard&nbsp;may&nbsp;declare&nbsp;a&nbsp;variable&nbsp;in&nbsp;addition</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880634">//&nbsp;to&nbsp;the&nbsp;variable&nbsp;declared&nbsp;in&nbsp;the&nbsp;initial&nbsp;SimpleStmt.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880693">//&nbsp;Introduce&nbsp;extra&nbsp;scope&nbsp;to&nbsp;avoid&nbsp;redeclaration&nbsp;errors:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880753">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880760">//&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;t&nbsp;:=&nbsp;0;&nbsp;t&nbsp;:=&nbsp;x.(T)&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880801">//</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880808">//&nbsp;(this&nbsp;code&nbsp;is&nbsp;not&nbsp;valid&nbsp;Go&nbsp;because&nbsp;the&nbsp;first&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880862">//&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;and&nbsp;thus&nbsp;is&nbsp;never&nbsp;used,&nbsp;the&nbsp;extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880922">//&nbsp;scope&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;correct&nbsp;error&nbsp;message).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880977">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4880984">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;a&nbsp;type&nbsp;switch,&nbsp;s2&nbsp;must&nbsp;be&nbsp;an&nbsp;expression.</span><br>
<span class="lineno">1930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4881049">//&nbsp;Having&nbsp;the&nbsp;extra&nbsp;nested&nbsp;but&nbsp;empty&nbsp;scope&nbsp;won&#39;t&nbsp;affect&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881113">p</span><span class="op" id="4881114">.</span><span class="ident" id="4881115">openScope</span><span class="op" id="4881124">(</span><span class="op" id="4881125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881131">defer</span>&nbsp;<span class="ident" id="4881137">p</span><span class="op" id="4881138">.</span><span class="ident" id="4881139">closeScope</span><span class="op" id="4881149">(</span><span class="op" id="4881150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881156">s2</span><span class="op" id="4881158">,</span>&nbsp;<span class="ident" id="4881160">_</span>&nbsp;<span class="op" id="4881162">=</span>&nbsp;<span class="ident" id="4881164">p</span><span class="op" id="4881165">.</span><span class="ident" id="4881166">parseSimpleStmt</span><span class="op" id="4881181">(</span><span class="ident" id="4881182">basic</span><span class="op" id="4881187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881192">}</span><br>
<span class="lineno">1935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881200">p</span><span class="op" id="4881201">.</span><span class="ident" id="4881202">exprLev</span>&nbsp;<span class="op" id="4881210">=</span>&nbsp;<span class="ident" id="4881212">prevLev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881225">typeSwitch</span>&nbsp;<span class="op" id="4881236">:=</span>&nbsp;<span class="ident" id="4881239">isTypeSwitchGuard</span><span class="op" id="4881256">(</span><span class="ident" id="4881257">s2</span><span class="op" id="4881259">)</span><br>
<span class="lineno">1940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881262">lbrace</span>&nbsp;<span class="op" id="4881269">:=</span>&nbsp;<span class="ident" id="4881272">p</span><span class="op" id="4881273">.</span><span class="ident" id="4881274">expect</span><span class="op" id="4881280">(</span><span class="ident" id="4881281">token</span><span class="op" id="4881286">.</span><span class="ident" id="4881287">LBRACE</span><span class="op" id="4881293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881296">var</span>&nbsp;<span class="ident" id="4881300">list</span>&nbsp;<span class="op" id="4881305">[</span><span class="op" id="4881306">]</span><span class="ident" id="4881307">ast</span><span class="op" id="4881310">.</span><span class="ident" id="4881311">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881317">for</span>&nbsp;<span class="ident" id="4881321">p</span><span class="op" id="4881322">.</span><span class="ident" id="4881323">tok</span>&nbsp;<span class="op" id="4881327">==</span>&nbsp;<span class="ident" id="4881330">token</span><span class="op" id="4881335">.</span><span class="ident" id="4881336">CASE</span>&nbsp;<span class="op" id="4881341">||</span>&nbsp;<span class="ident" id="4881344">p</span><span class="op" id="4881345">.</span><span class="ident" id="4881346">tok</span>&nbsp;<span class="op" id="4881350">==</span>&nbsp;<span class="ident" id="4881353">token</span><span class="op" id="4881358">.</span><span class="ident" id="4881359">DEFAULT</span>&nbsp;<span class="op" id="4881367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881371">list</span>&nbsp;<span class="op" id="4881376">=</span>&nbsp;<span class="builtinfunc" id="4881378">append</span><span class="op" id="4881384">(</span><span class="ident" id="4881385">list</span><span class="op" id="4881389">,</span>&nbsp;<span class="ident" id="4881391">p</span><span class="op" id="4881392">.</span><span class="ident" id="4881393">parseCaseClause</span><span class="op" id="4881408">(</span><span class="ident" id="4881409">typeSwitch</span><span class="op" id="4881419">)</span><span class="op" id="4881420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881423">}</span><br>
<span class="lineno">1945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881426">rbrace</span>&nbsp;<span class="op" id="4881433">:=</span>&nbsp;<span class="ident" id="4881436">p</span><span class="op" id="4881437">.</span><span class="ident" id="4881438">expect</span><span class="op" id="4881444">(</span><span class="ident" id="4881445">token</span><span class="op" id="4881450">.</span><span class="ident" id="4881451">RBRACE</span><span class="op" id="4881457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881460">p</span><span class="op" id="4881461">.</span><span class="ident" id="4881462">expectSemi</span><span class="op" id="4881472">(</span><span class="op" id="4881473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881476">body</span>&nbsp;<span class="op" id="4881481">:=</span>&nbsp;<span class="op" id="4881484">&amp;</span><span class="ident" id="4881485">ast</span><span class="op" id="4881488">.</span><span class="ident" id="4881489">BlockStmt</span><span class="op" id="4881498">{</span><span class="ident" id="4881499">Lbrace</span><span class="op" id="4881505">:</span>&nbsp;<span class="ident" id="4881507">lbrace</span><span class="op" id="4881513">,</span>&nbsp;<span class="ident" id="4881515">List</span><span class="op" id="4881519">:</span>&nbsp;<span class="ident" id="4881521">list</span><span class="op" id="4881525">,</span>&nbsp;<span class="ident" id="4881527">Rbrace</span><span class="op" id="4881533">:</span>&nbsp;<span class="ident" id="4881535">rbrace</span><span class="op" id="4881541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881545">if</span>&nbsp;<span class="ident" id="4881548">typeSwitch</span>&nbsp;<span class="op" id="4881559">{</span><br>
<span class="lineno">1950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881563">return</span>&nbsp;<span class="op" id="4881570">&amp;</span><span class="ident" id="4881571">ast</span><span class="op" id="4881574">.</span><span class="ident" id="4881575">TypeSwitchStmt</span><span class="op" id="4881589">{</span><span class="ident" id="4881590">Switch</span><span class="op" id="4881596">:</span>&nbsp;<span class="ident" id="4881598">pos</span><span class="op" id="4881601">,</span>&nbsp;<span class="ident" id="4881603">Init</span><span class="op" id="4881607">:</span>&nbsp;<span class="ident" id="4881609">s1</span><span class="op" id="4881611">,</span>&nbsp;<span class="ident" id="4881613">Assign</span><span class="op" id="4881619">:</span>&nbsp;<span class="ident" id="4881621">s2</span><span class="op" id="4881623">,</span>&nbsp;<span class="ident" id="4881625">Body</span><span class="op" id="4881629">:</span>&nbsp;<span class="ident" id="4881631">body</span><span class="op" id="4881635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881642">return</span>&nbsp;<span class="op" id="4881649">&amp;</span><span class="ident" id="4881650">ast</span><span class="op" id="4881653">.</span><span class="ident" id="4881654">SwitchStmt</span><span class="op" id="4881664">{</span><span class="ident" id="4881665">Switch</span><span class="op" id="4881671">:</span>&nbsp;<span class="ident" id="4881673">pos</span><span class="op" id="4881676">,</span>&nbsp;<span class="ident" id="4881678">Init</span><span class="op" id="4881682">:</span>&nbsp;<span class="ident" id="4881684">s1</span><span class="op" id="4881686">,</span>&nbsp;<span class="ident" id="4881688">Tag</span><span class="op" id="4881691">:</span>&nbsp;<span class="ident" id="4881693">p</span><span class="op" id="4881694">.</span><span class="ident" id="4881695">makeExpr</span><span class="op" id="4881703">(</span><span class="ident" id="4881704">s2</span><span class="op" id="4881706">,</span>&nbsp;<span class="string" id="4881708">&#34;switch&nbsp;expression&#34;</span><span class="op" id="4881727">)</span><span class="op" id="4881728">,</span>&nbsp;<span class="ident" id="4881730">Body</span><span class="op" id="4881734">:</span>&nbsp;<span class="ident" id="4881736">body</span><span class="op" id="4881740">}</span><br>
<span class="lineno"></span><span class="op" id="4881742">}</span><br>
<span class="lineno">1955</span><br>
<span class="lineno"></span><span class="keyword" id="4881745">func</span>&nbsp;<span class="op" id="4881750">(</span><span class="ident" id="4881751">p</span>&nbsp;<span class="op" id="4881753">*</span><span class="ident" id="4881754">parser</span><span class="op" id="4881760">)</span>&nbsp;<span class="ident" id="4881762">parseCommClause</span><span class="op" id="4881777">(</span><span class="op" id="4881778">)</span>&nbsp;<span class="op" id="4881780">*</span><span class="ident" id="4881781">ast</span><span class="op" id="4881784">.</span><span class="ident" id="4881785">CommClause</span>&nbsp;<span class="op" id="4881796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881799">if</span>&nbsp;<span class="ident" id="4881802">p</span><span class="op" id="4881803">.</span><span class="ident" id="4881804">trace</span>&nbsp;<span class="op" id="4881810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881814">defer</span>&nbsp;<span class="ident" id="4881820">un</span><span class="op" id="4881822">(</span><span class="ident" id="4881823">trace</span><span class="op" id="4881828">(</span><span class="ident" id="4881829">p</span><span class="op" id="4881830">,</span>&nbsp;<span class="string" id="4881832">&#34;CommClause&#34;</span><span class="op" id="4881844">)</span><span class="op" id="4881845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4881848">}</span><br>
<span class="lineno">1960</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881852">p</span><span class="op" id="4881853">.</span><span class="ident" id="4881854">openScope</span><span class="op" id="4881863">(</span><span class="op" id="4881864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881867">pos</span>&nbsp;<span class="op" id="4881871">:=</span>&nbsp;<span class="ident" id="4881874">p</span><span class="op" id="4881875">.</span><span class="ident" id="4881876">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881881">var</span>&nbsp;<span class="ident" id="4881885">comm</span>&nbsp;<span class="ident" id="4881890">ast</span><span class="op" id="4881893">.</span><span class="ident" id="4881894">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881900">if</span>&nbsp;<span class="ident" id="4881903">p</span><span class="op" id="4881904">.</span><span class="ident" id="4881905">tok</span>&nbsp;<span class="op" id="4881909">==</span>&nbsp;<span class="ident" id="4881912">token</span><span class="op" id="4881917">.</span><span class="ident" id="4881918">CASE</span>&nbsp;<span class="op" id="4881923">{</span><br>
<span class="lineno">1965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881927">p</span><span class="op" id="4881928">.</span><span class="ident" id="4881929">next</span><span class="op" id="4881933">(</span><span class="op" id="4881934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4881938">lhs</span>&nbsp;<span class="op" id="4881942">:=</span>&nbsp;<span class="ident" id="4881945">p</span><span class="op" id="4881946">.</span><span class="ident" id="4881947">parseLhsList</span><span class="op" id="4881959">(</span><span class="op" id="4881960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4881964">if</span>&nbsp;<span class="ident" id="4881967">p</span><span class="op" id="4881968">.</span><span class="ident" id="4881969">tok</span>&nbsp;<span class="op" id="4881973">==</span>&nbsp;<span class="ident" id="4881976">token</span><span class="op" id="4881981">.</span><span class="ident" id="4881982">ARROW</span>&nbsp;<span class="op" id="4881988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4881993">//&nbsp;SendStmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4882008">if</span>&nbsp;<span class="builtinfunc" id="4882011">len</span><span class="op" id="4882014">(</span><span class="ident" id="4882015">lhs</span><span class="op" id="4882018">)</span>&nbsp;<span class="op" id="4882020">&gt;</span>&nbsp;<span class="num" id="4882022">1</span>&nbsp;<span class="op" id="4882024">{</span><br>
<span class="lineno">1970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882030">p</span><span class="op" id="4882031">.</span><span class="ident" id="4882032">errorExpected</span><span class="op" id="4882045">(</span><span class="ident" id="4882046">lhs</span><span class="op" id="4882049">[</span><span class="num" id="4882050">0</span><span class="op" id="4882051">]</span><span class="op" id="4882052">.</span><span class="ident" id="4882053">Pos</span><span class="op" id="4882056">(</span><span class="op" id="4882057">)</span><span class="op" id="4882058">,</span>&nbsp;<span class="string" id="4882060">&#34;1&nbsp;expression&#34;</span><span class="op" id="4882074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882080">//&nbsp;continue&nbsp;with&nbsp;first&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882122">arrow</span>&nbsp;<span class="op" id="4882128">:=</span>&nbsp;<span class="ident" id="4882131">p</span><span class="op" id="4882132">.</span><span class="ident" id="4882133">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882140">p</span><span class="op" id="4882141">.</span><span class="ident" id="4882142">next</span><span class="op" id="4882146">(</span><span class="op" id="4882147">)</span><br>
<span class="lineno">1975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882152">rhs</span>&nbsp;<span class="op" id="4882156">:=</span>&nbsp;<span class="ident" id="4882159">p</span><span class="op" id="4882160">.</span><span class="ident" id="4882161">parseRhs</span><span class="op" id="4882169">(</span><span class="op" id="4882170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882175">comm</span>&nbsp;<span class="op" id="4882180">=</span>&nbsp;<span class="op" id="4882182">&amp;</span><span class="ident" id="4882183">ast</span><span class="op" id="4882186">.</span><span class="ident" id="4882187">SendStmt</span><span class="op" id="4882195">{</span><span class="ident" id="4882196">Chan</span><span class="op" id="4882200">:</span>&nbsp;<span class="ident" id="4882202">lhs</span><span class="op" id="4882205">[</span><span class="num" id="4882206">0</span><span class="op" id="4882207">]</span><span class="op" id="4882208">,</span>&nbsp;<span class="ident" id="4882210">Arrow</span><span class="op" id="4882215">:</span>&nbsp;<span class="ident" id="4882217">arrow</span><span class="op" id="4882222">,</span>&nbsp;<span class="ident" id="4882224">Value</span><span class="op" id="4882229">:</span>&nbsp;<span class="ident" id="4882231">rhs</span><span class="op" id="4882234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882238">}</span>&nbsp;<span class="keyword" id="4882240">else</span>&nbsp;<span class="op" id="4882245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882250">//&nbsp;RecvStmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4882265">if</span>&nbsp;<span class="ident" id="4882268">tok</span>&nbsp;<span class="op" id="4882272">:=</span>&nbsp;<span class="ident" id="4882275">p</span><span class="op" id="4882276">.</span><span class="ident" id="4882277">tok</span><span class="op" id="4882280">;</span>&nbsp;<span class="ident" id="4882282">tok</span>&nbsp;<span class="op" id="4882286">==</span>&nbsp;<span class="ident" id="4882289">token</span><span class="op" id="4882294">.</span><span class="ident" id="4882295">ASSIGN</span>&nbsp;<span class="op" id="4882302">||</span>&nbsp;<span class="ident" id="4882305">tok</span>&nbsp;<span class="op" id="4882309">==</span>&nbsp;<span class="ident" id="4882312">token</span><span class="op" id="4882317">.</span><span class="ident" id="4882318">DEFINE</span>&nbsp;<span class="op" id="4882325">{</span><br>
<span class="lineno">1980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882331">//&nbsp;RecvStmt&nbsp;with&nbsp;assignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4882363">if</span>&nbsp;<span class="builtinfunc" id="4882366">len</span><span class="op" id="4882369">(</span><span class="ident" id="4882370">lhs</span><span class="op" id="4882373">)</span>&nbsp;<span class="op" id="4882375">&gt;</span>&nbsp;<span class="num" id="4882377">2</span>&nbsp;<span class="op" id="4882379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882386">p</span><span class="op" id="4882387">.</span><span class="ident" id="4882388">errorExpected</span><span class="op" id="4882401">(</span><span class="ident" id="4882402">lhs</span><span class="op" id="4882405">[</span><span class="num" id="4882406">0</span><span class="op" id="4882407">]</span><span class="op" id="4882408">.</span><span class="ident" id="4882409">Pos</span><span class="op" id="4882412">(</span><span class="op" id="4882413">)</span><span class="op" id="4882414">,</span>&nbsp;<span class="string" id="4882416">&#34;1&nbsp;or&nbsp;2&nbsp;expressions&#34;</span><span class="op" id="4882436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882443">//&nbsp;continue&nbsp;with&nbsp;first&nbsp;two&nbsp;expressions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882487">lhs</span>&nbsp;<span class="op" id="4882491">=</span>&nbsp;<span class="ident" id="4882493">lhs</span><span class="op" id="4882496">[</span><span class="num" id="4882497">0</span><span class="op" id="4882498">:</span><span class="num" id="4882499">2</span><span class="op" id="4882500">]</span><br>
<span class="lineno">1985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882512">pos</span>&nbsp;<span class="op" id="4882516">:=</span>&nbsp;<span class="ident" id="4882519">p</span><span class="op" id="4882520">.</span><span class="ident" id="4882521">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882529">p</span><span class="op" id="4882530">.</span><span class="ident" id="4882531">next</span><span class="op" id="4882535">(</span><span class="op" id="4882536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882542">rhs</span>&nbsp;<span class="op" id="4882546">:=</span>&nbsp;<span class="ident" id="4882549">p</span><span class="op" id="4882550">.</span><span class="ident" id="4882551">parseRhs</span><span class="op" id="4882559">(</span><span class="op" id="4882560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882566">as</span>&nbsp;<span class="op" id="4882569">:=</span>&nbsp;<span class="op" id="4882572">&amp;</span><span class="ident" id="4882573">ast</span><span class="op" id="4882576">.</span><span class="ident" id="4882577">AssignStmt</span><span class="op" id="4882587">{</span><span class="ident" id="4882588">Lhs</span><span class="op" id="4882591">:</span>&nbsp;<span class="ident" id="4882593">lhs</span><span class="op" id="4882596">,</span>&nbsp;<span class="ident" id="4882598">TokPos</span><span class="op" id="4882604">:</span>&nbsp;<span class="ident" id="4882606">pos</span><span class="op" id="4882609">,</span>&nbsp;<span class="ident" id="4882611">Tok</span><span class="op" id="4882614">:</span>&nbsp;<span class="ident" id="4882616">tok</span><span class="op" id="4882619">,</span>&nbsp;<span class="ident" id="4882621">Rhs</span><span class="op" id="4882624">:</span>&nbsp;<span class="op" id="4882626">[</span><span class="op" id="4882627">]</span><span class="ident" id="4882628">ast</span><span class="op" id="4882631">.</span><span class="ident" id="4882632">Expr</span><span class="op" id="4882636">{</span><span class="ident" id="4882637">rhs</span><span class="op" id="4882640">}</span><span class="op" id="4882641">}</span><br>
<span class="lineno">1990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4882647">if</span>&nbsp;<span class="ident" id="4882650">tok</span>&nbsp;<span class="op" id="4882654">==</span>&nbsp;<span class="ident" id="4882657">token</span><span class="op" id="4882662">.</span><span class="ident" id="4882663">DEFINE</span>&nbsp;<span class="op" id="4882670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882677">p</span><span class="op" id="4882678">.</span><span class="ident" id="4882679">shortVarDecl</span><span class="op" id="4882691">(</span><span class="ident" id="4882692">as</span><span class="op" id="4882694">,</span>&nbsp;<span class="ident" id="4882696">lhs</span><span class="op" id="4882699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882711">comm</span>&nbsp;<span class="op" id="4882716">=</span>&nbsp;<span class="ident" id="4882718">as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882724">}</span>&nbsp;<span class="keyword" id="4882726">else</span>&nbsp;<span class="op" id="4882731">{</span><br>
<span class="lineno">1995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882737">//&nbsp;lhs&nbsp;must&nbsp;be&nbsp;single&nbsp;receive&nbsp;operation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4882781">if</span>&nbsp;<span class="builtinfunc" id="4882784">len</span><span class="op" id="4882787">(</span><span class="ident" id="4882788">lhs</span><span class="op" id="4882791">)</span>&nbsp;<span class="op" id="4882793">&gt;</span>&nbsp;<span class="num" id="4882795">1</span>&nbsp;<span class="op" id="4882797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882804">p</span><span class="op" id="4882805">.</span><span class="ident" id="4882806">errorExpected</span><span class="op" id="4882819">(</span><span class="ident" id="4882820">lhs</span><span class="op" id="4882823">[</span><span class="num" id="4882824">0</span><span class="op" id="4882825">]</span><span class="op" id="4882826">.</span><span class="ident" id="4882827">Pos</span><span class="op" id="4882830">(</span><span class="op" id="4882831">)</span><span class="op" id="4882832">,</span>&nbsp;<span class="string" id="4882834">&#34;1&nbsp;expression&#34;</span><span class="op" id="4882848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4882855">//&nbsp;continue&nbsp;with&nbsp;first&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882893">}</span><br>
<span class="lineno">2000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882899">comm</span>&nbsp;<span class="op" id="4882904">=</span>&nbsp;<span class="op" id="4882906">&amp;</span><span class="ident" id="4882907">ast</span><span class="op" id="4882910">.</span><span class="ident" id="4882911">ExprStmt</span><span class="op" id="4882919">{</span><span class="ident" id="4882920">X</span><span class="op" id="4882921">:</span>&nbsp;<span class="ident" id="4882923">lhs</span><span class="op" id="4882926">[</span><span class="num" id="4882927">0</span><span class="op" id="4882928">]</span><span class="op" id="4882929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882941">}</span>&nbsp;<span class="keyword" id="4882943">else</span>&nbsp;<span class="op" id="4882948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882952">p</span><span class="op" id="4882953">.</span><span class="ident" id="4882954">expect</span><span class="op" id="4882960">(</span><span class="ident" id="4882961">token</span><span class="op" id="4882966">.</span><span class="ident" id="4882967">DEFAULT</span><span class="op" id="4882974">)</span><br>
<span class="lineno">2005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4882977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4882981">colon</span>&nbsp;<span class="op" id="4882987">:=</span>&nbsp;<span class="ident" id="4882990">p</span><span class="op" id="4882991">.</span><span class="ident" id="4882992">expect</span><span class="op" id="4882998">(</span><span class="ident" id="4882999">token</span><span class="op" id="4883004">.</span><span class="ident" id="4883005">COLON</span><span class="op" id="4883010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883013">body</span>&nbsp;<span class="op" id="4883018">:=</span>&nbsp;<span class="ident" id="4883021">p</span><span class="op" id="4883022">.</span><span class="ident" id="4883023">parseStmtList</span><span class="op" id="4883036">(</span><span class="op" id="4883037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883040">p</span><span class="op" id="4883041">.</span><span class="ident" id="4883042">closeScope</span><span class="op" id="4883052">(</span><span class="op" id="4883053">)</span><br>
<span class="lineno">2010</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883057">return</span>&nbsp;<span class="op" id="4883064">&amp;</span><span class="ident" id="4883065">ast</span><span class="op" id="4883068">.</span><span class="ident" id="4883069">CommClause</span><span class="op" id="4883079">{</span><span class="ident" id="4883080">Case</span><span class="op" id="4883084">:</span>&nbsp;<span class="ident" id="4883086">pos</span><span class="op" id="4883089">,</span>&nbsp;<span class="ident" id="4883091">Comm</span><span class="op" id="4883095">:</span>&nbsp;<span class="ident" id="4883097">comm</span><span class="op" id="4883101">,</span>&nbsp;<span class="ident" id="4883103">Colon</span><span class="op" id="4883108">:</span>&nbsp;<span class="ident" id="4883110">colon</span><span class="op" id="4883115">,</span>&nbsp;<span class="ident" id="4883117">Body</span><span class="op" id="4883121">:</span>&nbsp;<span class="ident" id="4883123">body</span><span class="op" id="4883127">}</span><br>
<span class="lineno"></span><span class="op" id="4883129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4883132">func</span>&nbsp;<span class="op" id="4883137">(</span><span class="ident" id="4883138">p</span>&nbsp;<span class="op" id="4883140">*</span><span class="ident" id="4883141">parser</span><span class="op" id="4883147">)</span>&nbsp;<span class="ident" id="4883149">parseSelectStmt</span><span class="op" id="4883164">(</span><span class="op" id="4883165">)</span>&nbsp;<span class="op" id="4883167">*</span><span class="ident" id="4883168">ast</span><span class="op" id="4883171">.</span><span class="ident" id="4883172">SelectStmt</span>&nbsp;<span class="op" id="4883183">{</span><br>
<span class="lineno">2015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883186">if</span>&nbsp;<span class="ident" id="4883189">p</span><span class="op" id="4883190">.</span><span class="ident" id="4883191">trace</span>&nbsp;<span class="op" id="4883197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883201">defer</span>&nbsp;<span class="ident" id="4883207">un</span><span class="op" id="4883209">(</span><span class="ident" id="4883210">trace</span><span class="op" id="4883215">(</span><span class="ident" id="4883216">p</span><span class="op" id="4883217">,</span>&nbsp;<span class="string" id="4883219">&#34;SelectStmt&#34;</span><span class="op" id="4883231">)</span><span class="op" id="4883232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4883235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883239">pos</span>&nbsp;<span class="op" id="4883243">:=</span>&nbsp;<span class="ident" id="4883246">p</span><span class="op" id="4883247">.</span><span class="ident" id="4883248">expect</span><span class="op" id="4883254">(</span><span class="ident" id="4883255">token</span><span class="op" id="4883260">.</span><span class="ident" id="4883261">SELECT</span><span class="op" id="4883267">)</span><br>
<span class="lineno">2020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883270">lbrace</span>&nbsp;<span class="op" id="4883277">:=</span>&nbsp;<span class="ident" id="4883280">p</span><span class="op" id="4883281">.</span><span class="ident" id="4883282">expect</span><span class="op" id="4883288">(</span><span class="ident" id="4883289">token</span><span class="op" id="4883294">.</span><span class="ident" id="4883295">LBRACE</span><span class="op" id="4883301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883304">var</span>&nbsp;<span class="ident" id="4883308">list</span>&nbsp;<span class="op" id="4883313">[</span><span class="op" id="4883314">]</span><span class="ident" id="4883315">ast</span><span class="op" id="4883318">.</span><span class="ident" id="4883319">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883325">for</span>&nbsp;<span class="ident" id="4883329">p</span><span class="op" id="4883330">.</span><span class="ident" id="4883331">tok</span>&nbsp;<span class="op" id="4883335">==</span>&nbsp;<span class="ident" id="4883338">token</span><span class="op" id="4883343">.</span><span class="ident" id="4883344">CASE</span>&nbsp;<span class="op" id="4883349">||</span>&nbsp;<span class="ident" id="4883352">p</span><span class="op" id="4883353">.</span><span class="ident" id="4883354">tok</span>&nbsp;<span class="op" id="4883358">==</span>&nbsp;<span class="ident" id="4883361">token</span><span class="op" id="4883366">.</span><span class="ident" id="4883367">DEFAULT</span>&nbsp;<span class="op" id="4883375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883379">list</span>&nbsp;<span class="op" id="4883384">=</span>&nbsp;<span class="builtinfunc" id="4883386">append</span><span class="op" id="4883392">(</span><span class="ident" id="4883393">list</span><span class="op" id="4883397">,</span>&nbsp;<span class="ident" id="4883399">p</span><span class="op" id="4883400">.</span><span class="ident" id="4883401">parseCommClause</span><span class="op" id="4883416">(</span><span class="op" id="4883417">)</span><span class="op" id="4883418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4883421">}</span><br>
<span class="lineno">2025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883424">rbrace</span>&nbsp;<span class="op" id="4883431">:=</span>&nbsp;<span class="ident" id="4883434">p</span><span class="op" id="4883435">.</span><span class="ident" id="4883436">expect</span><span class="op" id="4883442">(</span><span class="ident" id="4883443">token</span><span class="op" id="4883448">.</span><span class="ident" id="4883449">RBRACE</span><span class="op" id="4883455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883458">p</span><span class="op" id="4883459">.</span><span class="ident" id="4883460">expectSemi</span><span class="op" id="4883470">(</span><span class="op" id="4883471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883474">body</span>&nbsp;<span class="op" id="4883479">:=</span>&nbsp;<span class="op" id="4883482">&amp;</span><span class="ident" id="4883483">ast</span><span class="op" id="4883486">.</span><span class="ident" id="4883487">BlockStmt</span><span class="op" id="4883496">{</span><span class="ident" id="4883497">Lbrace</span><span class="op" id="4883503">:</span>&nbsp;<span class="ident" id="4883505">lbrace</span><span class="op" id="4883511">,</span>&nbsp;<span class="ident" id="4883513">List</span><span class="op" id="4883517">:</span>&nbsp;<span class="ident" id="4883519">list</span><span class="op" id="4883523">,</span>&nbsp;<span class="ident" id="4883525">Rbrace</span><span class="op" id="4883531">:</span>&nbsp;<span class="ident" id="4883533">rbrace</span><span class="op" id="4883539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883543">return</span>&nbsp;<span class="op" id="4883550">&amp;</span><span class="ident" id="4883551">ast</span><span class="op" id="4883554">.</span><span class="ident" id="4883555">SelectStmt</span><span class="op" id="4883565">{</span><span class="ident" id="4883566">Select</span><span class="op" id="4883572">:</span>&nbsp;<span class="ident" id="4883574">pos</span><span class="op" id="4883577">,</span>&nbsp;<span class="ident" id="4883579">Body</span><span class="op" id="4883583">:</span>&nbsp;<span class="ident" id="4883585">body</span><span class="op" id="4883589">}</span><br>
<span class="lineno">2030</span><span class="op" id="4883591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4883594">func</span>&nbsp;<span class="op" id="4883599">(</span><span class="ident" id="4883600">p</span>&nbsp;<span class="op" id="4883602">*</span><span class="ident" id="4883603">parser</span><span class="op" id="4883609">)</span>&nbsp;<span class="ident" id="4883611">parseForStmt</span><span class="op" id="4883623">(</span><span class="op" id="4883624">)</span>&nbsp;<span class="ident" id="4883626">ast</span><span class="op" id="4883629">.</span><span class="ident" id="4883630">Stmt</span>&nbsp;<span class="op" id="4883635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883638">if</span>&nbsp;<span class="ident" id="4883641">p</span><span class="op" id="4883642">.</span><span class="ident" id="4883643">trace</span>&nbsp;<span class="op" id="4883649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883653">defer</span>&nbsp;<span class="ident" id="4883659">un</span><span class="op" id="4883661">(</span><span class="ident" id="4883662">trace</span><span class="op" id="4883667">(</span><span class="ident" id="4883668">p</span><span class="op" id="4883669">,</span>&nbsp;<span class="string" id="4883671">&#34;ForStmt&#34;</span><span class="op" id="4883680">)</span><span class="op" id="4883681">)</span><br>
<span class="lineno">2035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4883684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883688">pos</span>&nbsp;<span class="op" id="4883692">:=</span>&nbsp;<span class="ident" id="4883695">p</span><span class="op" id="4883696">.</span><span class="ident" id="4883697">expect</span><span class="op" id="4883703">(</span><span class="ident" id="4883704">token</span><span class="op" id="4883709">.</span><span class="ident" id="4883710">FOR</span><span class="op" id="4883713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883716">p</span><span class="op" id="4883717">.</span><span class="ident" id="4883718">openScope</span><span class="op" id="4883727">(</span><span class="op" id="4883728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883731">defer</span>&nbsp;<span class="ident" id="4883737">p</span><span class="op" id="4883738">.</span><span class="ident" id="4883739">closeScope</span><span class="op" id="4883749">(</span><span class="op" id="4883750">)</span><br>
<span class="lineno">2040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883754">var</span>&nbsp;<span class="ident" id="4883758">s1</span><span class="op" id="4883760">,</span>&nbsp;<span class="ident" id="4883762">s2</span><span class="op" id="4883764">,</span>&nbsp;<span class="ident" id="4883766">s3</span>&nbsp;<span class="ident" id="4883769">ast</span><span class="op" id="4883772">.</span><span class="ident" id="4883773">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883779">var</span>&nbsp;<span class="ident" id="4883783">isRange</span>&nbsp;<span class="builtintype" id="4883791">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883797">if</span>&nbsp;<span class="ident" id="4883800">p</span><span class="op" id="4883801">.</span><span class="ident" id="4883802">tok</span>&nbsp;<span class="op" id="4883806">!=</span>&nbsp;<span class="ident" id="4883809">token</span><span class="op" id="4883814">.</span><span class="ident" id="4883815">LBRACE</span>&nbsp;<span class="op" id="4883822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883826">prevLev</span>&nbsp;<span class="op" id="4883834">:=</span>&nbsp;<span class="ident" id="4883837">p</span><span class="op" id="4883838">.</span><span class="ident" id="4883839">exprLev</span><br>
<span class="lineno">2045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883849">p</span><span class="op" id="4883850">.</span><span class="ident" id="4883851">exprLev</span>&nbsp;<span class="op" id="4883859">=</span>&nbsp;<span class="op" id="4883861">-</span><span class="num" id="4883862">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883866">if</span>&nbsp;<span class="ident" id="4883869">p</span><span class="op" id="4883870">.</span><span class="ident" id="4883871">tok</span>&nbsp;<span class="op" id="4883875">!=</span>&nbsp;<span class="ident" id="4883878">token</span><span class="op" id="4883883">.</span><span class="ident" id="4883884">SEMICOLON</span>&nbsp;<span class="op" id="4883894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4883899">if</span>&nbsp;<span class="ident" id="4883902">p</span><span class="op" id="4883903">.</span><span class="ident" id="4883904">tok</span>&nbsp;<span class="op" id="4883908">==</span>&nbsp;<span class="ident" id="4883911">token</span><span class="op" id="4883916">.</span><span class="ident" id="4883917">RANGE</span>&nbsp;<span class="op" id="4883923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4883929">//&nbsp;&#34;for&nbsp;range&nbsp;x&#34;&nbsp;(nil&nbsp;lhs&nbsp;in&nbsp;assignment)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883974">pos</span>&nbsp;<span class="op" id="4883978">:=</span>&nbsp;<span class="ident" id="4883981">p</span><span class="op" id="4883982">.</span><span class="ident" id="4883983">pos</span><br>
<span class="lineno">2050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4883991">p</span><span class="op" id="4883992">.</span><span class="ident" id="4883993">next</span><span class="op" id="4883997">(</span><span class="op" id="4883998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884004">y</span>&nbsp;<span class="op" id="4884006">:=</span>&nbsp;<span class="op" id="4884009">[</span><span class="op" id="4884010">]</span><span class="ident" id="4884011">ast</span><span class="op" id="4884014">.</span><span class="ident" id="4884015">Expr</span><span class="op" id="4884019">{</span><span class="op" id="4884020">&amp;</span><span class="ident" id="4884021">ast</span><span class="op" id="4884024">.</span><span class="ident" id="4884025">UnaryExpr</span><span class="op" id="4884034">{</span><span class="ident" id="4884035">OpPos</span><span class="op" id="4884040">:</span>&nbsp;<span class="ident" id="4884042">pos</span><span class="op" id="4884045">,</span>&nbsp;<span class="ident" id="4884047">Op</span><span class="op" id="4884049">:</span>&nbsp;<span class="ident" id="4884051">token</span><span class="op" id="4884056">.</span><span class="ident" id="4884057">RANGE</span><span class="op" id="4884062">,</span>&nbsp;<span class="ident" id="4884064">X</span><span class="op" id="4884065">:</span>&nbsp;<span class="ident" id="4884067">p</span><span class="op" id="4884068">.</span><span class="ident" id="4884069">parseRhs</span><span class="op" id="4884077">(</span><span class="op" id="4884078">)</span><span class="op" id="4884079">}</span><span class="op" id="4884080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884086">s2</span>&nbsp;<span class="op" id="4884089">=</span>&nbsp;<span class="op" id="4884091">&amp;</span><span class="ident" id="4884092">ast</span><span class="op" id="4884095">.</span><span class="ident" id="4884096">AssignStmt</span><span class="op" id="4884106">{</span><span class="ident" id="4884107">Rhs</span><span class="op" id="4884110">:</span>&nbsp;<span class="ident" id="4884112">y</span><span class="op" id="4884113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884119">isRange</span>&nbsp;<span class="op" id="4884127">=</span>&nbsp;<span class="builtintype" id="4884129">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884137">}</span>&nbsp;<span class="keyword" id="4884139">else</span>&nbsp;<span class="op" id="4884144">{</span><br>
<span class="lineno">2055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884150">s2</span><span class="op" id="4884152">,</span>&nbsp;<span class="ident" id="4884154">isRange</span>&nbsp;<span class="op" id="4884162">=</span>&nbsp;<span class="ident" id="4884164">p</span><span class="op" id="4884165">.</span><span class="ident" id="4884166">parseSimpleStmt</span><span class="op" id="4884181">(</span><span class="ident" id="4884182">rangeOk</span><span class="op" id="4884189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884202">if</span>&nbsp;<span class="op" id="4884205">!</span><span class="ident" id="4884206">isRange</span>&nbsp;<span class="op" id="4884214">&amp;&amp;</span>&nbsp;<span class="ident" id="4884217">p</span><span class="op" id="4884218">.</span><span class="ident" id="4884219">tok</span>&nbsp;<span class="op" id="4884223">==</span>&nbsp;<span class="ident" id="4884226">token</span><span class="op" id="4884231">.</span><span class="ident" id="4884232">SEMICOLON</span>&nbsp;<span class="op" id="4884242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884247">p</span><span class="op" id="4884248">.</span><span class="ident" id="4884249">next</span><span class="op" id="4884253">(</span><span class="op" id="4884254">)</span><br>
<span class="lineno">2060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884259">s1</span>&nbsp;<span class="op" id="4884262">=</span>&nbsp;<span class="ident" id="4884264">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884270">s2</span>&nbsp;<span class="op" id="4884273">=</span>&nbsp;<span class="builtintype" id="4884275">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884282">if</span>&nbsp;<span class="ident" id="4884285">p</span><span class="op" id="4884286">.</span><span class="ident" id="4884287">tok</span>&nbsp;<span class="op" id="4884291">!=</span>&nbsp;<span class="ident" id="4884294">token</span><span class="op" id="4884299">.</span><span class="ident" id="4884300">SEMICOLON</span>&nbsp;<span class="op" id="4884310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884316">s2</span><span class="op" id="4884318">,</span>&nbsp;<span class="ident" id="4884320">_</span>&nbsp;<span class="op" id="4884322">=</span>&nbsp;<span class="ident" id="4884324">p</span><span class="op" id="4884325">.</span><span class="ident" id="4884326">parseSimpleStmt</span><span class="op" id="4884341">(</span><span class="ident" id="4884342">basic</span><span class="op" id="4884347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884352">}</span><br>
<span class="lineno">2065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884357">p</span><span class="op" id="4884358">.</span><span class="ident" id="4884359">expectSemi</span><span class="op" id="4884369">(</span><span class="op" id="4884370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884375">if</span>&nbsp;<span class="ident" id="4884378">p</span><span class="op" id="4884379">.</span><span class="ident" id="4884380">tok</span>&nbsp;<span class="op" id="4884384">!=</span>&nbsp;<span class="ident" id="4884387">token</span><span class="op" id="4884392">.</span><span class="ident" id="4884393">LBRACE</span>&nbsp;<span class="op" id="4884400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884406">s3</span><span class="op" id="4884408">,</span>&nbsp;<span class="ident" id="4884410">_</span>&nbsp;<span class="op" id="4884412">=</span>&nbsp;<span class="ident" id="4884414">p</span><span class="op" id="4884415">.</span><span class="ident" id="4884416">parseSimpleStmt</span><span class="op" id="4884431">(</span><span class="ident" id="4884432">basic</span><span class="op" id="4884437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884446">}</span><br>
<span class="lineno">2070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884450">p</span><span class="op" id="4884451">.</span><span class="ident" id="4884452">exprLev</span>&nbsp;<span class="op" id="4884460">=</span>&nbsp;<span class="ident" id="4884462">prevLev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884475">body</span>&nbsp;<span class="op" id="4884480">:=</span>&nbsp;<span class="ident" id="4884483">p</span><span class="op" id="4884484">.</span><span class="ident" id="4884485">parseBlockStmt</span><span class="op" id="4884499">(</span><span class="op" id="4884500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884503">p</span><span class="op" id="4884504">.</span><span class="ident" id="4884505">expectSemi</span><span class="op" id="4884515">(</span><span class="op" id="4884516">)</span><br>
<span class="lineno">2075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884520">if</span>&nbsp;<span class="ident" id="4884523">isRange</span>&nbsp;<span class="op" id="4884531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884535">as</span>&nbsp;<span class="op" id="4884538">:=</span>&nbsp;<span class="ident" id="4884541">s2</span><span class="op" id="4884543">.</span><span class="op" id="4884544">(</span><span class="op" id="4884545">*</span><span class="ident" id="4884546">ast</span><span class="op" id="4884549">.</span><span class="ident" id="4884550">AssignStmt</span><span class="op" id="4884560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4884564">//&nbsp;check&nbsp;lhs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884579">var</span>&nbsp;<span class="ident" id="4884583">key</span><span class="op" id="4884586">,</span>&nbsp;<span class="ident" id="4884588">value</span>&nbsp;<span class="ident" id="4884594">ast</span><span class="op" id="4884597">.</span><span class="ident" id="4884598">Expr</span><br>
<span class="lineno">2080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884605">switch</span>&nbsp;<span class="builtinfunc" id="4884612">len</span><span class="op" id="4884615">(</span><span class="ident" id="4884616">as</span><span class="op" id="4884618">.</span><span class="ident" id="4884619">Lhs</span><span class="op" id="4884622">)</span>&nbsp;<span class="op" id="4884624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884628">case</span>&nbsp;<span class="num" id="4884633">0</span><span class="op" id="4884634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4884639">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884658">case</span>&nbsp;<span class="num" id="4884663">1</span><span class="op" id="4884664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884669">key</span>&nbsp;<span class="op" id="4884673">=</span>&nbsp;<span class="ident" id="4884675">as</span><span class="op" id="4884677">.</span><span class="ident" id="4884678">Lhs</span><span class="op" id="4884681">[</span><span class="num" id="4884682">0</span><span class="op" id="4884683">]</span><br>
<span class="lineno">2085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884687">case</span>&nbsp;<span class="num" id="4884692">2</span><span class="op" id="4884693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884698">key</span><span class="op" id="4884701">,</span>&nbsp;<span class="ident" id="4884703">value</span>&nbsp;<span class="op" id="4884709">=</span>&nbsp;<span class="ident" id="4884711">as</span><span class="op" id="4884713">.</span><span class="ident" id="4884714">Lhs</span><span class="op" id="4884717">[</span><span class="num" id="4884718">0</span><span class="op" id="4884719">]</span><span class="op" id="4884720">,</span>&nbsp;<span class="ident" id="4884722">as</span><span class="op" id="4884724">.</span><span class="ident" id="4884725">Lhs</span><span class="op" id="4884728">[</span><span class="num" id="4884729">1</span><span class="op" id="4884730">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884734">default</span><span class="op" id="4884741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884746">p</span><span class="op" id="4884747">.</span><span class="ident" id="4884748">errorExpected</span><span class="op" id="4884761">(</span><span class="ident" id="4884762">as</span><span class="op" id="4884764">.</span><span class="ident" id="4884765">Lhs</span><span class="op" id="4884768">[</span><span class="builtinfunc" id="4884769">len</span><span class="op" id="4884772">(</span><span class="ident" id="4884773">as</span><span class="op" id="4884775">.</span><span class="ident" id="4884776">Lhs</span><span class="op" id="4884779">)</span><span class="op" id="4884780">-</span><span class="num" id="4884781">1</span><span class="op" id="4884782">]</span><span class="op" id="4884783">.</span><span class="ident" id="4884784">Pos</span><span class="op" id="4884787">(</span><span class="op" id="4884788">)</span><span class="op" id="4884789">,</span>&nbsp;<span class="string" id="4884791">&#34;at&nbsp;most&nbsp;2&nbsp;expressions&#34;</span><span class="op" id="4884814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4884819">return</span>&nbsp;<span class="op" id="4884826">&amp;</span><span class="ident" id="4884827">ast</span><span class="op" id="4884830">.</span><span class="ident" id="4884831">BadStmt</span><span class="op" id="4884838">{</span><span class="ident" id="4884839">From</span><span class="op" id="4884843">:</span>&nbsp;<span class="ident" id="4884845">pos</span><span class="op" id="4884848">,</span>&nbsp;<span class="ident" id="4884850">To</span><span class="op" id="4884852">:</span>&nbsp;<span class="ident" id="4884854">p</span><span class="op" id="4884855">.</span><span class="ident" id="4884856">safePos</span><span class="op" id="4884863">(</span><span class="ident" id="4884864">body</span><span class="op" id="4884868">.</span><span class="ident" id="4884869">End</span><span class="op" id="4884872">(</span><span class="op" id="4884873">)</span><span class="op" id="4884874">)</span><span class="op" id="4884875">}</span><br>
<span class="lineno">2090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4884879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4884883">//&nbsp;parseSimpleStmt&nbsp;returned&nbsp;a&nbsp;right-hand&nbsp;side&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4884936">//&nbsp;is&nbsp;a&nbsp;single&nbsp;unary&nbsp;expression&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;range&nbsp;x&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4884992">x</span>&nbsp;<span class="op" id="4884994">:=</span>&nbsp;<span class="ident" id="4884997">as</span><span class="op" id="4884999">.</span><span class="ident" id="4885000">Rhs</span><span class="op" id="4885003">[</span><span class="num" id="4885004">0</span><span class="op" id="4885005">]</span><span class="op" id="4885006">.</span><span class="op" id="4885007">(</span><span class="op" id="4885008">*</span><span class="ident" id="4885009">ast</span><span class="op" id="4885012">.</span><span class="ident" id="4885013">UnaryExpr</span><span class="op" id="4885022">)</span><span class="op" id="4885023">.</span><span class="ident" id="4885024">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885028">return</span>&nbsp;<span class="op" id="4885035">&amp;</span><span class="ident" id="4885036">ast</span><span class="op" id="4885039">.</span><span class="ident" id="4885040">RangeStmt</span><span class="op" id="4885049">{</span><br>
<span class="lineno">2095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885054">For</span><span class="op" id="4885057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885062">pos</span><span class="op" id="4885065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885070">Key</span><span class="op" id="4885073">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885078">key</span><span class="op" id="4885081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885086">Value</span><span class="op" id="4885091">:</span>&nbsp;&nbsp;<span class="ident" id="4885094">value</span><span class="op" id="4885099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885104">TokPos</span><span class="op" id="4885110">:</span>&nbsp;<span class="ident" id="4885112">as</span><span class="op" id="4885114">.</span><span class="ident" id="4885115">TokPos</span><span class="op" id="4885121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885126">Tok</span><span class="op" id="4885129">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885134">as</span><span class="op" id="4885136">.</span><span class="ident" id="4885137">Tok</span><span class="op" id="4885140">,</span><br>
<span class="lineno">2100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885145">X</span><span class="op" id="4885146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885153">x</span><span class="op" id="4885154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885159">Body</span><span class="op" id="4885163">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4885167">body</span><span class="op" id="4885171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4885182">//&nbsp;regular&nbsp;for&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885208">return</span>&nbsp;<span class="op" id="4885215">&amp;</span><span class="ident" id="4885216">ast</span><span class="op" id="4885219">.</span><span class="ident" id="4885220">ForStmt</span><span class="op" id="4885227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885231">For</span><span class="op" id="4885234">:</span>&nbsp;&nbsp;<span class="ident" id="4885237">pos</span><span class="op" id="4885240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885244">Init</span><span class="op" id="4885248">:</span>&nbsp;<span class="ident" id="4885250">s1</span><span class="op" id="4885252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885256">Cond</span><span class="op" id="4885260">:</span>&nbsp;<span class="ident" id="4885262">p</span><span class="op" id="4885263">.</span><span class="ident" id="4885264">makeExpr</span><span class="op" id="4885272">(</span><span class="ident" id="4885273">s2</span><span class="op" id="4885275">,</span>&nbsp;<span class="string" id="4885277">&#34;boolean&nbsp;or&nbsp;range&nbsp;expression&#34;</span><span class="op" id="4885306">)</span><span class="op" id="4885307">,</span><br>
<span class="lineno">2110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885311">Post</span><span class="op" id="4885315">:</span>&nbsp;<span class="ident" id="4885317">s3</span><span class="op" id="4885319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885323">Body</span><span class="op" id="4885327">:</span>&nbsp;<span class="ident" id="4885329">body</span><span class="op" id="4885333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885336">}</span><br>
<span class="lineno"></span><span class="op" id="4885338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2115</span><span class="keyword" id="4885341">func</span>&nbsp;<span class="op" id="4885346">(</span><span class="ident" id="4885347">p</span>&nbsp;<span class="op" id="4885349">*</span><span class="ident" id="4885350">parser</span><span class="op" id="4885356">)</span>&nbsp;<span class="ident" id="4885358">parseStmt</span><span class="op" id="4885367">(</span><span class="op" id="4885368">)</span>&nbsp;<span class="op" id="4885370">(</span><span class="ident" id="4885371">s</span>&nbsp;<span class="ident" id="4885373">ast</span><span class="op" id="4885376">.</span><span class="ident" id="4885377">Stmt</span><span class="op" id="4885381">)</span>&nbsp;<span class="op" id="4885383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885386">if</span>&nbsp;<span class="ident" id="4885389">p</span><span class="op" id="4885390">.</span><span class="ident" id="4885391">trace</span>&nbsp;<span class="op" id="4885397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885401">defer</span>&nbsp;<span class="ident" id="4885407">un</span><span class="op" id="4885409">(</span><span class="ident" id="4885410">trace</span><span class="op" id="4885415">(</span><span class="ident" id="4885416">p</span><span class="op" id="4885417">,</span>&nbsp;<span class="string" id="4885419">&#34;Statement&#34;</span><span class="op" id="4885430">)</span><span class="op" id="4885431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885438">switch</span>&nbsp;<span class="ident" id="4885445">p</span><span class="op" id="4885446">.</span><span class="ident" id="4885447">tok</span>&nbsp;<span class="op" id="4885451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885454">case</span>&nbsp;<span class="ident" id="4885459">token</span><span class="op" id="4885464">.</span><span class="ident" id="4885465">CONST</span><span class="op" id="4885470">,</span>&nbsp;<span class="ident" id="4885472">token</span><span class="op" id="4885477">.</span><span class="ident" id="4885478">TYPE</span><span class="op" id="4885482">,</span>&nbsp;<span class="ident" id="4885484">token</span><span class="op" id="4885489">.</span><span class="ident" id="4885490">VAR</span><span class="op" id="4885493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885497">s</span>&nbsp;<span class="op" id="4885499">=</span>&nbsp;<span class="op" id="4885501">&amp;</span><span class="ident" id="4885502">ast</span><span class="op" id="4885505">.</span><span class="ident" id="4885506">DeclStmt</span><span class="op" id="4885514">{</span><span class="ident" id="4885515">Decl</span><span class="op" id="4885519">:</span>&nbsp;<span class="ident" id="4885521">p</span><span class="op" id="4885522">.</span><span class="ident" id="4885523">parseDecl</span><span class="op" id="4885532">(</span><span class="ident" id="4885533">syncStmt</span><span class="op" id="4885541">)</span><span class="op" id="4885542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4885545">case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4885552">//&nbsp;tokens&nbsp;that&nbsp;may&nbsp;start&nbsp;an&nbsp;expression</span><br>
<span class="lineno">2125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885593">token</span><span class="op" id="4885598">.</span><span class="ident" id="4885599">IDENT</span><span class="op" id="4885604">,</span>&nbsp;<span class="ident" id="4885606">token</span><span class="op" id="4885611">.</span><span class="ident" id="4885612">INT</span><span class="op" id="4885615">,</span>&nbsp;<span class="ident" id="4885617">token</span><span class="op" id="4885622">.</span><span class="ident" id="4885623">FLOAT</span><span class="op" id="4885628">,</span>&nbsp;<span class="ident" id="4885630">token</span><span class="op" id="4885635">.</span><span class="ident" id="4885636">IMAG</span><span class="op" id="4885640">,</span>&nbsp;<span class="ident" id="4885642">token</span><span class="op" id="4885647">.</span><span class="ident" id="4885648">CHAR</span><span class="op" id="4885652">,</span>&nbsp;<span class="ident" id="4885654">token</span><span class="op" id="4885659">.</span><span class="ident" id="4885660">STRING</span><span class="op" id="4885666">,</span>&nbsp;<span class="ident" id="4885668">token</span><span class="op" id="4885673">.</span><span class="ident" id="4885674">FUNC</span><span class="op" id="4885678">,</span>&nbsp;<span class="ident" id="4885680">token</span><span class="op" id="4885685">.</span><span class="ident" id="4885686">LPAREN</span><span class="op" id="4885692">,</span>&nbsp;<span class="comment" id="4885694">//&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885708">token</span><span class="op" id="4885713">.</span><span class="ident" id="4885714">LBRACK</span><span class="op" id="4885720">,</span>&nbsp;<span class="ident" id="4885722">token</span><span class="op" id="4885727">.</span><span class="ident" id="4885728">STRUCT</span><span class="op" id="4885734">,</span>&nbsp;<span class="comment" id="4885736">//&nbsp;composite&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885757">token</span><span class="op" id="4885762">.</span><span class="ident" id="4885763">ADD</span><span class="op" id="4885766">,</span>&nbsp;<span class="ident" id="4885768">token</span><span class="op" id="4885773">.</span><span class="ident" id="4885774">SUB</span><span class="op" id="4885777">,</span>&nbsp;<span class="ident" id="4885779">token</span><span class="op" id="4885784">.</span><span class="ident" id="4885785">MUL</span><span class="op" id="4885788">,</span>&nbsp;<span class="ident" id="4885790">token</span><span class="op" id="4885795">.</span><span class="ident" id="4885796">AND</span><span class="op" id="4885799">,</span>&nbsp;<span class="ident" id="4885801">token</span><span class="op" id="4885806">.</span><span class="ident" id="4885807">XOR</span><span class="op" id="4885810">,</span>&nbsp;<span class="ident" id="4885812">token</span><span class="op" id="4885817">.</span><span class="ident" id="4885818">ARROW</span><span class="op" id="4885823">,</span>&nbsp;<span class="ident" id="4885825">token</span><span class="op" id="4885830">.</span><span class="ident" id="4885831">NOT</span><span class="op" id="4885834">:</span>&nbsp;<span class="comment" id="4885836">//&nbsp;unary&nbsp;operators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885857">s</span><span class="op" id="4885858">,</span>&nbsp;<span class="ident" id="4885860">_</span>&nbsp;<span class="op" id="4885862">=</span>&nbsp;<span class="ident" id="4885864">p</span><span class="op" id="4885865">.</span><span class="ident" id="4885866">parseSimpleStmt</span><span class="op" id="4885881">(</span><span class="ident" id="4885882">labelOk</span><span class="op" id="4885889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4885893">//&nbsp;because&nbsp;of&nbsp;the&nbsp;required&nbsp;look-ahead,&nbsp;labeled&nbsp;statements&nbsp;are</span><br>
<span class="lineno">2130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4885957">//&nbsp;parsed&nbsp;by&nbsp;parseSimpleStmt&nbsp;-&nbsp;don&#39;t&nbsp;expect&nbsp;a&nbsp;semicolon&nbsp;after</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4886021">//&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886031">if</span>&nbsp;<span class="ident" id="4886034">_</span><span class="op" id="4886035">,</span>&nbsp;<span class="ident" id="4886037">isLabeledStmt</span>&nbsp;<span class="op" id="4886051">:=</span>&nbsp;<span class="ident" id="4886054">s</span><span class="op" id="4886055">.</span><span class="op" id="4886056">(</span><span class="op" id="4886057">*</span><span class="ident" id="4886058">ast</span><span class="op" id="4886061">.</span><span class="ident" id="4886062">LabeledStmt</span><span class="op" id="4886073">)</span><span class="op" id="4886074">;</span>&nbsp;<span class="op" id="4886076">!</span><span class="ident" id="4886077">isLabeledStmt</span>&nbsp;<span class="op" id="4886091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886096">p</span><span class="op" id="4886097">.</span><span class="ident" id="4886098">expectSemi</span><span class="op" id="4886108">(</span><span class="op" id="4886109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4886113">}</span><br>
<span class="lineno">2135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886116">case</span>&nbsp;<span class="ident" id="4886121">token</span><span class="op" id="4886126">.</span><span class="ident" id="4886127">GO</span><span class="op" id="4886129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886133">s</span>&nbsp;<span class="op" id="4886135">=</span>&nbsp;<span class="ident" id="4886137">p</span><span class="op" id="4886138">.</span><span class="ident" id="4886139">parseGoStmt</span><span class="op" id="4886150">(</span><span class="op" id="4886151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886154">case</span>&nbsp;<span class="ident" id="4886159">token</span><span class="op" id="4886164">.</span><span class="ident" id="4886165">DEFER</span><span class="op" id="4886170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886174">s</span>&nbsp;<span class="op" id="4886176">=</span>&nbsp;<span class="ident" id="4886178">p</span><span class="op" id="4886179">.</span><span class="ident" id="4886180">parseDeferStmt</span><span class="op" id="4886194">(</span><span class="op" id="4886195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886198">case</span>&nbsp;<span class="ident" id="4886203">token</span><span class="op" id="4886208">.</span><span class="ident" id="4886209">RETURN</span><span class="op" id="4886215">:</span><br>
<span class="lineno">2140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886219">s</span>&nbsp;<span class="op" id="4886221">=</span>&nbsp;<span class="ident" id="4886223">p</span><span class="op" id="4886224">.</span><span class="ident" id="4886225">parseReturnStmt</span><span class="op" id="4886240">(</span><span class="op" id="4886241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886244">case</span>&nbsp;<span class="ident" id="4886249">token</span><span class="op" id="4886254">.</span><span class="ident" id="4886255">BREAK</span><span class="op" id="4886260">,</span>&nbsp;<span class="ident" id="4886262">token</span><span class="op" id="4886267">.</span><span class="ident" id="4886268">CONTINUE</span><span class="op" id="4886276">,</span>&nbsp;<span class="ident" id="4886278">token</span><span class="op" id="4886283">.</span><span class="ident" id="4886284">GOTO</span><span class="op" id="4886288">,</span>&nbsp;<span class="ident" id="4886290">token</span><span class="op" id="4886295">.</span><span class="ident" id="4886296">FALLTHROUGH</span><span class="op" id="4886307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886311">s</span>&nbsp;<span class="op" id="4886313">=</span>&nbsp;<span class="ident" id="4886315">p</span><span class="op" id="4886316">.</span><span class="ident" id="4886317">parseBranchStmt</span><span class="op" id="4886332">(</span><span class="ident" id="4886333">p</span><span class="op" id="4886334">.</span><span class="ident" id="4886335">tok</span><span class="op" id="4886338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886341">case</span>&nbsp;<span class="ident" id="4886346">token</span><span class="op" id="4886351">.</span><span class="ident" id="4886352">LBRACE</span><span class="op" id="4886358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886362">s</span>&nbsp;<span class="op" id="4886364">=</span>&nbsp;<span class="ident" id="4886366">p</span><span class="op" id="4886367">.</span><span class="ident" id="4886368">parseBlockStmt</span><span class="op" id="4886382">(</span><span class="op" id="4886383">)</span><br>
<span class="lineno">2145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886387">p</span><span class="op" id="4886388">.</span><span class="ident" id="4886389">expectSemi</span><span class="op" id="4886399">(</span><span class="op" id="4886400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886403">case</span>&nbsp;<span class="ident" id="4886408">token</span><span class="op" id="4886413">.</span><span class="ident" id="4886414">IF</span><span class="op" id="4886416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886420">s</span>&nbsp;<span class="op" id="4886422">=</span>&nbsp;<span class="ident" id="4886424">p</span><span class="op" id="4886425">.</span><span class="ident" id="4886426">parseIfStmt</span><span class="op" id="4886437">(</span><span class="op" id="4886438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886441">case</span>&nbsp;<span class="ident" id="4886446">token</span><span class="op" id="4886451">.</span><span class="ident" id="4886452">SWITCH</span><span class="op" id="4886458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886462">s</span>&nbsp;<span class="op" id="4886464">=</span>&nbsp;<span class="ident" id="4886466">p</span><span class="op" id="4886467">.</span><span class="ident" id="4886468">parseSwitchStmt</span><span class="op" id="4886483">(</span><span class="op" id="4886484">)</span><br>
<span class="lineno">2150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886487">case</span>&nbsp;<span class="ident" id="4886492">token</span><span class="op" id="4886497">.</span><span class="ident" id="4886498">SELECT</span><span class="op" id="4886504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886508">s</span>&nbsp;<span class="op" id="4886510">=</span>&nbsp;<span class="ident" id="4886512">p</span><span class="op" id="4886513">.</span><span class="ident" id="4886514">parseSelectStmt</span><span class="op" id="4886529">(</span><span class="op" id="4886530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886533">case</span>&nbsp;<span class="ident" id="4886538">token</span><span class="op" id="4886543">.</span><span class="ident" id="4886544">FOR</span><span class="op" id="4886547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886551">s</span>&nbsp;<span class="op" id="4886553">=</span>&nbsp;<span class="ident" id="4886555">p</span><span class="op" id="4886556">.</span><span class="ident" id="4886557">parseForStmt</span><span class="op" id="4886569">(</span><span class="op" id="4886570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886573">case</span>&nbsp;<span class="ident" id="4886578">token</span><span class="op" id="4886583">.</span><span class="ident" id="4886584">SEMICOLON</span><span class="op" id="4886593">:</span><br>
<span class="lineno">2155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886597">s</span>&nbsp;<span class="op" id="4886599">=</span>&nbsp;<span class="op" id="4886601">&amp;</span><span class="ident" id="4886602">ast</span><span class="op" id="4886605">.</span><span class="ident" id="4886606">EmptyStmt</span><span class="op" id="4886615">{</span><span class="ident" id="4886616">Semicolon</span><span class="op" id="4886625">:</span>&nbsp;<span class="ident" id="4886627">p</span><span class="op" id="4886628">.</span><span class="ident" id="4886629">pos</span><span class="op" id="4886632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886636">p</span><span class="op" id="4886637">.</span><span class="ident" id="4886638">next</span><span class="op" id="4886642">(</span><span class="op" id="4886643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886646">case</span>&nbsp;<span class="ident" id="4886651">token</span><span class="op" id="4886656">.</span><span class="ident" id="4886657">RBRACE</span><span class="op" id="4886663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4886667">//&nbsp;a&nbsp;semicolon&nbsp;may&nbsp;be&nbsp;omitted&nbsp;before&nbsp;a&nbsp;closing&nbsp;&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886720">s</span>&nbsp;<span class="op" id="4886722">=</span>&nbsp;<span class="op" id="4886724">&amp;</span><span class="ident" id="4886725">ast</span><span class="op" id="4886728">.</span><span class="ident" id="4886729">EmptyStmt</span><span class="op" id="4886738">{</span><span class="ident" id="4886739">Semicolon</span><span class="op" id="4886748">:</span>&nbsp;<span class="ident" id="4886750">p</span><span class="op" id="4886751">.</span><span class="ident" id="4886752">pos</span><span class="op" id="4886755">}</span><br>
<span class="lineno">2160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886758">default</span><span class="op" id="4886765">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4886769">//&nbsp;no&nbsp;statement&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886793">pos</span>&nbsp;<span class="op" id="4886797">:=</span>&nbsp;<span class="ident" id="4886800">p</span><span class="op" id="4886801">.</span><span class="ident" id="4886802">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886808">p</span><span class="op" id="4886809">.</span><span class="ident" id="4886810">errorExpected</span><span class="op" id="4886823">(</span><span class="ident" id="4886824">pos</span><span class="op" id="4886827">,</span>&nbsp;<span class="string" id="4886829">&#34;statement&#34;</span><span class="op" id="4886840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886844">syncStmt</span><span class="op" id="4886852">(</span><span class="ident" id="4886853">p</span><span class="op" id="4886854">)</span><br>
<span class="lineno">2165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4886858">s</span>&nbsp;<span class="op" id="4886860">=</span>&nbsp;<span class="op" id="4886862">&amp;</span><span class="ident" id="4886863">ast</span><span class="op" id="4886866">.</span><span class="ident" id="4886867">BadStmt</span><span class="op" id="4886874">{</span><span class="ident" id="4886875">From</span><span class="op" id="4886879">:</span>&nbsp;<span class="ident" id="4886881">pos</span><span class="op" id="4886884">,</span>&nbsp;<span class="ident" id="4886886">To</span><span class="op" id="4886888">:</span>&nbsp;<span class="ident" id="4886890">p</span><span class="op" id="4886891">.</span><span class="ident" id="4886892">pos</span><span class="op" id="4886895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4886898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4886902">return</span><br>
<span class="lineno"></span><span class="op" id="4886909">}</span><br>
<span class="lineno">2170</span><br>
<span class="lineno"></span><span class="comment" id="4886912">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4886992">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4887009">type</span>&nbsp;<span class="ident" id="4887014">parseSpecFunction</span>&nbsp;<span class="keyword" id="4887032">func</span><span class="op" id="4887036">(</span><span class="ident" id="4887037">doc</span>&nbsp;<span class="op" id="4887041">*</span><span class="ident" id="4887042">ast</span><span class="op" id="4887045">.</span><span class="ident" id="4887046">CommentGroup</span><span class="op" id="4887058">,</span>&nbsp;<span class="ident" id="4887060">keyword</span>&nbsp;<span class="ident" id="4887068">token</span><span class="op" id="4887073">.</span><span class="ident" id="4887074">Token</span><span class="op" id="4887079">,</span>&nbsp;<span class="ident" id="4887081">iota</span>&nbsp;<span class="builtintype" id="4887086">int</span><span class="op" id="4887089">)</span>&nbsp;<span class="ident" id="4887091">ast</span><span class="op" id="4887094">.</span><span class="ident" id="4887095">Spec</span><br>
<span class="lineno">2175</span><br>
<span class="lineno"></span><span class="keyword" id="4887101">func</span>&nbsp;<span class="ident" id="4887106">isValidImport</span><span class="op" id="4887119">(</span><span class="ident" id="4887120">lit</span>&nbsp;<span class="builtintype" id="4887124">string</span><span class="op" id="4887130">)</span>&nbsp;<span class="builtintype" id="4887132">bool</span>&nbsp;<span class="op" id="4887137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887140">const</span>&nbsp;<span class="ident" id="4887146">illegalChars</span>&nbsp;<span class="op" id="4887159">=</span>&nbsp;<span class="string" id="4887161">`!&#34;#$%&amp;&#39;()*,:;&lt;=&gt;?[\]^{|}`</span>&nbsp;<span class="op" id="4887188">+</span>&nbsp;<span class="string" id="4887190">&#34;`\uFFFD&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887201">s</span><span class="op" id="4887202">,</span>&nbsp;<span class="ident" id="4887204">_</span>&nbsp;<span class="op" id="4887206">:=</span>&nbsp;<span class="ident" id="4887209">strconv</span><span class="op" id="4887216">.</span><span class="ident" id="4887217">Unquote</span><span class="op" id="4887224">(</span><span class="ident" id="4887225">lit</span><span class="op" id="4887228">)</span>&nbsp;<span class="comment" id="4887230">//&nbsp;go/scanner&nbsp;returns&nbsp;a&nbsp;legal&nbsp;string&nbsp;literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887276">for</span>&nbsp;<span class="ident" id="4887280">_</span><span class="op" id="4887281">,</span>&nbsp;<span class="ident" id="4887283">r</span>&nbsp;<span class="op" id="4887285">:=</span>&nbsp;<span class="keyword" id="4887288">range</span>&nbsp;<span class="ident" id="4887294">s</span>&nbsp;<span class="op" id="4887296">{</span><br>
<span class="lineno">2180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887300">if</span>&nbsp;<span class="op" id="4887303">!</span><span class="ident" id="4887304">unicode</span><span class="op" id="4887311">.</span><span class="ident" id="4887312">IsGraphic</span><span class="op" id="4887321">(</span><span class="ident" id="4887322">r</span><span class="op" id="4887323">)</span>&nbsp;<span class="op" id="4887325">||</span>&nbsp;<span class="ident" id="4887328">unicode</span><span class="op" id="4887335">.</span><span class="ident" id="4887336">IsSpace</span><span class="op" id="4887343">(</span><span class="ident" id="4887344">r</span><span class="op" id="4887345">)</span>&nbsp;<span class="op" id="4887347">||</span>&nbsp;<span class="ident" id="4887350">strings</span><span class="op" id="4887357">.</span><span class="ident" id="4887358">ContainsRune</span><span class="op" id="4887370">(</span><span class="ident" id="4887371">illegalChars</span><span class="op" id="4887383">,</span>&nbsp;<span class="ident" id="4887385">r</span><span class="op" id="4887386">)</span>&nbsp;<span class="op" id="4887388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887393">return</span>&nbsp;<span class="builtintype" id="4887400">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887414">return</span>&nbsp;<span class="ident" id="4887421">s</span>&nbsp;<span class="op" id="4887423">!=</span>&nbsp;<span class="string" id="4887426">&#34;&#34;</span><br>
<span class="lineno">2185</span><span class="op" id="4887429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4887432">func</span>&nbsp;<span class="op" id="4887437">(</span><span class="ident" id="4887438">p</span>&nbsp;<span class="op" id="4887440">*</span><span class="ident" id="4887441">parser</span><span class="op" id="4887447">)</span>&nbsp;<span class="ident" id="4887449">parseImportSpec</span><span class="op" id="4887464">(</span><span class="ident" id="4887465">doc</span>&nbsp;<span class="op" id="4887469">*</span><span class="ident" id="4887470">ast</span><span class="op" id="4887473">.</span><span class="ident" id="4887474">CommentGroup</span><span class="op" id="4887486">,</span>&nbsp;<span class="ident" id="4887488">_</span>&nbsp;<span class="ident" id="4887490">token</span><span class="op" id="4887495">.</span><span class="ident" id="4887496">Token</span><span class="op" id="4887501">,</span>&nbsp;<span class="ident" id="4887503">_</span>&nbsp;<span class="builtintype" id="4887505">int</span><span class="op" id="4887508">)</span>&nbsp;<span class="ident" id="4887510">ast</span><span class="op" id="4887513">.</span><span class="ident" id="4887514">Spec</span>&nbsp;<span class="op" id="4887519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887522">if</span>&nbsp;<span class="ident" id="4887525">p</span><span class="op" id="4887526">.</span><span class="ident" id="4887527">trace</span>&nbsp;<span class="op" id="4887533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887537">defer</span>&nbsp;<span class="ident" id="4887543">un</span><span class="op" id="4887545">(</span><span class="ident" id="4887546">trace</span><span class="op" id="4887551">(</span><span class="ident" id="4887552">p</span><span class="op" id="4887553">,</span>&nbsp;<span class="string" id="4887555">&#34;ImportSpec&#34;</span><span class="op" id="4887567">)</span><span class="op" id="4887568">)</span><br>
<span class="lineno">2190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887575">var</span>&nbsp;<span class="ident" id="4887579">ident</span>&nbsp;<span class="op" id="4887585">*</span><span class="ident" id="4887586">ast</span><span class="op" id="4887589">.</span><span class="ident" id="4887590">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887597">switch</span>&nbsp;<span class="ident" id="4887604">p</span><span class="op" id="4887605">.</span><span class="ident" id="4887606">tok</span>&nbsp;<span class="op" id="4887610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887613">case</span>&nbsp;<span class="ident" id="4887618">token</span><span class="op" id="4887623">.</span><span class="ident" id="4887624">PERIOD</span><span class="op" id="4887630">:</span><br>
<span class="lineno">2195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887634">ident</span>&nbsp;<span class="op" id="4887640">=</span>&nbsp;<span class="op" id="4887642">&amp;</span><span class="ident" id="4887643">ast</span><span class="op" id="4887646">.</span><span class="ident" id="4887647">Ident</span><span class="op" id="4887652">{</span><span class="ident" id="4887653">NamePos</span><span class="op" id="4887660">:</span>&nbsp;<span class="ident" id="4887662">p</span><span class="op" id="4887663">.</span><span class="ident" id="4887664">pos</span><span class="op" id="4887667">,</span>&nbsp;<span class="ident" id="4887669">Name</span><span class="op" id="4887673">:</span>&nbsp;<span class="string" id="4887675">&#34;.&#34;</span><span class="op" id="4887678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887682">p</span><span class="op" id="4887683">.</span><span class="ident" id="4887684">next</span><span class="op" id="4887688">(</span><span class="op" id="4887689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887692">case</span>&nbsp;<span class="ident" id="4887697">token</span><span class="op" id="4887702">.</span><span class="ident" id="4887703">IDENT</span><span class="op" id="4887708">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887712">ident</span>&nbsp;<span class="op" id="4887718">=</span>&nbsp;<span class="ident" id="4887720">p</span><span class="op" id="4887721">.</span><span class="ident" id="4887722">parseIdent</span><span class="op" id="4887732">(</span><span class="op" id="4887733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887736">}</span><br>
<span class="lineno">2200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887740">pos</span>&nbsp;<span class="op" id="4887744">:=</span>&nbsp;<span class="ident" id="4887747">p</span><span class="op" id="4887748">.</span><span class="ident" id="4887749">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887754">var</span>&nbsp;<span class="ident" id="4887758">path</span>&nbsp;<span class="builtintype" id="4887763">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887771">if</span>&nbsp;<span class="ident" id="4887774">p</span><span class="op" id="4887775">.</span><span class="ident" id="4887776">tok</span>&nbsp;<span class="op" id="4887780">==</span>&nbsp;<span class="ident" id="4887783">token</span><span class="op" id="4887788">.</span><span class="ident" id="4887789">STRING</span>&nbsp;<span class="op" id="4887796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887800">path</span>&nbsp;<span class="op" id="4887805">=</span>&nbsp;<span class="ident" id="4887807">p</span><span class="op" id="4887808">.</span><span class="ident" id="4887809">lit</span><br>
<span class="lineno">2205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4887815">if</span>&nbsp;<span class="op" id="4887818">!</span><span class="ident" id="4887819">isValidImport</span><span class="op" id="4887832">(</span><span class="ident" id="4887833">path</span><span class="op" id="4887837">)</span>&nbsp;<span class="op" id="4887839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887844">p</span><span class="op" id="4887845">.</span><span class="builtintype" id="4887846">error</span><span class="op" id="4887851">(</span><span class="ident" id="4887852">pos</span><span class="op" id="4887855">,</span>&nbsp;<span class="string" id="4887857">&#34;invalid&nbsp;import&nbsp;path:&nbsp;&#34;</span><span class="op" id="4887880">+</span><span class="ident" id="4887881">path</span><span class="op" id="4887885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887893">p</span><span class="op" id="4887894">.</span><span class="ident" id="4887895">next</span><span class="op" id="4887899">(</span><span class="op" id="4887900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887903">}</span>&nbsp;<span class="keyword" id="4887905">else</span>&nbsp;<span class="op" id="4887910">{</span><br>
<span class="lineno">2210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887914">p</span><span class="op" id="4887915">.</span><span class="ident" id="4887916">expect</span><span class="op" id="4887922">(</span><span class="ident" id="4887923">token</span><span class="op" id="4887928">.</span><span class="ident" id="4887929">STRING</span><span class="op" id="4887935">)</span>&nbsp;<span class="comment" id="4887937">//&nbsp;use&nbsp;expect()&nbsp;error&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4887972">p</span><span class="op" id="4887973">.</span><span class="ident" id="4887974">expectSemi</span><span class="op" id="4887984">(</span><span class="op" id="4887985">)</span>&nbsp;<span class="comment" id="4887987">//&nbsp;call&nbsp;before&nbsp;accessing&nbsp;p.linecomment</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888028">//&nbsp;collect&nbsp;imports</span><br>
<span class="lineno">2215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888048">spec</span>&nbsp;<span class="op" id="4888053">:=</span>&nbsp;<span class="op" id="4888056">&amp;</span><span class="ident" id="4888057">ast</span><span class="op" id="4888060">.</span><span class="ident" id="4888061">ImportSpec</span><span class="op" id="4888071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888075">Doc</span><span class="op" id="4888078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888084">doc</span><span class="op" id="4888087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888091">Name</span><span class="op" id="4888095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888100">ident</span><span class="op" id="4888105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888109">Path</span><span class="op" id="4888113">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4888118">&amp;</span><span class="ident" id="4888119">ast</span><span class="op" id="4888122">.</span><span class="ident" id="4888123">BasicLit</span><span class="op" id="4888131">{</span><span class="ident" id="4888132">ValuePos</span><span class="op" id="4888140">:</span>&nbsp;<span class="ident" id="4888142">pos</span><span class="op" id="4888145">,</span>&nbsp;<span class="ident" id="4888147">Kind</span><span class="op" id="4888151">:</span>&nbsp;<span class="ident" id="4888153">token</span><span class="op" id="4888158">.</span><span class="ident" id="4888159">STRING</span><span class="op" id="4888165">,</span>&nbsp;<span class="ident" id="4888167">Value</span><span class="op" id="4888172">:</span>&nbsp;<span class="ident" id="4888174">path</span><span class="op" id="4888178">}</span><span class="op" id="4888179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888183">Comment</span><span class="op" id="4888190">:</span>&nbsp;<span class="ident" id="4888192">p</span><span class="op" id="4888193">.</span><span class="ident" id="4888194">lineComment</span><span class="op" id="4888205">,</span><br>
<span class="lineno">2220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4888208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888211">p</span><span class="op" id="4888212">.</span><span class="ident" id="4888213">imports</span>&nbsp;<span class="op" id="4888221">=</span>&nbsp;<span class="builtinfunc" id="4888223">append</span><span class="op" id="4888229">(</span><span class="ident" id="4888230">p</span><span class="op" id="4888231">.</span><span class="ident" id="4888232">imports</span><span class="op" id="4888239">,</span>&nbsp;<span class="ident" id="4888241">spec</span><span class="op" id="4888245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4888249">return</span>&nbsp;<span class="ident" id="4888256">spec</span><br>
<span class="lineno"></span><span class="op" id="4888261">}</span><br>
<span class="lineno">2225</span><br>
<span class="lineno"></span><span class="keyword" id="4888264">func</span>&nbsp;<span class="op" id="4888269">(</span><span class="ident" id="4888270">p</span>&nbsp;<span class="op" id="4888272">*</span><span class="ident" id="4888273">parser</span><span class="op" id="4888279">)</span>&nbsp;<span class="ident" id="4888281">parseValueSpec</span><span class="op" id="4888295">(</span><span class="ident" id="4888296">doc</span>&nbsp;<span class="op" id="4888300">*</span><span class="ident" id="4888301">ast</span><span class="op" id="4888304">.</span><span class="ident" id="4888305">CommentGroup</span><span class="op" id="4888317">,</span>&nbsp;<span class="ident" id="4888319">keyword</span>&nbsp;<span class="ident" id="4888327">token</span><span class="op" id="4888332">.</span><span class="ident" id="4888333">Token</span><span class="op" id="4888338">,</span>&nbsp;<span class="ident" id="4888340">iota</span>&nbsp;<span class="builtintype" id="4888345">int</span><span class="op" id="4888348">)</span>&nbsp;<span class="ident" id="4888350">ast</span><span class="op" id="4888353">.</span><span class="ident" id="4888354">Spec</span>&nbsp;<span class="op" id="4888359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4888362">if</span>&nbsp;<span class="ident" id="4888365">p</span><span class="op" id="4888366">.</span><span class="ident" id="4888367">trace</span>&nbsp;<span class="op" id="4888373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4888377">defer</span>&nbsp;<span class="ident" id="4888383">un</span><span class="op" id="4888385">(</span><span class="ident" id="4888386">trace</span><span class="op" id="4888391">(</span><span class="ident" id="4888392">p</span><span class="op" id="4888393">,</span>&nbsp;<span class="ident" id="4888395">keyword</span><span class="op" id="4888402">.</span><span class="ident" id="4888403">String</span><span class="op" id="4888409">(</span><span class="op" id="4888410">)</span><span class="op" id="4888411">+</span><span class="string" id="4888412">&#34;Spec&#34;</span><span class="op" id="4888418">)</span><span class="op" id="4888419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4888422">}</span><br>
<span class="lineno">2230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888426">idents</span>&nbsp;<span class="op" id="4888433">:=</span>&nbsp;<span class="ident" id="4888436">p</span><span class="op" id="4888437">.</span><span class="ident" id="4888438">parseIdentList</span><span class="op" id="4888452">(</span><span class="op" id="4888453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888456">typ</span>&nbsp;<span class="op" id="4888460">:=</span>&nbsp;<span class="ident" id="4888463">p</span><span class="op" id="4888464">.</span><span class="ident" id="4888465">tryType</span><span class="op" id="4888472">(</span><span class="op" id="4888473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4888476">var</span>&nbsp;<span class="ident" id="4888480">values</span>&nbsp;<span class="op" id="4888487">[</span><span class="op" id="4888488">]</span><span class="ident" id="4888489">ast</span><span class="op" id="4888492">.</span><span class="ident" id="4888493">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888499">//&nbsp;always&nbsp;permit&nbsp;optional&nbsp;initialization&nbsp;for&nbsp;more&nbsp;tolerant&nbsp;parsing</span><br>
<span class="lineno">2235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4888567">if</span>&nbsp;<span class="ident" id="4888570">p</span><span class="op" id="4888571">.</span><span class="ident" id="4888572">tok</span>&nbsp;<span class="op" id="4888576">==</span>&nbsp;<span class="ident" id="4888579">token</span><span class="op" id="4888584">.</span><span class="ident" id="4888585">ASSIGN</span>&nbsp;<span class="op" id="4888592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888596">p</span><span class="op" id="4888597">.</span><span class="ident" id="4888598">next</span><span class="op" id="4888602">(</span><span class="op" id="4888603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888607">values</span>&nbsp;<span class="op" id="4888614">=</span>&nbsp;<span class="ident" id="4888616">p</span><span class="op" id="4888617">.</span><span class="ident" id="4888618">parseRhsList</span><span class="op" id="4888630">(</span><span class="op" id="4888631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4888634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888637">p</span><span class="op" id="4888638">.</span><span class="ident" id="4888639">expectSemi</span><span class="op" id="4888649">(</span><span class="op" id="4888650">)</span>&nbsp;<span class="comment" id="4888652">//&nbsp;call&nbsp;before&nbsp;accessing&nbsp;p.linecomment</span><br>
<span class="lineno">2240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888693">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;a&nbsp;constant&nbsp;or&nbsp;variable&nbsp;identifier&nbsp;declared&nbsp;inside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888769">//&nbsp;a&nbsp;function&nbsp;begins&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;ConstSpec&nbsp;or&nbsp;VarSpec&nbsp;and&nbsp;ends&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888842">//&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;innermost&nbsp;containing&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4888889">//&nbsp;(Global&nbsp;identifiers&nbsp;are&nbsp;resolved&nbsp;in&nbsp;a&nbsp;separate&nbsp;phase&nbsp;after&nbsp;parsing.)</span><br>
<span class="lineno">2245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888962">spec</span>&nbsp;<span class="op" id="4888967">:=</span>&nbsp;<span class="op" id="4888970">&amp;</span><span class="ident" id="4888971">ast</span><span class="op" id="4888974">.</span><span class="ident" id="4888975">ValueSpec</span><span class="op" id="4888984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888988">Doc</span><span class="op" id="4888991">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888997">doc</span><span class="op" id="4889000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889004">Names</span><span class="op" id="4889009">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4889013">idents</span><span class="op" id="4889019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889023">Type</span><span class="op" id="4889027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889032">typ</span><span class="op" id="4889035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889039">Values</span><span class="op" id="4889045">:</span>&nbsp;&nbsp;<span class="ident" id="4889048">values</span><span class="op" id="4889054">,</span><br>
<span class="lineno">2250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889058">Comment</span><span class="op" id="4889065">:</span>&nbsp;<span class="ident" id="4889067">p</span><span class="op" id="4889068">.</span><span class="ident" id="4889069">lineComment</span><span class="op" id="4889080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4889083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889086">kind</span>&nbsp;<span class="op" id="4889091">:=</span>&nbsp;<span class="ident" id="4889094">ast</span><span class="op" id="4889097">.</span><span class="ident" id="4889098">Con</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889103">if</span>&nbsp;<span class="ident" id="4889106">keyword</span>&nbsp;<span class="op" id="4889114">==</span>&nbsp;<span class="ident" id="4889117">token</span><span class="op" id="4889122">.</span><span class="ident" id="4889123">VAR</span>&nbsp;<span class="op" id="4889127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889131">kind</span>&nbsp;<span class="op" id="4889136">=</span>&nbsp;<span class="ident" id="4889138">ast</span><span class="op" id="4889141">.</span><span class="ident" id="4889142">Var</span><br>
<span class="lineno">2255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4889147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889150">p</span><span class="op" id="4889151">.</span><span class="ident" id="4889152">declare</span><span class="op" id="4889159">(</span><span class="ident" id="4889160">spec</span><span class="op" id="4889164">,</span>&nbsp;<span class="ident" id="4889166">iota</span><span class="op" id="4889170">,</span>&nbsp;<span class="ident" id="4889172">p</span><span class="op" id="4889173">.</span><span class="ident" id="4889174">topScope</span><span class="op" id="4889182">,</span>&nbsp;<span class="ident" id="4889184">kind</span><span class="op" id="4889188">,</span>&nbsp;<span class="ident" id="4889190">idents</span><span class="op" id="4889196">...</span><span class="op" id="4889199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889203">return</span>&nbsp;<span class="ident" id="4889210">spec</span><br>
<span class="lineno"></span><span class="op" id="4889215">}</span><br>
<span class="lineno">2260</span><br>
<span class="lineno"></span><span class="keyword" id="4889218">func</span>&nbsp;<span class="op" id="4889223">(</span><span class="ident" id="4889224">p</span>&nbsp;<span class="op" id="4889226">*</span><span class="ident" id="4889227">parser</span><span class="op" id="4889233">)</span>&nbsp;<span class="ident" id="4889235">parseTypeSpec</span><span class="op" id="4889248">(</span><span class="ident" id="4889249">doc</span>&nbsp;<span class="op" id="4889253">*</span><span class="ident" id="4889254">ast</span><span class="op" id="4889257">.</span><span class="ident" id="4889258">CommentGroup</span><span class="op" id="4889270">,</span>&nbsp;<span class="ident" id="4889272">_</span>&nbsp;<span class="ident" id="4889274">token</span><span class="op" id="4889279">.</span><span class="ident" id="4889280">Token</span><span class="op" id="4889285">,</span>&nbsp;<span class="ident" id="4889287">_</span>&nbsp;<span class="builtintype" id="4889289">int</span><span class="op" id="4889292">)</span>&nbsp;<span class="ident" id="4889294">ast</span><span class="op" id="4889297">.</span><span class="ident" id="4889298">Spec</span>&nbsp;<span class="op" id="4889303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889306">if</span>&nbsp;<span class="ident" id="4889309">p</span><span class="op" id="4889310">.</span><span class="ident" id="4889311">trace</span>&nbsp;<span class="op" id="4889317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889321">defer</span>&nbsp;<span class="ident" id="4889327">un</span><span class="op" id="4889329">(</span><span class="ident" id="4889330">trace</span><span class="op" id="4889335">(</span><span class="ident" id="4889336">p</span><span class="op" id="4889337">,</span>&nbsp;<span class="string" id="4889339">&#34;TypeSpec&#34;</span><span class="op" id="4889349">)</span><span class="op" id="4889350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4889353">}</span><br>
<span class="lineno">2265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889357">ident</span>&nbsp;<span class="op" id="4889363">:=</span>&nbsp;<span class="ident" id="4889366">p</span><span class="op" id="4889367">.</span><span class="ident" id="4889368">parseIdent</span><span class="op" id="4889378">(</span><span class="op" id="4889379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4889383">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;a&nbsp;type&nbsp;identifier&nbsp;declared&nbsp;inside&nbsp;a&nbsp;function&nbsp;begins</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4889461">//&nbsp;at&nbsp;the&nbsp;identifier&nbsp;in&nbsp;the&nbsp;TypeSpec&nbsp;and&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;innermost</span><br>
<span class="lineno">2270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4889536">//&nbsp;containing&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4889558">//&nbsp;(Global&nbsp;identifiers&nbsp;are&nbsp;resolved&nbsp;in&nbsp;a&nbsp;separate&nbsp;phase&nbsp;after&nbsp;parsing.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889631">spec</span>&nbsp;<span class="op" id="4889636">:=</span>&nbsp;<span class="op" id="4889639">&amp;</span><span class="ident" id="4889640">ast</span><span class="op" id="4889643">.</span><span class="ident" id="4889644">TypeSpec</span><span class="op" id="4889652">{</span><span class="ident" id="4889653">Doc</span><span class="op" id="4889656">:</span>&nbsp;<span class="ident" id="4889658">doc</span><span class="op" id="4889661">,</span>&nbsp;<span class="ident" id="4889663">Name</span><span class="op" id="4889667">:</span>&nbsp;<span class="ident" id="4889669">ident</span><span class="op" id="4889674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889677">p</span><span class="op" id="4889678">.</span><span class="ident" id="4889679">declare</span><span class="op" id="4889686">(</span><span class="ident" id="4889687">spec</span><span class="op" id="4889691">,</span>&nbsp;<span class="builtintype" id="4889693">nil</span><span class="op" id="4889696">,</span>&nbsp;<span class="ident" id="4889698">p</span><span class="op" id="4889699">.</span><span class="ident" id="4889700">topScope</span><span class="op" id="4889708">,</span>&nbsp;<span class="ident" id="4889710">ast</span><span class="op" id="4889713">.</span><span class="ident" id="4889714">Typ</span><span class="op" id="4889717">,</span>&nbsp;<span class="ident" id="4889719">ident</span><span class="op" id="4889724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">2275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889728">spec</span><span class="op" id="4889732">.</span><span class="ident" id="4889733">Type</span>&nbsp;<span class="op" id="4889738">=</span>&nbsp;<span class="ident" id="4889740">p</span><span class="op" id="4889741">.</span><span class="ident" id="4889742">parseType</span><span class="op" id="4889751">(</span><span class="op" id="4889752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889755">p</span><span class="op" id="4889756">.</span><span class="ident" id="4889757">expectSemi</span><span class="op" id="4889767">(</span><span class="op" id="4889768">)</span>&nbsp;<span class="comment" id="4889770">//&nbsp;call&nbsp;before&nbsp;accessing&nbsp;p.linecomment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889810">spec</span><span class="op" id="4889814">.</span><span class="ident" id="4889815">Comment</span>&nbsp;<span class="op" id="4889823">=</span>&nbsp;<span class="ident" id="4889825">p</span><span class="op" id="4889826">.</span><span class="ident" id="4889827">lineComment</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889841">return</span>&nbsp;<span class="ident" id="4889848">spec</span><br>
<span class="lineno">2280</span><span class="op" id="4889853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4889856">func</span>&nbsp;<span class="op" id="4889861">(</span><span class="ident" id="4889862">p</span>&nbsp;<span class="op" id="4889864">*</span><span class="ident" id="4889865">parser</span><span class="op" id="4889871">)</span>&nbsp;<span class="ident" id="4889873">parseGenDecl</span><span class="op" id="4889885">(</span><span class="ident" id="4889886">keyword</span>&nbsp;<span class="ident" id="4889894">token</span><span class="op" id="4889899">.</span><span class="ident" id="4889900">Token</span><span class="op" id="4889905">,</span>&nbsp;<span class="ident" id="4889907">f</span>&nbsp;<span class="ident" id="4889909">parseSpecFunction</span><span class="op" id="4889926">)</span>&nbsp;<span class="op" id="4889928">*</span><span class="ident" id="4889929">ast</span><span class="op" id="4889932">.</span><span class="ident" id="4889933">GenDecl</span>&nbsp;<span class="op" id="4889941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889944">if</span>&nbsp;<span class="ident" id="4889947">p</span><span class="op" id="4889948">.</span><span class="ident" id="4889949">trace</span>&nbsp;<span class="op" id="4889955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4889959">defer</span>&nbsp;<span class="ident" id="4889965">un</span><span class="op" id="4889967">(</span><span class="ident" id="4889968">trace</span><span class="op" id="4889973">(</span><span class="ident" id="4889974">p</span><span class="op" id="4889975">,</span>&nbsp;<span class="string" id="4889977">&#34;GenDecl(&#34;</span><span class="op" id="4889987">+</span><span class="ident" id="4889988">keyword</span><span class="op" id="4889995">.</span><span class="ident" id="4889996">String</span><span class="op" id="4890002">(</span><span class="op" id="4890003">)</span><span class="op" id="4890004">+</span><span class="string" id="4890005">&#34;)&#34;</span><span class="op" id="4890008">)</span><span class="op" id="4890009">)</span><br>
<span class="lineno">2285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890016">doc</span>&nbsp;<span class="op" id="4890020">:=</span>&nbsp;<span class="ident" id="4890023">p</span><span class="op" id="4890024">.</span><span class="ident" id="4890025">leadComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890038">pos</span>&nbsp;<span class="op" id="4890042">:=</span>&nbsp;<span class="ident" id="4890045">p</span><span class="op" id="4890046">.</span><span class="ident" id="4890047">expect</span><span class="op" id="4890053">(</span><span class="ident" id="4890054">keyword</span><span class="op" id="4890061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890064">var</span>&nbsp;<span class="ident" id="4890068">lparen</span><span class="op" id="4890074">,</span>&nbsp;<span class="ident" id="4890076">rparen</span>&nbsp;<span class="ident" id="4890083">token</span><span class="op" id="4890088">.</span><span class="ident" id="4890089">Pos</span><br>
<span class="lineno">2290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890094">var</span>&nbsp;<span class="ident" id="4890098">list</span>&nbsp;<span class="op" id="4890103">[</span><span class="op" id="4890104">]</span><span class="ident" id="4890105">ast</span><span class="op" id="4890108">.</span><span class="ident" id="4890109">Spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890115">if</span>&nbsp;<span class="ident" id="4890118">p</span><span class="op" id="4890119">.</span><span class="ident" id="4890120">tok</span>&nbsp;<span class="op" id="4890124">==</span>&nbsp;<span class="ident" id="4890127">token</span><span class="op" id="4890132">.</span><span class="ident" id="4890133">LPAREN</span>&nbsp;<span class="op" id="4890140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890144">lparen</span>&nbsp;<span class="op" id="4890151">=</span>&nbsp;<span class="ident" id="4890153">p</span><span class="op" id="4890154">.</span><span class="ident" id="4890155">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890161">p</span><span class="op" id="4890162">.</span><span class="ident" id="4890163">next</span><span class="op" id="4890167">(</span><span class="op" id="4890168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890172">for</span>&nbsp;<span class="ident" id="4890176">iota</span>&nbsp;<span class="op" id="4890181">:=</span>&nbsp;<span class="num" id="4890184">0</span><span class="op" id="4890185">;</span>&nbsp;<span class="ident" id="4890187">p</span><span class="op" id="4890188">.</span><span class="ident" id="4890189">tok</span>&nbsp;<span class="op" id="4890193">!=</span>&nbsp;<span class="ident" id="4890196">token</span><span class="op" id="4890201">.</span><span class="ident" id="4890202">RPAREN</span>&nbsp;<span class="op" id="4890209">&amp;&amp;</span>&nbsp;<span class="ident" id="4890212">p</span><span class="op" id="4890213">.</span><span class="ident" id="4890214">tok</span>&nbsp;<span class="op" id="4890218">!=</span>&nbsp;<span class="ident" id="4890221">token</span><span class="op" id="4890226">.</span><span class="ident" id="4890227">EOF</span><span class="op" id="4890230">;</span>&nbsp;<span class="ident" id="4890232">iota</span><span class="op" id="4890236">++</span>&nbsp;<span class="op" id="4890239">{</span><br>
<span class="lineno">2295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890244">list</span>&nbsp;<span class="op" id="4890249">=</span>&nbsp;<span class="builtinfunc" id="4890251">append</span><span class="op" id="4890257">(</span><span class="ident" id="4890258">list</span><span class="op" id="4890262">,</span>&nbsp;<span class="ident" id="4890264">f</span><span class="op" id="4890265">(</span><span class="ident" id="4890266">p</span><span class="op" id="4890267">.</span><span class="ident" id="4890268">leadComment</span><span class="op" id="4890279">,</span>&nbsp;<span class="ident" id="4890281">keyword</span><span class="op" id="4890288">,</span>&nbsp;<span class="ident" id="4890290">iota</span><span class="op" id="4890294">)</span><span class="op" id="4890295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890303">rparen</span>&nbsp;<span class="op" id="4890310">=</span>&nbsp;<span class="ident" id="4890312">p</span><span class="op" id="4890313">.</span><span class="ident" id="4890314">expect</span><span class="op" id="4890320">(</span><span class="ident" id="4890321">token</span><span class="op" id="4890326">.</span><span class="ident" id="4890327">RPAREN</span><span class="op" id="4890333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890337">p</span><span class="op" id="4890338">.</span><span class="ident" id="4890339">expectSemi</span><span class="op" id="4890349">(</span><span class="op" id="4890350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890353">}</span>&nbsp;<span class="keyword" id="4890355">else</span>&nbsp;<span class="op" id="4890360">{</span><br>
<span class="lineno">2300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890364">list</span>&nbsp;<span class="op" id="4890369">=</span>&nbsp;<span class="builtinfunc" id="4890371">append</span><span class="op" id="4890377">(</span><span class="ident" id="4890378">list</span><span class="op" id="4890382">,</span>&nbsp;<span class="ident" id="4890384">f</span><span class="op" id="4890385">(</span><span class="builtintype" id="4890386">nil</span><span class="op" id="4890389">,</span>&nbsp;<span class="ident" id="4890391">keyword</span><span class="op" id="4890398">,</span>&nbsp;<span class="num" id="4890400">0</span><span class="op" id="4890401">)</span><span class="op" id="4890402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890409">return</span>&nbsp;<span class="op" id="4890416">&amp;</span><span class="ident" id="4890417">ast</span><span class="op" id="4890420">.</span><span class="ident" id="4890421">GenDecl</span><span class="op" id="4890428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890432">Doc</span><span class="op" id="4890435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890440">doc</span><span class="op" id="4890443">,</span><br>
<span class="lineno">2305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890447">TokPos</span><span class="op" id="4890453">:</span>&nbsp;<span class="ident" id="4890455">pos</span><span class="op" id="4890458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890462">Tok</span><span class="op" id="4890465">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890470">keyword</span><span class="op" id="4890477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890481">Lparen</span><span class="op" id="4890487">:</span>&nbsp;<span class="ident" id="4890489">lparen</span><span class="op" id="4890495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890499">Specs</span><span class="op" id="4890504">:</span>&nbsp;&nbsp;<span class="ident" id="4890507">list</span><span class="op" id="4890511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890515">Rparen</span><span class="op" id="4890521">:</span>&nbsp;<span class="ident" id="4890523">rparen</span><span class="op" id="4890529">,</span><br>
<span class="lineno">2310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890532">}</span><br>
<span class="lineno"></span><span class="op" id="4890534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4890537">func</span>&nbsp;<span class="op" id="4890542">(</span><span class="ident" id="4890543">p</span>&nbsp;<span class="op" id="4890545">*</span><span class="ident" id="4890546">parser</span><span class="op" id="4890552">)</span>&nbsp;<span class="ident" id="4890554">parseFuncDecl</span><span class="op" id="4890567">(</span><span class="op" id="4890568">)</span>&nbsp;<span class="op" id="4890570">*</span><span class="ident" id="4890571">ast</span><span class="op" id="4890574">.</span><span class="ident" id="4890575">FuncDecl</span>&nbsp;<span class="op" id="4890584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890587">if</span>&nbsp;<span class="ident" id="4890590">p</span><span class="op" id="4890591">.</span><span class="ident" id="4890592">trace</span>&nbsp;<span class="op" id="4890598">{</span><br>
<span class="lineno">2315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890602">defer</span>&nbsp;<span class="ident" id="4890608">un</span><span class="op" id="4890610">(</span><span class="ident" id="4890611">trace</span><span class="op" id="4890616">(</span><span class="ident" id="4890617">p</span><span class="op" id="4890618">,</span>&nbsp;<span class="string" id="4890620">&#34;FunctionDecl&#34;</span><span class="op" id="4890634">)</span><span class="op" id="4890635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890642">doc</span>&nbsp;<span class="op" id="4890646">:=</span>&nbsp;<span class="ident" id="4890649">p</span><span class="op" id="4890650">.</span><span class="ident" id="4890651">leadComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890664">pos</span>&nbsp;<span class="op" id="4890668">:=</span>&nbsp;<span class="ident" id="4890671">p</span><span class="op" id="4890672">.</span><span class="ident" id="4890673">expect</span><span class="op" id="4890679">(</span><span class="ident" id="4890680">token</span><span class="op" id="4890685">.</span><span class="ident" id="4890686">FUNC</span><span class="op" id="4890690">)</span><br>
<span class="lineno">2320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890693">scope</span>&nbsp;<span class="op" id="4890699">:=</span>&nbsp;<span class="ident" id="4890702">ast</span><span class="op" id="4890705">.</span><span class="ident" id="4890706">NewScope</span><span class="op" id="4890714">(</span><span class="ident" id="4890715">p</span><span class="op" id="4890716">.</span><span class="ident" id="4890717">topScope</span><span class="op" id="4890725">)</span>&nbsp;<span class="comment" id="4890727">//&nbsp;function&nbsp;scope</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890747">var</span>&nbsp;<span class="ident" id="4890751">recv</span>&nbsp;<span class="op" id="4890756">*</span><span class="ident" id="4890757">ast</span><span class="op" id="4890760">.</span><span class="ident" id="4890761">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890772">if</span>&nbsp;<span class="ident" id="4890775">p</span><span class="op" id="4890776">.</span><span class="ident" id="4890777">tok</span>&nbsp;<span class="op" id="4890781">==</span>&nbsp;<span class="ident" id="4890784">token</span><span class="op" id="4890789">.</span><span class="ident" id="4890790">LPAREN</span>&nbsp;<span class="op" id="4890797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890801">recv</span>&nbsp;<span class="op" id="4890806">=</span>&nbsp;<span class="ident" id="4890808">p</span><span class="op" id="4890809">.</span><span class="ident" id="4890810">parseParameters</span><span class="op" id="4890825">(</span><span class="ident" id="4890826">scope</span><span class="op" id="4890831">,</span>&nbsp;<span class="builtintype" id="4890833">false</span><span class="op" id="4890838">)</span><br>
<span class="lineno">2325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890845">ident</span>&nbsp;<span class="op" id="4890851">:=</span>&nbsp;<span class="ident" id="4890854">p</span><span class="op" id="4890855">.</span><span class="ident" id="4890856">parseIdent</span><span class="op" id="4890866">(</span><span class="op" id="4890867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890871">params</span><span class="op" id="4890877">,</span>&nbsp;<span class="ident" id="4890879">results</span>&nbsp;<span class="op" id="4890887">:=</span>&nbsp;<span class="ident" id="4890890">p</span><span class="op" id="4890891">.</span><span class="ident" id="4890892">parseSignature</span><span class="op" id="4890906">(</span><span class="ident" id="4890907">scope</span><span class="op" id="4890912">)</span><br>
<span class="lineno">2330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890916">var</span>&nbsp;<span class="ident" id="4890920">body</span>&nbsp;<span class="op" id="4890925">*</span><span class="ident" id="4890926">ast</span><span class="op" id="4890929">.</span><span class="ident" id="4890930">BlockStmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4890941">if</span>&nbsp;<span class="ident" id="4890944">p</span><span class="op" id="4890945">.</span><span class="ident" id="4890946">tok</span>&nbsp;<span class="op" id="4890950">==</span>&nbsp;<span class="ident" id="4890953">token</span><span class="op" id="4890958">.</span><span class="ident" id="4890959">LBRACE</span>&nbsp;<span class="op" id="4890966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4890970">body</span>&nbsp;<span class="op" id="4890975">=</span>&nbsp;<span class="ident" id="4890977">p</span><span class="op" id="4890978">.</span><span class="ident" id="4890979">parseBody</span><span class="op" id="4890988">(</span><span class="ident" id="4890989">scope</span><span class="op" id="4890994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4890997">}</span><br>
<span class="lineno">2335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891000">p</span><span class="op" id="4891001">.</span><span class="ident" id="4891002">expectSemi</span><span class="op" id="4891012">(</span><span class="op" id="4891013">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891017">decl</span>&nbsp;<span class="op" id="4891022">:=</span>&nbsp;<span class="op" id="4891025">&amp;</span><span class="ident" id="4891026">ast</span><span class="op" id="4891029">.</span><span class="ident" id="4891030">FuncDecl</span><span class="op" id="4891038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891042">Doc</span><span class="op" id="4891045">:</span>&nbsp;&nbsp;<span class="ident" id="4891048">doc</span><span class="op" id="4891051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891055">Recv</span><span class="op" id="4891059">:</span>&nbsp;<span class="ident" id="4891061">recv</span><span class="op" id="4891065">,</span><br>
<span class="lineno">2340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891069">Name</span><span class="op" id="4891073">:</span>&nbsp;<span class="ident" id="4891075">ident</span><span class="op" id="4891080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891084">Type</span><span class="op" id="4891088">:</span>&nbsp;<span class="op" id="4891090">&amp;</span><span class="ident" id="4891091">ast</span><span class="op" id="4891094">.</span><span class="ident" id="4891095">FuncType</span><span class="op" id="4891103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891108">Func</span><span class="op" id="4891112">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891117">pos</span><span class="op" id="4891120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891125">Params</span><span class="op" id="4891131">:</span>&nbsp;&nbsp;<span class="ident" id="4891134">params</span><span class="op" id="4891140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891145">Results</span><span class="op" id="4891152">:</span>&nbsp;<span class="ident" id="4891154">results</span><span class="op" id="4891161">,</span><br>
<span class="lineno">2345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4891165">}</span><span class="op" id="4891166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891170">Body</span><span class="op" id="4891174">:</span>&nbsp;<span class="ident" id="4891176">body</span><span class="op" id="4891180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4891183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891186">if</span>&nbsp;<span class="ident" id="4891189">recv</span>&nbsp;<span class="op" id="4891194">==</span>&nbsp;<span class="builtintype" id="4891197">nil</span>&nbsp;<span class="op" id="4891201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891205">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;scope&nbsp;of&nbsp;an&nbsp;identifier&nbsp;denoting&nbsp;a&nbsp;constant,&nbsp;type,</span><br>
<span class="lineno">2350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891273">//&nbsp;variable,&nbsp;or&nbsp;function&nbsp;(but&nbsp;not&nbsp;method)&nbsp;declared&nbsp;at&nbsp;top&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891339">//&nbsp;(outside&nbsp;any&nbsp;function)&nbsp;is&nbsp;the&nbsp;package&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891389">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891394">//&nbsp;init()&nbsp;functions&nbsp;cannot&nbsp;be&nbsp;referred&nbsp;to&nbsp;and&nbsp;there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4891452">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;-&nbsp;don&#39;t&nbsp;put&nbsp;them&nbsp;in&nbsp;the&nbsp;pkgScope</span><br>
<span class="lineno">2355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891507">if</span>&nbsp;<span class="ident" id="4891510">ident</span><span class="op" id="4891515">.</span><span class="ident" id="4891516">Name</span>&nbsp;<span class="op" id="4891521">!=</span>&nbsp;<span class="string" id="4891524">&#34;init&#34;</span>&nbsp;<span class="op" id="4891531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891536">p</span><span class="op" id="4891537">.</span><span class="ident" id="4891538">declare</span><span class="op" id="4891545">(</span><span class="ident" id="4891546">decl</span><span class="op" id="4891550">,</span>&nbsp;<span class="builtintype" id="4891552">nil</span><span class="op" id="4891555">,</span>&nbsp;<span class="ident" id="4891557">p</span><span class="op" id="4891558">.</span><span class="ident" id="4891559">pkgScope</span><span class="op" id="4891567">,</span>&nbsp;<span class="ident" id="4891569">ast</span><span class="op" id="4891572">.</span><span class="ident" id="4891573">Fun</span><span class="op" id="4891576">,</span>&nbsp;<span class="ident" id="4891578">ident</span><span class="op" id="4891583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4891587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4891590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891594">return</span>&nbsp;<span class="ident" id="4891601">decl</span><br>
<span class="lineno"></span><span class="op" id="4891606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4891609">func</span>&nbsp;<span class="op" id="4891614">(</span><span class="ident" id="4891615">p</span>&nbsp;<span class="op" id="4891617">*</span><span class="ident" id="4891618">parser</span><span class="op" id="4891624">)</span>&nbsp;<span class="ident" id="4891626">parseDecl</span><span class="op" id="4891635">(</span><span class="ident" id="4891636">sync</span>&nbsp;<span class="keyword" id="4891641">func</span><span class="op" id="4891645">(</span><span class="op" id="4891646">*</span><span class="ident" id="4891647">parser</span><span class="op" id="4891653">)</span><span class="op" id="4891654">)</span>&nbsp;<span class="ident" id="4891656">ast</span><span class="op" id="4891659">.</span><span class="ident" id="4891660">Decl</span>&nbsp;<span class="op" id="4891665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891668">if</span>&nbsp;<span class="ident" id="4891671">p</span><span class="op" id="4891672">.</span><span class="ident" id="4891673">trace</span>&nbsp;<span class="op" id="4891679">{</span><br>
<span class="lineno">2365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891683">defer</span>&nbsp;<span class="ident" id="4891689">un</span><span class="op" id="4891691">(</span><span class="ident" id="4891692">trace</span><span class="op" id="4891697">(</span><span class="ident" id="4891698">p</span><span class="op" id="4891699">,</span>&nbsp;<span class="string" id="4891701">&#34;Declaration&#34;</span><span class="op" id="4891714">)</span><span class="op" id="4891715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4891718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891722">var</span>&nbsp;<span class="ident" id="4891726">f</span>&nbsp;<span class="ident" id="4891728">parseSpecFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891747">switch</span>&nbsp;<span class="ident" id="4891754">p</span><span class="op" id="4891755">.</span><span class="ident" id="4891756">tok</span>&nbsp;<span class="op" id="4891760">{</span><br>
<span class="lineno">2370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891763">case</span>&nbsp;<span class="ident" id="4891768">token</span><span class="op" id="4891773">.</span><span class="ident" id="4891774">CONST</span><span class="op" id="4891779">,</span>&nbsp;<span class="ident" id="4891781">token</span><span class="op" id="4891786">.</span><span class="ident" id="4891787">VAR</span><span class="op" id="4891790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891794">f</span>&nbsp;<span class="op" id="4891796">=</span>&nbsp;<span class="ident" id="4891798">p</span><span class="op" id="4891799">.</span><span class="ident" id="4891800">parseValueSpec</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891817">case</span>&nbsp;<span class="ident" id="4891822">token</span><span class="op" id="4891827">.</span><span class="ident" id="4891828">TYPE</span><span class="op" id="4891832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891836">f</span>&nbsp;<span class="op" id="4891838">=</span>&nbsp;<span class="ident" id="4891840">p</span><span class="op" id="4891841">.</span><span class="ident" id="4891842">parseTypeSpec</span><br>
<span class="lineno">2375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891858">case</span>&nbsp;<span class="ident" id="4891863">token</span><span class="op" id="4891868">.</span><span class="ident" id="4891869">FUNC</span><span class="op" id="4891873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891877">return</span>&nbsp;<span class="ident" id="4891884">p</span><span class="op" id="4891885">.</span><span class="ident" id="4891886">parseFuncDecl</span><span class="op" id="4891899">(</span><span class="op" id="4891900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891904">default</span><span class="op" id="4891911">:</span><br>
<span class="lineno">2380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891915">pos</span>&nbsp;<span class="op" id="4891919">:=</span>&nbsp;<span class="ident" id="4891922">p</span><span class="op" id="4891923">.</span><span class="ident" id="4891924">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891930">p</span><span class="op" id="4891931">.</span><span class="ident" id="4891932">errorExpected</span><span class="op" id="4891945">(</span><span class="ident" id="4891946">pos</span><span class="op" id="4891949">,</span>&nbsp;<span class="string" id="4891951">&#34;declaration&#34;</span><span class="op" id="4891964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4891968">sync</span><span class="op" id="4891972">(</span><span class="ident" id="4891973">p</span><span class="op" id="4891974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4891978">return</span>&nbsp;<span class="op" id="4891985">&amp;</span><span class="ident" id="4891986">ast</span><span class="op" id="4891989">.</span><span class="ident" id="4891990">BadDecl</span><span class="op" id="4891997">{</span><span class="ident" id="4891998">From</span><span class="op" id="4892002">:</span>&nbsp;<span class="ident" id="4892004">pos</span><span class="op" id="4892007">,</span>&nbsp;<span class="ident" id="4892009">To</span><span class="op" id="4892011">:</span>&nbsp;<span class="ident" id="4892013">p</span><span class="op" id="4892014">.</span><span class="ident" id="4892015">pos</span><span class="op" id="4892018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4892021">}</span><br>
<span class="lineno">2385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892025">return</span>&nbsp;<span class="ident" id="4892032">p</span><span class="op" id="4892033">.</span><span class="ident" id="4892034">parseGenDecl</span><span class="op" id="4892046">(</span><span class="ident" id="4892047">p</span><span class="op" id="4892048">.</span><span class="ident" id="4892049">tok</span><span class="op" id="4892052">,</span>&nbsp;<span class="ident" id="4892054">f</span><span class="op" id="4892055">)</span><br>
<span class="lineno"></span><span class="op" id="4892057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4892060">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">2390</span><span class="comment" id="4892140">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4892157">func</span>&nbsp;<span class="op" id="4892162">(</span><span class="ident" id="4892163">p</span>&nbsp;<span class="op" id="4892165">*</span><span class="ident" id="4892166">parser</span><span class="op" id="4892172">)</span>&nbsp;<span class="ident" id="4892174">parseFile</span><span class="op" id="4892183">(</span><span class="op" id="4892184">)</span>&nbsp;<span class="op" id="4892186">*</span><span class="ident" id="4892187">ast</span><span class="op" id="4892190">.</span><span class="ident" id="4892191">File</span>&nbsp;<span class="op" id="4892196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892199">if</span>&nbsp;<span class="ident" id="4892202">p</span><span class="op" id="4892203">.</span><span class="ident" id="4892204">trace</span>&nbsp;<span class="op" id="4892210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892214">defer</span>&nbsp;<span class="ident" id="4892220">un</span><span class="op" id="4892222">(</span><span class="ident" id="4892223">trace</span><span class="op" id="4892228">(</span><span class="ident" id="4892229">p</span><span class="op" id="4892230">,</span>&nbsp;<span class="string" id="4892232">&#34;File&#34;</span><span class="op" id="4892238">)</span><span class="op" id="4892239">)</span><br>
<span class="lineno">2395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4892242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892246">//&nbsp;Don&#39;t&nbsp;bother&nbsp;parsing&nbsp;the&nbsp;rest&nbsp;if&nbsp;we&nbsp;had&nbsp;errors&nbsp;scanning&nbsp;the&nbsp;first&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892323">//&nbsp;Likely&nbsp;not&nbsp;a&nbsp;Go&nbsp;source&nbsp;file&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892363">if</span>&nbsp;<span class="ident" id="4892366">p</span><span class="op" id="4892367">.</span><span class="ident" id="4892368">errors</span><span class="op" id="4892374">.</span><span class="ident" id="4892375">Len</span><span class="op" id="4892378">(</span><span class="op" id="4892379">)</span>&nbsp;<span class="op" id="4892381">!=</span>&nbsp;<span class="num" id="4892384">0</span>&nbsp;<span class="op" id="4892386">{</span><br>
<span class="lineno">2400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892390">return</span>&nbsp;<span class="builtintype" id="4892397">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4892402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892406">//&nbsp;package&nbsp;clause</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892425">doc</span>&nbsp;<span class="op" id="4892429">:=</span>&nbsp;<span class="ident" id="4892432">p</span><span class="op" id="4892433">.</span><span class="ident" id="4892434">leadComment</span><br>
<span class="lineno">2405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892447">pos</span>&nbsp;<span class="op" id="4892451">:=</span>&nbsp;<span class="ident" id="4892454">p</span><span class="op" id="4892455">.</span><span class="ident" id="4892456">expect</span><span class="op" id="4892462">(</span><span class="ident" id="4892463">token</span><span class="op" id="4892468">.</span><span class="ident" id="4892469">PACKAGE</span><span class="op" id="4892476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892479">//&nbsp;Go&nbsp;spec:&nbsp;The&nbsp;package&nbsp;clause&nbsp;is&nbsp;not&nbsp;a&nbsp;declaration;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892533">//&nbsp;the&nbsp;package&nbsp;name&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;any&nbsp;scope.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892584">ident</span>&nbsp;<span class="op" id="4892590">:=</span>&nbsp;<span class="ident" id="4892593">p</span><span class="op" id="4892594">.</span><span class="ident" id="4892595">parseIdent</span><span class="op" id="4892605">(</span><span class="op" id="4892606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892609">if</span>&nbsp;<span class="ident" id="4892612">ident</span><span class="op" id="4892617">.</span><span class="ident" id="4892618">Name</span>&nbsp;<span class="op" id="4892623">==</span>&nbsp;<span class="string" id="4892626">&#34;_&#34;</span>&nbsp;<span class="op" id="4892630">&amp;&amp;</span>&nbsp;<span class="ident" id="4892633">p</span><span class="op" id="4892634">.</span><span class="ident" id="4892635">mode</span><span class="op" id="4892639">&amp;</span><span class="ident" id="4892640">DeclarationErrors</span>&nbsp;<span class="op" id="4892658">!=</span>&nbsp;<span class="num" id="4892661">0</span>&nbsp;<span class="op" id="4892663">{</span><br>
<span class="lineno">2410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892667">p</span><span class="op" id="4892668">.</span><span class="builtintype" id="4892669">error</span><span class="op" id="4892674">(</span><span class="ident" id="4892675">p</span><span class="op" id="4892676">.</span><span class="ident" id="4892677">pos</span><span class="op" id="4892680">,</span>&nbsp;<span class="string" id="4892682">&#34;invalid&nbsp;package&nbsp;name&nbsp;_&#34;</span><span class="op" id="4892706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4892709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892712">p</span><span class="op" id="4892713">.</span><span class="ident" id="4892714">expectSemi</span><span class="op" id="4892724">(</span><span class="op" id="4892725">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892729">//&nbsp;Don&#39;t&nbsp;bother&nbsp;parsing&nbsp;the&nbsp;rest&nbsp;if&nbsp;we&nbsp;had&nbsp;errors&nbsp;parsing&nbsp;the&nbsp;package&nbsp;clause.</span><br>
<span class="lineno">2415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892808">//&nbsp;Likely&nbsp;not&nbsp;a&nbsp;Go&nbsp;source&nbsp;file&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892848">if</span>&nbsp;<span class="ident" id="4892851">p</span><span class="op" id="4892852">.</span><span class="ident" id="4892853">errors</span><span class="op" id="4892859">.</span><span class="ident" id="4892860">Len</span><span class="op" id="4892863">(</span><span class="op" id="4892864">)</span>&nbsp;<span class="op" id="4892866">!=</span>&nbsp;<span class="num" id="4892869">0</span>&nbsp;<span class="op" id="4892871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892875">return</span>&nbsp;<span class="builtintype" id="4892882">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4892887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">2420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892891">p</span><span class="op" id="4892892">.</span><span class="ident" id="4892893">openScope</span><span class="op" id="4892902">(</span><span class="op" id="4892903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4892906">p</span><span class="op" id="4892907">.</span><span class="ident" id="4892908">pkgScope</span>&nbsp;<span class="op" id="4892917">=</span>&nbsp;<span class="ident" id="4892919">p</span><span class="op" id="4892920">.</span><span class="ident" id="4892921">topScope</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892931">var</span>&nbsp;<span class="ident" id="4892935">decls</span>&nbsp;<span class="op" id="4892941">[</span><span class="op" id="4892942">]</span><span class="ident" id="4892943">ast</span><span class="op" id="4892946">.</span><span class="ident" id="4892947">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4892953">if</span>&nbsp;<span class="ident" id="4892956">p</span><span class="op" id="4892957">.</span><span class="ident" id="4892958">mode</span><span class="op" id="4892962">&amp;</span><span class="ident" id="4892963">PackageClauseOnly</span>&nbsp;<span class="op" id="4892981">==</span>&nbsp;<span class="num" id="4892984">0</span>&nbsp;<span class="op" id="4892986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4892990">//&nbsp;import&nbsp;decls</span><br>
<span class="lineno">2425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893008">for</span>&nbsp;<span class="ident" id="4893012">p</span><span class="op" id="4893013">.</span><span class="ident" id="4893014">tok</span>&nbsp;<span class="op" id="4893018">==</span>&nbsp;<span class="ident" id="4893021">token</span><span class="op" id="4893026">.</span><span class="ident" id="4893027">IMPORT</span>&nbsp;<span class="op" id="4893034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893039">decls</span>&nbsp;<span class="op" id="4893045">=</span>&nbsp;<span class="builtinfunc" id="4893047">append</span><span class="op" id="4893053">(</span><span class="ident" id="4893054">decls</span><span class="op" id="4893059">,</span>&nbsp;<span class="ident" id="4893061">p</span><span class="op" id="4893062">.</span><span class="ident" id="4893063">parseGenDecl</span><span class="op" id="4893075">(</span><span class="ident" id="4893076">token</span><span class="op" id="4893081">.</span><span class="ident" id="4893082">IMPORT</span><span class="op" id="4893088">,</span>&nbsp;<span class="ident" id="4893090">p</span><span class="op" id="4893091">.</span><span class="ident" id="4893092">parseImportSpec</span><span class="op" id="4893107">)</span><span class="op" id="4893108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893117">if</span>&nbsp;<span class="ident" id="4893120">p</span><span class="op" id="4893121">.</span><span class="ident" id="4893122">mode</span><span class="op" id="4893126">&amp;</span><span class="ident" id="4893127">ImportsOnly</span>&nbsp;<span class="op" id="4893139">==</span>&nbsp;<span class="num" id="4893142">0</span>&nbsp;<span class="op" id="4893144">{</span><br>
<span class="lineno">2430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4893149">//&nbsp;rest&nbsp;of&nbsp;package&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893176">for</span>&nbsp;<span class="ident" id="4893180">p</span><span class="op" id="4893181">.</span><span class="ident" id="4893182">tok</span>&nbsp;<span class="op" id="4893186">!=</span>&nbsp;<span class="ident" id="4893189">token</span><span class="op" id="4893194">.</span><span class="ident" id="4893195">EOF</span>&nbsp;<span class="op" id="4893199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893205">decls</span>&nbsp;<span class="op" id="4893211">=</span>&nbsp;<span class="builtinfunc" id="4893213">append</span><span class="op" id="4893219">(</span><span class="ident" id="4893220">decls</span><span class="op" id="4893225">,</span>&nbsp;<span class="ident" id="4893227">p</span><span class="op" id="4893228">.</span><span class="ident" id="4893229">parseDecl</span><span class="op" id="4893238">(</span><span class="ident" id="4893239">syncDecl</span><span class="op" id="4893247">)</span><span class="op" id="4893248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893257">}</span><br>
<span class="lineno">2435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893263">p</span><span class="op" id="4893264">.</span><span class="ident" id="4893265">closeScope</span><span class="op" id="4893275">(</span><span class="op" id="4893276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893279">assert</span><span class="op" id="4893285">(</span><span class="ident" id="4893286">p</span><span class="op" id="4893287">.</span><span class="ident" id="4893288">topScope</span>&nbsp;<span class="op" id="4893297">==</span>&nbsp;<span class="builtintype" id="4893300">nil</span><span class="op" id="4893303">,</span>&nbsp;<span class="string" id="4893305">&#34;unbalanced&nbsp;scopes&#34;</span><span class="op" id="4893324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893327">assert</span><span class="op" id="4893333">(</span><span class="ident" id="4893334">p</span><span class="op" id="4893335">.</span><span class="ident" id="4893336">labelScope</span>&nbsp;<span class="op" id="4893347">==</span>&nbsp;<span class="builtintype" id="4893350">nil</span><span class="op" id="4893353">,</span>&nbsp;<span class="string" id="4893355">&#34;unbalanced&nbsp;label&nbsp;scopes&#34;</span><span class="op" id="4893380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">2440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4893384">//&nbsp;resolve&nbsp;global&nbsp;identifiers&nbsp;within&nbsp;the&nbsp;same&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893436">i</span>&nbsp;<span class="op" id="4893438">:=</span>&nbsp;<span class="num" id="4893441">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893444">for</span>&nbsp;<span class="ident" id="4893448">_</span><span class="op" id="4893449">,</span>&nbsp;<span class="ident" id="4893451">ident</span>&nbsp;<span class="op" id="4893457">:=</span>&nbsp;<span class="keyword" id="4893460">range</span>&nbsp;<span class="ident" id="4893466">p</span><span class="op" id="4893467">.</span><span class="ident" id="4893468">unresolved</span>&nbsp;<span class="op" id="4893479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4893483">//&nbsp;i&nbsp;&lt;=&nbsp;index&nbsp;for&nbsp;current&nbsp;ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893517">assert</span><span class="op" id="4893523">(</span><span class="ident" id="4893524">ident</span><span class="op" id="4893529">.</span><span class="ident" id="4893530">Obj</span>&nbsp;<span class="op" id="4893534">==</span>&nbsp;<span class="ident" id="4893537">unresolved</span><span class="op" id="4893547">,</span>&nbsp;<span class="string" id="4893549">&#34;object&nbsp;already&nbsp;resolved&#34;</span><span class="op" id="4893574">)</span><br>
<span class="lineno">2445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893578">ident</span><span class="op" id="4893583">.</span><span class="ident" id="4893584">Obj</span>&nbsp;<span class="op" id="4893588">=</span>&nbsp;<span class="ident" id="4893590">p</span><span class="op" id="4893591">.</span><span class="ident" id="4893592">pkgScope</span><span class="op" id="4893600">.</span><span class="ident" id="4893601">Lookup</span><span class="op" id="4893607">(</span><span class="ident" id="4893608">ident</span><span class="op" id="4893613">.</span><span class="ident" id="4893614">Name</span><span class="op" id="4893618">)</span>&nbsp;<span class="comment" id="4893620">//&nbsp;also&nbsp;removes&nbsp;unresolved&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893658">if</span>&nbsp;<span class="ident" id="4893661">ident</span><span class="op" id="4893666">.</span><span class="ident" id="4893667">Obj</span>&nbsp;<span class="op" id="4893671">==</span>&nbsp;<span class="builtintype" id="4893674">nil</span>&nbsp;<span class="op" id="4893678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893683">p</span><span class="op" id="4893684">.</span><span class="ident" id="4893685">unresolved</span><span class="op" id="4893695">[</span><span class="ident" id="4893696">i</span><span class="op" id="4893697">]</span>&nbsp;<span class="op" id="4893699">=</span>&nbsp;<span class="ident" id="4893701">ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893710">i</span><span class="op" id="4893711">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893716">}</span><br>
<span class="lineno">2450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4893723">return</span>&nbsp;<span class="op" id="4893730">&amp;</span><span class="ident" id="4893731">ast</span><span class="op" id="4893734">.</span><span class="ident" id="4893735">File</span><span class="op" id="4893739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893743">Doc</span><span class="op" id="4893746">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893755">doc</span><span class="op" id="4893758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893762">Package</span><span class="op" id="4893769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893774">pos</span><span class="op" id="4893777">,</span><br>
<span class="lineno">2455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893781">Name</span><span class="op" id="4893785">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893793">ident</span><span class="op" id="4893798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893802">Decls</span><span class="op" id="4893807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893814">decls</span><span class="op" id="4893819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893823">Scope</span><span class="op" id="4893828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893835">p</span><span class="op" id="4893836">.</span><span class="ident" id="4893837">pkgScope</span><span class="op" id="4893845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893849">Imports</span><span class="op" id="4893856">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893861">p</span><span class="op" id="4893862">.</span><span class="ident" id="4893863">imports</span><span class="op" id="4893870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893874">Unresolved</span><span class="op" id="4893884">:</span>&nbsp;<span class="ident" id="4893886">p</span><span class="op" id="4893887">.</span><span class="ident" id="4893888">unresolved</span><span class="op" id="4893898">[</span><span class="num" id="4893899">0</span><span class="op" id="4893900">:</span><span class="ident" id="4893901">i</span><span class="op" id="4893902">]</span><span class="op" id="4893903">,</span><br>
<span class="lineno">2460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4893907">Comments</span><span class="op" id="4893915">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4893919">p</span><span class="op" id="4893920">.</span><span class="ident" id="4893921">comments</span><span class="op" id="4893929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4893932">}</span><br>
<span class="lineno"></span><span class="op" id="4893934">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
