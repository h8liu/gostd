<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html" class="current">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3216200">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3216255">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3216309">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3216360">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="3217263">package</span>&nbsp;<span class="ident" id="3217271">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3217276">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="3217290">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3217327">import</span>&nbsp;<span class="op" id="3217334">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3217337">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3217347">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3217353">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3217359">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3217370">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="3217377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3217380">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3217428">type</span>&nbsp;<span class="ident" id="3217433">Addr</span>&nbsp;<span class="keyword" id="3217438">interface</span>&nbsp;<span class="op" id="3217448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217451">Network</span><span class="op" id="3217458">(</span><span class="op" id="3217459">)</span>&nbsp;<span class="builtintype" id="3217461">string</span>&nbsp;<span class="comment" id="3217468">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217492">String</span><span class="op" id="3217498">(</span><span class="op" id="3217499">)</span>&nbsp;<span class="builtintype" id="3217501">string</span>&nbsp;&nbsp;<span class="comment" id="3217509">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="3217535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3217538">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3217595">//</span><br>
<span class="lineno">60</span><span class="comment" id="3217598">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3217666">type</span>&nbsp;<span class="ident" id="3217671">Conn</span>&nbsp;<span class="keyword" id="3217676">interface</span>&nbsp;<span class="op" id="3217686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217689">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217730">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217805">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217872">Read</span><span class="op" id="3217876">(</span><span class="ident" id="3217877">b</span>&nbsp;<span class="op" id="3217879">[</span><span class="op" id="3217880">]</span><span class="builtintype" id="3217881">byte</span><span class="op" id="3217885">)</span>&nbsp;<span class="op" id="3217887">(</span><span class="ident" id="3217888">n</span>&nbsp;<span class="builtintype" id="3217890">int</span><span class="op" id="3217893">,</span>&nbsp;<span class="ident" id="3217895">err</span>&nbsp;<span class="builtintype" id="3217899">error</span><span class="op" id="3217904">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217908">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217949">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218025">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218093">Write</span><span class="op" id="3218098">(</span><span class="ident" id="3218099">b</span>&nbsp;<span class="op" id="3218101">[</span><span class="op" id="3218102">]</span><span class="builtintype" id="3218103">byte</span><span class="op" id="3218107">)</span>&nbsp;<span class="op" id="3218109">(</span><span class="ident" id="3218110">n</span>&nbsp;<span class="builtintype" id="3218112">int</span><span class="op" id="3218115">,</span>&nbsp;<span class="ident" id="3218117">err</span>&nbsp;<span class="builtintype" id="3218121">error</span><span class="op" id="3218126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218130">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218163">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218241">Close</span><span class="op" id="3218246">(</span><span class="op" id="3218247">)</span>&nbsp;<span class="builtintype" id="3218249">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218257">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218306">LocalAddr</span><span class="op" id="3218315">(</span><span class="op" id="3218316">)</span>&nbsp;<span class="ident" id="3218318">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218325">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218376">RemoteAddr</span><span class="op" id="3218386">(</span><span class="op" id="3218387">)</span>&nbsp;<span class="ident" id="3218389">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218396">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218457">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218515">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218557">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218561">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218623">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218675">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218738">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218791">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218795">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218858">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218913">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218917">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218980">SetDeadline</span><span class="op" id="3218991">(</span><span class="ident" id="3218992">t</span>&nbsp;<span class="ident" id="3218994">time</span><span class="op" id="3218998">.</span><span class="ident" id="3218999">Time</span><span class="op" id="3219003">)</span>&nbsp;<span class="builtintype" id="3219005">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219013">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219074">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219127">SetReadDeadline</span><span class="op" id="3219142">(</span><span class="ident" id="3219143">t</span>&nbsp;<span class="ident" id="3219145">time</span><span class="op" id="3219149">.</span><span class="ident" id="3219150">Time</span><span class="op" id="3219154">)</span>&nbsp;<span class="builtintype" id="3219156">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219164">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219227">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219293">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219340">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219394">SetWriteDeadline</span><span class="op" id="3219410">(</span><span class="ident" id="3219411">t</span>&nbsp;<span class="ident" id="3219413">time</span><span class="op" id="3219417">.</span><span class="ident" id="3219418">Time</span><span class="op" id="3219422">)</span>&nbsp;<span class="builtintype" id="3219424">error</span><br>
<span class="lineno"></span><span class="op" id="3219430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219433">type</span>&nbsp;<span class="ident" id="3219438">conn</span>&nbsp;<span class="keyword" id="3219443">struct</span>&nbsp;<span class="op" id="3219450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219453">fd</span>&nbsp;<span class="op" id="3219456">*</span><span class="ident" id="3219457">netFD</span><br>
<span class="lineno">110</span><span class="op" id="3219463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219466">func</span>&nbsp;<span class="op" id="3219471">(</span><span class="ident" id="3219472">c</span>&nbsp;<span class="op" id="3219474">*</span><span class="ident" id="3219475">conn</span><span class="op" id="3219479">)</span>&nbsp;<span class="ident" id="3219481">ok</span><span class="op" id="3219483">(</span><span class="op" id="3219484">)</span>&nbsp;<span class="builtintype" id="3219486">bool</span>&nbsp;<span class="op" id="3219491">{</span>&nbsp;<span class="keyword" id="3219493">return</span>&nbsp;<span class="ident" id="3219500">c</span>&nbsp;<span class="op" id="3219502">!=</span>&nbsp;<span class="ident" id="3219505">nil</span>&nbsp;<span class="op" id="3219509">&amp;&amp;</span>&nbsp;<span class="ident" id="3219512">c</span><span class="op" id="3219513">.</span><span class="ident" id="3219514">fd</span>&nbsp;<span class="op" id="3219517">!=</span>&nbsp;<span class="ident" id="3219520">nil</span>&nbsp;<span class="op" id="3219524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3219527">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3219569">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3219610">func</span>&nbsp;<span class="op" id="3219615">(</span><span class="ident" id="3219616">c</span>&nbsp;<span class="op" id="3219618">*</span><span class="ident" id="3219619">conn</span><span class="op" id="3219623">)</span>&nbsp;<span class="ident" id="3219625">Read</span><span class="op" id="3219629">(</span><span class="ident" id="3219630">b</span>&nbsp;<span class="op" id="3219632">[</span><span class="op" id="3219633">]</span><span class="builtintype" id="3219634">byte</span><span class="op" id="3219638">)</span>&nbsp;<span class="op" id="3219640">(</span><span class="builtintype" id="3219641">int</span><span class="op" id="3219644">,</span>&nbsp;<span class="builtintype" id="3219646">error</span><span class="op" id="3219651">)</span>&nbsp;<span class="op" id="3219653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219656">if</span>&nbsp;<span class="op" id="3219659">!</span><span class="ident" id="3219660">c</span><span class="op" id="3219661">.</span><span class="ident" id="3219662">ok</span><span class="op" id="3219664">(</span><span class="op" id="3219665">)</span>&nbsp;<span class="op" id="3219667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219671">return</span>&nbsp;<span class="num" id="3219678">0</span><span class="op" id="3219679">,</span>&nbsp;<span class="ident" id="3219681">syscall</span><span class="op" id="3219688">.</span><span class="ident" id="3219689">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219700">return</span>&nbsp;<span class="ident" id="3219707">c</span><span class="op" id="3219708">.</span><span class="ident" id="3219709">fd</span><span class="op" id="3219711">.</span><span class="ident" id="3219712">Read</span><span class="op" id="3219716">(</span><span class="ident" id="3219717">b</span><span class="op" id="3219718">)</span><br>
<span class="lineno"></span><span class="op" id="3219720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3219723">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="3219766">func</span>&nbsp;<span class="op" id="3219771">(</span><span class="ident" id="3219772">c</span>&nbsp;<span class="op" id="3219774">*</span><span class="ident" id="3219775">conn</span><span class="op" id="3219779">)</span>&nbsp;<span class="ident" id="3219781">Write</span><span class="op" id="3219786">(</span><span class="ident" id="3219787">b</span>&nbsp;<span class="op" id="3219789">[</span><span class="op" id="3219790">]</span><span class="builtintype" id="3219791">byte</span><span class="op" id="3219795">)</span>&nbsp;<span class="op" id="3219797">(</span><span class="builtintype" id="3219798">int</span><span class="op" id="3219801">,</span>&nbsp;<span class="builtintype" id="3219803">error</span><span class="op" id="3219808">)</span>&nbsp;<span class="op" id="3219810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219813">if</span>&nbsp;<span class="op" id="3219816">!</span><span class="ident" id="3219817">c</span><span class="op" id="3219818">.</span><span class="ident" id="3219819">ok</span><span class="op" id="3219821">(</span><span class="op" id="3219822">)</span>&nbsp;<span class="op" id="3219824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219828">return</span>&nbsp;<span class="num" id="3219835">0</span><span class="op" id="3219836">,</span>&nbsp;<span class="ident" id="3219838">syscall</span><span class="op" id="3219845">.</span><span class="ident" id="3219846">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219857">return</span>&nbsp;<span class="ident" id="3219864">c</span><span class="op" id="3219865">.</span><span class="ident" id="3219866">fd</span><span class="op" id="3219868">.</span><span class="ident" id="3219869">Write</span><span class="op" id="3219874">(</span><span class="ident" id="3219875">b</span><span class="op" id="3219876">)</span><br>
<span class="lineno">130</span><span class="op" id="3219878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3219881">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3219913">func</span>&nbsp;<span class="op" id="3219918">(</span><span class="ident" id="3219919">c</span>&nbsp;<span class="op" id="3219921">*</span><span class="ident" id="3219922">conn</span><span class="op" id="3219926">)</span>&nbsp;<span class="ident" id="3219928">Close</span><span class="op" id="3219933">(</span><span class="op" id="3219934">)</span>&nbsp;<span class="builtintype" id="3219936">error</span>&nbsp;<span class="op" id="3219942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219945">if</span>&nbsp;<span class="op" id="3219948">!</span><span class="ident" id="3219949">c</span><span class="op" id="3219950">.</span><span class="ident" id="3219951">ok</span><span class="op" id="3219953">(</span><span class="op" id="3219954">)</span>&nbsp;<span class="op" id="3219956">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219960">return</span>&nbsp;<span class="ident" id="3219967">syscall</span><span class="op" id="3219974">.</span><span class="ident" id="3219975">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219986">return</span>&nbsp;<span class="ident" id="3219993">c</span><span class="op" id="3219994">.</span><span class="ident" id="3219995">fd</span><span class="op" id="3219997">.</span><span class="ident" id="3219998">Close</span><span class="op" id="3220003">(</span><span class="op" id="3220004">)</span><br>
<span class="lineno"></span><span class="op" id="3220006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3220009">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3220057">func</span>&nbsp;<span class="op" id="3220062">(</span><span class="ident" id="3220063">c</span>&nbsp;<span class="op" id="3220065">*</span><span class="ident" id="3220066">conn</span><span class="op" id="3220070">)</span>&nbsp;<span class="ident" id="3220072">LocalAddr</span><span class="op" id="3220081">(</span><span class="op" id="3220082">)</span>&nbsp;<span class="ident" id="3220084">Addr</span>&nbsp;<span class="op" id="3220089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220092">if</span>&nbsp;<span class="op" id="3220095">!</span><span class="ident" id="3220096">c</span><span class="op" id="3220097">.</span><span class="ident" id="3220098">ok</span><span class="op" id="3220100">(</span><span class="op" id="3220101">)</span>&nbsp;<span class="op" id="3220103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220107">return</span>&nbsp;<span class="ident" id="3220114">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220119">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220122">return</span>&nbsp;<span class="ident" id="3220129">c</span><span class="op" id="3220130">.</span><span class="ident" id="3220131">fd</span><span class="op" id="3220133">.</span><span class="ident" id="3220134">laddr</span><br>
<span class="lineno"></span><span class="op" id="3220140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3220143">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3220193">func</span>&nbsp;<span class="op" id="3220198">(</span><span class="ident" id="3220199">c</span>&nbsp;<span class="op" id="3220201">*</span><span class="ident" id="3220202">conn</span><span class="op" id="3220206">)</span>&nbsp;<span class="ident" id="3220208">RemoteAddr</span><span class="op" id="3220218">(</span><span class="op" id="3220219">)</span>&nbsp;<span class="ident" id="3220221">Addr</span>&nbsp;<span class="op" id="3220226">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220229">if</span>&nbsp;<span class="op" id="3220232">!</span><span class="ident" id="3220233">c</span><span class="op" id="3220234">.</span><span class="ident" id="3220235">ok</span><span class="op" id="3220237">(</span><span class="op" id="3220238">)</span>&nbsp;<span class="op" id="3220240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220244">return</span>&nbsp;<span class="ident" id="3220251">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220259">return</span>&nbsp;<span class="ident" id="3220266">c</span><span class="op" id="3220267">.</span><span class="ident" id="3220268">fd</span><span class="op" id="3220270">.</span><span class="ident" id="3220271">raddr</span><br>
<span class="lineno"></span><span class="op" id="3220277">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3220280">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3220335">func</span>&nbsp;<span class="op" id="3220340">(</span><span class="ident" id="3220341">c</span>&nbsp;<span class="op" id="3220343">*</span><span class="ident" id="3220344">conn</span><span class="op" id="3220348">)</span>&nbsp;<span class="ident" id="3220350">SetDeadline</span><span class="op" id="3220361">(</span><span class="ident" id="3220362">t</span>&nbsp;<span class="ident" id="3220364">time</span><span class="op" id="3220368">.</span><span class="ident" id="3220369">Time</span><span class="op" id="3220373">)</span>&nbsp;<span class="builtintype" id="3220375">error</span>&nbsp;<span class="op" id="3220381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220384">if</span>&nbsp;<span class="op" id="3220387">!</span><span class="ident" id="3220388">c</span><span class="op" id="3220389">.</span><span class="ident" id="3220390">ok</span><span class="op" id="3220392">(</span><span class="op" id="3220393">)</span>&nbsp;<span class="op" id="3220395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220399">return</span>&nbsp;<span class="ident" id="3220406">syscall</span><span class="op" id="3220413">.</span><span class="ident" id="3220414">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220425">return</span>&nbsp;<span class="ident" id="3220432">c</span><span class="op" id="3220433">.</span><span class="ident" id="3220434">fd</span><span class="op" id="3220436">.</span><span class="ident" id="3220437">setDeadline</span><span class="op" id="3220448">(</span><span class="ident" id="3220449">t</span><span class="op" id="3220450">)</span><br>
<span class="lineno"></span><span class="op" id="3220452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3220455">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="3220518">func</span>&nbsp;<span class="op" id="3220523">(</span><span class="ident" id="3220524">c</span>&nbsp;<span class="op" id="3220526">*</span><span class="ident" id="3220527">conn</span><span class="op" id="3220531">)</span>&nbsp;<span class="ident" id="3220533">SetReadDeadline</span><span class="op" id="3220548">(</span><span class="ident" id="3220549">t</span>&nbsp;<span class="ident" id="3220551">time</span><span class="op" id="3220555">.</span><span class="ident" id="3220556">Time</span><span class="op" id="3220560">)</span>&nbsp;<span class="builtintype" id="3220562">error</span>&nbsp;<span class="op" id="3220568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220571">if</span>&nbsp;<span class="op" id="3220574">!</span><span class="ident" id="3220575">c</span><span class="op" id="3220576">.</span><span class="ident" id="3220577">ok</span><span class="op" id="3220579">(</span><span class="op" id="3220580">)</span>&nbsp;<span class="op" id="3220582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220586">return</span>&nbsp;<span class="ident" id="3220593">syscall</span><span class="op" id="3220600">.</span><span class="ident" id="3220601">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220612">return</span>&nbsp;<span class="ident" id="3220619">c</span><span class="op" id="3220620">.</span><span class="ident" id="3220621">fd</span><span class="op" id="3220623">.</span><span class="ident" id="3220624">setReadDeadline</span><span class="op" id="3220639">(</span><span class="ident" id="3220640">t</span><span class="op" id="3220641">)</span><br>
<span class="lineno">170</span><span class="op" id="3220643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3220646">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="3220711">func</span>&nbsp;<span class="op" id="3220716">(</span><span class="ident" id="3220717">c</span>&nbsp;<span class="op" id="3220719">*</span><span class="ident" id="3220720">conn</span><span class="op" id="3220724">)</span>&nbsp;<span class="ident" id="3220726">SetWriteDeadline</span><span class="op" id="3220742">(</span><span class="ident" id="3220743">t</span>&nbsp;<span class="ident" id="3220745">time</span><span class="op" id="3220749">.</span><span class="ident" id="3220750">Time</span><span class="op" id="3220754">)</span>&nbsp;<span class="builtintype" id="3220756">error</span>&nbsp;<span class="op" id="3220762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220765">if</span>&nbsp;<span class="op" id="3220768">!</span><span class="ident" id="3220769">c</span><span class="op" id="3220770">.</span><span class="ident" id="3220771">ok</span><span class="op" id="3220773">(</span><span class="op" id="3220774">)</span>&nbsp;<span class="op" id="3220776">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220780">return</span>&nbsp;<span class="ident" id="3220787">syscall</span><span class="op" id="3220794">.</span><span class="ident" id="3220795">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220806">return</span>&nbsp;<span class="ident" id="3220813">c</span><span class="op" id="3220814">.</span><span class="ident" id="3220815">fd</span><span class="op" id="3220817">.</span><span class="ident" id="3220818">setWriteDeadline</span><span class="op" id="3220834">(</span><span class="ident" id="3220835">t</span><span class="op" id="3220836">)</span><br>
<span class="lineno"></span><span class="op" id="3220838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3220841">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3220898">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3220948">func</span>&nbsp;<span class="op" id="3220953">(</span><span class="ident" id="3220954">c</span>&nbsp;<span class="op" id="3220956">*</span><span class="ident" id="3220957">conn</span><span class="op" id="3220961">)</span>&nbsp;<span class="ident" id="3220963">SetReadBuffer</span><span class="op" id="3220976">(</span><span class="ident" id="3220977">bytes</span>&nbsp;<span class="builtintype" id="3220983">int</span><span class="op" id="3220986">)</span>&nbsp;<span class="builtintype" id="3220988">error</span>&nbsp;<span class="op" id="3220994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220997">if</span>&nbsp;<span class="op" id="3221000">!</span><span class="ident" id="3221001">c</span><span class="op" id="3221002">.</span><span class="ident" id="3221003">ok</span><span class="op" id="3221005">(</span><span class="op" id="3221006">)</span>&nbsp;<span class="op" id="3221008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221012">return</span>&nbsp;<span class="ident" id="3221019">syscall</span><span class="op" id="3221026">.</span><span class="ident" id="3221027">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221038">return</span>&nbsp;<span class="ident" id="3221045">setReadBuffer</span><span class="op" id="3221058">(</span><span class="ident" id="3221059">c</span><span class="op" id="3221060">.</span><span class="ident" id="3221061">fd</span><span class="op" id="3221063">,</span>&nbsp;<span class="ident" id="3221065">bytes</span><span class="op" id="3221070">)</span><br>
<span class="lineno"></span><span class="op" id="3221072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3221075">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="3221133">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3221184">func</span>&nbsp;<span class="op" id="3221189">(</span><span class="ident" id="3221190">c</span>&nbsp;<span class="op" id="3221192">*</span><span class="ident" id="3221193">conn</span><span class="op" id="3221197">)</span>&nbsp;<span class="ident" id="3221199">SetWriteBuffer</span><span class="op" id="3221213">(</span><span class="ident" id="3221214">bytes</span>&nbsp;<span class="builtintype" id="3221220">int</span><span class="op" id="3221223">)</span>&nbsp;<span class="builtintype" id="3221225">error</span>&nbsp;<span class="op" id="3221231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221234">if</span>&nbsp;<span class="op" id="3221237">!</span><span class="ident" id="3221238">c</span><span class="op" id="3221239">.</span><span class="ident" id="3221240">ok</span><span class="op" id="3221242">(</span><span class="op" id="3221243">)</span>&nbsp;<span class="op" id="3221245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221249">return</span>&nbsp;<span class="ident" id="3221256">syscall</span><span class="op" id="3221263">.</span><span class="ident" id="3221264">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221272">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221275">return</span>&nbsp;<span class="ident" id="3221282">setWriteBuffer</span><span class="op" id="3221296">(</span><span class="ident" id="3221297">c</span><span class="op" id="3221298">.</span><span class="ident" id="3221299">fd</span><span class="op" id="3221301">,</span>&nbsp;<span class="ident" id="3221303">bytes</span><span class="op" id="3221308">)</span><br>
<span class="lineno"></span><span class="op" id="3221310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3221313">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="3221386">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="3221449">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="3221514">//</span><br>
<span class="lineno"></span><span class="comment" id="3221517">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="3221595">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="3221667">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="3221710">func</span>&nbsp;<span class="op" id="3221715">(</span><span class="ident" id="3221716">c</span>&nbsp;<span class="op" id="3221718">*</span><span class="ident" id="3221719">conn</span><span class="op" id="3221723">)</span>&nbsp;<span class="ident" id="3221725">File</span><span class="op" id="3221729">(</span><span class="op" id="3221730">)</span>&nbsp;<span class="op" id="3221732">(</span><span class="ident" id="3221733">f</span>&nbsp;<span class="op" id="3221735">*</span><span class="ident" id="3221736">os</span><span class="op" id="3221738">.</span><span class="ident" id="3221739">File</span><span class="op" id="3221743">,</span>&nbsp;<span class="ident" id="3221745">err</span>&nbsp;<span class="builtintype" id="3221749">error</span><span class="op" id="3221754">)</span>&nbsp;<span class="op" id="3221756">{</span>&nbsp;<span class="keyword" id="3221758">return</span>&nbsp;<span class="ident" id="3221765">c</span><span class="op" id="3221766">.</span><span class="ident" id="3221767">fd</span><span class="op" id="3221769">.</span><span class="ident" id="3221770">dup</span><span class="op" id="3221773">(</span><span class="op" id="3221774">)</span>&nbsp;<span class="op" id="3221776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3221779">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3221819">type</span>&nbsp;<span class="ident" id="3221824">Error</span>&nbsp;<span class="keyword" id="3221830">interface</span>&nbsp;<span class="op" id="3221840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3221843">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221850">Timeout</span><span class="op" id="3221857">(</span><span class="op" id="3221858">)</span>&nbsp;<span class="builtintype" id="3221860">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3221867">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221895">Temporary</span><span class="op" id="3221904">(</span><span class="op" id="3221905">)</span>&nbsp;<span class="builtintype" id="3221907">bool</span>&nbsp;<span class="comment" id="3221912">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="3221939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3221942">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="3222005">//</span><br>
<span class="lineno"></span><span class="comment" id="3222008">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="3222082">type</span>&nbsp;<span class="ident" id="3222087">PacketConn</span>&nbsp;<span class="keyword" id="3222098">interface</span>&nbsp;<span class="op" id="3222108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222111">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222160">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222218">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222270">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222293">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222341">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222403">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222444">ReadFrom</span><span class="op" id="3222452">(</span><span class="ident" id="3222453">b</span>&nbsp;<span class="op" id="3222455">[</span><span class="op" id="3222456">]</span><span class="builtintype" id="3222457">byte</span><span class="op" id="3222461">)</span>&nbsp;<span class="op" id="3222463">(</span><span class="ident" id="3222464">n</span>&nbsp;<span class="builtintype" id="3222466">int</span><span class="op" id="3222469">,</span>&nbsp;<span class="ident" id="3222471">addr</span>&nbsp;<span class="ident" id="3222476">Addr</span><span class="op" id="3222480">,</span>&nbsp;<span class="ident" id="3222482">err</span>&nbsp;<span class="builtintype" id="3222486">error</span><span class="op" id="3222491">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222495">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222547">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222594">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222656">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222698">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222759">WriteTo</span><span class="op" id="3222766">(</span><span class="ident" id="3222767">b</span>&nbsp;<span class="op" id="3222769">[</span><span class="op" id="3222770">]</span><span class="builtintype" id="3222771">byte</span><span class="op" id="3222775">,</span>&nbsp;<span class="ident" id="3222777">addr</span>&nbsp;<span class="ident" id="3222782">Addr</span><span class="op" id="3222786">)</span>&nbsp;<span class="op" id="3222788">(</span><span class="ident" id="3222789">n</span>&nbsp;<span class="builtintype" id="3222791">int</span><span class="op" id="3222794">,</span>&nbsp;<span class="ident" id="3222796">err</span>&nbsp;<span class="builtintype" id="3222800">error</span><span class="op" id="3222805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222809">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222842">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222926">Close</span><span class="op" id="3222931">(</span><span class="op" id="3222932">)</span>&nbsp;<span class="builtintype" id="3222934">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222942">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222991">LocalAddr</span><span class="op" id="3223000">(</span><span class="op" id="3223001">)</span>&nbsp;<span class="ident" id="3223003">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223010">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223071">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223096">SetDeadline</span><span class="op" id="3223107">(</span><span class="ident" id="3223108">t</span>&nbsp;<span class="ident" id="3223110">time</span><span class="op" id="3223114">.</span><span class="ident" id="3223115">Time</span><span class="op" id="3223119">)</span>&nbsp;<span class="builtintype" id="3223121">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223129">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223190">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223252">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223294">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223347">SetReadDeadline</span><span class="op" id="3223362">(</span><span class="ident" id="3223363">t</span>&nbsp;<span class="ident" id="3223365">time</span><span class="op" id="3223369">.</span><span class="ident" id="3223370">Time</span><span class="op" id="3223374">)</span>&nbsp;<span class="builtintype" id="3223376">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223384">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223447">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223510">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223552">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223606">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223672">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223719">SetWriteDeadline</span><span class="op" id="3223735">(</span><span class="ident" id="3223736">t</span>&nbsp;<span class="ident" id="3223738">time</span><span class="op" id="3223742">.</span><span class="ident" id="3223743">Time</span><span class="op" id="3223747">)</span>&nbsp;<span class="builtintype" id="3223749">error</span><br>
<span class="lineno"></span><span class="op" id="3223755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3223758">var</span>&nbsp;<span class="ident" id="3223762">listenerBacklog</span>&nbsp;<span class="op" id="3223778">=</span>&nbsp;<span class="ident" id="3223780">maxListenerBacklog</span><span class="op" id="3223798">(</span><span class="op" id="3223799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3223802">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="3223877">//</span><br>
<span class="lineno"></span><span class="comment" id="3223880">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="3223952">type</span>&nbsp;<span class="ident" id="3223957">Listener</span>&nbsp;<span class="keyword" id="3223966">interface</span>&nbsp;<span class="op" id="3223976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223979">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224049">Accept</span><span class="op" id="3224055">(</span><span class="op" id="3224056">)</span>&nbsp;<span class="op" id="3224058">(</span><span class="ident" id="3224059">c</span>&nbsp;<span class="ident" id="3224061">Conn</span><span class="op" id="3224065">,</span>&nbsp;<span class="ident" id="3224067">err</span>&nbsp;<span class="builtintype" id="3224071">error</span><span class="op" id="3224076">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224080">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224111">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224182">Close</span><span class="op" id="3224187">(</span><span class="op" id="3224188">)</span>&nbsp;<span class="builtintype" id="3224190">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224198">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224247">Addr</span><span class="op" id="3224251">(</span><span class="op" id="3224252">)</span>&nbsp;<span class="ident" id="3224254">Addr</span><br>
<span class="lineno">275</span><span class="op" id="3224259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3224262">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="3224302">var</span>&nbsp;<span class="op" id="3224306">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224309">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224356">errMissingAddress</span>&nbsp;<span class="op" id="3224374">=</span>&nbsp;<span class="ident" id="3224376">errors</span><span class="op" id="3224382">.</span><span class="ident" id="3224383">New</span><span class="op" id="3224386">(</span><span class="string" id="3224387">&#34;missing&nbsp;address&#34;</span><span class="op" id="3224404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224408">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224448">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3224468">error</span>&nbsp;<span class="op" id="3224474">=</span>&nbsp;<span class="op" id="3224476">&amp;</span><span class="ident" id="3224477">timeoutError</span><span class="op" id="3224489">{</span><span class="op" id="3224490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224493">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3224519">=</span>&nbsp;<span class="ident" id="3224521">errors</span><span class="op" id="3224527">.</span><span class="ident" id="3224528">New</span><span class="op" id="3224531">(</span><span class="string" id="3224532">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="3224566">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224569">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3224595">=</span>&nbsp;<span class="ident" id="3224597">errors</span><span class="op" id="3224603">.</span><span class="ident" id="3224604">New</span><span class="op" id="3224607">(</span><span class="string" id="3224608">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="3224654">)</span><br>
<span class="lineno"></span><span class="op" id="3224656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3224659">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="3224729">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="3224798">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3224811">type</span>&nbsp;<span class="ident" id="3224816">OpError</span>&nbsp;<span class="keyword" id="3224824">struct</span>&nbsp;<span class="op" id="3224831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224834">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224890">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224913">Op</span>&nbsp;<span class="builtintype" id="3224916">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224925">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224983">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225012">Net</span>&nbsp;<span class="builtintype" id="3225016">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225025">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225087">Addr</span>&nbsp;<span class="ident" id="3225092">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225099">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225156">Err</span>&nbsp;<span class="builtintype" id="3225160">error</span><br>
<span class="lineno">305</span><span class="op" id="3225166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225169">func</span>&nbsp;<span class="op" id="3225174">(</span><span class="ident" id="3225175">e</span>&nbsp;<span class="op" id="3225177">*</span><span class="ident" id="3225178">OpError</span><span class="op" id="3225185">)</span>&nbsp;<span class="ident" id="3225187">Error</span><span class="op" id="3225192">(</span><span class="op" id="3225193">)</span>&nbsp;<span class="builtintype" id="3225195">string</span>&nbsp;<span class="op" id="3225202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225205">if</span>&nbsp;<span class="ident" id="3225208">e</span>&nbsp;<span class="op" id="3225210">==</span>&nbsp;<span class="ident" id="3225213">nil</span>&nbsp;<span class="op" id="3225217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225221">return</span>&nbsp;<span class="string" id="3225228">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225240">s</span>&nbsp;<span class="op" id="3225242">:=</span>&nbsp;<span class="ident" id="3225245">e</span><span class="op" id="3225246">.</span><span class="ident" id="3225247">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225251">if</span>&nbsp;<span class="ident" id="3225254">e</span><span class="op" id="3225255">.</span><span class="ident" id="3225256">Net</span>&nbsp;<span class="op" id="3225260">!=</span>&nbsp;<span class="string" id="3225263">&#34;&#34;</span>&nbsp;<span class="op" id="3225266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225270">s</span>&nbsp;<span class="op" id="3225272">+=</span>&nbsp;<span class="string" id="3225275">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3225279">+</span>&nbsp;<span class="ident" id="3225281">e</span><span class="op" id="3225282">.</span><span class="ident" id="3225283">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225288">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225291">if</span>&nbsp;<span class="ident" id="3225294">e</span><span class="op" id="3225295">.</span><span class="ident" id="3225296">Addr</span>&nbsp;<span class="op" id="3225301">!=</span>&nbsp;<span class="ident" id="3225304">nil</span>&nbsp;<span class="op" id="3225308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225312">s</span>&nbsp;<span class="op" id="3225314">+=</span>&nbsp;<span class="string" id="3225317">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3225321">+</span>&nbsp;<span class="ident" id="3225323">e</span><span class="op" id="3225324">.</span><span class="ident" id="3225325">Addr</span><span class="op" id="3225329">.</span><span class="ident" id="3225330">String</span><span class="op" id="3225336">(</span><span class="op" id="3225337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225343">s</span>&nbsp;<span class="op" id="3225345">+=</span>&nbsp;<span class="string" id="3225348">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3225353">+</span>&nbsp;<span class="ident" id="3225355">e</span><span class="op" id="3225356">.</span><span class="ident" id="3225357">Err</span><span class="op" id="3225360">.</span><span class="ident" id="3225361">Error</span><span class="op" id="3225366">(</span><span class="op" id="3225367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225370">return</span>&nbsp;<span class="ident" id="3225377">s</span><br>
<span class="lineno">320</span><span class="op" id="3225379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225382">type</span>&nbsp;<span class="ident" id="3225387">temporary</span>&nbsp;<span class="keyword" id="3225397">interface</span>&nbsp;<span class="op" id="3225407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225410">Temporary</span><span class="op" id="3225419">(</span><span class="op" id="3225420">)</span>&nbsp;<span class="builtintype" id="3225422">bool</span><br>
<span class="lineno"></span><span class="op" id="3225427">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3225430">func</span>&nbsp;<span class="op" id="3225435">(</span><span class="ident" id="3225436">e</span>&nbsp;<span class="op" id="3225438">*</span><span class="ident" id="3225439">OpError</span><span class="op" id="3225446">)</span>&nbsp;<span class="ident" id="3225448">Temporary</span><span class="op" id="3225457">(</span><span class="op" id="3225458">)</span>&nbsp;<span class="builtintype" id="3225460">bool</span>&nbsp;<span class="op" id="3225465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225468">t</span><span class="op" id="3225469">,</span>&nbsp;<span class="ident" id="3225471">ok</span>&nbsp;<span class="op" id="3225474">:=</span>&nbsp;<span class="ident" id="3225477">e</span><span class="op" id="3225478">.</span><span class="ident" id="3225479">Err</span><span class="op" id="3225482">.</span><span class="op" id="3225483">(</span><span class="ident" id="3225484">temporary</span><span class="op" id="3225493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225496">return</span>&nbsp;<span class="ident" id="3225503">ok</span>&nbsp;<span class="op" id="3225506">&amp;&amp;</span>&nbsp;<span class="ident" id="3225509">t</span><span class="op" id="3225510">.</span><span class="ident" id="3225511">Temporary</span><span class="op" id="3225520">(</span><span class="op" id="3225521">)</span><br>
<span class="lineno"></span><span class="op" id="3225523">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="3225526">var</span>&nbsp;<span class="ident" id="3225530">noDeadline</span>&nbsp;<span class="op" id="3225541">=</span>&nbsp;<span class="ident" id="3225543">time</span><span class="op" id="3225547">.</span><span class="ident" id="3225548">Time</span><span class="op" id="3225552">{</span><span class="op" id="3225553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225556">type</span>&nbsp;<span class="ident" id="3225561">timeout</span>&nbsp;<span class="keyword" id="3225569">interface</span>&nbsp;<span class="op" id="3225579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225582">Timeout</span><span class="op" id="3225589">(</span><span class="op" id="3225590">)</span>&nbsp;<span class="builtintype" id="3225592">bool</span><br>
<span class="lineno">335</span><span class="op" id="3225597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225600">func</span>&nbsp;<span class="op" id="3225605">(</span><span class="ident" id="3225606">e</span>&nbsp;<span class="op" id="3225608">*</span><span class="ident" id="3225609">OpError</span><span class="op" id="3225616">)</span>&nbsp;<span class="ident" id="3225618">Timeout</span><span class="op" id="3225625">(</span><span class="op" id="3225626">)</span>&nbsp;<span class="builtintype" id="3225628">bool</span>&nbsp;<span class="op" id="3225633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225636">t</span><span class="op" id="3225637">,</span>&nbsp;<span class="ident" id="3225639">ok</span>&nbsp;<span class="op" id="3225642">:=</span>&nbsp;<span class="ident" id="3225645">e</span><span class="op" id="3225646">.</span><span class="ident" id="3225647">Err</span><span class="op" id="3225650">.</span><span class="op" id="3225651">(</span><span class="ident" id="3225652">timeout</span><span class="op" id="3225659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225662">return</span>&nbsp;<span class="ident" id="3225669">ok</span>&nbsp;<span class="op" id="3225672">&amp;&amp;</span>&nbsp;<span class="ident" id="3225675">t</span><span class="op" id="3225676">.</span><span class="ident" id="3225677">Timeout</span><span class="op" id="3225684">(</span><span class="op" id="3225685">)</span><br>
<span class="lineno">340</span><span class="op" id="3225687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225690">type</span>&nbsp;<span class="ident" id="3225695">timeoutError</span>&nbsp;<span class="keyword" id="3225708">struct</span><span class="op" id="3225714">{</span><span class="op" id="3225715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225718">func</span>&nbsp;<span class="op" id="3225723">(</span><span class="ident" id="3225724">e</span>&nbsp;<span class="op" id="3225726">*</span><span class="ident" id="3225727">timeoutError</span><span class="op" id="3225739">)</span>&nbsp;<span class="ident" id="3225741">Error</span><span class="op" id="3225746">(</span><span class="op" id="3225747">)</span>&nbsp;<span class="builtintype" id="3225749">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3225758">{</span>&nbsp;<span class="keyword" id="3225760">return</span>&nbsp;<span class="string" id="3225767">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="3225781">}</span><br>
<span class="lineno">345</span><span class="keyword" id="3225783">func</span>&nbsp;<span class="op" id="3225788">(</span><span class="ident" id="3225789">e</span>&nbsp;<span class="op" id="3225791">*</span><span class="ident" id="3225792">timeoutError</span><span class="op" id="3225804">)</span>&nbsp;<span class="ident" id="3225806">Timeout</span><span class="op" id="3225813">(</span><span class="op" id="3225814">)</span>&nbsp;<span class="builtintype" id="3225816">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3225823">{</span>&nbsp;<span class="keyword" id="3225825">return</span>&nbsp;<span class="builtintype" id="3225832">true</span>&nbsp;<span class="op" id="3225837">}</span><br>
<span class="lineno"></span><span class="keyword" id="3225839">func</span>&nbsp;<span class="op" id="3225844">(</span><span class="ident" id="3225845">e</span>&nbsp;<span class="op" id="3225847">*</span><span class="ident" id="3225848">timeoutError</span><span class="op" id="3225860">)</span>&nbsp;<span class="ident" id="3225862">Temporary</span><span class="op" id="3225871">(</span><span class="op" id="3225872">)</span>&nbsp;<span class="builtintype" id="3225874">bool</span>&nbsp;<span class="op" id="3225879">{</span>&nbsp;<span class="keyword" id="3225881">return</span>&nbsp;<span class="builtintype" id="3225888">true</span>&nbsp;<span class="op" id="3225893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225896">type</span>&nbsp;<span class="ident" id="3225901">AddrError</span>&nbsp;<span class="keyword" id="3225911">struct</span>&nbsp;<span class="op" id="3225918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225921">Err</span>&nbsp;&nbsp;<span class="builtintype" id="3225926">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225934">Addr</span>&nbsp;<span class="builtintype" id="3225939">string</span><br>
<span class="lineno"></span><span class="op" id="3225946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3225949">func</span>&nbsp;<span class="op" id="3225954">(</span><span class="ident" id="3225955">e</span>&nbsp;<span class="op" id="3225957">*</span><span class="ident" id="3225958">AddrError</span><span class="op" id="3225967">)</span>&nbsp;<span class="ident" id="3225969">Error</span><span class="op" id="3225974">(</span><span class="op" id="3225975">)</span>&nbsp;<span class="builtintype" id="3225977">string</span>&nbsp;<span class="op" id="3225984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225987">if</span>&nbsp;<span class="ident" id="3225990">e</span>&nbsp;<span class="op" id="3225992">==</span>&nbsp;<span class="ident" id="3225995">nil</span>&nbsp;<span class="op" id="3225999">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226003">return</span>&nbsp;<span class="string" id="3226010">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226022">s</span>&nbsp;<span class="op" id="3226024">:=</span>&nbsp;<span class="ident" id="3226027">e</span><span class="op" id="3226028">.</span><span class="ident" id="3226029">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226034">if</span>&nbsp;<span class="ident" id="3226037">e</span><span class="op" id="3226038">.</span><span class="ident" id="3226039">Addr</span>&nbsp;<span class="op" id="3226044">!=</span>&nbsp;<span class="string" id="3226047">&#34;&#34;</span>&nbsp;<span class="op" id="3226050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226054">s</span>&nbsp;<span class="op" id="3226056">+=</span>&nbsp;<span class="string" id="3226059">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="3226063">+</span>&nbsp;<span class="ident" id="3226065">e</span><span class="op" id="3226066">.</span><span class="ident" id="3226067">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226076">return</span>&nbsp;<span class="ident" id="3226083">s</span><br>
<span class="lineno"></span><span class="op" id="3226085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226088">func</span>&nbsp;<span class="op" id="3226093">(</span><span class="ident" id="3226094">e</span>&nbsp;<span class="op" id="3226096">*</span><span class="ident" id="3226097">AddrError</span><span class="op" id="3226106">)</span>&nbsp;<span class="ident" id="3226108">Temporary</span><span class="op" id="3226117">(</span><span class="op" id="3226118">)</span>&nbsp;<span class="builtintype" id="3226120">bool</span>&nbsp;<span class="op" id="3226125">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226128">return</span>&nbsp;<span class="builtintype" id="3226135">false</span><br>
<span class="lineno"></span><span class="op" id="3226141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226144">func</span>&nbsp;<span class="op" id="3226149">(</span><span class="ident" id="3226150">e</span>&nbsp;<span class="op" id="3226152">*</span><span class="ident" id="3226153">AddrError</span><span class="op" id="3226162">)</span>&nbsp;<span class="ident" id="3226164">Timeout</span><span class="op" id="3226171">(</span><span class="op" id="3226172">)</span>&nbsp;<span class="builtintype" id="3226174">bool</span>&nbsp;<span class="op" id="3226179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226182">return</span>&nbsp;<span class="builtintype" id="3226189">false</span><br>
<span class="lineno">370</span><span class="op" id="3226195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226198">type</span>&nbsp;<span class="ident" id="3226203">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="3226223">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226231">func</span>&nbsp;<span class="op" id="3226236">(</span><span class="ident" id="3226237">e</span>&nbsp;<span class="ident" id="3226239">UnknownNetworkError</span><span class="op" id="3226258">)</span>&nbsp;<span class="ident" id="3226260">Error</span><span class="op" id="3226265">(</span><span class="op" id="3226266">)</span>&nbsp;<span class="builtintype" id="3226268">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3226277">{</span>&nbsp;<span class="keyword" id="3226279">return</span>&nbsp;<span class="string" id="3226286">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="3226305">+</span>&nbsp;<span class="builtintype" id="3226307">string</span><span class="op" id="3226313">(</span><span class="ident" id="3226314">e</span><span class="op" id="3226315">)</span>&nbsp;<span class="op" id="3226317">}</span><br>
<span class="lineno">375</span><span class="keyword" id="3226319">func</span>&nbsp;<span class="op" id="3226324">(</span><span class="ident" id="3226325">e</span>&nbsp;<span class="ident" id="3226327">UnknownNetworkError</span><span class="op" id="3226346">)</span>&nbsp;<span class="ident" id="3226348">Temporary</span><span class="op" id="3226357">(</span><span class="op" id="3226358">)</span>&nbsp;<span class="builtintype" id="3226360">bool</span>&nbsp;<span class="op" id="3226365">{</span>&nbsp;<span class="keyword" id="3226367">return</span>&nbsp;<span class="builtintype" id="3226374">false</span>&nbsp;<span class="op" id="3226380">}</span><br>
<span class="lineno"></span><span class="keyword" id="3226382">func</span>&nbsp;<span class="op" id="3226387">(</span><span class="ident" id="3226388">e</span>&nbsp;<span class="ident" id="3226390">UnknownNetworkError</span><span class="op" id="3226409">)</span>&nbsp;<span class="ident" id="3226411">Timeout</span><span class="op" id="3226418">(</span><span class="op" id="3226419">)</span>&nbsp;<span class="builtintype" id="3226421">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3226428">{</span>&nbsp;<span class="keyword" id="3226430">return</span>&nbsp;<span class="builtintype" id="3226437">false</span>&nbsp;<span class="op" id="3226443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226446">type</span>&nbsp;<span class="ident" id="3226451">InvalidAddrError</span>&nbsp;<span class="builtintype" id="3226468">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="3226476">func</span>&nbsp;<span class="op" id="3226481">(</span><span class="ident" id="3226482">e</span>&nbsp;<span class="ident" id="3226484">InvalidAddrError</span><span class="op" id="3226500">)</span>&nbsp;<span class="ident" id="3226502">Error</span><span class="op" id="3226507">(</span><span class="op" id="3226508">)</span>&nbsp;<span class="builtintype" id="3226510">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3226519">{</span>&nbsp;<span class="keyword" id="3226521">return</span>&nbsp;<span class="builtintype" id="3226528">string</span><span class="op" id="3226534">(</span><span class="ident" id="3226535">e</span><span class="op" id="3226536">)</span>&nbsp;<span class="op" id="3226538">}</span><br>
<span class="lineno"></span><span class="keyword" id="3226540">func</span>&nbsp;<span class="op" id="3226545">(</span><span class="ident" id="3226546">e</span>&nbsp;<span class="ident" id="3226548">InvalidAddrError</span><span class="op" id="3226564">)</span>&nbsp;<span class="ident" id="3226566">Timeout</span><span class="op" id="3226573">(</span><span class="op" id="3226574">)</span>&nbsp;<span class="builtintype" id="3226576">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3226583">{</span>&nbsp;<span class="keyword" id="3226585">return</span>&nbsp;<span class="builtintype" id="3226592">false</span>&nbsp;<span class="op" id="3226598">}</span><br>
<span class="lineno"></span><span class="keyword" id="3226600">func</span>&nbsp;<span class="op" id="3226605">(</span><span class="ident" id="3226606">e</span>&nbsp;<span class="ident" id="3226608">InvalidAddrError</span><span class="op" id="3226624">)</span>&nbsp;<span class="ident" id="3226626">Temporary</span><span class="op" id="3226635">(</span><span class="op" id="3226636">)</span>&nbsp;<span class="builtintype" id="3226638">bool</span>&nbsp;<span class="op" id="3226643">{</span>&nbsp;<span class="keyword" id="3226645">return</span>&nbsp;<span class="builtintype" id="3226652">false</span>&nbsp;<span class="op" id="3226658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3226661">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="3226740">type</span>&nbsp;<span class="ident" id="3226745">DNSConfigError</span>&nbsp;<span class="keyword" id="3226760">struct</span>&nbsp;<span class="op" id="3226767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226770">Err</span>&nbsp;<span class="builtintype" id="3226774">error</span><br>
<span class="lineno"></span><span class="op" id="3226780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226783">func</span>&nbsp;<span class="op" id="3226788">(</span><span class="ident" id="3226789">e</span>&nbsp;<span class="op" id="3226791">*</span><span class="ident" id="3226792">DNSConfigError</span><span class="op" id="3226806">)</span>&nbsp;<span class="ident" id="3226808">Error</span><span class="op" id="3226813">(</span><span class="op" id="3226814">)</span>&nbsp;<span class="builtintype" id="3226816">string</span>&nbsp;<span class="op" id="3226823">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226826">return</span>&nbsp;<span class="string" id="3226833">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="3226862">+</span>&nbsp;<span class="ident" id="3226864">e</span><span class="op" id="3226865">.</span><span class="ident" id="3226866">Err</span><span class="op" id="3226869">.</span><span class="ident" id="3226870">Error</span><span class="op" id="3226875">(</span><span class="op" id="3226876">)</span><br>
<span class="lineno"></span><span class="op" id="3226878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3226881">func</span>&nbsp;<span class="op" id="3226886">(</span><span class="ident" id="3226887">e</span>&nbsp;<span class="op" id="3226889">*</span><span class="ident" id="3226890">DNSConfigError</span><span class="op" id="3226904">)</span>&nbsp;<span class="ident" id="3226906">Timeout</span><span class="op" id="3226913">(</span><span class="op" id="3226914">)</span>&nbsp;<span class="builtintype" id="3226916">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3226923">{</span>&nbsp;<span class="keyword" id="3226925">return</span>&nbsp;<span class="builtintype" id="3226932">false</span>&nbsp;<span class="op" id="3226938">}</span><br>
<span class="lineno"></span><span class="keyword" id="3226940">func</span>&nbsp;<span class="op" id="3226945">(</span><span class="ident" id="3226946">e</span>&nbsp;<span class="op" id="3226948">*</span><span class="ident" id="3226949">DNSConfigError</span><span class="op" id="3226963">)</span>&nbsp;<span class="ident" id="3226965">Temporary</span><span class="op" id="3226974">(</span><span class="op" id="3226975">)</span>&nbsp;<span class="builtintype" id="3226977">bool</span>&nbsp;<span class="op" id="3226982">{</span>&nbsp;<span class="keyword" id="3226984">return</span>&nbsp;<span class="builtintype" id="3226991">false</span>&nbsp;<span class="op" id="3226997">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="3227000">type</span>&nbsp;<span class="ident" id="3227005">writerOnly</span>&nbsp;<span class="keyword" id="3227016">struct</span>&nbsp;<span class="op" id="3227023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227026">io</span><span class="op" id="3227028">.</span><span class="ident" id="3227029">Writer</span><br>
<span class="lineno"></span><span class="op" id="3227036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="3227039">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="3227115">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="3227130">func</span>&nbsp;<span class="ident" id="3227135">genericReadFrom</span><span class="op" id="3227150">(</span><span class="ident" id="3227151">w</span>&nbsp;<span class="ident" id="3227153">io</span><span class="op" id="3227155">.</span><span class="ident" id="3227156">Writer</span><span class="op" id="3227162">,</span>&nbsp;<span class="ident" id="3227164">r</span>&nbsp;<span class="ident" id="3227166">io</span><span class="op" id="3227168">.</span><span class="ident" id="3227169">Reader</span><span class="op" id="3227175">)</span>&nbsp;<span class="op" id="3227177">(</span><span class="ident" id="3227178">n</span>&nbsp;<span class="ident" id="3227180">int64</span><span class="op" id="3227185">,</span>&nbsp;<span class="ident" id="3227187">err</span>&nbsp;<span class="builtintype" id="3227191">error</span><span class="op" id="3227196">)</span>&nbsp;<span class="op" id="3227198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3227201">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227259">return</span>&nbsp;<span class="ident" id="3227266">io</span><span class="op" id="3227268">.</span><span class="ident" id="3227269">Copy</span><span class="op" id="3227273">(</span><span class="ident" id="3227274">writerOnly</span><span class="op" id="3227284">{</span><span class="ident" id="3227285">w</span><span class="op" id="3227286">}</span><span class="op" id="3227287">,</span>&nbsp;<span class="ident" id="3227289">r</span><span class="op" id="3227290">)</span><br>
<span class="lineno">405</span><span class="op" id="3227292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3227295">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3227359">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="3227431">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="3227497">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3227569">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3227632">var</span>&nbsp;<span class="ident" id="3227636">threadLimit</span>&nbsp;<span class="op" id="3227648">=</span>&nbsp;<span class="builtinfunc" id="3227650">make</span><span class="op" id="3227654">(</span><span class="keyword" id="3227655">chan</span>&nbsp;<span class="keyword" id="3227660">struct</span><span class="op" id="3227666">{</span><span class="op" id="3227667">}</span><span class="op" id="3227668">,</span>&nbsp;<span class="num" id="3227670">500</span><span class="op" id="3227673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="3227676">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="3227745">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="3227817">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3227845">func</span>&nbsp;<span class="ident" id="3227850">acquireThread</span><span class="op" id="3227863">(</span><span class="op" id="3227864">)</span>&nbsp;<span class="op" id="3227866">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227869">threadLimit</span>&nbsp;<span class="op" id="3227881">&lt;-</span>&nbsp;<span class="keyword" id="3227884">struct</span><span class="op" id="3227890">{</span><span class="op" id="3227891">}</span><span class="op" id="3227892">{</span><span class="op" id="3227893">}</span><br>
<span class="lineno"></span><span class="op" id="3227895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3227898">func</span>&nbsp;<span class="ident" id="3227903">releaseThread</span><span class="op" id="3227916">(</span><span class="op" id="3227917">)</span>&nbsp;<span class="op" id="3227919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227922">&lt;-</span><span class="ident" id="3227924">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="3227936">}</span>
</div>
</body>
</html>
