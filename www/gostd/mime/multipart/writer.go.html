<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4323704">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4323759">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4323813">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4323864">package</span>&nbsp;<span class="ident" id="4323872">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4323883">import</span>&nbsp;<span class="op" id="4323890">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323893">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323902">&#34;crypto/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323917">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323927">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323934">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323940">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4323957">&#34;strings&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4323967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4323970">//&nbsp;A&nbsp;Writer&nbsp;generates&nbsp;multipart&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="4324012">type</span>&nbsp;<span class="ident" id="4324017">Writer</span>&nbsp;<span class="keyword" id="4324024">struct</span>&nbsp;<span class="op" id="4324031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324034">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324043"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4324045">.</span><span class="ident" id="4324046"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324054">boundary</span>&nbsp;<span class="builtintype" id="4324063">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324071">lastpart</span>&nbsp;<span class="op" id="4324080">*</span><span class="ident" id="4324081"><a href="/gostd/mime/multipart/writer.go.html#4327993">part</a></span><br>
<span class="lineno"></span><span class="op" id="4324086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4324089">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;multipart&nbsp;Writer&nbsp;with&nbsp;a&nbsp;random&nbsp;boundary,</span><br>
<span class="lineno">25</span><span class="comment" id="4324157">//&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4324174">func</span>&nbsp;<span class="ident" id="4324179">NewWriter</span><span class="op" id="4324188">(</span><span class="ident" id="4324189">w</span>&nbsp;<span class="ident" id="4324191"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4324193">.</span><span class="ident" id="4324194"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4324200">)</span>&nbsp;<span class="op" id="4324202">*</span><span class="ident" id="4324203"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span>&nbsp;<span class="op" id="4324210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324213">return</span>&nbsp;<span class="op" id="4324220">&amp;</span><span class="ident" id="4324221"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4324227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324231"><a href="/gostd/mime/multipart/writer.go.html#4324034">w</a></span><span class="op" id="4324232">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324241"><a href="/gostd/mime/multipart/writer.go.html#4324189">w</a></span><span class="op" id="4324242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324246"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><span class="op" id="4324254">:</span>&nbsp;<span class="ident" id="4324256"><a href="/gostd/mime/multipart/writer.go.html#4325438">randomBoundary</a></span><span class="op" id="4324270">(</span><span class="op" id="4324271">)</span><span class="op" id="4324272">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324275">}</span><br>
<span class="lineno"></span><span class="op" id="4324277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4324280">//&nbsp;Boundary&nbsp;returns&nbsp;the&nbsp;Writer&#39;s&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="keyword" id="4324323">func</span>&nbsp;<span class="op" id="4324328">(</span><span class="ident" id="4324329">w</span>&nbsp;<span class="op" id="4324331">*</span><span class="ident" id="4324332"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4324338">)</span>&nbsp;<span class="ident" id="4324340">Boundary</span><span class="op" id="4324348">(</span><span class="op" id="4324349">)</span>&nbsp;<span class="builtintype" id="4324351">string</span>&nbsp;<span class="op" id="4324358">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324361">return</span>&nbsp;<span class="ident" id="4324368"><a href="/gostd/mime/multipart/writer.go.html#4324329">w</a></span><span class="op" id="4324369">.</span><span class="ident" id="4324370"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><br>
<span class="lineno"></span><span class="op" id="4324379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4324382">//&nbsp;SetBoundary&nbsp;overrides&nbsp;the&nbsp;Writer&#39;s&nbsp;default&nbsp;randomly-generated</span><br>
<span class="lineno"></span><span class="comment" id="4324447">//&nbsp;boundary&nbsp;separator&nbsp;with&nbsp;an&nbsp;explicit&nbsp;value.</span><br>
<span class="lineno">40</span><span class="comment" id="4324493">//</span><br>
<span class="lineno"></span><span class="comment" id="4324496">//&nbsp;SetBoundary&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;any&nbsp;parts&nbsp;are&nbsp;created,&nbsp;may&nbsp;only</span><br>
<span class="lineno"></span><span class="comment" id="4324565">//&nbsp;contain&nbsp;certain&nbsp;ASCII&nbsp;characters,&nbsp;and&nbsp;must&nbsp;be&nbsp;1-69&nbsp;bytes&nbsp;long.</span><br>
<span class="lineno"></span><span class="keyword" id="4324631">func</span>&nbsp;<span class="op" id="4324636">(</span><span class="ident" id="4324637">w</span>&nbsp;<span class="op" id="4324639">*</span><span class="ident" id="4324640"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4324646">)</span>&nbsp;<span class="ident" id="4324648">SetBoundary</span><span class="op" id="4324659">(</span><span class="ident" id="4324660">boundary</span>&nbsp;<span class="builtintype" id="4324669">string</span><span class="op" id="4324675">)</span>&nbsp;<span class="builtintype" id="4324677">error</span>&nbsp;<span class="op" id="4324683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324686">if</span>&nbsp;<span class="ident" id="4324689"><a href="/gostd/mime/multipart/writer.go.html#4324637">w</a></span><span class="op" id="4324690">.</span><span class="ident" id="4324691"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4324700">!=</span>&nbsp;<span class="builtintype" id="4324703">nil</span>&nbsp;<span class="op" id="4324707">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324711">return</span>&nbsp;<span class="ident" id="4324718"><a href="/gostd/mime/multipart/writer.go.html#4323917">errors</a></span><span class="op" id="4324724">.</span><span class="ident" id="4324725"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4324728">(</span><span class="string" id="4324729">&#34;mime:&nbsp;SetBoundary&nbsp;called&nbsp;after&nbsp;write&#34;</span><span class="op" id="4324767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324773">//&nbsp;rfc2046#section-5.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324799">if</span>&nbsp;<span class="builtinfunc" id="4324802">len</span><span class="op" id="4324805">(</span><span class="ident" id="4324806"><a href="/gostd/mime/multipart/writer.go.html#4324660">boundary</a></span><span class="op" id="4324814">)</span>&nbsp;<span class="op" id="4324816">&lt;</span>&nbsp;<span class="num" id="4324818">1</span>&nbsp;<span class="op" id="4324820">||</span>&nbsp;<span class="builtinfunc" id="4324823">len</span><span class="op" id="4324826">(</span><span class="ident" id="4324827"><a href="/gostd/mime/multipart/writer.go.html#4324660">boundary</a></span><span class="op" id="4324835">)</span>&nbsp;<span class="op" id="4324837">&gt;</span>&nbsp;<span class="num" id="4324839">69</span>&nbsp;<span class="op" id="4324842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324846">return</span>&nbsp;<span class="ident" id="4324853"><a href="/gostd/mime/multipart/writer.go.html#4323917">errors</a></span><span class="op" id="4324859">.</span><span class="ident" id="4324860"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4324863">(</span><span class="string" id="4324864">&#34;mime:&nbsp;invalid&nbsp;boundary&nbsp;length&#34;</span><span class="op" id="4324895">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4324898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324901">for</span>&nbsp;<span class="ident" id="4324905">_</span><span class="op" id="4324906">,</span>&nbsp;<span class="ident" id="4324908">b</span>&nbsp;<span class="op" id="4324910">:=</span>&nbsp;<span class="keyword" id="4324913">range</span>&nbsp;<span class="ident" id="4324919"><a href="/gostd/mime/multipart/writer.go.html#4324660">boundary</a></span>&nbsp;<span class="op" id="4324928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4324932">if</span>&nbsp;<span class="string" id="4324935">&#39;A&#39;</span>&nbsp;<span class="op" id="4324939">&lt;=</span>&nbsp;<span class="ident" id="4324942"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324944">&amp;&amp;</span>&nbsp;<span class="ident" id="4324947"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324949">&lt;=</span>&nbsp;<span class="string" id="4324952">&#39;Z&#39;</span>&nbsp;<span class="op" id="4324956">||</span>&nbsp;<span class="string" id="4324959">&#39;a&#39;</span>&nbsp;<span class="op" id="4324963">&lt;=</span>&nbsp;<span class="ident" id="4324966"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324968">&amp;&amp;</span>&nbsp;<span class="ident" id="4324971"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324973">&lt;=</span>&nbsp;<span class="string" id="4324976">&#39;z&#39;</span>&nbsp;<span class="op" id="4324980">||</span>&nbsp;<span class="string" id="4324983">&#39;0&#39;</span>&nbsp;<span class="op" id="4324987">&lt;=</span>&nbsp;<span class="ident" id="4324990"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324992">&amp;&amp;</span>&nbsp;<span class="ident" id="4324995"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4324997">&lt;=</span>&nbsp;<span class="string" id="4325000">&#39;9&#39;</span>&nbsp;<span class="op" id="4325004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325009">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325020">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325024">switch</span>&nbsp;<span class="ident" id="4325031"><a href="/gostd/mime/multipart/writer.go.html#4324908">b</a></span>&nbsp;<span class="op" id="4325033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325037">case</span>&nbsp;<span class="string" id="4325042">&#39;\&#39;&#39;</span><span class="op" id="4325046">,</span>&nbsp;<span class="string" id="4325048">&#39;(&#39;</span><span class="op" id="4325051">,</span>&nbsp;<span class="string" id="4325053">&#39;)&#39;</span><span class="op" id="4325056">,</span>&nbsp;<span class="string" id="4325058">&#39;+&#39;</span><span class="op" id="4325061">,</span>&nbsp;<span class="string" id="4325063">&#39;_&#39;</span><span class="op" id="4325066">,</span>&nbsp;<span class="string" id="4325068">&#39;,&#39;</span><span class="op" id="4325071">,</span>&nbsp;<span class="string" id="4325073">&#39;-&#39;</span><span class="op" id="4325076">,</span>&nbsp;<span class="string" id="4325078">&#39;.&#39;</span><span class="op" id="4325081">,</span>&nbsp;<span class="string" id="4325083">&#39;/&#39;</span><span class="op" id="4325086">,</span>&nbsp;<span class="string" id="4325088">&#39;:&#39;</span><span class="op" id="4325091">,</span>&nbsp;<span class="string" id="4325093">&#39;=&#39;</span><span class="op" id="4325096">,</span>&nbsp;<span class="string" id="4325098">&#39;?&#39;</span><span class="op" id="4325101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325106">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325121">return</span>&nbsp;<span class="ident" id="4325128"><a href="/gostd/mime/multipart/writer.go.html#4323917">errors</a></span><span class="op" id="4325134">.</span><span class="ident" id="4325135"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4325138">(</span><span class="string" id="4325139">&#34;mime:&nbsp;invalid&nbsp;boundary&nbsp;character&#34;</span><span class="op" id="4325173">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325179"><a href="/gostd/mime/multipart/writer.go.html#4324637">w</a></span><span class="op" id="4325180">.</span><span class="ident" id="4325181"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span>&nbsp;<span class="op" id="4325190">=</span>&nbsp;<span class="ident" id="4325192"><a href="/gostd/mime/multipart/writer.go.html#4324660">boundary</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325202">return</span>&nbsp;<span class="builtintype" id="4325209">nil</span><br>
<span class="lineno"></span><span class="op" id="4325213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4325216">//&nbsp;FormDataContentType&nbsp;returns&nbsp;the&nbsp;Content-Type&nbsp;for&nbsp;an&nbsp;HTTP</span><br>
<span class="lineno"></span><span class="comment" id="4325276">//&nbsp;multipart/form-data&nbsp;with&nbsp;this&nbsp;Writer&#39;s&nbsp;Boundary.</span><br>
<span class="lineno"></span><span class="keyword" id="4325328">func</span>&nbsp;<span class="op" id="4325333">(</span><span class="ident" id="4325334">w</span>&nbsp;<span class="op" id="4325336">*</span><span class="ident" id="4325337"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4325343">)</span>&nbsp;<span class="ident" id="4325345">FormDataContentType</span><span class="op" id="4325364">(</span><span class="op" id="4325365">)</span>&nbsp;<span class="builtintype" id="4325367">string</span>&nbsp;<span class="op" id="4325374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325377">return</span>&nbsp;<span class="string" id="4325384">&#34;multipart/form-data;&nbsp;boundary=&#34;</span>&nbsp;<span class="op" id="4325417">+</span>&nbsp;<span class="ident" id="4325419"><a href="/gostd/mime/multipart/writer.go.html#4325334">w</a></span><span class="op" id="4325420">.</span><span class="ident" id="4325421"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><br>
<span class="lineno"></span><span class="op" id="4325430">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4325433">func</span>&nbsp;<span class="ident" id="4325438">randomBoundary</span><span class="op" id="4325452">(</span><span class="op" id="4325453">)</span>&nbsp;<span class="builtintype" id="4325455">string</span>&nbsp;<span class="op" id="4325462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325465">var</span>&nbsp;<span class="ident" id="4325469">buf</span>&nbsp;<span class="op" id="4325473">[</span><span class="num" id="4325474">30</span><span class="op" id="4325476">]</span><span class="builtintype" id="4325477">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325483">_</span><span class="op" id="4325484">,</span>&nbsp;<span class="ident" id="4325486">err</span>&nbsp;<span class="op" id="4325490">:=</span>&nbsp;<span class="ident" id="4325493"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4325495">.</span><span class="ident" id="4325496"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4325504">(</span><span class="ident" id="4325505"><a href="/gostd/mime/multipart/writer.go.html#4323902">rand</a></span><span class="op" id="4325509">.</span><span class="ident" id="4325510"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="4325516">,</span>&nbsp;<span class="ident" id="4325518"><a href="/gostd/mime/multipart/writer.go.html#4325469">buf</a></span><span class="op" id="4325521">[</span><span class="op" id="4325522">:</span><span class="op" id="4325523">]</span><span class="op" id="4325524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325527">if</span>&nbsp;<span class="ident" id="4325530"><a href="/gostd/mime/multipart/writer.go.html#4325486">err</a></span>&nbsp;<span class="op" id="4325534">!=</span>&nbsp;<span class="builtintype" id="4325537">nil</span>&nbsp;<span class="op" id="4325541">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4325545">panic</span><span class="op" id="4325550">(</span><span class="ident" id="4325551"><a href="/gostd/mime/multipart/writer.go.html#4325486">err</a></span><span class="op" id="4325554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325560">return</span>&nbsp;<span class="ident" id="4325567"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4325570">.</span><span class="ident" id="4325571"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4325578">(</span><span class="string" id="4325579">&#34;%x&#34;</span><span class="op" id="4325583">,</span>&nbsp;<span class="ident" id="4325585"><a href="/gostd/mime/multipart/writer.go.html#4325469">buf</a></span><span class="op" id="4325588">[</span><span class="op" id="4325589">:</span><span class="op" id="4325590">]</span><span class="op" id="4325591">)</span><br>
<span class="lineno"></span><span class="op" id="4325593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4325596">//&nbsp;CreatePart&nbsp;creates&nbsp;a&nbsp;new&nbsp;multipart&nbsp;section&nbsp;with&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="4325660">//&nbsp;header.&nbsp;The&nbsp;body&nbsp;of&nbsp;the&nbsp;part&nbsp;should&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="4325726">//&nbsp;Writer.&nbsp;After&nbsp;calling&nbsp;CreatePart,&nbsp;any&nbsp;previous&nbsp;part&nbsp;may&nbsp;no&nbsp;longer</span><br>
<span class="lineno"></span><span class="comment" id="4325795">//&nbsp;be&nbsp;written&nbsp;to.</span><br>
<span class="lineno"></span><span class="keyword" id="4325813">func</span>&nbsp;<span class="op" id="4325818">(</span><span class="ident" id="4325819">w</span>&nbsp;<span class="op" id="4325821">*</span><span class="ident" id="4325822"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4325828">)</span>&nbsp;<span class="ident" id="4325830">CreatePart</span><span class="op" id="4325840">(</span><span class="ident" id="4325841">header</span>&nbsp;<span class="ident" id="4325848"><a href="/gostd/mime/multipart/writer.go.html#4323940">textproto</a></span><span class="op" id="4325857">.</span><span class="ident" id="4325858"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="4325868">)</span>&nbsp;<span class="op" id="4325870">(</span><span class="ident" id="4325871"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4325873">.</span><span class="ident" id="4325874"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4325880">,</span>&nbsp;<span class="builtintype" id="4325882">error</span><span class="op" id="4325887">)</span>&nbsp;<span class="op" id="4325889">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325892">if</span>&nbsp;<span class="ident" id="4325895"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4325896">.</span><span class="ident" id="4325897"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4325906">!=</span>&nbsp;<span class="builtintype" id="4325909">nil</span>&nbsp;<span class="op" id="4325913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325917">if</span>&nbsp;<span class="ident" id="4325920">err</span>&nbsp;<span class="op" id="4325924">:=</span>&nbsp;<span class="ident" id="4325927"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4325928">.</span><span class="ident" id="4325929"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span><span class="op" id="4325937">.</span><span class="builtinfunc" id="4325938"><a href="/gostd/mime/multipart/writer.go.html#4328104">close</a></span><span class="op" id="4325943">(</span><span class="op" id="4325944">)</span><span class="op" id="4325945">;</span>&nbsp;<span class="ident" id="4325947"><a href="/gostd/mime/multipart/writer.go.html#4325920">err</a></span>&nbsp;<span class="op" id="4325951">!=</span>&nbsp;<span class="builtintype" id="4325954">nil</span>&nbsp;<span class="op" id="4325958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325963">return</span>&nbsp;<span class="builtintype" id="4325970">nil</span><span class="op" id="4325973">,</span>&nbsp;<span class="ident" id="4325975"><a href="/gostd/mime/multipart/writer.go.html#4325920">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4325984">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325987">var</span>&nbsp;<span class="ident" id="4325991">b</span>&nbsp;<span class="ident" id="4325993"><a href="/gostd/mime/multipart/writer.go.html#4323893">bytes</a></span><span class="op" id="4325998">.</span><span class="ident" id="4325999"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326007">if</span>&nbsp;<span class="ident" id="4326010"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326011">.</span><span class="ident" id="4326012"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4326021">!=</span>&nbsp;<span class="builtintype" id="4326024">nil</span>&nbsp;<span class="op" id="4326028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326032"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4326035">.</span><span class="ident" id="4326036"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4326043">(</span><span class="op" id="4326044">&amp;</span><span class="ident" id="4326045"><a href="/gostd/mime/multipart/writer.go.html#4325991">b</a></span><span class="op" id="4326046">,</span>&nbsp;<span class="string" id="4326048">&#34;\r\n--%s\r\n&#34;</span><span class="op" id="4326062">,</span>&nbsp;<span class="ident" id="4326064"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326065">.</span><span class="ident" id="4326066"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><span class="op" id="4326074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326077">}</span>&nbsp;<span class="keyword" id="4326079">else</span>&nbsp;<span class="op" id="4326084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326088"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4326091">.</span><span class="ident" id="4326092"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4326099">(</span><span class="op" id="4326100">&amp;</span><span class="ident" id="4326101"><a href="/gostd/mime/multipart/writer.go.html#4325991">b</a></span><span class="op" id="4326102">,</span>&nbsp;<span class="string" id="4326104">&#34;--%s\r\n&#34;</span><span class="op" id="4326114">,</span>&nbsp;<span class="ident" id="4326116"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326117">.</span><span class="ident" id="4326118"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><span class="op" id="4326126">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326132">//&nbsp;TODO(bradfitz):&nbsp;move&nbsp;this&nbsp;to&nbsp;textproto.MimeHeader.Write(w),&nbsp;have&nbsp;it&nbsp;sort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326209">//&nbsp;and&nbsp;clean,&nbsp;like&nbsp;http.Header.Write(w)&nbsp;does.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326256">for</span>&nbsp;<span class="ident" id="4326260">k</span><span class="op" id="4326261">,</span>&nbsp;<span class="ident" id="4326263">vv</span>&nbsp;<span class="op" id="4326266">:=</span>&nbsp;<span class="keyword" id="4326269">range</span>&nbsp;<span class="ident" id="4326275"><a href="/gostd/mime/multipart/writer.go.html#4325841">header</a></span>&nbsp;<span class="op" id="4326282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326286">for</span>&nbsp;<span class="ident" id="4326290">_</span><span class="op" id="4326291">,</span>&nbsp;<span class="ident" id="4326293">v</span>&nbsp;<span class="op" id="4326295">:=</span>&nbsp;<span class="keyword" id="4326298">range</span>&nbsp;<span class="ident" id="4326304"><a href="/gostd/mime/multipart/writer.go.html#4326263">vv</a></span>&nbsp;<span class="op" id="4326307">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326312"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4326315">.</span><span class="ident" id="4326316"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4326323">(</span><span class="op" id="4326324">&amp;</span><span class="ident" id="4326325"><a href="/gostd/mime/multipart/writer.go.html#4325991">b</a></span><span class="op" id="4326326">,</span>&nbsp;<span class="string" id="4326328">&#34;%s:&nbsp;%s\r\n&#34;</span><span class="op" id="4326340">,</span>&nbsp;<span class="ident" id="4326342"><a href="/gostd/mime/multipart/writer.go.html#4326260">k</a></span><span class="op" id="4326343">,</span>&nbsp;<span class="ident" id="4326345"><a href="/gostd/mime/multipart/writer.go.html#4326293">v</a></span><span class="op" id="4326346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326356"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4326359">.</span><span class="ident" id="4326360"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4326367">(</span><span class="op" id="4326368">&amp;</span><span class="ident" id="4326369"><a href="/gostd/mime/multipart/writer.go.html#4325991">b</a></span><span class="op" id="4326370">,</span>&nbsp;<span class="string" id="4326372">&#34;\r\n&#34;</span><span class="op" id="4326378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326381">_</span><span class="op" id="4326382">,</span>&nbsp;<span class="ident" id="4326384">err</span>&nbsp;<span class="op" id="4326388">:=</span>&nbsp;<span class="ident" id="4326391"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4326393">.</span><span class="ident" id="4326394"><a href="/gostd/io/io.go.html#1430946">Copy</a></span><span class="op" id="4326398">(</span><span class="ident" id="4326399"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326400">.</span><span class="ident" id="4326401"><a href="/gostd/mime/multipart/writer.go.html#4324034">w</a></span><span class="op" id="4326402">,</span>&nbsp;<span class="op" id="4326404">&amp;</span><span class="ident" id="4326405"><a href="/gostd/mime/multipart/writer.go.html#4325991">b</a></span><span class="op" id="4326406">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326409">if</span>&nbsp;<span class="ident" id="4326412"><a href="/gostd/mime/multipart/writer.go.html#4326384">err</a></span>&nbsp;<span class="op" id="4326416">!=</span>&nbsp;<span class="builtintype" id="4326419">nil</span>&nbsp;<span class="op" id="4326423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326427">return</span>&nbsp;<span class="builtintype" id="4326434">nil</span><span class="op" id="4326437">,</span>&nbsp;<span class="ident" id="4326439"><a href="/gostd/mime/multipart/writer.go.html#4326384">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326447">p</span>&nbsp;<span class="op" id="4326449">:=</span>&nbsp;<span class="op" id="4326452">&amp;</span><span class="ident" id="4326453"><a href="/gostd/mime/multipart/writer.go.html#4327993">part</a></span><span class="op" id="4326457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326461"><a href="/gostd/mime/multipart/writer.go.html#4328008">mw</a></span><span class="op" id="4326463">:</span>&nbsp;<span class="ident" id="4326465"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326466">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326472"><a href="/gostd/mime/multipart/writer.go.html#4325819">w</a></span><span class="op" id="4326473">.</span><span class="ident" id="4326474"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4326483">=</span>&nbsp;<span class="ident" id="4326485"><a href="/gostd/mime/multipart/writer.go.html#4326447">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326488">return</span>&nbsp;<span class="ident" id="4326495"><a href="/gostd/mime/multipart/writer.go.html#4326447">p</a></span><span class="op" id="4326496">,</span>&nbsp;<span class="builtintype" id="4326498">nil</span><br>
<span class="lineno"></span><span class="op" id="4326502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4326505">var</span>&nbsp;<span class="ident" id="4326509">quoteEscaper</span>&nbsp;<span class="op" id="4326522">=</span>&nbsp;<span class="ident" id="4326524"><a href="/gostd/mime/multipart/writer.go.html#4323957">strings</a></span><span class="op" id="4326531">.</span><span class="ident" id="4326532"><a href="/gostd/strings/replace.go.html#2949056">NewReplacer</a></span><span class="op" id="4326543">(</span><span class="string" id="4326544">&#34;\\&#34;</span><span class="op" id="4326548">,</span>&nbsp;<span class="string" id="4326550">&#34;\\\\&#34;</span><span class="op" id="4326556">,</span>&nbsp;<span class="string" id="4326558">`&#34;`</span><span class="op" id="4326561">,</span>&nbsp;<span class="string" id="4326563">&#34;\\\&#34;&#34;</span><span class="op" id="4326569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4326572">func</span>&nbsp;<span class="ident" id="4326577">escapeQuotes</span><span class="op" id="4326589">(</span><span class="ident" id="4326590">s</span>&nbsp;<span class="builtintype" id="4326592">string</span><span class="op" id="4326598">)</span>&nbsp;<span class="builtintype" id="4326600">string</span>&nbsp;<span class="op" id="4326607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326610">return</span>&nbsp;<span class="ident" id="4326617"><a href="/gostd/mime/multipart/writer.go.html#4326509">quoteEscaper</a></span><span class="op" id="4326629">.</span><span class="ident" id="4326630"><a href="/gostd/strings/replace.go.html#2950171">Replace</a></span><span class="op" id="4326637">(</span><span class="ident" id="4326638"><a href="/gostd/mime/multipart/writer.go.html#4326590">s</a></span><span class="op" id="4326639">)</span><br>
<span class="lineno"></span><span class="op" id="4326641">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="4326644">//&nbsp;CreateFormFile&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;around&nbsp;CreatePart.&nbsp;It&nbsp;creates</span><br>
<span class="lineno"></span><span class="comment" id="4326717">//&nbsp;a&nbsp;new&nbsp;form-data&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;field&nbsp;name&nbsp;and&nbsp;file&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4326787">func</span>&nbsp;<span class="op" id="4326792">(</span><span class="ident" id="4326793">w</span>&nbsp;<span class="op" id="4326795">*</span><span class="ident" id="4326796"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4326802">)</span>&nbsp;<span class="ident" id="4326804">CreateFormFile</span><span class="op" id="4326818">(</span><span class="ident" id="4326819">fieldname</span><span class="op" id="4326828">,</span>&nbsp;<span class="ident" id="4326830">filename</span>&nbsp;<span class="builtintype" id="4326839">string</span><span class="op" id="4326845">)</span>&nbsp;<span class="op" id="4326847">(</span><span class="ident" id="4326848"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4326850">.</span><span class="ident" id="4326851"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4326857">,</span>&nbsp;<span class="builtintype" id="4326859">error</span><span class="op" id="4326864">)</span>&nbsp;<span class="op" id="4326866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326869">h</span>&nbsp;<span class="op" id="4326871">:=</span>&nbsp;<span class="builtinfunc" id="4326874">make</span><span class="op" id="4326878">(</span><span class="ident" id="4326879"><a href="/gostd/mime/multipart/writer.go.html#4323940">textproto</a></span><span class="op" id="4326888">.</span><span class="ident" id="4326889"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="4326899">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326902"><a href="/gostd/mime/multipart/writer.go.html#4326869">h</a></span><span class="op" id="4326903">.</span><span class="ident" id="4326904"><a href="/gostd/net/textproto/header.go.html#4329038">Set</a></span><span class="op" id="4326907">(</span><span class="string" id="4326908">&#34;Content-Disposition&#34;</span><span class="op" id="4326929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326933"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4326936">.</span><span class="ident" id="4326937"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4326944">(</span><span class="string" id="4326945">`form-data;&nbsp;name=&#34;%s&#34;;&nbsp;filename=&#34;%s&#34;`</span><span class="op" id="4326982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326987"><a href="/gostd/mime/multipart/writer.go.html#4326577">escapeQuotes</a></span><span class="op" id="4326999">(</span><span class="ident" id="4327000"><a href="/gostd/mime/multipart/writer.go.html#4326819">fieldname</a></span><span class="op" id="4327009">)</span><span class="op" id="4327010">,</span>&nbsp;<span class="ident" id="4327012"><a href="/gostd/mime/multipart/writer.go.html#4326577">escapeQuotes</a></span><span class="op" id="4327024">(</span><span class="ident" id="4327025"><a href="/gostd/mime/multipart/writer.go.html#4326830">filename</a></span><span class="op" id="4327033">)</span><span class="op" id="4327034">)</span><span class="op" id="4327035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327038"><a href="/gostd/mime/multipart/writer.go.html#4326869">h</a></span><span class="op" id="4327039">.</span><span class="ident" id="4327040"><a href="/gostd/net/textproto/header.go.html#4329038">Set</a></span><span class="op" id="4327043">(</span><span class="string" id="4327044">&#34;Content-Type&#34;</span><span class="op" id="4327058">,</span>&nbsp;<span class="string" id="4327060">&#34;application/octet-stream&#34;</span><span class="op" id="4327086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327089">return</span>&nbsp;<span class="ident" id="4327096"><a href="/gostd/mime/multipart/writer.go.html#4326793">w</a></span><span class="op" id="4327097">.</span><span class="ident" id="4327098"><a href="/gostd/mime/multipart/writer.go.html#4325830">CreatePart</a></span><span class="op" id="4327108">(</span><span class="ident" id="4327109"><a href="/gostd/mime/multipart/writer.go.html#4326869">h</a></span><span class="op" id="4327110">)</span><br>
<span class="lineno">130</span><span class="op" id="4327112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4327115">//&nbsp;CreateFormField&nbsp;calls&nbsp;CreatePart&nbsp;with&nbsp;a&nbsp;header&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4327175">//&nbsp;given&nbsp;field&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4327196">func</span>&nbsp;<span class="op" id="4327201">(</span><span class="ident" id="4327202">w</span>&nbsp;<span class="op" id="4327204">*</span><span class="ident" id="4327205"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4327211">)</span>&nbsp;<span class="ident" id="4327213">CreateFormField</span><span class="op" id="4327228">(</span><span class="ident" id="4327229">fieldname</span>&nbsp;<span class="builtintype" id="4327239">string</span><span class="op" id="4327245">)</span>&nbsp;<span class="op" id="4327247">(</span><span class="ident" id="4327248"><a href="/gostd/mime/multipart/writer.go.html#4323934">io</a></span><span class="op" id="4327250">.</span><span class="ident" id="4327251"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4327257">,</span>&nbsp;<span class="builtintype" id="4327259">error</span><span class="op" id="4327264">)</span>&nbsp;<span class="op" id="4327266">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327269">h</span>&nbsp;<span class="op" id="4327271">:=</span>&nbsp;<span class="builtinfunc" id="4327274">make</span><span class="op" id="4327278">(</span><span class="ident" id="4327279"><a href="/gostd/mime/multipart/writer.go.html#4323940">textproto</a></span><span class="op" id="4327288">.</span><span class="ident" id="4327289"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="4327299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327302"><a href="/gostd/mime/multipart/writer.go.html#4327269">h</a></span><span class="op" id="4327303">.</span><span class="ident" id="4327304"><a href="/gostd/net/textproto/header.go.html#4329038">Set</a></span><span class="op" id="4327307">(</span><span class="string" id="4327308">&#34;Content-Disposition&#34;</span><span class="op" id="4327329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327333"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4327336">.</span><span class="ident" id="4327337"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="4327344">(</span><span class="string" id="4327345">`form-data;&nbsp;name=&#34;%s&#34;`</span><span class="op" id="4327367">,</span>&nbsp;<span class="ident" id="4327369"><a href="/gostd/mime/multipart/writer.go.html#4326577">escapeQuotes</a></span><span class="op" id="4327381">(</span><span class="ident" id="4327382"><a href="/gostd/mime/multipart/writer.go.html#4327229">fieldname</a></span><span class="op" id="4327391">)</span><span class="op" id="4327392">)</span><span class="op" id="4327393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327396">return</span>&nbsp;<span class="ident" id="4327403"><a href="/gostd/mime/multipart/writer.go.html#4327202">w</a></span><span class="op" id="4327404">.</span><span class="ident" id="4327405"><a href="/gostd/mime/multipart/writer.go.html#4325830">CreatePart</a></span><span class="op" id="4327415">(</span><span class="ident" id="4327416"><a href="/gostd/mime/multipart/writer.go.html#4327269">h</a></span><span class="op" id="4327417">)</span><br>
<span class="lineno"></span><span class="op" id="4327419">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="4327422">//&nbsp;WriteField&nbsp;calls&nbsp;CreateFormField&nbsp;and&nbsp;then&nbsp;writes&nbsp;the&nbsp;given&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4327491">func</span>&nbsp;<span class="op" id="4327496">(</span><span class="ident" id="4327497">w</span>&nbsp;<span class="op" id="4327499">*</span><span class="ident" id="4327500"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4327506">)</span>&nbsp;<span class="ident" id="4327508">WriteField</span><span class="op" id="4327518">(</span><span class="ident" id="4327519">fieldname</span><span class="op" id="4327528">,</span>&nbsp;<span class="ident" id="4327530">value</span>&nbsp;<span class="builtintype" id="4327536">string</span><span class="op" id="4327542">)</span>&nbsp;<span class="builtintype" id="4327544">error</span>&nbsp;<span class="op" id="4327550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327553">p</span><span class="op" id="4327554">,</span>&nbsp;<span class="ident" id="4327556">err</span>&nbsp;<span class="op" id="4327560">:=</span>&nbsp;<span class="ident" id="4327563"><a href="/gostd/mime/multipart/writer.go.html#4327497">w</a></span><span class="op" id="4327564">.</span><span class="ident" id="4327565"><a href="/gostd/mime/multipart/writer.go.html#4327213">CreateFormField</a></span><span class="op" id="4327580">(</span><span class="ident" id="4327581"><a href="/gostd/mime/multipart/writer.go.html#4327519">fieldname</a></span><span class="op" id="4327590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327593">if</span>&nbsp;<span class="ident" id="4327596"><a href="/gostd/mime/multipart/writer.go.html#4327556">err</a></span>&nbsp;<span class="op" id="4327600">!=</span>&nbsp;<span class="builtintype" id="4327603">nil</span>&nbsp;<span class="op" id="4327607">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327611">return</span>&nbsp;<span class="ident" id="4327618"><a href="/gostd/mime/multipart/writer.go.html#4327556">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327626">_</span><span class="op" id="4327627">,</span>&nbsp;<span class="ident" id="4327629"><a href="/gostd/mime/multipart/writer.go.html#4327556">err</a></span>&nbsp;<span class="op" id="4327633">=</span>&nbsp;<span class="ident" id="4327635"><a href="/gostd/mime/multipart/writer.go.html#4327553">p</a></span><span class="op" id="4327636">.</span><span class="ident" id="4327637"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4327642">(</span><span class="op" id="4327643">[</span><span class="op" id="4327644">]</span><span class="builtintype" id="4327645">byte</span><span class="op" id="4327649">(</span><span class="ident" id="4327650"><a href="/gostd/mime/multipart/writer.go.html#4327530">value</a></span><span class="op" id="4327655">)</span><span class="op" id="4327656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327659">return</span>&nbsp;<span class="ident" id="4327666"><a href="/gostd/mime/multipart/writer.go.html#4327556">err</a></span><br>
<span class="lineno"></span><span class="op" id="4327670">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="4327673">//&nbsp;Close&nbsp;finishes&nbsp;the&nbsp;multipart&nbsp;message&nbsp;and&nbsp;writes&nbsp;the&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="4327737">//&nbsp;boundary&nbsp;end&nbsp;line&nbsp;to&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4327773">func</span>&nbsp;<span class="op" id="4327778">(</span><span class="ident" id="4327779">w</span>&nbsp;<span class="op" id="4327781">*</span><span class="ident" id="4327782"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><span class="op" id="4327788">)</span>&nbsp;<span class="ident" id="4327790">Close</span><span class="op" id="4327795">(</span><span class="op" id="4327796">)</span>&nbsp;<span class="builtintype" id="4327798">error</span>&nbsp;<span class="op" id="4327804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327807">if</span>&nbsp;<span class="ident" id="4327810"><a href="/gostd/mime/multipart/writer.go.html#4327779">w</a></span><span class="op" id="4327811">.</span><span class="ident" id="4327812"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4327821">!=</span>&nbsp;<span class="builtintype" id="4327824">nil</span>&nbsp;<span class="op" id="4327828">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327832">if</span>&nbsp;<span class="ident" id="4327835">err</span>&nbsp;<span class="op" id="4327839">:=</span>&nbsp;<span class="ident" id="4327842"><a href="/gostd/mime/multipart/writer.go.html#4327779">w</a></span><span class="op" id="4327843">.</span><span class="ident" id="4327844"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span><span class="op" id="4327852">.</span><span class="builtinfunc" id="4327853"><a href="/gostd/mime/multipart/writer.go.html#4328104">close</a></span><span class="op" id="4327858">(</span><span class="op" id="4327859">)</span><span class="op" id="4327860">;</span>&nbsp;<span class="ident" id="4327862"><a href="/gostd/mime/multipart/writer.go.html#4327835">err</a></span>&nbsp;<span class="op" id="4327866">!=</span>&nbsp;<span class="builtintype" id="4327869">nil</span>&nbsp;<span class="op" id="4327873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327878">return</span>&nbsp;<span class="ident" id="4327885"><a href="/gostd/mime/multipart/writer.go.html#4327835">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327895"><a href="/gostd/mime/multipart/writer.go.html#4327779">w</a></span><span class="op" id="4327896">.</span><span class="ident" id="4327897"><a href="/gostd/mime/multipart/writer.go.html#4324071">lastpart</a></span>&nbsp;<span class="op" id="4327906">=</span>&nbsp;<span class="builtintype" id="4327908">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4327913">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4327916">_</span><span class="op" id="4327917">,</span>&nbsp;<span class="ident" id="4327919">err</span>&nbsp;<span class="op" id="4327923">:=</span>&nbsp;<span class="ident" id="4327926"><a href="/gostd/mime/multipart/writer.go.html#4323927">fmt</a></span><span class="op" id="4327929">.</span><span class="ident" id="4327930"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4327937">(</span><span class="ident" id="4327938"><a href="/gostd/mime/multipart/writer.go.html#4327779">w</a></span><span class="op" id="4327939">.</span><span class="ident" id="4327940"><a href="/gostd/mime/multipart/writer.go.html#4324034">w</a></span><span class="op" id="4327941">,</span>&nbsp;<span class="string" id="4327943">&#34;\r\n--%s--\r\n&#34;</span><span class="op" id="4327959">,</span>&nbsp;<span class="ident" id="4327961"><a href="/gostd/mime/multipart/writer.go.html#4327779">w</a></span><span class="op" id="4327962">.</span><span class="ident" id="4327963"><a href="/gostd/mime/multipart/writer.go.html#4324054">boundary</a></span><span class="op" id="4327971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4327974">return</span>&nbsp;<span class="ident" id="4327981"><a href="/gostd/mime/multipart/writer.go.html#4327919">err</a></span><br>
<span class="lineno"></span><span class="op" id="4327985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4327988">type</span>&nbsp;<span class="ident" id="4327993">part</span>&nbsp;<span class="keyword" id="4327998">struct</span>&nbsp;<span class="op" id="4328005">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328008">mw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328015">*</span><span class="ident" id="4328016"><a href="/gostd/mime/multipart/writer.go.html#4324017">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328024">closed</span>&nbsp;<span class="builtintype" id="4328031">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328037">we</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4328044">error</span>&nbsp;<span class="comment" id="4328050">//&nbsp;last&nbsp;error&nbsp;that&nbsp;occurred&nbsp;writing</span><br>
<span class="lineno"></span><span class="op" id="4328086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="4328089">func</span>&nbsp;<span class="op" id="4328094">(</span><span class="ident" id="4328095">p</span>&nbsp;<span class="op" id="4328097">*</span><span class="ident" id="4328098"><a href="/gostd/mime/multipart/writer.go.html#4327993">part</a></span><span class="op" id="4328102">)</span>&nbsp;<span class="builtinfunc" id="4328104">close</span><span class="op" id="4328109">(</span><span class="op" id="4328110">)</span>&nbsp;<span class="builtintype" id="4328112">error</span>&nbsp;<span class="op" id="4328118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328121"><a href="/gostd/mime/multipart/writer.go.html#4328095">p</a></span><span class="op" id="4328122">.</span><span class="ident" id="4328123"><a href="/gostd/mime/multipart/writer.go.html#4328024">closed</a></span>&nbsp;<span class="op" id="4328130">=</span>&nbsp;<span class="builtintype" id="4328132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328138">return</span>&nbsp;<span class="ident" id="4328145"><a href="/gostd/mime/multipart/writer.go.html#4328095">p</a></span><span class="op" id="4328146">.</span><span class="ident" id="4328147"><a href="/gostd/mime/multipart/writer.go.html#4328037">we</a></span><br>
<span class="lineno"></span><span class="op" id="4328150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="4328153">func</span>&nbsp;<span class="op" id="4328158">(</span><span class="ident" id="4328159">p</span>&nbsp;<span class="op" id="4328161">*</span><span class="ident" id="4328162"><a href="/gostd/mime/multipart/writer.go.html#4327993">part</a></span><span class="op" id="4328166">)</span>&nbsp;<span class="ident" id="4328168">Write</span><span class="op" id="4328173">(</span><span class="ident" id="4328174">d</span>&nbsp;<span class="op" id="4328176">[</span><span class="op" id="4328177">]</span><span class="builtintype" id="4328178">byte</span><span class="op" id="4328182">)</span>&nbsp;<span class="op" id="4328184">(</span><span class="ident" id="4328185">n</span>&nbsp;<span class="builtintype" id="4328187">int</span><span class="op" id="4328190">,</span>&nbsp;<span class="ident" id="4328192">err</span>&nbsp;<span class="builtintype" id="4328196">error</span><span class="op" id="4328201">)</span>&nbsp;<span class="op" id="4328203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328206">if</span>&nbsp;<span class="ident" id="4328209"><a href="/gostd/mime/multipart/writer.go.html#4328159">p</a></span><span class="op" id="4328210">.</span><span class="ident" id="4328211"><a href="/gostd/mime/multipart/writer.go.html#4328024">closed</a></span>&nbsp;<span class="op" id="4328218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328222">return</span>&nbsp;<span class="num" id="4328229">0</span><span class="op" id="4328230">,</span>&nbsp;<span class="ident" id="4328232"><a href="/gostd/mime/multipart/writer.go.html#4323917">errors</a></span><span class="op" id="4328238">.</span><span class="ident" id="4328239"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4328242">(</span><span class="string" id="4328243">&#34;multipart:&nbsp;can&#39;t&nbsp;write&nbsp;to&nbsp;finished&nbsp;part&#34;</span><span class="op" id="4328284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328290"><a href="/gostd/mime/multipart/writer.go.html#4328185">n</a></span><span class="op" id="4328291">,</span>&nbsp;<span class="ident" id="4328293"><a href="/gostd/mime/multipart/writer.go.html#4328192">err</a></span>&nbsp;<span class="op" id="4328297">=</span>&nbsp;<span class="ident" id="4328299"><a href="/gostd/mime/multipart/writer.go.html#4328159">p</a></span><span class="op" id="4328300">.</span><span class="ident" id="4328301"><a href="/gostd/mime/multipart/writer.go.html#4328008">mw</a></span><span class="op" id="4328303">.</span><span class="ident" id="4328304"><a href="/gostd/mime/multipart/writer.go.html#4324034">w</a></span><span class="op" id="4328305">.</span><span class="ident" id="4328306"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4328311">(</span><span class="ident" id="4328312"><a href="/gostd/mime/multipart/writer.go.html#4328174">d</a></span><span class="op" id="4328313">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328316">if</span>&nbsp;<span class="ident" id="4328319"><a href="/gostd/mime/multipart/writer.go.html#4328192">err</a></span>&nbsp;<span class="op" id="4328323">!=</span>&nbsp;<span class="builtintype" id="4328326">nil</span>&nbsp;<span class="op" id="4328330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4328334"><a href="/gostd/mime/multipart/writer.go.html#4328159">p</a></span><span class="op" id="4328335">.</span><span class="ident" id="4328336"><a href="/gostd/mime/multipart/writer.go.html#4328037">we</a></span>&nbsp;<span class="op" id="4328339">=</span>&nbsp;<span class="ident" id="4328341"><a href="/gostd/mime/multipart/writer.go.html#4328192">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4328346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4328349">return</span><br>
<span class="lineno"></span><span class="op" id="4328356">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
