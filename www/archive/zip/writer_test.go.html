<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7750847">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7750902">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7750956">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7751007">package</span>&nbsp;<span class="ident" id="7751015">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751020">import</span>&nbsp;<span class="op" id="7751027">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751030">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751039">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751045">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751058">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751071">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7751077">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7751087">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7751090">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751137">type</span>&nbsp;<span class="ident" id="7751142">WriteTest</span>&nbsp;<span class="keyword" id="7751152">struct</span>&nbsp;<span class="op" id="7751159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751162">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7751169">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751177">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7751184">[</span><span class="op" id="7751185">]</span><span class="builtintype" id="7751186">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751192">Method</span>&nbsp;<span class="builtintype" id="7751199">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751207">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7751214">os</span><span class="op" id="7751216">.</span><span class="ident" id="7751217">FileMode</span><br>
<span class="lineno"></span><span class="op" id="7751226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7751229">var</span>&nbsp;<span class="ident" id="7751233">writeTests</span>&nbsp;<span class="op" id="7751244">=</span>&nbsp;<span class="op" id="7751246">[</span><span class="op" id="7751247">]</span><span class="ident" id="7751248">WriteTest</span><span class="op" id="7751257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751264">Name</span><span class="op" id="7751268">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7751272">&#34;foo&#34;</span><span class="op" id="7751277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751281">Data</span><span class="op" id="7751285">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7751289">[</span><span class="op" id="7751290">]</span><span class="builtintype" id="7751291">byte</span><span class="op" id="7751295">(</span><span class="string" id="7751296">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7751356">)</span><span class="op" id="7751357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751361">Method</span><span class="op" id="7751367">:</span>&nbsp;<span class="ident" id="7751369">Store</span><span class="op" id="7751374">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751378">Mode</span><span class="op" id="7751382">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7751386">0666</span><span class="op" id="7751390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751393">}</span><span class="op" id="7751394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751401">Name</span><span class="op" id="7751405">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7751409">&#34;bar&#34;</span><span class="op" id="7751414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751418">Data</span><span class="op" id="7751422">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7751426">nil</span><span class="op" id="7751429">,</span>&nbsp;<span class="comment" id="7751431">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751463">Method</span><span class="op" id="7751469">:</span>&nbsp;<span class="ident" id="7751471">Deflate</span><span class="op" id="7751478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751482">Mode</span><span class="op" id="7751486">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7751490">0644</span><span class="op" id="7751494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751497">}</span><span class="op" id="7751498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751505">Name</span><span class="op" id="7751509">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7751513">&#34;setuid&#34;</span><span class="op" id="7751521">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751525">Data</span><span class="op" id="7751529">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7751533">[</span><span class="op" id="7751534">]</span><span class="builtintype" id="7751535">byte</span><span class="op" id="7751539">(</span><span class="string" id="7751540">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7751553">)</span><span class="op" id="7751554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751558">Method</span><span class="op" id="7751564">:</span>&nbsp;<span class="ident" id="7751566">Deflate</span><span class="op" id="7751573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751577">Mode</span><span class="op" id="7751581">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7751585">0755</span>&nbsp;<span class="op" id="7751590">|</span>&nbsp;<span class="ident" id="7751592">os</span><span class="op" id="7751594">.</span><span class="ident" id="7751595">ModeSetuid</span><span class="op" id="7751605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751608">}</span><span class="op" id="7751609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751612">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751616">Name</span><span class="op" id="7751620">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7751624">&#34;setgid&#34;</span><span class="op" id="7751632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751636">Data</span><span class="op" id="7751640">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7751644">[</span><span class="op" id="7751645">]</span><span class="builtintype" id="7751646">byte</span><span class="op" id="7751650">(</span><span class="string" id="7751651">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7751664">)</span><span class="op" id="7751665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751669">Method</span><span class="op" id="7751675">:</span>&nbsp;<span class="ident" id="7751677">Deflate</span><span class="op" id="7751684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751688">Mode</span><span class="op" id="7751692">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7751696">0755</span>&nbsp;<span class="op" id="7751701">|</span>&nbsp;<span class="ident" id="7751703">os</span><span class="op" id="7751705">.</span><span class="ident" id="7751706">ModeSetgid</span><span class="op" id="7751716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751719">}</span><span class="op" id="7751720">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751727">Name</span><span class="op" id="7751731">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7751735">&#34;symlink&#34;</span><span class="op" id="7751744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751748">Data</span><span class="op" id="7751752">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7751756">[</span><span class="op" id="7751757">]</span><span class="builtintype" id="7751758">byte</span><span class="op" id="7751762">(</span><span class="string" id="7751763">&#34;../link/target&#34;</span><span class="op" id="7751779">)</span><span class="op" id="7751780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751784">Method</span><span class="op" id="7751790">:</span>&nbsp;<span class="ident" id="7751792">Deflate</span><span class="op" id="7751799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751803">Mode</span><span class="op" id="7751807">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7751811">0755</span>&nbsp;<span class="op" id="7751816">|</span>&nbsp;<span class="ident" id="7751818">os</span><span class="op" id="7751820">.</span><span class="ident" id="7751821">ModeSymlink</span><span class="op" id="7751832">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751835">}</span><span class="op" id="7751836">,</span><br>
<span class="lineno"></span><span class="op" id="7751838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751841">func</span>&nbsp;<span class="ident" id="7751846">TestWriter</span><span class="op" id="7751856">(</span><span class="ident" id="7751857">t</span>&nbsp;<span class="op" id="7751859">*</span><span class="ident" id="7751860">testing</span><span class="op" id="7751867">.</span><span class="ident" id="7751868">T</span><span class="op" id="7751869">)</span>&nbsp;<span class="op" id="7751871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751874">largeData</span>&nbsp;<span class="op" id="7751884">:=</span>&nbsp;<span class="builtinfunc" id="7751887">make</span><span class="op" id="7751891">(</span><span class="op" id="7751892">[</span><span class="op" id="7751893">]</span><span class="builtintype" id="7751894">byte</span><span class="op" id="7751898">,</span>&nbsp;<span class="num" id="7751900">1</span><span class="op" id="7751901">&lt;&lt;</span><span class="num" id="7751903">17</span><span class="op" id="7751905">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7751908">for</span>&nbsp;<span class="ident" id="7751912">i</span>&nbsp;<span class="op" id="7751914">:=</span>&nbsp;<span class="keyword" id="7751917">range</span>&nbsp;<span class="ident" id="7751923">largeData</span>&nbsp;<span class="op" id="7751933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751937">largeData</span><span class="op" id="7751946">[</span><span class="ident" id="7751947">i</span><span class="op" id="7751948">]</span>&nbsp;<span class="op" id="7751950">=</span>&nbsp;<span class="builtintype" id="7751952">byte</span><span class="op" id="7751956">(</span><span class="ident" id="7751957">rand</span><span class="op" id="7751961">.</span><span class="ident" id="7751962">Int</span><span class="op" id="7751965">(</span><span class="op" id="7751966">)</span><span class="op" id="7751967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7751970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7751973">writeTests</span><span class="op" id="7751983">[</span><span class="num" id="7751984">1</span><span class="op" id="7751985">]</span><span class="op" id="7751986">.</span><span class="ident" id="7751987">Data</span>&nbsp;<span class="op" id="7751992">=</span>&nbsp;<span class="ident" id="7751994">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752005">defer</span>&nbsp;<span class="keyword" id="7752011">func</span><span class="op" id="7752015">(</span><span class="op" id="7752016">)</span>&nbsp;<span class="op" id="7752018">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752022">writeTests</span><span class="op" id="7752032">[</span><span class="num" id="7752033">1</span><span class="op" id="7752034">]</span><span class="op" id="7752035">.</span><span class="ident" id="7752036">Data</span>&nbsp;<span class="op" id="7752041">=</span>&nbsp;<span class="ident" id="7752043">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752048">}</span><span class="op" id="7752049">(</span><span class="op" id="7752050">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7752054">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752075">buf</span>&nbsp;<span class="op" id="7752079">:=</span>&nbsp;<span class="builtinfunc" id="7752082">new</span><span class="op" id="7752085">(</span><span class="ident" id="7752086">bytes</span><span class="op" id="7752091">.</span><span class="ident" id="7752092">Buffer</span><span class="op" id="7752098">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752101">w</span>&nbsp;<span class="op" id="7752103">:=</span>&nbsp;<span class="ident" id="7752106">NewWriter</span><span class="op" id="7752115">(</span><span class="ident" id="7752116">buf</span><span class="op" id="7752119">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752123">for</span>&nbsp;<span class="ident" id="7752127">_</span><span class="op" id="7752128">,</span>&nbsp;<span class="ident" id="7752130">wt</span>&nbsp;<span class="op" id="7752133">:=</span>&nbsp;<span class="keyword" id="7752136">range</span>&nbsp;<span class="ident" id="7752142">writeTests</span>&nbsp;<span class="op" id="7752153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752157">testCreate</span><span class="op" id="7752167">(</span><span class="ident" id="7752168">t</span><span class="op" id="7752169">,</span>&nbsp;<span class="ident" id="7752171">w</span><span class="op" id="7752172">,</span>&nbsp;<span class="op" id="7752174">&amp;</span><span class="ident" id="7752175">wt</span><span class="op" id="7752177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752180">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752184">if</span>&nbsp;<span class="ident" id="7752187">err</span>&nbsp;<span class="op" id="7752191">:=</span>&nbsp;<span class="ident" id="7752194">w</span><span class="op" id="7752195">.</span><span class="ident" id="7752196">Close</span><span class="op" id="7752201">(</span><span class="op" id="7752202">)</span><span class="op" id="7752203">;</span>&nbsp;<span class="ident" id="7752205">err</span>&nbsp;<span class="op" id="7752209">!=</span>&nbsp;<span class="ident" id="7752212">nil</span>&nbsp;<span class="op" id="7752216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752220">t</span><span class="op" id="7752221">.</span><span class="ident" id="7752222">Fatal</span><span class="op" id="7752227">(</span><span class="ident" id="7752228">err</span><span class="op" id="7752231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7752238">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752255">r</span><span class="op" id="7752256">,</span>&nbsp;<span class="ident" id="7752258">err</span>&nbsp;<span class="op" id="7752262">:=</span>&nbsp;<span class="ident" id="7752265">NewReader</span><span class="op" id="7752274">(</span><span class="ident" id="7752275">bytes</span><span class="op" id="7752280">.</span><span class="ident" id="7752281">NewReader</span><span class="op" id="7752290">(</span><span class="ident" id="7752291">buf</span><span class="op" id="7752294">.</span><span class="ident" id="7752295">Bytes</span><span class="op" id="7752300">(</span><span class="op" id="7752301">)</span><span class="op" id="7752302">)</span><span class="op" id="7752303">,</span>&nbsp;<span class="ident" id="7752305">int64</span><span class="op" id="7752310">(</span><span class="ident" id="7752311">buf</span><span class="op" id="7752314">.</span><span class="ident" id="7752315">Len</span><span class="op" id="7752318">(</span><span class="op" id="7752319">)</span><span class="op" id="7752320">)</span><span class="op" id="7752321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752324">if</span>&nbsp;<span class="ident" id="7752327">err</span>&nbsp;<span class="op" id="7752331">!=</span>&nbsp;<span class="ident" id="7752334">nil</span>&nbsp;<span class="op" id="7752338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752342">t</span><span class="op" id="7752343">.</span><span class="ident" id="7752344">Fatal</span><span class="op" id="7752349">(</span><span class="ident" id="7752350">err</span><span class="op" id="7752353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752356">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752359">for</span>&nbsp;<span class="ident" id="7752363">i</span><span class="op" id="7752364">,</span>&nbsp;<span class="ident" id="7752366">wt</span>&nbsp;<span class="op" id="7752369">:=</span>&nbsp;<span class="keyword" id="7752372">range</span>&nbsp;<span class="ident" id="7752378">writeTests</span>&nbsp;<span class="op" id="7752389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752393">testReadFile</span><span class="op" id="7752405">(</span><span class="ident" id="7752406">t</span><span class="op" id="7752407">,</span>&nbsp;<span class="ident" id="7752409">r</span><span class="op" id="7752410">.</span><span class="ident" id="7752411">File</span><span class="op" id="7752415">[</span><span class="ident" id="7752416">i</span><span class="op" id="7752417">]</span><span class="op" id="7752418">,</span>&nbsp;<span class="op" id="7752420">&amp;</span><span class="ident" id="7752421">wt</span><span class="op" id="7752423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752426">}</span><br>
<span class="lineno"></span><span class="op" id="7752428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7752431">func</span>&nbsp;<span class="ident" id="7752436">TestWriterFlush</span><span class="op" id="7752451">(</span><span class="ident" id="7752452">t</span>&nbsp;<span class="op" id="7752454">*</span><span class="ident" id="7752455">testing</span><span class="op" id="7752462">.</span><span class="ident" id="7752463">T</span><span class="op" id="7752464">)</span>&nbsp;<span class="op" id="7752466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752469">var</span>&nbsp;<span class="ident" id="7752473">buf</span>&nbsp;<span class="ident" id="7752477">bytes</span><span class="op" id="7752482">.</span><span class="ident" id="7752483">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752491">w</span>&nbsp;<span class="op" id="7752493">:=</span>&nbsp;<span class="ident" id="7752496">NewWriter</span><span class="op" id="7752505">(</span><span class="keyword" id="7752506">struct</span><span class="op" id="7752512">{</span>&nbsp;<span class="ident" id="7752514">io</span><span class="op" id="7752516">.</span><span class="ident" id="7752517">Writer</span>&nbsp;<span class="op" id="7752524">}</span><span class="op" id="7752525">{</span><span class="op" id="7752526">&amp;</span><span class="ident" id="7752527">buf</span><span class="op" id="7752530">}</span><span class="op" id="7752531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752534">_</span><span class="op" id="7752535">,</span>&nbsp;<span class="ident" id="7752537">err</span>&nbsp;<span class="op" id="7752541">:=</span>&nbsp;<span class="ident" id="7752544">w</span><span class="op" id="7752545">.</span><span class="ident" id="7752546">Create</span><span class="op" id="7752552">(</span><span class="string" id="7752553">&#34;foo&#34;</span><span class="op" id="7752558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752561">if</span>&nbsp;<span class="ident" id="7752564">err</span>&nbsp;<span class="op" id="7752568">!=</span>&nbsp;<span class="ident" id="7752571">nil</span>&nbsp;<span class="op" id="7752575">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752579">t</span><span class="op" id="7752580">.</span><span class="ident" id="7752581">Fatal</span><span class="op" id="7752586">(</span><span class="ident" id="7752587">err</span><span class="op" id="7752590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752596">if</span>&nbsp;<span class="ident" id="7752599">buf</span><span class="op" id="7752602">.</span><span class="ident" id="7752603">Len</span><span class="op" id="7752606">(</span><span class="op" id="7752607">)</span>&nbsp;<span class="op" id="7752609">&gt;</span>&nbsp;<span class="num" id="7752611">0</span>&nbsp;<span class="op" id="7752613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752617">t</span><span class="op" id="7752618">.</span><span class="ident" id="7752619">Fatalf</span><span class="op" id="7752625">(</span><span class="string" id="7752626">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7752665">,</span>&nbsp;<span class="ident" id="7752667">buf</span><span class="op" id="7752670">.</span><span class="ident" id="7752671">Len</span><span class="op" id="7752674">(</span><span class="op" id="7752675">)</span><span class="op" id="7752676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752679">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752682">if</span>&nbsp;<span class="ident" id="7752685">err</span>&nbsp;<span class="op" id="7752689">:=</span>&nbsp;<span class="ident" id="7752692">w</span><span class="op" id="7752693">.</span><span class="ident" id="7752694">Flush</span><span class="op" id="7752699">(</span><span class="op" id="7752700">)</span><span class="op" id="7752701">;</span>&nbsp;<span class="ident" id="7752703">err</span>&nbsp;<span class="op" id="7752707">!=</span>&nbsp;<span class="ident" id="7752710">nil</span>&nbsp;<span class="op" id="7752714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752718">t</span><span class="op" id="7752719">.</span><span class="ident" id="7752720">Fatal</span><span class="op" id="7752725">(</span><span class="ident" id="7752726">err</span><span class="op" id="7752729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752735">if</span>&nbsp;<span class="ident" id="7752738">buf</span><span class="op" id="7752741">.</span><span class="ident" id="7752742">Len</span><span class="op" id="7752745">(</span><span class="op" id="7752746">)</span>&nbsp;<span class="op" id="7752748">==</span>&nbsp;<span class="num" id="7752751">0</span>&nbsp;<span class="op" id="7752753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752757">t</span><span class="op" id="7752758">.</span><span class="ident" id="7752759">Fatal</span><span class="op" id="7752764">(</span><span class="string" id="7752765">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7752795">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752798">}</span><br>
<span class="lineno"></span><span class="op" id="7752800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7752803">func</span>&nbsp;<span class="ident" id="7752808">testCreate</span><span class="op" id="7752818">(</span><span class="ident" id="7752819">t</span>&nbsp;<span class="op" id="7752821">*</span><span class="ident" id="7752822">testing</span><span class="op" id="7752829">.</span><span class="ident" id="7752830">T</span><span class="op" id="7752831">,</span>&nbsp;<span class="ident" id="7752833">w</span>&nbsp;<span class="op" id="7752835">*</span><span class="ident" id="7752836">Writer</span><span class="op" id="7752842">,</span>&nbsp;<span class="ident" id="7752844">wt</span>&nbsp;<span class="op" id="7752847">*</span><span class="ident" id="7752848">WriteTest</span><span class="op" id="7752857">)</span>&nbsp;<span class="op" id="7752859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752862">header</span>&nbsp;<span class="op" id="7752869">:=</span>&nbsp;<span class="op" id="7752872">&amp;</span><span class="ident" id="7752873">FileHeader</span><span class="op" id="7752883">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752887">Name</span><span class="op" id="7752891">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7752895">wt</span><span class="op" id="7752897">.</span><span class="ident" id="7752898">Name</span><span class="op" id="7752902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752906">Method</span><span class="op" id="7752912">:</span>&nbsp;<span class="ident" id="7752914">wt</span><span class="op" id="7752916">.</span><span class="ident" id="7752917">Method</span><span class="op" id="7752923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7752929">if</span>&nbsp;<span class="ident" id="7752932">wt</span><span class="op" id="7752934">.</span><span class="ident" id="7752935">Mode</span>&nbsp;<span class="op" id="7752940">!=</span>&nbsp;<span class="num" id="7752943">0</span>&nbsp;<span class="op" id="7752945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752949">header</span><span class="op" id="7752955">.</span><span class="ident" id="7752956">SetMode</span><span class="op" id="7752963">(</span><span class="ident" id="7752964">wt</span><span class="op" id="7752966">.</span><span class="ident" id="7752967">Mode</span><span class="op" id="7752971">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7752974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7752977">f</span><span class="op" id="7752978">,</span>&nbsp;<span class="ident" id="7752980">err</span>&nbsp;<span class="op" id="7752984">:=</span>&nbsp;<span class="ident" id="7752987">w</span><span class="op" id="7752988">.</span><span class="ident" id="7752989">CreateHeader</span><span class="op" id="7753001">(</span><span class="ident" id="7753002">header</span><span class="op" id="7753008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753011">if</span>&nbsp;<span class="ident" id="7753014">err</span>&nbsp;<span class="op" id="7753018">!=</span>&nbsp;<span class="ident" id="7753021">nil</span>&nbsp;<span class="op" id="7753025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753029">t</span><span class="op" id="7753030">.</span><span class="ident" id="7753031">Fatal</span><span class="op" id="7753036">(</span><span class="ident" id="7753037">err</span><span class="op" id="7753040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753043">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753046">_</span><span class="op" id="7753047">,</span>&nbsp;<span class="ident" id="7753049">err</span>&nbsp;<span class="op" id="7753053">=</span>&nbsp;<span class="ident" id="7753055">f</span><span class="op" id="7753056">.</span><span class="ident" id="7753057">Write</span><span class="op" id="7753062">(</span><span class="ident" id="7753063">wt</span><span class="op" id="7753065">.</span><span class="ident" id="7753066">Data</span><span class="op" id="7753070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753073">if</span>&nbsp;<span class="ident" id="7753076">err</span>&nbsp;<span class="op" id="7753080">!=</span>&nbsp;<span class="ident" id="7753083">nil</span>&nbsp;<span class="op" id="7753087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753091">t</span><span class="op" id="7753092">.</span><span class="ident" id="7753093">Fatal</span><span class="op" id="7753098">(</span><span class="ident" id="7753099">err</span><span class="op" id="7753102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753105">}</span><br>
<span class="lineno"></span><span class="op" id="7753107">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7753110">func</span>&nbsp;<span class="ident" id="7753115">testReadFile</span><span class="op" id="7753127">(</span><span class="ident" id="7753128">t</span>&nbsp;<span class="op" id="7753130">*</span><span class="ident" id="7753131">testing</span><span class="op" id="7753138">.</span><span class="ident" id="7753139">T</span><span class="op" id="7753140">,</span>&nbsp;<span class="ident" id="7753142">f</span>&nbsp;<span class="op" id="7753144">*</span><span class="ident" id="7753145">File</span><span class="op" id="7753149">,</span>&nbsp;<span class="ident" id="7753151">wt</span>&nbsp;<span class="op" id="7753154">*</span><span class="ident" id="7753155">WriteTest</span><span class="op" id="7753164">)</span>&nbsp;<span class="op" id="7753166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753169">if</span>&nbsp;<span class="ident" id="7753172">f</span><span class="op" id="7753173">.</span><span class="ident" id="7753174">Name</span>&nbsp;<span class="op" id="7753179">!=</span>&nbsp;<span class="ident" id="7753182">wt</span><span class="op" id="7753184">.</span><span class="ident" id="7753185">Name</span>&nbsp;<span class="op" id="7753190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753194">t</span><span class="op" id="7753195">.</span><span class="ident" id="7753196">Fatalf</span><span class="op" id="7753202">(</span><span class="string" id="7753203">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7753231">,</span>&nbsp;<span class="ident" id="7753233">f</span><span class="op" id="7753234">.</span><span class="ident" id="7753235">Name</span><span class="op" id="7753239">,</span>&nbsp;<span class="ident" id="7753241">wt</span><span class="op" id="7753243">.</span><span class="ident" id="7753244">Name</span><span class="op" id="7753248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753251">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753254">testFileMode</span><span class="op" id="7753266">(</span><span class="ident" id="7753267">t</span><span class="op" id="7753268">,</span>&nbsp;<span class="ident" id="7753270">wt</span><span class="op" id="7753272">.</span><span class="ident" id="7753273">Name</span><span class="op" id="7753277">,</span>&nbsp;<span class="ident" id="7753279">f</span><span class="op" id="7753280">,</span>&nbsp;<span class="ident" id="7753282">wt</span><span class="op" id="7753284">.</span><span class="ident" id="7753285">Mode</span><span class="op" id="7753289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753292">rc</span><span class="op" id="7753294">,</span>&nbsp;<span class="ident" id="7753296">err</span>&nbsp;<span class="op" id="7753300">:=</span>&nbsp;<span class="ident" id="7753303">f</span><span class="op" id="7753304">.</span><span class="ident" id="7753305">Open</span><span class="op" id="7753309">(</span><span class="op" id="7753310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753313">if</span>&nbsp;<span class="ident" id="7753316">err</span>&nbsp;<span class="op" id="7753320">!=</span>&nbsp;<span class="ident" id="7753323">nil</span>&nbsp;<span class="op" id="7753327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753331">t</span><span class="op" id="7753332">.</span><span class="ident" id="7753333">Fatal</span><span class="op" id="7753338">(</span><span class="string" id="7753339">&#34;opening:&#34;</span><span class="op" id="7753349">,</span>&nbsp;<span class="ident" id="7753351">err</span><span class="op" id="7753354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753357">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753360">b</span><span class="op" id="7753361">,</span>&nbsp;<span class="ident" id="7753363">err</span>&nbsp;<span class="op" id="7753367">:=</span>&nbsp;<span class="ident" id="7753370">ioutil</span><span class="op" id="7753376">.</span><span class="ident" id="7753377">ReadAll</span><span class="op" id="7753384">(</span><span class="ident" id="7753385">rc</span><span class="op" id="7753387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753390">if</span>&nbsp;<span class="ident" id="7753393">err</span>&nbsp;<span class="op" id="7753397">!=</span>&nbsp;<span class="ident" id="7753400">nil</span>&nbsp;<span class="op" id="7753404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753408">t</span><span class="op" id="7753409">.</span><span class="ident" id="7753410">Fatal</span><span class="op" id="7753415">(</span><span class="string" id="7753416">&#34;reading:&#34;</span><span class="op" id="7753426">,</span>&nbsp;<span class="ident" id="7753428">err</span><span class="op" id="7753431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753437">err</span>&nbsp;<span class="op" id="7753441">=</span>&nbsp;<span class="ident" id="7753443">rc</span><span class="op" id="7753445">.</span><span class="ident" id="7753446">Close</span><span class="op" id="7753451">(</span><span class="op" id="7753452">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753455">if</span>&nbsp;<span class="ident" id="7753458">err</span>&nbsp;<span class="op" id="7753462">!=</span>&nbsp;<span class="ident" id="7753465">nil</span>&nbsp;<span class="op" id="7753469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753473">t</span><span class="op" id="7753474">.</span><span class="ident" id="7753475">Fatal</span><span class="op" id="7753480">(</span><span class="string" id="7753481">&#34;closing:&#34;</span><span class="op" id="7753491">,</span>&nbsp;<span class="ident" id="7753493">err</span><span class="op" id="7753496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753502">if</span>&nbsp;<span class="op" id="7753505">!</span><span class="ident" id="7753506">bytes</span><span class="op" id="7753511">.</span><span class="ident" id="7753512">Equal</span><span class="op" id="7753517">(</span><span class="ident" id="7753518">b</span><span class="op" id="7753519">,</span>&nbsp;<span class="ident" id="7753521">wt</span><span class="op" id="7753523">.</span><span class="ident" id="7753524">Data</span><span class="op" id="7753528">)</span>&nbsp;<span class="op" id="7753530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753534">t</span><span class="op" id="7753535">.</span><span class="ident" id="7753536">Errorf</span><span class="op" id="7753542">(</span><span class="string" id="7753543">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7753570">,</span>&nbsp;<span class="ident" id="7753572">b</span><span class="op" id="7753573">,</span>&nbsp;<span class="ident" id="7753575">wt</span><span class="op" id="7753577">.</span><span class="ident" id="7753578">Data</span><span class="op" id="7753582">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753585">}</span><br>
<span class="lineno"></span><span class="op" id="7753587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7753590">func</span>&nbsp;<span class="ident" id="7753595">BenchmarkCompressedZipGarbage</span><span class="op" id="7753624">(</span><span class="ident" id="7753625">b</span>&nbsp;<span class="op" id="7753627">*</span><span class="ident" id="7753628">testing</span><span class="op" id="7753635">.</span><span class="ident" id="7753636">B</span><span class="op" id="7753637">)</span>&nbsp;<span class="op" id="7753639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753642">b</span><span class="op" id="7753643">.</span><span class="ident" id="7753644">ReportAllocs</span><span class="op" id="7753656">(</span><span class="op" id="7753657">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753660">var</span>&nbsp;<span class="ident" id="7753664">buf</span>&nbsp;<span class="ident" id="7753668">bytes</span><span class="op" id="7753673">.</span><span class="ident" id="7753674">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753682">bigBuf</span>&nbsp;<span class="op" id="7753689">:=</span>&nbsp;<span class="ident" id="7753692">bytes</span><span class="op" id="7753697">.</span><span class="ident" id="7753698">Repeat</span><span class="op" id="7753704">(</span><span class="op" id="7753705">[</span><span class="op" id="7753706">]</span><span class="builtintype" id="7753707">byte</span><span class="op" id="7753711">(</span><span class="string" id="7753712">&#34;a&#34;</span><span class="op" id="7753715">)</span><span class="op" id="7753716">,</span>&nbsp;<span class="num" id="7753718">1</span><span class="op" id="7753719">&lt;&lt;</span><span class="num" id="7753721">20</span><span class="op" id="7753723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753726">for</span>&nbsp;<span class="ident" id="7753730">i</span>&nbsp;<span class="op" id="7753732">:=</span>&nbsp;<span class="num" id="7753735">0</span><span class="op" id="7753736">;</span>&nbsp;<span class="ident" id="7753738">i</span>&nbsp;<span class="op" id="7753740">&lt;</span>&nbsp;<span class="ident" id="7753742">b</span><span class="op" id="7753743">.</span><span class="ident" id="7753744">N</span><span class="op" id="7753745">;</span>&nbsp;<span class="ident" id="7753747">i</span><span class="op" id="7753748">++</span>&nbsp;<span class="op" id="7753751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753755">buf</span><span class="op" id="7753758">.</span><span class="ident" id="7753759">Reset</span><span class="op" id="7753764">(</span><span class="op" id="7753765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753769">zw</span>&nbsp;<span class="op" id="7753772">:=</span>&nbsp;<span class="ident" id="7753775">NewWriter</span><span class="op" id="7753784">(</span><span class="op" id="7753785">&amp;</span><span class="ident" id="7753786">buf</span><span class="op" id="7753789">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7753793">for</span>&nbsp;<span class="ident" id="7753797">j</span>&nbsp;<span class="op" id="7753799">:=</span>&nbsp;<span class="num" id="7753802">0</span><span class="op" id="7753803">;</span>&nbsp;<span class="ident" id="7753805">j</span>&nbsp;<span class="op" id="7753807">&lt;</span>&nbsp;<span class="num" id="7753809">3</span><span class="op" id="7753810">;</span>&nbsp;<span class="ident" id="7753812">j</span><span class="op" id="7753813">++</span>&nbsp;<span class="op" id="7753816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753821">w</span><span class="op" id="7753822">,</span>&nbsp;<span class="ident" id="7753824">_</span>&nbsp;<span class="op" id="7753826">:=</span>&nbsp;<span class="ident" id="7753829">zw</span><span class="op" id="7753831">.</span><span class="ident" id="7753832">CreateHeader</span><span class="op" id="7753844">(</span><span class="op" id="7753845">&amp;</span><span class="ident" id="7753846">FileHeader</span><span class="op" id="7753856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753862">Name</span><span class="op" id="7753866">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7753870">&#34;foo&#34;</span><span class="op" id="7753875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753881">Method</span><span class="op" id="7753887">:</span>&nbsp;<span class="ident" id="7753889">Deflate</span><span class="op" id="7753896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753901">}</span><span class="op" id="7753902">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753907">w</span><span class="op" id="7753908">.</span><span class="ident" id="7753909">Write</span><span class="op" id="7753914">(</span><span class="ident" id="7753915">bigBuf</span><span class="op" id="7753921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7753929">zw</span><span class="op" id="7753931">.</span><span class="ident" id="7753932">Close</span><span class="op" id="7753937">(</span><span class="op" id="7753938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7753941">}</span><br>
<span class="lineno"></span><span class="op" id="7753943">}</span>
</div>
</body>
</html>
