<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html" class="current">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3123054">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3123109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3123163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3123214">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3123238">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3123293">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3123346">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3123402">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3123436">package</span>&nbsp;<span class="ident" id="3123444">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3123452">type</span>&nbsp;<span class="ident" id="3123457">ctr</span>&nbsp;<span class="keyword" id="3123461">struct</span>&nbsp;<span class="op" id="3123468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123471">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123479">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123486">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3123494">[</span><span class="op" id="3123495">]</span><span class="builtintype" id="3123496">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123502">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3123510">[</span><span class="op" id="3123511">]</span><span class="builtintype" id="3123512">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123518">outUsed</span>&nbsp;<span class="builtintype" id="3123526">int</span><br>
<span class="lineno">20</span><span class="op" id="3123530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3123533">const</span>&nbsp;<span class="ident" id="3123539">streamBufferSize</span>&nbsp;<span class="op" id="3123556">=</span>&nbsp;<span class="num" id="3123558">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3123563">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3123639">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3123717">func</span>&nbsp;<span class="ident" id="3123722">NewCTR</span><span class="op" id="3123728">(</span><span class="ident" id="3123729">block</span>&nbsp;<span class="ident" id="3123735">Block</span><span class="op" id="3123740">,</span>&nbsp;<span class="ident" id="3123742">iv</span>&nbsp;<span class="op" id="3123745">[</span><span class="op" id="3123746">]</span><span class="builtintype" id="3123747">byte</span><span class="op" id="3123751">)</span>&nbsp;<span class="ident" id="3123753">Stream</span>&nbsp;<span class="op" id="3123760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3123763">if</span>&nbsp;<span class="builtinfunc" id="3123766">len</span><span class="op" id="3123769">(</span><span class="ident" id="3123770">iv</span><span class="op" id="3123772">)</span>&nbsp;<span class="op" id="3123774">!=</span>&nbsp;<span class="ident" id="3123777">block</span><span class="op" id="3123782">.</span><span class="ident" id="3123783">BlockSize</span><span class="op" id="3123792">(</span><span class="op" id="3123793">)</span>&nbsp;<span class="op" id="3123795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3123799">panic</span><span class="op" id="3123804">(</span><span class="string" id="3123805">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3123853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3123856">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123859">bufSize</span>&nbsp;<span class="op" id="3123867">:=</span>&nbsp;<span class="ident" id="3123870">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3123888">if</span>&nbsp;<span class="ident" id="3123891">bufSize</span>&nbsp;<span class="op" id="3123899">&lt;</span>&nbsp;<span class="ident" id="3123901">block</span><span class="op" id="3123906">.</span><span class="ident" id="3123907">BlockSize</span><span class="op" id="3123916">(</span><span class="op" id="3123917">)</span>&nbsp;<span class="op" id="3123919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123923">bufSize</span>&nbsp;<span class="op" id="3123931">=</span>&nbsp;<span class="ident" id="3123933">block</span><span class="op" id="3123938">.</span><span class="ident" id="3123939">BlockSize</span><span class="op" id="3123948">(</span><span class="op" id="3123949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3123952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3123955">return</span>&nbsp;<span class="op" id="3123962">&amp;</span><span class="ident" id="3123963">ctr</span><span class="op" id="3123966">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123970">b</span><span class="op" id="3123971">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123979">block</span><span class="op" id="3123984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123988">ctr</span><span class="op" id="3123991">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3123997">dup</span><span class="op" id="3124000">(</span><span class="ident" id="3124001">iv</span><span class="op" id="3124003">)</span><span class="op" id="3124004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124008">out</span><span class="op" id="3124011">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3124017">make</span><span class="op" id="3124021">(</span><span class="op" id="3124022">[</span><span class="op" id="3124023">]</span><span class="builtintype" id="3124024">byte</span><span class="op" id="3124028">,</span>&nbsp;<span class="num" id="3124030">0</span><span class="op" id="3124031">,</span>&nbsp;<span class="ident" id="3124033">bufSize</span><span class="op" id="3124040">)</span><span class="op" id="3124041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124045">outUsed</span><span class="op" id="3124052">:</span>&nbsp;<span class="num" id="3124054">0</span><span class="op" id="3124055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124058">}</span><br>
<span class="lineno">40</span><span class="op" id="3124060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3124063">func</span>&nbsp;<span class="op" id="3124068">(</span><span class="ident" id="3124069">x</span>&nbsp;<span class="op" id="3124071">*</span><span class="ident" id="3124072">ctr</span><span class="op" id="3124075">)</span>&nbsp;<span class="ident" id="3124077">refill</span><span class="op" id="3124083">(</span><span class="op" id="3124084">)</span>&nbsp;<span class="op" id="3124086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124089">remain</span>&nbsp;<span class="op" id="3124096">:=</span>&nbsp;<span class="builtinfunc" id="3124099">len</span><span class="op" id="3124102">(</span><span class="ident" id="3124103">x</span><span class="op" id="3124104">.</span><span class="ident" id="3124105">out</span><span class="op" id="3124108">)</span>&nbsp;<span class="op" id="3124110">-</span>&nbsp;<span class="ident" id="3124112">x</span><span class="op" id="3124113">.</span><span class="ident" id="3124114">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124123">if</span>&nbsp;<span class="ident" id="3124126">remain</span>&nbsp;<span class="op" id="3124133">&gt;</span>&nbsp;<span class="ident" id="3124135">x</span><span class="op" id="3124136">.</span><span class="ident" id="3124137">outUsed</span>&nbsp;<span class="op" id="3124145">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124149">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3124160">copy</span><span class="op" id="3124164">(</span><span class="ident" id="3124165">x</span><span class="op" id="3124166">.</span><span class="ident" id="3124167">out</span><span class="op" id="3124170">,</span>&nbsp;<span class="ident" id="3124172">x</span><span class="op" id="3124173">.</span><span class="ident" id="3124174">out</span><span class="op" id="3124177">[</span><span class="ident" id="3124178">x</span><span class="op" id="3124179">.</span><span class="ident" id="3124180">outUsed</span><span class="op" id="3124187">:</span><span class="op" id="3124188">]</span><span class="op" id="3124189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124192">x</span><span class="op" id="3124193">.</span><span class="ident" id="3124194">out</span>&nbsp;<span class="op" id="3124198">=</span>&nbsp;<span class="ident" id="3124200">x</span><span class="op" id="3124201">.</span><span class="ident" id="3124202">out</span><span class="op" id="3124205">[</span><span class="op" id="3124206">:</span><span class="builtinfunc" id="3124207">cap</span><span class="op" id="3124210">(</span><span class="ident" id="3124211">x</span><span class="op" id="3124212">.</span><span class="ident" id="3124213">out</span><span class="op" id="3124216">)</span><span class="op" id="3124217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124220">bs</span>&nbsp;<span class="op" id="3124223">:=</span>&nbsp;<span class="ident" id="3124226">x</span><span class="op" id="3124227">.</span><span class="ident" id="3124228">b</span><span class="op" id="3124229">.</span><span class="ident" id="3124230">BlockSize</span><span class="op" id="3124239">(</span><span class="op" id="3124240">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124243">for</span>&nbsp;<span class="ident" id="3124247">remain</span>&nbsp;<span class="op" id="3124254">&lt;</span>&nbsp;<span class="builtinfunc" id="3124256">len</span><span class="op" id="3124259">(</span><span class="ident" id="3124260">x</span><span class="op" id="3124261">.</span><span class="ident" id="3124262">out</span><span class="op" id="3124265">)</span><span class="op" id="3124266">-</span><span class="ident" id="3124267">bs</span>&nbsp;<span class="op" id="3124270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124274">x</span><span class="op" id="3124275">.</span><span class="ident" id="3124276">b</span><span class="op" id="3124277">.</span><span class="ident" id="3124278">Encrypt</span><span class="op" id="3124285">(</span><span class="ident" id="3124286">x</span><span class="op" id="3124287">.</span><span class="ident" id="3124288">out</span><span class="op" id="3124291">[</span><span class="ident" id="3124292">remain</span><span class="op" id="3124298">:</span><span class="op" id="3124299">]</span><span class="op" id="3124300">,</span>&nbsp;<span class="ident" id="3124302">x</span><span class="op" id="3124303">.</span><span class="ident" id="3124304">ctr</span><span class="op" id="3124307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124311">remain</span>&nbsp;<span class="op" id="3124318">+=</span>&nbsp;<span class="ident" id="3124321">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3124327">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124350">for</span>&nbsp;<span class="ident" id="3124354">i</span>&nbsp;<span class="op" id="3124356">:=</span>&nbsp;<span class="builtinfunc" id="3124359">len</span><span class="op" id="3124362">(</span><span class="ident" id="3124363">x</span><span class="op" id="3124364">.</span><span class="ident" id="3124365">ctr</span><span class="op" id="3124368">)</span>&nbsp;<span class="op" id="3124370">-</span>&nbsp;<span class="num" id="3124372">1</span><span class="op" id="3124373">;</span>&nbsp;<span class="ident" id="3124375">i</span>&nbsp;<span class="op" id="3124377">&gt;=</span>&nbsp;<span class="num" id="3124380">0</span><span class="op" id="3124381">;</span>&nbsp;<span class="ident" id="3124383">i</span><span class="op" id="3124384">--</span>&nbsp;<span class="op" id="3124387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124392">x</span><span class="op" id="3124393">.</span><span class="ident" id="3124394">ctr</span><span class="op" id="3124397">[</span><span class="ident" id="3124398">i</span><span class="op" id="3124399">]</span><span class="op" id="3124400">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124406">if</span>&nbsp;<span class="ident" id="3124409">x</span><span class="op" id="3124410">.</span><span class="ident" id="3124411">ctr</span><span class="op" id="3124414">[</span><span class="ident" id="3124415">i</span><span class="op" id="3124416">]</span>&nbsp;<span class="op" id="3124418">!=</span>&nbsp;<span class="num" id="3124421">0</span>&nbsp;<span class="op" id="3124423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124429">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124438">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124448">x</span><span class="op" id="3124449">.</span><span class="ident" id="3124450">out</span>&nbsp;<span class="op" id="3124454">=</span>&nbsp;<span class="ident" id="3124456">x</span><span class="op" id="3124457">.</span><span class="ident" id="3124458">out</span><span class="op" id="3124461">[</span><span class="op" id="3124462">:</span><span class="ident" id="3124463">remain</span><span class="op" id="3124469">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124472">x</span><span class="op" id="3124473">.</span><span class="ident" id="3124474">outUsed</span>&nbsp;<span class="op" id="3124482">=</span>&nbsp;<span class="num" id="3124484">0</span><br>
<span class="lineno"></span><span class="op" id="3124486">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3124489">func</span>&nbsp;<span class="op" id="3124494">(</span><span class="ident" id="3124495">x</span>&nbsp;<span class="op" id="3124497">*</span><span class="ident" id="3124498">ctr</span><span class="op" id="3124501">)</span>&nbsp;<span class="ident" id="3124503">XORKeyStream</span><span class="op" id="3124515">(</span><span class="ident" id="3124516">dst</span><span class="op" id="3124519">,</span>&nbsp;<span class="ident" id="3124521">src</span>&nbsp;<span class="op" id="3124525">[</span><span class="op" id="3124526">]</span><span class="builtintype" id="3124527">byte</span><span class="op" id="3124531">)</span>&nbsp;<span class="op" id="3124533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124536">for</span>&nbsp;<span class="builtinfunc" id="3124540">len</span><span class="op" id="3124543">(</span><span class="ident" id="3124544">src</span><span class="op" id="3124547">)</span>&nbsp;<span class="op" id="3124549">&gt;</span>&nbsp;<span class="num" id="3124551">0</span>&nbsp;<span class="op" id="3124553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3124557">if</span>&nbsp;<span class="ident" id="3124560">x</span><span class="op" id="3124561">.</span><span class="ident" id="3124562">outUsed</span>&nbsp;<span class="op" id="3124570">&gt;=</span>&nbsp;<span class="builtinfunc" id="3124573">len</span><span class="op" id="3124576">(</span><span class="ident" id="3124577">x</span><span class="op" id="3124578">.</span><span class="ident" id="3124579">out</span><span class="op" id="3124582">)</span><span class="op" id="3124583">-</span><span class="ident" id="3124584">x</span><span class="op" id="3124585">.</span><span class="ident" id="3124586">b</span><span class="op" id="3124587">.</span><span class="ident" id="3124588">BlockSize</span><span class="op" id="3124597">(</span><span class="op" id="3124598">)</span>&nbsp;<span class="op" id="3124600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124605">x</span><span class="op" id="3124606">.</span><span class="ident" id="3124607">refill</span><span class="op" id="3124613">(</span><span class="op" id="3124614">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124622">n</span>&nbsp;<span class="op" id="3124624">:=</span>&nbsp;<span class="ident" id="3124627">xorBytes</span><span class="op" id="3124635">(</span><span class="ident" id="3124636">dst</span><span class="op" id="3124639">,</span>&nbsp;<span class="ident" id="3124641">src</span><span class="op" id="3124644">,</span>&nbsp;<span class="ident" id="3124646">x</span><span class="op" id="3124647">.</span><span class="ident" id="3124648">out</span><span class="op" id="3124651">[</span><span class="ident" id="3124652">x</span><span class="op" id="3124653">.</span><span class="ident" id="3124654">outUsed</span><span class="op" id="3124661">:</span><span class="op" id="3124662">]</span><span class="op" id="3124663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124667">dst</span>&nbsp;<span class="op" id="3124671">=</span>&nbsp;<span class="ident" id="3124673">dst</span><span class="op" id="3124676">[</span><span class="ident" id="3124677">n</span><span class="op" id="3124678">:</span><span class="op" id="3124679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124683">src</span>&nbsp;<span class="op" id="3124687">=</span>&nbsp;<span class="ident" id="3124689">src</span><span class="op" id="3124692">[</span><span class="ident" id="3124693">n</span><span class="op" id="3124694">:</span><span class="op" id="3124695">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3124699">x</span><span class="op" id="3124700">.</span><span class="ident" id="3124701">outUsed</span>&nbsp;<span class="op" id="3124709">+=</span>&nbsp;<span class="ident" id="3124712">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3124715">}</span><br>
<span class="lineno"></span><span class="op" id="3124717">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
