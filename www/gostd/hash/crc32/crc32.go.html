<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html" class="current">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4839666">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4839721">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4839775">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4839826">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4839901">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4839975">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4839991">package</span>&nbsp;<span class="ident" id="4839999">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4840006">import</span>&nbsp;<span class="op" id="4840013">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4840016">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4840024">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4840031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4840034">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4840077">const</span>&nbsp;<span class="ident" id="4840083">Size</span>&nbsp;<span class="op" id="4840088">=</span>&nbsp;<span class="num" id="4840090">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4840093">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4840120">const</span>&nbsp;<span class="op" id="4840126">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840129">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840192">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840259">IEEE</span>&nbsp;<span class="op" id="4840264">=</span>&nbsp;<span class="num" id="4840266">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840279">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840323">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840381">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840421">Castagnoli</span>&nbsp;<span class="op" id="4840432">=</span>&nbsp;<span class="num" id="4840434">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840447">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840473">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840536">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840583">Koopman</span>&nbsp;<span class="op" id="4840591">=</span>&nbsp;<span class="num" id="4840593">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4840604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4840607">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4840690">type</span>&nbsp;<span class="ident" id="4840695">Table</span>&nbsp;<span class="op" id="4840701">[</span><span class="num" id="4840702">256</span><span class="op" id="4840705">]</span><span class="builtintype" id="4840706">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4840714">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4840789">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4840865">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4840941">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4840967">var</span>&nbsp;<span class="ident" id="4840971">castagnoliTable</span>&nbsp;<span class="op" id="4840987">*</span><span class="ident" id="4840988">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4840994">var</span>&nbsp;<span class="ident" id="4840998">castagnoliOnce</span>&nbsp;<span class="ident" id="4841013">sync</span><span class="op" id="4841017">.</span><span class="ident" id="4841018">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4841024">func</span>&nbsp;<span class="ident" id="4841029">castagnoliInit</span><span class="op" id="4841043">(</span><span class="op" id="4841044">)</span>&nbsp;<span class="op" id="4841046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841049">castagnoliTable</span>&nbsp;<span class="op" id="4841065">=</span>&nbsp;<span class="ident" id="4841067">makeTable</span><span class="op" id="4841076">(</span><span class="ident" id="4841077">Castagnoli</span><span class="op" id="4841087">)</span><br>
<span class="lineno"></span><span class="op" id="4841089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841092">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4841143">var</span>&nbsp;<span class="ident" id="4841147">IEEETable</span>&nbsp;<span class="op" id="4841157">=</span>&nbsp;<span class="ident" id="4841159">makeTable</span><span class="op" id="4841168">(</span><span class="ident" id="4841169">IEEE</span><span class="op" id="4841173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841176">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4841250">func</span>&nbsp;<span class="ident" id="4841255">MakeTable</span><span class="op" id="4841264">(</span><span class="ident" id="4841265">poly</span>&nbsp;<span class="builtintype" id="4841270">uint32</span><span class="op" id="4841276">)</span>&nbsp;<span class="op" id="4841278">*</span><span class="ident" id="4841279">Table</span>&nbsp;<span class="op" id="4841285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841288">switch</span>&nbsp;<span class="ident" id="4841295">poly</span>&nbsp;<span class="op" id="4841300">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841303">case</span>&nbsp;<span class="ident" id="4841308">IEEE</span><span class="op" id="4841312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841316">return</span>&nbsp;<span class="ident" id="4841323">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841334">case</span>&nbsp;<span class="ident" id="4841339">Castagnoli</span><span class="op" id="4841349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841353">castagnoliOnce</span><span class="op" id="4841367">.</span><span class="ident" id="4841368">Do</span><span class="op" id="4841370">(</span><span class="ident" id="4841371">castagnoliInit</span><span class="op" id="4841385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841389">return</span>&nbsp;<span class="ident" id="4841396">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841416">return</span>&nbsp;<span class="ident" id="4841423">makeTable</span><span class="op" id="4841432">(</span><span class="ident" id="4841433">poly</span><span class="op" id="4841437">)</span><br>
<span class="lineno"></span><span class="op" id="4841439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841442">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4841516">func</span>&nbsp;<span class="ident" id="4841521">makeTable</span><span class="op" id="4841530">(</span><span class="ident" id="4841531">poly</span>&nbsp;<span class="builtintype" id="4841536">uint32</span><span class="op" id="4841542">)</span>&nbsp;<span class="op" id="4841544">*</span><span class="ident" id="4841545">Table</span>&nbsp;<span class="op" id="4841551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841554">t</span>&nbsp;<span class="op" id="4841556">:=</span>&nbsp;<span class="builtinfunc" id="4841559">new</span><span class="op" id="4841562">(</span><span class="ident" id="4841563">Table</span><span class="op" id="4841568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841571">for</span>&nbsp;<span class="ident" id="4841575">i</span>&nbsp;<span class="op" id="4841577">:=</span>&nbsp;<span class="num" id="4841580">0</span><span class="op" id="4841581">;</span>&nbsp;<span class="ident" id="4841583">i</span>&nbsp;<span class="op" id="4841585">&lt;</span>&nbsp;<span class="num" id="4841587">256</span><span class="op" id="4841590">;</span>&nbsp;<span class="ident" id="4841592">i</span><span class="op" id="4841593">++</span>&nbsp;<span class="op" id="4841596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841600">crc</span>&nbsp;<span class="op" id="4841604">:=</span>&nbsp;<span class="builtintype" id="4841607">uint32</span><span class="op" id="4841613">(</span><span class="ident" id="4841614">i</span><span class="op" id="4841615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841619">for</span>&nbsp;<span class="ident" id="4841623">j</span>&nbsp;<span class="op" id="4841625">:=</span>&nbsp;<span class="num" id="4841628">0</span><span class="op" id="4841629">;</span>&nbsp;<span class="ident" id="4841631">j</span>&nbsp;<span class="op" id="4841633">&lt;</span>&nbsp;<span class="num" id="4841635">8</span><span class="op" id="4841636">;</span>&nbsp;<span class="ident" id="4841638">j</span><span class="op" id="4841639">++</span>&nbsp;<span class="op" id="4841642">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841647">if</span>&nbsp;<span class="ident" id="4841650">crc</span><span class="op" id="4841653">&amp;</span><span class="num" id="4841654">1</span>&nbsp;<span class="op" id="4841656">==</span>&nbsp;<span class="num" id="4841659">1</span>&nbsp;<span class="op" id="4841661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841667">crc</span>&nbsp;<span class="op" id="4841671">=</span>&nbsp;<span class="op" id="4841673">(</span><span class="ident" id="4841674">crc</span>&nbsp;<span class="op" id="4841678">&gt;&gt;</span>&nbsp;<span class="num" id="4841681">1</span><span class="op" id="4841682">)</span>&nbsp;<span class="op" id="4841684">^</span>&nbsp;<span class="ident" id="4841686">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841694">}</span>&nbsp;<span class="keyword" id="4841696">else</span>&nbsp;<span class="op" id="4841701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841707">crc</span>&nbsp;<span class="op" id="4841711">&gt;&gt;=</span>&nbsp;<span class="num" id="4841715">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841720">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841728">t</span><span class="op" id="4841729">[</span><span class="ident" id="4841730">i</span><span class="op" id="4841731">]</span>&nbsp;<span class="op" id="4841733">=</span>&nbsp;<span class="ident" id="4841735">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841743">return</span>&nbsp;<span class="ident" id="4841750">t</span><br>
<span class="lineno"></span><span class="op" id="4841752">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4841755">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4841814">type</span>&nbsp;<span class="ident" id="4841819">digest</span>&nbsp;<span class="keyword" id="4841826">struct</span>&nbsp;<span class="op" id="4841833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841836">crc</span>&nbsp;<span class="builtintype" id="4841840">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4841848">tab</span>&nbsp;<span class="op" id="4841852">*</span><span class="ident" id="4841853">Table</span><br>
<span class="lineno">85</span><span class="op" id="4841859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841862">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4841925">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4841975">func</span>&nbsp;<span class="ident" id="4841980">New</span><span class="op" id="4841983">(</span><span class="ident" id="4841984">tab</span>&nbsp;<span class="op" id="4841988">*</span><span class="ident" id="4841989">Table</span><span class="op" id="4841994">)</span>&nbsp;<span class="ident" id="4841996">hash</span><span class="op" id="4842000">.</span><span class="ident" id="4842001">Hash32</span>&nbsp;<span class="op" id="4842008">{</span>&nbsp;<span class="keyword" id="4842010">return</span>&nbsp;<span class="op" id="4842017">&amp;</span><span class="ident" id="4842018">digest</span><span class="op" id="4842024">{</span><span class="num" id="4842025">0</span><span class="op" id="4842026">,</span>&nbsp;<span class="ident" id="4842028">tab</span><span class="op" id="4842031">}</span>&nbsp;<span class="op" id="4842033">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4842036">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4842103">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4842133">func</span>&nbsp;<span class="ident" id="4842138">NewIEEE</span><span class="op" id="4842145">(</span><span class="op" id="4842146">)</span>&nbsp;<span class="ident" id="4842148">hash</span><span class="op" id="4842152">.</span><span class="ident" id="4842153">Hash32</span>&nbsp;<span class="op" id="4842160">{</span>&nbsp;<span class="keyword" id="4842162">return</span>&nbsp;<span class="ident" id="4842169">New</span><span class="op" id="4842172">(</span><span class="ident" id="4842173">IEEETable</span><span class="op" id="4842182">)</span>&nbsp;<span class="op" id="4842184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4842187">func</span>&nbsp;<span class="op" id="4842192">(</span><span class="ident" id="4842193">d</span>&nbsp;<span class="op" id="4842195">*</span><span class="ident" id="4842196">digest</span><span class="op" id="4842202">)</span>&nbsp;<span class="ident" id="4842204">Size</span><span class="op" id="4842208">(</span><span class="op" id="4842209">)</span>&nbsp;<span class="builtintype" id="4842211">int</span>&nbsp;<span class="op" id="4842215">{</span>&nbsp;<span class="keyword" id="4842217">return</span>&nbsp;<span class="ident" id="4842224">Size</span>&nbsp;<span class="op" id="4842229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842232">func</span>&nbsp;<span class="op" id="4842237">(</span><span class="ident" id="4842238">d</span>&nbsp;<span class="op" id="4842240">*</span><span class="ident" id="4842241">digest</span><span class="op" id="4842247">)</span>&nbsp;<span class="ident" id="4842249">BlockSize</span><span class="op" id="4842258">(</span><span class="op" id="4842259">)</span>&nbsp;<span class="builtintype" id="4842261">int</span>&nbsp;<span class="op" id="4842265">{</span>&nbsp;<span class="keyword" id="4842267">return</span>&nbsp;<span class="num" id="4842274">1</span>&nbsp;<span class="op" id="4842276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842279">func</span>&nbsp;<span class="op" id="4842284">(</span><span class="ident" id="4842285">d</span>&nbsp;<span class="op" id="4842287">*</span><span class="ident" id="4842288">digest</span><span class="op" id="4842294">)</span>&nbsp;<span class="ident" id="4842296">Reset</span><span class="op" id="4842301">(</span><span class="op" id="4842302">)</span>&nbsp;<span class="op" id="4842304">{</span>&nbsp;<span class="ident" id="4842306">d</span><span class="op" id="4842307">.</span><span class="ident" id="4842308">crc</span>&nbsp;<span class="op" id="4842312">=</span>&nbsp;<span class="num" id="4842314">0</span>&nbsp;<span class="op" id="4842316">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4842319">func</span>&nbsp;<span class="ident" id="4842324">update</span><span class="op" id="4842330">(</span><span class="ident" id="4842331">crc</span>&nbsp;<span class="builtintype" id="4842335">uint32</span><span class="op" id="4842341">,</span>&nbsp;<span class="ident" id="4842343">tab</span>&nbsp;<span class="op" id="4842347">*</span><span class="ident" id="4842348">Table</span><span class="op" id="4842353">,</span>&nbsp;<span class="ident" id="4842355">p</span>&nbsp;<span class="op" id="4842357">[</span><span class="op" id="4842358">]</span><span class="builtintype" id="4842359">byte</span><span class="op" id="4842363">)</span>&nbsp;<span class="builtintype" id="4842365">uint32</span>&nbsp;<span class="op" id="4842372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842375">crc</span>&nbsp;<span class="op" id="4842379">=</span>&nbsp;<span class="op" id="4842381">^</span><span class="ident" id="4842382">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842387">for</span>&nbsp;<span class="ident" id="4842391">_</span><span class="op" id="4842392">,</span>&nbsp;<span class="ident" id="4842394">v</span>&nbsp;<span class="op" id="4842396">:=</span>&nbsp;<span class="keyword" id="4842399">range</span>&nbsp;<span class="ident" id="4842405">p</span>&nbsp;<span class="op" id="4842407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842411">crc</span>&nbsp;<span class="op" id="4842415">=</span>&nbsp;<span class="ident" id="4842417">tab</span><span class="op" id="4842420">[</span><span class="builtintype" id="4842421">byte</span><span class="op" id="4842425">(</span><span class="ident" id="4842426">crc</span><span class="op" id="4842429">)</span><span class="op" id="4842430">^</span><span class="ident" id="4842431">v</span><span class="op" id="4842432">]</span>&nbsp;<span class="op" id="4842434">^</span>&nbsp;<span class="op" id="4842436">(</span><span class="ident" id="4842437">crc</span>&nbsp;<span class="op" id="4842441">&gt;&gt;</span>&nbsp;<span class="num" id="4842444">8</span><span class="op" id="4842445">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842451">return</span>&nbsp;<span class="op" id="4842458">^</span><span class="ident" id="4842459">crc</span><br>
<span class="lineno"></span><span class="op" id="4842463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4842466">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4842532">func</span>&nbsp;<span class="ident" id="4842537">Update</span><span class="op" id="4842543">(</span><span class="ident" id="4842544">crc</span>&nbsp;<span class="builtintype" id="4842548">uint32</span><span class="op" id="4842554">,</span>&nbsp;<span class="ident" id="4842556">tab</span>&nbsp;<span class="op" id="4842560">*</span><span class="ident" id="4842561">Table</span><span class="op" id="4842566">,</span>&nbsp;<span class="ident" id="4842568">p</span>&nbsp;<span class="op" id="4842570">[</span><span class="op" id="4842571">]</span><span class="builtintype" id="4842572">byte</span><span class="op" id="4842576">)</span>&nbsp;<span class="builtintype" id="4842578">uint32</span>&nbsp;<span class="op" id="4842585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842588">if</span>&nbsp;<span class="ident" id="4842591">tab</span>&nbsp;<span class="op" id="4842595">==</span>&nbsp;<span class="ident" id="4842598">castagnoliTable</span>&nbsp;<span class="op" id="4842614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842618">return</span>&nbsp;<span class="ident" id="4842625">updateCastagnoli</span><span class="op" id="4842641">(</span><span class="ident" id="4842642">crc</span><span class="op" id="4842645">,</span>&nbsp;<span class="ident" id="4842647">p</span><span class="op" id="4842648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4842651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842654">return</span>&nbsp;<span class="ident" id="4842661">update</span><span class="op" id="4842667">(</span><span class="ident" id="4842668">crc</span><span class="op" id="4842671">,</span>&nbsp;<span class="ident" id="4842673">tab</span><span class="op" id="4842676">,</span>&nbsp;<span class="ident" id="4842678">p</span><span class="op" id="4842679">)</span><br>
<span class="lineno">115</span><span class="op" id="4842681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842684">func</span>&nbsp;<span class="op" id="4842689">(</span><span class="ident" id="4842690">d</span>&nbsp;<span class="op" id="4842692">*</span><span class="ident" id="4842693">digest</span><span class="op" id="4842699">)</span>&nbsp;<span class="ident" id="4842701">Write</span><span class="op" id="4842706">(</span><span class="ident" id="4842707">p</span>&nbsp;<span class="op" id="4842709">[</span><span class="op" id="4842710">]</span><span class="builtintype" id="4842711">byte</span><span class="op" id="4842715">)</span>&nbsp;<span class="op" id="4842717">(</span><span class="ident" id="4842718">n</span>&nbsp;<span class="builtintype" id="4842720">int</span><span class="op" id="4842723">,</span>&nbsp;<span class="ident" id="4842725">err</span>&nbsp;<span class="builtintype" id="4842729">error</span><span class="op" id="4842734">)</span>&nbsp;<span class="op" id="4842736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842739">d</span><span class="op" id="4842740">.</span><span class="ident" id="4842741">crc</span>&nbsp;<span class="op" id="4842745">=</span>&nbsp;<span class="ident" id="4842747">Update</span><span class="op" id="4842753">(</span><span class="ident" id="4842754">d</span><span class="op" id="4842755">.</span><span class="ident" id="4842756">crc</span><span class="op" id="4842759">,</span>&nbsp;<span class="ident" id="4842761">d</span><span class="op" id="4842762">.</span><span class="ident" id="4842763">tab</span><span class="op" id="4842766">,</span>&nbsp;<span class="ident" id="4842768">p</span><span class="op" id="4842769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842772">return</span>&nbsp;<span class="builtinfunc" id="4842779">len</span><span class="op" id="4842782">(</span><span class="ident" id="4842783">p</span><span class="op" id="4842784">)</span><span class="op" id="4842785">,</span>&nbsp;<span class="builtintype" id="4842787">nil</span><br>
<span class="lineno">120</span><span class="op" id="4842791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842794">func</span>&nbsp;<span class="op" id="4842799">(</span><span class="ident" id="4842800">d</span>&nbsp;<span class="op" id="4842802">*</span><span class="ident" id="4842803">digest</span><span class="op" id="4842809">)</span>&nbsp;<span class="ident" id="4842811">Sum32</span><span class="op" id="4842816">(</span><span class="op" id="4842817">)</span>&nbsp;<span class="builtintype" id="4842819">uint32</span>&nbsp;<span class="op" id="4842826">{</span>&nbsp;<span class="keyword" id="4842828">return</span>&nbsp;<span class="ident" id="4842835">d</span><span class="op" id="4842836">.</span><span class="ident" id="4842837">crc</span>&nbsp;<span class="op" id="4842841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842844">func</span>&nbsp;<span class="op" id="4842849">(</span><span class="ident" id="4842850">d</span>&nbsp;<span class="op" id="4842852">*</span><span class="ident" id="4842853">digest</span><span class="op" id="4842859">)</span>&nbsp;<span class="ident" id="4842861">Sum</span><span class="op" id="4842864">(</span><span class="ident" id="4842865">in</span>&nbsp;<span class="op" id="4842868">[</span><span class="op" id="4842869">]</span><span class="builtintype" id="4842870">byte</span><span class="op" id="4842874">)</span>&nbsp;<span class="op" id="4842876">[</span><span class="op" id="4842877">]</span><span class="builtintype" id="4842878">byte</span>&nbsp;<span class="op" id="4842883">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4842886">s</span>&nbsp;<span class="op" id="4842888">:=</span>&nbsp;<span class="ident" id="4842891">d</span><span class="op" id="4842892">.</span><span class="ident" id="4842893">Sum32</span><span class="op" id="4842898">(</span><span class="op" id="4842899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4842902">return</span>&nbsp;<span class="builtinfunc" id="4842909">append</span><span class="op" id="4842915">(</span><span class="ident" id="4842916">in</span><span class="op" id="4842918">,</span>&nbsp;<span class="builtintype" id="4842920">byte</span><span class="op" id="4842924">(</span><span class="ident" id="4842925">s</span><span class="op" id="4842926">&gt;&gt;</span><span class="num" id="4842928">24</span><span class="op" id="4842930">)</span><span class="op" id="4842931">,</span>&nbsp;<span class="builtintype" id="4842933">byte</span><span class="op" id="4842937">(</span><span class="ident" id="4842938">s</span><span class="op" id="4842939">&gt;&gt;</span><span class="num" id="4842941">16</span><span class="op" id="4842943">)</span><span class="op" id="4842944">,</span>&nbsp;<span class="builtintype" id="4842946">byte</span><span class="op" id="4842950">(</span><span class="ident" id="4842951">s</span><span class="op" id="4842952">&gt;&gt;</span><span class="num" id="4842954">8</span><span class="op" id="4842955">)</span><span class="op" id="4842956">,</span>&nbsp;<span class="builtintype" id="4842958">byte</span><span class="op" id="4842962">(</span><span class="ident" id="4842963">s</span><span class="op" id="4842964">)</span><span class="op" id="4842965">)</span><br>
<span class="lineno"></span><span class="op" id="4842967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4842970">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4843018">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4843068">func</span>&nbsp;<span class="ident" id="4843073">Checksum</span><span class="op" id="4843081">(</span><span class="ident" id="4843082">data</span>&nbsp;<span class="op" id="4843087">[</span><span class="op" id="4843088">]</span><span class="builtintype" id="4843089">byte</span><span class="op" id="4843093">,</span>&nbsp;<span class="ident" id="4843095">tab</span>&nbsp;<span class="op" id="4843099">*</span><span class="ident" id="4843100">Table</span><span class="op" id="4843105">)</span>&nbsp;<span class="builtintype" id="4843107">uint32</span>&nbsp;<span class="op" id="4843114">{</span>&nbsp;<span class="keyword" id="4843116">return</span>&nbsp;<span class="ident" id="4843123">Update</span><span class="op" id="4843129">(</span><span class="num" id="4843130">0</span><span class="op" id="4843131">,</span>&nbsp;<span class="ident" id="4843133">tab</span><span class="op" id="4843136">,</span>&nbsp;<span class="ident" id="4843138">data</span><span class="op" id="4843142">)</span>&nbsp;<span class="op" id="4843144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4843147">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4843199">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4843229">func</span>&nbsp;<span class="ident" id="4843234">ChecksumIEEE</span><span class="op" id="4843246">(</span><span class="ident" id="4843247">data</span>&nbsp;<span class="op" id="4843252">[</span><span class="op" id="4843253">]</span><span class="builtintype" id="4843254">byte</span><span class="op" id="4843258">)</span>&nbsp;<span class="builtintype" id="4843260">uint32</span>&nbsp;<span class="op" id="4843267">{</span>&nbsp;<span class="keyword" id="4843269">return</span>&nbsp;<span class="ident" id="4843276">update</span><span class="op" id="4843282">(</span><span class="num" id="4843283">0</span><span class="op" id="4843284">,</span>&nbsp;<span class="ident" id="4843286">IEEETable</span><span class="op" id="4843295">,</span>&nbsp;<span class="ident" id="4843297">data</span><span class="op" id="4843301">)</span>&nbsp;<span class="op" id="4843303">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
