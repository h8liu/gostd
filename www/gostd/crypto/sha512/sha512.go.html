<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4518033">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4518088">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4518142">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4518193">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4518271">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4518289">package</span>&nbsp;<span class="ident" id="4518297">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4518305">import</span>&nbsp;<span class="op" id="4518312">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4518315">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4518325">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4518332">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4518335">func</span>&nbsp;<span class="ident" id="4518340">init</span><span class="op" id="4518344">(</span><span class="op" id="4518345">)</span>&nbsp;<span class="op" id="4518347">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518350">crypto</span><span class="op" id="4518356">.</span><span class="ident" id="4518357">RegisterHash</span><span class="op" id="4518369">(</span><span class="ident" id="4518370">crypto</span><span class="op" id="4518376">.</span><span class="ident" id="4518377">SHA384</span><span class="op" id="4518383">,</span>&nbsp;<span class="ident" id="4518385">New384</span><span class="op" id="4518391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518394">crypto</span><span class="op" id="4518400">.</span><span class="ident" id="4518401">RegisterHash</span><span class="op" id="4518413">(</span><span class="ident" id="4518414">crypto</span><span class="op" id="4518420">.</span><span class="ident" id="4518421">SHA512</span><span class="op" id="4518427">,</span>&nbsp;<span class="ident" id="4518429">New</span><span class="op" id="4518432">)</span><br>
<span class="lineno"></span><span class="op" id="4518434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4518437">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4518480">const</span>&nbsp;<span class="ident" id="4518486">Size</span>&nbsp;<span class="op" id="4518491">=</span>&nbsp;<span class="num" id="4518493">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4518497">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4518540">const</span>&nbsp;<span class="ident" id="4518546">Size384</span>&nbsp;<span class="op" id="4518554">=</span>&nbsp;<span class="num" id="4518556">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4518560">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4518608">const</span>&nbsp;<span class="ident" id="4518614">BlockSize</span>&nbsp;<span class="op" id="4518624">=</span>&nbsp;<span class="num" id="4518626">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4518631">const</span>&nbsp;<span class="op" id="4518637">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518640">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518650">=</span>&nbsp;<span class="num" id="4518652">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518657">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518667">=</span>&nbsp;<span class="num" id="4518669">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518689">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518699">=</span>&nbsp;<span class="num" id="4518701">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518721">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518731">=</span>&nbsp;<span class="num" id="4518733">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518753">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518763">=</span>&nbsp;<span class="num" id="4518765">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518785">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518795">=</span>&nbsp;<span class="num" id="4518797">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518817">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518827">=</span>&nbsp;<span class="num" id="4518829">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518849">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518859">=</span>&nbsp;<span class="num" id="4518861">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518881">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518891">=</span>&nbsp;<span class="num" id="4518893">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518913">init0_384</span>&nbsp;<span class="op" id="4518923">=</span>&nbsp;<span class="num" id="4518925">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518945">init1_384</span>&nbsp;<span class="op" id="4518955">=</span>&nbsp;<span class="num" id="4518957">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4518977">init2_384</span>&nbsp;<span class="op" id="4518987">=</span>&nbsp;<span class="num" id="4518989">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519009">init3_384</span>&nbsp;<span class="op" id="4519019">=</span>&nbsp;<span class="num" id="4519021">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519041">init4_384</span>&nbsp;<span class="op" id="4519051">=</span>&nbsp;<span class="num" id="4519053">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519073">init5_384</span>&nbsp;<span class="op" id="4519083">=</span>&nbsp;<span class="num" id="4519085">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519105">init6_384</span>&nbsp;<span class="op" id="4519115">=</span>&nbsp;<span class="num" id="4519117">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519137">init7_384</span>&nbsp;<span class="op" id="4519147">=</span>&nbsp;<span class="num" id="4519149">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4519168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4519171">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4519230">type</span>&nbsp;<span class="ident" id="4519235">digest</span>&nbsp;<span class="keyword" id="4519242">struct</span>&nbsp;<span class="op" id="4519249">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519252">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519258">[</span><span class="num" id="4519259">8</span><span class="op" id="4519260">]</span><span class="ident" id="4519261">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519269">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4519275">[</span><span class="ident" id="4519276">chunk</span><span class="op" id="4519281">]</span><span class="builtintype" id="4519282">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519288">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4519294">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4519299">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4519305">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519313">is384</span>&nbsp;<span class="builtintype" id="4519319">bool</span>&nbsp;<span class="comment" id="4519324">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4519358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4519361">func</span>&nbsp;<span class="op" id="4519366">(</span><span class="ident" id="4519367">d</span>&nbsp;<span class="op" id="4519369">*</span><span class="ident" id="4519370">digest</span><span class="op" id="4519376">)</span>&nbsp;<span class="ident" id="4519378">Reset</span><span class="op" id="4519383">(</span><span class="op" id="4519384">)</span>&nbsp;<span class="op" id="4519386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4519389">if</span>&nbsp;<span class="op" id="4519392">!</span><span class="ident" id="4519393">d</span><span class="op" id="4519394">.</span><span class="ident" id="4519395">is384</span>&nbsp;<span class="op" id="4519401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519405">d</span><span class="op" id="4519406">.</span><span class="ident" id="4519407">h</span><span class="op" id="4519408">[</span><span class="num" id="4519409">0</span><span class="op" id="4519410">]</span>&nbsp;<span class="op" id="4519412">=</span>&nbsp;<span class="ident" id="4519414">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519422">d</span><span class="op" id="4519423">.</span><span class="ident" id="4519424">h</span><span class="op" id="4519425">[</span><span class="num" id="4519426">1</span><span class="op" id="4519427">]</span>&nbsp;<span class="op" id="4519429">=</span>&nbsp;<span class="ident" id="4519431">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519439">d</span><span class="op" id="4519440">.</span><span class="ident" id="4519441">h</span><span class="op" id="4519442">[</span><span class="num" id="4519443">2</span><span class="op" id="4519444">]</span>&nbsp;<span class="op" id="4519446">=</span>&nbsp;<span class="ident" id="4519448">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519456">d</span><span class="op" id="4519457">.</span><span class="ident" id="4519458">h</span><span class="op" id="4519459">[</span><span class="num" id="4519460">3</span><span class="op" id="4519461">]</span>&nbsp;<span class="op" id="4519463">=</span>&nbsp;<span class="ident" id="4519465">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519473">d</span><span class="op" id="4519474">.</span><span class="ident" id="4519475">h</span><span class="op" id="4519476">[</span><span class="num" id="4519477">4</span><span class="op" id="4519478">]</span>&nbsp;<span class="op" id="4519480">=</span>&nbsp;<span class="ident" id="4519482">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519490">d</span><span class="op" id="4519491">.</span><span class="ident" id="4519492">h</span><span class="op" id="4519493">[</span><span class="num" id="4519494">5</span><span class="op" id="4519495">]</span>&nbsp;<span class="op" id="4519497">=</span>&nbsp;<span class="ident" id="4519499">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519507">d</span><span class="op" id="4519508">.</span><span class="ident" id="4519509">h</span><span class="op" id="4519510">[</span><span class="num" id="4519511">6</span><span class="op" id="4519512">]</span>&nbsp;<span class="op" id="4519514">=</span>&nbsp;<span class="ident" id="4519516">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519524">d</span><span class="op" id="4519525">.</span><span class="ident" id="4519526">h</span><span class="op" id="4519527">[</span><span class="num" id="4519528">7</span><span class="op" id="4519529">]</span>&nbsp;<span class="op" id="4519531">=</span>&nbsp;<span class="ident" id="4519533">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4519540">}</span>&nbsp;<span class="keyword" id="4519542">else</span>&nbsp;<span class="op" id="4519547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519551">d</span><span class="op" id="4519552">.</span><span class="ident" id="4519553">h</span><span class="op" id="4519554">[</span><span class="num" id="4519555">0</span><span class="op" id="4519556">]</span>&nbsp;<span class="op" id="4519558">=</span>&nbsp;<span class="ident" id="4519560">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519572">d</span><span class="op" id="4519573">.</span><span class="ident" id="4519574">h</span><span class="op" id="4519575">[</span><span class="num" id="4519576">1</span><span class="op" id="4519577">]</span>&nbsp;<span class="op" id="4519579">=</span>&nbsp;<span class="ident" id="4519581">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519593">d</span><span class="op" id="4519594">.</span><span class="ident" id="4519595">h</span><span class="op" id="4519596">[</span><span class="num" id="4519597">2</span><span class="op" id="4519598">]</span>&nbsp;<span class="op" id="4519600">=</span>&nbsp;<span class="ident" id="4519602">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519614">d</span><span class="op" id="4519615">.</span><span class="ident" id="4519616">h</span><span class="op" id="4519617">[</span><span class="num" id="4519618">3</span><span class="op" id="4519619">]</span>&nbsp;<span class="op" id="4519621">=</span>&nbsp;<span class="ident" id="4519623">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519635">d</span><span class="op" id="4519636">.</span><span class="ident" id="4519637">h</span><span class="op" id="4519638">[</span><span class="num" id="4519639">4</span><span class="op" id="4519640">]</span>&nbsp;<span class="op" id="4519642">=</span>&nbsp;<span class="ident" id="4519644">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519656">d</span><span class="op" id="4519657">.</span><span class="ident" id="4519658">h</span><span class="op" id="4519659">[</span><span class="num" id="4519660">5</span><span class="op" id="4519661">]</span>&nbsp;<span class="op" id="4519663">=</span>&nbsp;<span class="ident" id="4519665">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519677">d</span><span class="op" id="4519678">.</span><span class="ident" id="4519679">h</span><span class="op" id="4519680">[</span><span class="num" id="4519681">6</span><span class="op" id="4519682">]</span>&nbsp;<span class="op" id="4519684">=</span>&nbsp;<span class="ident" id="4519686">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519698">d</span><span class="op" id="4519699">.</span><span class="ident" id="4519700">h</span><span class="op" id="4519701">[</span><span class="num" id="4519702">7</span><span class="op" id="4519703">]</span>&nbsp;<span class="op" id="4519705">=</span>&nbsp;<span class="ident" id="4519707">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4519718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519721">d</span><span class="op" id="4519722">.</span><span class="ident" id="4519723">nx</span>&nbsp;<span class="op" id="4519726">=</span>&nbsp;<span class="num" id="4519728">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519731">d</span><span class="op" id="4519732">.</span><span class="builtinfunc" id="4519733">len</span>&nbsp;<span class="op" id="4519737">=</span>&nbsp;<span class="num" id="4519739">0</span><br>
<span class="lineno"></span><span class="op" id="4519741">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4519744">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4519806">func</span>&nbsp;<span class="ident" id="4519811">New</span><span class="op" id="4519814">(</span><span class="op" id="4519815">)</span>&nbsp;<span class="ident" id="4519817">hash</span><span class="op" id="4519821">.</span><span class="ident" id="4519822">Hash</span>&nbsp;<span class="op" id="4519827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519830">d</span>&nbsp;<span class="op" id="4519832">:=</span>&nbsp;<span class="builtinfunc" id="4519835">new</span><span class="op" id="4519838">(</span><span class="ident" id="4519839">digest</span><span class="op" id="4519845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519848">d</span><span class="op" id="4519849">.</span><span class="ident" id="4519850">Reset</span><span class="op" id="4519855">(</span><span class="op" id="4519856">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4519859">return</span>&nbsp;<span class="ident" id="4519866">d</span><br>
<span class="lineno"></span><span class="op" id="4519868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4519871">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4519936">func</span>&nbsp;<span class="ident" id="4519941">New384</span><span class="op" id="4519947">(</span><span class="op" id="4519948">)</span>&nbsp;<span class="ident" id="4519950">hash</span><span class="op" id="4519954">.</span><span class="ident" id="4519955">Hash</span>&nbsp;<span class="op" id="4519960">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519963">d</span>&nbsp;<span class="op" id="4519965">:=</span>&nbsp;<span class="builtinfunc" id="4519968">new</span><span class="op" id="4519971">(</span><span class="ident" id="4519972">digest</span><span class="op" id="4519978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519981">d</span><span class="op" id="4519982">.</span><span class="ident" id="4519983">is384</span>&nbsp;<span class="op" id="4519989">=</span>&nbsp;<span class="builtintype" id="4519991">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4519997">d</span><span class="op" id="4519998">.</span><span class="ident" id="4519999">Reset</span><span class="op" id="4520004">(</span><span class="op" id="4520005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520008">return</span>&nbsp;<span class="ident" id="4520015">d</span><br>
<span class="lineno"></span><span class="op" id="4520017">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4520020">func</span>&nbsp;<span class="op" id="4520025">(</span><span class="ident" id="4520026">d</span>&nbsp;<span class="op" id="4520028">*</span><span class="ident" id="4520029">digest</span><span class="op" id="4520035">)</span>&nbsp;<span class="ident" id="4520037">Size</span><span class="op" id="4520041">(</span><span class="op" id="4520042">)</span>&nbsp;<span class="builtintype" id="4520044">int</span>&nbsp;<span class="op" id="4520048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520051">if</span>&nbsp;<span class="op" id="4520054">!</span><span class="ident" id="4520055">d</span><span class="op" id="4520056">.</span><span class="ident" id="4520057">is384</span>&nbsp;<span class="op" id="4520063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520067">return</span>&nbsp;<span class="ident" id="4520074">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520080">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520083">return</span>&nbsp;<span class="ident" id="4520090">Size384</span><br>
<span class="lineno"></span><span class="op" id="4520098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520101">func</span>&nbsp;<span class="op" id="4520106">(</span><span class="ident" id="4520107">d</span>&nbsp;<span class="op" id="4520109">*</span><span class="ident" id="4520110">digest</span><span class="op" id="4520116">)</span>&nbsp;<span class="ident" id="4520118">BlockSize</span><span class="op" id="4520127">(</span><span class="op" id="4520128">)</span>&nbsp;<span class="builtintype" id="4520130">int</span>&nbsp;<span class="op" id="4520134">{</span>&nbsp;<span class="keyword" id="4520136">return</span>&nbsp;<span class="ident" id="4520143">BlockSize</span>&nbsp;<span class="op" id="4520153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4520156">func</span>&nbsp;<span class="op" id="4520161">(</span><span class="ident" id="4520162">d</span>&nbsp;<span class="op" id="4520164">*</span><span class="ident" id="4520165">digest</span><span class="op" id="4520171">)</span>&nbsp;<span class="ident" id="4520173">Write</span><span class="op" id="4520178">(</span><span class="ident" id="4520179">p</span>&nbsp;<span class="op" id="4520181">[</span><span class="op" id="4520182">]</span><span class="builtintype" id="4520183">byte</span><span class="op" id="4520187">)</span>&nbsp;<span class="op" id="4520189">(</span><span class="ident" id="4520190">nn</span>&nbsp;<span class="builtintype" id="4520193">int</span><span class="op" id="4520196">,</span>&nbsp;<span class="ident" id="4520198">err</span>&nbsp;<span class="builtintype" id="4520202">error</span><span class="op" id="4520207">)</span>&nbsp;<span class="op" id="4520209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520212">nn</span>&nbsp;<span class="op" id="4520215">=</span>&nbsp;<span class="builtinfunc" id="4520217">len</span><span class="op" id="4520220">(</span><span class="ident" id="4520221">p</span><span class="op" id="4520222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520225">d</span><span class="op" id="4520226">.</span><span class="builtinfunc" id="4520227">len</span>&nbsp;<span class="op" id="4520231">+=</span>&nbsp;<span class="ident" id="4520234">uint64</span><span class="op" id="4520240">(</span><span class="ident" id="4520241">nn</span><span class="op" id="4520243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520246">if</span>&nbsp;<span class="ident" id="4520249">d</span><span class="op" id="4520250">.</span><span class="ident" id="4520251">nx</span>&nbsp;<span class="op" id="4520254">&gt;</span>&nbsp;<span class="num" id="4520256">0</span>&nbsp;<span class="op" id="4520258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520262">n</span>&nbsp;<span class="op" id="4520264">:=</span>&nbsp;<span class="builtinfunc" id="4520267">copy</span><span class="op" id="4520271">(</span><span class="ident" id="4520272">d</span><span class="op" id="4520273">.</span><span class="ident" id="4520274">x</span><span class="op" id="4520275">[</span><span class="ident" id="4520276">d</span><span class="op" id="4520277">.</span><span class="ident" id="4520278">nx</span><span class="op" id="4520280">:</span><span class="op" id="4520281">]</span><span class="op" id="4520282">,</span>&nbsp;<span class="ident" id="4520284">p</span><span class="op" id="4520285">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520289">d</span><span class="op" id="4520290">.</span><span class="ident" id="4520291">nx</span>&nbsp;<span class="op" id="4520294">+=</span>&nbsp;<span class="ident" id="4520297">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520301">if</span>&nbsp;<span class="ident" id="4520304">d</span><span class="op" id="4520305">.</span><span class="ident" id="4520306">nx</span>&nbsp;<span class="op" id="4520309">==</span>&nbsp;<span class="ident" id="4520312">chunk</span>&nbsp;<span class="op" id="4520318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520323">block</span><span class="op" id="4520328">(</span><span class="ident" id="4520329">d</span><span class="op" id="4520330">,</span>&nbsp;<span class="ident" id="4520332">d</span><span class="op" id="4520333">.</span><span class="ident" id="4520334">x</span><span class="op" id="4520335">[</span><span class="op" id="4520336">:</span><span class="op" id="4520337">]</span><span class="op" id="4520338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520343">d</span><span class="op" id="4520344">.</span><span class="ident" id="4520345">nx</span>&nbsp;<span class="op" id="4520348">=</span>&nbsp;<span class="num" id="4520350">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520354">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520358">p</span>&nbsp;<span class="op" id="4520360">=</span>&nbsp;<span class="ident" id="4520362">p</span><span class="op" id="4520363">[</span><span class="ident" id="4520364">n</span><span class="op" id="4520365">:</span><span class="op" id="4520366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520372">if</span>&nbsp;<span class="builtinfunc" id="4520375">len</span><span class="op" id="4520378">(</span><span class="ident" id="4520379">p</span><span class="op" id="4520380">)</span>&nbsp;<span class="op" id="4520382">&gt;=</span>&nbsp;<span class="ident" id="4520385">chunk</span>&nbsp;<span class="op" id="4520391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520395">n</span>&nbsp;<span class="op" id="4520397">:=</span>&nbsp;<span class="builtinfunc" id="4520400">len</span><span class="op" id="4520403">(</span><span class="ident" id="4520404">p</span><span class="op" id="4520405">)</span>&nbsp;<span class="op" id="4520407">&amp;^</span>&nbsp;<span class="op" id="4520410">(</span><span class="ident" id="4520411">chunk</span>&nbsp;<span class="op" id="4520417">-</span>&nbsp;<span class="num" id="4520419">1</span><span class="op" id="4520420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520424">block</span><span class="op" id="4520429">(</span><span class="ident" id="4520430">d</span><span class="op" id="4520431">,</span>&nbsp;<span class="ident" id="4520433">p</span><span class="op" id="4520434">[</span><span class="op" id="4520435">:</span><span class="ident" id="4520436">n</span><span class="op" id="4520437">]</span><span class="op" id="4520438">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520442">p</span>&nbsp;<span class="op" id="4520444">=</span>&nbsp;<span class="ident" id="4520446">p</span><span class="op" id="4520447">[</span><span class="ident" id="4520448">n</span><span class="op" id="4520449">:</span><span class="op" id="4520450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520456">if</span>&nbsp;<span class="builtinfunc" id="4520459">len</span><span class="op" id="4520462">(</span><span class="ident" id="4520463">p</span><span class="op" id="4520464">)</span>&nbsp;<span class="op" id="4520466">&gt;</span>&nbsp;<span class="num" id="4520468">0</span>&nbsp;<span class="op" id="4520470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520474">d</span><span class="op" id="4520475">.</span><span class="ident" id="4520476">nx</span>&nbsp;<span class="op" id="4520479">=</span>&nbsp;<span class="builtinfunc" id="4520481">copy</span><span class="op" id="4520485">(</span><span class="ident" id="4520486">d</span><span class="op" id="4520487">.</span><span class="ident" id="4520488">x</span><span class="op" id="4520489">[</span><span class="op" id="4520490">:</span><span class="op" id="4520491">]</span><span class="op" id="4520492">,</span>&nbsp;<span class="ident" id="4520494">p</span><span class="op" id="4520495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520498">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520501">return</span><br>
<span class="lineno"></span><span class="op" id="4520508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520511">func</span>&nbsp;<span class="op" id="4520516">(</span><span class="ident" id="4520517">d0</span>&nbsp;<span class="op" id="4520520">*</span><span class="ident" id="4520521">digest</span><span class="op" id="4520527">)</span>&nbsp;<span class="ident" id="4520529">Sum</span><span class="op" id="4520532">(</span><span class="ident" id="4520533">in</span>&nbsp;<span class="op" id="4520536">[</span><span class="op" id="4520537">]</span><span class="builtintype" id="4520538">byte</span><span class="op" id="4520542">)</span>&nbsp;<span class="op" id="4520544">[</span><span class="op" id="4520545">]</span><span class="builtintype" id="4520546">byte</span>&nbsp;<span class="op" id="4520551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4520554">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520621">d</span>&nbsp;<span class="op" id="4520623">:=</span>&nbsp;<span class="builtinfunc" id="4520626">new</span><span class="op" id="4520629">(</span><span class="ident" id="4520630">digest</span><span class="op" id="4520636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520639">*</span><span class="ident" id="4520640">d</span>&nbsp;<span class="op" id="4520642">=</span>&nbsp;<span class="op" id="4520644">*</span><span class="ident" id="4520645">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520649">hash</span>&nbsp;<span class="op" id="4520654">:=</span>&nbsp;<span class="ident" id="4520657">d</span><span class="op" id="4520658">.</span><span class="ident" id="4520659">checkSum</span><span class="op" id="4520667">(</span><span class="op" id="4520668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520671">if</span>&nbsp;<span class="ident" id="4520674">d</span><span class="op" id="4520675">.</span><span class="ident" id="4520676">is384</span>&nbsp;<span class="op" id="4520682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520686">return</span>&nbsp;<span class="builtinfunc" id="4520693">append</span><span class="op" id="4520699">(</span><span class="ident" id="4520700">in</span><span class="op" id="4520702">,</span>&nbsp;<span class="ident" id="4520704">hash</span><span class="op" id="4520708">[</span><span class="op" id="4520709">:</span><span class="ident" id="4520710">Size384</span><span class="op" id="4520717">]</span><span class="op" id="4520718">...</span><span class="op" id="4520721">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520727">return</span>&nbsp;<span class="builtinfunc" id="4520734">append</span><span class="op" id="4520740">(</span><span class="ident" id="4520741">in</span><span class="op" id="4520743">,</span>&nbsp;<span class="ident" id="4520745">hash</span><span class="op" id="4520749">[</span><span class="op" id="4520750">:</span><span class="op" id="4520751">]</span><span class="op" id="4520752">...</span><span class="op" id="4520755">)</span><br>
<span class="lineno"></span><span class="op" id="4520757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4520760">func</span>&nbsp;<span class="op" id="4520765">(</span><span class="ident" id="4520766">d</span>&nbsp;<span class="op" id="4520768">*</span><span class="ident" id="4520769">digest</span><span class="op" id="4520775">)</span>&nbsp;<span class="ident" id="4520777">checkSum</span><span class="op" id="4520785">(</span><span class="op" id="4520786">)</span>&nbsp;<span class="op" id="4520788">[</span><span class="ident" id="4520789">Size</span><span class="op" id="4520793">]</span><span class="builtintype" id="4520794">byte</span>&nbsp;<span class="op" id="4520799">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4520802">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4520864">len</span>&nbsp;<span class="op" id="4520868">:=</span>&nbsp;<span class="ident" id="4520871">d</span><span class="op" id="4520872">.</span><span class="builtinfunc" id="4520873">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520878">var</span>&nbsp;<span class="ident" id="4520882">tmp</span>&nbsp;<span class="op" id="4520886">[</span><span class="num" id="4520887">128</span><span class="op" id="4520890">]</span><span class="builtintype" id="4520891">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520897">tmp</span><span class="op" id="4520900">[</span><span class="num" id="4520901">0</span><span class="op" id="4520902">]</span>&nbsp;<span class="op" id="4520904">=</span>&nbsp;<span class="num" id="4520906">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4520912">if</span>&nbsp;<span class="builtinfunc" id="4520915">len</span><span class="op" id="4520918">%</span><span class="num" id="4520919">128</span>&nbsp;<span class="op" id="4520923">&lt;</span>&nbsp;<span class="num" id="4520925">112</span>&nbsp;<span class="op" id="4520929">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520933">d</span><span class="op" id="4520934">.</span><span class="ident" id="4520935">Write</span><span class="op" id="4520940">(</span><span class="ident" id="4520941">tmp</span><span class="op" id="4520944">[</span><span class="num" id="4520945">0</span>&nbsp;<span class="op" id="4520947">:</span>&nbsp;<span class="num" id="4520949">112</span><span class="op" id="4520952">-</span><span class="builtinfunc" id="4520953">len</span><span class="op" id="4520956">%</span><span class="num" id="4520957">128</span><span class="op" id="4520960">]</span><span class="op" id="4520961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4520964">}</span>&nbsp;<span class="keyword" id="4520966">else</span>&nbsp;<span class="op" id="4520971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4520975">d</span><span class="op" id="4520976">.</span><span class="ident" id="4520977">Write</span><span class="op" id="4520982">(</span><span class="ident" id="4520983">tmp</span><span class="op" id="4520986">[</span><span class="num" id="4520987">0</span>&nbsp;<span class="op" id="4520989">:</span>&nbsp;<span class="num" id="4520991">128</span><span class="op" id="4520994">+</span><span class="num" id="4520995">112</span><span class="op" id="4520998">-</span><span class="builtinfunc" id="4520999">len</span><span class="op" id="4521002">%</span><span class="num" id="4521003">128</span><span class="op" id="4521006">]</span><span class="op" id="4521007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4521014">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521034">len</span>&nbsp;<span class="op" id="4521038">&lt;&lt;=</span>&nbsp;<span class="num" id="4521042">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521045">for</span>&nbsp;<span class="ident" id="4521049">i</span>&nbsp;<span class="op" id="4521051">:=</span>&nbsp;<span class="builtintype" id="4521054">uint</span><span class="op" id="4521058">(</span><span class="num" id="4521059">0</span><span class="op" id="4521060">)</span><span class="op" id="4521061">;</span>&nbsp;<span class="ident" id="4521063">i</span>&nbsp;<span class="op" id="4521065">&lt;</span>&nbsp;<span class="num" id="4521067">16</span><span class="op" id="4521069">;</span>&nbsp;<span class="ident" id="4521071">i</span><span class="op" id="4521072">++</span>&nbsp;<span class="op" id="4521075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521079">tmp</span><span class="op" id="4521082">[</span><span class="ident" id="4521083">i</span><span class="op" id="4521084">]</span>&nbsp;<span class="op" id="4521086">=</span>&nbsp;<span class="builtintype" id="4521088">byte</span><span class="op" id="4521092">(</span><span class="builtinfunc" id="4521093">len</span>&nbsp;<span class="op" id="4521097">&gt;&gt;</span>&nbsp;<span class="op" id="4521100">(</span><span class="num" id="4521101">120</span>&nbsp;<span class="op" id="4521105">-</span>&nbsp;<span class="num" id="4521107">8</span><span class="op" id="4521108">*</span><span class="ident" id="4521109">i</span><span class="op" id="4521110">)</span><span class="op" id="4521111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521114">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521117">d</span><span class="op" id="4521118">.</span><span class="ident" id="4521119">Write</span><span class="op" id="4521124">(</span><span class="ident" id="4521125">tmp</span><span class="op" id="4521128">[</span><span class="num" id="4521129">0</span><span class="op" id="4521130">:</span><span class="num" id="4521131">16</span><span class="op" id="4521133">]</span><span class="op" id="4521134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521138">if</span>&nbsp;<span class="ident" id="4521141">d</span><span class="op" id="4521142">.</span><span class="ident" id="4521143">nx</span>&nbsp;<span class="op" id="4521146">!=</span>&nbsp;<span class="num" id="4521149">0</span>&nbsp;<span class="op" id="4521151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521155">panic</span><span class="op" id="4521160">(</span><span class="string" id="4521161">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4521172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521175">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521179">h</span>&nbsp;<span class="op" id="4521181">:=</span>&nbsp;<span class="ident" id="4521184">d</span><span class="op" id="4521185">.</span><span class="ident" id="4521186">h</span><span class="op" id="4521187">[</span><span class="op" id="4521188">:</span><span class="op" id="4521189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521192">if</span>&nbsp;<span class="ident" id="4521195">d</span><span class="op" id="4521196">.</span><span class="ident" id="4521197">is384</span>&nbsp;<span class="op" id="4521203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521207">h</span>&nbsp;<span class="op" id="4521209">=</span>&nbsp;<span class="ident" id="4521211">d</span><span class="op" id="4521212">.</span><span class="ident" id="4521213">h</span><span class="op" id="4521214">[</span><span class="op" id="4521215">:</span><span class="num" id="4521216">6</span><span class="op" id="4521217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521220">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521224">var</span>&nbsp;<span class="ident" id="4521228">digest</span>&nbsp;<span class="op" id="4521235">[</span><span class="ident" id="4521236">Size</span><span class="op" id="4521240">]</span><span class="builtintype" id="4521241">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521247">for</span>&nbsp;<span class="ident" id="4521251">i</span><span class="op" id="4521252">,</span>&nbsp;<span class="ident" id="4521254">s</span>&nbsp;<span class="op" id="4521256">:=</span>&nbsp;<span class="keyword" id="4521259">range</span>&nbsp;<span class="ident" id="4521265">h</span>&nbsp;<span class="op" id="4521267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521271">digest</span><span class="op" id="4521277">[</span><span class="ident" id="4521278">i</span><span class="op" id="4521279">*</span><span class="num" id="4521280">8</span><span class="op" id="4521281">]</span>&nbsp;<span class="op" id="4521283">=</span>&nbsp;<span class="builtintype" id="4521285">byte</span><span class="op" id="4521289">(</span><span class="ident" id="4521290">s</span>&nbsp;<span class="op" id="4521292">&gt;&gt;</span>&nbsp;<span class="num" id="4521295">56</span><span class="op" id="4521297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521301">digest</span><span class="op" id="4521307">[</span><span class="ident" id="4521308">i</span><span class="op" id="4521309">*</span><span class="num" id="4521310">8</span><span class="op" id="4521311">+</span><span class="num" id="4521312">1</span><span class="op" id="4521313">]</span>&nbsp;<span class="op" id="4521315">=</span>&nbsp;<span class="builtintype" id="4521317">byte</span><span class="op" id="4521321">(</span><span class="ident" id="4521322">s</span>&nbsp;<span class="op" id="4521324">&gt;&gt;</span>&nbsp;<span class="num" id="4521327">48</span><span class="op" id="4521329">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521333">digest</span><span class="op" id="4521339">[</span><span class="ident" id="4521340">i</span><span class="op" id="4521341">*</span><span class="num" id="4521342">8</span><span class="op" id="4521343">+</span><span class="num" id="4521344">2</span><span class="op" id="4521345">]</span>&nbsp;<span class="op" id="4521347">=</span>&nbsp;<span class="builtintype" id="4521349">byte</span><span class="op" id="4521353">(</span><span class="ident" id="4521354">s</span>&nbsp;<span class="op" id="4521356">&gt;&gt;</span>&nbsp;<span class="num" id="4521359">40</span><span class="op" id="4521361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521365">digest</span><span class="op" id="4521371">[</span><span class="ident" id="4521372">i</span><span class="op" id="4521373">*</span><span class="num" id="4521374">8</span><span class="op" id="4521375">+</span><span class="num" id="4521376">3</span><span class="op" id="4521377">]</span>&nbsp;<span class="op" id="4521379">=</span>&nbsp;<span class="builtintype" id="4521381">byte</span><span class="op" id="4521385">(</span><span class="ident" id="4521386">s</span>&nbsp;<span class="op" id="4521388">&gt;&gt;</span>&nbsp;<span class="num" id="4521391">32</span><span class="op" id="4521393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521397">digest</span><span class="op" id="4521403">[</span><span class="ident" id="4521404">i</span><span class="op" id="4521405">*</span><span class="num" id="4521406">8</span><span class="op" id="4521407">+</span><span class="num" id="4521408">4</span><span class="op" id="4521409">]</span>&nbsp;<span class="op" id="4521411">=</span>&nbsp;<span class="builtintype" id="4521413">byte</span><span class="op" id="4521417">(</span><span class="ident" id="4521418">s</span>&nbsp;<span class="op" id="4521420">&gt;&gt;</span>&nbsp;<span class="num" id="4521423">24</span><span class="op" id="4521425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521429">digest</span><span class="op" id="4521435">[</span><span class="ident" id="4521436">i</span><span class="op" id="4521437">*</span><span class="num" id="4521438">8</span><span class="op" id="4521439">+</span><span class="num" id="4521440">5</span><span class="op" id="4521441">]</span>&nbsp;<span class="op" id="4521443">=</span>&nbsp;<span class="builtintype" id="4521445">byte</span><span class="op" id="4521449">(</span><span class="ident" id="4521450">s</span>&nbsp;<span class="op" id="4521452">&gt;&gt;</span>&nbsp;<span class="num" id="4521455">16</span><span class="op" id="4521457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521461">digest</span><span class="op" id="4521467">[</span><span class="ident" id="4521468">i</span><span class="op" id="4521469">*</span><span class="num" id="4521470">8</span><span class="op" id="4521471">+</span><span class="num" id="4521472">6</span><span class="op" id="4521473">]</span>&nbsp;<span class="op" id="4521475">=</span>&nbsp;<span class="builtintype" id="4521477">byte</span><span class="op" id="4521481">(</span><span class="ident" id="4521482">s</span>&nbsp;<span class="op" id="4521484">&gt;&gt;</span>&nbsp;<span class="num" id="4521487">8</span><span class="op" id="4521488">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521492">digest</span><span class="op" id="4521498">[</span><span class="ident" id="4521499">i</span><span class="op" id="4521500">*</span><span class="num" id="4521501">8</span><span class="op" id="4521502">+</span><span class="num" id="4521503">7</span><span class="op" id="4521504">]</span>&nbsp;<span class="op" id="4521506">=</span>&nbsp;<span class="builtintype" id="4521508">byte</span><span class="op" id="4521512">(</span><span class="ident" id="4521513">s</span><span class="op" id="4521514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4521517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521521">return</span>&nbsp;<span class="ident" id="4521528">digest</span><br>
<span class="lineno"></span><span class="op" id="4521535">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4521538">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4521589">func</span>&nbsp;<span class="ident" id="4521594">Sum512</span><span class="op" id="4521600">(</span><span class="ident" id="4521601">data</span>&nbsp;<span class="op" id="4521606">[</span><span class="op" id="4521607">]</span><span class="builtintype" id="4521608">byte</span><span class="op" id="4521612">)</span>&nbsp;<span class="op" id="4521614">[</span><span class="ident" id="4521615">Size</span><span class="op" id="4521619">]</span><span class="builtintype" id="4521620">byte</span>&nbsp;<span class="op" id="4521625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521628">var</span>&nbsp;<span class="ident" id="4521632">d</span>&nbsp;<span class="ident" id="4521634">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521642">d</span><span class="op" id="4521643">.</span><span class="ident" id="4521644">Reset</span><span class="op" id="4521649">(</span><span class="op" id="4521650">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521653">d</span><span class="op" id="4521654">.</span><span class="ident" id="4521655">Write</span><span class="op" id="4521660">(</span><span class="ident" id="4521661">data</span><span class="op" id="4521665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521668">return</span>&nbsp;<span class="ident" id="4521675">d</span><span class="op" id="4521676">.</span><span class="ident" id="4521677">checkSum</span><span class="op" id="4521685">(</span><span class="op" id="4521686">)</span><br>
<span class="lineno"></span><span class="op" id="4521688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4521691">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4521742">func</span>&nbsp;<span class="ident" id="4521747">Sum384</span><span class="op" id="4521753">(</span><span class="ident" id="4521754">data</span>&nbsp;<span class="op" id="4521759">[</span><span class="op" id="4521760">]</span><span class="builtintype" id="4521761">byte</span><span class="op" id="4521765">)</span>&nbsp;<span class="op" id="4521767">(</span><span class="ident" id="4521768">sum384</span>&nbsp;<span class="op" id="4521775">[</span><span class="ident" id="4521776">Size384</span><span class="op" id="4521783">]</span><span class="builtintype" id="4521784">byte</span><span class="op" id="4521788">)</span>&nbsp;<span class="op" id="4521790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521793">var</span>&nbsp;<span class="ident" id="4521797">d</span>&nbsp;<span class="ident" id="4521799">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521807">d</span><span class="op" id="4521808">.</span><span class="ident" id="4521809">is384</span>&nbsp;<span class="op" id="4521815">=</span>&nbsp;<span class="builtintype" id="4521817">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521823">d</span><span class="op" id="4521824">.</span><span class="ident" id="4521825">Reset</span><span class="op" id="4521830">(</span><span class="op" id="4521831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521834">d</span><span class="op" id="4521835">.</span><span class="ident" id="4521836">Write</span><span class="op" id="4521841">(</span><span class="ident" id="4521842">data</span><span class="op" id="4521846">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4521849">sum</span>&nbsp;<span class="op" id="4521853">:=</span>&nbsp;<span class="ident" id="4521856">d</span><span class="op" id="4521857">.</span><span class="ident" id="4521858">checkSum</span><span class="op" id="4521866">(</span><span class="op" id="4521867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4521870">copy</span><span class="op" id="4521874">(</span><span class="ident" id="4521875">sum384</span><span class="op" id="4521881">[</span><span class="op" id="4521882">:</span><span class="op" id="4521883">]</span><span class="op" id="4521884">,</span>&nbsp;<span class="ident" id="4521886">sum</span><span class="op" id="4521889">[</span><span class="op" id="4521890">:</span><span class="ident" id="4521891">Size384</span><span class="op" id="4521898">]</span><span class="op" id="4521899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4521902">return</span><br>
<span class="lineno"></span><span class="op" id="4521909">}</span>
</div>
</body>
</html>
