<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4118401">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4118456">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4118510">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4118561">package</span>&nbsp;<span class="ident" id="4118569">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4118574">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;the&nbsp;PSS&nbsp;signature&nbsp;scheme&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4118628">//</span><br>
<span class="lineno"></span><span class="comment" id="4118631">//&nbsp;[1]&nbsp;http://www.rsa.com/rsalabs/pkcs/files/h11300-wp-pkcs-1v2-2-rsa-cryptography-standard.pdf</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4118728">import</span>&nbsp;<span class="op" id="4118735">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118738">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118747">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118757">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118767">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118775">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4118781">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4118792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="4118795">func</span>&nbsp;<span class="ident" id="4118800">emsaPSSEncode</span><span class="op" id="4118813">(</span><span class="ident" id="4118814">mHash</span>&nbsp;<span class="op" id="4118820">[</span><span class="op" id="4118821">]</span><span class="builtintype" id="4118822">byte</span><span class="op" id="4118826">,</span>&nbsp;<span class="ident" id="4118828">emBits</span>&nbsp;<span class="builtintype" id="4118835">int</span><span class="op" id="4118838">,</span>&nbsp;<span class="ident" id="4118840">salt</span>&nbsp;<span class="op" id="4118845">[</span><span class="op" id="4118846">]</span><span class="builtintype" id="4118847">byte</span><span class="op" id="4118851">,</span>&nbsp;<span class="ident" id="4118853">hash</span>&nbsp;<span class="ident" id="4118858"><a href="/crypto/rsa/pss.go.html#4118767">hash</a></span><span class="op" id="4118862">.</span><span class="ident" id="4118863">Hash</span><span class="op" id="4118867">)</span>&nbsp;<span class="op" id="4118869">(</span><span class="op" id="4118870">[</span><span class="op" id="4118871">]</span><span class="builtintype" id="4118872">byte</span><span class="op" id="4118876">,</span>&nbsp;<span class="builtintype" id="4118878">error</span><span class="op" id="4118883">)</span>&nbsp;<span class="op" id="4118885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118888">//&nbsp;See&nbsp;[1],&nbsp;section&nbsp;9.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118915">hLen</span>&nbsp;<span class="op" id="4118920">:=</span>&nbsp;<span class="ident" id="4118923"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4118927">.</span><span class="ident" id="4118928">Size</span><span class="op" id="4118932">(</span><span class="op" id="4118933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118936">sLen</span>&nbsp;<span class="op" id="4118941">:=</span>&nbsp;<span class="builtinfunc" id="4118944">len</span><span class="op" id="4118947">(</span><span class="ident" id="4118948"><a href="/crypto/rsa/pss.go.html#4118840">salt</a></span><span class="op" id="4118952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4118955">emLen</span>&nbsp;<span class="op" id="4118961">:=</span>&nbsp;<span class="op" id="4118964">(</span><span class="ident" id="4118965"><a href="/crypto/rsa/pss.go.html#4118828">emBits</a></span>&nbsp;<span class="op" id="4118972">+</span>&nbsp;<span class="num" id="4118974">7</span><span class="op" id="4118975">)</span>&nbsp;<span class="op" id="4118977">/</span>&nbsp;<span class="num" id="4118979">8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4118983">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119055">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;message&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119126">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119150">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119154">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119216">if</span>&nbsp;<span class="builtinfunc" id="4119219">len</span><span class="op" id="4119222">(</span><span class="ident" id="4119223"><a href="/crypto/rsa/pss.go.html#4118814">mHash</a></span><span class="op" id="4119228">)</span>&nbsp;<span class="op" id="4119230">!=</span>&nbsp;<span class="ident" id="4119233"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span>&nbsp;<span class="op" id="4119238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119242">return</span>&nbsp;<span class="ident" id="4119249">nil</span><span class="op" id="4119252">,</span>&nbsp;<span class="ident" id="4119254"><a href="/crypto/rsa/pss.go.html#4118757">errors</a></span><span class="op" id="4119260">.</span><span class="ident" id="4119261">New</span><span class="op" id="4119264">(</span><span class="string" id="4119265">&#34;crypto/rsa:&nbsp;input&nbsp;must&nbsp;be&nbsp;hashed&nbsp;message&#34;</span><span class="op" id="4119307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119310">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119314">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;encoding&nbsp;error&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119385">if</span>&nbsp;<span class="ident" id="4119388"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span>&nbsp;<span class="op" id="4119394">&lt;</span>&nbsp;<span class="ident" id="4119396"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span><span class="op" id="4119400">+</span><span class="ident" id="4119401"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4119405">+</span><span class="num" id="4119406">2</span>&nbsp;<span class="op" id="4119408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119412">return</span>&nbsp;<span class="ident" id="4119419">nil</span><span class="op" id="4119422">,</span>&nbsp;<span class="ident" id="4119424"><a href="/crypto/rsa/pss.go.html#4118757">errors</a></span><span class="op" id="4119430">.</span><span class="ident" id="4119431">New</span><span class="op" id="4119434">(</span><span class="string" id="4119435">&#34;crypto/rsa:&nbsp;encoding&nbsp;error&#34;</span><span class="op" id="4119463">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4119466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119470">em</span>&nbsp;<span class="op" id="4119473">:=</span>&nbsp;<span class="builtinfunc" id="4119476">make</span><span class="op" id="4119480">(</span><span class="op" id="4119481">[</span><span class="op" id="4119482">]</span><span class="builtintype" id="4119483">byte</span><span class="op" id="4119487">,</span>&nbsp;<span class="ident" id="4119489"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4119494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119497">db</span>&nbsp;<span class="op" id="4119500">:=</span>&nbsp;<span class="ident" id="4119503"><a href="/crypto/rsa/pss.go.html#4119470">em</a></span><span class="op" id="4119505">[</span><span class="op" id="4119506">:</span><span class="ident" id="4119507"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4119512">-</span><span class="ident" id="4119513"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4119517">-</span><span class="ident" id="4119518"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span><span class="op" id="4119522">-</span><span class="num" id="4119523">2</span><span class="op" id="4119524">+</span><span class="num" id="4119525">1</span><span class="op" id="4119526">+</span><span class="ident" id="4119527"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4119531">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119534">h</span>&nbsp;<span class="op" id="4119536">:=</span>&nbsp;<span class="ident" id="4119539"><a href="/crypto/rsa/pss.go.html#4119470">em</a></span><span class="op" id="4119541">[</span><span class="ident" id="4119542"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4119547">-</span><span class="ident" id="4119548"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4119552">-</span><span class="ident" id="4119553"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span><span class="op" id="4119557">-</span><span class="num" id="4119558">2</span><span class="op" id="4119559">+</span><span class="num" id="4119560">1</span><span class="op" id="4119561">+</span><span class="ident" id="4119562"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span>&nbsp;<span class="op" id="4119567">:</span>&nbsp;<span class="ident" id="4119569"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4119574">-</span><span class="num" id="4119575">1</span><span class="op" id="4119576">]</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119580">//&nbsp;4.&nbsp;&nbsp;Generate&nbsp;a&nbsp;random&nbsp;octet&nbsp;string&nbsp;salt&nbsp;of&nbsp;length&nbsp;sLen;&nbsp;if&nbsp;sLen&nbsp;=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119653">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;salt&nbsp;is&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119692">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119696">//&nbsp;5.&nbsp;&nbsp;Let</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119708">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119769">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119869">//</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4119873">//&nbsp;6.&nbsp;&nbsp;Let&nbsp;H&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4119932">var</span>&nbsp;<span class="ident" id="4119936">prefix</span>&nbsp;<span class="op" id="4119943">[</span><span class="num" id="4119944">8</span><span class="op" id="4119945">]</span><span class="builtintype" id="4119946">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119953"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4119957">.</span><span class="ident" id="4119958">Write</span><span class="op" id="4119963">(</span><span class="ident" id="4119964"><a href="/crypto/rsa/pss.go.html#4119936">prefix</a></span><span class="op" id="4119970">[</span><span class="op" id="4119971">:</span><span class="op" id="4119972">]</span><span class="op" id="4119973">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119976"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4119980">.</span><span class="ident" id="4119981">Write</span><span class="op" id="4119986">(</span><span class="ident" id="4119987"><a href="/crypto/rsa/pss.go.html#4118814">mHash</a></span><span class="op" id="4119992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4119995"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4119999">.</span><span class="ident" id="4120000">Write</span><span class="op" id="4120005">(</span><span class="ident" id="4120006"><a href="/crypto/rsa/pss.go.html#4118840">salt</a></span><span class="op" id="4120010">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120014"><a href="/crypto/rsa/pss.go.html#4119534">h</a></span>&nbsp;<span class="op" id="4120016">=</span>&nbsp;<span class="ident" id="4120018"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4120022">.</span><span class="ident" id="4120023">Sum</span><span class="op" id="4120026">(</span><span class="ident" id="4120027"><a href="/crypto/rsa/pss.go.html#4119534">h</a></span><span class="op" id="4120028">[</span><span class="op" id="4120029">:</span><span class="num" id="4120030">0</span><span class="op" id="4120031">]</span><span class="op" id="4120032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120035"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4120039">.</span><span class="ident" id="4120040">Reset</span><span class="op" id="4120045">(</span><span class="op" id="4120046">)</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120050">//&nbsp;7.&nbsp;&nbsp;Generate&nbsp;an&nbsp;octet&nbsp;string&nbsp;PS&nbsp;consisting&nbsp;of&nbsp;emLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero&nbsp;octets.&nbsp;&nbsp;The&nbsp;length&nbsp;of&nbsp;PS&nbsp;may&nbsp;be&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120173">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120177">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;PS&nbsp;||&nbsp;0x01&nbsp;||&nbsp;salt;&nbsp;DB&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120273"><a href="/crypto/rsa/pss.go.html#4119497">db</a></span><span class="op" id="4120275">[</span><span class="ident" id="4120276"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4120281">-</span><span class="ident" id="4120282"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4120286">-</span><span class="ident" id="4120287"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span><span class="op" id="4120291">-</span><span class="num" id="4120292">2</span><span class="op" id="4120293">]</span>&nbsp;<span class="op" id="4120295">=</span>&nbsp;<span class="num" id="4120297">0x01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4120303">copy</span><span class="op" id="4120307">(</span><span class="ident" id="4120308"><a href="/crypto/rsa/pss.go.html#4119497">db</a></span><span class="op" id="4120310">[</span><span class="ident" id="4120311"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4120316">-</span><span class="ident" id="4120317"><a href="/crypto/rsa/pss.go.html#4118936">sLen</a></span><span class="op" id="4120321">-</span><span class="ident" id="4120322"><a href="/crypto/rsa/pss.go.html#4118915">hLen</a></span><span class="op" id="4120326">-</span><span class="num" id="4120327">1</span><span class="op" id="4120328">:</span><span class="op" id="4120329">]</span><span class="op" id="4120330">,</span>&nbsp;<span class="ident" id="4120332"><a href="/crypto/rsa/pss.go.html#4118840">salt</a></span><span class="op" id="4120336">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120340">//&nbsp;9.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120387">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120391">//&nbsp;10.&nbsp;Let&nbsp;maskedDB&nbsp;=&nbsp;DB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120431"><a href="/crypto/rsa/rsa.go.html#4134519">mgf1XOR</a></span><span class="op" id="4120438">(</span><span class="ident" id="4120439"><a href="/crypto/rsa/pss.go.html#4119497">db</a></span><span class="op" id="4120441">,</span>&nbsp;<span class="ident" id="4120443"><a href="/crypto/rsa/pss.go.html#4118853">hash</a></span><span class="op" id="4120447">,</span>&nbsp;<span class="ident" id="4120449"><a href="/crypto/rsa/pss.go.html#4119534">h</a></span><span class="op" id="4120450">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120454">//&nbsp;11.&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;to&nbsp;zero.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120555"><a href="/crypto/rsa/pss.go.html#4119497">db</a></span><span class="op" id="4120557">[</span><span class="num" id="4120558">0</span><span class="op" id="4120559">]</span>&nbsp;<span class="op" id="4120561">&amp;=</span>&nbsp;<span class="op" id="4120564">(</span><span class="num" id="4120565">0xFF</span>&nbsp;<span class="op" id="4120570">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4120573">uint</span><span class="op" id="4120577">(</span><span class="num" id="4120578">8</span><span class="op" id="4120579">*</span><span class="ident" id="4120580"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4120585">-</span><span class="ident" id="4120586"><a href="/crypto/rsa/pss.go.html#4118828">emBits</a></span><span class="op" id="4120592">)</span><span class="op" id="4120593">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120597">//&nbsp;12.&nbsp;Let&nbsp;EM&nbsp;=&nbsp;maskedDB&nbsp;||&nbsp;H&nbsp;||&nbsp;0xbc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4120637"><a href="/crypto/rsa/pss.go.html#4119470">em</a></span><span class="op" id="4120639">[</span><span class="ident" id="4120640"><a href="/crypto/rsa/pss.go.html#4118955">emLen</a></span><span class="op" id="4120645">-</span><span class="num" id="4120646">1</span><span class="op" id="4120647">]</span>&nbsp;<span class="op" id="4120649">=</span>&nbsp;<span class="num" id="4120651">0xBC</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120658">//&nbsp;13.&nbsp;Output&nbsp;EM.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4120677">return</span>&nbsp;<span class="ident" id="4120684"><a href="/crypto/rsa/pss.go.html#4119470">em</a></span><span class="op" id="4120686">,</span>&nbsp;<span class="ident" id="4120688">nil</span><br>
<span class="lineno"></span><span class="op" id="4120692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4120695">func</span>&nbsp;<span class="ident" id="4120700">emsaPSSVerify</span><span class="op" id="4120713">(</span><span class="ident" id="4120714">mHash</span><span class="op" id="4120719">,</span>&nbsp;<span class="ident" id="4120721">em</span>&nbsp;<span class="op" id="4120724">[</span><span class="op" id="4120725">]</span><span class="builtintype" id="4120726">byte</span><span class="op" id="4120730">,</span>&nbsp;<span class="ident" id="4120732">emBits</span><span class="op" id="4120738">,</span>&nbsp;<span class="ident" id="4120740">sLen</span>&nbsp;<span class="builtintype" id="4120745">int</span><span class="op" id="4120748">,</span>&nbsp;<span class="ident" id="4120750">hash</span>&nbsp;<span class="ident" id="4120755"><a href="/crypto/rsa/pss.go.html#4118767">hash</a></span><span class="op" id="4120759">.</span><span class="ident" id="4120760">Hash</span><span class="op" id="4120764">)</span>&nbsp;<span class="builtintype" id="4120766">error</span>&nbsp;<span class="op" id="4120772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120775">//&nbsp;1.&nbsp;&nbsp;If&nbsp;the&nbsp;length&nbsp;of&nbsp;M&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;input&nbsp;limitation&nbsp;for&nbsp;the</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash&nbsp;function&nbsp;(2^61&nbsp;-&nbsp;1&nbsp;octets&nbsp;for&nbsp;SHA-1),&nbsp;output&nbsp;&#34;inconsistent&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120920">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120938">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4120942">//&nbsp;2.&nbsp;&nbsp;Let&nbsp;mHash&nbsp;=&nbsp;Hash(M),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121003">hLen</span>&nbsp;<span class="op" id="4121008">:=</span>&nbsp;<span class="ident" id="4121011"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4121015">.</span><span class="ident" id="4121016">Size</span><span class="op" id="4121020">(</span><span class="op" id="4121021">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121024">if</span>&nbsp;<span class="ident" id="4121027"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span>&nbsp;<span class="op" id="4121032">!=</span>&nbsp;<span class="builtinfunc" id="4121035">len</span><span class="op" id="4121038">(</span><span class="ident" id="4121039"><a href="/crypto/rsa/pss.go.html#4120714">mHash</a></span><span class="op" id="4121044">)</span>&nbsp;<span class="op" id="4121046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121050">return</span>&nbsp;<span class="ident" id="4121057"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121078">//&nbsp;3.&nbsp;&nbsp;If&nbsp;emLen&nbsp;&lt;&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;+&nbsp;2,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121146">emLen</span>&nbsp;<span class="op" id="4121152">:=</span>&nbsp;<span class="op" id="4121155">(</span><span class="ident" id="4121156"><a href="/crypto/rsa/pss.go.html#4120732">emBits</a></span>&nbsp;<span class="op" id="4121163">+</span>&nbsp;<span class="num" id="4121165">7</span><span class="op" id="4121166">)</span>&nbsp;<span class="op" id="4121168">/</span>&nbsp;<span class="num" id="4121170">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121173">if</span>&nbsp;<span class="ident" id="4121176"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span>&nbsp;<span class="op" id="4121182">&lt;</span>&nbsp;<span class="ident" id="4121184"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4121188">+</span><span class="ident" id="4121189"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4121193">+</span><span class="num" id="4121194">2</span>&nbsp;<span class="op" id="4121196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121200">return</span>&nbsp;<span class="ident" id="4121207"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121228">//&nbsp;4.&nbsp;&nbsp;If&nbsp;the&nbsp;rightmost&nbsp;octet&nbsp;of&nbsp;EM&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121297">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbc,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121343">if</span>&nbsp;<span class="ident" id="4121346"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121348">[</span><span class="builtinfunc" id="4121349">len</span><span class="op" id="4121352">(</span><span class="ident" id="4121353"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121355">)</span><span class="op" id="4121356">-</span><span class="num" id="4121357">1</span><span class="op" id="4121358">]</span>&nbsp;<span class="op" id="4121360">!=</span>&nbsp;<span class="num" id="4121363">0xBC</span>&nbsp;<span class="op" id="4121368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121372">return</span>&nbsp;<span class="ident" id="4121379"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121396">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121400">//&nbsp;5.&nbsp;&nbsp;Let&nbsp;maskedDB&nbsp;be&nbsp;the&nbsp;leftmost&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1&nbsp;octets&nbsp;of&nbsp;EM,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;H&nbsp;be&nbsp;the&nbsp;next&nbsp;hLen&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121511">db</span>&nbsp;<span class="op" id="4121514">:=</span>&nbsp;<span class="ident" id="4121517"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121519">[</span><span class="op" id="4121520">:</span><span class="ident" id="4121521"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4121526">-</span><span class="ident" id="4121527"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4121531">-</span><span class="num" id="4121532">1</span><span class="op" id="4121533">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121536">h</span>&nbsp;<span class="op" id="4121538">:=</span>&nbsp;<span class="ident" id="4121541"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121543">[</span><span class="ident" id="4121544"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4121549">-</span><span class="ident" id="4121550"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4121554">-</span><span class="num" id="4121555">1</span>&nbsp;<span class="op" id="4121557">:</span>&nbsp;<span class="builtinfunc" id="4121559">len</span><span class="op" id="4121562">(</span><span class="ident" id="4121563"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121565">)</span><span class="op" id="4121566">-</span><span class="num" id="4121567">1</span><span class="op" id="4121568">]</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121572">//&nbsp;6.&nbsp;&nbsp;If&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121645">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskedDB&nbsp;are&nbsp;not&nbsp;all&nbsp;equal&nbsp;to&nbsp;zero,&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121729">if</span>&nbsp;<span class="ident" id="4121732"><a href="/crypto/rsa/pss.go.html#4120721">em</a></span><span class="op" id="4121734">[</span><span class="num" id="4121735">0</span><span class="op" id="4121736">]</span><span class="op" id="4121737">&amp;</span><span class="op" id="4121738">(</span><span class="num" id="4121739">0xFF</span><span class="op" id="4121743">&lt;&lt;</span><span class="builtintype" id="4121745">uint</span><span class="op" id="4121749">(</span><span class="num" id="4121750">8</span><span class="op" id="4121751">-</span><span class="op" id="4121752">(</span><span class="num" id="4121753">8</span><span class="op" id="4121754">*</span><span class="ident" id="4121755"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4121760">-</span><span class="ident" id="4121761"><a href="/crypto/rsa/pss.go.html#4120732">emBits</a></span><span class="op" id="4121767">)</span><span class="op" id="4121768">)</span><span class="op" id="4121769">)</span>&nbsp;<span class="op" id="4121771">!=</span>&nbsp;<span class="num" id="4121774">0</span>&nbsp;<span class="op" id="4121776">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4121780">return</span>&nbsp;<span class="ident" id="4121787"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4121804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121808">//&nbsp;7.&nbsp;&nbsp;Let&nbsp;dbMask&nbsp;=&nbsp;MGF(H,&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121855">//</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121859">//&nbsp;8.&nbsp;&nbsp;Let&nbsp;DB&nbsp;=&nbsp;maskedDB&nbsp;\xor&nbsp;dbMask.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4121898"><a href="/crypto/rsa/rsa.go.html#4134519">mgf1XOR</a></span><span class="op" id="4121905">(</span><span class="ident" id="4121906"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4121908">,</span>&nbsp;<span class="ident" id="4121910"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4121914">,</span>&nbsp;<span class="ident" id="4121916"><a href="/crypto/rsa/pss.go.html#4121536">h</a></span><span class="op" id="4121917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121921">//&nbsp;9.&nbsp;&nbsp;Set&nbsp;the&nbsp;leftmost&nbsp;8&nbsp;*&nbsp;emLen&nbsp;-&nbsp;emBits&nbsp;bits&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;octet&nbsp;in&nbsp;DB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4121998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;zero.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122015"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122017">[</span><span class="num" id="4122018">0</span><span class="op" id="4122019">]</span>&nbsp;<span class="op" id="4122021">&amp;=</span>&nbsp;<span class="op" id="4122024">(</span><span class="num" id="4122025">0xFF</span>&nbsp;<span class="op" id="4122030">&gt;&gt;</span>&nbsp;<span class="builtintype" id="4122033">uint</span><span class="op" id="4122037">(</span><span class="num" id="4122038">8</span><span class="op" id="4122039">*</span><span class="ident" id="4122040"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4122045">-</span><span class="ident" id="4122046"><a href="/crypto/rsa/pss.go.html#4120732">emBits</a></span><span class="op" id="4122052">)</span><span class="op" id="4122053">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122057">if</span>&nbsp;<span class="ident" id="4122060"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span>&nbsp;<span class="op" id="4122065">==</span>&nbsp;<span class="ident" id="4122068"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span>&nbsp;<span class="op" id="4122086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122089">FindSaltLength</span><span class="op" id="4122103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122107">for</span>&nbsp;<span class="ident" id="4122111"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span>&nbsp;<span class="op" id="4122116">=</span>&nbsp;<span class="ident" id="4122118"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span>&nbsp;<span class="op" id="4122124">-</span>&nbsp;<span class="op" id="4122126">(</span><span class="ident" id="4122127"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span>&nbsp;<span class="op" id="4122132">+</span>&nbsp;<span class="num" id="4122134">2</span><span class="op" id="4122135">)</span><span class="op" id="4122136">;</span>&nbsp;<span class="ident" id="4122138"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span>&nbsp;<span class="op" id="4122143">&gt;=</span>&nbsp;<span class="num" id="4122146">0</span><span class="op" id="4122147">;</span>&nbsp;<span class="ident" id="4122149"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4122153">--</span>&nbsp;<span class="op" id="4122156">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122161">switch</span>&nbsp;<span class="ident" id="4122168"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122170">[</span><span class="ident" id="4122171"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4122176">-</span><span class="ident" id="4122177"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4122181">-</span><span class="ident" id="4122182"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4122186">-</span><span class="num" id="4122187">2</span><span class="op" id="4122188">]</span>&nbsp;<span class="op" id="4122190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122195">case</span>&nbsp;<span class="num" id="4122200">1</span><span class="op" id="4122201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122207">break</span>&nbsp;<span class="ident" id="4122213">FindSaltLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122231">case</span>&nbsp;<span class="num" id="4122236">0</span><span class="op" id="4122237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122243">continue</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122255">default</span><span class="op" id="4122262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122268">return</span>&nbsp;<span class="ident" id="4122275"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122302">if</span>&nbsp;<span class="ident" id="4122305"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span>&nbsp;<span class="op" id="4122310">&lt;</span>&nbsp;<span class="num" id="4122312">0</span>&nbsp;<span class="op" id="4122314">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122319">return</span>&nbsp;<span class="ident" id="4122326"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122347">}</span>&nbsp;<span class="keyword" id="4122349">else</span>&nbsp;<span class="op" id="4122354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122358">//&nbsp;10.&nbsp;If&nbsp;the&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;2&nbsp;leftmost&nbsp;octets&nbsp;of&nbsp;DB&nbsp;are&nbsp;not&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122433">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;if&nbsp;the&nbsp;octet&nbsp;at&nbsp;position&nbsp;emLen&nbsp;-&nbsp;hLen&nbsp;-&nbsp;sLen&nbsp;-&nbsp;1&nbsp;(the&nbsp;leftmost</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;is&nbsp;&#34;position&nbsp;1&#34;)&nbsp;does&nbsp;not&nbsp;have&nbsp;hexadecimal&nbsp;value&nbsp;0x01,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122581">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;&#34;inconsistent&#34;&nbsp;and&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122622">for</span>&nbsp;<span class="ident" id="4122626">_</span><span class="op" id="4122627">,</span>&nbsp;<span class="ident" id="4122629">e</span>&nbsp;<span class="op" id="4122631">:=</span>&nbsp;<span class="keyword" id="4122634">range</span>&nbsp;<span class="ident" id="4122640"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122642">[</span><span class="op" id="4122643">:</span><span class="ident" id="4122644"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4122649">-</span><span class="ident" id="4122650"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4122654">-</span><span class="ident" id="4122655"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4122659">-</span><span class="num" id="4122660">2</span><span class="op" id="4122661">]</span>&nbsp;<span class="op" id="4122663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122668">if</span>&nbsp;<span class="ident" id="4122671"><a href="/crypto/rsa/pss.go.html#4122629">e</a></span>&nbsp;<span class="op" id="4122673">!=</span>&nbsp;<span class="num" id="4122676">0x00</span>&nbsp;<span class="op" id="4122681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122687">return</span>&nbsp;<span class="ident" id="4122694"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122721">if</span>&nbsp;<span class="ident" id="4122724"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122726">[</span><span class="ident" id="4122727"><a href="/crypto/rsa/pss.go.html#4121146">emLen</a></span><span class="op" id="4122732">-</span><span class="ident" id="4122733"><a href="/crypto/rsa/pss.go.html#4121003">hLen</a></span><span class="op" id="4122737">-</span><span class="ident" id="4122738"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4122742">-</span><span class="num" id="4122743">2</span><span class="op" id="4122744">]</span>&nbsp;<span class="op" id="4122746">!=</span>&nbsp;<span class="num" id="4122749">0x01</span>&nbsp;<span class="op" id="4122754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4122759">return</span>&nbsp;<span class="ident" id="4122766"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122784">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4122787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122791">//&nbsp;11.&nbsp;&nbsp;Let&nbsp;salt&nbsp;be&nbsp;the&nbsp;last&nbsp;sLen&nbsp;octets&nbsp;of&nbsp;DB.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4122840">salt</span>&nbsp;<span class="op" id="4122845">:=</span>&nbsp;<span class="ident" id="4122848"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122850">[</span><span class="builtinfunc" id="4122851">len</span><span class="op" id="4122854">(</span><span class="ident" id="4122855"><a href="/crypto/rsa/pss.go.html#4121511">db</a></span><span class="op" id="4122857">)</span><span class="op" id="4122858">-</span><span class="ident" id="4122859"><a href="/crypto/rsa/pss.go.html#4120740">sLen</a></span><span class="op" id="4122863">:</span><span class="op" id="4122864">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122868">//&nbsp;12.&nbsp;&nbsp;Let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;=&nbsp;(0x)00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;||&nbsp;mHash&nbsp;||&nbsp;salt&nbsp;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4122946">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&#39;&nbsp;is&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;8&nbsp;+&nbsp;hLen&nbsp;+&nbsp;sLen&nbsp;with&nbsp;eight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123013">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;zero&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123042">//</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123046">//&nbsp;13.&nbsp;Let&nbsp;H&#39;&nbsp;=&nbsp;Hash(M&#39;),&nbsp;an&nbsp;octet&nbsp;string&nbsp;of&nbsp;length&nbsp;hLen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123105">var</span>&nbsp;<span class="ident" id="4123109">prefix</span>&nbsp;<span class="op" id="4123116">[</span><span class="num" id="4123117">8</span><span class="op" id="4123118">]</span><span class="builtintype" id="4123119">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123125"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4123129">.</span><span class="ident" id="4123130">Write</span><span class="op" id="4123135">(</span><span class="ident" id="4123136"><a href="/crypto/rsa/pss.go.html#4123109">prefix</a></span><span class="op" id="4123142">[</span><span class="op" id="4123143">:</span><span class="op" id="4123144">]</span><span class="op" id="4123145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123148"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4123152">.</span><span class="ident" id="4123153">Write</span><span class="op" id="4123158">(</span><span class="ident" id="4123159"><a href="/crypto/rsa/pss.go.html#4120714">mHash</a></span><span class="op" id="4123164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123167"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4123171">.</span><span class="ident" id="4123172">Write</span><span class="op" id="4123177">(</span><span class="ident" id="4123178"><a href="/crypto/rsa/pss.go.html#4122840">salt</a></span><span class="op" id="4123182">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123186">h0</span>&nbsp;<span class="op" id="4123189">:=</span>&nbsp;<span class="ident" id="4123192"><a href="/crypto/rsa/pss.go.html#4120750">hash</a></span><span class="op" id="4123196">.</span><span class="ident" id="4123197">Sum</span><span class="op" id="4123200">(</span><span class="ident" id="4123201">nil</span><span class="op" id="4123204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4123208">//&nbsp;14.&nbsp;If&nbsp;H&nbsp;=&nbsp;H&#39;,&nbsp;output&nbsp;&#34;consistent.&#34;&nbsp;Otherwise,&nbsp;output&nbsp;&#34;inconsistent.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123282">if</span>&nbsp;<span class="op" id="4123285">!</span><span class="ident" id="4123286"><a href="/crypto/rsa/pss.go.html#4118738">bytes</a></span><span class="op" id="4123291">.</span><span class="ident" id="4123292">Equal</span><span class="op" id="4123297">(</span><span class="ident" id="4123298"><a href="/crypto/rsa/pss.go.html#4123186">h0</a></span><span class="op" id="4123300">,</span>&nbsp;<span class="ident" id="4123302"><a href="/crypto/rsa/pss.go.html#4121536">h</a></span><span class="op" id="4123303">)</span>&nbsp;<span class="op" id="4123305">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123309">return</span>&nbsp;<span class="ident" id="4123316"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123336">return</span>&nbsp;<span class="ident" id="4123343">nil</span><br>
<span class="lineno"></span><span class="op" id="4123347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4123350">//&nbsp;signPSSWithSalt&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;PSS&nbsp;[1]&nbsp;with&nbsp;specified&nbsp;salt.</span><br>
<span class="lineno"></span><span class="comment" id="4123439">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4123517">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;salt&nbsp;is&nbsp;a&nbsp;random&nbsp;sequence&nbsp;of&nbsp;bytes&nbsp;whose&nbsp;length&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4123597">//&nbsp;later&nbsp;used&nbsp;to&nbsp;verify&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4123636">func</span>&nbsp;<span class="ident" id="4123641">signPSSWithSalt</span><span class="op" id="4123656">(</span><span class="ident" id="4123657">rand</span>&nbsp;<span class="ident" id="4123662"><a href="/crypto/rsa/pss.go.html#4118775">io</a></span><span class="op" id="4123664">.</span><span class="ident" id="4123665">Reader</span><span class="op" id="4123671">,</span>&nbsp;<span class="ident" id="4123673">priv</span>&nbsp;<span class="op" id="4123678">*</span><span class="ident" id="4123679"><a href="/crypto/rsa/rsa.go.html#4128208">PrivateKey</a></span><span class="op" id="4123689">,</span>&nbsp;<span class="ident" id="4123691">hash</span>&nbsp;<span class="ident" id="4123696"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4123702">.</span><span class="ident" id="4123703">Hash</span><span class="op" id="4123707">,</span>&nbsp;<span class="ident" id="4123709">hashed</span><span class="op" id="4123715">,</span>&nbsp;<span class="ident" id="4123717">salt</span>&nbsp;<span class="op" id="4123722">[</span><span class="op" id="4123723">]</span><span class="builtintype" id="4123724">byte</span><span class="op" id="4123728">)</span>&nbsp;<span class="op" id="4123730">(</span><span class="ident" id="4123731">s</span>&nbsp;<span class="op" id="4123733">[</span><span class="op" id="4123734">]</span><span class="builtintype" id="4123735">byte</span><span class="op" id="4123739">,</span>&nbsp;<span class="ident" id="4123741">err</span>&nbsp;<span class="builtintype" id="4123745">error</span><span class="op" id="4123750">)</span>&nbsp;<span class="op" id="4123752">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123755">nBits</span>&nbsp;<span class="op" id="4123761">:=</span>&nbsp;<span class="ident" id="4123764"><a href="/crypto/rsa/pss.go.html#4123673">priv</a></span><span class="op" id="4123768">.</span><span class="ident" id="4123769">N</span><span class="op" id="4123770">.</span><span class="ident" id="4123771">BitLen</span><span class="op" id="4123777">(</span><span class="op" id="4123778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123781">em</span><span class="op" id="4123783">,</span>&nbsp;<span class="ident" id="4123785"><a href="/crypto/rsa/pss.go.html#4123741">err</a></span>&nbsp;<span class="op" id="4123789">:=</span>&nbsp;<span class="ident" id="4123792"><a href="/crypto/rsa/pss.go.html#4118800">emsaPSSEncode</a></span><span class="op" id="4123805">(</span><span class="ident" id="4123806"><a href="/crypto/rsa/pss.go.html#4123709">hashed</a></span><span class="op" id="4123812">,</span>&nbsp;<span class="ident" id="4123814"><a href="/crypto/rsa/pss.go.html#4123755">nBits</a></span><span class="op" id="4123819">-</span><span class="num" id="4123820">1</span><span class="op" id="4123821">,</span>&nbsp;<span class="ident" id="4123823"><a href="/crypto/rsa/pss.go.html#4123717">salt</a></span><span class="op" id="4123827">,</span>&nbsp;<span class="ident" id="4123829"><a href="/crypto/rsa/pss.go.html#4123691">hash</a></span><span class="op" id="4123833">.</span><span class="ident" id="4123834">New</span><span class="op" id="4123837">(</span><span class="op" id="4123838">)</span><span class="op" id="4123839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123842">if</span>&nbsp;<span class="ident" id="4123845"><a href="/crypto/rsa/pss.go.html#4123741">err</a></span>&nbsp;<span class="op" id="4123849">!=</span>&nbsp;<span class="ident" id="4123852">nil</span>&nbsp;<span class="op" id="4123856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123868">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123871">m</span>&nbsp;<span class="op" id="4123873">:=</span>&nbsp;<span class="builtinfunc" id="4123876">new</span><span class="op" id="4123879">(</span><span class="ident" id="4123880"><a href="/crypto/rsa/pss.go.html#4118781">big</a></span><span class="op" id="4123883">.</span><span class="ident" id="4123884">Int</span><span class="op" id="4123887">)</span><span class="op" id="4123888">.</span><span class="ident" id="4123889">SetBytes</span><span class="op" id="4123897">(</span><span class="ident" id="4123898"><a href="/crypto/rsa/pss.go.html#4123781">em</a></span><span class="op" id="4123900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123903">c</span><span class="op" id="4123904">,</span>&nbsp;<span class="ident" id="4123906"><a href="/crypto/rsa/pss.go.html#4123741">err</a></span>&nbsp;<span class="op" id="4123910">:=</span>&nbsp;<span class="ident" id="4123913"><a href="/crypto/rsa/rsa.go.html#4138388">decrypt</a></span><span class="op" id="4123920">(</span><span class="ident" id="4123921"><a href="/crypto/rsa/pss.go.html#4123657">rand</a></span><span class="op" id="4123925">,</span>&nbsp;<span class="ident" id="4123927"><a href="/crypto/rsa/pss.go.html#4123673">priv</a></span><span class="op" id="4123931">,</span>&nbsp;<span class="ident" id="4123933"><a href="/crypto/rsa/pss.go.html#4123871">m</a></span><span class="op" id="4123934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123937">if</span>&nbsp;<span class="ident" id="4123940"><a href="/crypto/rsa/pss.go.html#4123741">err</a></span>&nbsp;<span class="op" id="4123944">!=</span>&nbsp;<span class="ident" id="4123947">nil</span>&nbsp;<span class="op" id="4123951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4123955">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4123963">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123966"><a href="/crypto/rsa/pss.go.html#4123731">s</a></span>&nbsp;<span class="op" id="4123968">=</span>&nbsp;<span class="builtinfunc" id="4123970">make</span><span class="op" id="4123974">(</span><span class="op" id="4123975">[</span><span class="op" id="4123976">]</span><span class="builtintype" id="4123977">byte</span><span class="op" id="4123981">,</span>&nbsp;<span class="op" id="4123983">(</span><span class="ident" id="4123984"><a href="/crypto/rsa/pss.go.html#4123755">nBits</a></span><span class="op" id="4123989">+</span><span class="num" id="4123990">7</span><span class="op" id="4123991">)</span><span class="op" id="4123992">/</span><span class="num" id="4123993">8</span><span class="op" id="4123994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4123997"><a href="/crypto/rsa/pkcs1v15.go.html#4118229">copyWithLeftPad</a></span><span class="op" id="4124012">(</span><span class="ident" id="4124013"><a href="/crypto/rsa/pss.go.html#4123731">s</a></span><span class="op" id="4124014">,</span>&nbsp;<span class="ident" id="4124016"><a href="/crypto/rsa/pss.go.html#4123903">c</a></span><span class="op" id="4124017">.</span><span class="ident" id="4124018">Bytes</span><span class="op" id="4124023">(</span><span class="op" id="4124024">)</span><span class="op" id="4124025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124028">return</span><br>
<span class="lineno"></span><span class="op" id="4124035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4124038">const</span>&nbsp;<span class="op" id="4124044">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124047">//&nbsp;PSSSaltLengthAuto&nbsp;causes&nbsp;the&nbsp;salt&nbsp;in&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;to&nbsp;be&nbsp;as&nbsp;large</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124119">//&nbsp;as&nbsp;possible&nbsp;when&nbsp;signing,&nbsp;and&nbsp;to&nbsp;be&nbsp;auto-detected&nbsp;when&nbsp;verifying.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124189">PSSSaltLengthAuto</span>&nbsp;<span class="op" id="4124207">=</span>&nbsp;<span class="num" id="4124209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124212">//&nbsp;PSSSaltLengthEqualsHash&nbsp;causes&nbsp;the&nbsp;salt&nbsp;length&nbsp;to&nbsp;equal&nbsp;the&nbsp;length</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124283">//&nbsp;of&nbsp;the&nbsp;hash&nbsp;used&nbsp;in&nbsp;the&nbsp;signature.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124322">PSSSaltLengthEqualsHash</span>&nbsp;<span class="op" id="4124346">=</span>&nbsp;<span class="op" id="4124348">-</span><span class="num" id="4124349">1</span><br>
<span class="lineno"></span><span class="op" id="4124351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4124354">//&nbsp;PSSOptions&nbsp;contains&nbsp;options&nbsp;for&nbsp;creating&nbsp;and&nbsp;verifying&nbsp;PSS&nbsp;signatures.</span><br>
<span class="lineno">220</span><span class="keyword" id="4124428">type</span>&nbsp;<span class="ident" id="4124433">PSSOptions</span>&nbsp;<span class="keyword" id="4124444">struct</span>&nbsp;<span class="op" id="4124451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124454">//&nbsp;SaltLength&nbsp;controls&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;salt&nbsp;used&nbsp;in&nbsp;the&nbsp;PSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124517">//&nbsp;signature.&nbsp;It&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;number&nbsp;of&nbsp;bytes,&nbsp;or&nbsp;one&nbsp;of&nbsp;the&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124590">//&nbsp;PSSSaltLength&nbsp;constants.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124619">SaltLength</span>&nbsp;<span class="builtintype" id="4124630">int</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124636">//&nbsp;Hash,&nbsp;if&nbsp;not&nbsp;zero,&nbsp;overrides&nbsp;the&nbsp;hash&nbsp;function&nbsp;passed&nbsp;to&nbsp;SignPSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124706">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;specify&nbsp;the&nbsp;hash&nbsp;function&nbsp;when&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4124775">//&nbsp;crypto.Signer&nbsp;interface.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4124804">Hash</span>&nbsp;<span class="ident" id="4124809"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4124815">.</span><span class="ident" id="4124816">Hash</span><br>
<span class="lineno">230</span><span class="op" id="4124821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4124824">//&nbsp;HashFunc&nbsp;returns&nbsp;pssOpts.Hash&nbsp;so&nbsp;that&nbsp;PSSOptions&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="4124887">//&nbsp;crypto.SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="4124909">func</span>&nbsp;<span class="op" id="4124914">(</span><span class="ident" id="4124915">pssOpts</span>&nbsp;<span class="op" id="4124923">*</span><span class="ident" id="4124924"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><span class="op" id="4124934">)</span>&nbsp;<span class="ident" id="4124936">HashFunc</span><span class="op" id="4124944">(</span><span class="op" id="4124945">)</span>&nbsp;<span class="ident" id="4124947"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4124953">.</span><span class="ident" id="4124954">Hash</span>&nbsp;<span class="op" id="4124959">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4124962">return</span>&nbsp;<span class="ident" id="4124969"><a href="/crypto/rsa/pss.go.html#4124915">pssOpts</a></span><span class="op" id="4124976">.</span><span class="ident" id="4124977">Hash</span><br>
<span class="lineno"></span><span class="op" id="4124982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4124985">func</span>&nbsp;<span class="op" id="4124990">(</span><span class="ident" id="4124991">opts</span>&nbsp;<span class="op" id="4124996">*</span><span class="ident" id="4124997"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><span class="op" id="4125007">)</span>&nbsp;<span class="ident" id="4125009">saltLength</span><span class="op" id="4125019">(</span><span class="op" id="4125020">)</span>&nbsp;<span class="builtintype" id="4125022">int</span>&nbsp;<span class="op" id="4125026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125029">if</span>&nbsp;<span class="ident" id="4125032"><a href="/crypto/rsa/pss.go.html#4124991">opts</a></span>&nbsp;<span class="op" id="4125037">==</span>&nbsp;<span class="ident" id="4125040">nil</span>&nbsp;<span class="op" id="4125044">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125048">return</span>&nbsp;<span class="ident" id="4125055"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125077">return</span>&nbsp;<span class="ident" id="4125084"><a href="/crypto/rsa/pss.go.html#4124991">opts</a></span><span class="op" id="4125088">.</span><span class="ident" id="4125089">SaltLength</span><br>
<span class="lineno"></span><span class="op" id="4125100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4125103">//&nbsp;SignPSS&nbsp;calculates&nbsp;the&nbsp;signature&nbsp;of&nbsp;hashed&nbsp;using&nbsp;RSASSA-PSS&nbsp;[1].</span><br>
<span class="lineno"></span><span class="comment" id="4125171">//&nbsp;Note&nbsp;that&nbsp;hashed&nbsp;must&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4125249">//&nbsp;given&nbsp;hash&nbsp;function.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4125326">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4125348">func</span>&nbsp;<span class="ident" id="4125353">SignPSS</span><span class="op" id="4125360">(</span><span class="ident" id="4125361">rand</span>&nbsp;<span class="ident" id="4125366"><a href="/crypto/rsa/pss.go.html#4118775">io</a></span><span class="op" id="4125368">.</span><span class="ident" id="4125369">Reader</span><span class="op" id="4125375">,</span>&nbsp;<span class="ident" id="4125377">priv</span>&nbsp;<span class="op" id="4125382">*</span><span class="ident" id="4125383"><a href="/crypto/rsa/rsa.go.html#4128208">PrivateKey</a></span><span class="op" id="4125393">,</span>&nbsp;<span class="ident" id="4125395">hash</span>&nbsp;<span class="ident" id="4125400"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4125406">.</span><span class="ident" id="4125407">Hash</span><span class="op" id="4125411">,</span>&nbsp;<span class="ident" id="4125413">hashed</span>&nbsp;<span class="op" id="4125420">[</span><span class="op" id="4125421">]</span><span class="builtintype" id="4125422">byte</span><span class="op" id="4125426">,</span>&nbsp;<span class="ident" id="4125428">opts</span>&nbsp;<span class="op" id="4125433">*</span><span class="ident" id="4125434"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><span class="op" id="4125444">)</span>&nbsp;<span class="op" id="4125446">(</span><span class="ident" id="4125447">s</span>&nbsp;<span class="op" id="4125449">[</span><span class="op" id="4125450">]</span><span class="builtintype" id="4125451">byte</span><span class="op" id="4125455">,</span>&nbsp;<span class="ident" id="4125457">err</span>&nbsp;<span class="builtintype" id="4125461">error</span><span class="op" id="4125466">)</span>&nbsp;<span class="op" id="4125468">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125471">saltLength</span>&nbsp;<span class="op" id="4125482">:=</span>&nbsp;<span class="ident" id="4125485"><a href="/crypto/rsa/pss.go.html#4125428">opts</a></span><span class="op" id="4125489">.</span><span class="ident" id="4125490">saltLength</span><span class="op" id="4125500">(</span><span class="op" id="4125501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125504">switch</span>&nbsp;<span class="ident" id="4125511"><a href="/crypto/rsa/pss.go.html#4125471">saltLength</a></span>&nbsp;<span class="op" id="4125522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125525">case</span>&nbsp;<span class="ident" id="4125530"><a href="/crypto/rsa/pss.go.html#4124189">PSSSaltLengthAuto</a></span><span class="op" id="4125547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125551"><a href="/crypto/rsa/pss.go.html#4125471">saltLength</a></span>&nbsp;<span class="op" id="4125562">=</span>&nbsp;<span class="op" id="4125564">(</span><span class="ident" id="4125565"><a href="/crypto/rsa/pss.go.html#4125377">priv</a></span><span class="op" id="4125569">.</span><span class="ident" id="4125570">N</span><span class="op" id="4125571">.</span><span class="ident" id="4125572">BitLen</span><span class="op" id="4125578">(</span><span class="op" id="4125579">)</span><span class="op" id="4125580">+</span><span class="num" id="4125581">7</span><span class="op" id="4125582">)</span><span class="op" id="4125583">/</span><span class="num" id="4125584">8</span>&nbsp;<span class="op" id="4125586">-</span>&nbsp;<span class="num" id="4125588">2</span>&nbsp;<span class="op" id="4125590">-</span>&nbsp;<span class="ident" id="4125592"><a href="/crypto/rsa/pss.go.html#4125395">hash</a></span><span class="op" id="4125596">.</span><span class="ident" id="4125597">Size</span><span class="op" id="4125601">(</span><span class="op" id="4125602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125605">case</span>&nbsp;<span class="ident" id="4125610"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span><span class="op" id="4125633">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125637"><a href="/crypto/rsa/pss.go.html#4125471">saltLength</a></span>&nbsp;<span class="op" id="4125648">=</span>&nbsp;<span class="ident" id="4125650"><a href="/crypto/rsa/pss.go.html#4125395">hash</a></span><span class="op" id="4125654">.</span><span class="ident" id="4125655">Size</span><span class="op" id="4125659">(</span><span class="op" id="4125660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125667">if</span>&nbsp;<span class="ident" id="4125670"><a href="/crypto/rsa/pss.go.html#4125428">opts</a></span><span class="op" id="4125674">.</span><span class="ident" id="4125675">Hash</span>&nbsp;<span class="op" id="4125680">!=</span>&nbsp;<span class="num" id="4125683">0</span>&nbsp;<span class="op" id="4125685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125689"><a href="/crypto/rsa/pss.go.html#4125395">hash</a></span>&nbsp;<span class="op" id="4125694">=</span>&nbsp;<span class="ident" id="4125696"><a href="/crypto/rsa/pss.go.html#4125428">opts</a></span><span class="op" id="4125700">.</span><span class="ident" id="4125701">Hash</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125711">salt</span>&nbsp;<span class="op" id="4125716">:=</span>&nbsp;<span class="builtinfunc" id="4125719">make</span><span class="op" id="4125723">(</span><span class="op" id="4125724">[</span><span class="op" id="4125725">]</span><span class="builtintype" id="4125726">byte</span><span class="op" id="4125730">,</span>&nbsp;<span class="ident" id="4125732"><a href="/crypto/rsa/pss.go.html#4125471">saltLength</a></span><span class="op" id="4125742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125745">if</span>&nbsp;<span class="ident" id="4125748">_</span><span class="op" id="4125749">,</span>&nbsp;<span class="ident" id="4125751"><a href="/crypto/rsa/pss.go.html#4125457">err</a></span>&nbsp;<span class="op" id="4125755">=</span>&nbsp;<span class="ident" id="4125757"><a href="/crypto/rsa/pss.go.html#4118775">io</a></span><span class="op" id="4125759">.</span><span class="ident" id="4125760">ReadFull</span><span class="op" id="4125768">(</span><span class="ident" id="4125769"><a href="/crypto/rsa/pss.go.html#4125361">rand</a></span><span class="op" id="4125773">,</span>&nbsp;<span class="ident" id="4125775"><a href="/crypto/rsa/pss.go.html#4125711">salt</a></span><span class="op" id="4125779">)</span><span class="op" id="4125780">;</span>&nbsp;<span class="ident" id="4125782"><a href="/crypto/rsa/pss.go.html#4125457">err</a></span>&nbsp;<span class="op" id="4125786">!=</span>&nbsp;<span class="ident" id="4125789">nil</span>&nbsp;<span class="op" id="4125793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125797">return</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4125805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4125808">return</span>&nbsp;<span class="ident" id="4125815"><a href="/crypto/rsa/pss.go.html#4123641">signPSSWithSalt</a></span><span class="op" id="4125830">(</span><span class="ident" id="4125831"><a href="/crypto/rsa/pss.go.html#4125361">rand</a></span><span class="op" id="4125835">,</span>&nbsp;<span class="ident" id="4125837"><a href="/crypto/rsa/pss.go.html#4125377">priv</a></span><span class="op" id="4125841">,</span>&nbsp;<span class="ident" id="4125843"><a href="/crypto/rsa/pss.go.html#4125395">hash</a></span><span class="op" id="4125847">,</span>&nbsp;<span class="ident" id="4125849"><a href="/crypto/rsa/pss.go.html#4125413">hashed</a></span><span class="op" id="4125855">,</span>&nbsp;<span class="ident" id="4125857"><a href="/crypto/rsa/pss.go.html#4125711">salt</a></span><span class="op" id="4125861">)</span><br>
<span class="lineno"></span><span class="op" id="4125863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125866">//&nbsp;VerifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature.</span><br>
<span class="lineno">270</span><span class="comment" id="4125905">//&nbsp;hashed&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;the&nbsp;input&nbsp;message&nbsp;using&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4125979">//&nbsp;function&nbsp;and&nbsp;sig&nbsp;is&nbsp;the&nbsp;signature.&nbsp;A&nbsp;valid&nbsp;signature&nbsp;is&nbsp;indicated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4126051">//&nbsp;returning&nbsp;a&nbsp;nil&nbsp;error.&nbsp;The&nbsp;opts&nbsp;argument&nbsp;may&nbsp;be&nbsp;nil,&nbsp;in&nbsp;which&nbsp;case&nbsp;sensible</span><br>
<span class="lineno"></span><span class="comment" id="4126130">//&nbsp;defaults&nbsp;are&nbsp;used.</span><br>
<span class="lineno"></span><span class="keyword" id="4126152">func</span>&nbsp;<span class="ident" id="4126157">VerifyPSS</span><span class="op" id="4126166">(</span><span class="ident" id="4126167">pub</span>&nbsp;<span class="op" id="4126171">*</span><span class="ident" id="4126172"><a href="/crypto/rsa/rsa.go.html#4127377">PublicKey</a></span><span class="op" id="4126181">,</span>&nbsp;<span class="ident" id="4126183">hash</span>&nbsp;<span class="ident" id="4126188"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4126194">.</span><span class="ident" id="4126195">Hash</span><span class="op" id="4126199">,</span>&nbsp;<span class="ident" id="4126201">hashed</span>&nbsp;<span class="op" id="4126208">[</span><span class="op" id="4126209">]</span><span class="builtintype" id="4126210">byte</span><span class="op" id="4126214">,</span>&nbsp;<span class="ident" id="4126216">sig</span>&nbsp;<span class="op" id="4126220">[</span><span class="op" id="4126221">]</span><span class="builtintype" id="4126222">byte</span><span class="op" id="4126226">,</span>&nbsp;<span class="ident" id="4126228">opts</span>&nbsp;<span class="op" id="4126233">*</span><span class="ident" id="4126234"><a href="/crypto/rsa/pss.go.html#4124433">PSSOptions</a></span><span class="op" id="4126244">)</span>&nbsp;<span class="builtintype" id="4126246">error</span>&nbsp;<span class="op" id="4126252">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126255">return</span>&nbsp;<span class="ident" id="4126262"><a href="/crypto/rsa/pss.go.html#4126389">verifyPSS</a></span><span class="op" id="4126271">(</span><span class="ident" id="4126272"><a href="/crypto/rsa/pss.go.html#4126167">pub</a></span><span class="op" id="4126275">,</span>&nbsp;<span class="ident" id="4126277"><a href="/crypto/rsa/pss.go.html#4126183">hash</a></span><span class="op" id="4126281">,</span>&nbsp;<span class="ident" id="4126283"><a href="/crypto/rsa/pss.go.html#4126201">hashed</a></span><span class="op" id="4126289">,</span>&nbsp;<span class="ident" id="4126291"><a href="/crypto/rsa/pss.go.html#4126216">sig</a></span><span class="op" id="4126294">,</span>&nbsp;<span class="ident" id="4126296"><a href="/crypto/rsa/pss.go.html#4126228">opts</a></span><span class="op" id="4126300">.</span><span class="ident" id="4126301">saltLength</span><span class="op" id="4126311">(</span><span class="op" id="4126312">)</span><span class="op" id="4126313">)</span><br>
<span class="lineno"></span><span class="op" id="4126315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4126318">//&nbsp;verifyPSS&nbsp;verifies&nbsp;a&nbsp;PSS&nbsp;signature&nbsp;with&nbsp;the&nbsp;given&nbsp;salt&nbsp;length.</span><br>
<span class="lineno"></span><span class="keyword" id="4126384">func</span>&nbsp;<span class="ident" id="4126389">verifyPSS</span><span class="op" id="4126398">(</span><span class="ident" id="4126399">pub</span>&nbsp;<span class="op" id="4126403">*</span><span class="ident" id="4126404"><a href="/crypto/rsa/rsa.go.html#4127377">PublicKey</a></span><span class="op" id="4126413">,</span>&nbsp;<span class="ident" id="4126415">hash</span>&nbsp;<span class="ident" id="4126420"><a href="/crypto/rsa/pss.go.html#4118747">crypto</a></span><span class="op" id="4126426">.</span><span class="ident" id="4126427">Hash</span><span class="op" id="4126431">,</span>&nbsp;<span class="ident" id="4126433">hashed</span>&nbsp;<span class="op" id="4126440">[</span><span class="op" id="4126441">]</span><span class="builtintype" id="4126442">byte</span><span class="op" id="4126446">,</span>&nbsp;<span class="ident" id="4126448">sig</span>&nbsp;<span class="op" id="4126452">[</span><span class="op" id="4126453">]</span><span class="builtintype" id="4126454">byte</span><span class="op" id="4126458">,</span>&nbsp;<span class="ident" id="4126460">saltLen</span>&nbsp;<span class="builtintype" id="4126468">int</span><span class="op" id="4126471">)</span>&nbsp;<span class="builtintype" id="4126473">error</span>&nbsp;<span class="op" id="4126479">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126482">nBits</span>&nbsp;<span class="op" id="4126488">:=</span>&nbsp;<span class="ident" id="4126491"><a href="/crypto/rsa/pss.go.html#4126399">pub</a></span><span class="op" id="4126494">.</span><span class="ident" id="4126495">N</span><span class="op" id="4126496">.</span><span class="ident" id="4126497">BitLen</span><span class="op" id="4126503">(</span><span class="op" id="4126504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126507">if</span>&nbsp;<span class="builtinfunc" id="4126510">len</span><span class="op" id="4126513">(</span><span class="ident" id="4126514"><a href="/crypto/rsa/pss.go.html#4126448">sig</a></span><span class="op" id="4126517">)</span>&nbsp;<span class="op" id="4126519">!=</span>&nbsp;<span class="op" id="4126522">(</span><span class="ident" id="4126523"><a href="/crypto/rsa/pss.go.html#4126482">nBits</a></span><span class="op" id="4126528">+</span><span class="num" id="4126529">7</span><span class="op" id="4126530">)</span><span class="op" id="4126531">/</span><span class="num" id="4126532">8</span>&nbsp;<span class="op" id="4126534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126538">return</span>&nbsp;<span class="ident" id="4126545"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126565">s</span>&nbsp;<span class="op" id="4126567">:=</span>&nbsp;<span class="builtinfunc" id="4126570">new</span><span class="op" id="4126573">(</span><span class="ident" id="4126574"><a href="/crypto/rsa/pss.go.html#4118781">big</a></span><span class="op" id="4126577">.</span><span class="ident" id="4126578">Int</span><span class="op" id="4126581">)</span><span class="op" id="4126582">.</span><span class="ident" id="4126583">SetBytes</span><span class="op" id="4126591">(</span><span class="ident" id="4126592"><a href="/crypto/rsa/pss.go.html#4126448">sig</a></span><span class="op" id="4126595">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126598">m</span>&nbsp;<span class="op" id="4126600">:=</span>&nbsp;<span class="ident" id="4126603"><a href="/crypto/rsa/rsa.go.html#4135085">encrypt</a></span><span class="op" id="4126610">(</span><span class="builtinfunc" id="4126611">new</span><span class="op" id="4126614">(</span><span class="ident" id="4126615"><a href="/crypto/rsa/pss.go.html#4118781">big</a></span><span class="op" id="4126618">.</span><span class="ident" id="4126619">Int</span><span class="op" id="4126622">)</span><span class="op" id="4126623">,</span>&nbsp;<span class="ident" id="4126625"><a href="/crypto/rsa/pss.go.html#4126399">pub</a></span><span class="op" id="4126628">,</span>&nbsp;<span class="ident" id="4126630"><a href="/crypto/rsa/pss.go.html#4126565">s</a></span><span class="op" id="4126631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126634">emBits</span>&nbsp;<span class="op" id="4126641">:=</span>&nbsp;<span class="ident" id="4126644"><a href="/crypto/rsa/pss.go.html#4126482">nBits</a></span>&nbsp;<span class="op" id="4126650">-</span>&nbsp;<span class="num" id="4126652">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126655">emLen</span>&nbsp;<span class="op" id="4126661">:=</span>&nbsp;<span class="op" id="4126664">(</span><span class="ident" id="4126665"><a href="/crypto/rsa/pss.go.html#4126634">emBits</a></span>&nbsp;<span class="op" id="4126672">+</span>&nbsp;<span class="num" id="4126674">7</span><span class="op" id="4126675">)</span>&nbsp;<span class="op" id="4126677">/</span>&nbsp;<span class="num" id="4126679">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126682">if</span>&nbsp;<span class="ident" id="4126685"><a href="/crypto/rsa/pss.go.html#4126655">emLen</a></span>&nbsp;<span class="op" id="4126691">&lt;</span>&nbsp;<span class="builtinfunc" id="4126693">len</span><span class="op" id="4126696">(</span><span class="ident" id="4126697"><a href="/crypto/rsa/pss.go.html#4126598">m</a></span><span class="op" id="4126698">.</span><span class="ident" id="4126699">Bytes</span><span class="op" id="4126704">(</span><span class="op" id="4126705">)</span><span class="op" id="4126706">)</span>&nbsp;<span class="op" id="4126708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126712">return</span>&nbsp;<span class="ident" id="4126719"><a href="/crypto/rsa/rsa.go.html#4136573">ErrVerification</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126739">em</span>&nbsp;<span class="op" id="4126742">:=</span>&nbsp;<span class="builtinfunc" id="4126745">make</span><span class="op" id="4126749">(</span><span class="op" id="4126750">[</span><span class="op" id="4126751">]</span><span class="builtintype" id="4126752">byte</span><span class="op" id="4126756">,</span>&nbsp;<span class="ident" id="4126758"><a href="/crypto/rsa/pss.go.html#4126655">emLen</a></span><span class="op" id="4126763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126766"><a href="/crypto/rsa/pkcs1v15.go.html#4118229">copyWithLeftPad</a></span><span class="op" id="4126781">(</span><span class="ident" id="4126782"><a href="/crypto/rsa/pss.go.html#4126739">em</a></span><span class="op" id="4126784">,</span>&nbsp;<span class="ident" id="4126786"><a href="/crypto/rsa/pss.go.html#4126598">m</a></span><span class="op" id="4126787">.</span><span class="ident" id="4126788">Bytes</span><span class="op" id="4126793">(</span><span class="op" id="4126794">)</span><span class="op" id="4126795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126798">if</span>&nbsp;<span class="ident" id="4126801"><a href="/crypto/rsa/pss.go.html#4126460">saltLen</a></span>&nbsp;<span class="op" id="4126809">==</span>&nbsp;<span class="ident" id="4126812"><a href="/crypto/rsa/pss.go.html#4124322">PSSSaltLengthEqualsHash</a></span>&nbsp;<span class="op" id="4126836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126840"><a href="/crypto/rsa/pss.go.html#4126460">saltLen</a></span>&nbsp;<span class="op" id="4126848">=</span>&nbsp;<span class="ident" id="4126850"><a href="/crypto/rsa/pss.go.html#4126415">hash</a></span><span class="op" id="4126854">.</span><span class="ident" id="4126855">Size</span><span class="op" id="4126859">(</span><span class="op" id="4126860">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4126863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4126866">return</span>&nbsp;<span class="ident" id="4126873"><a href="/crypto/rsa/pss.go.html#4120700">emsaPSSVerify</a></span><span class="op" id="4126886">(</span><span class="ident" id="4126887"><a href="/crypto/rsa/pss.go.html#4126433">hashed</a></span><span class="op" id="4126893">,</span>&nbsp;<span class="ident" id="4126895"><a href="/crypto/rsa/pss.go.html#4126739">em</a></span><span class="op" id="4126897">,</span>&nbsp;<span class="ident" id="4126899"><a href="/crypto/rsa/pss.go.html#4126634">emBits</a></span><span class="op" id="4126905">,</span>&nbsp;<span class="ident" id="4126907"><a href="/crypto/rsa/pss.go.html#4126460">saltLen</a></span><span class="op" id="4126914">,</span>&nbsp;<span class="ident" id="4126916"><a href="/crypto/rsa/pss.go.html#4126415">hash</a></span><span class="op" id="4126920">.</span><span class="ident" id="4126921">New</span><span class="op" id="4126924">(</span><span class="op" id="4126925">)</span><span class="op" id="4126926">)</span><br>
<span class="lineno"></span><span class="op" id="4126928">}</span>
</div>
</body>
</html>
