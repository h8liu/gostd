<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3253081">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3253136">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3253190">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3253241">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3253269">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3253314">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3253355">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3253416">package</span>&nbsp;<span class="ident" id="3253424">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3253430">import</span>&nbsp;<span class="string" id="3253437">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3253445">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3253492">type</span>&nbsp;<span class="ident" id="3253497">Zipf</span>&nbsp;<span class="keyword" id="3253502">struct</span>&nbsp;<span class="op" id="3253509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253512">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3253525">*</span><span class="ident" id="3253526">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253532">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253545">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253554">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253567">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253576">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253589">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253598">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253611">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253620">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253633">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253642">oneminusQinv</span>&nbsp;<span class="builtintype" id="3253655">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253664">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3253677">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3253686">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3253699">float64</span><br>
<span class="lineno">25</span><span class="op" id="3253707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3253710">func</span>&nbsp;<span class="op" id="3253715">(</span><span class="ident" id="3253716">z</span>&nbsp;<span class="op" id="3253718">*</span><span class="ident" id="3253719">Zipf</span><span class="op" id="3253723">)</span>&nbsp;<span class="ident" id="3253725">h</span><span class="op" id="3253726">(</span><span class="ident" id="3253727">x</span>&nbsp;<span class="builtintype" id="3253729">float64</span><span class="op" id="3253736">)</span>&nbsp;<span class="builtintype" id="3253738">float64</span>&nbsp;<span class="op" id="3253746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253749">return</span>&nbsp;<span class="ident" id="3253756">math</span><span class="op" id="3253760">.</span><span class="ident" id="3253761">Exp</span><span class="op" id="3253764">(</span><span class="ident" id="3253765">z</span><span class="op" id="3253766">.</span><span class="ident" id="3253767">oneminusQ</span><span class="op" id="3253776">*</span><span class="ident" id="3253777">math</span><span class="op" id="3253781">.</span><span class="ident" id="3253782">Log</span><span class="op" id="3253785">(</span><span class="ident" id="3253786">z</span><span class="op" id="3253787">.</span><span class="ident" id="3253788">v</span><span class="op" id="3253789">+</span><span class="ident" id="3253790">x</span><span class="op" id="3253791">)</span><span class="op" id="3253792">)</span>&nbsp;<span class="op" id="3253794">*</span>&nbsp;<span class="ident" id="3253796">z</span><span class="op" id="3253797">.</span><span class="ident" id="3253798">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3253811">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3253814">func</span>&nbsp;<span class="op" id="3253819">(</span><span class="ident" id="3253820">z</span>&nbsp;<span class="op" id="3253822">*</span><span class="ident" id="3253823">Zipf</span><span class="op" id="3253827">)</span>&nbsp;<span class="ident" id="3253829">hinv</span><span class="op" id="3253833">(</span><span class="ident" id="3253834">x</span>&nbsp;<span class="builtintype" id="3253836">float64</span><span class="op" id="3253843">)</span>&nbsp;<span class="builtintype" id="3253845">float64</span>&nbsp;<span class="op" id="3253853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3253856">return</span>&nbsp;<span class="ident" id="3253863">math</span><span class="op" id="3253867">.</span><span class="ident" id="3253868">Exp</span><span class="op" id="3253871">(</span><span class="ident" id="3253872">z</span><span class="op" id="3253873">.</span><span class="ident" id="3253874">oneminusQinv</span><span class="op" id="3253886">*</span><span class="ident" id="3253887">math</span><span class="op" id="3253891">.</span><span class="ident" id="3253892">Log</span><span class="op" id="3253895">(</span><span class="ident" id="3253896">z</span><span class="op" id="3253897">.</span><span class="ident" id="3253898">oneminusQ</span><span class="op" id="3253907">*</span><span class="ident" id="3253908">x</span><span class="op" id="3253909">)</span><span class="op" id="3253910">)</span>&nbsp;<span class="op" id="3253912">-</span>&nbsp;<span class="ident" id="3253914">z</span><span class="op" id="3253915">.</span><span class="ident" id="3253916">v</span><br>
<span class="lineno"></span><span class="op" id="3253918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3253921">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3253985">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3254046">func</span>&nbsp;<span class="ident" id="3254051">NewZipf</span><span class="op" id="3254058">(</span><span class="ident" id="3254059">r</span>&nbsp;<span class="op" id="3254061">*</span><span class="ident" id="3254062">Rand</span><span class="op" id="3254066">,</span>&nbsp;<span class="ident" id="3254068">s</span>&nbsp;<span class="builtintype" id="3254070">float64</span><span class="op" id="3254077">,</span>&nbsp;<span class="ident" id="3254079">v</span>&nbsp;<span class="builtintype" id="3254081">float64</span><span class="op" id="3254088">,</span>&nbsp;<span class="ident" id="3254090">imax</span>&nbsp;<span class="ident" id="3254095">uint64</span><span class="op" id="3254101">)</span>&nbsp;<span class="op" id="3254103">*</span><span class="ident" id="3254104">Zipf</span>&nbsp;<span class="op" id="3254109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254112">z</span>&nbsp;<span class="op" id="3254114">:=</span>&nbsp;<span class="builtinfunc" id="3254117">new</span><span class="op" id="3254120">(</span><span class="ident" id="3254121">Zipf</span><span class="op" id="3254125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254128">if</span>&nbsp;<span class="ident" id="3254131">s</span>&nbsp;<span class="op" id="3254133">&lt;=</span>&nbsp;<span class="num" id="3254136">1.0</span>&nbsp;<span class="op" id="3254140">||</span>&nbsp;<span class="ident" id="3254143">v</span>&nbsp;<span class="op" id="3254145">&lt;</span>&nbsp;<span class="num" id="3254147">1</span>&nbsp;<span class="op" id="3254149">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254153">return</span>&nbsp;<span class="ident" id="3254160">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254168">z</span><span class="op" id="3254169">.</span><span class="ident" id="3254170">r</span>&nbsp;<span class="op" id="3254172">=</span>&nbsp;<span class="ident" id="3254174">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254177">z</span><span class="op" id="3254178">.</span><span class="ident" id="3254179">imax</span>&nbsp;<span class="op" id="3254184">=</span>&nbsp;<span class="builtintype" id="3254186">float64</span><span class="op" id="3254193">(</span><span class="ident" id="3254194">imax</span><span class="op" id="3254198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254201">z</span><span class="op" id="3254202">.</span><span class="ident" id="3254203">v</span>&nbsp;<span class="op" id="3254205">=</span>&nbsp;<span class="ident" id="3254207">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254210">z</span><span class="op" id="3254211">.</span><span class="ident" id="3254212">q</span>&nbsp;<span class="op" id="3254214">=</span>&nbsp;<span class="ident" id="3254216">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254219">z</span><span class="op" id="3254220">.</span><span class="ident" id="3254221">oneminusQ</span>&nbsp;<span class="op" id="3254231">=</span>&nbsp;<span class="num" id="3254233">1.0</span>&nbsp;<span class="op" id="3254237">-</span>&nbsp;<span class="ident" id="3254239">z</span><span class="op" id="3254240">.</span><span class="ident" id="3254241">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254244">z</span><span class="op" id="3254245">.</span><span class="ident" id="3254246">oneminusQinv</span>&nbsp;<span class="op" id="3254259">=</span>&nbsp;<span class="num" id="3254261">1.0</span>&nbsp;<span class="op" id="3254265">/</span>&nbsp;<span class="ident" id="3254267">z</span><span class="op" id="3254268">.</span><span class="ident" id="3254269">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254280">z</span><span class="op" id="3254281">.</span><span class="ident" id="3254282">hxm</span>&nbsp;<span class="op" id="3254286">=</span>&nbsp;<span class="ident" id="3254288">z</span><span class="op" id="3254289">.</span><span class="ident" id="3254290">h</span><span class="op" id="3254291">(</span><span class="ident" id="3254292">z</span><span class="op" id="3254293">.</span><span class="ident" id="3254294">imax</span>&nbsp;<span class="op" id="3254299">+</span>&nbsp;<span class="num" id="3254301">0.5</span><span class="op" id="3254304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254307">z</span><span class="op" id="3254308">.</span><span class="ident" id="3254309">hx0minusHxm</span>&nbsp;<span class="op" id="3254321">=</span>&nbsp;<span class="ident" id="3254323">z</span><span class="op" id="3254324">.</span><span class="ident" id="3254325">h</span><span class="op" id="3254326">(</span><span class="num" id="3254327">0.5</span><span class="op" id="3254330">)</span>&nbsp;<span class="op" id="3254332">-</span>&nbsp;<span class="ident" id="3254334">math</span><span class="op" id="3254338">.</span><span class="ident" id="3254339">Exp</span><span class="op" id="3254342">(</span><span class="ident" id="3254343">math</span><span class="op" id="3254347">.</span><span class="ident" id="3254348">Log</span><span class="op" id="3254351">(</span><span class="ident" id="3254352">z</span><span class="op" id="3254353">.</span><span class="ident" id="3254354">v</span><span class="op" id="3254355">)</span><span class="op" id="3254356">*</span><span class="op" id="3254357">(</span><span class="op" id="3254358">-</span><span class="ident" id="3254359">z</span><span class="op" id="3254360">.</span><span class="ident" id="3254361">q</span><span class="op" id="3254362">)</span><span class="op" id="3254363">)</span>&nbsp;<span class="op" id="3254365">-</span>&nbsp;<span class="ident" id="3254367">z</span><span class="op" id="3254368">.</span><span class="ident" id="3254369">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254374">z</span><span class="op" id="3254375">.</span><span class="ident" id="3254376">s</span>&nbsp;<span class="op" id="3254378">=</span>&nbsp;<span class="num" id="3254380">1</span>&nbsp;<span class="op" id="3254382">-</span>&nbsp;<span class="ident" id="3254384">z</span><span class="op" id="3254385">.</span><span class="ident" id="3254386">hinv</span><span class="op" id="3254390">(</span><span class="ident" id="3254391">z</span><span class="op" id="3254392">.</span><span class="ident" id="3254393">h</span><span class="op" id="3254394">(</span><span class="num" id="3254395">1.5</span><span class="op" id="3254398">)</span><span class="op" id="3254399">-</span><span class="ident" id="3254400">math</span><span class="op" id="3254404">.</span><span class="ident" id="3254405">Exp</span><span class="op" id="3254408">(</span><span class="op" id="3254409">-</span><span class="ident" id="3254410">z</span><span class="op" id="3254411">.</span><span class="ident" id="3254412">q</span><span class="op" id="3254413">*</span><span class="ident" id="3254414">math</span><span class="op" id="3254418">.</span><span class="ident" id="3254419">Log</span><span class="op" id="3254422">(</span><span class="ident" id="3254423">z</span><span class="op" id="3254424">.</span><span class="ident" id="3254425">v</span><span class="op" id="3254426">+</span><span class="num" id="3254427">1.0</span><span class="op" id="3254430">)</span><span class="op" id="3254431">)</span><span class="op" id="3254432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254435">return</span>&nbsp;<span class="ident" id="3254442">z</span><br>
<span class="lineno"></span><span class="op" id="3254444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3254447">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3254516">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3254539">func</span>&nbsp;<span class="op" id="3254544">(</span><span class="ident" id="3254545">z</span>&nbsp;<span class="op" id="3254547">*</span><span class="ident" id="3254548">Zipf</span><span class="op" id="3254552">)</span>&nbsp;<span class="ident" id="3254554">Uint64</span><span class="op" id="3254560">(</span><span class="op" id="3254561">)</span>&nbsp;<span class="ident" id="3254563">uint64</span>&nbsp;<span class="op" id="3254570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254573">if</span>&nbsp;<span class="ident" id="3254576">z</span>&nbsp;<span class="op" id="3254578">==</span>&nbsp;<span class="ident" id="3254581">nil</span>&nbsp;<span class="op" id="3254585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3254589">panic</span><span class="op" id="3254594">(</span><span class="string" id="3254595">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3254611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254614">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254617">k</span>&nbsp;<span class="op" id="3254619">:=</span>&nbsp;<span class="num" id="3254622">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254628">for</span>&nbsp;<span class="op" id="3254632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254636">r</span>&nbsp;<span class="op" id="3254638">:=</span>&nbsp;<span class="ident" id="3254641">z</span><span class="op" id="3254642">.</span><span class="ident" id="3254643">r</span><span class="op" id="3254644">.</span><span class="ident" id="3254645">Float64</span><span class="op" id="3254652">(</span><span class="op" id="3254653">)</span>&nbsp;<span class="comment" id="3254655">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254671">ur</span>&nbsp;<span class="op" id="3254674">:=</span>&nbsp;<span class="ident" id="3254677">z</span><span class="op" id="3254678">.</span><span class="ident" id="3254679">hxm</span>&nbsp;<span class="op" id="3254683">+</span>&nbsp;<span class="ident" id="3254685">r</span><span class="op" id="3254686">*</span><span class="ident" id="3254687">z</span><span class="op" id="3254688">.</span><span class="ident" id="3254689">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254703">x</span>&nbsp;<span class="op" id="3254705">:=</span>&nbsp;<span class="ident" id="3254708">z</span><span class="op" id="3254709">.</span><span class="ident" id="3254710">hinv</span><span class="op" id="3254714">(</span><span class="ident" id="3254715">ur</span><span class="op" id="3254717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3254721">k</span>&nbsp;<span class="op" id="3254723">=</span>&nbsp;<span class="ident" id="3254725">math</span><span class="op" id="3254729">.</span><span class="ident" id="3254730">Floor</span><span class="op" id="3254735">(</span><span class="ident" id="3254736">x</span>&nbsp;<span class="op" id="3254738">+</span>&nbsp;<span class="num" id="3254740">0.5</span><span class="op" id="3254743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254747">if</span>&nbsp;<span class="ident" id="3254750">k</span><span class="op" id="3254751">-</span><span class="ident" id="3254752">x</span>&nbsp;<span class="op" id="3254754">&lt;=</span>&nbsp;<span class="ident" id="3254757">z</span><span class="op" id="3254758">.</span><span class="ident" id="3254759">s</span>&nbsp;<span class="op" id="3254761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254766">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254774">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254778">if</span>&nbsp;<span class="ident" id="3254781">ur</span>&nbsp;<span class="op" id="3254784">&gt;=</span>&nbsp;<span class="ident" id="3254787">z</span><span class="op" id="3254788">.</span><span class="ident" id="3254789">h</span><span class="op" id="3254790">(</span><span class="ident" id="3254791">k</span><span class="op" id="3254792">+</span><span class="num" id="3254793">0.5</span><span class="op" id="3254796">)</span><span class="op" id="3254797">-</span><span class="ident" id="3254798">math</span><span class="op" id="3254802">.</span><span class="ident" id="3254803">Exp</span><span class="op" id="3254806">(</span><span class="op" id="3254807">-</span><span class="ident" id="3254808">math</span><span class="op" id="3254812">.</span><span class="ident" id="3254813">Log</span><span class="op" id="3254816">(</span><span class="ident" id="3254817">k</span><span class="op" id="3254818">+</span><span class="ident" id="3254819">z</span><span class="op" id="3254820">.</span><span class="ident" id="3254821">v</span><span class="op" id="3254822">)</span><span class="op" id="3254823">*</span><span class="ident" id="3254824">z</span><span class="op" id="3254825">.</span><span class="ident" id="3254826">q</span><span class="op" id="3254827">)</span>&nbsp;<span class="op" id="3254829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254834">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3254845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3254848">return</span>&nbsp;<span class="ident" id="3254855">uint64</span><span class="op" id="3254861">(</span><span class="ident" id="3254862">k</span><span class="op" id="3254863">)</span><br>
<span class="lineno">75</span><span class="op" id="3254865">}</span>
</div>
</body>
</html>
