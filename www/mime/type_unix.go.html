<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3603502">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3603557">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3603611">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3603662">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3603732">package</span>&nbsp;<span class="ident" id="3603740">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3603746">import</span>&nbsp;<span class="op" id="3603753">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603756">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603765">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603771">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3603781">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3603784">var</span>&nbsp;<span class="ident" id="3603788">typeFiles</span>&nbsp;<span class="op" id="3603798">=</span>&nbsp;<span class="op" id="3603800">[</span><span class="op" id="3603801">]</span><span class="builtintype" id="3603802">string</span><span class="op" id="3603808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603811">&#34;/etc/mime.types&#34;</span><span class="op" id="3603828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603831">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3603856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3603859">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3603883">,</span><br>
<span class="lineno"></span><span class="op" id="3603885">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3603888">func</span>&nbsp;<span class="ident" id="3603893">loadMimeFile</span><span class="op" id="3603905">(</span><span class="ident" id="3603906">filename</span>&nbsp;<span class="builtintype" id="3603915">string</span><span class="op" id="3603921">)</span>&nbsp;<span class="op" id="3603923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603926">f</span><span class="op" id="3603927">,</span>&nbsp;<span class="ident" id="3603929">err</span>&nbsp;<span class="op" id="3603933">:=</span>&nbsp;<span class="ident" id="3603936"><a href="/mime/type_unix.go.html#3603765">os</a></span><span class="op" id="3603938">.</span><span class="ident" id="3603939">Open</span><span class="op" id="3603943">(</span><span class="ident" id="3603944"><a href="/mime/type_unix.go.html#3603906">filename</a></span><span class="op" id="3603952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603955">if</span>&nbsp;<span class="ident" id="3603958"><a href="/mime/type_unix.go.html#3603929">err</a></span>&nbsp;<span class="op" id="3603962">!=</span>&nbsp;<span class="ident" id="3603965">nil</span>&nbsp;<span class="op" id="3603969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603973">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603984">defer</span>&nbsp;<span class="ident" id="3603990"><a href="/mime/type_unix.go.html#3603926">f</a></span><span class="op" id="3603991">.</span><span class="ident" id="3603992">Close</span><span class="op" id="3603997">(</span><span class="op" id="3603998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604002">scanner</span>&nbsp;<span class="op" id="3604010">:=</span>&nbsp;<span class="ident" id="3604013"><a href="/mime/type_unix.go.html#3603756">bufio</a></span><span class="op" id="3604018">.</span><span class="ident" id="3604019">NewScanner</span><span class="op" id="3604029">(</span><span class="ident" id="3604030"><a href="/mime/type_unix.go.html#3603926">f</a></span><span class="op" id="3604031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604034">for</span>&nbsp;<span class="ident" id="3604038"><a href="/mime/type_unix.go.html#3604002">scanner</a></span><span class="op" id="3604045">.</span><span class="ident" id="3604046">Scan</span><span class="op" id="3604050">(</span><span class="op" id="3604051">)</span>&nbsp;<span class="op" id="3604053">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604057">fields</span>&nbsp;<span class="op" id="3604064">:=</span>&nbsp;<span class="ident" id="3604067"><a href="/mime/type_unix.go.html#3603771">strings</a></span><span class="op" id="3604074">.</span><span class="ident" id="3604075">Fields</span><span class="op" id="3604081">(</span><span class="ident" id="3604082"><a href="/mime/type_unix.go.html#3604002">scanner</a></span><span class="op" id="3604089">.</span><span class="ident" id="3604090">Text</span><span class="op" id="3604094">(</span><span class="op" id="3604095">)</span><span class="op" id="3604096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604100">if</span>&nbsp;<span class="builtinfunc" id="3604103">len</span><span class="op" id="3604106">(</span><span class="ident" id="3604107"><a href="/mime/type_unix.go.html#3604057">fields</a></span><span class="op" id="3604113">)</span>&nbsp;<span class="op" id="3604115">&lt;=</span>&nbsp;<span class="num" id="3604118">1</span>&nbsp;<span class="op" id="3604120">||</span>&nbsp;<span class="ident" id="3604123"><a href="/mime/type_unix.go.html#3604057">fields</a></span><span class="op" id="3604129">[</span><span class="num" id="3604130">0</span><span class="op" id="3604131">]</span><span class="op" id="3604132">[</span><span class="num" id="3604133">0</span><span class="op" id="3604134">]</span>&nbsp;<span class="op" id="3604136">==</span>&nbsp;<span class="string" id="3604139">&#39;#&#39;</span>&nbsp;<span class="op" id="3604143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604148">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604163">mimeType</span>&nbsp;<span class="op" id="3604172">:=</span>&nbsp;<span class="ident" id="3604175"><a href="/mime/type_unix.go.html#3604057">fields</a></span><span class="op" id="3604181">[</span><span class="num" id="3604182">0</span><span class="op" id="3604183">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604187">for</span>&nbsp;<span class="ident" id="3604191">_</span><span class="op" id="3604192">,</span>&nbsp;<span class="ident" id="3604194">ext</span>&nbsp;<span class="op" id="3604198">:=</span>&nbsp;<span class="keyword" id="3604201">range</span>&nbsp;<span class="ident" id="3604207"><a href="/mime/type_unix.go.html#3604057">fields</a></span><span class="op" id="3604213">[</span><span class="num" id="3604214">1</span><span class="op" id="3604215">:</span><span class="op" id="3604216">]</span>&nbsp;<span class="op" id="3604218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604223">if</span>&nbsp;<span class="ident" id="3604226"><a href="/mime/type_unix.go.html#3604194">ext</a></span><span class="op" id="3604229">[</span><span class="num" id="3604230">0</span><span class="op" id="3604231">]</span>&nbsp;<span class="op" id="3604233">==</span>&nbsp;<span class="string" id="3604236">&#39;#&#39;</span>&nbsp;<span class="op" id="3604240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604246">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604260"><a href="/mime/type.go.html#3603064">setExtensionType</a></span><span class="op" id="3604276">(</span><span class="string" id="3604277">&#34;.&#34;</span><span class="op" id="3604280">+</span><span class="ident" id="3604281"><a href="/mime/type_unix.go.html#3604194">ext</a></span><span class="op" id="3604284">,</span>&nbsp;<span class="ident" id="3604286"><a href="/mime/type_unix.go.html#3604163">mimeType</a></span><span class="op" id="3604294">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604304">if</span>&nbsp;<span class="ident" id="3604307">err</span>&nbsp;<span class="op" id="3604311">:=</span>&nbsp;<span class="ident" id="3604314"><a href="/mime/type_unix.go.html#3604002">scanner</a></span><span class="op" id="3604321">.</span><span class="ident" id="3604322">Err</span><span class="op" id="3604325">(</span><span class="op" id="3604326">)</span><span class="op" id="3604327">;</span>&nbsp;<span class="ident" id="3604329"><a href="/mime/type_unix.go.html#3604307">err</a></span>&nbsp;<span class="op" id="3604333">!=</span>&nbsp;<span class="ident" id="3604336">nil</span>&nbsp;<span class="op" id="3604340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3604344">panic</span><span class="op" id="3604349">(</span><span class="ident" id="3604350"><a href="/mime/type_unix.go.html#3604307">err</a></span><span class="op" id="3604353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604356">}</span><br>
<span class="lineno">45</span><span class="op" id="3604358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3604361">func</span>&nbsp;<span class="ident" id="3604366">initMime</span><span class="op" id="3604374">(</span><span class="op" id="3604375">)</span>&nbsp;<span class="op" id="3604377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604380">for</span>&nbsp;<span class="ident" id="3604384">_</span><span class="op" id="3604385">,</span>&nbsp;<span class="ident" id="3604387">filename</span>&nbsp;<span class="op" id="3604396">:=</span>&nbsp;<span class="keyword" id="3604399">range</span>&nbsp;<span class="ident" id="3604405"><a href="/mime/type_unix.go.html#3603788">typeFiles</a></span>&nbsp;<span class="op" id="3604415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604419"><a href="/mime/type_unix.go.html#3603893">loadMimeFile</a></span><span class="op" id="3604431">(</span><span class="ident" id="3604432"><a href="/mime/type_unix.go.html#3604387">filename</a></span><span class="op" id="3604440">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604443">}</span><br>
<span class="lineno"></span><span class="op" id="3604445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3604448">func</span>&nbsp;<span class="ident" id="3604453">initMimeForTests</span><span class="op" id="3604469">(</span><span class="op" id="3604470">)</span>&nbsp;<span class="keyword" id="3604472">map</span><span class="op" id="3604475">[</span><span class="builtintype" id="3604476">string</span><span class="op" id="3604482">]</span><span class="builtintype" id="3604483">string</span>&nbsp;<span class="op" id="3604490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604493"><a href="/mime/type_unix.go.html#3603788">typeFiles</a></span>&nbsp;<span class="op" id="3604503">=</span>&nbsp;<span class="op" id="3604505">[</span><span class="op" id="3604506">]</span><span class="builtintype" id="3604507">string</span><span class="op" id="3604513">{</span><span class="string" id="3604514">&#34;testdata/test.types&#34;</span><span class="op" id="3604535">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604538">return</span>&nbsp;<span class="keyword" id="3604545">map</span><span class="op" id="3604548">[</span><span class="builtintype" id="3604549">string</span><span class="op" id="3604555">]</span><span class="builtintype" id="3604556">string</span><span class="op" id="3604562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3604566">&#34;.T1&#34;</span><span class="op" id="3604571">:</span>&nbsp;&nbsp;<span class="string" id="3604574">&#34;application/test&#34;</span><span class="op" id="3604592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3604596">&#34;.t2&#34;</span><span class="op" id="3604601">:</span>&nbsp;&nbsp;<span class="string" id="3604604">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3604630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3604634">&#34;.png&#34;</span><span class="op" id="3604640">:</span>&nbsp;<span class="string" id="3604642">&#34;image/png&#34;</span><span class="op" id="3604653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604656">}</span><br>
<span class="lineno">60</span><span class="op" id="3604658">}</span>
</div>
</body>
</html>
