<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4658077">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4658132">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4658186">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4658237">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658254">package</span>&nbsp;<span class="ident" id="4658262">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4658269">import</span>&nbsp;<span class="op" id="4658276">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4658279">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4658288">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4658295">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4658306">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4658316">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4658319">var</span>&nbsp;<span class="ident" id="4658323">textFormat</span>&nbsp;<span class="op" id="4658334">=</span>&nbsp;<span class="string" id="4658336">&#34;%s&#34;</span>&nbsp;<span class="comment" id="4658341">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658397">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="4658466">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="4658526">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4658573">type</span>&nbsp;<span class="ident" id="4658578">Node</span>&nbsp;<span class="keyword" id="4658583">interface</span>&nbsp;<span class="op" id="4658593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658596">Type</span><span class="op" id="4658600">(</span><span class="op" id="4658601">)</span>&nbsp;<span class="ident" id="4658603">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658613">String</span><span class="op" id="4658619">(</span><span class="op" id="4658620">)</span>&nbsp;<span class="builtintype" id="4658622">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658630">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658692">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658758">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658800">Copy</span><span class="op" id="4658804">(</span><span class="op" id="4658805">)</span>&nbsp;<span class="ident" id="4658807">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658813">Position</span><span class="op" id="4658821">(</span><span class="op" id="4658822">)</span>&nbsp;<span class="ident" id="4658824">Pos</span>&nbsp;<span class="comment" id="4658828">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658893">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4658932">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659005">tree</span><span class="op" id="4659009">(</span><span class="op" id="4659010">)</span>&nbsp;<span class="op" id="4659012">*</span><span class="ident" id="4659013">Tree</span><br>
<span class="lineno"></span><span class="op" id="4659018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659021">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="4659075">type</span>&nbsp;<span class="ident" id="4659080">NodeType</span>&nbsp;<span class="builtintype" id="4659089">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659094">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="4659166">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="4659195">type</span>&nbsp;<span class="ident" id="4659200">Pos</span>&nbsp;<span class="builtintype" id="4659204">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4659209">func</span>&nbsp;<span class="op" id="4659214">(</span><span class="ident" id="4659215">p</span>&nbsp;<span class="ident" id="4659217">Pos</span><span class="op" id="4659220">)</span>&nbsp;<span class="ident" id="4659222">Position</span><span class="op" id="4659230">(</span><span class="op" id="4659231">)</span>&nbsp;<span class="ident" id="4659233">Pos</span>&nbsp;<span class="op" id="4659237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659240">return</span>&nbsp;<span class="ident" id="4659247">p</span><br>
<span class="lineno"></span><span class="op" id="4659249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4659252">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="4659319">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4659382">func</span>&nbsp;<span class="op" id="4659387">(</span><span class="ident" id="4659388">t</span>&nbsp;<span class="ident" id="4659390">NodeType</span><span class="op" id="4659398">)</span>&nbsp;<span class="ident" id="4659400">Type</span><span class="op" id="4659404">(</span><span class="op" id="4659405">)</span>&nbsp;<span class="ident" id="4659407">NodeType</span>&nbsp;<span class="op" id="4659416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659419">return</span>&nbsp;<span class="ident" id="4659426">t</span><br>
<span class="lineno"></span><span class="op" id="4659428">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4659431">const</span>&nbsp;<span class="op" id="4659437">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659440">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4659455">NodeType</span>&nbsp;<span class="op" id="4659464">=</span>&nbsp;<span class="ident" id="4659466">iota</span>&nbsp;<span class="comment" id="4659471">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659487">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659518">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659571">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659602">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659626">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659657">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659691">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659722">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659752">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659783">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659804">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659835">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659874">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659905">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659943">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4659974">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660002">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660033">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660076">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660107">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660125">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660156">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660177">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660208">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660237">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660268">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660294">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660325">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660353">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660384">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660404">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660435">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660458">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660489">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660523">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660554">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660572">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4660603">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4660621">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4660624">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4660635">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4660674">type</span>&nbsp;<span class="ident" id="4660679">ListNode</span>&nbsp;<span class="keyword" id="4660688">struct</span>&nbsp;<span class="op" id="4660695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660698">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660708">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660713">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4660719">*</span><span class="ident" id="4660720">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660726">Nodes</span>&nbsp;<span class="op" id="4660732">[</span><span class="op" id="4660733">]</span><span class="ident" id="4660734">Node</span>&nbsp;<span class="comment" id="4660739">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4660778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4660781">func</span>&nbsp;<span class="op" id="4660786">(</span><span class="ident" id="4660787">t</span>&nbsp;<span class="op" id="4660789">*</span><span class="ident" id="4660790">Tree</span><span class="op" id="4660794">)</span>&nbsp;<span class="ident" id="4660796">newList</span><span class="op" id="4660803">(</span><span class="ident" id="4660804">pos</span>&nbsp;<span class="ident" id="4660808">Pos</span><span class="op" id="4660811">)</span>&nbsp;<span class="op" id="4660813">*</span><span class="ident" id="4660814">ListNode</span>&nbsp;<span class="op" id="4660823">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660826">return</span>&nbsp;<span class="op" id="4660833">&amp;</span><span class="ident" id="4660834">ListNode</span><span class="op" id="4660842">{</span><span class="ident" id="4660843">tr</span><span class="op" id="4660845">:</span>&nbsp;<span class="ident" id="4660847">t</span><span class="op" id="4660848">,</span>&nbsp;<span class="ident" id="4660850">NodeType</span><span class="op" id="4660858">:</span>&nbsp;<span class="ident" id="4660860">NodeList</span><span class="op" id="4660868">,</span>&nbsp;<span class="ident" id="4660870">Pos</span><span class="op" id="4660873">:</span>&nbsp;<span class="ident" id="4660875">pos</span><span class="op" id="4660878">}</span><br>
<span class="lineno"></span><span class="op" id="4660880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4660883">func</span>&nbsp;<span class="op" id="4660888">(</span><span class="ident" id="4660889">l</span>&nbsp;<span class="op" id="4660891">*</span><span class="ident" id="4660892">ListNode</span><span class="op" id="4660900">)</span>&nbsp;<span class="builtinfunc" id="4660902">append</span><span class="op" id="4660908">(</span><span class="ident" id="4660909">n</span>&nbsp;<span class="ident" id="4660911">Node</span><span class="op" id="4660915">)</span>&nbsp;<span class="op" id="4660917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660920">l</span><span class="op" id="4660921">.</span><span class="ident" id="4660922">Nodes</span>&nbsp;<span class="op" id="4660928">=</span>&nbsp;<span class="builtinfunc" id="4660930">append</span><span class="op" id="4660936">(</span><span class="ident" id="4660937">l</span><span class="op" id="4660938">.</span><span class="ident" id="4660939">Nodes</span><span class="op" id="4660944">,</span>&nbsp;<span class="ident" id="4660946">n</span><span class="op" id="4660947">)</span><br>
<span class="lineno">90</span><span class="op" id="4660949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4660952">func</span>&nbsp;<span class="op" id="4660957">(</span><span class="ident" id="4660958">l</span>&nbsp;<span class="op" id="4660960">*</span><span class="ident" id="4660961">ListNode</span><span class="op" id="4660969">)</span>&nbsp;<span class="ident" id="4660971">tree</span><span class="op" id="4660975">(</span><span class="op" id="4660976">)</span>&nbsp;<span class="op" id="4660978">*</span><span class="ident" id="4660979">Tree</span>&nbsp;<span class="op" id="4660984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660987">return</span>&nbsp;<span class="ident" id="4660994">l</span><span class="op" id="4660995">.</span><span class="ident" id="4660996">tr</span><br>
<span class="lineno"></span><span class="op" id="4660999">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4661002">func</span>&nbsp;<span class="op" id="4661007">(</span><span class="ident" id="4661008">l</span>&nbsp;<span class="op" id="4661010">*</span><span class="ident" id="4661011">ListNode</span><span class="op" id="4661019">)</span>&nbsp;<span class="ident" id="4661021">String</span><span class="op" id="4661027">(</span><span class="op" id="4661028">)</span>&nbsp;<span class="builtintype" id="4661030">string</span>&nbsp;<span class="op" id="4661037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661040">b</span>&nbsp;<span class="op" id="4661042">:=</span>&nbsp;<span class="builtinfunc" id="4661045">new</span><span class="op" id="4661048">(</span><span class="ident" id="4661049">bytes</span><span class="op" id="4661054">.</span><span class="ident" id="4661055">Buffer</span><span class="op" id="4661061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661064">for</span>&nbsp;<span class="ident" id="4661068">_</span><span class="op" id="4661069">,</span>&nbsp;<span class="ident" id="4661071">n</span>&nbsp;<span class="op" id="4661073">:=</span>&nbsp;<span class="keyword" id="4661076">range</span>&nbsp;<span class="ident" id="4661082">l</span><span class="op" id="4661083">.</span><span class="ident" id="4661084">Nodes</span>&nbsp;<span class="op" id="4661090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661094">fmt</span><span class="op" id="4661097">.</span><span class="ident" id="4661098">Fprint</span><span class="op" id="4661104">(</span><span class="ident" id="4661105">b</span><span class="op" id="4661106">,</span>&nbsp;<span class="ident" id="4661108">n</span><span class="op" id="4661109">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661115">return</span>&nbsp;<span class="ident" id="4661122">b</span><span class="op" id="4661123">.</span><span class="ident" id="4661124">String</span><span class="op" id="4661130">(</span><span class="op" id="4661131">)</span><br>
<span class="lineno"></span><span class="op" id="4661133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4661136">func</span>&nbsp;<span class="op" id="4661141">(</span><span class="ident" id="4661142">l</span>&nbsp;<span class="op" id="4661144">*</span><span class="ident" id="4661145">ListNode</span><span class="op" id="4661153">)</span>&nbsp;<span class="ident" id="4661155">CopyList</span><span class="op" id="4661163">(</span><span class="op" id="4661164">)</span>&nbsp;<span class="op" id="4661166">*</span><span class="ident" id="4661167">ListNode</span>&nbsp;<span class="op" id="4661176">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661179">if</span>&nbsp;<span class="ident" id="4661182">l</span>&nbsp;<span class="op" id="4661184">==</span>&nbsp;<span class="ident" id="4661187">nil</span>&nbsp;<span class="op" id="4661191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661195">return</span>&nbsp;<span class="ident" id="4661202">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661208">n</span>&nbsp;<span class="op" id="4661210">:=</span>&nbsp;<span class="ident" id="4661213">l</span><span class="op" id="4661214">.</span><span class="ident" id="4661215">tr</span><span class="op" id="4661217">.</span><span class="ident" id="4661218">newList</span><span class="op" id="4661225">(</span><span class="ident" id="4661226">l</span><span class="op" id="4661227">.</span><span class="ident" id="4661228">Pos</span><span class="op" id="4661231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661234">for</span>&nbsp;<span class="ident" id="4661238">_</span><span class="op" id="4661239">,</span>&nbsp;<span class="ident" id="4661241">elem</span>&nbsp;<span class="op" id="4661246">:=</span>&nbsp;<span class="keyword" id="4661249">range</span>&nbsp;<span class="ident" id="4661255">l</span><span class="op" id="4661256">.</span><span class="ident" id="4661257">Nodes</span>&nbsp;<span class="op" id="4661263">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661267">n</span><span class="op" id="4661268">.</span><span class="builtinfunc" id="4661269">append</span><span class="op" id="4661275">(</span><span class="ident" id="4661276">elem</span><span class="op" id="4661280">.</span><span class="ident" id="4661281">Copy</span><span class="op" id="4661285">(</span><span class="op" id="4661286">)</span><span class="op" id="4661287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661293">return</span>&nbsp;<span class="ident" id="4661300">n</span><br>
<span class="lineno"></span><span class="op" id="4661302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4661305">func</span>&nbsp;<span class="op" id="4661310">(</span><span class="ident" id="4661311">l</span>&nbsp;<span class="op" id="4661313">*</span><span class="ident" id="4661314">ListNode</span><span class="op" id="4661322">)</span>&nbsp;<span class="ident" id="4661324">Copy</span><span class="op" id="4661328">(</span><span class="op" id="4661329">)</span>&nbsp;<span class="ident" id="4661331">Node</span>&nbsp;<span class="op" id="4661336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661339">return</span>&nbsp;<span class="ident" id="4661346">l</span><span class="op" id="4661347">.</span><span class="ident" id="4661348">CopyList</span><span class="op" id="4661356">(</span><span class="op" id="4661357">)</span><br>
<span class="lineno"></span><span class="op" id="4661359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661362">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="4661392">type</span>&nbsp;<span class="ident" id="4661397">TextNode</span>&nbsp;<span class="keyword" id="4661406">struct</span>&nbsp;<span class="op" id="4661413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661416">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661426">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661431">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4661436">*</span><span class="ident" id="4661437">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661443">Text</span>&nbsp;<span class="op" id="4661448">[</span><span class="op" id="4661449">]</span><span class="builtintype" id="4661450">byte</span>&nbsp;<span class="comment" id="4661455">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="4661487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4661490">func</span>&nbsp;<span class="op" id="4661495">(</span><span class="ident" id="4661496">t</span>&nbsp;<span class="op" id="4661498">*</span><span class="ident" id="4661499">Tree</span><span class="op" id="4661503">)</span>&nbsp;<span class="ident" id="4661505">newText</span><span class="op" id="4661512">(</span><span class="ident" id="4661513">pos</span>&nbsp;<span class="ident" id="4661517">Pos</span><span class="op" id="4661520">,</span>&nbsp;<span class="ident" id="4661522">text</span>&nbsp;<span class="builtintype" id="4661527">string</span><span class="op" id="4661533">)</span>&nbsp;<span class="op" id="4661535">*</span><span class="ident" id="4661536">TextNode</span>&nbsp;<span class="op" id="4661545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661548">return</span>&nbsp;<span class="op" id="4661555">&amp;</span><span class="ident" id="4661556">TextNode</span><span class="op" id="4661564">{</span><span class="ident" id="4661565">tr</span><span class="op" id="4661567">:</span>&nbsp;<span class="ident" id="4661569">t</span><span class="op" id="4661570">,</span>&nbsp;<span class="ident" id="4661572">NodeType</span><span class="op" id="4661580">:</span>&nbsp;<span class="ident" id="4661582">NodeText</span><span class="op" id="4661590">,</span>&nbsp;<span class="ident" id="4661592">Pos</span><span class="op" id="4661595">:</span>&nbsp;<span class="ident" id="4661597">pos</span><span class="op" id="4661600">,</span>&nbsp;<span class="ident" id="4661602">Text</span><span class="op" id="4661606">:</span>&nbsp;<span class="op" id="4661608">[</span><span class="op" id="4661609">]</span><span class="builtintype" id="4661610">byte</span><span class="op" id="4661614">(</span><span class="ident" id="4661615">text</span><span class="op" id="4661619">)</span><span class="op" id="4661620">}</span><br>
<span class="lineno"></span><span class="op" id="4661622">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="4661625">func</span>&nbsp;<span class="op" id="4661630">(</span><span class="ident" id="4661631">t</span>&nbsp;<span class="op" id="4661633">*</span><span class="ident" id="4661634">TextNode</span><span class="op" id="4661642">)</span>&nbsp;<span class="ident" id="4661644">String</span><span class="op" id="4661650">(</span><span class="op" id="4661651">)</span>&nbsp;<span class="builtintype" id="4661653">string</span>&nbsp;<span class="op" id="4661660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661663">return</span>&nbsp;<span class="ident" id="4661670">fmt</span><span class="op" id="4661673">.</span><span class="ident" id="4661674">Sprintf</span><span class="op" id="4661681">(</span><span class="ident" id="4661682">textFormat</span><span class="op" id="4661692">,</span>&nbsp;<span class="ident" id="4661694">t</span><span class="op" id="4661695">.</span><span class="ident" id="4661696">Text</span><span class="op" id="4661700">)</span><br>
<span class="lineno"></span><span class="op" id="4661702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4661705">func</span>&nbsp;<span class="op" id="4661710">(</span><span class="ident" id="4661711">t</span>&nbsp;<span class="op" id="4661713">*</span><span class="ident" id="4661714">TextNode</span><span class="op" id="4661722">)</span>&nbsp;<span class="ident" id="4661724">tree</span><span class="op" id="4661728">(</span><span class="op" id="4661729">)</span>&nbsp;<span class="op" id="4661731">*</span><span class="ident" id="4661732">Tree</span>&nbsp;<span class="op" id="4661737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661740">return</span>&nbsp;<span class="ident" id="4661747">t</span><span class="op" id="4661748">.</span><span class="ident" id="4661749">tr</span><br>
<span class="lineno"></span><span class="op" id="4661752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4661755">func</span>&nbsp;<span class="op" id="4661760">(</span><span class="ident" id="4661761">t</span>&nbsp;<span class="op" id="4661763">*</span><span class="ident" id="4661764">TextNode</span><span class="op" id="4661772">)</span>&nbsp;<span class="ident" id="4661774">Copy</span><span class="op" id="4661778">(</span><span class="op" id="4661779">)</span>&nbsp;<span class="ident" id="4661781">Node</span>&nbsp;<span class="op" id="4661786">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661789">return</span>&nbsp;<span class="op" id="4661796">&amp;</span><span class="ident" id="4661797">TextNode</span><span class="op" id="4661805">{</span><span class="ident" id="4661806">tr</span><span class="op" id="4661808">:</span>&nbsp;<span class="ident" id="4661810">t</span><span class="op" id="4661811">.</span><span class="ident" id="4661812">tr</span><span class="op" id="4661814">,</span>&nbsp;<span class="ident" id="4661816">NodeType</span><span class="op" id="4661824">:</span>&nbsp;<span class="ident" id="4661826">NodeText</span><span class="op" id="4661834">,</span>&nbsp;<span class="ident" id="4661836">Pos</span><span class="op" id="4661839">:</span>&nbsp;<span class="ident" id="4661841">t</span><span class="op" id="4661842">.</span><span class="ident" id="4661843">Pos</span><span class="op" id="4661846">,</span>&nbsp;<span class="ident" id="4661848">Text</span><span class="op" id="4661852">:</span>&nbsp;<span class="builtinfunc" id="4661854">append</span><span class="op" id="4661860">(</span><span class="op" id="4661861">[</span><span class="op" id="4661862">]</span><span class="builtintype" id="4661863">byte</span><span class="op" id="4661867">{</span><span class="op" id="4661868">}</span><span class="op" id="4661869">,</span>&nbsp;<span class="ident" id="4661871">t</span><span class="op" id="4661872">.</span><span class="ident" id="4661873">Text</span><span class="op" id="4661877">...</span><span class="op" id="4661880">)</span><span class="op" id="4661881">}</span><br>
<span class="lineno"></span><span class="op" id="4661883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661886">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="4661941">type</span>&nbsp;<span class="ident" id="4661946">PipeNode</span>&nbsp;<span class="keyword" id="4661955">struct</span>&nbsp;<span class="op" id="4661962">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661965">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661975">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661980">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4661985">*</span><span class="ident" id="4661986">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661992">Line</span>&nbsp;<span class="builtintype" id="4661997">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4662013">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662083">Decl</span>&nbsp;<span class="op" id="4662088">[</span><span class="op" id="4662089">]</span><span class="op" id="4662090">*</span><span class="ident" id="4662091">VariableNode</span>&nbsp;<span class="comment" id="4662104">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662148">Cmds</span>&nbsp;<span class="op" id="4662153">[</span><span class="op" id="4662154">]</span><span class="op" id="4662155">*</span><span class="ident" id="4662156">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="4662169">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4662203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4662206">func</span>&nbsp;<span class="op" id="4662211">(</span><span class="ident" id="4662212">t</span>&nbsp;<span class="op" id="4662214">*</span><span class="ident" id="4662215">Tree</span><span class="op" id="4662219">)</span>&nbsp;<span class="ident" id="4662221">newPipeline</span><span class="op" id="4662232">(</span><span class="ident" id="4662233">pos</span>&nbsp;<span class="ident" id="4662237">Pos</span><span class="op" id="4662240">,</span>&nbsp;<span class="ident" id="4662242">line</span>&nbsp;<span class="builtintype" id="4662247">int</span><span class="op" id="4662250">,</span>&nbsp;<span class="ident" id="4662252">decl</span>&nbsp;<span class="op" id="4662257">[</span><span class="op" id="4662258">]</span><span class="op" id="4662259">*</span><span class="ident" id="4662260">VariableNode</span><span class="op" id="4662272">)</span>&nbsp;<span class="op" id="4662274">*</span><span class="ident" id="4662275">PipeNode</span>&nbsp;<span class="op" id="4662284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662287">return</span>&nbsp;<span class="op" id="4662294">&amp;</span><span class="ident" id="4662295">PipeNode</span><span class="op" id="4662303">{</span><span class="ident" id="4662304">tr</span><span class="op" id="4662306">:</span>&nbsp;<span class="ident" id="4662308">t</span><span class="op" id="4662309">,</span>&nbsp;<span class="ident" id="4662311">NodeType</span><span class="op" id="4662319">:</span>&nbsp;<span class="ident" id="4662321">NodePipe</span><span class="op" id="4662329">,</span>&nbsp;<span class="ident" id="4662331">Pos</span><span class="op" id="4662334">:</span>&nbsp;<span class="ident" id="4662336">pos</span><span class="op" id="4662339">,</span>&nbsp;<span class="ident" id="4662341">Line</span><span class="op" id="4662345">:</span>&nbsp;<span class="ident" id="4662347">line</span><span class="op" id="4662351">,</span>&nbsp;<span class="ident" id="4662353">Decl</span><span class="op" id="4662357">:</span>&nbsp;<span class="ident" id="4662359">decl</span><span class="op" id="4662363">}</span><br>
<span class="lineno">155</span><span class="op" id="4662365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4662368">func</span>&nbsp;<span class="op" id="4662373">(</span><span class="ident" id="4662374">p</span>&nbsp;<span class="op" id="4662376">*</span><span class="ident" id="4662377">PipeNode</span><span class="op" id="4662385">)</span>&nbsp;<span class="builtinfunc" id="4662387">append</span><span class="op" id="4662393">(</span><span class="ident" id="4662394">command</span>&nbsp;<span class="op" id="4662402">*</span><span class="ident" id="4662403">CommandNode</span><span class="op" id="4662414">)</span>&nbsp;<span class="op" id="4662416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662419">p</span><span class="op" id="4662420">.</span><span class="ident" id="4662421">Cmds</span>&nbsp;<span class="op" id="4662426">=</span>&nbsp;<span class="builtinfunc" id="4662428">append</span><span class="op" id="4662434">(</span><span class="ident" id="4662435">p</span><span class="op" id="4662436">.</span><span class="ident" id="4662437">Cmds</span><span class="op" id="4662441">,</span>&nbsp;<span class="ident" id="4662443">command</span><span class="op" id="4662450">)</span><br>
<span class="lineno"></span><span class="op" id="4662452">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="4662455">func</span>&nbsp;<span class="op" id="4662460">(</span><span class="ident" id="4662461">p</span>&nbsp;<span class="op" id="4662463">*</span><span class="ident" id="4662464">PipeNode</span><span class="op" id="4662472">)</span>&nbsp;<span class="ident" id="4662474">String</span><span class="op" id="4662480">(</span><span class="op" id="4662481">)</span>&nbsp;<span class="builtintype" id="4662483">string</span>&nbsp;<span class="op" id="4662490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662493">s</span>&nbsp;<span class="op" id="4662495">:=</span>&nbsp;<span class="string" id="4662498">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662502">if</span>&nbsp;<span class="builtinfunc" id="4662505">len</span><span class="op" id="4662508">(</span><span class="ident" id="4662509">p</span><span class="op" id="4662510">.</span><span class="ident" id="4662511">Decl</span><span class="op" id="4662515">)</span>&nbsp;<span class="op" id="4662517">&gt;</span>&nbsp;<span class="num" id="4662519">0</span>&nbsp;<span class="op" id="4662521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662525">for</span>&nbsp;<span class="ident" id="4662529">i</span><span class="op" id="4662530">,</span>&nbsp;<span class="ident" id="4662532">v</span>&nbsp;<span class="op" id="4662534">:=</span>&nbsp;<span class="keyword" id="4662537">range</span>&nbsp;<span class="ident" id="4662543">p</span><span class="op" id="4662544">.</span><span class="ident" id="4662545">Decl</span>&nbsp;<span class="op" id="4662550">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662555">if</span>&nbsp;<span class="ident" id="4662558">i</span>&nbsp;<span class="op" id="4662560">&gt;</span>&nbsp;<span class="num" id="4662562">0</span>&nbsp;<span class="op" id="4662564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662570">s</span>&nbsp;<span class="op" id="4662572">+=</span>&nbsp;<span class="string" id="4662575">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662588">s</span>&nbsp;<span class="op" id="4662590">+=</span>&nbsp;<span class="ident" id="4662593">v</span><span class="op" id="4662594">.</span><span class="ident" id="4662595">String</span><span class="op" id="4662601">(</span><span class="op" id="4662602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662606">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662610">s</span>&nbsp;<span class="op" id="4662612">+=</span>&nbsp;<span class="string" id="4662615">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662626">for</span>&nbsp;<span class="ident" id="4662630">i</span><span class="op" id="4662631">,</span>&nbsp;<span class="ident" id="4662633">c</span>&nbsp;<span class="op" id="4662635">:=</span>&nbsp;<span class="keyword" id="4662638">range</span>&nbsp;<span class="ident" id="4662644">p</span><span class="op" id="4662645">.</span><span class="ident" id="4662646">Cmds</span>&nbsp;<span class="op" id="4662651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662655">if</span>&nbsp;<span class="ident" id="4662658">i</span>&nbsp;<span class="op" id="4662660">&gt;</span>&nbsp;<span class="num" id="4662662">0</span>&nbsp;<span class="op" id="4662664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662669">s</span>&nbsp;<span class="op" id="4662671">+=</span>&nbsp;<span class="string" id="4662674">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662686">s</span>&nbsp;<span class="op" id="4662688">+=</span>&nbsp;<span class="ident" id="4662691">c</span><span class="op" id="4662692">.</span><span class="ident" id="4662693">String</span><span class="op" id="4662699">(</span><span class="op" id="4662700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662706">return</span>&nbsp;<span class="ident" id="4662713">s</span><br>
<span class="lineno"></span><span class="op" id="4662715">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4662718">func</span>&nbsp;<span class="op" id="4662723">(</span><span class="ident" id="4662724">p</span>&nbsp;<span class="op" id="4662726">*</span><span class="ident" id="4662727">PipeNode</span><span class="op" id="4662735">)</span>&nbsp;<span class="ident" id="4662737">tree</span><span class="op" id="4662741">(</span><span class="op" id="4662742">)</span>&nbsp;<span class="op" id="4662744">*</span><span class="ident" id="4662745">Tree</span>&nbsp;<span class="op" id="4662750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662753">return</span>&nbsp;<span class="ident" id="4662760">p</span><span class="op" id="4662761">.</span><span class="ident" id="4662762">tr</span><br>
<span class="lineno"></span><span class="op" id="4662765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4662768">func</span>&nbsp;<span class="op" id="4662773">(</span><span class="ident" id="4662774">p</span>&nbsp;<span class="op" id="4662776">*</span><span class="ident" id="4662777">PipeNode</span><span class="op" id="4662785">)</span>&nbsp;<span class="ident" id="4662787">CopyPipe</span><span class="op" id="4662795">(</span><span class="op" id="4662796">)</span>&nbsp;<span class="op" id="4662798">*</span><span class="ident" id="4662799">PipeNode</span>&nbsp;<span class="op" id="4662808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662811">if</span>&nbsp;<span class="ident" id="4662814">p</span>&nbsp;<span class="op" id="4662816">==</span>&nbsp;<span class="ident" id="4662819">nil</span>&nbsp;<span class="op" id="4662823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662827">return</span>&nbsp;<span class="ident" id="4662834">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662840">var</span>&nbsp;<span class="ident" id="4662844">decl</span>&nbsp;<span class="op" id="4662849">[</span><span class="op" id="4662850">]</span><span class="op" id="4662851">*</span><span class="ident" id="4662852">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662866">for</span>&nbsp;<span class="ident" id="4662870">_</span><span class="op" id="4662871">,</span>&nbsp;<span class="ident" id="4662873">d</span>&nbsp;<span class="op" id="4662875">:=</span>&nbsp;<span class="keyword" id="4662878">range</span>&nbsp;<span class="ident" id="4662884">p</span><span class="op" id="4662885">.</span><span class="ident" id="4662886">Decl</span>&nbsp;<span class="op" id="4662891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662895">decl</span>&nbsp;<span class="op" id="4662900">=</span>&nbsp;<span class="builtinfunc" id="4662902">append</span><span class="op" id="4662908">(</span><span class="ident" id="4662909">decl</span><span class="op" id="4662913">,</span>&nbsp;<span class="ident" id="4662915">d</span><span class="op" id="4662916">.</span><span class="ident" id="4662917">Copy</span><span class="op" id="4662921">(</span><span class="op" id="4662922">)</span><span class="op" id="4662923">.</span><span class="op" id="4662924">(</span><span class="op" id="4662925">*</span><span class="ident" id="4662926">VariableNode</span><span class="op" id="4662938">)</span><span class="op" id="4662939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662945">n</span>&nbsp;<span class="op" id="4662947">:=</span>&nbsp;<span class="ident" id="4662950">p</span><span class="op" id="4662951">.</span><span class="ident" id="4662952">tr</span><span class="op" id="4662954">.</span><span class="ident" id="4662955">newPipeline</span><span class="op" id="4662966">(</span><span class="ident" id="4662967">p</span><span class="op" id="4662968">.</span><span class="ident" id="4662969">Pos</span><span class="op" id="4662972">,</span>&nbsp;<span class="ident" id="4662974">p</span><span class="op" id="4662975">.</span><span class="ident" id="4662976">Line</span><span class="op" id="4662980">,</span>&nbsp;<span class="ident" id="4662982">decl</span><span class="op" id="4662986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662989">for</span>&nbsp;<span class="ident" id="4662993">_</span><span class="op" id="4662994">,</span>&nbsp;<span class="ident" id="4662996">c</span>&nbsp;<span class="op" id="4662998">:=</span>&nbsp;<span class="keyword" id="4663001">range</span>&nbsp;<span class="ident" id="4663007">p</span><span class="op" id="4663008">.</span><span class="ident" id="4663009">Cmds</span>&nbsp;<span class="op" id="4663014">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663018">n</span><span class="op" id="4663019">.</span><span class="builtinfunc" id="4663020">append</span><span class="op" id="4663026">(</span><span class="ident" id="4663027">c</span><span class="op" id="4663028">.</span><span class="ident" id="4663029">Copy</span><span class="op" id="4663033">(</span><span class="op" id="4663034">)</span><span class="op" id="4663035">.</span><span class="op" id="4663036">(</span><span class="op" id="4663037">*</span><span class="ident" id="4663038">CommandNode</span><span class="op" id="4663049">)</span><span class="op" id="4663050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4663053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663056">return</span>&nbsp;<span class="ident" id="4663063">n</span><br>
<span class="lineno"></span><span class="op" id="4663065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="4663068">func</span>&nbsp;<span class="op" id="4663073">(</span><span class="ident" id="4663074">p</span>&nbsp;<span class="op" id="4663076">*</span><span class="ident" id="4663077">PipeNode</span><span class="op" id="4663085">)</span>&nbsp;<span class="ident" id="4663087">Copy</span><span class="op" id="4663091">(</span><span class="op" id="4663092">)</span>&nbsp;<span class="ident" id="4663094">Node</span>&nbsp;<span class="op" id="4663099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663102">return</span>&nbsp;<span class="ident" id="4663109">p</span><span class="op" id="4663110">.</span><span class="ident" id="4663111">CopyPipe</span><span class="op" id="4663119">(</span><span class="op" id="4663120">)</span><br>
<span class="lineno"></span><span class="op" id="4663122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663125">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="4663190">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="4663260">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="4663323">type</span>&nbsp;<span class="ident" id="4663328">ActionNode</span>&nbsp;<span class="keyword" id="4663339">struct</span>&nbsp;<span class="op" id="4663346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663349">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663359">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663364">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4663369">*</span><span class="ident" id="4663370">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663376">Line</span>&nbsp;<span class="builtintype" id="4663381">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4663391">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663461">Pipe</span>&nbsp;<span class="op" id="4663466">*</span><span class="ident" id="4663467">PipeNode</span>&nbsp;<span class="comment" id="4663476">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="4663507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4663510">func</span>&nbsp;<span class="op" id="4663515">(</span><span class="ident" id="4663516">t</span>&nbsp;<span class="op" id="4663518">*</span><span class="ident" id="4663519">Tree</span><span class="op" id="4663523">)</span>&nbsp;<span class="ident" id="4663525">newAction</span><span class="op" id="4663534">(</span><span class="ident" id="4663535">pos</span>&nbsp;<span class="ident" id="4663539">Pos</span><span class="op" id="4663542">,</span>&nbsp;<span class="ident" id="4663544">line</span>&nbsp;<span class="builtintype" id="4663549">int</span><span class="op" id="4663552">,</span>&nbsp;<span class="ident" id="4663554">pipe</span>&nbsp;<span class="op" id="4663559">*</span><span class="ident" id="4663560">PipeNode</span><span class="op" id="4663568">)</span>&nbsp;<span class="op" id="4663570">*</span><span class="ident" id="4663571">ActionNode</span>&nbsp;<span class="op" id="4663582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663585">return</span>&nbsp;<span class="op" id="4663592">&amp;</span><span class="ident" id="4663593">ActionNode</span><span class="op" id="4663603">{</span><span class="ident" id="4663604">tr</span><span class="op" id="4663606">:</span>&nbsp;<span class="ident" id="4663608">t</span><span class="op" id="4663609">,</span>&nbsp;<span class="ident" id="4663611">NodeType</span><span class="op" id="4663619">:</span>&nbsp;<span class="ident" id="4663621">NodeAction</span><span class="op" id="4663631">,</span>&nbsp;<span class="ident" id="4663633">Pos</span><span class="op" id="4663636">:</span>&nbsp;<span class="ident" id="4663638">pos</span><span class="op" id="4663641">,</span>&nbsp;<span class="ident" id="4663643">Line</span><span class="op" id="4663647">:</span>&nbsp;<span class="ident" id="4663649">line</span><span class="op" id="4663653">,</span>&nbsp;<span class="ident" id="4663655">Pipe</span><span class="op" id="4663659">:</span>&nbsp;<span class="ident" id="4663661">pipe</span><span class="op" id="4663665">}</span><br>
<span class="lineno"></span><span class="op" id="4663667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663670">func</span>&nbsp;<span class="op" id="4663675">(</span><span class="ident" id="4663676">a</span>&nbsp;<span class="op" id="4663678">*</span><span class="ident" id="4663679">ActionNode</span><span class="op" id="4663689">)</span>&nbsp;<span class="ident" id="4663691">String</span><span class="op" id="4663697">(</span><span class="op" id="4663698">)</span>&nbsp;<span class="builtintype" id="4663700">string</span>&nbsp;<span class="op" id="4663707">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663710">return</span>&nbsp;<span class="ident" id="4663717">fmt</span><span class="op" id="4663720">.</span><span class="ident" id="4663721">Sprintf</span><span class="op" id="4663728">(</span><span class="string" id="4663729">&#34;{{%s}}&#34;</span><span class="op" id="4663737">,</span>&nbsp;<span class="ident" id="4663739">a</span><span class="op" id="4663740">.</span><span class="ident" id="4663741">Pipe</span><span class="op" id="4663745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="4663748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663751">func</span>&nbsp;<span class="op" id="4663756">(</span><span class="ident" id="4663757">a</span>&nbsp;<span class="op" id="4663759">*</span><span class="ident" id="4663760">ActionNode</span><span class="op" id="4663770">)</span>&nbsp;<span class="ident" id="4663772">tree</span><span class="op" id="4663776">(</span><span class="op" id="4663777">)</span>&nbsp;<span class="op" id="4663779">*</span><span class="ident" id="4663780">Tree</span>&nbsp;<span class="op" id="4663785">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663788">return</span>&nbsp;<span class="ident" id="4663795">a</span><span class="op" id="4663796">.</span><span class="ident" id="4663797">tr</span><br>
<span class="lineno"></span><span class="op" id="4663800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4663803">func</span>&nbsp;<span class="op" id="4663808">(</span><span class="ident" id="4663809">a</span>&nbsp;<span class="op" id="4663811">*</span><span class="ident" id="4663812">ActionNode</span><span class="op" id="4663822">)</span>&nbsp;<span class="ident" id="4663824">Copy</span><span class="op" id="4663828">(</span><span class="op" id="4663829">)</span>&nbsp;<span class="ident" id="4663831">Node</span>&nbsp;<span class="op" id="4663836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663839">return</span>&nbsp;<span class="ident" id="4663846">a</span><span class="op" id="4663847">.</span><span class="ident" id="4663848">tr</span><span class="op" id="4663850">.</span><span class="ident" id="4663851">newAction</span><span class="op" id="4663860">(</span><span class="ident" id="4663861">a</span><span class="op" id="4663862">.</span><span class="ident" id="4663863">Pos</span><span class="op" id="4663866">,</span>&nbsp;<span class="ident" id="4663868">a</span><span class="op" id="4663869">.</span><span class="ident" id="4663870">Line</span><span class="op" id="4663874">,</span>&nbsp;<span class="ident" id="4663876">a</span><span class="op" id="4663877">.</span><span class="ident" id="4663878">Pipe</span><span class="op" id="4663882">.</span><span class="ident" id="4663883">CopyPipe</span><span class="op" id="4663891">(</span><span class="op" id="4663892">)</span><span class="op" id="4663893">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="4663896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663899">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="4663972">type</span>&nbsp;<span class="ident" id="4663977">CommandNode</span>&nbsp;<span class="keyword" id="4663989">struct</span>&nbsp;<span class="op" id="4663996">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663999">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664009">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664014">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4664019">*</span><span class="ident" id="4664020">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664026">Args</span>&nbsp;<span class="op" id="4664031">[</span><span class="op" id="4664032">]</span><span class="ident" id="4664033">Node</span>&nbsp;<span class="comment" id="4664038">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4664101">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="4664104">func</span>&nbsp;<span class="op" id="4664109">(</span><span class="ident" id="4664110">t</span>&nbsp;<span class="op" id="4664112">*</span><span class="ident" id="4664113">Tree</span><span class="op" id="4664117">)</span>&nbsp;<span class="ident" id="4664119">newCommand</span><span class="op" id="4664129">(</span><span class="ident" id="4664130">pos</span>&nbsp;<span class="ident" id="4664134">Pos</span><span class="op" id="4664137">)</span>&nbsp;<span class="op" id="4664139">*</span><span class="ident" id="4664140">CommandNode</span>&nbsp;<span class="op" id="4664152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664155">return</span>&nbsp;<span class="op" id="4664162">&amp;</span><span class="ident" id="4664163">CommandNode</span><span class="op" id="4664174">{</span><span class="ident" id="4664175">tr</span><span class="op" id="4664177">:</span>&nbsp;<span class="ident" id="4664179">t</span><span class="op" id="4664180">,</span>&nbsp;<span class="ident" id="4664182">NodeType</span><span class="op" id="4664190">:</span>&nbsp;<span class="ident" id="4664192">NodeCommand</span><span class="op" id="4664203">,</span>&nbsp;<span class="ident" id="4664205">Pos</span><span class="op" id="4664208">:</span>&nbsp;<span class="ident" id="4664210">pos</span><span class="op" id="4664213">}</span><br>
<span class="lineno"></span><span class="op" id="4664215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="4664218">func</span>&nbsp;<span class="op" id="4664223">(</span><span class="ident" id="4664224">c</span>&nbsp;<span class="op" id="4664226">*</span><span class="ident" id="4664227">CommandNode</span><span class="op" id="4664238">)</span>&nbsp;<span class="builtinfunc" id="4664240">append</span><span class="op" id="4664246">(</span><span class="ident" id="4664247">arg</span>&nbsp;<span class="ident" id="4664251">Node</span><span class="op" id="4664255">)</span>&nbsp;<span class="op" id="4664257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664260">c</span><span class="op" id="4664261">.</span><span class="ident" id="4664262">Args</span>&nbsp;<span class="op" id="4664267">=</span>&nbsp;<span class="builtinfunc" id="4664269">append</span><span class="op" id="4664275">(</span><span class="ident" id="4664276">c</span><span class="op" id="4664277">.</span><span class="ident" id="4664278">Args</span><span class="op" id="4664282">,</span>&nbsp;<span class="ident" id="4664284">arg</span><span class="op" id="4664287">)</span><br>
<span class="lineno"></span><span class="op" id="4664289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664292">func</span>&nbsp;<span class="op" id="4664297">(</span><span class="ident" id="4664298">c</span>&nbsp;<span class="op" id="4664300">*</span><span class="ident" id="4664301">CommandNode</span><span class="op" id="4664312">)</span>&nbsp;<span class="ident" id="4664314">String</span><span class="op" id="4664320">(</span><span class="op" id="4664321">)</span>&nbsp;<span class="builtintype" id="4664323">string</span>&nbsp;<span class="op" id="4664330">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664333">s</span>&nbsp;<span class="op" id="4664335">:=</span>&nbsp;<span class="string" id="4664338">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664342">for</span>&nbsp;<span class="ident" id="4664346">i</span><span class="op" id="4664347">,</span>&nbsp;<span class="ident" id="4664349">arg</span>&nbsp;<span class="op" id="4664353">:=</span>&nbsp;<span class="keyword" id="4664356">range</span>&nbsp;<span class="ident" id="4664362">c</span><span class="op" id="4664363">.</span><span class="ident" id="4664364">Args</span>&nbsp;<span class="op" id="4664369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664373">if</span>&nbsp;<span class="ident" id="4664376">i</span>&nbsp;<span class="op" id="4664378">&gt;</span>&nbsp;<span class="num" id="4664380">0</span>&nbsp;<span class="op" id="4664382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664387">s</span>&nbsp;<span class="op" id="4664389">+=</span>&nbsp;<span class="string" id="4664392">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664398">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664402">if</span>&nbsp;<span class="ident" id="4664405">arg</span><span class="op" id="4664408">,</span>&nbsp;<span class="ident" id="4664410">ok</span>&nbsp;<span class="op" id="4664413">:=</span>&nbsp;<span class="ident" id="4664416">arg</span><span class="op" id="4664419">.</span><span class="op" id="4664420">(</span><span class="op" id="4664421">*</span><span class="ident" id="4664422">PipeNode</span><span class="op" id="4664430">)</span><span class="op" id="4664431">;</span>&nbsp;<span class="ident" id="4664433">ok</span>&nbsp;<span class="op" id="4664436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664441">s</span>&nbsp;<span class="op" id="4664443">+=</span>&nbsp;<span class="string" id="4664446">&#34;(&#34;</span>&nbsp;<span class="op" id="4664450">+</span>&nbsp;<span class="ident" id="4664452">arg</span><span class="op" id="4664455">.</span><span class="ident" id="4664456">String</span><span class="op" id="4664462">(</span><span class="op" id="4664463">)</span>&nbsp;<span class="op" id="4664465">+</span>&nbsp;<span class="string" id="4664467">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664474">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664489">s</span>&nbsp;<span class="op" id="4664491">+=</span>&nbsp;<span class="ident" id="4664494">arg</span><span class="op" id="4664497">.</span><span class="ident" id="4664498">String</span><span class="op" id="4664504">(</span><span class="op" id="4664505">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664511">return</span>&nbsp;<span class="ident" id="4664518">s</span><br>
<span class="lineno"></span><span class="op" id="4664520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664523">func</span>&nbsp;<span class="op" id="4664528">(</span><span class="ident" id="4664529">c</span>&nbsp;<span class="op" id="4664531">*</span><span class="ident" id="4664532">CommandNode</span><span class="op" id="4664543">)</span>&nbsp;<span class="ident" id="4664545">tree</span><span class="op" id="4664549">(</span><span class="op" id="4664550">)</span>&nbsp;<span class="op" id="4664552">*</span><span class="ident" id="4664553">Tree</span>&nbsp;<span class="op" id="4664558">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664561">return</span>&nbsp;<span class="ident" id="4664568">c</span><span class="op" id="4664569">.</span><span class="ident" id="4664570">tr</span><br>
<span class="lineno"></span><span class="op" id="4664573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664576">func</span>&nbsp;<span class="op" id="4664581">(</span><span class="ident" id="4664582">c</span>&nbsp;<span class="op" id="4664584">*</span><span class="ident" id="4664585">CommandNode</span><span class="op" id="4664596">)</span>&nbsp;<span class="ident" id="4664598">Copy</span><span class="op" id="4664602">(</span><span class="op" id="4664603">)</span>&nbsp;<span class="ident" id="4664605">Node</span>&nbsp;<span class="op" id="4664610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664613">if</span>&nbsp;<span class="ident" id="4664616">c</span>&nbsp;<span class="op" id="4664618">==</span>&nbsp;<span class="ident" id="4664621">nil</span>&nbsp;<span class="op" id="4664625">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664629">return</span>&nbsp;<span class="ident" id="4664636">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664642">n</span>&nbsp;<span class="op" id="4664644">:=</span>&nbsp;<span class="ident" id="4664647">c</span><span class="op" id="4664648">.</span><span class="ident" id="4664649">tr</span><span class="op" id="4664651">.</span><span class="ident" id="4664652">newCommand</span><span class="op" id="4664662">(</span><span class="ident" id="4664663">c</span><span class="op" id="4664664">.</span><span class="ident" id="4664665">Pos</span><span class="op" id="4664668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664671">for</span>&nbsp;<span class="ident" id="4664675">_</span><span class="op" id="4664676">,</span>&nbsp;<span class="ident" id="4664678">c</span>&nbsp;<span class="op" id="4664680">:=</span>&nbsp;<span class="keyword" id="4664683">range</span>&nbsp;<span class="ident" id="4664689">c</span><span class="op" id="4664690">.</span><span class="ident" id="4664691">Args</span>&nbsp;<span class="op" id="4664696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664700">n</span><span class="op" id="4664701">.</span><span class="builtinfunc" id="4664702">append</span><span class="op" id="4664708">(</span><span class="ident" id="4664709">c</span><span class="op" id="4664710">.</span><span class="ident" id="4664711">Copy</span><span class="op" id="4664715">(</span><span class="op" id="4664716">)</span><span class="op" id="4664717">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664723">return</span>&nbsp;<span class="ident" id="4664730">n</span><br>
<span class="lineno"></span><span class="op" id="4664732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4664735">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="4664774">type</span>&nbsp;<span class="ident" id="4664779">IdentifierNode</span>&nbsp;<span class="keyword" id="4664794">struct</span>&nbsp;<span class="op" id="4664801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664804">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664814">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664819">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4664825">*</span><span class="ident" id="4664826">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664832">Ident</span>&nbsp;<span class="builtintype" id="4664838">string</span>&nbsp;<span class="comment" id="4664845">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="4664871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4664874">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4664952">func</span>&nbsp;<span class="ident" id="4664957">NewIdentifier</span><span class="op" id="4664970">(</span><span class="ident" id="4664971">ident</span>&nbsp;<span class="builtintype" id="4664977">string</span><span class="op" id="4664983">)</span>&nbsp;<span class="op" id="4664985">*</span><span class="ident" id="4664986">IdentifierNode</span>&nbsp;<span class="op" id="4665001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665004">return</span>&nbsp;<span class="op" id="4665011">&amp;</span><span class="ident" id="4665012">IdentifierNode</span><span class="op" id="4665026">{</span><span class="ident" id="4665027">NodeType</span><span class="op" id="4665035">:</span>&nbsp;<span class="ident" id="4665037">NodeIdentifier</span><span class="op" id="4665051">,</span>&nbsp;<span class="ident" id="4665053">Ident</span><span class="op" id="4665058">:</span>&nbsp;<span class="ident" id="4665060">ident</span><span class="op" id="4665065">}</span><br>
<span class="lineno">290</span><span class="op" id="4665067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4665070">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4665166">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4665194">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="4665216">func</span>&nbsp;<span class="op" id="4665221">(</span><span class="ident" id="4665222">i</span>&nbsp;<span class="op" id="4665224">*</span><span class="ident" id="4665225">IdentifierNode</span><span class="op" id="4665239">)</span>&nbsp;<span class="ident" id="4665241">SetPos</span><span class="op" id="4665247">(</span><span class="ident" id="4665248">pos</span>&nbsp;<span class="ident" id="4665252">Pos</span><span class="op" id="4665255">)</span>&nbsp;<span class="op" id="4665257">*</span><span class="ident" id="4665258">IdentifierNode</span>&nbsp;<span class="op" id="4665273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665276">i</span><span class="op" id="4665277">.</span><span class="ident" id="4665278">Pos</span>&nbsp;<span class="op" id="4665282">=</span>&nbsp;<span class="ident" id="4665284">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665289">return</span>&nbsp;<span class="ident" id="4665296">i</span><br>
<span class="lineno"></span><span class="op" id="4665298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="4665301">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="4665414">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="4665442">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="4665464">func</span>&nbsp;<span class="op" id="4665469">(</span><span class="ident" id="4665470">i</span>&nbsp;<span class="op" id="4665472">*</span><span class="ident" id="4665473">IdentifierNode</span><span class="op" id="4665487">)</span>&nbsp;<span class="ident" id="4665489">SetTree</span><span class="op" id="4665496">(</span><span class="ident" id="4665497">t</span>&nbsp;<span class="op" id="4665499">*</span><span class="ident" id="4665500">Tree</span><span class="op" id="4665504">)</span>&nbsp;<span class="op" id="4665506">*</span><span class="ident" id="4665507">IdentifierNode</span>&nbsp;<span class="op" id="4665522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665525">i</span><span class="op" id="4665526">.</span><span class="ident" id="4665527">tr</span>&nbsp;<span class="op" id="4665530">=</span>&nbsp;<span class="ident" id="4665532">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665535">return</span>&nbsp;<span class="ident" id="4665542">i</span><br>
<span class="lineno"></span><span class="op" id="4665544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665547">func</span>&nbsp;<span class="op" id="4665552">(</span><span class="ident" id="4665553">i</span>&nbsp;<span class="op" id="4665555">*</span><span class="ident" id="4665556">IdentifierNode</span><span class="op" id="4665570">)</span>&nbsp;<span class="ident" id="4665572">String</span><span class="op" id="4665578">(</span><span class="op" id="4665579">)</span>&nbsp;<span class="builtintype" id="4665581">string</span>&nbsp;<span class="op" id="4665588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665591">return</span>&nbsp;<span class="ident" id="4665598">i</span><span class="op" id="4665599">.</span><span class="ident" id="4665600">Ident</span><br>
<span class="lineno">310</span><span class="op" id="4665606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665609">func</span>&nbsp;<span class="op" id="4665614">(</span><span class="ident" id="4665615">i</span>&nbsp;<span class="op" id="4665617">*</span><span class="ident" id="4665618">IdentifierNode</span><span class="op" id="4665632">)</span>&nbsp;<span class="ident" id="4665634">tree</span><span class="op" id="4665638">(</span><span class="op" id="4665639">)</span>&nbsp;<span class="op" id="4665641">*</span><span class="ident" id="4665642">Tree</span>&nbsp;<span class="op" id="4665647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665650">return</span>&nbsp;<span class="ident" id="4665657">i</span><span class="op" id="4665658">.</span><span class="ident" id="4665659">tr</span><br>
<span class="lineno"></span><span class="op" id="4665662">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4665665">func</span>&nbsp;<span class="op" id="4665670">(</span><span class="ident" id="4665671">i</span>&nbsp;<span class="op" id="4665673">*</span><span class="ident" id="4665674">IdentifierNode</span><span class="op" id="4665688">)</span>&nbsp;<span class="ident" id="4665690">Copy</span><span class="op" id="4665694">(</span><span class="op" id="4665695">)</span>&nbsp;<span class="ident" id="4665697">Node</span>&nbsp;<span class="op" id="4665702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665705">return</span>&nbsp;<span class="ident" id="4665712">NewIdentifier</span><span class="op" id="4665725">(</span><span class="ident" id="4665726">i</span><span class="op" id="4665727">.</span><span class="ident" id="4665728">Ident</span><span class="op" id="4665733">)</span><span class="op" id="4665734">.</span><span class="ident" id="4665735">SetTree</span><span class="op" id="4665742">(</span><span class="ident" id="4665743">i</span><span class="op" id="4665744">.</span><span class="ident" id="4665745">tr</span><span class="op" id="4665747">)</span><span class="op" id="4665748">.</span><span class="ident" id="4665749">SetPos</span><span class="op" id="4665755">(</span><span class="ident" id="4665756">i</span><span class="op" id="4665757">.</span><span class="ident" id="4665758">Pos</span><span class="op" id="4665761">)</span><br>
<span class="lineno"></span><span class="op" id="4665763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="4665766">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4665842">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4665900">type</span>&nbsp;<span class="ident" id="4665905">VariableNode</span>&nbsp;<span class="keyword" id="4665918">struct</span>&nbsp;<span class="op" id="4665925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665928">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665938">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665943">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4665949">*</span><span class="ident" id="4665950">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665956">Ident</span>&nbsp;<span class="op" id="4665962">[</span><span class="op" id="4665963">]</span><span class="builtintype" id="4665964">string</span>&nbsp;<span class="comment" id="4665971">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4666017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666020">func</span>&nbsp;<span class="op" id="4666025">(</span><span class="ident" id="4666026">t</span>&nbsp;<span class="op" id="4666028">*</span><span class="ident" id="4666029">Tree</span><span class="op" id="4666033">)</span>&nbsp;<span class="ident" id="4666035">newVariable</span><span class="op" id="4666046">(</span><span class="ident" id="4666047">pos</span>&nbsp;<span class="ident" id="4666051">Pos</span><span class="op" id="4666054">,</span>&nbsp;<span class="ident" id="4666056">ident</span>&nbsp;<span class="builtintype" id="4666062">string</span><span class="op" id="4666068">)</span>&nbsp;<span class="op" id="4666070">*</span><span class="ident" id="4666071">VariableNode</span>&nbsp;<span class="op" id="4666084">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666087">return</span>&nbsp;<span class="op" id="4666094">&amp;</span><span class="ident" id="4666095">VariableNode</span><span class="op" id="4666107">{</span><span class="ident" id="4666108">tr</span><span class="op" id="4666110">:</span>&nbsp;<span class="ident" id="4666112">t</span><span class="op" id="4666113">,</span>&nbsp;<span class="ident" id="4666115">NodeType</span><span class="op" id="4666123">:</span>&nbsp;<span class="ident" id="4666125">NodeVariable</span><span class="op" id="4666137">,</span>&nbsp;<span class="ident" id="4666139">Pos</span><span class="op" id="4666142">:</span>&nbsp;<span class="ident" id="4666144">pos</span><span class="op" id="4666147">,</span>&nbsp;<span class="ident" id="4666149">Ident</span><span class="op" id="4666154">:</span>&nbsp;<span class="ident" id="4666156">strings</span><span class="op" id="4666163">.</span><span class="ident" id="4666164">Split</span><span class="op" id="4666169">(</span><span class="ident" id="4666170">ident</span><span class="op" id="4666175">,</span>&nbsp;<span class="string" id="4666177">&#34;.&#34;</span><span class="op" id="4666180">)</span><span class="op" id="4666181">}</span><br>
<span class="lineno"></span><span class="op" id="4666183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666186">func</span>&nbsp;<span class="op" id="4666191">(</span><span class="ident" id="4666192">v</span>&nbsp;<span class="op" id="4666194">*</span><span class="ident" id="4666195">VariableNode</span><span class="op" id="4666207">)</span>&nbsp;<span class="ident" id="4666209">String</span><span class="op" id="4666215">(</span><span class="op" id="4666216">)</span>&nbsp;<span class="builtintype" id="4666218">string</span>&nbsp;<span class="op" id="4666225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666228">s</span>&nbsp;<span class="op" id="4666230">:=</span>&nbsp;<span class="string" id="4666233">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666237">for</span>&nbsp;<span class="ident" id="4666241">i</span><span class="op" id="4666242">,</span>&nbsp;<span class="ident" id="4666244">id</span>&nbsp;<span class="op" id="4666247">:=</span>&nbsp;<span class="keyword" id="4666250">range</span>&nbsp;<span class="ident" id="4666256">v</span><span class="op" id="4666257">.</span><span class="ident" id="4666258">Ident</span>&nbsp;<span class="op" id="4666264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666268">if</span>&nbsp;<span class="ident" id="4666271">i</span>&nbsp;<span class="op" id="4666273">&gt;</span>&nbsp;<span class="num" id="4666275">0</span>&nbsp;<span class="op" id="4666277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666282">s</span>&nbsp;<span class="op" id="4666284">+=</span>&nbsp;<span class="string" id="4666287">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666297">s</span>&nbsp;<span class="op" id="4666299">+=</span>&nbsp;<span class="ident" id="4666302">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666309">return</span>&nbsp;<span class="ident" id="4666316">s</span><br>
<span class="lineno"></span><span class="op" id="4666318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666321">func</span>&nbsp;<span class="op" id="4666326">(</span><span class="ident" id="4666327">v</span>&nbsp;<span class="op" id="4666329">*</span><span class="ident" id="4666330">VariableNode</span><span class="op" id="4666342">)</span>&nbsp;<span class="ident" id="4666344">tree</span><span class="op" id="4666348">(</span><span class="op" id="4666349">)</span>&nbsp;<span class="op" id="4666351">*</span><span class="ident" id="4666352">Tree</span>&nbsp;<span class="op" id="4666357">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666360">return</span>&nbsp;<span class="ident" id="4666367">v</span><span class="op" id="4666368">.</span><span class="ident" id="4666369">tr</span><br>
<span class="lineno"></span><span class="op" id="4666372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666375">func</span>&nbsp;<span class="op" id="4666380">(</span><span class="ident" id="4666381">v</span>&nbsp;<span class="op" id="4666383">*</span><span class="ident" id="4666384">VariableNode</span><span class="op" id="4666396">)</span>&nbsp;<span class="ident" id="4666398">Copy</span><span class="op" id="4666402">(</span><span class="op" id="4666403">)</span>&nbsp;<span class="ident" id="4666405">Node</span>&nbsp;<span class="op" id="4666410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666413">return</span>&nbsp;<span class="op" id="4666420">&amp;</span><span class="ident" id="4666421">VariableNode</span><span class="op" id="4666433">{</span><span class="ident" id="4666434">tr</span><span class="op" id="4666436">:</span>&nbsp;<span class="ident" id="4666438">v</span><span class="op" id="4666439">.</span><span class="ident" id="4666440">tr</span><span class="op" id="4666442">,</span>&nbsp;<span class="ident" id="4666444">NodeType</span><span class="op" id="4666452">:</span>&nbsp;<span class="ident" id="4666454">NodeVariable</span><span class="op" id="4666466">,</span>&nbsp;<span class="ident" id="4666468">Pos</span><span class="op" id="4666471">:</span>&nbsp;<span class="ident" id="4666473">v</span><span class="op" id="4666474">.</span><span class="ident" id="4666475">Pos</span><span class="op" id="4666478">,</span>&nbsp;<span class="ident" id="4666480">Ident</span><span class="op" id="4666485">:</span>&nbsp;<span class="builtinfunc" id="4666487">append</span><span class="op" id="4666493">(</span><span class="op" id="4666494">[</span><span class="op" id="4666495">]</span><span class="builtintype" id="4666496">string</span><span class="op" id="4666502">{</span><span class="op" id="4666503">}</span><span class="op" id="4666504">,</span>&nbsp;<span class="ident" id="4666506">v</span><span class="op" id="4666507">.</span><span class="ident" id="4666508">Ident</span><span class="op" id="4666513">...</span><span class="op" id="4666516">)</span><span class="op" id="4666517">}</span><br>
<span class="lineno">350</span><span class="op" id="4666519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4666522">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="4666567">type</span>&nbsp;<span class="ident" id="4666572">DotNode</span>&nbsp;<span class="keyword" id="4666580">struct</span>&nbsp;<span class="op" id="4666587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666590">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666600">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666605">tr</span>&nbsp;<span class="op" id="4666608">*</span><span class="ident" id="4666609">Tree</span><br>
<span class="lineno"></span><span class="op" id="4666614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666617">func</span>&nbsp;<span class="op" id="4666622">(</span><span class="ident" id="4666623">t</span>&nbsp;<span class="op" id="4666625">*</span><span class="ident" id="4666626">Tree</span><span class="op" id="4666630">)</span>&nbsp;<span class="ident" id="4666632">newDot</span><span class="op" id="4666638">(</span><span class="ident" id="4666639">pos</span>&nbsp;<span class="ident" id="4666643">Pos</span><span class="op" id="4666646">)</span>&nbsp;<span class="op" id="4666648">*</span><span class="ident" id="4666649">DotNode</span>&nbsp;<span class="op" id="4666657">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666660">return</span>&nbsp;<span class="op" id="4666667">&amp;</span><span class="ident" id="4666668">DotNode</span><span class="op" id="4666675">{</span><span class="ident" id="4666676">tr</span><span class="op" id="4666678">:</span>&nbsp;<span class="ident" id="4666680">t</span><span class="op" id="4666681">,</span>&nbsp;<span class="ident" id="4666683">NodeType</span><span class="op" id="4666691">:</span>&nbsp;<span class="ident" id="4666693">NodeDot</span><span class="op" id="4666700">,</span>&nbsp;<span class="ident" id="4666702">Pos</span><span class="op" id="4666705">:</span>&nbsp;<span class="ident" id="4666707">pos</span><span class="op" id="4666710">}</span><br>
<span class="lineno"></span><span class="op" id="4666712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666715">func</span>&nbsp;<span class="op" id="4666720">(</span><span class="ident" id="4666721">d</span>&nbsp;<span class="op" id="4666723">*</span><span class="ident" id="4666724">DotNode</span><span class="op" id="4666731">)</span>&nbsp;<span class="ident" id="4666733">Type</span><span class="op" id="4666737">(</span><span class="op" id="4666738">)</span>&nbsp;<span class="ident" id="4666740">NodeType</span>&nbsp;<span class="op" id="4666749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666752">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666816">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666884">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666908">return</span>&nbsp;<span class="ident" id="4666915">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="4666923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="4666926">func</span>&nbsp;<span class="op" id="4666931">(</span><span class="ident" id="4666932">d</span>&nbsp;<span class="op" id="4666934">*</span><span class="ident" id="4666935">DotNode</span><span class="op" id="4666942">)</span>&nbsp;<span class="ident" id="4666944">String</span><span class="op" id="4666950">(</span><span class="op" id="4666951">)</span>&nbsp;<span class="builtintype" id="4666953">string</span>&nbsp;<span class="op" id="4666960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666963">return</span>&nbsp;<span class="string" id="4666970">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="4666974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666977">func</span>&nbsp;<span class="op" id="4666982">(</span><span class="ident" id="4666983">d</span>&nbsp;<span class="op" id="4666985">*</span><span class="ident" id="4666986">DotNode</span><span class="op" id="4666993">)</span>&nbsp;<span class="ident" id="4666995">tree</span><span class="op" id="4666999">(</span><span class="op" id="4667000">)</span>&nbsp;<span class="op" id="4667002">*</span><span class="ident" id="4667003">Tree</span>&nbsp;<span class="op" id="4667008">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667011">return</span>&nbsp;<span class="ident" id="4667018">d</span><span class="op" id="4667019">.</span><span class="ident" id="4667020">tr</span><br>
<span class="lineno"></span><span class="op" id="4667023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667026">func</span>&nbsp;<span class="op" id="4667031">(</span><span class="ident" id="4667032">d</span>&nbsp;<span class="op" id="4667034">*</span><span class="ident" id="4667035">DotNode</span><span class="op" id="4667042">)</span>&nbsp;<span class="ident" id="4667044">Copy</span><span class="op" id="4667048">(</span><span class="op" id="4667049">)</span>&nbsp;<span class="ident" id="4667051">Node</span>&nbsp;<span class="op" id="4667056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667059">return</span>&nbsp;<span class="ident" id="4667066">d</span><span class="op" id="4667067">.</span><span class="ident" id="4667068">tr</span><span class="op" id="4667070">.</span><span class="ident" id="4667071">newDot</span><span class="op" id="4667077">(</span><span class="ident" id="4667078">d</span><span class="op" id="4667079">.</span><span class="ident" id="4667080">Pos</span><span class="op" id="4667083">)</span><br>
<span class="lineno">380</span><span class="op" id="4667085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4667088">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4667172">type</span>&nbsp;<span class="ident" id="4667177">NilNode</span>&nbsp;<span class="keyword" id="4667185">struct</span>&nbsp;<span class="op" id="4667192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667195">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667205">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667210">tr</span>&nbsp;<span class="op" id="4667213">*</span><span class="ident" id="4667214">Tree</span><br>
<span class="lineno"></span><span class="op" id="4667219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667222">func</span>&nbsp;<span class="op" id="4667227">(</span><span class="ident" id="4667228">t</span>&nbsp;<span class="op" id="4667230">*</span><span class="ident" id="4667231">Tree</span><span class="op" id="4667235">)</span>&nbsp;<span class="ident" id="4667237">newNil</span><span class="op" id="4667243">(</span><span class="ident" id="4667244">pos</span>&nbsp;<span class="ident" id="4667248">Pos</span><span class="op" id="4667251">)</span>&nbsp;<span class="op" id="4667253">*</span><span class="ident" id="4667254">NilNode</span>&nbsp;<span class="op" id="4667262">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667265">return</span>&nbsp;<span class="op" id="4667272">&amp;</span><span class="ident" id="4667273">NilNode</span><span class="op" id="4667280">{</span><span class="ident" id="4667281">tr</span><span class="op" id="4667283">:</span>&nbsp;<span class="ident" id="4667285">t</span><span class="op" id="4667286">,</span>&nbsp;<span class="ident" id="4667288">NodeType</span><span class="op" id="4667296">:</span>&nbsp;<span class="ident" id="4667298">NodeNil</span><span class="op" id="4667305">,</span>&nbsp;<span class="ident" id="4667307">Pos</span><span class="op" id="4667310">:</span>&nbsp;<span class="ident" id="4667312">pos</span><span class="op" id="4667315">}</span><br>
<span class="lineno"></span><span class="op" id="4667317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667320">func</span>&nbsp;<span class="op" id="4667325">(</span><span class="ident" id="4667326">n</span>&nbsp;<span class="op" id="4667328">*</span><span class="ident" id="4667329">NilNode</span><span class="op" id="4667336">)</span>&nbsp;<span class="ident" id="4667338">Type</span><span class="op" id="4667342">(</span><span class="op" id="4667343">)</span>&nbsp;<span class="ident" id="4667345">NodeType</span>&nbsp;<span class="op" id="4667354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4667357">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4667421">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4667489">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667513">return</span>&nbsp;<span class="ident" id="4667520">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="4667528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="4667531">func</span>&nbsp;<span class="op" id="4667536">(</span><span class="ident" id="4667537">n</span>&nbsp;<span class="op" id="4667539">*</span><span class="ident" id="4667540">NilNode</span><span class="op" id="4667547">)</span>&nbsp;<span class="ident" id="4667549">String</span><span class="op" id="4667555">(</span><span class="op" id="4667556">)</span>&nbsp;<span class="builtintype" id="4667558">string</span>&nbsp;<span class="op" id="4667565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667568">return</span>&nbsp;<span class="string" id="4667575">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="4667581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667584">func</span>&nbsp;<span class="op" id="4667589">(</span><span class="ident" id="4667590">n</span>&nbsp;<span class="op" id="4667592">*</span><span class="ident" id="4667593">NilNode</span><span class="op" id="4667600">)</span>&nbsp;<span class="ident" id="4667602">tree</span><span class="op" id="4667606">(</span><span class="op" id="4667607">)</span>&nbsp;<span class="op" id="4667609">*</span><span class="ident" id="4667610">Tree</span>&nbsp;<span class="op" id="4667615">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667618">return</span>&nbsp;<span class="ident" id="4667625">n</span><span class="op" id="4667626">.</span><span class="ident" id="4667627">tr</span><br>
<span class="lineno"></span><span class="op" id="4667630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667633">func</span>&nbsp;<span class="op" id="4667638">(</span><span class="ident" id="4667639">n</span>&nbsp;<span class="op" id="4667641">*</span><span class="ident" id="4667642">NilNode</span><span class="op" id="4667649">)</span>&nbsp;<span class="ident" id="4667651">Copy</span><span class="op" id="4667655">(</span><span class="op" id="4667656">)</span>&nbsp;<span class="ident" id="4667658">Node</span>&nbsp;<span class="op" id="4667663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667666">return</span>&nbsp;<span class="ident" id="4667673">n</span><span class="op" id="4667674">.</span><span class="ident" id="4667675">tr</span><span class="op" id="4667677">.</span><span class="ident" id="4667678">newNil</span><span class="op" id="4667684">(</span><span class="ident" id="4667685">n</span><span class="op" id="4667686">.</span><span class="ident" id="4667687">Pos</span><span class="op" id="4667690">)</span><br>
<span class="lineno">410</span><span class="op" id="4667692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4667695">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4667754">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4667792">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="4667834">type</span>&nbsp;<span class="ident" id="4667839">FieldNode</span>&nbsp;<span class="keyword" id="4667849">struct</span>&nbsp;<span class="op" id="4667856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667859">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667869">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667874">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4667880">*</span><span class="ident" id="4667881">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667887">Ident</span>&nbsp;<span class="op" id="4667893">[</span><span class="op" id="4667894">]</span><span class="builtintype" id="4667895">string</span>&nbsp;<span class="comment" id="4667902">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="4667939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4667942">func</span>&nbsp;<span class="op" id="4667947">(</span><span class="ident" id="4667948">t</span>&nbsp;<span class="op" id="4667950">*</span><span class="ident" id="4667951">Tree</span><span class="op" id="4667955">)</span>&nbsp;<span class="ident" id="4667957">newField</span><span class="op" id="4667965">(</span><span class="ident" id="4667966">pos</span>&nbsp;<span class="ident" id="4667970">Pos</span><span class="op" id="4667973">,</span>&nbsp;<span class="ident" id="4667975">ident</span>&nbsp;<span class="builtintype" id="4667981">string</span><span class="op" id="4667987">)</span>&nbsp;<span class="op" id="4667989">*</span><span class="ident" id="4667990">FieldNode</span>&nbsp;<span class="op" id="4668000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668003">return</span>&nbsp;<span class="op" id="4668010">&amp;</span><span class="ident" id="4668011">FieldNode</span><span class="op" id="4668020">{</span><span class="ident" id="4668021">tr</span><span class="op" id="4668023">:</span>&nbsp;<span class="ident" id="4668025">t</span><span class="op" id="4668026">,</span>&nbsp;<span class="ident" id="4668028">NodeType</span><span class="op" id="4668036">:</span>&nbsp;<span class="ident" id="4668038">NodeField</span><span class="op" id="4668047">,</span>&nbsp;<span class="ident" id="4668049">Pos</span><span class="op" id="4668052">:</span>&nbsp;<span class="ident" id="4668054">pos</span><span class="op" id="4668057">,</span>&nbsp;<span class="ident" id="4668059">Ident</span><span class="op" id="4668064">:</span>&nbsp;<span class="ident" id="4668066">strings</span><span class="op" id="4668073">.</span><span class="ident" id="4668074">Split</span><span class="op" id="4668079">(</span><span class="ident" id="4668080">ident</span><span class="op" id="4668085">[</span><span class="num" id="4668086">1</span><span class="op" id="4668087">:</span><span class="op" id="4668088">]</span><span class="op" id="4668089">,</span>&nbsp;<span class="string" id="4668091">&#34;.&#34;</span><span class="op" id="4668094">)</span><span class="op" id="4668095">}</span>&nbsp;<span class="comment" id="4668097">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="4668128">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="4668131">func</span>&nbsp;<span class="op" id="4668136">(</span><span class="ident" id="4668137">f</span>&nbsp;<span class="op" id="4668139">*</span><span class="ident" id="4668140">FieldNode</span><span class="op" id="4668149">)</span>&nbsp;<span class="ident" id="4668151">String</span><span class="op" id="4668157">(</span><span class="op" id="4668158">)</span>&nbsp;<span class="builtintype" id="4668160">string</span>&nbsp;<span class="op" id="4668167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668170">s</span>&nbsp;<span class="op" id="4668172">:=</span>&nbsp;<span class="string" id="4668175">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668179">for</span>&nbsp;<span class="ident" id="4668183">_</span><span class="op" id="4668184">,</span>&nbsp;<span class="ident" id="4668186">id</span>&nbsp;<span class="op" id="4668189">:=</span>&nbsp;<span class="keyword" id="4668192">range</span>&nbsp;<span class="ident" id="4668198">f</span><span class="op" id="4668199">.</span><span class="ident" id="4668200">Ident</span>&nbsp;<span class="op" id="4668206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668210">s</span>&nbsp;<span class="op" id="4668212">+=</span>&nbsp;<span class="string" id="4668215">&#34;.&#34;</span>&nbsp;<span class="op" id="4668219">+</span>&nbsp;<span class="ident" id="4668221">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668228">return</span>&nbsp;<span class="ident" id="4668235">s</span><br>
<span class="lineno"></span><span class="op" id="4668237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668240">func</span>&nbsp;<span class="op" id="4668245">(</span><span class="ident" id="4668246">f</span>&nbsp;<span class="op" id="4668248">*</span><span class="ident" id="4668249">FieldNode</span><span class="op" id="4668258">)</span>&nbsp;<span class="ident" id="4668260">tree</span><span class="op" id="4668264">(</span><span class="op" id="4668265">)</span>&nbsp;<span class="op" id="4668267">*</span><span class="ident" id="4668268">Tree</span>&nbsp;<span class="op" id="4668273">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668276">return</span>&nbsp;<span class="ident" id="4668283">f</span><span class="op" id="4668284">.</span><span class="ident" id="4668285">tr</span><br>
<span class="lineno"></span><span class="op" id="4668288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668291">func</span>&nbsp;<span class="op" id="4668296">(</span><span class="ident" id="4668297">f</span>&nbsp;<span class="op" id="4668299">*</span><span class="ident" id="4668300">FieldNode</span><span class="op" id="4668309">)</span>&nbsp;<span class="ident" id="4668311">Copy</span><span class="op" id="4668315">(</span><span class="op" id="4668316">)</span>&nbsp;<span class="ident" id="4668318">Node</span>&nbsp;<span class="op" id="4668323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668326">return</span>&nbsp;<span class="op" id="4668333">&amp;</span><span class="ident" id="4668334">FieldNode</span><span class="op" id="4668343">{</span><span class="ident" id="4668344">tr</span><span class="op" id="4668346">:</span>&nbsp;<span class="ident" id="4668348">f</span><span class="op" id="4668349">.</span><span class="ident" id="4668350">tr</span><span class="op" id="4668352">,</span>&nbsp;<span class="ident" id="4668354">NodeType</span><span class="op" id="4668362">:</span>&nbsp;<span class="ident" id="4668364">NodeField</span><span class="op" id="4668373">,</span>&nbsp;<span class="ident" id="4668375">Pos</span><span class="op" id="4668378">:</span>&nbsp;<span class="ident" id="4668380">f</span><span class="op" id="4668381">.</span><span class="ident" id="4668382">Pos</span><span class="op" id="4668385">,</span>&nbsp;<span class="ident" id="4668387">Ident</span><span class="op" id="4668392">:</span>&nbsp;<span class="builtinfunc" id="4668394">append</span><span class="op" id="4668400">(</span><span class="op" id="4668401">[</span><span class="op" id="4668402">]</span><span class="builtintype" id="4668403">string</span><span class="op" id="4668409">{</span><span class="op" id="4668410">}</span><span class="op" id="4668411">,</span>&nbsp;<span class="ident" id="4668413">f</span><span class="op" id="4668414">.</span><span class="ident" id="4668415">Ident</span><span class="op" id="4668420">...</span><span class="op" id="4668423">)</span><span class="op" id="4668424">}</span><br>
<span class="lineno">440</span><span class="op" id="4668426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668429">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4668525">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="4668563">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="4668607">type</span>&nbsp;<span class="ident" id="4668612">ChainNode</span>&nbsp;<span class="keyword" id="4668622">struct</span>&nbsp;<span class="op" id="4668629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668632">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668642">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668647">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4668653">*</span><span class="ident" id="4668654">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668660">Node</span>&nbsp;&nbsp;<span class="ident" id="4668666">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668672">Field</span>&nbsp;<span class="op" id="4668678">[</span><span class="op" id="4668679">]</span><span class="builtintype" id="4668680">string</span>&nbsp;<span class="comment" id="4668687">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="4668724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4668727">func</span>&nbsp;<span class="op" id="4668732">(</span><span class="ident" id="4668733">t</span>&nbsp;<span class="op" id="4668735">*</span><span class="ident" id="4668736">Tree</span><span class="op" id="4668740">)</span>&nbsp;<span class="ident" id="4668742">newChain</span><span class="op" id="4668750">(</span><span class="ident" id="4668751">pos</span>&nbsp;<span class="ident" id="4668755">Pos</span><span class="op" id="4668758">,</span>&nbsp;<span class="ident" id="4668760">node</span>&nbsp;<span class="ident" id="4668765">Node</span><span class="op" id="4668769">)</span>&nbsp;<span class="op" id="4668771">*</span><span class="ident" id="4668772">ChainNode</span>&nbsp;<span class="op" id="4668782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668785">return</span>&nbsp;<span class="op" id="4668792">&amp;</span><span class="ident" id="4668793">ChainNode</span><span class="op" id="4668802">{</span><span class="ident" id="4668803">tr</span><span class="op" id="4668805">:</span>&nbsp;<span class="ident" id="4668807">t</span><span class="op" id="4668808">,</span>&nbsp;<span class="ident" id="4668810">NodeType</span><span class="op" id="4668818">:</span>&nbsp;<span class="ident" id="4668820">NodeChain</span><span class="op" id="4668829">,</span>&nbsp;<span class="ident" id="4668831">Pos</span><span class="op" id="4668834">:</span>&nbsp;<span class="ident" id="4668836">pos</span><span class="op" id="4668839">,</span>&nbsp;<span class="ident" id="4668841">Node</span><span class="op" id="4668845">:</span>&nbsp;<span class="ident" id="4668847">node</span><span class="op" id="4668851">}</span><br>
<span class="lineno">455</span><span class="op" id="4668853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668856">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4668944">func</span>&nbsp;<span class="op" id="4668949">(</span><span class="ident" id="4668950">c</span>&nbsp;<span class="op" id="4668952">*</span><span class="ident" id="4668953">ChainNode</span><span class="op" id="4668962">)</span>&nbsp;<span class="ident" id="4668964">Add</span><span class="op" id="4668967">(</span><span class="ident" id="4668968">field</span>&nbsp;<span class="builtintype" id="4668974">string</span><span class="op" id="4668980">)</span>&nbsp;<span class="op" id="4668982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668985">if</span>&nbsp;<span class="builtinfunc" id="4668988">len</span><span class="op" id="4668991">(</span><span class="ident" id="4668992">field</span><span class="op" id="4668997">)</span>&nbsp;<span class="op" id="4668999">==</span>&nbsp;<span class="num" id="4669002">0</span>&nbsp;<span class="op" id="4669004">||</span>&nbsp;<span class="ident" id="4669007">field</span><span class="op" id="4669012">[</span><span class="num" id="4669013">0</span><span class="op" id="4669014">]</span>&nbsp;<span class="op" id="4669016">!=</span>&nbsp;<span class="string" id="4669019">&#39;.&#39;</span>&nbsp;<span class="op" id="4669023">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4669027">panic</span><span class="op" id="4669032">(</span><span class="string" id="4669033">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="4669050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669056">field</span>&nbsp;<span class="op" id="4669062">=</span>&nbsp;<span class="ident" id="4669064">field</span><span class="op" id="4669069">[</span><span class="num" id="4669070">1</span><span class="op" id="4669071">:</span><span class="op" id="4669072">]</span>&nbsp;<span class="comment" id="4669074">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669098">if</span>&nbsp;<span class="ident" id="4669101">field</span>&nbsp;<span class="op" id="4669107">==</span>&nbsp;<span class="string" id="4669110">&#34;&#34;</span>&nbsp;<span class="op" id="4669113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4669117">panic</span><span class="op" id="4669122">(</span><span class="string" id="4669123">&#34;empty&nbsp;field&#34;</span><span class="op" id="4669136">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669142">c</span><span class="op" id="4669143">.</span><span class="ident" id="4669144">Field</span>&nbsp;<span class="op" id="4669150">=</span>&nbsp;<span class="builtinfunc" id="4669152">append</span><span class="op" id="4669158">(</span><span class="ident" id="4669159">c</span><span class="op" id="4669160">.</span><span class="ident" id="4669161">Field</span><span class="op" id="4669166">,</span>&nbsp;<span class="ident" id="4669168">field</span><span class="op" id="4669173">)</span><br>
<span class="lineno"></span><span class="op" id="4669175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669178">func</span>&nbsp;<span class="op" id="4669183">(</span><span class="ident" id="4669184">c</span>&nbsp;<span class="op" id="4669186">*</span><span class="ident" id="4669187">ChainNode</span><span class="op" id="4669196">)</span>&nbsp;<span class="ident" id="4669198">String</span><span class="op" id="4669204">(</span><span class="op" id="4669205">)</span>&nbsp;<span class="builtintype" id="4669207">string</span>&nbsp;<span class="op" id="4669214">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669217">s</span>&nbsp;<span class="op" id="4669219">:=</span>&nbsp;<span class="ident" id="4669222">c</span><span class="op" id="4669223">.</span><span class="ident" id="4669224">Node</span><span class="op" id="4669228">.</span><span class="ident" id="4669229">String</span><span class="op" id="4669235">(</span><span class="op" id="4669236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669239">if</span>&nbsp;<span class="ident" id="4669242">_</span><span class="op" id="4669243">,</span>&nbsp;<span class="ident" id="4669245">ok</span>&nbsp;<span class="op" id="4669248">:=</span>&nbsp;<span class="ident" id="4669251">c</span><span class="op" id="4669252">.</span><span class="ident" id="4669253">Node</span><span class="op" id="4669257">.</span><span class="op" id="4669258">(</span><span class="op" id="4669259">*</span><span class="ident" id="4669260">PipeNode</span><span class="op" id="4669268">)</span><span class="op" id="4669269">;</span>&nbsp;<span class="ident" id="4669271">ok</span>&nbsp;<span class="op" id="4669274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669278">s</span>&nbsp;<span class="op" id="4669280">=</span>&nbsp;<span class="string" id="4669282">&#34;(&#34;</span>&nbsp;<span class="op" id="4669286">+</span>&nbsp;<span class="ident" id="4669288">s</span>&nbsp;<span class="op" id="4669290">+</span>&nbsp;<span class="string" id="4669292">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669300">for</span>&nbsp;<span class="ident" id="4669304">_</span><span class="op" id="4669305">,</span>&nbsp;<span class="ident" id="4669307">field</span>&nbsp;<span class="op" id="4669313">:=</span>&nbsp;<span class="keyword" id="4669316">range</span>&nbsp;<span class="ident" id="4669322">c</span><span class="op" id="4669323">.</span><span class="ident" id="4669324">Field</span>&nbsp;<span class="op" id="4669330">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669334">s</span>&nbsp;<span class="op" id="4669336">+=</span>&nbsp;<span class="string" id="4669339">&#34;.&#34;</span>&nbsp;<span class="op" id="4669343">+</span>&nbsp;<span class="ident" id="4669345">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669355">return</span>&nbsp;<span class="ident" id="4669362">s</span><br>
<span class="lineno"></span><span class="op" id="4669364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="4669367">func</span>&nbsp;<span class="op" id="4669372">(</span><span class="ident" id="4669373">c</span>&nbsp;<span class="op" id="4669375">*</span><span class="ident" id="4669376">ChainNode</span><span class="op" id="4669385">)</span>&nbsp;<span class="ident" id="4669387">tree</span><span class="op" id="4669391">(</span><span class="op" id="4669392">)</span>&nbsp;<span class="op" id="4669394">*</span><span class="ident" id="4669395">Tree</span>&nbsp;<span class="op" id="4669400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669403">return</span>&nbsp;<span class="ident" id="4669410">c</span><span class="op" id="4669411">.</span><span class="ident" id="4669412">tr</span><br>
<span class="lineno"></span><span class="op" id="4669415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669418">func</span>&nbsp;<span class="op" id="4669423">(</span><span class="ident" id="4669424">c</span>&nbsp;<span class="op" id="4669426">*</span><span class="ident" id="4669427">ChainNode</span><span class="op" id="4669436">)</span>&nbsp;<span class="ident" id="4669438">Copy</span><span class="op" id="4669442">(</span><span class="op" id="4669443">)</span>&nbsp;<span class="ident" id="4669445">Node</span>&nbsp;<span class="op" id="4669450">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669453">return</span>&nbsp;<span class="op" id="4669460">&amp;</span><span class="ident" id="4669461">ChainNode</span><span class="op" id="4669470">{</span><span class="ident" id="4669471">tr</span><span class="op" id="4669473">:</span>&nbsp;<span class="ident" id="4669475">c</span><span class="op" id="4669476">.</span><span class="ident" id="4669477">tr</span><span class="op" id="4669479">,</span>&nbsp;<span class="ident" id="4669481">NodeType</span><span class="op" id="4669489">:</span>&nbsp;<span class="ident" id="4669491">NodeChain</span><span class="op" id="4669500">,</span>&nbsp;<span class="ident" id="4669502">Pos</span><span class="op" id="4669505">:</span>&nbsp;<span class="ident" id="4669507">c</span><span class="op" id="4669508">.</span><span class="ident" id="4669509">Pos</span><span class="op" id="4669512">,</span>&nbsp;<span class="ident" id="4669514">Node</span><span class="op" id="4669518">:</span>&nbsp;<span class="ident" id="4669520">c</span><span class="op" id="4669521">.</span><span class="ident" id="4669522">Node</span><span class="op" id="4669526">,</span>&nbsp;<span class="ident" id="4669528">Field</span><span class="op" id="4669533">:</span>&nbsp;<span class="builtinfunc" id="4669535">append</span><span class="op" id="4669541">(</span><span class="op" id="4669542">[</span><span class="op" id="4669543">]</span><span class="builtintype" id="4669544">string</span><span class="op" id="4669550">{</span><span class="op" id="4669551">}</span><span class="op" id="4669552">,</span>&nbsp;<span class="ident" id="4669554">c</span><span class="op" id="4669555">.</span><span class="ident" id="4669556">Field</span><span class="op" id="4669561">...</span><span class="op" id="4669564">)</span><span class="op" id="4669565">}</span><br>
<span class="lineno"></span><span class="op" id="4669567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4669570">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="4669608">type</span>&nbsp;<span class="ident" id="4669613">BoolNode</span>&nbsp;<span class="keyword" id="4669622">struct</span>&nbsp;<span class="op" id="4669629">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669632">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669642">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669647">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4669652">*</span><span class="ident" id="4669653">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669659">True</span>&nbsp;<span class="builtintype" id="4669664">bool</span>&nbsp;<span class="comment" id="4669669">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="4669707">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="4669710">func</span>&nbsp;<span class="op" id="4669715">(</span><span class="ident" id="4669716">t</span>&nbsp;<span class="op" id="4669718">*</span><span class="ident" id="4669719">Tree</span><span class="op" id="4669723">)</span>&nbsp;<span class="ident" id="4669725">newBool</span><span class="op" id="4669732">(</span><span class="ident" id="4669733">pos</span>&nbsp;<span class="ident" id="4669737">Pos</span><span class="op" id="4669740">,</span>&nbsp;<span class="builtintype" id="4669742">true</span>&nbsp;<span class="builtintype" id="4669747">bool</span><span class="op" id="4669751">)</span>&nbsp;<span class="op" id="4669753">*</span><span class="ident" id="4669754">BoolNode</span>&nbsp;<span class="op" id="4669763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669766">return</span>&nbsp;<span class="op" id="4669773">&amp;</span><span class="ident" id="4669774">BoolNode</span><span class="op" id="4669782">{</span><span class="ident" id="4669783">tr</span><span class="op" id="4669785">:</span>&nbsp;<span class="ident" id="4669787">t</span><span class="op" id="4669788">,</span>&nbsp;<span class="ident" id="4669790">NodeType</span><span class="op" id="4669798">:</span>&nbsp;<span class="ident" id="4669800">NodeBool</span><span class="op" id="4669808">,</span>&nbsp;<span class="ident" id="4669810">Pos</span><span class="op" id="4669813">:</span>&nbsp;<span class="ident" id="4669815">pos</span><span class="op" id="4669818">,</span>&nbsp;<span class="ident" id="4669820">True</span><span class="op" id="4669824">:</span>&nbsp;<span class="builtintype" id="4669826">true</span><span class="op" id="4669830">}</span><br>
<span class="lineno"></span><span class="op" id="4669832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4669835">func</span>&nbsp;<span class="op" id="4669840">(</span><span class="ident" id="4669841">b</span>&nbsp;<span class="op" id="4669843">*</span><span class="ident" id="4669844">BoolNode</span><span class="op" id="4669852">)</span>&nbsp;<span class="ident" id="4669854">String</span><span class="op" id="4669860">(</span><span class="op" id="4669861">)</span>&nbsp;<span class="builtintype" id="4669863">string</span>&nbsp;<span class="op" id="4669870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669873">if</span>&nbsp;<span class="ident" id="4669876">b</span><span class="op" id="4669877">.</span><span class="ident" id="4669878">True</span>&nbsp;<span class="op" id="4669883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669887">return</span>&nbsp;<span class="string" id="4669894">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669905">return</span>&nbsp;<span class="string" id="4669912">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="4669920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669923">func</span>&nbsp;<span class="op" id="4669928">(</span><span class="ident" id="4669929">b</span>&nbsp;<span class="op" id="4669931">*</span><span class="ident" id="4669932">BoolNode</span><span class="op" id="4669940">)</span>&nbsp;<span class="ident" id="4669942">tree</span><span class="op" id="4669946">(</span><span class="op" id="4669947">)</span>&nbsp;<span class="op" id="4669949">*</span><span class="ident" id="4669950">Tree</span>&nbsp;<span class="op" id="4669955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669958">return</span>&nbsp;<span class="ident" id="4669965">b</span><span class="op" id="4669966">.</span><span class="ident" id="4669967">tr</span><br>
<span class="lineno"></span><span class="op" id="4669970">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4669973">func</span>&nbsp;<span class="op" id="4669978">(</span><span class="ident" id="4669979">b</span>&nbsp;<span class="op" id="4669981">*</span><span class="ident" id="4669982">BoolNode</span><span class="op" id="4669990">)</span>&nbsp;<span class="ident" id="4669992">Copy</span><span class="op" id="4669996">(</span><span class="op" id="4669997">)</span>&nbsp;<span class="ident" id="4669999">Node</span>&nbsp;<span class="op" id="4670004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670007">return</span>&nbsp;<span class="ident" id="4670014">b</span><span class="op" id="4670015">.</span><span class="ident" id="4670016">tr</span><span class="op" id="4670018">.</span><span class="ident" id="4670019">newBool</span><span class="op" id="4670026">(</span><span class="ident" id="4670027">b</span><span class="op" id="4670028">.</span><span class="ident" id="4670029">Pos</span><span class="op" id="4670032">,</span>&nbsp;<span class="ident" id="4670034">b</span><span class="op" id="4670035">.</span><span class="ident" id="4670036">True</span><span class="op" id="4670040">)</span><br>
<span class="lineno"></span><span class="op" id="4670042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="4670045">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="4670122">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4670206">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4670288">type</span>&nbsp;<span class="ident" id="4670293">NumberNode</span>&nbsp;<span class="keyword" id="4670304">struct</span>&nbsp;<span class="op" id="4670311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670314">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670324">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670329">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4670340">*</span><span class="ident" id="4670341">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670347">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4670358">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670369">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670403">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4670414">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670425">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670468">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4670479">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670490">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670529">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="4670540">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670551">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670574">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670585">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670596">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670626">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4670637">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670648">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670680">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4670691">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670702">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670732">Complex128</span>&nbsp;<span class="builtintype" id="4670743">complex128</span>&nbsp;<span class="comment" id="4670754">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670777">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4670788">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4670799">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="4670854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4670857">func</span>&nbsp;<span class="op" id="4670862">(</span><span class="ident" id="4670863">t</span>&nbsp;<span class="op" id="4670865">*</span><span class="ident" id="4670866">Tree</span><span class="op" id="4670870">)</span>&nbsp;<span class="ident" id="4670872">newNumber</span><span class="op" id="4670881">(</span><span class="ident" id="4670882">pos</span>&nbsp;<span class="ident" id="4670886">Pos</span><span class="op" id="4670889">,</span>&nbsp;<span class="ident" id="4670891">text</span>&nbsp;<span class="builtintype" id="4670896">string</span><span class="op" id="4670902">,</span>&nbsp;<span class="ident" id="4670904">typ</span>&nbsp;<span class="ident" id="4670908">itemType</span><span class="op" id="4670916">)</span>&nbsp;<span class="op" id="4670918">(</span><span class="op" id="4670919">*</span><span class="ident" id="4670920">NumberNode</span><span class="op" id="4670930">,</span>&nbsp;<span class="builtintype" id="4670932">error</span><span class="op" id="4670937">)</span>&nbsp;<span class="op" id="4670939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670942">n</span>&nbsp;<span class="op" id="4670944">:=</span>&nbsp;<span class="op" id="4670947">&amp;</span><span class="ident" id="4670948">NumberNode</span><span class="op" id="4670958">{</span><span class="ident" id="4670959">tr</span><span class="op" id="4670961">:</span>&nbsp;<span class="ident" id="4670963">t</span><span class="op" id="4670964">,</span>&nbsp;<span class="ident" id="4670966">NodeType</span><span class="op" id="4670974">:</span>&nbsp;<span class="ident" id="4670976">NodeNumber</span><span class="op" id="4670986">,</span>&nbsp;<span class="ident" id="4670988">Pos</span><span class="op" id="4670991">:</span>&nbsp;<span class="ident" id="4670993">pos</span><span class="op" id="4670996">,</span>&nbsp;<span class="ident" id="4670998">Text</span><span class="op" id="4671002">:</span>&nbsp;<span class="ident" id="4671004">text</span><span class="op" id="4671008">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671011">switch</span>&nbsp;<span class="ident" id="4671018">typ</span>&nbsp;<span class="op" id="4671022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671025">case</span>&nbsp;<span class="ident" id="4671030">itemCharConstant</span><span class="op" id="4671046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4671050">rune</span><span class="op" id="4671054">,</span>&nbsp;<span class="ident" id="4671056">_</span><span class="op" id="4671057">,</span>&nbsp;<span class="ident" id="4671059">tail</span><span class="op" id="4671063">,</span>&nbsp;<span class="ident" id="4671065">err</span>&nbsp;<span class="op" id="4671069">:=</span>&nbsp;<span class="ident" id="4671072">strconv</span><span class="op" id="4671079">.</span><span class="ident" id="4671080">UnquoteChar</span><span class="op" id="4671091">(</span><span class="ident" id="4671092">text</span><span class="op" id="4671096">[</span><span class="num" id="4671097">1</span><span class="op" id="4671098">:</span><span class="op" id="4671099">]</span><span class="op" id="4671100">,</span>&nbsp;<span class="ident" id="4671102">text</span><span class="op" id="4671106">[</span><span class="num" id="4671107">0</span><span class="op" id="4671108">]</span><span class="op" id="4671109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671113">if</span>&nbsp;<span class="ident" id="4671116">err</span>&nbsp;<span class="op" id="4671120">!=</span>&nbsp;<span class="ident" id="4671123">nil</span>&nbsp;<span class="op" id="4671127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671132">return</span>&nbsp;<span class="ident" id="4671139">nil</span><span class="op" id="4671142">,</span>&nbsp;<span class="ident" id="4671144">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671154">if</span>&nbsp;<span class="ident" id="4671157">tail</span>&nbsp;<span class="op" id="4671162">!=</span>&nbsp;<span class="string" id="4671165">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="4671169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671174">return</span>&nbsp;<span class="ident" id="4671181">nil</span><span class="op" id="4671184">,</span>&nbsp;<span class="ident" id="4671186">fmt</span><span class="op" id="4671189">.</span><span class="ident" id="4671190">Errorf</span><span class="op" id="4671196">(</span><span class="string" id="4671197">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="4671231">,</span>&nbsp;<span class="ident" id="4671233">text</span><span class="op" id="4671237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671245">n</span><span class="op" id="4671246">.</span><span class="ident" id="4671247">Int64</span>&nbsp;<span class="op" id="4671253">=</span>&nbsp;<span class="ident" id="4671255">int64</span><span class="op" id="4671260">(</span><span class="builtintype" id="4671261">rune</span><span class="op" id="4671265">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671269">n</span><span class="op" id="4671270">.</span><span class="ident" id="4671271">IsInt</span>&nbsp;<span class="op" id="4671277">=</span>&nbsp;<span class="builtintype" id="4671279">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671286">n</span><span class="op" id="4671287">.</span><span class="ident" id="4671288">Uint64</span>&nbsp;<span class="op" id="4671295">=</span>&nbsp;<span class="ident" id="4671297">uint64</span><span class="op" id="4671303">(</span><span class="builtintype" id="4671304">rune</span><span class="op" id="4671308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671312">n</span><span class="op" id="4671313">.</span><span class="ident" id="4671314">IsUint</span>&nbsp;<span class="op" id="4671321">=</span>&nbsp;<span class="builtintype" id="4671323">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671330">n</span><span class="op" id="4671331">.</span><span class="ident" id="4671332">Float64</span>&nbsp;<span class="op" id="4671340">=</span>&nbsp;<span class="builtintype" id="4671342">float64</span><span class="op" id="4671349">(</span><span class="builtintype" id="4671350">rune</span><span class="op" id="4671354">)</span>&nbsp;<span class="comment" id="4671356">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671390">n</span><span class="op" id="4671391">.</span><span class="ident" id="4671392">IsFloat</span>&nbsp;<span class="op" id="4671400">=</span>&nbsp;<span class="builtintype" id="4671402">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671409">return</span>&nbsp;<span class="ident" id="4671416">n</span><span class="op" id="4671417">,</span>&nbsp;<span class="ident" id="4671419">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671424">case</span>&nbsp;<span class="ident" id="4671429">itemComplex</span><span class="op" id="4671440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671444">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671502">if</span>&nbsp;<span class="ident" id="4671505">_</span><span class="op" id="4671506">,</span>&nbsp;<span class="ident" id="4671508">err</span>&nbsp;<span class="op" id="4671512">:=</span>&nbsp;<span class="ident" id="4671515">fmt</span><span class="op" id="4671518">.</span><span class="ident" id="4671519">Sscan</span><span class="op" id="4671524">(</span><span class="ident" id="4671525">text</span><span class="op" id="4671529">,</span>&nbsp;<span class="op" id="4671531">&amp;</span><span class="ident" id="4671532">n</span><span class="op" id="4671533">.</span><span class="ident" id="4671534">Complex128</span><span class="op" id="4671544">)</span><span class="op" id="4671545">;</span>&nbsp;<span class="ident" id="4671547">err</span>&nbsp;<span class="op" id="4671551">!=</span>&nbsp;<span class="ident" id="4671554">nil</span>&nbsp;<span class="op" id="4671558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671563">return</span>&nbsp;<span class="ident" id="4671570">nil</span><span class="op" id="4671573">,</span>&nbsp;<span class="ident" id="4671575">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671585">n</span><span class="op" id="4671586">.</span><span class="ident" id="4671587">IsComplex</span>&nbsp;<span class="op" id="4671597">=</span>&nbsp;<span class="builtintype" id="4671599">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671606">n</span><span class="op" id="4671607">.</span><span class="ident" id="4671608">simplifyComplex</span><span class="op" id="4671623">(</span><span class="op" id="4671624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671628">return</span>&nbsp;<span class="ident" id="4671635">n</span><span class="op" id="4671636">,</span>&nbsp;<span class="ident" id="4671638">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671643">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671646">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671712">if</span>&nbsp;<span class="builtinfunc" id="4671715">len</span><span class="op" id="4671718">(</span><span class="ident" id="4671719">text</span><span class="op" id="4671723">)</span>&nbsp;<span class="op" id="4671725">&gt;</span>&nbsp;<span class="num" id="4671727">0</span>&nbsp;<span class="op" id="4671729">&amp;&amp;</span>&nbsp;<span class="ident" id="4671732">text</span><span class="op" id="4671736">[</span><span class="builtinfunc" id="4671737">len</span><span class="op" id="4671740">(</span><span class="ident" id="4671741">text</span><span class="op" id="4671745">)</span><span class="op" id="4671746">-</span><span class="num" id="4671747">1</span><span class="op" id="4671748">]</span>&nbsp;<span class="op" id="4671750">==</span>&nbsp;<span class="string" id="4671753">&#39;i&#39;</span>&nbsp;<span class="op" id="4671757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671761">f</span><span class="op" id="4671762">,</span>&nbsp;<span class="ident" id="4671764">err</span>&nbsp;<span class="op" id="4671768">:=</span>&nbsp;<span class="ident" id="4671771">strconv</span><span class="op" id="4671778">.</span><span class="ident" id="4671779">ParseFloat</span><span class="op" id="4671789">(</span><span class="ident" id="4671790">text</span><span class="op" id="4671794">[</span><span class="op" id="4671795">:</span><span class="builtinfunc" id="4671796">len</span><span class="op" id="4671799">(</span><span class="ident" id="4671800">text</span><span class="op" id="4671804">)</span><span class="op" id="4671805">-</span><span class="num" id="4671806">1</span><span class="op" id="4671807">]</span><span class="op" id="4671808">,</span>&nbsp;<span class="num" id="4671810">64</span><span class="op" id="4671812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671816">if</span>&nbsp;<span class="ident" id="4671819">err</span>&nbsp;<span class="op" id="4671823">==</span>&nbsp;<span class="ident" id="4671826">nil</span>&nbsp;<span class="op" id="4671830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671835">n</span><span class="op" id="4671836">.</span><span class="ident" id="4671837">IsComplex</span>&nbsp;<span class="op" id="4671847">=</span>&nbsp;<span class="builtintype" id="4671849">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671857">n</span><span class="op" id="4671858">.</span><span class="ident" id="4671859">Complex128</span>&nbsp;<span class="op" id="4671870">=</span>&nbsp;<span class="builtinfunc" id="4671872">complex</span><span class="op" id="4671879">(</span><span class="num" id="4671880">0</span><span class="op" id="4671881">,</span>&nbsp;<span class="ident" id="4671883">f</span><span class="op" id="4671884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671889">n</span><span class="op" id="4671890">.</span><span class="ident" id="4671891">simplifyComplex</span><span class="op" id="4671906">(</span><span class="op" id="4671907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671912">return</span>&nbsp;<span class="ident" id="4671919">n</span><span class="op" id="4671920">,</span>&nbsp;<span class="ident" id="4671922">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671931">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671934">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671981">u</span><span class="op" id="4671982">,</span>&nbsp;<span class="ident" id="4671984">err</span>&nbsp;<span class="op" id="4671988">:=</span>&nbsp;<span class="ident" id="4671991">strconv</span><span class="op" id="4671998">.</span><span class="ident" id="4671999">ParseUint</span><span class="op" id="4672008">(</span><span class="ident" id="4672009">text</span><span class="op" id="4672013">,</span>&nbsp;<span class="num" id="4672015">0</span><span class="op" id="4672016">,</span>&nbsp;<span class="num" id="4672018">64</span><span class="op" id="4672020">)</span>&nbsp;<span class="comment" id="4672022">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672057">if</span>&nbsp;<span class="ident" id="4672060">err</span>&nbsp;<span class="op" id="4672064">==</span>&nbsp;<span class="ident" id="4672067">nil</span>&nbsp;<span class="op" id="4672071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672075">n</span><span class="op" id="4672076">.</span><span class="ident" id="4672077">IsUint</span>&nbsp;<span class="op" id="4672084">=</span>&nbsp;<span class="builtintype" id="4672086">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672093">n</span><span class="op" id="4672094">.</span><span class="ident" id="4672095">Uint64</span>&nbsp;<span class="op" id="4672102">=</span>&nbsp;<span class="ident" id="4672104">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672110">i</span><span class="op" id="4672111">,</span>&nbsp;<span class="ident" id="4672113">err</span>&nbsp;<span class="op" id="4672117">:=</span>&nbsp;<span class="ident" id="4672120">strconv</span><span class="op" id="4672127">.</span><span class="ident" id="4672128">ParseInt</span><span class="op" id="4672136">(</span><span class="ident" id="4672137">text</span><span class="op" id="4672141">,</span>&nbsp;<span class="num" id="4672143">0</span><span class="op" id="4672144">,</span>&nbsp;<span class="num" id="4672146">64</span><span class="op" id="4672148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672151">if</span>&nbsp;<span class="ident" id="4672154">err</span>&nbsp;<span class="op" id="4672158">==</span>&nbsp;<span class="ident" id="4672161">nil</span>&nbsp;<span class="op" id="4672165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672169">n</span><span class="op" id="4672170">.</span><span class="ident" id="4672171">IsInt</span>&nbsp;<span class="op" id="4672177">=</span>&nbsp;<span class="builtintype" id="4672179">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672186">n</span><span class="op" id="4672187">.</span><span class="ident" id="4672188">Int64</span>&nbsp;<span class="op" id="4672194">=</span>&nbsp;<span class="ident" id="4672196">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672200">if</span>&nbsp;<span class="ident" id="4672203">i</span>&nbsp;<span class="op" id="4672205">==</span>&nbsp;<span class="num" id="4672208">0</span>&nbsp;<span class="op" id="4672210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672215">n</span><span class="op" id="4672216">.</span><span class="ident" id="4672217">IsUint</span>&nbsp;<span class="op" id="4672224">=</span>&nbsp;<span class="builtintype" id="4672226">true</span>&nbsp;<span class="comment" id="4672231">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672252">n</span><span class="op" id="4672253">.</span><span class="ident" id="4672254">Uint64</span>&nbsp;<span class="op" id="4672261">=</span>&nbsp;<span class="ident" id="4672263">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672270">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672273">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672332">if</span>&nbsp;<span class="ident" id="4672335">n</span><span class="op" id="4672336">.</span><span class="ident" id="4672337">IsInt</span>&nbsp;<span class="op" id="4672343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672347">n</span><span class="op" id="4672348">.</span><span class="ident" id="4672349">IsFloat</span>&nbsp;<span class="op" id="4672357">=</span>&nbsp;<span class="builtintype" id="4672359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672366">n</span><span class="op" id="4672367">.</span><span class="ident" id="4672368">Float64</span>&nbsp;<span class="op" id="4672376">=</span>&nbsp;<span class="builtintype" id="4672378">float64</span><span class="op" id="4672385">(</span><span class="ident" id="4672386">n</span><span class="op" id="4672387">.</span><span class="ident" id="4672388">Int64</span><span class="op" id="4672393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672396">}</span>&nbsp;<span class="keyword" id="4672398">else</span>&nbsp;<span class="keyword" id="4672403">if</span>&nbsp;<span class="ident" id="4672406">n</span><span class="op" id="4672407">.</span><span class="ident" id="4672408">IsUint</span>&nbsp;<span class="op" id="4672415">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672419">n</span><span class="op" id="4672420">.</span><span class="ident" id="4672421">IsFloat</span>&nbsp;<span class="op" id="4672429">=</span>&nbsp;<span class="builtintype" id="4672431">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672438">n</span><span class="op" id="4672439">.</span><span class="ident" id="4672440">Float64</span>&nbsp;<span class="op" id="4672448">=</span>&nbsp;<span class="builtintype" id="4672450">float64</span><span class="op" id="4672457">(</span><span class="ident" id="4672458">n</span><span class="op" id="4672459">.</span><span class="ident" id="4672460">Uint64</span><span class="op" id="4672466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672469">}</span>&nbsp;<span class="keyword" id="4672471">else</span>&nbsp;<span class="op" id="4672476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672480">f</span><span class="op" id="4672481">,</span>&nbsp;<span class="ident" id="4672483">err</span>&nbsp;<span class="op" id="4672487">:=</span>&nbsp;<span class="ident" id="4672490">strconv</span><span class="op" id="4672497">.</span><span class="ident" id="4672498">ParseFloat</span><span class="op" id="4672508">(</span><span class="ident" id="4672509">text</span><span class="op" id="4672513">,</span>&nbsp;<span class="num" id="4672515">64</span><span class="op" id="4672517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672521">if</span>&nbsp;<span class="ident" id="4672524">err</span>&nbsp;<span class="op" id="4672528">==</span>&nbsp;<span class="ident" id="4672531">nil</span>&nbsp;<span class="op" id="4672535">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672540">n</span><span class="op" id="4672541">.</span><span class="ident" id="4672542">IsFloat</span>&nbsp;<span class="op" id="4672550">=</span>&nbsp;<span class="builtintype" id="4672552">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672560">n</span><span class="op" id="4672561">.</span><span class="ident" id="4672562">Float64</span>&nbsp;<span class="op" id="4672570">=</span>&nbsp;<span class="ident" id="4672572">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672577">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672652">if</span>&nbsp;<span class="op" id="4672655">!</span><span class="ident" id="4672656">n</span><span class="op" id="4672657">.</span><span class="ident" id="4672658">IsInt</span>&nbsp;<span class="op" id="4672664">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4672667">float64</span><span class="op" id="4672674">(</span><span class="ident" id="4672675">int64</span><span class="op" id="4672680">(</span><span class="ident" id="4672681">f</span><span class="op" id="4672682">)</span><span class="op" id="4672683">)</span>&nbsp;<span class="op" id="4672685">==</span>&nbsp;<span class="ident" id="4672688">f</span>&nbsp;<span class="op" id="4672690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672696">n</span><span class="op" id="4672697">.</span><span class="ident" id="4672698">IsInt</span>&nbsp;<span class="op" id="4672704">=</span>&nbsp;<span class="builtintype" id="4672706">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672715">n</span><span class="op" id="4672716">.</span><span class="ident" id="4672717">Int64</span>&nbsp;<span class="op" id="4672723">=</span>&nbsp;<span class="ident" id="4672725">int64</span><span class="op" id="4672730">(</span><span class="ident" id="4672731">f</span><span class="op" id="4672732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672742">if</span>&nbsp;<span class="op" id="4672745">!</span><span class="ident" id="4672746">n</span><span class="op" id="4672747">.</span><span class="ident" id="4672748">IsUint</span>&nbsp;<span class="op" id="4672755">&amp;&amp;</span>&nbsp;<span class="builtintype" id="4672758">float64</span><span class="op" id="4672765">(</span><span class="ident" id="4672766">uint64</span><span class="op" id="4672772">(</span><span class="ident" id="4672773">f</span><span class="op" id="4672774">)</span><span class="op" id="4672775">)</span>&nbsp;<span class="op" id="4672777">==</span>&nbsp;<span class="ident" id="4672780">f</span>&nbsp;<span class="op" id="4672782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672788">n</span><span class="op" id="4672789">.</span><span class="ident" id="4672790">IsUint</span>&nbsp;<span class="op" id="4672797">=</span>&nbsp;<span class="builtintype" id="4672799">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672808">n</span><span class="op" id="4672809">.</span><span class="ident" id="4672810">Uint64</span>&nbsp;<span class="op" id="4672817">=</span>&nbsp;<span class="ident" id="4672819">uint64</span><span class="op" id="4672825">(</span><span class="ident" id="4672826">f</span><span class="op" id="4672827">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672842">if</span>&nbsp;<span class="op" id="4672845">!</span><span class="ident" id="4672846">n</span><span class="op" id="4672847">.</span><span class="ident" id="4672848">IsInt</span>&nbsp;<span class="op" id="4672854">&amp;&amp;</span>&nbsp;<span class="op" id="4672857">!</span><span class="ident" id="4672858">n</span><span class="op" id="4672859">.</span><span class="ident" id="4672860">IsUint</span>&nbsp;<span class="op" id="4672867">&amp;&amp;</span>&nbsp;<span class="op" id="4672870">!</span><span class="ident" id="4672871">n</span><span class="op" id="4672872">.</span><span class="ident" id="4672873">IsFloat</span>&nbsp;<span class="op" id="4672881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672885">return</span>&nbsp;<span class="ident" id="4672892">nil</span><span class="op" id="4672895">,</span>&nbsp;<span class="ident" id="4672897">fmt</span><span class="op" id="4672900">.</span><span class="ident" id="4672901">Errorf</span><span class="op" id="4672907">(</span><span class="string" id="4672908">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="4672935">,</span>&nbsp;<span class="ident" id="4672937">text</span><span class="op" id="4672941">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672947">return</span>&nbsp;<span class="ident" id="4672954">n</span><span class="op" id="4672955">,</span>&nbsp;<span class="ident" id="4672957">nil</span><br>
<span class="lineno"></span><span class="op" id="4672961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4672964">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="4673053">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4673107">func</span>&nbsp;<span class="op" id="4673112">(</span><span class="ident" id="4673113">n</span>&nbsp;<span class="op" id="4673115">*</span><span class="ident" id="4673116">NumberNode</span><span class="op" id="4673126">)</span>&nbsp;<span class="ident" id="4673128">simplifyComplex</span><span class="op" id="4673143">(</span><span class="op" id="4673144">)</span>&nbsp;<span class="op" id="4673146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673149">n</span><span class="op" id="4673150">.</span><span class="ident" id="4673151">IsFloat</span>&nbsp;<span class="op" id="4673159">=</span>&nbsp;<span class="builtinfunc" id="4673161">imag</span><span class="op" id="4673165">(</span><span class="ident" id="4673166">n</span><span class="op" id="4673167">.</span><span class="ident" id="4673168">Complex128</span><span class="op" id="4673178">)</span>&nbsp;<span class="op" id="4673180">==</span>&nbsp;<span class="num" id="4673183">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673186">if</span>&nbsp;<span class="ident" id="4673189">n</span><span class="op" id="4673190">.</span><span class="ident" id="4673191">IsFloat</span>&nbsp;<span class="op" id="4673199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673203">n</span><span class="op" id="4673204">.</span><span class="ident" id="4673205">Float64</span>&nbsp;<span class="op" id="4673213">=</span>&nbsp;<span class="builtinfunc" id="4673215">real</span><span class="op" id="4673219">(</span><span class="ident" id="4673220">n</span><span class="op" id="4673221">.</span><span class="ident" id="4673222">Complex128</span><span class="op" id="4673232">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673236">n</span><span class="op" id="4673237">.</span><span class="ident" id="4673238">IsInt</span>&nbsp;<span class="op" id="4673244">=</span>&nbsp;<span class="builtintype" id="4673246">float64</span><span class="op" id="4673253">(</span><span class="ident" id="4673254">int64</span><span class="op" id="4673259">(</span><span class="ident" id="4673260">n</span><span class="op" id="4673261">.</span><span class="ident" id="4673262">Float64</span><span class="op" id="4673269">)</span><span class="op" id="4673270">)</span>&nbsp;<span class="op" id="4673272">==</span>&nbsp;<span class="ident" id="4673275">n</span><span class="op" id="4673276">.</span><span class="ident" id="4673277">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673287">if</span>&nbsp;<span class="ident" id="4673290">n</span><span class="op" id="4673291">.</span><span class="ident" id="4673292">IsInt</span>&nbsp;<span class="op" id="4673298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673303">n</span><span class="op" id="4673304">.</span><span class="ident" id="4673305">Int64</span>&nbsp;<span class="op" id="4673311">=</span>&nbsp;<span class="ident" id="4673313">int64</span><span class="op" id="4673318">(</span><span class="ident" id="4673319">n</span><span class="op" id="4673320">.</span><span class="ident" id="4673321">Float64</span><span class="op" id="4673328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673336">n</span><span class="op" id="4673337">.</span><span class="ident" id="4673338">IsUint</span>&nbsp;<span class="op" id="4673345">=</span>&nbsp;<span class="builtintype" id="4673347">float64</span><span class="op" id="4673354">(</span><span class="ident" id="4673355">uint64</span><span class="op" id="4673361">(</span><span class="ident" id="4673362">n</span><span class="op" id="4673363">.</span><span class="ident" id="4673364">Float64</span><span class="op" id="4673371">)</span><span class="op" id="4673372">)</span>&nbsp;<span class="op" id="4673374">==</span>&nbsp;<span class="ident" id="4673377">n</span><span class="op" id="4673378">.</span><span class="ident" id="4673379">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673389">if</span>&nbsp;<span class="ident" id="4673392">n</span><span class="op" id="4673393">.</span><span class="ident" id="4673394">IsUint</span>&nbsp;<span class="op" id="4673401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673406">n</span><span class="op" id="4673407">.</span><span class="ident" id="4673408">Uint64</span>&nbsp;<span class="op" id="4673415">=</span>&nbsp;<span class="ident" id="4673417">uint64</span><span class="op" id="4673423">(</span><span class="ident" id="4673424">n</span><span class="op" id="4673425">.</span><span class="ident" id="4673426">Float64</span><span class="op" id="4673433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673440">}</span><br>
<span class="lineno"></span><span class="op" id="4673442">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="4673445">func</span>&nbsp;<span class="op" id="4673450">(</span><span class="ident" id="4673451">n</span>&nbsp;<span class="op" id="4673453">*</span><span class="ident" id="4673454">NumberNode</span><span class="op" id="4673464">)</span>&nbsp;<span class="ident" id="4673466">String</span><span class="op" id="4673472">(</span><span class="op" id="4673473">)</span>&nbsp;<span class="builtintype" id="4673475">string</span>&nbsp;<span class="op" id="4673482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673485">return</span>&nbsp;<span class="ident" id="4673492">n</span><span class="op" id="4673493">.</span><span class="ident" id="4673494">Text</span><br>
<span class="lineno"></span><span class="op" id="4673499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="4673502">func</span>&nbsp;<span class="op" id="4673507">(</span><span class="ident" id="4673508">n</span>&nbsp;<span class="op" id="4673510">*</span><span class="ident" id="4673511">NumberNode</span><span class="op" id="4673521">)</span>&nbsp;<span class="ident" id="4673523">tree</span><span class="op" id="4673527">(</span><span class="op" id="4673528">)</span>&nbsp;<span class="op" id="4673530">*</span><span class="ident" id="4673531">Tree</span>&nbsp;<span class="op" id="4673536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673539">return</span>&nbsp;<span class="ident" id="4673546">n</span><span class="op" id="4673547">.</span><span class="ident" id="4673548">tr</span><br>
<span class="lineno"></span><span class="op" id="4673551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4673554">func</span>&nbsp;<span class="op" id="4673559">(</span><span class="ident" id="4673560">n</span>&nbsp;<span class="op" id="4673562">*</span><span class="ident" id="4673563">NumberNode</span><span class="op" id="4673573">)</span>&nbsp;<span class="ident" id="4673575">Copy</span><span class="op" id="4673579">(</span><span class="op" id="4673580">)</span>&nbsp;<span class="ident" id="4673582">Node</span>&nbsp;<span class="op" id="4673587">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673590">nn</span>&nbsp;<span class="op" id="4673593">:=</span>&nbsp;<span class="builtinfunc" id="4673596">new</span><span class="op" id="4673599">(</span><span class="ident" id="4673600">NumberNode</span><span class="op" id="4673610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673613">*</span><span class="ident" id="4673614">nn</span>&nbsp;<span class="op" id="4673617">=</span>&nbsp;<span class="op" id="4673619">*</span><span class="ident" id="4673620">n</span>&nbsp;<span class="comment" id="4673622">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673647">return</span>&nbsp;<span class="ident" id="4673654">nn</span><br>
<span class="lineno"></span><span class="op" id="4673657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="4673660">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4673730">type</span>&nbsp;<span class="ident" id="4673735">StringNode</span>&nbsp;<span class="keyword" id="4673746">struct</span>&nbsp;<span class="op" id="4673753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673756">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673766">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673771">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673778">*</span><span class="ident" id="4673779">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673785">Quoted</span>&nbsp;<span class="builtintype" id="4673792">string</span>&nbsp;<span class="comment" id="4673799">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673849">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4673856">string</span>&nbsp;<span class="comment" id="4673863">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="4673902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4673905">func</span>&nbsp;<span class="op" id="4673910">(</span><span class="ident" id="4673911">t</span>&nbsp;<span class="op" id="4673913">*</span><span class="ident" id="4673914">Tree</span><span class="op" id="4673918">)</span>&nbsp;<span class="ident" id="4673920">newString</span><span class="op" id="4673929">(</span><span class="ident" id="4673930">pos</span>&nbsp;<span class="ident" id="4673934">Pos</span><span class="op" id="4673937">,</span>&nbsp;<span class="ident" id="4673939">orig</span><span class="op" id="4673943">,</span>&nbsp;<span class="ident" id="4673945">text</span>&nbsp;<span class="builtintype" id="4673950">string</span><span class="op" id="4673956">)</span>&nbsp;<span class="op" id="4673958">*</span><span class="ident" id="4673959">StringNode</span>&nbsp;<span class="op" id="4673970">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673973">return</span>&nbsp;<span class="op" id="4673980">&amp;</span><span class="ident" id="4673981">StringNode</span><span class="op" id="4673991">{</span><span class="ident" id="4673992">tr</span><span class="op" id="4673994">:</span>&nbsp;<span class="ident" id="4673996">t</span><span class="op" id="4673997">,</span>&nbsp;<span class="ident" id="4673999">NodeType</span><span class="op" id="4674007">:</span>&nbsp;<span class="ident" id="4674009">NodeString</span><span class="op" id="4674019">,</span>&nbsp;<span class="ident" id="4674021">Pos</span><span class="op" id="4674024">:</span>&nbsp;<span class="ident" id="4674026">pos</span><span class="op" id="4674029">,</span>&nbsp;<span class="ident" id="4674031">Quoted</span><span class="op" id="4674037">:</span>&nbsp;<span class="ident" id="4674039">orig</span><span class="op" id="4674043">,</span>&nbsp;<span class="ident" id="4674045">Text</span><span class="op" id="4674049">:</span>&nbsp;<span class="ident" id="4674051">text</span><span class="op" id="4674055">}</span><br>
<span class="lineno"></span><span class="op" id="4674057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674060">func</span>&nbsp;<span class="op" id="4674065">(</span><span class="ident" id="4674066">s</span>&nbsp;<span class="op" id="4674068">*</span><span class="ident" id="4674069">StringNode</span><span class="op" id="4674079">)</span>&nbsp;<span class="ident" id="4674081">String</span><span class="op" id="4674087">(</span><span class="op" id="4674088">)</span>&nbsp;<span class="builtintype" id="4674090">string</span>&nbsp;<span class="op" id="4674097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674100">return</span>&nbsp;<span class="ident" id="4674107">s</span><span class="op" id="4674108">.</span><span class="ident" id="4674109">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="4674116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674119">func</span>&nbsp;<span class="op" id="4674124">(</span><span class="ident" id="4674125">s</span>&nbsp;<span class="op" id="4674127">*</span><span class="ident" id="4674128">StringNode</span><span class="op" id="4674138">)</span>&nbsp;<span class="ident" id="4674140">tree</span><span class="op" id="4674144">(</span><span class="op" id="4674145">)</span>&nbsp;<span class="op" id="4674147">*</span><span class="ident" id="4674148">Tree</span>&nbsp;<span class="op" id="4674153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674156">return</span>&nbsp;<span class="ident" id="4674163">s</span><span class="op" id="4674164">.</span><span class="ident" id="4674165">tr</span><br>
<span class="lineno"></span><span class="op" id="4674168">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="4674171">func</span>&nbsp;<span class="op" id="4674176">(</span><span class="ident" id="4674177">s</span>&nbsp;<span class="op" id="4674179">*</span><span class="ident" id="4674180">StringNode</span><span class="op" id="4674190">)</span>&nbsp;<span class="ident" id="4674192">Copy</span><span class="op" id="4674196">(</span><span class="op" id="4674197">)</span>&nbsp;<span class="ident" id="4674199">Node</span>&nbsp;<span class="op" id="4674204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674207">return</span>&nbsp;<span class="ident" id="4674214">s</span><span class="op" id="4674215">.</span><span class="ident" id="4674216">tr</span><span class="op" id="4674218">.</span><span class="ident" id="4674219">newString</span><span class="op" id="4674228">(</span><span class="ident" id="4674229">s</span><span class="op" id="4674230">.</span><span class="ident" id="4674231">Pos</span><span class="op" id="4674234">,</span>&nbsp;<span class="ident" id="4674236">s</span><span class="op" id="4674237">.</span><span class="ident" id="4674238">Quoted</span><span class="op" id="4674244">,</span>&nbsp;<span class="ident" id="4674246">s</span><span class="op" id="4674247">.</span><span class="ident" id="4674248">Text</span><span class="op" id="4674252">)</span><br>
<span class="lineno"></span><span class="op" id="4674254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4674257">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="4674298">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="4674345">type</span>&nbsp;<span class="ident" id="4674350">endNode</span>&nbsp;<span class="keyword" id="4674358">struct</span>&nbsp;<span class="op" id="4674365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674368">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674378">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674383">tr</span>&nbsp;<span class="op" id="4674386">*</span><span class="ident" id="4674387">Tree</span><br>
<span class="lineno"></span><span class="op" id="4674392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674395">func</span>&nbsp;<span class="op" id="4674400">(</span><span class="ident" id="4674401">t</span>&nbsp;<span class="op" id="4674403">*</span><span class="ident" id="4674404">Tree</span><span class="op" id="4674408">)</span>&nbsp;<span class="ident" id="4674410">newEnd</span><span class="op" id="4674416">(</span><span class="ident" id="4674417">pos</span>&nbsp;<span class="ident" id="4674421">Pos</span><span class="op" id="4674424">)</span>&nbsp;<span class="op" id="4674426">*</span><span class="ident" id="4674427">endNode</span>&nbsp;<span class="op" id="4674435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674438">return</span>&nbsp;<span class="op" id="4674445">&amp;</span><span class="ident" id="4674446">endNode</span><span class="op" id="4674453">{</span><span class="ident" id="4674454">tr</span><span class="op" id="4674456">:</span>&nbsp;<span class="ident" id="4674458">t</span><span class="op" id="4674459">,</span>&nbsp;<span class="ident" id="4674461">NodeType</span><span class="op" id="4674469">:</span>&nbsp;<span class="ident" id="4674471">nodeEnd</span><span class="op" id="4674478">,</span>&nbsp;<span class="ident" id="4674480">Pos</span><span class="op" id="4674483">:</span>&nbsp;<span class="ident" id="4674485">pos</span><span class="op" id="4674488">}</span><br>
<span class="lineno">680</span><span class="op" id="4674490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674493">func</span>&nbsp;<span class="op" id="4674498">(</span><span class="ident" id="4674499">e</span>&nbsp;<span class="op" id="4674501">*</span><span class="ident" id="4674502">endNode</span><span class="op" id="4674509">)</span>&nbsp;<span class="ident" id="4674511">String</span><span class="op" id="4674517">(</span><span class="op" id="4674518">)</span>&nbsp;<span class="builtintype" id="4674520">string</span>&nbsp;<span class="op" id="4674527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674530">return</span>&nbsp;<span class="string" id="4674537">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4674547">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4674550">func</span>&nbsp;<span class="op" id="4674555">(</span><span class="ident" id="4674556">e</span>&nbsp;<span class="op" id="4674558">*</span><span class="ident" id="4674559">endNode</span><span class="op" id="4674566">)</span>&nbsp;<span class="ident" id="4674568">tree</span><span class="op" id="4674572">(</span><span class="op" id="4674573">)</span>&nbsp;<span class="op" id="4674575">*</span><span class="ident" id="4674576">Tree</span>&nbsp;<span class="op" id="4674581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674584">return</span>&nbsp;<span class="ident" id="4674591">e</span><span class="op" id="4674592">.</span><span class="ident" id="4674593">tr</span><br>
<span class="lineno"></span><span class="op" id="4674596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="4674599">func</span>&nbsp;<span class="op" id="4674604">(</span><span class="ident" id="4674605">e</span>&nbsp;<span class="op" id="4674607">*</span><span class="ident" id="4674608">endNode</span><span class="op" id="4674615">)</span>&nbsp;<span class="ident" id="4674617">Copy</span><span class="op" id="4674621">(</span><span class="op" id="4674622">)</span>&nbsp;<span class="ident" id="4674624">Node</span>&nbsp;<span class="op" id="4674629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674632">return</span>&nbsp;<span class="ident" id="4674639">e</span><span class="op" id="4674640">.</span><span class="ident" id="4674641">tr</span><span class="op" id="4674643">.</span><span class="ident" id="4674644">newEnd</span><span class="op" id="4674650">(</span><span class="ident" id="4674651">e</span><span class="op" id="4674652">.</span><span class="ident" id="4674653">Pos</span><span class="op" id="4674656">)</span><br>
<span class="lineno"></span><span class="op" id="4674658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4674661">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="4674739">type</span>&nbsp;<span class="ident" id="4674744">elseNode</span>&nbsp;<span class="keyword" id="4674753">struct</span>&nbsp;<span class="op" id="4674760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674763">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674773">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674778">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4674783">*</span><span class="ident" id="4674784">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674790">Line</span>&nbsp;<span class="builtintype" id="4674795">int</span>&nbsp;<span class="comment" id="4674799">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="4674868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4674871">func</span>&nbsp;<span class="op" id="4674876">(</span><span class="ident" id="4674877">t</span>&nbsp;<span class="op" id="4674879">*</span><span class="ident" id="4674880">Tree</span><span class="op" id="4674884">)</span>&nbsp;<span class="ident" id="4674886">newElse</span><span class="op" id="4674893">(</span><span class="ident" id="4674894">pos</span>&nbsp;<span class="ident" id="4674898">Pos</span><span class="op" id="4674901">,</span>&nbsp;<span class="ident" id="4674903">line</span>&nbsp;<span class="builtintype" id="4674908">int</span><span class="op" id="4674911">)</span>&nbsp;<span class="op" id="4674913">*</span><span class="ident" id="4674914">elseNode</span>&nbsp;<span class="op" id="4674923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674926">return</span>&nbsp;<span class="op" id="4674933">&amp;</span><span class="ident" id="4674934">elseNode</span><span class="op" id="4674942">{</span><span class="ident" id="4674943">tr</span><span class="op" id="4674945">:</span>&nbsp;<span class="ident" id="4674947">t</span><span class="op" id="4674948">,</span>&nbsp;<span class="ident" id="4674950">NodeType</span><span class="op" id="4674958">:</span>&nbsp;<span class="ident" id="4674960">nodeElse</span><span class="op" id="4674968">,</span>&nbsp;<span class="ident" id="4674970">Pos</span><span class="op" id="4674973">:</span>&nbsp;<span class="ident" id="4674975">pos</span><span class="op" id="4674978">,</span>&nbsp;<span class="ident" id="4674980">Line</span><span class="op" id="4674984">:</span>&nbsp;<span class="ident" id="4674986">line</span><span class="op" id="4674990">}</span><br>
<span class="lineno"></span><span class="op" id="4674992">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="4674995">func</span>&nbsp;<span class="op" id="4675000">(</span><span class="ident" id="4675001">e</span>&nbsp;<span class="op" id="4675003">*</span><span class="ident" id="4675004">elseNode</span><span class="op" id="4675012">)</span>&nbsp;<span class="ident" id="4675014">Type</span><span class="op" id="4675018">(</span><span class="op" id="4675019">)</span>&nbsp;<span class="ident" id="4675021">NodeType</span>&nbsp;<span class="op" id="4675030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675033">return</span>&nbsp;<span class="ident" id="4675040">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="4675049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="4675052">func</span>&nbsp;<span class="op" id="4675057">(</span><span class="ident" id="4675058">e</span>&nbsp;<span class="op" id="4675060">*</span><span class="ident" id="4675061">elseNode</span><span class="op" id="4675069">)</span>&nbsp;<span class="ident" id="4675071">String</span><span class="op" id="4675077">(</span><span class="op" id="4675078">)</span>&nbsp;<span class="builtintype" id="4675080">string</span>&nbsp;<span class="op" id="4675087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675090">return</span>&nbsp;<span class="string" id="4675097">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="4675108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675111">func</span>&nbsp;<span class="op" id="4675116">(</span><span class="ident" id="4675117">e</span>&nbsp;<span class="op" id="4675119">*</span><span class="ident" id="4675120">elseNode</span><span class="op" id="4675128">)</span>&nbsp;<span class="ident" id="4675130">tree</span><span class="op" id="4675134">(</span><span class="op" id="4675135">)</span>&nbsp;<span class="op" id="4675137">*</span><span class="ident" id="4675138">Tree</span>&nbsp;<span class="op" id="4675143">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675146">return</span>&nbsp;<span class="ident" id="4675153">e</span><span class="op" id="4675154">.</span><span class="ident" id="4675155">tr</span><br>
<span class="lineno"></span><span class="op" id="4675158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675161">func</span>&nbsp;<span class="op" id="4675166">(</span><span class="ident" id="4675167">e</span>&nbsp;<span class="op" id="4675169">*</span><span class="ident" id="4675170">elseNode</span><span class="op" id="4675178">)</span>&nbsp;<span class="ident" id="4675180">Copy</span><span class="op" id="4675184">(</span><span class="op" id="4675185">)</span>&nbsp;<span class="ident" id="4675187">Node</span>&nbsp;<span class="op" id="4675192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675195">return</span>&nbsp;<span class="ident" id="4675202">e</span><span class="op" id="4675203">.</span><span class="ident" id="4675204">tr</span><span class="op" id="4675206">.</span><span class="ident" id="4675207">newElse</span><span class="op" id="4675214">(</span><span class="ident" id="4675215">e</span><span class="op" id="4675216">.</span><span class="ident" id="4675217">Pos</span><span class="op" id="4675220">,</span>&nbsp;<span class="ident" id="4675222">e</span><span class="op" id="4675223">.</span><span class="ident" id="4675224">Line</span><span class="op" id="4675228">)</span><br>
<span class="lineno">720</span><span class="op" id="4675230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4675233">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="4675300">type</span>&nbsp;<span class="ident" id="4675305">BranchNode</span>&nbsp;<span class="keyword" id="4675316">struct</span>&nbsp;<span class="op" id="4675323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675326">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675336">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675341">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675350">*</span><span class="ident" id="4675351">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675357">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4675366">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4675376">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675446">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675455">*</span><span class="ident" id="4675456">PipeNode</span>&nbsp;<span class="comment" id="4675465">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675499">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4675508">*</span><span class="ident" id="4675509">ListNode</span>&nbsp;<span class="comment" id="4675518">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675565">ElseList</span>&nbsp;<span class="op" id="4675574">*</span><span class="ident" id="4675575">ListNode</span>&nbsp;<span class="comment" id="4675584">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="4675642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4675645">func</span>&nbsp;<span class="op" id="4675650">(</span><span class="ident" id="4675651">b</span>&nbsp;<span class="op" id="4675653">*</span><span class="ident" id="4675654">BranchNode</span><span class="op" id="4675664">)</span>&nbsp;<span class="ident" id="4675666">String</span><span class="op" id="4675672">(</span><span class="op" id="4675673">)</span>&nbsp;<span class="builtintype" id="4675675">string</span>&nbsp;<span class="op" id="4675682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675685">name</span>&nbsp;<span class="op" id="4675690">:=</span>&nbsp;<span class="string" id="4675693">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675697">switch</span>&nbsp;<span class="ident" id="4675704">b</span><span class="op" id="4675705">.</span><span class="ident" id="4675706">NodeType</span>&nbsp;<span class="op" id="4675715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675718">case</span>&nbsp;<span class="ident" id="4675723">NodeIf</span><span class="op" id="4675729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675733">name</span>&nbsp;<span class="op" id="4675738">=</span>&nbsp;<span class="string" id="4675740">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675746">case</span>&nbsp;<span class="ident" id="4675751">NodeRange</span><span class="op" id="4675760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675764">name</span>&nbsp;<span class="op" id="4675769">=</span>&nbsp;<span class="string" id="4675771">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675780">case</span>&nbsp;<span class="ident" id="4675785">NodeWith</span><span class="op" id="4675793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675797">name</span>&nbsp;<span class="op" id="4675802">=</span>&nbsp;<span class="string" id="4675804">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675812">default</span><span class="op" id="4675819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4675823">panic</span><span class="op" id="4675828">(</span><span class="string" id="4675829">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4675850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675853">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675856">if</span>&nbsp;<span class="ident" id="4675859">b</span><span class="op" id="4675860">.</span><span class="ident" id="4675861">ElseList</span>&nbsp;<span class="op" id="4675870">!=</span>&nbsp;<span class="ident" id="4675873">nil</span>&nbsp;<span class="op" id="4675877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675881">return</span>&nbsp;<span class="ident" id="4675888">fmt</span><span class="op" id="4675891">.</span><span class="ident" id="4675892">Sprintf</span><span class="op" id="4675899">(</span><span class="string" id="4675900">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="4675930">,</span>&nbsp;<span class="ident" id="4675932">name</span><span class="op" id="4675936">,</span>&nbsp;<span class="ident" id="4675938">b</span><span class="op" id="4675939">.</span><span class="ident" id="4675940">Pipe</span><span class="op" id="4675944">,</span>&nbsp;<span class="ident" id="4675946">b</span><span class="op" id="4675947">.</span><span class="ident" id="4675948">List</span><span class="op" id="4675952">,</span>&nbsp;<span class="ident" id="4675954">b</span><span class="op" id="4675955">.</span><span class="ident" id="4675956">ElseList</span><span class="op" id="4675964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675970">return</span>&nbsp;<span class="ident" id="4675977">fmt</span><span class="op" id="4675980">.</span><span class="ident" id="4675981">Sprintf</span><span class="op" id="4675988">(</span><span class="string" id="4675989">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="4676009">,</span>&nbsp;<span class="ident" id="4676011">name</span><span class="op" id="4676015">,</span>&nbsp;<span class="ident" id="4676017">b</span><span class="op" id="4676018">.</span><span class="ident" id="4676019">Pipe</span><span class="op" id="4676023">,</span>&nbsp;<span class="ident" id="4676025">b</span><span class="op" id="4676026">.</span><span class="ident" id="4676027">List</span><span class="op" id="4676031">)</span><br>
<span class="lineno"></span><span class="op" id="4676033">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="4676036">func</span>&nbsp;<span class="op" id="4676041">(</span><span class="ident" id="4676042">b</span>&nbsp;<span class="op" id="4676044">*</span><span class="ident" id="4676045">BranchNode</span><span class="op" id="4676055">)</span>&nbsp;<span class="ident" id="4676057">tree</span><span class="op" id="4676061">(</span><span class="op" id="4676062">)</span>&nbsp;<span class="op" id="4676064">*</span><span class="ident" id="4676065">Tree</span>&nbsp;<span class="op" id="4676070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676073">return</span>&nbsp;<span class="ident" id="4676080">b</span><span class="op" id="4676081">.</span><span class="ident" id="4676082">tr</span><br>
<span class="lineno"></span><span class="op" id="4676085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="4676088">func</span>&nbsp;<span class="op" id="4676093">(</span><span class="ident" id="4676094">b</span>&nbsp;<span class="op" id="4676096">*</span><span class="ident" id="4676097">BranchNode</span><span class="op" id="4676107">)</span>&nbsp;<span class="ident" id="4676109">Copy</span><span class="op" id="4676113">(</span><span class="op" id="4676114">)</span>&nbsp;<span class="ident" id="4676116">Node</span>&nbsp;<span class="op" id="4676121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676124">switch</span>&nbsp;<span class="ident" id="4676131">b</span><span class="op" id="4676132">.</span><span class="ident" id="4676133">NodeType</span>&nbsp;<span class="op" id="4676142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676145">case</span>&nbsp;<span class="ident" id="4676150">NodeIf</span><span class="op" id="4676156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676160">return</span>&nbsp;<span class="ident" id="4676167">b</span><span class="op" id="4676168">.</span><span class="ident" id="4676169">tr</span><span class="op" id="4676171">.</span><span class="ident" id="4676172">newIf</span><span class="op" id="4676177">(</span><span class="ident" id="4676178">b</span><span class="op" id="4676179">.</span><span class="ident" id="4676180">Pos</span><span class="op" id="4676183">,</span>&nbsp;<span class="ident" id="4676185">b</span><span class="op" id="4676186">.</span><span class="ident" id="4676187">Line</span><span class="op" id="4676191">,</span>&nbsp;<span class="ident" id="4676193">b</span><span class="op" id="4676194">.</span><span class="ident" id="4676195">Pipe</span><span class="op" id="4676199">,</span>&nbsp;<span class="ident" id="4676201">b</span><span class="op" id="4676202">.</span><span class="ident" id="4676203">List</span><span class="op" id="4676207">,</span>&nbsp;<span class="ident" id="4676209">b</span><span class="op" id="4676210">.</span><span class="ident" id="4676211">ElseList</span><span class="op" id="4676219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676222">case</span>&nbsp;<span class="ident" id="4676227">NodeRange</span><span class="op" id="4676236">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676240">return</span>&nbsp;<span class="ident" id="4676247">b</span><span class="op" id="4676248">.</span><span class="ident" id="4676249">tr</span><span class="op" id="4676251">.</span><span class="ident" id="4676252">newRange</span><span class="op" id="4676260">(</span><span class="ident" id="4676261">b</span><span class="op" id="4676262">.</span><span class="ident" id="4676263">Pos</span><span class="op" id="4676266">,</span>&nbsp;<span class="ident" id="4676268">b</span><span class="op" id="4676269">.</span><span class="ident" id="4676270">Line</span><span class="op" id="4676274">,</span>&nbsp;<span class="ident" id="4676276">b</span><span class="op" id="4676277">.</span><span class="ident" id="4676278">Pipe</span><span class="op" id="4676282">,</span>&nbsp;<span class="ident" id="4676284">b</span><span class="op" id="4676285">.</span><span class="ident" id="4676286">List</span><span class="op" id="4676290">,</span>&nbsp;<span class="ident" id="4676292">b</span><span class="op" id="4676293">.</span><span class="ident" id="4676294">ElseList</span><span class="op" id="4676302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676305">case</span>&nbsp;<span class="ident" id="4676310">NodeWith</span><span class="op" id="4676318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676322">return</span>&nbsp;<span class="ident" id="4676329">b</span><span class="op" id="4676330">.</span><span class="ident" id="4676331">tr</span><span class="op" id="4676333">.</span><span class="ident" id="4676334">newWith</span><span class="op" id="4676341">(</span><span class="ident" id="4676342">b</span><span class="op" id="4676343">.</span><span class="ident" id="4676344">Pos</span><span class="op" id="4676347">,</span>&nbsp;<span class="ident" id="4676349">b</span><span class="op" id="4676350">.</span><span class="ident" id="4676351">Line</span><span class="op" id="4676355">,</span>&nbsp;<span class="ident" id="4676357">b</span><span class="op" id="4676358">.</span><span class="ident" id="4676359">Pipe</span><span class="op" id="4676363">,</span>&nbsp;<span class="ident" id="4676365">b</span><span class="op" id="4676366">.</span><span class="ident" id="4676367">List</span><span class="op" id="4676371">,</span>&nbsp;<span class="ident" id="4676373">b</span><span class="op" id="4676374">.</span><span class="ident" id="4676375">ElseList</span><span class="op" id="4676383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676386">default</span><span class="op" id="4676393">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4676397">panic</span><span class="op" id="4676402">(</span><span class="string" id="4676403">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="4676424">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676427">}</span><br>
<span class="lineno"></span><span class="op" id="4676429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4676432">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4676488">type</span>&nbsp;<span class="ident" id="4676493">IfNode</span>&nbsp;<span class="keyword" id="4676500">struct</span>&nbsp;<span class="op" id="4676507">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676510">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4676521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4676524">func</span>&nbsp;<span class="op" id="4676529">(</span><span class="ident" id="4676530">t</span>&nbsp;<span class="op" id="4676532">*</span><span class="ident" id="4676533">Tree</span><span class="op" id="4676537">)</span>&nbsp;<span class="ident" id="4676539">newIf</span><span class="op" id="4676544">(</span><span class="ident" id="4676545">pos</span>&nbsp;<span class="ident" id="4676549">Pos</span><span class="op" id="4676552">,</span>&nbsp;<span class="ident" id="4676554">line</span>&nbsp;<span class="builtintype" id="4676559">int</span><span class="op" id="4676562">,</span>&nbsp;<span class="ident" id="4676564">pipe</span>&nbsp;<span class="op" id="4676569">*</span><span class="ident" id="4676570">PipeNode</span><span class="op" id="4676578">,</span>&nbsp;<span class="ident" id="4676580">list</span><span class="op" id="4676584">,</span>&nbsp;<span class="ident" id="4676586">elseList</span>&nbsp;<span class="op" id="4676595">*</span><span class="ident" id="4676596">ListNode</span><span class="op" id="4676604">)</span>&nbsp;<span class="op" id="4676606">*</span><span class="ident" id="4676607">IfNode</span>&nbsp;<span class="op" id="4676614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676617">return</span>&nbsp;<span class="op" id="4676624">&amp;</span><span class="ident" id="4676625">IfNode</span><span class="op" id="4676631">{</span><span class="ident" id="4676632">BranchNode</span><span class="op" id="4676642">{</span><span class="ident" id="4676643">tr</span><span class="op" id="4676645">:</span>&nbsp;<span class="ident" id="4676647">t</span><span class="op" id="4676648">,</span>&nbsp;<span class="ident" id="4676650">NodeType</span><span class="op" id="4676658">:</span>&nbsp;<span class="ident" id="4676660">NodeIf</span><span class="op" id="4676666">,</span>&nbsp;<span class="ident" id="4676668">Pos</span><span class="op" id="4676671">:</span>&nbsp;<span class="ident" id="4676673">pos</span><span class="op" id="4676676">,</span>&nbsp;<span class="ident" id="4676678">Line</span><span class="op" id="4676682">:</span>&nbsp;<span class="ident" id="4676684">line</span><span class="op" id="4676688">,</span>&nbsp;<span class="ident" id="4676690">Pipe</span><span class="op" id="4676694">:</span>&nbsp;<span class="ident" id="4676696">pipe</span><span class="op" id="4676700">,</span>&nbsp;<span class="ident" id="4676702">List</span><span class="op" id="4676706">:</span>&nbsp;<span class="ident" id="4676708">list</span><span class="op" id="4676712">,</span>&nbsp;<span class="ident" id="4676714">ElseList</span><span class="op" id="4676722">:</span>&nbsp;<span class="ident" id="4676724">elseList</span><span class="op" id="4676732">}</span><span class="op" id="4676733">}</span><br>
<span class="lineno">775</span><span class="op" id="4676735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4676738">func</span>&nbsp;<span class="op" id="4676743">(</span><span class="ident" id="4676744">i</span>&nbsp;<span class="op" id="4676746">*</span><span class="ident" id="4676747">IfNode</span><span class="op" id="4676753">)</span>&nbsp;<span class="ident" id="4676755">Copy</span><span class="op" id="4676759">(</span><span class="op" id="4676760">)</span>&nbsp;<span class="ident" id="4676762">Node</span>&nbsp;<span class="op" id="4676767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676770">return</span>&nbsp;<span class="ident" id="4676777">i</span><span class="op" id="4676778">.</span><span class="ident" id="4676779">tr</span><span class="op" id="4676781">.</span><span class="ident" id="4676782">newIf</span><span class="op" id="4676787">(</span><span class="ident" id="4676788">i</span><span class="op" id="4676789">.</span><span class="ident" id="4676790">Pos</span><span class="op" id="4676793">,</span>&nbsp;<span class="ident" id="4676795">i</span><span class="op" id="4676796">.</span><span class="ident" id="4676797">Line</span><span class="op" id="4676801">,</span>&nbsp;<span class="ident" id="4676803">i</span><span class="op" id="4676804">.</span><span class="ident" id="4676805">Pipe</span><span class="op" id="4676809">.</span><span class="ident" id="4676810">CopyPipe</span><span class="op" id="4676818">(</span><span class="op" id="4676819">)</span><span class="op" id="4676820">,</span>&nbsp;<span class="ident" id="4676822">i</span><span class="op" id="4676823">.</span><span class="ident" id="4676824">List</span><span class="op" id="4676828">.</span><span class="ident" id="4676829">CopyList</span><span class="op" id="4676837">(</span><span class="op" id="4676838">)</span><span class="op" id="4676839">,</span>&nbsp;<span class="ident" id="4676841">i</span><span class="op" id="4676842">.</span><span class="ident" id="4676843">ElseList</span><span class="op" id="4676851">.</span><span class="ident" id="4676852">CopyList</span><span class="op" id="4676860">(</span><span class="op" id="4676861">)</span><span class="op" id="4676862">)</span><br>
<span class="lineno"></span><span class="op" id="4676864">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="4676867">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="4676928">type</span>&nbsp;<span class="ident" id="4676933">RangeNode</span>&nbsp;<span class="keyword" id="4676943">struct</span>&nbsp;<span class="op" id="4676950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676953">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4676964">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="4676967">func</span>&nbsp;<span class="op" id="4676972">(</span><span class="ident" id="4676973">t</span>&nbsp;<span class="op" id="4676975">*</span><span class="ident" id="4676976">Tree</span><span class="op" id="4676980">)</span>&nbsp;<span class="ident" id="4676982">newRange</span><span class="op" id="4676990">(</span><span class="ident" id="4676991">pos</span>&nbsp;<span class="ident" id="4676995">Pos</span><span class="op" id="4676998">,</span>&nbsp;<span class="ident" id="4677000">line</span>&nbsp;<span class="builtintype" id="4677005">int</span><span class="op" id="4677008">,</span>&nbsp;<span class="ident" id="4677010">pipe</span>&nbsp;<span class="op" id="4677015">*</span><span class="ident" id="4677016">PipeNode</span><span class="op" id="4677024">,</span>&nbsp;<span class="ident" id="4677026">list</span><span class="op" id="4677030">,</span>&nbsp;<span class="ident" id="4677032">elseList</span>&nbsp;<span class="op" id="4677041">*</span><span class="ident" id="4677042">ListNode</span><span class="op" id="4677050">)</span>&nbsp;<span class="op" id="4677052">*</span><span class="ident" id="4677053">RangeNode</span>&nbsp;<span class="op" id="4677063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677066">return</span>&nbsp;<span class="op" id="4677073">&amp;</span><span class="ident" id="4677074">RangeNode</span><span class="op" id="4677083">{</span><span class="ident" id="4677084">BranchNode</span><span class="op" id="4677094">{</span><span class="ident" id="4677095">tr</span><span class="op" id="4677097">:</span>&nbsp;<span class="ident" id="4677099">t</span><span class="op" id="4677100">,</span>&nbsp;<span class="ident" id="4677102">NodeType</span><span class="op" id="4677110">:</span>&nbsp;<span class="ident" id="4677112">NodeRange</span><span class="op" id="4677121">,</span>&nbsp;<span class="ident" id="4677123">Pos</span><span class="op" id="4677126">:</span>&nbsp;<span class="ident" id="4677128">pos</span><span class="op" id="4677131">,</span>&nbsp;<span class="ident" id="4677133">Line</span><span class="op" id="4677137">:</span>&nbsp;<span class="ident" id="4677139">line</span><span class="op" id="4677143">,</span>&nbsp;<span class="ident" id="4677145">Pipe</span><span class="op" id="4677149">:</span>&nbsp;<span class="ident" id="4677151">pipe</span><span class="op" id="4677155">,</span>&nbsp;<span class="ident" id="4677157">List</span><span class="op" id="4677161">:</span>&nbsp;<span class="ident" id="4677163">list</span><span class="op" id="4677167">,</span>&nbsp;<span class="ident" id="4677169">ElseList</span><span class="op" id="4677177">:</span>&nbsp;<span class="ident" id="4677179">elseList</span><span class="op" id="4677187">}</span><span class="op" id="4677188">}</span><br>
<span class="lineno"></span><span class="op" id="4677190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="4677193">func</span>&nbsp;<span class="op" id="4677198">(</span><span class="ident" id="4677199">r</span>&nbsp;<span class="op" id="4677201">*</span><span class="ident" id="4677202">RangeNode</span><span class="op" id="4677211">)</span>&nbsp;<span class="ident" id="4677213">Copy</span><span class="op" id="4677217">(</span><span class="op" id="4677218">)</span>&nbsp;<span class="ident" id="4677220">Node</span>&nbsp;<span class="op" id="4677225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677228">return</span>&nbsp;<span class="ident" id="4677235">r</span><span class="op" id="4677236">.</span><span class="ident" id="4677237">tr</span><span class="op" id="4677239">.</span><span class="ident" id="4677240">newRange</span><span class="op" id="4677248">(</span><span class="ident" id="4677249">r</span><span class="op" id="4677250">.</span><span class="ident" id="4677251">Pos</span><span class="op" id="4677254">,</span>&nbsp;<span class="ident" id="4677256">r</span><span class="op" id="4677257">.</span><span class="ident" id="4677258">Line</span><span class="op" id="4677262">,</span>&nbsp;<span class="ident" id="4677264">r</span><span class="op" id="4677265">.</span><span class="ident" id="4677266">Pipe</span><span class="op" id="4677270">.</span><span class="ident" id="4677271">CopyPipe</span><span class="op" id="4677279">(</span><span class="op" id="4677280">)</span><span class="op" id="4677281">,</span>&nbsp;<span class="ident" id="4677283">r</span><span class="op" id="4677284">.</span><span class="ident" id="4677285">List</span><span class="op" id="4677289">.</span><span class="ident" id="4677290">CopyList</span><span class="op" id="4677298">(</span><span class="op" id="4677299">)</span><span class="op" id="4677300">,</span>&nbsp;<span class="ident" id="4677302">r</span><span class="op" id="4677303">.</span><span class="ident" id="4677304">ElseList</span><span class="op" id="4677312">.</span><span class="ident" id="4677313">CopyList</span><span class="op" id="4677321">(</span><span class="op" id="4677322">)</span><span class="op" id="4677323">)</span><br>
<span class="lineno"></span><span class="op" id="4677325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4677328">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="4677387">type</span>&nbsp;<span class="ident" id="4677392">WithNode</span>&nbsp;<span class="keyword" id="4677401">struct</span>&nbsp;<span class="op" id="4677408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677411">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="4677422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4677425">func</span>&nbsp;<span class="op" id="4677430">(</span><span class="ident" id="4677431">t</span>&nbsp;<span class="op" id="4677433">*</span><span class="ident" id="4677434">Tree</span><span class="op" id="4677438">)</span>&nbsp;<span class="ident" id="4677440">newWith</span><span class="op" id="4677447">(</span><span class="ident" id="4677448">pos</span>&nbsp;<span class="ident" id="4677452">Pos</span><span class="op" id="4677455">,</span>&nbsp;<span class="ident" id="4677457">line</span>&nbsp;<span class="builtintype" id="4677462">int</span><span class="op" id="4677465">,</span>&nbsp;<span class="ident" id="4677467">pipe</span>&nbsp;<span class="op" id="4677472">*</span><span class="ident" id="4677473">PipeNode</span><span class="op" id="4677481">,</span>&nbsp;<span class="ident" id="4677483">list</span><span class="op" id="4677487">,</span>&nbsp;<span class="ident" id="4677489">elseList</span>&nbsp;<span class="op" id="4677498">*</span><span class="ident" id="4677499">ListNode</span><span class="op" id="4677507">)</span>&nbsp;<span class="op" id="4677509">*</span><span class="ident" id="4677510">WithNode</span>&nbsp;<span class="op" id="4677519">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677522">return</span>&nbsp;<span class="op" id="4677529">&amp;</span><span class="ident" id="4677530">WithNode</span><span class="op" id="4677538">{</span><span class="ident" id="4677539">BranchNode</span><span class="op" id="4677549">{</span><span class="ident" id="4677550">tr</span><span class="op" id="4677552">:</span>&nbsp;<span class="ident" id="4677554">t</span><span class="op" id="4677555">,</span>&nbsp;<span class="ident" id="4677557">NodeType</span><span class="op" id="4677565">:</span>&nbsp;<span class="ident" id="4677567">NodeWith</span><span class="op" id="4677575">,</span>&nbsp;<span class="ident" id="4677577">Pos</span><span class="op" id="4677580">:</span>&nbsp;<span class="ident" id="4677582">pos</span><span class="op" id="4677585">,</span>&nbsp;<span class="ident" id="4677587">Line</span><span class="op" id="4677591">:</span>&nbsp;<span class="ident" id="4677593">line</span><span class="op" id="4677597">,</span>&nbsp;<span class="ident" id="4677599">Pipe</span><span class="op" id="4677603">:</span>&nbsp;<span class="ident" id="4677605">pipe</span><span class="op" id="4677609">,</span>&nbsp;<span class="ident" id="4677611">List</span><span class="op" id="4677615">:</span>&nbsp;<span class="ident" id="4677617">list</span><span class="op" id="4677621">,</span>&nbsp;<span class="ident" id="4677623">ElseList</span><span class="op" id="4677631">:</span>&nbsp;<span class="ident" id="4677633">elseList</span><span class="op" id="4677641">}</span><span class="op" id="4677642">}</span><br>
<span class="lineno"></span><span class="op" id="4677644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4677647">func</span>&nbsp;<span class="op" id="4677652">(</span><span class="ident" id="4677653">w</span>&nbsp;<span class="op" id="4677655">*</span><span class="ident" id="4677656">WithNode</span><span class="op" id="4677664">)</span>&nbsp;<span class="ident" id="4677666">Copy</span><span class="op" id="4677670">(</span><span class="op" id="4677671">)</span>&nbsp;<span class="ident" id="4677673">Node</span>&nbsp;<span class="op" id="4677678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677681">return</span>&nbsp;<span class="ident" id="4677688">w</span><span class="op" id="4677689">.</span><span class="ident" id="4677690">tr</span><span class="op" id="4677692">.</span><span class="ident" id="4677693">newWith</span><span class="op" id="4677700">(</span><span class="ident" id="4677701">w</span><span class="op" id="4677702">.</span><span class="ident" id="4677703">Pos</span><span class="op" id="4677706">,</span>&nbsp;<span class="ident" id="4677708">w</span><span class="op" id="4677709">.</span><span class="ident" id="4677710">Line</span><span class="op" id="4677714">,</span>&nbsp;<span class="ident" id="4677716">w</span><span class="op" id="4677717">.</span><span class="ident" id="4677718">Pipe</span><span class="op" id="4677722">.</span><span class="ident" id="4677723">CopyPipe</span><span class="op" id="4677731">(</span><span class="op" id="4677732">)</span><span class="op" id="4677733">,</span>&nbsp;<span class="ident" id="4677735">w</span><span class="op" id="4677736">.</span><span class="ident" id="4677737">List</span><span class="op" id="4677741">.</span><span class="ident" id="4677742">CopyList</span><span class="op" id="4677750">(</span><span class="op" id="4677751">)</span><span class="op" id="4677752">,</span>&nbsp;<span class="ident" id="4677754">w</span><span class="op" id="4677755">.</span><span class="ident" id="4677756">ElseList</span><span class="op" id="4677764">.</span><span class="ident" id="4677765">CopyList</span><span class="op" id="4677773">(</span><span class="op" id="4677774">)</span><span class="op" id="4677775">)</span><br>
<span class="lineno">805</span><span class="op" id="4677777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4677780">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4677830">type</span>&nbsp;<span class="ident" id="4677835">TemplateNode</span>&nbsp;<span class="keyword" id="4677848">struct</span>&nbsp;<span class="op" id="4677855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677858">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677868">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677873">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4677878">*</span><span class="ident" id="4677879">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677885">Line</span>&nbsp;<span class="builtintype" id="4677890">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677900">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677970">Name</span>&nbsp;<span class="builtintype" id="4677975">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4677985">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678026">Pipe</span>&nbsp;<span class="op" id="4678031">*</span><span class="ident" id="4678032">PipeNode</span>&nbsp;<span class="comment" id="4678041">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="4678093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4678096">func</span>&nbsp;<span class="op" id="4678101">(</span><span class="ident" id="4678102">t</span>&nbsp;<span class="op" id="4678104">*</span><span class="ident" id="4678105">Tree</span><span class="op" id="4678109">)</span>&nbsp;<span class="ident" id="4678111">newTemplate</span><span class="op" id="4678122">(</span><span class="ident" id="4678123">pos</span>&nbsp;<span class="ident" id="4678127">Pos</span><span class="op" id="4678130">,</span>&nbsp;<span class="ident" id="4678132">line</span>&nbsp;<span class="builtintype" id="4678137">int</span><span class="op" id="4678140">,</span>&nbsp;<span class="ident" id="4678142">name</span>&nbsp;<span class="builtintype" id="4678147">string</span><span class="op" id="4678153">,</span>&nbsp;<span class="ident" id="4678155">pipe</span>&nbsp;<span class="op" id="4678160">*</span><span class="ident" id="4678161">PipeNode</span><span class="op" id="4678169">)</span>&nbsp;<span class="op" id="4678171">*</span><span class="ident" id="4678172">TemplateNode</span>&nbsp;<span class="op" id="4678185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678188">return</span>&nbsp;<span class="op" id="4678195">&amp;</span><span class="ident" id="4678196">TemplateNode</span><span class="op" id="4678208">{</span><span class="ident" id="4678209">tr</span><span class="op" id="4678211">:</span>&nbsp;<span class="ident" id="4678213">t</span><span class="op" id="4678214">,</span>&nbsp;<span class="ident" id="4678216">NodeType</span><span class="op" id="4678224">:</span>&nbsp;<span class="ident" id="4678226">NodeTemplate</span><span class="op" id="4678238">,</span>&nbsp;<span class="ident" id="4678240">Pos</span><span class="op" id="4678243">:</span>&nbsp;<span class="ident" id="4678245">pos</span><span class="op" id="4678248">,</span>&nbsp;<span class="ident" id="4678250">Line</span><span class="op" id="4678254">:</span>&nbsp;<span class="ident" id="4678256">line</span><span class="op" id="4678260">,</span>&nbsp;<span class="ident" id="4678262">Name</span><span class="op" id="4678266">:</span>&nbsp;<span class="ident" id="4678268">name</span><span class="op" id="4678272">,</span>&nbsp;<span class="ident" id="4678274">Pipe</span><span class="op" id="4678278">:</span>&nbsp;<span class="ident" id="4678280">pipe</span><span class="op" id="4678284">}</span><br>
<span class="lineno"></span><span class="op" id="4678286">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="4678289">func</span>&nbsp;<span class="op" id="4678294">(</span><span class="ident" id="4678295">t</span>&nbsp;<span class="op" id="4678297">*</span><span class="ident" id="4678298">TemplateNode</span><span class="op" id="4678310">)</span>&nbsp;<span class="ident" id="4678312">String</span><span class="op" id="4678318">(</span><span class="op" id="4678319">)</span>&nbsp;<span class="builtintype" id="4678321">string</span>&nbsp;<span class="op" id="4678328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678331">if</span>&nbsp;<span class="ident" id="4678334">t</span><span class="op" id="4678335">.</span><span class="ident" id="4678336">Pipe</span>&nbsp;<span class="op" id="4678341">==</span>&nbsp;<span class="ident" id="4678344">nil</span>&nbsp;<span class="op" id="4678348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678352">return</span>&nbsp;<span class="ident" id="4678359">fmt</span><span class="op" id="4678362">.</span><span class="ident" id="4678363">Sprintf</span><span class="op" id="4678370">(</span><span class="string" id="4678371">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="4678388">,</span>&nbsp;<span class="ident" id="4678390">t</span><span class="op" id="4678391">.</span><span class="ident" id="4678392">Name</span><span class="op" id="4678396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678399">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678402">return</span>&nbsp;<span class="ident" id="4678409">fmt</span><span class="op" id="4678412">.</span><span class="ident" id="4678413">Sprintf</span><span class="op" id="4678420">(</span><span class="string" id="4678421">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="4678441">,</span>&nbsp;<span class="ident" id="4678443">t</span><span class="op" id="4678444">.</span><span class="ident" id="4678445">Name</span><span class="op" id="4678449">,</span>&nbsp;<span class="ident" id="4678451">t</span><span class="op" id="4678452">.</span><span class="ident" id="4678453">Pipe</span><span class="op" id="4678457">)</span><br>
<span class="lineno"></span><span class="op" id="4678459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4678462">func</span>&nbsp;<span class="op" id="4678467">(</span><span class="ident" id="4678468">t</span>&nbsp;<span class="op" id="4678470">*</span><span class="ident" id="4678471">TemplateNode</span><span class="op" id="4678483">)</span>&nbsp;<span class="ident" id="4678485">tree</span><span class="op" id="4678489">(</span><span class="op" id="4678490">)</span>&nbsp;<span class="op" id="4678492">*</span><span class="ident" id="4678493">Tree</span>&nbsp;<span class="op" id="4678498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678501">return</span>&nbsp;<span class="ident" id="4678508">t</span><span class="op" id="4678509">.</span><span class="ident" id="4678510">tr</span><br>
<span class="lineno">830</span><span class="op" id="4678513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4678516">func</span>&nbsp;<span class="op" id="4678521">(</span><span class="ident" id="4678522">t</span>&nbsp;<span class="op" id="4678524">*</span><span class="ident" id="4678525">TemplateNode</span><span class="op" id="4678537">)</span>&nbsp;<span class="ident" id="4678539">Copy</span><span class="op" id="4678543">(</span><span class="op" id="4678544">)</span>&nbsp;<span class="ident" id="4678546">Node</span>&nbsp;<span class="op" id="4678551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678554">return</span>&nbsp;<span class="ident" id="4678561">t</span><span class="op" id="4678562">.</span><span class="ident" id="4678563">tr</span><span class="op" id="4678565">.</span><span class="ident" id="4678566">newTemplate</span><span class="op" id="4678577">(</span><span class="ident" id="4678578">t</span><span class="op" id="4678579">.</span><span class="ident" id="4678580">Pos</span><span class="op" id="4678583">,</span>&nbsp;<span class="ident" id="4678585">t</span><span class="op" id="4678586">.</span><span class="ident" id="4678587">Line</span><span class="op" id="4678591">,</span>&nbsp;<span class="ident" id="4678593">t</span><span class="op" id="4678594">.</span><span class="ident" id="4678595">Name</span><span class="op" id="4678599">,</span>&nbsp;<span class="ident" id="4678601">t</span><span class="op" id="4678602">.</span><span class="ident" id="4678603">Pipe</span><span class="op" id="4678607">.</span><span class="ident" id="4678608">CopyPipe</span><span class="op" id="4678616">(</span><span class="op" id="4678617">)</span><span class="op" id="4678618">)</span><br>
<span class="lineno"></span><span class="op" id="4678620">}</span>
</div>
</body>
</html>
