<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/cgi</h2>
<ul>
<li><a href="/gostd/net/http/cgi/child.go.html">child.go</a></li>
<li><a href="/gostd/net/http/cgi/child_test.go.html">child_test.go</a></li>
<li><a href="/gostd/net/http/cgi/host.go.html">host.go</a></li>
<li><a href="/gostd/net/http/cgi/host_test.go.html" class="current">host_test.go</a></li>
<li><a href="/gostd/net/http/cgi/matryoshka_test.go.html">matryoshka_test.go</a></li>
<li><a href="/gostd/net/http/cgi/posix_test.go.html">posix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7418053">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7418108">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7418162">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7418213">//&nbsp;Tests&nbsp;for&nbsp;package&nbsp;cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418239">package</span>&nbsp;<span class="ident" id="7418247">cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7418252">import</span>&nbsp;<span class="op" id="7418259">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418262">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418271">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418278">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418284">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418291">&#34;net/http&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418303">&#34;net/http/httptest&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418324">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418330">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418341">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418358">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418369">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418380">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418391">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7418402">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7418409">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7418412">func</span>&nbsp;<span class="ident" id="7418417">newRequest</span><span class="op" id="7418427">(</span><span class="ident" id="7418428">httpreq</span>&nbsp;<span class="builtintype" id="7418436">string</span><span class="op" id="7418442">)</span>&nbsp;<span class="op" id="7418444">*</span><span class="ident" id="7418445"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7418449">.</span><span class="ident" id="7418450"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span>&nbsp;<span class="op" id="7418458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418461">buf</span>&nbsp;<span class="op" id="7418465">:=</span>&nbsp;<span class="ident" id="7418468"><a href="/gostd/net/http/cgi/host_test.go.html#7418262">bufio</a></span><span class="op" id="7418473">.</span><span class="ident" id="7418474"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="7418483">(</span><span class="ident" id="7418484"><a href="/gostd/net/http/cgi/host_test.go.html#7418380">strings</a></span><span class="op" id="7418491">.</span><span class="ident" id="7418492"><a href="/gostd/strings/reader.go.html#2948317">NewReader</a></span><span class="op" id="7418501">(</span><span class="ident" id="7418502"><a href="/gostd/net/http/cgi/host_test.go.html#7418428">httpreq</a></span><span class="op" id="7418509">)</span><span class="op" id="7418510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418513">req</span><span class="op" id="7418516">,</span>&nbsp;<span class="ident" id="7418518">err</span>&nbsp;<span class="op" id="7418522">:=</span>&nbsp;<span class="ident" id="7418525"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7418529">.</span><span class="ident" id="7418530"><a href="/gostd/net/http/request.go.html#4152095">ReadRequest</a></span><span class="op" id="7418541">(</span><span class="ident" id="7418542"><a href="/gostd/net/http/cgi/host_test.go.html#7418461">buf</a></span><span class="op" id="7418545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7418548">if</span>&nbsp;<span class="ident" id="7418551"><a href="/gostd/net/http/cgi/host_test.go.html#7418518">err</a></span>&nbsp;<span class="op" id="7418555">!=</span>&nbsp;<span class="builtintype" id="7418558">nil</span>&nbsp;<span class="op" id="7418562">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7418566">panic</span><span class="op" id="7418571">(</span><span class="string" id="7418572">&#34;cgi:&nbsp;bogus&nbsp;http&nbsp;request&nbsp;in&nbsp;test:&nbsp;&#34;</span>&nbsp;<span class="op" id="7418608">+</span>&nbsp;<span class="ident" id="7418610"><a href="/gostd/net/http/cgi/host_test.go.html#7418428">httpreq</a></span><span class="op" id="7418617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418623"><a href="/gostd/net/http/cgi/host_test.go.html#7418513">req</a></span><span class="op" id="7418626">.</span><span class="ident" id="7418627"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span>&nbsp;<span class="op" id="7418638">=</span>&nbsp;<span class="string" id="7418640">&#34;1.2.3.4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7418651">return</span>&nbsp;<span class="ident" id="7418658"><a href="/gostd/net/http/cgi/host_test.go.html#7418513">req</a></span><br>
<span class="lineno"></span><span class="op" id="7418662">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7418665">func</span>&nbsp;<span class="ident" id="7418670">runCgiTest</span><span class="op" id="7418680">(</span><span class="ident" id="7418681">t</span>&nbsp;<span class="op" id="7418683">*</span><span class="ident" id="7418684"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7418691">.</span><span class="ident" id="7418692"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7418693">,</span>&nbsp;<span class="ident" id="7418695">h</span>&nbsp;<span class="op" id="7418697">*</span><span class="ident" id="7418698"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7418705">,</span>&nbsp;<span class="ident" id="7418707">httpreq</span>&nbsp;<span class="builtintype" id="7418715">string</span><span class="op" id="7418721">,</span>&nbsp;<span class="ident" id="7418723">expectedMap</span>&nbsp;<span class="keyword" id="7418735">map</span><span class="op" id="7418738">[</span><span class="builtintype" id="7418739">string</span><span class="op" id="7418745">]</span><span class="builtintype" id="7418746">string</span><span class="op" id="7418752">)</span>&nbsp;<span class="op" id="7418754">*</span><span class="ident" id="7418755"><a href="/gostd/net/http/cgi/host_test.go.html#7418303">httptest</a></span><span class="op" id="7418763">.</span><span class="ident" id="7418764"><a href="/gostd/net/http/httptest/recorder.go.html#6132219">ResponseRecorder</a></span>&nbsp;<span class="op" id="7418781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418784">rw</span>&nbsp;<span class="op" id="7418787">:=</span>&nbsp;<span class="ident" id="7418790"><a href="/gostd/net/http/cgi/host_test.go.html#7418303">httptest</a></span><span class="op" id="7418798">.</span><span class="ident" id="7418799"><a href="/gostd/net/http/httptest/recorder.go.html#6132549">NewRecorder</a></span><span class="op" id="7418810">(</span><span class="op" id="7418811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418814">req</span>&nbsp;<span class="op" id="7418818">:=</span>&nbsp;<span class="ident" id="7418821"><a href="/gostd/net/http/cgi/host_test.go.html#7418417">newRequest</a></span><span class="op" id="7418831">(</span><span class="ident" id="7418832"><a href="/gostd/net/http/cgi/host_test.go.html#7418707">httpreq</a></span><span class="op" id="7418839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418842"><a href="/gostd/net/http/cgi/host_test.go.html#7418695">h</a></span><span class="op" id="7418843">.</span><span class="ident" id="7418844"><a href="/gostd/net/http/cgi/host.go.html#5697533">ServeHTTP</a></span><span class="op" id="7418853">(</span><span class="ident" id="7418854"><a href="/gostd/net/http/cgi/host_test.go.html#7418784">rw</a></span><span class="op" id="7418856">,</span>&nbsp;<span class="ident" id="7418858"><a href="/gostd/net/http/cgi/host_test.go.html#7418814">req</a></span><span class="op" id="7418861">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7418865">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;to&nbsp;hold&nbsp;the&nbsp;test&nbsp;map&nbsp;that&nbsp;the&nbsp;CGI&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418923">m</span>&nbsp;<span class="op" id="7418925">:=</span>&nbsp;<span class="builtinfunc" id="7418928">make</span><span class="op" id="7418932">(</span><span class="keyword" id="7418933">map</span><span class="op" id="7418936">[</span><span class="builtintype" id="7418937">string</span><span class="op" id="7418943">]</span><span class="builtintype" id="7418944">string</span><span class="op" id="7418950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418953"><a href="/gostd/net/http/cgi/host_test.go.html#7418923">m</a></span><span class="op" id="7418954">[</span><span class="string" id="7418955">&#34;_body&#34;</span><span class="op" id="7418962">]</span>&nbsp;<span class="op" id="7418964">=</span>&nbsp;<span class="ident" id="7418966"><a href="/gostd/net/http/cgi/host_test.go.html#7418784">rw</a></span><span class="op" id="7418968">.</span><span class="ident" id="7418969"><a href="/gostd/net/http/httptest/recorder.go.html#6132368">Body</a></span><span class="op" id="7418973">.</span><span class="ident" id="7418974"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="7418980">(</span><span class="op" id="7418981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418984">linesRead</span>&nbsp;<span class="op" id="7418994">:=</span>&nbsp;<span class="num" id="7418997">0</span><br>
<span class="lineno">45</span><span class="ident" id="7418999">readlines</span><span class="op" id="7419008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419011">for</span>&nbsp;<span class="op" id="7419015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419019">line</span><span class="op" id="7419023">,</span>&nbsp;<span class="ident" id="7419025">err</span>&nbsp;<span class="op" id="7419029">:=</span>&nbsp;<span class="ident" id="7419032"><a href="/gostd/net/http/cgi/host_test.go.html#7418784">rw</a></span><span class="op" id="7419034">.</span><span class="ident" id="7419035"><a href="/gostd/net/http/httptest/recorder.go.html#6132368">Body</a></span><span class="op" id="7419039">.</span><span class="ident" id="7419040"><a href="/gostd/bytes/buffer.go.html#1395056">ReadString</a></span><span class="op" id="7419050">(</span><span class="string" id="7419051">&#39;\n&#39;</span><span class="op" id="7419055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419059">switch</span>&nbsp;<span class="op" id="7419066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419070">case</span>&nbsp;<span class="ident" id="7419075"><a href="/gostd/net/http/cgi/host_test.go.html#7419025">err</a></span>&nbsp;<span class="op" id="7419079">==</span>&nbsp;<span class="ident" id="7419082"><a href="/gostd/net/http/cgi/host_test.go.html#7418278">io</a></span><span class="op" id="7419084">.</span><span class="ident" id="7419085"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><span class="op" id="7419088">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419093">break</span>&nbsp;<span class="ident" id="7419099"><a href="/gostd/net/http/cgi/host_test.go.html#7418999">readlines</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419111">case</span>&nbsp;<span class="ident" id="7419116"><a href="/gostd/net/http/cgi/host_test.go.html#7419025">err</a></span>&nbsp;<span class="op" id="7419120">!=</span>&nbsp;<span class="builtintype" id="7419123">nil</span><span class="op" id="7419126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419131"><a href="/gostd/net/http/cgi/host_test.go.html#7418681">t</a></span><span class="op" id="7419132">.</span><span class="ident" id="7419133"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7419139">(</span><span class="string" id="7419140">&#34;unexpected&nbsp;error&nbsp;reading&nbsp;from&nbsp;CGI:&nbsp;%v&#34;</span><span class="op" id="7419179">,</span>&nbsp;<span class="ident" id="7419181"><a href="/gostd/net/http/cgi/host_test.go.html#7419025">err</a></span><span class="op" id="7419184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419192"><a href="/gostd/net/http/cgi/host_test.go.html#7418984">linesRead</a></span><span class="op" id="7419201">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419206">trimmedLine</span>&nbsp;<span class="op" id="7419218">:=</span>&nbsp;<span class="ident" id="7419221"><a href="/gostd/net/http/cgi/host_test.go.html#7418380">strings</a></span><span class="op" id="7419228">.</span><span class="ident" id="7419229"><a href="/gostd/strings/strings.go.html#2982257">TrimRight</a></span><span class="op" id="7419238">(</span><span class="ident" id="7419239"><a href="/gostd/net/http/cgi/host_test.go.html#7419019">line</a></span><span class="op" id="7419243">,</span>&nbsp;<span class="string" id="7419245">&#34;\r\n&#34;</span><span class="op" id="7419251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419255">split</span>&nbsp;<span class="op" id="7419261">:=</span>&nbsp;<span class="ident" id="7419264"><a href="/gostd/net/http/cgi/host_test.go.html#7418380">strings</a></span><span class="op" id="7419271">.</span><span class="ident" id="7419272"><a href="/gostd/strings/strings.go.html#2972338">SplitN</a></span><span class="op" id="7419278">(</span><span class="ident" id="7419279"><a href="/gostd/net/http/cgi/host_test.go.html#7419206">trimmedLine</a></span><span class="op" id="7419290">,</span>&nbsp;<span class="string" id="7419292">&#34;=&#34;</span><span class="op" id="7419295">,</span>&nbsp;<span class="num" id="7419297">2</span><span class="op" id="7419298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419302">if</span>&nbsp;<span class="builtinfunc" id="7419305">len</span><span class="op" id="7419308">(</span><span class="ident" id="7419309"><a href="/gostd/net/http/cgi/host_test.go.html#7419255">split</a></span><span class="op" id="7419314">)</span>&nbsp;<span class="op" id="7419316">!=</span>&nbsp;<span class="num" id="7419319">2</span>&nbsp;<span class="op" id="7419321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419326"><a href="/gostd/net/http/cgi/host_test.go.html#7418681">t</a></span><span class="op" id="7419327">.</span><span class="ident" id="7419328"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7419334">(</span><span class="string" id="7419335">&#34;Unexpected&nbsp;%d&nbsp;parts&nbsp;from&nbsp;invalid&nbsp;line&nbsp;number&nbsp;%v:&nbsp;%q;&nbsp;existing&nbsp;map=%v&#34;</span><span class="op" id="7419405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7419411">len</span><span class="op" id="7419414">(</span><span class="ident" id="7419415"><a href="/gostd/net/http/cgi/host_test.go.html#7419255">split</a></span><span class="op" id="7419420">)</span><span class="op" id="7419421">,</span>&nbsp;<span class="ident" id="7419423"><a href="/gostd/net/http/cgi/host_test.go.html#7418984">linesRead</a></span><span class="op" id="7419432">,</span>&nbsp;<span class="ident" id="7419434"><a href="/gostd/net/http/cgi/host_test.go.html#7419019">line</a></span><span class="op" id="7419438">,</span>&nbsp;<span class="ident" id="7419440"><a href="/gostd/net/http/cgi/host_test.go.html#7418923">m</a></span><span class="op" id="7419441">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419449"><a href="/gostd/net/http/cgi/host_test.go.html#7418923">m</a></span><span class="op" id="7419450">[</span><span class="ident" id="7419451"><a href="/gostd/net/http/cgi/host_test.go.html#7419255">split</a></span><span class="op" id="7419456">[</span><span class="num" id="7419457">0</span><span class="op" id="7419458">]</span><span class="op" id="7419459">]</span>&nbsp;<span class="op" id="7419461">=</span>&nbsp;<span class="ident" id="7419463"><a href="/gostd/net/http/cgi/host_test.go.html#7419255">split</a></span><span class="op" id="7419468">[</span><span class="num" id="7419469">1</span><span class="op" id="7419470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419477">for</span>&nbsp;<span class="ident" id="7419481">key</span><span class="op" id="7419484">,</span>&nbsp;<span class="ident" id="7419486">expected</span>&nbsp;<span class="op" id="7419495">:=</span>&nbsp;<span class="keyword" id="7419498">range</span>&nbsp;<span class="ident" id="7419504"><a href="/gostd/net/http/cgi/host_test.go.html#7418723">expectedMap</a></span>&nbsp;<span class="op" id="7419516">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419520">got</span>&nbsp;<span class="op" id="7419524">:=</span>&nbsp;<span class="ident" id="7419527"><a href="/gostd/net/http/cgi/host_test.go.html#7418923">m</a></span><span class="op" id="7419528">[</span><span class="ident" id="7419529"><a href="/gostd/net/http/cgi/host_test.go.html#7419481">key</a></span><span class="op" id="7419532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419536">if</span>&nbsp;<span class="ident" id="7419539"><a href="/gostd/net/http/cgi/host_test.go.html#7419481">key</a></span>&nbsp;<span class="op" id="7419543">==</span>&nbsp;<span class="string" id="7419546">&#34;cwd&#34;</span>&nbsp;<span class="op" id="7419552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7419557">//&nbsp;For&nbsp;Windows.&nbsp;golang.org/issue/4645.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419599">fi1</span><span class="op" id="7419602">,</span>&nbsp;<span class="ident" id="7419604">_</span>&nbsp;<span class="op" id="7419606">:=</span>&nbsp;<span class="ident" id="7419609"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7419611">.</span><span class="ident" id="7419612"><a href="/gostd/os/file_unix.go.html#2455511">Stat</a></span><span class="op" id="7419616">(</span><span class="ident" id="7419617"><a href="/gostd/net/http/cgi/host_test.go.html#7419520">got</a></span><span class="op" id="7419620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419625">fi2</span><span class="op" id="7419628">,</span>&nbsp;<span class="ident" id="7419630">_</span>&nbsp;<span class="op" id="7419632">:=</span>&nbsp;<span class="ident" id="7419635"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7419637">.</span><span class="ident" id="7419638"><a href="/gostd/os/file_unix.go.html#2455511">Stat</a></span><span class="op" id="7419642">(</span><span class="ident" id="7419643"><a href="/gostd/net/http/cgi/host_test.go.html#7419486">expected</a></span><span class="op" id="7419651">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419656">if</span>&nbsp;<span class="ident" id="7419659"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7419661">.</span><span class="ident" id="7419662"><a href="/gostd/os/types.go.html#2475949">SameFile</a></span><span class="op" id="7419670">(</span><span class="ident" id="7419671"><a href="/gostd/net/http/cgi/host_test.go.html#7419599">fi1</a></span><span class="op" id="7419674">,</span>&nbsp;<span class="ident" id="7419676"><a href="/gostd/net/http/cgi/host_test.go.html#7419625">fi2</a></span><span class="op" id="7419679">)</span>&nbsp;<span class="op" id="7419681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419687"><a href="/gostd/net/http/cgi/host_test.go.html#7419520">got</a></span>&nbsp;<span class="op" id="7419691">=</span>&nbsp;<span class="ident" id="7419693"><a href="/gostd/net/http/cgi/host_test.go.html#7419486">expected</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419713">if</span>&nbsp;<span class="ident" id="7419716"><a href="/gostd/net/http/cgi/host_test.go.html#7419520">got</a></span>&nbsp;<span class="op" id="7419720">!=</span>&nbsp;<span class="ident" id="7419723"><a href="/gostd/net/http/cgi/host_test.go.html#7419486">expected</a></span>&nbsp;<span class="op" id="7419732">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419737"><a href="/gostd/net/http/cgi/host_test.go.html#7418681">t</a></span><span class="op" id="7419738">.</span><span class="ident" id="7419739"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7419745">(</span><span class="string" id="7419746">&#34;for&nbsp;key&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7419778">,</span>&nbsp;<span class="ident" id="7419780"><a href="/gostd/net/http/cgi/host_test.go.html#7419481">key</a></span><span class="op" id="7419783">,</span>&nbsp;<span class="ident" id="7419785"><a href="/gostd/net/http/cgi/host_test.go.html#7419520">got</a></span><span class="op" id="7419788">,</span>&nbsp;<span class="ident" id="7419790"><a href="/gostd/net/http/cgi/host_test.go.html#7419486">expected</a></span><span class="op" id="7419798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419808">return</span>&nbsp;<span class="ident" id="7419815"><a href="/gostd/net/http/cgi/host_test.go.html#7418784">rw</a></span><br>
<span class="lineno"></span><span class="op" id="7419818">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7419821">var</span>&nbsp;<span class="ident" id="7419825">cgiTested</span><span class="op" id="7419834">,</span>&nbsp;<span class="ident" id="7419836">cgiWorks</span>&nbsp;<span class="builtintype" id="7419845">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7419851">func</span>&nbsp;<span class="ident" id="7419856">check</span><span class="op" id="7419861">(</span><span class="ident" id="7419862">t</span>&nbsp;<span class="op" id="7419864">*</span><span class="ident" id="7419865"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7419872">.</span><span class="ident" id="7419873"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7419874">)</span>&nbsp;<span class="op" id="7419876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419879">if</span>&nbsp;<span class="op" id="7419882">!</span><span class="ident" id="7419883"><a href="/gostd/net/http/cgi/host_test.go.html#7419825">cgiTested</a></span>&nbsp;<span class="op" id="7419893">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419897"><a href="/gostd/net/http/cgi/host_test.go.html#7419825">cgiTested</a></span>&nbsp;<span class="op" id="7419907">=</span>&nbsp;<span class="builtintype" id="7419909">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7419916"><a href="/gostd/net/http/cgi/host_test.go.html#7419836">cgiWorks</a></span>&nbsp;<span class="op" id="7419925">=</span>&nbsp;<span class="ident" id="7419927"><a href="/gostd/net/http/cgi/host_test.go.html#7418330">exec</a></span><span class="op" id="7419931">.</span><span class="ident" id="7419932"><a href="/gostd/os/exec/exec.go.html#5581161">Command</a></span><span class="op" id="7419939">(</span><span class="string" id="7419940">&#34;./testdata/test.cgi&#34;</span><span class="op" id="7419961">)</span><span class="op" id="7419962">.</span><span class="ident" id="7419963"><a href="/gostd/os/exec/exec.go.html#5583742">Run</a></span><span class="op" id="7419966">(</span><span class="op" id="7419967">)</span>&nbsp;<span class="op" id="7419969">==</span>&nbsp;<span class="builtintype" id="7419972">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7419977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7419980">if</span>&nbsp;<span class="op" id="7419983">!</span><span class="ident" id="7419984"><a href="/gostd/net/http/cgi/host_test.go.html#7419836">cgiWorks</a></span>&nbsp;<span class="op" id="7419993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7419997">//&nbsp;No&nbsp;Perl&nbsp;on&nbsp;Windows,&nbsp;needed&nbsp;by&nbsp;test.cgi</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7420041">//&nbsp;TODO:&nbsp;make&nbsp;the&nbsp;child&nbsp;process&nbsp;be&nbsp;Go,&nbsp;not&nbsp;Perl.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420092"><a href="/gostd/net/http/cgi/host_test.go.html#7419862">t</a></span><span class="op" id="7420093">.</span><span class="ident" id="7420094"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7420098">(</span><span class="string" id="7420099">&#34;Skipping&nbsp;test:&nbsp;test.cgi&nbsp;failed.&#34;</span><span class="op" id="7420132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420135">}</span><br>
<span class="lineno"></span><span class="op" id="7420137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7420140">func</span>&nbsp;<span class="ident" id="7420145">TestCGIBasicGet</span><span class="op" id="7420160">(</span><span class="ident" id="7420161">t</span>&nbsp;<span class="op" id="7420163">*</span><span class="ident" id="7420164"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7420171">.</span><span class="ident" id="7420172"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7420173">)</span>&nbsp;<span class="op" id="7420175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420178"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7420183">(</span><span class="ident" id="7420184"><a href="/gostd/net/http/cgi/host_test.go.html#7420161">t</a></span><span class="op" id="7420185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420188">h</span>&nbsp;<span class="op" id="7420190">:=</span>&nbsp;<span class="op" id="7420193">&amp;</span><span class="ident" id="7420194"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7420201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420205"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7420209">:</span>&nbsp;<span class="string" id="7420211">&#34;testdata/test.cgi&#34;</span><span class="op" id="7420230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420234"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7420238">:</span>&nbsp;<span class="string" id="7420240">&#34;/test.cgi&#34;</span><span class="op" id="7420251">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420257">expectedMap</span>&nbsp;<span class="op" id="7420269">:=</span>&nbsp;<span class="keyword" id="7420272">map</span><span class="op" id="7420275">[</span><span class="builtintype" id="7420276">string</span><span class="op" id="7420282">]</span><span class="builtintype" id="7420283">string</span><span class="op" id="7420289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420293">&#34;test&#34;</span><span class="op" id="7420299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420318">&#34;Hello&nbsp;CGI&#34;</span><span class="op" id="7420329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420333">&#34;param-a&#34;</span><span class="op" id="7420342">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420358">&#34;b&#34;</span><span class="op" id="7420361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420365">&#34;param-foo&#34;</span><span class="op" id="7420376">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420390">&#34;bar&#34;</span><span class="op" id="7420395">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420399">&#34;env-GATEWAY_INTERFACE&#34;</span><span class="op" id="7420422">:</span>&nbsp;<span class="string" id="7420424">&#34;CGI/1.1&#34;</span><span class="op" id="7420433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420437">&#34;env-HTTP_HOST&#34;</span><span class="op" id="7420452">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420462">&#34;example.com&#34;</span><span class="op" id="7420475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420479">&#34;env-PATH_INFO&#34;</span><span class="op" id="7420494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420504">&#34;&#34;</span><span class="op" id="7420506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420510">&#34;env-QUERY_STRING&#34;</span><span class="op" id="7420528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420535">&#34;foo=bar&amp;a=b&#34;</span><span class="op" id="7420548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420552">&#34;env-REMOTE_ADDR&#34;</span><span class="op" id="7420569">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420577">&#34;1.2.3.4&#34;</span><span class="op" id="7420586">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420590">&#34;env-REMOTE_HOST&#34;</span><span class="op" id="7420607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420615">&#34;1.2.3.4&#34;</span><span class="op" id="7420624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420628">&#34;env-REQUEST_METHOD&#34;</span><span class="op" id="7420648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420653">&#34;GET&#34;</span><span class="op" id="7420658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420662">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7420679">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420687">&#34;/test.cgi?foo=bar&amp;a=b&#34;</span><span class="op" id="7420710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420714">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7420735">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7420739">&#34;testdata/test.cgi&#34;</span><span class="op" id="7420758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420762">&#34;env-SCRIPT_NAME&#34;</span><span class="op" id="7420779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420787">&#34;/test.cgi&#34;</span><span class="op" id="7420798">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420802">&#34;env-SERVER_NAME&#34;</span><span class="op" id="7420819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420827">&#34;example.com&#34;</span><span class="op" id="7420840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420844">&#34;env-SERVER_PORT&#34;</span><span class="op" id="7420861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420869">&#34;80&#34;</span><span class="op" id="7420873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7420877">&#34;env-SERVER_SOFTWARE&#34;</span><span class="op" id="7420898">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7420902">&#34;go&#34;</span><span class="op" id="7420906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7420909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7420912">replay</span>&nbsp;<span class="op" id="7420919">:=</span>&nbsp;<span class="ident" id="7420922"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7420932">(</span><span class="ident" id="7420933"><a href="/gostd/net/http/cgi/host_test.go.html#7420161">t</a></span><span class="op" id="7420934">,</span>&nbsp;<span class="ident" id="7420936"><a href="/gostd/net/http/cgi/host_test.go.html#7420188">h</a></span><span class="op" id="7420937">,</span>&nbsp;<span class="string" id="7420939">&#34;GET&nbsp;/test.cgi?foo=bar&amp;a=b&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7420998">,</span>&nbsp;<span class="ident" id="7421000"><a href="/gostd/net/http/cgi/host_test.go.html#7420257">expectedMap</a></span><span class="op" id="7421011">)</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7421015">if</span>&nbsp;<span class="ident" id="7421018">expected</span><span class="op" id="7421026">,</span>&nbsp;<span class="ident" id="7421028">got</span>&nbsp;<span class="op" id="7421032">:=</span>&nbsp;<span class="string" id="7421035">&#34;text/html&#34;</span><span class="op" id="7421046">,</span>&nbsp;<span class="ident" id="7421048"><a href="/gostd/net/http/cgi/host_test.go.html#7420912">replay</a></span><span class="op" id="7421054">.</span><span class="ident" id="7421055"><a href="/gostd/net/http/httptest/recorder.go.html#6132945">Header</a></span><span class="op" id="7421061">(</span><span class="op" id="7421062">)</span><span class="op" id="7421063">.</span><span class="ident" id="7421064"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7421067">(</span><span class="string" id="7421068">&#34;Content-Type&#34;</span><span class="op" id="7421082">)</span><span class="op" id="7421083">;</span>&nbsp;<span class="ident" id="7421085"><a href="/gostd/net/http/cgi/host_test.go.html#7421028">got</a></span>&nbsp;<span class="op" id="7421089">!=</span>&nbsp;<span class="ident" id="7421092"><a href="/gostd/net/http/cgi/host_test.go.html#7421018">expected</a></span>&nbsp;<span class="op" id="7421101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421105"><a href="/gostd/net/http/cgi/host_test.go.html#7420161">t</a></span><span class="op" id="7421106">.</span><span class="ident" id="7421107"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7421113">(</span><span class="string" id="7421114">&#34;got&nbsp;a&nbsp;Content-Type&nbsp;of&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7421153">,</span>&nbsp;<span class="ident" id="7421155"><a href="/gostd/net/http/cgi/host_test.go.html#7421028">got</a></span><span class="op" id="7421158">,</span>&nbsp;<span class="ident" id="7421160"><a href="/gostd/net/http/cgi/host_test.go.html#7421018">expected</a></span><span class="op" id="7421168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7421174">if</span>&nbsp;<span class="ident" id="7421177">expected</span><span class="op" id="7421185">,</span>&nbsp;<span class="ident" id="7421187">got</span>&nbsp;<span class="op" id="7421191">:=</span>&nbsp;<span class="string" id="7421194">&#34;X-Test-Value&#34;</span><span class="op" id="7421208">,</span>&nbsp;<span class="ident" id="7421210"><a href="/gostd/net/http/cgi/host_test.go.html#7420912">replay</a></span><span class="op" id="7421216">.</span><span class="ident" id="7421217"><a href="/gostd/net/http/httptest/recorder.go.html#6132945">Header</a></span><span class="op" id="7421223">(</span><span class="op" id="7421224">)</span><span class="op" id="7421225">.</span><span class="ident" id="7421226"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7421229">(</span><span class="string" id="7421230">&#34;X-Test-Header&#34;</span><span class="op" id="7421245">)</span><span class="op" id="7421246">;</span>&nbsp;<span class="ident" id="7421248"><a href="/gostd/net/http/cgi/host_test.go.html#7421187">got</a></span>&nbsp;<span class="op" id="7421252">!=</span>&nbsp;<span class="ident" id="7421255"><a href="/gostd/net/http/cgi/host_test.go.html#7421177">expected</a></span>&nbsp;<span class="op" id="7421264">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421268"><a href="/gostd/net/http/cgi/host_test.go.html#7420161">t</a></span><span class="op" id="7421269">.</span><span class="ident" id="7421270"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7421276">(</span><span class="string" id="7421277">&#34;got&nbsp;a&nbsp;X-Test-Header&nbsp;of&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7421317">,</span>&nbsp;<span class="ident" id="7421319"><a href="/gostd/net/http/cgi/host_test.go.html#7421187">got</a></span><span class="op" id="7421322">,</span>&nbsp;<span class="ident" id="7421324"><a href="/gostd/net/http/cgi/host_test.go.html#7421177">expected</a></span><span class="op" id="7421332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421335">}</span><br>
<span class="lineno"></span><span class="op" id="7421337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7421340">func</span>&nbsp;<span class="ident" id="7421345">TestCGIBasicGetAbsPath</span><span class="op" id="7421367">(</span><span class="ident" id="7421368">t</span>&nbsp;<span class="op" id="7421370">*</span><span class="ident" id="7421371"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7421378">.</span><span class="ident" id="7421379"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7421380">)</span>&nbsp;<span class="op" id="7421382">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421385"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7421390">(</span><span class="ident" id="7421391"><a href="/gostd/net/http/cgi/host_test.go.html#7421368">t</a></span><span class="op" id="7421392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421395">pwd</span><span class="op" id="7421398">,</span>&nbsp;<span class="ident" id="7421400">err</span>&nbsp;<span class="op" id="7421404">:=</span>&nbsp;<span class="ident" id="7421407"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7421409">.</span><span class="ident" id="7421410"><a href="/gostd/os/getwd.go.html#2462017">Getwd</a></span><span class="op" id="7421415">(</span><span class="op" id="7421416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7421419">if</span>&nbsp;<span class="ident" id="7421422"><a href="/gostd/net/http/cgi/host_test.go.html#7421400">err</a></span>&nbsp;<span class="op" id="7421426">!=</span>&nbsp;<span class="builtintype" id="7421429">nil</span>&nbsp;<span class="op" id="7421433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421437"><a href="/gostd/net/http/cgi/host_test.go.html#7421368">t</a></span><span class="op" id="7421438">.</span><span class="ident" id="7421439"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7421445">(</span><span class="string" id="7421446">&#34;getwd&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7421463">,</span>&nbsp;<span class="ident" id="7421465"><a href="/gostd/net/http/cgi/host_test.go.html#7421400">err</a></span><span class="op" id="7421468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421471">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421474">h</span>&nbsp;<span class="op" id="7421476">:=</span>&nbsp;<span class="op" id="7421479">&amp;</span><span class="ident" id="7421480"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7421487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421491"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7421495">:</span>&nbsp;<span class="ident" id="7421497"><a href="/gostd/net/http/cgi/host_test.go.html#7421395">pwd</a></span>&nbsp;<span class="op" id="7421501">+</span>&nbsp;<span class="string" id="7421503">&#34;/testdata/test.cgi&#34;</span><span class="op" id="7421523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421527"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7421531">:</span>&nbsp;<span class="string" id="7421533">&#34;/test.cgi&#34;</span><span class="op" id="7421544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421550">expectedMap</span>&nbsp;<span class="op" id="7421562">:=</span>&nbsp;<span class="keyword" id="7421565">map</span><span class="op" id="7421568">[</span><span class="builtintype" id="7421569">string</span><span class="op" id="7421575">]</span><span class="builtintype" id="7421576">string</span><span class="op" id="7421582">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421586">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7421603">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421609">&#34;/test.cgi?foo=bar&amp;a=b&#34;</span><span class="op" id="7421632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421636">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7421657">:</span>&nbsp;<span class="ident" id="7421659"><a href="/gostd/net/http/cgi/host_test.go.html#7421395">pwd</a></span>&nbsp;<span class="op" id="7421663">+</span>&nbsp;<span class="string" id="7421665">&#34;/testdata/test.cgi&#34;</span><span class="op" id="7421685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421689">&#34;env-SCRIPT_NAME&#34;</span><span class="op" id="7421706">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421712">&#34;/test.cgi&#34;</span><span class="op" id="7421723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421729"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7421739">(</span><span class="ident" id="7421740"><a href="/gostd/net/http/cgi/host_test.go.html#7421368">t</a></span><span class="op" id="7421741">,</span>&nbsp;<span class="ident" id="7421743"><a href="/gostd/net/http/cgi/host_test.go.html#7421474">h</a></span><span class="op" id="7421744">,</span>&nbsp;<span class="string" id="7421746">&#34;GET&nbsp;/test.cgi?foo=bar&amp;a=b&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7421805">,</span>&nbsp;<span class="ident" id="7421807"><a href="/gostd/net/http/cgi/host_test.go.html#7421550">expectedMap</a></span><span class="op" id="7421818">)</span><br>
<span class="lineno">145</span><span class="op" id="7421820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7421823">func</span>&nbsp;<span class="ident" id="7421828">TestPathInfo</span><span class="op" id="7421840">(</span><span class="ident" id="7421841">t</span>&nbsp;<span class="op" id="7421843">*</span><span class="ident" id="7421844"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7421851">.</span><span class="ident" id="7421852"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7421853">)</span>&nbsp;<span class="op" id="7421855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421858"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7421863">(</span><span class="ident" id="7421864"><a href="/gostd/net/http/cgi/host_test.go.html#7421841">t</a></span><span class="op" id="7421865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421868">h</span>&nbsp;<span class="op" id="7421870">:=</span>&nbsp;<span class="op" id="7421873">&amp;</span><span class="ident" id="7421874"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7421881">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421885"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7421889">:</span>&nbsp;<span class="string" id="7421891">&#34;testdata/test.cgi&#34;</span><span class="op" id="7421910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421914"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7421918">:</span>&nbsp;<span class="string" id="7421920">&#34;/test.cgi&#34;</span><span class="op" id="7421931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7421934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7421937">expectedMap</span>&nbsp;<span class="op" id="7421949">:=</span>&nbsp;<span class="keyword" id="7421952">map</span><span class="op" id="7421955">[</span><span class="builtintype" id="7421956">string</span><span class="op" id="7421962">]</span><span class="builtintype" id="7421963">string</span><span class="op" id="7421969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421973">&#34;param-a&#34;</span><span class="op" id="7421982">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7421996">&#34;b&#34;</span><span class="op" id="7421999">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422003">&#34;env-PATH_INFO&#34;</span><span class="op" id="7422018">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422026">&#34;/extrapath&#34;</span><span class="op" id="7422038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422042">&#34;env-QUERY_STRING&#34;</span><span class="op" id="7422060">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422065">&#34;a=b&#34;</span><span class="op" id="7422070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422074">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7422091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422097">&#34;/test.cgi/extrapath?a=b&#34;</span><span class="op" id="7422122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422126">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7422147">:</span>&nbsp;<span class="string" id="7422149">&#34;testdata/test.cgi&#34;</span><span class="op" id="7422168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422172">&#34;env-SCRIPT_NAME&#34;</span><span class="op" id="7422189">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422195">&#34;/test.cgi&#34;</span><span class="op" id="7422206">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7422209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422212"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7422222">(</span><span class="ident" id="7422223"><a href="/gostd/net/http/cgi/host_test.go.html#7421841">t</a></span><span class="op" id="7422224">,</span>&nbsp;<span class="ident" id="7422226"><a href="/gostd/net/http/cgi/host_test.go.html#7421868">h</a></span><span class="op" id="7422227">,</span>&nbsp;<span class="string" id="7422229">&#34;GET&nbsp;/test.cgi/extrapath?a=b&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7422290">,</span>&nbsp;<span class="ident" id="7422292"><a href="/gostd/net/http/cgi/host_test.go.html#7421937">expectedMap</a></span><span class="op" id="7422303">)</span><br>
<span class="lineno"></span><span class="op" id="7422305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7422308">func</span>&nbsp;<span class="ident" id="7422313">TestPathInfoDirRoot</span><span class="op" id="7422332">(</span><span class="ident" id="7422333">t</span>&nbsp;<span class="op" id="7422335">*</span><span class="ident" id="7422336"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7422343">.</span><span class="ident" id="7422344"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7422345">)</span>&nbsp;<span class="op" id="7422347">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422350"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7422355">(</span><span class="ident" id="7422356"><a href="/gostd/net/http/cgi/host_test.go.html#7422333">t</a></span><span class="op" id="7422357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422360">h</span>&nbsp;<span class="op" id="7422362">:=</span>&nbsp;<span class="op" id="7422365">&amp;</span><span class="ident" id="7422366"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7422373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422377"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7422381">:</span>&nbsp;<span class="string" id="7422383">&#34;testdata/test.cgi&#34;</span><span class="op" id="7422402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422406"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7422410">:</span>&nbsp;<span class="string" id="7422412">&#34;/myscript/&#34;</span><span class="op" id="7422424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7422427">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422430">expectedMap</span>&nbsp;<span class="op" id="7422442">:=</span>&nbsp;<span class="keyword" id="7422445">map</span><span class="op" id="7422448">[</span><span class="builtintype" id="7422449">string</span><span class="op" id="7422455">]</span><span class="builtintype" id="7422456">string</span><span class="op" id="7422462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422466">&#34;env-PATH_INFO&#34;</span><span class="op" id="7422481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422489">&#34;bar&#34;</span><span class="op" id="7422494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422498">&#34;env-QUERY_STRING&#34;</span><span class="op" id="7422516">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422521">&#34;a=b&#34;</span><span class="op" id="7422526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422530">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7422547">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422553">&#34;/myscript/bar?a=b&#34;</span><span class="op" id="7422572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422576">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7422597">:</span>&nbsp;<span class="string" id="7422599">&#34;testdata/test.cgi&#34;</span><span class="op" id="7422618">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422622">&#34;env-SCRIPT_NAME&#34;</span><span class="op" id="7422639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422645">&#34;/myscript/&#34;</span><span class="op" id="7422657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7422660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422663"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7422673">(</span><span class="ident" id="7422674"><a href="/gostd/net/http/cgi/host_test.go.html#7422333">t</a></span><span class="op" id="7422675">,</span>&nbsp;<span class="ident" id="7422677"><a href="/gostd/net/http/cgi/host_test.go.html#7422360">h</a></span><span class="op" id="7422678">,</span>&nbsp;<span class="string" id="7422680">&#34;GET&nbsp;/myscript/bar?a=b&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7422735">,</span>&nbsp;<span class="ident" id="7422737"><a href="/gostd/net/http/cgi/host_test.go.html#7422430">expectedMap</a></span><span class="op" id="7422748">)</span><br>
<span class="lineno"></span><span class="op" id="7422750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7422753">func</span>&nbsp;<span class="ident" id="7422758">TestDupHeaders</span><span class="op" id="7422772">(</span><span class="ident" id="7422773">t</span>&nbsp;<span class="op" id="7422775">*</span><span class="ident" id="7422776"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7422783">.</span><span class="ident" id="7422784"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7422785">)</span>&nbsp;<span class="op" id="7422787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422790"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7422795">(</span><span class="ident" id="7422796"><a href="/gostd/net/http/cgi/host_test.go.html#7422773">t</a></span><span class="op" id="7422797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422800">h</span>&nbsp;<span class="op" id="7422802">:=</span>&nbsp;<span class="op" id="7422805">&amp;</span><span class="ident" id="7422806"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7422813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422817"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7422821">:</span>&nbsp;<span class="string" id="7422823">&#34;testdata/test.cgi&#34;</span><span class="op" id="7422842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7422845">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7422848">expectedMap</span>&nbsp;<span class="op" id="7422860">:=</span>&nbsp;<span class="keyword" id="7422863">map</span><span class="op" id="7422866">[</span><span class="builtintype" id="7422867">string</span><span class="op" id="7422873">]</span><span class="builtintype" id="7422874">string</span><span class="op" id="7422880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422884">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7422901">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422907">&#34;/myscript/bar?a=b&#34;</span><span class="op" id="7422926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422930">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7422951">:</span>&nbsp;<span class="string" id="7422953">&#34;testdata/test.cgi&#34;</span><span class="op" id="7422972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422976">&#34;env-HTTP_COOKIE&#34;</span><span class="op" id="7422993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7422999">&#34;nom=NOM;&nbsp;yum=YUM&#34;</span><span class="op" id="7423017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423021">&#34;env-HTTP_X_FOO&#34;</span><span class="op" id="7423037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423044">&#34;val1,&nbsp;val2&#34;</span><span class="op" id="7423056">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7423059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423062"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7423072">(</span><span class="ident" id="7423073"><a href="/gostd/net/http/cgi/host_test.go.html#7422773">t</a></span><span class="op" id="7423074">,</span>&nbsp;<span class="ident" id="7423076"><a href="/gostd/net/http/cgi/host_test.go.html#7422800">h</a></span><span class="op" id="7423077">,</span>&nbsp;<span class="string" id="7423079">&#34;GET&nbsp;/myscript/bar?a=b&nbsp;HTTP/1.0\n&#34;</span><span class="op" id="7423113">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423117">&#34;Cookie:&nbsp;nom=NOM\n&#34;</span><span class="op" id="7423136">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423140">&#34;Cookie:&nbsp;yum=YUM\n&#34;</span><span class="op" id="7423159">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423163">&#34;X-Foo:&nbsp;val1\n&#34;</span><span class="op" id="7423178">+</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423182">&#34;X-Foo:&nbsp;val2\n&#34;</span><span class="op" id="7423197">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423201">&#34;Host:&nbsp;example.com\n\n&#34;</span><span class="op" id="7423224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423228"><a href="/gostd/net/http/cgi/host_test.go.html#7422848">expectedMap</a></span><span class="op" id="7423239">)</span><br>
<span class="lineno"></span><span class="op" id="7423241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="7423244">func</span>&nbsp;<span class="ident" id="7423249">TestPathInfoNoRoot</span><span class="op" id="7423267">(</span><span class="ident" id="7423268">t</span>&nbsp;<span class="op" id="7423270">*</span><span class="ident" id="7423271"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7423278">.</span><span class="ident" id="7423279"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7423280">)</span>&nbsp;<span class="op" id="7423282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423285"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7423290">(</span><span class="ident" id="7423291"><a href="/gostd/net/http/cgi/host_test.go.html#7423268">t</a></span><span class="op" id="7423292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423295">h</span>&nbsp;<span class="op" id="7423297">:=</span>&nbsp;<span class="op" id="7423300">&amp;</span><span class="ident" id="7423301"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7423308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423312"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7423316">:</span>&nbsp;<span class="string" id="7423318">&#34;testdata/test.cgi&#34;</span><span class="op" id="7423337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423341"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7423345">:</span>&nbsp;<span class="string" id="7423347">&#34;&#34;</span><span class="op" id="7423349">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7423352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423355">expectedMap</span>&nbsp;<span class="op" id="7423367">:=</span>&nbsp;<span class="keyword" id="7423370">map</span><span class="op" id="7423373">[</span><span class="builtintype" id="7423374">string</span><span class="op" id="7423380">]</span><span class="builtintype" id="7423381">string</span><span class="op" id="7423387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423391">&#34;env-PATH_INFO&#34;</span><span class="op" id="7423406">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423414">&#34;/bar&#34;</span><span class="op" id="7423420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423424">&#34;env-QUERY_STRING&#34;</span><span class="op" id="7423442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423447">&#34;a=b&#34;</span><span class="op" id="7423452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423456">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7423473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423479">&#34;/bar?a=b&#34;</span><span class="op" id="7423489">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423493">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7423514">:</span>&nbsp;<span class="string" id="7423516">&#34;testdata/test.cgi&#34;</span><span class="op" id="7423535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423539">&#34;env-SCRIPT_NAME&#34;</span><span class="op" id="7423556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423562">&#34;/&#34;</span><span class="op" id="7423565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7423568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423571"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7423581">(</span><span class="ident" id="7423582"><a href="/gostd/net/http/cgi/host_test.go.html#7423268">t</a></span><span class="op" id="7423583">,</span>&nbsp;<span class="ident" id="7423585"><a href="/gostd/net/http/cgi/host_test.go.html#7423295">h</a></span><span class="op" id="7423586">,</span>&nbsp;<span class="string" id="7423588">&#34;GET&nbsp;/bar?a=b&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7423634">,</span>&nbsp;<span class="ident" id="7423636"><a href="/gostd/net/http/cgi/host_test.go.html#7423355">expectedMap</a></span><span class="op" id="7423647">)</span><br>
<span class="lineno"></span><span class="op" id="7423649">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7423652">func</span>&nbsp;<span class="ident" id="7423657">TestCGIBasicPost</span><span class="op" id="7423673">(</span><span class="ident" id="7423674">t</span>&nbsp;<span class="op" id="7423676">*</span><span class="ident" id="7423677"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7423684">.</span><span class="ident" id="7423685"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7423686">)</span>&nbsp;<span class="op" id="7423688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423691"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7423696">(</span><span class="ident" id="7423697"><a href="/gostd/net/http/cgi/host_test.go.html#7423674">t</a></span><span class="op" id="7423698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423701">postReq</span>&nbsp;<span class="op" id="7423709">:=</span>&nbsp;<span class="string" id="7423712">`POST&nbsp;/test.cgi?a=b&nbsp;HTTP/1.0<br>
<span class="lineno"></span>Host:&nbsp;example.com<br>
<span class="lineno">220</span>Content-Type:&nbsp;application/x-www-form-urlencoded<br>
<span class="lineno"></span>Content-Length:&nbsp;15<br>
<span class="lineno"></span><br>
<span class="lineno"></span>postfoo=postbar`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423845">h</span>&nbsp;<span class="op" id="7423847">:=</span>&nbsp;<span class="op" id="7423850">&amp;</span><span class="ident" id="7423851"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7423858">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423862"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7423866">:</span>&nbsp;<span class="string" id="7423868">&#34;testdata/test.cgi&#34;</span><span class="op" id="7423887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423891"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7423895">:</span>&nbsp;<span class="string" id="7423897">&#34;/test.cgi&#34;</span><span class="op" id="7423908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7423911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7423914">expectedMap</span>&nbsp;<span class="op" id="7423926">:=</span>&nbsp;<span class="keyword" id="7423929">map</span><span class="op" id="7423932">[</span><span class="builtintype" id="7423933">string</span><span class="op" id="7423939">]</span><span class="builtintype" id="7423940">string</span><span class="op" id="7423946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423950">&#34;test&#34;</span><span class="op" id="7423956">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423972">&#34;Hello&nbsp;CGI&#34;</span><span class="op" id="7423983">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7423987">&#34;param-postfoo&#34;</span><span class="op" id="7424002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7424009">&#34;postbar&#34;</span><span class="op" id="7424018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7424022">&#34;env-REQUEST_METHOD&#34;</span><span class="op" id="7424042">:</span>&nbsp;<span class="string" id="7424044">&#34;POST&#34;</span><span class="op" id="7424050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7424054">&#34;env-CONTENT_LENGTH&#34;</span><span class="op" id="7424074">:</span>&nbsp;<span class="string" id="7424076">&#34;15&#34;</span><span class="op" id="7424080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7424084">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7424101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7424106">&#34;/test.cgi?a=b&#34;</span><span class="op" id="7424121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7424124">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424127"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7424137">(</span><span class="ident" id="7424138"><a href="/gostd/net/http/cgi/host_test.go.html#7423674">t</a></span><span class="op" id="7424139">,</span>&nbsp;<span class="ident" id="7424141"><a href="/gostd/net/http/cgi/host_test.go.html#7423845">h</a></span><span class="op" id="7424142">,</span>&nbsp;<span class="ident" id="7424144"><a href="/gostd/net/http/cgi/host_test.go.html#7423701">postReq</a></span><span class="op" id="7424151">,</span>&nbsp;<span class="ident" id="7424153"><a href="/gostd/net/http/cgi/host_test.go.html#7423914">expectedMap</a></span><span class="op" id="7424164">)</span><br>
<span class="lineno"></span><span class="op" id="7424166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7424169">func</span>&nbsp;<span class="ident" id="7424174">chunk</span><span class="op" id="7424179">(</span><span class="ident" id="7424180">s</span>&nbsp;<span class="builtintype" id="7424182">string</span><span class="op" id="7424188">)</span>&nbsp;<span class="builtintype" id="7424190">string</span>&nbsp;<span class="op" id="7424197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7424200">return</span>&nbsp;<span class="ident" id="7424207"><a href="/gostd/net/http/cgi/host_test.go.html#7418271">fmt</a></span><span class="op" id="7424210">.</span><span class="ident" id="7424211"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7424218">(</span><span class="string" id="7424219">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7424233">,</span>&nbsp;<span class="builtinfunc" id="7424235">len</span><span class="op" id="7424238">(</span><span class="ident" id="7424239"><a href="/gostd/net/http/cgi/host_test.go.html#7424180">s</a></span><span class="op" id="7424240">)</span><span class="op" id="7424241">,</span>&nbsp;<span class="ident" id="7424243"><a href="/gostd/net/http/cgi/host_test.go.html#7424180">s</a></span><span class="op" id="7424244">)</span><br>
<span class="lineno">240</span><span class="op" id="7424246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7424249">//&nbsp;The&nbsp;CGI&nbsp;spec&nbsp;doesn&#39;t&nbsp;allow&nbsp;chunked&nbsp;requests.</span><br>
<span class="lineno"></span><span class="keyword" id="7424297">func</span>&nbsp;<span class="ident" id="7424302">TestCGIPostChunked</span><span class="op" id="7424320">(</span><span class="ident" id="7424321">t</span>&nbsp;<span class="op" id="7424323">*</span><span class="ident" id="7424324"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7424331">.</span><span class="ident" id="7424332"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7424333">)</span>&nbsp;<span class="op" id="7424335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424338"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7424343">(</span><span class="ident" id="7424344"><a href="/gostd/net/http/cgi/host_test.go.html#7424321">t</a></span><span class="op" id="7424345">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424348">postReq</span>&nbsp;<span class="op" id="7424356">:=</span>&nbsp;<span class="string" id="7424359">`POST&nbsp;/test.cgi?a=b&nbsp;HTTP/1.1<br>
<span class="lineno"></span>Host:&nbsp;example.com<br>
<span class="lineno"></span>Content-Type:&nbsp;application/x-www-form-urlencoded<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">250</span>`</span>&nbsp;<span class="op" id="7424484">+</span>&nbsp;<span class="ident" id="7424486"><a href="/gostd/net/http/cgi/host_test.go.html#7424174">chunk</a></span><span class="op" id="7424491">(</span><span class="string" id="7424492">&#34;postfoo&#34;</span><span class="op" id="7424501">)</span>&nbsp;<span class="op" id="7424503">+</span>&nbsp;<span class="ident" id="7424505"><a href="/gostd/net/http/cgi/host_test.go.html#7424174">chunk</a></span><span class="op" id="7424510">(</span><span class="string" id="7424511">&#34;=&#34;</span><span class="op" id="7424514">)</span>&nbsp;<span class="op" id="7424516">+</span>&nbsp;<span class="ident" id="7424518"><a href="/gostd/net/http/cgi/host_test.go.html#7424174">chunk</a></span><span class="op" id="7424523">(</span><span class="string" id="7424524">&#34;postbar&#34;</span><span class="op" id="7424533">)</span>&nbsp;<span class="op" id="7424535">+</span>&nbsp;<span class="ident" id="7424537"><a href="/gostd/net/http/cgi/host_test.go.html#7424174">chunk</a></span><span class="op" id="7424542">(</span><span class="string" id="7424543">&#34;&#34;</span><span class="op" id="7424545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424549">h</span>&nbsp;<span class="op" id="7424551">:=</span>&nbsp;<span class="op" id="7424554">&amp;</span><span class="ident" id="7424555"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7424562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424566"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7424570">:</span>&nbsp;<span class="string" id="7424572">&#34;testdata/test.cgi&#34;</span><span class="op" id="7424591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424595"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7424599">:</span>&nbsp;<span class="string" id="7424601">&#34;/test.cgi&#34;</span><span class="op" id="7424612">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7424615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424618">expectedMap</span>&nbsp;<span class="op" id="7424630">:=</span>&nbsp;<span class="keyword" id="7424633">map</span><span class="op" id="7424636">[</span><span class="builtintype" id="7424637">string</span><span class="op" id="7424643">]</span><span class="builtintype" id="7424644">string</span><span class="op" id="7424650">{</span><span class="op" id="7424651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424654">resp</span>&nbsp;<span class="op" id="7424659">:=</span>&nbsp;<span class="ident" id="7424662"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7424672">(</span><span class="ident" id="7424673"><a href="/gostd/net/http/cgi/host_test.go.html#7424321">t</a></span><span class="op" id="7424674">,</span>&nbsp;<span class="ident" id="7424676"><a href="/gostd/net/http/cgi/host_test.go.html#7424549">h</a></span><span class="op" id="7424677">,</span>&nbsp;<span class="ident" id="7424679"><a href="/gostd/net/http/cgi/host_test.go.html#7424348">postReq</a></span><span class="op" id="7424686">,</span>&nbsp;<span class="ident" id="7424688"><a href="/gostd/net/http/cgi/host_test.go.html#7424618">expectedMap</a></span><span class="op" id="7424699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7424702">if</span>&nbsp;<span class="ident" id="7424705">got</span><span class="op" id="7424708">,</span>&nbsp;<span class="ident" id="7424710">expected</span>&nbsp;<span class="op" id="7424719">:=</span>&nbsp;<span class="ident" id="7424722"><a href="/gostd/net/http/cgi/host_test.go.html#7424654">resp</a></span><span class="op" id="7424726">.</span><span class="ident" id="7424727"><a href="/gostd/net/http/httptest/recorder.go.html#6132246">Code</a></span><span class="op" id="7424731">,</span>&nbsp;<span class="ident" id="7424733"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7424737">.</span><span class="ident" id="7424738"><a href="/gostd/net/http/status.go.html#4236667">StatusBadRequest</a></span><span class="op" id="7424754">;</span>&nbsp;<span class="ident" id="7424756"><a href="/gostd/net/http/cgi/host_test.go.html#7424705">got</a></span>&nbsp;<span class="op" id="7424760">!=</span>&nbsp;<span class="ident" id="7424763"><a href="/gostd/net/http/cgi/host_test.go.html#7424710">expected</a></span>&nbsp;<span class="op" id="7424772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424776"><a href="/gostd/net/http/cgi/host_test.go.html#7424321">t</a></span><span class="op" id="7424777">.</span><span class="ident" id="7424778"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7424784">(</span><span class="string" id="7424785">&#34;Expected&nbsp;%v&nbsp;response&nbsp;code&nbsp;from&nbsp;chunked&nbsp;request&nbsp;body;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7424846">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424851"><a href="/gostd/net/http/cgi/host_test.go.html#7424710">expected</a></span><span class="op" id="7424859">,</span>&nbsp;<span class="ident" id="7424861"><a href="/gostd/net/http/cgi/host_test.go.html#7424705">got</a></span><span class="op" id="7424864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7424867">}</span><br>
<span class="lineno"></span><span class="op" id="7424869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7424872">func</span>&nbsp;<span class="ident" id="7424877">TestRedirect</span><span class="op" id="7424889">(</span><span class="ident" id="7424890">t</span>&nbsp;<span class="op" id="7424892">*</span><span class="ident" id="7424893"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7424900">.</span><span class="ident" id="7424901"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7424902">)</span>&nbsp;<span class="op" id="7424904">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424907"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7424912">(</span><span class="ident" id="7424913"><a href="/gostd/net/http/cgi/host_test.go.html#7424890">t</a></span><span class="op" id="7424914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424917">h</span>&nbsp;<span class="op" id="7424919">:=</span>&nbsp;<span class="op" id="7424922">&amp;</span><span class="ident" id="7424923"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7424930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424934"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7424938">:</span>&nbsp;<span class="string" id="7424940">&#34;testdata/test.cgi&#34;</span><span class="op" id="7424959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424963"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7424967">:</span>&nbsp;<span class="string" id="7424969">&#34;/test.cgi&#34;</span><span class="op" id="7424980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7424983">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7424986">rec</span>&nbsp;<span class="op" id="7424990">:=</span>&nbsp;<span class="ident" id="7424993"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7425003">(</span><span class="ident" id="7425004"><a href="/gostd/net/http/cgi/host_test.go.html#7424890">t</a></span><span class="op" id="7425005">,</span>&nbsp;<span class="ident" id="7425007"><a href="/gostd/net/http/cgi/host_test.go.html#7424917">h</a></span><span class="op" id="7425008">,</span>&nbsp;<span class="string" id="7425010">&#34;GET&nbsp;/test.cgi?loc=http://foo.com/&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7425077">,</span>&nbsp;<span class="builtintype" id="7425079">nil</span><span class="op" id="7425082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7425085">if</span>&nbsp;<span class="ident" id="7425088">e</span><span class="op" id="7425089">,</span>&nbsp;<span class="ident" id="7425091">g</span>&nbsp;<span class="op" id="7425093">:=</span>&nbsp;<span class="num" id="7425096">302</span><span class="op" id="7425099">,</span>&nbsp;<span class="ident" id="7425101"><a href="/gostd/net/http/cgi/host_test.go.html#7424986">rec</a></span><span class="op" id="7425104">.</span><span class="ident" id="7425105"><a href="/gostd/net/http/httptest/recorder.go.html#6132246">Code</a></span><span class="op" id="7425109">;</span>&nbsp;<span class="ident" id="7425111"><a href="/gostd/net/http/cgi/host_test.go.html#7425088">e</a></span>&nbsp;<span class="op" id="7425113">!=</span>&nbsp;<span class="ident" id="7425116"><a href="/gostd/net/http/cgi/host_test.go.html#7425091">g</a></span>&nbsp;<span class="op" id="7425118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425122"><a href="/gostd/net/http/cgi/host_test.go.html#7424890">t</a></span><span class="op" id="7425123">.</span><span class="ident" id="7425124"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7425130">(</span><span class="string" id="7425131">&#34;expected&nbsp;status&nbsp;code&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7425164">,</span>&nbsp;<span class="ident" id="7425166"><a href="/gostd/net/http/cgi/host_test.go.html#7425088">e</a></span><span class="op" id="7425167">,</span>&nbsp;<span class="ident" id="7425169"><a href="/gostd/net/http/cgi/host_test.go.html#7425091">g</a></span><span class="op" id="7425170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7425173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7425176">if</span>&nbsp;<span class="ident" id="7425179">e</span><span class="op" id="7425180">,</span>&nbsp;<span class="ident" id="7425182">g</span>&nbsp;<span class="op" id="7425184">:=</span>&nbsp;<span class="string" id="7425187">&#34;http://foo.com/&#34;</span><span class="op" id="7425204">,</span>&nbsp;<span class="ident" id="7425206"><a href="/gostd/net/http/cgi/host_test.go.html#7424986">rec</a></span><span class="op" id="7425209">.</span><span class="ident" id="7425210"><a href="/gostd/net/http/httptest/recorder.go.html#6132945">Header</a></span><span class="op" id="7425216">(</span><span class="op" id="7425217">)</span><span class="op" id="7425218">.</span><span class="ident" id="7425219"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7425222">(</span><span class="string" id="7425223">&#34;Location&#34;</span><span class="op" id="7425233">)</span><span class="op" id="7425234">;</span>&nbsp;<span class="ident" id="7425236"><a href="/gostd/net/http/cgi/host_test.go.html#7425179">e</a></span>&nbsp;<span class="op" id="7425238">!=</span>&nbsp;<span class="ident" id="7425241"><a href="/gostd/net/http/cgi/host_test.go.html#7425182">g</a></span>&nbsp;<span class="op" id="7425243">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425247"><a href="/gostd/net/http/cgi/host_test.go.html#7424890">t</a></span><span class="op" id="7425248">.</span><span class="ident" id="7425249"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7425255">(</span><span class="string" id="7425256">&#34;expected&nbsp;Location&nbsp;header&nbsp;of&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7425296">,</span>&nbsp;<span class="ident" id="7425298"><a href="/gostd/net/http/cgi/host_test.go.html#7425179">e</a></span><span class="op" id="7425299">,</span>&nbsp;<span class="ident" id="7425301"><a href="/gostd/net/http/cgi/host_test.go.html#7425182">g</a></span><span class="op" id="7425302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7425305">}</span><br>
<span class="lineno"></span><span class="op" id="7425307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7425310">func</span>&nbsp;<span class="ident" id="7425315">TestInternalRedirect</span><span class="op" id="7425335">(</span><span class="ident" id="7425336">t</span>&nbsp;<span class="op" id="7425338">*</span><span class="ident" id="7425339"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7425346">.</span><span class="ident" id="7425347"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7425348">)</span>&nbsp;<span class="op" id="7425350">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425353"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7425358">(</span><span class="ident" id="7425359"><a href="/gostd/net/http/cgi/host_test.go.html#7425336">t</a></span><span class="op" id="7425360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425363">baseHandler</span>&nbsp;<span class="op" id="7425375">:=</span>&nbsp;<span class="ident" id="7425378"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7425382">.</span><span class="ident" id="7425383"><a href="/gostd/net/http/server.go.html#4205623">HandlerFunc</a></span><span class="op" id="7425394">(</span><span class="keyword" id="7425395">func</span><span class="op" id="7425399">(</span><span class="ident" id="7425400">rw</span>&nbsp;<span class="ident" id="7425403"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7425407">.</span><span class="ident" id="7425408"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="7425422">,</span>&nbsp;<span class="ident" id="7425424">req</span>&nbsp;<span class="op" id="7425428">*</span><span class="ident" id="7425429"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7425433">.</span><span class="ident" id="7425434"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="7425441">)</span>&nbsp;<span class="op" id="7425443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425447"><a href="/gostd/net/http/cgi/host_test.go.html#7418271">fmt</a></span><span class="op" id="7425450">.</span><span class="ident" id="7425451"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="7425458">(</span><span class="ident" id="7425459"><a href="/gostd/net/http/cgi/host_test.go.html#7425400">rw</a></span><span class="op" id="7425461">,</span>&nbsp;<span class="string" id="7425463">&#34;basepath=%s\n&#34;</span><span class="op" id="7425478">,</span>&nbsp;<span class="ident" id="7425480"><a href="/gostd/net/http/cgi/host_test.go.html#7425424">req</a></span><span class="op" id="7425483">.</span><span class="ident" id="7425484"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="7425487">.</span><span class="ident" id="7425488"><a href="/gostd/net/url/url.go.html#3751366">Path</a></span><span class="op" id="7425492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425496"><a href="/gostd/net/http/cgi/host_test.go.html#7418271">fmt</a></span><span class="op" id="7425499">.</span><span class="ident" id="7425500"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="7425507">(</span><span class="ident" id="7425508"><a href="/gostd/net/http/cgi/host_test.go.html#7425400">rw</a></span><span class="op" id="7425510">,</span>&nbsp;<span class="string" id="7425512">&#34;remoteaddr=%s\n&#34;</span><span class="op" id="7425529">,</span>&nbsp;<span class="ident" id="7425531"><a href="/gostd/net/http/cgi/host_test.go.html#7425424">req</a></span><span class="op" id="7425534">.</span><span class="ident" id="7425535"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="7425545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7425548">}</span><span class="op" id="7425549">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425552">h</span>&nbsp;<span class="op" id="7425554">:=</span>&nbsp;<span class="op" id="7425557">&amp;</span><span class="ident" id="7425558"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7425565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425569"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7425573">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7425590">&#34;testdata/test.cgi&#34;</span><span class="op" id="7425609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425613"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7425617">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7425634">&#34;/test.cgi&#34;</span><span class="op" id="7425645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425649"><a href="/gostd/net/http/cgi/host.go.html#5696926">PathLocationHandler</a></span><span class="op" id="7425668">:</span>&nbsp;<span class="ident" id="7425670"><a href="/gostd/net/http/cgi/host_test.go.html#7425363">baseHandler</a></span><span class="op" id="7425681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7425684">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425687">expectedMap</span>&nbsp;<span class="op" id="7425699">:=</span>&nbsp;<span class="keyword" id="7425702">map</span><span class="op" id="7425705">[</span><span class="builtintype" id="7425706">string</span><span class="op" id="7425712">]</span><span class="builtintype" id="7425713">string</span><span class="op" id="7425719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7425723">&#34;basepath&#34;</span><span class="op" id="7425733">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7425737">&#34;/foo&#34;</span><span class="op" id="7425743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7425747">&#34;remoteaddr&#34;</span><span class="op" id="7425759">:</span>&nbsp;<span class="string" id="7425761">&#34;1.2.3.4&#34;</span><span class="op" id="7425770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7425773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7425776"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7425786">(</span><span class="ident" id="7425787"><a href="/gostd/net/http/cgi/host_test.go.html#7425336">t</a></span><span class="op" id="7425788">,</span>&nbsp;<span class="ident" id="7425790"><a href="/gostd/net/http/cgi/host_test.go.html#7425552">h</a></span><span class="op" id="7425791">,</span>&nbsp;<span class="string" id="7425793">&#34;GET&nbsp;/test.cgi?loc=/foo&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7425849">,</span>&nbsp;<span class="ident" id="7425851"><a href="/gostd/net/http/cgi/host_test.go.html#7425687">expectedMap</a></span><span class="op" id="7425862">)</span><br>
<span class="lineno">295</span><span class="op" id="7425864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7425867">//&nbsp;TestCopyError&nbsp;tests&nbsp;that&nbsp;we&nbsp;kill&nbsp;the&nbsp;process&nbsp;if&nbsp;there&#39;s&nbsp;an&nbsp;error&nbsp;copying</span><br>
<span class="lineno"></span><span class="comment" id="7425943">//&nbsp;its&nbsp;output.&nbsp;(for&nbsp;example,&nbsp;from&nbsp;the&nbsp;client&nbsp;having&nbsp;gone&nbsp;away)</span><br>
<span class="lineno"></span><span class="keyword" id="7426006">func</span>&nbsp;<span class="ident" id="7426011">TestCopyError</span><span class="op" id="7426024">(</span><span class="ident" id="7426025">t</span>&nbsp;<span class="op" id="7426027">*</span><span class="ident" id="7426028"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7426035">.</span><span class="ident" id="7426036"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7426037">)</span>&nbsp;<span class="op" id="7426039">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426042"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7426047">(</span><span class="ident" id="7426048"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426052">if</span>&nbsp;<span class="ident" id="7426055"><a href="/gostd/net/http/cgi/host_test.go.html#7418358">runtime</a></span><span class="op" id="7426062">.</span><span class="ident" id="7426063"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="7426068">==</span>&nbsp;<span class="string" id="7426071">&#34;windows&#34;</span>&nbsp;<span class="op" id="7426081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426085"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426086">.</span><span class="ident" id="7426087"><a href="/gostd/testing/testing.go.html#5480718">Skipf</a></span><span class="op" id="7426092">(</span><span class="string" id="7426093">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7426114">,</span>&nbsp;<span class="ident" id="7426116"><a href="/gostd/net/http/cgi/host_test.go.html#7418358">runtime</a></span><span class="op" id="7426123">.</span><span class="ident" id="7426124"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span><span class="op" id="7426128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426134">h</span>&nbsp;<span class="op" id="7426136">:=</span>&nbsp;<span class="op" id="7426139">&amp;</span><span class="ident" id="7426140"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7426147">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426151"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7426155">:</span>&nbsp;<span class="string" id="7426157">&#34;testdata/test.cgi&#34;</span><span class="op" id="7426176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426180"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7426184">:</span>&nbsp;<span class="string" id="7426186">&#34;/test.cgi&#34;</span><span class="op" id="7426197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426203">ts</span>&nbsp;<span class="op" id="7426206">:=</span>&nbsp;<span class="ident" id="7426209"><a href="/gostd/net/http/cgi/host_test.go.html#7418303">httptest</a></span><span class="op" id="7426217">.</span><span class="ident" id="7426218"><a href="/gostd/net/http/httptest/server.go.html#6135832">NewServer</a></span><span class="op" id="7426227">(</span><span class="ident" id="7426228"><a href="/gostd/net/http/cgi/host_test.go.html#7426134">h</a></span><span class="op" id="7426229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426232">defer</span>&nbsp;<span class="ident" id="7426238"><a href="/gostd/net/http/cgi/host_test.go.html#7426203">ts</a></span><span class="op" id="7426240">.</span><span class="ident" id="7426241"><a href="/gostd/net/http/httptest/server.go.html#6137960">Close</a></span><span class="op" id="7426246">(</span><span class="op" id="7426247">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426251">conn</span><span class="op" id="7426255">,</span>&nbsp;<span class="ident" id="7426257">err</span>&nbsp;<span class="op" id="7426261">:=</span>&nbsp;<span class="ident" id="7426264"><a href="/gostd/net/http/cgi/host_test.go.html#7418284">net</a></span><span class="op" id="7426267">.</span><span class="ident" id="7426268"><a href="/gostd/net/dial.go.html#3203459">Dial</a></span><span class="op" id="7426272">(</span><span class="string" id="7426273">&#34;tcp&#34;</span><span class="op" id="7426278">,</span>&nbsp;<span class="ident" id="7426280"><a href="/gostd/net/http/cgi/host_test.go.html#7426203">ts</a></span><span class="op" id="7426282">.</span><span class="ident" id="7426283"><a href="/gostd/net/http/httptest/server.go.html#6134105">Listener</a></span><span class="op" id="7426291">.</span><span class="ident" id="7426292"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="7426296">(</span><span class="op" id="7426297">)</span><span class="op" id="7426298">.</span><span class="ident" id="7426299"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="7426305">(</span><span class="op" id="7426306">)</span><span class="op" id="7426307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426310">if</span>&nbsp;<span class="ident" id="7426313"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426317">!=</span>&nbsp;<span class="builtintype" id="7426320">nil</span>&nbsp;<span class="op" id="7426324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426328"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426329">.</span><span class="ident" id="7426330"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7426335">(</span><span class="ident" id="7426336"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span><span class="op" id="7426339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426342">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426345">req</span><span class="op" id="7426348">,</span>&nbsp;<span class="ident" id="7426350">_</span>&nbsp;<span class="op" id="7426352">:=</span>&nbsp;<span class="ident" id="7426355"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7426359">.</span><span class="ident" id="7426360"><a href="/gostd/net/http/request.go.html#4149529">NewRequest</a></span><span class="op" id="7426370">(</span><span class="string" id="7426371">&#34;GET&#34;</span><span class="op" id="7426376">,</span>&nbsp;<span class="string" id="7426378">&#34;http://example.com/test.cgi?bigresponse=1&#34;</span><span class="op" id="7426421">,</span>&nbsp;<span class="builtintype" id="7426423">nil</span><span class="op" id="7426426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426429"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426433">=</span>&nbsp;<span class="ident" id="7426435"><a href="/gostd/net/http/cgi/host_test.go.html#7426345">req</a></span><span class="op" id="7426438">.</span><span class="ident" id="7426439"><a href="/gostd/net/http/request.go.html#4146008">Write</a></span><span class="op" id="7426444">(</span><span class="ident" id="7426445"><a href="/gostd/net/http/cgi/host_test.go.html#7426251">conn</a></span><span class="op" id="7426449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426452">if</span>&nbsp;<span class="ident" id="7426455"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426459">!=</span>&nbsp;<span class="builtintype" id="7426462">nil</span>&nbsp;<span class="op" id="7426466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426470"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426471">.</span><span class="ident" id="7426472"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7426478">(</span><span class="string" id="7426479">&#34;Write:&nbsp;%v&#34;</span><span class="op" id="7426490">,</span>&nbsp;<span class="ident" id="7426492"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span><span class="op" id="7426495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426498">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426502">res</span><span class="op" id="7426505">,</span>&nbsp;<span class="ident" id="7426507"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426511">:=</span>&nbsp;<span class="ident" id="7426514"><a href="/gostd/net/http/cgi/host_test.go.html#7418291">http</a></span><span class="op" id="7426518">.</span><span class="ident" id="7426519"><a href="/gostd/net/http/response.go.html#4164712">ReadResponse</a></span><span class="op" id="7426531">(</span><span class="ident" id="7426532"><a href="/gostd/net/http/cgi/host_test.go.html#7418262">bufio</a></span><span class="op" id="7426537">.</span><span class="ident" id="7426538"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="7426547">(</span><span class="ident" id="7426548"><a href="/gostd/net/http/cgi/host_test.go.html#7426251">conn</a></span><span class="op" id="7426552">)</span><span class="op" id="7426553">,</span>&nbsp;<span class="ident" id="7426555"><a href="/gostd/net/http/cgi/host_test.go.html#7426345">req</a></span><span class="op" id="7426558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426561">if</span>&nbsp;<span class="ident" id="7426564"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426568">!=</span>&nbsp;<span class="builtintype" id="7426571">nil</span>&nbsp;<span class="op" id="7426575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426579"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426580">.</span><span class="ident" id="7426581"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7426587">(</span><span class="string" id="7426588">&#34;ReadResponse:&nbsp;%v&#34;</span><span class="op" id="7426606">,</span>&nbsp;<span class="ident" id="7426608"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span><span class="op" id="7426611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426614">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426618">pidstr</span>&nbsp;<span class="op" id="7426625">:=</span>&nbsp;<span class="ident" id="7426628"><a href="/gostd/net/http/cgi/host_test.go.html#7426502">res</a></span><span class="op" id="7426631">.</span><span class="ident" id="7426632"><a href="/gostd/net/http/response.go.html#4162137">Header</a></span><span class="op" id="7426638">.</span><span class="ident" id="7426639"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7426642">(</span><span class="string" id="7426643">&#34;X-CGI-Pid&#34;</span><span class="op" id="7426654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426657">if</span>&nbsp;<span class="ident" id="7426660"><a href="/gostd/net/http/cgi/host_test.go.html#7426618">pidstr</a></span>&nbsp;<span class="op" id="7426667">==</span>&nbsp;<span class="string" id="7426670">&#34;&#34;</span>&nbsp;<span class="op" id="7426673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426677"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426678">.</span><span class="ident" id="7426679"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7426685">(</span><span class="string" id="7426686">&#34;expected&nbsp;an&nbsp;X-CGI-Pid&nbsp;header&nbsp;in&nbsp;response&#34;</span><span class="op" id="7426728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426731">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426734">pid</span><span class="op" id="7426737">,</span>&nbsp;<span class="ident" id="7426739"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426743">:=</span>&nbsp;<span class="ident" id="7426746"><a href="/gostd/net/http/cgi/host_test.go.html#7418369">strconv</a></span><span class="op" id="7426753">.</span><span class="ident" id="7426754"><a href="/gostd/strconv/atoi.go.html#2357032">Atoi</a></span><span class="op" id="7426758">(</span><span class="ident" id="7426759"><a href="/gostd/net/http/cgi/host_test.go.html#7426618">pidstr</a></span><span class="op" id="7426765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426768">if</span>&nbsp;<span class="ident" id="7426771"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426775">!=</span>&nbsp;<span class="builtintype" id="7426778">nil</span>&nbsp;<span class="op" id="7426782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426786"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426787">.</span><span class="ident" id="7426788"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7426794">(</span><span class="string" id="7426795">&#34;invalid&nbsp;X-CGI-Pid&nbsp;value&#34;</span><span class="op" id="7426820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426827">var</span>&nbsp;<span class="ident" id="7426831">buf</span>&nbsp;<span class="op" id="7426835">[</span><span class="num" id="7426836">5000</span><span class="op" id="7426840">]</span><span class="builtintype" id="7426841">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426847">n</span><span class="op" id="7426848">,</span>&nbsp;<span class="ident" id="7426850"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426854">:=</span>&nbsp;<span class="ident" id="7426857"><a href="/gostd/net/http/cgi/host_test.go.html#7418278">io</a></span><span class="op" id="7426859">.</span><span class="ident" id="7426860"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="7426868">(</span><span class="ident" id="7426869"><a href="/gostd/net/http/cgi/host_test.go.html#7426502">res</a></span><span class="op" id="7426872">.</span><span class="ident" id="7426873"><a href="/gostd/net/http/response.go.html#4162507">Body</a></span><span class="op" id="7426877">,</span>&nbsp;<span class="ident" id="7426879"><a href="/gostd/net/http/cgi/host_test.go.html#7426831">buf</a></span><span class="op" id="7426882">[</span><span class="op" id="7426883">:</span><span class="op" id="7426884">]</span><span class="op" id="7426885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426888">if</span>&nbsp;<span class="ident" id="7426891"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span>&nbsp;<span class="op" id="7426895">!=</span>&nbsp;<span class="builtintype" id="7426898">nil</span>&nbsp;<span class="op" id="7426902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426906"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7426907">.</span><span class="ident" id="7426908"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7426914">(</span><span class="string" id="7426915">&#34;ReadFull:&nbsp;%d&nbsp;bytes,&nbsp;%v&#34;</span><span class="op" id="7426939">,</span>&nbsp;<span class="ident" id="7426941"><a href="/gostd/net/http/cgi/host_test.go.html#7426847">n</a></span><span class="op" id="7426942">,</span>&nbsp;<span class="ident" id="7426944"><a href="/gostd/net/http/cgi/host_test.go.html#7426257">err</a></span><span class="op" id="7426947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7426950">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7426954">childRunning</span>&nbsp;<span class="op" id="7426967">:=</span>&nbsp;<span class="keyword" id="7426970">func</span><span class="op" id="7426974">(</span><span class="op" id="7426975">)</span>&nbsp;<span class="builtintype" id="7426977">bool</span>&nbsp;<span class="op" id="7426982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7426986">return</span>&nbsp;<span class="ident" id="7426993"><a href="/gostd/net/http/cgi/posix_test.go.html#7435848">isProcessRunning</a></span><span class="op" id="7427009">(</span><span class="ident" id="7427010"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7427011">,</span>&nbsp;<span class="ident" id="7427013"><a href="/gostd/net/http/cgi/host_test.go.html#7426734">pid</a></span><span class="op" id="7427016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7427023">if</span>&nbsp;<span class="op" id="7427026">!</span><span class="ident" id="7427027"><a href="/gostd/net/http/cgi/host_test.go.html#7426954">childRunning</a></span><span class="op" id="7427039">(</span><span class="op" id="7427040">)</span>&nbsp;<span class="op" id="7427042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427046"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7427047">.</span><span class="ident" id="7427048"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7427054">(</span><span class="string" id="7427055">&#34;pre-conn.Close,&nbsp;expected&nbsp;child&nbsp;to&nbsp;be&nbsp;running&#34;</span><span class="op" id="7427101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427107"><a href="/gostd/net/http/cgi/host_test.go.html#7426251">conn</a></span><span class="op" id="7427111">.</span><span class="ident" id="7427112"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="7427117">(</span><span class="op" id="7427118">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427122">tries</span>&nbsp;<span class="op" id="7427128">:=</span>&nbsp;<span class="num" id="7427131">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7427134">for</span>&nbsp;<span class="ident" id="7427138"><a href="/gostd/net/http/cgi/host_test.go.html#7427122">tries</a></span>&nbsp;<span class="op" id="7427144">&lt;</span>&nbsp;<span class="num" id="7427146">25</span>&nbsp;<span class="op" id="7427149">&amp;&amp;</span>&nbsp;<span class="ident" id="7427152"><a href="/gostd/net/http/cgi/host_test.go.html#7426954">childRunning</a></span><span class="op" id="7427164">(</span><span class="op" id="7427165">)</span>&nbsp;<span class="op" id="7427167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427171"><a href="/gostd/net/http/cgi/host_test.go.html#7418402">time</a></span><span class="op" id="7427175">.</span><span class="ident" id="7427176"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="7427181">(</span><span class="num" id="7427182">50</span>&nbsp;<span class="op" id="7427185">*</span>&nbsp;<span class="ident" id="7427187"><a href="/gostd/net/http/cgi/host_test.go.html#7418402">time</a></span><span class="op" id="7427191">.</span><span class="ident" id="7427192"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span>&nbsp;<span class="op" id="7427204">*</span>&nbsp;<span class="ident" id="7427206"><a href="/gostd/net/http/cgi/host_test.go.html#7418402">time</a></span><span class="op" id="7427210">.</span><span class="ident" id="7427211"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="7427219">(</span><span class="ident" id="7427220"><a href="/gostd/net/http/cgi/host_test.go.html#7427122">tries</a></span><span class="op" id="7427225">)</span><span class="op" id="7427226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427230"><a href="/gostd/net/http/cgi/host_test.go.html#7427122">tries</a></span><span class="op" id="7427235">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427239">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7427242">if</span>&nbsp;<span class="ident" id="7427245"><a href="/gostd/net/http/cgi/host_test.go.html#7426954">childRunning</a></span><span class="op" id="7427257">(</span><span class="op" id="7427258">)</span>&nbsp;<span class="op" id="7427260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427264"><a href="/gostd/net/http/cgi/host_test.go.html#7426025">t</a></span><span class="op" id="7427265">.</span><span class="ident" id="7427266"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7427272">(</span><span class="string" id="7427273">&#34;post-conn.Close,&nbsp;expected&nbsp;child&nbsp;to&nbsp;be&nbsp;gone&#34;</span><span class="op" id="7427317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427320">}</span><br>
<span class="lineno"></span><span class="op" id="7427322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="keyword" id="7427325">func</span>&nbsp;<span class="ident" id="7427330">TestDirUnix</span><span class="op" id="7427341">(</span><span class="ident" id="7427342">t</span>&nbsp;<span class="op" id="7427344">*</span><span class="ident" id="7427345"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7427352">.</span><span class="ident" id="7427353"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7427354">)</span>&nbsp;<span class="op" id="7427356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427359"><a href="/gostd/net/http/cgi/host_test.go.html#7419856">check</a></span><span class="op" id="7427364">(</span><span class="ident" id="7427365"><a href="/gostd/net/http/cgi/host_test.go.html#7427342">t</a></span><span class="op" id="7427366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7427369">if</span>&nbsp;<span class="ident" id="7427372"><a href="/gostd/net/http/cgi/host_test.go.html#7418358">runtime</a></span><span class="op" id="7427379">.</span><span class="ident" id="7427380"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="7427385">==</span>&nbsp;<span class="string" id="7427388">&#34;windows&#34;</span>&nbsp;<span class="op" id="7427398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427402"><a href="/gostd/net/http/cgi/host_test.go.html#7427342">t</a></span><span class="op" id="7427403">.</span><span class="ident" id="7427404"><a href="/gostd/testing/testing.go.html#5480718">Skipf</a></span><span class="op" id="7427409">(</span><span class="string" id="7427410">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7427431">,</span>&nbsp;<span class="ident" id="7427433"><a href="/gostd/net/http/cgi/host_test.go.html#7418358">runtime</a></span><span class="op" id="7427440">.</span><span class="ident" id="7427441"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span><span class="op" id="7427445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427448">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427451">cwd</span><span class="op" id="7427454">,</span>&nbsp;<span class="ident" id="7427456">_</span>&nbsp;<span class="op" id="7427458">:=</span>&nbsp;<span class="ident" id="7427461"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7427463">.</span><span class="ident" id="7427464"><a href="/gostd/os/getwd.go.html#2462017">Getwd</a></span><span class="op" id="7427469">(</span><span class="op" id="7427470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427473">h</span>&nbsp;<span class="op" id="7427475">:=</span>&nbsp;<span class="op" id="7427478">&amp;</span><span class="ident" id="7427479"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7427486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427490"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7427494">:</span>&nbsp;<span class="string" id="7427496">&#34;testdata/test.cgi&#34;</span><span class="op" id="7427515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427519"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7427523">:</span>&nbsp;<span class="string" id="7427525">&#34;/test.cgi&#34;</span><span class="op" id="7427536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427540"><a href="/gostd/net/http/cgi/host.go.html#5696216">Dir</a></span><span class="op" id="7427543">:</span>&nbsp;&nbsp;<span class="ident" id="7427546"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span><span class="op" id="7427549">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427555">expectedMap</span>&nbsp;<span class="op" id="7427567">:=</span>&nbsp;<span class="keyword" id="7427570">map</span><span class="op" id="7427573">[</span><span class="builtintype" id="7427574">string</span><span class="op" id="7427580">]</span><span class="builtintype" id="7427581">string</span><span class="op" id="7427587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7427591">&#34;cwd&#34;</span><span class="op" id="7427596">:</span>&nbsp;<span class="ident" id="7427598"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span><span class="op" id="7427601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427607"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7427617">(</span><span class="ident" id="7427618"><a href="/gostd/net/http/cgi/host_test.go.html#7427342">t</a></span><span class="op" id="7427619">,</span>&nbsp;<span class="ident" id="7427621"><a href="/gostd/net/http/cgi/host_test.go.html#7427473">h</a></span><span class="op" id="7427622">,</span>&nbsp;<span class="string" id="7427624">&#34;GET&nbsp;/test.cgi&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7427671">,</span>&nbsp;<span class="ident" id="7427673"><a href="/gostd/net/http/cgi/host_test.go.html#7427555">expectedMap</a></span><span class="op" id="7427684">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427688"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span><span class="op" id="7427691">,</span>&nbsp;<span class="ident" id="7427693">_</span>&nbsp;<span class="op" id="7427695">=</span>&nbsp;<span class="ident" id="7427697"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7427699">.</span><span class="ident" id="7427700"><a href="/gostd/os/getwd.go.html#2462017">Getwd</a></span><span class="op" id="7427705">(</span><span class="op" id="7427706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427709"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span>&nbsp;<span class="op" id="7427713">=</span>&nbsp;<span class="ident" id="7427715"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7427723">.</span><span class="ident" id="7427724"><a href="/gostd/path/filepath/path.go.html#3783597">Join</a></span><span class="op" id="7427728">(</span><span class="ident" id="7427729"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span><span class="op" id="7427732">,</span>&nbsp;<span class="string" id="7427734">&#34;testdata&#34;</span><span class="op" id="7427744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427747"><a href="/gostd/net/http/cgi/host_test.go.html#7427473">h</a></span>&nbsp;<span class="op" id="7427749">=</span>&nbsp;<span class="op" id="7427751">&amp;</span><span class="ident" id="7427752"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7427759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427763"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7427767">:</span>&nbsp;<span class="string" id="7427769">&#34;testdata/test.cgi&#34;</span><span class="op" id="7427788">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427792"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7427796">:</span>&nbsp;<span class="string" id="7427798">&#34;/test.cgi&#34;</span><span class="op" id="7427809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427815"><a href="/gostd/net/http/cgi/host_test.go.html#7427555">expectedMap</a></span>&nbsp;<span class="op" id="7427827">=</span>&nbsp;<span class="keyword" id="7427829">map</span><span class="op" id="7427832">[</span><span class="builtintype" id="7427833">string</span><span class="op" id="7427839">]</span><span class="builtintype" id="7427840">string</span><span class="op" id="7427846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7427850">&#34;cwd&#34;</span><span class="op" id="7427855">:</span>&nbsp;<span class="ident" id="7427857"><a href="/gostd/net/http/cgi/host_test.go.html#7427451">cwd</a></span><span class="op" id="7427860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7427863">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7427866"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7427876">(</span><span class="ident" id="7427877"><a href="/gostd/net/http/cgi/host_test.go.html#7427342">t</a></span><span class="op" id="7427878">,</span>&nbsp;<span class="ident" id="7427880"><a href="/gostd/net/http/cgi/host_test.go.html#7427473">h</a></span><span class="op" id="7427881">,</span>&nbsp;<span class="string" id="7427883">&#34;GET&nbsp;/test.cgi&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7427930">,</span>&nbsp;<span class="ident" id="7427932"><a href="/gostd/net/http/cgi/host_test.go.html#7427555">expectedMap</a></span><span class="op" id="7427943">)</span><br>
<span class="lineno"></span><span class="op" id="7427945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7427948">func</span>&nbsp;<span class="ident" id="7427953">TestDirWindows</span><span class="op" id="7427967">(</span><span class="ident" id="7427968">t</span>&nbsp;<span class="op" id="7427970">*</span><span class="ident" id="7427971"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7427978">.</span><span class="ident" id="7427979"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7427980">)</span>&nbsp;<span class="op" id="7427982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7427985">if</span>&nbsp;<span class="ident" id="7427988"><a href="/gostd/net/http/cgi/host_test.go.html#7418358">runtime</a></span><span class="op" id="7427995">.</span><span class="ident" id="7427996"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="7428001">!=</span>&nbsp;<span class="string" id="7428004">&#34;windows&#34;</span>&nbsp;<span class="op" id="7428014">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428018"><a href="/gostd/net/http/cgi/host_test.go.html#7427968">t</a></span><span class="op" id="7428019">.</span><span class="ident" id="7428020"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7428024">(</span><span class="string" id="7428025">&#34;Skipping&nbsp;windows&nbsp;specific&nbsp;test.&#34;</span><span class="op" id="7428058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428065">cgifile</span><span class="op" id="7428072">,</span>&nbsp;<span class="ident" id="7428074">_</span>&nbsp;<span class="op" id="7428076">:=</span>&nbsp;<span class="ident" id="7428079"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7428087">.</span><span class="ident" id="7428088"><a href="/gostd/path/filepath/path.go.html#3784647">Abs</a></span><span class="op" id="7428091">(</span><span class="string" id="7428092">&#34;testdata/test.cgi&#34;</span><span class="op" id="7428111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7428115">var</span>&nbsp;<span class="ident" id="7428119">perl</span>&nbsp;<span class="builtintype" id="7428124">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7428132">var</span>&nbsp;<span class="ident" id="7428136">err</span>&nbsp;<span class="builtintype" id="7428140">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428147"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428151">,</span>&nbsp;<span class="ident" id="7428153"><a href="/gostd/net/http/cgi/host_test.go.html#7428136">err</a></span>&nbsp;<span class="op" id="7428157">=</span>&nbsp;<span class="ident" id="7428159"><a href="/gostd/net/http/cgi/host_test.go.html#7418330">exec</a></span><span class="op" id="7428163">.</span><span class="ident" id="7428164"><a href="/gostd/os/exec/lp_unix.go.html#5591524">LookPath</a></span><span class="op" id="7428172">(</span><span class="string" id="7428173">&#34;perl&#34;</span><span class="op" id="7428179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7428182">if</span>&nbsp;<span class="ident" id="7428185"><a href="/gostd/net/http/cgi/host_test.go.html#7428136">err</a></span>&nbsp;<span class="op" id="7428189">!=</span>&nbsp;<span class="builtintype" id="7428192">nil</span>&nbsp;<span class="op" id="7428196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428200"><a href="/gostd/net/http/cgi/host_test.go.html#7427968">t</a></span><span class="op" id="7428201">.</span><span class="ident" id="7428202"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7428206">(</span><span class="string" id="7428207">&#34;Skipping&nbsp;test:&nbsp;perl&nbsp;not&nbsp;found.&#34;</span><span class="op" id="7428239">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428245"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428249">,</span>&nbsp;<span class="ident" id="7428251">_</span>&nbsp;<span class="op" id="7428253">=</span>&nbsp;<span class="ident" id="7428255"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7428263">.</span><span class="ident" id="7428264"><a href="/gostd/path/filepath/path.go.html#3784647">Abs</a></span><span class="op" id="7428267">(</span><span class="ident" id="7428268"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428272">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428276">cwd</span><span class="op" id="7428279">,</span>&nbsp;<span class="ident" id="7428281">_</span>&nbsp;<span class="op" id="7428283">:=</span>&nbsp;<span class="ident" id="7428286"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7428288">.</span><span class="ident" id="7428289"><a href="/gostd/os/getwd.go.html#2462017">Getwd</a></span><span class="op" id="7428294">(</span><span class="op" id="7428295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428298">h</span>&nbsp;<span class="op" id="7428300">:=</span>&nbsp;<span class="op" id="7428303">&amp;</span><span class="ident" id="7428304"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7428311">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428315"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7428319">:</span>&nbsp;<span class="ident" id="7428321"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428329"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7428333">:</span>&nbsp;<span class="string" id="7428335">&#34;/test.cgi&#34;</span><span class="op" id="7428346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428350"><a href="/gostd/net/http/cgi/host.go.html#5696216">Dir</a></span><span class="op" id="7428353">:</span>&nbsp;&nbsp;<span class="ident" id="7428356"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428363"><a href="/gostd/net/http/cgi/host.go.html#5696470">Args</a></span><span class="op" id="7428367">:</span>&nbsp;<span class="op" id="7428369">[</span><span class="op" id="7428370">]</span><span class="builtintype" id="7428371">string</span><span class="op" id="7428377">{</span><span class="ident" id="7428378"><a href="/gostd/net/http/cgi/host_test.go.html#7428065">cgifile</a></span><span class="op" id="7428385">}</span><span class="op" id="7428386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428390"><a href="/gostd/net/http/cgi/host.go.html#5696229">Env</a></span><span class="op" id="7428393">:</span>&nbsp;&nbsp;<span class="op" id="7428396">[</span><span class="op" id="7428397">]</span><span class="builtintype" id="7428398">string</span><span class="op" id="7428404">{</span><span class="string" id="7428405">&#34;SCRIPT_FILENAME=&#34;</span>&nbsp;<span class="op" id="7428424">+</span>&nbsp;<span class="ident" id="7428426"><a href="/gostd/net/http/cgi/host_test.go.html#7428065">cgifile</a></span><span class="op" id="7428433">}</span><span class="op" id="7428434">,</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428440">expectedMap</span>&nbsp;<span class="op" id="7428452">:=</span>&nbsp;<span class="keyword" id="7428455">map</span><span class="op" id="7428458">[</span><span class="builtintype" id="7428459">string</span><span class="op" id="7428465">]</span><span class="builtintype" id="7428466">string</span><span class="op" id="7428472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7428476">&#34;cwd&#34;</span><span class="op" id="7428481">:</span>&nbsp;<span class="ident" id="7428483"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428492"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7428502">(</span><span class="ident" id="7428503"><a href="/gostd/net/http/cgi/host_test.go.html#7427968">t</a></span><span class="op" id="7428504">,</span>&nbsp;<span class="ident" id="7428506"><a href="/gostd/net/http/cgi/host_test.go.html#7428298">h</a></span><span class="op" id="7428507">,</span>&nbsp;<span class="string" id="7428509">&#34;GET&nbsp;/test.cgi&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7428556">,</span>&nbsp;<span class="ident" id="7428558"><a href="/gostd/net/http/cgi/host_test.go.html#7428440">expectedMap</a></span><span class="op" id="7428569">)</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7428573">//&nbsp;If&nbsp;not&nbsp;specify&nbsp;Dir&nbsp;on&nbsp;windows,&nbsp;working&nbsp;directory&nbsp;should&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7428636">//&nbsp;base&nbsp;directory&nbsp;of&nbsp;perl.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428664"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428667">,</span>&nbsp;<span class="ident" id="7428669">_</span>&nbsp;<span class="op" id="7428671">=</span>&nbsp;<span class="ident" id="7428673"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7428681">.</span><span class="ident" id="7428682"><a href="/gostd/path/filepath/path.go.html#3783242">Split</a></span><span class="op" id="7428687">(</span><span class="ident" id="7428688"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7428695">if</span>&nbsp;<span class="ident" id="7428698"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span>&nbsp;<span class="op" id="7428702">!=</span>&nbsp;<span class="string" id="7428705">&#34;&#34;</span>&nbsp;<span class="op" id="7428708">&amp;&amp;</span>&nbsp;<span class="ident" id="7428711"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428714">[</span><span class="builtinfunc" id="7428715">len</span><span class="op" id="7428718">(</span><span class="ident" id="7428719"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428722">)</span><span class="op" id="7428723">-</span><span class="num" id="7428724">1</span><span class="op" id="7428725">]</span>&nbsp;<span class="op" id="7428727">==</span>&nbsp;<span class="ident" id="7428730"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7428738">.</span><span class="ident" id="7428739"><a href="/gostd/path/filepath/path.go.html#3779295">Separator</a></span>&nbsp;<span class="op" id="7428749">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428753"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span>&nbsp;<span class="op" id="7428757">=</span>&nbsp;<span class="ident" id="7428759"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428762">[</span><span class="op" id="7428763">:</span><span class="builtinfunc" id="7428764">len</span><span class="op" id="7428767">(</span><span class="ident" id="7428768"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428771">)</span><span class="op" id="7428772">-</span><span class="num" id="7428773">1</span><span class="op" id="7428774">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428780"><a href="/gostd/net/http/cgi/host_test.go.html#7428298">h</a></span>&nbsp;<span class="op" id="7428782">=</span>&nbsp;<span class="op" id="7428784">&amp;</span><span class="ident" id="7428785"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7428792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428796"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7428800">:</span>&nbsp;<span class="ident" id="7428802"><a href="/gostd/net/http/cgi/host_test.go.html#7428119">perl</a></span><span class="op" id="7428806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428810"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7428814">:</span>&nbsp;<span class="string" id="7428816">&#34;/test.cgi&#34;</span><span class="op" id="7428827">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428831"><a href="/gostd/net/http/cgi/host.go.html#5696470">Args</a></span><span class="op" id="7428835">:</span>&nbsp;<span class="op" id="7428837">[</span><span class="op" id="7428838">]</span><span class="builtintype" id="7428839">string</span><span class="op" id="7428845">{</span><span class="ident" id="7428846"><a href="/gostd/net/http/cgi/host_test.go.html#7428065">cgifile</a></span><span class="op" id="7428853">}</span><span class="op" id="7428854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428858"><a href="/gostd/net/http/cgi/host.go.html#5696229">Env</a></span><span class="op" id="7428861">:</span>&nbsp;&nbsp;<span class="op" id="7428864">[</span><span class="op" id="7428865">]</span><span class="builtintype" id="7428866">string</span><span class="op" id="7428872">{</span><span class="string" id="7428873">&#34;SCRIPT_FILENAME=&#34;</span>&nbsp;<span class="op" id="7428892">+</span>&nbsp;<span class="ident" id="7428894"><a href="/gostd/net/http/cgi/host_test.go.html#7428065">cgifile</a></span><span class="op" id="7428901">}</span><span class="op" id="7428902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428908"><a href="/gostd/net/http/cgi/host_test.go.html#7428440">expectedMap</a></span>&nbsp;<span class="op" id="7428920">=</span>&nbsp;<span class="keyword" id="7428922">map</span><span class="op" id="7428925">[</span><span class="builtintype" id="7428926">string</span><span class="op" id="7428932">]</span><span class="builtintype" id="7428933">string</span><span class="op" id="7428939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7428943">&#34;cwd&#34;</span><span class="op" id="7428948">:</span>&nbsp;<span class="ident" id="7428950"><a href="/gostd/net/http/cgi/host_test.go.html#7428276">cwd</a></span><span class="op" id="7428953">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7428956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7428959"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7428969">(</span><span class="ident" id="7428970"><a href="/gostd/net/http/cgi/host_test.go.html#7427968">t</a></span><span class="op" id="7428971">,</span>&nbsp;<span class="ident" id="7428973"><a href="/gostd/net/http/cgi/host_test.go.html#7428298">h</a></span><span class="op" id="7428974">,</span>&nbsp;<span class="string" id="7428976">&#34;GET&nbsp;/test.cgi&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7429023">,</span>&nbsp;<span class="ident" id="7429025"><a href="/gostd/net/http/cgi/host_test.go.html#7428440">expectedMap</a></span><span class="op" id="7429036">)</span><br>
<span class="lineno"></span><span class="op" id="7429038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7429041">func</span>&nbsp;<span class="ident" id="7429046">TestEnvOverride</span><span class="op" id="7429061">(</span><span class="ident" id="7429062">t</span>&nbsp;<span class="op" id="7429064">*</span><span class="ident" id="7429065"><a href="/gostd/net/http/cgi/host_test.go.html#7418391">testing</a></span><span class="op" id="7429072">.</span><span class="ident" id="7429073"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7429074">)</span>&nbsp;<span class="op" id="7429076">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429079">cgifile</span><span class="op" id="7429086">,</span>&nbsp;<span class="ident" id="7429088">_</span>&nbsp;<span class="op" id="7429090">:=</span>&nbsp;<span class="ident" id="7429093"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7429101">.</span><span class="ident" id="7429102"><a href="/gostd/path/filepath/path.go.html#3784647">Abs</a></span><span class="op" id="7429105">(</span><span class="string" id="7429106">&#34;testdata/test.cgi&#34;</span><span class="op" id="7429125">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7429129">var</span>&nbsp;<span class="ident" id="7429133">perl</span>&nbsp;<span class="builtintype" id="7429138">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7429146">var</span>&nbsp;<span class="ident" id="7429150">err</span>&nbsp;<span class="builtintype" id="7429154">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429161"><a href="/gostd/net/http/cgi/host_test.go.html#7429133">perl</a></span><span class="op" id="7429165">,</span>&nbsp;<span class="ident" id="7429167"><a href="/gostd/net/http/cgi/host_test.go.html#7429150">err</a></span>&nbsp;<span class="op" id="7429171">=</span>&nbsp;<span class="ident" id="7429173"><a href="/gostd/net/http/cgi/host_test.go.html#7418330">exec</a></span><span class="op" id="7429177">.</span><span class="ident" id="7429178"><a href="/gostd/os/exec/lp_unix.go.html#5591524">LookPath</a></span><span class="op" id="7429186">(</span><span class="string" id="7429187">&#34;perl&#34;</span><span class="op" id="7429193">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7429196">if</span>&nbsp;<span class="ident" id="7429199"><a href="/gostd/net/http/cgi/host_test.go.html#7429150">err</a></span>&nbsp;<span class="op" id="7429203">!=</span>&nbsp;<span class="builtintype" id="7429206">nil</span>&nbsp;<span class="op" id="7429210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429214"><a href="/gostd/net/http/cgi/host_test.go.html#7429062">t</a></span><span class="op" id="7429215">.</span><span class="ident" id="7429216"><a href="/gostd/testing/testing.go.html#5480718">Skipf</a></span><span class="op" id="7429221">(</span><span class="string" id="7429222">&#34;Skipping&nbsp;test:&nbsp;perl&nbsp;not&nbsp;found.&#34;</span><span class="op" id="7429254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7429257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429260"><a href="/gostd/net/http/cgi/host_test.go.html#7429133">perl</a></span><span class="op" id="7429264">,</span>&nbsp;<span class="ident" id="7429266">_</span>&nbsp;<span class="op" id="7429268">=</span>&nbsp;<span class="ident" id="7429270"><a href="/gostd/net/http/cgi/host_test.go.html#7418341">filepath</a></span><span class="op" id="7429278">.</span><span class="ident" id="7429279"><a href="/gostd/path/filepath/path.go.html#3784647">Abs</a></span><span class="op" id="7429282">(</span><span class="ident" id="7429283"><a href="/gostd/net/http/cgi/host_test.go.html#7429133">perl</a></span><span class="op" id="7429287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429291">cwd</span><span class="op" id="7429294">,</span>&nbsp;<span class="ident" id="7429296">_</span>&nbsp;<span class="op" id="7429298">:=</span>&nbsp;<span class="ident" id="7429301"><a href="/gostd/net/http/cgi/host_test.go.html#7418324">os</a></span><span class="op" id="7429303">.</span><span class="ident" id="7429304"><a href="/gostd/os/getwd.go.html#2462017">Getwd</a></span><span class="op" id="7429309">(</span><span class="op" id="7429310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429313">h</span>&nbsp;<span class="op" id="7429315">:=</span>&nbsp;<span class="op" id="7429318">&amp;</span><span class="ident" id="7429319"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="7429326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429330"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="7429334">:</span>&nbsp;<span class="ident" id="7429336"><a href="/gostd/net/http/cgi/host_test.go.html#7429133">perl</a></span><span class="op" id="7429340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429344"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><span class="op" id="7429348">:</span>&nbsp;<span class="string" id="7429350">&#34;/test.cgi&#34;</span><span class="op" id="7429361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429365"><a href="/gostd/net/http/cgi/host.go.html#5696216">Dir</a></span><span class="op" id="7429368">:</span>&nbsp;&nbsp;<span class="ident" id="7429371"><a href="/gostd/net/http/cgi/host_test.go.html#7429291">cwd</a></span><span class="op" id="7429374">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429378"><a href="/gostd/net/http/cgi/host.go.html#5696470">Args</a></span><span class="op" id="7429382">:</span>&nbsp;<span class="op" id="7429384">[</span><span class="op" id="7429385">]</span><span class="builtintype" id="7429386">string</span><span class="op" id="7429392">{</span><span class="ident" id="7429393"><a href="/gostd/net/http/cgi/host_test.go.html#7429079">cgifile</a></span><span class="op" id="7429400">}</span><span class="op" id="7429401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429405"><a href="/gostd/net/http/cgi/host.go.html#5696229">Env</a></span><span class="op" id="7429408">:</span>&nbsp;<span class="op" id="7429410">[</span><span class="op" id="7429411">]</span><span class="builtintype" id="7429412">string</span><span class="op" id="7429418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429423">&#34;SCRIPT_FILENAME=&#34;</span>&nbsp;<span class="op" id="7429442">+</span>&nbsp;<span class="ident" id="7429444"><a href="/gostd/net/http/cgi/host_test.go.html#7429079">cgifile</a></span><span class="op" id="7429451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429456">&#34;REQUEST_URI=/foo/bar&#34;</span><span class="op" id="7429478">}</span><span class="op" id="7429479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7429482">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429485">expectedMap</span>&nbsp;<span class="op" id="7429497">:=</span>&nbsp;<span class="keyword" id="7429500">map</span><span class="op" id="7429503">[</span><span class="builtintype" id="7429504">string</span><span class="op" id="7429510">]</span><span class="builtintype" id="7429511">string</span><span class="op" id="7429517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429521">&#34;cwd&#34;</span><span class="op" id="7429526">:</span>&nbsp;<span class="ident" id="7429528"><a href="/gostd/net/http/cgi/host_test.go.html#7429291">cwd</a></span><span class="op" id="7429531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429535">&#34;env-SCRIPT_FILENAME&#34;</span><span class="op" id="7429556">:</span>&nbsp;<span class="ident" id="7429558"><a href="/gostd/net/http/cgi/host_test.go.html#7429079">cgifile</a></span><span class="op" id="7429565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429569">&#34;env-REQUEST_URI&#34;</span><span class="op" id="7429586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7429592">&#34;/foo/bar&#34;</span><span class="op" id="7429602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7429605">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7429608"><a href="/gostd/net/http/cgi/host_test.go.html#7418670">runCgiTest</a></span><span class="op" id="7429618">(</span><span class="ident" id="7429619"><a href="/gostd/net/http/cgi/host_test.go.html#7429062">t</a></span><span class="op" id="7429620">,</span>&nbsp;<span class="ident" id="7429622"><a href="/gostd/net/http/cgi/host_test.go.html#7429313">h</a></span><span class="op" id="7429623">,</span>&nbsp;<span class="string" id="7429625">&#34;GET&nbsp;/test.cgi&nbsp;HTTP/1.0\nHost:&nbsp;example.com\n\n&#34;</span><span class="op" id="7429672">,</span>&nbsp;<span class="ident" id="7429674"><a href="/gostd/net/http/cgi/host_test.go.html#7429485">expectedMap</a></span><span class="op" id="7429685">)</span><br>
<span class="lineno"></span><span class="op" id="7429687">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
