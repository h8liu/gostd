<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/printer</h2>
<ul>
<li><a href="/gostd/go/printer/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/printer/nodes.go.html" class="current">nodes.go</a></li>
<li><a href="/gostd/go/printer/performance_test.go.html">performance_test.go</a></li>
<li><a href="/gostd/go/printer/printer.go.html">printer.go</a></li>
<li><a href="/gostd/go/printer/printer_test.go.html">printer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5138063">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5138118">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5138172">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5138223">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;printing&nbsp;of&nbsp;AST&nbsp;nodes;&nbsp;specifically</span><br>
<span class="lineno"></span><span class="comment" id="5138283">//&nbsp;expressions,&nbsp;statements,&nbsp;declarations,&nbsp;and&nbsp;files.&nbsp;It&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5138344">//&nbsp;the&nbsp;print&nbsp;functionality&nbsp;implemented&nbsp;in&nbsp;printer.go.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5138399">package</span>&nbsp;<span class="ident" id="5138407">printer</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5138416">import</span>&nbsp;<span class="op" id="5138423">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138426">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138435">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138445">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138457">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5138472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138475">//&nbsp;Formatting&nbsp;issues:</span><br>
<span class="lineno"></span><span class="comment" id="5138497">//&nbsp;-&nbsp;better&nbsp;comment&nbsp;formatting&nbsp;for&nbsp;/*-style&nbsp;comments&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;(e.g.&nbsp;a&nbsp;declaration)</span><br>
<span class="lineno">20</span><span class="comment" id="5138592">//&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;comment&nbsp;spans&nbsp;multiple&nbsp;lines;&nbsp;if&nbsp;such&nbsp;a&nbsp;comment&nbsp;is&nbsp;just&nbsp;two&nbsp;lines,&nbsp;formatting&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5138687">//&nbsp;&nbsp;&nbsp;not&nbsp;idempotent</span><br>
<span class="lineno"></span><span class="comment" id="5138707">//&nbsp;-&nbsp;formatting&nbsp;of&nbsp;expression&nbsp;lists</span><br>
<span class="lineno"></span><span class="comment" id="5138743">//&nbsp;-&nbsp;should&nbsp;use&nbsp;blank&nbsp;instead&nbsp;of&nbsp;tab&nbsp;to&nbsp;separate&nbsp;one-line&nbsp;function&nbsp;bodies&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5138822">//&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;header&nbsp;unless&nbsp;there&nbsp;is&nbsp;a&nbsp;group&nbsp;of&nbsp;consecutive&nbsp;one-liners</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="5138898">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5138978">//&nbsp;Common&nbsp;AST&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139000">//&nbsp;Print&nbsp;as&nbsp;many&nbsp;newlines&nbsp;as&nbsp;necessary&nbsp;(but&nbsp;at&nbsp;least&nbsp;min&nbsp;newlines)&nbsp;to&nbsp;get&nbsp;to</span><br>
<span class="lineno">30</span><span class="comment" id="5139077">//&nbsp;the&nbsp;current&nbsp;line.&nbsp;ws&nbsp;is&nbsp;printed&nbsp;before&nbsp;the&nbsp;first&nbsp;line&nbsp;break.&nbsp;If&nbsp;newSection</span><br>
<span class="lineno"></span><span class="comment" id="5139155">//&nbsp;is&nbsp;set,&nbsp;the&nbsp;first&nbsp;line&nbsp;break&nbsp;is&nbsp;printed&nbsp;as&nbsp;formfeed.&nbsp;Returns&nbsp;true&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5139231">//&nbsp;line&nbsp;break&nbsp;was&nbsp;printed;&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5139283">//</span><br>
<span class="lineno"></span><span class="comment" id="5139286">//&nbsp;TODO(gri):&nbsp;linebreak&nbsp;may&nbsp;add&nbsp;too&nbsp;many&nbsp;lines&nbsp;if&nbsp;the&nbsp;next&nbsp;statement&nbsp;at&nbsp;&#34;line&#34;</span><br>
<span class="lineno">35</span><span class="comment" id="5139365">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;preceded&nbsp;by&nbsp;comments&nbsp;because&nbsp;the&nbsp;computation&nbsp;of&nbsp;n&nbsp;assumes</span><br>
<span class="lineno"></span><span class="comment" id="5139440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;position&nbsp;before&nbsp;the&nbsp;comment&nbsp;and&nbsp;the&nbsp;target&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5139518">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after&nbsp;the&nbsp;comment.&nbsp;Thus,&nbsp;after&nbsp;interspersing&nbsp;such&nbsp;comments,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5139596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;taken&nbsp;up&nbsp;by&nbsp;them&nbsp;is&nbsp;not&nbsp;considered&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5139675">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linebreaks.&nbsp;At&nbsp;the&nbsp;moment&nbsp;there&nbsp;is&nbsp;no&nbsp;easy&nbsp;way&nbsp;to&nbsp;know&nbsp;about</span><br>
<span class="lineno">40</span><span class="comment" id="5139750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;future&nbsp;(not&nbsp;yet&nbsp;interspersed)&nbsp;comments&nbsp;in&nbsp;this&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5139821">//</span><br>
<span class="lineno"></span><span class="keyword" id="5139824">func</span>&nbsp;<span class="op" id="5139829">(</span><span class="ident" id="5139830">p</span>&nbsp;<span class="op" id="5139832">*</span><span class="ident" id="5139833">printer</span><span class="op" id="5139840">)</span>&nbsp;<span class="ident" id="5139842">linebreak</span><span class="op" id="5139851">(</span><span class="ident" id="5139852">line</span><span class="op" id="5139856">,</span>&nbsp;<span class="ident" id="5139858">min</span>&nbsp;<span class="builtintype" id="5139862">int</span><span class="op" id="5139865">,</span>&nbsp;<span class="ident" id="5139867">ws</span>&nbsp;<span class="ident" id="5139870">whiteSpace</span><span class="op" id="5139880">,</span>&nbsp;<span class="ident" id="5139882">newSection</span>&nbsp;<span class="builtintype" id="5139893">bool</span><span class="op" id="5139897">)</span>&nbsp;<span class="op" id="5139899">(</span><span class="ident" id="5139900">printedBreak</span>&nbsp;<span class="builtintype" id="5139913">bool</span><span class="op" id="5139917">)</span>&nbsp;<span class="op" id="5139919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139922">n</span>&nbsp;<span class="op" id="5139924">:=</span>&nbsp;<span class="ident" id="5139927">nlimit</span><span class="op" id="5139933">(</span><span class="ident" id="5139934">line</span>&nbsp;<span class="op" id="5139939">-</span>&nbsp;<span class="ident" id="5139941">p</span><span class="op" id="5139942">.</span><span class="ident" id="5139943">pos</span><span class="op" id="5139946">.</span><span class="ident" id="5139947">Line</span><span class="op" id="5139951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139954">if</span>&nbsp;<span class="ident" id="5139957">n</span>&nbsp;<span class="op" id="5139959">&lt;</span>&nbsp;<span class="ident" id="5139961">min</span>&nbsp;<span class="op" id="5139965">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139969">n</span>&nbsp;<span class="op" id="5139971">=</span>&nbsp;<span class="ident" id="5139973">min</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139981">if</span>&nbsp;<span class="ident" id="5139984">n</span>&nbsp;<span class="op" id="5139986">&gt;</span>&nbsp;<span class="num" id="5139988">0</span>&nbsp;<span class="op" id="5139990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139994">p</span><span class="op" id="5139995">.</span><span class="builtinfunc" id="5139996">print</span><span class="op" id="5140001">(</span><span class="ident" id="5140002">ws</span><span class="op" id="5140004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140008">if</span>&nbsp;<span class="ident" id="5140011">newSection</span>&nbsp;<span class="op" id="5140022">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140027">p</span><span class="op" id="5140028">.</span><span class="builtinfunc" id="5140029">print</span><span class="op" id="5140034">(</span><span class="ident" id="5140035">formfeed</span><span class="op" id="5140043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140048">n</span><span class="op" id="5140049">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140058">for</span>&nbsp;<span class="op" id="5140062">;</span>&nbsp;<span class="ident" id="5140064">n</span>&nbsp;<span class="op" id="5140066">&gt;</span>&nbsp;<span class="num" id="5140068">0</span><span class="op" id="5140069">;</span>&nbsp;<span class="ident" id="5140071">n</span><span class="op" id="5140072">--</span>&nbsp;<span class="op" id="5140075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140080">p</span><span class="op" id="5140081">.</span><span class="builtinfunc" id="5140082">print</span><span class="op" id="5140087">(</span><span class="ident" id="5140088">newline</span><span class="op" id="5140095">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140103">printedBreak</span>&nbsp;<span class="op" id="5140116">=</span>&nbsp;<span class="builtintype" id="5140118">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140127">return</span><br>
<span class="lineno"></span><span class="op" id="5140134">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5140137">//&nbsp;setComment&nbsp;sets&nbsp;g&nbsp;as&nbsp;the&nbsp;next&nbsp;comment&nbsp;if&nbsp;g&nbsp;!=&nbsp;nil&nbsp;and&nbsp;if&nbsp;node&nbsp;comments</span><br>
<span class="lineno"></span><span class="comment" id="5140211">//&nbsp;are&nbsp;enabled&nbsp;-&nbsp;this&nbsp;mode&nbsp;is&nbsp;used&nbsp;when&nbsp;printing&nbsp;source&nbsp;code&nbsp;fragments&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5140287">//&nbsp;as&nbsp;exports&nbsp;only.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;pending&nbsp;comment&nbsp;in&nbsp;p.comments</span><br>
<span class="lineno"></span><span class="comment" id="5140365">//&nbsp;and&nbsp;at&nbsp;most&nbsp;one&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache.</span><br>
<span class="lineno">65</span><span class="keyword" id="5140424">func</span>&nbsp;<span class="op" id="5140429">(</span><span class="ident" id="5140430">p</span>&nbsp;<span class="op" id="5140432">*</span><span class="ident" id="5140433">printer</span><span class="op" id="5140440">)</span>&nbsp;<span class="ident" id="5140442">setComment</span><span class="op" id="5140452">(</span><span class="ident" id="5140453">g</span>&nbsp;<span class="op" id="5140455">*</span><span class="ident" id="5140456">ast</span><span class="op" id="5140459">.</span><span class="ident" id="5140460">CommentGroup</span><span class="op" id="5140472">)</span>&nbsp;<span class="op" id="5140474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140477">if</span>&nbsp;<span class="ident" id="5140480">g</span>&nbsp;<span class="op" id="5140482">==</span>&nbsp;<span class="ident" id="5140485">nil</span>&nbsp;<span class="op" id="5140489">||</span>&nbsp;<span class="op" id="5140492">!</span><span class="ident" id="5140493">p</span><span class="op" id="5140494">.</span><span class="ident" id="5140495">useNodeComments</span>&nbsp;<span class="op" id="5140511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140515">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140526">if</span>&nbsp;<span class="ident" id="5140529">p</span><span class="op" id="5140530">.</span><span class="ident" id="5140531">comments</span>&nbsp;<span class="op" id="5140540">==</span>&nbsp;<span class="ident" id="5140543">nil</span>&nbsp;<span class="op" id="5140547">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140551">//&nbsp;initialize&nbsp;p.comments&nbsp;lazily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140585">p</span><span class="op" id="5140586">.</span><span class="ident" id="5140587">comments</span>&nbsp;<span class="op" id="5140596">=</span>&nbsp;<span class="builtinfunc" id="5140598">make</span><span class="op" id="5140602">(</span><span class="op" id="5140603">[</span><span class="op" id="5140604">]</span><span class="op" id="5140605">*</span><span class="ident" id="5140606">ast</span><span class="op" id="5140609">.</span><span class="ident" id="5140610">CommentGroup</span><span class="op" id="5140622">,</span>&nbsp;<span class="num" id="5140624">1</span><span class="op" id="5140625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140628">}</span>&nbsp;<span class="keyword" id="5140630">else</span>&nbsp;<span class="keyword" id="5140635">if</span>&nbsp;<span class="ident" id="5140638">p</span><span class="op" id="5140639">.</span><span class="ident" id="5140640">cindex</span>&nbsp;<span class="op" id="5140647">&lt;</span>&nbsp;<span class="builtinfunc" id="5140649">len</span><span class="op" id="5140652">(</span><span class="ident" id="5140653">p</span><span class="op" id="5140654">.</span><span class="ident" id="5140655">comments</span><span class="op" id="5140663">)</span>&nbsp;<span class="op" id="5140665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140669">//&nbsp;for&nbsp;some&nbsp;reason&nbsp;there&nbsp;are&nbsp;pending&nbsp;comments;&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140723">//&nbsp;should&nbsp;never&nbsp;happen&nbsp;-&nbsp;handle&nbsp;gracefully&nbsp;and&nbsp;flush</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140778">//&nbsp;all&nbsp;comments&nbsp;up&nbsp;to&nbsp;g,&nbsp;ignore&nbsp;anything&nbsp;after&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140832">p</span><span class="op" id="5140833">.</span><span class="ident" id="5140834">flush</span><span class="op" id="5140839">(</span><span class="ident" id="5140840">p</span><span class="op" id="5140841">.</span><span class="ident" id="5140842">posFor</span><span class="op" id="5140848">(</span><span class="ident" id="5140849">g</span><span class="op" id="5140850">.</span><span class="ident" id="5140851">List</span><span class="op" id="5140855">[</span><span class="num" id="5140856">0</span><span class="op" id="5140857">]</span><span class="op" id="5140858">.</span><span class="ident" id="5140859">Pos</span><span class="op" id="5140862">(</span><span class="op" id="5140863">)</span><span class="op" id="5140864">)</span><span class="op" id="5140865">,</span>&nbsp;<span class="ident" id="5140867">token</span><span class="op" id="5140872">.</span><span class="ident" id="5140873">ILLEGAL</span><span class="op" id="5140880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140884">p</span><span class="op" id="5140885">.</span><span class="ident" id="5140886">comments</span>&nbsp;<span class="op" id="5140895">=</span>&nbsp;<span class="ident" id="5140897">p</span><span class="op" id="5140898">.</span><span class="ident" id="5140899">comments</span><span class="op" id="5140907">[</span><span class="num" id="5140908">0</span><span class="op" id="5140909">:</span><span class="num" id="5140910">1</span><span class="op" id="5140911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140915">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;report&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140948">p</span><span class="op" id="5140949">.</span><span class="ident" id="5140950">internalError</span><span class="op" id="5140963">(</span><span class="string" id="5140964">&#34;setComment&nbsp;found&nbsp;pending&nbsp;comments&#34;</span><span class="op" id="5140999">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141005">p</span><span class="op" id="5141006">.</span><span class="ident" id="5141007">comments</span><span class="op" id="5141015">[</span><span class="num" id="5141016">0</span><span class="op" id="5141017">]</span>&nbsp;<span class="op" id="5141019">=</span>&nbsp;<span class="ident" id="5141021">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141024">p</span><span class="op" id="5141025">.</span><span class="ident" id="5141026">cindex</span>&nbsp;<span class="op" id="5141033">=</span>&nbsp;<span class="num" id="5141035">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141038">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;any&nbsp;pending&nbsp;comment&nbsp;in&nbsp;the&nbsp;p.comment&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141101">//&nbsp;(there&nbsp;may&nbsp;be&nbsp;a&nbsp;pending&nbsp;comment&nbsp;when&nbsp;a&nbsp;line&nbsp;comment&nbsp;is</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141160">//&nbsp;immediately&nbsp;followed&nbsp;by&nbsp;a&nbsp;lead&nbsp;comment&nbsp;with&nbsp;no&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141217">//&nbsp;tokens&nbsp;between)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141237">if</span>&nbsp;<span class="ident" id="5141240">p</span><span class="op" id="5141241">.</span><span class="ident" id="5141242">commentOffset</span>&nbsp;<span class="op" id="5141256">==</span>&nbsp;<span class="ident" id="5141259">infinity</span>&nbsp;<span class="op" id="5141268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141272">p</span><span class="op" id="5141273">.</span><span class="ident" id="5141274">nextComment</span><span class="op" id="5141285">(</span><span class="op" id="5141286">)</span>&nbsp;<span class="comment" id="5141288">//&nbsp;get&nbsp;comment&nbsp;ready&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141318">}</span><br>
<span class="lineno">90</span><span class="op" id="5141320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5141323">type</span>&nbsp;<span class="ident" id="5141328">exprListMode</span>&nbsp;<span class="builtintype" id="5141341">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5141347">const</span>&nbsp;<span class="op" id="5141353">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141356">commaTerm</span>&nbsp;<span class="ident" id="5141366">exprListMode</span>&nbsp;<span class="op" id="5141379">=</span>&nbsp;<span class="num" id="5141381">1</span>&nbsp;<span class="op" id="5141383">&lt;&lt;</span>&nbsp;<span class="ident" id="5141386">iota</span>&nbsp;<span class="comment" id="5141391">//&nbsp;list&nbsp;is&nbsp;optionally&nbsp;terminated&nbsp;by&nbsp;a&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141436">noIndent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5141471">//&nbsp;no&nbsp;extra&nbsp;indentation&nbsp;in&nbsp;multi-line&nbsp;lists</span><br>
<span class="lineno"></span><span class="op" id="5141515">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5141518">//&nbsp;If&nbsp;indent&nbsp;is&nbsp;set,&nbsp;a&nbsp;multi-line&nbsp;identifier&nbsp;list&nbsp;is&nbsp;indented&nbsp;after&nbsp;the</span><br>
<span class="lineno">100</span><span class="comment" id="5141590">//&nbsp;first&nbsp;linebreak&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="5141622">func</span>&nbsp;<span class="op" id="5141627">(</span><span class="ident" id="5141628">p</span>&nbsp;<span class="op" id="5141630">*</span><span class="ident" id="5141631">printer</span><span class="op" id="5141638">)</span>&nbsp;<span class="ident" id="5141640">identList</span><span class="op" id="5141649">(</span><span class="ident" id="5141650">list</span>&nbsp;<span class="op" id="5141655">[</span><span class="op" id="5141656">]</span><span class="op" id="5141657">*</span><span class="ident" id="5141658">ast</span><span class="op" id="5141661">.</span><span class="ident" id="5141662">Ident</span><span class="op" id="5141667">,</span>&nbsp;<span class="ident" id="5141669">indent</span>&nbsp;<span class="builtintype" id="5141676">bool</span><span class="op" id="5141680">)</span>&nbsp;<span class="op" id="5141682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141685">//&nbsp;convert&nbsp;into&nbsp;an&nbsp;expression&nbsp;list&nbsp;so&nbsp;we&nbsp;can&nbsp;re-use&nbsp;exprList&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141758">xlist</span>&nbsp;<span class="op" id="5141764">:=</span>&nbsp;<span class="builtinfunc" id="5141767">make</span><span class="op" id="5141771">(</span><span class="op" id="5141772">[</span><span class="op" id="5141773">]</span><span class="ident" id="5141774">ast</span><span class="op" id="5141777">.</span><span class="ident" id="5141778">Expr</span><span class="op" id="5141782">,</span>&nbsp;<span class="builtinfunc" id="5141784">len</span><span class="op" id="5141787">(</span><span class="ident" id="5141788">list</span><span class="op" id="5141792">)</span><span class="op" id="5141793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141796">for</span>&nbsp;<span class="ident" id="5141800">i</span><span class="op" id="5141801">,</span>&nbsp;<span class="ident" id="5141803">x</span>&nbsp;<span class="op" id="5141805">:=</span>&nbsp;<span class="keyword" id="5141808">range</span>&nbsp;<span class="ident" id="5141814">list</span>&nbsp;<span class="op" id="5141819">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141823">xlist</span><span class="op" id="5141828">[</span><span class="ident" id="5141829">i</span><span class="op" id="5141830">]</span>&nbsp;<span class="op" id="5141832">=</span>&nbsp;<span class="ident" id="5141834">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141840">var</span>&nbsp;<span class="ident" id="5141844">mode</span>&nbsp;<span class="ident" id="5141849">exprListMode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141863">if</span>&nbsp;<span class="op" id="5141866">!</span><span class="ident" id="5141867">indent</span>&nbsp;<span class="op" id="5141874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141878">mode</span>&nbsp;<span class="op" id="5141883">=</span>&nbsp;<span class="ident" id="5141885">noIndent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141898">p</span><span class="op" id="5141899">.</span><span class="ident" id="5141900">exprList</span><span class="op" id="5141908">(</span><span class="ident" id="5141909">token</span><span class="op" id="5141914">.</span><span class="ident" id="5141915">NoPos</span><span class="op" id="5141920">,</span>&nbsp;<span class="ident" id="5141922">xlist</span><span class="op" id="5141927">,</span>&nbsp;<span class="num" id="5141929">1</span><span class="op" id="5141930">,</span>&nbsp;<span class="ident" id="5141932">mode</span><span class="op" id="5141936">,</span>&nbsp;<span class="ident" id="5141938">token</span><span class="op" id="5141943">.</span><span class="ident" id="5141944">NoPos</span><span class="op" id="5141949">)</span><br>
<span class="lineno"></span><span class="op" id="5141951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5141954">//&nbsp;Print&nbsp;a&nbsp;list&nbsp;of&nbsp;expressions.&nbsp;If&nbsp;the&nbsp;list&nbsp;spans&nbsp;multiple</span><br>
<span class="lineno">115</span><span class="comment" id="5142013">//&nbsp;source&nbsp;lines,&nbsp;the&nbsp;original&nbsp;line&nbsp;breaks&nbsp;are&nbsp;respected&nbsp;between</span><br>
<span class="lineno"></span><span class="comment" id="5142077">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="comment" id="5142093">//</span><br>
<span class="lineno"></span><span class="comment" id="5142096">//&nbsp;TODO(gri)&nbsp;Consider&nbsp;rewriting&nbsp;this&nbsp;to&nbsp;be&nbsp;independent&nbsp;of&nbsp;[]ast.Expr</span><br>
<span class="lineno"></span><span class="comment" id="5142165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;algorithm&nbsp;for&nbsp;any&nbsp;kind&nbsp;of&nbsp;list</span><br>
<span class="lineno">120</span><span class="comment" id="5142232">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;pass&nbsp;list&nbsp;via&nbsp;a&nbsp;channel&nbsp;over&nbsp;which&nbsp;to&nbsp;range).</span><br>
<span class="lineno"></span><span class="keyword" id="5142298">func</span>&nbsp;<span class="op" id="5142303">(</span><span class="ident" id="5142304">p</span>&nbsp;<span class="op" id="5142306">*</span><span class="ident" id="5142307">printer</span><span class="op" id="5142314">)</span>&nbsp;<span class="ident" id="5142316">exprList</span><span class="op" id="5142324">(</span><span class="ident" id="5142325">prev0</span>&nbsp;<span class="ident" id="5142331">token</span><span class="op" id="5142336">.</span><span class="ident" id="5142337">Pos</span><span class="op" id="5142340">,</span>&nbsp;<span class="ident" id="5142342">list</span>&nbsp;<span class="op" id="5142347">[</span><span class="op" id="5142348">]</span><span class="ident" id="5142349">ast</span><span class="op" id="5142352">.</span><span class="ident" id="5142353">Expr</span><span class="op" id="5142357">,</span>&nbsp;<span class="ident" id="5142359">depth</span>&nbsp;<span class="builtintype" id="5142365">int</span><span class="op" id="5142368">,</span>&nbsp;<span class="ident" id="5142370">mode</span>&nbsp;<span class="ident" id="5142375">exprListMode</span><span class="op" id="5142387">,</span>&nbsp;<span class="ident" id="5142389">next0</span>&nbsp;<span class="ident" id="5142395">token</span><span class="op" id="5142400">.</span><span class="ident" id="5142401">Pos</span><span class="op" id="5142404">)</span>&nbsp;<span class="op" id="5142406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142409">if</span>&nbsp;<span class="builtinfunc" id="5142412">len</span><span class="op" id="5142415">(</span><span class="ident" id="5142416">list</span><span class="op" id="5142420">)</span>&nbsp;<span class="op" id="5142422">==</span>&nbsp;<span class="num" id="5142425">0</span>&nbsp;<span class="op" id="5142427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142431">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142439">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142443">prev</span>&nbsp;<span class="op" id="5142448">:=</span>&nbsp;<span class="ident" id="5142451">p</span><span class="op" id="5142452">.</span><span class="ident" id="5142453">posFor</span><span class="op" id="5142459">(</span><span class="ident" id="5142460">prev0</span><span class="op" id="5142465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142468">next</span>&nbsp;<span class="op" id="5142473">:=</span>&nbsp;<span class="ident" id="5142476">p</span><span class="op" id="5142477">.</span><span class="ident" id="5142478">posFor</span><span class="op" id="5142484">(</span><span class="ident" id="5142485">next0</span><span class="op" id="5142490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142493">line</span>&nbsp;<span class="op" id="5142498">:=</span>&nbsp;<span class="ident" id="5142501">p</span><span class="op" id="5142502">.</span><span class="ident" id="5142503">lineFor</span><span class="op" id="5142510">(</span><span class="ident" id="5142511">list</span><span class="op" id="5142515">[</span><span class="num" id="5142516">0</span><span class="op" id="5142517">]</span><span class="op" id="5142518">.</span><span class="ident" id="5142519">Pos</span><span class="op" id="5142522">(</span><span class="op" id="5142523">)</span><span class="op" id="5142524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142527">endLine</span>&nbsp;<span class="op" id="5142535">:=</span>&nbsp;<span class="ident" id="5142538">p</span><span class="op" id="5142539">.</span><span class="ident" id="5142540">lineFor</span><span class="op" id="5142547">(</span><span class="ident" id="5142548">list</span><span class="op" id="5142552">[</span><span class="builtinfunc" id="5142553">len</span><span class="op" id="5142556">(</span><span class="ident" id="5142557">list</span><span class="op" id="5142561">)</span><span class="op" id="5142562">-</span><span class="num" id="5142563">1</span><span class="op" id="5142564">]</span><span class="op" id="5142565">.</span><span class="ident" id="5142566">End</span><span class="op" id="5142569">(</span><span class="op" id="5142570">)</span><span class="op" id="5142571">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142575">if</span>&nbsp;<span class="ident" id="5142578">prev</span><span class="op" id="5142582">.</span><span class="ident" id="5142583">IsValid</span><span class="op" id="5142590">(</span><span class="op" id="5142591">)</span>&nbsp;<span class="op" id="5142593">&amp;&amp;</span>&nbsp;<span class="ident" id="5142596">prev</span><span class="op" id="5142600">.</span><span class="ident" id="5142601">Line</span>&nbsp;<span class="op" id="5142606">==</span>&nbsp;<span class="ident" id="5142609">line</span>&nbsp;<span class="op" id="5142614">&amp;&amp;</span>&nbsp;<span class="ident" id="5142617">line</span>&nbsp;<span class="op" id="5142622">==</span>&nbsp;<span class="ident" id="5142625">endLine</span>&nbsp;<span class="op" id="5142633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142637">//&nbsp;all&nbsp;list&nbsp;entries&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142676">for</span>&nbsp;<span class="ident" id="5142680">i</span><span class="op" id="5142681">,</span>&nbsp;<span class="ident" id="5142683">x</span>&nbsp;<span class="op" id="5142685">:=</span>&nbsp;<span class="keyword" id="5142688">range</span>&nbsp;<span class="ident" id="5142694">list</span>&nbsp;<span class="op" id="5142699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142704">if</span>&nbsp;<span class="ident" id="5142707">i</span>&nbsp;<span class="op" id="5142709">&gt;</span>&nbsp;<span class="num" id="5142711">0</span>&nbsp;<span class="op" id="5142713">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142719">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142776">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142828">p</span><span class="op" id="5142829">.</span><span class="builtinfunc" id="5142830">print</span><span class="op" id="5142835">(</span><span class="ident" id="5142836">x</span><span class="op" id="5142837">.</span><span class="ident" id="5142838">Pos</span><span class="op" id="5142841">(</span><span class="op" id="5142842">)</span><span class="op" id="5142843">,</span>&nbsp;<span class="ident" id="5142845">token</span><span class="op" id="5142850">.</span><span class="ident" id="5142851">COMMA</span><span class="op" id="5142856">,</span>&nbsp;<span class="ident" id="5142858">blank</span><span class="op" id="5142863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142873">p</span><span class="op" id="5142874">.</span><span class="ident" id="5142875">expr0</span><span class="op" id="5142880">(</span><span class="ident" id="5142881">x</span><span class="op" id="5142882">,</span>&nbsp;<span class="ident" id="5142884">depth</span><span class="op" id="5142889">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142897">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142909">//&nbsp;list&nbsp;entries&nbsp;span&nbsp;multiple&nbsp;lines;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142947">//&nbsp;use&nbsp;source&nbsp;code&nbsp;positions&nbsp;to&nbsp;guide&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142999">//&nbsp;don&#39;t&nbsp;add&nbsp;extra&nbsp;indentation&nbsp;if&nbsp;noIndent&nbsp;is&nbsp;set;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143051">//&nbsp;i.e.,&nbsp;pretend&nbsp;that&nbsp;the&nbsp;first&nbsp;line&nbsp;is&nbsp;already&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143109">ws</span>&nbsp;<span class="op" id="5143112">:=</span>&nbsp;<span class="ident" id="5143115">ignore</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143123">if</span>&nbsp;<span class="ident" id="5143126">mode</span><span class="op" id="5143130">&amp;</span><span class="ident" id="5143131">noIndent</span>&nbsp;<span class="op" id="5143140">==</span>&nbsp;<span class="num" id="5143143">0</span>&nbsp;<span class="op" id="5143145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143149">ws</span>&nbsp;<span class="op" id="5143152">=</span>&nbsp;<span class="ident" id="5143154">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143166">//&nbsp;the&nbsp;first&nbsp;linebreak&nbsp;is&nbsp;always&nbsp;a&nbsp;formfeed&nbsp;since&nbsp;this&nbsp;section&nbsp;must&nbsp;not</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143239">//&nbsp;depend&nbsp;on&nbsp;any&nbsp;previous&nbsp;formatting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143277">prevBreak</span>&nbsp;<span class="op" id="5143287">:=</span>&nbsp;<span class="op" id="5143290">-</span><span class="num" id="5143291">1</span>&nbsp;<span class="comment" id="5143293">//&nbsp;index&nbsp;of&nbsp;last&nbsp;expression&nbsp;that&nbsp;was&nbsp;followed&nbsp;by&nbsp;a&nbsp;linebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143355">if</span>&nbsp;<span class="ident" id="5143358">prev</span><span class="op" id="5143362">.</span><span class="ident" id="5143363">IsValid</span><span class="op" id="5143370">(</span><span class="op" id="5143371">)</span>&nbsp;<span class="op" id="5143373">&amp;&amp;</span>&nbsp;<span class="ident" id="5143376">prev</span><span class="op" id="5143380">.</span><span class="ident" id="5143381">Line</span>&nbsp;<span class="op" id="5143386">&lt;</span>&nbsp;<span class="ident" id="5143388">line</span>&nbsp;<span class="op" id="5143393">&amp;&amp;</span>&nbsp;<span class="ident" id="5143396">p</span><span class="op" id="5143397">.</span><span class="ident" id="5143398">linebreak</span><span class="op" id="5143407">(</span><span class="ident" id="5143408">line</span><span class="op" id="5143412">,</span>&nbsp;<span class="num" id="5143414">0</span><span class="op" id="5143415">,</span>&nbsp;<span class="ident" id="5143417">ws</span><span class="op" id="5143419">,</span>&nbsp;<span class="builtintype" id="5143421">true</span><span class="op" id="5143425">)</span>&nbsp;<span class="op" id="5143427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143431">ws</span>&nbsp;<span class="op" id="5143434">=</span>&nbsp;<span class="ident" id="5143436">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143445">prevBreak</span>&nbsp;<span class="op" id="5143455">=</span>&nbsp;<span class="num" id="5143457">0</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143464">//&nbsp;initialize&nbsp;expression/key&nbsp;size:&nbsp;a&nbsp;zero&nbsp;value&nbsp;indicates&nbsp;expr/key&nbsp;doesn&#39;t&nbsp;fit&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143561">size</span>&nbsp;<span class="op" id="5143566">:=</span>&nbsp;<span class="num" id="5143569">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143573">//&nbsp;print&nbsp;all&nbsp;list&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143601">prevLine</span>&nbsp;<span class="op" id="5143610">:=</span>&nbsp;<span class="ident" id="5143613">prev</span><span class="op" id="5143617">.</span><span class="ident" id="5143618">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143624">for</span>&nbsp;<span class="ident" id="5143628">i</span><span class="op" id="5143629">,</span>&nbsp;<span class="ident" id="5143631">x</span>&nbsp;<span class="op" id="5143633">:=</span>&nbsp;<span class="keyword" id="5143636">range</span>&nbsp;<span class="ident" id="5143642">list</span>&nbsp;<span class="op" id="5143647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143651">line</span>&nbsp;<span class="op" id="5143656">=</span>&nbsp;<span class="ident" id="5143658">p</span><span class="op" id="5143659">.</span><span class="ident" id="5143660">lineFor</span><span class="op" id="5143667">(</span><span class="ident" id="5143668">x</span><span class="op" id="5143669">.</span><span class="ident" id="5143670">Pos</span><span class="op" id="5143673">(</span><span class="op" id="5143674">)</span><span class="op" id="5143675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143680">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;next&nbsp;linebreak,&nbsp;if&nbsp;any,&nbsp;needs&nbsp;to&nbsp;use&nbsp;formfeed:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143749">//&nbsp;in&nbsp;general,&nbsp;use&nbsp;the&nbsp;entire&nbsp;node&nbsp;size&nbsp;to&nbsp;make&nbsp;the&nbsp;decision;&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143817">//&nbsp;key:value&nbsp;expressions,&nbsp;use&nbsp;the&nbsp;key&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143862">//&nbsp;TODO(gri)&nbsp;for&nbsp;a&nbsp;better&nbsp;result,&nbsp;should&nbsp;probably&nbsp;incorporate&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143931">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;key&nbsp;and&nbsp;the&nbsp;node&nbsp;size&nbsp;into&nbsp;the&nbsp;decision&nbsp;process</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143998">useFF</span>&nbsp;<span class="op" id="5144004">:=</span>&nbsp;<span class="builtintype" id="5144007">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144015">//&nbsp;determine&nbsp;element&nbsp;size:&nbsp;all&nbsp;bets&nbsp;are&nbsp;off&nbsp;if&nbsp;we&nbsp;don&#39;t&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144078">//&nbsp;position&nbsp;information&nbsp;for&nbsp;the&nbsp;previous&nbsp;and&nbsp;next&nbsp;token&nbsp;(likely</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144144">//&nbsp;generated&nbsp;code&nbsp;-&nbsp;simply&nbsp;ignore&nbsp;the&nbsp;size&nbsp;in&nbsp;this&nbsp;case&nbsp;by&nbsp;setting</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144213">//&nbsp;it&nbsp;to&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144227">prevSize</span>&nbsp;<span class="op" id="5144236">:=</span>&nbsp;<span class="ident" id="5144239">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144246">const</span>&nbsp;<span class="ident" id="5144252">infinity</span>&nbsp;<span class="op" id="5144261">=</span>&nbsp;<span class="num" id="5144263">1e6</span>&nbsp;<span class="comment" id="5144267">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;source&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144300">size</span>&nbsp;<span class="op" id="5144305">=</span>&nbsp;<span class="ident" id="5144307">p</span><span class="op" id="5144308">.</span><span class="ident" id="5144309">nodeSize</span><span class="op" id="5144317">(</span><span class="ident" id="5144318">x</span><span class="op" id="5144319">,</span>&nbsp;<span class="ident" id="5144321">infinity</span><span class="op" id="5144329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144333">pair</span><span class="op" id="5144337">,</span>&nbsp;<span class="ident" id="5144339">isPair</span>&nbsp;<span class="op" id="5144346">:=</span>&nbsp;<span class="ident" id="5144349">x</span><span class="op" id="5144350">.</span><span class="op" id="5144351">(</span><span class="op" id="5144352">*</span><span class="ident" id="5144353">ast</span><span class="op" id="5144356">.</span><span class="ident" id="5144357">KeyValueExpr</span><span class="op" id="5144369">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144373">if</span>&nbsp;<span class="ident" id="5144376">size</span>&nbsp;<span class="op" id="5144381">&lt;=</span>&nbsp;<span class="ident" id="5144384">infinity</span>&nbsp;<span class="op" id="5144393">&amp;&amp;</span>&nbsp;<span class="ident" id="5144396">prev</span><span class="op" id="5144400">.</span><span class="ident" id="5144401">IsValid</span><span class="op" id="5144408">(</span><span class="op" id="5144409">)</span>&nbsp;<span class="op" id="5144411">&amp;&amp;</span>&nbsp;<span class="ident" id="5144414">next</span><span class="op" id="5144418">.</span><span class="ident" id="5144419">IsValid</span><span class="op" id="5144426">(</span><span class="op" id="5144427">)</span>&nbsp;<span class="op" id="5144429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144434">//&nbsp;x&nbsp;fits&nbsp;on&nbsp;a&nbsp;single&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144464">if</span>&nbsp;<span class="ident" id="5144467">isPair</span>&nbsp;<span class="op" id="5144474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144480">size</span>&nbsp;<span class="op" id="5144485">=</span>&nbsp;<span class="ident" id="5144487">p</span><span class="op" id="5144488">.</span><span class="ident" id="5144489">nodeSize</span><span class="op" id="5144497">(</span><span class="ident" id="5144498">pair</span><span class="op" id="5144502">.</span><span class="ident" id="5144503">Key</span><span class="op" id="5144506">,</span>&nbsp;<span class="ident" id="5144508">infinity</span><span class="op" id="5144516">)</span>&nbsp;<span class="comment" id="5144518">//&nbsp;size&nbsp;&lt;=&nbsp;infinity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144541">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144545">}</span>&nbsp;<span class="keyword" id="5144547">else</span>&nbsp;<span class="op" id="5144552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144557">//&nbsp;size&nbsp;too&nbsp;large&nbsp;or&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;good&nbsp;layout&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144619">size</span>&nbsp;<span class="op" id="5144624">=</span>&nbsp;<span class="num" id="5144626">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144635">//&nbsp;if&nbsp;the&nbsp;previous&nbsp;line&nbsp;and&nbsp;the&nbsp;current&nbsp;line&nbsp;had&nbsp;single-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144694">//&nbsp;line-expressions&nbsp;and&nbsp;the&nbsp;key&nbsp;sizes&nbsp;are&nbsp;small&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144751">//&nbsp;the&nbsp;ratio&nbsp;between&nbsp;the&nbsp;key&nbsp;sizes&nbsp;does&nbsp;not&nbsp;exceed&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144806">//&nbsp;threshold,&nbsp;align&nbsp;columns&nbsp;and&nbsp;do&nbsp;not&nbsp;use&nbsp;formfeed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144860">if</span>&nbsp;<span class="ident" id="5144863">prevSize</span>&nbsp;<span class="op" id="5144872">&gt;</span>&nbsp;<span class="num" id="5144874">0</span>&nbsp;<span class="op" id="5144876">&amp;&amp;</span>&nbsp;<span class="ident" id="5144879">size</span>&nbsp;<span class="op" id="5144884">&gt;</span>&nbsp;<span class="num" id="5144886">0</span>&nbsp;<span class="op" id="5144888">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144893">const</span>&nbsp;<span class="ident" id="5144899">smallSize</span>&nbsp;<span class="op" id="5144909">=</span>&nbsp;<span class="num" id="5144911">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144917">if</span>&nbsp;<span class="ident" id="5144920">prevSize</span>&nbsp;<span class="op" id="5144929">&lt;=</span>&nbsp;<span class="ident" id="5144932">smallSize</span>&nbsp;<span class="op" id="5144942">&amp;&amp;</span>&nbsp;<span class="ident" id="5144945">size</span>&nbsp;<span class="op" id="5144950">&lt;=</span>&nbsp;<span class="ident" id="5144953">smallSize</span>&nbsp;<span class="op" id="5144963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144969">useFF</span>&nbsp;<span class="op" id="5144975">=</span>&nbsp;<span class="builtintype" id="5144977">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144986">}</span>&nbsp;<span class="keyword" id="5144988">else</span>&nbsp;<span class="op" id="5144993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144999">const</span>&nbsp;<span class="ident" id="5145005">r</span>&nbsp;<span class="op" id="5145007">=</span>&nbsp;<span class="num" id="5145009">4</span>&nbsp;<span class="comment" id="5145011">//&nbsp;threshold</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145028">ratio</span>&nbsp;<span class="op" id="5145034">:=</span>&nbsp;<span class="builtintype" id="5145037">float64</span><span class="op" id="5145044">(</span><span class="ident" id="5145045">size</span><span class="op" id="5145049">)</span>&nbsp;<span class="op" id="5145051">/</span>&nbsp;<span class="builtintype" id="5145053">float64</span><span class="op" id="5145060">(</span><span class="ident" id="5145061">prevSize</span><span class="op" id="5145069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145075">useFF</span>&nbsp;<span class="op" id="5145081">=</span>&nbsp;<span class="ident" id="5145083">ratio</span>&nbsp;<span class="op" id="5145089">&lt;=</span>&nbsp;<span class="num" id="5145092">1.0</span><span class="op" id="5145095">/</span><span class="ident" id="5145096">r</span>&nbsp;<span class="op" id="5145098">||</span>&nbsp;<span class="ident" id="5145101">r</span>&nbsp;<span class="op" id="5145103">&lt;=</span>&nbsp;<span class="ident" id="5145106">ratio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145124">needsLinebreak</span>&nbsp;<span class="op" id="5145139">:=</span>&nbsp;<span class="num" id="5145142">0</span>&nbsp;<span class="op" id="5145144">&lt;</span>&nbsp;<span class="ident" id="5145146">prevLine</span>&nbsp;<span class="op" id="5145155">&amp;&amp;</span>&nbsp;<span class="ident" id="5145158">prevLine</span>&nbsp;<span class="op" id="5145167">&lt;</span>&nbsp;<span class="ident" id="5145169">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145176">if</span>&nbsp;<span class="ident" id="5145179">i</span>&nbsp;<span class="op" id="5145181">&gt;</span>&nbsp;<span class="num" id="5145183">0</span>&nbsp;<span class="op" id="5145185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145190">//&nbsp;use&nbsp;position&nbsp;of&nbsp;expression&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145246">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145302">//&nbsp;only&nbsp;if&nbsp;the&nbsp;expression&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145351">if</span>&nbsp;<span class="op" id="5145354">!</span><span class="ident" id="5145355">needsLinebreak</span>&nbsp;<span class="op" id="5145370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145376">p</span><span class="op" id="5145377">.</span><span class="builtinfunc" id="5145378">print</span><span class="op" id="5145383">(</span><span class="ident" id="5145384">x</span><span class="op" id="5145385">.</span><span class="ident" id="5145386">Pos</span><span class="op" id="5145389">(</span><span class="op" id="5145390">)</span><span class="op" id="5145391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145401">p</span><span class="op" id="5145402">.</span><span class="builtinfunc" id="5145403">print</span><span class="op" id="5145408">(</span><span class="ident" id="5145409">token</span><span class="op" id="5145414">.</span><span class="ident" id="5145415">COMMA</span><span class="op" id="5145420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145425">needsBlank</span>&nbsp;<span class="op" id="5145436">:=</span>&nbsp;<span class="builtintype" id="5145439">true</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145447">if</span>&nbsp;<span class="ident" id="5145450">needsLinebreak</span>&nbsp;<span class="op" id="5145465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145471">//&nbsp;lines&nbsp;are&nbsp;broken&nbsp;using&nbsp;newlines&nbsp;so&nbsp;comments&nbsp;remain&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145537">//&nbsp;unless&nbsp;forceFF&nbsp;is&nbsp;set&nbsp;or&nbsp;there&nbsp;are&nbsp;multiple&nbsp;expressions&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145603">//&nbsp;the&nbsp;same&nbsp;line&nbsp;in&nbsp;which&nbsp;case&nbsp;formfeed&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145655">if</span>&nbsp;<span class="ident" id="5145658">p</span><span class="op" id="5145659">.</span><span class="ident" id="5145660">linebreak</span><span class="op" id="5145669">(</span><span class="ident" id="5145670">line</span><span class="op" id="5145674">,</span>&nbsp;<span class="num" id="5145676">0</span><span class="op" id="5145677">,</span>&nbsp;<span class="ident" id="5145679">ws</span><span class="op" id="5145681">,</span>&nbsp;<span class="ident" id="5145683">useFF</span>&nbsp;<span class="op" id="5145689">||</span>&nbsp;<span class="ident" id="5145692">prevBreak</span><span class="op" id="5145701">+</span><span class="num" id="5145702">1</span>&nbsp;<span class="op" id="5145704">&lt;</span>&nbsp;<span class="ident" id="5145706">i</span><span class="op" id="5145707">)</span>&nbsp;<span class="op" id="5145709">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145716">ws</span>&nbsp;<span class="op" id="5145719">=</span>&nbsp;<span class="ident" id="5145721">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145733">prevBreak</span>&nbsp;<span class="op" id="5145743">=</span>&nbsp;<span class="ident" id="5145745">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145752">needsBlank</span>&nbsp;<span class="op" id="5145763">=</span>&nbsp;<span class="builtintype" id="5145765">false</span>&nbsp;<span class="comment" id="5145771">//&nbsp;we&nbsp;got&nbsp;a&nbsp;line&nbsp;break&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145811">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145816">if</span>&nbsp;<span class="ident" id="5145819">needsBlank</span>&nbsp;<span class="op" id="5145830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145836">p</span><span class="op" id="5145837">.</span><span class="builtinfunc" id="5145838">print</span><span class="op" id="5145843">(</span><span class="ident" id="5145844">blank</span><span class="op" id="5145849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5145858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145863">if</span>&nbsp;<span class="builtinfunc" id="5145866">len</span><span class="op" id="5145869">(</span><span class="ident" id="5145870">list</span><span class="op" id="5145874">)</span>&nbsp;<span class="op" id="5145876">&gt;</span>&nbsp;<span class="num" id="5145878">1</span>&nbsp;<span class="op" id="5145880">&amp;&amp;</span>&nbsp;<span class="ident" id="5145883">isPair</span>&nbsp;<span class="op" id="5145890">&amp;&amp;</span>&nbsp;<span class="ident" id="5145893">size</span>&nbsp;<span class="op" id="5145898">&gt;</span>&nbsp;<span class="num" id="5145900">0</span>&nbsp;<span class="op" id="5145902">&amp;&amp;</span>&nbsp;<span class="ident" id="5145905">needsLinebreak</span>&nbsp;<span class="op" id="5145920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145925">//&nbsp;we&nbsp;have&nbsp;a&nbsp;key:value&nbsp;expression&nbsp;that&nbsp;fits&nbsp;onto&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145986">//&nbsp;and&nbsp;it&#39;s&nbsp;not&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;prior&nbsp;expression:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146047">//&nbsp;use&nbsp;a&nbsp;column&nbsp;for&nbsp;the&nbsp;key&nbsp;such&nbsp;that&nbsp;consecutive&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146108">//&nbsp;can&nbsp;align&nbsp;if&nbsp;possible</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146136">//&nbsp;(needsLinebreak&nbsp;is&nbsp;set&nbsp;if&nbsp;we&nbsp;started&nbsp;a&nbsp;new&nbsp;line&nbsp;before)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146198">p</span><span class="op" id="5146199">.</span><span class="ident" id="5146200">expr</span><span class="op" id="5146204">(</span><span class="ident" id="5146205">pair</span><span class="op" id="5146209">.</span><span class="ident" id="5146210">Key</span><span class="op" id="5146213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146218">p</span><span class="op" id="5146219">.</span><span class="builtinfunc" id="5146220">print</span><span class="op" id="5146225">(</span><span class="ident" id="5146226">pair</span><span class="op" id="5146230">.</span><span class="ident" id="5146231">Colon</span><span class="op" id="5146236">,</span>&nbsp;<span class="ident" id="5146238">token</span><span class="op" id="5146243">.</span><span class="ident" id="5146244">COLON</span><span class="op" id="5146249">,</span>&nbsp;<span class="ident" id="5146251">vtab</span><span class="op" id="5146255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146260">p</span><span class="op" id="5146261">.</span><span class="ident" id="5146262">expr</span><span class="op" id="5146266">(</span><span class="ident" id="5146267">pair</span><span class="op" id="5146271">.</span><span class="ident" id="5146272">Value</span><span class="op" id="5146277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146281">}</span>&nbsp;<span class="keyword" id="5146283">else</span>&nbsp;<span class="op" id="5146288">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146293">p</span><span class="op" id="5146294">.</span><span class="ident" id="5146295">expr0</span><span class="op" id="5146300">(</span><span class="ident" id="5146301">x</span><span class="op" id="5146302">,</span>&nbsp;<span class="ident" id="5146304">depth</span><span class="op" id="5146309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146318">prevLine</span>&nbsp;<span class="op" id="5146327">=</span>&nbsp;<span class="ident" id="5146329">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146335">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146339">if</span>&nbsp;<span class="ident" id="5146342">mode</span><span class="op" id="5146346">&amp;</span><span class="ident" id="5146347">commaTerm</span>&nbsp;<span class="op" id="5146357">!=</span>&nbsp;<span class="num" id="5146360">0</span>&nbsp;<span class="op" id="5146362">&amp;&amp;</span>&nbsp;<span class="ident" id="5146365">next</span><span class="op" id="5146369">.</span><span class="ident" id="5146370">IsValid</span><span class="op" id="5146377">(</span><span class="op" id="5146378">)</span>&nbsp;<span class="op" id="5146380">&amp;&amp;</span>&nbsp;<span class="ident" id="5146383">p</span><span class="op" id="5146384">.</span><span class="ident" id="5146385">pos</span><span class="op" id="5146388">.</span><span class="ident" id="5146389">Line</span>&nbsp;<span class="op" id="5146394">&lt;</span>&nbsp;<span class="ident" id="5146396">next</span><span class="op" id="5146400">.</span><span class="ident" id="5146401">Line</span>&nbsp;<span class="op" id="5146406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146410">//&nbsp;print&nbsp;a&nbsp;terminating&nbsp;comma&nbsp;if&nbsp;the&nbsp;next&nbsp;token&nbsp;is&nbsp;on&nbsp;a&nbsp;new&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146476">p</span><span class="op" id="5146477">.</span><span class="builtinfunc" id="5146478">print</span><span class="op" id="5146483">(</span><span class="ident" id="5146484">token</span><span class="op" id="5146489">.</span><span class="ident" id="5146490">COMMA</span><span class="op" id="5146495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146499">if</span>&nbsp;<span class="ident" id="5146502">ws</span>&nbsp;<span class="op" id="5146505">==</span>&nbsp;<span class="ident" id="5146508">ignore</span>&nbsp;<span class="op" id="5146515">&amp;&amp;</span>&nbsp;<span class="ident" id="5146518">mode</span><span class="op" id="5146522">&amp;</span><span class="ident" id="5146523">noIndent</span>&nbsp;<span class="op" id="5146532">==</span>&nbsp;<span class="num" id="5146535">0</span>&nbsp;<span class="op" id="5146537">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146542">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146572">p</span><span class="op" id="5146573">.</span><span class="builtinfunc" id="5146574">print</span><span class="op" id="5146579">(</span><span class="ident" id="5146580">unindent</span><span class="op" id="5146588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146596">p</span><span class="op" id="5146597">.</span><span class="builtinfunc" id="5146598">print</span><span class="op" id="5146603">(</span><span class="ident" id="5146604">formfeed</span><span class="op" id="5146612">)</span>&nbsp;<span class="comment" id="5146614">//&nbsp;terminating&nbsp;comma&nbsp;needs&nbsp;a&nbsp;line&nbsp;break&nbsp;to&nbsp;look&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146669">return</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146681">if</span>&nbsp;<span class="ident" id="5146684">ws</span>&nbsp;<span class="op" id="5146687">==</span>&nbsp;<span class="ident" id="5146690">ignore</span>&nbsp;<span class="op" id="5146697">&amp;&amp;</span>&nbsp;<span class="ident" id="5146700">mode</span><span class="op" id="5146704">&amp;</span><span class="ident" id="5146705">noIndent</span>&nbsp;<span class="op" id="5146714">==</span>&nbsp;<span class="num" id="5146717">0</span>&nbsp;<span class="op" id="5146719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146723">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146752">p</span><span class="op" id="5146753">.</span><span class="builtinfunc" id="5146754">print</span><span class="op" id="5146759">(</span><span class="ident" id="5146760">unindent</span><span class="op" id="5146768">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5146771">}</span><br>
<span class="lineno"></span><span class="op" id="5146773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5146776">func</span>&nbsp;<span class="op" id="5146781">(</span><span class="ident" id="5146782">p</span>&nbsp;<span class="op" id="5146784">*</span><span class="ident" id="5146785">printer</span><span class="op" id="5146792">)</span>&nbsp;<span class="ident" id="5146794">parameters</span><span class="op" id="5146804">(</span><span class="ident" id="5146805">fields</span>&nbsp;<span class="op" id="5146812">*</span><span class="ident" id="5146813">ast</span><span class="op" id="5146816">.</span><span class="ident" id="5146817">FieldList</span><span class="op" id="5146826">)</span>&nbsp;<span class="op" id="5146828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146831">p</span><span class="op" id="5146832">.</span><span class="builtinfunc" id="5146833">print</span><span class="op" id="5146838">(</span><span class="ident" id="5146839">fields</span><span class="op" id="5146845">.</span><span class="ident" id="5146846">Opening</span><span class="op" id="5146853">,</span>&nbsp;<span class="ident" id="5146855">token</span><span class="op" id="5146860">.</span><span class="ident" id="5146861">LPAREN</span><span class="op" id="5146867">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146870">if</span>&nbsp;<span class="builtinfunc" id="5146873">len</span><span class="op" id="5146876">(</span><span class="ident" id="5146877">fields</span><span class="op" id="5146883">.</span><span class="ident" id="5146884">List</span><span class="op" id="5146888">)</span>&nbsp;<span class="op" id="5146890">&gt;</span>&nbsp;<span class="num" id="5146892">0</span>&nbsp;<span class="op" id="5146894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146898">prevLine</span>&nbsp;<span class="op" id="5146907">:=</span>&nbsp;<span class="ident" id="5146910">p</span><span class="op" id="5146911">.</span><span class="ident" id="5146912">lineFor</span><span class="op" id="5146919">(</span><span class="ident" id="5146920">fields</span><span class="op" id="5146926">.</span><span class="ident" id="5146927">Opening</span><span class="op" id="5146934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146938">ws</span>&nbsp;<span class="op" id="5146941">:=</span>&nbsp;<span class="ident" id="5146944">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5146953">for</span>&nbsp;<span class="ident" id="5146957">i</span><span class="op" id="5146958">,</span>&nbsp;<span class="ident" id="5146960">par</span>&nbsp;<span class="op" id="5146964">:=</span>&nbsp;<span class="keyword" id="5146967">range</span>&nbsp;<span class="ident" id="5146973">fields</span><span class="op" id="5146979">.</span><span class="ident" id="5146980">List</span>&nbsp;<span class="op" id="5146985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146990">//&nbsp;determine&nbsp;par&nbsp;begin&nbsp;and&nbsp;end&nbsp;line&nbsp;(may&nbsp;be&nbsp;different</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147047">//&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;parameter&nbsp;names&nbsp;for&nbsp;this&nbsp;par</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147104">//&nbsp;or&nbsp;the&nbsp;type&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147145">var</span>&nbsp;<span class="ident" id="5147149">parLineBeg</span>&nbsp;<span class="builtintype" id="5147160">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147167">if</span>&nbsp;<span class="builtinfunc" id="5147170">len</span><span class="op" id="5147173">(</span><span class="ident" id="5147174">par</span><span class="op" id="5147177">.</span><span class="ident" id="5147178">Names</span><span class="op" id="5147183">)</span>&nbsp;<span class="op" id="5147185">&gt;</span>&nbsp;<span class="num" id="5147187">0</span>&nbsp;<span class="op" id="5147189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147195">parLineBeg</span>&nbsp;<span class="op" id="5147206">=</span>&nbsp;<span class="ident" id="5147208">p</span><span class="op" id="5147209">.</span><span class="ident" id="5147210">lineFor</span><span class="op" id="5147217">(</span><span class="ident" id="5147218">par</span><span class="op" id="5147221">.</span><span class="ident" id="5147222">Names</span><span class="op" id="5147227">[</span><span class="num" id="5147228">0</span><span class="op" id="5147229">]</span><span class="op" id="5147230">.</span><span class="ident" id="5147231">Pos</span><span class="op" id="5147234">(</span><span class="op" id="5147235">)</span><span class="op" id="5147236">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147241">}</span>&nbsp;<span class="keyword" id="5147243">else</span>&nbsp;<span class="op" id="5147248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147254">parLineBeg</span>&nbsp;<span class="op" id="5147265">=</span>&nbsp;<span class="ident" id="5147267">p</span><span class="op" id="5147268">.</span><span class="ident" id="5147269">lineFor</span><span class="op" id="5147276">(</span><span class="ident" id="5147277">par</span><span class="op" id="5147280">.</span><span class="ident" id="5147281">Type</span><span class="op" id="5147285">.</span><span class="ident" id="5147286">Pos</span><span class="op" id="5147289">(</span><span class="op" id="5147290">)</span><span class="op" id="5147291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147301">var</span>&nbsp;<span class="ident" id="5147305">parLineEnd</span>&nbsp;<span class="op" id="5147316">=</span>&nbsp;<span class="ident" id="5147318">p</span><span class="op" id="5147319">.</span><span class="ident" id="5147320">lineFor</span><span class="op" id="5147327">(</span><span class="ident" id="5147328">par</span><span class="op" id="5147331">.</span><span class="ident" id="5147332">Type</span><span class="op" id="5147336">.</span><span class="ident" id="5147337">End</span><span class="op" id="5147340">(</span><span class="op" id="5147341">)</span><span class="op" id="5147342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147347">//&nbsp;separating&nbsp;&#34;,&#34;&nbsp;if&nbsp;needed</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147378">needsLinebreak</span>&nbsp;<span class="op" id="5147393">:=</span>&nbsp;<span class="num" id="5147396">0</span>&nbsp;<span class="op" id="5147398">&lt;</span>&nbsp;<span class="ident" id="5147400">prevLine</span>&nbsp;<span class="op" id="5147409">&amp;&amp;</span>&nbsp;<span class="ident" id="5147412">prevLine</span>&nbsp;<span class="op" id="5147421">&lt;</span>&nbsp;<span class="ident" id="5147423">parLineBeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147437">if</span>&nbsp;<span class="ident" id="5147440">i</span>&nbsp;<span class="op" id="5147442">&gt;</span>&nbsp;<span class="num" id="5147444">0</span>&nbsp;<span class="op" id="5147446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147452">//&nbsp;use&nbsp;position&nbsp;of&nbsp;parameter&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147508">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comma&nbsp;placement,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147563">//&nbsp;only&nbsp;if&nbsp;the&nbsp;next&nbsp;parameter&nbsp;is&nbsp;on&nbsp;the&nbsp;same&nbsp;line</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147617">if</span>&nbsp;<span class="op" id="5147620">!</span><span class="ident" id="5147621">needsLinebreak</span>&nbsp;<span class="op" id="5147636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147643">p</span><span class="op" id="5147644">.</span><span class="builtinfunc" id="5147645">print</span><span class="op" id="5147650">(</span><span class="ident" id="5147651">par</span><span class="op" id="5147654">.</span><span class="ident" id="5147655">Pos</span><span class="op" id="5147658">(</span><span class="op" id="5147659">)</span><span class="op" id="5147660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147672">p</span><span class="op" id="5147673">.</span><span class="builtinfunc" id="5147674">print</span><span class="op" id="5147679">(</span><span class="ident" id="5147680">token</span><span class="op" id="5147685">.</span><span class="ident" id="5147686">COMMA</span><span class="op" id="5147691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147696">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147701">//&nbsp;separator&nbsp;if&nbsp;needed&nbsp;(linebreak&nbsp;or&nbsp;blank)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147748">if</span>&nbsp;<span class="ident" id="5147751">needsLinebreak</span>&nbsp;<span class="op" id="5147766">&amp;&amp;</span>&nbsp;<span class="ident" id="5147769">p</span><span class="op" id="5147770">.</span><span class="ident" id="5147771">linebreak</span><span class="op" id="5147780">(</span><span class="ident" id="5147781">parLineBeg</span><span class="op" id="5147791">,</span>&nbsp;<span class="num" id="5147793">0</span><span class="op" id="5147794">,</span>&nbsp;<span class="ident" id="5147796">ws</span><span class="op" id="5147798">,</span>&nbsp;<span class="builtintype" id="5147800">true</span><span class="op" id="5147804">)</span>&nbsp;<span class="op" id="5147806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147812">//&nbsp;break&nbsp;line&nbsp;if&nbsp;the&nbsp;opening&nbsp;&#34;(&#34;&nbsp;or&nbsp;previous&nbsp;parameter&nbsp;ended&nbsp;on&nbsp;a&nbsp;different&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147897">ws</span>&nbsp;<span class="op" id="5147900">=</span>&nbsp;<span class="ident" id="5147902">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147912">}</span>&nbsp;<span class="keyword" id="5147914">else</span>&nbsp;<span class="keyword" id="5147919">if</span>&nbsp;<span class="ident" id="5147922">i</span>&nbsp;<span class="op" id="5147924">&gt;</span>&nbsp;<span class="num" id="5147926">0</span>&nbsp;<span class="op" id="5147928">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147934">p</span><span class="op" id="5147935">.</span><span class="builtinfunc" id="5147936">print</span><span class="op" id="5147941">(</span><span class="ident" id="5147942">blank</span><span class="op" id="5147947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147957">//&nbsp;parameter&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147979">if</span>&nbsp;<span class="builtinfunc" id="5147982">len</span><span class="op" id="5147985">(</span><span class="ident" id="5147986">par</span><span class="op" id="5147989">.</span><span class="ident" id="5147990">Names</span><span class="op" id="5147995">)</span>&nbsp;<span class="op" id="5147997">&gt;</span>&nbsp;<span class="num" id="5147999">0</span>&nbsp;<span class="op" id="5148001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148007">//&nbsp;Very&nbsp;subtle:&nbsp;If&nbsp;we&nbsp;indented&nbsp;before&nbsp;(ws&nbsp;==&nbsp;ignore),&nbsp;identList</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148075">//&nbsp;won&#39;t&nbsp;indent&nbsp;again.&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;(ws&nbsp;==&nbsp;indent),&nbsp;identList&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148146">//&nbsp;indent&nbsp;if&nbsp;the&nbsp;identList&nbsp;spans&nbsp;multiple&nbsp;lines,&nbsp;and&nbsp;it&nbsp;will&nbsp;outdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148219">//&nbsp;again&nbsp;at&nbsp;the&nbsp;end&nbsp;(and&nbsp;still&nbsp;ws&nbsp;==&nbsp;indent).&nbsp;Thus,&nbsp;a&nbsp;subsequent&nbsp;indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148295">//&nbsp;by&nbsp;a&nbsp;linebreak&nbsp;call&nbsp;after&nbsp;a&nbsp;type,&nbsp;or&nbsp;in&nbsp;the&nbsp;next&nbsp;multi-line&nbsp;identList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148372">//&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148404">p</span><span class="op" id="5148405">.</span><span class="ident" id="5148406">identList</span><span class="op" id="5148415">(</span><span class="ident" id="5148416">par</span><span class="op" id="5148419">.</span><span class="ident" id="5148420">Names</span><span class="op" id="5148425">,</span>&nbsp;<span class="ident" id="5148427">ws</span>&nbsp;<span class="op" id="5148430">==</span>&nbsp;<span class="ident" id="5148433">indent</span><span class="op" id="5148439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148445">p</span><span class="op" id="5148446">.</span><span class="builtinfunc" id="5148447">print</span><span class="op" id="5148452">(</span><span class="ident" id="5148453">blank</span><span class="op" id="5148458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148468">//&nbsp;parameter&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148489">p</span><span class="op" id="5148490">.</span><span class="ident" id="5148491">expr</span><span class="op" id="5148495">(</span><span class="ident" id="5148496">stripParensAlways</span><span class="op" id="5148513">(</span><span class="ident" id="5148514">par</span><span class="op" id="5148517">.</span><span class="ident" id="5148518">Type</span><span class="op" id="5148522">)</span><span class="op" id="5148523">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148528">prevLine</span>&nbsp;<span class="op" id="5148537">=</span>&nbsp;<span class="ident" id="5148539">parLineEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148556">//&nbsp;if&nbsp;the&nbsp;closing&nbsp;&#34;)&#34;&nbsp;is&nbsp;on&nbsp;a&nbsp;separate&nbsp;line&nbsp;from&nbsp;the&nbsp;last&nbsp;parameter,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148627">//&nbsp;print&nbsp;an&nbsp;additional&nbsp;&#34;,&#34;&nbsp;and&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148671">if</span>&nbsp;<span class="ident" id="5148674">closing</span>&nbsp;<span class="op" id="5148682">:=</span>&nbsp;<span class="ident" id="5148685">p</span><span class="op" id="5148686">.</span><span class="ident" id="5148687">lineFor</span><span class="op" id="5148694">(</span><span class="ident" id="5148695">fields</span><span class="op" id="5148701">.</span><span class="ident" id="5148702">Closing</span><span class="op" id="5148709">)</span><span class="op" id="5148710">;</span>&nbsp;<span class="num" id="5148712">0</span>&nbsp;<span class="op" id="5148714">&lt;</span>&nbsp;<span class="ident" id="5148716">prevLine</span>&nbsp;<span class="op" id="5148725">&amp;&amp;</span>&nbsp;<span class="ident" id="5148728">prevLine</span>&nbsp;<span class="op" id="5148737">&lt;</span>&nbsp;<span class="ident" id="5148739">closing</span>&nbsp;<span class="op" id="5148747">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148752">p</span><span class="op" id="5148753">.</span><span class="builtinfunc" id="5148754">print</span><span class="op" id="5148759">(</span><span class="ident" id="5148760">token</span><span class="op" id="5148765">.</span><span class="ident" id="5148766">COMMA</span><span class="op" id="5148771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148776">p</span><span class="op" id="5148777">.</span><span class="ident" id="5148778">linebreak</span><span class="op" id="5148787">(</span><span class="ident" id="5148788">closing</span><span class="op" id="5148795">,</span>&nbsp;<span class="num" id="5148797">0</span><span class="op" id="5148798">,</span>&nbsp;<span class="ident" id="5148800">ignore</span><span class="op" id="5148806">,</span>&nbsp;<span class="builtintype" id="5148808">true</span><span class="op" id="5148812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148820">//&nbsp;unindent&nbsp;if&nbsp;we&nbsp;indented</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148849">if</span>&nbsp;<span class="ident" id="5148852">ws</span>&nbsp;<span class="op" id="5148855">==</span>&nbsp;<span class="ident" id="5148858">ignore</span>&nbsp;<span class="op" id="5148865">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148870">p</span><span class="op" id="5148871">.</span><span class="builtinfunc" id="5148872">print</span><span class="op" id="5148877">(</span><span class="ident" id="5148878">unindent</span><span class="op" id="5148886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148896">p</span><span class="op" id="5148897">.</span><span class="builtinfunc" id="5148898">print</span><span class="op" id="5148903">(</span><span class="ident" id="5148904">fields</span><span class="op" id="5148910">.</span><span class="ident" id="5148911">Closing</span><span class="op" id="5148918">,</span>&nbsp;<span class="ident" id="5148920">token</span><span class="op" id="5148925">.</span><span class="ident" id="5148926">RPAREN</span><span class="op" id="5148932">)</span><br>
<span class="lineno"></span><span class="op" id="5148934">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5148937">func</span>&nbsp;<span class="op" id="5148942">(</span><span class="ident" id="5148943">p</span>&nbsp;<span class="op" id="5148945">*</span><span class="ident" id="5148946">printer</span><span class="op" id="5148953">)</span>&nbsp;<span class="ident" id="5148955">signature</span><span class="op" id="5148964">(</span><span class="ident" id="5148965">params</span><span class="op" id="5148971">,</span>&nbsp;<span class="ident" id="5148973">result</span>&nbsp;<span class="op" id="5148980">*</span><span class="ident" id="5148981">ast</span><span class="op" id="5148984">.</span><span class="ident" id="5148985">FieldList</span><span class="op" id="5148994">)</span>&nbsp;<span class="op" id="5148996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148999">if</span>&nbsp;<span class="ident" id="5149002">params</span>&nbsp;<span class="op" id="5149009">!=</span>&nbsp;<span class="ident" id="5149012">nil</span>&nbsp;<span class="op" id="5149016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149020">p</span><span class="op" id="5149021">.</span><span class="ident" id="5149022">parameters</span><span class="op" id="5149032">(</span><span class="ident" id="5149033">params</span><span class="op" id="5149039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149042">}</span>&nbsp;<span class="keyword" id="5149044">else</span>&nbsp;<span class="op" id="5149049">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149053">p</span><span class="op" id="5149054">.</span><span class="builtinfunc" id="5149055">print</span><span class="op" id="5149060">(</span><span class="ident" id="5149061">token</span><span class="op" id="5149066">.</span><span class="ident" id="5149067">LPAREN</span><span class="op" id="5149073">,</span>&nbsp;<span class="ident" id="5149075">token</span><span class="op" id="5149080">.</span><span class="ident" id="5149081">RPAREN</span><span class="op" id="5149087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149093">n</span>&nbsp;<span class="op" id="5149095">:=</span>&nbsp;<span class="ident" id="5149098">result</span><span class="op" id="5149104">.</span><span class="ident" id="5149105">NumFields</span><span class="op" id="5149114">(</span><span class="op" id="5149115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149118">if</span>&nbsp;<span class="ident" id="5149121">n</span>&nbsp;<span class="op" id="5149123">&gt;</span>&nbsp;<span class="num" id="5149125">0</span>&nbsp;<span class="op" id="5149127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149131">//&nbsp;result&nbsp;!=&nbsp;nil</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149150">p</span><span class="op" id="5149151">.</span><span class="builtinfunc" id="5149152">print</span><span class="op" id="5149157">(</span><span class="ident" id="5149158">blank</span><span class="op" id="5149163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149167">if</span>&nbsp;<span class="ident" id="5149170">n</span>&nbsp;<span class="op" id="5149172">==</span>&nbsp;<span class="num" id="5149175">1</span>&nbsp;<span class="op" id="5149177">&amp;&amp;</span>&nbsp;<span class="ident" id="5149180">result</span><span class="op" id="5149186">.</span><span class="ident" id="5149187">List</span><span class="op" id="5149191">[</span><span class="num" id="5149192">0</span><span class="op" id="5149193">]</span><span class="op" id="5149194">.</span><span class="ident" id="5149195">Names</span>&nbsp;<span class="op" id="5149201">==</span>&nbsp;<span class="ident" id="5149204">nil</span>&nbsp;<span class="op" id="5149208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149213">//&nbsp;single&nbsp;anonymous&nbsp;result;&nbsp;no&nbsp;()&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149252">p</span><span class="op" id="5149253">.</span><span class="ident" id="5149254">expr</span><span class="op" id="5149258">(</span><span class="ident" id="5149259">stripParensAlways</span><span class="op" id="5149276">(</span><span class="ident" id="5149277">result</span><span class="op" id="5149283">.</span><span class="ident" id="5149284">List</span><span class="op" id="5149288">[</span><span class="num" id="5149289">0</span><span class="op" id="5149290">]</span><span class="op" id="5149291">.</span><span class="ident" id="5149292">Type</span><span class="op" id="5149296">)</span><span class="op" id="5149297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149302">return</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149315">p</span><span class="op" id="5149316">.</span><span class="ident" id="5149317">parameters</span><span class="op" id="5149327">(</span><span class="ident" id="5149328">result</span><span class="op" id="5149334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149337">}</span><br>
<span class="lineno"></span><span class="op" id="5149339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5149342">func</span>&nbsp;<span class="ident" id="5149347">identListSize</span><span class="op" id="5149360">(</span><span class="ident" id="5149361">list</span>&nbsp;<span class="op" id="5149366">[</span><span class="op" id="5149367">]</span><span class="op" id="5149368">*</span><span class="ident" id="5149369">ast</span><span class="op" id="5149372">.</span><span class="ident" id="5149373">Ident</span><span class="op" id="5149378">,</span>&nbsp;<span class="ident" id="5149380">maxSize</span>&nbsp;<span class="builtintype" id="5149388">int</span><span class="op" id="5149391">)</span>&nbsp;<span class="op" id="5149393">(</span><span class="ident" id="5149394">size</span>&nbsp;<span class="builtintype" id="5149399">int</span><span class="op" id="5149402">)</span>&nbsp;<span class="op" id="5149404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149407">for</span>&nbsp;<span class="ident" id="5149411">i</span><span class="op" id="5149412">,</span>&nbsp;<span class="ident" id="5149414">x</span>&nbsp;<span class="op" id="5149416">:=</span>&nbsp;<span class="keyword" id="5149419">range</span>&nbsp;<span class="ident" id="5149425">list</span>&nbsp;<span class="op" id="5149430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149434">if</span>&nbsp;<span class="ident" id="5149437">i</span>&nbsp;<span class="op" id="5149439">&gt;</span>&nbsp;<span class="num" id="5149441">0</span>&nbsp;<span class="op" id="5149443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149448">size</span>&nbsp;<span class="op" id="5149453">+=</span>&nbsp;<span class="builtinfunc" id="5149456">len</span><span class="op" id="5149459">(</span><span class="string" id="5149460">&#34;,&nbsp;&#34;</span><span class="op" id="5149464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149468">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149472">size</span>&nbsp;<span class="op" id="5149477">+=</span>&nbsp;<span class="ident" id="5149480">utf8</span><span class="op" id="5149484">.</span><span class="ident" id="5149485">RuneCountInString</span><span class="op" id="5149502">(</span><span class="ident" id="5149503">x</span><span class="op" id="5149504">.</span><span class="ident" id="5149505">Name</span><span class="op" id="5149509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149513">if</span>&nbsp;<span class="ident" id="5149516">size</span>&nbsp;<span class="op" id="5149521">&gt;=</span>&nbsp;<span class="ident" id="5149524">maxSize</span>&nbsp;<span class="op" id="5149532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149537">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149548">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149551">return</span><br>
<span class="lineno"></span><span class="op" id="5149558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149561">func</span>&nbsp;<span class="op" id="5149566">(</span><span class="ident" id="5149567">p</span>&nbsp;<span class="op" id="5149569">*</span><span class="ident" id="5149570">printer</span><span class="op" id="5149577">)</span>&nbsp;<span class="ident" id="5149579">isOneLineFieldList</span><span class="op" id="5149597">(</span><span class="ident" id="5149598">list</span>&nbsp;<span class="op" id="5149603">[</span><span class="op" id="5149604">]</span><span class="op" id="5149605">*</span><span class="ident" id="5149606">ast</span><span class="op" id="5149609">.</span><span class="ident" id="5149610">Field</span><span class="op" id="5149615">)</span>&nbsp;<span class="builtintype" id="5149617">bool</span>&nbsp;<span class="op" id="5149622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149625">if</span>&nbsp;<span class="builtinfunc" id="5149628">len</span><span class="op" id="5149631">(</span><span class="ident" id="5149632">list</span><span class="op" id="5149636">)</span>&nbsp;<span class="op" id="5149638">!=</span>&nbsp;<span class="num" id="5149641">1</span>&nbsp;<span class="op" id="5149643">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149647">return</span>&nbsp;<span class="builtintype" id="5149654">false</span>&nbsp;<span class="comment" id="5149660">//&nbsp;allow&nbsp;only&nbsp;one&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149688">f</span>&nbsp;<span class="op" id="5149690">:=</span>&nbsp;<span class="ident" id="5149693">list</span><span class="op" id="5149697">[</span><span class="num" id="5149698">0</span><span class="op" id="5149699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149702">if</span>&nbsp;<span class="ident" id="5149705">f</span><span class="op" id="5149706">.</span><span class="ident" id="5149707">Tag</span>&nbsp;<span class="op" id="5149711">!=</span>&nbsp;<span class="ident" id="5149714">nil</span>&nbsp;<span class="op" id="5149718">||</span>&nbsp;<span class="ident" id="5149721">f</span><span class="op" id="5149722">.</span><span class="ident" id="5149723">Comment</span>&nbsp;<span class="op" id="5149731">!=</span>&nbsp;<span class="ident" id="5149734">nil</span>&nbsp;<span class="op" id="5149738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149742">return</span>&nbsp;<span class="builtintype" id="5149749">false</span>&nbsp;<span class="comment" id="5149755">//&nbsp;don&#39;t&nbsp;allow&nbsp;tags&nbsp;or&nbsp;comments</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149791">//&nbsp;only&nbsp;name(s)&nbsp;and&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149817">const</span>&nbsp;<span class="ident" id="5149823">maxSize</span>&nbsp;<span class="op" id="5149831">=</span>&nbsp;<span class="num" id="5149833">30</span>&nbsp;<span class="comment" id="5149836">//&nbsp;adjust&nbsp;as&nbsp;appropriate,&nbsp;this&nbsp;is&nbsp;an&nbsp;approximate&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149892">namesSize</span>&nbsp;<span class="op" id="5149902">:=</span>&nbsp;<span class="ident" id="5149905">identListSize</span><span class="op" id="5149918">(</span><span class="ident" id="5149919">f</span><span class="op" id="5149920">.</span><span class="ident" id="5149921">Names</span><span class="op" id="5149926">,</span>&nbsp;<span class="ident" id="5149928">maxSize</span><span class="op" id="5149935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149938">if</span>&nbsp;<span class="ident" id="5149941">namesSize</span>&nbsp;<span class="op" id="5149951">&gt;</span>&nbsp;<span class="num" id="5149953">0</span>&nbsp;<span class="op" id="5149955">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149959">namesSize</span>&nbsp;<span class="op" id="5149969">=</span>&nbsp;<span class="num" id="5149971">1</span>&nbsp;<span class="comment" id="5149973">//&nbsp;blank&nbsp;between&nbsp;names&nbsp;and&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150010">typeSize</span>&nbsp;<span class="op" id="5150019">:=</span>&nbsp;<span class="ident" id="5150022">p</span><span class="op" id="5150023">.</span><span class="ident" id="5150024">nodeSize</span><span class="op" id="5150032">(</span><span class="ident" id="5150033">f</span><span class="op" id="5150034">.</span><span class="ident" id="5150035">Type</span><span class="op" id="5150039">,</span>&nbsp;<span class="ident" id="5150041">maxSize</span><span class="op" id="5150048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150051">return</span>&nbsp;<span class="ident" id="5150058">namesSize</span><span class="op" id="5150067">+</span><span class="ident" id="5150068">typeSize</span>&nbsp;<span class="op" id="5150077">&lt;=</span>&nbsp;<span class="ident" id="5150080">maxSize</span><br>
<span class="lineno"></span><span class="op" id="5150088">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="5150091">func</span>&nbsp;<span class="op" id="5150096">(</span><span class="ident" id="5150097">p</span>&nbsp;<span class="op" id="5150099">*</span><span class="ident" id="5150100">printer</span><span class="op" id="5150107">)</span>&nbsp;<span class="ident" id="5150109">setLineComment</span><span class="op" id="5150123">(</span><span class="ident" id="5150124">text</span>&nbsp;<span class="builtintype" id="5150129">string</span><span class="op" id="5150135">)</span>&nbsp;<span class="op" id="5150137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150140">p</span><span class="op" id="5150141">.</span><span class="ident" id="5150142">setComment</span><span class="op" id="5150152">(</span><span class="op" id="5150153">&amp;</span><span class="ident" id="5150154">ast</span><span class="op" id="5150157">.</span><span class="ident" id="5150158">CommentGroup</span><span class="op" id="5150170">{</span><span class="ident" id="5150171">List</span><span class="op" id="5150175">:</span>&nbsp;<span class="op" id="5150177">[</span><span class="op" id="5150178">]</span><span class="op" id="5150179">*</span><span class="ident" id="5150180">ast</span><span class="op" id="5150183">.</span><span class="ident" id="5150184">Comment</span><span class="op" id="5150191">{</span><span class="op" id="5150192">{</span><span class="ident" id="5150193">Slash</span><span class="op" id="5150198">:</span>&nbsp;<span class="ident" id="5150200">token</span><span class="op" id="5150205">.</span><span class="ident" id="5150206">NoPos</span><span class="op" id="5150211">,</span>&nbsp;<span class="ident" id="5150213">Text</span><span class="op" id="5150217">:</span>&nbsp;<span class="ident" id="5150219">text</span><span class="op" id="5150223">}</span><span class="op" id="5150224">}</span><span class="op" id="5150225">}</span><span class="op" id="5150226">)</span><br>
<span class="lineno"></span><span class="op" id="5150228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5150231">func</span>&nbsp;<span class="op" id="5150236">(</span><span class="ident" id="5150237">p</span>&nbsp;<span class="op" id="5150239">*</span><span class="ident" id="5150240">printer</span><span class="op" id="5150247">)</span>&nbsp;<span class="ident" id="5150249">fieldList</span><span class="op" id="5150258">(</span><span class="ident" id="5150259">fields</span>&nbsp;<span class="op" id="5150266">*</span><span class="ident" id="5150267">ast</span><span class="op" id="5150270">.</span><span class="ident" id="5150271">FieldList</span><span class="op" id="5150280">,</span>&nbsp;<span class="ident" id="5150282">isStruct</span><span class="op" id="5150290">,</span>&nbsp;<span class="ident" id="5150292">isIncomplete</span>&nbsp;<span class="builtintype" id="5150305">bool</span><span class="op" id="5150309">)</span>&nbsp;<span class="op" id="5150311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150314">lbrace</span>&nbsp;<span class="op" id="5150321">:=</span>&nbsp;<span class="ident" id="5150324">fields</span><span class="op" id="5150330">.</span><span class="ident" id="5150331">Opening</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150340">list</span>&nbsp;<span class="op" id="5150345">:=</span>&nbsp;<span class="ident" id="5150348">fields</span><span class="op" id="5150354">.</span><span class="ident" id="5150355">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150361">rbrace</span>&nbsp;<span class="op" id="5150368">:=</span>&nbsp;<span class="ident" id="5150371">fields</span><span class="op" id="5150377">.</span><span class="ident" id="5150378">Closing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150387">hasComments</span>&nbsp;<span class="op" id="5150399">:=</span>&nbsp;<span class="ident" id="5150402">isIncomplete</span>&nbsp;<span class="op" id="5150415">||</span>&nbsp;<span class="ident" id="5150418">p</span><span class="op" id="5150419">.</span><span class="ident" id="5150420">commentBefore</span><span class="op" id="5150433">(</span><span class="ident" id="5150434">p</span><span class="op" id="5150435">.</span><span class="ident" id="5150436">posFor</span><span class="op" id="5150442">(</span><span class="ident" id="5150443">rbrace</span><span class="op" id="5150449">)</span><span class="op" id="5150450">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150453">srcIsOneLine</span>&nbsp;<span class="op" id="5150466">:=</span>&nbsp;<span class="ident" id="5150469">lbrace</span><span class="op" id="5150475">.</span><span class="ident" id="5150476">IsValid</span><span class="op" id="5150483">(</span><span class="op" id="5150484">)</span>&nbsp;<span class="op" id="5150486">&amp;&amp;</span>&nbsp;<span class="ident" id="5150489">rbrace</span><span class="op" id="5150495">.</span><span class="ident" id="5150496">IsValid</span><span class="op" id="5150503">(</span><span class="op" id="5150504">)</span>&nbsp;<span class="op" id="5150506">&amp;&amp;</span>&nbsp;<span class="ident" id="5150509">p</span><span class="op" id="5150510">.</span><span class="ident" id="5150511">lineFor</span><span class="op" id="5150518">(</span><span class="ident" id="5150519">lbrace</span><span class="op" id="5150525">)</span>&nbsp;<span class="op" id="5150527">==</span>&nbsp;<span class="ident" id="5150530">p</span><span class="op" id="5150531">.</span><span class="ident" id="5150532">lineFor</span><span class="op" id="5150539">(</span><span class="ident" id="5150540">rbrace</span><span class="op" id="5150546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150550">if</span>&nbsp;<span class="op" id="5150553">!</span><span class="ident" id="5150554">hasComments</span>&nbsp;<span class="op" id="5150566">&amp;&amp;</span>&nbsp;<span class="ident" id="5150569">srcIsOneLine</span>&nbsp;<span class="op" id="5150582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5150586">//&nbsp;possibly&nbsp;a&nbsp;one-line&nbsp;struct/interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150628">if</span>&nbsp;<span class="builtinfunc" id="5150631">len</span><span class="op" id="5150634">(</span><span class="ident" id="5150635">list</span><span class="op" id="5150639">)</span>&nbsp;<span class="op" id="5150641">==</span>&nbsp;<span class="num" id="5150644">0</span>&nbsp;<span class="op" id="5150646">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5150651">//&nbsp;no&nbsp;blank&nbsp;between&nbsp;keyword&nbsp;and&nbsp;{}&nbsp;in&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150702">p</span><span class="op" id="5150703">.</span><span class="builtinfunc" id="5150704">print</span><span class="op" id="5150709">(</span><span class="ident" id="5150710">lbrace</span><span class="op" id="5150716">,</span>&nbsp;<span class="ident" id="5150718">token</span><span class="op" id="5150723">.</span><span class="ident" id="5150724">LBRACE</span><span class="op" id="5150730">,</span>&nbsp;<span class="ident" id="5150732">rbrace</span><span class="op" id="5150738">,</span>&nbsp;<span class="ident" id="5150740">token</span><span class="op" id="5150745">.</span><span class="ident" id="5150746">RBRACE</span><span class="op" id="5150752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150766">}</span>&nbsp;<span class="keyword" id="5150768">else</span>&nbsp;<span class="keyword" id="5150773">if</span>&nbsp;<span class="ident" id="5150776">isStruct</span>&nbsp;<span class="op" id="5150785">&amp;&amp;</span>&nbsp;<span class="ident" id="5150788">p</span><span class="op" id="5150789">.</span><span class="ident" id="5150790">isOneLineFieldList</span><span class="op" id="5150808">(</span><span class="ident" id="5150809">list</span><span class="op" id="5150813">)</span>&nbsp;<span class="op" id="5150815">{</span>&nbsp;<span class="comment" id="5150817">//&nbsp;for&nbsp;now&nbsp;ignore&nbsp;interfaces</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5150849">//&nbsp;small&nbsp;enough&nbsp;-&nbsp;print&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5150888">//&nbsp;(don&#39;t&nbsp;use&nbsp;identList&nbsp;and&nbsp;ignore&nbsp;source&nbsp;line&nbsp;breaks)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150946">p</span><span class="op" id="5150947">.</span><span class="builtinfunc" id="5150948">print</span><span class="op" id="5150953">(</span><span class="ident" id="5150954">lbrace</span><span class="op" id="5150960">,</span>&nbsp;<span class="ident" id="5150962">token</span><span class="op" id="5150967">.</span><span class="ident" id="5150968">LBRACE</span><span class="op" id="5150974">,</span>&nbsp;<span class="ident" id="5150976">blank</span><span class="op" id="5150981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150986">f</span>&nbsp;<span class="op" id="5150988">:=</span>&nbsp;<span class="ident" id="5150991">list</span><span class="op" id="5150995">[</span><span class="num" id="5150996">0</span><span class="op" id="5150997">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151002">for</span>&nbsp;<span class="ident" id="5151006">i</span><span class="op" id="5151007">,</span>&nbsp;<span class="ident" id="5151009">x</span>&nbsp;<span class="op" id="5151011">:=</span>&nbsp;<span class="keyword" id="5151014">range</span>&nbsp;<span class="ident" id="5151020">f</span><span class="op" id="5151021">.</span><span class="ident" id="5151022">Names</span>&nbsp;<span class="op" id="5151028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151034">if</span>&nbsp;<span class="ident" id="5151037">i</span>&nbsp;<span class="op" id="5151039">&gt;</span>&nbsp;<span class="num" id="5151041">0</span>&nbsp;<span class="op" id="5151043">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151050">//&nbsp;no&nbsp;comments&nbsp;so&nbsp;no&nbsp;need&nbsp;for&nbsp;comma&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151100">p</span><span class="op" id="5151101">.</span><span class="builtinfunc" id="5151102">print</span><span class="op" id="5151107">(</span><span class="ident" id="5151108">token</span><span class="op" id="5151113">.</span><span class="ident" id="5151114">COMMA</span><span class="op" id="5151119">,</span>&nbsp;<span class="ident" id="5151121">blank</span><span class="op" id="5151126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151138">p</span><span class="op" id="5151139">.</span><span class="ident" id="5151140">expr</span><span class="op" id="5151144">(</span><span class="ident" id="5151145">x</span><span class="op" id="5151146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151151">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151156">if</span>&nbsp;<span class="builtinfunc" id="5151159">len</span><span class="op" id="5151162">(</span><span class="ident" id="5151163">f</span><span class="op" id="5151164">.</span><span class="ident" id="5151165">Names</span><span class="op" id="5151170">)</span>&nbsp;<span class="op" id="5151172">&gt;</span>&nbsp;<span class="num" id="5151174">0</span>&nbsp;<span class="op" id="5151176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151182">p</span><span class="op" id="5151183">.</span><span class="builtinfunc" id="5151184">print</span><span class="op" id="5151189">(</span><span class="ident" id="5151190">blank</span><span class="op" id="5151195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151205">p</span><span class="op" id="5151206">.</span><span class="ident" id="5151207">expr</span><span class="op" id="5151211">(</span><span class="ident" id="5151212">f</span><span class="op" id="5151213">.</span><span class="ident" id="5151214">Type</span><span class="op" id="5151218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151223">p</span><span class="op" id="5151224">.</span><span class="builtinfunc" id="5151225">print</span><span class="op" id="5151230">(</span><span class="ident" id="5151231">blank</span><span class="op" id="5151236">,</span>&nbsp;<span class="ident" id="5151238">rbrace</span><span class="op" id="5151244">,</span>&nbsp;<span class="ident" id="5151246">token</span><span class="op" id="5151251">.</span><span class="ident" id="5151252">RBRACE</span><span class="op" id="5151258">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151263">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151278">//&nbsp;hasComments&nbsp;||&nbsp;!srcIsOneLine</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151312">p</span><span class="op" id="5151313">.</span><span class="builtinfunc" id="5151314">print</span><span class="op" id="5151319">(</span><span class="ident" id="5151320">blank</span><span class="op" id="5151325">,</span>&nbsp;<span class="ident" id="5151327">lbrace</span><span class="op" id="5151333">,</span>&nbsp;<span class="ident" id="5151335">token</span><span class="op" id="5151340">.</span><span class="ident" id="5151341">LBRACE</span><span class="op" id="5151347">,</span>&nbsp;<span class="ident" id="5151349">indent</span><span class="op" id="5151355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151358">if</span>&nbsp;<span class="ident" id="5151361">hasComments</span>&nbsp;<span class="op" id="5151373">||</span>&nbsp;<span class="builtinfunc" id="5151376">len</span><span class="op" id="5151379">(</span><span class="ident" id="5151380">list</span><span class="op" id="5151384">)</span>&nbsp;<span class="op" id="5151386">&gt;</span>&nbsp;<span class="num" id="5151388">0</span>&nbsp;<span class="op" id="5151390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151394">p</span><span class="op" id="5151395">.</span><span class="builtinfunc" id="5151396">print</span><span class="op" id="5151401">(</span><span class="ident" id="5151402">formfeed</span><span class="op" id="5151410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151417">if</span>&nbsp;<span class="ident" id="5151420">isStruct</span>&nbsp;<span class="op" id="5151429">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151434">sep</span>&nbsp;<span class="op" id="5151438">:=</span>&nbsp;<span class="ident" id="5151441">vtab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151448">if</span>&nbsp;<span class="builtinfunc" id="5151451">len</span><span class="op" id="5151454">(</span><span class="ident" id="5151455">list</span><span class="op" id="5151459">)</span>&nbsp;<span class="op" id="5151461">==</span>&nbsp;<span class="num" id="5151464">1</span>&nbsp;<span class="op" id="5151466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151471">sep</span>&nbsp;<span class="op" id="5151475">=</span>&nbsp;<span class="ident" id="5151477">blank</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151489">var</span>&nbsp;<span class="ident" id="5151493">line</span>&nbsp;<span class="builtintype" id="5151498">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151504">for</span>&nbsp;<span class="ident" id="5151508">i</span><span class="op" id="5151509">,</span>&nbsp;<span class="ident" id="5151511">f</span>&nbsp;<span class="op" id="5151513">:=</span>&nbsp;<span class="keyword" id="5151516">range</span>&nbsp;<span class="ident" id="5151522">list</span>&nbsp;<span class="op" id="5151527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151532">if</span>&nbsp;<span class="ident" id="5151535">i</span>&nbsp;<span class="op" id="5151537">&gt;</span>&nbsp;<span class="num" id="5151539">0</span>&nbsp;<span class="op" id="5151541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151547">p</span><span class="op" id="5151548">.</span><span class="ident" id="5151549">linebreak</span><span class="op" id="5151558">(</span><span class="ident" id="5151559">p</span><span class="op" id="5151560">.</span><span class="ident" id="5151561">lineFor</span><span class="op" id="5151568">(</span><span class="ident" id="5151569">f</span><span class="op" id="5151570">.</span><span class="ident" id="5151571">Pos</span><span class="op" id="5151574">(</span><span class="op" id="5151575">)</span><span class="op" id="5151576">)</span><span class="op" id="5151577">,</span>&nbsp;<span class="num" id="5151579">1</span><span class="op" id="5151580">,</span>&nbsp;<span class="ident" id="5151582">ignore</span><span class="op" id="5151588">,</span>&nbsp;<span class="ident" id="5151590">p</span><span class="op" id="5151591">.</span><span class="ident" id="5151592">linesFrom</span><span class="op" id="5151601">(</span><span class="ident" id="5151602">line</span><span class="op" id="5151606">)</span>&nbsp;<span class="op" id="5151608">&gt;</span>&nbsp;<span class="num" id="5151610">0</span><span class="op" id="5151611">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151621">extraTabs</span>&nbsp;<span class="op" id="5151631">:=</span>&nbsp;<span class="num" id="5151634">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151639">p</span><span class="op" id="5151640">.</span><span class="ident" id="5151641">setComment</span><span class="op" id="5151651">(</span><span class="ident" id="5151652">f</span><span class="op" id="5151653">.</span><span class="ident" id="5151654">Doc</span><span class="op" id="5151657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151662">p</span><span class="op" id="5151663">.</span><span class="ident" id="5151664">recordLine</span><span class="op" id="5151674">(</span><span class="op" id="5151675">&amp;</span><span class="ident" id="5151676">line</span><span class="op" id="5151680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151685">if</span>&nbsp;<span class="builtinfunc" id="5151688">len</span><span class="op" id="5151691">(</span><span class="ident" id="5151692">f</span><span class="op" id="5151693">.</span><span class="ident" id="5151694">Names</span><span class="op" id="5151699">)</span>&nbsp;<span class="op" id="5151701">&gt;</span>&nbsp;<span class="num" id="5151703">0</span>&nbsp;<span class="op" id="5151705">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151711">//&nbsp;named&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151731">p</span><span class="op" id="5151732">.</span><span class="ident" id="5151733">identList</span><span class="op" id="5151742">(</span><span class="ident" id="5151743">f</span><span class="op" id="5151744">.</span><span class="ident" id="5151745">Names</span><span class="op" id="5151750">,</span>&nbsp;<span class="builtintype" id="5151752">false</span><span class="op" id="5151757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151763">p</span><span class="op" id="5151764">.</span><span class="builtinfunc" id="5151765">print</span><span class="op" id="5151770">(</span><span class="ident" id="5151771">sep</span><span class="op" id="5151774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151780">p</span><span class="op" id="5151781">.</span><span class="ident" id="5151782">expr</span><span class="op" id="5151786">(</span><span class="ident" id="5151787">f</span><span class="op" id="5151788">.</span><span class="ident" id="5151789">Type</span><span class="op" id="5151793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151799">extraTabs</span>&nbsp;<span class="op" id="5151809">=</span>&nbsp;<span class="num" id="5151811">1</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151816">}</span>&nbsp;<span class="keyword" id="5151818">else</span>&nbsp;<span class="op" id="5151823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151829">//&nbsp;anonymous&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151852">p</span><span class="op" id="5151853">.</span><span class="ident" id="5151854">expr</span><span class="op" id="5151858">(</span><span class="ident" id="5151859">f</span><span class="op" id="5151860">.</span><span class="ident" id="5151861">Type</span><span class="op" id="5151865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151871">extraTabs</span>&nbsp;<span class="op" id="5151881">=</span>&nbsp;<span class="num" id="5151883">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151888">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151893">if</span>&nbsp;<span class="ident" id="5151896">f</span><span class="op" id="5151897">.</span><span class="ident" id="5151898">Tag</span>&nbsp;<span class="op" id="5151902">!=</span>&nbsp;<span class="ident" id="5151905">nil</span>&nbsp;<span class="op" id="5151909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151915">if</span>&nbsp;<span class="builtinfunc" id="5151918">len</span><span class="op" id="5151921">(</span><span class="ident" id="5151922">f</span><span class="op" id="5151923">.</span><span class="ident" id="5151924">Names</span><span class="op" id="5151929">)</span>&nbsp;<span class="op" id="5151931">&gt;</span>&nbsp;<span class="num" id="5151933">0</span>&nbsp;<span class="op" id="5151935">&amp;&amp;</span>&nbsp;<span class="ident" id="5151938">sep</span>&nbsp;<span class="op" id="5151942">==</span>&nbsp;<span class="ident" id="5151945">vtab</span>&nbsp;<span class="op" id="5151950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151957">p</span><span class="op" id="5151958">.</span><span class="builtinfunc" id="5151959">print</span><span class="op" id="5151964">(</span><span class="ident" id="5151965">sep</span><span class="op" id="5151968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151980">p</span><span class="op" id="5151981">.</span><span class="builtinfunc" id="5151982">print</span><span class="op" id="5151987">(</span><span class="ident" id="5151988">sep</span><span class="op" id="5151991">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151997">p</span><span class="op" id="5151998">.</span><span class="ident" id="5151999">expr</span><span class="op" id="5152003">(</span><span class="ident" id="5152004">f</span><span class="op" id="5152005">.</span><span class="ident" id="5152006">Tag</span><span class="op" id="5152009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152015">extraTabs</span>&nbsp;<span class="op" id="5152025">=</span>&nbsp;<span class="num" id="5152027">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152037">if</span>&nbsp;<span class="ident" id="5152040">f</span><span class="op" id="5152041">.</span><span class="ident" id="5152042">Comment</span>&nbsp;<span class="op" id="5152050">!=</span>&nbsp;<span class="ident" id="5152053">nil</span>&nbsp;<span class="op" id="5152057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152063">for</span>&nbsp;<span class="op" id="5152067">;</span>&nbsp;<span class="ident" id="5152069">extraTabs</span>&nbsp;<span class="op" id="5152079">&gt;</span>&nbsp;<span class="num" id="5152081">0</span><span class="op" id="5152082">;</span>&nbsp;<span class="ident" id="5152084">extraTabs</span><span class="op" id="5152093">--</span>&nbsp;<span class="op" id="5152096">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152103">p</span><span class="op" id="5152104">.</span><span class="builtinfunc" id="5152105">print</span><span class="op" id="5152110">(</span><span class="ident" id="5152111">sep</span><span class="op" id="5152114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152126">p</span><span class="op" id="5152127">.</span><span class="ident" id="5152128">setComment</span><span class="op" id="5152138">(</span><span class="ident" id="5152139">f</span><span class="op" id="5152140">.</span><span class="ident" id="5152141">Comment</span><span class="op" id="5152148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152157">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152161">if</span>&nbsp;<span class="ident" id="5152164">isIncomplete</span>&nbsp;<span class="op" id="5152177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152182">if</span>&nbsp;<span class="builtinfunc" id="5152185">len</span><span class="op" id="5152188">(</span><span class="ident" id="5152189">list</span><span class="op" id="5152193">)</span>&nbsp;<span class="op" id="5152195">&gt;</span>&nbsp;<span class="num" id="5152197">0</span>&nbsp;<span class="op" id="5152199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152205">p</span><span class="op" id="5152206">.</span><span class="builtinfunc" id="5152207">print</span><span class="op" id="5152212">(</span><span class="ident" id="5152213">formfeed</span><span class="op" id="5152221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152231">p</span><span class="op" id="5152232">.</span><span class="ident" id="5152233">flush</span><span class="op" id="5152238">(</span><span class="ident" id="5152239">p</span><span class="op" id="5152240">.</span><span class="ident" id="5152241">posFor</span><span class="op" id="5152247">(</span><span class="ident" id="5152248">rbrace</span><span class="op" id="5152254">)</span><span class="op" id="5152255">,</span>&nbsp;<span class="ident" id="5152257">token</span><span class="op" id="5152262">.</span><span class="ident" id="5152263">RBRACE</span><span class="op" id="5152269">)</span>&nbsp;<span class="comment" id="5152271">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152323">p</span><span class="op" id="5152324">.</span><span class="ident" id="5152325">setLineComment</span><span class="op" id="5152339">(</span><span class="string" id="5152340">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;fields&#34;</span><span class="op" id="5152383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152391">}</span>&nbsp;<span class="keyword" id="5152393">else</span>&nbsp;<span class="op" id="5152398">{</span>&nbsp;<span class="comment" id="5152400">//&nbsp;interface</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152416">var</span>&nbsp;<span class="ident" id="5152420">line</span>&nbsp;<span class="builtintype" id="5152425">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152431">for</span>&nbsp;<span class="ident" id="5152435">i</span><span class="op" id="5152436">,</span>&nbsp;<span class="ident" id="5152438">f</span>&nbsp;<span class="op" id="5152440">:=</span>&nbsp;<span class="keyword" id="5152443">range</span>&nbsp;<span class="ident" id="5152449">list</span>&nbsp;<span class="op" id="5152454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152459">if</span>&nbsp;<span class="ident" id="5152462">i</span>&nbsp;<span class="op" id="5152464">&gt;</span>&nbsp;<span class="num" id="5152466">0</span>&nbsp;<span class="op" id="5152468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152474">p</span><span class="op" id="5152475">.</span><span class="ident" id="5152476">linebreak</span><span class="op" id="5152485">(</span><span class="ident" id="5152486">p</span><span class="op" id="5152487">.</span><span class="ident" id="5152488">lineFor</span><span class="op" id="5152495">(</span><span class="ident" id="5152496">f</span><span class="op" id="5152497">.</span><span class="ident" id="5152498">Pos</span><span class="op" id="5152501">(</span><span class="op" id="5152502">)</span><span class="op" id="5152503">)</span><span class="op" id="5152504">,</span>&nbsp;<span class="num" id="5152506">1</span><span class="op" id="5152507">,</span>&nbsp;<span class="ident" id="5152509">ignore</span><span class="op" id="5152515">,</span>&nbsp;<span class="ident" id="5152517">p</span><span class="op" id="5152518">.</span><span class="ident" id="5152519">linesFrom</span><span class="op" id="5152528">(</span><span class="ident" id="5152529">line</span><span class="op" id="5152533">)</span>&nbsp;<span class="op" id="5152535">&gt;</span>&nbsp;<span class="num" id="5152537">0</span><span class="op" id="5152538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152543">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152548">p</span><span class="op" id="5152549">.</span><span class="ident" id="5152550">setComment</span><span class="op" id="5152560">(</span><span class="ident" id="5152561">f</span><span class="op" id="5152562">.</span><span class="ident" id="5152563">Doc</span><span class="op" id="5152566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152571">p</span><span class="op" id="5152572">.</span><span class="ident" id="5152573">recordLine</span><span class="op" id="5152583">(</span><span class="op" id="5152584">&amp;</span><span class="ident" id="5152585">line</span><span class="op" id="5152589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152594">if</span>&nbsp;<span class="ident" id="5152597">ftyp</span><span class="op" id="5152601">,</span>&nbsp;<span class="ident" id="5152603">isFtyp</span>&nbsp;<span class="op" id="5152610">:=</span>&nbsp;<span class="ident" id="5152613">f</span><span class="op" id="5152614">.</span><span class="ident" id="5152615">Type</span><span class="op" id="5152619">.</span><span class="op" id="5152620">(</span><span class="op" id="5152621">*</span><span class="ident" id="5152622">ast</span><span class="op" id="5152625">.</span><span class="ident" id="5152626">FuncType</span><span class="op" id="5152634">)</span><span class="op" id="5152635">;</span>&nbsp;<span class="ident" id="5152637">isFtyp</span>&nbsp;<span class="op" id="5152644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152650">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152664">p</span><span class="op" id="5152665">.</span><span class="ident" id="5152666">expr</span><span class="op" id="5152670">(</span><span class="ident" id="5152671">f</span><span class="op" id="5152672">.</span><span class="ident" id="5152673">Names</span><span class="op" id="5152678">[</span><span class="num" id="5152679">0</span><span class="op" id="5152680">]</span><span class="op" id="5152681">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152687">p</span><span class="op" id="5152688">.</span><span class="ident" id="5152689">signature</span><span class="op" id="5152698">(</span><span class="ident" id="5152699">ftyp</span><span class="op" id="5152703">.</span><span class="ident" id="5152704">Params</span><span class="op" id="5152710">,</span>&nbsp;<span class="ident" id="5152712">ftyp</span><span class="op" id="5152716">.</span><span class="ident" id="5152717">Results</span><span class="op" id="5152724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152729">}</span>&nbsp;<span class="keyword" id="5152731">else</span>&nbsp;<span class="op" id="5152736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152742">//&nbsp;embedded&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152768">p</span><span class="op" id="5152769">.</span><span class="ident" id="5152770">expr</span><span class="op" id="5152774">(</span><span class="ident" id="5152775">f</span><span class="op" id="5152776">.</span><span class="ident" id="5152777">Type</span><span class="op" id="5152781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152786">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152791">p</span><span class="op" id="5152792">.</span><span class="ident" id="5152793">setComment</span><span class="op" id="5152803">(</span><span class="ident" id="5152804">f</span><span class="op" id="5152805">.</span><span class="ident" id="5152806">Comment</span><span class="op" id="5152813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152821">if</span>&nbsp;<span class="ident" id="5152824">isIncomplete</span>&nbsp;<span class="op" id="5152837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152842">if</span>&nbsp;<span class="builtinfunc" id="5152845">len</span><span class="op" id="5152848">(</span><span class="ident" id="5152849">list</span><span class="op" id="5152853">)</span>&nbsp;<span class="op" id="5152855">&gt;</span>&nbsp;<span class="num" id="5152857">0</span>&nbsp;<span class="op" id="5152859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152865">p</span><span class="op" id="5152866">.</span><span class="builtinfunc" id="5152867">print</span><span class="op" id="5152872">(</span><span class="ident" id="5152873">formfeed</span><span class="op" id="5152881">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152891">p</span><span class="op" id="5152892">.</span><span class="ident" id="5152893">flush</span><span class="op" id="5152898">(</span><span class="ident" id="5152899">p</span><span class="op" id="5152900">.</span><span class="ident" id="5152901">posFor</span><span class="op" id="5152907">(</span><span class="ident" id="5152908">rbrace</span><span class="op" id="5152914">)</span><span class="op" id="5152915">,</span>&nbsp;<span class="ident" id="5152917">token</span><span class="op" id="5152922">.</span><span class="ident" id="5152923">RBRACE</span><span class="op" id="5152929">)</span>&nbsp;<span class="comment" id="5152931">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;lose&nbsp;the&nbsp;last&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152983">p</span><span class="op" id="5152984">.</span><span class="ident" id="5152985">setLineComment</span><span class="op" id="5152999">(</span><span class="string" id="5153000">&#34;//&nbsp;contains&nbsp;filtered&nbsp;or&nbsp;unexported&nbsp;methods&#34;</span><span class="op" id="5153044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153055">p</span><span class="op" id="5153056">.</span><span class="builtinfunc" id="5153057">print</span><span class="op" id="5153062">(</span><span class="ident" id="5153063">unindent</span><span class="op" id="5153071">,</span>&nbsp;<span class="ident" id="5153073">formfeed</span><span class="op" id="5153081">,</span>&nbsp;<span class="ident" id="5153083">rbrace</span><span class="op" id="5153089">,</span>&nbsp;<span class="ident" id="5153091">token</span><span class="op" id="5153096">.</span><span class="ident" id="5153097">RBRACE</span><span class="op" id="5153103">)</span><br>
<span class="lineno"></span><span class="op" id="5153105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5153108">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">505</span><span class="comment" id="5153188">//&nbsp;Expressions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153204">func</span>&nbsp;<span class="ident" id="5153209">walkBinary</span><span class="op" id="5153219">(</span><span class="ident" id="5153220">e</span>&nbsp;<span class="op" id="5153222">*</span><span class="ident" id="5153223">ast</span><span class="op" id="5153226">.</span><span class="ident" id="5153227">BinaryExpr</span><span class="op" id="5153237">)</span>&nbsp;<span class="op" id="5153239">(</span><span class="ident" id="5153240">has4</span><span class="op" id="5153244">,</span>&nbsp;<span class="ident" id="5153246">has5</span>&nbsp;<span class="builtintype" id="5153251">bool</span><span class="op" id="5153255">,</span>&nbsp;<span class="ident" id="5153257">maxProblem</span>&nbsp;<span class="builtintype" id="5153268">int</span><span class="op" id="5153271">)</span>&nbsp;<span class="op" id="5153273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153276">switch</span>&nbsp;<span class="ident" id="5153283">e</span><span class="op" id="5153284">.</span><span class="ident" id="5153285">Op</span><span class="op" id="5153287">.</span><span class="ident" id="5153288">Precedence</span><span class="op" id="5153298">(</span><span class="op" id="5153299">)</span>&nbsp;<span class="op" id="5153301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153304">case</span>&nbsp;<span class="num" id="5153309">4</span><span class="op" id="5153310">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153314">has4</span>&nbsp;<span class="op" id="5153319">=</span>&nbsp;<span class="builtintype" id="5153321">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153327">case</span>&nbsp;<span class="num" id="5153332">5</span><span class="op" id="5153333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153337">has5</span>&nbsp;<span class="op" id="5153342">=</span>&nbsp;<span class="builtintype" id="5153344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153354">switch</span>&nbsp;<span class="ident" id="5153361">l</span>&nbsp;<span class="op" id="5153363">:=</span>&nbsp;<span class="ident" id="5153366">e</span><span class="op" id="5153367">.</span><span class="ident" id="5153368">X</span><span class="op" id="5153369">.</span><span class="op" id="5153370">(</span><span class="keyword" id="5153371">type</span><span class="op" id="5153375">)</span>&nbsp;<span class="op" id="5153377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153380">case</span>&nbsp;<span class="op" id="5153385">*</span><span class="ident" id="5153386">ast</span><span class="op" id="5153389">.</span><span class="ident" id="5153390">BinaryExpr</span><span class="op" id="5153400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153404">if</span>&nbsp;<span class="ident" id="5153407">l</span><span class="op" id="5153408">.</span><span class="ident" id="5153409">Op</span><span class="op" id="5153411">.</span><span class="ident" id="5153412">Precedence</span><span class="op" id="5153422">(</span><span class="op" id="5153423">)</span>&nbsp;<span class="op" id="5153425">&lt;</span>&nbsp;<span class="ident" id="5153427">e</span><span class="op" id="5153428">.</span><span class="ident" id="5153429">Op</span><span class="op" id="5153431">.</span><span class="ident" id="5153432">Precedence</span><span class="op" id="5153442">(</span><span class="op" id="5153443">)</span>&nbsp;<span class="op" id="5153445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153450">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153481">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153537">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153549">h4</span><span class="op" id="5153551">,</span>&nbsp;<span class="ident" id="5153553">h5</span><span class="op" id="5153555">,</span>&nbsp;<span class="ident" id="5153557">mp</span>&nbsp;<span class="op" id="5153560">:=</span>&nbsp;<span class="ident" id="5153563">walkBinary</span><span class="op" id="5153573">(</span><span class="ident" id="5153574">l</span><span class="op" id="5153575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153579">has4</span>&nbsp;<span class="op" id="5153584">=</span>&nbsp;<span class="ident" id="5153586">has4</span>&nbsp;<span class="op" id="5153591">||</span>&nbsp;<span class="ident" id="5153594">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153599">has5</span>&nbsp;<span class="op" id="5153604">=</span>&nbsp;<span class="ident" id="5153606">has5</span>&nbsp;<span class="op" id="5153611">||</span>&nbsp;<span class="ident" id="5153614">h5</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153619">if</span>&nbsp;<span class="ident" id="5153622">maxProblem</span>&nbsp;<span class="op" id="5153633">&lt;</span>&nbsp;<span class="ident" id="5153635">mp</span>&nbsp;<span class="op" id="5153638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153643">maxProblem</span>&nbsp;<span class="op" id="5153654">=</span>&nbsp;<span class="ident" id="5153656">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153668">switch</span>&nbsp;<span class="ident" id="5153675">r</span>&nbsp;<span class="op" id="5153677">:=</span>&nbsp;<span class="ident" id="5153680">e</span><span class="op" id="5153681">.</span><span class="ident" id="5153682">Y</span><span class="op" id="5153683">.</span><span class="op" id="5153684">(</span><span class="keyword" id="5153685">type</span><span class="op" id="5153689">)</span>&nbsp;<span class="op" id="5153691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153694">case</span>&nbsp;<span class="op" id="5153699">*</span><span class="ident" id="5153700">ast</span><span class="op" id="5153703">.</span><span class="ident" id="5153704">BinaryExpr</span><span class="op" id="5153714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153718">if</span>&nbsp;<span class="ident" id="5153721">r</span><span class="op" id="5153722">.</span><span class="ident" id="5153723">Op</span><span class="op" id="5153725">.</span><span class="ident" id="5153726">Precedence</span><span class="op" id="5153736">(</span><span class="op" id="5153737">)</span>&nbsp;<span class="op" id="5153739">&lt;=</span>&nbsp;<span class="ident" id="5153742">e</span><span class="op" id="5153743">.</span><span class="ident" id="5153744">Op</span><span class="op" id="5153746">.</span><span class="ident" id="5153747">Precedence</span><span class="op" id="5153757">(</span><span class="op" id="5153758">)</span>&nbsp;<span class="op" id="5153760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153765">//&nbsp;parens&nbsp;will&nbsp;be&nbsp;inserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153796">//&nbsp;pretend&nbsp;this&nbsp;is&nbsp;an&nbsp;*ast.ParenExpr&nbsp;and&nbsp;do&nbsp;nothing.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153852">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153864">h4</span><span class="op" id="5153866">,</span>&nbsp;<span class="ident" id="5153868">h5</span><span class="op" id="5153870">,</span>&nbsp;<span class="ident" id="5153872">mp</span>&nbsp;<span class="op" id="5153875">:=</span>&nbsp;<span class="ident" id="5153878">walkBinary</span><span class="op" id="5153888">(</span><span class="ident" id="5153889">r</span><span class="op" id="5153890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153894">has4</span>&nbsp;<span class="op" id="5153899">=</span>&nbsp;<span class="ident" id="5153901">has4</span>&nbsp;<span class="op" id="5153906">||</span>&nbsp;<span class="ident" id="5153909">h4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153914">has5</span>&nbsp;<span class="op" id="5153919">=</span>&nbsp;<span class="ident" id="5153921">has5</span>&nbsp;<span class="op" id="5153926">||</span>&nbsp;<span class="ident" id="5153929">h5</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153934">if</span>&nbsp;<span class="ident" id="5153937">maxProblem</span>&nbsp;<span class="op" id="5153948">&lt;</span>&nbsp;<span class="ident" id="5153950">mp</span>&nbsp;<span class="op" id="5153953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153958">maxProblem</span>&nbsp;<span class="op" id="5153969">=</span>&nbsp;<span class="ident" id="5153971">mp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153980">case</span>&nbsp;<span class="op" id="5153985">*</span><span class="ident" id="5153986">ast</span><span class="op" id="5153989">.</span><span class="ident" id="5153990">StarExpr</span><span class="op" id="5153998">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154002">if</span>&nbsp;<span class="ident" id="5154005">e</span><span class="op" id="5154006">.</span><span class="ident" id="5154007">Op</span>&nbsp;<span class="op" id="5154010">==</span>&nbsp;<span class="ident" id="5154013">token</span><span class="op" id="5154018">.</span><span class="ident" id="5154019">QUO</span>&nbsp;<span class="op" id="5154023">{</span>&nbsp;<span class="comment" id="5154025">//&nbsp;`*/`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154036">maxProblem</span>&nbsp;<span class="op" id="5154047">=</span>&nbsp;<span class="num" id="5154049">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154057">case</span>&nbsp;<span class="op" id="5154062">*</span><span class="ident" id="5154063">ast</span><span class="op" id="5154066">.</span><span class="ident" id="5154067">UnaryExpr</span><span class="op" id="5154076">:</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154080">switch</span>&nbsp;<span class="ident" id="5154087">e</span><span class="op" id="5154088">.</span><span class="ident" id="5154089">Op</span><span class="op" id="5154091">.</span><span class="ident" id="5154092">String</span><span class="op" id="5154098">(</span><span class="op" id="5154099">)</span>&nbsp;<span class="op" id="5154101">+</span>&nbsp;<span class="ident" id="5154103">r</span><span class="op" id="5154104">.</span><span class="ident" id="5154105">Op</span><span class="op" id="5154107">.</span><span class="ident" id="5154108">String</span><span class="op" id="5154114">(</span><span class="op" id="5154115">)</span>&nbsp;<span class="op" id="5154117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154121">case</span>&nbsp;<span class="string" id="5154126">&#34;/*&#34;</span><span class="op" id="5154130">,</span>&nbsp;<span class="string" id="5154132">&#34;&amp;&amp;&#34;</span><span class="op" id="5154136">,</span>&nbsp;<span class="string" id="5154138">&#34;&amp;^&#34;</span><span class="op" id="5154142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154147">maxProblem</span>&nbsp;<span class="op" id="5154158">=</span>&nbsp;<span class="num" id="5154160">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154164">case</span>&nbsp;<span class="string" id="5154169">&#34;++&#34;</span><span class="op" id="5154173">,</span>&nbsp;<span class="string" id="5154175">&#34;--&#34;</span><span class="op" id="5154179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154184">if</span>&nbsp;<span class="ident" id="5154187">maxProblem</span>&nbsp;<span class="op" id="5154198">&lt;</span>&nbsp;<span class="num" id="5154200">4</span>&nbsp;<span class="op" id="5154202">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154208">maxProblem</span>&nbsp;<span class="op" id="5154219">=</span>&nbsp;<span class="num" id="5154221">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154236">return</span><br>
<span class="lineno">560</span><span class="op" id="5154243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154246">func</span>&nbsp;<span class="ident" id="5154251">cutoff</span><span class="op" id="5154257">(</span><span class="ident" id="5154258">e</span>&nbsp;<span class="op" id="5154260">*</span><span class="ident" id="5154261">ast</span><span class="op" id="5154264">.</span><span class="ident" id="5154265">BinaryExpr</span><span class="op" id="5154275">,</span>&nbsp;<span class="ident" id="5154277">depth</span>&nbsp;<span class="builtintype" id="5154283">int</span><span class="op" id="5154286">)</span>&nbsp;<span class="builtintype" id="5154288">int</span>&nbsp;<span class="op" id="5154292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154295">has4</span><span class="op" id="5154299">,</span>&nbsp;<span class="ident" id="5154301">has5</span><span class="op" id="5154305">,</span>&nbsp;<span class="ident" id="5154307">maxProblem</span>&nbsp;<span class="op" id="5154318">:=</span>&nbsp;<span class="ident" id="5154321">walkBinary</span><span class="op" id="5154331">(</span><span class="ident" id="5154332">e</span><span class="op" id="5154333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154336">if</span>&nbsp;<span class="ident" id="5154339">maxProblem</span>&nbsp;<span class="op" id="5154350">&gt;</span>&nbsp;<span class="num" id="5154352">0</span>&nbsp;<span class="op" id="5154354">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154358">return</span>&nbsp;<span class="ident" id="5154365">maxProblem</span>&nbsp;<span class="op" id="5154376">+</span>&nbsp;<span class="num" id="5154378">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154384">if</span>&nbsp;<span class="ident" id="5154387">has4</span>&nbsp;<span class="op" id="5154392">&amp;&amp;</span>&nbsp;<span class="ident" id="5154395">has5</span>&nbsp;<span class="op" id="5154400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154404">if</span>&nbsp;<span class="ident" id="5154407">depth</span>&nbsp;<span class="op" id="5154413">==</span>&nbsp;<span class="num" id="5154416">1</span>&nbsp;<span class="op" id="5154418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154423">return</span>&nbsp;<span class="num" id="5154430">5</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154438">return</span>&nbsp;<span class="num" id="5154445">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154451">if</span>&nbsp;<span class="ident" id="5154454">depth</span>&nbsp;<span class="op" id="5154460">==</span>&nbsp;<span class="num" id="5154463">1</span>&nbsp;<span class="op" id="5154465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154469">return</span>&nbsp;<span class="num" id="5154476">6</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154482">return</span>&nbsp;<span class="num" id="5154489">4</span><br>
<span class="lineno"></span><span class="op" id="5154491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154494">func</span>&nbsp;<span class="ident" id="5154499">diffPrec</span><span class="op" id="5154507">(</span><span class="ident" id="5154508">expr</span>&nbsp;<span class="ident" id="5154513">ast</span><span class="op" id="5154516">.</span><span class="ident" id="5154517">Expr</span><span class="op" id="5154521">,</span>&nbsp;<span class="ident" id="5154523">prec</span>&nbsp;<span class="builtintype" id="5154528">int</span><span class="op" id="5154531">)</span>&nbsp;<span class="builtintype" id="5154533">int</span>&nbsp;<span class="op" id="5154537">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154540">x</span><span class="op" id="5154541">,</span>&nbsp;<span class="ident" id="5154543">ok</span>&nbsp;<span class="op" id="5154546">:=</span>&nbsp;<span class="ident" id="5154549">expr</span><span class="op" id="5154553">.</span><span class="op" id="5154554">(</span><span class="op" id="5154555">*</span><span class="ident" id="5154556">ast</span><span class="op" id="5154559">.</span><span class="ident" id="5154560">BinaryExpr</span><span class="op" id="5154570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154573">if</span>&nbsp;<span class="op" id="5154576">!</span><span class="ident" id="5154577">ok</span>&nbsp;<span class="op" id="5154580">||</span>&nbsp;<span class="ident" id="5154583">prec</span>&nbsp;<span class="op" id="5154588">!=</span>&nbsp;<span class="ident" id="5154591">x</span><span class="op" id="5154592">.</span><span class="ident" id="5154593">Op</span><span class="op" id="5154595">.</span><span class="ident" id="5154596">Precedence</span><span class="op" id="5154606">(</span><span class="op" id="5154607">)</span>&nbsp;<span class="op" id="5154609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154613">return</span>&nbsp;<span class="num" id="5154620">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154626">return</span>&nbsp;<span class="num" id="5154633">0</span><br>
<span class="lineno">585</span><span class="op" id="5154635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5154638">func</span>&nbsp;<span class="ident" id="5154643">reduceDepth</span><span class="op" id="5154654">(</span><span class="ident" id="5154655">depth</span>&nbsp;<span class="builtintype" id="5154661">int</span><span class="op" id="5154664">)</span>&nbsp;<span class="builtintype" id="5154666">int</span>&nbsp;<span class="op" id="5154670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154673">depth</span><span class="op" id="5154678">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154682">if</span>&nbsp;<span class="ident" id="5154685">depth</span>&nbsp;<span class="op" id="5154691">&lt;</span>&nbsp;<span class="num" id="5154693">1</span>&nbsp;<span class="op" id="5154695">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154699">depth</span>&nbsp;<span class="op" id="5154705">=</span>&nbsp;<span class="num" id="5154707">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154713">return</span>&nbsp;<span class="ident" id="5154720">depth</span><br>
<span class="lineno"></span><span class="op" id="5154726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="5154729">//&nbsp;Format&nbsp;the&nbsp;binary&nbsp;expression:&nbsp;decide&nbsp;the&nbsp;cutoff&nbsp;and&nbsp;then&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5154797">//&nbsp;Let&#39;s&nbsp;call&nbsp;depth&nbsp;==&nbsp;1&nbsp;Normal&nbsp;mode,&nbsp;and&nbsp;depth&nbsp;&gt;&nbsp;1&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5154863">//&nbsp;(Algorithm&nbsp;suggestion&nbsp;by&nbsp;Russ&nbsp;Cox.)</span><br>
<span class="lineno"></span><span class="comment" id="5154902">//</span><br>
<span class="lineno"></span><span class="comment" id="5154905">//&nbsp;The&nbsp;precedences&nbsp;are:</span><br>
<span class="lineno">600</span><span class="comment" id="5154929">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;%&nbsp;&nbsp;&lt;&lt;&nbsp;&nbsp;&gt;&gt;&nbsp;&nbsp;&amp;&nbsp;&nbsp;&amp;^</span><br>
<span class="lineno"></span><span class="comment" id="5154969">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;|&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="5154997">//&nbsp;&nbsp;&nbsp;&nbsp3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;&nbsp;!=&nbsp;&nbsp;&lt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;&nbsp;&nbsp;&gt;=</span><br>
<span class="lineno"></span><span class="comment" id="5155035">//&nbsp;&nbsp;&nbsp;&nbsp2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;</span><br>
<span class="lineno"></span><span class="comment" id="5155055">//&nbsp;&nbsp;&nbsp;&nbsp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||</span><br>
<span class="lineno">605</span><span class="comment" id="5155075">//</span><br>
<span class="lineno"></span><span class="comment" id="5155078">//&nbsp;The&nbsp;only&nbsp;decision&nbsp;is&nbsp;whether&nbsp;there&nbsp;will&nbsp;be&nbsp;spaces&nbsp;around&nbsp;levels&nbsp;4&nbsp;and&nbsp;5.</span><br>
<span class="lineno"></span><span class="comment" id="5155154">//&nbsp;There&nbsp;are&nbsp;never&nbsp;spaces&nbsp;at&nbsp;level&nbsp;6&nbsp;(unary),&nbsp;and&nbsp;always&nbsp;spaces&nbsp;at&nbsp;levels&nbsp;3&nbsp;and&nbsp;below.</span><br>
<span class="lineno"></span><span class="comment" id="5155241">//</span><br>
<span class="lineno"></span><span class="comment" id="5155244">//&nbsp;To&nbsp;choose&nbsp;the&nbsp;cutoff,&nbsp;look&nbsp;at&nbsp;the&nbsp;whole&nbsp;expression&nbsp;but&nbsp;excluding&nbsp;primary</span><br>
<span class="lineno">610</span><span class="comment" id="5155320">//&nbsp;expressions&nbsp;(function&nbsp;calls,&nbsp;parenthesized&nbsp;exprs),&nbsp;and&nbsp;apply&nbsp;these&nbsp;rules:</span><br>
<span class="lineno"></span><span class="comment" id="5155397">//</span><br>
<span class="lineno"></span><span class="comment" id="5155400">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;binary&nbsp;operator&nbsp;with&nbsp;a&nbsp;right&nbsp;side&nbsp;unary&nbsp;operand</span><br>
<span class="lineno"></span><span class="comment" id="5155468">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;would&nbsp;clash&nbsp;without&nbsp;a&nbsp;space,&nbsp;the&nbsp;cutoff&nbsp;must&nbsp;be&nbsp;(in&nbsp;order):</span><br>
<span class="lineno"></span><span class="comment" id="5155539">//</span><br>
<span class="lineno">615</span><span class="comment" id="5155542">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp/*&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5155551">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5155560">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&amp;^&nbsp;&nbsp;&nbsp;&nbsp6</span><br>
<span class="lineno"></span><span class="comment" id="5155569">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp++&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno"></span><span class="comment" id="5155578">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp--&nbsp;&nbsp;&nbsp;&nbsp5</span><br>
<span class="lineno">620</span><span class="comment" id="5155587">//</span><br>
<span class="lineno"></span><span class="comment" id="5155590">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Comparison&nbsp;operators&nbsp;always&nbsp;have&nbsp;spaces&nbsp;around&nbsp;them.)</span><br>
<span class="lineno"></span><span class="comment" id="5155656">//</span><br>
<span class="lineno"></span><span class="comment" id="5155659">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;mix&nbsp;of&nbsp;level&nbsp;5&nbsp;and&nbsp;level&nbsp;4&nbsp;operators,&nbsp;then&nbsp;the&nbsp;cutoff</span><br>
<span class="lineno"></span><span class="comment" id="5155733">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;is&nbsp;5&nbsp;(use&nbsp;spaces&nbsp;to&nbsp;distinguish&nbsp;precedence)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno">625</span><span class="comment" id="5155798">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno"></span><span class="comment" id="5155846">//</span><br>
<span class="lineno"></span><span class="comment" id="5155849">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;level&nbsp;4&nbsp;operators&nbsp;or&nbsp;no&nbsp;level&nbsp;5&nbsp;operators,&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5155923">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;cutoff&nbsp;is&nbsp;6&nbsp;(always&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Normal&nbsp;mode</span><br>
<span class="lineno"></span><span class="comment" id="5155976">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;and&nbsp;4&nbsp;(never&nbsp;use&nbsp;spaces)&nbsp;in&nbsp;Compact&nbsp;mode.</span><br>
<span class="lineno">630</span><span class="comment" id="5156024">//</span><br>
<span class="lineno"></span><span class="keyword" id="5156027">func</span>&nbsp;<span class="op" id="5156032">(</span><span class="ident" id="5156033">p</span>&nbsp;<span class="op" id="5156035">*</span><span class="ident" id="5156036">printer</span><span class="op" id="5156043">)</span>&nbsp;<span class="ident" id="5156045">binaryExpr</span><span class="op" id="5156055">(</span><span class="ident" id="5156056">x</span>&nbsp;<span class="op" id="5156058">*</span><span class="ident" id="5156059">ast</span><span class="op" id="5156062">.</span><span class="ident" id="5156063">BinaryExpr</span><span class="op" id="5156073">,</span>&nbsp;<span class="ident" id="5156075">prec1</span><span class="op" id="5156080">,</span>&nbsp;<span class="ident" id="5156082">cutoff</span><span class="op" id="5156088">,</span>&nbsp;<span class="ident" id="5156090">depth</span>&nbsp;<span class="builtintype" id="5156096">int</span><span class="op" id="5156099">)</span>&nbsp;<span class="op" id="5156101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156104">prec</span>&nbsp;<span class="op" id="5156109">:=</span>&nbsp;<span class="ident" id="5156112">x</span><span class="op" id="5156113">.</span><span class="ident" id="5156114">Op</span><span class="op" id="5156116">.</span><span class="ident" id="5156117">Precedence</span><span class="op" id="5156127">(</span><span class="op" id="5156128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156131">if</span>&nbsp;<span class="ident" id="5156134">prec</span>&nbsp;<span class="op" id="5156139">&lt;</span>&nbsp;<span class="ident" id="5156141">prec1</span>&nbsp;<span class="op" id="5156147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156151">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156175">//&nbsp;Note:&nbsp;The&nbsp;parser&nbsp;inserts&nbsp;an&nbsp;ast.ParenExpr&nbsp;node;&nbsp;thus&nbsp;this&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156243">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;only&nbsp;occur&nbsp;if&nbsp;the&nbsp;AST&nbsp;is&nbsp;created&nbsp;in&nbsp;a&nbsp;different&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156311">p</span><span class="op" id="5156312">.</span><span class="builtinfunc" id="5156313">print</span><span class="op" id="5156318">(</span><span class="ident" id="5156319">token</span><span class="op" id="5156324">.</span><span class="ident" id="5156325">LPAREN</span><span class="op" id="5156331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156335">p</span><span class="op" id="5156336">.</span><span class="ident" id="5156337">expr0</span><span class="op" id="5156342">(</span><span class="ident" id="5156343">x</span><span class="op" id="5156344">,</span>&nbsp;<span class="ident" id="5156346">reduceDepth</span><span class="op" id="5156357">(</span><span class="ident" id="5156358">depth</span><span class="op" id="5156363">)</span><span class="op" id="5156364">)</span>&nbsp;<span class="comment" id="5156366">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156407">p</span><span class="op" id="5156408">.</span><span class="builtinfunc" id="5156409">print</span><span class="op" id="5156414">(</span><span class="ident" id="5156415">token</span><span class="op" id="5156420">.</span><span class="ident" id="5156421">RPAREN</span><span class="op" id="5156427">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156431">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156443">printBlank</span>&nbsp;<span class="op" id="5156454">:=</span>&nbsp;<span class="ident" id="5156457">prec</span>&nbsp;<span class="op" id="5156462">&lt;</span>&nbsp;<span class="ident" id="5156464">cutoff</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156473">ws</span>&nbsp;<span class="op" id="5156476">:=</span>&nbsp;<span class="ident" id="5156479">indent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156487">p</span><span class="op" id="5156488">.</span><span class="ident" id="5156489">expr1</span><span class="op" id="5156494">(</span><span class="ident" id="5156495">x</span><span class="op" id="5156496">.</span><span class="ident" id="5156497">X</span><span class="op" id="5156498">,</span>&nbsp;<span class="ident" id="5156500">prec</span><span class="op" id="5156504">,</span>&nbsp;<span class="ident" id="5156506">depth</span><span class="op" id="5156511">+</span><span class="ident" id="5156512">diffPrec</span><span class="op" id="5156520">(</span><span class="ident" id="5156521">x</span><span class="op" id="5156522">.</span><span class="ident" id="5156523">X</span><span class="op" id="5156524">,</span>&nbsp;<span class="ident" id="5156526">prec</span><span class="op" id="5156530">)</span><span class="op" id="5156531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156534">if</span>&nbsp;<span class="ident" id="5156537">printBlank</span>&nbsp;<span class="op" id="5156548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156552">p</span><span class="op" id="5156553">.</span><span class="builtinfunc" id="5156554">print</span><span class="op" id="5156559">(</span><span class="ident" id="5156560">blank</span><span class="op" id="5156565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156568">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156571">xline</span>&nbsp;<span class="op" id="5156577">:=</span>&nbsp;<span class="ident" id="5156580">p</span><span class="op" id="5156581">.</span><span class="ident" id="5156582">pos</span><span class="op" id="5156585">.</span><span class="ident" id="5156586">Line</span>&nbsp;<span class="comment" id="5156591">//&nbsp;before&nbsp;the&nbsp;operator&nbsp;(it&nbsp;may&nbsp;be&nbsp;on&nbsp;the&nbsp;next&nbsp;line!)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156645">yline</span>&nbsp;<span class="op" id="5156651">:=</span>&nbsp;<span class="ident" id="5156654">p</span><span class="op" id="5156655">.</span><span class="ident" id="5156656">lineFor</span><span class="op" id="5156663">(</span><span class="ident" id="5156664">x</span><span class="op" id="5156665">.</span><span class="ident" id="5156666">Y</span><span class="op" id="5156667">.</span><span class="ident" id="5156668">Pos</span><span class="op" id="5156671">(</span><span class="op" id="5156672">)</span><span class="op" id="5156673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156676">p</span><span class="op" id="5156677">.</span><span class="builtinfunc" id="5156678">print</span><span class="op" id="5156683">(</span><span class="ident" id="5156684">x</span><span class="op" id="5156685">.</span><span class="ident" id="5156686">OpPos</span><span class="op" id="5156691">,</span>&nbsp;<span class="ident" id="5156693">x</span><span class="op" id="5156694">.</span><span class="ident" id="5156695">Op</span><span class="op" id="5156697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156700">if</span>&nbsp;<span class="ident" id="5156703">xline</span>&nbsp;<span class="op" id="5156709">!=</span>&nbsp;<span class="ident" id="5156712">yline</span>&nbsp;<span class="op" id="5156718">&amp;&amp;</span>&nbsp;<span class="ident" id="5156721">xline</span>&nbsp;<span class="op" id="5156727">&gt;</span>&nbsp;<span class="num" id="5156729">0</span>&nbsp;<span class="op" id="5156731">&amp;&amp;</span>&nbsp;<span class="ident" id="5156734">yline</span>&nbsp;<span class="op" id="5156740">&gt;</span>&nbsp;<span class="num" id="5156742">0</span>&nbsp;<span class="op" id="5156744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156748">//&nbsp;at&nbsp;least&nbsp;one&nbsp;line&nbsp;break,&nbsp;but&nbsp;respect&nbsp;an&nbsp;extra&nbsp;empty&nbsp;line</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156810">//&nbsp;in&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156829">if</span>&nbsp;<span class="ident" id="5156832">p</span><span class="op" id="5156833">.</span><span class="ident" id="5156834">linebreak</span><span class="op" id="5156843">(</span><span class="ident" id="5156844">yline</span><span class="op" id="5156849">,</span>&nbsp;<span class="num" id="5156851">1</span><span class="op" id="5156852">,</span>&nbsp;<span class="ident" id="5156854">ws</span><span class="op" id="5156856">,</span>&nbsp;<span class="builtintype" id="5156858">true</span><span class="op" id="5156862">)</span>&nbsp;<span class="op" id="5156864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156869">ws</span>&nbsp;<span class="op" id="5156872">=</span>&nbsp;<span class="ident" id="5156874">ignore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156884">printBlank</span>&nbsp;<span class="op" id="5156895">=</span>&nbsp;<span class="builtintype" id="5156897">false</span>&nbsp;<span class="comment" id="5156903">//&nbsp;no&nbsp;blank&nbsp;after&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156934">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156940">if</span>&nbsp;<span class="ident" id="5156943">printBlank</span>&nbsp;<span class="op" id="5156954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156958">p</span><span class="op" id="5156959">.</span><span class="builtinfunc" id="5156960">print</span><span class="op" id="5156965">(</span><span class="ident" id="5156966">blank</span><span class="op" id="5156971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156977">p</span><span class="op" id="5156978">.</span><span class="ident" id="5156979">expr1</span><span class="op" id="5156984">(</span><span class="ident" id="5156985">x</span><span class="op" id="5156986">.</span><span class="ident" id="5156987">Y</span><span class="op" id="5156988">,</span>&nbsp;<span class="ident" id="5156990">prec</span><span class="op" id="5156994">+</span><span class="num" id="5156995">1</span><span class="op" id="5156996">,</span>&nbsp;<span class="ident" id="5156998">depth</span><span class="op" id="5157003">+</span><span class="num" id="5157004">1</span><span class="op" id="5157005">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157008">if</span>&nbsp;<span class="ident" id="5157011">ws</span>&nbsp;<span class="op" id="5157014">==</span>&nbsp;<span class="ident" id="5157017">ignore</span>&nbsp;<span class="op" id="5157024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157028">p</span><span class="op" id="5157029">.</span><span class="builtinfunc" id="5157030">print</span><span class="op" id="5157035">(</span><span class="ident" id="5157036">unindent</span><span class="op" id="5157044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157047">}</span><br>
<span class="lineno"></span><span class="op" id="5157049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="keyword" id="5157052">func</span>&nbsp;<span class="ident" id="5157057">isBinary</span><span class="op" id="5157065">(</span><span class="ident" id="5157066">expr</span>&nbsp;<span class="ident" id="5157071">ast</span><span class="op" id="5157074">.</span><span class="ident" id="5157075">Expr</span><span class="op" id="5157079">)</span>&nbsp;<span class="builtintype" id="5157081">bool</span>&nbsp;<span class="op" id="5157086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157089">_</span><span class="op" id="5157090">,</span>&nbsp;<span class="ident" id="5157092">ok</span>&nbsp;<span class="op" id="5157095">:=</span>&nbsp;<span class="ident" id="5157098">expr</span><span class="op" id="5157102">.</span><span class="op" id="5157103">(</span><span class="op" id="5157104">*</span><span class="ident" id="5157105">ast</span><span class="op" id="5157108">.</span><span class="ident" id="5157109">BinaryExpr</span><span class="op" id="5157119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157122">return</span>&nbsp;<span class="ident" id="5157129">ok</span><br>
<span class="lineno"></span><span class="op" id="5157132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5157135">func</span>&nbsp;<span class="op" id="5157140">(</span><span class="ident" id="5157141">p</span>&nbsp;<span class="op" id="5157143">*</span><span class="ident" id="5157144">printer</span><span class="op" id="5157151">)</span>&nbsp;<span class="ident" id="5157153">expr1</span><span class="op" id="5157158">(</span><span class="ident" id="5157159">expr</span>&nbsp;<span class="ident" id="5157164">ast</span><span class="op" id="5157167">.</span><span class="ident" id="5157168">Expr</span><span class="op" id="5157172">,</span>&nbsp;<span class="ident" id="5157174">prec1</span><span class="op" id="5157179">,</span>&nbsp;<span class="ident" id="5157181">depth</span>&nbsp;<span class="builtintype" id="5157187">int</span><span class="op" id="5157190">)</span>&nbsp;<span class="op" id="5157192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157195">p</span><span class="op" id="5157196">.</span><span class="builtinfunc" id="5157197">print</span><span class="op" id="5157202">(</span><span class="ident" id="5157203">expr</span><span class="op" id="5157207">.</span><span class="ident" id="5157208">Pos</span><span class="op" id="5157211">(</span><span class="op" id="5157212">)</span><span class="op" id="5157213">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157217">switch</span>&nbsp;<span class="ident" id="5157224">x</span>&nbsp;<span class="op" id="5157226">:=</span>&nbsp;<span class="ident" id="5157229">expr</span><span class="op" id="5157233">.</span><span class="op" id="5157234">(</span><span class="keyword" id="5157235">type</span><span class="op" id="5157239">)</span>&nbsp;<span class="op" id="5157241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157244">case</span>&nbsp;<span class="op" id="5157249">*</span><span class="ident" id="5157250">ast</span><span class="op" id="5157253">.</span><span class="ident" id="5157254">BadExpr</span><span class="op" id="5157261">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157265">p</span><span class="op" id="5157266">.</span><span class="builtinfunc" id="5157267">print</span><span class="op" id="5157272">(</span><span class="string" id="5157273">&#34;BadExpr&#34;</span><span class="op" id="5157282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157286">case</span>&nbsp;<span class="op" id="5157291">*</span><span class="ident" id="5157292">ast</span><span class="op" id="5157295">.</span><span class="ident" id="5157296">Ident</span><span class="op" id="5157301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157305">p</span><span class="op" id="5157306">.</span><span class="builtinfunc" id="5157307">print</span><span class="op" id="5157312">(</span><span class="ident" id="5157313">x</span><span class="op" id="5157314">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157318">case</span>&nbsp;<span class="op" id="5157323">*</span><span class="ident" id="5157324">ast</span><span class="op" id="5157327">.</span><span class="ident" id="5157328">BinaryExpr</span><span class="op" id="5157338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157342">if</span>&nbsp;<span class="ident" id="5157345">depth</span>&nbsp;<span class="op" id="5157351">&lt;</span>&nbsp;<span class="num" id="5157353">1</span>&nbsp;<span class="op" id="5157355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157360">p</span><span class="op" id="5157361">.</span><span class="ident" id="5157362">internalError</span><span class="op" id="5157375">(</span><span class="string" id="5157376">&#34;depth&nbsp;&lt;&nbsp;1:&#34;</span><span class="op" id="5157388">,</span>&nbsp;<span class="ident" id="5157390">depth</span><span class="op" id="5157395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157400">depth</span>&nbsp;<span class="op" id="5157406">=</span>&nbsp;<span class="num" id="5157408">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157412">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157416">p</span><span class="op" id="5157417">.</span><span class="ident" id="5157418">binaryExpr</span><span class="op" id="5157428">(</span><span class="ident" id="5157429">x</span><span class="op" id="5157430">,</span>&nbsp;<span class="ident" id="5157432">prec1</span><span class="op" id="5157437">,</span>&nbsp;<span class="ident" id="5157439">cutoff</span><span class="op" id="5157445">(</span><span class="ident" id="5157446">x</span><span class="op" id="5157447">,</span>&nbsp;<span class="ident" id="5157449">depth</span><span class="op" id="5157454">)</span><span class="op" id="5157455">,</span>&nbsp;<span class="ident" id="5157457">depth</span><span class="op" id="5157462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157466">case</span>&nbsp;<span class="op" id="5157471">*</span><span class="ident" id="5157472">ast</span><span class="op" id="5157475">.</span><span class="ident" id="5157476">KeyValueExpr</span><span class="op" id="5157488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157492">p</span><span class="op" id="5157493">.</span><span class="ident" id="5157494">expr</span><span class="op" id="5157498">(</span><span class="ident" id="5157499">x</span><span class="op" id="5157500">.</span><span class="ident" id="5157501">Key</span><span class="op" id="5157504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157508">p</span><span class="op" id="5157509">.</span><span class="builtinfunc" id="5157510">print</span><span class="op" id="5157515">(</span><span class="ident" id="5157516">x</span><span class="op" id="5157517">.</span><span class="ident" id="5157518">Colon</span><span class="op" id="5157523">,</span>&nbsp;<span class="ident" id="5157525">token</span><span class="op" id="5157530">.</span><span class="ident" id="5157531">COLON</span><span class="op" id="5157536">,</span>&nbsp;<span class="ident" id="5157538">blank</span><span class="op" id="5157543">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157547">p</span><span class="op" id="5157548">.</span><span class="ident" id="5157549">expr</span><span class="op" id="5157553">(</span><span class="ident" id="5157554">x</span><span class="op" id="5157555">.</span><span class="ident" id="5157556">Value</span><span class="op" id="5157561">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157565">case</span>&nbsp;<span class="op" id="5157570">*</span><span class="ident" id="5157571">ast</span><span class="op" id="5157574">.</span><span class="ident" id="5157575">StarExpr</span><span class="op" id="5157583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157587">const</span>&nbsp;<span class="ident" id="5157593">prec</span>&nbsp;<span class="op" id="5157598">=</span>&nbsp;<span class="ident" id="5157600">token</span><span class="op" id="5157605">.</span><span class="ident" id="5157606">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157618">if</span>&nbsp;<span class="ident" id="5157621">prec</span>&nbsp;<span class="op" id="5157626">&lt;</span>&nbsp;<span class="ident" id="5157628">prec1</span>&nbsp;<span class="op" id="5157634">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5157639">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157664">p</span><span class="op" id="5157665">.</span><span class="builtinfunc" id="5157666">print</span><span class="op" id="5157671">(</span><span class="ident" id="5157672">token</span><span class="op" id="5157677">.</span><span class="ident" id="5157678">LPAREN</span><span class="op" id="5157684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157689">p</span><span class="op" id="5157690">.</span><span class="builtinfunc" id="5157691">print</span><span class="op" id="5157696">(</span><span class="ident" id="5157697">token</span><span class="op" id="5157702">.</span><span class="ident" id="5157703">MUL</span><span class="op" id="5157706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157711">p</span><span class="op" id="5157712">.</span><span class="ident" id="5157713">expr</span><span class="op" id="5157717">(</span><span class="ident" id="5157718">x</span><span class="op" id="5157719">.</span><span class="ident" id="5157720">X</span><span class="op" id="5157721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157726">p</span><span class="op" id="5157727">.</span><span class="builtinfunc" id="5157728">print</span><span class="op" id="5157733">(</span><span class="ident" id="5157734">token</span><span class="op" id="5157739">.</span><span class="ident" id="5157740">RPAREN</span><span class="op" id="5157746">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157750">}</span>&nbsp;<span class="keyword" id="5157752">else</span>&nbsp;<span class="op" id="5157757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5157762">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157790">p</span><span class="op" id="5157791">.</span><span class="builtinfunc" id="5157792">print</span><span class="op" id="5157797">(</span><span class="ident" id="5157798">token</span><span class="op" id="5157803">.</span><span class="ident" id="5157804">MUL</span><span class="op" id="5157807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157812">p</span><span class="op" id="5157813">.</span><span class="ident" id="5157814">expr</span><span class="op" id="5157818">(</span><span class="ident" id="5157819">x</span><span class="op" id="5157820">.</span><span class="ident" id="5157821">X</span><span class="op" id="5157822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157826">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157830">case</span>&nbsp;<span class="op" id="5157835">*</span><span class="ident" id="5157836">ast</span><span class="op" id="5157839">.</span><span class="ident" id="5157840">UnaryExpr</span><span class="op" id="5157849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157853">const</span>&nbsp;<span class="ident" id="5157859">prec</span>&nbsp;<span class="op" id="5157864">=</span>&nbsp;<span class="ident" id="5157866">token</span><span class="op" id="5157871">.</span><span class="ident" id="5157872">UnaryPrec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157884">if</span>&nbsp;<span class="ident" id="5157887">prec</span>&nbsp;<span class="op" id="5157892">&lt;</span>&nbsp;<span class="ident" id="5157894">prec1</span>&nbsp;<span class="op" id="5157900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5157905">//&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157930">p</span><span class="op" id="5157931">.</span><span class="builtinfunc" id="5157932">print</span><span class="op" id="5157937">(</span><span class="ident" id="5157938">token</span><span class="op" id="5157943">.</span><span class="ident" id="5157944">LPAREN</span><span class="op" id="5157950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157955">p</span><span class="op" id="5157956">.</span><span class="ident" id="5157957">expr</span><span class="op" id="5157961">(</span><span class="ident" id="5157962">x</span><span class="op" id="5157963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157968">p</span><span class="op" id="5157969">.</span><span class="builtinfunc" id="5157970">print</span><span class="op" id="5157975">(</span><span class="ident" id="5157976">token</span><span class="op" id="5157981">.</span><span class="ident" id="5157982">RPAREN</span><span class="op" id="5157988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157992">}</span>&nbsp;<span class="keyword" id="5157994">else</span>&nbsp;<span class="op" id="5157999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158004">//&nbsp;no&nbsp;parenthesis&nbsp;needed</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158032">p</span><span class="op" id="5158033">.</span><span class="builtinfunc" id="5158034">print</span><span class="op" id="5158039">(</span><span class="ident" id="5158040">x</span><span class="op" id="5158041">.</span><span class="ident" id="5158042">Op</span><span class="op" id="5158044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158049">if</span>&nbsp;<span class="ident" id="5158052">x</span><span class="op" id="5158053">.</span><span class="ident" id="5158054">Op</span>&nbsp;<span class="op" id="5158057">==</span>&nbsp;<span class="ident" id="5158060">token</span><span class="op" id="5158065">.</span><span class="ident" id="5158066">RANGE</span>&nbsp;<span class="op" id="5158072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158078">//&nbsp;TODO(gri)&nbsp;Remove&nbsp;this&nbsp;code&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;reached.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158137">p</span><span class="op" id="5158138">.</span><span class="builtinfunc" id="5158139">print</span><span class="op" id="5158144">(</span><span class="ident" id="5158145">blank</span><span class="op" id="5158150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158155">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158160">p</span><span class="op" id="5158161">.</span><span class="ident" id="5158162">expr1</span><span class="op" id="5158167">(</span><span class="ident" id="5158168">x</span><span class="op" id="5158169">.</span><span class="ident" id="5158170">X</span><span class="op" id="5158171">,</span>&nbsp;<span class="ident" id="5158173">prec</span><span class="op" id="5158177">,</span>&nbsp;<span class="ident" id="5158179">depth</span><span class="op" id="5158184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158192">case</span>&nbsp;<span class="op" id="5158197">*</span><span class="ident" id="5158198">ast</span><span class="op" id="5158201">.</span><span class="ident" id="5158202">BasicLit</span><span class="op" id="5158210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158214">p</span><span class="op" id="5158215">.</span><span class="builtinfunc" id="5158216">print</span><span class="op" id="5158221">(</span><span class="ident" id="5158222">x</span><span class="op" id="5158223">)</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158227">case</span>&nbsp;<span class="op" id="5158232">*</span><span class="ident" id="5158233">ast</span><span class="op" id="5158236">.</span><span class="ident" id="5158237">FuncLit</span><span class="op" id="5158244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158248">p</span><span class="op" id="5158249">.</span><span class="ident" id="5158250">expr</span><span class="op" id="5158254">(</span><span class="ident" id="5158255">x</span><span class="op" id="5158256">.</span><span class="ident" id="5158257">Type</span><span class="op" id="5158261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158265">p</span><span class="op" id="5158266">.</span><span class="ident" id="5158267">adjBlock</span><span class="op" id="5158275">(</span><span class="ident" id="5158276">p</span><span class="op" id="5158277">.</span><span class="ident" id="5158278">distanceFrom</span><span class="op" id="5158290">(</span><span class="ident" id="5158291">x</span><span class="op" id="5158292">.</span><span class="ident" id="5158293">Type</span><span class="op" id="5158297">.</span><span class="ident" id="5158298">Pos</span><span class="op" id="5158301">(</span><span class="op" id="5158302">)</span><span class="op" id="5158303">)</span><span class="op" id="5158304">,</span>&nbsp;<span class="ident" id="5158306">blank</span><span class="op" id="5158311">,</span>&nbsp;<span class="ident" id="5158313">x</span><span class="op" id="5158314">.</span><span class="ident" id="5158315">Body</span><span class="op" id="5158319">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158323">case</span>&nbsp;<span class="op" id="5158328">*</span><span class="ident" id="5158329">ast</span><span class="op" id="5158332">.</span><span class="ident" id="5158333">ParenExpr</span><span class="op" id="5158342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158346">if</span>&nbsp;<span class="ident" id="5158349">_</span><span class="op" id="5158350">,</span>&nbsp;<span class="ident" id="5158352">hasParens</span>&nbsp;<span class="op" id="5158362">:=</span>&nbsp;<span class="ident" id="5158365">x</span><span class="op" id="5158366">.</span><span class="ident" id="5158367">X</span><span class="op" id="5158368">.</span><span class="op" id="5158369">(</span><span class="op" id="5158370">*</span><span class="ident" id="5158371">ast</span><span class="op" id="5158374">.</span><span class="ident" id="5158375">ParenExpr</span><span class="op" id="5158384">)</span><span class="op" id="5158385">;</span>&nbsp;<span class="ident" id="5158387">hasParens</span>&nbsp;<span class="op" id="5158397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158402">//&nbsp;don&#39;t&nbsp;print&nbsp;parentheses&nbsp;around&nbsp;an&nbsp;already&nbsp;parenthesized&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158475">//&nbsp;TODO(gri)&nbsp;consider&nbsp;making&nbsp;this&nbsp;more&nbsp;general&nbsp;and&nbsp;incorporate&nbsp;precedence&nbsp;levels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158559">p</span><span class="op" id="5158560">.</span><span class="ident" id="5158561">expr0</span><span class="op" id="5158566">(</span><span class="ident" id="5158567">x</span><span class="op" id="5158568">.</span><span class="ident" id="5158569">X</span><span class="op" id="5158570">,</span>&nbsp;<span class="ident" id="5158572">depth</span><span class="op" id="5158577">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158581">}</span>&nbsp;<span class="keyword" id="5158583">else</span>&nbsp;<span class="op" id="5158588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158593">p</span><span class="op" id="5158594">.</span><span class="builtinfunc" id="5158595">print</span><span class="op" id="5158600">(</span><span class="ident" id="5158601">token</span><span class="op" id="5158606">.</span><span class="ident" id="5158607">LPAREN</span><span class="op" id="5158613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158618">p</span><span class="op" id="5158619">.</span><span class="ident" id="5158620">expr0</span><span class="op" id="5158625">(</span><span class="ident" id="5158626">x</span><span class="op" id="5158627">.</span><span class="ident" id="5158628">X</span><span class="op" id="5158629">,</span>&nbsp;<span class="ident" id="5158631">reduceDepth</span><span class="op" id="5158642">(</span><span class="ident" id="5158643">depth</span><span class="op" id="5158648">)</span><span class="op" id="5158649">)</span>&nbsp;<span class="comment" id="5158651">//&nbsp;parentheses&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158693">p</span><span class="op" id="5158694">.</span><span class="builtinfunc" id="5158695">print</span><span class="op" id="5158700">(</span><span class="ident" id="5158701">x</span><span class="op" id="5158702">.</span><span class="ident" id="5158703">Rparen</span><span class="op" id="5158709">,</span>&nbsp;<span class="ident" id="5158711">token</span><span class="op" id="5158716">.</span><span class="ident" id="5158717">RPAREN</span><span class="op" id="5158723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158727">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158731">case</span>&nbsp;<span class="op" id="5158736">*</span><span class="ident" id="5158737">ast</span><span class="op" id="5158740">.</span><span class="ident" id="5158741">SelectorExpr</span><span class="op" id="5158753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158757">p</span><span class="op" id="5158758">.</span><span class="ident" id="5158759">expr1</span><span class="op" id="5158764">(</span><span class="ident" id="5158765">x</span><span class="op" id="5158766">.</span><span class="ident" id="5158767">X</span><span class="op" id="5158768">,</span>&nbsp;<span class="ident" id="5158770">token</span><span class="op" id="5158775">.</span><span class="ident" id="5158776">HighestPrec</span><span class="op" id="5158787">,</span>&nbsp;<span class="ident" id="5158789">depth</span><span class="op" id="5158794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158798">p</span><span class="op" id="5158799">.</span><span class="builtinfunc" id="5158800">print</span><span class="op" id="5158805">(</span><span class="ident" id="5158806">token</span><span class="op" id="5158811">.</span><span class="ident" id="5158812">PERIOD</span><span class="op" id="5158818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158822">if</span>&nbsp;<span class="ident" id="5158825">line</span>&nbsp;<span class="op" id="5158830">:=</span>&nbsp;<span class="ident" id="5158833">p</span><span class="op" id="5158834">.</span><span class="ident" id="5158835">lineFor</span><span class="op" id="5158842">(</span><span class="ident" id="5158843">x</span><span class="op" id="5158844">.</span><span class="ident" id="5158845">Sel</span><span class="op" id="5158848">.</span><span class="ident" id="5158849">Pos</span><span class="op" id="5158852">(</span><span class="op" id="5158853">)</span><span class="op" id="5158854">)</span><span class="op" id="5158855">;</span>&nbsp;<span class="ident" id="5158857">p</span><span class="op" id="5158858">.</span><span class="ident" id="5158859">pos</span><span class="op" id="5158862">.</span><span class="ident" id="5158863">IsValid</span><span class="op" id="5158870">(</span><span class="op" id="5158871">)</span>&nbsp;<span class="op" id="5158873">&amp;&amp;</span>&nbsp;<span class="ident" id="5158876">p</span><span class="op" id="5158877">.</span><span class="ident" id="5158878">pos</span><span class="op" id="5158881">.</span><span class="ident" id="5158882">Line</span>&nbsp;<span class="op" id="5158887">&lt;</span>&nbsp;<span class="ident" id="5158889">line</span>&nbsp;<span class="op" id="5158894">{</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158899">p</span><span class="op" id="5158900">.</span><span class="builtinfunc" id="5158901">print</span><span class="op" id="5158906">(</span><span class="ident" id="5158907">indent</span><span class="op" id="5158913">,</span>&nbsp;<span class="ident" id="5158915">newline</span><span class="op" id="5158922">,</span>&nbsp;<span class="ident" id="5158924">x</span><span class="op" id="5158925">.</span><span class="ident" id="5158926">Sel</span><span class="op" id="5158929">.</span><span class="ident" id="5158930">Pos</span><span class="op" id="5158933">(</span><span class="op" id="5158934">)</span><span class="op" id="5158935">,</span>&nbsp;<span class="ident" id="5158937">x</span><span class="op" id="5158938">.</span><span class="ident" id="5158939">Sel</span><span class="op" id="5158942">,</span>&nbsp;<span class="ident" id="5158944">unindent</span><span class="op" id="5158952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158956">}</span>&nbsp;<span class="keyword" id="5158958">else</span>&nbsp;<span class="op" id="5158963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158968">p</span><span class="op" id="5158969">.</span><span class="builtinfunc" id="5158970">print</span><span class="op" id="5158975">(</span><span class="ident" id="5158976">x</span><span class="op" id="5158977">.</span><span class="ident" id="5158978">Sel</span><span class="op" id="5158981">.</span><span class="ident" id="5158982">Pos</span><span class="op" id="5158985">(</span><span class="op" id="5158986">)</span><span class="op" id="5158987">,</span>&nbsp;<span class="ident" id="5158989">x</span><span class="op" id="5158990">.</span><span class="ident" id="5158991">Sel</span><span class="op" id="5158994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159002">case</span>&nbsp;<span class="op" id="5159007">*</span><span class="ident" id="5159008">ast</span><span class="op" id="5159011">.</span><span class="ident" id="5159012">TypeAssertExpr</span><span class="op" id="5159026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159030">p</span><span class="op" id="5159031">.</span><span class="ident" id="5159032">expr1</span><span class="op" id="5159037">(</span><span class="ident" id="5159038">x</span><span class="op" id="5159039">.</span><span class="ident" id="5159040">X</span><span class="op" id="5159041">,</span>&nbsp;<span class="ident" id="5159043">token</span><span class="op" id="5159048">.</span><span class="ident" id="5159049">HighestPrec</span><span class="op" id="5159060">,</span>&nbsp;<span class="ident" id="5159062">depth</span><span class="op" id="5159067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159071">p</span><span class="op" id="5159072">.</span><span class="builtinfunc" id="5159073">print</span><span class="op" id="5159078">(</span><span class="ident" id="5159079">token</span><span class="op" id="5159084">.</span><span class="ident" id="5159085">PERIOD</span><span class="op" id="5159091">,</span>&nbsp;<span class="ident" id="5159093">x</span><span class="op" id="5159094">.</span><span class="ident" id="5159095">Lparen</span><span class="op" id="5159101">,</span>&nbsp;<span class="ident" id="5159103">token</span><span class="op" id="5159108">.</span><span class="ident" id="5159109">LPAREN</span><span class="op" id="5159115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159119">if</span>&nbsp;<span class="ident" id="5159122">x</span><span class="op" id="5159123">.</span><span class="ident" id="5159124">Type</span>&nbsp;<span class="op" id="5159129">!=</span>&nbsp;<span class="ident" id="5159132">nil</span>&nbsp;<span class="op" id="5159136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159141">p</span><span class="op" id="5159142">.</span><span class="ident" id="5159143">expr</span><span class="op" id="5159147">(</span><span class="ident" id="5159148">x</span><span class="op" id="5159149">.</span><span class="ident" id="5159150">Type</span><span class="op" id="5159154">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159158">}</span>&nbsp;<span class="keyword" id="5159160">else</span>&nbsp;<span class="op" id="5159165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159170">p</span><span class="op" id="5159171">.</span><span class="builtinfunc" id="5159172">print</span><span class="op" id="5159177">(</span><span class="ident" id="5159178">token</span><span class="op" id="5159183">.</span><span class="ident" id="5159184">TYPE</span><span class="op" id="5159188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159196">p</span><span class="op" id="5159197">.</span><span class="builtinfunc" id="5159198">print</span><span class="op" id="5159203">(</span><span class="ident" id="5159204">x</span><span class="op" id="5159205">.</span><span class="ident" id="5159206">Rparen</span><span class="op" id="5159212">,</span>&nbsp;<span class="ident" id="5159214">token</span><span class="op" id="5159219">.</span><span class="ident" id="5159220">RPAREN</span><span class="op" id="5159226">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159230">case</span>&nbsp;<span class="op" id="5159235">*</span><span class="ident" id="5159236">ast</span><span class="op" id="5159239">.</span><span class="ident" id="5159240">IndexExpr</span><span class="op" id="5159249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159253">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159329">p</span><span class="op" id="5159330">.</span><span class="ident" id="5159331">expr1</span><span class="op" id="5159336">(</span><span class="ident" id="5159337">x</span><span class="op" id="5159338">.</span><span class="ident" id="5159339">X</span><span class="op" id="5159340">,</span>&nbsp;<span class="ident" id="5159342">token</span><span class="op" id="5159347">.</span><span class="ident" id="5159348">HighestPrec</span><span class="op" id="5159359">,</span>&nbsp;<span class="num" id="5159361">1</span><span class="op" id="5159362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159366">p</span><span class="op" id="5159367">.</span><span class="builtinfunc" id="5159368">print</span><span class="op" id="5159373">(</span><span class="ident" id="5159374">x</span><span class="op" id="5159375">.</span><span class="ident" id="5159376">Lbrack</span><span class="op" id="5159382">,</span>&nbsp;<span class="ident" id="5159384">token</span><span class="op" id="5159389">.</span><span class="ident" id="5159390">LBRACK</span><span class="op" id="5159396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159400">p</span><span class="op" id="5159401">.</span><span class="ident" id="5159402">expr0</span><span class="op" id="5159407">(</span><span class="ident" id="5159408">x</span><span class="op" id="5159409">.</span><span class="ident" id="5159410">Index</span><span class="op" id="5159415">,</span>&nbsp;<span class="ident" id="5159417">depth</span><span class="op" id="5159422">+</span><span class="num" id="5159423">1</span><span class="op" id="5159424">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159428">p</span><span class="op" id="5159429">.</span><span class="builtinfunc" id="5159430">print</span><span class="op" id="5159435">(</span><span class="ident" id="5159436">x</span><span class="op" id="5159437">.</span><span class="ident" id="5159438">Rbrack</span><span class="op" id="5159444">,</span>&nbsp;<span class="ident" id="5159446">token</span><span class="op" id="5159451">.</span><span class="ident" id="5159452">RBRACK</span><span class="op" id="5159458">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159462">case</span>&nbsp;<span class="op" id="5159467">*</span><span class="ident" id="5159468">ast</span><span class="op" id="5159471">.</span><span class="ident" id="5159472">SliceExpr</span><span class="op" id="5159481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159485">//&nbsp;TODO(gri):&nbsp;should&nbsp;treat[]&nbsp;like&nbsp;parentheses&nbsp;and&nbsp;undo&nbsp;one&nbsp;level&nbsp;of&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159561">p</span><span class="op" id="5159562">.</span><span class="ident" id="5159563">expr1</span><span class="op" id="5159568">(</span><span class="ident" id="5159569">x</span><span class="op" id="5159570">.</span><span class="ident" id="5159571">X</span><span class="op" id="5159572">,</span>&nbsp;<span class="ident" id="5159574">token</span><span class="op" id="5159579">.</span><span class="ident" id="5159580">HighestPrec</span><span class="op" id="5159591">,</span>&nbsp;<span class="num" id="5159593">1</span><span class="op" id="5159594">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159598">p</span><span class="op" id="5159599">.</span><span class="builtinfunc" id="5159600">print</span><span class="op" id="5159605">(</span><span class="ident" id="5159606">x</span><span class="op" id="5159607">.</span><span class="ident" id="5159608">Lbrack</span><span class="op" id="5159614">,</span>&nbsp;<span class="ident" id="5159616">token</span><span class="op" id="5159621">.</span><span class="ident" id="5159622">LBRACK</span><span class="op" id="5159628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159632">indices</span>&nbsp;<span class="op" id="5159640">:=</span>&nbsp;<span class="op" id="5159643">[</span><span class="op" id="5159644">]</span><span class="ident" id="5159645">ast</span><span class="op" id="5159648">.</span><span class="ident" id="5159649">Expr</span><span class="op" id="5159653">{</span><span class="ident" id="5159654">x</span><span class="op" id="5159655">.</span><span class="ident" id="5159656">Low</span><span class="op" id="5159659">,</span>&nbsp;<span class="ident" id="5159661">x</span><span class="op" id="5159662">.</span><span class="ident" id="5159663">High</span><span class="op" id="5159667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159671">if</span>&nbsp;<span class="ident" id="5159674">x</span><span class="op" id="5159675">.</span><span class="ident" id="5159676">Max</span>&nbsp;<span class="op" id="5159680">!=</span>&nbsp;<span class="ident" id="5159683">nil</span>&nbsp;<span class="op" id="5159687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159692">indices</span>&nbsp;<span class="op" id="5159700">=</span>&nbsp;<span class="builtinfunc" id="5159702">append</span><span class="op" id="5159708">(</span><span class="ident" id="5159709">indices</span><span class="op" id="5159716">,</span>&nbsp;<span class="ident" id="5159718">x</span><span class="op" id="5159719">.</span><span class="ident" id="5159720">Max</span><span class="op" id="5159723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159727">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159731">for</span>&nbsp;<span class="ident" id="5159735">i</span><span class="op" id="5159736">,</span>&nbsp;<span class="ident" id="5159738">y</span>&nbsp;<span class="op" id="5159740">:=</span>&nbsp;<span class="keyword" id="5159743">range</span>&nbsp;<span class="ident" id="5159749">indices</span>&nbsp;<span class="op" id="5159757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159762">if</span>&nbsp;<span class="ident" id="5159765">i</span>&nbsp;<span class="op" id="5159767">&gt;</span>&nbsp;<span class="num" id="5159769">0</span>&nbsp;<span class="op" id="5159771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159777">//&nbsp;blanks&nbsp;around&nbsp;&#34;:&#34;&nbsp;if&nbsp;both&nbsp;sides&nbsp;exist&nbsp;and&nbsp;either&nbsp;side&nbsp;is&nbsp;a&nbsp;binary&nbsp;expression</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159861">//&nbsp;TODO(gri)&nbsp;once&nbsp;we&nbsp;have&nbsp;committed&nbsp;a&nbsp;variant&nbsp;of&nbsp;a[i:j:k]&nbsp;we&nbsp;may&nbsp;want&nbsp;to&nbsp;fine-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tune&nbsp;the&nbsp;formatting&nbsp;here</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159986">x</span>&nbsp;<span class="op" id="5159988">:=</span>&nbsp;<span class="ident" id="5159991">indices</span><span class="op" id="5159998">[</span><span class="ident" id="5159999">i</span><span class="op" id="5160000">-</span><span class="num" id="5160001">1</span><span class="op" id="5160002">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160008">if</span>&nbsp;<span class="ident" id="5160011">depth</span>&nbsp;<span class="op" id="5160017">&lt;=</span>&nbsp;<span class="num" id="5160020">1</span>&nbsp;<span class="op" id="5160022">&amp;&amp;</span>&nbsp;<span class="ident" id="5160025">x</span>&nbsp;<span class="op" id="5160027">!=</span>&nbsp;<span class="ident" id="5160030">nil</span>&nbsp;<span class="op" id="5160034">&amp;&amp;</span>&nbsp;<span class="ident" id="5160037">y</span>&nbsp;<span class="op" id="5160039">!=</span>&nbsp;<span class="ident" id="5160042">nil</span>&nbsp;<span class="op" id="5160046">&amp;&amp;</span>&nbsp;<span class="op" id="5160049">(</span><span class="ident" id="5160050">isBinary</span><span class="op" id="5160058">(</span><span class="ident" id="5160059">x</span><span class="op" id="5160060">)</span>&nbsp;<span class="op" id="5160062">||</span>&nbsp;<span class="ident" id="5160065">isBinary</span><span class="op" id="5160073">(</span><span class="ident" id="5160074">y</span><span class="op" id="5160075">)</span><span class="op" id="5160076">)</span>&nbsp;<span class="op" id="5160078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160085">p</span><span class="op" id="5160086">.</span><span class="builtinfunc" id="5160087">print</span><span class="op" id="5160092">(</span><span class="ident" id="5160093">blank</span><span class="op" id="5160098">,</span>&nbsp;<span class="ident" id="5160100">token</span><span class="op" id="5160105">.</span><span class="ident" id="5160106">COLON</span><span class="op" id="5160111">,</span>&nbsp;<span class="ident" id="5160113">blank</span><span class="op" id="5160118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160124">}</span>&nbsp;<span class="keyword" id="5160126">else</span>&nbsp;<span class="op" id="5160131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160138">p</span><span class="op" id="5160139">.</span><span class="builtinfunc" id="5160140">print</span><span class="op" id="5160145">(</span><span class="ident" id="5160146">token</span><span class="op" id="5160151">.</span><span class="ident" id="5160152">COLON</span><span class="op" id="5160157">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160173">if</span>&nbsp;<span class="ident" id="5160176">y</span>&nbsp;<span class="op" id="5160178">!=</span>&nbsp;<span class="ident" id="5160181">nil</span>&nbsp;<span class="op" id="5160185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160191">p</span><span class="op" id="5160192">.</span><span class="ident" id="5160193">expr0</span><span class="op" id="5160198">(</span><span class="ident" id="5160199">y</span><span class="op" id="5160200">,</span>&nbsp;<span class="ident" id="5160202">depth</span><span class="op" id="5160207">+</span><span class="num" id="5160208">1</span><span class="op" id="5160209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160214">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160222">p</span><span class="op" id="5160223">.</span><span class="builtinfunc" id="5160224">print</span><span class="op" id="5160229">(</span><span class="ident" id="5160230">x</span><span class="op" id="5160231">.</span><span class="ident" id="5160232">Rbrack</span><span class="op" id="5160238">,</span>&nbsp;<span class="ident" id="5160240">token</span><span class="op" id="5160245">.</span><span class="ident" id="5160246">RBRACK</span><span class="op" id="5160252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160256">case</span>&nbsp;<span class="op" id="5160261">*</span><span class="ident" id="5160262">ast</span><span class="op" id="5160265">.</span><span class="ident" id="5160266">CallExpr</span><span class="op" id="5160274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160278">if</span>&nbsp;<span class="builtinfunc" id="5160281">len</span><span class="op" id="5160284">(</span><span class="ident" id="5160285">x</span><span class="op" id="5160286">.</span><span class="ident" id="5160287">Args</span><span class="op" id="5160291">)</span>&nbsp;<span class="op" id="5160293">&gt;</span>&nbsp;<span class="num" id="5160295">1</span>&nbsp;<span class="op" id="5160297">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160302">depth</span><span class="op" id="5160307">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160316">if</span>&nbsp;<span class="ident" id="5160319">_</span><span class="op" id="5160320">,</span>&nbsp;<span class="ident" id="5160322">ok</span>&nbsp;<span class="op" id="5160325">:=</span>&nbsp;<span class="ident" id="5160328">x</span><span class="op" id="5160329">.</span><span class="ident" id="5160330">Fun</span><span class="op" id="5160333">.</span><span class="op" id="5160334">(</span><span class="op" id="5160335">*</span><span class="ident" id="5160336">ast</span><span class="op" id="5160339">.</span><span class="ident" id="5160340">FuncType</span><span class="op" id="5160348">)</span><span class="op" id="5160349">;</span>&nbsp;<span class="ident" id="5160351">ok</span>&nbsp;<span class="op" id="5160354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160359">//&nbsp;conversions&nbsp;to&nbsp;literal&nbsp;function&nbsp;types&nbsp;require&nbsp;parentheses&nbsp;around&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160439">p</span><span class="op" id="5160440">.</span><span class="builtinfunc" id="5160441">print</span><span class="op" id="5160446">(</span><span class="ident" id="5160447">token</span><span class="op" id="5160452">.</span><span class="ident" id="5160453">LPAREN</span><span class="op" id="5160459">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160464">p</span><span class="op" id="5160465">.</span><span class="ident" id="5160466">expr1</span><span class="op" id="5160471">(</span><span class="ident" id="5160472">x</span><span class="op" id="5160473">.</span><span class="ident" id="5160474">Fun</span><span class="op" id="5160477">,</span>&nbsp;<span class="ident" id="5160479">token</span><span class="op" id="5160484">.</span><span class="ident" id="5160485">HighestPrec</span><span class="op" id="5160496">,</span>&nbsp;<span class="ident" id="5160498">depth</span><span class="op" id="5160503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160508">p</span><span class="op" id="5160509">.</span><span class="builtinfunc" id="5160510">print</span><span class="op" id="5160515">(</span><span class="ident" id="5160516">token</span><span class="op" id="5160521">.</span><span class="ident" id="5160522">RPAREN</span><span class="op" id="5160528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160532">}</span>&nbsp;<span class="keyword" id="5160534">else</span>&nbsp;<span class="op" id="5160539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160544">p</span><span class="op" id="5160545">.</span><span class="ident" id="5160546">expr1</span><span class="op" id="5160551">(</span><span class="ident" id="5160552">x</span><span class="op" id="5160553">.</span><span class="ident" id="5160554">Fun</span><span class="op" id="5160557">,</span>&nbsp;<span class="ident" id="5160559">token</span><span class="op" id="5160564">.</span><span class="ident" id="5160565">HighestPrec</span><span class="op" id="5160576">,</span>&nbsp;<span class="ident" id="5160578">depth</span><span class="op" id="5160583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160587">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160591">p</span><span class="op" id="5160592">.</span><span class="builtinfunc" id="5160593">print</span><span class="op" id="5160598">(</span><span class="ident" id="5160599">x</span><span class="op" id="5160600">.</span><span class="ident" id="5160601">Lparen</span><span class="op" id="5160607">,</span>&nbsp;<span class="ident" id="5160609">token</span><span class="op" id="5160614">.</span><span class="ident" id="5160615">LPAREN</span><span class="op" id="5160621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160625">if</span>&nbsp;<span class="ident" id="5160628">x</span><span class="op" id="5160629">.</span><span class="ident" id="5160630">Ellipsis</span><span class="op" id="5160638">.</span><span class="ident" id="5160639">IsValid</span><span class="op" id="5160646">(</span><span class="op" id="5160647">)</span>&nbsp;<span class="op" id="5160649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160654">p</span><span class="op" id="5160655">.</span><span class="ident" id="5160656">exprList</span><span class="op" id="5160664">(</span><span class="ident" id="5160665">x</span><span class="op" id="5160666">.</span><span class="ident" id="5160667">Lparen</span><span class="op" id="5160673">,</span>&nbsp;<span class="ident" id="5160675">x</span><span class="op" id="5160676">.</span><span class="ident" id="5160677">Args</span><span class="op" id="5160681">,</span>&nbsp;<span class="ident" id="5160683">depth</span><span class="op" id="5160688">,</span>&nbsp;<span class="num" id="5160690">0</span><span class="op" id="5160691">,</span>&nbsp;<span class="ident" id="5160693">x</span><span class="op" id="5160694">.</span><span class="ident" id="5160695">Ellipsis</span><span class="op" id="5160703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160708">p</span><span class="op" id="5160709">.</span><span class="builtinfunc" id="5160710">print</span><span class="op" id="5160715">(</span><span class="ident" id="5160716">x</span><span class="op" id="5160717">.</span><span class="ident" id="5160718">Ellipsis</span><span class="op" id="5160726">,</span>&nbsp;<span class="ident" id="5160728">token</span><span class="op" id="5160733">.</span><span class="ident" id="5160734">ELLIPSIS</span><span class="op" id="5160742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160747">if</span>&nbsp;<span class="ident" id="5160750">x</span><span class="op" id="5160751">.</span><span class="ident" id="5160752">Rparen</span><span class="op" id="5160758">.</span><span class="ident" id="5160759">IsValid</span><span class="op" id="5160766">(</span><span class="op" id="5160767">)</span>&nbsp;<span class="op" id="5160769">&amp;&amp;</span>&nbsp;<span class="ident" id="5160772">p</span><span class="op" id="5160773">.</span><span class="ident" id="5160774">lineFor</span><span class="op" id="5160781">(</span><span class="ident" id="5160782">x</span><span class="op" id="5160783">.</span><span class="ident" id="5160784">Ellipsis</span><span class="op" id="5160792">)</span>&nbsp;<span class="op" id="5160794">&lt;</span>&nbsp;<span class="ident" id="5160796">p</span><span class="op" id="5160797">.</span><span class="ident" id="5160798">lineFor</span><span class="op" id="5160805">(</span><span class="ident" id="5160806">x</span><span class="op" id="5160807">.</span><span class="ident" id="5160808">Rparen</span><span class="op" id="5160814">)</span>&nbsp;<span class="op" id="5160816">{</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160822">p</span><span class="op" id="5160823">.</span><span class="builtinfunc" id="5160824">print</span><span class="op" id="5160829">(</span><span class="ident" id="5160830">token</span><span class="op" id="5160835">.</span><span class="ident" id="5160836">COMMA</span><span class="op" id="5160841">,</span>&nbsp;<span class="ident" id="5160843">formfeed</span><span class="op" id="5160851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160860">}</span>&nbsp;<span class="keyword" id="5160862">else</span>&nbsp;<span class="op" id="5160867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160872">p</span><span class="op" id="5160873">.</span><span class="ident" id="5160874">exprList</span><span class="op" id="5160882">(</span><span class="ident" id="5160883">x</span><span class="op" id="5160884">.</span><span class="ident" id="5160885">Lparen</span><span class="op" id="5160891">,</span>&nbsp;<span class="ident" id="5160893">x</span><span class="op" id="5160894">.</span><span class="ident" id="5160895">Args</span><span class="op" id="5160899">,</span>&nbsp;<span class="ident" id="5160901">depth</span><span class="op" id="5160906">,</span>&nbsp;<span class="ident" id="5160908">commaTerm</span><span class="op" id="5160917">,</span>&nbsp;<span class="ident" id="5160919">x</span><span class="op" id="5160920">.</span><span class="ident" id="5160921">Rparen</span><span class="op" id="5160927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160931">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160935">p</span><span class="op" id="5160936">.</span><span class="builtinfunc" id="5160937">print</span><span class="op" id="5160942">(</span><span class="ident" id="5160943">x</span><span class="op" id="5160944">.</span><span class="ident" id="5160945">Rparen</span><span class="op" id="5160951">,</span>&nbsp;<span class="ident" id="5160953">token</span><span class="op" id="5160958">.</span><span class="ident" id="5160959">RPAREN</span><span class="op" id="5160965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160969">case</span>&nbsp;<span class="op" id="5160974">*</span><span class="ident" id="5160975">ast</span><span class="op" id="5160978">.</span><span class="ident" id="5160979">CompositeLit</span><span class="op" id="5160991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160995">//&nbsp;composite&nbsp;literal&nbsp;elements&nbsp;that&nbsp;are&nbsp;composite&nbsp;literals&nbsp;themselves&nbsp;may&nbsp;have&nbsp;the&nbsp;type&nbsp;omitted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161092">if</span>&nbsp;<span class="ident" id="5161095">x</span><span class="op" id="5161096">.</span><span class="ident" id="5161097">Type</span>&nbsp;<span class="op" id="5161102">!=</span>&nbsp;<span class="ident" id="5161105">nil</span>&nbsp;<span class="op" id="5161109">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161114">p</span><span class="op" id="5161115">.</span><span class="ident" id="5161116">expr1</span><span class="op" id="5161121">(</span><span class="ident" id="5161122">x</span><span class="op" id="5161123">.</span><span class="ident" id="5161124">Type</span><span class="op" id="5161128">,</span>&nbsp;<span class="ident" id="5161130">token</span><span class="op" id="5161135">.</span><span class="ident" id="5161136">HighestPrec</span><span class="op" id="5161147">,</span>&nbsp;<span class="ident" id="5161149">depth</span><span class="op" id="5161154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161162">p</span><span class="op" id="5161163">.</span><span class="builtinfunc" id="5161164">print</span><span class="op" id="5161169">(</span><span class="ident" id="5161170">x</span><span class="op" id="5161171">.</span><span class="ident" id="5161172">Lbrace</span><span class="op" id="5161178">,</span>&nbsp;<span class="ident" id="5161180">token</span><span class="op" id="5161185">.</span><span class="ident" id="5161186">LBRACE</span><span class="op" id="5161192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161196">p</span><span class="op" id="5161197">.</span><span class="ident" id="5161198">exprList</span><span class="op" id="5161206">(</span><span class="ident" id="5161207">x</span><span class="op" id="5161208">.</span><span class="ident" id="5161209">Lbrace</span><span class="op" id="5161215">,</span>&nbsp;<span class="ident" id="5161217">x</span><span class="op" id="5161218">.</span><span class="ident" id="5161219">Elts</span><span class="op" id="5161223">,</span>&nbsp;<span class="num" id="5161225">1</span><span class="op" id="5161226">,</span>&nbsp;<span class="ident" id="5161228">commaTerm</span><span class="op" id="5161237">,</span>&nbsp;<span class="ident" id="5161239">x</span><span class="op" id="5161240">.</span><span class="ident" id="5161241">Rbrace</span><span class="op" id="5161247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161251">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;line&nbsp;break&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161316">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;as&nbsp;it&nbsp;might&nbsp;break&nbsp;the&nbsp;code&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161380">//&nbsp;is&nbsp;no&nbsp;trailing&nbsp;&#39;,&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161404">mode</span>&nbsp;<span class="op" id="5161409">:=</span>&nbsp;<span class="ident" id="5161412">noExtraLinebreak</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161431">//&nbsp;do&nbsp;not&nbsp;insert&nbsp;extra&nbsp;blank&nbsp;following&nbsp;a&nbsp;/*-style&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161491">//&nbsp;before&nbsp;the&nbsp;closing&nbsp;&#39;}&#39;&nbsp;unless&nbsp;the&nbsp;literal&nbsp;is&nbsp;empty</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161547">if</span>&nbsp;<span class="builtinfunc" id="5161550">len</span><span class="op" id="5161553">(</span><span class="ident" id="5161554">x</span><span class="op" id="5161555">.</span><span class="ident" id="5161556">Elts</span><span class="op" id="5161560">)</span>&nbsp;<span class="op" id="5161562">&gt;</span>&nbsp;<span class="num" id="5161564">0</span>&nbsp;<span class="op" id="5161566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161571">mode</span>&nbsp;<span class="op" id="5161576">|=</span>&nbsp;<span class="ident" id="5161579">noExtraBlank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161598">p</span><span class="op" id="5161599">.</span><span class="builtinfunc" id="5161600">print</span><span class="op" id="5161605">(</span><span class="ident" id="5161606">mode</span><span class="op" id="5161610">,</span>&nbsp;<span class="ident" id="5161612">x</span><span class="op" id="5161613">.</span><span class="ident" id="5161614">Rbrace</span><span class="op" id="5161620">,</span>&nbsp;<span class="ident" id="5161622">token</span><span class="op" id="5161627">.</span><span class="ident" id="5161628">RBRACE</span><span class="op" id="5161634">,</span>&nbsp;<span class="ident" id="5161636">mode</span><span class="op" id="5161640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161644">case</span>&nbsp;<span class="op" id="5161649">*</span><span class="ident" id="5161650">ast</span><span class="op" id="5161653">.</span><span class="ident" id="5161654">Ellipsis</span><span class="op" id="5161662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161666">p</span><span class="op" id="5161667">.</span><span class="builtinfunc" id="5161668">print</span><span class="op" id="5161673">(</span><span class="ident" id="5161674">token</span><span class="op" id="5161679">.</span><span class="ident" id="5161680">ELLIPSIS</span><span class="op" id="5161688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161692">if</span>&nbsp;<span class="ident" id="5161695">x</span><span class="op" id="5161696">.</span><span class="ident" id="5161697">Elt</span>&nbsp;<span class="op" id="5161701">!=</span>&nbsp;<span class="ident" id="5161704">nil</span>&nbsp;<span class="op" id="5161708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161713">p</span><span class="op" id="5161714">.</span><span class="ident" id="5161715">expr</span><span class="op" id="5161719">(</span><span class="ident" id="5161720">x</span><span class="op" id="5161721">.</span><span class="ident" id="5161722">Elt</span><span class="op" id="5161725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161729">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161733">case</span>&nbsp;<span class="op" id="5161738">*</span><span class="ident" id="5161739">ast</span><span class="op" id="5161742">.</span><span class="ident" id="5161743">ArrayType</span><span class="op" id="5161752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161756">p</span><span class="op" id="5161757">.</span><span class="builtinfunc" id="5161758">print</span><span class="op" id="5161763">(</span><span class="ident" id="5161764">token</span><span class="op" id="5161769">.</span><span class="ident" id="5161770">LBRACK</span><span class="op" id="5161776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161780">if</span>&nbsp;<span class="ident" id="5161783">x</span><span class="op" id="5161784">.</span><span class="ident" id="5161785">Len</span>&nbsp;<span class="op" id="5161789">!=</span>&nbsp;<span class="ident" id="5161792">nil</span>&nbsp;<span class="op" id="5161796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161801">p</span><span class="op" id="5161802">.</span><span class="ident" id="5161803">expr</span><span class="op" id="5161807">(</span><span class="ident" id="5161808">x</span><span class="op" id="5161809">.</span><span class="ident" id="5161810">Len</span><span class="op" id="5161813">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161821">p</span><span class="op" id="5161822">.</span><span class="builtinfunc" id="5161823">print</span><span class="op" id="5161828">(</span><span class="ident" id="5161829">token</span><span class="op" id="5161834">.</span><span class="ident" id="5161835">RBRACK</span><span class="op" id="5161841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161845">p</span><span class="op" id="5161846">.</span><span class="ident" id="5161847">expr</span><span class="op" id="5161851">(</span><span class="ident" id="5161852">x</span><span class="op" id="5161853">.</span><span class="ident" id="5161854">Elt</span><span class="op" id="5161857">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161861">case</span>&nbsp;<span class="op" id="5161866">*</span><span class="ident" id="5161867">ast</span><span class="op" id="5161870">.</span><span class="ident" id="5161871">StructType</span><span class="op" id="5161881">:</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161885">p</span><span class="op" id="5161886">.</span><span class="builtinfunc" id="5161887">print</span><span class="op" id="5161892">(</span><span class="ident" id="5161893">token</span><span class="op" id="5161898">.</span><span class="ident" id="5161899">STRUCT</span><span class="op" id="5161905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161909">p</span><span class="op" id="5161910">.</span><span class="ident" id="5161911">fieldList</span><span class="op" id="5161920">(</span><span class="ident" id="5161921">x</span><span class="op" id="5161922">.</span><span class="ident" id="5161923">Fields</span><span class="op" id="5161929">,</span>&nbsp;<span class="builtintype" id="5161931">true</span><span class="op" id="5161935">,</span>&nbsp;<span class="ident" id="5161937">x</span><span class="op" id="5161938">.</span><span class="ident" id="5161939">Incomplete</span><span class="op" id="5161949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161953">case</span>&nbsp;<span class="op" id="5161958">*</span><span class="ident" id="5161959">ast</span><span class="op" id="5161962">.</span><span class="ident" id="5161963">FuncType</span><span class="op" id="5161971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161975">p</span><span class="op" id="5161976">.</span><span class="builtinfunc" id="5161977">print</span><span class="op" id="5161982">(</span><span class="ident" id="5161983">token</span><span class="op" id="5161988">.</span><span class="ident" id="5161989">FUNC</span><span class="op" id="5161993">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161997">p</span><span class="op" id="5161998">.</span><span class="ident" id="5161999">signature</span><span class="op" id="5162008">(</span><span class="ident" id="5162009">x</span><span class="op" id="5162010">.</span><span class="ident" id="5162011">Params</span><span class="op" id="5162017">,</span>&nbsp;<span class="ident" id="5162019">x</span><span class="op" id="5162020">.</span><span class="ident" id="5162021">Results</span><span class="op" id="5162028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162032">case</span>&nbsp;<span class="op" id="5162037">*</span><span class="ident" id="5162038">ast</span><span class="op" id="5162041">.</span><span class="ident" id="5162042">InterfaceType</span><span class="op" id="5162055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162059">p</span><span class="op" id="5162060">.</span><span class="builtinfunc" id="5162061">print</span><span class="op" id="5162066">(</span><span class="ident" id="5162067">token</span><span class="op" id="5162072">.</span><span class="ident" id="5162073">INTERFACE</span><span class="op" id="5162082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162086">p</span><span class="op" id="5162087">.</span><span class="ident" id="5162088">fieldList</span><span class="op" id="5162097">(</span><span class="ident" id="5162098">x</span><span class="op" id="5162099">.</span><span class="ident" id="5162100">Methods</span><span class="op" id="5162107">,</span>&nbsp;<span class="builtintype" id="5162109">false</span><span class="op" id="5162114">,</span>&nbsp;<span class="ident" id="5162116">x</span><span class="op" id="5162117">.</span><span class="ident" id="5162118">Incomplete</span><span class="op" id="5162128">)</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162132">case</span>&nbsp;<span class="op" id="5162137">*</span><span class="ident" id="5162138">ast</span><span class="op" id="5162141">.</span><span class="ident" id="5162142">MapType</span><span class="op" id="5162149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162153">p</span><span class="op" id="5162154">.</span><span class="builtinfunc" id="5162155">print</span><span class="op" id="5162160">(</span><span class="ident" id="5162161">token</span><span class="op" id="5162166">.</span><span class="ident" id="5162167">MAP</span><span class="op" id="5162170">,</span>&nbsp;<span class="ident" id="5162172">token</span><span class="op" id="5162177">.</span><span class="ident" id="5162178">LBRACK</span><span class="op" id="5162184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162188">p</span><span class="op" id="5162189">.</span><span class="ident" id="5162190">expr</span><span class="op" id="5162194">(</span><span class="ident" id="5162195">x</span><span class="op" id="5162196">.</span><span class="ident" id="5162197">Key</span><span class="op" id="5162200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162204">p</span><span class="op" id="5162205">.</span><span class="builtinfunc" id="5162206">print</span><span class="op" id="5162211">(</span><span class="ident" id="5162212">token</span><span class="op" id="5162217">.</span><span class="ident" id="5162218">RBRACK</span><span class="op" id="5162224">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162228">p</span><span class="op" id="5162229">.</span><span class="ident" id="5162230">expr</span><span class="op" id="5162234">(</span><span class="ident" id="5162235">x</span><span class="op" id="5162236">.</span><span class="ident" id="5162237">Value</span><span class="op" id="5162242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162246">case</span>&nbsp;<span class="op" id="5162251">*</span><span class="ident" id="5162252">ast</span><span class="op" id="5162255">.</span><span class="ident" id="5162256">ChanType</span><span class="op" id="5162264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162268">switch</span>&nbsp;<span class="ident" id="5162275">x</span><span class="op" id="5162276">.</span><span class="ident" id="5162277">Dir</span>&nbsp;<span class="op" id="5162281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162285">case</span>&nbsp;<span class="ident" id="5162290">ast</span><span class="op" id="5162293">.</span><span class="ident" id="5162294">SEND</span>&nbsp;<span class="op" id="5162299">|</span>&nbsp;<span class="ident" id="5162301">ast</span><span class="op" id="5162304">.</span><span class="ident" id="5162305">RECV</span><span class="op" id="5162309">:</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162314">p</span><span class="op" id="5162315">.</span><span class="builtinfunc" id="5162316">print</span><span class="op" id="5162321">(</span><span class="ident" id="5162322">token</span><span class="op" id="5162327">.</span><span class="ident" id="5162328">CHAN</span><span class="op" id="5162332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162336">case</span>&nbsp;<span class="ident" id="5162341">ast</span><span class="op" id="5162344">.</span><span class="ident" id="5162345">RECV</span><span class="op" id="5162349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162354">p</span><span class="op" id="5162355">.</span><span class="builtinfunc" id="5162356">print</span><span class="op" id="5162361">(</span><span class="ident" id="5162362">token</span><span class="op" id="5162367">.</span><span class="ident" id="5162368">ARROW</span><span class="op" id="5162373">,</span>&nbsp;<span class="ident" id="5162375">token</span><span class="op" id="5162380">.</span><span class="ident" id="5162381">CHAN</span><span class="op" id="5162385">)</span>&nbsp;<span class="comment" id="5162387">//&nbsp;x.Arrow&nbsp;and&nbsp;x.Pos()&nbsp;are&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162425">case</span>&nbsp;<span class="ident" id="5162430">ast</span><span class="op" id="5162433">.</span><span class="ident" id="5162434">SEND</span><span class="op" id="5162438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162443">p</span><span class="op" id="5162444">.</span><span class="builtinfunc" id="5162445">print</span><span class="op" id="5162450">(</span><span class="ident" id="5162451">token</span><span class="op" id="5162456">.</span><span class="ident" id="5162457">CHAN</span><span class="op" id="5162461">,</span>&nbsp;<span class="ident" id="5162463">x</span><span class="op" id="5162464">.</span><span class="ident" id="5162465">Arrow</span><span class="op" id="5162470">,</span>&nbsp;<span class="ident" id="5162472">token</span><span class="op" id="5162477">.</span><span class="ident" id="5162478">ARROW</span><span class="op" id="5162483">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162491">p</span><span class="op" id="5162492">.</span><span class="builtinfunc" id="5162493">print</span><span class="op" id="5162498">(</span><span class="ident" id="5162499">blank</span><span class="op" id="5162504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162508">p</span><span class="op" id="5162509">.</span><span class="ident" id="5162510">expr</span><span class="op" id="5162514">(</span><span class="ident" id="5162515">x</span><span class="op" id="5162516">.</span><span class="ident" id="5162517">Value</span><span class="op" id="5162522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162526">default</span><span class="op" id="5162533">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5162537">panic</span><span class="op" id="5162542">(</span><span class="string" id="5162543">&#34;unreachable&#34;</span><span class="op" id="5162556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162563">return</span><br>
<span class="lineno"></span><span class="op" id="5162570">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="keyword" id="5162573">func</span>&nbsp;<span class="op" id="5162578">(</span><span class="ident" id="5162579">p</span>&nbsp;<span class="op" id="5162581">*</span><span class="ident" id="5162582">printer</span><span class="op" id="5162589">)</span>&nbsp;<span class="ident" id="5162591">expr0</span><span class="op" id="5162596">(</span><span class="ident" id="5162597">x</span>&nbsp;<span class="ident" id="5162599">ast</span><span class="op" id="5162602">.</span><span class="ident" id="5162603">Expr</span><span class="op" id="5162607">,</span>&nbsp;<span class="ident" id="5162609">depth</span>&nbsp;<span class="builtintype" id="5162615">int</span><span class="op" id="5162618">)</span>&nbsp;<span class="op" id="5162620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162623">p</span><span class="op" id="5162624">.</span><span class="ident" id="5162625">expr1</span><span class="op" id="5162630">(</span><span class="ident" id="5162631">x</span><span class="op" id="5162632">,</span>&nbsp;<span class="ident" id="5162634">token</span><span class="op" id="5162639">.</span><span class="ident" id="5162640">LowestPrec</span><span class="op" id="5162650">,</span>&nbsp;<span class="ident" id="5162652">depth</span><span class="op" id="5162657">)</span><br>
<span class="lineno"></span><span class="op" id="5162659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span><span class="keyword" id="5162662">func</span>&nbsp;<span class="op" id="5162667">(</span><span class="ident" id="5162668">p</span>&nbsp;<span class="op" id="5162670">*</span><span class="ident" id="5162671">printer</span><span class="op" id="5162678">)</span>&nbsp;<span class="ident" id="5162680">expr</span><span class="op" id="5162684">(</span><span class="ident" id="5162685">x</span>&nbsp;<span class="ident" id="5162687">ast</span><span class="op" id="5162690">.</span><span class="ident" id="5162691">Expr</span><span class="op" id="5162695">)</span>&nbsp;<span class="op" id="5162697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162700">const</span>&nbsp;<span class="ident" id="5162706">depth</span>&nbsp;<span class="op" id="5162712">=</span>&nbsp;<span class="num" id="5162714">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162717">p</span><span class="op" id="5162718">.</span><span class="ident" id="5162719">expr1</span><span class="op" id="5162724">(</span><span class="ident" id="5162725">x</span><span class="op" id="5162726">,</span>&nbsp;<span class="ident" id="5162728">token</span><span class="op" id="5162733">.</span><span class="ident" id="5162734">LowestPrec</span><span class="op" id="5162744">,</span>&nbsp;<span class="ident" id="5162746">depth</span><span class="op" id="5162751">)</span><br>
<span class="lineno"></span><span class="op" id="5162753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5162756">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5162836">//&nbsp;Statements</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5162851">//&nbsp;Print&nbsp;the&nbsp;statement&nbsp;list&nbsp;indented,&nbsp;but&nbsp;without&nbsp;a&nbsp;newline&nbsp;after&nbsp;the&nbsp;last&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5162937">//&nbsp;Extra&nbsp;line&nbsp;breaks&nbsp;between&nbsp;statements&nbsp;in&nbsp;the&nbsp;source&nbsp;are&nbsp;respected&nbsp;but&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">905</span><span class="comment" id="5163021">//&nbsp;empty&nbsp;line&nbsp;is&nbsp;printed&nbsp;between&nbsp;statements.</span><br>
<span class="lineno"></span><span class="keyword" id="5163066">func</span>&nbsp;<span class="op" id="5163071">(</span><span class="ident" id="5163072">p</span>&nbsp;<span class="op" id="5163074">*</span><span class="ident" id="5163075">printer</span><span class="op" id="5163082">)</span>&nbsp;<span class="ident" id="5163084">stmtList</span><span class="op" id="5163092">(</span><span class="ident" id="5163093">list</span>&nbsp;<span class="op" id="5163098">[</span><span class="op" id="5163099">]</span><span class="ident" id="5163100">ast</span><span class="op" id="5163103">.</span><span class="ident" id="5163104">Stmt</span><span class="op" id="5163108">,</span>&nbsp;<span class="ident" id="5163110">nindent</span>&nbsp;<span class="builtintype" id="5163118">int</span><span class="op" id="5163121">,</span>&nbsp;<span class="ident" id="5163123">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5163136">bool</span><span class="op" id="5163140">)</span>&nbsp;<span class="op" id="5163142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163145">if</span>&nbsp;<span class="ident" id="5163148">nindent</span>&nbsp;<span class="op" id="5163156">&gt;</span>&nbsp;<span class="num" id="5163158">0</span>&nbsp;<span class="op" id="5163160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163164">p</span><span class="op" id="5163165">.</span><span class="builtinfunc" id="5163166">print</span><span class="op" id="5163171">(</span><span class="ident" id="5163172">indent</span><span class="op" id="5163178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5163181">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163184">var</span>&nbsp;<span class="ident" id="5163188">line</span>&nbsp;<span class="builtintype" id="5163193">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163198">i</span>&nbsp;<span class="op" id="5163200">:=</span>&nbsp;<span class="num" id="5163203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163206">for</span>&nbsp;<span class="ident" id="5163210">_</span><span class="op" id="5163211">,</span>&nbsp;<span class="ident" id="5163213">s</span>&nbsp;<span class="op" id="5163215">:=</span>&nbsp;<span class="keyword" id="5163218">range</span>&nbsp;<span class="ident" id="5163224">list</span>&nbsp;<span class="op" id="5163229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163233">//&nbsp;ignore&nbsp;empty&nbsp;statements&nbsp;(was&nbsp;issue&nbsp;3466)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163279">if</span>&nbsp;<span class="ident" id="5163282">_</span><span class="op" id="5163283">,</span>&nbsp;<span class="ident" id="5163285">isEmpty</span>&nbsp;<span class="op" id="5163293">:=</span>&nbsp;<span class="ident" id="5163296">s</span><span class="op" id="5163297">.</span><span class="op" id="5163298">(</span><span class="op" id="5163299">*</span><span class="ident" id="5163300">ast</span><span class="op" id="5163303">.</span><span class="ident" id="5163304">EmptyStmt</span><span class="op" id="5163313">)</span><span class="op" id="5163314">;</span>&nbsp;<span class="op" id="5163316">!</span><span class="ident" id="5163317">isEmpty</span>&nbsp;<span class="op" id="5163325">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163330">//&nbsp;nindent&nbsp;==&nbsp;0&nbsp;only&nbsp;for&nbsp;lists&nbsp;of&nbsp;switch/select&nbsp;case&nbsp;clauses;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163395">//&nbsp;in&nbsp;those&nbsp;cases&nbsp;each&nbsp;clause&nbsp;is&nbsp;a&nbsp;new&nbsp;section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163445">if</span>&nbsp;<span class="builtinfunc" id="5163448">len</span><span class="op" id="5163451">(</span><span class="ident" id="5163452">p</span><span class="op" id="5163453">.</span><span class="ident" id="5163454">output</span><span class="op" id="5163460">)</span>&nbsp;<span class="op" id="5163462">&gt;</span>&nbsp;<span class="num" id="5163464">0</span>&nbsp;<span class="op" id="5163466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163472">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163546">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163604">p</span><span class="op" id="5163605">.</span><span class="ident" id="5163606">linebreak</span><span class="op" id="5163615">(</span><span class="ident" id="5163616">p</span><span class="op" id="5163617">.</span><span class="ident" id="5163618">lineFor</span><span class="op" id="5163625">(</span><span class="ident" id="5163626">s</span><span class="op" id="5163627">.</span><span class="ident" id="5163628">Pos</span><span class="op" id="5163631">(</span><span class="op" id="5163632">)</span><span class="op" id="5163633">)</span><span class="op" id="5163634">,</span>&nbsp;<span class="num" id="5163636">1</span><span class="op" id="5163637">,</span>&nbsp;<span class="ident" id="5163639">ignore</span><span class="op" id="5163645">,</span>&nbsp;<span class="ident" id="5163647">i</span>&nbsp;<span class="op" id="5163649">==</span>&nbsp;<span class="num" id="5163652">0</span>&nbsp;<span class="op" id="5163654">||</span>&nbsp;<span class="ident" id="5163657">nindent</span>&nbsp;<span class="op" id="5163665">==</span>&nbsp;<span class="num" id="5163668">0</span>&nbsp;<span class="op" id="5163670">||</span>&nbsp;<span class="ident" id="5163673">p</span><span class="op" id="5163674">.</span><span class="ident" id="5163675">linesFrom</span><span class="op" id="5163684">(</span><span class="ident" id="5163685">line</span><span class="op" id="5163689">)</span>&nbsp;<span class="op" id="5163691">&gt;</span>&nbsp;<span class="num" id="5163693">0</span><span class="op" id="5163694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5163699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163704">p</span><span class="op" id="5163705">.</span><span class="ident" id="5163706">recordLine</span><span class="op" id="5163716">(</span><span class="op" id="5163717">&amp;</span><span class="ident" id="5163718">line</span><span class="op" id="5163722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163727">p</span><span class="op" id="5163728">.</span><span class="ident" id="5163729">stmt</span><span class="op" id="5163733">(</span><span class="ident" id="5163734">s</span><span class="op" id="5163735">,</span>&nbsp;<span class="ident" id="5163737">nextIsRBrace</span>&nbsp;<span class="op" id="5163750">&amp;&amp;</span>&nbsp;<span class="ident" id="5163753">i</span>&nbsp;<span class="op" id="5163755">==</span>&nbsp;<span class="builtinfunc" id="5163758">len</span><span class="op" id="5163761">(</span><span class="ident" id="5163762">list</span><span class="op" id="5163766">)</span><span class="op" id="5163767">-</span><span class="num" id="5163768">1</span><span class="op" id="5163769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163774">//&nbsp;labeled&nbsp;statements&nbsp;put&nbsp;labels&nbsp;on&nbsp;a&nbsp;separate&nbsp;line,&nbsp;but&nbsp;here</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163839">//&nbsp;we&nbsp;only&nbsp;care&nbsp;about&nbsp;the&nbsp;start&nbsp;line&nbsp;of&nbsp;the&nbsp;actual&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163903">//&nbsp;without&nbsp;label&nbsp;-&nbsp;correct&nbsp;line&nbsp;for&nbsp;each&nbsp;label</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163953">for</span>&nbsp;<span class="ident" id="5163957">t</span>&nbsp;<span class="op" id="5163959">:=</span>&nbsp;<span class="ident" id="5163962">s</span><span class="op" id="5163963">;</span>&nbsp;<span class="op" id="5163965">;</span>&nbsp;<span class="op" id="5163967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163973">lt</span><span class="op" id="5163975">,</span>&nbsp;<span class="ident" id="5163977">_</span>&nbsp;<span class="op" id="5163979">:=</span>&nbsp;<span class="ident" id="5163982">t</span><span class="op" id="5163983">.</span><span class="op" id="5163984">(</span><span class="op" id="5163985">*</span><span class="ident" id="5163986">ast</span><span class="op" id="5163989">.</span><span class="ident" id="5163990">LabeledStmt</span><span class="op" id="5164001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164007">if</span>&nbsp;<span class="ident" id="5164010">lt</span>&nbsp;<span class="op" id="5164013">==</span>&nbsp;<span class="ident" id="5164016">nil</span>&nbsp;<span class="op" id="5164020">{</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164027">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164043">line</span><span class="op" id="5164047">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164054">t</span>&nbsp;<span class="op" id="5164056">=</span>&nbsp;<span class="ident" id="5164058">lt</span><span class="op" id="5164060">.</span><span class="ident" id="5164061">Stmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164069">}</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164074">i</span><span class="op" id="5164075">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164086">if</span>&nbsp;<span class="ident" id="5164089">nindent</span>&nbsp;<span class="op" id="5164097">&gt;</span>&nbsp;<span class="num" id="5164099">0</span>&nbsp;<span class="op" id="5164101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164105">p</span><span class="op" id="5164106">.</span><span class="builtinfunc" id="5164107">print</span><span class="op" id="5164112">(</span><span class="ident" id="5164113">unindent</span><span class="op" id="5164121">)</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164124">}</span><br>
<span class="lineno"></span><span class="op" id="5164126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5164129">//&nbsp;block&nbsp;prints&nbsp;an&nbsp;*ast.BlockStmt;&nbsp;it&nbsp;always&nbsp;spans&nbsp;at&nbsp;least&nbsp;two&nbsp;lines.</span><br>
<span class="lineno"></span><span class="keyword" id="5164200">func</span>&nbsp;<span class="op" id="5164205">(</span><span class="ident" id="5164206">p</span>&nbsp;<span class="op" id="5164208">*</span><span class="ident" id="5164209">printer</span><span class="op" id="5164216">)</span>&nbsp;<span class="ident" id="5164218">block</span><span class="op" id="5164223">(</span><span class="ident" id="5164224">b</span>&nbsp;<span class="op" id="5164226">*</span><span class="ident" id="5164227">ast</span><span class="op" id="5164230">.</span><span class="ident" id="5164231">BlockStmt</span><span class="op" id="5164240">,</span>&nbsp;<span class="ident" id="5164242">nindent</span>&nbsp;<span class="builtintype" id="5164250">int</span><span class="op" id="5164253">)</span>&nbsp;<span class="op" id="5164255">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164258">p</span><span class="op" id="5164259">.</span><span class="builtinfunc" id="5164260">print</span><span class="op" id="5164265">(</span><span class="ident" id="5164266">b</span><span class="op" id="5164267">.</span><span class="ident" id="5164268">Lbrace</span><span class="op" id="5164274">,</span>&nbsp;<span class="ident" id="5164276">token</span><span class="op" id="5164281">.</span><span class="ident" id="5164282">LBRACE</span><span class="op" id="5164288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164291">p</span><span class="op" id="5164292">.</span><span class="ident" id="5164293">stmtList</span><span class="op" id="5164301">(</span><span class="ident" id="5164302">b</span><span class="op" id="5164303">.</span><span class="ident" id="5164304">List</span><span class="op" id="5164308">,</span>&nbsp;<span class="ident" id="5164310">nindent</span><span class="op" id="5164317">,</span>&nbsp;<span class="builtintype" id="5164319">true</span><span class="op" id="5164323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164326">p</span><span class="op" id="5164327">.</span><span class="ident" id="5164328">linebreak</span><span class="op" id="5164337">(</span><span class="ident" id="5164338">p</span><span class="op" id="5164339">.</span><span class="ident" id="5164340">lineFor</span><span class="op" id="5164347">(</span><span class="ident" id="5164348">b</span><span class="op" id="5164349">.</span><span class="ident" id="5164350">Rbrace</span><span class="op" id="5164356">)</span><span class="op" id="5164357">,</span>&nbsp;<span class="num" id="5164359">1</span><span class="op" id="5164360">,</span>&nbsp;<span class="ident" id="5164362">ignore</span><span class="op" id="5164368">,</span>&nbsp;<span class="builtintype" id="5164370">true</span><span class="op" id="5164374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164377">p</span><span class="op" id="5164378">.</span><span class="builtinfunc" id="5164379">print</span><span class="op" id="5164384">(</span><span class="ident" id="5164385">b</span><span class="op" id="5164386">.</span><span class="ident" id="5164387">Rbrace</span><span class="op" id="5164393">,</span>&nbsp;<span class="ident" id="5164395">token</span><span class="op" id="5164400">.</span><span class="ident" id="5164401">RBRACE</span><span class="op" id="5164407">)</span><br>
<span class="lineno"></span><span class="op" id="5164409">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="5164412">func</span>&nbsp;<span class="ident" id="5164417">isTypeName</span><span class="op" id="5164427">(</span><span class="ident" id="5164428">x</span>&nbsp;<span class="ident" id="5164430">ast</span><span class="op" id="5164433">.</span><span class="ident" id="5164434">Expr</span><span class="op" id="5164438">)</span>&nbsp;<span class="builtintype" id="5164440">bool</span>&nbsp;<span class="op" id="5164445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164448">switch</span>&nbsp;<span class="ident" id="5164455">t</span>&nbsp;<span class="op" id="5164457">:=</span>&nbsp;<span class="ident" id="5164460">x</span><span class="op" id="5164461">.</span><span class="op" id="5164462">(</span><span class="keyword" id="5164463">type</span><span class="op" id="5164467">)</span>&nbsp;<span class="op" id="5164469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164472">case</span>&nbsp;<span class="op" id="5164477">*</span><span class="ident" id="5164478">ast</span><span class="op" id="5164481">.</span><span class="ident" id="5164482">Ident</span><span class="op" id="5164487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164491">return</span>&nbsp;<span class="builtintype" id="5164498">true</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164504">case</span>&nbsp;<span class="op" id="5164509">*</span><span class="ident" id="5164510">ast</span><span class="op" id="5164513">.</span><span class="ident" id="5164514">SelectorExpr</span><span class="op" id="5164526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164530">return</span>&nbsp;<span class="ident" id="5164537">isTypeName</span><span class="op" id="5164547">(</span><span class="ident" id="5164548">t</span><span class="op" id="5164549">.</span><span class="ident" id="5164550">X</span><span class="op" id="5164551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164557">return</span>&nbsp;<span class="builtintype" id="5164564">false</span><br>
<span class="lineno"></span><span class="op" id="5164570">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span><span class="keyword" id="5164573">func</span>&nbsp;<span class="ident" id="5164578">stripParens</span><span class="op" id="5164589">(</span><span class="ident" id="5164590">x</span>&nbsp;<span class="ident" id="5164592">ast</span><span class="op" id="5164595">.</span><span class="ident" id="5164596">Expr</span><span class="op" id="5164600">)</span>&nbsp;<span class="ident" id="5164602">ast</span><span class="op" id="5164605">.</span><span class="ident" id="5164606">Expr</span>&nbsp;<span class="op" id="5164611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164614">if</span>&nbsp;<span class="ident" id="5164617">px</span><span class="op" id="5164619">,</span>&nbsp;<span class="ident" id="5164621">strip</span>&nbsp;<span class="op" id="5164627">:=</span>&nbsp;<span class="ident" id="5164630">x</span><span class="op" id="5164631">.</span><span class="op" id="5164632">(</span><span class="op" id="5164633">*</span><span class="ident" id="5164634">ast</span><span class="op" id="5164637">.</span><span class="ident" id="5164638">ParenExpr</span><span class="op" id="5164647">)</span><span class="op" id="5164648">;</span>&nbsp;<span class="ident" id="5164650">strip</span>&nbsp;<span class="op" id="5164656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164660">//&nbsp;parentheses&nbsp;must&nbsp;not&nbsp;be&nbsp;stripped&nbsp;if&nbsp;there&nbsp;are&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164715">//&nbsp;unparenthesized&nbsp;composite&nbsp;literals&nbsp;starting&nbsp;with</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164769">//&nbsp;a&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164786">ast</span><span class="op" id="5164789">.</span><span class="ident" id="5164790">Inspect</span><span class="op" id="5164797">(</span><span class="ident" id="5164798">px</span><span class="op" id="5164800">.</span><span class="ident" id="5164801">X</span><span class="op" id="5164802">,</span>&nbsp;<span class="keyword" id="5164804">func</span><span class="op" id="5164808">(</span><span class="ident" id="5164809">node</span>&nbsp;<span class="ident" id="5164814">ast</span><span class="op" id="5164817">.</span><span class="ident" id="5164818">Node</span><span class="op" id="5164822">)</span>&nbsp;<span class="builtintype" id="5164824">bool</span>&nbsp;<span class="op" id="5164829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164834">switch</span>&nbsp;<span class="ident" id="5164841">x</span>&nbsp;<span class="op" id="5164843">:=</span>&nbsp;<span class="ident" id="5164846">node</span><span class="op" id="5164850">.</span><span class="op" id="5164851">(</span><span class="keyword" id="5164852">type</span><span class="op" id="5164856">)</span>&nbsp;<span class="op" id="5164858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164863">case</span>&nbsp;<span class="op" id="5164868">*</span><span class="ident" id="5164869">ast</span><span class="op" id="5164872">.</span><span class="ident" id="5164873">ParenExpr</span><span class="op" id="5164882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164888">//&nbsp;parentheses&nbsp;protect&nbsp;enclosed&nbsp;composite&nbsp;literals</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164943">return</span>&nbsp;<span class="builtintype" id="5164950">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164959">case</span>&nbsp;<span class="op" id="5164964">*</span><span class="ident" id="5164965">ast</span><span class="op" id="5164968">.</span><span class="ident" id="5164969">CompositeLit</span><span class="op" id="5164981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164987">if</span>&nbsp;<span class="ident" id="5164990">isTypeName</span><span class="op" id="5165000">(</span><span class="ident" id="5165001">x</span><span class="op" id="5165002">.</span><span class="ident" id="5165003">Type</span><span class="op" id="5165007">)</span>&nbsp;<span class="op" id="5165009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165016">strip</span>&nbsp;<span class="op" id="5165022">=</span>&nbsp;<span class="builtintype" id="5165024">false</span>&nbsp;<span class="comment" id="5165030">//&nbsp;do&nbsp;not&nbsp;strip&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165062">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165068">return</span>&nbsp;<span class="builtintype" id="5165075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5165089">//&nbsp;in&nbsp;all&nbsp;other&nbsp;cases,&nbsp;keep&nbsp;inspecting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165131">return</span>&nbsp;<span class="builtintype" id="5165138">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165145">}</span><span class="op" id="5165146">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165150">if</span>&nbsp;<span class="ident" id="5165153">strip</span>&nbsp;<span class="op" id="5165159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165164">return</span>&nbsp;<span class="ident" id="5165171">stripParens</span><span class="op" id="5165182">(</span><span class="ident" id="5165183">px</span><span class="op" id="5165185">.</span><span class="ident" id="5165186">X</span><span class="op" id="5165187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165197">return</span>&nbsp;<span class="ident" id="5165204">x</span><br>
<span class="lineno">985</span><span class="op" id="5165206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5165209">func</span>&nbsp;<span class="ident" id="5165214">stripParensAlways</span><span class="op" id="5165231">(</span><span class="ident" id="5165232">x</span>&nbsp;<span class="ident" id="5165234">ast</span><span class="op" id="5165237">.</span><span class="ident" id="5165238">Expr</span><span class="op" id="5165242">)</span>&nbsp;<span class="ident" id="5165244">ast</span><span class="op" id="5165247">.</span><span class="ident" id="5165248">Expr</span>&nbsp;<span class="op" id="5165253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165256">if</span>&nbsp;<span class="ident" id="5165259">x</span><span class="op" id="5165260">,</span>&nbsp;<span class="ident" id="5165262">ok</span>&nbsp;<span class="op" id="5165265">:=</span>&nbsp;<span class="ident" id="5165268">x</span><span class="op" id="5165269">.</span><span class="op" id="5165270">(</span><span class="op" id="5165271">*</span><span class="ident" id="5165272">ast</span><span class="op" id="5165275">.</span><span class="ident" id="5165276">ParenExpr</span><span class="op" id="5165285">)</span><span class="op" id="5165286">;</span>&nbsp;<span class="ident" id="5165288">ok</span>&nbsp;<span class="op" id="5165291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165295">return</span>&nbsp;<span class="ident" id="5165302">stripParensAlways</span><span class="op" id="5165319">(</span><span class="ident" id="5165320">x</span><span class="op" id="5165321">.</span><span class="ident" id="5165322">X</span><span class="op" id="5165323">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165329">return</span>&nbsp;<span class="ident" id="5165336">x</span><br>
<span class="lineno"></span><span class="op" id="5165338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5165341">func</span>&nbsp;<span class="op" id="5165346">(</span><span class="ident" id="5165347">p</span>&nbsp;<span class="op" id="5165349">*</span><span class="ident" id="5165350">printer</span><span class="op" id="5165357">)</span>&nbsp;<span class="ident" id="5165359">controlClause</span><span class="op" id="5165372">(</span><span class="ident" id="5165373">isForStmt</span>&nbsp;<span class="builtintype" id="5165383">bool</span><span class="op" id="5165387">,</span>&nbsp;<span class="ident" id="5165389">init</span>&nbsp;<span class="ident" id="5165394">ast</span><span class="op" id="5165397">.</span><span class="ident" id="5165398">Stmt</span><span class="op" id="5165402">,</span>&nbsp;<span class="ident" id="5165404">expr</span>&nbsp;<span class="ident" id="5165409">ast</span><span class="op" id="5165412">.</span><span class="ident" id="5165413">Expr</span><span class="op" id="5165417">,</span>&nbsp;<span class="ident" id="5165419">post</span>&nbsp;<span class="ident" id="5165424">ast</span><span class="op" id="5165427">.</span><span class="ident" id="5165428">Stmt</span><span class="op" id="5165432">)</span>&nbsp;<span class="op" id="5165434">{</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165437">p</span><span class="op" id="5165438">.</span><span class="builtinfunc" id="5165439">print</span><span class="op" id="5165444">(</span><span class="ident" id="5165445">blank</span><span class="op" id="5165450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165453">needsBlank</span>&nbsp;<span class="op" id="5165464">:=</span>&nbsp;<span class="builtintype" id="5165467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165474">if</span>&nbsp;<span class="ident" id="5165477">init</span>&nbsp;<span class="op" id="5165482">==</span>&nbsp;<span class="ident" id="5165485">nil</span>&nbsp;<span class="op" id="5165489">&amp;&amp;</span>&nbsp;<span class="ident" id="5165492">post</span>&nbsp;<span class="op" id="5165497">==</span>&nbsp;<span class="ident" id="5165500">nil</span>&nbsp;<span class="op" id="5165504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5165508">//&nbsp;no&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165536">if</span>&nbsp;<span class="ident" id="5165539">expr</span>&nbsp;<span class="op" id="5165544">!=</span>&nbsp;<span class="ident" id="5165547">nil</span>&nbsp;<span class="op" id="5165551">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165556">p</span><span class="op" id="5165557">.</span><span class="ident" id="5165558">expr</span><span class="op" id="5165562">(</span><span class="ident" id="5165563">stripParens</span><span class="op" id="5165574">(</span><span class="ident" id="5165575">expr</span><span class="op" id="5165579">)</span><span class="op" id="5165580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165585">needsBlank</span>&nbsp;<span class="op" id="5165596">=</span>&nbsp;<span class="builtintype" id="5165598">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165608">}</span>&nbsp;<span class="keyword" id="5165610">else</span>&nbsp;<span class="op" id="5165615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5165619">//&nbsp;all&nbsp;semicolons&nbsp;required</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5165648">//&nbsp;(they&nbsp;are&nbsp;not&nbsp;separators,&nbsp;print&nbsp;them&nbsp;explicitly)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165702">if</span>&nbsp;<span class="ident" id="5165705">init</span>&nbsp;<span class="op" id="5165710">!=</span>&nbsp;<span class="ident" id="5165713">nil</span>&nbsp;<span class="op" id="5165717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165722">p</span><span class="op" id="5165723">.</span><span class="ident" id="5165724">stmt</span><span class="op" id="5165728">(</span><span class="ident" id="5165729">init</span><span class="op" id="5165733">,</span>&nbsp;<span class="builtintype" id="5165735">false</span><span class="op" id="5165740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165748">p</span><span class="op" id="5165749">.</span><span class="builtinfunc" id="5165750">print</span><span class="op" id="5165755">(</span><span class="ident" id="5165756">token</span><span class="op" id="5165761">.</span><span class="ident" id="5165762">SEMICOLON</span><span class="op" id="5165771">,</span>&nbsp;<span class="ident" id="5165773">blank</span><span class="op" id="5165778">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165782">if</span>&nbsp;<span class="ident" id="5165785">expr</span>&nbsp;<span class="op" id="5165790">!=</span>&nbsp;<span class="ident" id="5165793">nil</span>&nbsp;<span class="op" id="5165797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165802">p</span><span class="op" id="5165803">.</span><span class="ident" id="5165804">expr</span><span class="op" id="5165808">(</span><span class="ident" id="5165809">stripParens</span><span class="op" id="5165820">(</span><span class="ident" id="5165821">expr</span><span class="op" id="5165825">)</span><span class="op" id="5165826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165831">needsBlank</span>&nbsp;<span class="op" id="5165842">=</span>&nbsp;<span class="builtintype" id="5165844">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165855">if</span>&nbsp;<span class="ident" id="5165858">isForStmt</span>&nbsp;<span class="op" id="5165868">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165873">p</span><span class="op" id="5165874">.</span><span class="builtinfunc" id="5165875">print</span><span class="op" id="5165880">(</span><span class="ident" id="5165881">token</span><span class="op" id="5165886">.</span><span class="ident" id="5165887">SEMICOLON</span><span class="op" id="5165896">,</span>&nbsp;<span class="ident" id="5165898">blank</span><span class="op" id="5165903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165908">needsBlank</span>&nbsp;<span class="op" id="5165919">=</span>&nbsp;<span class="builtintype" id="5165921">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5165930">if</span>&nbsp;<span class="ident" id="5165933">post</span>&nbsp;<span class="op" id="5165938">!=</span>&nbsp;<span class="ident" id="5165941">nil</span>&nbsp;<span class="op" id="5165945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165951">p</span><span class="op" id="5165952">.</span><span class="ident" id="5165953">stmt</span><span class="op" id="5165957">(</span><span class="ident" id="5165958">post</span><span class="op" id="5165962">,</span>&nbsp;<span class="builtintype" id="5165964">false</span><span class="op" id="5165969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165975">needsBlank</span>&nbsp;<span class="op" id="5165986">=</span>&nbsp;<span class="builtintype" id="5165988">true</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5165996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166006">if</span>&nbsp;<span class="ident" id="5166009">needsBlank</span>&nbsp;<span class="op" id="5166020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166024">p</span><span class="op" id="5166025">.</span><span class="builtinfunc" id="5166026">print</span><span class="op" id="5166031">(</span><span class="ident" id="5166032">blank</span><span class="op" id="5166037">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166040">}</span><br>
<span class="lineno"></span><span class="op" id="5166042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5166045">//&nbsp;indentList&nbsp;reports&nbsp;whether&nbsp;an&nbsp;expression&nbsp;list&nbsp;would&nbsp;look&nbsp;better&nbsp;if&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5166118">//&nbsp;were&nbsp;indented&nbsp;wholesale&nbsp;(starting&nbsp;with&nbsp;the&nbsp;very&nbsp;first&nbsp;element,&nbsp;rather</span><br>
<span class="lineno">1030</span><span class="comment" id="5166191">//&nbsp;than&nbsp;starting&nbsp;at&nbsp;the&nbsp;first&nbsp;line&nbsp;break).</span><br>
<span class="lineno"></span><span class="comment" id="5166234">//</span><br>
<span class="lineno"></span><span class="keyword" id="5166237">func</span>&nbsp;<span class="op" id="5166242">(</span><span class="ident" id="5166243">p</span>&nbsp;<span class="op" id="5166245">*</span><span class="ident" id="5166246">printer</span><span class="op" id="5166253">)</span>&nbsp;<span class="ident" id="5166255">indentList</span><span class="op" id="5166265">(</span><span class="ident" id="5166266">list</span>&nbsp;<span class="op" id="5166271">[</span><span class="op" id="5166272">]</span><span class="ident" id="5166273">ast</span><span class="op" id="5166276">.</span><span class="ident" id="5166277">Expr</span><span class="op" id="5166281">)</span>&nbsp;<span class="builtintype" id="5166283">bool</span>&nbsp;<span class="op" id="5166288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166291">//&nbsp;Heuristic:&nbsp;indentList&nbsp;returns&nbsp;true&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;than&nbsp;one&nbsp;multi-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166364">//&nbsp;line&nbsp;element&nbsp;in&nbsp;the&nbsp;list,&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;element&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166433">//&nbsp;starting&nbsp;on&nbsp;the&nbsp;same&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ends.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166489">if</span>&nbsp;<span class="builtinfunc" id="5166492">len</span><span class="op" id="5166495">(</span><span class="ident" id="5166496">list</span><span class="op" id="5166500">)</span>&nbsp;<span class="op" id="5166502">&gt;=</span>&nbsp;<span class="num" id="5166505">2</span>&nbsp;<span class="op" id="5166507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166511">var</span>&nbsp;<span class="ident" id="5166515">b</span>&nbsp;<span class="op" id="5166517">=</span>&nbsp;<span class="ident" id="5166519">p</span><span class="op" id="5166520">.</span><span class="ident" id="5166521">lineFor</span><span class="op" id="5166528">(</span><span class="ident" id="5166529">list</span><span class="op" id="5166533">[</span><span class="num" id="5166534">0</span><span class="op" id="5166535">]</span><span class="op" id="5166536">.</span><span class="ident" id="5166537">Pos</span><span class="op" id="5166540">(</span><span class="op" id="5166541">)</span><span class="op" id="5166542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166546">var</span>&nbsp;<span class="ident" id="5166550">e</span>&nbsp;<span class="op" id="5166552">=</span>&nbsp;<span class="ident" id="5166554">p</span><span class="op" id="5166555">.</span><span class="ident" id="5166556">lineFor</span><span class="op" id="5166563">(</span><span class="ident" id="5166564">list</span><span class="op" id="5166568">[</span><span class="builtinfunc" id="5166569">len</span><span class="op" id="5166572">(</span><span class="ident" id="5166573">list</span><span class="op" id="5166577">)</span><span class="op" id="5166578">-</span><span class="num" id="5166579">1</span><span class="op" id="5166580">]</span><span class="op" id="5166581">.</span><span class="ident" id="5166582">End</span><span class="op" id="5166585">(</span><span class="op" id="5166586">)</span><span class="op" id="5166587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166591">if</span>&nbsp;<span class="num" id="5166594">0</span>&nbsp;<span class="op" id="5166596">&lt;</span>&nbsp;<span class="ident" id="5166598">b</span>&nbsp;<span class="op" id="5166600">&amp;&amp;</span>&nbsp;<span class="ident" id="5166603">b</span>&nbsp;<span class="op" id="5166605">&lt;</span>&nbsp;<span class="ident" id="5166607">e</span>&nbsp;<span class="op" id="5166609">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166614">//&nbsp;list&nbsp;spans&nbsp;multiple&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166646">n</span>&nbsp;<span class="op" id="5166648">:=</span>&nbsp;<span class="num" id="5166651">0</span>&nbsp;<span class="comment" id="5166653">//&nbsp;multi-line&nbsp;element&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166684">line</span>&nbsp;<span class="op" id="5166689">:=</span>&nbsp;<span class="ident" id="5166692">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166697">for</span>&nbsp;<span class="ident" id="5166701">_</span><span class="op" id="5166702">,</span>&nbsp;<span class="ident" id="5166704">x</span>&nbsp;<span class="op" id="5166706">:=</span>&nbsp;<span class="keyword" id="5166709">range</span>&nbsp;<span class="ident" id="5166715">list</span>&nbsp;<span class="op" id="5166720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166726">xb</span>&nbsp;<span class="op" id="5166729">:=</span>&nbsp;<span class="ident" id="5166732">p</span><span class="op" id="5166733">.</span><span class="ident" id="5166734">lineFor</span><span class="op" id="5166741">(</span><span class="ident" id="5166742">x</span><span class="op" id="5166743">.</span><span class="ident" id="5166744">Pos</span><span class="op" id="5166747">(</span><span class="op" id="5166748">)</span><span class="op" id="5166749">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166755">xe</span>&nbsp;<span class="op" id="5166758">:=</span>&nbsp;<span class="ident" id="5166761">p</span><span class="op" id="5166762">.</span><span class="ident" id="5166763">lineFor</span><span class="op" id="5166770">(</span><span class="ident" id="5166771">x</span><span class="op" id="5166772">.</span><span class="ident" id="5166773">End</span><span class="op" id="5166776">(</span><span class="op" id="5166777">)</span><span class="op" id="5166778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166784">if</span>&nbsp;<span class="ident" id="5166787">line</span>&nbsp;<span class="op" id="5166792">&lt;</span>&nbsp;<span class="ident" id="5166794">xb</span>&nbsp;<span class="op" id="5166797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166804">//&nbsp;x&nbsp;is&nbsp;not&nbsp;starting&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166842">//&nbsp;line&nbsp;as&nbsp;the&nbsp;previous&nbsp;one&nbsp;ended</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166881">return</span>&nbsp;<span class="builtintype" id="5166888">true</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166903">if</span>&nbsp;<span class="ident" id="5166906">xb</span>&nbsp;<span class="op" id="5166909">&lt;</span>&nbsp;<span class="ident" id="5166911">xe</span>&nbsp;<span class="op" id="5166914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166921">//&nbsp;x&nbsp;is&nbsp;a&nbsp;multi-line&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166955">n</span><span class="op" id="5166956">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166963">}</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166969">line</span>&nbsp;<span class="op" id="5166974">=</span>&nbsp;<span class="ident" id="5166976">xe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5166982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5166987">return</span>&nbsp;<span class="ident" id="5166994">n</span>&nbsp;<span class="op" id="5166996">&gt;</span>&nbsp;<span class="num" id="5166998">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167005">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167008">return</span>&nbsp;<span class="builtintype" id="5167015">false</span><br>
<span class="lineno"></span><span class="op" id="5167021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5167024">func</span>&nbsp;<span class="op" id="5167029">(</span><span class="ident" id="5167030">p</span>&nbsp;<span class="op" id="5167032">*</span><span class="ident" id="5167033">printer</span><span class="op" id="5167040">)</span>&nbsp;<span class="ident" id="5167042">stmt</span><span class="op" id="5167046">(</span><span class="ident" id="5167047">stmt</span>&nbsp;<span class="ident" id="5167052">ast</span><span class="op" id="5167055">.</span><span class="ident" id="5167056">Stmt</span><span class="op" id="5167060">,</span>&nbsp;<span class="ident" id="5167062">nextIsRBrace</span>&nbsp;<span class="builtintype" id="5167075">bool</span><span class="op" id="5167079">)</span>&nbsp;<span class="op" id="5167081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167084">p</span><span class="op" id="5167085">.</span><span class="builtinfunc" id="5167086">print</span><span class="op" id="5167091">(</span><span class="ident" id="5167092">stmt</span><span class="op" id="5167096">.</span><span class="ident" id="5167097">Pos</span><span class="op" id="5167100">(</span><span class="op" id="5167101">)</span><span class="op" id="5167102">)</span><br>
<span class="lineno">1065</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167106">switch</span>&nbsp;<span class="ident" id="5167113">s</span>&nbsp;<span class="op" id="5167115">:=</span>&nbsp;<span class="ident" id="5167118">stmt</span><span class="op" id="5167122">.</span><span class="op" id="5167123">(</span><span class="keyword" id="5167124">type</span><span class="op" id="5167128">)</span>&nbsp;<span class="op" id="5167130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167133">case</span>&nbsp;<span class="op" id="5167138">*</span><span class="ident" id="5167139">ast</span><span class="op" id="5167142">.</span><span class="ident" id="5167143">BadStmt</span><span class="op" id="5167150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167154">p</span><span class="op" id="5167155">.</span><span class="builtinfunc" id="5167156">print</span><span class="op" id="5167161">(</span><span class="string" id="5167162">&#34;BadStmt&#34;</span><span class="op" id="5167171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167175">case</span>&nbsp;<span class="op" id="5167180">*</span><span class="ident" id="5167181">ast</span><span class="op" id="5167184">.</span><span class="ident" id="5167185">DeclStmt</span><span class="op" id="5167193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167197">p</span><span class="op" id="5167198">.</span><span class="ident" id="5167199">decl</span><span class="op" id="5167203">(</span><span class="ident" id="5167204">s</span><span class="op" id="5167205">.</span><span class="ident" id="5167206">Decl</span><span class="op" id="5167210">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167214">case</span>&nbsp;<span class="op" id="5167219">*</span><span class="ident" id="5167220">ast</span><span class="op" id="5167223">.</span><span class="ident" id="5167224">EmptyStmt</span><span class="op" id="5167233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167237">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">1075</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167256">case</span>&nbsp;<span class="op" id="5167261">*</span><span class="ident" id="5167262">ast</span><span class="op" id="5167265">.</span><span class="ident" id="5167266">LabeledStmt</span><span class="op" id="5167277">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167281">//&nbsp;a&nbsp;&#34;correcting&#34;&nbsp;unindent&nbsp;immediately&nbsp;following&nbsp;a&nbsp;line&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167345">//&nbsp;is&nbsp;applied&nbsp;before&nbsp;the&nbsp;line&nbsp;break&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167406">//&nbsp;between&nbsp;(see&nbsp;writeWhitespace)</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167441">p</span><span class="op" id="5167442">.</span><span class="builtinfunc" id="5167443">print</span><span class="op" id="5167448">(</span><span class="ident" id="5167449">unindent</span><span class="op" id="5167457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167461">p</span><span class="op" id="5167462">.</span><span class="ident" id="5167463">expr</span><span class="op" id="5167467">(</span><span class="ident" id="5167468">s</span><span class="op" id="5167469">.</span><span class="ident" id="5167470">Label</span><span class="op" id="5167475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167479">p</span><span class="op" id="5167480">.</span><span class="builtinfunc" id="5167481">print</span><span class="op" id="5167486">(</span><span class="ident" id="5167487">s</span><span class="op" id="5167488">.</span><span class="ident" id="5167489">Colon</span><span class="op" id="5167494">,</span>&nbsp;<span class="ident" id="5167496">token</span><span class="op" id="5167501">.</span><span class="ident" id="5167502">COLON</span><span class="op" id="5167507">,</span>&nbsp;<span class="ident" id="5167509">indent</span><span class="op" id="5167515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167519">if</span>&nbsp;<span class="ident" id="5167522">e</span><span class="op" id="5167523">,</span>&nbsp;<span class="ident" id="5167525">isEmpty</span>&nbsp;<span class="op" id="5167533">:=</span>&nbsp;<span class="ident" id="5167536">s</span><span class="op" id="5167537">.</span><span class="ident" id="5167538">Stmt</span><span class="op" id="5167542">.</span><span class="op" id="5167543">(</span><span class="op" id="5167544">*</span><span class="ident" id="5167545">ast</span><span class="op" id="5167548">.</span><span class="ident" id="5167549">EmptyStmt</span><span class="op" id="5167558">)</span><span class="op" id="5167559">;</span>&nbsp;<span class="ident" id="5167561">isEmpty</span>&nbsp;<span class="op" id="5167569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167574">if</span>&nbsp;<span class="op" id="5167577">!</span><span class="ident" id="5167578">nextIsRBrace</span>&nbsp;<span class="op" id="5167591">{</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167597">p</span><span class="op" id="5167598">.</span><span class="builtinfunc" id="5167599">print</span><span class="op" id="5167604">(</span><span class="ident" id="5167605">newline</span><span class="op" id="5167612">,</span>&nbsp;<span class="ident" id="5167614">e</span><span class="op" id="5167615">.</span><span class="ident" id="5167616">Pos</span><span class="op" id="5167619">(</span><span class="op" id="5167620">)</span><span class="op" id="5167621">,</span>&nbsp;<span class="ident" id="5167623">token</span><span class="op" id="5167628">.</span><span class="ident" id="5167629">SEMICOLON</span><span class="op" id="5167638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167644">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167657">}</span>&nbsp;<span class="keyword" id="5167659">else</span>&nbsp;<span class="op" id="5167664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167669">p</span><span class="op" id="5167670">.</span><span class="ident" id="5167671">linebreak</span><span class="op" id="5167680">(</span><span class="ident" id="5167681">p</span><span class="op" id="5167682">.</span><span class="ident" id="5167683">lineFor</span><span class="op" id="5167690">(</span><span class="ident" id="5167691">s</span><span class="op" id="5167692">.</span><span class="ident" id="5167693">Stmt</span><span class="op" id="5167697">.</span><span class="ident" id="5167698">Pos</span><span class="op" id="5167701">(</span><span class="op" id="5167702">)</span><span class="op" id="5167703">)</span><span class="op" id="5167704">,</span>&nbsp;<span class="num" id="5167706">1</span><span class="op" id="5167707">,</span>&nbsp;<span class="ident" id="5167709">ignore</span><span class="op" id="5167715">,</span>&nbsp;<span class="builtintype" id="5167717">true</span><span class="op" id="5167721">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5167725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167729">p</span><span class="op" id="5167730">.</span><span class="ident" id="5167731">stmt</span><span class="op" id="5167735">(</span><span class="ident" id="5167736">s</span><span class="op" id="5167737">.</span><span class="ident" id="5167738">Stmt</span><span class="op" id="5167742">,</span>&nbsp;<span class="ident" id="5167744">nextIsRBrace</span><span class="op" id="5167756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167760">case</span>&nbsp;<span class="op" id="5167765">*</span><span class="ident" id="5167766">ast</span><span class="op" id="5167769">.</span><span class="ident" id="5167770">ExprStmt</span><span class="op" id="5167778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167782">const</span>&nbsp;<span class="ident" id="5167788">depth</span>&nbsp;<span class="op" id="5167794">=</span>&nbsp;<span class="num" id="5167796">1</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167800">p</span><span class="op" id="5167801">.</span><span class="ident" id="5167802">expr0</span><span class="op" id="5167807">(</span><span class="ident" id="5167808">s</span><span class="op" id="5167809">.</span><span class="ident" id="5167810">X</span><span class="op" id="5167811">,</span>&nbsp;<span class="ident" id="5167813">depth</span><span class="op" id="5167818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167822">case</span>&nbsp;<span class="op" id="5167827">*</span><span class="ident" id="5167828">ast</span><span class="op" id="5167831">.</span><span class="ident" id="5167832">SendStmt</span><span class="op" id="5167840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167844">const</span>&nbsp;<span class="ident" id="5167850">depth</span>&nbsp;<span class="op" id="5167856">=</span>&nbsp;<span class="num" id="5167858">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167862">p</span><span class="op" id="5167863">.</span><span class="ident" id="5167864">expr0</span><span class="op" id="5167869">(</span><span class="ident" id="5167870">s</span><span class="op" id="5167871">.</span><span class="ident" id="5167872">Chan</span><span class="op" id="5167876">,</span>&nbsp;<span class="ident" id="5167878">depth</span><span class="op" id="5167883">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167887">p</span><span class="op" id="5167888">.</span><span class="builtinfunc" id="5167889">print</span><span class="op" id="5167894">(</span><span class="ident" id="5167895">blank</span><span class="op" id="5167900">,</span>&nbsp;<span class="ident" id="5167902">s</span><span class="op" id="5167903">.</span><span class="ident" id="5167904">Arrow</span><span class="op" id="5167909">,</span>&nbsp;<span class="ident" id="5167911">token</span><span class="op" id="5167916">.</span><span class="ident" id="5167917">ARROW</span><span class="op" id="5167922">,</span>&nbsp;<span class="ident" id="5167924">blank</span><span class="op" id="5167929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167933">p</span><span class="op" id="5167934">.</span><span class="ident" id="5167935">expr0</span><span class="op" id="5167940">(</span><span class="ident" id="5167941">s</span><span class="op" id="5167942">.</span><span class="ident" id="5167943">Value</span><span class="op" id="5167948">,</span>&nbsp;<span class="ident" id="5167950">depth</span><span class="op" id="5167955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167959">case</span>&nbsp;<span class="op" id="5167964">*</span><span class="ident" id="5167965">ast</span><span class="op" id="5167968">.</span><span class="ident" id="5167969">IncDecStmt</span><span class="op" id="5167979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5167983">const</span>&nbsp;<span class="ident" id="5167989">depth</span>&nbsp;<span class="op" id="5167995">=</span>&nbsp;<span class="num" id="5167997">1</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168001">p</span><span class="op" id="5168002">.</span><span class="ident" id="5168003">expr0</span><span class="op" id="5168008">(</span><span class="ident" id="5168009">s</span><span class="op" id="5168010">.</span><span class="ident" id="5168011">X</span><span class="op" id="5168012">,</span>&nbsp;<span class="ident" id="5168014">depth</span><span class="op" id="5168019">+</span><span class="num" id="5168020">1</span><span class="op" id="5168021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168025">p</span><span class="op" id="5168026">.</span><span class="builtinfunc" id="5168027">print</span><span class="op" id="5168032">(</span><span class="ident" id="5168033">s</span><span class="op" id="5168034">.</span><span class="ident" id="5168035">TokPos</span><span class="op" id="5168041">,</span>&nbsp;<span class="ident" id="5168043">s</span><span class="op" id="5168044">.</span><span class="ident" id="5168045">Tok</span><span class="op" id="5168048">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168052">case</span>&nbsp;<span class="op" id="5168057">*</span><span class="ident" id="5168058">ast</span><span class="op" id="5168061">.</span><span class="ident" id="5168062">AssignStmt</span><span class="op" id="5168072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168076">var</span>&nbsp;<span class="ident" id="5168080">depth</span>&nbsp;<span class="op" id="5168086">=</span>&nbsp;<span class="num" id="5168088">1</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168092">if</span>&nbsp;<span class="builtinfunc" id="5168095">len</span><span class="op" id="5168098">(</span><span class="ident" id="5168099">s</span><span class="op" id="5168100">.</span><span class="ident" id="5168101">Lhs</span><span class="op" id="5168104">)</span>&nbsp;<span class="op" id="5168106">&gt;</span>&nbsp;<span class="num" id="5168108">1</span>&nbsp;<span class="op" id="5168110">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5168113">len</span><span class="op" id="5168116">(</span><span class="ident" id="5168117">s</span><span class="op" id="5168118">.</span><span class="ident" id="5168119">Rhs</span><span class="op" id="5168122">)</span>&nbsp;<span class="op" id="5168124">&gt;</span>&nbsp;<span class="num" id="5168126">1</span>&nbsp;<span class="op" id="5168128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168133">depth</span><span class="op" id="5168138">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168147">p</span><span class="op" id="5168148">.</span><span class="ident" id="5168149">exprList</span><span class="op" id="5168157">(</span><span class="ident" id="5168158">s</span><span class="op" id="5168159">.</span><span class="ident" id="5168160">Pos</span><span class="op" id="5168163">(</span><span class="op" id="5168164">)</span><span class="op" id="5168165">,</span>&nbsp;<span class="ident" id="5168167">s</span><span class="op" id="5168168">.</span><span class="ident" id="5168169">Lhs</span><span class="op" id="5168172">,</span>&nbsp;<span class="ident" id="5168174">depth</span><span class="op" id="5168179">,</span>&nbsp;<span class="num" id="5168181">0</span><span class="op" id="5168182">,</span>&nbsp;<span class="ident" id="5168184">s</span><span class="op" id="5168185">.</span><span class="ident" id="5168186">TokPos</span><span class="op" id="5168192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168196">p</span><span class="op" id="5168197">.</span><span class="builtinfunc" id="5168198">print</span><span class="op" id="5168203">(</span><span class="ident" id="5168204">blank</span><span class="op" id="5168209">,</span>&nbsp;<span class="ident" id="5168211">s</span><span class="op" id="5168212">.</span><span class="ident" id="5168213">TokPos</span><span class="op" id="5168219">,</span>&nbsp;<span class="ident" id="5168221">s</span><span class="op" id="5168222">.</span><span class="ident" id="5168223">Tok</span><span class="op" id="5168226">,</span>&nbsp;<span class="ident" id="5168228">blank</span><span class="op" id="5168233">)</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168237">p</span><span class="op" id="5168238">.</span><span class="ident" id="5168239">exprList</span><span class="op" id="5168247">(</span><span class="ident" id="5168248">s</span><span class="op" id="5168249">.</span><span class="ident" id="5168250">TokPos</span><span class="op" id="5168256">,</span>&nbsp;<span class="ident" id="5168258">s</span><span class="op" id="5168259">.</span><span class="ident" id="5168260">Rhs</span><span class="op" id="5168263">,</span>&nbsp;<span class="ident" id="5168265">depth</span><span class="op" id="5168270">,</span>&nbsp;<span class="num" id="5168272">0</span><span class="op" id="5168273">,</span>&nbsp;<span class="ident" id="5168275">token</span><span class="op" id="5168280">.</span><span class="ident" id="5168281">NoPos</span><span class="op" id="5168286">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168290">case</span>&nbsp;<span class="op" id="5168295">*</span><span class="ident" id="5168296">ast</span><span class="op" id="5168299">.</span><span class="ident" id="5168300">GoStmt</span><span class="op" id="5168306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168310">p</span><span class="op" id="5168311">.</span><span class="builtinfunc" id="5168312">print</span><span class="op" id="5168317">(</span><span class="ident" id="5168318">token</span><span class="op" id="5168323">.</span><span class="ident" id="5168324">GO</span><span class="op" id="5168326">,</span>&nbsp;<span class="ident" id="5168328">blank</span><span class="op" id="5168333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168337">p</span><span class="op" id="5168338">.</span><span class="ident" id="5168339">expr</span><span class="op" id="5168343">(</span><span class="ident" id="5168344">s</span><span class="op" id="5168345">.</span><span class="ident" id="5168346">Call</span><span class="op" id="5168350">)</span><br>
<span class="lineno">1120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168354">case</span>&nbsp;<span class="op" id="5168359">*</span><span class="ident" id="5168360">ast</span><span class="op" id="5168363">.</span><span class="ident" id="5168364">DeferStmt</span><span class="op" id="5168373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168377">p</span><span class="op" id="5168378">.</span><span class="builtinfunc" id="5168379">print</span><span class="op" id="5168384">(</span><span class="ident" id="5168385">token</span><span class="op" id="5168390">.</span><span class="ident" id="5168391">DEFER</span><span class="op" id="5168396">,</span>&nbsp;<span class="ident" id="5168398">blank</span><span class="op" id="5168403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168407">p</span><span class="op" id="5168408">.</span><span class="ident" id="5168409">expr</span><span class="op" id="5168413">(</span><span class="ident" id="5168414">s</span><span class="op" id="5168415">.</span><span class="ident" id="5168416">Call</span><span class="op" id="5168420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168424">case</span>&nbsp;<span class="op" id="5168429">*</span><span class="ident" id="5168430">ast</span><span class="op" id="5168433">.</span><span class="ident" id="5168434">ReturnStmt</span><span class="op" id="5168444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168448">p</span><span class="op" id="5168449">.</span><span class="builtinfunc" id="5168450">print</span><span class="op" id="5168455">(</span><span class="ident" id="5168456">token</span><span class="op" id="5168461">.</span><span class="ident" id="5168462">RETURN</span><span class="op" id="5168468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168472">if</span>&nbsp;<span class="ident" id="5168475">s</span><span class="op" id="5168476">.</span><span class="ident" id="5168477">Results</span>&nbsp;<span class="op" id="5168485">!=</span>&nbsp;<span class="ident" id="5168488">nil</span>&nbsp;<span class="op" id="5168492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168497">p</span><span class="op" id="5168498">.</span><span class="builtinfunc" id="5168499">print</span><span class="op" id="5168504">(</span><span class="ident" id="5168505">blank</span><span class="op" id="5168510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168515">//&nbsp;Use&nbsp;indentList&nbsp;heuristic&nbsp;to&nbsp;make&nbsp;corner&nbsp;cases&nbsp;look</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168572">//&nbsp;better&nbsp;(issue&nbsp;1207).&nbsp;A&nbsp;more&nbsp;systematic&nbsp;approach&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168632">//&nbsp;always&nbsp;indent,&nbsp;but&nbsp;this&nbsp;would&nbsp;cause&nbsp;significant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168686">//&nbsp;reformatting&nbsp;of&nbsp;the&nbsp;code&nbsp;base&nbsp;and&nbsp;not&nbsp;necessarily</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168742">//&nbsp;lead&nbsp;to&nbsp;more&nbsp;nicely&nbsp;formatted&nbsp;code&nbsp;in&nbsp;general.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168795">if</span>&nbsp;<span class="ident" id="5168798">p</span><span class="op" id="5168799">.</span><span class="ident" id="5168800">indentList</span><span class="op" id="5168810">(</span><span class="ident" id="5168811">s</span><span class="op" id="5168812">.</span><span class="ident" id="5168813">Results</span><span class="op" id="5168820">)</span>&nbsp;<span class="op" id="5168822">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168828">p</span><span class="op" id="5168829">.</span><span class="builtinfunc" id="5168830">print</span><span class="op" id="5168835">(</span><span class="ident" id="5168836">indent</span><span class="op" id="5168842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168848">p</span><span class="op" id="5168849">.</span><span class="ident" id="5168850">exprList</span><span class="op" id="5168858">(</span><span class="ident" id="5168859">s</span><span class="op" id="5168860">.</span><span class="ident" id="5168861">Pos</span><span class="op" id="5168864">(</span><span class="op" id="5168865">)</span><span class="op" id="5168866">,</span>&nbsp;<span class="ident" id="5168868">s</span><span class="op" id="5168869">.</span><span class="ident" id="5168870">Results</span><span class="op" id="5168877">,</span>&nbsp;<span class="num" id="5168879">1</span><span class="op" id="5168880">,</span>&nbsp;<span class="ident" id="5168882">noIndent</span><span class="op" id="5168890">,</span>&nbsp;<span class="ident" id="5168892">token</span><span class="op" id="5168897">.</span><span class="ident" id="5168898">NoPos</span><span class="op" id="5168903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168909">p</span><span class="op" id="5168910">.</span><span class="builtinfunc" id="5168911">print</span><span class="op" id="5168916">(</span><span class="ident" id="5168917">unindent</span><span class="op" id="5168925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168930">}</span>&nbsp;<span class="keyword" id="5168932">else</span>&nbsp;<span class="op" id="5168937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168943">p</span><span class="op" id="5168944">.</span><span class="ident" id="5168945">exprList</span><span class="op" id="5168953">(</span><span class="ident" id="5168954">s</span><span class="op" id="5168955">.</span><span class="ident" id="5168956">Pos</span><span class="op" id="5168959">(</span><span class="op" id="5168960">)</span><span class="op" id="5168961">,</span>&nbsp;<span class="ident" id="5168963">s</span><span class="op" id="5168964">.</span><span class="ident" id="5168965">Results</span><span class="op" id="5168972">,</span>&nbsp;<span class="num" id="5168974">1</span><span class="op" id="5168975">,</span>&nbsp;<span class="num" id="5168977">0</span><span class="op" id="5168978">,</span>&nbsp;<span class="ident" id="5168980">token</span><span class="op" id="5168985">.</span><span class="ident" id="5168986">NoPos</span><span class="op" id="5168991">)</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169004">case</span>&nbsp;<span class="op" id="5169009">*</span><span class="ident" id="5169010">ast</span><span class="op" id="5169013">.</span><span class="ident" id="5169014">BranchStmt</span><span class="op" id="5169024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169028">p</span><span class="op" id="5169029">.</span><span class="builtinfunc" id="5169030">print</span><span class="op" id="5169035">(</span><span class="ident" id="5169036">s</span><span class="op" id="5169037">.</span><span class="ident" id="5169038">Tok</span><span class="op" id="5169041">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169045">if</span>&nbsp;<span class="ident" id="5169048">s</span><span class="op" id="5169049">.</span><span class="ident" id="5169050">Label</span>&nbsp;<span class="op" id="5169056">!=</span>&nbsp;<span class="ident" id="5169059">nil</span>&nbsp;<span class="op" id="5169063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169068">p</span><span class="op" id="5169069">.</span><span class="builtinfunc" id="5169070">print</span><span class="op" id="5169075">(</span><span class="ident" id="5169076">blank</span><span class="op" id="5169081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169086">p</span><span class="op" id="5169087">.</span><span class="ident" id="5169088">expr</span><span class="op" id="5169092">(</span><span class="ident" id="5169093">s</span><span class="op" id="5169094">.</span><span class="ident" id="5169095">Label</span><span class="op" id="5169100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169108">case</span>&nbsp;<span class="op" id="5169113">*</span><span class="ident" id="5169114">ast</span><span class="op" id="5169117">.</span><span class="ident" id="5169118">BlockStmt</span><span class="op" id="5169127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169131">p</span><span class="op" id="5169132">.</span><span class="ident" id="5169133">block</span><span class="op" id="5169138">(</span><span class="ident" id="5169139">s</span><span class="op" id="5169140">,</span>&nbsp;<span class="num" id="5169142">1</span><span class="op" id="5169143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169147">case</span>&nbsp;<span class="op" id="5169152">*</span><span class="ident" id="5169153">ast</span><span class="op" id="5169156">.</span><span class="ident" id="5169157">IfStmt</span><span class="op" id="5169163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169167">p</span><span class="op" id="5169168">.</span><span class="builtinfunc" id="5169169">print</span><span class="op" id="5169174">(</span><span class="ident" id="5169175">token</span><span class="op" id="5169180">.</span><span class="ident" id="5169181">IF</span><span class="op" id="5169183">)</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169187">p</span><span class="op" id="5169188">.</span><span class="ident" id="5169189">controlClause</span><span class="op" id="5169202">(</span><span class="builtintype" id="5169203">false</span><span class="op" id="5169208">,</span>&nbsp;<span class="ident" id="5169210">s</span><span class="op" id="5169211">.</span><span class="ident" id="5169212">Init</span><span class="op" id="5169216">,</span>&nbsp;<span class="ident" id="5169218">s</span><span class="op" id="5169219">.</span><span class="ident" id="5169220">Cond</span><span class="op" id="5169224">,</span>&nbsp;<span class="ident" id="5169226">nil</span><span class="op" id="5169229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169233">p</span><span class="op" id="5169234">.</span><span class="ident" id="5169235">block</span><span class="op" id="5169240">(</span><span class="ident" id="5169241">s</span><span class="op" id="5169242">.</span><span class="ident" id="5169243">Body</span><span class="op" id="5169247">,</span>&nbsp;<span class="num" id="5169249">1</span><span class="op" id="5169250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169254">if</span>&nbsp;<span class="ident" id="5169257">s</span><span class="op" id="5169258">.</span><span class="ident" id="5169259">Else</span>&nbsp;<span class="op" id="5169264">!=</span>&nbsp;<span class="ident" id="5169267">nil</span>&nbsp;<span class="op" id="5169271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169276">p</span><span class="op" id="5169277">.</span><span class="builtinfunc" id="5169278">print</span><span class="op" id="5169283">(</span><span class="ident" id="5169284">blank</span><span class="op" id="5169289">,</span>&nbsp;<span class="ident" id="5169291">token</span><span class="op" id="5169296">.</span><span class="ident" id="5169297">ELSE</span><span class="op" id="5169301">,</span>&nbsp;<span class="ident" id="5169303">blank</span><span class="op" id="5169308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169313">switch</span>&nbsp;<span class="ident" id="5169320">s</span><span class="op" id="5169321">.</span><span class="ident" id="5169322">Else</span><span class="op" id="5169326">.</span><span class="op" id="5169327">(</span><span class="keyword" id="5169328">type</span><span class="op" id="5169332">)</span>&nbsp;<span class="op" id="5169334">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169339">case</span>&nbsp;<span class="op" id="5169344">*</span><span class="ident" id="5169345">ast</span><span class="op" id="5169348">.</span><span class="ident" id="5169349">BlockStmt</span><span class="op" id="5169358">,</span>&nbsp;<span class="op" id="5169360">*</span><span class="ident" id="5169361">ast</span><span class="op" id="5169364">.</span><span class="ident" id="5169365">IfStmt</span><span class="op" id="5169371">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169377">p</span><span class="op" id="5169378">.</span><span class="ident" id="5169379">stmt</span><span class="op" id="5169383">(</span><span class="ident" id="5169384">s</span><span class="op" id="5169385">.</span><span class="ident" id="5169386">Else</span><span class="op" id="5169390">,</span>&nbsp;<span class="ident" id="5169392">nextIsRBrace</span><span class="op" id="5169404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169409">default</span><span class="op" id="5169416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169422">p</span><span class="op" id="5169423">.</span><span class="builtinfunc" id="5169424">print</span><span class="op" id="5169429">(</span><span class="ident" id="5169430">token</span><span class="op" id="5169435">.</span><span class="ident" id="5169436">LBRACE</span><span class="op" id="5169442">,</span>&nbsp;<span class="ident" id="5169444">indent</span><span class="op" id="5169450">,</span>&nbsp;<span class="ident" id="5169452">formfeed</span><span class="op" id="5169460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169466">p</span><span class="op" id="5169467">.</span><span class="ident" id="5169468">stmt</span><span class="op" id="5169472">(</span><span class="ident" id="5169473">s</span><span class="op" id="5169474">.</span><span class="ident" id="5169475">Else</span><span class="op" id="5169479">,</span>&nbsp;<span class="builtintype" id="5169481">true</span><span class="op" id="5169485">)</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169491">p</span><span class="op" id="5169492">.</span><span class="builtinfunc" id="5169493">print</span><span class="op" id="5169498">(</span><span class="ident" id="5169499">unindent</span><span class="op" id="5169507">,</span>&nbsp;<span class="ident" id="5169509">formfeed</span><span class="op" id="5169517">,</span>&nbsp;<span class="ident" id="5169519">token</span><span class="op" id="5169524">.</span><span class="ident" id="5169525">RBRACE</span><span class="op" id="5169531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169544">case</span>&nbsp;<span class="op" id="5169549">*</span><span class="ident" id="5169550">ast</span><span class="op" id="5169553">.</span><span class="ident" id="5169554">CaseClause</span><span class="op" id="5169564">:</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169568">if</span>&nbsp;<span class="ident" id="5169571">s</span><span class="op" id="5169572">.</span><span class="ident" id="5169573">List</span>&nbsp;<span class="op" id="5169578">!=</span>&nbsp;<span class="ident" id="5169581">nil</span>&nbsp;<span class="op" id="5169585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169590">p</span><span class="op" id="5169591">.</span><span class="builtinfunc" id="5169592">print</span><span class="op" id="5169597">(</span><span class="ident" id="5169598">token</span><span class="op" id="5169603">.</span><span class="ident" id="5169604">CASE</span><span class="op" id="5169608">,</span>&nbsp;<span class="ident" id="5169610">blank</span><span class="op" id="5169615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169620">p</span><span class="op" id="5169621">.</span><span class="ident" id="5169622">exprList</span><span class="op" id="5169630">(</span><span class="ident" id="5169631">s</span><span class="op" id="5169632">.</span><span class="ident" id="5169633">Pos</span><span class="op" id="5169636">(</span><span class="op" id="5169637">)</span><span class="op" id="5169638">,</span>&nbsp;<span class="ident" id="5169640">s</span><span class="op" id="5169641">.</span><span class="ident" id="5169642">List</span><span class="op" id="5169646">,</span>&nbsp;<span class="num" id="5169648">1</span><span class="op" id="5169649">,</span>&nbsp;<span class="num" id="5169651">0</span><span class="op" id="5169652">,</span>&nbsp;<span class="ident" id="5169654">s</span><span class="op" id="5169655">.</span><span class="ident" id="5169656">Colon</span><span class="op" id="5169661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169665">}</span>&nbsp;<span class="keyword" id="5169667">else</span>&nbsp;<span class="op" id="5169672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169677">p</span><span class="op" id="5169678">.</span><span class="builtinfunc" id="5169679">print</span><span class="op" id="5169684">(</span><span class="ident" id="5169685">token</span><span class="op" id="5169690">.</span><span class="ident" id="5169691">DEFAULT</span><span class="op" id="5169698">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169706">p</span><span class="op" id="5169707">.</span><span class="builtinfunc" id="5169708">print</span><span class="op" id="5169713">(</span><span class="ident" id="5169714">s</span><span class="op" id="5169715">.</span><span class="ident" id="5169716">Colon</span><span class="op" id="5169721">,</span>&nbsp;<span class="ident" id="5169723">token</span><span class="op" id="5169728">.</span><span class="ident" id="5169729">COLON</span><span class="op" id="5169734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169738">p</span><span class="op" id="5169739">.</span><span class="ident" id="5169740">stmtList</span><span class="op" id="5169748">(</span><span class="ident" id="5169749">s</span><span class="op" id="5169750">.</span><span class="ident" id="5169751">Body</span><span class="op" id="5169755">,</span>&nbsp;<span class="num" id="5169757">1</span><span class="op" id="5169758">,</span>&nbsp;<span class="ident" id="5169760">nextIsRBrace</span><span class="op" id="5169772">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169776">case</span>&nbsp;<span class="op" id="5169781">*</span><span class="ident" id="5169782">ast</span><span class="op" id="5169785">.</span><span class="ident" id="5169786">SwitchStmt</span><span class="op" id="5169796">:</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169800">p</span><span class="op" id="5169801">.</span><span class="builtinfunc" id="5169802">print</span><span class="op" id="5169807">(</span><span class="ident" id="5169808">token</span><span class="op" id="5169813">.</span><span class="ident" id="5169814">SWITCH</span><span class="op" id="5169820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169824">p</span><span class="op" id="5169825">.</span><span class="ident" id="5169826">controlClause</span><span class="op" id="5169839">(</span><span class="builtintype" id="5169840">false</span><span class="op" id="5169845">,</span>&nbsp;<span class="ident" id="5169847">s</span><span class="op" id="5169848">.</span><span class="ident" id="5169849">Init</span><span class="op" id="5169853">,</span>&nbsp;<span class="ident" id="5169855">s</span><span class="op" id="5169856">.</span><span class="ident" id="5169857">Tag</span><span class="op" id="5169860">,</span>&nbsp;<span class="ident" id="5169862">nil</span><span class="op" id="5169865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169869">p</span><span class="op" id="5169870">.</span><span class="ident" id="5169871">block</span><span class="op" id="5169876">(</span><span class="ident" id="5169877">s</span><span class="op" id="5169878">.</span><span class="ident" id="5169879">Body</span><span class="op" id="5169883">,</span>&nbsp;<span class="num" id="5169885">0</span><span class="op" id="5169886">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169890">case</span>&nbsp;<span class="op" id="5169895">*</span><span class="ident" id="5169896">ast</span><span class="op" id="5169899">.</span><span class="ident" id="5169900">TypeSwitchStmt</span><span class="op" id="5169914">:</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169918">p</span><span class="op" id="5169919">.</span><span class="builtinfunc" id="5169920">print</span><span class="op" id="5169925">(</span><span class="ident" id="5169926">token</span><span class="op" id="5169931">.</span><span class="ident" id="5169932">SWITCH</span><span class="op" id="5169938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169942">if</span>&nbsp;<span class="ident" id="5169945">s</span><span class="op" id="5169946">.</span><span class="ident" id="5169947">Init</span>&nbsp;<span class="op" id="5169952">!=</span>&nbsp;<span class="ident" id="5169955">nil</span>&nbsp;<span class="op" id="5169959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169964">p</span><span class="op" id="5169965">.</span><span class="builtinfunc" id="5169966">print</span><span class="op" id="5169971">(</span><span class="ident" id="5169972">blank</span><span class="op" id="5169977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5169982">p</span><span class="op" id="5169983">.</span><span class="ident" id="5169984">stmt</span><span class="op" id="5169988">(</span><span class="ident" id="5169989">s</span><span class="op" id="5169990">.</span><span class="ident" id="5169991">Init</span><span class="op" id="5169995">,</span>&nbsp;<span class="builtintype" id="5169997">false</span><span class="op" id="5170002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170007">p</span><span class="op" id="5170008">.</span><span class="builtinfunc" id="5170009">print</span><span class="op" id="5170014">(</span><span class="ident" id="5170015">token</span><span class="op" id="5170020">.</span><span class="ident" id="5170021">SEMICOLON</span><span class="op" id="5170030">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170038">p</span><span class="op" id="5170039">.</span><span class="builtinfunc" id="5170040">print</span><span class="op" id="5170045">(</span><span class="ident" id="5170046">blank</span><span class="op" id="5170051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170055">p</span><span class="op" id="5170056">.</span><span class="ident" id="5170057">stmt</span><span class="op" id="5170061">(</span><span class="ident" id="5170062">s</span><span class="op" id="5170063">.</span><span class="ident" id="5170064">Assign</span><span class="op" id="5170070">,</span>&nbsp;<span class="builtintype" id="5170072">false</span><span class="op" id="5170077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170081">p</span><span class="op" id="5170082">.</span><span class="builtinfunc" id="5170083">print</span><span class="op" id="5170088">(</span><span class="ident" id="5170089">blank</span><span class="op" id="5170094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170098">p</span><span class="op" id="5170099">.</span><span class="ident" id="5170100">block</span><span class="op" id="5170105">(</span><span class="ident" id="5170106">s</span><span class="op" id="5170107">.</span><span class="ident" id="5170108">Body</span><span class="op" id="5170112">,</span>&nbsp;<span class="num" id="5170114">0</span><span class="op" id="5170115">)</span><br>
<span class="lineno">1195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170119">case</span>&nbsp;<span class="op" id="5170124">*</span><span class="ident" id="5170125">ast</span><span class="op" id="5170128">.</span><span class="ident" id="5170129">CommClause</span><span class="op" id="5170139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170143">if</span>&nbsp;<span class="ident" id="5170146">s</span><span class="op" id="5170147">.</span><span class="ident" id="5170148">Comm</span>&nbsp;<span class="op" id="5170153">!=</span>&nbsp;<span class="ident" id="5170156">nil</span>&nbsp;<span class="op" id="5170160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170165">p</span><span class="op" id="5170166">.</span><span class="builtinfunc" id="5170167">print</span><span class="op" id="5170172">(</span><span class="ident" id="5170173">token</span><span class="op" id="5170178">.</span><span class="ident" id="5170179">CASE</span><span class="op" id="5170183">,</span>&nbsp;<span class="ident" id="5170185">blank</span><span class="op" id="5170190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170195">p</span><span class="op" id="5170196">.</span><span class="ident" id="5170197">stmt</span><span class="op" id="5170201">(</span><span class="ident" id="5170202">s</span><span class="op" id="5170203">.</span><span class="ident" id="5170204">Comm</span><span class="op" id="5170208">,</span>&nbsp;<span class="builtintype" id="5170210">false</span><span class="op" id="5170215">)</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170219">}</span>&nbsp;<span class="keyword" id="5170221">else</span>&nbsp;<span class="op" id="5170226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170231">p</span><span class="op" id="5170232">.</span><span class="builtinfunc" id="5170233">print</span><span class="op" id="5170238">(</span><span class="ident" id="5170239">token</span><span class="op" id="5170244">.</span><span class="ident" id="5170245">DEFAULT</span><span class="op" id="5170252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170260">p</span><span class="op" id="5170261">.</span><span class="builtinfunc" id="5170262">print</span><span class="op" id="5170267">(</span><span class="ident" id="5170268">s</span><span class="op" id="5170269">.</span><span class="ident" id="5170270">Colon</span><span class="op" id="5170275">,</span>&nbsp;<span class="ident" id="5170277">token</span><span class="op" id="5170282">.</span><span class="ident" id="5170283">COLON</span><span class="op" id="5170288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170292">p</span><span class="op" id="5170293">.</span><span class="ident" id="5170294">stmtList</span><span class="op" id="5170302">(</span><span class="ident" id="5170303">s</span><span class="op" id="5170304">.</span><span class="ident" id="5170305">Body</span><span class="op" id="5170309">,</span>&nbsp;<span class="num" id="5170311">1</span><span class="op" id="5170312">,</span>&nbsp;<span class="ident" id="5170314">nextIsRBrace</span><span class="op" id="5170326">)</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170330">case</span>&nbsp;<span class="op" id="5170335">*</span><span class="ident" id="5170336">ast</span><span class="op" id="5170339">.</span><span class="ident" id="5170340">SelectStmt</span><span class="op" id="5170350">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170354">p</span><span class="op" id="5170355">.</span><span class="builtinfunc" id="5170356">print</span><span class="op" id="5170361">(</span><span class="ident" id="5170362">token</span><span class="op" id="5170367">.</span><span class="ident" id="5170368">SELECT</span><span class="op" id="5170374">,</span>&nbsp;<span class="ident" id="5170376">blank</span><span class="op" id="5170381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170385">body</span>&nbsp;<span class="op" id="5170390">:=</span>&nbsp;<span class="ident" id="5170393">s</span><span class="op" id="5170394">.</span><span class="ident" id="5170395">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170402">if</span>&nbsp;<span class="builtinfunc" id="5170405">len</span><span class="op" id="5170408">(</span><span class="ident" id="5170409">body</span><span class="op" id="5170413">.</span><span class="ident" id="5170414">List</span><span class="op" id="5170418">)</span>&nbsp;<span class="op" id="5170420">==</span>&nbsp;<span class="num" id="5170423">0</span>&nbsp;<span class="op" id="5170425">&amp;&amp;</span>&nbsp;<span class="op" id="5170428">!</span><span class="ident" id="5170429">p</span><span class="op" id="5170430">.</span><span class="ident" id="5170431">commentBefore</span><span class="op" id="5170444">(</span><span class="ident" id="5170445">p</span><span class="op" id="5170446">.</span><span class="ident" id="5170447">posFor</span><span class="op" id="5170453">(</span><span class="ident" id="5170454">body</span><span class="op" id="5170458">.</span><span class="ident" id="5170459">Rbrace</span><span class="op" id="5170465">)</span><span class="op" id="5170466">)</span>&nbsp;<span class="op" id="5170468">{</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5170473">//&nbsp;print&nbsp;empty&nbsp;select&nbsp;statement&nbsp;w/o&nbsp;comments&nbsp;on&nbsp;one&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170533">p</span><span class="op" id="5170534">.</span><span class="builtinfunc" id="5170535">print</span><span class="op" id="5170540">(</span><span class="ident" id="5170541">body</span><span class="op" id="5170545">.</span><span class="ident" id="5170546">Lbrace</span><span class="op" id="5170552">,</span>&nbsp;<span class="ident" id="5170554">token</span><span class="op" id="5170559">.</span><span class="ident" id="5170560">LBRACE</span><span class="op" id="5170566">,</span>&nbsp;<span class="ident" id="5170568">body</span><span class="op" id="5170572">.</span><span class="ident" id="5170573">Rbrace</span><span class="op" id="5170579">,</span>&nbsp;<span class="ident" id="5170581">token</span><span class="op" id="5170586">.</span><span class="ident" id="5170587">RBRACE</span><span class="op" id="5170593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170597">}</span>&nbsp;<span class="keyword" id="5170599">else</span>&nbsp;<span class="op" id="5170604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170609">p</span><span class="op" id="5170610">.</span><span class="ident" id="5170611">block</span><span class="op" id="5170616">(</span><span class="ident" id="5170617">body</span><span class="op" id="5170621">,</span>&nbsp;<span class="num" id="5170623">0</span><span class="op" id="5170624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170628">}</span><br>
<span class="lineno">1215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170632">case</span>&nbsp;<span class="op" id="5170637">*</span><span class="ident" id="5170638">ast</span><span class="op" id="5170641">.</span><span class="ident" id="5170642">ForStmt</span><span class="op" id="5170649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170653">p</span><span class="op" id="5170654">.</span><span class="builtinfunc" id="5170655">print</span><span class="op" id="5170660">(</span><span class="ident" id="5170661">token</span><span class="op" id="5170666">.</span><span class="ident" id="5170667">FOR</span><span class="op" id="5170670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170674">p</span><span class="op" id="5170675">.</span><span class="ident" id="5170676">controlClause</span><span class="op" id="5170689">(</span><span class="builtintype" id="5170690">true</span><span class="op" id="5170694">,</span>&nbsp;<span class="ident" id="5170696">s</span><span class="op" id="5170697">.</span><span class="ident" id="5170698">Init</span><span class="op" id="5170702">,</span>&nbsp;<span class="ident" id="5170704">s</span><span class="op" id="5170705">.</span><span class="ident" id="5170706">Cond</span><span class="op" id="5170710">,</span>&nbsp;<span class="ident" id="5170712">s</span><span class="op" id="5170713">.</span><span class="ident" id="5170714">Post</span><span class="op" id="5170718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170722">p</span><span class="op" id="5170723">.</span><span class="ident" id="5170724">block</span><span class="op" id="5170729">(</span><span class="ident" id="5170730">s</span><span class="op" id="5170731">.</span><span class="ident" id="5170732">Body</span><span class="op" id="5170736">,</span>&nbsp;<span class="num" id="5170738">1</span><span class="op" id="5170739">)</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170743">case</span>&nbsp;<span class="op" id="5170748">*</span><span class="ident" id="5170749">ast</span><span class="op" id="5170752">.</span><span class="ident" id="5170753">RangeStmt</span><span class="op" id="5170762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170766">p</span><span class="op" id="5170767">.</span><span class="builtinfunc" id="5170768">print</span><span class="op" id="5170773">(</span><span class="ident" id="5170774">token</span><span class="op" id="5170779">.</span><span class="ident" id="5170780">FOR</span><span class="op" id="5170783">,</span>&nbsp;<span class="ident" id="5170785">blank</span><span class="op" id="5170790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170794">if</span>&nbsp;<span class="ident" id="5170797">s</span><span class="op" id="5170798">.</span><span class="ident" id="5170799">Key</span>&nbsp;<span class="op" id="5170803">!=</span>&nbsp;<span class="ident" id="5170806">nil</span>&nbsp;<span class="op" id="5170810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170815">p</span><span class="op" id="5170816">.</span><span class="ident" id="5170817">expr</span><span class="op" id="5170821">(</span><span class="ident" id="5170822">s</span><span class="op" id="5170823">.</span><span class="ident" id="5170824">Key</span><span class="op" id="5170827">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170832">if</span>&nbsp;<span class="ident" id="5170835">s</span><span class="op" id="5170836">.</span><span class="ident" id="5170837">Value</span>&nbsp;<span class="op" id="5170843">!=</span>&nbsp;<span class="ident" id="5170846">nil</span>&nbsp;<span class="op" id="5170850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5170856">//&nbsp;use&nbsp;position&nbsp;of&nbsp;value&nbsp;following&nbsp;the&nbsp;comma&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5170908">//&nbsp;comma&nbsp;position&nbsp;for&nbsp;correct&nbsp;comment&nbsp;placement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5170960">p</span><span class="op" id="5170961">.</span><span class="builtinfunc" id="5170962">print</span><span class="op" id="5170967">(</span><span class="ident" id="5170968">s</span><span class="op" id="5170969">.</span><span class="ident" id="5170970">Value</span><span class="op" id="5170975">.</span><span class="ident" id="5170976">Pos</span><span class="op" id="5170979">(</span><span class="op" id="5170980">)</span><span class="op" id="5170981">,</span>&nbsp;<span class="ident" id="5170983">token</span><span class="op" id="5170988">.</span><span class="ident" id="5170989">COMMA</span><span class="op" id="5170994">,</span>&nbsp;<span class="ident" id="5170996">blank</span><span class="op" id="5171001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171007">p</span><span class="op" id="5171008">.</span><span class="ident" id="5171009">expr</span><span class="op" id="5171013">(</span><span class="ident" id="5171014">s</span><span class="op" id="5171015">.</span><span class="ident" id="5171016">Value</span><span class="op" id="5171021">)</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171031">p</span><span class="op" id="5171032">.</span><span class="builtinfunc" id="5171033">print</span><span class="op" id="5171038">(</span><span class="ident" id="5171039">blank</span><span class="op" id="5171044">,</span>&nbsp;<span class="ident" id="5171046">s</span><span class="op" id="5171047">.</span><span class="ident" id="5171048">TokPos</span><span class="op" id="5171054">,</span>&nbsp;<span class="ident" id="5171056">s</span><span class="op" id="5171057">.</span><span class="ident" id="5171058">Tok</span><span class="op" id="5171061">,</span>&nbsp;<span class="ident" id="5171063">blank</span><span class="op" id="5171068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171076">p</span><span class="op" id="5171077">.</span><span class="builtinfunc" id="5171078">print</span><span class="op" id="5171083">(</span><span class="ident" id="5171084">token</span><span class="op" id="5171089">.</span><span class="ident" id="5171090">RANGE</span><span class="op" id="5171095">,</span>&nbsp;<span class="ident" id="5171097">blank</span><span class="op" id="5171102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171106">p</span><span class="op" id="5171107">.</span><span class="ident" id="5171108">expr</span><span class="op" id="5171112">(</span><span class="ident" id="5171113">stripParens</span><span class="op" id="5171124">(</span><span class="ident" id="5171125">s</span><span class="op" id="5171126">.</span><span class="ident" id="5171127">X</span><span class="op" id="5171128">)</span><span class="op" id="5171129">)</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171133">p</span><span class="op" id="5171134">.</span><span class="builtinfunc" id="5171135">print</span><span class="op" id="5171140">(</span><span class="ident" id="5171141">blank</span><span class="op" id="5171146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171150">p</span><span class="op" id="5171151">.</span><span class="ident" id="5171152">block</span><span class="op" id="5171157">(</span><span class="ident" id="5171158">s</span><span class="op" id="5171159">.</span><span class="ident" id="5171160">Body</span><span class="op" id="5171164">,</span>&nbsp;<span class="num" id="5171166">1</span><span class="op" id="5171167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171171">default</span><span class="op" id="5171178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5171182">panic</span><span class="op" id="5171187">(</span><span class="string" id="5171188">&#34;unreachable&#34;</span><span class="op" id="5171201">)</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171208">return</span><br>
<span class="lineno"></span><span class="op" id="5171215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1245</span><span class="comment" id="5171218">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5171298">//&nbsp;Declarations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5171315">//&nbsp;The&nbsp;keepTypeColumn&nbsp;function&nbsp;determines&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;of&nbsp;a&nbsp;series&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5171391">//&nbsp;consecutive&nbsp;const&nbsp;or&nbsp;var&nbsp;declarations&nbsp;must&nbsp;be&nbsp;kept,&nbsp;or&nbsp;if&nbsp;initialization</span><br>
<span class="lineno">1250</span><span class="comment" id="5171467">//&nbsp;values&nbsp;(V)&nbsp;can&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;type&nbsp;column&nbsp;(T)&nbsp;instead.&nbsp;The&nbsp;i&#39;th&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5171542">//&nbsp;in&nbsp;the&nbsp;result&nbsp;slice&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;in&nbsp;spec[i]&nbsp;must&nbsp;be&nbsp;kept.</span><br>
<span class="lineno"></span><span class="comment" id="5171617">//</span><br>
<span class="lineno"></span><span class="comment" id="5171620">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;declaration:</span><br>
<span class="lineno"></span><span class="comment" id="5171653">//</span><br>
<span class="lineno">1255</span><span class="comment" id="5171656">//&nbsp;&nbsp;&nbsp;&nbspconst&nbsp;(</span><br>
<span class="lineno"></span><span class="comment" id="5171667">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoobar&nbsp;int&nbsp;=&nbsp;42&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5171698">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;//&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="5171729">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspfoo</span><br>
<span class="lineno"></span><span class="comment" id="5171737">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar&nbsp;=&nbsp;991</span><br>
<span class="lineno">1260</span><span class="comment" id="5171763">//&nbsp;&nbsp;&nbsp;&nbsp)</span><br>
<span class="lineno"></span><span class="comment" id="5171768">//</span><br>
<span class="lineno"></span><span class="comment" id="5171771">//&nbsp;leads&nbsp;to&nbsp;the&nbsp;type/values&nbsp;matrix&nbsp;below.&nbsp;A&nbsp;run&nbsp;of&nbsp;value&nbsp;columns&nbsp;(V)&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="5171844">//&nbsp;be&nbsp;moved&nbsp;into&nbsp;the&nbsp;type&nbsp;column&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;type&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5171919">//&nbsp;in&nbsp;that&nbsp;column&nbsp;(we&nbsp;only&nbsp;move&nbsp;entire&nbsp;columns&nbsp;so&nbsp;that&nbsp;they&nbsp;align&nbsp;properly).</span><br>
<span class="lineno">1265</span><span class="comment" id="5171996">//</span><br>
<span class="lineno"></span><span class="comment" id="5171999">//&nbsp;&nbsp;&nbsp;&nbspmatrix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="5172037">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix</span><br>
<span class="lineno"></span><span class="comment" id="5172066">//&nbsp;&nbsp;&nbsp;&nbspT&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;a&nbsp;T&nbsp;and&nbsp;so&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5172136">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno">1270</span><span class="comment" id="5172197">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="5172234">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;&nbsp;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;is&nbsp;moved&nbsp;into&nbsp;T&nbsp;column</span><br>
<span class="lineno"></span><span class="comment" id="5172300">//</span><br>
<span class="lineno"></span><span class="keyword" id="5172303">func</span>&nbsp;<span class="ident" id="5172308">keepTypeColumn</span><span class="op" id="5172322">(</span><span class="ident" id="5172323">specs</span>&nbsp;<span class="op" id="5172329">[</span><span class="op" id="5172330">]</span><span class="ident" id="5172331">ast</span><span class="op" id="5172334">.</span><span class="ident" id="5172335">Spec</span><span class="op" id="5172339">)</span>&nbsp;<span class="op" id="5172341">[</span><span class="op" id="5172342">]</span><span class="builtintype" id="5172343">bool</span>&nbsp;<span class="op" id="5172348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172351">m</span>&nbsp;<span class="op" id="5172353">:=</span>&nbsp;<span class="builtinfunc" id="5172356">make</span><span class="op" id="5172360">(</span><span class="op" id="5172361">[</span><span class="op" id="5172362">]</span><span class="builtintype" id="5172363">bool</span><span class="op" id="5172367">,</span>&nbsp;<span class="builtinfunc" id="5172369">len</span><span class="op" id="5172372">(</span><span class="ident" id="5172373">specs</span><span class="op" id="5172378">)</span><span class="op" id="5172379">)</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172383">populate</span>&nbsp;<span class="op" id="5172392">:=</span>&nbsp;<span class="keyword" id="5172395">func</span><span class="op" id="5172399">(</span><span class="ident" id="5172400">i</span><span class="op" id="5172401">,</span>&nbsp;<span class="ident" id="5172403">j</span>&nbsp;<span class="builtintype" id="5172405">int</span><span class="op" id="5172408">,</span>&nbsp;<span class="ident" id="5172410">keepType</span>&nbsp;<span class="builtintype" id="5172419">bool</span><span class="op" id="5172423">)</span>&nbsp;<span class="op" id="5172425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172429">if</span>&nbsp;<span class="ident" id="5172432">keepType</span>&nbsp;<span class="op" id="5172441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172446">for</span>&nbsp;<span class="op" id="5172450">;</span>&nbsp;<span class="ident" id="5172452">i</span>&nbsp;<span class="op" id="5172454">&lt;</span>&nbsp;<span class="ident" id="5172456">j</span><span class="op" id="5172457">;</span>&nbsp;<span class="ident" id="5172459">i</span><span class="op" id="5172460">++</span>&nbsp;<span class="op" id="5172463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172469">m</span><span class="op" id="5172470">[</span><span class="ident" id="5172471">i</span><span class="op" id="5172472">]</span>&nbsp;<span class="op" id="5172474">=</span>&nbsp;<span class="builtintype" id="5172476">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172495">i0</span>&nbsp;<span class="op" id="5172498">:=</span>&nbsp;<span class="op" id="5172501">-</span><span class="num" id="5172502">1</span>&nbsp;<span class="comment" id="5172504">//&nbsp;if&nbsp;i0&nbsp;&gt;=&nbsp;0&nbsp;we&nbsp;are&nbsp;in&nbsp;a&nbsp;run&nbsp;and&nbsp;i0&nbsp;is&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;run</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172566">var</span>&nbsp;<span class="ident" id="5172570">keepType</span>&nbsp;<span class="builtintype" id="5172579">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172585">for</span>&nbsp;<span class="ident" id="5172589">i</span><span class="op" id="5172590">,</span>&nbsp;<span class="ident" id="5172592">s</span>&nbsp;<span class="op" id="5172594">:=</span>&nbsp;<span class="keyword" id="5172597">range</span>&nbsp;<span class="ident" id="5172603">specs</span>&nbsp;<span class="op" id="5172609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172613">t</span>&nbsp;<span class="op" id="5172615">:=</span>&nbsp;<span class="ident" id="5172618">s</span><span class="op" id="5172619">.</span><span class="op" id="5172620">(</span><span class="op" id="5172621">*</span><span class="ident" id="5172622">ast</span><span class="op" id="5172625">.</span><span class="ident" id="5172626">ValueSpec</span><span class="op" id="5172635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172639">if</span>&nbsp;<span class="ident" id="5172642">t</span><span class="op" id="5172643">.</span><span class="ident" id="5172644">Values</span>&nbsp;<span class="op" id="5172651">!=</span>&nbsp;<span class="ident" id="5172654">nil</span>&nbsp;<span class="op" id="5172658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172663">if</span>&nbsp;<span class="ident" id="5172666">i0</span>&nbsp;<span class="op" id="5172669">&lt;</span>&nbsp;<span class="num" id="5172671">0</span>&nbsp;<span class="op" id="5172673">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172679">//&nbsp;start&nbsp;of&nbsp;a&nbsp;run&nbsp;of&nbsp;ValueSpecs&nbsp;with&nbsp;non-nil&nbsp;Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172735">i0</span>&nbsp;<span class="op" id="5172738">=</span>&nbsp;<span class="ident" id="5172740">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172746">keepType</span>&nbsp;<span class="op" id="5172755">=</span>&nbsp;<span class="builtintype" id="5172757">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172770">}</span>&nbsp;<span class="keyword" id="5172772">else</span>&nbsp;<span class="op" id="5172777">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172782">if</span>&nbsp;<span class="ident" id="5172785">i0</span>&nbsp;<span class="op" id="5172788">&gt;=</span>&nbsp;<span class="num" id="5172791">0</span>&nbsp;<span class="op" id="5172793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172799">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172819">populate</span><span class="op" id="5172827">(</span><span class="ident" id="5172828">i0</span><span class="op" id="5172830">,</span>&nbsp;<span class="ident" id="5172832">i</span><span class="op" id="5172833">,</span>&nbsp;<span class="ident" id="5172835">keepType</span><span class="op" id="5172843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172849">i0</span>&nbsp;<span class="op" id="5172852">=</span>&nbsp;<span class="op" id="5172854">-</span><span class="num" id="5172855">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172860">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172868">if</span>&nbsp;<span class="ident" id="5172871">t</span><span class="op" id="5172872">.</span><span class="ident" id="5172873">Type</span>&nbsp;<span class="op" id="5172878">!=</span>&nbsp;<span class="ident" id="5172881">nil</span>&nbsp;<span class="op" id="5172885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172890">keepType</span>&nbsp;<span class="op" id="5172899">=</span>&nbsp;<span class="builtintype" id="5172901">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172911">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172914">if</span>&nbsp;<span class="ident" id="5172917">i0</span>&nbsp;<span class="op" id="5172920">&gt;=</span>&nbsp;<span class="num" id="5172923">0</span>&nbsp;<span class="op" id="5172925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172929">//&nbsp;end&nbsp;of&nbsp;a&nbsp;run</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172947">populate</span><span class="op" id="5172955">(</span><span class="ident" id="5172956">i0</span><span class="op" id="5172958">,</span>&nbsp;<span class="builtinfunc" id="5172960">len</span><span class="op" id="5172963">(</span><span class="ident" id="5172964">specs</span><span class="op" id="5172969">)</span><span class="op" id="5172970">,</span>&nbsp;<span class="ident" id="5172972">keepType</span><span class="op" id="5172980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172987">return</span>&nbsp;<span class="ident" id="5172994">m</span><br>
<span class="lineno"></span><span class="op" id="5172996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5172999">func</span>&nbsp;<span class="op" id="5173004">(</span><span class="ident" id="5173005">p</span>&nbsp;<span class="op" id="5173007">*</span><span class="ident" id="5173008">printer</span><span class="op" id="5173015">)</span>&nbsp;<span class="ident" id="5173017">valueSpec</span><span class="op" id="5173026">(</span><span class="ident" id="5173027">s</span>&nbsp;<span class="op" id="5173029">*</span><span class="ident" id="5173030">ast</span><span class="op" id="5173033">.</span><span class="ident" id="5173034">ValueSpec</span><span class="op" id="5173043">,</span>&nbsp;<span class="ident" id="5173045">keepType</span>&nbsp;<span class="builtintype" id="5173054">bool</span><span class="op" id="5173058">)</span>&nbsp;<span class="op" id="5173060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173063">p</span><span class="op" id="5173064">.</span><span class="ident" id="5173065">setComment</span><span class="op" id="5173075">(</span><span class="ident" id="5173076">s</span><span class="op" id="5173077">.</span><span class="ident" id="5173078">Doc</span><span class="op" id="5173081">)</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173084">p</span><span class="op" id="5173085">.</span><span class="ident" id="5173086">identList</span><span class="op" id="5173095">(</span><span class="ident" id="5173096">s</span><span class="op" id="5173097">.</span><span class="ident" id="5173098">Names</span><span class="op" id="5173103">,</span>&nbsp;<span class="builtintype" id="5173105">false</span><span class="op" id="5173110">)</span>&nbsp;<span class="comment" id="5173112">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173131">extraTabs</span>&nbsp;<span class="op" id="5173141">:=</span>&nbsp;<span class="num" id="5173144">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173147">if</span>&nbsp;<span class="ident" id="5173150">s</span><span class="op" id="5173151">.</span><span class="ident" id="5173152">Type</span>&nbsp;<span class="op" id="5173157">!=</span>&nbsp;<span class="ident" id="5173160">nil</span>&nbsp;<span class="op" id="5173164">||</span>&nbsp;<span class="ident" id="5173167">keepType</span>&nbsp;<span class="op" id="5173176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173180">p</span><span class="op" id="5173181">.</span><span class="builtinfunc" id="5173182">print</span><span class="op" id="5173187">(</span><span class="ident" id="5173188">vtab</span><span class="op" id="5173192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173196">extraTabs</span><span class="op" id="5173205">--</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173212">if</span>&nbsp;<span class="ident" id="5173215">s</span><span class="op" id="5173216">.</span><span class="ident" id="5173217">Type</span>&nbsp;<span class="op" id="5173222">!=</span>&nbsp;<span class="ident" id="5173225">nil</span>&nbsp;<span class="op" id="5173229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173233">p</span><span class="op" id="5173234">.</span><span class="ident" id="5173235">expr</span><span class="op" id="5173239">(</span><span class="ident" id="5173240">s</span><span class="op" id="5173241">.</span><span class="ident" id="5173242">Type</span><span class="op" id="5173246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173252">if</span>&nbsp;<span class="ident" id="5173255">s</span><span class="op" id="5173256">.</span><span class="ident" id="5173257">Values</span>&nbsp;<span class="op" id="5173264">!=</span>&nbsp;<span class="ident" id="5173267">nil</span>&nbsp;<span class="op" id="5173271">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173275">p</span><span class="op" id="5173276">.</span><span class="builtinfunc" id="5173277">print</span><span class="op" id="5173282">(</span><span class="ident" id="5173283">vtab</span><span class="op" id="5173287">,</span>&nbsp;<span class="ident" id="5173289">token</span><span class="op" id="5173294">.</span><span class="ident" id="5173295">ASSIGN</span><span class="op" id="5173301">,</span>&nbsp;<span class="ident" id="5173303">blank</span><span class="op" id="5173308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173312">p</span><span class="op" id="5173313">.</span><span class="ident" id="5173314">exprList</span><span class="op" id="5173322">(</span><span class="ident" id="5173323">token</span><span class="op" id="5173328">.</span><span class="ident" id="5173329">NoPos</span><span class="op" id="5173334">,</span>&nbsp;<span class="ident" id="5173336">s</span><span class="op" id="5173337">.</span><span class="ident" id="5173338">Values</span><span class="op" id="5173344">,</span>&nbsp;<span class="num" id="5173346">1</span><span class="op" id="5173347">,</span>&nbsp;<span class="num" id="5173349">0</span><span class="op" id="5173350">,</span>&nbsp;<span class="ident" id="5173352">token</span><span class="op" id="5173357">.</span><span class="ident" id="5173358">NoPos</span><span class="op" id="5173363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173367">extraTabs</span><span class="op" id="5173376">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173383">if</span>&nbsp;<span class="ident" id="5173386">s</span><span class="op" id="5173387">.</span><span class="ident" id="5173388">Comment</span>&nbsp;<span class="op" id="5173396">!=</span>&nbsp;<span class="ident" id="5173399">nil</span>&nbsp;<span class="op" id="5173403">{</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173407">for</span>&nbsp;<span class="op" id="5173411">;</span>&nbsp;<span class="ident" id="5173413">extraTabs</span>&nbsp;<span class="op" id="5173423">&gt;</span>&nbsp;<span class="num" id="5173425">0</span><span class="op" id="5173426">;</span>&nbsp;<span class="ident" id="5173428">extraTabs</span><span class="op" id="5173437">--</span>&nbsp;<span class="op" id="5173440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173445">p</span><span class="op" id="5173446">.</span><span class="builtinfunc" id="5173447">print</span><span class="op" id="5173452">(</span><span class="ident" id="5173453">vtab</span><span class="op" id="5173457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173465">p</span><span class="op" id="5173466">.</span><span class="ident" id="5173467">setComment</span><span class="op" id="5173477">(</span><span class="ident" id="5173478">s</span><span class="op" id="5173479">.</span><span class="ident" id="5173480">Comment</span><span class="op" id="5173487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173490">}</span><br>
<span class="lineno">1335</span><span class="op" id="5173492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5173495">//&nbsp;The&nbsp;parameter&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;specs&nbsp;in&nbsp;the&nbsp;group.&nbsp;If&nbsp;doIndent&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5173571">//&nbsp;multi-line&nbsp;identifier&nbsp;lists&nbsp;in&nbsp;the&nbsp;spec&nbsp;are&nbsp;indented&nbsp;when&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5173642">//&nbsp;linebreak&nbsp;is&nbsp;encountered.</span><br>
<span class="lineno">1340</span><span class="comment" id="5173671">//</span><br>
<span class="lineno"></span><span class="keyword" id="5173674">func</span>&nbsp;<span class="op" id="5173679">(</span><span class="ident" id="5173680">p</span>&nbsp;<span class="op" id="5173682">*</span><span class="ident" id="5173683">printer</span><span class="op" id="5173690">)</span>&nbsp;<span class="ident" id="5173692">spec</span><span class="op" id="5173696">(</span><span class="ident" id="5173697">spec</span>&nbsp;<span class="ident" id="5173702">ast</span><span class="op" id="5173705">.</span><span class="ident" id="5173706">Spec</span><span class="op" id="5173710">,</span>&nbsp;<span class="ident" id="5173712">n</span>&nbsp;<span class="builtintype" id="5173714">int</span><span class="op" id="5173717">,</span>&nbsp;<span class="ident" id="5173719">doIndent</span>&nbsp;<span class="builtintype" id="5173728">bool</span><span class="op" id="5173732">)</span>&nbsp;<span class="op" id="5173734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173737">switch</span>&nbsp;<span class="ident" id="5173744">s</span>&nbsp;<span class="op" id="5173746">:=</span>&nbsp;<span class="ident" id="5173749">spec</span><span class="op" id="5173753">.</span><span class="op" id="5173754">(</span><span class="keyword" id="5173755">type</span><span class="op" id="5173759">)</span>&nbsp;<span class="op" id="5173761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173764">case</span>&nbsp;<span class="op" id="5173769">*</span><span class="ident" id="5173770">ast</span><span class="op" id="5173773">.</span><span class="ident" id="5173774">ImportSpec</span><span class="op" id="5173784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173788">p</span><span class="op" id="5173789">.</span><span class="ident" id="5173790">setComment</span><span class="op" id="5173800">(</span><span class="ident" id="5173801">s</span><span class="op" id="5173802">.</span><span class="ident" id="5173803">Doc</span><span class="op" id="5173806">)</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173810">if</span>&nbsp;<span class="ident" id="5173813">s</span><span class="op" id="5173814">.</span><span class="ident" id="5173815">Name</span>&nbsp;<span class="op" id="5173820">!=</span>&nbsp;<span class="ident" id="5173823">nil</span>&nbsp;<span class="op" id="5173827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173832">p</span><span class="op" id="5173833">.</span><span class="ident" id="5173834">expr</span><span class="op" id="5173838">(</span><span class="ident" id="5173839">s</span><span class="op" id="5173840">.</span><span class="ident" id="5173841">Name</span><span class="op" id="5173845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173850">p</span><span class="op" id="5173851">.</span><span class="builtinfunc" id="5173852">print</span><span class="op" id="5173857">(</span><span class="ident" id="5173858">blank</span><span class="op" id="5173863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173871">p</span><span class="op" id="5173872">.</span><span class="ident" id="5173873">expr</span><span class="op" id="5173877">(</span><span class="ident" id="5173878">s</span><span class="op" id="5173879">.</span><span class="ident" id="5173880">Path</span><span class="op" id="5173884">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173888">p</span><span class="op" id="5173889">.</span><span class="ident" id="5173890">setComment</span><span class="op" id="5173900">(</span><span class="ident" id="5173901">s</span><span class="op" id="5173902">.</span><span class="ident" id="5173903">Comment</span><span class="op" id="5173910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173914">p</span><span class="op" id="5173915">.</span><span class="builtinfunc" id="5173916">print</span><span class="op" id="5173921">(</span><span class="ident" id="5173922">s</span><span class="op" id="5173923">.</span><span class="ident" id="5173924">EndPos</span><span class="op" id="5173930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173934">case</span>&nbsp;<span class="op" id="5173939">*</span><span class="ident" id="5173940">ast</span><span class="op" id="5173943">.</span><span class="ident" id="5173944">ValueSpec</span><span class="op" id="5173953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173957">if</span>&nbsp;<span class="ident" id="5173960">n</span>&nbsp;<span class="op" id="5173962">!=</span>&nbsp;<span class="num" id="5173965">1</span>&nbsp;<span class="op" id="5173967">{</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173972">p</span><span class="op" id="5173973">.</span><span class="ident" id="5173974">internalError</span><span class="op" id="5173987">(</span><span class="string" id="5173988">&#34;expected&nbsp;n&nbsp;=&nbsp;1;&nbsp;got&#34;</span><span class="op" id="5174009">,</span>&nbsp;<span class="ident" id="5174011">n</span><span class="op" id="5174012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174020">p</span><span class="op" id="5174021">.</span><span class="ident" id="5174022">setComment</span><span class="op" id="5174032">(</span><span class="ident" id="5174033">s</span><span class="op" id="5174034">.</span><span class="ident" id="5174035">Doc</span><span class="op" id="5174038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174042">p</span><span class="op" id="5174043">.</span><span class="ident" id="5174044">identList</span><span class="op" id="5174053">(</span><span class="ident" id="5174054">s</span><span class="op" id="5174055">.</span><span class="ident" id="5174056">Names</span><span class="op" id="5174061">,</span>&nbsp;<span class="ident" id="5174063">doIndent</span><span class="op" id="5174071">)</span>&nbsp;<span class="comment" id="5174073">//&nbsp;always&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174093">if</span>&nbsp;<span class="ident" id="5174096">s</span><span class="op" id="5174097">.</span><span class="ident" id="5174098">Type</span>&nbsp;<span class="op" id="5174103">!=</span>&nbsp;<span class="ident" id="5174106">nil</span>&nbsp;<span class="op" id="5174110">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174115">p</span><span class="op" id="5174116">.</span><span class="builtinfunc" id="5174117">print</span><span class="op" id="5174122">(</span><span class="ident" id="5174123">blank</span><span class="op" id="5174128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174133">p</span><span class="op" id="5174134">.</span><span class="ident" id="5174135">expr</span><span class="op" id="5174139">(</span><span class="ident" id="5174140">s</span><span class="op" id="5174141">.</span><span class="ident" id="5174142">Type</span><span class="op" id="5174146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174154">if</span>&nbsp;<span class="ident" id="5174157">s</span><span class="op" id="5174158">.</span><span class="ident" id="5174159">Values</span>&nbsp;<span class="op" id="5174166">!=</span>&nbsp;<span class="ident" id="5174169">nil</span>&nbsp;<span class="op" id="5174173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174178">p</span><span class="op" id="5174179">.</span><span class="builtinfunc" id="5174180">print</span><span class="op" id="5174185">(</span><span class="ident" id="5174186">blank</span><span class="op" id="5174191">,</span>&nbsp;<span class="ident" id="5174193">token</span><span class="op" id="5174198">.</span><span class="ident" id="5174199">ASSIGN</span><span class="op" id="5174205">,</span>&nbsp;<span class="ident" id="5174207">blank</span><span class="op" id="5174212">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174217">p</span><span class="op" id="5174218">.</span><span class="ident" id="5174219">exprList</span><span class="op" id="5174227">(</span><span class="ident" id="5174228">token</span><span class="op" id="5174233">.</span><span class="ident" id="5174234">NoPos</span><span class="op" id="5174239">,</span>&nbsp;<span class="ident" id="5174241">s</span><span class="op" id="5174242">.</span><span class="ident" id="5174243">Values</span><span class="op" id="5174249">,</span>&nbsp;<span class="num" id="5174251">1</span><span class="op" id="5174252">,</span>&nbsp;<span class="num" id="5174254">0</span><span class="op" id="5174255">,</span>&nbsp;<span class="ident" id="5174257">token</span><span class="op" id="5174262">.</span><span class="ident" id="5174263">NoPos</span><span class="op" id="5174268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174276">p</span><span class="op" id="5174277">.</span><span class="ident" id="5174278">setComment</span><span class="op" id="5174288">(</span><span class="ident" id="5174289">s</span><span class="op" id="5174290">.</span><span class="ident" id="5174291">Comment</span><span class="op" id="5174298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174302">case</span>&nbsp;<span class="op" id="5174307">*</span><span class="ident" id="5174308">ast</span><span class="op" id="5174311">.</span><span class="ident" id="5174312">TypeSpec</span><span class="op" id="5174320">:</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174324">p</span><span class="op" id="5174325">.</span><span class="ident" id="5174326">setComment</span><span class="op" id="5174336">(</span><span class="ident" id="5174337">s</span><span class="op" id="5174338">.</span><span class="ident" id="5174339">Doc</span><span class="op" id="5174342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174346">p</span><span class="op" id="5174347">.</span><span class="ident" id="5174348">expr</span><span class="op" id="5174352">(</span><span class="ident" id="5174353">s</span><span class="op" id="5174354">.</span><span class="ident" id="5174355">Name</span><span class="op" id="5174359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174363">if</span>&nbsp;<span class="ident" id="5174366">n</span>&nbsp;<span class="op" id="5174368">==</span>&nbsp;<span class="num" id="5174371">1</span>&nbsp;<span class="op" id="5174373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174378">p</span><span class="op" id="5174379">.</span><span class="builtinfunc" id="5174380">print</span><span class="op" id="5174385">(</span><span class="ident" id="5174386">blank</span><span class="op" id="5174391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174395">}</span>&nbsp;<span class="keyword" id="5174397">else</span>&nbsp;<span class="op" id="5174402">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174407">p</span><span class="op" id="5174408">.</span><span class="builtinfunc" id="5174409">print</span><span class="op" id="5174414">(</span><span class="ident" id="5174415">vtab</span><span class="op" id="5174419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174427">p</span><span class="op" id="5174428">.</span><span class="ident" id="5174429">expr</span><span class="op" id="5174433">(</span><span class="ident" id="5174434">s</span><span class="op" id="5174435">.</span><span class="ident" id="5174436">Type</span><span class="op" id="5174440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174444">p</span><span class="op" id="5174445">.</span><span class="ident" id="5174446">setComment</span><span class="op" id="5174456">(</span><span class="ident" id="5174457">s</span><span class="op" id="5174458">.</span><span class="ident" id="5174459">Comment</span><span class="op" id="5174466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174470">default</span><span class="op" id="5174477">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5174481">panic</span><span class="op" id="5174486">(</span><span class="string" id="5174487">&#34;unreachable&#34;</span><span class="op" id="5174500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174503">}</span><br>
<span class="lineno"></span><span class="op" id="5174505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1385</span><span class="keyword" id="5174508">func</span>&nbsp;<span class="op" id="5174513">(</span><span class="ident" id="5174514">p</span>&nbsp;<span class="op" id="5174516">*</span><span class="ident" id="5174517">printer</span><span class="op" id="5174524">)</span>&nbsp;<span class="ident" id="5174526">genDecl</span><span class="op" id="5174533">(</span><span class="ident" id="5174534">d</span>&nbsp;<span class="op" id="5174536">*</span><span class="ident" id="5174537">ast</span><span class="op" id="5174540">.</span><span class="ident" id="5174541">GenDecl</span><span class="op" id="5174548">)</span>&nbsp;<span class="op" id="5174550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174553">p</span><span class="op" id="5174554">.</span><span class="ident" id="5174555">setComment</span><span class="op" id="5174565">(</span><span class="ident" id="5174566">d</span><span class="op" id="5174567">.</span><span class="ident" id="5174568">Doc</span><span class="op" id="5174571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174574">p</span><span class="op" id="5174575">.</span><span class="builtinfunc" id="5174576">print</span><span class="op" id="5174581">(</span><span class="ident" id="5174582">d</span><span class="op" id="5174583">.</span><span class="ident" id="5174584">Pos</span><span class="op" id="5174587">(</span><span class="op" id="5174588">)</span><span class="op" id="5174589">,</span>&nbsp;<span class="ident" id="5174591">d</span><span class="op" id="5174592">.</span><span class="ident" id="5174593">Tok</span><span class="op" id="5174596">,</span>&nbsp;<span class="ident" id="5174598">blank</span><span class="op" id="5174603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174607">if</span>&nbsp;<span class="ident" id="5174610">d</span><span class="op" id="5174611">.</span><span class="ident" id="5174612">Lparen</span><span class="op" id="5174618">.</span><span class="ident" id="5174619">IsValid</span><span class="op" id="5174626">(</span><span class="op" id="5174627">)</span>&nbsp;<span class="op" id="5174629">{</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174633">//&nbsp;group&nbsp;of&nbsp;parenthesized&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174674">p</span><span class="op" id="5174675">.</span><span class="builtinfunc" id="5174676">print</span><span class="op" id="5174681">(</span><span class="ident" id="5174682">d</span><span class="op" id="5174683">.</span><span class="ident" id="5174684">Lparen</span><span class="op" id="5174690">,</span>&nbsp;<span class="ident" id="5174692">token</span><span class="op" id="5174697">.</span><span class="ident" id="5174698">LPAREN</span><span class="op" id="5174704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174708">if</span>&nbsp;<span class="ident" id="5174711">n</span>&nbsp;<span class="op" id="5174713">:=</span>&nbsp;<span class="builtinfunc" id="5174716">len</span><span class="op" id="5174719">(</span><span class="ident" id="5174720">d</span><span class="op" id="5174721">.</span><span class="ident" id="5174722">Specs</span><span class="op" id="5174727">)</span><span class="op" id="5174728">;</span>&nbsp;<span class="ident" id="5174730">n</span>&nbsp;<span class="op" id="5174732">&gt;</span>&nbsp;<span class="num" id="5174734">0</span>&nbsp;<span class="op" id="5174736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174741">p</span><span class="op" id="5174742">.</span><span class="builtinfunc" id="5174743">print</span><span class="op" id="5174748">(</span><span class="ident" id="5174749">indent</span><span class="op" id="5174755">,</span>&nbsp;<span class="ident" id="5174757">formfeed</span><span class="op" id="5174765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174770">if</span>&nbsp;<span class="ident" id="5174773">n</span>&nbsp;<span class="op" id="5174775">&gt;</span>&nbsp;<span class="num" id="5174777">1</span>&nbsp;<span class="op" id="5174779">&amp;&amp;</span>&nbsp;<span class="op" id="5174782">(</span><span class="ident" id="5174783">d</span><span class="op" id="5174784">.</span><span class="ident" id="5174785">Tok</span>&nbsp;<span class="op" id="5174789">==</span>&nbsp;<span class="ident" id="5174792">token</span><span class="op" id="5174797">.</span><span class="ident" id="5174798">CONST</span>&nbsp;<span class="op" id="5174804">||</span>&nbsp;<span class="ident" id="5174807">d</span><span class="op" id="5174808">.</span><span class="ident" id="5174809">Tok</span>&nbsp;<span class="op" id="5174813">==</span>&nbsp;<span class="ident" id="5174816">token</span><span class="op" id="5174821">.</span><span class="ident" id="5174822">VAR</span><span class="op" id="5174825">)</span>&nbsp;<span class="op" id="5174827">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174833">//&nbsp;two&nbsp;or&nbsp;more&nbsp;grouped&nbsp;const/var&nbsp;declarations:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174884">//&nbsp;determine&nbsp;if&nbsp;the&nbsp;type&nbsp;column&nbsp;must&nbsp;be&nbsp;kept</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174933">keepType</span>&nbsp;<span class="op" id="5174942">:=</span>&nbsp;<span class="ident" id="5174945">keepTypeColumn</span><span class="op" id="5174959">(</span><span class="ident" id="5174960">d</span><span class="op" id="5174961">.</span><span class="ident" id="5174962">Specs</span><span class="op" id="5174967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174973">var</span>&nbsp;<span class="ident" id="5174977">line</span>&nbsp;<span class="builtintype" id="5174982">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174990">for</span>&nbsp;<span class="ident" id="5174994">i</span><span class="op" id="5174995">,</span>&nbsp;<span class="ident" id="5174997">s</span>&nbsp;<span class="op" id="5174999">:=</span>&nbsp;<span class="keyword" id="5175002">range</span>&nbsp;<span class="ident" id="5175008">d</span><span class="op" id="5175009">.</span><span class="ident" id="5175010">Specs</span>&nbsp;<span class="op" id="5175016">{</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175023">if</span>&nbsp;<span class="ident" id="5175026">i</span>&nbsp;<span class="op" id="5175028">&gt;</span>&nbsp;<span class="num" id="5175030">0</span>&nbsp;<span class="op" id="5175032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175040">p</span><span class="op" id="5175041">.</span><span class="ident" id="5175042">linebreak</span><span class="op" id="5175051">(</span><span class="ident" id="5175052">p</span><span class="op" id="5175053">.</span><span class="ident" id="5175054">lineFor</span><span class="op" id="5175061">(</span><span class="ident" id="5175062">s</span><span class="op" id="5175063">.</span><span class="ident" id="5175064">Pos</span><span class="op" id="5175067">(</span><span class="op" id="5175068">)</span><span class="op" id="5175069">)</span><span class="op" id="5175070">,</span>&nbsp;<span class="num" id="5175072">1</span><span class="op" id="5175073">,</span>&nbsp;<span class="ident" id="5175075">ignore</span><span class="op" id="5175081">,</span>&nbsp;<span class="ident" id="5175083">p</span><span class="op" id="5175084">.</span><span class="ident" id="5175085">linesFrom</span><span class="op" id="5175094">(</span><span class="ident" id="5175095">line</span><span class="op" id="5175099">)</span>&nbsp;<span class="op" id="5175101">&gt;</span>&nbsp;<span class="num" id="5175103">0</span><span class="op" id="5175104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175118">p</span><span class="op" id="5175119">.</span><span class="ident" id="5175120">recordLine</span><span class="op" id="5175130">(</span><span class="op" id="5175131">&amp;</span><span class="ident" id="5175132">line</span><span class="op" id="5175136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175143">p</span><span class="op" id="5175144">.</span><span class="ident" id="5175145">valueSpec</span><span class="op" id="5175154">(</span><span class="ident" id="5175155">s</span><span class="op" id="5175156">.</span><span class="op" id="5175157">(</span><span class="op" id="5175158">*</span><span class="ident" id="5175159">ast</span><span class="op" id="5175162">.</span><span class="ident" id="5175163">ValueSpec</span><span class="op" id="5175172">)</span><span class="op" id="5175173">,</span>&nbsp;<span class="ident" id="5175175">keepType</span><span class="op" id="5175183">[</span><span class="ident" id="5175184">i</span><span class="op" id="5175185">]</span><span class="op" id="5175186">)</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175197">}</span>&nbsp;<span class="keyword" id="5175199">else</span>&nbsp;<span class="op" id="5175204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175210">var</span>&nbsp;<span class="ident" id="5175214">line</span>&nbsp;<span class="builtintype" id="5175219">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175227">for</span>&nbsp;<span class="ident" id="5175231">i</span><span class="op" id="5175232">,</span>&nbsp;<span class="ident" id="5175234">s</span>&nbsp;<span class="op" id="5175236">:=</span>&nbsp;<span class="keyword" id="5175239">range</span>&nbsp;<span class="ident" id="5175245">d</span><span class="op" id="5175246">.</span><span class="ident" id="5175247">Specs</span>&nbsp;<span class="op" id="5175253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175260">if</span>&nbsp;<span class="ident" id="5175263">i</span>&nbsp;<span class="op" id="5175265">&gt;</span>&nbsp;<span class="num" id="5175267">0</span>&nbsp;<span class="op" id="5175269">{</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175277">p</span><span class="op" id="5175278">.</span><span class="ident" id="5175279">linebreak</span><span class="op" id="5175288">(</span><span class="ident" id="5175289">p</span><span class="op" id="5175290">.</span><span class="ident" id="5175291">lineFor</span><span class="op" id="5175298">(</span><span class="ident" id="5175299">s</span><span class="op" id="5175300">.</span><span class="ident" id="5175301">Pos</span><span class="op" id="5175304">(</span><span class="op" id="5175305">)</span><span class="op" id="5175306">)</span><span class="op" id="5175307">,</span>&nbsp;<span class="num" id="5175309">1</span><span class="op" id="5175310">,</span>&nbsp;<span class="ident" id="5175312">ignore</span><span class="op" id="5175318">,</span>&nbsp;<span class="ident" id="5175320">p</span><span class="op" id="5175321">.</span><span class="ident" id="5175322">linesFrom</span><span class="op" id="5175331">(</span><span class="ident" id="5175332">line</span><span class="op" id="5175336">)</span>&nbsp;<span class="op" id="5175338">&gt;</span>&nbsp;<span class="num" id="5175340">0</span><span class="op" id="5175341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175355">p</span><span class="op" id="5175356">.</span><span class="ident" id="5175357">recordLine</span><span class="op" id="5175367">(</span><span class="op" id="5175368">&amp;</span><span class="ident" id="5175369">line</span><span class="op" id="5175373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175380">p</span><span class="op" id="5175381">.</span><span class="ident" id="5175382">spec</span><span class="op" id="5175386">(</span><span class="ident" id="5175387">s</span><span class="op" id="5175388">,</span>&nbsp;<span class="ident" id="5175390">n</span><span class="op" id="5175391">,</span>&nbsp;<span class="builtintype" id="5175393">false</span><span class="op" id="5175398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175404">}</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175414">p</span><span class="op" id="5175415">.</span><span class="builtinfunc" id="5175416">print</span><span class="op" id="5175421">(</span><span class="ident" id="5175422">unindent</span><span class="op" id="5175430">,</span>&nbsp;<span class="ident" id="5175432">formfeed</span><span class="op" id="5175440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175448">p</span><span class="op" id="5175449">.</span><span class="builtinfunc" id="5175450">print</span><span class="op" id="5175455">(</span><span class="ident" id="5175456">d</span><span class="op" id="5175457">.</span><span class="ident" id="5175458">Rparen</span><span class="op" id="5175464">,</span>&nbsp;<span class="ident" id="5175466">token</span><span class="op" id="5175471">.</span><span class="ident" id="5175472">RPAREN</span><span class="op" id="5175478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175482">}</span>&nbsp;<span class="keyword" id="5175484">else</span>&nbsp;<span class="op" id="5175489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175493">//&nbsp;single&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175517">p</span><span class="op" id="5175518">.</span><span class="ident" id="5175519">spec</span><span class="op" id="5175523">(</span><span class="ident" id="5175524">d</span><span class="op" id="5175525">.</span><span class="ident" id="5175526">Specs</span><span class="op" id="5175531">[</span><span class="num" id="5175532">0</span><span class="op" id="5175533">]</span><span class="op" id="5175534">,</span>&nbsp;<span class="num" id="5175536">1</span><span class="op" id="5175537">,</span>&nbsp;<span class="builtintype" id="5175539">true</span><span class="op" id="5175543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175546">}</span><br>
<span class="lineno"></span><span class="op" id="5175548">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="5175551">//&nbsp;nodeSize&nbsp;determines&nbsp;the&nbsp;size&nbsp;of&nbsp;n&nbsp;in&nbsp;chars&nbsp;after&nbsp;formatting.</span><br>
<span class="lineno"></span><span class="comment" id="5175615">//&nbsp;The&nbsp;result&nbsp;is&nbsp;&lt;=&nbsp;maxSize&nbsp;if&nbsp;the&nbsp;node&nbsp;fits&nbsp;on&nbsp;one&nbsp;line&nbsp;with&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5175680">//&nbsp;most&nbsp;maxSize&nbsp;chars&nbsp;and&nbsp;the&nbsp;formatted&nbsp;output&nbsp;doesn&#39;t&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5175743">//&nbsp;any&nbsp;control&nbsp;chars.&nbsp;Otherwise,&nbsp;the&nbsp;result&nbsp;is&nbsp;&gt;&nbsp;maxSize.</span><br>
<span class="lineno">1430</span><span class="comment" id="5175801">//</span><br>
<span class="lineno"></span><span class="keyword" id="5175804">func</span>&nbsp;<span class="op" id="5175809">(</span><span class="ident" id="5175810">p</span>&nbsp;<span class="op" id="5175812">*</span><span class="ident" id="5175813">printer</span><span class="op" id="5175820">)</span>&nbsp;<span class="ident" id="5175822">nodeSize</span><span class="op" id="5175830">(</span><span class="ident" id="5175831">n</span>&nbsp;<span class="ident" id="5175833">ast</span><span class="op" id="5175836">.</span><span class="ident" id="5175837">Node</span><span class="op" id="5175841">,</span>&nbsp;<span class="ident" id="5175843">maxSize</span>&nbsp;<span class="builtintype" id="5175851">int</span><span class="op" id="5175854">)</span>&nbsp;<span class="op" id="5175856">(</span><span class="ident" id="5175857">size</span>&nbsp;<span class="builtintype" id="5175862">int</span><span class="op" id="5175865">)</span>&nbsp;<span class="op" id="5175867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175870">//&nbsp;nodeSize&nbsp;invokes&nbsp;the&nbsp;printer,&nbsp;which&nbsp;may&nbsp;invoke&nbsp;nodeSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175930">//&nbsp;recursively.&nbsp;For&nbsp;deep&nbsp;composite&nbsp;literal&nbsp;nests,&nbsp;this&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175990">//&nbsp;lead&nbsp;to&nbsp;an&nbsp;exponential&nbsp;algorithm.&nbsp;Remember&nbsp;previous</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176046">//&nbsp;results&nbsp;to&nbsp;prune&nbsp;the&nbsp;recursion&nbsp;(was&nbsp;issue&nbsp;1628).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176099">if</span>&nbsp;<span class="ident" id="5176102">size</span><span class="op" id="5176106">,</span>&nbsp;<span class="ident" id="5176108">found</span>&nbsp;<span class="op" id="5176114">:=</span>&nbsp;<span class="ident" id="5176117">p</span><span class="op" id="5176118">.</span><span class="ident" id="5176119">nodeSizes</span><span class="op" id="5176128">[</span><span class="ident" id="5176129">n</span><span class="op" id="5176130">]</span><span class="op" id="5176131">;</span>&nbsp;<span class="ident" id="5176133">found</span>&nbsp;<span class="op" id="5176139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176143">return</span>&nbsp;<span class="ident" id="5176150">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176160">size</span>&nbsp;<span class="op" id="5176165">=</span>&nbsp;<span class="ident" id="5176167">maxSize</span>&nbsp;<span class="op" id="5176175">+</span>&nbsp;<span class="num" id="5176177">1</span>&nbsp;<span class="comment" id="5176179">//&nbsp;assume&nbsp;n&nbsp;doesn&#39;t&nbsp;fit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176204">p</span><span class="op" id="5176205">.</span><span class="ident" id="5176206">nodeSizes</span><span class="op" id="5176215">[</span><span class="ident" id="5176216">n</span><span class="op" id="5176217">]</span>&nbsp;<span class="op" id="5176219">=</span>&nbsp;<span class="ident" id="5176221">size</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176228">//&nbsp;nodeSize&nbsp;computation&nbsp;must&nbsp;be&nbsp;independent&nbsp;of&nbsp;particular</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176287">//&nbsp;style&nbsp;so&nbsp;that&nbsp;we&nbsp;always&nbsp;get&nbsp;the&nbsp;same&nbsp;decision;&nbsp;print</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176344">//&nbsp;in&nbsp;RawFormat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176361">cfg</span>&nbsp;<span class="op" id="5176365">:=</span>&nbsp;<span class="ident" id="5176368">Config</span><span class="op" id="5176374">{</span><span class="ident" id="5176375">Mode</span><span class="op" id="5176379">:</span>&nbsp;<span class="ident" id="5176381">RawFormat</span><span class="op" id="5176390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176393">var</span>&nbsp;<span class="ident" id="5176397">buf</span>&nbsp;<span class="ident" id="5176401">bytes</span><span class="op" id="5176406">.</span><span class="ident" id="5176407">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176415">if</span>&nbsp;<span class="ident" id="5176418">err</span>&nbsp;<span class="op" id="5176422">:=</span>&nbsp;<span class="ident" id="5176425">cfg</span><span class="op" id="5176428">.</span><span class="ident" id="5176429">fprint</span><span class="op" id="5176435">(</span><span class="op" id="5176436">&amp;</span><span class="ident" id="5176437">buf</span><span class="op" id="5176440">,</span>&nbsp;<span class="ident" id="5176442">p</span><span class="op" id="5176443">.</span><span class="ident" id="5176444">fset</span><span class="op" id="5176448">,</span>&nbsp;<span class="ident" id="5176450">n</span><span class="op" id="5176451">,</span>&nbsp;<span class="ident" id="5176453">p</span><span class="op" id="5176454">.</span><span class="ident" id="5176455">nodeSizes</span><span class="op" id="5176464">)</span><span class="op" id="5176465">;</span>&nbsp;<span class="ident" id="5176467">err</span>&nbsp;<span class="op" id="5176471">!=</span>&nbsp;<span class="ident" id="5176474">nil</span>&nbsp;<span class="op" id="5176478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176482">return</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176493">if</span>&nbsp;<span class="ident" id="5176496">buf</span><span class="op" id="5176499">.</span><span class="ident" id="5176500">Len</span><span class="op" id="5176503">(</span><span class="op" id="5176504">)</span>&nbsp;<span class="op" id="5176506">&lt;=</span>&nbsp;<span class="ident" id="5176509">maxSize</span>&nbsp;<span class="op" id="5176517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176521">for</span>&nbsp;<span class="ident" id="5176525">_</span><span class="op" id="5176526">,</span>&nbsp;<span class="ident" id="5176528">ch</span>&nbsp;<span class="op" id="5176531">:=</span>&nbsp;<span class="keyword" id="5176534">range</span>&nbsp;<span class="ident" id="5176540">buf</span><span class="op" id="5176543">.</span><span class="ident" id="5176544">Bytes</span><span class="op" id="5176549">(</span><span class="op" id="5176550">)</span>&nbsp;<span class="op" id="5176552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176557">if</span>&nbsp;<span class="ident" id="5176560">ch</span>&nbsp;<span class="op" id="5176563">&lt;</span>&nbsp;<span class="string" id="5176565">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5176569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176575">return</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176593">size</span>&nbsp;<span class="op" id="5176598">=</span>&nbsp;<span class="ident" id="5176600">buf</span><span class="op" id="5176603">.</span><span class="ident" id="5176604">Len</span><span class="op" id="5176607">(</span><span class="op" id="5176608">)</span>&nbsp;<span class="comment" id="5176610">//&nbsp;n&nbsp;fits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176622">p</span><span class="op" id="5176623">.</span><span class="ident" id="5176624">nodeSizes</span><span class="op" id="5176633">[</span><span class="ident" id="5176634">n</span><span class="op" id="5176635">]</span>&nbsp;<span class="op" id="5176637">=</span>&nbsp;<span class="ident" id="5176639">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176645">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176648">return</span><br>
<span class="lineno"></span><span class="op" id="5176655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5176658">//&nbsp;bodySize&nbsp;is&nbsp;like&nbsp;nodeSize&nbsp;but&nbsp;it&nbsp;is&nbsp;specialized&nbsp;for&nbsp;*ast.BlockStmt&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5176731">func</span>&nbsp;<span class="op" id="5176736">(</span><span class="ident" id="5176737">p</span>&nbsp;<span class="op" id="5176739">*</span><span class="ident" id="5176740">printer</span><span class="op" id="5176747">)</span>&nbsp;<span class="ident" id="5176749">bodySize</span><span class="op" id="5176757">(</span><span class="ident" id="5176758">b</span>&nbsp;<span class="op" id="5176760">*</span><span class="ident" id="5176761">ast</span><span class="op" id="5176764">.</span><span class="ident" id="5176765">BlockStmt</span><span class="op" id="5176774">,</span>&nbsp;<span class="ident" id="5176776">maxSize</span>&nbsp;<span class="builtintype" id="5176784">int</span><span class="op" id="5176787">)</span>&nbsp;<span class="builtintype" id="5176789">int</span>&nbsp;<span class="op" id="5176793">{</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176796">pos1</span>&nbsp;<span class="op" id="5176801">:=</span>&nbsp;<span class="ident" id="5176804">b</span><span class="op" id="5176805">.</span><span class="ident" id="5176806">Pos</span><span class="op" id="5176809">(</span><span class="op" id="5176810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176813">pos2</span>&nbsp;<span class="op" id="5176818">:=</span>&nbsp;<span class="ident" id="5176821">b</span><span class="op" id="5176822">.</span><span class="ident" id="5176823">Rbrace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176831">if</span>&nbsp;<span class="ident" id="5176834">pos1</span><span class="op" id="5176838">.</span><span class="ident" id="5176839">IsValid</span><span class="op" id="5176846">(</span><span class="op" id="5176847">)</span>&nbsp;<span class="op" id="5176849">&amp;&amp;</span>&nbsp;<span class="ident" id="5176852">pos2</span><span class="op" id="5176856">.</span><span class="ident" id="5176857">IsValid</span><span class="op" id="5176864">(</span><span class="op" id="5176865">)</span>&nbsp;<span class="op" id="5176867">&amp;&amp;</span>&nbsp;<span class="ident" id="5176870">p</span><span class="op" id="5176871">.</span><span class="ident" id="5176872">lineFor</span><span class="op" id="5176879">(</span><span class="ident" id="5176880">pos1</span><span class="op" id="5176884">)</span>&nbsp;<span class="op" id="5176886">!=</span>&nbsp;<span class="ident" id="5176889">p</span><span class="op" id="5176890">.</span><span class="ident" id="5176891">lineFor</span><span class="op" id="5176898">(</span><span class="ident" id="5176899">pos2</span><span class="op" id="5176903">)</span>&nbsp;<span class="op" id="5176905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176909">//&nbsp;opening&nbsp;and&nbsp;closing&nbsp;brace&nbsp;are&nbsp;on&nbsp;different&nbsp;lines&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176991">return</span>&nbsp;<span class="ident" id="5176998">maxSize</span>&nbsp;<span class="op" id="5177006">+</span>&nbsp;<span class="num" id="5177008">1</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177014">if</span>&nbsp;<span class="builtinfunc" id="5177017">len</span><span class="op" id="5177020">(</span><span class="ident" id="5177021">b</span><span class="op" id="5177022">.</span><span class="ident" id="5177023">List</span><span class="op" id="5177027">)</span>&nbsp;<span class="op" id="5177029">&gt;</span>&nbsp;<span class="num" id="5177031">5</span>&nbsp;<span class="op" id="5177033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177037">//&nbsp;too&nbsp;many&nbsp;statements&nbsp;-&nbsp;don&#39;t&nbsp;make&nbsp;it&nbsp;a&nbsp;one-liner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177090">return</span>&nbsp;<span class="ident" id="5177097">maxSize</span>&nbsp;<span class="op" id="5177105">+</span>&nbsp;<span class="num" id="5177107">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177110">}</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177113">//&nbsp;otherwise,&nbsp;estimate&nbsp;body&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177147">bodySize</span>&nbsp;<span class="op" id="5177156">:=</span>&nbsp;<span class="ident" id="5177159">p</span><span class="op" id="5177160">.</span><span class="ident" id="5177161">commentSizeBefore</span><span class="op" id="5177178">(</span><span class="ident" id="5177179">p</span><span class="op" id="5177180">.</span><span class="ident" id="5177181">posFor</span><span class="op" id="5177187">(</span><span class="ident" id="5177188">pos2</span><span class="op" id="5177192">)</span><span class="op" id="5177193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177196">for</span>&nbsp;<span class="ident" id="5177200">i</span><span class="op" id="5177201">,</span>&nbsp;<span class="ident" id="5177203">s</span>&nbsp;<span class="op" id="5177205">:=</span>&nbsp;<span class="keyword" id="5177208">range</span>&nbsp;<span class="ident" id="5177214">b</span><span class="op" id="5177215">.</span><span class="ident" id="5177216">List</span>&nbsp;<span class="op" id="5177221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177225">if</span>&nbsp;<span class="ident" id="5177228">bodySize</span>&nbsp;<span class="op" id="5177237">&gt;</span>&nbsp;<span class="ident" id="5177239">maxSize</span>&nbsp;<span class="op" id="5177247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177252">break</span>&nbsp;<span class="comment" id="5177258">//&nbsp;no&nbsp;need&nbsp;to&nbsp;continue</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177287">if</span>&nbsp;<span class="ident" id="5177290">i</span>&nbsp;<span class="op" id="5177292">&gt;</span>&nbsp;<span class="num" id="5177294">0</span>&nbsp;<span class="op" id="5177296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177301">bodySize</span>&nbsp;<span class="op" id="5177310">+=</span>&nbsp;<span class="num" id="5177313">2</span>&nbsp;<span class="comment" id="5177315">//&nbsp;space&nbsp;for&nbsp;a&nbsp;semicolon&nbsp;and&nbsp;blank</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177356">bodySize</span>&nbsp;<span class="op" id="5177365">+=</span>&nbsp;<span class="ident" id="5177368">p</span><span class="op" id="5177369">.</span><span class="ident" id="5177370">nodeSize</span><span class="op" id="5177378">(</span><span class="ident" id="5177379">s</span><span class="op" id="5177380">,</span>&nbsp;<span class="ident" id="5177382">maxSize</span><span class="op" id="5177389">)</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177395">return</span>&nbsp;<span class="ident" id="5177402">bodySize</span><br>
<span class="lineno"></span><span class="op" id="5177411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5177414">//&nbsp;adjBlock&nbsp;prints&nbsp;an&nbsp;&#34;adjacent&#34;&nbsp;block&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;or&nbsp;function&nbsp;body)&nbsp;following</span><br>
<span class="lineno">1490</span><span class="comment" id="5177499">//&nbsp;a&nbsp;header&nbsp;(e.g.,&nbsp;a&nbsp;for-loop&nbsp;control&nbsp;clause&nbsp;or&nbsp;function&nbsp;signature)&nbsp;of&nbsp;given&nbsp;headerSize.</span><br>
<span class="lineno"></span><span class="comment" id="5177588">//&nbsp;If&nbsp;the&nbsp;header&#39;s&nbsp;and&nbsp;block&#39;s&nbsp;size&nbsp;are&nbsp;&#34;small&nbsp;enough&#34;&nbsp;and&nbsp;the&nbsp;block&nbsp;is&nbsp;&#34;simple&nbsp;enough&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5177677">//&nbsp;the&nbsp;block&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;without&nbsp;line&nbsp;breaks,&nbsp;spaced&nbsp;from&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5177766">//&nbsp;by&nbsp;sep.&nbsp;Otherwise&nbsp;the&nbsp;block&#39;s&nbsp;opening&nbsp;&#34;{&#34;&nbsp;is&nbsp;printed&nbsp;on&nbsp;the&nbsp;current&nbsp;line,&nbsp;followed&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5177855">//&nbsp;lines&nbsp;for&nbsp;the&nbsp;block&#39;s&nbsp;statements&nbsp;and&nbsp;its&nbsp;closing&nbsp;&#34;}&#34;.</span><br>
<span class="lineno">1495</span><span class="comment" id="5177912">//</span><br>
<span class="lineno"></span><span class="keyword" id="5177915">func</span>&nbsp;<span class="op" id="5177920">(</span><span class="ident" id="5177921">p</span>&nbsp;<span class="op" id="5177923">*</span><span class="ident" id="5177924">printer</span><span class="op" id="5177931">)</span>&nbsp;<span class="ident" id="5177933">adjBlock</span><span class="op" id="5177941">(</span><span class="ident" id="5177942">headerSize</span>&nbsp;<span class="builtintype" id="5177953">int</span><span class="op" id="5177956">,</span>&nbsp;<span class="ident" id="5177958">sep</span>&nbsp;<span class="ident" id="5177962">whiteSpace</span><span class="op" id="5177972">,</span>&nbsp;<span class="ident" id="5177974">b</span>&nbsp;<span class="op" id="5177976">*</span><span class="ident" id="5177977">ast</span><span class="op" id="5177980">.</span><span class="ident" id="5177981">BlockStmt</span><span class="op" id="5177990">)</span>&nbsp;<span class="op" id="5177992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177995">if</span>&nbsp;<span class="ident" id="5177998">b</span>&nbsp;<span class="op" id="5178000">==</span>&nbsp;<span class="ident" id="5178003">nil</span>&nbsp;<span class="op" id="5178007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178011">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178019">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178023">const</span>&nbsp;<span class="ident" id="5178029">maxSize</span>&nbsp;<span class="op" id="5178037">=</span>&nbsp;<span class="num" id="5178039">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178044">if</span>&nbsp;<span class="ident" id="5178047">headerSize</span><span class="op" id="5178057">+</span><span class="ident" id="5178058">p</span><span class="op" id="5178059">.</span><span class="ident" id="5178060">bodySize</span><span class="op" id="5178068">(</span><span class="ident" id="5178069">b</span><span class="op" id="5178070">,</span>&nbsp;<span class="ident" id="5178072">maxSize</span><span class="op" id="5178079">)</span>&nbsp;<span class="op" id="5178081">&lt;=</span>&nbsp;<span class="ident" id="5178084">maxSize</span>&nbsp;<span class="op" id="5178092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178096">p</span><span class="op" id="5178097">.</span><span class="builtinfunc" id="5178098">print</span><span class="op" id="5178103">(</span><span class="ident" id="5178104">sep</span><span class="op" id="5178107">,</span>&nbsp;<span class="ident" id="5178109">b</span><span class="op" id="5178110">.</span><span class="ident" id="5178111">Lbrace</span><span class="op" id="5178117">,</span>&nbsp;<span class="ident" id="5178119">token</span><span class="op" id="5178124">.</span><span class="ident" id="5178125">LBRACE</span><span class="op" id="5178131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178135">if</span>&nbsp;<span class="builtinfunc" id="5178138">len</span><span class="op" id="5178141">(</span><span class="ident" id="5178142">b</span><span class="op" id="5178143">.</span><span class="ident" id="5178144">List</span><span class="op" id="5178148">)</span>&nbsp;<span class="op" id="5178150">&gt;</span>&nbsp;<span class="num" id="5178152">0</span>&nbsp;<span class="op" id="5178154">{</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178159">p</span><span class="op" id="5178160">.</span><span class="builtinfunc" id="5178161">print</span><span class="op" id="5178166">(</span><span class="ident" id="5178167">blank</span><span class="op" id="5178172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178177">for</span>&nbsp;<span class="ident" id="5178181">i</span><span class="op" id="5178182">,</span>&nbsp;<span class="ident" id="5178184">s</span>&nbsp;<span class="op" id="5178186">:=</span>&nbsp;<span class="keyword" id="5178189">range</span>&nbsp;<span class="ident" id="5178195">b</span><span class="op" id="5178196">.</span><span class="ident" id="5178197">List</span>&nbsp;<span class="op" id="5178202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178208">if</span>&nbsp;<span class="ident" id="5178211">i</span>&nbsp;<span class="op" id="5178213">&gt;</span>&nbsp;<span class="num" id="5178215">0</span>&nbsp;<span class="op" id="5178217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178224">p</span><span class="op" id="5178225">.</span><span class="builtinfunc" id="5178226">print</span><span class="op" id="5178231">(</span><span class="ident" id="5178232">token</span><span class="op" id="5178237">.</span><span class="ident" id="5178238">SEMICOLON</span><span class="op" id="5178247">,</span>&nbsp;<span class="ident" id="5178249">blank</span><span class="op" id="5178254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178260">}</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178266">p</span><span class="op" id="5178267">.</span><span class="ident" id="5178268">stmt</span><span class="op" id="5178272">(</span><span class="ident" id="5178273">s</span><span class="op" id="5178274">,</span>&nbsp;<span class="ident" id="5178276">i</span>&nbsp;<span class="op" id="5178278">==</span>&nbsp;<span class="builtinfunc" id="5178281">len</span><span class="op" id="5178284">(</span><span class="ident" id="5178285">b</span><span class="op" id="5178286">.</span><span class="ident" id="5178287">List</span><span class="op" id="5178291">)</span><span class="op" id="5178292">-</span><span class="num" id="5178293">1</span><span class="op" id="5178294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178304">p</span><span class="op" id="5178305">.</span><span class="builtinfunc" id="5178306">print</span><span class="op" id="5178311">(</span><span class="ident" id="5178312">blank</span><span class="op" id="5178317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178325">p</span><span class="op" id="5178326">.</span><span class="builtinfunc" id="5178327">print</span><span class="op" id="5178332">(</span><span class="ident" id="5178333">noExtraLinebreak</span><span class="op" id="5178349">,</span>&nbsp;<span class="ident" id="5178351">b</span><span class="op" id="5178352">.</span><span class="ident" id="5178353">Rbrace</span><span class="op" id="5178359">,</span>&nbsp;<span class="ident" id="5178361">token</span><span class="op" id="5178366">.</span><span class="ident" id="5178367">RBRACE</span><span class="op" id="5178373">,</span>&nbsp;<span class="ident" id="5178375">noExtraLinebreak</span><span class="op" id="5178391">)</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178395">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178407">if</span>&nbsp;<span class="ident" id="5178410">sep</span>&nbsp;<span class="op" id="5178414">!=</span>&nbsp;<span class="ident" id="5178417">ignore</span>&nbsp;<span class="op" id="5178424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178428">p</span><span class="op" id="5178429">.</span><span class="builtinfunc" id="5178430">print</span><span class="op" id="5178435">(</span><span class="ident" id="5178436">blank</span><span class="op" id="5178441">)</span>&nbsp;<span class="comment" id="5178443">//&nbsp;always&nbsp;use&nbsp;blank</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178467">p</span><span class="op" id="5178468">.</span><span class="ident" id="5178469">block</span><span class="op" id="5178474">(</span><span class="ident" id="5178475">b</span><span class="op" id="5178476">,</span>&nbsp;<span class="num" id="5178478">1</span><span class="op" id="5178479">)</span><br>
<span class="lineno"></span><span class="op" id="5178481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5178484">//&nbsp;distanceFrom&nbsp;returns&nbsp;the&nbsp;column&nbsp;difference&nbsp;between&nbsp;from&nbsp;and&nbsp;p.pos&nbsp;(the&nbsp;current</span><br>
<span class="lineno">1525</span><span class="comment" id="5178566">//&nbsp;estimated&nbsp;position)&nbsp;if&nbsp;both&nbsp;are&nbsp;on&nbsp;the&nbsp;same&nbsp;line;&nbsp;if&nbsp;they&nbsp;are&nbsp;on&nbsp;different&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="5178650">//&nbsp;(or&nbsp;unknown)&nbsp;the&nbsp;result&nbsp;is&nbsp;infinity.</span><br>
<span class="lineno"></span><span class="keyword" id="5178690">func</span>&nbsp;<span class="op" id="5178695">(</span><span class="ident" id="5178696">p</span>&nbsp;<span class="op" id="5178698">*</span><span class="ident" id="5178699">printer</span><span class="op" id="5178706">)</span>&nbsp;<span class="ident" id="5178708">distanceFrom</span><span class="op" id="5178720">(</span><span class="ident" id="5178721">from</span>&nbsp;<span class="ident" id="5178726">token</span><span class="op" id="5178731">.</span><span class="ident" id="5178732">Pos</span><span class="op" id="5178735">)</span>&nbsp;<span class="builtintype" id="5178737">int</span>&nbsp;<span class="op" id="5178741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178744">if</span>&nbsp;<span class="ident" id="5178747">from</span><span class="op" id="5178751">.</span><span class="ident" id="5178752">IsValid</span><span class="op" id="5178759">(</span><span class="op" id="5178760">)</span>&nbsp;<span class="op" id="5178762">&amp;&amp;</span>&nbsp;<span class="ident" id="5178765">p</span><span class="op" id="5178766">.</span><span class="ident" id="5178767">pos</span><span class="op" id="5178770">.</span><span class="ident" id="5178771">IsValid</span><span class="op" id="5178778">(</span><span class="op" id="5178779">)</span>&nbsp;<span class="op" id="5178781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178785">if</span>&nbsp;<span class="ident" id="5178788">f</span>&nbsp;<span class="op" id="5178790">:=</span>&nbsp;<span class="ident" id="5178793">p</span><span class="op" id="5178794">.</span><span class="ident" id="5178795">posFor</span><span class="op" id="5178801">(</span><span class="ident" id="5178802">from</span><span class="op" id="5178806">)</span><span class="op" id="5178807">;</span>&nbsp;<span class="ident" id="5178809">f</span><span class="op" id="5178810">.</span><span class="ident" id="5178811">Line</span>&nbsp;<span class="op" id="5178816">==</span>&nbsp;<span class="ident" id="5178819">p</span><span class="op" id="5178820">.</span><span class="ident" id="5178821">pos</span><span class="op" id="5178824">.</span><span class="ident" id="5178825">Line</span>&nbsp;<span class="op" id="5178830">{</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178835">return</span>&nbsp;<span class="ident" id="5178842">p</span><span class="op" id="5178843">.</span><span class="ident" id="5178844">pos</span><span class="op" id="5178847">.</span><span class="ident" id="5178848">Column</span>&nbsp;<span class="op" id="5178855">-</span>&nbsp;<span class="ident" id="5178857">f</span><span class="op" id="5178858">.</span><span class="ident" id="5178859">Column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178874">return</span>&nbsp;<span class="ident" id="5178881">infinity</span><br>
<span class="lineno"></span><span class="op" id="5178890">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span><span class="keyword" id="5178893">func</span>&nbsp;<span class="op" id="5178898">(</span><span class="ident" id="5178899">p</span>&nbsp;<span class="op" id="5178901">*</span><span class="ident" id="5178902">printer</span><span class="op" id="5178909">)</span>&nbsp;<span class="ident" id="5178911">funcDecl</span><span class="op" id="5178919">(</span><span class="ident" id="5178920">d</span>&nbsp;<span class="op" id="5178922">*</span><span class="ident" id="5178923">ast</span><span class="op" id="5178926">.</span><span class="ident" id="5178927">FuncDecl</span><span class="op" id="5178935">)</span>&nbsp;<span class="op" id="5178937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178940">p</span><span class="op" id="5178941">.</span><span class="ident" id="5178942">setComment</span><span class="op" id="5178952">(</span><span class="ident" id="5178953">d</span><span class="op" id="5178954">.</span><span class="ident" id="5178955">Doc</span><span class="op" id="5178958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178961">p</span><span class="op" id="5178962">.</span><span class="builtinfunc" id="5178963">print</span><span class="op" id="5178968">(</span><span class="ident" id="5178969">d</span><span class="op" id="5178970">.</span><span class="ident" id="5178971">Pos</span><span class="op" id="5178974">(</span><span class="op" id="5178975">)</span><span class="op" id="5178976">,</span>&nbsp;<span class="ident" id="5178978">token</span><span class="op" id="5178983">.</span><span class="ident" id="5178984">FUNC</span><span class="op" id="5178988">,</span>&nbsp;<span class="ident" id="5178990">blank</span><span class="op" id="5178995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178998">if</span>&nbsp;<span class="ident" id="5179001">d</span><span class="op" id="5179002">.</span><span class="ident" id="5179003">Recv</span>&nbsp;<span class="op" id="5179008">!=</span>&nbsp;<span class="ident" id="5179011">nil</span>&nbsp;<span class="op" id="5179015">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179019">p</span><span class="op" id="5179020">.</span><span class="ident" id="5179021">parameters</span><span class="op" id="5179031">(</span><span class="ident" id="5179032">d</span><span class="op" id="5179033">.</span><span class="ident" id="5179034">Recv</span><span class="op" id="5179038">)</span>&nbsp;<span class="comment" id="5179040">//&nbsp;method:&nbsp;print&nbsp;receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179068">p</span><span class="op" id="5179069">.</span><span class="builtinfunc" id="5179070">print</span><span class="op" id="5179075">(</span><span class="ident" id="5179076">blank</span><span class="op" id="5179081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179087">p</span><span class="op" id="5179088">.</span><span class="ident" id="5179089">expr</span><span class="op" id="5179093">(</span><span class="ident" id="5179094">d</span><span class="op" id="5179095">.</span><span class="ident" id="5179096">Name</span><span class="op" id="5179100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179103">p</span><span class="op" id="5179104">.</span><span class="ident" id="5179105">signature</span><span class="op" id="5179114">(</span><span class="ident" id="5179115">d</span><span class="op" id="5179116">.</span><span class="ident" id="5179117">Type</span><span class="op" id="5179121">.</span><span class="ident" id="5179122">Params</span><span class="op" id="5179128">,</span>&nbsp;<span class="ident" id="5179130">d</span><span class="op" id="5179131">.</span><span class="ident" id="5179132">Type</span><span class="op" id="5179136">.</span><span class="ident" id="5179137">Results</span><span class="op" id="5179144">)</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179147">p</span><span class="op" id="5179148">.</span><span class="ident" id="5179149">adjBlock</span><span class="op" id="5179157">(</span><span class="ident" id="5179158">p</span><span class="op" id="5179159">.</span><span class="ident" id="5179160">distanceFrom</span><span class="op" id="5179172">(</span><span class="ident" id="5179173">d</span><span class="op" id="5179174">.</span><span class="ident" id="5179175">Pos</span><span class="op" id="5179178">(</span><span class="op" id="5179179">)</span><span class="op" id="5179180">)</span><span class="op" id="5179181">,</span>&nbsp;<span class="ident" id="5179183">vtab</span><span class="op" id="5179187">,</span>&nbsp;<span class="ident" id="5179189">d</span><span class="op" id="5179190">.</span><span class="ident" id="5179191">Body</span><span class="op" id="5179195">)</span><br>
<span class="lineno"></span><span class="op" id="5179197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179200">func</span>&nbsp;<span class="op" id="5179205">(</span><span class="ident" id="5179206">p</span>&nbsp;<span class="op" id="5179208">*</span><span class="ident" id="5179209">printer</span><span class="op" id="5179216">)</span>&nbsp;<span class="ident" id="5179218">decl</span><span class="op" id="5179222">(</span><span class="ident" id="5179223">decl</span>&nbsp;<span class="ident" id="5179228">ast</span><span class="op" id="5179231">.</span><span class="ident" id="5179232">Decl</span><span class="op" id="5179236">)</span>&nbsp;<span class="op" id="5179238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179241">switch</span>&nbsp;<span class="ident" id="5179248">d</span>&nbsp;<span class="op" id="5179250">:=</span>&nbsp;<span class="ident" id="5179253">decl</span><span class="op" id="5179257">.</span><span class="op" id="5179258">(</span><span class="keyword" id="5179259">type</span><span class="op" id="5179263">)</span>&nbsp;<span class="op" id="5179265">{</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179268">case</span>&nbsp;<span class="op" id="5179273">*</span><span class="ident" id="5179274">ast</span><span class="op" id="5179277">.</span><span class="ident" id="5179278">BadDecl</span><span class="op" id="5179285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179289">p</span><span class="op" id="5179290">.</span><span class="builtinfunc" id="5179291">print</span><span class="op" id="5179296">(</span><span class="ident" id="5179297">d</span><span class="op" id="5179298">.</span><span class="ident" id="5179299">Pos</span><span class="op" id="5179302">(</span><span class="op" id="5179303">)</span><span class="op" id="5179304">,</span>&nbsp;<span class="string" id="5179306">&#34;BadDecl&#34;</span><span class="op" id="5179315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179318">case</span>&nbsp;<span class="op" id="5179323">*</span><span class="ident" id="5179324">ast</span><span class="op" id="5179327">.</span><span class="ident" id="5179328">GenDecl</span><span class="op" id="5179335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179339">p</span><span class="op" id="5179340">.</span><span class="ident" id="5179341">genDecl</span><span class="op" id="5179348">(</span><span class="ident" id="5179349">d</span><span class="op" id="5179350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179353">case</span>&nbsp;<span class="op" id="5179358">*</span><span class="ident" id="5179359">ast</span><span class="op" id="5179362">.</span><span class="ident" id="5179363">FuncDecl</span><span class="op" id="5179371">:</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179375">p</span><span class="op" id="5179376">.</span><span class="ident" id="5179377">funcDecl</span><span class="op" id="5179385">(</span><span class="ident" id="5179386">d</span><span class="op" id="5179387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179390">default</span><span class="op" id="5179397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5179401">panic</span><span class="op" id="5179406">(</span><span class="string" id="5179407">&#34;unreachable&#34;</span><span class="op" id="5179420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179423">}</span><br>
<span class="lineno"></span><span class="op" id="5179425">}</span><br>
<span class="lineno">1560</span><br>
<span class="lineno"></span><span class="comment" id="5179428">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5179508">//&nbsp;Files</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5179518">func</span>&nbsp;<span class="ident" id="5179523">declToken</span><span class="op" id="5179532">(</span><span class="ident" id="5179533">decl</span>&nbsp;<span class="ident" id="5179538">ast</span><span class="op" id="5179541">.</span><span class="ident" id="5179542">Decl</span><span class="op" id="5179546">)</span>&nbsp;<span class="op" id="5179548">(</span><span class="ident" id="5179549">tok</span>&nbsp;<span class="ident" id="5179553">token</span><span class="op" id="5179558">.</span><span class="ident" id="5179559">Token</span><span class="op" id="5179564">)</span>&nbsp;<span class="op" id="5179566">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179569">tok</span>&nbsp;<span class="op" id="5179573">=</span>&nbsp;<span class="ident" id="5179575">token</span><span class="op" id="5179580">.</span><span class="ident" id="5179581">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179590">switch</span>&nbsp;<span class="ident" id="5179597">d</span>&nbsp;<span class="op" id="5179599">:=</span>&nbsp;<span class="ident" id="5179602">decl</span><span class="op" id="5179606">.</span><span class="op" id="5179607">(</span><span class="keyword" id="5179608">type</span><span class="op" id="5179612">)</span>&nbsp;<span class="op" id="5179614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179617">case</span>&nbsp;<span class="op" id="5179622">*</span><span class="ident" id="5179623">ast</span><span class="op" id="5179626">.</span><span class="ident" id="5179627">GenDecl</span><span class="op" id="5179634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179638">tok</span>&nbsp;<span class="op" id="5179642">=</span>&nbsp;<span class="ident" id="5179644">d</span><span class="op" id="5179645">.</span><span class="ident" id="5179646">Tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179651">case</span>&nbsp;<span class="op" id="5179656">*</span><span class="ident" id="5179657">ast</span><span class="op" id="5179660">.</span><span class="ident" id="5179661">FuncDecl</span><span class="op" id="5179669">:</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179673">tok</span>&nbsp;<span class="op" id="5179677">=</span>&nbsp;<span class="ident" id="5179679">token</span><span class="op" id="5179684">.</span><span class="ident" id="5179685">FUNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179694">return</span><br>
<span class="lineno"></span><span class="op" id="5179701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span><span class="keyword" id="5179704">func</span>&nbsp;<span class="op" id="5179709">(</span><span class="ident" id="5179710">p</span>&nbsp;<span class="op" id="5179712">*</span><span class="ident" id="5179713">printer</span><span class="op" id="5179720">)</span>&nbsp;<span class="ident" id="5179722">declList</span><span class="op" id="5179730">(</span><span class="ident" id="5179731">list</span>&nbsp;<span class="op" id="5179736">[</span><span class="op" id="5179737">]</span><span class="ident" id="5179738">ast</span><span class="op" id="5179741">.</span><span class="ident" id="5179742">Decl</span><span class="op" id="5179746">)</span>&nbsp;<span class="op" id="5179748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179751">tok</span>&nbsp;<span class="op" id="5179755">:=</span>&nbsp;<span class="ident" id="5179758">token</span><span class="op" id="5179763">.</span><span class="ident" id="5179764">ILLEGAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179773">for</span>&nbsp;<span class="ident" id="5179777">_</span><span class="op" id="5179778">,</span>&nbsp;<span class="ident" id="5179780">d</span>&nbsp;<span class="op" id="5179782">:=</span>&nbsp;<span class="keyword" id="5179785">range</span>&nbsp;<span class="ident" id="5179791">list</span>&nbsp;<span class="op" id="5179796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179800">prev</span>&nbsp;<span class="op" id="5179805">:=</span>&nbsp;<span class="ident" id="5179808">tok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179814">tok</span>&nbsp;<span class="op" id="5179818">=</span>&nbsp;<span class="ident" id="5179820">declToken</span><span class="op" id="5179829">(</span><span class="ident" id="5179830">d</span><span class="op" id="5179831">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179835">//&nbsp;If&nbsp;the&nbsp;declaration&nbsp;token&nbsp;changed&nbsp;(e.g.,&nbsp;from&nbsp;CONST&nbsp;to&nbsp;TYPE)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179900">//&nbsp;or&nbsp;the&nbsp;next&nbsp;declaration&nbsp;has&nbsp;documentation&nbsp;associated&nbsp;with&nbsp;it,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179967">//&nbsp;print&nbsp;an&nbsp;empty&nbsp;line&nbsp;between&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180024">//&nbsp;(because&nbsp;p.linebreak&nbsp;is&nbsp;called&nbsp;with&nbsp;the&nbsp;position&nbsp;of&nbsp;d,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180090">//&nbsp;is&nbsp;past&nbsp;any&nbsp;documentation,&nbsp;the&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;satisfied</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180159">//&nbsp;even&nbsp;w/o&nbsp;the&nbsp;extra&nbsp;getDoc(d)&nbsp;nil-check&nbsp;-&nbsp;leave&nbsp;it&nbsp;in&nbsp;case&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180226">//&nbsp;linebreak&nbsp;logic&nbsp;improves&nbsp;-&nbsp;there&#39;s&nbsp;already&nbsp;a&nbsp;TODO).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180283">if</span>&nbsp;<span class="builtinfunc" id="5180286">len</span><span class="op" id="5180289">(</span><span class="ident" id="5180290">p</span><span class="op" id="5180291">.</span><span class="ident" id="5180292">output</span><span class="op" id="5180298">)</span>&nbsp;<span class="op" id="5180300">&gt;</span>&nbsp;<span class="num" id="5180302">0</span>&nbsp;<span class="op" id="5180304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180309">//&nbsp;only&nbsp;print&nbsp;line&nbsp;break&nbsp;if&nbsp;we&nbsp;are&nbsp;not&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180382">//&nbsp;(i.e.,&nbsp;we&nbsp;are&nbsp;not&nbsp;printing&nbsp;only&nbsp;a&nbsp;partial&nbsp;program)</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180439">min</span>&nbsp;<span class="op" id="5180443">:=</span>&nbsp;<span class="num" id="5180446">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180451">if</span>&nbsp;<span class="ident" id="5180454">prev</span>&nbsp;<span class="op" id="5180459">!=</span>&nbsp;<span class="ident" id="5180462">tok</span>&nbsp;<span class="op" id="5180466">||</span>&nbsp;<span class="ident" id="5180469">getDoc</span><span class="op" id="5180475">(</span><span class="ident" id="5180476">d</span><span class="op" id="5180477">)</span>&nbsp;<span class="op" id="5180479">!=</span>&nbsp;<span class="ident" id="5180482">nil</span>&nbsp;<span class="op" id="5180486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180492">min</span>&nbsp;<span class="op" id="5180496">=</span>&nbsp;<span class="num" id="5180498">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180508">p</span><span class="op" id="5180509">.</span><span class="ident" id="5180510">linebreak</span><span class="op" id="5180519">(</span><span class="ident" id="5180520">p</span><span class="op" id="5180521">.</span><span class="ident" id="5180522">lineFor</span><span class="op" id="5180529">(</span><span class="ident" id="5180530">d</span><span class="op" id="5180531">.</span><span class="ident" id="5180532">Pos</span><span class="op" id="5180535">(</span><span class="op" id="5180536">)</span><span class="op" id="5180537">)</span><span class="op" id="5180538">,</span>&nbsp;<span class="ident" id="5180540">min</span><span class="op" id="5180543">,</span>&nbsp;<span class="ident" id="5180545">ignore</span><span class="op" id="5180551">,</span>&nbsp;<span class="builtintype" id="5180553">false</span><span class="op" id="5180558">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180566">p</span><span class="op" id="5180567">.</span><span class="ident" id="5180568">decl</span><span class="op" id="5180572">(</span><span class="ident" id="5180573">d</span><span class="op" id="5180574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180577">}</span><br>
<span class="lineno"></span><span class="op" id="5180579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1600</span><span class="keyword" id="5180582">func</span>&nbsp;<span class="op" id="5180587">(</span><span class="ident" id="5180588">p</span>&nbsp;<span class="op" id="5180590">*</span><span class="ident" id="5180591">printer</span><span class="op" id="5180598">)</span>&nbsp;<span class="ident" id="5180600">file</span><span class="op" id="5180604">(</span><span class="ident" id="5180605">src</span>&nbsp;<span class="op" id="5180609">*</span><span class="ident" id="5180610">ast</span><span class="op" id="5180613">.</span><span class="ident" id="5180614">File</span><span class="op" id="5180618">)</span>&nbsp;<span class="op" id="5180620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180623">p</span><span class="op" id="5180624">.</span><span class="ident" id="5180625">setComment</span><span class="op" id="5180635">(</span><span class="ident" id="5180636">src</span><span class="op" id="5180639">.</span><span class="ident" id="5180640">Doc</span><span class="op" id="5180643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180646">p</span><span class="op" id="5180647">.</span><span class="builtinfunc" id="5180648">print</span><span class="op" id="5180653">(</span><span class="ident" id="5180654">src</span><span class="op" id="5180657">.</span><span class="ident" id="5180658">Pos</span><span class="op" id="5180661">(</span><span class="op" id="5180662">)</span><span class="op" id="5180663">,</span>&nbsp;<span class="ident" id="5180665">token</span><span class="op" id="5180670">.</span><span class="ident" id="5180671">PACKAGE</span><span class="op" id="5180678">,</span>&nbsp;<span class="ident" id="5180680">blank</span><span class="op" id="5180685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180688">p</span><span class="op" id="5180689">.</span><span class="ident" id="5180690">expr</span><span class="op" id="5180694">(</span><span class="ident" id="5180695">src</span><span class="op" id="5180698">.</span><span class="ident" id="5180699">Name</span><span class="op" id="5180703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180706">p</span><span class="op" id="5180707">.</span><span class="ident" id="5180708">declList</span><span class="op" id="5180716">(</span><span class="ident" id="5180717">src</span><span class="op" id="5180720">.</span><span class="ident" id="5180721">Decls</span><span class="op" id="5180726">)</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180729">p</span><span class="op" id="5180730">.</span><span class="builtinfunc" id="5180731">print</span><span class="op" id="5180736">(</span><span class="ident" id="5180737">newline</span><span class="op" id="5180744">)</span><br>
<span class="lineno"></span><span class="op" id="5180746">}</span>
</div>
</body>
</html>
