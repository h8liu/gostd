<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2286643">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2286698">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2286752">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2286803">package</span>&nbsp;<span class="ident" id="2286811">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286817">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2286873">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2286927">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2286984">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2287039">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2287069">//</span><br>
<span class="lineno"></span><span class="comment" id="2287072">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2287128">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2287197">//</span><br>
<span class="lineno"></span><span class="comment" id="2287200">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2287259">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2287315">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2287372">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2287389">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2287445">//</span><br>
<span class="lineno">25</span><span class="comment" id="2287448">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2287483">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2287543">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2287599">//</span><br>
<span class="lineno"></span><span class="comment" id="2287602">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2287613">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2287655">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2287715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2287760">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2287809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2287830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2287883">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2287940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2288009">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2288063">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2288133">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2288198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2288230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2288298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2288349">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2288410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2288454">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2288481">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2288529">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2288551">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2288604">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2288666">//</span><br>
<span class="lineno"></span><span class="comment" id="2288669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2288733">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2288803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2288858">//</span><br>
<span class="lineno"></span><span class="comment" id="2288861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2288928">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2288958">//</span><br>
<span class="lineno"></span><span class="comment" id="2288961">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2288987">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2289059">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2289084">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2289147">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2289190">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2289243">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2289254">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2289315">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2289374">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2289388">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2289427">//</span><br>
<span class="lineno"></span><span class="comment" id="2289430">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2289482">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2289528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2289544">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2289593">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2289663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2289717">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2289761">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2289827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2289892">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2289935">//</span><br>
<span class="lineno"></span><span class="comment" id="2289938">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2289960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2290013">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2290051">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2290098">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2290144">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2290185">//</span><br>
<span class="lineno"></span><span class="comment" id="2290188">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2290192">var</span>&nbsp;<span class="ident" id="2290196">_lgamA</span>&nbsp;<span class="op" id="2290203">=</span>&nbsp;<span class="op" id="2290205">[</span><span class="op" id="2290206">...</span><span class="op" id="2290209">]</span><span class="builtintype" id="2290210">float64</span><span class="op" id="2290217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290220">7.72156649015328655494e-02</span><span class="op" id="2290246">,</span>&nbsp;<span class="comment" id="2290248">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290271">3.22467033424113591611e-01</span><span class="op" id="2290297">,</span>&nbsp;<span class="comment" id="2290299">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290322">6.73523010531292681824e-02</span><span class="op" id="2290348">,</span>&nbsp;<span class="comment" id="2290350">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290373">2.05808084325167332806e-02</span><span class="op" id="2290399">,</span>&nbsp;<span class="comment" id="2290401">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290424">7.38555086081402883957e-03</span><span class="op" id="2290450">,</span>&nbsp;<span class="comment" id="2290452">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290475">2.89051383673415629091e-03</span><span class="op" id="2290501">,</span>&nbsp;<span class="comment" id="2290503">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290526">1.19270763183362067845e-03</span><span class="op" id="2290552">,</span>&nbsp;<span class="comment" id="2290554">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290577">5.10069792153511336608e-04</span><span class="op" id="2290603">,</span>&nbsp;<span class="comment" id="2290605">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290628">2.20862790713908385557e-04</span><span class="op" id="2290654">,</span>&nbsp;<span class="comment" id="2290656">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290679">1.08011567247583939954e-04</span><span class="op" id="2290705">,</span>&nbsp;<span class="comment" id="2290707">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290730">2.52144565451257326939e-05</span><span class="op" id="2290756">,</span>&nbsp;<span class="comment" id="2290758">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290781">4.48640949618915160150e-05</span><span class="op" id="2290807">,</span>&nbsp;<span class="comment" id="2290809">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2290831">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2290833">var</span>&nbsp;<span class="ident" id="2290837">_lgamR</span>&nbsp;<span class="op" id="2290844">=</span>&nbsp;<span class="op" id="2290846">[</span><span class="op" id="2290847">...</span><span class="op" id="2290850">]</span><span class="builtintype" id="2290851">float64</span><span class="op" id="2290858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290861">1.0</span><span class="op" id="2290864">,</span>&nbsp;<span class="comment" id="2290866">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290882">1.39200533467621045958e+00</span><span class="op" id="2290908">,</span>&nbsp;<span class="comment" id="2290910">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290933">7.21935547567138069525e-01</span><span class="op" id="2290959">,</span>&nbsp;<span class="comment" id="2290961">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2290984">1.71933865632803078993e-01</span><span class="op" id="2291010">,</span>&nbsp;<span class="comment" id="2291012">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291035">1.86459191715652901344e-02</span><span class="op" id="2291061">,</span>&nbsp;<span class="comment" id="2291063">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291086">7.77942496381893596434e-04</span><span class="op" id="2291112">,</span>&nbsp;<span class="comment" id="2291114">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291137">7.32668430744625636189e-06</span><span class="op" id="2291163">,</span>&nbsp;<span class="comment" id="2291165">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2291187">}</span><br>
<span class="lineno"></span><span class="keyword" id="2291189">var</span>&nbsp;<span class="ident" id="2291193">_lgamS</span>&nbsp;<span class="op" id="2291200">=</span>&nbsp;<span class="op" id="2291202">[</span><span class="op" id="2291203">...</span><span class="op" id="2291206">]</span><span class="builtintype" id="2291207">float64</span><span class="op" id="2291214">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291217">-</span><span class="num" id="2291218">7.72156649015328655494e-02</span><span class="op" id="2291244">,</span>&nbsp;<span class="comment" id="2291246">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291269">2.14982415960608852501e-01</span><span class="op" id="2291295">,</span>&nbsp;&nbsp;<span class="comment" id="2291298">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291321">3.25778796408930981787e-01</span><span class="op" id="2291347">,</span>&nbsp;&nbsp;<span class="comment" id="2291350">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291373">1.46350472652464452805e-01</span><span class="op" id="2291399">,</span>&nbsp;&nbsp;<span class="comment" id="2291402">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291425">2.66422703033638609560e-02</span><span class="op" id="2291451">,</span>&nbsp;&nbsp;<span class="comment" id="2291454">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291477">1.84028451407337715652e-03</span><span class="op" id="2291503">,</span>&nbsp;&nbsp;<span class="comment" id="2291506">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291529">3.19475326584100867617e-05</span><span class="op" id="2291555">,</span>&nbsp;&nbsp;<span class="comment" id="2291558">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2291580">}</span><br>
<span class="lineno"></span><span class="keyword" id="2291582">var</span>&nbsp;<span class="ident" id="2291586">_lgamT</span>&nbsp;<span class="op" id="2291593">=</span>&nbsp;<span class="op" id="2291595">[</span><span class="op" id="2291596">...</span><span class="op" id="2291599">]</span><span class="builtintype" id="2291600">float64</span><span class="op" id="2291607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291610">4.83836122723810047042e-01</span><span class="op" id="2291636">,</span>&nbsp;&nbsp;<span class="comment" id="2291639">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291662">-</span><span class="num" id="2291663">1.47587722994593911752e-01</span><span class="op" id="2291689">,</span>&nbsp;<span class="comment" id="2291691">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291714">6.46249402391333854778e-02</span><span class="op" id="2291740">,</span>&nbsp;&nbsp;<span class="comment" id="2291743">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291766">-</span><span class="num" id="2291767">3.27885410759859649565e-02</span><span class="op" id="2291793">,</span>&nbsp;<span class="comment" id="2291795">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291818">1.79706750811820387126e-02</span><span class="op" id="2291844">,</span>&nbsp;&nbsp;<span class="comment" id="2291847">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291870">-</span><span class="num" id="2291871">1.03142241298341437450e-02</span><span class="op" id="2291897">,</span>&nbsp;<span class="comment" id="2291899">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2291922">6.10053870246291332635e-03</span><span class="op" id="2291948">,</span>&nbsp;&nbsp;<span class="comment" id="2291951">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291974">-</span><span class="num" id="2291975">3.68452016781138256760e-03</span><span class="op" id="2292001">,</span>&nbsp;<span class="comment" id="2292003">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292026">2.25964780900612472250e-03</span><span class="op" id="2292052">,</span>&nbsp;&nbsp;<span class="comment" id="2292055">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292078">-</span><span class="num" id="2292079">1.40346469989232843813e-03</span><span class="op" id="2292105">,</span>&nbsp;<span class="comment" id="2292107">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292130">8.81081882437654011382e-04</span><span class="op" id="2292156">,</span>&nbsp;&nbsp;<span class="comment" id="2292159">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292182">-</span><span class="num" id="2292183">5.38595305356740546715e-04</span><span class="op" id="2292209">,</span>&nbsp;<span class="comment" id="2292211">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292234">3.15632070903625950361e-04</span><span class="op" id="2292260">,</span>&nbsp;&nbsp;<span class="comment" id="2292263">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292286">-</span><span class="num" id="2292287">3.12754168375120860518e-04</span><span class="op" id="2292313">,</span>&nbsp;<span class="comment" id="2292315">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292338">3.35529192635519073543e-04</span><span class="op" id="2292364">,</span>&nbsp;&nbsp;<span class="comment" id="2292367">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2292389">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2292391">var</span>&nbsp;<span class="ident" id="2292395">_lgamU</span>&nbsp;<span class="op" id="2292402">=</span>&nbsp;<span class="op" id="2292404">[</span><span class="op" id="2292405">...</span><span class="op" id="2292408">]</span><span class="builtintype" id="2292409">float64</span><span class="op" id="2292416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292419">-</span><span class="num" id="2292420">7.72156649015328655494e-02</span><span class="op" id="2292446">,</span>&nbsp;<span class="comment" id="2292448">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292471">6.32827064025093366517e-01</span><span class="op" id="2292497">,</span>&nbsp;&nbsp;<span class="comment" id="2292500">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292523">1.45492250137234768737e+00</span><span class="op" id="2292549">,</span>&nbsp;&nbsp;<span class="comment" id="2292552">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292575">9.77717527963372745603e-01</span><span class="op" id="2292601">,</span>&nbsp;&nbsp;<span class="comment" id="2292604">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292627">2.28963728064692451092e-01</span><span class="op" id="2292653">,</span>&nbsp;&nbsp;<span class="comment" id="2292656">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292679">1.33810918536787660377e-02</span><span class="op" id="2292705">,</span>&nbsp;&nbsp;<span class="comment" id="2292708">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2292730">}</span><br>
<span class="lineno"></span><span class="keyword" id="2292732">var</span>&nbsp;<span class="ident" id="2292736">_lgamV</span>&nbsp;<span class="op" id="2292743">=</span>&nbsp;<span class="op" id="2292745">[</span><span class="op" id="2292746">...</span><span class="op" id="2292749">]</span><span class="builtintype" id="2292750">float64</span><span class="op" id="2292757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292760">1.0</span><span class="op" id="2292763">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292766">2.45597793713041134822e+00</span><span class="op" id="2292792">,</span>&nbsp;<span class="comment" id="2292794">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292817">2.12848976379893395361e+00</span><span class="op" id="2292843">,</span>&nbsp;<span class="comment" id="2292845">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292868">7.69285150456672783825e-01</span><span class="op" id="2292894">,</span>&nbsp;<span class="comment" id="2292896">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292919">1.04222645593369134254e-01</span><span class="op" id="2292945">,</span>&nbsp;<span class="comment" id="2292947">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2292970">3.21709242282423911810e-03</span><span class="op" id="2292996">,</span>&nbsp;<span class="comment" id="2292998">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2293020">}</span><br>
<span class="lineno"></span><span class="keyword" id="2293022">var</span>&nbsp;<span class="ident" id="2293026">_lgamW</span>&nbsp;<span class="op" id="2293033">=</span>&nbsp;<span class="op" id="2293035">[</span><span class="op" id="2293036">...</span><span class="op" id="2293039">]</span><span class="builtintype" id="2293040">float64</span><span class="op" id="2293047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2293050">4.18938533204672725052e-01</span><span class="op" id="2293076">,</span>&nbsp;&nbsp;<span class="comment" id="2293079">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2293102">8.33333333333329678849e-02</span><span class="op" id="2293128">,</span>&nbsp;&nbsp;<span class="comment" id="2293131">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2293154">-</span><span class="num" id="2293155">2.77777777728775536470e-03</span><span class="op" id="2293181">,</span>&nbsp;<span class="comment" id="2293183">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2293206">7.93650558643019558500e-04</span><span class="op" id="2293232">,</span>&nbsp;&nbsp;<span class="comment" id="2293235">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2293258">-</span><span class="num" id="2293259">5.95187557450339963135e-04</span><span class="op" id="2293285">,</span>&nbsp;<span class="comment" id="2293287">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2293310">8.36339918996282139126e-04</span><span class="op" id="2293336">,</span>&nbsp;&nbsp;<span class="comment" id="2293339">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2293362">-</span><span class="num" id="2293363">1.63092934096575273989e-03</span><span class="op" id="2293389">,</span>&nbsp;<span class="comment" id="2293391">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2293413">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2293416">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2293489">//</span><br>
<span class="lineno"></span><span class="comment" id="2293492">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2293514">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2293537">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2293557">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2293584">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2293607">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2293628">func</span>&nbsp;<span class="ident" id="2293633">Lgamma</span><span class="op" id="2293639">(</span><span class="ident" id="2293640">x</span>&nbsp;<span class="builtintype" id="2293642">float64</span><span class="op" id="2293649">)</span>&nbsp;<span class="op" id="2293651">(</span><span class="ident" id="2293652">lgamma</span>&nbsp;<span class="builtintype" id="2293659">float64</span><span class="op" id="2293666">,</span>&nbsp;<span class="ident" id="2293668">sign</span>&nbsp;<span class="builtintype" id="2293673">int</span><span class="op" id="2293676">)</span>&nbsp;<span class="op" id="2293678">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2293681">const</span>&nbsp;<span class="op" id="2293687">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2293691">Ymin</span>&nbsp;&nbsp;<span class="op" id="2293697">=</span>&nbsp;<span class="num" id="2293699">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2293722">Two52</span>&nbsp;<span class="op" id="2293728">=</span>&nbsp;<span class="num" id="2293730">1</span>&nbsp;<span class="op" id="2293732">&lt;&lt;</span>&nbsp;<span class="num" id="2293735">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2293758">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2293794">Two53</span>&nbsp;<span class="op" id="2293800">=</span>&nbsp;<span class="num" id="2293802">1</span>&nbsp;<span class="op" id="2293804">&lt;&lt;</span>&nbsp;<span class="num" id="2293807">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2293830">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2293866">Two58</span>&nbsp;<span class="op" id="2293872">=</span>&nbsp;<span class="num" id="2293874">1</span>&nbsp;<span class="op" id="2293876">&lt;&lt;</span>&nbsp;<span class="num" id="2293879">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2293902">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2293938">Tiny</span>&nbsp;&nbsp;<span class="op" id="2293944">=</span>&nbsp;<span class="num" id="2293946">1.0</span>&nbsp;<span class="op" id="2293950">/</span>&nbsp;<span class="op" id="2293952">(</span><span class="num" id="2293953">1</span>&nbsp;<span class="op" id="2293955">&lt;&lt;</span>&nbsp;<span class="num" id="2293958">70</span><span class="op" id="2293960">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2293974">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294011">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294017">=</span>&nbsp;<span class="num" id="2294019">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2294047">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294071">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294077">=</span>&nbsp;<span class="op" id="2294079">-</span><span class="num" id="2294080">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2294107">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2294131">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294155">Tt</span>&nbsp;<span class="op" id="2294158">=</span>&nbsp;<span class="op" id="2294160">-</span><span class="num" id="2294161">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2294188">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2294214">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294232"><a href="/gostd/math/lgamma.go.html#2293668">sign</a></span>&nbsp;<span class="op" id="2294237">=</span>&nbsp;<span class="num" id="2294239">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294242">switch</span>&nbsp;<span class="op" id="2294249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294252">case</span>&nbsp;<span class="ident" id="2294257"><a href="/gostd/math/bits.go.html#2211423">IsNaN</a></span><span class="op" id="2294262">(</span><span class="ident" id="2294263"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294264">)</span><span class="op" id="2294265">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294269"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294276">=</span>&nbsp;<span class="ident" id="2294278"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294282">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294290">case</span>&nbsp;<span class="ident" id="2294295"><a href="/gostd/math/bits.go.html#2211921">IsInf</a></span><span class="op" id="2294300">(</span><span class="ident" id="2294301"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294302">,</span>&nbsp;<span class="num" id="2294304">0</span><span class="op" id="2294305">)</span><span class="op" id="2294306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294310"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294317">=</span>&nbsp;<span class="ident" id="2294319"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294323">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294331">case</span>&nbsp;<span class="ident" id="2294336"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294338">==</span>&nbsp;<span class="num" id="2294341">0</span><span class="op" id="2294342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294346"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294353">=</span>&nbsp;<span class="ident" id="2294355"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2294358">(</span><span class="num" id="2294359">1</span><span class="op" id="2294360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294364">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294376">neg</span>&nbsp;<span class="op" id="2294380">:=</span>&nbsp;<span class="builtintype" id="2294383">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294390">if</span>&nbsp;<span class="ident" id="2294393"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294395">&lt;</span>&nbsp;<span class="num" id="2294397">0</span>&nbsp;<span class="op" id="2294399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294403"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294405">=</span>&nbsp;<span class="op" id="2294407">-</span><span class="ident" id="2294408"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294412"><a href="/gostd/math/lgamma.go.html#2294376">neg</a></span>&nbsp;<span class="op" id="2294416">=</span>&nbsp;<span class="builtintype" id="2294418">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294424">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294428">if</span>&nbsp;<span class="ident" id="2294431"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294433">&lt;</span>&nbsp;<span class="ident" id="2294435"><a href="/gostd/math/lgamma.go.html#2293938">Tiny</a></span>&nbsp;<span class="op" id="2294440">{</span>&nbsp;<span class="comment" id="2294442">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294481">if</span>&nbsp;<span class="ident" id="2294484"><a href="/gostd/math/lgamma.go.html#2294376">neg</a></span>&nbsp;<span class="op" id="2294488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294493"><a href="/gostd/math/lgamma.go.html#2293668">sign</a></span>&nbsp;<span class="op" id="2294498">=</span>&nbsp;<span class="op" id="2294500">-</span><span class="num" id="2294501">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294505">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294509"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294516">=</span>&nbsp;<span class="op" id="2294518">-</span><span class="ident" id="2294519"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2294522">(</span><span class="ident" id="2294523"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294528">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294539">var</span>&nbsp;<span class="ident" id="2294543">nadj</span>&nbsp;<span class="builtintype" id="2294548">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294557">if</span>&nbsp;<span class="ident" id="2294560"><a href="/gostd/math/lgamma.go.html#2294376">neg</a></span>&nbsp;<span class="op" id="2294564">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294568">if</span>&nbsp;<span class="ident" id="2294571"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294573">&gt;=</span>&nbsp;<span class="ident" id="2294576"><a href="/gostd/math/lgamma.go.html#2293722">Two52</a></span>&nbsp;<span class="op" id="2294582">{</span>&nbsp;<span class="comment" id="2294584">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294621"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294628">=</span>&nbsp;<span class="ident" id="2294630"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2294633">(</span><span class="num" id="2294634">1</span><span class="op" id="2294635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294640">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294653">t</span>&nbsp;<span class="op" id="2294655">:=</span>&nbsp;<span class="ident" id="2294658"><a href="/gostd/math/lgamma.go.html#2297222">sinPi</a></span><span class="op" id="2294663">(</span><span class="ident" id="2294664"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294665">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294669">if</span>&nbsp;<span class="ident" id="2294672"><a href="/gostd/math/lgamma.go.html#2294653">t</a></span>&nbsp;<span class="op" id="2294674">==</span>&nbsp;<span class="num" id="2294677">0</span>&nbsp;<span class="op" id="2294679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294684"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294691">=</span>&nbsp;<span class="ident" id="2294693"><a href="/gostd/math/bits.go.html#2211123">Inf</a></span><span class="op" id="2294696">(</span><span class="num" id="2294697">1</span><span class="op" id="2294698">)</span>&nbsp;<span class="comment" id="2294700">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294715">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294728"><a href="/gostd/math/lgamma.go.html#2294543">nadj</a></span>&nbsp;<span class="op" id="2294733">=</span>&nbsp;<span class="ident" id="2294735"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2294738">(</span><span class="ident" id="2294739"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2294742">/</span>&nbsp;<span class="ident" id="2294744"><a href="/gostd/math/abs.go.html#2199481">Abs</a></span><span class="op" id="2294747">(</span><span class="ident" id="2294748"><a href="/gostd/math/lgamma.go.html#2294653">t</a></span><span class="op" id="2294749">*</span><span class="ident" id="2294750"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294751">)</span><span class="op" id="2294752">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294756">if</span>&nbsp;<span class="ident" id="2294759"><a href="/gostd/math/lgamma.go.html#2294653">t</a></span>&nbsp;<span class="op" id="2294761">&lt;</span>&nbsp;<span class="num" id="2294763">0</span>&nbsp;<span class="op" id="2294765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294770"><a href="/gostd/math/lgamma.go.html#2293668">sign</a></span>&nbsp;<span class="op" id="2294775">=</span>&nbsp;<span class="op" id="2294777">-</span><span class="num" id="2294778">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2294785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294789">switch</span>&nbsp;<span class="op" id="2294796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294799">case</span>&nbsp;<span class="ident" id="2294804"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294806">==</span>&nbsp;<span class="num" id="2294809">1</span>&nbsp;<span class="op" id="2294811">||</span>&nbsp;<span class="ident" id="2294814"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294816">==</span>&nbsp;<span class="num" id="2294819">2</span><span class="op" id="2294820">:</span>&nbsp;<span class="comment" id="2294822">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294845"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294852">=</span>&nbsp;<span class="num" id="2294854">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294866">case</span>&nbsp;<span class="ident" id="2294871"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294873">&lt;</span>&nbsp;<span class="num" id="2294875">2</span><span class="op" id="2294876">:</span>&nbsp;<span class="comment" id="2294878">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294920">var</span>&nbsp;<span class="ident" id="2294924">y</span>&nbsp;<span class="builtintype" id="2294926">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294936">var</span>&nbsp;<span class="ident" id="2294940">i</span>&nbsp;<span class="builtintype" id="2294942">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294948">if</span>&nbsp;<span class="ident" id="2294951"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2294953">&lt;=</span>&nbsp;<span class="num" id="2294956">0.9</span>&nbsp;<span class="op" id="2294960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2294965"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2294972">=</span>&nbsp;<span class="op" id="2294974">-</span><span class="ident" id="2294975"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2294978">(</span><span class="ident" id="2294979"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2294980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294985">switch</span>&nbsp;<span class="op" id="2294992">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2294997">case</span>&nbsp;<span class="ident" id="2295002"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295004">&gt;=</span>&nbsp;<span class="op" id="2295007">(</span><span class="ident" id="2295008"><a href="/gostd/math/lgamma.go.html#2293691">Ymin</a></span>&nbsp;<span class="op" id="2295013">-</span>&nbsp;<span class="num" id="2295015">1</span>&nbsp;<span class="op" id="2295017">+</span>&nbsp;<span class="num" id="2295019">0.27</span><span class="op" id="2295023">)</span><span class="op" id="2295024">:</span>&nbsp;<span class="comment" id="2295026">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295053"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295055">=</span>&nbsp;<span class="num" id="2295057">1</span>&nbsp;<span class="op" id="2295059">-</span>&nbsp;<span class="ident" id="2295061"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295067"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295069">=</span>&nbsp;<span class="num" id="2295071">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295076">case</span>&nbsp;<span class="ident" id="2295081"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295083">&gt;=</span>&nbsp;<span class="op" id="2295086">(</span><span class="ident" id="2295087"><a href="/gostd/math/lgamma.go.html#2293691">Ymin</a></span>&nbsp;<span class="op" id="2295092">-</span>&nbsp;<span class="num" id="2295094">1</span>&nbsp;<span class="op" id="2295096">-</span>&nbsp;<span class="num" id="2295098">0.27</span><span class="op" id="2295102">)</span><span class="op" id="2295103">:</span>&nbsp;<span class="comment" id="2295105">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295133"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295135">=</span>&nbsp;<span class="ident" id="2295137"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295139">-</span>&nbsp;<span class="op" id="2295141">(</span><span class="ident" id="2295142"><a href="/gostd/math/lgamma.go.html#2294011">Tc</a></span>&nbsp;<span class="op" id="2295145">-</span>&nbsp;<span class="num" id="2295147">1</span><span class="op" id="2295148">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295154"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295156">=</span>&nbsp;<span class="num" id="2295158">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295163">default</span><span class="op" id="2295170">:</span>&nbsp;<span class="comment" id="2295172">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295194"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295196">=</span>&nbsp;<span class="ident" id="2295198"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295204"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295206">=</span>&nbsp;<span class="num" id="2295208">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2295213">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2295217">}</span>&nbsp;<span class="keyword" id="2295219">else</span>&nbsp;<span class="op" id="2295224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295229"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2295236">=</span>&nbsp;<span class="num" id="2295238">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295243">switch</span>&nbsp;<span class="op" id="2295250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295255">case</span>&nbsp;<span class="ident" id="2295260"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295262">&gt;=</span>&nbsp;<span class="op" id="2295265">(</span><span class="ident" id="2295266"><a href="/gostd/math/lgamma.go.html#2293691">Ymin</a></span>&nbsp;<span class="op" id="2295271">+</span>&nbsp;<span class="num" id="2295273">0.27</span><span class="op" id="2295277">)</span><span class="op" id="2295278">:</span>&nbsp;<span class="comment" id="2295280">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295303"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295305">=</span>&nbsp;<span class="num" id="2295307">2</span>&nbsp;<span class="op" id="2295309">-</span>&nbsp;<span class="ident" id="2295311"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295317"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295319">=</span>&nbsp;<span class="num" id="2295321">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295326">case</span>&nbsp;<span class="ident" id="2295331"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295333">&gt;=</span>&nbsp;<span class="op" id="2295336">(</span><span class="ident" id="2295337"><a href="/gostd/math/lgamma.go.html#2293691">Ymin</a></span>&nbsp;<span class="op" id="2295342">-</span>&nbsp;<span class="num" id="2295344">0.27</span><span class="op" id="2295348">)</span><span class="op" id="2295349">:</span>&nbsp;<span class="comment" id="2295351">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295379"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295381">=</span>&nbsp;<span class="ident" id="2295383"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295385">-</span>&nbsp;<span class="ident" id="2295387"><a href="/gostd/math/lgamma.go.html#2294011">Tc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295394"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295396">=</span>&nbsp;<span class="num" id="2295398">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295403">default</span><span class="op" id="2295410">:</span>&nbsp;<span class="comment" id="2295412">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295436"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295438">=</span>&nbsp;<span class="ident" id="2295440"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2295442">-</span>&nbsp;<span class="num" id="2295444">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295450"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295452">=</span>&nbsp;<span class="num" id="2295454">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2295459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2295463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295467">switch</span>&nbsp;<span class="ident" id="2295474"><a href="/gostd/math/lgamma.go.html#2294940">i</a></span>&nbsp;<span class="op" id="2295476">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295480">case</span>&nbsp;<span class="num" id="2295485">0</span><span class="op" id="2295486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295491">z</span>&nbsp;<span class="op" id="2295493">:=</span>&nbsp;<span class="ident" id="2295496"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295498">*</span>&nbsp;<span class="ident" id="2295500"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295505">p1</span>&nbsp;<span class="op" id="2295508">:=</span>&nbsp;<span class="ident" id="2295511"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295517">[</span><span class="num" id="2295518">0</span><span class="op" id="2295519">]</span>&nbsp;<span class="op" id="2295521">+</span>&nbsp;<span class="ident" id="2295523"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295524">*</span><span class="op" id="2295525">(</span><span class="ident" id="2295526"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295532">[</span><span class="num" id="2295533">2</span><span class="op" id="2295534">]</span><span class="op" id="2295535">+</span><span class="ident" id="2295536"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295537">*</span><span class="op" id="2295538">(</span><span class="ident" id="2295539"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295545">[</span><span class="num" id="2295546">4</span><span class="op" id="2295547">]</span><span class="op" id="2295548">+</span><span class="ident" id="2295549"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295550">*</span><span class="op" id="2295551">(</span><span class="ident" id="2295552"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295558">[</span><span class="num" id="2295559">6</span><span class="op" id="2295560">]</span><span class="op" id="2295561">+</span><span class="ident" id="2295562"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295563">*</span><span class="op" id="2295564">(</span><span class="ident" id="2295565"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295571">[</span><span class="num" id="2295572">8</span><span class="op" id="2295573">]</span><span class="op" id="2295574">+</span><span class="ident" id="2295575"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295576">*</span><span class="ident" id="2295577"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295583">[</span><span class="num" id="2295584">10</span><span class="op" id="2295586">]</span><span class="op" id="2295587">)</span><span class="op" id="2295588">)</span><span class="op" id="2295589">)</span><span class="op" id="2295590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295595">p2</span>&nbsp;<span class="op" id="2295598">:=</span>&nbsp;<span class="ident" id="2295601"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span>&nbsp;<span class="op" id="2295603">*</span>&nbsp;<span class="op" id="2295605">(</span><span class="ident" id="2295606"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295612">[</span><span class="num" id="2295613">1</span><span class="op" id="2295614">]</span>&nbsp;<span class="op" id="2295616">+</span>&nbsp;<span class="ident" id="2295618"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295619">*</span><span class="op" id="2295620">(</span><span class="op" id="2295621">+</span><span class="ident" id="2295622"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295628">[</span><span class="num" id="2295629">3</span><span class="op" id="2295630">]</span><span class="op" id="2295631">+</span><span class="ident" id="2295632"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295633">*</span><span class="op" id="2295634">(</span><span class="ident" id="2295635"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295641">[</span><span class="num" id="2295642">5</span><span class="op" id="2295643">]</span><span class="op" id="2295644">+</span><span class="ident" id="2295645"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295646">*</span><span class="op" id="2295647">(</span><span class="ident" id="2295648"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295654">[</span><span class="num" id="2295655">7</span><span class="op" id="2295656">]</span><span class="op" id="2295657">+</span><span class="ident" id="2295658"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295659">*</span><span class="op" id="2295660">(</span><span class="ident" id="2295661"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295667">[</span><span class="num" id="2295668">9</span><span class="op" id="2295669">]</span><span class="op" id="2295670">+</span><span class="ident" id="2295671"><a href="/gostd/math/lgamma.go.html#2295491">z</a></span><span class="op" id="2295672">*</span><span class="ident" id="2295673"><a href="/gostd/math/lgamma.go.html#2290196">_lgamA</a></span><span class="op" id="2295679">[</span><span class="num" id="2295680">11</span><span class="op" id="2295682">]</span><span class="op" id="2295683">)</span><span class="op" id="2295684">)</span><span class="op" id="2295685">)</span><span class="op" id="2295686">)</span><span class="op" id="2295687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295692">p</span>&nbsp;<span class="op" id="2295694">:=</span>&nbsp;<span class="ident" id="2295697"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2295698">*</span><span class="ident" id="2295699"><a href="/gostd/math/lgamma.go.html#2295505">p1</a></span>&nbsp;<span class="op" id="2295702">+</span>&nbsp;<span class="ident" id="2295704"><a href="/gostd/math/lgamma.go.html#2295595">p2</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295710"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2295717">+=</span>&nbsp;<span class="op" id="2295720">(</span><span class="ident" id="2295721"><a href="/gostd/math/lgamma.go.html#2295692">p</a></span>&nbsp;<span class="op" id="2295723">-</span>&nbsp;<span class="num" id="2295725">0.5</span><span class="op" id="2295728">*</span><span class="ident" id="2295729"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2295730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2295734">case</span>&nbsp;<span class="num" id="2295739">1</span><span class="op" id="2295740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295745">z</span>&nbsp;<span class="op" id="2295747">:=</span>&nbsp;<span class="ident" id="2295750"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2295752">*</span>&nbsp;<span class="ident" id="2295754"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295759">w</span>&nbsp;<span class="op" id="2295761">:=</span>&nbsp;<span class="ident" id="2295764"><a href="/gostd/math/lgamma.go.html#2295745">z</a></span>&nbsp;<span class="op" id="2295766">*</span>&nbsp;<span class="ident" id="2295768"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295773">p1</span>&nbsp;<span class="op" id="2295776">:=</span>&nbsp;<span class="ident" id="2295779"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295785">[</span><span class="num" id="2295786">0</span><span class="op" id="2295787">]</span>&nbsp;<span class="op" id="2295789">+</span>&nbsp;<span class="ident" id="2295791"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295792">*</span><span class="op" id="2295793">(</span><span class="ident" id="2295794"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295800">[</span><span class="num" id="2295801">3</span><span class="op" id="2295802">]</span><span class="op" id="2295803">+</span><span class="ident" id="2295804"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295805">*</span><span class="op" id="2295806">(</span><span class="ident" id="2295807"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295813">[</span><span class="num" id="2295814">6</span><span class="op" id="2295815">]</span><span class="op" id="2295816">+</span><span class="ident" id="2295817"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295818">*</span><span class="op" id="2295819">(</span><span class="ident" id="2295820"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295826">[</span><span class="num" id="2295827">9</span><span class="op" id="2295828">]</span><span class="op" id="2295829">+</span><span class="ident" id="2295830"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295831">*</span><span class="ident" id="2295832"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295838">[</span><span class="num" id="2295839">12</span><span class="op" id="2295841">]</span><span class="op" id="2295842">)</span><span class="op" id="2295843">)</span><span class="op" id="2295844">)</span>&nbsp;<span class="comment" id="2295846">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295866">p2</span>&nbsp;<span class="op" id="2295869">:=</span>&nbsp;<span class="ident" id="2295872"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295878">[</span><span class="num" id="2295879">1</span><span class="op" id="2295880">]</span>&nbsp;<span class="op" id="2295882">+</span>&nbsp;<span class="ident" id="2295884"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295885">*</span><span class="op" id="2295886">(</span><span class="ident" id="2295887"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295893">[</span><span class="num" id="2295894">4</span><span class="op" id="2295895">]</span><span class="op" id="2295896">+</span><span class="ident" id="2295897"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295898">*</span><span class="op" id="2295899">(</span><span class="ident" id="2295900"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295906">[</span><span class="num" id="2295907">7</span><span class="op" id="2295908">]</span><span class="op" id="2295909">+</span><span class="ident" id="2295910"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295911">*</span><span class="op" id="2295912">(</span><span class="ident" id="2295913"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295919">[</span><span class="num" id="2295920">10</span><span class="op" id="2295922">]</span><span class="op" id="2295923">+</span><span class="ident" id="2295924"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295925">*</span><span class="ident" id="2295926"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295932">[</span><span class="num" id="2295933">13</span><span class="op" id="2295935">]</span><span class="op" id="2295936">)</span><span class="op" id="2295937">)</span><span class="op" id="2295938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2295943">p3</span>&nbsp;<span class="op" id="2295946">:=</span>&nbsp;<span class="ident" id="2295949"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295955">[</span><span class="num" id="2295956">2</span><span class="op" id="2295957">]</span>&nbsp;<span class="op" id="2295959">+</span>&nbsp;<span class="ident" id="2295961"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295962">*</span><span class="op" id="2295963">(</span><span class="ident" id="2295964"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295970">[</span><span class="num" id="2295971">5</span><span class="op" id="2295972">]</span><span class="op" id="2295973">+</span><span class="ident" id="2295974"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295975">*</span><span class="op" id="2295976">(</span><span class="ident" id="2295977"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295983">[</span><span class="num" id="2295984">8</span><span class="op" id="2295985">]</span><span class="op" id="2295986">+</span><span class="ident" id="2295987"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2295988">*</span><span class="op" id="2295989">(</span><span class="ident" id="2295990"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2295996">[</span><span class="num" id="2295997">11</span><span class="op" id="2295999">]</span><span class="op" id="2296000">+</span><span class="ident" id="2296001"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2296002">*</span><span class="ident" id="2296003"><a href="/gostd/math/lgamma.go.html#2291586">_lgamT</a></span><span class="op" id="2296009">[</span><span class="num" id="2296010">14</span><span class="op" id="2296012">]</span><span class="op" id="2296013">)</span><span class="op" id="2296014">)</span><span class="op" id="2296015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296020">p</span>&nbsp;<span class="op" id="2296022">:=</span>&nbsp;<span class="ident" id="2296025"><a href="/gostd/math/lgamma.go.html#2295745">z</a></span><span class="op" id="2296026">*</span><span class="ident" id="2296027"><a href="/gostd/math/lgamma.go.html#2295773">p1</a></span>&nbsp;<span class="op" id="2296030">-</span>&nbsp;<span class="op" id="2296032">(</span><span class="ident" id="2296033"><a href="/gostd/math/lgamma.go.html#2294155">Tt</a></span>&nbsp;<span class="op" id="2296036">-</span>&nbsp;<span class="ident" id="2296038"><a href="/gostd/math/lgamma.go.html#2295759">w</a></span><span class="op" id="2296039">*</span><span class="op" id="2296040">(</span><span class="ident" id="2296041"><a href="/gostd/math/lgamma.go.html#2295866">p2</a></span><span class="op" id="2296043">+</span><span class="ident" id="2296044"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296045">*</span><span class="ident" id="2296046"><a href="/gostd/math/lgamma.go.html#2295943">p3</a></span><span class="op" id="2296048">)</span><span class="op" id="2296049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296054"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2296061">+=</span>&nbsp;<span class="op" id="2296064">(</span><span class="ident" id="2296065"><a href="/gostd/math/lgamma.go.html#2294071">Tf</a></span>&nbsp;<span class="op" id="2296068">+</span>&nbsp;<span class="ident" id="2296070"><a href="/gostd/math/lgamma.go.html#2296020">p</a></span><span class="op" id="2296071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296075">case</span>&nbsp;<span class="num" id="2296080">2</span><span class="op" id="2296081">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296086">p1</span>&nbsp;<span class="op" id="2296089">:=</span>&nbsp;<span class="ident" id="2296092"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2296094">*</span>&nbsp;<span class="op" id="2296096">(</span><span class="ident" id="2296097"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296103">[</span><span class="num" id="2296104">0</span><span class="op" id="2296105">]</span>&nbsp;<span class="op" id="2296107">+</span>&nbsp;<span class="ident" id="2296109"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296110">*</span><span class="op" id="2296111">(</span><span class="ident" id="2296112"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296118">[</span><span class="num" id="2296119">1</span><span class="op" id="2296120">]</span><span class="op" id="2296121">+</span><span class="ident" id="2296122"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296123">*</span><span class="op" id="2296124">(</span><span class="ident" id="2296125"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296131">[</span><span class="num" id="2296132">2</span><span class="op" id="2296133">]</span><span class="op" id="2296134">+</span><span class="ident" id="2296135"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296136">*</span><span class="op" id="2296137">(</span><span class="ident" id="2296138"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296144">[</span><span class="num" id="2296145">3</span><span class="op" id="2296146">]</span><span class="op" id="2296147">+</span><span class="ident" id="2296148"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296149">*</span><span class="op" id="2296150">(</span><span class="ident" id="2296151"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296157">[</span><span class="num" id="2296158">4</span><span class="op" id="2296159">]</span><span class="op" id="2296160">+</span><span class="ident" id="2296161"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296162">*</span><span class="ident" id="2296163"><a href="/gostd/math/lgamma.go.html#2292395">_lgamU</a></span><span class="op" id="2296169">[</span><span class="num" id="2296170">5</span><span class="op" id="2296171">]</span><span class="op" id="2296172">)</span><span class="op" id="2296173">)</span><span class="op" id="2296174">)</span><span class="op" id="2296175">)</span><span class="op" id="2296176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296181">p2</span>&nbsp;<span class="op" id="2296184">:=</span>&nbsp;<span class="num" id="2296187">1</span>&nbsp;<span class="op" id="2296189">+</span>&nbsp;<span class="ident" id="2296191"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296192">*</span><span class="op" id="2296193">(</span><span class="ident" id="2296194"><a href="/gostd/math/lgamma.go.html#2292736">_lgamV</a></span><span class="op" id="2296200">[</span><span class="num" id="2296201">1</span><span class="op" id="2296202">]</span><span class="op" id="2296203">+</span><span class="ident" id="2296204"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296205">*</span><span class="op" id="2296206">(</span><span class="ident" id="2296207"><a href="/gostd/math/lgamma.go.html#2292736">_lgamV</a></span><span class="op" id="2296213">[</span><span class="num" id="2296214">2</span><span class="op" id="2296215">]</span><span class="op" id="2296216">+</span><span class="ident" id="2296217"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296218">*</span><span class="op" id="2296219">(</span><span class="ident" id="2296220"><a href="/gostd/math/lgamma.go.html#2292736">_lgamV</a></span><span class="op" id="2296226">[</span><span class="num" id="2296227">3</span><span class="op" id="2296228">]</span><span class="op" id="2296229">+</span><span class="ident" id="2296230"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296231">*</span><span class="op" id="2296232">(</span><span class="ident" id="2296233"><a href="/gostd/math/lgamma.go.html#2292736">_lgamV</a></span><span class="op" id="2296239">[</span><span class="num" id="2296240">4</span><span class="op" id="2296241">]</span><span class="op" id="2296242">+</span><span class="ident" id="2296243"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span><span class="op" id="2296244">*</span><span class="ident" id="2296245"><a href="/gostd/math/lgamma.go.html#2292736">_lgamV</a></span><span class="op" id="2296251">[</span><span class="num" id="2296252">5</span><span class="op" id="2296253">]</span><span class="op" id="2296254">)</span><span class="op" id="2296255">)</span><span class="op" id="2296256">)</span><span class="op" id="2296257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296262"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2296269">+=</span>&nbsp;<span class="op" id="2296272">(</span><span class="op" id="2296273">-</span><span class="num" id="2296274">0.5</span><span class="op" id="2296277">*</span><span class="ident" id="2296278"><a href="/gostd/math/lgamma.go.html#2294924">y</a></span>&nbsp;<span class="op" id="2296280">+</span>&nbsp;<span class="ident" id="2296282"><a href="/gostd/math/lgamma.go.html#2296086">p1</a></span><span class="op" id="2296284">/</span><span class="ident" id="2296285"><a href="/gostd/math/lgamma.go.html#2296181">p2</a></span><span class="op" id="2296287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2296291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296294">case</span>&nbsp;<span class="ident" id="2296299"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2296301">&lt;</span>&nbsp;<span class="num" id="2296303">8</span><span class="op" id="2296304">:</span>&nbsp;<span class="comment" id="2296306">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296322">i</span>&nbsp;<span class="op" id="2296324">:=</span>&nbsp;<span class="builtintype" id="2296327">int</span><span class="op" id="2296330">(</span><span class="ident" id="2296331"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2296332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296336">y</span>&nbsp;<span class="op" id="2296338">:=</span>&nbsp;<span class="ident" id="2296341"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2296343">-</span>&nbsp;<span class="builtintype" id="2296345">float64</span><span class="op" id="2296352">(</span><span class="ident" id="2296353"><a href="/gostd/math/lgamma.go.html#2296322">i</a></span><span class="op" id="2296354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296358">p</span>&nbsp;<span class="op" id="2296360">:=</span>&nbsp;<span class="ident" id="2296363"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296365">*</span>&nbsp;<span class="op" id="2296367">(</span><span class="ident" id="2296368"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296374">[</span><span class="num" id="2296375">0</span><span class="op" id="2296376">]</span>&nbsp;<span class="op" id="2296378">+</span>&nbsp;<span class="ident" id="2296380"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296381">*</span><span class="op" id="2296382">(</span><span class="ident" id="2296383"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296389">[</span><span class="num" id="2296390">1</span><span class="op" id="2296391">]</span><span class="op" id="2296392">+</span><span class="ident" id="2296393"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296394">*</span><span class="op" id="2296395">(</span><span class="ident" id="2296396"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296402">[</span><span class="num" id="2296403">2</span><span class="op" id="2296404">]</span><span class="op" id="2296405">+</span><span class="ident" id="2296406"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296407">*</span><span class="op" id="2296408">(</span><span class="ident" id="2296409"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296415">[</span><span class="num" id="2296416">3</span><span class="op" id="2296417">]</span><span class="op" id="2296418">+</span><span class="ident" id="2296419"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296420">*</span><span class="op" id="2296421">(</span><span class="ident" id="2296422"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296428">[</span><span class="num" id="2296429">4</span><span class="op" id="2296430">]</span><span class="op" id="2296431">+</span><span class="ident" id="2296432"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296433">*</span><span class="op" id="2296434">(</span><span class="ident" id="2296435"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296441">[</span><span class="num" id="2296442">5</span><span class="op" id="2296443">]</span><span class="op" id="2296444">+</span><span class="ident" id="2296445"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296446">*</span><span class="ident" id="2296447"><a href="/gostd/math/lgamma.go.html#2291193">_lgamS</a></span><span class="op" id="2296453">[</span><span class="num" id="2296454">6</span><span class="op" id="2296455">]</span><span class="op" id="2296456">)</span><span class="op" id="2296457">)</span><span class="op" id="2296458">)</span><span class="op" id="2296459">)</span><span class="op" id="2296460">)</span><span class="op" id="2296461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296465">q</span>&nbsp;<span class="op" id="2296467">:=</span>&nbsp;<span class="num" id="2296470">1</span>&nbsp;<span class="op" id="2296472">+</span>&nbsp;<span class="ident" id="2296474"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296475">*</span><span class="op" id="2296476">(</span><span class="ident" id="2296477"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296483">[</span><span class="num" id="2296484">1</span><span class="op" id="2296485">]</span><span class="op" id="2296486">+</span><span class="ident" id="2296487"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296488">*</span><span class="op" id="2296489">(</span><span class="ident" id="2296490"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296496">[</span><span class="num" id="2296497">2</span><span class="op" id="2296498">]</span><span class="op" id="2296499">+</span><span class="ident" id="2296500"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296501">*</span><span class="op" id="2296502">(</span><span class="ident" id="2296503"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296509">[</span><span class="num" id="2296510">3</span><span class="op" id="2296511">]</span><span class="op" id="2296512">+</span><span class="ident" id="2296513"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296514">*</span><span class="op" id="2296515">(</span><span class="ident" id="2296516"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296522">[</span><span class="num" id="2296523">4</span><span class="op" id="2296524">]</span><span class="op" id="2296525">+</span><span class="ident" id="2296526"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296527">*</span><span class="op" id="2296528">(</span><span class="ident" id="2296529"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296535">[</span><span class="num" id="2296536">5</span><span class="op" id="2296537">]</span><span class="op" id="2296538">+</span><span class="ident" id="2296539"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span><span class="op" id="2296540">*</span><span class="ident" id="2296541"><a href="/gostd/math/lgamma.go.html#2290837">_lgamR</a></span><span class="op" id="2296547">[</span><span class="num" id="2296548">6</span><span class="op" id="2296549">]</span><span class="op" id="2296550">)</span><span class="op" id="2296551">)</span><span class="op" id="2296552">)</span><span class="op" id="2296553">)</span><span class="op" id="2296554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296558"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2296565">=</span>&nbsp;<span class="num" id="2296567">0.5</span><span class="op" id="2296570">*</span><span class="ident" id="2296571"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296573">+</span>&nbsp;<span class="ident" id="2296575"><a href="/gostd/math/lgamma.go.html#2296358">p</a></span><span class="op" id="2296576">/</span><span class="ident" id="2296577"><a href="/gostd/math/lgamma.go.html#2296465">q</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296581">z</span>&nbsp;<span class="op" id="2296583">:=</span>&nbsp;<span class="num" id="2296586">1.0</span>&nbsp;<span class="comment" id="2296590">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296628">switch</span>&nbsp;<span class="ident" id="2296635"><a href="/gostd/math/lgamma.go.html#2296322">i</a></span>&nbsp;<span class="op" id="2296637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296641">case</span>&nbsp;<span class="num" id="2296646">7</span><span class="op" id="2296647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296652"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span>&nbsp;<span class="op" id="2296654">*=</span>&nbsp;<span class="op" id="2296657">(</span><span class="ident" id="2296658"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296660">+</span>&nbsp;<span class="num" id="2296662">6</span><span class="op" id="2296663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296668">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296682">case</span>&nbsp;<span class="num" id="2296687">6</span><span class="op" id="2296688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296693"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span>&nbsp;<span class="op" id="2296695">*=</span>&nbsp;<span class="op" id="2296698">(</span><span class="ident" id="2296699"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296701">+</span>&nbsp;<span class="num" id="2296703">5</span><span class="op" id="2296704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296709">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296723">case</span>&nbsp;<span class="num" id="2296728">5</span><span class="op" id="2296729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296734"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span>&nbsp;<span class="op" id="2296736">*=</span>&nbsp;<span class="op" id="2296739">(</span><span class="ident" id="2296740"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296742">+</span>&nbsp;<span class="num" id="2296744">4</span><span class="op" id="2296745">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296750">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296764">case</span>&nbsp;<span class="num" id="2296769">4</span><span class="op" id="2296770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296775"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span>&nbsp;<span class="op" id="2296777">*=</span>&nbsp;<span class="op" id="2296780">(</span><span class="ident" id="2296781"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296783">+</span>&nbsp;<span class="num" id="2296785">3</span><span class="op" id="2296786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296791">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296805">case</span>&nbsp;<span class="num" id="2296810">3</span><span class="op" id="2296811">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296816"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span>&nbsp;<span class="op" id="2296818">*=</span>&nbsp;<span class="op" id="2296821">(</span><span class="ident" id="2296822"><a href="/gostd/math/lgamma.go.html#2296336">y</a></span>&nbsp;<span class="op" id="2296824">+</span>&nbsp;<span class="num" id="2296826">2</span><span class="op" id="2296827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296832"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2296839">+=</span>&nbsp;<span class="ident" id="2296842"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2296845">(</span><span class="ident" id="2296846"><a href="/gostd/math/lgamma.go.html#2296581">z</a></span><span class="op" id="2296847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2296851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2296854">case</span>&nbsp;<span class="ident" id="2296859"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2296861">&lt;</span>&nbsp;<span class="ident" id="2296863"><a href="/gostd/math/lgamma.go.html#2293866">Two58</a></span><span class="op" id="2296868">:</span>&nbsp;<span class="comment" id="2296870">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296890">t</span>&nbsp;<span class="op" id="2296892">:=</span>&nbsp;<span class="ident" id="2296895"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2296898">(</span><span class="ident" id="2296899"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2296900">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296904">z</span>&nbsp;<span class="op" id="2296906">:=</span>&nbsp;<span class="num" id="2296909">1</span>&nbsp;<span class="op" id="2296911">/</span>&nbsp;<span class="ident" id="2296913"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296917">y</span>&nbsp;<span class="op" id="2296919">:=</span>&nbsp;<span class="ident" id="2296922"><a href="/gostd/math/lgamma.go.html#2296904">z</a></span>&nbsp;<span class="op" id="2296924">*</span>&nbsp;<span class="ident" id="2296926"><a href="/gostd/math/lgamma.go.html#2296904">z</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2296930">w</span>&nbsp;<span class="op" id="2296932">:=</span>&nbsp;<span class="ident" id="2296935"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2296941">[</span><span class="num" id="2296942">0</span><span class="op" id="2296943">]</span>&nbsp;<span class="op" id="2296945">+</span>&nbsp;<span class="ident" id="2296947"><a href="/gostd/math/lgamma.go.html#2296904">z</a></span><span class="op" id="2296948">*</span><span class="op" id="2296949">(</span><span class="ident" id="2296950"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2296956">[</span><span class="num" id="2296957">1</span><span class="op" id="2296958">]</span><span class="op" id="2296959">+</span><span class="ident" id="2296960"><a href="/gostd/math/lgamma.go.html#2296917">y</a></span><span class="op" id="2296961">*</span><span class="op" id="2296962">(</span><span class="ident" id="2296963"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2296969">[</span><span class="num" id="2296970">2</span><span class="op" id="2296971">]</span><span class="op" id="2296972">+</span><span class="ident" id="2296973"><a href="/gostd/math/lgamma.go.html#2296917">y</a></span><span class="op" id="2296974">*</span><span class="op" id="2296975">(</span><span class="ident" id="2296976"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2296982">[</span><span class="num" id="2296983">3</span><span class="op" id="2296984">]</span><span class="op" id="2296985">+</span><span class="ident" id="2296986"><a href="/gostd/math/lgamma.go.html#2296917">y</a></span><span class="op" id="2296987">*</span><span class="op" id="2296988">(</span><span class="ident" id="2296989"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2296995">[</span><span class="num" id="2296996">4</span><span class="op" id="2296997">]</span><span class="op" id="2296998">+</span><span class="ident" id="2296999"><a href="/gostd/math/lgamma.go.html#2296917">y</a></span><span class="op" id="2297000">*</span><span class="op" id="2297001">(</span><span class="ident" id="2297002"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2297008">[</span><span class="num" id="2297009">5</span><span class="op" id="2297010">]</span><span class="op" id="2297011">+</span><span class="ident" id="2297012"><a href="/gostd/math/lgamma.go.html#2296917">y</a></span><span class="op" id="2297013">*</span><span class="ident" id="2297014"><a href="/gostd/math/lgamma.go.html#2293026">_lgamW</a></span><span class="op" id="2297020">[</span><span class="num" id="2297021">6</span><span class="op" id="2297022">]</span><span class="op" id="2297023">)</span><span class="op" id="2297024">)</span><span class="op" id="2297025">)</span><span class="op" id="2297026">)</span><span class="op" id="2297027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297031"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2297038">=</span>&nbsp;<span class="op" id="2297040">(</span><span class="ident" id="2297041"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2297042">-</span><span class="num" id="2297043">0.5</span><span class="op" id="2297046">)</span><span class="op" id="2297047">*</span><span class="op" id="2297048">(</span><span class="ident" id="2297049"><a href="/gostd/math/lgamma.go.html#2296890">t</a></span><span class="op" id="2297050">-</span><span class="num" id="2297051">1</span><span class="op" id="2297052">)</span>&nbsp;<span class="op" id="2297054">+</span>&nbsp;<span class="ident" id="2297056"><a href="/gostd/math/lgamma.go.html#2296930">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297059">default</span><span class="op" id="2297066">:</span>&nbsp;<span class="comment" id="2297068">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297091"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2297098">=</span>&nbsp;<span class="ident" id="2297100"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span>&nbsp;<span class="op" id="2297102">*</span>&nbsp;<span class="op" id="2297104">(</span><span class="ident" id="2297105"><a href="/gostd/math/log.go.html#2300722">Log</a></span><span class="op" id="2297108">(</span><span class="ident" id="2297109"><a href="/gostd/math/lgamma.go.html#2293640">x</a></span><span class="op" id="2297110">)</span>&nbsp;<span class="op" id="2297112">-</span>&nbsp;<span class="num" id="2297114">1</span><span class="op" id="2297115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297121">if</span>&nbsp;<span class="ident" id="2297124"><a href="/gostd/math/lgamma.go.html#2294376">neg</a></span>&nbsp;<span class="op" id="2297128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297132"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span>&nbsp;<span class="op" id="2297139">=</span>&nbsp;<span class="ident" id="2297141"><a href="/gostd/math/lgamma.go.html#2294543">nadj</a></span>&nbsp;<span class="op" id="2297146">-</span>&nbsp;<span class="ident" id="2297148"><a href="/gostd/math/lgamma.go.html#2293652">lgamma</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297156">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297159">return</span><br>
<span class="lineno"></span><span class="op" id="2297166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2297169">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2297217">func</span>&nbsp;<span class="ident" id="2297222">sinPi</span><span class="op" id="2297227">(</span><span class="ident" id="2297228">x</span>&nbsp;<span class="builtintype" id="2297230">float64</span><span class="op" id="2297237">)</span>&nbsp;<span class="builtintype" id="2297239">float64</span>&nbsp;<span class="op" id="2297247">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297250">const</span>&nbsp;<span class="op" id="2297256">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297260">Two52</span>&nbsp;<span class="op" id="2297266">=</span>&nbsp;<span class="num" id="2297268">1</span>&nbsp;<span class="op" id="2297270">&lt;&lt;</span>&nbsp;<span class="num" id="2297273">52</span>&nbsp;<span class="comment" id="2297276">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297312">Two53</span>&nbsp;<span class="op" id="2297318">=</span>&nbsp;<span class="num" id="2297320">1</span>&nbsp;<span class="op" id="2297322">&lt;&lt;</span>&nbsp;<span class="num" id="2297325">53</span>&nbsp;<span class="comment" id="2297328">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297366">if</span>&nbsp;<span class="ident" id="2297369"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297371">&lt;</span>&nbsp;<span class="num" id="2297373">0.25</span>&nbsp;<span class="op" id="2297378">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297382">return</span>&nbsp;<span class="op" id="2297389">-</span><span class="ident" id="2297390"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2297393">(</span><span class="ident" id="2297394"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297397">*</span>&nbsp;<span class="ident" id="2297399"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2297407">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297430">z</span>&nbsp;<span class="op" id="2297432">:=</span>&nbsp;<span class="ident" id="2297435"><a href="/gostd/math/floor.go.html#2243355">Floor</a></span><span class="op" id="2297440">(</span><span class="ident" id="2297441"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297442">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297445">var</span>&nbsp;<span class="ident" id="2297449">n</span>&nbsp;<span class="builtintype" id="2297451">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297456">if</span>&nbsp;<span class="ident" id="2297459"><a href="/gostd/math/lgamma.go.html#2297430">z</a></span>&nbsp;<span class="op" id="2297461">!=</span>&nbsp;<span class="ident" id="2297464"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297466">{</span>&nbsp;<span class="comment" id="2297468">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297481"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297483">=</span>&nbsp;<span class="ident" id="2297485"><a href="/gostd/math/mod.go.html#2310349">Mod</a></span><span class="op" id="2297488">(</span><span class="ident" id="2297489"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297490">,</span>&nbsp;<span class="num" id="2297492">2</span><span class="op" id="2297493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297497"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span>&nbsp;<span class="op" id="2297499">=</span>&nbsp;<span class="builtintype" id="2297501">int</span><span class="op" id="2297504">(</span><span class="ident" id="2297505"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297507">*</span>&nbsp;<span class="num" id="2297509">4</span><span class="op" id="2297510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297513">}</span>&nbsp;<span class="keyword" id="2297515">else</span>&nbsp;<span class="op" id="2297520">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297524">if</span>&nbsp;<span class="ident" id="2297527"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297529">&gt;=</span>&nbsp;<span class="ident" id="2297532"><a href="/gostd/math/lgamma.go.html#2297312">Two53</a></span>&nbsp;<span class="op" id="2297538">{</span>&nbsp;<span class="comment" id="2297540">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297561"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297563">=</span>&nbsp;<span class="num" id="2297565">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297570"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span>&nbsp;<span class="op" id="2297572">=</span>&nbsp;<span class="num" id="2297574">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297578">}</span>&nbsp;<span class="keyword" id="2297580">else</span>&nbsp;<span class="op" id="2297585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297590">if</span>&nbsp;<span class="ident" id="2297593"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297595">&lt;</span>&nbsp;<span class="ident" id="2297597"><a href="/gostd/math/lgamma.go.html#2297260">Two52</a></span>&nbsp;<span class="op" id="2297603">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297609"><a href="/gostd/math/lgamma.go.html#2297430">z</a></span>&nbsp;<span class="op" id="2297611">=</span>&nbsp;<span class="ident" id="2297613"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297615">+</span>&nbsp;<span class="ident" id="2297617"><a href="/gostd/math/lgamma.go.html#2297260">Two52</a></span>&nbsp;<span class="comment" id="2297623">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297640"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span>&nbsp;<span class="op" id="2297642">=</span>&nbsp;<span class="builtintype" id="2297644">int</span><span class="op" id="2297647">(</span><span class="num" id="2297648">1</span>&nbsp;<span class="op" id="2297650">&amp;</span>&nbsp;<span class="ident" id="2297652"><a href="/gostd/math/unsafe.go.html#2340061">Float64bits</a></span><span class="op" id="2297663">(</span><span class="ident" id="2297664"><a href="/gostd/math/lgamma.go.html#2297430">z</a></span><span class="op" id="2297665">)</span><span class="op" id="2297666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297671"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297673">=</span>&nbsp;<span class="builtintype" id="2297675">float64</span><span class="op" id="2297682">(</span><span class="ident" id="2297683"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span><span class="op" id="2297684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297689"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span>&nbsp;<span class="op" id="2297691">&lt;&lt;=</span>&nbsp;<span class="num" id="2297695">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297705">switch</span>&nbsp;<span class="ident" id="2297712"><a href="/gostd/math/lgamma.go.html#2297449">n</a></span>&nbsp;<span class="op" id="2297714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297717">case</span>&nbsp;<span class="num" id="2297722">0</span><span class="op" id="2297723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297727"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297729">=</span>&nbsp;<span class="ident" id="2297731"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2297734">(</span><span class="ident" id="2297735"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297738">*</span>&nbsp;<span class="ident" id="2297740"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297741">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297744">case</span>&nbsp;<span class="num" id="2297749">1</span><span class="op" id="2297750">,</span>&nbsp;<span class="num" id="2297752">2</span><span class="op" id="2297753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297757"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297759">=</span>&nbsp;<span class="ident" id="2297761"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2297764">(</span><span class="ident" id="2297765"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297768">*</span>&nbsp;<span class="op" id="2297770">(</span><span class="num" id="2297771">0.5</span>&nbsp;<span class="op" id="2297775">-</span>&nbsp;<span class="ident" id="2297777"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297778">)</span><span class="op" id="2297779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297782">case</span>&nbsp;<span class="num" id="2297787">3</span><span class="op" id="2297788">,</span>&nbsp;<span class="num" id="2297790">4</span><span class="op" id="2297791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297795"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297797">=</span>&nbsp;<span class="ident" id="2297799"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2297802">(</span><span class="ident" id="2297803"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297806">*</span>&nbsp;<span class="op" id="2297808">(</span><span class="num" id="2297809">1</span>&nbsp;<span class="op" id="2297811">-</span>&nbsp;<span class="ident" id="2297813"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><span class="op" id="2297814">)</span><span class="op" id="2297815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297818">case</span>&nbsp;<span class="num" id="2297823">5</span><span class="op" id="2297824">,</span>&nbsp;<span class="num" id="2297826">6</span><span class="op" id="2297827">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297831"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297833">=</span>&nbsp;<span class="op" id="2297835">-</span><span class="ident" id="2297836"><a href="/gostd/math/sin.go.html#2322210">Cos</a></span><span class="op" id="2297839">(</span><span class="ident" id="2297840"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297843">*</span>&nbsp;<span class="op" id="2297845">(</span><span class="ident" id="2297846"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297848">-</span>&nbsp;<span class="num" id="2297850">1.5</span><span class="op" id="2297853">)</span><span class="op" id="2297854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297857">default</span><span class="op" id="2297864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2297868"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297870">=</span>&nbsp;<span class="ident" id="2297872"><a href="/gostd/math/sin.go.html#2323604">Sin</a></span><span class="op" id="2297875">(</span><span class="ident" id="2297876"><a href="/gostd/math/const.go.html#2214581">Pi</a></span>&nbsp;<span class="op" id="2297879">*</span>&nbsp;<span class="op" id="2297881">(</span><span class="ident" id="2297882"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span>&nbsp;<span class="op" id="2297884">-</span>&nbsp;<span class="num" id="2297886">2</span><span class="op" id="2297887">)</span><span class="op" id="2297888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2297891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2297894">return</span>&nbsp;<span class="op" id="2297901">-</span><span class="ident" id="2297902"><a href="/gostd/math/lgamma.go.html#2297228">x</a></span><br>
<span class="lineno">365</span><span class="op" id="2297904">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
