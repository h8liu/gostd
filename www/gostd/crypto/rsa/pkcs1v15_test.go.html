<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8055916">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8055971">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8056025">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8056076">package</span>&nbsp;<span class="ident" id="8056084">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8056089">import</span>&nbsp;<span class="op" id="8056096">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056099">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056108">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056118">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056133">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056148">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056167">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056183">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056189">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056201">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056212">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8056228">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8056231">func</span>&nbsp;<span class="ident" id="8056236">decodeBase64</span><span class="op" id="8056248">(</span><span class="ident" id="8056249">in</span>&nbsp;<span class="builtintype" id="8056252">string</span><span class="op" id="8056258">)</span>&nbsp;<span class="op" id="8056260">[</span><span class="op" id="8056261">]</span><span class="builtintype" id="8056262">byte</span>&nbsp;<span class="op" id="8056267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8056270">out</span>&nbsp;<span class="op" id="8056274">:=</span>&nbsp;<span class="builtinfunc" id="8056277">make</span><span class="op" id="8056281">(</span><span class="op" id="8056282">[</span><span class="op" id="8056283">]</span><span class="builtintype" id="8056284">byte</span><span class="op" id="8056288">,</span>&nbsp;<span class="ident" id="8056290">base64</span><span class="op" id="8056296">.</span><span class="ident" id="8056297">StdEncoding</span><span class="op" id="8056308">.</span><span class="ident" id="8056309">DecodedLen</span><span class="op" id="8056319">(</span><span class="builtinfunc" id="8056320">len</span><span class="op" id="8056323">(</span><span class="ident" id="8056324">in</span><span class="op" id="8056326">)</span><span class="op" id="8056327">)</span><span class="op" id="8056328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8056331">n</span><span class="op" id="8056332">,</span>&nbsp;<span class="ident" id="8056334">err</span>&nbsp;<span class="op" id="8056338">:=</span>&nbsp;<span class="ident" id="8056341">base64</span><span class="op" id="8056347">.</span><span class="ident" id="8056348">StdEncoding</span><span class="op" id="8056359">.</span><span class="ident" id="8056360">Decode</span><span class="op" id="8056366">(</span><span class="ident" id="8056367">out</span><span class="op" id="8056370">,</span>&nbsp;<span class="op" id="8056372">[</span><span class="op" id="8056373">]</span><span class="builtintype" id="8056374">byte</span><span class="op" id="8056378">(</span><span class="ident" id="8056379">in</span><span class="op" id="8056381">)</span><span class="op" id="8056382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8056385">if</span>&nbsp;<span class="ident" id="8056388">err</span>&nbsp;<span class="op" id="8056392">!=</span>&nbsp;<span class="ident" id="8056395">nil</span>&nbsp;<span class="op" id="8056399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8056403">return</span>&nbsp;<span class="ident" id="8056410">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8056418">return</span>&nbsp;<span class="ident" id="8056425">out</span><span class="op" id="8056428">[</span><span class="num" id="8056429">0</span><span class="op" id="8056430">:</span><span class="ident" id="8056431">n</span><span class="op" id="8056432">]</span><br>
<span class="lineno"></span><span class="op" id="8056434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8056437">type</span>&nbsp;<span class="ident" id="8056442">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8056462">struct</span>&nbsp;<span class="op" id="8056469">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8056472">in</span><span class="op" id="8056474">,</span>&nbsp;<span class="ident" id="8056476">out</span>&nbsp;<span class="builtintype" id="8056480">string</span><br>
<span class="lineno"></span><span class="op" id="8056487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8056490">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8056564">var</span>&nbsp;<span class="ident" id="8056568">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8056589">=</span>&nbsp;<span class="op" id="8056591">[</span><span class="op" id="8056592">]</span><span class="ident" id="8056593">DecryptPKCS1v15Test</span><span class="op" id="8056612">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056619">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8056709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056713">&#34;x&#34;</span><span class="op" id="8056716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056719">}</span><span class="op" id="8056720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056723">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056727">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8056817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056821">&#34;testing.&#34;</span><span class="op" id="8056831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056834">}</span><span class="op" id="8056835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056842">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8056932">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056936">&#34;testing.\n&#34;</span><span class="op" id="8056948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056951">}</span><span class="op" id="8056952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8056955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8056959">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8057049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8057053">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8057108">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057111">}</span><span class="op" id="8057112">,</span><br>
<span class="lineno"></span><span class="op" id="8057114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8057117">func</span>&nbsp;<span class="ident" id="8057122">TestDecryptPKCS1v15</span><span class="op" id="8057141">(</span><span class="ident" id="8057142">t</span>&nbsp;<span class="op" id="8057144">*</span><span class="ident" id="8057145">testing</span><span class="op" id="8057152">.</span><span class="ident" id="8057153">T</span><span class="op" id="8057154">)</span>&nbsp;<span class="op" id="8057156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057159">for</span>&nbsp;<span class="ident" id="8057163">i</span><span class="op" id="8057164">,</span>&nbsp;<span class="ident" id="8057166">test</span>&nbsp;<span class="op" id="8057171">:=</span>&nbsp;<span class="keyword" id="8057174">range</span>&nbsp;<span class="ident" id="8057180">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8057201">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057205">out</span><span class="op" id="8057208">,</span>&nbsp;<span class="ident" id="8057210">err</span>&nbsp;<span class="op" id="8057214">:=</span>&nbsp;<span class="ident" id="8057217">DecryptPKCS1v15</span><span class="op" id="8057232">(</span><span class="ident" id="8057233">nil</span><span class="op" id="8057236">,</span>&nbsp;<span class="ident" id="8057238">rsaPrivateKey</span><span class="op" id="8057251">,</span>&nbsp;<span class="ident" id="8057253">decodeBase64</span><span class="op" id="8057265">(</span><span class="ident" id="8057266">test</span><span class="op" id="8057270">.</span><span class="ident" id="8057271">in</span><span class="op" id="8057273">)</span><span class="op" id="8057274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057278">if</span>&nbsp;<span class="ident" id="8057281">err</span>&nbsp;<span class="op" id="8057285">!=</span>&nbsp;<span class="ident" id="8057288">nil</span>&nbsp;<span class="op" id="8057292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057297">t</span><span class="op" id="8057298">.</span><span class="ident" id="8057299">Errorf</span><span class="op" id="8057305">(</span><span class="string" id="8057306">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8057328">,</span>&nbsp;<span class="ident" id="8057330">i</span><span class="op" id="8057331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057339">want</span>&nbsp;<span class="op" id="8057344">:=</span>&nbsp;<span class="op" id="8057347">[</span><span class="op" id="8057348">]</span><span class="builtintype" id="8057349">byte</span><span class="op" id="8057353">(</span><span class="ident" id="8057354">test</span><span class="op" id="8057358">.</span><span class="ident" id="8057359">out</span><span class="op" id="8057362">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057366">if</span>&nbsp;<span class="op" id="8057369">!</span><span class="ident" id="8057370">bytes</span><span class="op" id="8057375">.</span><span class="ident" id="8057376">Equal</span><span class="op" id="8057381">(</span><span class="ident" id="8057382">out</span><span class="op" id="8057385">,</span>&nbsp;<span class="ident" id="8057387">want</span><span class="op" id="8057391">)</span>&nbsp;<span class="op" id="8057393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057398">t</span><span class="op" id="8057399">.</span><span class="ident" id="8057400">Errorf</span><span class="op" id="8057406">(</span><span class="string" id="8057407">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8057429">,</span>&nbsp;<span class="ident" id="8057431">i</span><span class="op" id="8057432">,</span>&nbsp;<span class="ident" id="8057434">out</span><span class="op" id="8057437">,</span>&nbsp;<span class="ident" id="8057439">want</span><span class="op" id="8057443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057450">}</span><br>
<span class="lineno"></span><span class="op" id="8057452">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8057455">func</span>&nbsp;<span class="ident" id="8057460">TestEncryptPKCS1v15</span><span class="op" id="8057479">(</span><span class="ident" id="8057480">t</span>&nbsp;<span class="op" id="8057482">*</span><span class="ident" id="8057483">testing</span><span class="op" id="8057490">.</span><span class="ident" id="8057491">T</span><span class="op" id="8057492">)</span>&nbsp;<span class="op" id="8057494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057497">random</span>&nbsp;<span class="op" id="8057504">:=</span>&nbsp;<span class="ident" id="8057507">rand</span><span class="op" id="8057511">.</span><span class="ident" id="8057512">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057520">k</span>&nbsp;<span class="op" id="8057522">:=</span>&nbsp;<span class="op" id="8057525">(</span><span class="ident" id="8057526">rsaPrivateKey</span><span class="op" id="8057539">.</span><span class="ident" id="8057540">N</span><span class="op" id="8057541">.</span><span class="ident" id="8057542">BitLen</span><span class="op" id="8057548">(</span><span class="op" id="8057549">)</span>&nbsp;<span class="op" id="8057551">+</span>&nbsp;<span class="num" id="8057553">7</span><span class="op" id="8057554">)</span>&nbsp;<span class="op" id="8057556">/</span>&nbsp;<span class="num" id="8057558">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057562">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8057580">:=</span>&nbsp;<span class="keyword" id="8057583">func</span><span class="op" id="8057587">(</span><span class="ident" id="8057588">in</span>&nbsp;<span class="op" id="8057591">[</span><span class="op" id="8057592">]</span><span class="builtintype" id="8057593">byte</span><span class="op" id="8057597">,</span>&nbsp;<span class="ident" id="8057599">blind</span>&nbsp;<span class="builtintype" id="8057605">bool</span><span class="op" id="8057609">)</span>&nbsp;<span class="builtintype" id="8057611">bool</span>&nbsp;<span class="op" id="8057616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057620">if</span>&nbsp;<span class="builtinfunc" id="8057623">len</span><span class="op" id="8057626">(</span><span class="ident" id="8057627">in</span><span class="op" id="8057629">)</span>&nbsp;<span class="op" id="8057631">&gt;</span>&nbsp;<span class="ident" id="8057633">k</span><span class="op" id="8057634">-</span><span class="num" id="8057635">11</span>&nbsp;<span class="op" id="8057638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057643">in</span>&nbsp;<span class="op" id="8057646">=</span>&nbsp;<span class="ident" id="8057648">in</span><span class="op" id="8057650">[</span><span class="num" id="8057651">0</span>&nbsp;<span class="op" id="8057653">:</span>&nbsp;<span class="ident" id="8057655">k</span><span class="op" id="8057656">-</span><span class="num" id="8057657">11</span><span class="op" id="8057659">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057668">ciphertext</span><span class="op" id="8057678">,</span>&nbsp;<span class="ident" id="8057680">err</span>&nbsp;<span class="op" id="8057684">:=</span>&nbsp;<span class="ident" id="8057687">EncryptPKCS1v15</span><span class="op" id="8057702">(</span><span class="ident" id="8057703">random</span><span class="op" id="8057709">,</span>&nbsp;<span class="op" id="8057711">&amp;</span><span class="ident" id="8057712">rsaPrivateKey</span><span class="op" id="8057725">.</span><span class="ident" id="8057726">PublicKey</span><span class="op" id="8057735">,</span>&nbsp;<span class="ident" id="8057737">in</span><span class="op" id="8057739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057743">if</span>&nbsp;<span class="ident" id="8057746">err</span>&nbsp;<span class="op" id="8057750">!=</span>&nbsp;<span class="ident" id="8057753">nil</span>&nbsp;<span class="op" id="8057757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057762">t</span><span class="op" id="8057763">.</span><span class="ident" id="8057764">Errorf</span><span class="op" id="8057770">(</span><span class="string" id="8057771">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8057793">,</span>&nbsp;<span class="ident" id="8057795">err</span><span class="op" id="8057798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057803">return</span>&nbsp;<span class="builtintype" id="8057810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057818">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057823">var</span>&nbsp;<span class="ident" id="8057827">rand</span>&nbsp;<span class="ident" id="8057832">io</span><span class="op" id="8057834">.</span><span class="ident" id="8057835">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057844">if</span>&nbsp;<span class="op" id="8057847">!</span><span class="ident" id="8057848">blind</span>&nbsp;<span class="op" id="8057854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057859">rand</span>&nbsp;<span class="op" id="8057864">=</span>&nbsp;<span class="ident" id="8057866">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057872">}</span>&nbsp;<span class="keyword" id="8057874">else</span>&nbsp;<span class="op" id="8057879">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057884">rand</span>&nbsp;<span class="op" id="8057889">=</span>&nbsp;<span class="ident" id="8057891">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8057900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057904">plaintext</span><span class="op" id="8057913">,</span>&nbsp;<span class="ident" id="8057915">err</span>&nbsp;<span class="op" id="8057919">:=</span>&nbsp;<span class="ident" id="8057922">DecryptPKCS1v15</span><span class="op" id="8057937">(</span><span class="ident" id="8057938">rand</span><span class="op" id="8057942">,</span>&nbsp;<span class="ident" id="8057944">rsaPrivateKey</span><span class="op" id="8057957">,</span>&nbsp;<span class="ident" id="8057959">ciphertext</span><span class="op" id="8057969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8057973">if</span>&nbsp;<span class="ident" id="8057976">err</span>&nbsp;<span class="op" id="8057980">!=</span>&nbsp;<span class="ident" id="8057983">nil</span>&nbsp;<span class="op" id="8057987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8057992">t</span><span class="op" id="8057993">.</span><span class="ident" id="8057994">Errorf</span><span class="op" id="8058000">(</span><span class="string" id="8058001">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8058023">,</span>&nbsp;<span class="ident" id="8058025">err</span><span class="op" id="8058028">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058033">return</span>&nbsp;<span class="builtintype" id="8058040">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058053">if</span>&nbsp;<span class="op" id="8058056">!</span><span class="ident" id="8058057">bytes</span><span class="op" id="8058062">.</span><span class="ident" id="8058063">Equal</span><span class="op" id="8058068">(</span><span class="ident" id="8058069">plaintext</span><span class="op" id="8058078">,</span>&nbsp;<span class="ident" id="8058080">in</span><span class="op" id="8058082">)</span>&nbsp;<span class="op" id="8058084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8058089">t</span><span class="op" id="8058090">.</span><span class="ident" id="8058091">Errorf</span><span class="op" id="8058097">(</span><span class="string" id="8058098">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8058124">,</span>&nbsp;<span class="ident" id="8058126">plaintext</span><span class="op" id="8058135">,</span>&nbsp;<span class="ident" id="8058137">in</span><span class="op" id="8058139">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058144">return</span>&nbsp;<span class="builtintype" id="8058151">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058163">return</span>&nbsp;<span class="builtintype" id="8058170">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8058180">config</span>&nbsp;<span class="op" id="8058187">:=</span>&nbsp;<span class="builtinfunc" id="8058190">new</span><span class="op" id="8058193">(</span><span class="ident" id="8058194">quick</span><span class="op" id="8058199">.</span><span class="ident" id="8058200">Config</span><span class="op" id="8058206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058209">if</span>&nbsp;<span class="ident" id="8058212">testing</span><span class="op" id="8058219">.</span><span class="ident" id="8058220">Short</span><span class="op" id="8058225">(</span><span class="op" id="8058226">)</span>&nbsp;<span class="op" id="8058228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8058232">config</span><span class="op" id="8058238">.</span><span class="ident" id="8058239">MaxCount</span>&nbsp;<span class="op" id="8058248">=</span>&nbsp;<span class="num" id="8058250">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8058257">quick</span><span class="op" id="8058262">.</span><span class="ident" id="8058263">Check</span><span class="op" id="8058268">(</span><span class="ident" id="8058269">tryEncryptDecrypt</span><span class="op" id="8058286">,</span>&nbsp;<span class="ident" id="8058288">config</span><span class="op" id="8058294">)</span><br>
<span class="lineno">105</span><span class="op" id="8058296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8058299">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8058373">var</span>&nbsp;<span class="ident" id="8058377">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8058408">=</span>&nbsp;<span class="op" id="8058410">[</span><span class="op" id="8058411">]</span><span class="ident" id="8058412">DecryptPKCS1v15Test</span><span class="op" id="8058431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058434">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058438">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8058528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058532">&#34;1234&#34;</span><span class="op" id="8058538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058541">}</span><span class="op" id="8058542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058549">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8058639">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058643">&#34;FAIL&#34;</span><span class="op" id="8058649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058652">}</span><span class="op" id="8058653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058660">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8058750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058754">&#34;abcd&#34;</span><span class="op" id="8058760">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058763">}</span><span class="op" id="8058764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058771">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8058861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8058865">&#34;FAIL&#34;</span><span class="op" id="8058871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8058874">}</span><span class="op" id="8058875">,</span><br>
<span class="lineno">125</span><span class="op" id="8058877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8058880">func</span>&nbsp;<span class="ident" id="8058885">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8058914">(</span><span class="ident" id="8058915">t</span>&nbsp;<span class="op" id="8058917">*</span><span class="ident" id="8058918">testing</span><span class="op" id="8058925">.</span><span class="ident" id="8058926">T</span><span class="op" id="8058927">)</span>&nbsp;<span class="op" id="8058929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8058932">for</span>&nbsp;<span class="ident" id="8058936">i</span><span class="op" id="8058937">,</span>&nbsp;<span class="ident" id="8058939">test</span>&nbsp;<span class="op" id="8058944">:=</span>&nbsp;<span class="keyword" id="8058947">range</span>&nbsp;<span class="ident" id="8058953">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8058984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8058988">key</span>&nbsp;<span class="op" id="8058992">:=</span>&nbsp;<span class="op" id="8058995">[</span><span class="op" id="8058996">]</span><span class="builtintype" id="8058997">byte</span><span class="op" id="8059001">(</span><span class="string" id="8059002">&#34;FAIL&#34;</span><span class="op" id="8059008">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059012">err</span>&nbsp;<span class="op" id="8059016">:=</span>&nbsp;<span class="ident" id="8059019">DecryptPKCS1v15SessionKey</span><span class="op" id="8059044">(</span><span class="ident" id="8059045">nil</span><span class="op" id="8059048">,</span>&nbsp;<span class="ident" id="8059050">rsaPrivateKey</span><span class="op" id="8059063">,</span>&nbsp;<span class="ident" id="8059065">decodeBase64</span><span class="op" id="8059077">(</span><span class="ident" id="8059078">test</span><span class="op" id="8059082">.</span><span class="ident" id="8059083">in</span><span class="op" id="8059085">)</span><span class="op" id="8059086">,</span>&nbsp;<span class="ident" id="8059088">key</span><span class="op" id="8059091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059095">if</span>&nbsp;<span class="ident" id="8059098">err</span>&nbsp;<span class="op" id="8059102">!=</span>&nbsp;<span class="ident" id="8059105">nil</span>&nbsp;<span class="op" id="8059109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059114">t</span><span class="op" id="8059115">.</span><span class="ident" id="8059116">Errorf</span><span class="op" id="8059122">(</span><span class="string" id="8059123">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8059145">,</span>&nbsp;<span class="ident" id="8059147">i</span><span class="op" id="8059148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059156">want</span>&nbsp;<span class="op" id="8059161">:=</span>&nbsp;<span class="op" id="8059164">[</span><span class="op" id="8059165">]</span><span class="builtintype" id="8059166">byte</span><span class="op" id="8059170">(</span><span class="ident" id="8059171">test</span><span class="op" id="8059175">.</span><span class="ident" id="8059176">out</span><span class="op" id="8059179">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059183">if</span>&nbsp;<span class="op" id="8059186">!</span><span class="ident" id="8059187">bytes</span><span class="op" id="8059192">.</span><span class="ident" id="8059193">Equal</span><span class="op" id="8059198">(</span><span class="ident" id="8059199">key</span><span class="op" id="8059202">,</span>&nbsp;<span class="ident" id="8059204">want</span><span class="op" id="8059208">)</span>&nbsp;<span class="op" id="8059210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059215">t</span><span class="op" id="8059216">.</span><span class="ident" id="8059217">Errorf</span><span class="op" id="8059223">(</span><span class="string" id="8059224">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8059246">,</span>&nbsp;<span class="ident" id="8059248">i</span><span class="op" id="8059249">,</span>&nbsp;<span class="ident" id="8059251">key</span><span class="op" id="8059254">,</span>&nbsp;<span class="ident" id="8059256">want</span><span class="op" id="8059260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059267">}</span><br>
<span class="lineno"></span><span class="op" id="8059269">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8059272">func</span>&nbsp;<span class="ident" id="8059277">TestNonZeroRandomBytes</span><span class="op" id="8059299">(</span><span class="ident" id="8059300">t</span>&nbsp;<span class="op" id="8059302">*</span><span class="ident" id="8059303">testing</span><span class="op" id="8059310">.</span><span class="ident" id="8059311">T</span><span class="op" id="8059312">)</span>&nbsp;<span class="op" id="8059314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059317">random</span>&nbsp;<span class="op" id="8059324">:=</span>&nbsp;<span class="ident" id="8059327">rand</span><span class="op" id="8059331">.</span><span class="ident" id="8059332">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059341">b</span>&nbsp;<span class="op" id="8059343">:=</span>&nbsp;<span class="builtinfunc" id="8059346">make</span><span class="op" id="8059350">(</span><span class="op" id="8059351">[</span><span class="op" id="8059352">]</span><span class="builtintype" id="8059353">byte</span><span class="op" id="8059357">,</span>&nbsp;<span class="num" id="8059359">512</span><span class="op" id="8059362">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059365">err</span>&nbsp;<span class="op" id="8059369">:=</span>&nbsp;<span class="ident" id="8059372">nonZeroRandomBytes</span><span class="op" id="8059390">(</span><span class="ident" id="8059391">b</span><span class="op" id="8059392">,</span>&nbsp;<span class="ident" id="8059394">random</span><span class="op" id="8059400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059403">if</span>&nbsp;<span class="ident" id="8059406">err</span>&nbsp;<span class="op" id="8059410">!=</span>&nbsp;<span class="ident" id="8059413">nil</span>&nbsp;<span class="op" id="8059417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059421">t</span><span class="op" id="8059422">.</span><span class="ident" id="8059423">Errorf</span><span class="op" id="8059429">(</span><span class="string" id="8059430">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8059450">,</span>&nbsp;<span class="ident" id="8059452">err</span><span class="op" id="8059455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059461">for</span>&nbsp;<span class="ident" id="8059465">_</span><span class="op" id="8059466">,</span>&nbsp;<span class="ident" id="8059468">b</span>&nbsp;<span class="op" id="8059470">:=</span>&nbsp;<span class="keyword" id="8059473">range</span>&nbsp;<span class="ident" id="8059479">b</span>&nbsp;<span class="op" id="8059481">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059485">if</span>&nbsp;<span class="ident" id="8059488">b</span>&nbsp;<span class="op" id="8059490">==</span>&nbsp;<span class="num" id="8059493">0</span>&nbsp;<span class="op" id="8059495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059500">t</span><span class="op" id="8059501">.</span><span class="ident" id="8059502">Errorf</span><span class="op" id="8059508">(</span><span class="string" id="8059509">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8059527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059544">}</span><br>
<span class="lineno">155</span><span class="op" id="8059546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8059549">type</span>&nbsp;<span class="ident" id="8059554">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8059571">struct</span>&nbsp;<span class="op" id="8059578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059581">in</span><span class="op" id="8059583">,</span>&nbsp;<span class="ident" id="8059585">out</span>&nbsp;<span class="builtintype" id="8059589">string</span><br>
<span class="lineno"></span><span class="op" id="8059596">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8059599">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8059638">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8059705">var</span>&nbsp;<span class="ident" id="8059709">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8059727">=</span>&nbsp;<span class="op" id="8059729">[</span><span class="op" id="8059730">]</span><span class="ident" id="8059731">signPKCS1v15Test</span><span class="op" id="8059747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8059750">{</span><span class="string" id="8059751">&#34;Test.\n&#34;</span><span class="op" id="8059760">,</span>&nbsp;<span class="string" id="8059762">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8059892">}</span><span class="op" id="8059893">,</span><br>
<span class="lineno">165</span><span class="op" id="8059895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8059898">func</span>&nbsp;<span class="ident" id="8059903">TestSignPKCS1v15</span><span class="op" id="8059919">(</span><span class="ident" id="8059920">t</span>&nbsp;<span class="op" id="8059922">*</span><span class="ident" id="8059923">testing</span><span class="op" id="8059930">.</span><span class="ident" id="8059931">T</span><span class="op" id="8059932">)</span>&nbsp;<span class="op" id="8059934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8059937">for</span>&nbsp;<span class="ident" id="8059941">i</span><span class="op" id="8059942">,</span>&nbsp;<span class="ident" id="8059944">test</span>&nbsp;<span class="op" id="8059949">:=</span>&nbsp;<span class="keyword" id="8059952">range</span>&nbsp;<span class="ident" id="8059958">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8059976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059980">h</span>&nbsp;<span class="op" id="8059982">:=</span>&nbsp;<span class="ident" id="8059985">sha1</span><span class="op" id="8059989">.</span><span class="ident" id="8059990">New</span><span class="op" id="8059993">(</span><span class="op" id="8059994">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8059998">h</span><span class="op" id="8059999">.</span><span class="ident" id="8060000">Write</span><span class="op" id="8060005">(</span><span class="op" id="8060006">[</span><span class="op" id="8060007">]</span><span class="builtintype" id="8060008">byte</span><span class="op" id="8060012">(</span><span class="ident" id="8060013">test</span><span class="op" id="8060017">.</span><span class="ident" id="8060018">in</span><span class="op" id="8060020">)</span><span class="op" id="8060021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060025">digest</span>&nbsp;<span class="op" id="8060032">:=</span>&nbsp;<span class="ident" id="8060035">h</span><span class="op" id="8060036">.</span><span class="ident" id="8060037">Sum</span><span class="op" id="8060040">(</span><span class="ident" id="8060041">nil</span><span class="op" id="8060044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060049">s</span><span class="op" id="8060050">,</span>&nbsp;<span class="ident" id="8060052">err</span>&nbsp;<span class="op" id="8060056">:=</span>&nbsp;<span class="ident" id="8060059">SignPKCS1v15</span><span class="op" id="8060071">(</span><span class="ident" id="8060072">nil</span><span class="op" id="8060075">,</span>&nbsp;<span class="ident" id="8060077">rsaPrivateKey</span><span class="op" id="8060090">,</span>&nbsp;<span class="ident" id="8060092">crypto</span><span class="op" id="8060098">.</span><span class="ident" id="8060099">SHA1</span><span class="op" id="8060103">,</span>&nbsp;<span class="ident" id="8060105">digest</span><span class="op" id="8060111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8060115">if</span>&nbsp;<span class="ident" id="8060118">err</span>&nbsp;<span class="op" id="8060122">!=</span>&nbsp;<span class="ident" id="8060125">nil</span>&nbsp;<span class="op" id="8060129">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060134">t</span><span class="op" id="8060135">.</span><span class="ident" id="8060136">Errorf</span><span class="op" id="8060142">(</span><span class="string" id="8060143">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8060151">,</span>&nbsp;<span class="ident" id="8060153">i</span><span class="op" id="8060154">,</span>&nbsp;<span class="ident" id="8060156">err</span><span class="op" id="8060159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060168">expected</span><span class="op" id="8060176">,</span>&nbsp;<span class="ident" id="8060178">_</span>&nbsp;<span class="op" id="8060180">:=</span>&nbsp;<span class="ident" id="8060183">hex</span><span class="op" id="8060186">.</span><span class="ident" id="8060187">DecodeString</span><span class="op" id="8060199">(</span><span class="ident" id="8060200">test</span><span class="op" id="8060204">.</span><span class="ident" id="8060205">out</span><span class="op" id="8060208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8060212">if</span>&nbsp;<span class="op" id="8060215">!</span><span class="ident" id="8060216">bytes</span><span class="op" id="8060221">.</span><span class="ident" id="8060222">Equal</span><span class="op" id="8060227">(</span><span class="ident" id="8060228">s</span><span class="op" id="8060229">,</span>&nbsp;<span class="ident" id="8060231">expected</span><span class="op" id="8060239">)</span>&nbsp;<span class="op" id="8060241">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060246">t</span><span class="op" id="8060247">.</span><span class="ident" id="8060248">Errorf</span><span class="op" id="8060254">(</span><span class="string" id="8060255">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8060277">,</span>&nbsp;<span class="ident" id="8060279">i</span><span class="op" id="8060280">,</span>&nbsp;<span class="ident" id="8060282">s</span><span class="op" id="8060283">,</span>&nbsp;<span class="ident" id="8060285">expected</span><span class="op" id="8060293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060300">}</span><br>
<span class="lineno"></span><span class="op" id="8060302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8060305">func</span>&nbsp;<span class="ident" id="8060310">TestVerifyPKCS1v15</span><span class="op" id="8060328">(</span><span class="ident" id="8060329">t</span>&nbsp;<span class="op" id="8060331">*</span><span class="ident" id="8060332">testing</span><span class="op" id="8060339">.</span><span class="ident" id="8060340">T</span><span class="op" id="8060341">)</span>&nbsp;<span class="op" id="8060343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8060346">for</span>&nbsp;<span class="ident" id="8060350">i</span><span class="op" id="8060351">,</span>&nbsp;<span class="ident" id="8060353">test</span>&nbsp;<span class="op" id="8060358">:=</span>&nbsp;<span class="keyword" id="8060361">range</span>&nbsp;<span class="ident" id="8060367">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8060385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060389">h</span>&nbsp;<span class="op" id="8060391">:=</span>&nbsp;<span class="ident" id="8060394">sha1</span><span class="op" id="8060398">.</span><span class="ident" id="8060399">New</span><span class="op" id="8060402">(</span><span class="op" id="8060403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060407">h</span><span class="op" id="8060408">.</span><span class="ident" id="8060409">Write</span><span class="op" id="8060414">(</span><span class="op" id="8060415">[</span><span class="op" id="8060416">]</span><span class="builtintype" id="8060417">byte</span><span class="op" id="8060421">(</span><span class="ident" id="8060422">test</span><span class="op" id="8060426">.</span><span class="ident" id="8060427">in</span><span class="op" id="8060429">)</span><span class="op" id="8060430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060434">digest</span>&nbsp;<span class="op" id="8060441">:=</span>&nbsp;<span class="ident" id="8060444">h</span><span class="op" id="8060445">.</span><span class="ident" id="8060446">Sum</span><span class="op" id="8060449">(</span><span class="ident" id="8060450">nil</span><span class="op" id="8060453">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060458">sig</span><span class="op" id="8060461">,</span>&nbsp;<span class="ident" id="8060463">_</span>&nbsp;<span class="op" id="8060465">:=</span>&nbsp;<span class="ident" id="8060468">hex</span><span class="op" id="8060471">.</span><span class="ident" id="8060472">DecodeString</span><span class="op" id="8060484">(</span><span class="ident" id="8060485">test</span><span class="op" id="8060489">.</span><span class="ident" id="8060490">out</span><span class="op" id="8060493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060498">err</span>&nbsp;<span class="op" id="8060502">:=</span>&nbsp;<span class="ident" id="8060505">VerifyPKCS1v15</span><span class="op" id="8060519">(</span><span class="op" id="8060520">&amp;</span><span class="ident" id="8060521">rsaPrivateKey</span><span class="op" id="8060534">.</span><span class="ident" id="8060535">PublicKey</span><span class="op" id="8060544">,</span>&nbsp;<span class="ident" id="8060546">crypto</span><span class="op" id="8060552">.</span><span class="ident" id="8060553">SHA1</span><span class="op" id="8060557">,</span>&nbsp;<span class="ident" id="8060559">digest</span><span class="op" id="8060565">,</span>&nbsp;<span class="ident" id="8060567">sig</span><span class="op" id="8060570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8060574">if</span>&nbsp;<span class="ident" id="8060577">err</span>&nbsp;<span class="op" id="8060581">!=</span>&nbsp;<span class="ident" id="8060584">nil</span>&nbsp;<span class="op" id="8060588">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060593">t</span><span class="op" id="8060594">.</span><span class="ident" id="8060595">Errorf</span><span class="op" id="8060601">(</span><span class="string" id="8060602">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8060610">,</span>&nbsp;<span class="ident" id="8060612">i</span><span class="op" id="8060613">,</span>&nbsp;<span class="ident" id="8060615">err</span><span class="op" id="8060618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060625">}</span><br>
<span class="lineno"></span><span class="op" id="8060627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8060630">func</span>&nbsp;<span class="ident" id="8060635">TestOverlongMessagePKCS1v15</span><span class="op" id="8060662">(</span><span class="ident" id="8060663">t</span>&nbsp;<span class="op" id="8060665">*</span><span class="ident" id="8060666">testing</span><span class="op" id="8060673">.</span><span class="ident" id="8060674">T</span><span class="op" id="8060675">)</span>&nbsp;<span class="op" id="8060677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060680">ciphertext</span>&nbsp;<span class="op" id="8060691">:=</span>&nbsp;<span class="ident" id="8060694">decodeBase64</span><span class="op" id="8060706">(</span><span class="string" id="8060707">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8060799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060802">_</span><span class="op" id="8060803">,</span>&nbsp;<span class="ident" id="8060805">err</span>&nbsp;<span class="op" id="8060809">:=</span>&nbsp;<span class="ident" id="8060812">DecryptPKCS1v15</span><span class="op" id="8060827">(</span><span class="ident" id="8060828">nil</span><span class="op" id="8060831">,</span>&nbsp;<span class="ident" id="8060833">rsaPrivateKey</span><span class="op" id="8060846">,</span>&nbsp;<span class="ident" id="8060848">ciphertext</span><span class="op" id="8060858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8060861">if</span>&nbsp;<span class="ident" id="8060864">err</span>&nbsp;<span class="op" id="8060868">==</span>&nbsp;<span class="ident" id="8060871">nil</span>&nbsp;<span class="op" id="8060875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060879">t</span><span class="op" id="8060880">.</span><span class="ident" id="8060881">Error</span><span class="op" id="8060886">(</span><span class="string" id="8060887">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8060931">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8060934">}</span><br>
<span class="lineno"></span><span class="op" id="8060936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8060939">func</span>&nbsp;<span class="ident" id="8060944">TestUnpaddedSignature</span><span class="op" id="8060965">(</span><span class="ident" id="8060966">t</span>&nbsp;<span class="op" id="8060968">*</span><span class="ident" id="8060969">testing</span><span class="op" id="8060976">.</span><span class="ident" id="8060977">T</span><span class="op" id="8060978">)</span>&nbsp;<span class="op" id="8060980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8060983">msg</span>&nbsp;<span class="op" id="8060987">:=</span>&nbsp;<span class="op" id="8060990">[</span><span class="op" id="8060991">]</span><span class="builtintype" id="8060992">byte</span><span class="op" id="8060996">(</span><span class="string" id="8060997">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8061029">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061032">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061074">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061125">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061190">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061194">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061267">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061277">expectedSig</span>&nbsp;<span class="op" id="8061289">:=</span>&nbsp;<span class="ident" id="8061292">decodeBase64</span><span class="op" id="8061304">(</span><span class="string" id="8061305">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8061395">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061399">sig</span><span class="op" id="8061402">,</span>&nbsp;<span class="ident" id="8061404">err</span>&nbsp;<span class="op" id="8061408">:=</span>&nbsp;<span class="ident" id="8061411">SignPKCS1v15</span><span class="op" id="8061423">(</span><span class="ident" id="8061424">nil</span><span class="op" id="8061427">,</span>&nbsp;<span class="ident" id="8061429">rsaPrivateKey</span><span class="op" id="8061442">,</span>&nbsp;<span class="ident" id="8061444">crypto</span><span class="op" id="8061450">.</span><span class="ident" id="8061451">Hash</span><span class="op" id="8061455">(</span><span class="num" id="8061456">0</span><span class="op" id="8061457">)</span><span class="op" id="8061458">,</span>&nbsp;<span class="ident" id="8061460">msg</span><span class="op" id="8061463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8061466">if</span>&nbsp;<span class="ident" id="8061469">err</span>&nbsp;<span class="op" id="8061473">!=</span>&nbsp;<span class="ident" id="8061476">nil</span>&nbsp;<span class="op" id="8061480">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061484">t</span><span class="op" id="8061485">.</span><span class="ident" id="8061486">Fatalf</span><span class="op" id="8061492">(</span><span class="string" id="8061493">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8061518">,</span>&nbsp;<span class="ident" id="8061520">err</span><span class="op" id="8061523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8061526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8061529">if</span>&nbsp;<span class="op" id="8061532">!</span><span class="ident" id="8061533">bytes</span><span class="op" id="8061538">.</span><span class="ident" id="8061539">Equal</span><span class="op" id="8061544">(</span><span class="ident" id="8061545">sig</span><span class="op" id="8061548">,</span>&nbsp;<span class="ident" id="8061550">expectedSig</span><span class="op" id="8061561">)</span>&nbsp;<span class="op" id="8061563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061567">t</span><span class="op" id="8061568">.</span><span class="ident" id="8061569">Fatalf</span><span class="op" id="8061575">(</span><span class="string" id="8061576">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8061626">,</span>&nbsp;<span class="ident" id="8061628">sig</span><span class="op" id="8061631">,</span>&nbsp;<span class="ident" id="8061633">expectedSig</span><span class="op" id="8061644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8061647">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8061650">if</span>&nbsp;<span class="ident" id="8061653">err</span>&nbsp;<span class="op" id="8061657">:=</span>&nbsp;<span class="ident" id="8061660">VerifyPKCS1v15</span><span class="op" id="8061674">(</span><span class="op" id="8061675">&amp;</span><span class="ident" id="8061676">rsaPrivateKey</span><span class="op" id="8061689">.</span><span class="ident" id="8061690">PublicKey</span><span class="op" id="8061699">,</span>&nbsp;<span class="ident" id="8061701">crypto</span><span class="op" id="8061707">.</span><span class="ident" id="8061708">Hash</span><span class="op" id="8061712">(</span><span class="num" id="8061713">0</span><span class="op" id="8061714">)</span><span class="op" id="8061715">,</span>&nbsp;<span class="ident" id="8061717">msg</span><span class="op" id="8061720">,</span>&nbsp;<span class="ident" id="8061722">sig</span><span class="op" id="8061725">)</span><span class="op" id="8061726">;</span>&nbsp;<span class="ident" id="8061728">err</span>&nbsp;<span class="op" id="8061732">!=</span>&nbsp;<span class="ident" id="8061735">nil</span>&nbsp;<span class="op" id="8061739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061743">t</span><span class="op" id="8061744">.</span><span class="ident" id="8061745">Fatalf</span><span class="op" id="8061751">(</span><span class="string" id="8061752">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8061784">,</span>&nbsp;<span class="ident" id="8061786">err</span><span class="op" id="8061789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8061792">}</span><br>
<span class="lineno"></span><span class="op" id="8061794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8061797">func</span>&nbsp;<span class="ident" id="8061802">TestShortSessionKey</span><span class="op" id="8061821">(</span><span class="ident" id="8061822">t</span>&nbsp;<span class="op" id="8061824">*</span><span class="ident" id="8061825">testing</span><span class="op" id="8061832">.</span><span class="ident" id="8061833">T</span><span class="op" id="8061834">)</span>&nbsp;<span class="op" id="8061836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061839">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8061905">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8061971">ciphertext</span><span class="op" id="8061981">,</span>&nbsp;<span class="ident" id="8061983">err</span>&nbsp;<span class="op" id="8061987">:=</span>&nbsp;<span class="ident" id="8061990">EncryptPKCS1v15</span><span class="op" id="8062005">(</span><span class="ident" id="8062006">rand</span><span class="op" id="8062010">.</span><span class="ident" id="8062011">Reader</span><span class="op" id="8062017">,</span>&nbsp;<span class="op" id="8062019">&amp;</span><span class="ident" id="8062020">rsaPrivateKey</span><span class="op" id="8062033">.</span><span class="ident" id="8062034">PublicKey</span><span class="op" id="8062043">,</span>&nbsp;<span class="op" id="8062045">[</span><span class="op" id="8062046">]</span><span class="builtintype" id="8062047">byte</span><span class="op" id="8062051">{</span><span class="num" id="8062052">1</span><span class="op" id="8062053">}</span><span class="op" id="8062054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8062057">if</span>&nbsp;<span class="ident" id="8062060">err</span>&nbsp;<span class="op" id="8062064">!=</span>&nbsp;<span class="ident" id="8062067">nil</span>&nbsp;<span class="op" id="8062071">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8062075">t</span><span class="op" id="8062076">.</span><span class="ident" id="8062077">Fatalf</span><span class="op" id="8062083">(</span><span class="string" id="8062084">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8062121">,</span>&nbsp;<span class="ident" id="8062123">err</span><span class="op" id="8062126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8062129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8062133">var</span>&nbsp;<span class="ident" id="8062137">key</span>&nbsp;<span class="op" id="8062141">[</span><span class="num" id="8062142">32</span><span class="op" id="8062144">]</span><span class="builtintype" id="8062145">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8062151">if</span>&nbsp;<span class="ident" id="8062154">err</span>&nbsp;<span class="op" id="8062158">:=</span>&nbsp;<span class="ident" id="8062161">DecryptPKCS1v15SessionKey</span><span class="op" id="8062186">(</span><span class="ident" id="8062187">nil</span><span class="op" id="8062190">,</span>&nbsp;<span class="ident" id="8062192">rsaPrivateKey</span><span class="op" id="8062205">,</span>&nbsp;<span class="ident" id="8062207">ciphertext</span><span class="op" id="8062217">,</span>&nbsp;<span class="ident" id="8062219">key</span><span class="op" id="8062222">[</span><span class="op" id="8062223">:</span><span class="op" id="8062224">]</span><span class="op" id="8062225">)</span><span class="op" id="8062226">;</span>&nbsp;<span class="ident" id="8062228">err</span>&nbsp;<span class="op" id="8062232">!=</span>&nbsp;<span class="ident" id="8062235">nil</span>&nbsp;<span class="op" id="8062239">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8062243">t</span><span class="op" id="8062244">.</span><span class="ident" id="8062245">Fatalf</span><span class="op" id="8062251">(</span><span class="string" id="8062252">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8062289">,</span>&nbsp;<span class="ident" id="8062291">err</span><span class="op" id="8062294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8062297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8062301">for</span>&nbsp;<span class="ident" id="8062305">_</span><span class="op" id="8062306">,</span>&nbsp;<span class="ident" id="8062308">v</span>&nbsp;<span class="op" id="8062310">:=</span>&nbsp;<span class="keyword" id="8062313">range</span>&nbsp;<span class="ident" id="8062319">key</span>&nbsp;<span class="op" id="8062323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8062327">if</span>&nbsp;<span class="ident" id="8062330">v</span>&nbsp;<span class="op" id="8062332">!=</span>&nbsp;<span class="num" id="8062335">0</span>&nbsp;<span class="op" id="8062337">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8062342">t</span><span class="op" id="8062343">.</span><span class="ident" id="8062344">Fatal</span><span class="op" id="8062349">(</span><span class="string" id="8062350">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8062396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8062400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8062403">}</span><br>
<span class="lineno"></span><span class="op" id="8062405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8062408">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8062487">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8062522">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8062590">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8062658">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8062726">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8062794">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8062862">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8062930">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8062974">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8063008">var</span>&nbsp;<span class="ident" id="8063012">rsaPrivateKey</span>&nbsp;<span class="op" id="8063026">=</span>&nbsp;<span class="op" id="8063028">&amp;</span><span class="ident" id="8063029">PrivateKey</span><span class="op" id="8063039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063042">PublicKey</span><span class="op" id="8063051">:</span>&nbsp;<span class="ident" id="8063053">PublicKey</span><span class="op" id="8063062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063066">N</span><span class="op" id="8063067">:</span>&nbsp;<span class="ident" id="8063069">fromBase10</span><span class="op" id="8063079">(</span><span class="string" id="8063080">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8063236">)</span><span class="op" id="8063237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063241">E</span><span class="op" id="8063242">:</span>&nbsp;<span class="num" id="8063244">65537</span><span class="op" id="8063249">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8063252">}</span><span class="op" id="8063253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063256">D</span><span class="op" id="8063257">:</span>&nbsp;<span class="ident" id="8063259">fromBase10</span><span class="op" id="8063269">(</span><span class="string" id="8063270">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8063426">)</span><span class="op" id="8063427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063430">Primes</span><span class="op" id="8063436">:</span>&nbsp;<span class="op" id="8063438">[</span><span class="op" id="8063439">]</span><span class="op" id="8063440">*</span><span class="ident" id="8063441">big</span><span class="op" id="8063444">.</span><span class="ident" id="8063445">Int</span><span class="op" id="8063448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063452">fromBase10</span><span class="op" id="8063462">(</span><span class="string" id="8063463">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8063542">)</span><span class="op" id="8063543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8063547">fromBase10</span><span class="op" id="8063557">(</span><span class="string" id="8063558">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8063637">)</span><span class="op" id="8063638">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8063641">}</span><span class="op" id="8063642">,</span><br>
<span class="lineno"></span><span class="op" id="8063644">}</span>
</div>
</body>
</html>
