<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html" class="current">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8284702">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8284757">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8284811">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8284862">package</span>&nbsp;<span class="ident" id="8284870">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8284875">import</span>&nbsp;<span class="op" id="8284882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8284885">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8284900">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8284907">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8284913">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8284924">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8284933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8284936">type</span>&nbsp;<span class="ident" id="8284941">md5Test</span>&nbsp;<span class="keyword" id="8284949">struct</span>&nbsp;<span class="op" id="8284956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284959">out</span>&nbsp;<span class="builtintype" id="8284963">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8284971">in</span>&nbsp;&nbsp;<span class="builtintype" id="8284975">string</span><br>
<span class="lineno"></span><span class="op" id="8284982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8284985">var</span>&nbsp;<span class="ident" id="8284989">golden</span>&nbsp;<span class="op" id="8284996">=</span>&nbsp;<span class="op" id="8284998">[</span><span class="op" id="8284999">]</span><span class="ident" id="8285000">md5Test</span><span class="op" id="8285007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285010">{</span><span class="string" id="8285011">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="8285045">,</span>&nbsp;<span class="string" id="8285047">&#34;&#34;</span><span class="op" id="8285049">}</span><span class="op" id="8285050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285053">{</span><span class="string" id="8285054">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="8285088">,</span>&nbsp;<span class="string" id="8285090">&#34;a&#34;</span><span class="op" id="8285093">}</span><span class="op" id="8285094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285097">{</span><span class="string" id="8285098">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="8285132">,</span>&nbsp;<span class="string" id="8285134">&#34;ab&#34;</span><span class="op" id="8285138">}</span><span class="op" id="8285139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285142">{</span><span class="string" id="8285143">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="8285177">,</span>&nbsp;<span class="string" id="8285179">&#34;abc&#34;</span><span class="op" id="8285184">}</span><span class="op" id="8285185">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285188">{</span><span class="string" id="8285189">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="8285223">,</span>&nbsp;<span class="string" id="8285225">&#34;abcd&#34;</span><span class="op" id="8285231">}</span><span class="op" id="8285232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285235">{</span><span class="string" id="8285236">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="8285270">,</span>&nbsp;<span class="string" id="8285272">&#34;abcde&#34;</span><span class="op" id="8285279">}</span><span class="op" id="8285280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285283">{</span><span class="string" id="8285284">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="8285318">,</span>&nbsp;<span class="string" id="8285320">&#34;abcdef&#34;</span><span class="op" id="8285328">}</span><span class="op" id="8285329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285332">{</span><span class="string" id="8285333">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="8285367">,</span>&nbsp;<span class="string" id="8285369">&#34;abcdefg&#34;</span><span class="op" id="8285378">}</span><span class="op" id="8285379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285382">{</span><span class="string" id="8285383">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="8285417">,</span>&nbsp;<span class="string" id="8285419">&#34;abcdefgh&#34;</span><span class="op" id="8285429">}</span><span class="op" id="8285430">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285433">{</span><span class="string" id="8285434">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="8285468">,</span>&nbsp;<span class="string" id="8285470">&#34;abcdefghi&#34;</span><span class="op" id="8285481">}</span><span class="op" id="8285482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285485">{</span><span class="string" id="8285486">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="8285520">,</span>&nbsp;<span class="string" id="8285522">&#34;abcdefghij&#34;</span><span class="op" id="8285534">}</span><span class="op" id="8285535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285538">{</span><span class="string" id="8285539">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="8285573">,</span>&nbsp;<span class="string" id="8285575">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="8285618">}</span><span class="op" id="8285619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285622">{</span><span class="string" id="8285623">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="8285657">,</span>&nbsp;<span class="string" id="8285659">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="8285718">}</span><span class="op" id="8285719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285722">{</span><span class="string" id="8285723">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="8285757">,</span>&nbsp;<span class="string" id="8285759">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="8285803">}</span><span class="op" id="8285804">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285807">{</span><span class="string" id="8285808">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="8285842">,</span>&nbsp;<span class="string" id="8285844">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="8285903">}</span><span class="op" id="8285904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8285907">{</span><span class="string" id="8285908">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="8285942">,</span>&nbsp;<span class="string" id="8285944">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="8286004">}</span><span class="op" id="8286005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286008">{</span><span class="string" id="8286009">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="8286043">,</span>&nbsp;<span class="string" id="8286045">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="8286074">}</span><span class="op" id="8286075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286078">{</span><span class="string" id="8286079">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="8286113">,</span>&nbsp;<span class="string" id="8286115">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="8286184">}</span><span class="op" id="8286185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286188">{</span><span class="string" id="8286189">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="8286223">,</span>&nbsp;<span class="string" id="8286225">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="8286284">}</span><span class="op" id="8286285">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286288">{</span><span class="string" id="8286289">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="8286323">,</span>&nbsp;<span class="string" id="8286325">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="8286415">}</span><span class="op" id="8286416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286419">{</span><span class="string" id="8286420">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="8286454">,</span>&nbsp;<span class="string" id="8286456">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="8286533">}</span><span class="op" id="8286534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286537">{</span><span class="string" id="8286538">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="8286572">,</span>&nbsp;<span class="string" id="8286574">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="8286600">}</span><span class="op" id="8286601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286604">{</span><span class="string" id="8286605">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="8286639">,</span>&nbsp;<span class="string" id="8286641">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="8286692">}</span><span class="op" id="8286693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286696">{</span><span class="string" id="8286697">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="8286731">,</span>&nbsp;<span class="string" id="8286733">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="8286807">}</span><span class="op" id="8286808">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286811">{</span><span class="string" id="8286812">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="8286846">,</span>&nbsp;<span class="string" id="8286848">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="8286896">}</span><span class="op" id="8286897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286900">{</span><span class="string" id="8286901">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="8286935">,</span>&nbsp;<span class="string" id="8286937">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="8287009">}</span><span class="op" id="8287010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287013">{</span><span class="string" id="8287014">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="8287048">,</span>&nbsp;<span class="string" id="8287050">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="8287120">}</span><span class="op" id="8287121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287124">{</span><span class="string" id="8287125">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="8287159">,</span>&nbsp;<span class="string" id="8287161">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="8287195">}</span><span class="op" id="8287196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287199">{</span><span class="string" id="8287200">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="8287234">,</span>&nbsp;<span class="string" id="8287236">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="8287326">}</span><span class="op" id="8287327">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287330">{</span><span class="string" id="8287331">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="8287365">,</span>&nbsp;<span class="string" id="8287367">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="8287501">}</span><span class="op" id="8287502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287505">{</span><span class="string" id="8287506">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="8287540">,</span>&nbsp;<span class="string" id="8287542">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="8287600">}</span><span class="op" id="8287601">,</span><br>
<span class="lineno"></span><span class="op" id="8287603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8287606">func</span>&nbsp;<span class="ident" id="8287611">TestGolden</span><span class="op" id="8287621">(</span><span class="ident" id="8287622">t</span>&nbsp;<span class="op" id="8287624">*</span><span class="ident" id="8287625">testing</span><span class="op" id="8287632">.</span><span class="ident" id="8287633">T</span><span class="op" id="8287634">)</span>&nbsp;<span class="op" id="8287636">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287639">for</span>&nbsp;<span class="ident" id="8287643">i</span>&nbsp;<span class="op" id="8287645">:=</span>&nbsp;<span class="num" id="8287648">0</span><span class="op" id="8287649">;</span>&nbsp;<span class="ident" id="8287651">i</span>&nbsp;<span class="op" id="8287653">&lt;</span>&nbsp;<span class="builtinfunc" id="8287655">len</span><span class="op" id="8287658">(</span><span class="ident" id="8287659">golden</span><span class="op" id="8287665">)</span><span class="op" id="8287666">;</span>&nbsp;<span class="ident" id="8287668">i</span><span class="op" id="8287669">++</span>&nbsp;<span class="op" id="8287672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287676">g</span>&nbsp;<span class="op" id="8287678">:=</span>&nbsp;<span class="ident" id="8287681">golden</span><span class="op" id="8287687">[</span><span class="ident" id="8287688">i</span><span class="op" id="8287689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287693">s</span>&nbsp;<span class="op" id="8287695">:=</span>&nbsp;<span class="ident" id="8287698">fmt</span><span class="op" id="8287701">.</span><span class="ident" id="8287702">Sprintf</span><span class="op" id="8287709">(</span><span class="string" id="8287710">&#34;%x&#34;</span><span class="op" id="8287714">,</span>&nbsp;<span class="ident" id="8287716">Sum</span><span class="op" id="8287719">(</span><span class="op" id="8287720">[</span><span class="op" id="8287721">]</span><span class="builtintype" id="8287722">byte</span><span class="op" id="8287726">(</span><span class="ident" id="8287727">g</span><span class="op" id="8287728">.</span><span class="ident" id="8287729">in</span><span class="op" id="8287731">)</span><span class="op" id="8287732">)</span><span class="op" id="8287733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287737">if</span>&nbsp;<span class="ident" id="8287740">s</span>&nbsp;<span class="op" id="8287742">!=</span>&nbsp;<span class="ident" id="8287745">g</span><span class="op" id="8287746">.</span><span class="ident" id="8287747">out</span>&nbsp;<span class="op" id="8287751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287756">t</span><span class="op" id="8287757">.</span><span class="ident" id="8287758">Fatalf</span><span class="op" id="8287764">(</span><span class="string" id="8287765">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8287801">,</span>&nbsp;<span class="ident" id="8287803">g</span><span class="op" id="8287804">.</span><span class="ident" id="8287805">in</span><span class="op" id="8287807">,</span>&nbsp;<span class="ident" id="8287809">s</span><span class="op" id="8287810">,</span>&nbsp;<span class="ident" id="8287812">g</span><span class="op" id="8287813">.</span><span class="ident" id="8287814">out</span><span class="op" id="8287817">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287825">c</span>&nbsp;<span class="op" id="8287827">:=</span>&nbsp;<span class="ident" id="8287830">New</span><span class="op" id="8287833">(</span><span class="op" id="8287834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287838">buf</span>&nbsp;<span class="op" id="8287842">:=</span>&nbsp;<span class="builtinfunc" id="8287845">make</span><span class="op" id="8287849">(</span><span class="op" id="8287850">[</span><span class="op" id="8287851">]</span><span class="builtintype" id="8287852">byte</span><span class="op" id="8287856">,</span>&nbsp;<span class="builtinfunc" id="8287858">len</span><span class="op" id="8287861">(</span><span class="ident" id="8287862">g</span><span class="op" id="8287863">.</span><span class="ident" id="8287864">in</span><span class="op" id="8287866">)</span><span class="op" id="8287867">+</span><span class="num" id="8287868">4</span><span class="op" id="8287869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287873">for</span>&nbsp;<span class="ident" id="8287877">j</span>&nbsp;<span class="op" id="8287879">:=</span>&nbsp;<span class="num" id="8287882">0</span><span class="op" id="8287883">;</span>&nbsp;<span class="ident" id="8287885">j</span>&nbsp;<span class="op" id="8287887">&lt;</span>&nbsp;<span class="num" id="8287889">3</span><span class="op" id="8287890">+</span><span class="num" id="8287891">4</span><span class="op" id="8287892">;</span>&nbsp;<span class="ident" id="8287894">j</span><span class="op" id="8287895">++</span>&nbsp;<span class="op" id="8287898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287903">if</span>&nbsp;<span class="ident" id="8287906">j</span>&nbsp;<span class="op" id="8287908">&lt;</span>&nbsp;<span class="num" id="8287910">2</span>&nbsp;<span class="op" id="8287912">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287918">io</span><span class="op" id="8287920">.</span><span class="ident" id="8287921">WriteString</span><span class="op" id="8287932">(</span><span class="ident" id="8287933">c</span><span class="op" id="8287934">,</span>&nbsp;<span class="ident" id="8287936">g</span><span class="op" id="8287937">.</span><span class="ident" id="8287938">in</span><span class="op" id="8287940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287945">}</span>&nbsp;<span class="keyword" id="8287947">else</span>&nbsp;<span class="keyword" id="8287952">if</span>&nbsp;<span class="ident" id="8287955">j</span>&nbsp;<span class="op" id="8287957">==</span>&nbsp;<span class="num" id="8287960">2</span>&nbsp;<span class="op" id="8287962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287968">io</span><span class="op" id="8287970">.</span><span class="ident" id="8287971">WriteString</span><span class="op" id="8287982">(</span><span class="ident" id="8287983">c</span><span class="op" id="8287984">,</span>&nbsp;<span class="ident" id="8287986">g</span><span class="op" id="8287987">.</span><span class="ident" id="8287988">in</span><span class="op" id="8287990">[</span><span class="num" id="8287991">0</span><span class="op" id="8287992">:</span><span class="builtinfunc" id="8287993">len</span><span class="op" id="8287996">(</span><span class="ident" id="8287997">g</span><span class="op" id="8287998">.</span><span class="ident" id="8287999">in</span><span class="op" id="8288001">)</span><span class="op" id="8288002">/</span><span class="num" id="8288003">2</span><span class="op" id="8288004">]</span><span class="op" id="8288005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288011">c</span><span class="op" id="8288012">.</span><span class="ident" id="8288013">Sum</span><span class="op" id="8288016">(</span><span class="ident" id="8288017">nil</span><span class="op" id="8288020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288026">io</span><span class="op" id="8288028">.</span><span class="ident" id="8288029">WriteString</span><span class="op" id="8288040">(</span><span class="ident" id="8288041">c</span><span class="op" id="8288042">,</span>&nbsp;<span class="ident" id="8288044">g</span><span class="op" id="8288045">.</span><span class="ident" id="8288046">in</span><span class="op" id="8288048">[</span><span class="builtinfunc" id="8288049">len</span><span class="op" id="8288052">(</span><span class="ident" id="8288053">g</span><span class="op" id="8288054">.</span><span class="ident" id="8288055">in</span><span class="op" id="8288057">)</span><span class="op" id="8288058">/</span><span class="num" id="8288059">2</span><span class="op" id="8288060">:</span><span class="op" id="8288061">]</span><span class="op" id="8288062">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288067">}</span>&nbsp;<span class="keyword" id="8288069">else</span>&nbsp;<span class="keyword" id="8288074">if</span>&nbsp;<span class="ident" id="8288077">j</span>&nbsp;<span class="op" id="8288079">&gt;</span>&nbsp;<span class="num" id="8288081">2</span>&nbsp;<span class="op" id="8288083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8288089">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288117">buf</span>&nbsp;<span class="op" id="8288121">=</span>&nbsp;<span class="ident" id="8288123">buf</span><span class="op" id="8288126">[</span><span class="num" id="8288127">1</span><span class="op" id="8288128">:</span><span class="op" id="8288129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8288135">copy</span><span class="op" id="8288139">(</span><span class="ident" id="8288140">buf</span><span class="op" id="8288143">,</span>&nbsp;<span class="ident" id="8288145">g</span><span class="op" id="8288146">.</span><span class="ident" id="8288147">in</span><span class="op" id="8288149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288155">c</span><span class="op" id="8288156">.</span><span class="ident" id="8288157">Write</span><span class="op" id="8288162">(</span><span class="ident" id="8288163">buf</span><span class="op" id="8288166">[</span><span class="op" id="8288167">:</span><span class="builtinfunc" id="8288168">len</span><span class="op" id="8288171">(</span><span class="ident" id="8288172">g</span><span class="op" id="8288173">.</span><span class="ident" id="8288174">in</span><span class="op" id="8288176">)</span><span class="op" id="8288177">]</span><span class="op" id="8288178">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288188">s</span>&nbsp;<span class="op" id="8288190">:=</span>&nbsp;<span class="ident" id="8288193">fmt</span><span class="op" id="8288196">.</span><span class="ident" id="8288197">Sprintf</span><span class="op" id="8288204">(</span><span class="string" id="8288205">&#34;%x&#34;</span><span class="op" id="8288209">,</span>&nbsp;<span class="ident" id="8288211">c</span><span class="op" id="8288212">.</span><span class="ident" id="8288213">Sum</span><span class="op" id="8288216">(</span><span class="ident" id="8288217">nil</span><span class="op" id="8288220">)</span><span class="op" id="8288221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288226">if</span>&nbsp;<span class="ident" id="8288229">s</span>&nbsp;<span class="op" id="8288231">!=</span>&nbsp;<span class="ident" id="8288234">g</span><span class="op" id="8288235">.</span><span class="ident" id="8288236">out</span>&nbsp;<span class="op" id="8288240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288246">t</span><span class="op" id="8288247">.</span><span class="ident" id="8288248">Fatalf</span><span class="op" id="8288254">(</span><span class="string" id="8288255">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8288281">,</span>&nbsp;<span class="ident" id="8288283">j</span><span class="op" id="8288284">,</span>&nbsp;<span class="ident" id="8288286">g</span><span class="op" id="8288287">.</span><span class="ident" id="8288288">in</span><span class="op" id="8288290">,</span>&nbsp;<span class="ident" id="8288292">s</span><span class="op" id="8288293">,</span>&nbsp;<span class="ident" id="8288295">g</span><span class="op" id="8288296">.</span><span class="ident" id="8288297">out</span><span class="op" id="8288300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288305">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288310">c</span><span class="op" id="8288311">.</span><span class="ident" id="8288312">Reset</span><span class="op" id="8288317">(</span><span class="op" id="8288318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288325">}</span><br>
<span class="lineno"></span><span class="op" id="8288327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="8288330">func</span>&nbsp;<span class="ident" id="8288335">TestLarge</span><span class="op" id="8288344">(</span><span class="ident" id="8288345">t</span>&nbsp;<span class="op" id="8288347">*</span><span class="ident" id="8288348">testing</span><span class="op" id="8288355">.</span><span class="ident" id="8288356">T</span><span class="op" id="8288357">)</span>&nbsp;<span class="op" id="8288359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288362">const</span>&nbsp;<span class="ident" id="8288368">N</span>&nbsp;<span class="op" id="8288370">=</span>&nbsp;<span class="num" id="8288372">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288379">ok</span>&nbsp;<span class="op" id="8288382">:=</span>&nbsp;<span class="string" id="8288385">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="8288420">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288454">block</span>&nbsp;<span class="op" id="8288460">:=</span>&nbsp;<span class="builtinfunc" id="8288463">make</span><span class="op" id="8288467">(</span><span class="op" id="8288468">[</span><span class="op" id="8288469">]</span><span class="builtintype" id="8288470">byte</span><span class="op" id="8288474">,</span>&nbsp;<span class="num" id="8288476">10004</span><span class="op" id="8288481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288484">c</span>&nbsp;<span class="op" id="8288486">:=</span>&nbsp;<span class="ident" id="8288489">New</span><span class="op" id="8288492">(</span><span class="op" id="8288493">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288496">for</span>&nbsp;<span class="ident" id="8288500">offset</span>&nbsp;<span class="op" id="8288507">:=</span>&nbsp;<span class="num" id="8288510">0</span><span class="op" id="8288511">;</span>&nbsp;<span class="ident" id="8288513">offset</span>&nbsp;<span class="op" id="8288520">&lt;</span>&nbsp;<span class="num" id="8288522">4</span><span class="op" id="8288523">;</span>&nbsp;<span class="ident" id="8288525">offset</span><span class="op" id="8288531">++</span>&nbsp;<span class="op" id="8288534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288538">for</span>&nbsp;<span class="ident" id="8288542">i</span>&nbsp;<span class="op" id="8288544">:=</span>&nbsp;<span class="num" id="8288547">0</span><span class="op" id="8288548">;</span>&nbsp;<span class="ident" id="8288550">i</span>&nbsp;<span class="op" id="8288552">&lt;</span>&nbsp;<span class="ident" id="8288554">N</span><span class="op" id="8288555">;</span>&nbsp;<span class="ident" id="8288557">i</span><span class="op" id="8288558">++</span>&nbsp;<span class="op" id="8288561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288566">block</span><span class="op" id="8288571">[</span><span class="ident" id="8288572">offset</span><span class="op" id="8288578">+</span><span class="ident" id="8288579">i</span><span class="op" id="8288580">]</span>&nbsp;<span class="op" id="8288582">=</span>&nbsp;<span class="string" id="8288584">&#39;0&#39;</span>&nbsp;<span class="op" id="8288588">+</span>&nbsp;<span class="builtintype" id="8288590">byte</span><span class="op" id="8288594">(</span><span class="ident" id="8288595">i</span><span class="op" id="8288596">%</span><span class="num" id="8288597">10</span><span class="op" id="8288599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288607">for</span>&nbsp;<span class="ident" id="8288611">blockSize</span>&nbsp;<span class="op" id="8288621">:=</span>&nbsp;<span class="num" id="8288624">10</span><span class="op" id="8288626">;</span>&nbsp;<span class="ident" id="8288628">blockSize</span>&nbsp;<span class="op" id="8288638">&lt;=</span>&nbsp;<span class="ident" id="8288641">N</span><span class="op" id="8288642">;</span>&nbsp;<span class="ident" id="8288644">blockSize</span>&nbsp;<span class="op" id="8288654">*=</span>&nbsp;<span class="num" id="8288657">10</span>&nbsp;<span class="op" id="8288660">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288665">blocks</span>&nbsp;<span class="op" id="8288672">:=</span>&nbsp;<span class="ident" id="8288675">N</span>&nbsp;<span class="op" id="8288677">/</span>&nbsp;<span class="ident" id="8288679">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288692">b</span>&nbsp;<span class="op" id="8288694">:=</span>&nbsp;<span class="ident" id="8288697">block</span><span class="op" id="8288702">[</span><span class="ident" id="8288703">offset</span>&nbsp;<span class="op" id="8288710">:</span>&nbsp;<span class="ident" id="8288712">offset</span><span class="op" id="8288718">+</span><span class="ident" id="8288719">blockSize</span><span class="op" id="8288728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288733">c</span><span class="op" id="8288734">.</span><span class="ident" id="8288735">Reset</span><span class="op" id="8288740">(</span><span class="op" id="8288741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288746">for</span>&nbsp;<span class="ident" id="8288750">i</span>&nbsp;<span class="op" id="8288752">:=</span>&nbsp;<span class="num" id="8288755">0</span><span class="op" id="8288756">;</span>&nbsp;<span class="ident" id="8288758">i</span>&nbsp;<span class="op" id="8288760">&lt;</span>&nbsp;<span class="ident" id="8288762">blocks</span><span class="op" id="8288768">;</span>&nbsp;<span class="ident" id="8288770">i</span><span class="op" id="8288771">++</span>&nbsp;<span class="op" id="8288774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288780">c</span><span class="op" id="8288781">.</span><span class="ident" id="8288782">Write</span><span class="op" id="8288787">(</span><span class="ident" id="8288788">b</span><span class="op" id="8288789">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288799">s</span>&nbsp;<span class="op" id="8288801">:=</span>&nbsp;<span class="ident" id="8288804">fmt</span><span class="op" id="8288807">.</span><span class="ident" id="8288808">Sprintf</span><span class="op" id="8288815">(</span><span class="string" id="8288816">&#34;%x&#34;</span><span class="op" id="8288820">,</span>&nbsp;<span class="ident" id="8288822">c</span><span class="op" id="8288823">.</span><span class="ident" id="8288824">Sum</span><span class="op" id="8288827">(</span><span class="ident" id="8288828">nil</span><span class="op" id="8288831">)</span><span class="op" id="8288832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288837">if</span>&nbsp;<span class="ident" id="8288840">s</span>&nbsp;<span class="op" id="8288842">!=</span>&nbsp;<span class="ident" id="8288845">ok</span>&nbsp;<span class="op" id="8288848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288854">t</span><span class="op" id="8288855">.</span><span class="ident" id="8288856">Fatalf</span><span class="op" id="8288862">(</span><span class="string" id="8288863">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8288915">,</span>&nbsp;<span class="ident" id="8288917">offset</span><span class="op" id="8288923">,</span>&nbsp;<span class="ident" id="8288925">blockSize</span><span class="op" id="8288934">,</span>&nbsp;<span class="ident" id="8288936">s</span><span class="op" id="8288937">,</span>&nbsp;<span class="ident" id="8288939">ok</span><span class="op" id="8288941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288946">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288953">}</span><br>
<span class="lineno"></span><span class="op" id="8288955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8288958">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="8289046">func</span>&nbsp;<span class="ident" id="8289051">TestBlockGeneric</span><span class="op" id="8289067">(</span><span class="ident" id="8289068">t</span>&nbsp;<span class="op" id="8289070">*</span><span class="ident" id="8289071">testing</span><span class="op" id="8289078">.</span><span class="ident" id="8289079">T</span><span class="op" id="8289080">)</span>&nbsp;<span class="op" id="8289082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289085">gen</span><span class="op" id="8289088">,</span>&nbsp;<span class="ident" id="8289090">asm</span>&nbsp;<span class="op" id="8289094">:=</span>&nbsp;<span class="ident" id="8289097">New</span><span class="op" id="8289100">(</span><span class="op" id="8289101">)</span><span class="op" id="8289102">.</span><span class="op" id="8289103">(</span><span class="op" id="8289104">*</span><span class="ident" id="8289105">digest</span><span class="op" id="8289111">)</span><span class="op" id="8289112">,</span>&nbsp;<span class="ident" id="8289114">New</span><span class="op" id="8289117">(</span><span class="op" id="8289118">)</span><span class="op" id="8289119">.</span><span class="op" id="8289120">(</span><span class="op" id="8289121">*</span><span class="ident" id="8289122">digest</span><span class="op" id="8289128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289131">buf</span>&nbsp;<span class="op" id="8289135">:=</span>&nbsp;<span class="builtinfunc" id="8289138">make</span><span class="op" id="8289142">(</span><span class="op" id="8289143">[</span><span class="op" id="8289144">]</span><span class="builtintype" id="8289145">byte</span><span class="op" id="8289149">,</span>&nbsp;<span class="ident" id="8289151">BlockSize</span><span class="op" id="8289160">*</span><span class="num" id="8289161">20</span><span class="op" id="8289163">)</span>&nbsp;<span class="comment" id="8289165">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289186">rand</span><span class="op" id="8289190">.</span><span class="ident" id="8289191">Read</span><span class="op" id="8289195">(</span><span class="ident" id="8289196">buf</span><span class="op" id="8289199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289202">blockGeneric</span><span class="op" id="8289214">(</span><span class="ident" id="8289215">gen</span><span class="op" id="8289218">,</span>&nbsp;<span class="ident" id="8289220">buf</span><span class="op" id="8289223">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289226">block</span><span class="op" id="8289231">(</span><span class="ident" id="8289232">asm</span><span class="op" id="8289235">,</span>&nbsp;<span class="ident" id="8289237">buf</span><span class="op" id="8289240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289243">if</span>&nbsp;<span class="op" id="8289246">*</span><span class="ident" id="8289247">gen</span>&nbsp;<span class="op" id="8289251">!=</span>&nbsp;<span class="op" id="8289254">*</span><span class="ident" id="8289255">asm</span>&nbsp;<span class="op" id="8289259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289263">t</span><span class="op" id="8289264">.</span><span class="ident" id="8289265">Error</span><span class="op" id="8289270">(</span><span class="string" id="8289271">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="8289324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289327">}</span><br>
<span class="lineno"></span><span class="op" id="8289329">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8289332">var</span>&nbsp;<span class="ident" id="8289336">bench</span>&nbsp;<span class="op" id="8289342">=</span>&nbsp;<span class="ident" id="8289344">New</span><span class="op" id="8289347">(</span><span class="op" id="8289348">)</span><br>
<span class="lineno"></span><span class="keyword" id="8289350">var</span>&nbsp;<span class="ident" id="8289354">buf</span>&nbsp;<span class="op" id="8289358">=</span>&nbsp;<span class="builtinfunc" id="8289360">make</span><span class="op" id="8289364">(</span><span class="op" id="8289365">[</span><span class="op" id="8289366">]</span><span class="builtintype" id="8289367">byte</span><span class="op" id="8289371">,</span>&nbsp;<span class="num" id="8289373">8192</span><span class="op" id="8289377">+</span><span class="num" id="8289378">1</span><span class="op" id="8289379">)</span><br>
<span class="lineno"></span><span class="keyword" id="8289381">var</span>&nbsp;<span class="ident" id="8289385">sum</span>&nbsp;<span class="op" id="8289389">=</span>&nbsp;<span class="builtinfunc" id="8289391">make</span><span class="op" id="8289395">(</span><span class="op" id="8289396">[</span><span class="op" id="8289397">]</span><span class="builtintype" id="8289398">byte</span><span class="op" id="8289402">,</span>&nbsp;<span class="ident" id="8289404">bench</span><span class="op" id="8289409">.</span><span class="ident" id="8289410">Size</span><span class="op" id="8289414">(</span><span class="op" id="8289415">)</span><span class="op" id="8289416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="8289419">func</span>&nbsp;<span class="ident" id="8289424">benchmarkSize</span><span class="op" id="8289437">(</span><span class="ident" id="8289438">b</span>&nbsp;<span class="op" id="8289440">*</span><span class="ident" id="8289441">testing</span><span class="op" id="8289448">.</span><span class="ident" id="8289449">B</span><span class="op" id="8289450">,</span>&nbsp;<span class="ident" id="8289452">size</span>&nbsp;<span class="builtintype" id="8289457">int</span><span class="op" id="8289460">,</span>&nbsp;<span class="ident" id="8289462">unaligned</span>&nbsp;<span class="builtintype" id="8289472">bool</span><span class="op" id="8289476">)</span>&nbsp;<span class="op" id="8289478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289481">b</span><span class="op" id="8289482">.</span><span class="ident" id="8289483">SetBytes</span><span class="op" id="8289491">(</span><span class="ident" id="8289492">int64</span><span class="op" id="8289497">(</span><span class="ident" id="8289498">size</span><span class="op" id="8289502">)</span><span class="op" id="8289503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289506">buf</span>&nbsp;<span class="op" id="8289510">:=</span>&nbsp;<span class="ident" id="8289513">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289518">if</span>&nbsp;<span class="ident" id="8289521">unaligned</span>&nbsp;<span class="op" id="8289531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289535">if</span>&nbsp;<span class="builtintype" id="8289538">uintptr</span><span class="op" id="8289545">(</span><span class="ident" id="8289546">unsafe</span><span class="op" id="8289552">.</span><span class="ident" id="8289553">Pointer</span><span class="op" id="8289560">(</span><span class="op" id="8289561">&amp;</span><span class="ident" id="8289562">buf</span><span class="op" id="8289565">[</span><span class="num" id="8289566">0</span><span class="op" id="8289567">]</span><span class="op" id="8289568">)</span><span class="op" id="8289569">)</span><span class="op" id="8289570">&amp;</span><span class="op" id="8289571">(</span><span class="ident" id="8289572">unsafe</span><span class="op" id="8289578">.</span><span class="ident" id="8289579">Alignof</span><span class="op" id="8289586">(</span><span class="builtintype" id="8289587">uint32</span><span class="op" id="8289593">(</span><span class="num" id="8289594">0</span><span class="op" id="8289595">)</span><span class="op" id="8289596">)</span><span class="op" id="8289597">-</span><span class="num" id="8289598">1</span><span class="op" id="8289599">)</span>&nbsp;<span class="op" id="8289601">==</span>&nbsp;<span class="num" id="8289604">0</span>&nbsp;<span class="op" id="8289606">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289611">buf</span>&nbsp;<span class="op" id="8289615">=</span>&nbsp;<span class="ident" id="8289617">buf</span><span class="op" id="8289620">[</span><span class="num" id="8289621">1</span><span class="op" id="8289622">:</span><span class="op" id="8289623">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289633">b</span><span class="op" id="8289634">.</span><span class="ident" id="8289635">ResetTimer</span><span class="op" id="8289645">(</span><span class="op" id="8289646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289649">for</span>&nbsp;<span class="ident" id="8289653">i</span>&nbsp;<span class="op" id="8289655">:=</span>&nbsp;<span class="num" id="8289658">0</span><span class="op" id="8289659">;</span>&nbsp;<span class="ident" id="8289661">i</span>&nbsp;<span class="op" id="8289663">&lt;</span>&nbsp;<span class="ident" id="8289665">b</span><span class="op" id="8289666">.</span><span class="ident" id="8289667">N</span><span class="op" id="8289668">;</span>&nbsp;<span class="ident" id="8289670">i</span><span class="op" id="8289671">++</span>&nbsp;<span class="op" id="8289674">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289678">bench</span><span class="op" id="8289683">.</span><span class="ident" id="8289684">Reset</span><span class="op" id="8289689">(</span><span class="op" id="8289690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289694">bench</span><span class="op" id="8289699">.</span><span class="ident" id="8289700">Write</span><span class="op" id="8289705">(</span><span class="ident" id="8289706">buf</span><span class="op" id="8289709">[</span><span class="op" id="8289710">:</span><span class="ident" id="8289711">size</span><span class="op" id="8289715">]</span><span class="op" id="8289716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289720">bench</span><span class="op" id="8289725">.</span><span class="ident" id="8289726">Sum</span><span class="op" id="8289729">(</span><span class="ident" id="8289730">sum</span><span class="op" id="8289733">[</span><span class="op" id="8289734">:</span><span class="num" id="8289735">0</span><span class="op" id="8289736">]</span><span class="op" id="8289737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289740">}</span><br>
<span class="lineno"></span><span class="op" id="8289742">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8289745">func</span>&nbsp;<span class="ident" id="8289750">BenchmarkHash8Bytes</span><span class="op" id="8289769">(</span><span class="ident" id="8289770">b</span>&nbsp;<span class="op" id="8289772">*</span><span class="ident" id="8289773">testing</span><span class="op" id="8289780">.</span><span class="ident" id="8289781">B</span><span class="op" id="8289782">)</span>&nbsp;<span class="op" id="8289784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289787">benchmarkSize</span><span class="op" id="8289800">(</span><span class="ident" id="8289801">b</span><span class="op" id="8289802">,</span>&nbsp;<span class="num" id="8289804">8</span><span class="op" id="8289805">,</span>&nbsp;<span class="builtintype" id="8289807">false</span><span class="op" id="8289812">)</span><br>
<span class="lineno"></span><span class="op" id="8289814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="8289817">func</span>&nbsp;<span class="ident" id="8289822">BenchmarkHash1K</span><span class="op" id="8289837">(</span><span class="ident" id="8289838">b</span>&nbsp;<span class="op" id="8289840">*</span><span class="ident" id="8289841">testing</span><span class="op" id="8289848">.</span><span class="ident" id="8289849">B</span><span class="op" id="8289850">)</span>&nbsp;<span class="op" id="8289852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289855">benchmarkSize</span><span class="op" id="8289868">(</span><span class="ident" id="8289869">b</span><span class="op" id="8289870">,</span>&nbsp;<span class="num" id="8289872">1024</span><span class="op" id="8289876">,</span>&nbsp;<span class="builtintype" id="8289878">false</span><span class="op" id="8289883">)</span><br>
<span class="lineno"></span><span class="op" id="8289885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8289888">func</span>&nbsp;<span class="ident" id="8289893">BenchmarkHash8K</span><span class="op" id="8289908">(</span><span class="ident" id="8289909">b</span>&nbsp;<span class="op" id="8289911">*</span><span class="ident" id="8289912">testing</span><span class="op" id="8289919">.</span><span class="ident" id="8289920">B</span><span class="op" id="8289921">)</span>&nbsp;<span class="op" id="8289923">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289926">benchmarkSize</span><span class="op" id="8289939">(</span><span class="ident" id="8289940">b</span><span class="op" id="8289941">,</span>&nbsp;<span class="num" id="8289943">8192</span><span class="op" id="8289947">,</span>&nbsp;<span class="builtintype" id="8289949">false</span><span class="op" id="8289954">)</span><br>
<span class="lineno"></span><span class="op" id="8289956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8289959">func</span>&nbsp;<span class="ident" id="8289964">BenchmarkHash8BytesUnaligned</span><span class="op" id="8289992">(</span><span class="ident" id="8289993">b</span>&nbsp;<span class="op" id="8289995">*</span><span class="ident" id="8289996">testing</span><span class="op" id="8290003">.</span><span class="ident" id="8290004">B</span><span class="op" id="8290005">)</span>&nbsp;<span class="op" id="8290007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290010">benchmarkSize</span><span class="op" id="8290023">(</span><span class="ident" id="8290024">b</span><span class="op" id="8290025">,</span>&nbsp;<span class="num" id="8290027">8</span><span class="op" id="8290028">,</span>&nbsp;<span class="builtintype" id="8290030">true</span><span class="op" id="8290034">)</span><br>
<span class="lineno">155</span><span class="op" id="8290036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8290039">func</span>&nbsp;<span class="ident" id="8290044">BenchmarkHash1KUnaligned</span><span class="op" id="8290068">(</span><span class="ident" id="8290069">b</span>&nbsp;<span class="op" id="8290071">*</span><span class="ident" id="8290072">testing</span><span class="op" id="8290079">.</span><span class="ident" id="8290080">B</span><span class="op" id="8290081">)</span>&nbsp;<span class="op" id="8290083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290086">benchmarkSize</span><span class="op" id="8290099">(</span><span class="ident" id="8290100">b</span><span class="op" id="8290101">,</span>&nbsp;<span class="num" id="8290103">1024</span><span class="op" id="8290107">,</span>&nbsp;<span class="builtintype" id="8290109">true</span><span class="op" id="8290113">)</span><br>
<span class="lineno"></span><span class="op" id="8290115">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="8290118">func</span>&nbsp;<span class="ident" id="8290123">BenchmarkHash8KUnaligned</span><span class="op" id="8290147">(</span><span class="ident" id="8290148">b</span>&nbsp;<span class="op" id="8290150">*</span><span class="ident" id="8290151">testing</span><span class="op" id="8290158">.</span><span class="ident" id="8290159">B</span><span class="op" id="8290160">)</span>&nbsp;<span class="op" id="8290162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290165">benchmarkSize</span><span class="op" id="8290178">(</span><span class="ident" id="8290179">b</span><span class="op" id="8290180">,</span>&nbsp;<span class="num" id="8290182">8192</span><span class="op" id="8290186">,</span>&nbsp;<span class="builtintype" id="8290188">true</span><span class="op" id="8290192">)</span><br>
<span class="lineno"></span><span class="op" id="8290194">}</span>
</div>
</body>
</html>
