<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html" class="current">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1467047">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1467102">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1467156">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1467207">package</span>&nbsp;<span class="ident" id="1467215">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1467224">import</span>&nbsp;<span class="string" id="1467231">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1467241">//&nbsp;Breakpoint&nbsp;executes&nbsp;a&nbsp;breakpoint&nbsp;trap.</span><br>
<span class="lineno">10</span><span class="keyword" id="1467283">func</span>&nbsp;<span class="ident" id="1467288">Breakpoint</span><span class="op" id="1467298">(</span><span class="op" id="1467299">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1467302">//&nbsp;LockOSThread&nbsp;wires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;to&nbsp;its&nbsp;current&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1467386">//&nbsp;Until&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;exits&nbsp;or&nbsp;calls&nbsp;UnlockOSThread,&nbsp;it&nbsp;will&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="1467463">//&nbsp;execute&nbsp;in&nbsp;that&nbsp;thread,&nbsp;and&nbsp;no&nbsp;other&nbsp;goroutine&nbsp;can.</span><br>
<span class="lineno">15</span><span class="keyword" id="1467518">func</span>&nbsp;<span class="ident" id="1467523">LockOSThread</span><span class="op" id="1467535">(</span><span class="op" id="1467536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1467539">//&nbsp;UnlockOSThread&nbsp;unwires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;from&nbsp;its&nbsp;fixed&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1467627">//&nbsp;If&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;has&nbsp;not&nbsp;called&nbsp;LockOSThread,&nbsp;UnlockOSThread&nbsp;is&nbsp;a&nbsp;no-op.</span><br>
<span class="lineno"></span><span class="keyword" id="1467711">func</span>&nbsp;<span class="ident" id="1467716">UnlockOSThread</span><span class="op" id="1467730">(</span><span class="op" id="1467731">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1467734">//&nbsp;GOMAXPROCS&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;that&nbsp;can&nbsp;be&nbsp;executing</span><br>
<span class="lineno"></span><span class="comment" id="1467802">//&nbsp;simultaneously&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.&nbsp;&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;1,&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1467877">//&nbsp;change&nbsp;the&nbsp;current&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="1467908">//&nbsp;The&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine&nbsp;can&nbsp;be&nbsp;queried&nbsp;with&nbsp;NumCPU.</span><br>
<span class="lineno">25</span><span class="comment" id="1467987">//&nbsp;This&nbsp;call&nbsp;will&nbsp;go&nbsp;away&nbsp;when&nbsp;the&nbsp;scheduler&nbsp;improves.</span><br>
<span class="lineno"></span><span class="keyword" id="1468042">func</span>&nbsp;<span class="ident" id="1468047">GOMAXPROCS</span><span class="op" id="1468057">(</span><span class="ident" id="1468058">n</span>&nbsp;<span class="builtintype" id="1468060">int</span><span class="op" id="1468063">)</span>&nbsp;<span class="builtintype" id="1468065">int</span>&nbsp;<span class="op" id="1468069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468072">if</span>&nbsp;<span class="ident" id="1468075">n</span>&nbsp;<span class="op" id="1468077">&gt;</span>&nbsp;<span class="ident" id="1468079">_MaxGomaxprocs</span>&nbsp;<span class="op" id="1468094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468098">n</span>&nbsp;<span class="op" id="1468100">=</span>&nbsp;<span class="ident" id="1468102">_MaxGomaxprocs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1468118">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468121">lock</span><span class="op" id="1468125">(</span><span class="op" id="1468126">&amp;</span><span class="ident" id="1468127">sched</span><span class="op" id="1468132">.</span><span class="ident" id="1468133">lock</span><span class="op" id="1468137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468140">ret</span>&nbsp;<span class="op" id="1468144">:=</span>&nbsp;<span class="builtintype" id="1468147">int</span><span class="op" id="1468150">(</span><span class="ident" id="1468151">gomaxprocs</span><span class="op" id="1468161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468164">unlock</span><span class="op" id="1468170">(</span><span class="op" id="1468171">&amp;</span><span class="ident" id="1468172">sched</span><span class="op" id="1468177">.</span><span class="ident" id="1468178">lock</span><span class="op" id="1468182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468185">if</span>&nbsp;<span class="ident" id="1468188">n</span>&nbsp;<span class="op" id="1468190">&lt;=</span>&nbsp;<span class="num" id="1468193">0</span>&nbsp;<span class="op" id="1468195">||</span>&nbsp;<span class="ident" id="1468198">n</span>&nbsp;<span class="op" id="1468200">==</span>&nbsp;<span class="ident" id="1468203">ret</span>&nbsp;<span class="op" id="1468207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468211">return</span>&nbsp;<span class="ident" id="1468218">ret</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1468223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468227">semacquire</span><span class="op" id="1468237">(</span><span class="op" id="1468238">&amp;</span><span class="ident" id="1468239">worldsema</span><span class="op" id="1468248">,</span>&nbsp;<span class="builtintype" id="1468250">false</span><span class="op" id="1468255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468258">gp</span>&nbsp;<span class="op" id="1468261">:=</span>&nbsp;<span class="ident" id="1468264">getg</span><span class="op" id="1468268">(</span><span class="op" id="1468269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468272">gp</span><span class="op" id="1468274">.</span><span class="ident" id="1468275">m</span><span class="op" id="1468276">.</span><span class="ident" id="1468277">gcing</span>&nbsp;<span class="op" id="1468283">=</span>&nbsp;<span class="num" id="1468285">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468288">onM</span><span class="op" id="1468291">(</span><span class="ident" id="1468292">stoptheworld</span><span class="op" id="1468304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1468308">//&nbsp;newprocs&nbsp;will&nbsp;be&nbsp;processed&nbsp;by&nbsp;starttheworld</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468356">newprocs</span>&nbsp;<span class="op" id="1468365">=</span>&nbsp;<span class="builtintype" id="1468367">int32</span><span class="op" id="1468372">(</span><span class="ident" id="1468373">n</span><span class="op" id="1468374">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468378">gp</span><span class="op" id="1468380">.</span><span class="ident" id="1468381">m</span><span class="op" id="1468382">.</span><span class="ident" id="1468383">gcing</span>&nbsp;<span class="op" id="1468389">=</span>&nbsp;<span class="num" id="1468391">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468394">semrelease</span><span class="op" id="1468404">(</span><span class="op" id="1468405">&amp;</span><span class="ident" id="1468406">worldsema</span><span class="op" id="1468415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468418">onM</span><span class="op" id="1468421">(</span><span class="ident" id="1468422">starttheworld</span><span class="op" id="1468435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468438">return</span>&nbsp;<span class="ident" id="1468445">ret</span><br>
<span class="lineno"></span><span class="op" id="1468449">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="1468452">//&nbsp;NumCPU&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="1468519">func</span>&nbsp;<span class="ident" id="1468524">NumCPU</span><span class="op" id="1468530">(</span><span class="op" id="1468531">)</span>&nbsp;<span class="builtintype" id="1468533">int</span>&nbsp;<span class="op" id="1468537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468540">return</span>&nbsp;<span class="builtintype" id="1468547">int</span><span class="op" id="1468550">(</span><span class="ident" id="1468551">ncpu</span><span class="op" id="1468555">)</span><br>
<span class="lineno"></span><span class="op" id="1468557">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1468560">//&nbsp;NumCgoCall&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;cgo&nbsp;calls&nbsp;made&nbsp;by&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="1468635">func</span>&nbsp;<span class="ident" id="1468640">NumCgoCall</span><span class="op" id="1468650">(</span><span class="op" id="1468651">)</span>&nbsp;<span class="ident" id="1468653">int64</span>&nbsp;<span class="op" id="1468659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468662">var</span>&nbsp;<span class="ident" id="1468666">n</span>&nbsp;<span class="ident" id="1468668">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468675">for</span>&nbsp;<span class="ident" id="1468679">mp</span>&nbsp;<span class="op" id="1468682">:=</span>&nbsp;<span class="op" id="1468685">(</span><span class="op" id="1468686">*</span><span class="ident" id="1468687">m</span><span class="op" id="1468688">)</span><span class="op" id="1468689">(</span><span class="ident" id="1468690">atomicloadp</span><span class="op" id="1468701">(</span><span class="ident" id="1468702">unsafe</span><span class="op" id="1468708">.</span><span class="ident" id="1468709">Pointer</span><span class="op" id="1468716">(</span><span class="op" id="1468717">&amp;</span><span class="ident" id="1468718">allm</span><span class="op" id="1468722">)</span><span class="op" id="1468723">)</span><span class="op" id="1468724">)</span><span class="op" id="1468725">;</span>&nbsp;<span class="ident" id="1468727">mp</span>&nbsp;<span class="op" id="1468730">!=</span>&nbsp;<span class="ident" id="1468733">nil</span><span class="op" id="1468736">;</span>&nbsp;<span class="ident" id="1468738">mp</span>&nbsp;<span class="op" id="1468741">=</span>&nbsp;<span class="ident" id="1468743">mp</span><span class="op" id="1468745">.</span><span class="ident" id="1468746">alllink</span>&nbsp;<span class="op" id="1468754">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1468758">n</span>&nbsp;<span class="op" id="1468760">+=</span>&nbsp;<span class="ident" id="1468763">int64</span><span class="op" id="1468768">(</span><span class="ident" id="1468769">mp</span><span class="op" id="1468771">.</span><span class="ident" id="1468772">ncgocall</span><span class="op" id="1468780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1468783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468786">return</span>&nbsp;<span class="ident" id="1468793">n</span><br>
<span class="lineno"></span><span class="op" id="1468795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="1468798">//&nbsp;NumGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines&nbsp;that&nbsp;currently&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="1468869">func</span>&nbsp;<span class="ident" id="1468874">NumGoroutine</span><span class="op" id="1468886">(</span><span class="op" id="1468887">)</span>&nbsp;<span class="builtintype" id="1468889">int</span>&nbsp;<span class="op" id="1468893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1468896">return</span>&nbsp;<span class="builtintype" id="1468903">int</span><span class="op" id="1468906">(</span><span class="ident" id="1468907">gcount</span><span class="op" id="1468913">(</span><span class="op" id="1468914">)</span><span class="op" id="1468915">)</span><br>
<span class="lineno"></span><span class="op" id="1468917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="1468920">func</span>&nbsp;<span class="ident" id="1468925">gcount</span><span class="op" id="1468931">(</span><span class="op" id="1468932">)</span>&nbsp;<span class="builtintype" id="1468934">int32</span>
</div>
</body>
</html>
