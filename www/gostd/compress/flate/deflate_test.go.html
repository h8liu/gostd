<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6755276">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6755331">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6755385">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6755436">package</span>&nbsp;<span class="ident" id="6755444">flate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6755451">import</span>&nbsp;<span class="op" id="6755458">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755461">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755470">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755477">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755483">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755496">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755507">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6755515">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6755525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6755528">type</span>&nbsp;<span class="ident" id="6755533">deflateTest</span>&nbsp;<span class="keyword" id="6755545">struct</span>&nbsp;<span class="op" id="6755552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755555">in</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755561">[</span><span class="op" id="6755562">]</span><span class="builtintype" id="6755563">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755569">level</span>&nbsp;<span class="builtintype" id="6755575">int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755580">out</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6755586">[</span><span class="op" id="6755587">]</span><span class="builtintype" id="6755588">byte</span><br>
<span class="lineno"></span><span class="op" id="6755593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6755596">type</span>&nbsp;<span class="ident" id="6755601">deflateInflateTest</span>&nbsp;<span class="keyword" id="6755620">struct</span>&nbsp;<span class="op" id="6755627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755630">in</span>&nbsp;<span class="op" id="6755633">[</span><span class="op" id="6755634">]</span><span class="builtintype" id="6755635">byte</span><br>
<span class="lineno">25</span><span class="op" id="6755640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6755643">type</span>&nbsp;<span class="ident" id="6755648">reverseBitsTest</span>&nbsp;<span class="keyword" id="6755664">struct</span>&nbsp;<span class="op" id="6755671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755674">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6755683">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755691">bitCount</span>&nbsp;<span class="builtintype" id="6755700">uint8</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6755707">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6755716">uint16</span><br>
<span class="lineno"></span><span class="op" id="6755723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6755726">var</span>&nbsp;<span class="ident" id="6755730">deflateTests</span>&nbsp;<span class="op" id="6755743">=</span>&nbsp;<span class="op" id="6755745">[</span><span class="op" id="6755746">]</span><span class="op" id="6755747">*</span><span class="ident" id="6755748">deflateTest</span><span class="op" id="6755759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6755762">{</span><span class="op" id="6755763">[</span><span class="op" id="6755764">]</span><span class="builtintype" id="6755765">byte</span><span class="op" id="6755769">{</span><span class="op" id="6755770">}</span><span class="op" id="6755771">,</span>&nbsp;<span class="num" id="6755773">0</span><span class="op" id="6755774">,</span>&nbsp;<span class="op" id="6755776">[</span><span class="op" id="6755777">]</span><span class="builtintype" id="6755778">byte</span><span class="op" id="6755782">{</span><span class="num" id="6755783">1</span><span class="op" id="6755784">,</span>&nbsp;<span class="num" id="6755786">0</span><span class="op" id="6755787">,</span>&nbsp;<span class="num" id="6755789">0</span><span class="op" id="6755790">,</span>&nbsp;<span class="num" id="6755792">255</span><span class="op" id="6755795">,</span>&nbsp;<span class="num" id="6755797">255</span><span class="op" id="6755800">}</span><span class="op" id="6755801">}</span><span class="op" id="6755802">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6755805">{</span><span class="op" id="6755806">[</span><span class="op" id="6755807">]</span><span class="builtintype" id="6755808">byte</span><span class="op" id="6755812">{</span><span class="num" id="6755813">0x11</span><span class="op" id="6755817">}</span><span class="op" id="6755818">,</span>&nbsp;<span class="op" id="6755820">-</span><span class="num" id="6755821">1</span><span class="op" id="6755822">,</span>&nbsp;<span class="op" id="6755824">[</span><span class="op" id="6755825">]</span><span class="builtintype" id="6755826">byte</span><span class="op" id="6755830">{</span><span class="num" id="6755831">18</span><span class="op" id="6755833">,</span>&nbsp;<span class="num" id="6755835">4</span><span class="op" id="6755836">,</span>&nbsp;<span class="num" id="6755838">4</span><span class="op" id="6755839">,</span>&nbsp;<span class="num" id="6755841">0</span><span class="op" id="6755842">,</span>&nbsp;<span class="num" id="6755844">0</span><span class="op" id="6755845">,</span>&nbsp;<span class="num" id="6755847">255</span><span class="op" id="6755850">,</span>&nbsp;<span class="num" id="6755852">255</span><span class="op" id="6755855">}</span><span class="op" id="6755856">}</span><span class="op" id="6755857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6755860">{</span><span class="op" id="6755861">[</span><span class="op" id="6755862">]</span><span class="builtintype" id="6755863">byte</span><span class="op" id="6755867">{</span><span class="num" id="6755868">0x11</span><span class="op" id="6755872">}</span><span class="op" id="6755873">,</span>&nbsp;<span class="ident" id="6755875">DefaultCompression</span><span class="op" id="6755893">,</span>&nbsp;<span class="op" id="6755895">[</span><span class="op" id="6755896">]</span><span class="builtintype" id="6755897">byte</span><span class="op" id="6755901">{</span><span class="num" id="6755902">18</span><span class="op" id="6755904">,</span>&nbsp;<span class="num" id="6755906">4</span><span class="op" id="6755907">,</span>&nbsp;<span class="num" id="6755909">4</span><span class="op" id="6755910">,</span>&nbsp;<span class="num" id="6755912">0</span><span class="op" id="6755913">,</span>&nbsp;<span class="num" id="6755915">0</span><span class="op" id="6755916">,</span>&nbsp;<span class="num" id="6755918">255</span><span class="op" id="6755921">,</span>&nbsp;<span class="num" id="6755923">255</span><span class="op" id="6755926">}</span><span class="op" id="6755927">}</span><span class="op" id="6755928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6755931">{</span><span class="op" id="6755932">[</span><span class="op" id="6755933">]</span><span class="builtintype" id="6755934">byte</span><span class="op" id="6755938">{</span><span class="num" id="6755939">0x11</span><span class="op" id="6755943">}</span><span class="op" id="6755944">,</span>&nbsp;<span class="num" id="6755946">4</span><span class="op" id="6755947">,</span>&nbsp;<span class="op" id="6755949">[</span><span class="op" id="6755950">]</span><span class="builtintype" id="6755951">byte</span><span class="op" id="6755955">{</span><span class="num" id="6755956">18</span><span class="op" id="6755958">,</span>&nbsp;<span class="num" id="6755960">4</span><span class="op" id="6755961">,</span>&nbsp;<span class="num" id="6755963">4</span><span class="op" id="6755964">,</span>&nbsp;<span class="num" id="6755966">0</span><span class="op" id="6755967">,</span>&nbsp;<span class="num" id="6755969">0</span><span class="op" id="6755970">,</span>&nbsp;<span class="num" id="6755972">255</span><span class="op" id="6755975">,</span>&nbsp;<span class="num" id="6755977">255</span><span class="op" id="6755980">}</span><span class="op" id="6755981">}</span><span class="op" id="6755982">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6755986">{</span><span class="op" id="6755987">[</span><span class="op" id="6755988">]</span><span class="builtintype" id="6755989">byte</span><span class="op" id="6755993">{</span><span class="num" id="6755994">0x11</span><span class="op" id="6755998">}</span><span class="op" id="6755999">,</span>&nbsp;<span class="num" id="6756001">0</span><span class="op" id="6756002">,</span>&nbsp;<span class="op" id="6756004">[</span><span class="op" id="6756005">]</span><span class="builtintype" id="6756006">byte</span><span class="op" id="6756010">{</span><span class="num" id="6756011">0</span><span class="op" id="6756012">,</span>&nbsp;<span class="num" id="6756014">1</span><span class="op" id="6756015">,</span>&nbsp;<span class="num" id="6756017">0</span><span class="op" id="6756018">,</span>&nbsp;<span class="num" id="6756020">254</span><span class="op" id="6756023">,</span>&nbsp;<span class="num" id="6756025">255</span><span class="op" id="6756028">,</span>&nbsp;<span class="num" id="6756030">17</span><span class="op" id="6756032">,</span>&nbsp;<span class="num" id="6756034">1</span><span class="op" id="6756035">,</span>&nbsp;<span class="num" id="6756037">0</span><span class="op" id="6756038">,</span>&nbsp;<span class="num" id="6756040">0</span><span class="op" id="6756041">,</span>&nbsp;<span class="num" id="6756043">255</span><span class="op" id="6756046">,</span>&nbsp;<span class="num" id="6756048">255</span><span class="op" id="6756051">}</span><span class="op" id="6756052">}</span><span class="op" id="6756053">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756056">{</span><span class="op" id="6756057">[</span><span class="op" id="6756058">]</span><span class="builtintype" id="6756059">byte</span><span class="op" id="6756063">{</span><span class="num" id="6756064">0x11</span><span class="op" id="6756068">,</span>&nbsp;<span class="num" id="6756070">0x12</span><span class="op" id="6756074">}</span><span class="op" id="6756075">,</span>&nbsp;<span class="num" id="6756077">0</span><span class="op" id="6756078">,</span>&nbsp;<span class="op" id="6756080">[</span><span class="op" id="6756081">]</span><span class="builtintype" id="6756082">byte</span><span class="op" id="6756086">{</span><span class="num" id="6756087">0</span><span class="op" id="6756088">,</span>&nbsp;<span class="num" id="6756090">2</span><span class="op" id="6756091">,</span>&nbsp;<span class="num" id="6756093">0</span><span class="op" id="6756094">,</span>&nbsp;<span class="num" id="6756096">253</span><span class="op" id="6756099">,</span>&nbsp;<span class="num" id="6756101">255</span><span class="op" id="6756104">,</span>&nbsp;<span class="num" id="6756106">17</span><span class="op" id="6756108">,</span>&nbsp;<span class="num" id="6756110">18</span><span class="op" id="6756112">,</span>&nbsp;<span class="num" id="6756114">1</span><span class="op" id="6756115">,</span>&nbsp;<span class="num" id="6756117">0</span><span class="op" id="6756118">,</span>&nbsp;<span class="num" id="6756120">0</span><span class="op" id="6756121">,</span>&nbsp;<span class="num" id="6756123">255</span><span class="op" id="6756126">,</span>&nbsp;<span class="num" id="6756128">255</span><span class="op" id="6756131">}</span><span class="op" id="6756132">}</span><span class="op" id="6756133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756136">{</span><span class="op" id="6756137">[</span><span class="op" id="6756138">]</span><span class="builtintype" id="6756139">byte</span><span class="op" id="6756143">{</span><span class="num" id="6756144">0x11</span><span class="op" id="6756148">,</span>&nbsp;<span class="num" id="6756150">0x11</span><span class="op" id="6756154">,</span>&nbsp;<span class="num" id="6756156">0x11</span><span class="op" id="6756160">,</span>&nbsp;<span class="num" id="6756162">0x11</span><span class="op" id="6756166">,</span>&nbsp;<span class="num" id="6756168">0x11</span><span class="op" id="6756172">,</span>&nbsp;<span class="num" id="6756174">0x11</span><span class="op" id="6756178">,</span>&nbsp;<span class="num" id="6756180">0x11</span><span class="op" id="6756184">,</span>&nbsp;<span class="num" id="6756186">0x11</span><span class="op" id="6756190">}</span><span class="op" id="6756191">,</span>&nbsp;<span class="num" id="6756193">0</span><span class="op" id="6756194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756198">[</span><span class="op" id="6756199">]</span><span class="builtintype" id="6756200">byte</span><span class="op" id="6756204">{</span><span class="num" id="6756205">0</span><span class="op" id="6756206">,</span>&nbsp;<span class="num" id="6756208">8</span><span class="op" id="6756209">,</span>&nbsp;<span class="num" id="6756211">0</span><span class="op" id="6756212">,</span>&nbsp;<span class="num" id="6756214">247</span><span class="op" id="6756217">,</span>&nbsp;<span class="num" id="6756219">255</span><span class="op" id="6756222">,</span>&nbsp;<span class="num" id="6756224">17</span><span class="op" id="6756226">,</span>&nbsp;<span class="num" id="6756228">17</span><span class="op" id="6756230">,</span>&nbsp;<span class="num" id="6756232">17</span><span class="op" id="6756234">,</span>&nbsp;<span class="num" id="6756236">17</span><span class="op" id="6756238">,</span>&nbsp;<span class="num" id="6756240">17</span><span class="op" id="6756242">,</span>&nbsp;<span class="num" id="6756244">17</span><span class="op" id="6756246">,</span>&nbsp;<span class="num" id="6756248">17</span><span class="op" id="6756250">,</span>&nbsp;<span class="num" id="6756252">17</span><span class="op" id="6756254">,</span>&nbsp;<span class="num" id="6756256">1</span><span class="op" id="6756257">,</span>&nbsp;<span class="num" id="6756259">0</span><span class="op" id="6756260">,</span>&nbsp;<span class="num" id="6756262">0</span><span class="op" id="6756263">,</span>&nbsp;<span class="num" id="6756265">255</span><span class="op" id="6756268">,</span>&nbsp;<span class="num" id="6756270">255</span><span class="op" id="6756273">}</span><span class="op" id="6756274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756277">}</span><span class="op" id="6756278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756281">{</span><span class="op" id="6756282">[</span><span class="op" id="6756283">]</span><span class="builtintype" id="6756284">byte</span><span class="op" id="6756288">{</span><span class="op" id="6756289">}</span><span class="op" id="6756290">,</span>&nbsp;<span class="num" id="6756292">1</span><span class="op" id="6756293">,</span>&nbsp;<span class="op" id="6756295">[</span><span class="op" id="6756296">]</span><span class="builtintype" id="6756297">byte</span><span class="op" id="6756301">{</span><span class="num" id="6756302">1</span><span class="op" id="6756303">,</span>&nbsp;<span class="num" id="6756305">0</span><span class="op" id="6756306">,</span>&nbsp;<span class="num" id="6756308">0</span><span class="op" id="6756309">,</span>&nbsp;<span class="num" id="6756311">255</span><span class="op" id="6756314">,</span>&nbsp;<span class="num" id="6756316">255</span><span class="op" id="6756319">}</span><span class="op" id="6756320">}</span><span class="op" id="6756321">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756324">{</span><span class="op" id="6756325">[</span><span class="op" id="6756326">]</span><span class="builtintype" id="6756327">byte</span><span class="op" id="6756331">{</span><span class="num" id="6756332">0x11</span><span class="op" id="6756336">}</span><span class="op" id="6756337">,</span>&nbsp;<span class="num" id="6756339">1</span><span class="op" id="6756340">,</span>&nbsp;<span class="op" id="6756342">[</span><span class="op" id="6756343">]</span><span class="builtintype" id="6756344">byte</span><span class="op" id="6756348">{</span><span class="num" id="6756349">18</span><span class="op" id="6756351">,</span>&nbsp;<span class="num" id="6756353">4</span><span class="op" id="6756354">,</span>&nbsp;<span class="num" id="6756356">4</span><span class="op" id="6756357">,</span>&nbsp;<span class="num" id="6756359">0</span><span class="op" id="6756360">,</span>&nbsp;<span class="num" id="6756362">0</span><span class="op" id="6756363">,</span>&nbsp;<span class="num" id="6756365">255</span><span class="op" id="6756368">,</span>&nbsp;<span class="num" id="6756370">255</span><span class="op" id="6756373">}</span><span class="op" id="6756374">}</span><span class="op" id="6756375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756378">{</span><span class="op" id="6756379">[</span><span class="op" id="6756380">]</span><span class="builtintype" id="6756381">byte</span><span class="op" id="6756385">{</span><span class="num" id="6756386">0x11</span><span class="op" id="6756390">,</span>&nbsp;<span class="num" id="6756392">0x12</span><span class="op" id="6756396">}</span><span class="op" id="6756397">,</span>&nbsp;<span class="num" id="6756399">1</span><span class="op" id="6756400">,</span>&nbsp;<span class="op" id="6756402">[</span><span class="op" id="6756403">]</span><span class="builtintype" id="6756404">byte</span><span class="op" id="6756408">{</span><span class="num" id="6756409">18</span><span class="op" id="6756411">,</span>&nbsp;<span class="num" id="6756413">20</span><span class="op" id="6756415">,</span>&nbsp;<span class="num" id="6756417">2</span><span class="op" id="6756418">,</span>&nbsp;<span class="num" id="6756420">4</span><span class="op" id="6756421">,</span>&nbsp;<span class="num" id="6756423">0</span><span class="op" id="6756424">,</span>&nbsp;<span class="num" id="6756426">0</span><span class="op" id="6756427">,</span>&nbsp;<span class="num" id="6756429">255</span><span class="op" id="6756432">,</span>&nbsp;<span class="num" id="6756434">255</span><span class="op" id="6756437">}</span><span class="op" id="6756438">}</span><span class="op" id="6756439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756442">{</span><span class="op" id="6756443">[</span><span class="op" id="6756444">]</span><span class="builtintype" id="6756445">byte</span><span class="op" id="6756449">{</span><span class="num" id="6756450">0x11</span><span class="op" id="6756454">,</span>&nbsp;<span class="num" id="6756456">0x11</span><span class="op" id="6756460">,</span>&nbsp;<span class="num" id="6756462">0x11</span><span class="op" id="6756466">,</span>&nbsp;<span class="num" id="6756468">0x11</span><span class="op" id="6756472">,</span>&nbsp;<span class="num" id="6756474">0x11</span><span class="op" id="6756478">,</span>&nbsp;<span class="num" id="6756480">0x11</span><span class="op" id="6756484">,</span>&nbsp;<span class="num" id="6756486">0x11</span><span class="op" id="6756490">,</span>&nbsp;<span class="num" id="6756492">0x11</span><span class="op" id="6756496">}</span><span class="op" id="6756497">,</span>&nbsp;<span class="num" id="6756499">1</span><span class="op" id="6756500">,</span>&nbsp;<span class="op" id="6756502">[</span><span class="op" id="6756503">]</span><span class="builtintype" id="6756504">byte</span><span class="op" id="6756508">{</span><span class="num" id="6756509">18</span><span class="op" id="6756511">,</span>&nbsp;<span class="num" id="6756513">132</span><span class="op" id="6756516">,</span>&nbsp;<span class="num" id="6756518">2</span><span class="op" id="6756519">,</span>&nbsp;<span class="num" id="6756521">64</span><span class="op" id="6756523">,</span>&nbsp;<span class="num" id="6756525">0</span><span class="op" id="6756526">,</span>&nbsp;<span class="num" id="6756528">0</span><span class="op" id="6756529">,</span>&nbsp;<span class="num" id="6756531">0</span><span class="op" id="6756532">,</span>&nbsp;<span class="num" id="6756534">255</span><span class="op" id="6756537">,</span>&nbsp;<span class="num" id="6756539">255</span><span class="op" id="6756542">}</span><span class="op" id="6756543">}</span><span class="op" id="6756544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756547">{</span><span class="op" id="6756548">[</span><span class="op" id="6756549">]</span><span class="builtintype" id="6756550">byte</span><span class="op" id="6756554">{</span><span class="op" id="6756555">}</span><span class="op" id="6756556">,</span>&nbsp;<span class="num" id="6756558">9</span><span class="op" id="6756559">,</span>&nbsp;<span class="op" id="6756561">[</span><span class="op" id="6756562">]</span><span class="builtintype" id="6756563">byte</span><span class="op" id="6756567">{</span><span class="num" id="6756568">1</span><span class="op" id="6756569">,</span>&nbsp;<span class="num" id="6756571">0</span><span class="op" id="6756572">,</span>&nbsp;<span class="num" id="6756574">0</span><span class="op" id="6756575">,</span>&nbsp;<span class="num" id="6756577">255</span><span class="op" id="6756580">,</span>&nbsp;<span class="num" id="6756582">255</span><span class="op" id="6756585">}</span><span class="op" id="6756586">}</span><span class="op" id="6756587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756590">{</span><span class="op" id="6756591">[</span><span class="op" id="6756592">]</span><span class="builtintype" id="6756593">byte</span><span class="op" id="6756597">{</span><span class="num" id="6756598">0x11</span><span class="op" id="6756602">}</span><span class="op" id="6756603">,</span>&nbsp;<span class="num" id="6756605">9</span><span class="op" id="6756606">,</span>&nbsp;<span class="op" id="6756608">[</span><span class="op" id="6756609">]</span><span class="builtintype" id="6756610">byte</span><span class="op" id="6756614">{</span><span class="num" id="6756615">18</span><span class="op" id="6756617">,</span>&nbsp;<span class="num" id="6756619">4</span><span class="op" id="6756620">,</span>&nbsp;<span class="num" id="6756622">4</span><span class="op" id="6756623">,</span>&nbsp;<span class="num" id="6756625">0</span><span class="op" id="6756626">,</span>&nbsp;<span class="num" id="6756628">0</span><span class="op" id="6756629">,</span>&nbsp;<span class="num" id="6756631">255</span><span class="op" id="6756634">,</span>&nbsp;<span class="num" id="6756636">255</span><span class="op" id="6756639">}</span><span class="op" id="6756640">}</span><span class="op" id="6756641">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756644">{</span><span class="op" id="6756645">[</span><span class="op" id="6756646">]</span><span class="builtintype" id="6756647">byte</span><span class="op" id="6756651">{</span><span class="num" id="6756652">0x11</span><span class="op" id="6756656">,</span>&nbsp;<span class="num" id="6756658">0x12</span><span class="op" id="6756662">}</span><span class="op" id="6756663">,</span>&nbsp;<span class="num" id="6756665">9</span><span class="op" id="6756666">,</span>&nbsp;<span class="op" id="6756668">[</span><span class="op" id="6756669">]</span><span class="builtintype" id="6756670">byte</span><span class="op" id="6756674">{</span><span class="num" id="6756675">18</span><span class="op" id="6756677">,</span>&nbsp;<span class="num" id="6756679">20</span><span class="op" id="6756681">,</span>&nbsp;<span class="num" id="6756683">2</span><span class="op" id="6756684">,</span>&nbsp;<span class="num" id="6756686">4</span><span class="op" id="6756687">,</span>&nbsp;<span class="num" id="6756689">0</span><span class="op" id="6756690">,</span>&nbsp;<span class="num" id="6756692">0</span><span class="op" id="6756693">,</span>&nbsp;<span class="num" id="6756695">255</span><span class="op" id="6756698">,</span>&nbsp;<span class="num" id="6756700">255</span><span class="op" id="6756703">}</span><span class="op" id="6756704">}</span><span class="op" id="6756705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756708">{</span><span class="op" id="6756709">[</span><span class="op" id="6756710">]</span><span class="builtintype" id="6756711">byte</span><span class="op" id="6756715">{</span><span class="num" id="6756716">0x11</span><span class="op" id="6756720">,</span>&nbsp;<span class="num" id="6756722">0x11</span><span class="op" id="6756726">,</span>&nbsp;<span class="num" id="6756728">0x11</span><span class="op" id="6756732">,</span>&nbsp;<span class="num" id="6756734">0x11</span><span class="op" id="6756738">,</span>&nbsp;<span class="num" id="6756740">0x11</span><span class="op" id="6756744">,</span>&nbsp;<span class="num" id="6756746">0x11</span><span class="op" id="6756750">,</span>&nbsp;<span class="num" id="6756752">0x11</span><span class="op" id="6756756">,</span>&nbsp;<span class="num" id="6756758">0x11</span><span class="op" id="6756762">}</span><span class="op" id="6756763">,</span>&nbsp;<span class="num" id="6756765">9</span><span class="op" id="6756766">,</span>&nbsp;<span class="op" id="6756768">[</span><span class="op" id="6756769">]</span><span class="builtintype" id="6756770">byte</span><span class="op" id="6756774">{</span><span class="num" id="6756775">18</span><span class="op" id="6756777">,</span>&nbsp;<span class="num" id="6756779">132</span><span class="op" id="6756782">,</span>&nbsp;<span class="num" id="6756784">2</span><span class="op" id="6756785">,</span>&nbsp;<span class="num" id="6756787">64</span><span class="op" id="6756789">,</span>&nbsp;<span class="num" id="6756791">0</span><span class="op" id="6756792">,</span>&nbsp;<span class="num" id="6756794">0</span><span class="op" id="6756795">,</span>&nbsp;<span class="num" id="6756797">0</span><span class="op" id="6756798">,</span>&nbsp;<span class="num" id="6756800">255</span><span class="op" id="6756803">,</span>&nbsp;<span class="num" id="6756805">255</span><span class="op" id="6756808">}</span><span class="op" id="6756809">}</span><span class="op" id="6756810">,</span><br>
<span class="lineno"></span><span class="op" id="6756812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6756815">var</span>&nbsp;<span class="ident" id="6756819">deflateInflateTests</span>&nbsp;<span class="op" id="6756839">=</span>&nbsp;<span class="op" id="6756841">[</span><span class="op" id="6756842">]</span><span class="op" id="6756843">*</span><span class="ident" id="6756844">deflateInflateTest</span><span class="op" id="6756862">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756865">{</span><span class="op" id="6756866">[</span><span class="op" id="6756867">]</span><span class="builtintype" id="6756868">byte</span><span class="op" id="6756872">{</span><span class="op" id="6756873">}</span><span class="op" id="6756874">}</span><span class="op" id="6756875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756878">{</span><span class="op" id="6756879">[</span><span class="op" id="6756880">]</span><span class="builtintype" id="6756881">byte</span><span class="op" id="6756885">{</span><span class="num" id="6756886">0x11</span><span class="op" id="6756890">}</span><span class="op" id="6756891">}</span><span class="op" id="6756892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756895">{</span><span class="op" id="6756896">[</span><span class="op" id="6756897">]</span><span class="builtintype" id="6756898">byte</span><span class="op" id="6756902">{</span><span class="num" id="6756903">0x11</span><span class="op" id="6756907">,</span>&nbsp;<span class="num" id="6756909">0x12</span><span class="op" id="6756913">}</span><span class="op" id="6756914">}</span><span class="op" id="6756915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756918">{</span><span class="op" id="6756919">[</span><span class="op" id="6756920">]</span><span class="builtintype" id="6756921">byte</span><span class="op" id="6756925">{</span><span class="num" id="6756926">0x11</span><span class="op" id="6756930">,</span>&nbsp;<span class="num" id="6756932">0x11</span><span class="op" id="6756936">,</span>&nbsp;<span class="num" id="6756938">0x11</span><span class="op" id="6756942">,</span>&nbsp;<span class="num" id="6756944">0x11</span><span class="op" id="6756948">,</span>&nbsp;<span class="num" id="6756950">0x11</span><span class="op" id="6756954">,</span>&nbsp;<span class="num" id="6756956">0x11</span><span class="op" id="6756960">,</span>&nbsp;<span class="num" id="6756962">0x11</span><span class="op" id="6756966">,</span>&nbsp;<span class="num" id="6756968">0x11</span><span class="op" id="6756972">}</span><span class="op" id="6756973">}</span><span class="op" id="6756974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6756977">{</span><span class="op" id="6756978">[</span><span class="op" id="6756979">]</span><span class="builtintype" id="6756980">byte</span><span class="op" id="6756984">{</span><span class="num" id="6756985">0x11</span><span class="op" id="6756989">,</span>&nbsp;<span class="num" id="6756991">0x10</span><span class="op" id="6756995">,</span>&nbsp;<span class="num" id="6756997">0x13</span><span class="op" id="6757001">,</span>&nbsp;<span class="num" id="6757003">0x41</span><span class="op" id="6757007">,</span>&nbsp;<span class="num" id="6757009">0x21</span><span class="op" id="6757013">,</span>&nbsp;<span class="num" id="6757015">0x21</span><span class="op" id="6757019">,</span>&nbsp;<span class="num" id="6757021">0x41</span><span class="op" id="6757025">,</span>&nbsp;<span class="num" id="6757027">0x13</span><span class="op" id="6757031">,</span>&nbsp;<span class="num" id="6757033">0x87</span><span class="op" id="6757037">,</span>&nbsp;<span class="num" id="6757039">0x78</span><span class="op" id="6757043">,</span>&nbsp;<span class="num" id="6757045">0x13</span><span class="op" id="6757049">}</span><span class="op" id="6757050">}</span><span class="op" id="6757051">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757054">{</span><span class="ident" id="6757055">largeDataChunk</span><span class="op" id="6757069">(</span><span class="op" id="6757070">)</span><span class="op" id="6757071">}</span><span class="op" id="6757072">,</span><br>
<span class="lineno"></span><span class="op" id="6757074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6757077">var</span>&nbsp;<span class="ident" id="6757081">reverseBitsTests</span>&nbsp;<span class="op" id="6757098">=</span>&nbsp;<span class="op" id="6757100">[</span><span class="op" id="6757101">]</span><span class="op" id="6757102">*</span><span class="ident" id="6757103">reverseBitsTest</span><span class="op" id="6757118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757121">{</span><span class="num" id="6757122">1</span><span class="op" id="6757123">,</span>&nbsp;<span class="num" id="6757125">1</span><span class="op" id="6757126">,</span>&nbsp;<span class="num" id="6757128">1</span><span class="op" id="6757129">}</span><span class="op" id="6757130">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757133">{</span><span class="num" id="6757134">1</span><span class="op" id="6757135">,</span>&nbsp;<span class="num" id="6757137">2</span><span class="op" id="6757138">,</span>&nbsp;<span class="num" id="6757140">2</span><span class="op" id="6757141">}</span><span class="op" id="6757142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757145">{</span><span class="num" id="6757146">1</span><span class="op" id="6757147">,</span>&nbsp;<span class="num" id="6757149">3</span><span class="op" id="6757150">,</span>&nbsp;<span class="num" id="6757152">4</span><span class="op" id="6757153">}</span><span class="op" id="6757154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757157">{</span><span class="num" id="6757158">1</span><span class="op" id="6757159">,</span>&nbsp;<span class="num" id="6757161">4</span><span class="op" id="6757162">,</span>&nbsp;<span class="num" id="6757164">8</span><span class="op" id="6757165">}</span><span class="op" id="6757166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757169">{</span><span class="num" id="6757170">1</span><span class="op" id="6757171">,</span>&nbsp;<span class="num" id="6757173">5</span><span class="op" id="6757174">,</span>&nbsp;<span class="num" id="6757176">16</span><span class="op" id="6757178">}</span><span class="op" id="6757179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757182">{</span><span class="num" id="6757183">17</span><span class="op" id="6757185">,</span>&nbsp;<span class="num" id="6757187">5</span><span class="op" id="6757188">,</span>&nbsp;<span class="num" id="6757190">17</span><span class="op" id="6757192">}</span><span class="op" id="6757193">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757196">{</span><span class="num" id="6757197">257</span><span class="op" id="6757200">,</span>&nbsp;<span class="num" id="6757202">9</span><span class="op" id="6757203">,</span>&nbsp;<span class="num" id="6757205">257</span><span class="op" id="6757208">}</span><span class="op" id="6757209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757212">{</span><span class="num" id="6757213">29</span><span class="op" id="6757215">,</span>&nbsp;<span class="num" id="6757217">5</span><span class="op" id="6757218">,</span>&nbsp;<span class="num" id="6757220">23</span><span class="op" id="6757222">}</span><span class="op" id="6757223">,</span><br>
<span class="lineno"></span><span class="op" id="6757225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6757228">func</span>&nbsp;<span class="ident" id="6757233">largeDataChunk</span><span class="op" id="6757247">(</span><span class="op" id="6757248">)</span>&nbsp;<span class="op" id="6757250">[</span><span class="op" id="6757251">]</span><span class="builtintype" id="6757252">byte</span>&nbsp;<span class="op" id="6757257">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757260">result</span>&nbsp;<span class="op" id="6757267">:=</span>&nbsp;<span class="builtinfunc" id="6757270">make</span><span class="op" id="6757274">(</span><span class="op" id="6757275">[</span><span class="op" id="6757276">]</span><span class="builtintype" id="6757277">byte</span><span class="op" id="6757281">,</span>&nbsp;<span class="num" id="6757283">100000</span><span class="op" id="6757289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757292">for</span>&nbsp;<span class="ident" id="6757296">i</span>&nbsp;<span class="op" id="6757298">:=</span>&nbsp;<span class="keyword" id="6757301">range</span>&nbsp;<span class="ident" id="6757307">result</span>&nbsp;<span class="op" id="6757314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757318">result</span><span class="op" id="6757324">[</span><span class="ident" id="6757325">i</span><span class="op" id="6757326">]</span>&nbsp;<span class="op" id="6757328">=</span>&nbsp;<span class="builtintype" id="6757330">byte</span><span class="op" id="6757334">(</span><span class="ident" id="6757335">i</span>&nbsp;<span class="op" id="6757337">*</span>&nbsp;<span class="ident" id="6757339">i</span>&nbsp;<span class="op" id="6757341">&amp;</span>&nbsp;<span class="num" id="6757343">0xFF</span><span class="op" id="6757347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757353">return</span>&nbsp;<span class="ident" id="6757360">result</span><br>
<span class="lineno">80</span><span class="op" id="6757367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6757370">func</span>&nbsp;<span class="ident" id="6757375">TestDeflate</span><span class="op" id="6757386">(</span><span class="ident" id="6757387">t</span>&nbsp;<span class="op" id="6757389">*</span><span class="ident" id="6757390">testing</span><span class="op" id="6757397">.</span><span class="ident" id="6757398">T</span><span class="op" id="6757399">)</span>&nbsp;<span class="op" id="6757401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757404">for</span>&nbsp;<span class="ident" id="6757408">_</span><span class="op" id="6757409">,</span>&nbsp;<span class="ident" id="6757411">h</span>&nbsp;<span class="op" id="6757413">:=</span>&nbsp;<span class="keyword" id="6757416">range</span>&nbsp;<span class="ident" id="6757422">deflateTests</span>&nbsp;<span class="op" id="6757435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757439">var</span>&nbsp;<span class="ident" id="6757443">buf</span>&nbsp;<span class="ident" id="6757447">bytes</span><span class="op" id="6757452">.</span><span class="ident" id="6757453">Buffer</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757462">w</span><span class="op" id="6757463">,</span>&nbsp;<span class="ident" id="6757465">err</span>&nbsp;<span class="op" id="6757469">:=</span>&nbsp;<span class="ident" id="6757472">NewWriter</span><span class="op" id="6757481">(</span><span class="op" id="6757482">&amp;</span><span class="ident" id="6757483">buf</span><span class="op" id="6757486">,</span>&nbsp;<span class="ident" id="6757488">h</span><span class="op" id="6757489">.</span><span class="ident" id="6757490">level</span><span class="op" id="6757495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757499">if</span>&nbsp;<span class="ident" id="6757502">err</span>&nbsp;<span class="op" id="6757506">!=</span>&nbsp;<span class="ident" id="6757509">nil</span>&nbsp;<span class="op" id="6757513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757518">t</span><span class="op" id="6757519">.</span><span class="ident" id="6757520">Errorf</span><span class="op" id="6757526">(</span><span class="string" id="6757527">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6757542">,</span>&nbsp;<span class="ident" id="6757544">err</span><span class="op" id="6757547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757552">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757563">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757567">w</span><span class="op" id="6757568">.</span><span class="ident" id="6757569">Write</span><span class="op" id="6757574">(</span><span class="ident" id="6757575">h</span><span class="op" id="6757576">.</span><span class="ident" id="6757577">in</span><span class="op" id="6757579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757583">w</span><span class="op" id="6757584">.</span><span class="ident" id="6757585">Close</span><span class="op" id="6757590">(</span><span class="op" id="6757591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757595">if</span>&nbsp;<span class="op" id="6757598">!</span><span class="ident" id="6757599">bytes</span><span class="op" id="6757604">.</span><span class="ident" id="6757605">Equal</span><span class="op" id="6757610">(</span><span class="ident" id="6757611">buf</span><span class="op" id="6757614">.</span><span class="ident" id="6757615">Bytes</span><span class="op" id="6757620">(</span><span class="op" id="6757621">)</span><span class="op" id="6757622">,</span>&nbsp;<span class="ident" id="6757624">h</span><span class="op" id="6757625">.</span><span class="ident" id="6757626">out</span><span class="op" id="6757629">)</span>&nbsp;<span class="op" id="6757631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757636">t</span><span class="op" id="6757637">.</span><span class="ident" id="6757638">Errorf</span><span class="op" id="6757644">(</span><span class="string" id="6757645">&#34;Deflate(%d,&nbsp;%x)&nbsp;=&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6757676">,</span>&nbsp;<span class="ident" id="6757678">h</span><span class="op" id="6757679">.</span><span class="ident" id="6757680">level</span><span class="op" id="6757685">,</span>&nbsp;<span class="ident" id="6757687">h</span><span class="op" id="6757688">.</span><span class="ident" id="6757689">in</span><span class="op" id="6757691">,</span>&nbsp;<span class="ident" id="6757693">buf</span><span class="op" id="6757696">.</span><span class="ident" id="6757697">Bytes</span><span class="op" id="6757702">(</span><span class="op" id="6757703">)</span><span class="op" id="6757704">,</span>&nbsp;<span class="ident" id="6757706">h</span><span class="op" id="6757707">.</span><span class="ident" id="6757708">out</span><span class="op" id="6757711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757715">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6757718">}</span><br>
<span class="lineno"></span><span class="op" id="6757720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6757723">//&nbsp;A&nbsp;sparseReader&nbsp;returns&nbsp;a&nbsp;stream&nbsp;consisting&nbsp;of&nbsp;0s&nbsp;followed&nbsp;by&nbsp;1&lt;&lt;16&nbsp;1s.</span><br>
<span class="lineno"></span><span class="comment" id="6757797">//&nbsp;This&nbsp;tests&nbsp;missing&nbsp;hash&nbsp;references&nbsp;in&nbsp;a&nbsp;very&nbsp;large&nbsp;input.</span><br>
<span class="lineno">100</span><span class="keyword" id="6757858">type</span>&nbsp;<span class="ident" id="6757863">sparseReader</span>&nbsp;<span class="keyword" id="6757876">struct</span>&nbsp;<span class="op" id="6757883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757886">l</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6757890">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6757897">cur</span>&nbsp;<span class="ident" id="6757901">int64</span><br>
<span class="lineno"></span><span class="op" id="6757907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="6757910">func</span>&nbsp;<span class="op" id="6757915">(</span><span class="ident" id="6757916">r</span>&nbsp;<span class="op" id="6757918">*</span><span class="ident" id="6757919">sparseReader</span><span class="op" id="6757931">)</span>&nbsp;<span class="ident" id="6757933">Read</span><span class="op" id="6757937">(</span><span class="ident" id="6757938">b</span>&nbsp;<span class="op" id="6757940">[</span><span class="op" id="6757941">]</span><span class="builtintype" id="6757942">byte</span><span class="op" id="6757946">)</span>&nbsp;<span class="op" id="6757948">(</span><span class="ident" id="6757949">n</span>&nbsp;<span class="builtintype" id="6757951">int</span><span class="op" id="6757954">,</span>&nbsp;<span class="ident" id="6757956">err</span>&nbsp;<span class="builtintype" id="6757960">error</span><span class="op" id="6757965">)</span>&nbsp;<span class="op" id="6757967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757970">if</span>&nbsp;<span class="ident" id="6757973">r</span><span class="op" id="6757974">.</span><span class="ident" id="6757975">cur</span>&nbsp;<span class="op" id="6757979">&gt;=</span>&nbsp;<span class="ident" id="6757982">r</span><span class="op" id="6757983">.</span><span class="ident" id="6757984">l</span>&nbsp;<span class="op" id="6757986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6757990">return</span>&nbsp;<span class="num" id="6757997">0</span><span class="op" id="6757998">,</span>&nbsp;<span class="ident" id="6758000">io</span><span class="op" id="6758002">.</span><span class="ident" id="6758003">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758011">n</span>&nbsp;<span class="op" id="6758013">=</span>&nbsp;<span class="builtinfunc" id="6758015">len</span><span class="op" id="6758018">(</span><span class="ident" id="6758019">b</span><span class="op" id="6758020">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758023">cur</span>&nbsp;<span class="op" id="6758027">:=</span>&nbsp;<span class="ident" id="6758030">r</span><span class="op" id="6758031">.</span><span class="ident" id="6758032">cur</span>&nbsp;<span class="op" id="6758036">+</span>&nbsp;<span class="ident" id="6758038">int64</span><span class="op" id="6758043">(</span><span class="ident" id="6758044">n</span><span class="op" id="6758045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758048">if</span>&nbsp;<span class="ident" id="6758051">cur</span>&nbsp;<span class="op" id="6758055">&gt;</span>&nbsp;<span class="ident" id="6758057">r</span><span class="op" id="6758058">.</span><span class="ident" id="6758059">l</span>&nbsp;<span class="op" id="6758061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758065">n</span>&nbsp;<span class="op" id="6758067">-=</span>&nbsp;<span class="builtintype" id="6758070">int</span><span class="op" id="6758073">(</span><span class="ident" id="6758074">cur</span>&nbsp;<span class="op" id="6758078">-</span>&nbsp;<span class="ident" id="6758080">r</span><span class="op" id="6758081">.</span><span class="ident" id="6758082">l</span><span class="op" id="6758083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758087">cur</span>&nbsp;<span class="op" id="6758091">=</span>&nbsp;<span class="ident" id="6758093">r</span><span class="op" id="6758094">.</span><span class="ident" id="6758095">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758098">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758101">for</span>&nbsp;<span class="ident" id="6758105">i</span>&nbsp;<span class="op" id="6758107">:=</span>&nbsp;<span class="keyword" id="6758110">range</span>&nbsp;<span class="ident" id="6758116">b</span><span class="op" id="6758117">[</span><span class="num" id="6758118">0</span><span class="op" id="6758119">:</span><span class="ident" id="6758120">n</span><span class="op" id="6758121">]</span>&nbsp;<span class="op" id="6758123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758127">if</span>&nbsp;<span class="ident" id="6758130">r</span><span class="op" id="6758131">.</span><span class="ident" id="6758132">cur</span><span class="op" id="6758135">+</span><span class="ident" id="6758136">int64</span><span class="op" id="6758141">(</span><span class="ident" id="6758142">i</span><span class="op" id="6758143">)</span>&nbsp;<span class="op" id="6758145">&gt;=</span>&nbsp;<span class="ident" id="6758148">r</span><span class="op" id="6758149">.</span><span class="ident" id="6758150">l</span><span class="op" id="6758151">-</span><span class="num" id="6758152">1</span><span class="op" id="6758153">&lt;&lt;</span><span class="num" id="6758155">16</span>&nbsp;<span class="op" id="6758158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758163">b</span><span class="op" id="6758164">[</span><span class="ident" id="6758165">i</span><span class="op" id="6758166">]</span>&nbsp;<span class="op" id="6758168">=</span>&nbsp;<span class="num" id="6758170">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758174">}</span>&nbsp;<span class="keyword" id="6758176">else</span>&nbsp;<span class="op" id="6758181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758186">b</span><span class="op" id="6758187">[</span><span class="ident" id="6758188">i</span><span class="op" id="6758189">]</span>&nbsp;<span class="op" id="6758191">=</span>&nbsp;<span class="num" id="6758193">0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758203">r</span><span class="op" id="6758204">.</span><span class="ident" id="6758205">cur</span>&nbsp;<span class="op" id="6758209">=</span>&nbsp;<span class="ident" id="6758211">cur</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758216">return</span><br>
<span class="lineno"></span><span class="op" id="6758223">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="6758226">func</span>&nbsp;<span class="ident" id="6758231">TestVeryLongSparseChunk</span><span class="op" id="6758254">(</span><span class="ident" id="6758255">t</span>&nbsp;<span class="op" id="6758257">*</span><span class="ident" id="6758258">testing</span><span class="op" id="6758265">.</span><span class="ident" id="6758266">T</span><span class="op" id="6758267">)</span>&nbsp;<span class="op" id="6758269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758272">if</span>&nbsp;<span class="ident" id="6758275">testing</span><span class="op" id="6758282">.</span><span class="ident" id="6758283">Short</span><span class="op" id="6758288">(</span><span class="op" id="6758289">)</span>&nbsp;<span class="op" id="6758291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758295">t</span><span class="op" id="6758296">.</span><span class="ident" id="6758297">Skip</span><span class="op" id="6758301">(</span><span class="string" id="6758302">&#34;skipping&nbsp;sparse&nbsp;chunk&nbsp;during&nbsp;short&nbsp;test&#34;</span><span class="op" id="6758343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758346">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758349">w</span><span class="op" id="6758350">,</span>&nbsp;<span class="ident" id="6758352">err</span>&nbsp;<span class="op" id="6758356">:=</span>&nbsp;<span class="ident" id="6758359">NewWriter</span><span class="op" id="6758368">(</span><span class="ident" id="6758369">ioutil</span><span class="op" id="6758375">.</span><span class="ident" id="6758376">Discard</span><span class="op" id="6758383">,</span>&nbsp;<span class="num" id="6758385">1</span><span class="op" id="6758386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758389">if</span>&nbsp;<span class="ident" id="6758392">err</span>&nbsp;<span class="op" id="6758396">!=</span>&nbsp;<span class="ident" id="6758399">nil</span>&nbsp;<span class="op" id="6758403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758407">t</span><span class="op" id="6758408">.</span><span class="ident" id="6758409">Errorf</span><span class="op" id="6758415">(</span><span class="string" id="6758416">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6758431">,</span>&nbsp;<span class="ident" id="6758433">err</span><span class="op" id="6758436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758440">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758448">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758451">if</span>&nbsp;<span class="ident" id="6758454">_</span><span class="op" id="6758455">,</span>&nbsp;<span class="ident" id="6758457">err</span>&nbsp;<span class="op" id="6758461">=</span>&nbsp;<span class="ident" id="6758463">io</span><span class="op" id="6758465">.</span><span class="ident" id="6758466">Copy</span><span class="op" id="6758470">(</span><span class="ident" id="6758471">w</span><span class="op" id="6758472">,</span>&nbsp;<span class="op" id="6758474">&amp;</span><span class="ident" id="6758475">sparseReader</span><span class="op" id="6758487">{</span><span class="ident" id="6758488">l</span><span class="op" id="6758489">:</span>&nbsp;<span class="num" id="6758491">23E8</span><span class="op" id="6758495">}</span><span class="op" id="6758496">)</span><span class="op" id="6758497">;</span>&nbsp;<span class="ident" id="6758499">err</span>&nbsp;<span class="op" id="6758503">!=</span>&nbsp;<span class="ident" id="6758506">nil</span>&nbsp;<span class="op" id="6758510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758514">t</span><span class="op" id="6758515">.</span><span class="ident" id="6758516">Errorf</span><span class="op" id="6758522">(</span><span class="string" id="6758523">&#34;Compress&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6758544">,</span>&nbsp;<span class="ident" id="6758546">err</span><span class="op" id="6758549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758553">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758561">}</span><br>
<span class="lineno"></span><span class="op" id="6758563">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6758566">type</span>&nbsp;<span class="ident" id="6758571">syncBuffer</span>&nbsp;<span class="keyword" id="6758582">struct</span>&nbsp;<span class="op" id="6758589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758592">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758599">bytes</span><span class="op" id="6758604">.</span><span class="ident" id="6758605">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758613">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758620">sync</span><span class="op" id="6758624">.</span><span class="ident" id="6758625">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758634">closed</span>&nbsp;<span class="builtintype" id="6758641">bool</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758647">ready</span>&nbsp;&nbsp;<span class="keyword" id="6758654">chan</span>&nbsp;<span class="builtintype" id="6758659">bool</span><br>
<span class="lineno"></span><span class="op" id="6758664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6758667">func</span>&nbsp;<span class="ident" id="6758672">newSyncBuffer</span><span class="op" id="6758685">(</span><span class="op" id="6758686">)</span>&nbsp;<span class="op" id="6758688">*</span><span class="ident" id="6758689">syncBuffer</span>&nbsp;<span class="op" id="6758700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758703">return</span>&nbsp;<span class="op" id="6758710">&amp;</span><span class="ident" id="6758711">syncBuffer</span><span class="op" id="6758721">{</span><span class="ident" id="6758722">ready</span><span class="op" id="6758727">:</span>&nbsp;<span class="builtinfunc" id="6758729">make</span><span class="op" id="6758733">(</span><span class="keyword" id="6758734">chan</span>&nbsp;<span class="builtintype" id="6758739">bool</span><span class="op" id="6758743">,</span>&nbsp;<span class="num" id="6758745">1</span><span class="op" id="6758746">)</span><span class="op" id="6758747">}</span><br>
<span class="lineno">150</span><span class="op" id="6758749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6758752">func</span>&nbsp;<span class="op" id="6758757">(</span><span class="ident" id="6758758">b</span>&nbsp;<span class="op" id="6758760">*</span><span class="ident" id="6758761">syncBuffer</span><span class="op" id="6758771">)</span>&nbsp;<span class="ident" id="6758773">Read</span><span class="op" id="6758777">(</span><span class="ident" id="6758778">p</span>&nbsp;<span class="op" id="6758780">[</span><span class="op" id="6758781">]</span><span class="builtintype" id="6758782">byte</span><span class="op" id="6758786">)</span>&nbsp;<span class="op" id="6758788">(</span><span class="ident" id="6758789">n</span>&nbsp;<span class="builtintype" id="6758791">int</span><span class="op" id="6758794">,</span>&nbsp;<span class="ident" id="6758796">err</span>&nbsp;<span class="builtintype" id="6758800">error</span><span class="op" id="6758805">)</span>&nbsp;<span class="op" id="6758807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758810">for</span>&nbsp;<span class="op" id="6758814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758818">b</span><span class="op" id="6758819">.</span><span class="ident" id="6758820">mu</span><span class="op" id="6758822">.</span><span class="ident" id="6758823">RLock</span><span class="op" id="6758828">(</span><span class="op" id="6758829">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758833">n</span><span class="op" id="6758834">,</span>&nbsp;<span class="ident" id="6758836">err</span>&nbsp;<span class="op" id="6758840">=</span>&nbsp;<span class="ident" id="6758842">b</span><span class="op" id="6758843">.</span><span class="ident" id="6758844">buf</span><span class="op" id="6758847">.</span><span class="ident" id="6758848">Read</span><span class="op" id="6758852">(</span><span class="ident" id="6758853">p</span><span class="op" id="6758854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6758858">b</span><span class="op" id="6758859">.</span><span class="ident" id="6758860">mu</span><span class="op" id="6758862">.</span><span class="ident" id="6758863">RUnlock</span><span class="op" id="6758870">(</span><span class="op" id="6758871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758875">if</span>&nbsp;<span class="ident" id="6758878">n</span>&nbsp;<span class="op" id="6758880">&gt;</span>&nbsp;<span class="num" id="6758882">0</span>&nbsp;<span class="op" id="6758884">||</span>&nbsp;<span class="ident" id="6758887">b</span><span class="op" id="6758888">.</span><span class="ident" id="6758889">closed</span>&nbsp;<span class="op" id="6758896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758910">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758914">&lt;-</span><span class="ident" id="6758916">b</span><span class="op" id="6758917">.</span><span class="ident" id="6758918">ready</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6758925">}</span><br>
<span class="lineno"></span><span class="op" id="6758927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6758930">func</span>&nbsp;<span class="op" id="6758935">(</span><span class="ident" id="6758936">b</span>&nbsp;<span class="op" id="6758938">*</span><span class="ident" id="6758939">syncBuffer</span><span class="op" id="6758949">)</span>&nbsp;<span class="ident" id="6758951">signal</span><span class="op" id="6758957">(</span><span class="op" id="6758958">)</span>&nbsp;<span class="op" id="6758960">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758963">select</span>&nbsp;<span class="op" id="6758970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758973">case</span>&nbsp;<span class="ident" id="6758978">b</span><span class="op" id="6758979">.</span><span class="ident" id="6758980">ready</span>&nbsp;<span class="op" id="6758986">&lt;-</span>&nbsp;<span class="builtintype" id="6758989">true</span><span class="op" id="6758993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6758996">default</span><span class="op" id="6759003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6759006">}</span><br>
<span class="lineno"></span><span class="op" id="6759008">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6759011">func</span>&nbsp;<span class="op" id="6759016">(</span><span class="ident" id="6759017">b</span>&nbsp;<span class="op" id="6759019">*</span><span class="ident" id="6759020">syncBuffer</span><span class="op" id="6759030">)</span>&nbsp;<span class="ident" id="6759032">Write</span><span class="op" id="6759037">(</span><span class="ident" id="6759038">p</span>&nbsp;<span class="op" id="6759040">[</span><span class="op" id="6759041">]</span><span class="builtintype" id="6759042">byte</span><span class="op" id="6759046">)</span>&nbsp;<span class="op" id="6759048">(</span><span class="ident" id="6759049">n</span>&nbsp;<span class="builtintype" id="6759051">int</span><span class="op" id="6759054">,</span>&nbsp;<span class="ident" id="6759056">err</span>&nbsp;<span class="builtintype" id="6759060">error</span><span class="op" id="6759065">)</span>&nbsp;<span class="op" id="6759067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759070">n</span><span class="op" id="6759071">,</span>&nbsp;<span class="ident" id="6759073">err</span>&nbsp;<span class="op" id="6759077">=</span>&nbsp;<span class="ident" id="6759079">b</span><span class="op" id="6759080">.</span><span class="ident" id="6759081">buf</span><span class="op" id="6759084">.</span><span class="ident" id="6759085">Write</span><span class="op" id="6759090">(</span><span class="ident" id="6759091">p</span><span class="op" id="6759092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759095">b</span><span class="op" id="6759096">.</span><span class="ident" id="6759097">signal</span><span class="op" id="6759103">(</span><span class="op" id="6759104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759107">return</span><br>
<span class="lineno">175</span><span class="op" id="6759114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6759117">func</span>&nbsp;<span class="op" id="6759122">(</span><span class="ident" id="6759123">b</span>&nbsp;<span class="op" id="6759125">*</span><span class="ident" id="6759126">syncBuffer</span><span class="op" id="6759136">)</span>&nbsp;<span class="ident" id="6759138">WriteMode</span><span class="op" id="6759147">(</span><span class="op" id="6759148">)</span>&nbsp;<span class="op" id="6759150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759153">b</span><span class="op" id="6759154">.</span><span class="ident" id="6759155">mu</span><span class="op" id="6759157">.</span><span class="ident" id="6759158">Lock</span><span class="op" id="6759162">(</span><span class="op" id="6759163">)</span><br>
<span class="lineno"></span><span class="op" id="6759165">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="6759168">func</span>&nbsp;<span class="op" id="6759173">(</span><span class="ident" id="6759174">b</span>&nbsp;<span class="op" id="6759176">*</span><span class="ident" id="6759177">syncBuffer</span><span class="op" id="6759187">)</span>&nbsp;<span class="ident" id="6759189">ReadMode</span><span class="op" id="6759197">(</span><span class="op" id="6759198">)</span>&nbsp;<span class="op" id="6759200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759203">b</span><span class="op" id="6759204">.</span><span class="ident" id="6759205">mu</span><span class="op" id="6759207">.</span><span class="ident" id="6759208">Unlock</span><span class="op" id="6759214">(</span><span class="op" id="6759215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759218">b</span><span class="op" id="6759219">.</span><span class="ident" id="6759220">signal</span><span class="op" id="6759226">(</span><span class="op" id="6759227">)</span><br>
<span class="lineno"></span><span class="op" id="6759229">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="6759232">func</span>&nbsp;<span class="op" id="6759237">(</span><span class="ident" id="6759238">b</span>&nbsp;<span class="op" id="6759240">*</span><span class="ident" id="6759241">syncBuffer</span><span class="op" id="6759251">)</span>&nbsp;<span class="ident" id="6759253">Close</span><span class="op" id="6759258">(</span><span class="op" id="6759259">)</span>&nbsp;<span class="builtintype" id="6759261">error</span>&nbsp;<span class="op" id="6759267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759270">b</span><span class="op" id="6759271">.</span><span class="ident" id="6759272">closed</span>&nbsp;<span class="op" id="6759279">=</span>&nbsp;<span class="builtintype" id="6759281">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759287">b</span><span class="op" id="6759288">.</span><span class="ident" id="6759289">signal</span><span class="op" id="6759295">(</span><span class="op" id="6759296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759299">return</span>&nbsp;<span class="ident" id="6759306">nil</span><br>
<span class="lineno">190</span><span class="op" id="6759310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6759313">func</span>&nbsp;<span class="ident" id="6759318">testSync</span><span class="op" id="6759326">(</span><span class="ident" id="6759327">t</span>&nbsp;<span class="op" id="6759329">*</span><span class="ident" id="6759330">testing</span><span class="op" id="6759337">.</span><span class="ident" id="6759338">T</span><span class="op" id="6759339">,</span>&nbsp;<span class="ident" id="6759341">level</span>&nbsp;<span class="builtintype" id="6759347">int</span><span class="op" id="6759350">,</span>&nbsp;<span class="ident" id="6759352">input</span>&nbsp;<span class="op" id="6759358">[</span><span class="op" id="6759359">]</span><span class="builtintype" id="6759360">byte</span><span class="op" id="6759364">,</span>&nbsp;<span class="ident" id="6759366">name</span>&nbsp;<span class="builtintype" id="6759371">string</span><span class="op" id="6759377">)</span>&nbsp;<span class="op" id="6759379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759382">if</span>&nbsp;<span class="builtinfunc" id="6759385">len</span><span class="op" id="6759388">(</span><span class="ident" id="6759389">input</span><span class="op" id="6759394">)</span>&nbsp;<span class="op" id="6759396">==</span>&nbsp;<span class="num" id="6759399">0</span>&nbsp;<span class="op" id="6759401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759405">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6759413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759417">t</span><span class="op" id="6759418">.</span><span class="ident" id="6759419">Logf</span><span class="op" id="6759423">(</span><span class="string" id="6759424">&#34;--testSync&nbsp;%d,&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="6759447">,</span>&nbsp;<span class="ident" id="6759449">level</span><span class="op" id="6759454">,</span>&nbsp;<span class="builtinfunc" id="6759456">len</span><span class="op" id="6759459">(</span><span class="ident" id="6759460">input</span><span class="op" id="6759465">)</span><span class="op" id="6759466">,</span>&nbsp;<span class="ident" id="6759468">name</span><span class="op" id="6759472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759475">buf</span>&nbsp;<span class="op" id="6759479">:=</span>&nbsp;<span class="ident" id="6759482">newSyncBuffer</span><span class="op" id="6759495">(</span><span class="op" id="6759496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759499">buf1</span>&nbsp;<span class="op" id="6759504">:=</span>&nbsp;<span class="builtinfunc" id="6759507">new</span><span class="op" id="6759510">(</span><span class="ident" id="6759511">bytes</span><span class="op" id="6759516">.</span><span class="ident" id="6759517">Buffer</span><span class="op" id="6759523">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759526">buf</span><span class="op" id="6759529">.</span><span class="ident" id="6759530">WriteMode</span><span class="op" id="6759539">(</span><span class="op" id="6759540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759543">w</span><span class="op" id="6759544">,</span>&nbsp;<span class="ident" id="6759546">err</span>&nbsp;<span class="op" id="6759550">:=</span>&nbsp;<span class="ident" id="6759553">NewWriter</span><span class="op" id="6759562">(</span><span class="ident" id="6759563">io</span><span class="op" id="6759565">.</span><span class="ident" id="6759566">MultiWriter</span><span class="op" id="6759577">(</span><span class="ident" id="6759578">buf</span><span class="op" id="6759581">,</span>&nbsp;<span class="ident" id="6759583">buf1</span><span class="op" id="6759587">)</span><span class="op" id="6759588">,</span>&nbsp;<span class="ident" id="6759590">level</span><span class="op" id="6759595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759598">if</span>&nbsp;<span class="ident" id="6759601">err</span>&nbsp;<span class="op" id="6759605">!=</span>&nbsp;<span class="ident" id="6759608">nil</span>&nbsp;<span class="op" id="6759612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759616">t</span><span class="op" id="6759617">.</span><span class="ident" id="6759618">Errorf</span><span class="op" id="6759624">(</span><span class="string" id="6759625">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6759640">,</span>&nbsp;<span class="ident" id="6759642">err</span><span class="op" id="6759645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759649">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6759657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759660">r</span>&nbsp;<span class="op" id="6759662">:=</span>&nbsp;<span class="ident" id="6759665">NewReader</span><span class="op" id="6759674">(</span><span class="ident" id="6759675">buf</span><span class="op" id="6759678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6759682">//&nbsp;Write&nbsp;half&nbsp;the&nbsp;input&nbsp;and&nbsp;read&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759722">for</span>&nbsp;<span class="ident" id="6759726">i</span>&nbsp;<span class="op" id="6759728">:=</span>&nbsp;<span class="num" id="6759731">0</span><span class="op" id="6759732">;</span>&nbsp;<span class="ident" id="6759734">i</span>&nbsp;<span class="op" id="6759736">&lt;</span>&nbsp;<span class="num" id="6759738">2</span><span class="op" id="6759739">;</span>&nbsp;<span class="ident" id="6759741">i</span><span class="op" id="6759742">++</span>&nbsp;<span class="op" id="6759745">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759749">var</span>&nbsp;<span class="ident" id="6759753">lo</span><span class="op" id="6759755">,</span>&nbsp;<span class="ident" id="6759757">hi</span>&nbsp;<span class="builtintype" id="6759760">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759766">if</span>&nbsp;<span class="ident" id="6759769">i</span>&nbsp;<span class="op" id="6759771">==</span>&nbsp;<span class="num" id="6759774">0</span>&nbsp;<span class="op" id="6759776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759781">lo</span><span class="op" id="6759783">,</span>&nbsp;<span class="ident" id="6759785">hi</span>&nbsp;<span class="op" id="6759788">=</span>&nbsp;<span class="num" id="6759790">0</span><span class="op" id="6759791">,</span>&nbsp;<span class="op" id="6759793">(</span><span class="builtinfunc" id="6759794">len</span><span class="op" id="6759797">(</span><span class="ident" id="6759798">input</span><span class="op" id="6759803">)</span><span class="op" id="6759804">+</span><span class="num" id="6759805">1</span><span class="op" id="6759806">)</span><span class="op" id="6759807">/</span><span class="num" id="6759808">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6759812">}</span>&nbsp;<span class="keyword" id="6759814">else</span>&nbsp;<span class="op" id="6759819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759824">lo</span><span class="op" id="6759826">,</span>&nbsp;<span class="ident" id="6759828">hi</span>&nbsp;<span class="op" id="6759831">=</span>&nbsp;<span class="op" id="6759833">(</span><span class="builtinfunc" id="6759834">len</span><span class="op" id="6759837">(</span><span class="ident" id="6759838">input</span><span class="op" id="6759843">)</span><span class="op" id="6759844">+</span><span class="num" id="6759845">1</span><span class="op" id="6759846">)</span><span class="op" id="6759847">/</span><span class="num" id="6759848">2</span><span class="op" id="6759849">,</span>&nbsp;<span class="builtinfunc" id="6759851">len</span><span class="op" id="6759854">(</span><span class="ident" id="6759855">input</span><span class="op" id="6759860">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6759864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759868">t</span><span class="op" id="6759869">.</span><span class="ident" id="6759870">Logf</span><span class="op" id="6759874">(</span><span class="string" id="6759875">&#34;#%d:&nbsp;write&nbsp;%d-%d&#34;</span><span class="op" id="6759893">,</span>&nbsp;<span class="ident" id="6759895">i</span><span class="op" id="6759896">,</span>&nbsp;<span class="ident" id="6759898">lo</span><span class="op" id="6759900">,</span>&nbsp;<span class="ident" id="6759902">hi</span><span class="op" id="6759904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6759908">if</span>&nbsp;<span class="ident" id="6759911">_</span><span class="op" id="6759912">,</span>&nbsp;<span class="ident" id="6759914">err</span>&nbsp;<span class="op" id="6759918">:=</span>&nbsp;<span class="ident" id="6759921">w</span><span class="op" id="6759922">.</span><span class="ident" id="6759923">Write</span><span class="op" id="6759928">(</span><span class="ident" id="6759929">input</span><span class="op" id="6759934">[</span><span class="ident" id="6759935">lo</span><span class="op" id="6759937">:</span><span class="ident" id="6759938">hi</span><span class="op" id="6759940">]</span><span class="op" id="6759941">)</span><span class="op" id="6759942">;</span>&nbsp;<span class="ident" id="6759944">err</span>&nbsp;<span class="op" id="6759948">!=</span>&nbsp;<span class="ident" id="6759951">nil</span>&nbsp;<span class="op" id="6759955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6759960">t</span><span class="op" id="6759961">.</span><span class="ident" id="6759962">Errorf</span><span class="op" id="6759968">(</span><span class="string" id="6759969">&#34;testSync:&nbsp;write:&nbsp;%v&#34;</span><span class="op" id="6759990">,</span>&nbsp;<span class="ident" id="6759992">err</span><span class="op" id="6759995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760000">return</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760013">if</span>&nbsp;<span class="ident" id="6760016">i</span>&nbsp;<span class="op" id="6760018">==</span>&nbsp;<span class="num" id="6760021">0</span>&nbsp;<span class="op" id="6760023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760028">if</span>&nbsp;<span class="ident" id="6760031">err</span>&nbsp;<span class="op" id="6760035">:=</span>&nbsp;<span class="ident" id="6760038">w</span><span class="op" id="6760039">.</span><span class="ident" id="6760040">Flush</span><span class="op" id="6760045">(</span><span class="op" id="6760046">)</span><span class="op" id="6760047">;</span>&nbsp;<span class="ident" id="6760049">err</span>&nbsp;<span class="op" id="6760053">!=</span>&nbsp;<span class="ident" id="6760056">nil</span>&nbsp;<span class="op" id="6760060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760066">t</span><span class="op" id="6760067">.</span><span class="ident" id="6760068">Errorf</span><span class="op" id="6760074">(</span><span class="string" id="6760075">&#34;testSync:&nbsp;flush:&nbsp;%v&#34;</span><span class="op" id="6760096">,</span>&nbsp;<span class="ident" id="6760098">err</span><span class="op" id="6760101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760107">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760121">}</span>&nbsp;<span class="keyword" id="6760123">else</span>&nbsp;<span class="op" id="6760128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760133">if</span>&nbsp;<span class="ident" id="6760136">err</span>&nbsp;<span class="op" id="6760140">:=</span>&nbsp;<span class="ident" id="6760143">w</span><span class="op" id="6760144">.</span><span class="ident" id="6760145">Close</span><span class="op" id="6760150">(</span><span class="op" id="6760151">)</span><span class="op" id="6760152">;</span>&nbsp;<span class="ident" id="6760154">err</span>&nbsp;<span class="op" id="6760158">!=</span>&nbsp;<span class="ident" id="6760161">nil</span>&nbsp;<span class="op" id="6760165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760171">t</span><span class="op" id="6760172">.</span><span class="ident" id="6760173">Errorf</span><span class="op" id="6760179">(</span><span class="string" id="6760180">&#34;testSync:&nbsp;close:&nbsp;%v&#34;</span><span class="op" id="6760201">,</span>&nbsp;<span class="ident" id="6760203">err</span><span class="op" id="6760206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760211">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760219">buf</span><span class="op" id="6760222">.</span><span class="ident" id="6760223">ReadMode</span><span class="op" id="6760231">(</span><span class="op" id="6760232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760236">out</span>&nbsp;<span class="op" id="6760240">:=</span>&nbsp;<span class="builtinfunc" id="6760243">make</span><span class="op" id="6760247">(</span><span class="op" id="6760248">[</span><span class="op" id="6760249">]</span><span class="builtintype" id="6760250">byte</span><span class="op" id="6760254">,</span>&nbsp;<span class="ident" id="6760256">hi</span><span class="op" id="6760258">-</span><span class="ident" id="6760259">lo</span><span class="op" id="6760261">+</span><span class="num" id="6760262">1</span><span class="op" id="6760263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760267">m</span><span class="op" id="6760268">,</span>&nbsp;<span class="ident" id="6760270">err</span>&nbsp;<span class="op" id="6760274">:=</span>&nbsp;<span class="ident" id="6760277">io</span><span class="op" id="6760279">.</span><span class="ident" id="6760280">ReadAtLeast</span><span class="op" id="6760291">(</span><span class="ident" id="6760292">r</span><span class="op" id="6760293">,</span>&nbsp;<span class="ident" id="6760295">out</span><span class="op" id="6760298">,</span>&nbsp;<span class="ident" id="6760300">hi</span><span class="op" id="6760302">-</span><span class="ident" id="6760303">lo</span><span class="op" id="6760305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760309">t</span><span class="op" id="6760310">.</span><span class="ident" id="6760311">Logf</span><span class="op" id="6760315">(</span><span class="string" id="6760316">&#34;#%d:&nbsp;read&nbsp;%d&#34;</span><span class="op" id="6760330">,</span>&nbsp;<span class="ident" id="6760332">i</span><span class="op" id="6760333">,</span>&nbsp;<span class="ident" id="6760335">m</span><span class="op" id="6760336">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760340">if</span>&nbsp;<span class="ident" id="6760343">m</span>&nbsp;<span class="op" id="6760345">!=</span>&nbsp;<span class="ident" id="6760348">hi</span><span class="op" id="6760350">-</span><span class="ident" id="6760351">lo</span>&nbsp;<span class="op" id="6760354">||</span>&nbsp;<span class="ident" id="6760357">err</span>&nbsp;<span class="op" id="6760361">!=</span>&nbsp;<span class="ident" id="6760364">nil</span>&nbsp;<span class="op" id="6760368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760373">t</span><span class="op" id="6760374">.</span><span class="ident" id="6760375">Errorf</span><span class="op" id="6760381">(</span><span class="string" id="6760382">&#34;testSync/%d&nbsp;(%d,&nbsp;%d,&nbsp;%s):&nbsp;read&nbsp;%d:&nbsp;%d,&nbsp;%v&nbsp;(%d&nbsp;left)&#34;</span><span class="op" id="6760435">,</span>&nbsp;<span class="ident" id="6760437">i</span><span class="op" id="6760438">,</span>&nbsp;<span class="ident" id="6760440">level</span><span class="op" id="6760445">,</span>&nbsp;<span class="builtinfunc" id="6760447">len</span><span class="op" id="6760450">(</span><span class="ident" id="6760451">input</span><span class="op" id="6760456">)</span><span class="op" id="6760457">,</span>&nbsp;<span class="ident" id="6760459">name</span><span class="op" id="6760463">,</span>&nbsp;<span class="ident" id="6760465">hi</span><span class="op" id="6760467">-</span><span class="ident" id="6760468">lo</span><span class="op" id="6760470">,</span>&nbsp;<span class="ident" id="6760472">m</span><span class="op" id="6760473">,</span>&nbsp;<span class="ident" id="6760475">err</span><span class="op" id="6760478">,</span>&nbsp;<span class="ident" id="6760480">buf</span><span class="op" id="6760483">.</span><span class="ident" id="6760484">buf</span><span class="op" id="6760487">.</span><span class="ident" id="6760488">Len</span><span class="op" id="6760491">(</span><span class="op" id="6760492">)</span><span class="op" id="6760493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760498">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760511">if</span>&nbsp;<span class="op" id="6760514">!</span><span class="ident" id="6760515">bytes</span><span class="op" id="6760520">.</span><span class="ident" id="6760521">Equal</span><span class="op" id="6760526">(</span><span class="ident" id="6760527">input</span><span class="op" id="6760532">[</span><span class="ident" id="6760533">lo</span><span class="op" id="6760535">:</span><span class="ident" id="6760536">hi</span><span class="op" id="6760538">]</span><span class="op" id="6760539">,</span>&nbsp;<span class="ident" id="6760541">out</span><span class="op" id="6760544">[</span><span class="op" id="6760545">:</span><span class="ident" id="6760546">hi</span><span class="op" id="6760548">-</span><span class="ident" id="6760549">lo</span><span class="op" id="6760551">]</span><span class="op" id="6760552">)</span>&nbsp;<span class="op" id="6760554">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6760559">t</span><span class="op" id="6760560">.</span><span class="ident" id="6760561">Errorf</span><span class="op" id="6760567">(</span><span class="string" id="6760568">&#34;testSync/%d:&nbsp;read&nbsp;wrong&nbsp;bytes:&nbsp;%x&nbsp;vs&nbsp;%x&#34;</span><span class="op" id="6760609">,</span>&nbsp;<span class="ident" id="6760611">i</span><span class="op" id="6760612">,</span>&nbsp;<span class="ident" id="6760614">input</span><span class="op" id="6760619">[</span><span class="ident" id="6760620">lo</span><span class="op" id="6760622">:</span><span class="ident" id="6760623">hi</span><span class="op" id="6760625">]</span><span class="op" id="6760626">,</span>&nbsp;<span class="ident" id="6760628">out</span><span class="op" id="6760631">[</span><span class="op" id="6760632">:</span><span class="ident" id="6760633">hi</span><span class="op" id="6760635">-</span><span class="ident" id="6760636">lo</span><span class="op" id="6760638">]</span><span class="op" id="6760639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6760644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6760653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760657">//&nbsp;This&nbsp;test&nbsp;originally&nbsp;checked&nbsp;that&nbsp;after&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760710">//&nbsp;the&nbsp;first&nbsp;half&nbsp;of&nbsp;the&nbsp;input,&nbsp;there&nbsp;was&nbsp;nothing&nbsp;left</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760767">//&nbsp;in&nbsp;the&nbsp;read&nbsp;buffer&nbsp;(buf.buf.Len()&nbsp;!=&nbsp;0)&nbsp;but&nbsp;that&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760824">//&nbsp;not&nbsp;necessarily&nbsp;the&nbsp;case:&nbsp;the&nbsp;write&nbsp;Flush&nbsp;may&nbsp;emit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760880">//&nbsp;some&nbsp;extra&nbsp;framing&nbsp;bits&nbsp;that&nbsp;are&nbsp;not&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760932">//&nbsp;to&nbsp;process&nbsp;to&nbsp;obtain&nbsp;the&nbsp;first&nbsp;half&nbsp;of&nbsp;the&nbsp;uncompressed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6760993">//&nbsp;data.&nbsp;&nbsp;The&nbsp;test&nbsp;ran&nbsp;correctly&nbsp;most&nbsp;of&nbsp;the&nbsp;time,&nbsp;because</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6761054">//&nbsp;the&nbsp;background&nbsp;goroutine&nbsp;had&nbsp;usually&nbsp;read&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6761106">//&nbsp;those&nbsp;extra&nbsp;bits&nbsp;by&nbsp;now,&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;useful&nbsp;thing&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6761167">//&nbsp;check.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761179">buf</span><span class="op" id="6761182">.</span><span class="ident" id="6761183">WriteMode</span><span class="op" id="6761192">(</span><span class="op" id="6761193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6761196">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761199">buf</span><span class="op" id="6761202">.</span><span class="ident" id="6761203">ReadMode</span><span class="op" id="6761211">(</span><span class="op" id="6761212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761215">out</span>&nbsp;<span class="op" id="6761219">:=</span>&nbsp;<span class="builtinfunc" id="6761222">make</span><span class="op" id="6761226">(</span><span class="op" id="6761227">[</span><span class="op" id="6761228">]</span><span class="builtintype" id="6761229">byte</span><span class="op" id="6761233">,</span>&nbsp;<span class="num" id="6761235">10</span><span class="op" id="6761237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761240">if</span>&nbsp;<span class="ident" id="6761243">n</span><span class="op" id="6761244">,</span>&nbsp;<span class="ident" id="6761246">err</span>&nbsp;<span class="op" id="6761250">:=</span>&nbsp;<span class="ident" id="6761253">r</span><span class="op" id="6761254">.</span><span class="ident" id="6761255">Read</span><span class="op" id="6761259">(</span><span class="ident" id="6761260">out</span><span class="op" id="6761263">)</span><span class="op" id="6761264">;</span>&nbsp;<span class="ident" id="6761266">n</span>&nbsp;<span class="op" id="6761268">&gt;</span>&nbsp;<span class="num" id="6761270">0</span>&nbsp;<span class="op" id="6761272">||</span>&nbsp;<span class="ident" id="6761275">err</span>&nbsp;<span class="op" id="6761279">!=</span>&nbsp;<span class="ident" id="6761282">io</span><span class="op" id="6761284">.</span><span class="ident" id="6761285">EOF</span>&nbsp;<span class="op" id="6761289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761293">t</span><span class="op" id="6761294">.</span><span class="ident" id="6761295">Errorf</span><span class="op" id="6761301">(</span><span class="string" id="6761302">&#34;testSync&nbsp;(%d,&nbsp;%d,&nbsp;%s):&nbsp;final&nbsp;Read:&nbsp;%d,&nbsp;%v&nbsp;(hex:&nbsp;%x)&#34;</span><span class="op" id="6761355">,</span>&nbsp;<span class="ident" id="6761357">level</span><span class="op" id="6761362">,</span>&nbsp;<span class="builtinfunc" id="6761364">len</span><span class="op" id="6761367">(</span><span class="ident" id="6761368">input</span><span class="op" id="6761373">)</span><span class="op" id="6761374">,</span>&nbsp;<span class="ident" id="6761376">name</span><span class="op" id="6761380">,</span>&nbsp;<span class="ident" id="6761382">n</span><span class="op" id="6761383">,</span>&nbsp;<span class="ident" id="6761385">err</span><span class="op" id="6761388">,</span>&nbsp;<span class="ident" id="6761390">out</span><span class="op" id="6761393">[</span><span class="num" id="6761394">0</span><span class="op" id="6761395">:</span><span class="ident" id="6761396">n</span><span class="op" id="6761397">]</span><span class="op" id="6761398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6761401">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761404">if</span>&nbsp;<span class="ident" id="6761407">buf</span><span class="op" id="6761410">.</span><span class="ident" id="6761411">buf</span><span class="op" id="6761414">.</span><span class="ident" id="6761415">Len</span><span class="op" id="6761418">(</span><span class="op" id="6761419">)</span>&nbsp;<span class="op" id="6761421">!=</span>&nbsp;<span class="num" id="6761424">0</span>&nbsp;<span class="op" id="6761426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761430">t</span><span class="op" id="6761431">.</span><span class="ident" id="6761432">Errorf</span><span class="op" id="6761438">(</span><span class="string" id="6761439">&#34;testSync&nbsp;(%d,&nbsp;%d,&nbsp;%s):&nbsp;extra&nbsp;data&nbsp;at&nbsp;end&#34;</span><span class="op" id="6761481">,</span>&nbsp;<span class="ident" id="6761483">level</span><span class="op" id="6761488">,</span>&nbsp;<span class="builtinfunc" id="6761490">len</span><span class="op" id="6761493">(</span><span class="ident" id="6761494">input</span><span class="op" id="6761499">)</span><span class="op" id="6761500">,</span>&nbsp;<span class="ident" id="6761502">name</span><span class="op" id="6761506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6761509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761512">r</span><span class="op" id="6761513">.</span><span class="ident" id="6761514">Close</span><span class="op" id="6761519">(</span><span class="op" id="6761520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6761524">//&nbsp;stream&nbsp;should&nbsp;work&nbsp;for&nbsp;ordinary&nbsp;reader&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761571">r</span>&nbsp;<span class="op" id="6761573">=</span>&nbsp;<span class="ident" id="6761575">NewReader</span><span class="op" id="6761584">(</span><span class="ident" id="6761585">buf1</span><span class="op" id="6761589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761592">out</span><span class="op" id="6761595">,</span>&nbsp;<span class="ident" id="6761597">err</span>&nbsp;<span class="op" id="6761601">=</span>&nbsp;<span class="ident" id="6761603">ioutil</span><span class="op" id="6761609">.</span><span class="ident" id="6761610">ReadAll</span><span class="op" id="6761617">(</span><span class="ident" id="6761618">r</span><span class="op" id="6761619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761622">if</span>&nbsp;<span class="ident" id="6761625">err</span>&nbsp;<span class="op" id="6761629">!=</span>&nbsp;<span class="ident" id="6761632">nil</span>&nbsp;<span class="op" id="6761636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761640">t</span><span class="op" id="6761641">.</span><span class="ident" id="6761642">Errorf</span><span class="op" id="6761648">(</span><span class="string" id="6761649">&#34;testSync:&nbsp;read:&nbsp;%s&#34;</span><span class="op" id="6761669">,</span>&nbsp;<span class="ident" id="6761671">err</span><span class="op" id="6761674">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6761686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761689">r</span><span class="op" id="6761690">.</span><span class="ident" id="6761691">Close</span><span class="op" id="6761696">(</span><span class="op" id="6761697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761700">if</span>&nbsp;<span class="op" id="6761703">!</span><span class="ident" id="6761704">bytes</span><span class="op" id="6761709">.</span><span class="ident" id="6761710">Equal</span><span class="op" id="6761715">(</span><span class="ident" id="6761716">input</span><span class="op" id="6761721">,</span>&nbsp;<span class="ident" id="6761723">out</span><span class="op" id="6761726">)</span>&nbsp;<span class="op" id="6761728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761732">t</span><span class="op" id="6761733">.</span><span class="ident" id="6761734">Errorf</span><span class="op" id="6761740">(</span><span class="string" id="6761741">&#34;testSync:&nbsp;decompress(compress(data))&nbsp;!=&nbsp;data:&nbsp;level=%d&nbsp;input=%s&#34;</span><span class="op" id="6761806">,</span>&nbsp;<span class="ident" id="6761808">level</span><span class="op" id="6761813">,</span>&nbsp;<span class="ident" id="6761815">name</span><span class="op" id="6761819">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6761822">}</span><br>
<span class="lineno"></span><span class="op" id="6761824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6761827">func</span>&nbsp;<span class="ident" id="6761832">testToFromWithLevelAndLimit</span><span class="op" id="6761859">(</span><span class="ident" id="6761860">t</span>&nbsp;<span class="op" id="6761862">*</span><span class="ident" id="6761863">testing</span><span class="op" id="6761870">.</span><span class="ident" id="6761871">T</span><span class="op" id="6761872">,</span>&nbsp;<span class="ident" id="6761874">level</span>&nbsp;<span class="builtintype" id="6761880">int</span><span class="op" id="6761883">,</span>&nbsp;<span class="ident" id="6761885">input</span>&nbsp;<span class="op" id="6761891">[</span><span class="op" id="6761892">]</span><span class="builtintype" id="6761893">byte</span><span class="op" id="6761897">,</span>&nbsp;<span class="ident" id="6761899">name</span>&nbsp;<span class="builtintype" id="6761904">string</span><span class="op" id="6761910">,</span>&nbsp;<span class="ident" id="6761912">limit</span>&nbsp;<span class="builtintype" id="6761918">int</span><span class="op" id="6761921">)</span>&nbsp;<span class="op" id="6761923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761926">var</span>&nbsp;<span class="ident" id="6761930">buffer</span>&nbsp;<span class="ident" id="6761937">bytes</span><span class="op" id="6761942">.</span><span class="ident" id="6761943">Buffer</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6761951">w</span><span class="op" id="6761952">,</span>&nbsp;<span class="ident" id="6761954">err</span>&nbsp;<span class="op" id="6761958">:=</span>&nbsp;<span class="ident" id="6761961">NewWriter</span><span class="op" id="6761970">(</span><span class="op" id="6761971">&amp;</span><span class="ident" id="6761972">buffer</span><span class="op" id="6761978">,</span>&nbsp;<span class="ident" id="6761980">level</span><span class="op" id="6761985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6761988">if</span>&nbsp;<span class="ident" id="6761991">err</span>&nbsp;<span class="op" id="6761995">!=</span>&nbsp;<span class="ident" id="6761998">nil</span>&nbsp;<span class="op" id="6762002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762006">t</span><span class="op" id="6762007">.</span><span class="ident" id="6762008">Errorf</span><span class="op" id="6762014">(</span><span class="string" id="6762015">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6762030">,</span>&nbsp;<span class="ident" id="6762032">err</span><span class="op" id="6762035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762039">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762047">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762050">w</span><span class="op" id="6762051">.</span><span class="ident" id="6762052">Write</span><span class="op" id="6762057">(</span><span class="ident" id="6762058">input</span><span class="op" id="6762063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762066">w</span><span class="op" id="6762067">.</span><span class="ident" id="6762068">Close</span><span class="op" id="6762073">(</span><span class="op" id="6762074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762077">if</span>&nbsp;<span class="ident" id="6762080">limit</span>&nbsp;<span class="op" id="6762086">&gt;</span>&nbsp;<span class="num" id="6762088">0</span>&nbsp;<span class="op" id="6762090">&amp;&amp;</span>&nbsp;<span class="ident" id="6762093">buffer</span><span class="op" id="6762099">.</span><span class="ident" id="6762100">Len</span><span class="op" id="6762103">(</span><span class="op" id="6762104">)</span>&nbsp;<span class="op" id="6762106">&gt;</span>&nbsp;<span class="ident" id="6762108">limit</span>&nbsp;<span class="op" id="6762114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762118">t</span><span class="op" id="6762119">.</span><span class="ident" id="6762120">Errorf</span><span class="op" id="6762126">(</span><span class="string" id="6762127">&#34;level:&nbsp;%d,&nbsp;len(compress(data))&nbsp;=&nbsp;%d&nbsp;&gt;&nbsp;limit&nbsp;=&nbsp;%d&#34;</span><span class="op" id="6762177">,</span>&nbsp;<span class="ident" id="6762179">level</span><span class="op" id="6762184">,</span>&nbsp;<span class="ident" id="6762186">buffer</span><span class="op" id="6762192">.</span><span class="ident" id="6762193">Len</span><span class="op" id="6762196">(</span><span class="op" id="6762197">)</span><span class="op" id="6762198">,</span>&nbsp;<span class="ident" id="6762200">limit</span><span class="op" id="6762205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762209">return</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762220">r</span>&nbsp;<span class="op" id="6762222">:=</span>&nbsp;<span class="ident" id="6762225">NewReader</span><span class="op" id="6762234">(</span><span class="op" id="6762235">&amp;</span><span class="ident" id="6762236">buffer</span><span class="op" id="6762242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762245">out</span><span class="op" id="6762248">,</span>&nbsp;<span class="ident" id="6762250">err</span>&nbsp;<span class="op" id="6762254">:=</span>&nbsp;<span class="ident" id="6762257">ioutil</span><span class="op" id="6762263">.</span><span class="ident" id="6762264">ReadAll</span><span class="op" id="6762271">(</span><span class="ident" id="6762272">r</span><span class="op" id="6762273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762276">if</span>&nbsp;<span class="ident" id="6762279">err</span>&nbsp;<span class="op" id="6762283">!=</span>&nbsp;<span class="ident" id="6762286">nil</span>&nbsp;<span class="op" id="6762290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762294">t</span><span class="op" id="6762295">.</span><span class="ident" id="6762296">Errorf</span><span class="op" id="6762302">(</span><span class="string" id="6762303">&#34;read:&nbsp;%s&#34;</span><span class="op" id="6762313">,</span>&nbsp;<span class="ident" id="6762315">err</span><span class="op" id="6762318">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762333">r</span><span class="op" id="6762334">.</span><span class="ident" id="6762335">Close</span><span class="op" id="6762340">(</span><span class="op" id="6762341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762344">if</span>&nbsp;<span class="op" id="6762347">!</span><span class="ident" id="6762348">bytes</span><span class="op" id="6762353">.</span><span class="ident" id="6762354">Equal</span><span class="op" id="6762359">(</span><span class="ident" id="6762360">input</span><span class="op" id="6762365">,</span>&nbsp;<span class="ident" id="6762367">out</span><span class="op" id="6762370">)</span>&nbsp;<span class="op" id="6762372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762376">t</span><span class="op" id="6762377">.</span><span class="ident" id="6762378">Errorf</span><span class="op" id="6762384">(</span><span class="string" id="6762385">&#34;decompress(compress(data))&nbsp;!=&nbsp;data:&nbsp;level=%d&nbsp;input=%s&#34;</span><span class="op" id="6762440">,</span>&nbsp;<span class="ident" id="6762442">level</span><span class="op" id="6762447">,</span>&nbsp;<span class="ident" id="6762449">name</span><span class="op" id="6762453">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762457">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762468">testSync</span><span class="op" id="6762476">(</span><span class="ident" id="6762477">t</span><span class="op" id="6762478">,</span>&nbsp;<span class="ident" id="6762480">level</span><span class="op" id="6762485">,</span>&nbsp;<span class="ident" id="6762487">input</span><span class="op" id="6762492">,</span>&nbsp;<span class="ident" id="6762494">name</span><span class="op" id="6762498">)</span><br>
<span class="lineno"></span><span class="op" id="6762500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span><span class="keyword" id="6762503">func</span>&nbsp;<span class="ident" id="6762508">testToFromWithLimit</span><span class="op" id="6762527">(</span><span class="ident" id="6762528">t</span>&nbsp;<span class="op" id="6762530">*</span><span class="ident" id="6762531">testing</span><span class="op" id="6762538">.</span><span class="ident" id="6762539">T</span><span class="op" id="6762540">,</span>&nbsp;<span class="ident" id="6762542">input</span>&nbsp;<span class="op" id="6762548">[</span><span class="op" id="6762549">]</span><span class="builtintype" id="6762550">byte</span><span class="op" id="6762554">,</span>&nbsp;<span class="ident" id="6762556">name</span>&nbsp;<span class="builtintype" id="6762561">string</span><span class="op" id="6762567">,</span>&nbsp;<span class="ident" id="6762569">limit</span>&nbsp;<span class="op" id="6762575">[</span><span class="num" id="6762576">10</span><span class="op" id="6762578">]</span><span class="builtintype" id="6762579">int</span><span class="op" id="6762582">)</span>&nbsp;<span class="op" id="6762584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762587">for</span>&nbsp;<span class="ident" id="6762591">i</span>&nbsp;<span class="op" id="6762593">:=</span>&nbsp;<span class="num" id="6762596">0</span><span class="op" id="6762597">;</span>&nbsp;<span class="ident" id="6762599">i</span>&nbsp;<span class="op" id="6762601">&lt;</span>&nbsp;<span class="num" id="6762603">10</span><span class="op" id="6762605">;</span>&nbsp;<span class="ident" id="6762607">i</span><span class="op" id="6762608">++</span>&nbsp;<span class="op" id="6762611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762615">testToFromWithLevelAndLimit</span><span class="op" id="6762642">(</span><span class="ident" id="6762643">t</span><span class="op" id="6762644">,</span>&nbsp;<span class="ident" id="6762646">i</span><span class="op" id="6762647">,</span>&nbsp;<span class="ident" id="6762649">input</span><span class="op" id="6762654">,</span>&nbsp;<span class="ident" id="6762656">name</span><span class="op" id="6762660">,</span>&nbsp;<span class="ident" id="6762662">limit</span><span class="op" id="6762667">[</span><span class="ident" id="6762668">i</span><span class="op" id="6762669">]</span><span class="op" id="6762670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762673">}</span><br>
<span class="lineno"></span><span class="op" id="6762675">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span><span class="keyword" id="6762678">func</span>&nbsp;<span class="ident" id="6762683">TestDeflateInflate</span><span class="op" id="6762701">(</span><span class="ident" id="6762702">t</span>&nbsp;<span class="op" id="6762704">*</span><span class="ident" id="6762705">testing</span><span class="op" id="6762712">.</span><span class="ident" id="6762713">T</span><span class="op" id="6762714">)</span>&nbsp;<span class="op" id="6762716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762719">for</span>&nbsp;<span class="ident" id="6762723">i</span><span class="op" id="6762724">,</span>&nbsp;<span class="ident" id="6762726">h</span>&nbsp;<span class="op" id="6762728">:=</span>&nbsp;<span class="keyword" id="6762731">range</span>&nbsp;<span class="ident" id="6762737">deflateInflateTests</span>&nbsp;<span class="op" id="6762757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762761">testToFromWithLimit</span><span class="op" id="6762780">(</span><span class="ident" id="6762781">t</span><span class="op" id="6762782">,</span>&nbsp;<span class="ident" id="6762784">h</span><span class="op" id="6762785">.</span><span class="ident" id="6762786">in</span><span class="op" id="6762788">,</span>&nbsp;<span class="ident" id="6762790">fmt</span><span class="op" id="6762793">.</span><span class="ident" id="6762794">Sprintf</span><span class="op" id="6762801">(</span><span class="string" id="6762802">&#34;#%d&#34;</span><span class="op" id="6762807">,</span>&nbsp;<span class="ident" id="6762809">i</span><span class="op" id="6762810">)</span><span class="op" id="6762811">,</span>&nbsp;<span class="op" id="6762813">[</span><span class="num" id="6762814">10</span><span class="op" id="6762816">]</span><span class="builtintype" id="6762817">int</span><span class="op" id="6762820">{</span><span class="op" id="6762821">}</span><span class="op" id="6762822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6762825">}</span><br>
<span class="lineno">315</span><span class="op" id="6762827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6762830">func</span>&nbsp;<span class="ident" id="6762835">TestReverseBits</span><span class="op" id="6762850">(</span><span class="ident" id="6762851">t</span>&nbsp;<span class="op" id="6762853">*</span><span class="ident" id="6762854">testing</span><span class="op" id="6762861">.</span><span class="ident" id="6762862">T</span><span class="op" id="6762863">)</span>&nbsp;<span class="op" id="6762865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762868">for</span>&nbsp;<span class="ident" id="6762872">_</span><span class="op" id="6762873">,</span>&nbsp;<span class="ident" id="6762875">h</span>&nbsp;<span class="op" id="6762877">:=</span>&nbsp;<span class="keyword" id="6762880">range</span>&nbsp;<span class="ident" id="6762886">reverseBitsTests</span>&nbsp;<span class="op" id="6762903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6762907">if</span>&nbsp;<span class="ident" id="6762910">v</span>&nbsp;<span class="op" id="6762912">:=</span>&nbsp;<span class="ident" id="6762915">reverseBits</span><span class="op" id="6762926">(</span><span class="ident" id="6762927">h</span><span class="op" id="6762928">.</span><span class="ident" id="6762929">in</span><span class="op" id="6762931">,</span>&nbsp;<span class="ident" id="6762933">h</span><span class="op" id="6762934">.</span><span class="ident" id="6762935">bitCount</span><span class="op" id="6762943">)</span><span class="op" id="6762944">;</span>&nbsp;<span class="ident" id="6762946">v</span>&nbsp;<span class="op" id="6762948">!=</span>&nbsp;<span class="ident" id="6762951">h</span><span class="op" id="6762952">.</span><span class="ident" id="6762953">out</span>&nbsp;<span class="op" id="6762957">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6762962">t</span><span class="op" id="6762963">.</span><span class="ident" id="6762964">Errorf</span><span class="op" id="6762970">(</span><span class="string" id="6762971">&#34;reverseBits(%v,%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6763005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763011">h</span><span class="op" id="6763012">.</span><span class="ident" id="6763013">in</span><span class="op" id="6763015">,</span>&nbsp;<span class="ident" id="6763017">h</span><span class="op" id="6763018">.</span><span class="ident" id="6763019">bitCount</span><span class="op" id="6763027">,</span>&nbsp;<span class="ident" id="6763029">v</span><span class="op" id="6763030">,</span>&nbsp;<span class="ident" id="6763032">h</span><span class="op" id="6763033">.</span><span class="ident" id="6763034">out</span><span class="op" id="6763037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763044">}</span><br>
<span class="lineno"></span><span class="op" id="6763046">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="6763049">type</span>&nbsp;<span class="ident" id="6763054">deflateInflateStringTest</span>&nbsp;<span class="keyword" id="6763079">struct</span>&nbsp;<span class="op" id="6763086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763089">filename</span>&nbsp;<span class="builtintype" id="6763098">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763106">label</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6763115">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763123">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6763132">[</span><span class="num" id="6763133">10</span><span class="op" id="6763135">]</span><span class="builtintype" id="6763136">int</span><br>
<span class="lineno">330</span><span class="op" id="6763140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6763143">var</span>&nbsp;<span class="ident" id="6763147">deflateInflateStringTests</span>&nbsp;<span class="op" id="6763173">=</span>&nbsp;<span class="op" id="6763175">[</span><span class="op" id="6763176">]</span><span class="ident" id="6763177">deflateInflateStringTest</span><span class="op" id="6763201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6763208">&#34;../testdata/e.txt&#34;</span><span class="op" id="6763227">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6763231">&#34;2.718281828...&#34;</span><span class="op" id="6763247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763251">[</span><span class="op" id="6763252">...</span><span class="op" id="6763255">]</span><span class="builtintype" id="6763256">int</span><span class="op" id="6763259">{</span><span class="num" id="6763260">100018</span><span class="op" id="6763266">,</span>&nbsp;<span class="num" id="6763268">50650</span><span class="op" id="6763273">,</span>&nbsp;<span class="num" id="6763275">50960</span><span class="op" id="6763280">,</span>&nbsp;<span class="num" id="6763282">51150</span><span class="op" id="6763287">,</span>&nbsp;<span class="num" id="6763289">50930</span><span class="op" id="6763294">,</span>&nbsp;<span class="num" id="6763296">50790</span><span class="op" id="6763301">,</span>&nbsp;<span class="num" id="6763303">50790</span><span class="op" id="6763308">,</span>&nbsp;<span class="num" id="6763310">50790</span><span class="op" id="6763315">,</span>&nbsp;<span class="num" id="6763317">50790</span><span class="op" id="6763322">,</span>&nbsp;<span class="num" id="6763324">50790</span><span class="op" id="6763329">}</span><span class="op" id="6763330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763333">}</span><span class="op" id="6763334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6763341">&#34;../testdata/Mark.Twain-Tom.Sawyer.txt&#34;</span><span class="op" id="6763380">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6763384">&#34;Mark.Twain-Tom.Sawyer&#34;</span><span class="op" id="6763407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763411">[</span><span class="op" id="6763412">...</span><span class="op" id="6763415">]</span><span class="builtintype" id="6763416">int</span><span class="op" id="6763419">{</span><span class="num" id="6763420">407330</span><span class="op" id="6763426">,</span>&nbsp;<span class="num" id="6763428">187598</span><span class="op" id="6763434">,</span>&nbsp;<span class="num" id="6763436">180361</span><span class="op" id="6763442">,</span>&nbsp;<span class="num" id="6763444">172974</span><span class="op" id="6763450">,</span>&nbsp;<span class="num" id="6763452">169160</span><span class="op" id="6763458">,</span>&nbsp;<span class="num" id="6763460">163476</span><span class="op" id="6763466">,</span>&nbsp;<span class="num" id="6763468">160936</span><span class="op" id="6763474">,</span>&nbsp;<span class="num" id="6763476">160506</span><span class="op" id="6763482">,</span>&nbsp;<span class="num" id="6763484">160295</span><span class="op" id="6763490">,</span>&nbsp;<span class="num" id="6763492">160295</span><span class="op" id="6763498">}</span><span class="op" id="6763499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763502">}</span><span class="op" id="6763503">,</span><br>
<span class="lineno"></span><span class="op" id="6763505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="6763508">func</span>&nbsp;<span class="ident" id="6763513">TestDeflateInflateString</span><span class="op" id="6763537">(</span><span class="ident" id="6763538">t</span>&nbsp;<span class="op" id="6763540">*</span><span class="ident" id="6763541">testing</span><span class="op" id="6763548">.</span><span class="ident" id="6763549">T</span><span class="op" id="6763550">)</span>&nbsp;<span class="op" id="6763552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763555">for</span>&nbsp;<span class="ident" id="6763559">_</span><span class="op" id="6763560">,</span>&nbsp;<span class="ident" id="6763562">test</span>&nbsp;<span class="op" id="6763567">:=</span>&nbsp;<span class="keyword" id="6763570">range</span>&nbsp;<span class="ident" id="6763576">deflateInflateStringTests</span>&nbsp;<span class="op" id="6763602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763606">gold</span><span class="op" id="6763610">,</span>&nbsp;<span class="ident" id="6763612">err</span>&nbsp;<span class="op" id="6763616">:=</span>&nbsp;<span class="ident" id="6763619">ioutil</span><span class="op" id="6763625">.</span><span class="ident" id="6763626">ReadFile</span><span class="op" id="6763634">(</span><span class="ident" id="6763635">test</span><span class="op" id="6763639">.</span><span class="ident" id="6763640">filename</span><span class="op" id="6763648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763652">if</span>&nbsp;<span class="ident" id="6763655">err</span>&nbsp;<span class="op" id="6763659">!=</span>&nbsp;<span class="ident" id="6763662">nil</span>&nbsp;<span class="op" id="6763666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763671">t</span><span class="op" id="6763672">.</span><span class="ident" id="6763673">Error</span><span class="op" id="6763678">(</span><span class="ident" id="6763679">err</span><span class="op" id="6763682">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763690">testToFromWithLimit</span><span class="op" id="6763709">(</span><span class="ident" id="6763710">t</span><span class="op" id="6763711">,</span>&nbsp;<span class="ident" id="6763713">gold</span><span class="op" id="6763717">,</span>&nbsp;<span class="ident" id="6763719">test</span><span class="op" id="6763723">.</span><span class="ident" id="6763724">label</span><span class="op" id="6763729">,</span>&nbsp;<span class="ident" id="6763731">test</span><span class="op" id="6763735">.</span><span class="ident" id="6763736">limit</span><span class="op" id="6763741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763745">if</span>&nbsp;<span class="ident" id="6763748">testing</span><span class="op" id="6763755">.</span><span class="ident" id="6763756">Short</span><span class="op" id="6763761">(</span><span class="op" id="6763762">)</span>&nbsp;<span class="op" id="6763764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763769">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763777">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763780">}</span><br>
<span class="lineno"></span><span class="op" id="6763782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6763785">func</span>&nbsp;<span class="ident" id="6763790">TestReaderDict</span><span class="op" id="6763804">(</span><span class="ident" id="6763805">t</span>&nbsp;<span class="op" id="6763807">*</span><span class="ident" id="6763808">testing</span><span class="op" id="6763815">.</span><span class="ident" id="6763816">T</span><span class="op" id="6763817">)</span>&nbsp;<span class="op" id="6763819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763822">const</span>&nbsp;<span class="op" id="6763828">(</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763832">dict</span>&nbsp;<span class="op" id="6763837">=</span>&nbsp;<span class="string" id="6763839">&#34;hello&nbsp;world&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763855">text</span>&nbsp;<span class="op" id="6763860">=</span>&nbsp;<span class="string" id="6763862">&#34;hello&nbsp;again&nbsp;world&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763886">var</span>&nbsp;<span class="ident" id="6763890">b</span>&nbsp;<span class="ident" id="6763892">bytes</span><span class="op" id="6763897">.</span><span class="ident" id="6763898">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763906">w</span><span class="op" id="6763907">,</span>&nbsp;<span class="ident" id="6763909">err</span>&nbsp;<span class="op" id="6763913">:=</span>&nbsp;<span class="ident" id="6763916">NewWriter</span><span class="op" id="6763925">(</span><span class="op" id="6763926">&amp;</span><span class="ident" id="6763927">b</span><span class="op" id="6763928">,</span>&nbsp;<span class="num" id="6763930">5</span><span class="op" id="6763931">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6763934">if</span>&nbsp;<span class="ident" id="6763937">err</span>&nbsp;<span class="op" id="6763941">!=</span>&nbsp;<span class="ident" id="6763944">nil</span>&nbsp;<span class="op" id="6763948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763952">t</span><span class="op" id="6763953">.</span><span class="ident" id="6763954">Fatalf</span><span class="op" id="6763960">(</span><span class="string" id="6763961">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6763976">,</span>&nbsp;<span class="ident" id="6763978">err</span><span class="op" id="6763981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6763984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6763987">w</span><span class="op" id="6763988">.</span><span class="ident" id="6763989">Write</span><span class="op" id="6763994">(</span><span class="op" id="6763995">[</span><span class="op" id="6763996">]</span><span class="builtintype" id="6763997">byte</span><span class="op" id="6764001">(</span><span class="ident" id="6764002">dict</span><span class="op" id="6764006">)</span><span class="op" id="6764007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764010">w</span><span class="op" id="6764011">.</span><span class="ident" id="6764012">Flush</span><span class="op" id="6764017">(</span><span class="op" id="6764018">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764021">b</span><span class="op" id="6764022">.</span><span class="ident" id="6764023">Reset</span><span class="op" id="6764028">(</span><span class="op" id="6764029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764032">w</span><span class="op" id="6764033">.</span><span class="ident" id="6764034">Write</span><span class="op" id="6764039">(</span><span class="op" id="6764040">[</span><span class="op" id="6764041">]</span><span class="builtintype" id="6764042">byte</span><span class="op" id="6764046">(</span><span class="ident" id="6764047">text</span><span class="op" id="6764051">)</span><span class="op" id="6764052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764055">w</span><span class="op" id="6764056">.</span><span class="ident" id="6764057">Close</span><span class="op" id="6764062">(</span><span class="op" id="6764063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764067">r</span>&nbsp;<span class="op" id="6764069">:=</span>&nbsp;<span class="ident" id="6764072">NewReaderDict</span><span class="op" id="6764085">(</span><span class="op" id="6764086">&amp;</span><span class="ident" id="6764087">b</span><span class="op" id="6764088">,</span>&nbsp;<span class="op" id="6764090">[</span><span class="op" id="6764091">]</span><span class="builtintype" id="6764092">byte</span><span class="op" id="6764096">(</span><span class="ident" id="6764097">dict</span><span class="op" id="6764101">)</span><span class="op" id="6764102">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764105">data</span><span class="op" id="6764109">,</span>&nbsp;<span class="ident" id="6764111">err</span>&nbsp;<span class="op" id="6764115">:=</span>&nbsp;<span class="ident" id="6764118">ioutil</span><span class="op" id="6764124">.</span><span class="ident" id="6764125">ReadAll</span><span class="op" id="6764132">(</span><span class="ident" id="6764133">r</span><span class="op" id="6764134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764137">if</span>&nbsp;<span class="ident" id="6764140">err</span>&nbsp;<span class="op" id="6764144">!=</span>&nbsp;<span class="ident" id="6764147">nil</span>&nbsp;<span class="op" id="6764151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764155">t</span><span class="op" id="6764156">.</span><span class="ident" id="6764157">Fatal</span><span class="op" id="6764162">(</span><span class="ident" id="6764163">err</span><span class="op" id="6764166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764172">if</span>&nbsp;<span class="builtintype" id="6764175">string</span><span class="op" id="6764181">(</span><span class="ident" id="6764182">data</span><span class="op" id="6764186">)</span>&nbsp;<span class="op" id="6764188">!=</span>&nbsp;<span class="string" id="6764191">&#34;hello&nbsp;again&nbsp;world&#34;</span>&nbsp;<span class="op" id="6764211">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764215">t</span><span class="op" id="6764216">.</span><span class="ident" id="6764217">Fatalf</span><span class="op" id="6764223">(</span><span class="string" id="6764224">&#34;read&nbsp;returned&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6764250">,</span>&nbsp;<span class="builtintype" id="6764252">string</span><span class="op" id="6764258">(</span><span class="ident" id="6764259">data</span><span class="op" id="6764263">)</span><span class="op" id="6764264">,</span>&nbsp;<span class="ident" id="6764266">text</span><span class="op" id="6764270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764273">}</span><br>
<span class="lineno"></span><span class="op" id="6764275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6764278">func</span>&nbsp;<span class="ident" id="6764283">TestWriterDict</span><span class="op" id="6764297">(</span><span class="ident" id="6764298">t</span>&nbsp;<span class="op" id="6764300">*</span><span class="ident" id="6764301">testing</span><span class="op" id="6764308">.</span><span class="ident" id="6764309">T</span><span class="op" id="6764310">)</span>&nbsp;<span class="op" id="6764312">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764315">const</span>&nbsp;<span class="op" id="6764321">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764325">dict</span>&nbsp;<span class="op" id="6764330">=</span>&nbsp;<span class="string" id="6764332">&#34;hello&nbsp;world&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764348">text</span>&nbsp;<span class="op" id="6764353">=</span>&nbsp;<span class="string" id="6764355">&#34;hello&nbsp;again&nbsp;world&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764379">var</span>&nbsp;<span class="ident" id="6764383">b</span>&nbsp;<span class="ident" id="6764385">bytes</span><span class="op" id="6764390">.</span><span class="ident" id="6764391">Buffer</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764399">w</span><span class="op" id="6764400">,</span>&nbsp;<span class="ident" id="6764402">err</span>&nbsp;<span class="op" id="6764406">:=</span>&nbsp;<span class="ident" id="6764409">NewWriter</span><span class="op" id="6764418">(</span><span class="op" id="6764419">&amp;</span><span class="ident" id="6764420">b</span><span class="op" id="6764421">,</span>&nbsp;<span class="num" id="6764423">5</span><span class="op" id="6764424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764427">if</span>&nbsp;<span class="ident" id="6764430">err</span>&nbsp;<span class="op" id="6764434">!=</span>&nbsp;<span class="ident" id="6764437">nil</span>&nbsp;<span class="op" id="6764441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764445">t</span><span class="op" id="6764446">.</span><span class="ident" id="6764447">Fatalf</span><span class="op" id="6764453">(</span><span class="string" id="6764454">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6764469">,</span>&nbsp;<span class="ident" id="6764471">err</span><span class="op" id="6764474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764480">w</span><span class="op" id="6764481">.</span><span class="ident" id="6764482">Write</span><span class="op" id="6764487">(</span><span class="op" id="6764488">[</span><span class="op" id="6764489">]</span><span class="builtintype" id="6764490">byte</span><span class="op" id="6764494">(</span><span class="ident" id="6764495">dict</span><span class="op" id="6764499">)</span><span class="op" id="6764500">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764503">w</span><span class="op" id="6764504">.</span><span class="ident" id="6764505">Flush</span><span class="op" id="6764510">(</span><span class="op" id="6764511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764514">b</span><span class="op" id="6764515">.</span><span class="ident" id="6764516">Reset</span><span class="op" id="6764521">(</span><span class="op" id="6764522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764525">w</span><span class="op" id="6764526">.</span><span class="ident" id="6764527">Write</span><span class="op" id="6764532">(</span><span class="op" id="6764533">[</span><span class="op" id="6764534">]</span><span class="builtintype" id="6764535">byte</span><span class="op" id="6764539">(</span><span class="ident" id="6764540">text</span><span class="op" id="6764544">)</span><span class="op" id="6764545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764548">w</span><span class="op" id="6764549">.</span><span class="ident" id="6764550">Close</span><span class="op" id="6764555">(</span><span class="op" id="6764556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764560">var</span>&nbsp;<span class="ident" id="6764564">b1</span>&nbsp;<span class="ident" id="6764567">bytes</span><span class="op" id="6764572">.</span><span class="ident" id="6764573">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764581">w</span><span class="op" id="6764582">,</span>&nbsp;<span class="ident" id="6764584">_</span>&nbsp;<span class="op" id="6764586">=</span>&nbsp;<span class="ident" id="6764588">NewWriterDict</span><span class="op" id="6764601">(</span><span class="op" id="6764602">&amp;</span><span class="ident" id="6764603">b1</span><span class="op" id="6764605">,</span>&nbsp;<span class="num" id="6764607">5</span><span class="op" id="6764608">,</span>&nbsp;<span class="op" id="6764610">[</span><span class="op" id="6764611">]</span><span class="builtintype" id="6764612">byte</span><span class="op" id="6764616">(</span><span class="ident" id="6764617">dict</span><span class="op" id="6764621">)</span><span class="op" id="6764622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764625">w</span><span class="op" id="6764626">.</span><span class="ident" id="6764627">Write</span><span class="op" id="6764632">(</span><span class="op" id="6764633">[</span><span class="op" id="6764634">]</span><span class="builtintype" id="6764635">byte</span><span class="op" id="6764639">(</span><span class="ident" id="6764640">text</span><span class="op" id="6764644">)</span><span class="op" id="6764645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764648">w</span><span class="op" id="6764649">.</span><span class="ident" id="6764650">Close</span><span class="op" id="6764655">(</span><span class="op" id="6764656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764660">if</span>&nbsp;<span class="op" id="6764663">!</span><span class="ident" id="6764664">bytes</span><span class="op" id="6764669">.</span><span class="ident" id="6764670">Equal</span><span class="op" id="6764675">(</span><span class="ident" id="6764676">b1</span><span class="op" id="6764678">.</span><span class="ident" id="6764679">Bytes</span><span class="op" id="6764684">(</span><span class="op" id="6764685">)</span><span class="op" id="6764686">,</span>&nbsp;<span class="ident" id="6764688">b</span><span class="op" id="6764689">.</span><span class="ident" id="6764690">Bytes</span><span class="op" id="6764695">(</span><span class="op" id="6764696">)</span><span class="op" id="6764697">)</span>&nbsp;<span class="op" id="6764699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764703">t</span><span class="op" id="6764704">.</span><span class="ident" id="6764705">Fatalf</span><span class="op" id="6764711">(</span><span class="string" id="6764712">&#34;writer&nbsp;wrote&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6764737">,</span>&nbsp;<span class="ident" id="6764739">b1</span><span class="op" id="6764741">.</span><span class="ident" id="6764742">Bytes</span><span class="op" id="6764747">(</span><span class="op" id="6764748">)</span><span class="op" id="6764749">,</span>&nbsp;<span class="ident" id="6764751">b</span><span class="op" id="6764752">.</span><span class="ident" id="6764753">Bytes</span><span class="op" id="6764758">(</span><span class="op" id="6764759">)</span><span class="op" id="6764760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764763">}</span><br>
<span class="lineno"></span><span class="op" id="6764765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="comment" id="6764768">//&nbsp;See&nbsp;http://code.google.com/p/go/issues/detail?id=2508</span><br>
<span class="lineno"></span><span class="keyword" id="6764825">func</span>&nbsp;<span class="ident" id="6764830">TestRegression2508</span><span class="op" id="6764848">(</span><span class="ident" id="6764849">t</span>&nbsp;<span class="op" id="6764851">*</span><span class="ident" id="6764852">testing</span><span class="op" id="6764859">.</span><span class="ident" id="6764860">T</span><span class="op" id="6764861">)</span>&nbsp;<span class="op" id="6764863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764866">if</span>&nbsp;<span class="ident" id="6764869">testing</span><span class="op" id="6764876">.</span><span class="ident" id="6764877">Short</span><span class="op" id="6764882">(</span><span class="op" id="6764883">)</span>&nbsp;<span class="op" id="6764885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764889">t</span><span class="op" id="6764890">.</span><span class="ident" id="6764891">Logf</span><span class="op" id="6764895">(</span><span class="string" id="6764896">&#34;test&nbsp;disabled&nbsp;with&nbsp;-short&#34;</span><span class="op" id="6764923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764927">return</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6764935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764938">w</span><span class="op" id="6764939">,</span>&nbsp;<span class="ident" id="6764941">err</span>&nbsp;<span class="op" id="6764945">:=</span>&nbsp;<span class="ident" id="6764948">NewWriter</span><span class="op" id="6764957">(</span><span class="ident" id="6764958">ioutil</span><span class="op" id="6764964">.</span><span class="ident" id="6764965">Discard</span><span class="op" id="6764972">,</span>&nbsp;<span class="num" id="6764974">1</span><span class="op" id="6764975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6764978">if</span>&nbsp;<span class="ident" id="6764981">err</span>&nbsp;<span class="op" id="6764985">!=</span>&nbsp;<span class="ident" id="6764988">nil</span>&nbsp;<span class="op" id="6764992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6764996">t</span><span class="op" id="6764997">.</span><span class="ident" id="6764998">Fatalf</span><span class="op" id="6765004">(</span><span class="string" id="6765005">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6765020">,</span>&nbsp;<span class="ident" id="6765022">err</span><span class="op" id="6765025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765028">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765031">buf</span>&nbsp;<span class="op" id="6765035">:=</span>&nbsp;<span class="builtinfunc" id="6765038">make</span><span class="op" id="6765042">(</span><span class="op" id="6765043">[</span><span class="op" id="6765044">]</span><span class="builtintype" id="6765045">byte</span><span class="op" id="6765049">,</span>&nbsp;<span class="num" id="6765051">1024</span><span class="op" id="6765055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765058">for</span>&nbsp;<span class="ident" id="6765062">i</span>&nbsp;<span class="op" id="6765064">:=</span>&nbsp;<span class="num" id="6765067">0</span><span class="op" id="6765068">;</span>&nbsp;<span class="ident" id="6765070">i</span>&nbsp;<span class="op" id="6765072">&lt;</span>&nbsp;<span class="num" id="6765074">131072</span><span class="op" id="6765080">;</span>&nbsp;<span class="ident" id="6765082">i</span><span class="op" id="6765083">++</span>&nbsp;<span class="op" id="6765086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765090">if</span>&nbsp;<span class="ident" id="6765093">_</span><span class="op" id="6765094">,</span>&nbsp;<span class="ident" id="6765096">err</span>&nbsp;<span class="op" id="6765100">:=</span>&nbsp;<span class="ident" id="6765103">w</span><span class="op" id="6765104">.</span><span class="ident" id="6765105">Write</span><span class="op" id="6765110">(</span><span class="ident" id="6765111">buf</span><span class="op" id="6765114">)</span><span class="op" id="6765115">;</span>&nbsp;<span class="ident" id="6765117">err</span>&nbsp;<span class="op" id="6765121">!=</span>&nbsp;<span class="ident" id="6765124">nil</span>&nbsp;<span class="op" id="6765128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765133">t</span><span class="op" id="6765134">.</span><span class="ident" id="6765135">Fatalf</span><span class="op" id="6765141">(</span><span class="string" id="6765142">&#34;writer&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6765161">,</span>&nbsp;<span class="ident" id="6765163">err</span><span class="op" id="6765166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765170">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765176">w</span><span class="op" id="6765177">.</span><span class="ident" id="6765178">Close</span><span class="op" id="6765183">(</span><span class="op" id="6765184">)</span><br>
<span class="lineno"></span><span class="op" id="6765186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6765189">func</span>&nbsp;<span class="ident" id="6765194">TestWriterReset</span><span class="op" id="6765209">(</span><span class="ident" id="6765210">t</span>&nbsp;<span class="op" id="6765212">*</span><span class="ident" id="6765213">testing</span><span class="op" id="6765220">.</span><span class="ident" id="6765221">T</span><span class="op" id="6765222">)</span>&nbsp;<span class="op" id="6765224">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765227">for</span>&nbsp;<span class="ident" id="6765231">level</span>&nbsp;<span class="op" id="6765237">:=</span>&nbsp;<span class="num" id="6765240">0</span><span class="op" id="6765241">;</span>&nbsp;<span class="ident" id="6765243">level</span>&nbsp;<span class="op" id="6765249">&lt;=</span>&nbsp;<span class="num" id="6765252">9</span><span class="op" id="6765253">;</span>&nbsp;<span class="ident" id="6765255">level</span><span class="op" id="6765260">++</span>&nbsp;<span class="op" id="6765263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765267">if</span>&nbsp;<span class="ident" id="6765270">testing</span><span class="op" id="6765277">.</span><span class="ident" id="6765278">Short</span><span class="op" id="6765283">(</span><span class="op" id="6765284">)</span>&nbsp;<span class="op" id="6765286">&amp;&amp;</span>&nbsp;<span class="ident" id="6765289">level</span>&nbsp;<span class="op" id="6765295">&gt;</span>&nbsp;<span class="num" id="6765297">1</span>&nbsp;<span class="op" id="6765299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765304">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765316">w</span><span class="op" id="6765317">,</span>&nbsp;<span class="ident" id="6765319">err</span>&nbsp;<span class="op" id="6765323">:=</span>&nbsp;<span class="ident" id="6765326">NewWriter</span><span class="op" id="6765335">(</span><span class="ident" id="6765336">ioutil</span><span class="op" id="6765342">.</span><span class="ident" id="6765343">Discard</span><span class="op" id="6765350">,</span>&nbsp;<span class="ident" id="6765352">level</span><span class="op" id="6765357">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765361">if</span>&nbsp;<span class="ident" id="6765364">err</span>&nbsp;<span class="op" id="6765368">!=</span>&nbsp;<span class="ident" id="6765371">nil</span>&nbsp;<span class="op" id="6765375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765380">t</span><span class="op" id="6765381">.</span><span class="ident" id="6765382">Fatalf</span><span class="op" id="6765388">(</span><span class="string" id="6765389">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6765404">,</span>&nbsp;<span class="ident" id="6765406">err</span><span class="op" id="6765409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765417">buf</span>&nbsp;<span class="op" id="6765421">:=</span>&nbsp;<span class="op" id="6765424">[</span><span class="op" id="6765425">]</span><span class="builtintype" id="6765426">byte</span><span class="op" id="6765430">(</span><span class="string" id="6765431">&#34;hello&nbsp;world&#34;</span><span class="op" id="6765444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765448">for</span>&nbsp;<span class="ident" id="6765452">i</span>&nbsp;<span class="op" id="6765454">:=</span>&nbsp;<span class="num" id="6765457">0</span><span class="op" id="6765458">;</span>&nbsp;<span class="ident" id="6765460">i</span>&nbsp;<span class="op" id="6765462">&lt;</span>&nbsp;<span class="num" id="6765464">1024</span><span class="op" id="6765468">;</span>&nbsp;<span class="ident" id="6765470">i</span><span class="op" id="6765471">++</span>&nbsp;<span class="op" id="6765474">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765479">w</span><span class="op" id="6765480">.</span><span class="ident" id="6765481">Write</span><span class="op" id="6765486">(</span><span class="ident" id="6765487">buf</span><span class="op" id="6765490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765498">w</span><span class="op" id="6765499">.</span><span class="ident" id="6765500">Reset</span><span class="op" id="6765505">(</span><span class="ident" id="6765506">ioutil</span><span class="op" id="6765512">.</span><span class="ident" id="6765513">Discard</span><span class="op" id="6765520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765525">wref</span><span class="op" id="6765529">,</span>&nbsp;<span class="ident" id="6765531">err</span>&nbsp;<span class="op" id="6765535">:=</span>&nbsp;<span class="ident" id="6765538">NewWriter</span><span class="op" id="6765547">(</span><span class="ident" id="6765548">ioutil</span><span class="op" id="6765554">.</span><span class="ident" id="6765555">Discard</span><span class="op" id="6765562">,</span>&nbsp;<span class="ident" id="6765564">level</span><span class="op" id="6765569">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765573">if</span>&nbsp;<span class="ident" id="6765576">err</span>&nbsp;<span class="op" id="6765580">!=</span>&nbsp;<span class="ident" id="6765583">nil</span>&nbsp;<span class="op" id="6765587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765592">t</span><span class="op" id="6765593">.</span><span class="ident" id="6765594">Fatalf</span><span class="op" id="6765600">(</span><span class="string" id="6765601">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6765616">,</span>&nbsp;<span class="ident" id="6765618">err</span><span class="op" id="6765621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6765630">//&nbsp;DeepEqual&nbsp;doesn&#39;t&nbsp;compare&nbsp;functions.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765672">w</span><span class="op" id="6765673">.</span><span class="ident" id="6765674">d</span><span class="op" id="6765675">.</span><span class="ident" id="6765676">fill</span><span class="op" id="6765680">,</span>&nbsp;<span class="ident" id="6765682">wref</span><span class="op" id="6765686">.</span><span class="ident" id="6765687">d</span><span class="op" id="6765688">.</span><span class="ident" id="6765689">fill</span>&nbsp;<span class="op" id="6765694">=</span>&nbsp;<span class="ident" id="6765696">nil</span><span class="op" id="6765699">,</span>&nbsp;<span class="ident" id="6765701">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765707">w</span><span class="op" id="6765708">.</span><span class="ident" id="6765709">d</span><span class="op" id="6765710">.</span><span class="ident" id="6765711">step</span><span class="op" id="6765715">,</span>&nbsp;<span class="ident" id="6765717">wref</span><span class="op" id="6765721">.</span><span class="ident" id="6765722">d</span><span class="op" id="6765723">.</span><span class="ident" id="6765724">step</span>&nbsp;<span class="op" id="6765729">=</span>&nbsp;<span class="ident" id="6765731">nil</span><span class="op" id="6765734">,</span>&nbsp;<span class="ident" id="6765736">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6765742">if</span>&nbsp;<span class="op" id="6765745">!</span><span class="ident" id="6765746">reflect</span><span class="op" id="6765753">.</span><span class="ident" id="6765754">DeepEqual</span><span class="op" id="6765763">(</span><span class="ident" id="6765764">w</span><span class="op" id="6765765">,</span>&nbsp;<span class="ident" id="6765767">wref</span><span class="op" id="6765771">)</span>&nbsp;<span class="op" id="6765773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765778">t</span><span class="op" id="6765779">.</span><span class="ident" id="6765780">Errorf</span><span class="op" id="6765786">(</span><span class="string" id="6765787">&#34;level&nbsp;%d&nbsp;Writer&nbsp;not&nbsp;reset&nbsp;after&nbsp;Reset&#34;</span><span class="op" id="6765826">,</span>&nbsp;<span class="ident" id="6765828">level</span><span class="op" id="6765833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765837">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6765840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765843">testResetOutput</span><span class="op" id="6765858">(</span><span class="ident" id="6765859">t</span><span class="op" id="6765860">,</span>&nbsp;<span class="keyword" id="6765862">func</span><span class="op" id="6765866">(</span><span class="ident" id="6765867">w</span>&nbsp;<span class="ident" id="6765869">io</span><span class="op" id="6765871">.</span><span class="ident" id="6765872">Writer</span><span class="op" id="6765878">)</span>&nbsp;<span class="op" id="6765880">(</span><span class="op" id="6765881">*</span><span class="ident" id="6765882">Writer</span><span class="op" id="6765888">,</span>&nbsp;<span class="builtintype" id="6765890">error</span><span class="op" id="6765895">)</span>&nbsp;<span class="op" id="6765897">{</span>&nbsp;<span class="keyword" id="6765899">return</span>&nbsp;<span class="ident" id="6765906">NewWriter</span><span class="op" id="6765915">(</span><span class="ident" id="6765916">w</span><span class="op" id="6765917">,</span>&nbsp;<span class="ident" id="6765919">NoCompression</span><span class="op" id="6765932">)</span>&nbsp;<span class="op" id="6765934">}</span><span class="op" id="6765935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6765938">testResetOutput</span><span class="op" id="6765953">(</span><span class="ident" id="6765954">t</span><span class="op" id="6765955">,</span>&nbsp;<span class="keyword" id="6765957">func</span><span class="op" id="6765961">(</span><span class="ident" id="6765962">w</span>&nbsp;<span class="ident" id="6765964">io</span><span class="op" id="6765966">.</span><span class="ident" id="6765967">Writer</span><span class="op" id="6765973">)</span>&nbsp;<span class="op" id="6765975">(</span><span class="op" id="6765976">*</span><span class="ident" id="6765977">Writer</span><span class="op" id="6765983">,</span>&nbsp;<span class="builtintype" id="6765985">error</span><span class="op" id="6765990">)</span>&nbsp;<span class="op" id="6765992">{</span>&nbsp;<span class="keyword" id="6765994">return</span>&nbsp;<span class="ident" id="6766001">NewWriter</span><span class="op" id="6766010">(</span><span class="ident" id="6766011">w</span><span class="op" id="6766012">,</span>&nbsp;<span class="ident" id="6766014">DefaultCompression</span><span class="op" id="6766032">)</span>&nbsp;<span class="op" id="6766034">}</span><span class="op" id="6766035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766038">testResetOutput</span><span class="op" id="6766053">(</span><span class="ident" id="6766054">t</span><span class="op" id="6766055">,</span>&nbsp;<span class="keyword" id="6766057">func</span><span class="op" id="6766061">(</span><span class="ident" id="6766062">w</span>&nbsp;<span class="ident" id="6766064">io</span><span class="op" id="6766066">.</span><span class="ident" id="6766067">Writer</span><span class="op" id="6766073">)</span>&nbsp;<span class="op" id="6766075">(</span><span class="op" id="6766076">*</span><span class="ident" id="6766077">Writer</span><span class="op" id="6766083">,</span>&nbsp;<span class="builtintype" id="6766085">error</span><span class="op" id="6766090">)</span>&nbsp;<span class="op" id="6766092">{</span>&nbsp;<span class="keyword" id="6766094">return</span>&nbsp;<span class="ident" id="6766101">NewWriter</span><span class="op" id="6766110">(</span><span class="ident" id="6766111">w</span><span class="op" id="6766112">,</span>&nbsp;<span class="ident" id="6766114">BestCompression</span><span class="op" id="6766129">)</span>&nbsp;<span class="op" id="6766131">}</span><span class="op" id="6766132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766135">dict</span>&nbsp;<span class="op" id="6766140">:=</span>&nbsp;<span class="op" id="6766143">[</span><span class="op" id="6766144">]</span><span class="builtintype" id="6766145">byte</span><span class="op" id="6766149">(</span><span class="string" id="6766150">&#34;we&nbsp;are&nbsp;the&nbsp;world&#34;</span><span class="op" id="6766168">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766171">testResetOutput</span><span class="op" id="6766186">(</span><span class="ident" id="6766187">t</span><span class="op" id="6766188">,</span>&nbsp;<span class="keyword" id="6766190">func</span><span class="op" id="6766194">(</span><span class="ident" id="6766195">w</span>&nbsp;<span class="ident" id="6766197">io</span><span class="op" id="6766199">.</span><span class="ident" id="6766200">Writer</span><span class="op" id="6766206">)</span>&nbsp;<span class="op" id="6766208">(</span><span class="op" id="6766209">*</span><span class="ident" id="6766210">Writer</span><span class="op" id="6766216">,</span>&nbsp;<span class="builtintype" id="6766218">error</span><span class="op" id="6766223">)</span>&nbsp;<span class="op" id="6766225">{</span>&nbsp;<span class="keyword" id="6766227">return</span>&nbsp;<span class="ident" id="6766234">NewWriterDict</span><span class="op" id="6766247">(</span><span class="ident" id="6766248">w</span><span class="op" id="6766249">,</span>&nbsp;<span class="ident" id="6766251">NoCompression</span><span class="op" id="6766264">,</span>&nbsp;<span class="ident" id="6766266">dict</span><span class="op" id="6766270">)</span>&nbsp;<span class="op" id="6766272">}</span><span class="op" id="6766273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766276">testResetOutput</span><span class="op" id="6766291">(</span><span class="ident" id="6766292">t</span><span class="op" id="6766293">,</span>&nbsp;<span class="keyword" id="6766295">func</span><span class="op" id="6766299">(</span><span class="ident" id="6766300">w</span>&nbsp;<span class="ident" id="6766302">io</span><span class="op" id="6766304">.</span><span class="ident" id="6766305">Writer</span><span class="op" id="6766311">)</span>&nbsp;<span class="op" id="6766313">(</span><span class="op" id="6766314">*</span><span class="ident" id="6766315">Writer</span><span class="op" id="6766321">,</span>&nbsp;<span class="builtintype" id="6766323">error</span><span class="op" id="6766328">)</span>&nbsp;<span class="op" id="6766330">{</span>&nbsp;<span class="keyword" id="6766332">return</span>&nbsp;<span class="ident" id="6766339">NewWriterDict</span><span class="op" id="6766352">(</span><span class="ident" id="6766353">w</span><span class="op" id="6766354">,</span>&nbsp;<span class="ident" id="6766356">DefaultCompression</span><span class="op" id="6766374">,</span>&nbsp;<span class="ident" id="6766376">dict</span><span class="op" id="6766380">)</span>&nbsp;<span class="op" id="6766382">}</span><span class="op" id="6766383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766386">testResetOutput</span><span class="op" id="6766401">(</span><span class="ident" id="6766402">t</span><span class="op" id="6766403">,</span>&nbsp;<span class="keyword" id="6766405">func</span><span class="op" id="6766409">(</span><span class="ident" id="6766410">w</span>&nbsp;<span class="ident" id="6766412">io</span><span class="op" id="6766414">.</span><span class="ident" id="6766415">Writer</span><span class="op" id="6766421">)</span>&nbsp;<span class="op" id="6766423">(</span><span class="op" id="6766424">*</span><span class="ident" id="6766425">Writer</span><span class="op" id="6766431">,</span>&nbsp;<span class="builtintype" id="6766433">error</span><span class="op" id="6766438">)</span>&nbsp;<span class="op" id="6766440">{</span>&nbsp;<span class="keyword" id="6766442">return</span>&nbsp;<span class="ident" id="6766449">NewWriterDict</span><span class="op" id="6766462">(</span><span class="ident" id="6766463">w</span><span class="op" id="6766464">,</span>&nbsp;<span class="ident" id="6766466">BestCompression</span><span class="op" id="6766481">,</span>&nbsp;<span class="ident" id="6766483">dict</span><span class="op" id="6766487">)</span>&nbsp;<span class="op" id="6766489">}</span><span class="op" id="6766490">)</span><br>
<span class="lineno"></span><span class="op" id="6766492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="6766495">func</span>&nbsp;<span class="ident" id="6766500">testResetOutput</span><span class="op" id="6766515">(</span><span class="ident" id="6766516">t</span>&nbsp;<span class="op" id="6766518">*</span><span class="ident" id="6766519">testing</span><span class="op" id="6766526">.</span><span class="ident" id="6766527">T</span><span class="op" id="6766528">,</span>&nbsp;<span class="ident" id="6766530">newWriter</span>&nbsp;<span class="keyword" id="6766540">func</span><span class="op" id="6766544">(</span><span class="ident" id="6766545">w</span>&nbsp;<span class="ident" id="6766547">io</span><span class="op" id="6766549">.</span><span class="ident" id="6766550">Writer</span><span class="op" id="6766556">)</span>&nbsp;<span class="op" id="6766558">(</span><span class="op" id="6766559">*</span><span class="ident" id="6766560">Writer</span><span class="op" id="6766566">,</span>&nbsp;<span class="builtintype" id="6766568">error</span><span class="op" id="6766573">)</span><span class="op" id="6766574">)</span>&nbsp;<span class="op" id="6766576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766579">buf</span>&nbsp;<span class="op" id="6766583">:=</span>&nbsp;<span class="builtinfunc" id="6766586">new</span><span class="op" id="6766589">(</span><span class="ident" id="6766590">bytes</span><span class="op" id="6766595">.</span><span class="ident" id="6766596">Buffer</span><span class="op" id="6766602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766605">w</span><span class="op" id="6766606">,</span>&nbsp;<span class="ident" id="6766608">err</span>&nbsp;<span class="op" id="6766612">:=</span>&nbsp;<span class="ident" id="6766615">newWriter</span><span class="op" id="6766624">(</span><span class="ident" id="6766625">buf</span><span class="op" id="6766628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6766631">if</span>&nbsp;<span class="ident" id="6766634">err</span>&nbsp;<span class="op" id="6766638">!=</span>&nbsp;<span class="ident" id="6766641">nil</span>&nbsp;<span class="op" id="6766645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766649">t</span><span class="op" id="6766650">.</span><span class="ident" id="6766651">Fatalf</span><span class="op" id="6766657">(</span><span class="string" id="6766658">&#34;NewWriter:&nbsp;%v&#34;</span><span class="op" id="6766673">,</span>&nbsp;<span class="ident" id="6766675">err</span><span class="op" id="6766678">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6766681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766684">b</span>&nbsp;<span class="op" id="6766686">:=</span>&nbsp;<span class="op" id="6766689">[</span><span class="op" id="6766690">]</span><span class="builtintype" id="6766691">byte</span><span class="op" id="6766695">(</span><span class="string" id="6766696">&#34;hello&nbsp;world&#34;</span><span class="op" id="6766709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6766712">for</span>&nbsp;<span class="ident" id="6766716">i</span>&nbsp;<span class="op" id="6766718">:=</span>&nbsp;<span class="num" id="6766721">0</span><span class="op" id="6766722">;</span>&nbsp;<span class="ident" id="6766724">i</span>&nbsp;<span class="op" id="6766726">&lt;</span>&nbsp;<span class="num" id="6766728">1024</span><span class="op" id="6766732">;</span>&nbsp;<span class="ident" id="6766734">i</span><span class="op" id="6766735">++</span>&nbsp;<span class="op" id="6766738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766742">w</span><span class="op" id="6766743">.</span><span class="ident" id="6766744">Write</span><span class="op" id="6766749">(</span><span class="ident" id="6766750">b</span><span class="op" id="6766751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6766754">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766757">w</span><span class="op" id="6766758">.</span><span class="ident" id="6766759">Close</span><span class="op" id="6766764">(</span><span class="op" id="6766765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766768">out1</span>&nbsp;<span class="op" id="6766773">:=</span>&nbsp;<span class="ident" id="6766776">buf</span><span class="op" id="6766779">.</span><span class="ident" id="6766780">String</span><span class="op" id="6766786">(</span><span class="op" id="6766787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766791">buf2</span>&nbsp;<span class="op" id="6766796">:=</span>&nbsp;<span class="builtinfunc" id="6766799">new</span><span class="op" id="6766802">(</span><span class="ident" id="6766803">bytes</span><span class="op" id="6766808">.</span><span class="ident" id="6766809">Buffer</span><span class="op" id="6766815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766818">w</span><span class="op" id="6766819">.</span><span class="ident" id="6766820">Reset</span><span class="op" id="6766825">(</span><span class="ident" id="6766826">buf2</span><span class="op" id="6766830">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6766833">for</span>&nbsp;<span class="ident" id="6766837">i</span>&nbsp;<span class="op" id="6766839">:=</span>&nbsp;<span class="num" id="6766842">0</span><span class="op" id="6766843">;</span>&nbsp;<span class="ident" id="6766845">i</span>&nbsp;<span class="op" id="6766847">&lt;</span>&nbsp;<span class="num" id="6766849">1024</span><span class="op" id="6766853">;</span>&nbsp;<span class="ident" id="6766855">i</span><span class="op" id="6766856">++</span>&nbsp;<span class="op" id="6766859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766863">w</span><span class="op" id="6766864">.</span><span class="ident" id="6766865">Write</span><span class="op" id="6766870">(</span><span class="ident" id="6766871">b</span><span class="op" id="6766872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6766875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766878">w</span><span class="op" id="6766879">.</span><span class="ident" id="6766880">Close</span><span class="op" id="6766885">(</span><span class="op" id="6766886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766889">out2</span>&nbsp;<span class="op" id="6766894">:=</span>&nbsp;<span class="ident" id="6766897">buf2</span><span class="op" id="6766901">.</span><span class="ident" id="6766902">String</span><span class="op" id="6766908">(</span><span class="op" id="6766909">)</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6766913">if</span>&nbsp;<span class="ident" id="6766916">out1</span>&nbsp;<span class="op" id="6766921">!=</span>&nbsp;<span class="ident" id="6766924">out2</span>&nbsp;<span class="op" id="6766929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766933">t</span><span class="op" id="6766934">.</span><span class="ident" id="6766935">Errorf</span><span class="op" id="6766941">(</span><span class="string" id="6766942">&#34;got&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6766963">,</span>&nbsp;<span class="ident" id="6766965">out2</span><span class="op" id="6766969">,</span>&nbsp;<span class="ident" id="6766971">out1</span><span class="op" id="6766975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6766978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6766981">t</span><span class="op" id="6766982">.</span><span class="ident" id="6766983">Logf</span><span class="op" id="6766987">(</span><span class="string" id="6766988">&#34;got&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="6767002">,</span>&nbsp;<span class="builtinfunc" id="6767004">len</span><span class="op" id="6767007">(</span><span class="ident" id="6767008">out1</span><span class="op" id="6767012">)</span><span class="op" id="6767013">)</span><br>
<span class="lineno">490</span><span class="op" id="6767015">}</span>
</div>
</body>
</html>
