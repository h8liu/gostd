<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8488709">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8488765">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8488819">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8488870">package</span>&nbsp;<span class="ident" id="8488878">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488889">import</span>&nbsp;<span class="op" id="8488896">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488899">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488908">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8488917">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8488927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8488930">func</span>&nbsp;<span class="ident" id="8488935">TestPrintfLine</span><span class="op" id="8488949">(</span><span class="ident" id="8488950">t</span>&nbsp;<span class="op" id="8488952">*</span><span class="ident" id="8488953">testing</span><span class="op" id="8488960">.</span><span class="ident" id="8488961">T</span><span class="op" id="8488962">)</span>&nbsp;<span class="op" id="8488964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8488967">var</span>&nbsp;<span class="ident" id="8488971">buf</span>&nbsp;<span class="ident" id="8488975">bytes</span><span class="op" id="8488980">.</span><span class="ident" id="8488981">Buffer</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8488989">w</span>&nbsp;<span class="op" id="8488991">:=</span>&nbsp;<span class="ident" id="8488994">NewWriter</span><span class="op" id="8489003">(</span><span class="ident" id="8489004">bufio</span><span class="op" id="8489009">.</span><span class="ident" id="8489010">NewWriter</span><span class="op" id="8489019">(</span><span class="op" id="8489020">&amp;</span><span class="ident" id="8489021">buf</span><span class="op" id="8489024">)</span><span class="op" id="8489025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489028">err</span>&nbsp;<span class="op" id="8489032">:=</span>&nbsp;<span class="ident" id="8489035">w</span><span class="op" id="8489036">.</span><span class="ident" id="8489037">PrintfLine</span><span class="op" id="8489047">(</span><span class="string" id="8489048">&#34;foo&nbsp;%d&#34;</span><span class="op" id="8489056">,</span>&nbsp;<span class="num" id="8489058">123</span><span class="op" id="8489061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8489064">if</span>&nbsp;<span class="ident" id="8489067">s</span>&nbsp;<span class="op" id="8489069">:=</span>&nbsp;<span class="ident" id="8489072">buf</span><span class="op" id="8489075">.</span><span class="ident" id="8489076">String</span><span class="op" id="8489082">(</span><span class="op" id="8489083">)</span><span class="op" id="8489084">;</span>&nbsp;<span class="ident" id="8489086">s</span>&nbsp;<span class="op" id="8489088">!=</span>&nbsp;<span class="string" id="8489091">&#34;foo&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="8489105">||</span>&nbsp;<span class="ident" id="8489108">err</span>&nbsp;<span class="op" id="8489112">!=</span>&nbsp;<span class="ident" id="8489115">nil</span>&nbsp;<span class="op" id="8489119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489123">t</span><span class="op" id="8489124">.</span><span class="ident" id="8489125">Fatalf</span><span class="op" id="8489131">(</span><span class="string" id="8489132">&#34;s=%q;&nbsp;err=%s&#34;</span><span class="op" id="8489146">,</span>&nbsp;<span class="ident" id="8489148">s</span><span class="op" id="8489149">,</span>&nbsp;<span class="ident" id="8489151">err</span><span class="op" id="8489154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489157">}</span><br>
<span class="lineno">20</span><span class="op" id="8489159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8489162">func</span>&nbsp;<span class="ident" id="8489167">TestDotWriter</span><span class="op" id="8489180">(</span><span class="ident" id="8489181">t</span>&nbsp;<span class="op" id="8489183">*</span><span class="ident" id="8489184">testing</span><span class="op" id="8489191">.</span><span class="ident" id="8489192">T</span><span class="op" id="8489193">)</span>&nbsp;<span class="op" id="8489195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8489198">var</span>&nbsp;<span class="ident" id="8489202">buf</span>&nbsp;<span class="ident" id="8489206">bytes</span><span class="op" id="8489211">.</span><span class="ident" id="8489212">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489220">w</span>&nbsp;<span class="op" id="8489222">:=</span>&nbsp;<span class="ident" id="8489225">NewWriter</span><span class="op" id="8489234">(</span><span class="ident" id="8489235">bufio</span><span class="op" id="8489240">.</span><span class="ident" id="8489241">NewWriter</span><span class="op" id="8489250">(</span><span class="op" id="8489251">&amp;</span><span class="ident" id="8489252">buf</span><span class="op" id="8489255">)</span><span class="op" id="8489256">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489259">d</span>&nbsp;<span class="op" id="8489261">:=</span>&nbsp;<span class="ident" id="8489264">w</span><span class="op" id="8489265">.</span><span class="ident" id="8489266">DotWriter</span><span class="op" id="8489275">(</span><span class="op" id="8489276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489279">n</span><span class="op" id="8489280">,</span>&nbsp;<span class="ident" id="8489282">err</span>&nbsp;<span class="op" id="8489286">:=</span>&nbsp;<span class="ident" id="8489289">d</span><span class="op" id="8489290">.</span><span class="ident" id="8489291">Write</span><span class="op" id="8489296">(</span><span class="op" id="8489297">[</span><span class="op" id="8489298">]</span><span class="builtintype" id="8489299">byte</span><span class="op" id="8489303">(</span><span class="string" id="8489304">&#34;abc\n.def\n..ghi\n.jkl\n.&#34;</span><span class="op" id="8489331">)</span><span class="op" id="8489332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8489335">if</span>&nbsp;<span class="ident" id="8489338">n</span>&nbsp;<span class="op" id="8489340">!=</span>&nbsp;<span class="num" id="8489343">21</span>&nbsp;<span class="op" id="8489346">||</span>&nbsp;<span class="ident" id="8489349">err</span>&nbsp;<span class="op" id="8489353">!=</span>&nbsp;<span class="ident" id="8489356">nil</span>&nbsp;<span class="op" id="8489360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489364">t</span><span class="op" id="8489365">.</span><span class="ident" id="8489366">Fatalf</span><span class="op" id="8489372">(</span><span class="string" id="8489373">&#34;Write:&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="8489388">,</span>&nbsp;<span class="ident" id="8489390">n</span><span class="op" id="8489391">,</span>&nbsp;<span class="ident" id="8489393">err</span><span class="op" id="8489396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489399">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489402">d</span><span class="op" id="8489403">.</span><span class="ident" id="8489404">Close</span><span class="op" id="8489409">(</span><span class="op" id="8489410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489413">want</span>&nbsp;<span class="op" id="8489418">:=</span>&nbsp;<span class="string" id="8489421">&#34;abc\r\n..def\r\n...ghi\r\n..jkl\r\n..\r\n.\r\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8489471">if</span>&nbsp;<span class="ident" id="8489474">s</span>&nbsp;<span class="op" id="8489476">:=</span>&nbsp;<span class="ident" id="8489479">buf</span><span class="op" id="8489482">.</span><span class="ident" id="8489483">String</span><span class="op" id="8489489">(</span><span class="op" id="8489490">)</span><span class="op" id="8489491">;</span>&nbsp;<span class="ident" id="8489493">s</span>&nbsp;<span class="op" id="8489495">!=</span>&nbsp;<span class="ident" id="8489498">want</span>&nbsp;<span class="op" id="8489503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8489507">t</span><span class="op" id="8489508">.</span><span class="ident" id="8489509">Fatalf</span><span class="op" id="8489515">(</span><span class="string" id="8489516">&#34;wrote&nbsp;%q&#34;</span><span class="op" id="8489526">,</span>&nbsp;<span class="ident" id="8489528">s</span><span class="op" id="8489529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8489532">}</span><br>
<span class="lineno">35</span><span class="op" id="8489534">}</span>
</div>
</body>
</html>
