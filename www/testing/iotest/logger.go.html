<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2784416">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2784471">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2784525">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2784576">package</span>&nbsp;<span class="ident" id="2784584">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784592">import</span>&nbsp;<span class="op" id="2784599">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2784602">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2784608">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2784614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784617">type</span>&nbsp;<span class="ident" id="2784622">writeLogger</span>&nbsp;<span class="keyword" id="2784634">struct</span>&nbsp;<span class="op" id="2784641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784644">prefix</span>&nbsp;<span class="builtintype" id="2784651">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784659">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2784666"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2784668">.</span><span class="ident" id="2784669">Writer</span><br>
<span class="lineno">15</span><span class="op" id="2784676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2784679">func</span>&nbsp;<span class="op" id="2784684">(</span><span class="ident" id="2784685">l</span>&nbsp;<span class="op" id="2784687">*</span><span class="ident" id="2784688"><a href="/testing/iotest/logger.go.html#2784622">writeLogger</a></span><span class="op" id="2784699">)</span>&nbsp;<span class="ident" id="2784701">Write</span><span class="op" id="2784706">(</span><span class="ident" id="2784707">p</span>&nbsp;<span class="op" id="2784709">[</span><span class="op" id="2784710">]</span><span class="builtintype" id="2784711">byte</span><span class="op" id="2784715">)</span>&nbsp;<span class="op" id="2784717">(</span><span class="ident" id="2784718">n</span>&nbsp;<span class="builtintype" id="2784720">int</span><span class="op" id="2784723">,</span>&nbsp;<span class="ident" id="2784725">err</span>&nbsp;<span class="builtintype" id="2784729">error</span><span class="op" id="2784734">)</span>&nbsp;<span class="op" id="2784736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784739"><a href="/testing/iotest/logger.go.html#2784718">n</a></span><span class="op" id="2784740">,</span>&nbsp;<span class="ident" id="2784742"><a href="/testing/iotest/logger.go.html#2784725">err</a></span>&nbsp;<span class="op" id="2784746">=</span>&nbsp;<span class="ident" id="2784748"><a href="/testing/iotest/logger.go.html#2784685">l</a></span><span class="op" id="2784749">.</span><span class="ident" id="2784750">w</span><span class="op" id="2784751">.</span><span class="ident" id="2784752">Write</span><span class="op" id="2784757">(</span><span class="ident" id="2784758"><a href="/testing/iotest/logger.go.html#2784707">p</a></span><span class="op" id="2784759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784762">if</span>&nbsp;<span class="ident" id="2784765"><a href="/testing/iotest/logger.go.html#2784725">err</a></span>&nbsp;<span class="op" id="2784769">!=</span>&nbsp;<span class="ident" id="2784772">nil</span>&nbsp;<span class="op" id="2784776">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784780"><a href="/testing/iotest/logger.go.html#2784608">log</a></span><span class="op" id="2784783">.</span><span class="ident" id="2784784">Printf</span><span class="op" id="2784790">(</span><span class="string" id="2784791">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="2784802">,</span>&nbsp;<span class="ident" id="2784804"><a href="/testing/iotest/logger.go.html#2784685">l</a></span><span class="op" id="2784805">.</span><span class="ident" id="2784806">prefix</span><span class="op" id="2784812">,</span>&nbsp;<span class="ident" id="2784814"><a href="/testing/iotest/logger.go.html#2784707">p</a></span><span class="op" id="2784815">[</span><span class="num" id="2784816">0</span><span class="op" id="2784817">:</span><span class="ident" id="2784818"><a href="/testing/iotest/logger.go.html#2784718">n</a></span><span class="op" id="2784819">]</span><span class="op" id="2784820">,</span>&nbsp;<span class="ident" id="2784822"><a href="/testing/iotest/logger.go.html#2784725">err</a></span><span class="op" id="2784825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784828">}</span>&nbsp;<span class="keyword" id="2784830">else</span>&nbsp;<span class="op" id="2784835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2784839"><a href="/testing/iotest/logger.go.html#2784608">log</a></span><span class="op" id="2784842">.</span><span class="ident" id="2784843">Printf</span><span class="op" id="2784849">(</span><span class="string" id="2784850">&#34;%s&nbsp;%x&#34;</span><span class="op" id="2784857">,</span>&nbsp;<span class="ident" id="2784859"><a href="/testing/iotest/logger.go.html#2784685">l</a></span><span class="op" id="2784860">.</span><span class="ident" id="2784861">prefix</span><span class="op" id="2784867">,</span>&nbsp;<span class="ident" id="2784869"><a href="/testing/iotest/logger.go.html#2784707">p</a></span><span class="op" id="2784870">[</span><span class="num" id="2784871">0</span><span class="op" id="2784872">:</span><span class="ident" id="2784873"><a href="/testing/iotest/logger.go.html#2784718">n</a></span><span class="op" id="2784874">]</span><span class="op" id="2784875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2784878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2784881">return</span><br>
<span class="lineno">25</span><span class="op" id="2784888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2784891">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="2784953">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="2785018">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="2785075">func</span>&nbsp;<span class="ident" id="2785080">NewWriteLogger</span><span class="op" id="2785094">(</span><span class="ident" id="2785095">prefix</span>&nbsp;<span class="builtintype" id="2785102">string</span><span class="op" id="2785108">,</span>&nbsp;<span class="ident" id="2785110">w</span>&nbsp;<span class="ident" id="2785112"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2785114">.</span><span class="ident" id="2785115">Writer</span><span class="op" id="2785121">)</span>&nbsp;<span class="ident" id="2785123"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2785125">.</span><span class="ident" id="2785126">Writer</span>&nbsp;<span class="op" id="2785133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785136">return</span>&nbsp;<span class="op" id="2785143">&amp;</span><span class="ident" id="2785144"><a href="/testing/iotest/logger.go.html#2784622">writeLogger</a></span><span class="op" id="2785155">{</span><span class="ident" id="2785156"><a href="/testing/iotest/logger.go.html#2785095">prefix</a></span><span class="op" id="2785162">,</span>&nbsp;<span class="ident" id="2785164"><a href="/testing/iotest/logger.go.html#2785110">w</a></span><span class="op" id="2785165">}</span><br>
<span class="lineno"></span><span class="op" id="2785167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785170">type</span>&nbsp;<span class="ident" id="2785175">readLogger</span>&nbsp;<span class="keyword" id="2785186">struct</span>&nbsp;<span class="op" id="2785193">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785196">prefix</span>&nbsp;<span class="builtintype" id="2785203">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785211">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785218"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2785220">.</span><span class="ident" id="2785221">Reader</span><br>
<span class="lineno"></span><span class="op" id="2785228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785231">func</span>&nbsp;<span class="op" id="2785236">(</span><span class="ident" id="2785237">l</span>&nbsp;<span class="op" id="2785239">*</span><span class="ident" id="2785240"><a href="/testing/iotest/logger.go.html#2785175">readLogger</a></span><span class="op" id="2785250">)</span>&nbsp;<span class="ident" id="2785252">Read</span><span class="op" id="2785256">(</span><span class="ident" id="2785257">p</span>&nbsp;<span class="op" id="2785259">[</span><span class="op" id="2785260">]</span><span class="builtintype" id="2785261">byte</span><span class="op" id="2785265">)</span>&nbsp;<span class="op" id="2785267">(</span><span class="ident" id="2785268">n</span>&nbsp;<span class="builtintype" id="2785270">int</span><span class="op" id="2785273">,</span>&nbsp;<span class="ident" id="2785275">err</span>&nbsp;<span class="builtintype" id="2785279">error</span><span class="op" id="2785284">)</span>&nbsp;<span class="op" id="2785286">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785289"><a href="/testing/iotest/logger.go.html#2785268">n</a></span><span class="op" id="2785290">,</span>&nbsp;<span class="ident" id="2785292"><a href="/testing/iotest/logger.go.html#2785275">err</a></span>&nbsp;<span class="op" id="2785296">=</span>&nbsp;<span class="ident" id="2785298"><a href="/testing/iotest/logger.go.html#2785237">l</a></span><span class="op" id="2785299">.</span><span class="ident" id="2785300">r</span><span class="op" id="2785301">.</span><span class="ident" id="2785302">Read</span><span class="op" id="2785306">(</span><span class="ident" id="2785307"><a href="/testing/iotest/logger.go.html#2785257">p</a></span><span class="op" id="2785308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785311">if</span>&nbsp;<span class="ident" id="2785314"><a href="/testing/iotest/logger.go.html#2785275">err</a></span>&nbsp;<span class="op" id="2785318">!=</span>&nbsp;<span class="ident" id="2785321">nil</span>&nbsp;<span class="op" id="2785325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785329"><a href="/testing/iotest/logger.go.html#2784608">log</a></span><span class="op" id="2785332">.</span><span class="ident" id="2785333">Printf</span><span class="op" id="2785339">(</span><span class="string" id="2785340">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="2785351">,</span>&nbsp;<span class="ident" id="2785353"><a href="/testing/iotest/logger.go.html#2785237">l</a></span><span class="op" id="2785354">.</span><span class="ident" id="2785355">prefix</span><span class="op" id="2785361">,</span>&nbsp;<span class="ident" id="2785363"><a href="/testing/iotest/logger.go.html#2785257">p</a></span><span class="op" id="2785364">[</span><span class="num" id="2785365">0</span><span class="op" id="2785366">:</span><span class="ident" id="2785367"><a href="/testing/iotest/logger.go.html#2785268">n</a></span><span class="op" id="2785368">]</span><span class="op" id="2785369">,</span>&nbsp;<span class="ident" id="2785371"><a href="/testing/iotest/logger.go.html#2785275">err</a></span><span class="op" id="2785374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785377">}</span>&nbsp;<span class="keyword" id="2785379">else</span>&nbsp;<span class="op" id="2785384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2785388"><a href="/testing/iotest/logger.go.html#2784608">log</a></span><span class="op" id="2785391">.</span><span class="ident" id="2785392">Printf</span><span class="op" id="2785398">(</span><span class="string" id="2785399">&#34;%s&nbsp;%x&#34;</span><span class="op" id="2785406">,</span>&nbsp;<span class="ident" id="2785408"><a href="/testing/iotest/logger.go.html#2785237">l</a></span><span class="op" id="2785409">.</span><span class="ident" id="2785410">prefix</span><span class="op" id="2785416">,</span>&nbsp;<span class="ident" id="2785418"><a href="/testing/iotest/logger.go.html#2785257">p</a></span><span class="op" id="2785419">[</span><span class="num" id="2785420">0</span><span class="op" id="2785421">:</span><span class="ident" id="2785422"><a href="/testing/iotest/logger.go.html#2785268">n</a></span><span class="op" id="2785423">]</span><span class="op" id="2785424">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2785427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785430">return</span><br>
<span class="lineno"></span><span class="op" id="2785437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2785440">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="2785501">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="2785564">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="2785621">func</span>&nbsp;<span class="ident" id="2785626">NewReadLogger</span><span class="op" id="2785639">(</span><span class="ident" id="2785640">prefix</span>&nbsp;<span class="builtintype" id="2785647">string</span><span class="op" id="2785653">,</span>&nbsp;<span class="ident" id="2785655">r</span>&nbsp;<span class="ident" id="2785657"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2785659">.</span><span class="ident" id="2785660">Reader</span><span class="op" id="2785666">)</span>&nbsp;<span class="ident" id="2785668"><a href="/testing/iotest/logger.go.html#2784602">io</a></span><span class="op" id="2785670">.</span><span class="ident" id="2785671">Reader</span>&nbsp;<span class="op" id="2785678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2785681">return</span>&nbsp;<span class="op" id="2785688">&amp;</span><span class="ident" id="2785689"><a href="/testing/iotest/logger.go.html#2785175">readLogger</a></span><span class="op" id="2785699">{</span><span class="ident" id="2785700"><a href="/testing/iotest/logger.go.html#2785640">prefix</a></span><span class="op" id="2785706">,</span>&nbsp;<span class="ident" id="2785708"><a href="/testing/iotest/logger.go.html#2785655">r</a></span><span class="op" id="2785709">}</span><br>
<span class="lineno"></span><span class="op" id="2785711">}</span>
</div>
</body>
</html>
