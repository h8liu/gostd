<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/token</h2>
<ul>
<li><a href="/gostd/go/token/position.go.html" class="current">position.go</a></li>
<li><a href="/gostd/go/token/position_test.go.html">position_test.go</a></li>
<li><a href="/gostd/go/token/serialize.go.html">serialize.go</a></li>
<li><a href="/gostd/go/token/serialize_test.go.html">serialize_test.go</a></li>
<li><a href="/gostd/go/token/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3873500">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3873555">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3873609">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3873660">package</span>&nbsp;<span class="ident" id="3873668">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3873675">import</span>&nbsp;<span class="op" id="3873682">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3873685">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3873692">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3873700">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3873707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3873710">//&nbsp;-----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3873791">//&nbsp;Positions</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3873805">//&nbsp;Position&nbsp;describes&nbsp;an&nbsp;arbitrary&nbsp;source&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="3873856">//&nbsp;including&nbsp;the&nbsp;file,&nbsp;line,&nbsp;and&nbsp;column&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="3873906">//&nbsp;A&nbsp;Position&nbsp;is&nbsp;valid&nbsp;if&nbsp;the&nbsp;line&nbsp;number&nbsp;is&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="3873956">//</span><br>
<span class="lineno">20</span><span class="keyword" id="3873959">type</span>&nbsp;<span class="ident" id="3873964">Position</span>&nbsp;<span class="keyword" id="3873973">struct</span>&nbsp;<span class="op" id="3873980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3873983">Filename</span>&nbsp;<span class="builtintype" id="3873992">string</span>&nbsp;<span class="comment" id="3873999">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874020">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3874029">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874036">//&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874062">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3874071">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874078">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874109">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3874118">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874125">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count)</span><br>
<span class="lineno">25</span><span class="op" id="3874175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3874178">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="3874228">func</span>&nbsp;<span class="op" id="3874233">(</span><span class="ident" id="3874234">pos</span>&nbsp;<span class="op" id="3874238">*</span><span class="ident" id="3874239"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3874247">)</span>&nbsp;<span class="ident" id="3874249">IsValid</span><span class="op" id="3874256">(</span><span class="op" id="3874257">)</span>&nbsp;<span class="builtintype" id="3874259">bool</span>&nbsp;<span class="op" id="3874264">{</span>&nbsp;<span class="keyword" id="3874266">return</span>&nbsp;<span class="ident" id="3874273"><a href="/gostd/go/token/position.go.html#3874234">pos</a></span><span class="op" id="3874276">.</span><span class="ident" id="3874277"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span>&nbsp;<span class="op" id="3874282">&gt;</span>&nbsp;<span class="num" id="3874284">0</span>&nbsp;<span class="op" id="3874286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3874289">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;in&nbsp;one&nbsp;of&nbsp;several&nbsp;forms:</span><br>
<span class="lineno"></span><span class="comment" id="3874341">//</span><br>
<span class="lineno"></span><span class="comment" id="3874344">//&nbsp;&nbsp;&nbsp;&nbsp;file:line:column&nbsp;&nbsp;&nbsp;&nbsp;valid&nbsp;position&nbsp;with&nbsp;file&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3874397">//&nbsp;&nbsp;&nbsp;&nbsp;line:column&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid&nbsp;position&nbsp;without&nbsp;file&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3874453">//&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid&nbsp;position&nbsp;with&nbsp;file&nbsp;name</span><br>
<span class="lineno">35</span><span class="comment" id="3874508">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invalid&nbsp;position&nbsp;without&nbsp;file&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3874566">//</span><br>
<span class="lineno"></span><span class="keyword" id="3874569">func</span>&nbsp;<span class="op" id="3874574">(</span><span class="ident" id="3874575">pos</span>&nbsp;<span class="ident" id="3874579"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3874587">)</span>&nbsp;<span class="ident" id="3874589">String</span><span class="op" id="3874595">(</span><span class="op" id="3874596">)</span>&nbsp;<span class="builtintype" id="3874598">string</span>&nbsp;<span class="op" id="3874605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874608">s</span>&nbsp;<span class="op" id="3874610">:=</span>&nbsp;<span class="ident" id="3874613"><a href="/gostd/go/token/position.go.html#3874575">pos</a></span><span class="op" id="3874616">.</span><span class="ident" id="3874617"><a href="/gostd/go/token/position.go.html#3873983">Filename</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874627">if</span>&nbsp;<span class="ident" id="3874630"><a href="/gostd/go/token/position.go.html#3874575">pos</a></span><span class="op" id="3874633">.</span><span class="ident" id="3874634"><a href="/gostd/go/token/position.go.html#3874249">IsValid</a></span><span class="op" id="3874641">(</span><span class="op" id="3874642">)</span>&nbsp;<span class="op" id="3874644">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874648">if</span>&nbsp;<span class="ident" id="3874651"><a href="/gostd/go/token/position.go.html#3874608">s</a></span>&nbsp;<span class="op" id="3874653">!=</span>&nbsp;<span class="string" id="3874656">&#34;&#34;</span>&nbsp;<span class="op" id="3874659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874664"><a href="/gostd/go/token/position.go.html#3874608">s</a></span>&nbsp;<span class="op" id="3874666">+=</span>&nbsp;<span class="string" id="3874669">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874679"><a href="/gostd/go/token/position.go.html#3874608">s</a></span>&nbsp;<span class="op" id="3874681">+=</span>&nbsp;<span class="ident" id="3874684"><a href="/gostd/go/token/position.go.html#3873685">fmt</a></span><span class="op" id="3874687">.</span><span class="ident" id="3874688"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3874695">(</span><span class="string" id="3874696">&#34;%d:%d&#34;</span><span class="op" id="3874703">,</span>&nbsp;<span class="ident" id="3874705"><a href="/gostd/go/token/position.go.html#3874575">pos</a></span><span class="op" id="3874708">.</span><span class="ident" id="3874709"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3874713">,</span>&nbsp;<span class="ident" id="3874715"><a href="/gostd/go/token/position.go.html#3874575">pos</a></span><span class="op" id="3874718">.</span><span class="ident" id="3874719"><a href="/gostd/go/token/position.go.html#3874109">Column</a></span><span class="op" id="3874725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874728">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874731">if</span>&nbsp;<span class="ident" id="3874734"><a href="/gostd/go/token/position.go.html#3874608">s</a></span>&nbsp;<span class="op" id="3874736">==</span>&nbsp;<span class="string" id="3874739">&#34;&#34;</span>&nbsp;<span class="op" id="3874742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874746"><a href="/gostd/go/token/position.go.html#3874608">s</a></span>&nbsp;<span class="op" id="3874748">=</span>&nbsp;<span class="string" id="3874750">&#34;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874758">return</span>&nbsp;<span class="ident" id="3874765"><a href="/gostd/go/token/position.go.html#3874608">s</a></span><br>
<span class="lineno"></span><span class="op" id="3874767">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3874770">//&nbsp;Pos&nbsp;is&nbsp;a&nbsp;compact&nbsp;encoding&nbsp;of&nbsp;a&nbsp;source&nbsp;position&nbsp;within&nbsp;a&nbsp;file&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="3874839">//&nbsp;It&nbsp;can&nbsp;be&nbsp;converted&nbsp;into&nbsp;a&nbsp;Position&nbsp;for&nbsp;a&nbsp;more&nbsp;convenient,&nbsp;but&nbsp;much</span><br>
<span class="lineno"></span><span class="comment" id="3874910">//&nbsp;larger,&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3874937">//</span><br>
<span class="lineno">55</span><span class="comment" id="3874940">//&nbsp;The&nbsp;Pos&nbsp;value&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;the&nbsp;range&nbsp;[base,&nbsp;base+size],</span><br>
<span class="lineno"></span><span class="comment" id="3875018">//&nbsp;where&nbsp;base&nbsp;and&nbsp;size&nbsp;are&nbsp;specified&nbsp;when&nbsp;adding&nbsp;the&nbsp;file&nbsp;to&nbsp;the&nbsp;file&nbsp;set&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="3875096">//&nbsp;AddFile.</span><br>
<span class="lineno"></span><span class="comment" id="3875108">//</span><br>
<span class="lineno"></span><span class="comment" id="3875111">//&nbsp;To&nbsp;create&nbsp;the&nbsp;Pos&nbsp;value&nbsp;for&nbsp;a&nbsp;specific&nbsp;source&nbsp;offset,&nbsp;first&nbsp;add</span><br>
<span class="lineno">60</span><span class="comment" id="3875178">//&nbsp;the&nbsp;respective&nbsp;file&nbsp;to&nbsp;the&nbsp;current&nbsp;file&nbsp;set&nbsp;(via&nbsp;FileSet.AddFile)</span><br>
<span class="lineno"></span><span class="comment" id="3875247">//&nbsp;and&nbsp;then&nbsp;call&nbsp;File.Pos(offset)&nbsp;for&nbsp;that&nbsp;file.&nbsp;Given&nbsp;a&nbsp;Pos&nbsp;value&nbsp;p</span><br>
<span class="lineno"></span><span class="comment" id="3875316">//&nbsp;for&nbsp;a&nbsp;specific&nbsp;file&nbsp;set&nbsp;fset,&nbsp;the&nbsp;corresponding&nbsp;Position&nbsp;value&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3875385">//&nbsp;obtained&nbsp;by&nbsp;calling&nbsp;fset.Position(p).</span><br>
<span class="lineno"></span><span class="comment" id="3875426">//</span><br>
<span class="lineno">65</span><span class="comment" id="3875429">//&nbsp;Pos&nbsp;values&nbsp;can&nbsp;be&nbsp;compared&nbsp;directly&nbsp;with&nbsp;the&nbsp;usual&nbsp;comparison&nbsp;operators:</span><br>
<span class="lineno"></span><span class="comment" id="3875505">//&nbsp;If&nbsp;two&nbsp;Pos&nbsp;values&nbsp;p&nbsp;and&nbsp;q&nbsp;are&nbsp;in&nbsp;the&nbsp;same&nbsp;file,&nbsp;comparing&nbsp;p&nbsp;and&nbsp;q&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3875577">//&nbsp;equivalent&nbsp;to&nbsp;comparing&nbsp;the&nbsp;respective&nbsp;source&nbsp;file&nbsp;offsets.&nbsp;If&nbsp;p&nbsp;and&nbsp;q</span><br>
<span class="lineno"></span><span class="comment" id="3875651">//&nbsp;are&nbsp;in&nbsp;different&nbsp;files,&nbsp;p&nbsp;&lt;&nbsp;q&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;file&nbsp;implied&nbsp;by&nbsp;p&nbsp;was&nbsp;added</span><br>
<span class="lineno"></span><span class="comment" id="3875727">//&nbsp;to&nbsp;the&nbsp;respective&nbsp;file&nbsp;set&nbsp;before&nbsp;the&nbsp;file&nbsp;implied&nbsp;by&nbsp;q.</span><br>
<span class="lineno">70</span><span class="comment" id="3875787">//</span><br>
<span class="lineno"></span><span class="keyword" id="3875790">type</span>&nbsp;<span class="ident" id="3875795">Pos</span>&nbsp;<span class="builtintype" id="3875799">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3875804">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;Pos&nbsp;is&nbsp;NoPos;&nbsp;there&nbsp;is&nbsp;no&nbsp;file&nbsp;and&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="3875878">//&nbsp;associated&nbsp;with&nbsp;it,&nbsp;and&nbsp;NoPos().IsValid()&nbsp;is&nbsp;false.&nbsp;NoPos&nbsp;is&nbsp;always</span><br>
<span class="lineno">75</span><span class="comment" id="3875949">//&nbsp;smaller&nbsp;than&nbsp;any&nbsp;other&nbsp;Pos&nbsp;value.&nbsp;The&nbsp;corresponding&nbsp;Position&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3876019">//&nbsp;for&nbsp;NoPos&nbsp;is&nbsp;the&nbsp;zero&nbsp;value&nbsp;for&nbsp;Position.</span><br>
<span class="lineno"></span><span class="comment" id="3876064">//</span><br>
<span class="lineno"></span><span class="keyword" id="3876067">const</span>&nbsp;<span class="ident" id="3876073">NoPos</span>&nbsp;<span class="ident" id="3876079"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span>&nbsp;<span class="op" id="3876083">=</span>&nbsp;<span class="num" id="3876085">0</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3876088">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="3876138">func</span>&nbsp;<span class="op" id="3876143">(</span><span class="ident" id="3876144">p</span>&nbsp;<span class="ident" id="3876146"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3876149">)</span>&nbsp;<span class="ident" id="3876151">IsValid</span><span class="op" id="3876158">(</span><span class="op" id="3876159">)</span>&nbsp;<span class="builtintype" id="3876161">bool</span>&nbsp;<span class="op" id="3876166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876169">return</span>&nbsp;<span class="ident" id="3876176"><a href="/gostd/go/token/position.go.html#3876144">p</a></span>&nbsp;<span class="op" id="3876178">!=</span>&nbsp;<span class="ident" id="3876181"><a href="/gostd/go/token/position.go.html#3876073">NoPos</a></span><br>
<span class="lineno"></span><span class="op" id="3876187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3876190">//&nbsp;-----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3876271">//&nbsp;File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876280">//&nbsp;A&nbsp;File&nbsp;is&nbsp;a&nbsp;handle&nbsp;for&nbsp;a&nbsp;file&nbsp;belonging&nbsp;to&nbsp;a&nbsp;FileSet.</span><br>
<span class="lineno"></span><span class="comment" id="3876337">//&nbsp;A&nbsp;File&nbsp;has&nbsp;a&nbsp;name,&nbsp;size,&nbsp;and&nbsp;line&nbsp;offset&nbsp;table.</span><br>
<span class="lineno">90</span><span class="comment" id="3876388">//</span><br>
<span class="lineno"></span><span class="keyword" id="3876391">type</span>&nbsp;<span class="ident" id="3876396">File</span>&nbsp;<span class="keyword" id="3876401">struct</span>&nbsp;<span class="op" id="3876408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876411">set</span>&nbsp;&nbsp;<span class="op" id="3876416">*</span><span class="ident" id="3876417"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876426">name</span>&nbsp;<span class="builtintype" id="3876431">string</span>&nbsp;<span class="comment" id="3876438">//&nbsp;file&nbsp;name&nbsp;as&nbsp;provided&nbsp;to&nbsp;AddFile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876475">base</span>&nbsp;<span class="builtintype" id="3876480">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876487">//&nbsp;Pos&nbsp;value&nbsp;range&nbsp;for&nbsp;this&nbsp;file&nbsp;is&nbsp;[base...base+size]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876543">size</span>&nbsp;<span class="builtintype" id="3876548">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876555">//&nbsp;file&nbsp;size&nbsp;as&nbsp;provided&nbsp;to&nbsp;AddFile</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876593">//&nbsp;lines&nbsp;and&nbsp;infos&nbsp;are&nbsp;protected&nbsp;by&nbsp;set.mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876640">lines</span>&nbsp;<span class="op" id="3876646">[</span><span class="op" id="3876647">]</span><span class="builtintype" id="3876648">int</span>&nbsp;<span class="comment" id="3876652">//&nbsp;lines&nbsp;contains&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;first&nbsp;character&nbsp;for&nbsp;each&nbsp;line&nbsp;(the&nbsp;first&nbsp;entry&nbsp;is&nbsp;always&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876749">infos</span>&nbsp;<span class="op" id="3876755">[</span><span class="op" id="3876756">]</span><span class="ident" id="3876757"><a href="/gostd/go/token/position.go.html#3879912">lineInfo</a></span><br>
<span class="lineno">100</span><span class="op" id="3876766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876769">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;of&nbsp;file&nbsp;f&nbsp;as&nbsp;registered&nbsp;with&nbsp;AddFile.</span><br>
<span class="lineno"></span><span class="keyword" id="3876837">func</span>&nbsp;<span class="op" id="3876842">(</span><span class="ident" id="3876843">f</span>&nbsp;<span class="op" id="3876845">*</span><span class="ident" id="3876846"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3876850">)</span>&nbsp;<span class="ident" id="3876852">Name</span><span class="op" id="3876856">(</span><span class="op" id="3876857">)</span>&nbsp;<span class="builtintype" id="3876859">string</span>&nbsp;<span class="op" id="3876866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876869">return</span>&nbsp;<span class="ident" id="3876876"><a href="/gostd/go/token/position.go.html#3876843">f</a></span><span class="op" id="3876877">.</span><span class="ident" id="3876878"><a href="/gostd/go/token/position.go.html#3876426">name</a></span><br>
<span class="lineno">105</span><span class="op" id="3876883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876886">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;base&nbsp;offset&nbsp;of&nbsp;file&nbsp;f&nbsp;as&nbsp;registered&nbsp;with&nbsp;AddFile.</span><br>
<span class="lineno"></span><span class="keyword" id="3876956">func</span>&nbsp;<span class="op" id="3876961">(</span><span class="ident" id="3876962">f</span>&nbsp;<span class="op" id="3876964">*</span><span class="ident" id="3876965"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3876969">)</span>&nbsp;<span class="ident" id="3876971">Base</span><span class="op" id="3876975">(</span><span class="op" id="3876976">)</span>&nbsp;<span class="builtintype" id="3876978">int</span>&nbsp;<span class="op" id="3876982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876985">return</span>&nbsp;<span class="ident" id="3876992"><a href="/gostd/go/token/position.go.html#3876962">f</a></span><span class="op" id="3876993">.</span><span class="ident" id="3876994"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><br>
<span class="lineno">110</span><span class="op" id="3876999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3877002">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;file&nbsp;f&nbsp;as&nbsp;registered&nbsp;with&nbsp;AddFile.</span><br>
<span class="lineno"></span><span class="keyword" id="3877065">func</span>&nbsp;<span class="op" id="3877070">(</span><span class="ident" id="3877071">f</span>&nbsp;<span class="op" id="3877073">*</span><span class="ident" id="3877074"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3877078">)</span>&nbsp;<span class="ident" id="3877080">Size</span><span class="op" id="3877084">(</span><span class="op" id="3877085">)</span>&nbsp;<span class="builtintype" id="3877087">int</span>&nbsp;<span class="op" id="3877091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877094">return</span>&nbsp;<span class="ident" id="3877101"><a href="/gostd/go/token/position.go.html#3877071">f</a></span><span class="op" id="3877102">.</span><span class="ident" id="3877103"><a href="/gostd/go/token/position.go.html#3876543">size</a></span><br>
<span class="lineno">115</span><span class="op" id="3877108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3877111">//&nbsp;LineCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;lines&nbsp;in&nbsp;file&nbsp;f.</span><br>
<span class="lineno"></span><span class="keyword" id="3877163">func</span>&nbsp;<span class="op" id="3877168">(</span><span class="ident" id="3877169">f</span>&nbsp;<span class="op" id="3877171">*</span><span class="ident" id="3877172"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3877176">)</span>&nbsp;<span class="ident" id="3877178">LineCount</span><span class="op" id="3877187">(</span><span class="op" id="3877188">)</span>&nbsp;<span class="builtintype" id="3877190">int</span>&nbsp;<span class="op" id="3877194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877197"><a href="/gostd/go/token/position.go.html#3877169">f</a></span><span class="op" id="3877198">.</span><span class="ident" id="3877199"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3877202">.</span><span class="ident" id="3877203"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3877208">.</span><span class="ident" id="3877209"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="3877214">(</span><span class="op" id="3877215">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877218">n</span>&nbsp;<span class="op" id="3877220">:=</span>&nbsp;<span class="builtinfunc" id="3877223">len</span><span class="op" id="3877226">(</span><span class="ident" id="3877227"><a href="/gostd/go/token/position.go.html#3877169">f</a></span><span class="op" id="3877228">.</span><span class="ident" id="3877229"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3877234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877237"><a href="/gostd/go/token/position.go.html#3877169">f</a></span><span class="op" id="3877238">.</span><span class="ident" id="3877239"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3877242">.</span><span class="ident" id="3877243"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3877248">.</span><span class="ident" id="3877249"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3877256">(</span><span class="op" id="3877257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877260">return</span>&nbsp;<span class="ident" id="3877267"><a href="/gostd/go/token/position.go.html#3877218">n</a></span><br>
<span class="lineno"></span><span class="op" id="3877269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3877272">//&nbsp;AddLine&nbsp;adds&nbsp;the&nbsp;line&nbsp;offset&nbsp;for&nbsp;a&nbsp;new&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="3877320">//&nbsp;The&nbsp;line&nbsp;offset&nbsp;must&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;previous&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="3877392">//&nbsp;and&nbsp;smaller&nbsp;than&nbsp;the&nbsp;file&nbsp;size;&nbsp;otherwise&nbsp;the&nbsp;line&nbsp;offset&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3877465">//</span><br>
<span class="lineno"></span><span class="keyword" id="3877468">func</span>&nbsp;<span class="op" id="3877473">(</span><span class="ident" id="3877474">f</span>&nbsp;<span class="op" id="3877476">*</span><span class="ident" id="3877477"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3877481">)</span>&nbsp;<span class="ident" id="3877483">AddLine</span><span class="op" id="3877490">(</span><span class="ident" id="3877491">offset</span>&nbsp;<span class="builtintype" id="3877498">int</span><span class="op" id="3877501">)</span>&nbsp;<span class="op" id="3877503">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877506"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877507">.</span><span class="ident" id="3877508"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3877511">.</span><span class="ident" id="3877512"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3877517">.</span><span class="ident" id="3877518"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3877522">(</span><span class="op" id="3877523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877526">if</span>&nbsp;<span class="ident" id="3877529">i</span>&nbsp;<span class="op" id="3877531">:=</span>&nbsp;<span class="builtinfunc" id="3877534">len</span><span class="op" id="3877537">(</span><span class="ident" id="3877538"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877539">.</span><span class="ident" id="3877540"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3877545">)</span><span class="op" id="3877546">;</span>&nbsp;<span class="op" id="3877548">(</span><span class="ident" id="3877549"><a href="/gostd/go/token/position.go.html#3877529">i</a></span>&nbsp;<span class="op" id="3877551">==</span>&nbsp;<span class="num" id="3877554">0</span>&nbsp;<span class="op" id="3877556">||</span>&nbsp;<span class="ident" id="3877559"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877560">.</span><span class="ident" id="3877561"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3877566">[</span><span class="ident" id="3877567"><a href="/gostd/go/token/position.go.html#3877529">i</a></span><span class="op" id="3877568">-</span><span class="num" id="3877569">1</span><span class="op" id="3877570">]</span>&nbsp;<span class="op" id="3877572">&lt;</span>&nbsp;<span class="ident" id="3877574"><a href="/gostd/go/token/position.go.html#3877491">offset</a></span><span class="op" id="3877580">)</span>&nbsp;<span class="op" id="3877582">&amp;&amp;</span>&nbsp;<span class="ident" id="3877585"><a href="/gostd/go/token/position.go.html#3877491">offset</a></span>&nbsp;<span class="op" id="3877592">&lt;</span>&nbsp;<span class="ident" id="3877594"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877595">.</span><span class="ident" id="3877596"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3877601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877605"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877606">.</span><span class="ident" id="3877607"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span>&nbsp;<span class="op" id="3877613">=</span>&nbsp;<span class="builtinfunc" id="3877615">append</span><span class="op" id="3877621">(</span><span class="ident" id="3877622"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877623">.</span><span class="ident" id="3877624"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3877629">,</span>&nbsp;<span class="ident" id="3877631"><a href="/gostd/go/token/position.go.html#3877491">offset</a></span><span class="op" id="3877637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3877640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877643"><a href="/gostd/go/token/position.go.html#3877474">f</a></span><span class="op" id="3877644">.</span><span class="ident" id="3877645"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3877648">.</span><span class="ident" id="3877649"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3877654">.</span><span class="ident" id="3877655"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3877661">(</span><span class="op" id="3877662">)</span><br>
<span class="lineno">135</span><span class="op" id="3877664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3877667">//&nbsp;MergeLine&nbsp;merges&nbsp;a&nbsp;line&nbsp;with&nbsp;the&nbsp;following&nbsp;line.&nbsp;It&nbsp;is&nbsp;akin&nbsp;to&nbsp;replacing</span><br>
<span class="lineno"></span><span class="comment" id="3877743">//&nbsp;the&nbsp;newline&nbsp;character&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line&nbsp;with&nbsp;a&nbsp;space&nbsp;(to&nbsp;not&nbsp;change&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3877823">//&nbsp;remaining&nbsp;offsets).&nbsp;To&nbsp;obtain&nbsp;the&nbsp;line&nbsp;number,&nbsp;consult&nbsp;e.g.&nbsp;Position.Line.</span><br>
<span class="lineno">140</span><span class="comment" id="3877901">//&nbsp;MergeLine&nbsp;will&nbsp;panic&nbsp;if&nbsp;given&nbsp;an&nbsp;invalid&nbsp;line&nbsp;number.</span><br>
<span class="lineno"></span><span class="comment" id="3877958">//</span><br>
<span class="lineno"></span><span class="keyword" id="3877961">func</span>&nbsp;<span class="op" id="3877966">(</span><span class="ident" id="3877967">f</span>&nbsp;<span class="op" id="3877969">*</span><span class="ident" id="3877970"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3877974">)</span>&nbsp;<span class="ident" id="3877976">MergeLine</span><span class="op" id="3877985">(</span><span class="ident" id="3877986">line</span>&nbsp;<span class="builtintype" id="3877991">int</span><span class="op" id="3877994">)</span>&nbsp;<span class="op" id="3877996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3877999">if</span>&nbsp;<span class="ident" id="3878002"><a href="/gostd/go/token/position.go.html#3877986">line</a></span>&nbsp;<span class="op" id="3878007">&lt;=</span>&nbsp;<span class="num" id="3878010">0</span>&nbsp;<span class="op" id="3878012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3878016">panic</span><span class="op" id="3878021">(</span><span class="string" id="3878022">&#34;illegal&nbsp;line&nbsp;number&nbsp;(line&nbsp;numbering&nbsp;starts&nbsp;at&nbsp;1)&#34;</span><span class="op" id="3878072">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878078"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878079">.</span><span class="ident" id="3878080"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3878083">.</span><span class="ident" id="3878084"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3878089">.</span><span class="ident" id="3878090"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3878094">(</span><span class="op" id="3878095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878098">defer</span>&nbsp;<span class="ident" id="3878104"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878105">.</span><span class="ident" id="3878106"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3878109">.</span><span class="ident" id="3878110"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3878115">.</span><span class="ident" id="3878116"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3878122">(</span><span class="op" id="3878123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878126">if</span>&nbsp;<span class="ident" id="3878129"><a href="/gostd/go/token/position.go.html#3877986">line</a></span>&nbsp;<span class="op" id="3878134">&gt;=</span>&nbsp;<span class="builtinfunc" id="3878137">len</span><span class="op" id="3878140">(</span><span class="ident" id="3878141"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878142">.</span><span class="ident" id="3878143"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3878148">)</span>&nbsp;<span class="op" id="3878150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3878154">panic</span><span class="op" id="3878159">(</span><span class="string" id="3878160">&#34;illegal&nbsp;line&nbsp;number&#34;</span><span class="op" id="3878181">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3878184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878187">//&nbsp;To&nbsp;merge&nbsp;the&nbsp;line&nbsp;numbered&nbsp;&lt;line&gt;&nbsp;with&nbsp;the&nbsp;line&nbsp;numbered&nbsp;&lt;line+1&gt;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878258">//&nbsp;we&nbsp;need&nbsp;to&nbsp;remove&nbsp;the&nbsp;entry&nbsp;in&nbsp;lines&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878325">//&nbsp;numbered&nbsp;&lt;line+1&gt;.&nbsp;The&nbsp;entry&nbsp;in&nbsp;lines&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878393">//&nbsp;numbered&nbsp;&lt;line+1&gt;&nbsp;is&nbsp;located&nbsp;at&nbsp;index&nbsp;&lt;line&gt;,&nbsp;since&nbsp;indices&nbsp;in&nbsp;lines</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878466">//&nbsp;are&nbsp;0-based&nbsp;and&nbsp;line&nbsp;numbers&nbsp;are&nbsp;1-based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3878512">copy</span><span class="op" id="3878516">(</span><span class="ident" id="3878517"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878518">.</span><span class="ident" id="3878519"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3878524">[</span><span class="ident" id="3878525"><a href="/gostd/go/token/position.go.html#3877986">line</a></span><span class="op" id="3878529">:</span><span class="op" id="3878530">]</span><span class="op" id="3878531">,</span>&nbsp;<span class="ident" id="3878533"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878534">.</span><span class="ident" id="3878535"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3878540">[</span><span class="ident" id="3878541"><a href="/gostd/go/token/position.go.html#3877986">line</a></span><span class="op" id="3878545">+</span><span class="num" id="3878546">1</span><span class="op" id="3878547">:</span><span class="op" id="3878548">]</span><span class="op" id="3878549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878552"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878553">.</span><span class="ident" id="3878554"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span>&nbsp;<span class="op" id="3878560">=</span>&nbsp;<span class="ident" id="3878562"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878563">.</span><span class="ident" id="3878564"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3878569">[</span><span class="op" id="3878570">:</span><span class="builtinfunc" id="3878571">len</span><span class="op" id="3878574">(</span><span class="ident" id="3878575"><a href="/gostd/go/token/position.go.html#3877967">f</a></span><span class="op" id="3878576">.</span><span class="ident" id="3878577"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3878582">)</span><span class="op" id="3878583">-</span><span class="num" id="3878584">1</span><span class="op" id="3878585">]</span><br>
<span class="lineno"></span><span class="op" id="3878587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="3878590">//&nbsp;SetLines&nbsp;sets&nbsp;the&nbsp;line&nbsp;offsets&nbsp;for&nbsp;a&nbsp;file&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;successful.</span><br>
<span class="lineno"></span><span class="comment" id="3878667">//&nbsp;The&nbsp;line&nbsp;offsets&nbsp;are&nbsp;the&nbsp;offsets&nbsp;of&nbsp;the&nbsp;first&nbsp;character&nbsp;of&nbsp;each&nbsp;line;</span><br>
<span class="lineno"></span><span class="comment" id="3878740">//&nbsp;for&nbsp;instance&nbsp;for&nbsp;the&nbsp;content&nbsp;&#34;ab\nc\n&#34;&nbsp;the&nbsp;line&nbsp;offsets&nbsp;are&nbsp;{0,&nbsp;3}.</span><br>
<span class="lineno"></span><span class="comment" id="3878811">//&nbsp;An&nbsp;empty&nbsp;file&nbsp;has&nbsp;an&nbsp;empty&nbsp;line&nbsp;offset&nbsp;table.</span><br>
<span class="lineno"></span><span class="comment" id="3878860">//&nbsp;Each&nbsp;line&nbsp;offset&nbsp;must&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;previous&nbsp;line</span><br>
<span class="lineno">165</span><span class="comment" id="3878933">//&nbsp;and&nbsp;smaller&nbsp;than&nbsp;the&nbsp;file&nbsp;size;&nbsp;otherwise&nbsp;SetLines&nbsp;fails&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3879005">//&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="3879015">//</span><br>
<span class="lineno"></span><span class="keyword" id="3879018">func</span>&nbsp;<span class="op" id="3879023">(</span><span class="ident" id="3879024">f</span>&nbsp;<span class="op" id="3879026">*</span><span class="ident" id="3879027"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3879031">)</span>&nbsp;<span class="ident" id="3879033">SetLines</span><span class="op" id="3879041">(</span><span class="ident" id="3879042">lines</span>&nbsp;<span class="op" id="3879048">[</span><span class="op" id="3879049">]</span><span class="builtintype" id="3879050">int</span><span class="op" id="3879053">)</span>&nbsp;<span class="builtintype" id="3879055">bool</span>&nbsp;<span class="op" id="3879060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879063">//&nbsp;verify&nbsp;validity&nbsp;of&nbsp;lines&nbsp;table</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879098">size</span>&nbsp;<span class="op" id="3879103">:=</span>&nbsp;<span class="ident" id="3879106"><a href="/gostd/go/token/position.go.html#3879024">f</a></span><span class="op" id="3879107">.</span><span class="ident" id="3879108"><a href="/gostd/go/token/position.go.html#3876543">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879114">for</span>&nbsp;<span class="ident" id="3879118">i</span><span class="op" id="3879119">,</span>&nbsp;<span class="ident" id="3879121">offset</span>&nbsp;<span class="op" id="3879128">:=</span>&nbsp;<span class="keyword" id="3879131">range</span>&nbsp;<span class="ident" id="3879137"><a href="/gostd/go/token/position.go.html#3879042">lines</a></span>&nbsp;<span class="op" id="3879143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879147">if</span>&nbsp;<span class="ident" id="3879150"><a href="/gostd/go/token/position.go.html#3879118">i</a></span>&nbsp;<span class="op" id="3879152">&gt;</span>&nbsp;<span class="num" id="3879154">0</span>&nbsp;<span class="op" id="3879156">&amp;&amp;</span>&nbsp;<span class="ident" id="3879159"><a href="/gostd/go/token/position.go.html#3879121">offset</a></span>&nbsp;<span class="op" id="3879166">&lt;=</span>&nbsp;<span class="ident" id="3879169"><a href="/gostd/go/token/position.go.html#3879042">lines</a></span><span class="op" id="3879174">[</span><span class="ident" id="3879175"><a href="/gostd/go/token/position.go.html#3879118">i</a></span><span class="op" id="3879176">-</span><span class="num" id="3879177">1</span><span class="op" id="3879178">]</span>&nbsp;<span class="op" id="3879180">||</span>&nbsp;<span class="ident" id="3879183"><a href="/gostd/go/token/position.go.html#3879098">size</a></span>&nbsp;<span class="op" id="3879188">&lt;=</span>&nbsp;<span class="ident" id="3879191"><a href="/gostd/go/token/position.go.html#3879121">offset</a></span>&nbsp;<span class="op" id="3879198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879203">return</span>&nbsp;<span class="builtintype" id="3879210">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879218">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879225">//&nbsp;set&nbsp;lines&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879245"><a href="/gostd/go/token/position.go.html#3879024">f</a></span><span class="op" id="3879246">.</span><span class="ident" id="3879247"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3879250">.</span><span class="ident" id="3879251"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3879256">.</span><span class="ident" id="3879257"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3879261">(</span><span class="op" id="3879262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879265"><a href="/gostd/go/token/position.go.html#3879024">f</a></span><span class="op" id="3879266">.</span><span class="ident" id="3879267"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span>&nbsp;<span class="op" id="3879273">=</span>&nbsp;<span class="ident" id="3879275"><a href="/gostd/go/token/position.go.html#3879042">lines</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879282"><a href="/gostd/go/token/position.go.html#3879024">f</a></span><span class="op" id="3879283">.</span><span class="ident" id="3879284"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3879287">.</span><span class="ident" id="3879288"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3879293">.</span><span class="ident" id="3879294"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3879300">(</span><span class="op" id="3879301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879304">return</span>&nbsp;<span class="builtintype" id="3879311">true</span><br>
<span class="lineno"></span><span class="op" id="3879316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3879319">//&nbsp;SetLinesForContent&nbsp;sets&nbsp;the&nbsp;line&nbsp;offsets&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;content.</span><br>
<span class="lineno">185</span><span class="comment" id="3879391">//&nbsp;It&nbsp;ignores&nbsp;position-altering&nbsp;//line&nbsp;comments.</span><br>
<span class="lineno"></span><span class="keyword" id="3879440">func</span>&nbsp;<span class="op" id="3879445">(</span><span class="ident" id="3879446">f</span>&nbsp;<span class="op" id="3879448">*</span><span class="ident" id="3879449"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3879453">)</span>&nbsp;<span class="ident" id="3879455">SetLinesForContent</span><span class="op" id="3879473">(</span><span class="ident" id="3879474">content</span>&nbsp;<span class="op" id="3879482">[</span><span class="op" id="3879483">]</span><span class="builtintype" id="3879484">byte</span><span class="op" id="3879488">)</span>&nbsp;<span class="op" id="3879490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879493">var</span>&nbsp;<span class="ident" id="3879497">lines</span>&nbsp;<span class="op" id="3879503">[</span><span class="op" id="3879504">]</span><span class="builtintype" id="3879505">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879510">line</span>&nbsp;<span class="op" id="3879515">:=</span>&nbsp;<span class="num" id="3879518">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879521">for</span>&nbsp;<span class="ident" id="3879525">offset</span><span class="op" id="3879531">,</span>&nbsp;<span class="ident" id="3879533">b</span>&nbsp;<span class="op" id="3879535">:=</span>&nbsp;<span class="keyword" id="3879538">range</span>&nbsp;<span class="ident" id="3879544"><a href="/gostd/go/token/position.go.html#3879474">content</a></span>&nbsp;<span class="op" id="3879552">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879556">if</span>&nbsp;<span class="ident" id="3879559"><a href="/gostd/go/token/position.go.html#3879510">line</a></span>&nbsp;<span class="op" id="3879564">&gt;=</span>&nbsp;<span class="num" id="3879567">0</span>&nbsp;<span class="op" id="3879569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879574"><a href="/gostd/go/token/position.go.html#3879497">lines</a></span>&nbsp;<span class="op" id="3879580">=</span>&nbsp;<span class="builtinfunc" id="3879582">append</span><span class="op" id="3879588">(</span><span class="ident" id="3879589"><a href="/gostd/go/token/position.go.html#3879497">lines</a></span><span class="op" id="3879594">,</span>&nbsp;<span class="ident" id="3879596"><a href="/gostd/go/token/position.go.html#3879510">line</a></span><span class="op" id="3879600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879608"><a href="/gostd/go/token/position.go.html#3879510">line</a></span>&nbsp;<span class="op" id="3879613">=</span>&nbsp;<span class="op" id="3879615">-</span><span class="num" id="3879616">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879620">if</span>&nbsp;<span class="ident" id="3879623"><a href="/gostd/go/token/position.go.html#3879533">b</a></span>&nbsp;<span class="op" id="3879625">==</span>&nbsp;<span class="string" id="3879628">&#39;\n&#39;</span>&nbsp;<span class="op" id="3879633">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879638"><a href="/gostd/go/token/position.go.html#3879510">line</a></span>&nbsp;<span class="op" id="3879643">=</span>&nbsp;<span class="ident" id="3879645"><a href="/gostd/go/token/position.go.html#3879525">offset</a></span>&nbsp;<span class="op" id="3879652">+</span>&nbsp;<span class="num" id="3879654">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879665">//&nbsp;set&nbsp;lines&nbsp;table</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879685"><a href="/gostd/go/token/position.go.html#3879446">f</a></span><span class="op" id="3879686">.</span><span class="ident" id="3879687"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3879690">.</span><span class="ident" id="3879691"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3879696">.</span><span class="ident" id="3879697"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3879701">(</span><span class="op" id="3879702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879705"><a href="/gostd/go/token/position.go.html#3879446">f</a></span><span class="op" id="3879706">.</span><span class="ident" id="3879707"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span>&nbsp;<span class="op" id="3879713">=</span>&nbsp;<span class="ident" id="3879715"><a href="/gostd/go/token/position.go.html#3879497">lines</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879722"><a href="/gostd/go/token/position.go.html#3879446">f</a></span><span class="op" id="3879723">.</span><span class="ident" id="3879724"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3879727">.</span><span class="ident" id="3879728"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3879733">.</span><span class="ident" id="3879734"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3879740">(</span><span class="op" id="3879741">)</span><br>
<span class="lineno"></span><span class="op" id="3879743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3879746">//&nbsp;A&nbsp;lineInfo&nbsp;object&nbsp;describes&nbsp;alternative&nbsp;file&nbsp;and&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3879810">//&nbsp;information&nbsp;(such&nbsp;as&nbsp;provided&nbsp;via&nbsp;a&nbsp;//line&nbsp;comment&nbsp;in&nbsp;a&nbsp;.go</span><br>
<span class="lineno"></span><span class="comment" id="3879873">//&nbsp;file)&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="3879907">type</span>&nbsp;<span class="ident" id="3879912">lineInfo</span>&nbsp;<span class="keyword" id="3879921">struct</span>&nbsp;<span class="op" id="3879928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879931">//&nbsp;fields&nbsp;are&nbsp;exported&nbsp;to&nbsp;make&nbsp;them&nbsp;accessible&nbsp;to&nbsp;gob</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879986">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3879995">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880000">Filename</span>&nbsp;<span class="builtintype" id="3880009">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880017">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3880026">int</span><br>
<span class="lineno"></span><span class="op" id="3880030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="3880033">//&nbsp;AddLineInfo&nbsp;adds&nbsp;alternative&nbsp;file&nbsp;and&nbsp;line&nbsp;number&nbsp;information&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3880102">//&nbsp;a&nbsp;given&nbsp;file&nbsp;offset.&nbsp;The&nbsp;offset&nbsp;must&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;offset&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3880172">//&nbsp;the&nbsp;previously&nbsp;added&nbsp;alternative&nbsp;line&nbsp;info&nbsp;and&nbsp;smaller&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3880239">//&nbsp;file&nbsp;size;&nbsp;otherwise&nbsp;the&nbsp;information&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3880291">//</span><br>
<span class="lineno">220</span><span class="comment" id="3880294">//&nbsp;AddLineInfo&nbsp;is&nbsp;typically&nbsp;used&nbsp;to&nbsp;register&nbsp;alternative&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="3880360">//&nbsp;information&nbsp;for&nbsp;//line&nbsp;filename:line&nbsp;comments&nbsp;in&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="3880426">//</span><br>
<span class="lineno"></span><span class="keyword" id="3880429">func</span>&nbsp;<span class="op" id="3880434">(</span><span class="ident" id="3880435">f</span>&nbsp;<span class="op" id="3880437">*</span><span class="ident" id="3880438"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3880442">)</span>&nbsp;<span class="ident" id="3880444">AddLineInfo</span><span class="op" id="3880455">(</span><span class="ident" id="3880456">offset</span>&nbsp;<span class="builtintype" id="3880463">int</span><span class="op" id="3880466">,</span>&nbsp;<span class="ident" id="3880468">filename</span>&nbsp;<span class="builtintype" id="3880477">string</span><span class="op" id="3880483">,</span>&nbsp;<span class="ident" id="3880485">line</span>&nbsp;<span class="builtintype" id="3880490">int</span><span class="op" id="3880493">)</span>&nbsp;<span class="op" id="3880495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880498"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880499">.</span><span class="ident" id="3880500"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3880503">.</span><span class="ident" id="3880504"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3880509">.</span><span class="ident" id="3880510"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3880514">(</span><span class="op" id="3880515">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880518">if</span>&nbsp;<span class="ident" id="3880521">i</span>&nbsp;<span class="op" id="3880523">:=</span>&nbsp;<span class="builtinfunc" id="3880526">len</span><span class="op" id="3880529">(</span><span class="ident" id="3880530"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880531">.</span><span class="ident" id="3880532"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3880537">)</span><span class="op" id="3880538">;</span>&nbsp;<span class="ident" id="3880540"><a href="/gostd/go/token/position.go.html#3880521">i</a></span>&nbsp;<span class="op" id="3880542">==</span>&nbsp;<span class="num" id="3880545">0</span>&nbsp;<span class="op" id="3880547">||</span>&nbsp;<span class="ident" id="3880550"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880551">.</span><span class="ident" id="3880552"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3880557">[</span><span class="ident" id="3880558"><a href="/gostd/go/token/position.go.html#3880521">i</a></span><span class="op" id="3880559">-</span><span class="num" id="3880560">1</span><span class="op" id="3880561">]</span><span class="op" id="3880562">.</span><span class="ident" id="3880563"><a href="/gostd/go/token/position.go.html#3879986">Offset</a></span>&nbsp;<span class="op" id="3880570">&lt;</span>&nbsp;<span class="ident" id="3880572"><a href="/gostd/go/token/position.go.html#3880456">offset</a></span>&nbsp;<span class="op" id="3880579">&amp;&amp;</span>&nbsp;<span class="ident" id="3880582"><a href="/gostd/go/token/position.go.html#3880456">offset</a></span>&nbsp;<span class="op" id="3880589">&lt;</span>&nbsp;<span class="ident" id="3880591"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880592">.</span><span class="ident" id="3880593"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3880598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880602"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880603">.</span><span class="ident" id="3880604"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span>&nbsp;<span class="op" id="3880610">=</span>&nbsp;<span class="builtinfunc" id="3880612">append</span><span class="op" id="3880618">(</span><span class="ident" id="3880619"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880620">.</span><span class="ident" id="3880621"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3880626">,</span>&nbsp;<span class="ident" id="3880628"><a href="/gostd/go/token/position.go.html#3879912">lineInfo</a></span><span class="op" id="3880636">{</span><span class="ident" id="3880637"><a href="/gostd/go/token/position.go.html#3880456">offset</a></span><span class="op" id="3880643">,</span>&nbsp;<span class="ident" id="3880645"><a href="/gostd/go/token/position.go.html#3880468">filename</a></span><span class="op" id="3880653">,</span>&nbsp;<span class="ident" id="3880655"><a href="/gostd/go/token/position.go.html#3880485">line</a></span><span class="op" id="3880659">}</span><span class="op" id="3880660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880666"><a href="/gostd/go/token/position.go.html#3880435">f</a></span><span class="op" id="3880667">.</span><span class="ident" id="3880668"><a href="/gostd/go/token/position.go.html#3876411">set</a></span><span class="op" id="3880671">.</span><span class="ident" id="3880672"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3880677">.</span><span class="ident" id="3880678"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3880684">(</span><span class="op" id="3880685">)</span><br>
<span class="lineno"></span><span class="op" id="3880687">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="3880690">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;Pos&nbsp;value&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;offset;</span><br>
<span class="lineno"></span><span class="comment" id="3880746">//&nbsp;the&nbsp;offset&nbsp;must&nbsp;be&nbsp;&lt;=&nbsp;f.Size().</span><br>
<span class="lineno"></span><span class="comment" id="3880781">//&nbsp;f.Pos(f.Offset(p))&nbsp;==&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="3880809">//</span><br>
<span class="lineno">235</span><span class="keyword" id="3880812">func</span>&nbsp;<span class="op" id="3880817">(</span><span class="ident" id="3880818">f</span>&nbsp;<span class="op" id="3880820">*</span><span class="ident" id="3880821"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3880825">)</span>&nbsp;<span class="ident" id="3880827">Pos</span><span class="op" id="3880830">(</span><span class="ident" id="3880831">offset</span>&nbsp;<span class="builtintype" id="3880838">int</span><span class="op" id="3880841">)</span>&nbsp;<span class="ident" id="3880843"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span>&nbsp;<span class="op" id="3880847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880850">if</span>&nbsp;<span class="ident" id="3880853"><a href="/gostd/go/token/position.go.html#3880831">offset</a></span>&nbsp;<span class="op" id="3880860">&gt;</span>&nbsp;<span class="ident" id="3880862"><a href="/gostd/go/token/position.go.html#3880818">f</a></span><span class="op" id="3880863">.</span><span class="ident" id="3880864"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3880869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3880873">panic</span><span class="op" id="3880878">(</span><span class="string" id="3880879">&#34;illegal&nbsp;file&nbsp;offset&#34;</span><span class="op" id="3880900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3880906">return</span>&nbsp;<span class="ident" id="3880913"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3880916">(</span><span class="ident" id="3880917"><a href="/gostd/go/token/position.go.html#3880818">f</a></span><span class="op" id="3880918">.</span><span class="ident" id="3880919"><a href="/gostd/go/token/position.go.html#3876475">base</a></span>&nbsp;<span class="op" id="3880924">+</span>&nbsp;<span class="ident" id="3880926"><a href="/gostd/go/token/position.go.html#3880831">offset</a></span><span class="op" id="3880932">)</span><br>
<span class="lineno">240</span><span class="op" id="3880934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3880937">//&nbsp;Offset&nbsp;returns&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;position&nbsp;p;</span><br>
<span class="lineno"></span><span class="comment" id="3880997">//&nbsp;p&nbsp;must&nbsp;be&nbsp;a&nbsp;valid&nbsp;Pos&nbsp;value&nbsp;in&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3881042">//&nbsp;f.Offset(f.Pos(offset))&nbsp;==&nbsp;offset.</span><br>
<span class="lineno">245</span><span class="comment" id="3881080">//</span><br>
<span class="lineno"></span><span class="keyword" id="3881083">func</span>&nbsp;<span class="op" id="3881088">(</span><span class="ident" id="3881089">f</span>&nbsp;<span class="op" id="3881091">*</span><span class="ident" id="3881092"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3881096">)</span>&nbsp;<span class="ident" id="3881098">Offset</span><span class="op" id="3881104">(</span><span class="ident" id="3881105">p</span>&nbsp;<span class="ident" id="3881107"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3881110">)</span>&nbsp;<span class="builtintype" id="3881112">int</span>&nbsp;<span class="op" id="3881116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881119">if</span>&nbsp;<span class="builtintype" id="3881122">int</span><span class="op" id="3881125">(</span><span class="ident" id="3881126"><a href="/gostd/go/token/position.go.html#3881105">p</a></span><span class="op" id="3881127">)</span>&nbsp;<span class="op" id="3881129">&lt;</span>&nbsp;<span class="ident" id="3881131"><a href="/gostd/go/token/position.go.html#3881089">f</a></span><span class="op" id="3881132">.</span><span class="ident" id="3881133"><a href="/gostd/go/token/position.go.html#3876475">base</a></span>&nbsp;<span class="op" id="3881138">||</span>&nbsp;<span class="builtintype" id="3881141">int</span><span class="op" id="3881144">(</span><span class="ident" id="3881145"><a href="/gostd/go/token/position.go.html#3881105">p</a></span><span class="op" id="3881146">)</span>&nbsp;<span class="op" id="3881148">&gt;</span>&nbsp;<span class="ident" id="3881150"><a href="/gostd/go/token/position.go.html#3881089">f</a></span><span class="op" id="3881151">.</span><span class="ident" id="3881152"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><span class="op" id="3881156">+</span><span class="ident" id="3881157"><a href="/gostd/go/token/position.go.html#3881089">f</a></span><span class="op" id="3881158">.</span><span class="ident" id="3881159"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3881164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3881168">panic</span><span class="op" id="3881173">(</span><span class="string" id="3881174">&#34;illegal&nbsp;Pos&nbsp;value&#34;</span><span class="op" id="3881193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881196">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881199">return</span>&nbsp;<span class="builtintype" id="3881206">int</span><span class="op" id="3881209">(</span><span class="ident" id="3881210"><a href="/gostd/go/token/position.go.html#3881105">p</a></span><span class="op" id="3881211">)</span>&nbsp;<span class="op" id="3881213">-</span>&nbsp;<span class="ident" id="3881215"><a href="/gostd/go/token/position.go.html#3881089">f</a></span><span class="op" id="3881216">.</span><span class="ident" id="3881217"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><br>
<span class="lineno"></span><span class="op" id="3881222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881225">//&nbsp;Line&nbsp;returns&nbsp;the&nbsp;line&nbsp;number&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;position&nbsp;p;</span><br>
<span class="lineno"></span><span class="comment" id="3881288">//&nbsp;p&nbsp;must&nbsp;be&nbsp;a&nbsp;Pos&nbsp;value&nbsp;in&nbsp;that&nbsp;file&nbsp;or&nbsp;NoPos.</span><br>
<span class="lineno">255</span><span class="comment" id="3881336">//</span><br>
<span class="lineno"></span><span class="keyword" id="3881339">func</span>&nbsp;<span class="op" id="3881344">(</span><span class="ident" id="3881345">f</span>&nbsp;<span class="op" id="3881347">*</span><span class="ident" id="3881348"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3881352">)</span>&nbsp;<span class="ident" id="3881354">Line</span><span class="op" id="3881358">(</span><span class="ident" id="3881359">p</span>&nbsp;<span class="ident" id="3881361"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3881364">)</span>&nbsp;<span class="builtintype" id="3881366">int</span>&nbsp;<span class="op" id="3881370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881373">return</span>&nbsp;<span class="ident" id="3881380"><a href="/gostd/go/token/position.go.html#3881345">f</a></span><span class="op" id="3881381">.</span><span class="ident" id="3881382"><a href="/gostd/go/token/position.go.html#3883056">Position</a></span><span class="op" id="3881390">(</span><span class="ident" id="3881391"><a href="/gostd/go/token/position.go.html#3881359">p</a></span><span class="op" id="3881392">)</span><span class="op" id="3881393">.</span><span class="ident" id="3881394"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><br>
<span class="lineno"></span><span class="op" id="3881399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3881402">func</span>&nbsp;<span class="ident" id="3881407">searchLineInfos</span><span class="op" id="3881422">(</span><span class="ident" id="3881423">a</span>&nbsp;<span class="op" id="3881425">[</span><span class="op" id="3881426">]</span><span class="ident" id="3881427"><a href="/gostd/go/token/position.go.html#3879912">lineInfo</a></span><span class="op" id="3881435">,</span>&nbsp;<span class="ident" id="3881437">x</span>&nbsp;<span class="builtintype" id="3881439">int</span><span class="op" id="3881442">)</span>&nbsp;<span class="builtintype" id="3881444">int</span>&nbsp;<span class="op" id="3881448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881451">return</span>&nbsp;<span class="ident" id="3881458"><a href="/gostd/go/token/position.go.html#3873692">sort</a></span><span class="op" id="3881462">.</span><span class="ident" id="3881463"><a href="/gostd/sort/search.go.html#2008959">Search</a></span><span class="op" id="3881469">(</span><span class="builtinfunc" id="3881470">len</span><span class="op" id="3881473">(</span><span class="ident" id="3881474"><a href="/gostd/go/token/position.go.html#3881423">a</a></span><span class="op" id="3881475">)</span><span class="op" id="3881476">,</span>&nbsp;<span class="keyword" id="3881478">func</span><span class="op" id="3881482">(</span><span class="ident" id="3881483">i</span>&nbsp;<span class="builtintype" id="3881485">int</span><span class="op" id="3881488">)</span>&nbsp;<span class="builtintype" id="3881490">bool</span>&nbsp;<span class="op" id="3881495">{</span>&nbsp;<span class="keyword" id="3881497">return</span>&nbsp;<span class="ident" id="3881504"><a href="/gostd/go/token/position.go.html#3881423">a</a></span><span class="op" id="3881505">[</span><span class="ident" id="3881506"><a href="/gostd/go/token/position.go.html#3881483">i</a></span><span class="op" id="3881507">]</span><span class="op" id="3881508">.</span><span class="ident" id="3881509"><a href="/gostd/go/token/position.go.html#3879986">Offset</a></span>&nbsp;<span class="op" id="3881516">&gt;</span>&nbsp;<span class="ident" id="3881518"><a href="/gostd/go/token/position.go.html#3881437">x</a></span>&nbsp;<span class="op" id="3881520">}</span><span class="op" id="3881521">)</span>&nbsp;<span class="op" id="3881523">-</span>&nbsp;<span class="num" id="3881525">1</span><br>
<span class="lineno"></span><span class="op" id="3881527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3881530">//&nbsp;unpack&nbsp;returns&nbsp;the&nbsp;filename&nbsp;and&nbsp;line&nbsp;and&nbsp;column&nbsp;number&nbsp;for&nbsp;a&nbsp;file&nbsp;offset.</span><br>
<span class="lineno">265</span><span class="comment" id="3881607">//&nbsp;If&nbsp;adjusted&nbsp;is&nbsp;set,&nbsp;unpack&nbsp;will&nbsp;return&nbsp;the&nbsp;filename&nbsp;and&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="3881683">//&nbsp;possibly&nbsp;adjusted&nbsp;by&nbsp;//line&nbsp;comments;&nbsp;otherwise&nbsp;those&nbsp;comments&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3881762">//</span><br>
<span class="lineno"></span><span class="keyword" id="3881765">func</span>&nbsp;<span class="op" id="3881770">(</span><span class="ident" id="3881771">f</span>&nbsp;<span class="op" id="3881773">*</span><span class="ident" id="3881774"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3881778">)</span>&nbsp;<span class="ident" id="3881780">unpack</span><span class="op" id="3881786">(</span><span class="ident" id="3881787">offset</span>&nbsp;<span class="builtintype" id="3881794">int</span><span class="op" id="3881797">,</span>&nbsp;<span class="ident" id="3881799">adjusted</span>&nbsp;<span class="builtintype" id="3881808">bool</span><span class="op" id="3881812">)</span>&nbsp;<span class="op" id="3881814">(</span><span class="ident" id="3881815">filename</span>&nbsp;<span class="builtintype" id="3881824">string</span><span class="op" id="3881830">,</span>&nbsp;<span class="ident" id="3881832">line</span><span class="op" id="3881836">,</span>&nbsp;<span class="ident" id="3881838">column</span>&nbsp;<span class="builtintype" id="3881845">int</span><span class="op" id="3881848">)</span>&nbsp;<span class="op" id="3881850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881853"><a href="/gostd/go/token/position.go.html#3881815">filename</a></span>&nbsp;<span class="op" id="3881862">=</span>&nbsp;<span class="ident" id="3881864"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3881865">.</span><span class="ident" id="3881866"><a href="/gostd/go/token/position.go.html#3876426">name</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881872">if</span>&nbsp;<span class="ident" id="3881875">i</span>&nbsp;<span class="op" id="3881877">:=</span>&nbsp;<span class="ident" id="3881880"><a href="/gostd/go/token/position.go.html#3887245">searchInts</a></span><span class="op" id="3881890">(</span><span class="ident" id="3881891"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3881892">.</span><span class="ident" id="3881893"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3881898">,</span>&nbsp;<span class="ident" id="3881900"><a href="/gostd/go/token/position.go.html#3881787">offset</a></span><span class="op" id="3881906">)</span><span class="op" id="3881907">;</span>&nbsp;<span class="ident" id="3881909"><a href="/gostd/go/token/position.go.html#3881875">i</a></span>&nbsp;<span class="op" id="3881911">&gt;=</span>&nbsp;<span class="num" id="3881914">0</span>&nbsp;<span class="op" id="3881916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3881920"><a href="/gostd/go/token/position.go.html#3881832">line</a></span><span class="op" id="3881924">,</span>&nbsp;<span class="ident" id="3881926"><a href="/gostd/go/token/position.go.html#3881838">column</a></span>&nbsp;<span class="op" id="3881933">=</span>&nbsp;<span class="ident" id="3881935"><a href="/gostd/go/token/position.go.html#3881875">i</a></span><span class="op" id="3881936">+</span><span class="num" id="3881937">1</span><span class="op" id="3881938">,</span>&nbsp;<span class="ident" id="3881940"><a href="/gostd/go/token/position.go.html#3881787">offset</a></span><span class="op" id="3881946">-</span><span class="ident" id="3881947"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3881948">.</span><span class="ident" id="3881949"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3881954">[</span><span class="ident" id="3881955"><a href="/gostd/go/token/position.go.html#3881875">i</a></span><span class="op" id="3881956">]</span><span class="op" id="3881957">+</span><span class="num" id="3881958">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3881961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3881964">if</span>&nbsp;<span class="ident" id="3881967"><a href="/gostd/go/token/position.go.html#3881799">adjusted</a></span>&nbsp;<span class="op" id="3881976">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3881979">len</span><span class="op" id="3881982">(</span><span class="ident" id="3881983"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3881984">.</span><span class="ident" id="3881985"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3881990">)</span>&nbsp;<span class="op" id="3881992">&gt;</span>&nbsp;<span class="num" id="3881994">0</span>&nbsp;<span class="op" id="3881996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3882000">//&nbsp;almost&nbsp;no&nbsp;files&nbsp;have&nbsp;extra&nbsp;line&nbsp;infos</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882043">if</span>&nbsp;<span class="ident" id="3882046">i</span>&nbsp;<span class="op" id="3882048">:=</span>&nbsp;<span class="ident" id="3882051"><a href="/gostd/go/token/position.go.html#3881407">searchLineInfos</a></span><span class="op" id="3882066">(</span><span class="ident" id="3882067"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3882068">.</span><span class="ident" id="3882069"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3882074">,</span>&nbsp;<span class="ident" id="3882076"><a href="/gostd/go/token/position.go.html#3881787">offset</a></span><span class="op" id="3882082">)</span><span class="op" id="3882083">;</span>&nbsp;<span class="ident" id="3882085"><a href="/gostd/go/token/position.go.html#3882046">i</a></span>&nbsp;<span class="op" id="3882087">&gt;=</span>&nbsp;<span class="num" id="3882090">0</span>&nbsp;<span class="op" id="3882092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882097">alt</span>&nbsp;<span class="op" id="3882101">:=</span>&nbsp;<span class="op" id="3882104">&amp;</span><span class="ident" id="3882105"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3882106">.</span><span class="ident" id="3882107"><a href="/gostd/go/token/position.go.html#3876749">infos</a></span><span class="op" id="3882112">[</span><span class="ident" id="3882113"><a href="/gostd/go/token/position.go.html#3882046">i</a></span><span class="op" id="3882114">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882119"><a href="/gostd/go/token/position.go.html#3881815">filename</a></span>&nbsp;<span class="op" id="3882128">=</span>&nbsp;<span class="ident" id="3882130"><a href="/gostd/go/token/position.go.html#3882097">alt</a></span><span class="op" id="3882133">.</span><span class="ident" id="3882134"><a href="/gostd/go/token/position.go.html#3880000">Filename</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882146">if</span>&nbsp;<span class="ident" id="3882149">i</span>&nbsp;<span class="op" id="3882151">:=</span>&nbsp;<span class="ident" id="3882154"><a href="/gostd/go/token/position.go.html#3887245">searchInts</a></span><span class="op" id="3882164">(</span><span class="ident" id="3882165"><a href="/gostd/go/token/position.go.html#3881771">f</a></span><span class="op" id="3882166">.</span><span class="ident" id="3882167"><a href="/gostd/go/token/position.go.html#3876640">lines</a></span><span class="op" id="3882172">,</span>&nbsp;<span class="ident" id="3882174"><a href="/gostd/go/token/position.go.html#3882097">alt</a></span><span class="op" id="3882177">.</span><span class="ident" id="3882178"><a href="/gostd/go/token/position.go.html#3879986">Offset</a></span><span class="op" id="3882184">)</span><span class="op" id="3882185">;</span>&nbsp;<span class="ident" id="3882187"><a href="/gostd/go/token/position.go.html#3882149">i</a></span>&nbsp;<span class="op" id="3882189">&gt;=</span>&nbsp;<span class="num" id="3882192">0</span>&nbsp;<span class="op" id="3882194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882200"><a href="/gostd/go/token/position.go.html#3881832">line</a></span>&nbsp;<span class="op" id="3882205">+=</span>&nbsp;<span class="ident" id="3882208"><a href="/gostd/go/token/position.go.html#3882097">alt</a></span><span class="op" id="3882211">.</span><span class="ident" id="3882212"><a href="/gostd/go/token/position.go.html#3880017">Line</a></span>&nbsp;<span class="op" id="3882217">-</span>&nbsp;<span class="ident" id="3882219"><a href="/gostd/go/token/position.go.html#3882149">i</a></span>&nbsp;<span class="op" id="3882221">-</span>&nbsp;<span class="num" id="3882223">1</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882238">return</span><br>
<span class="lineno"></span><span class="op" id="3882245">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="3882248">func</span>&nbsp;<span class="op" id="3882253">(</span><span class="ident" id="3882254">f</span>&nbsp;<span class="op" id="3882256">*</span><span class="ident" id="3882257"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3882261">)</span>&nbsp;<span class="ident" id="3882263">position</span><span class="op" id="3882271">(</span><span class="ident" id="3882272">p</span>&nbsp;<span class="ident" id="3882274"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3882277">,</span>&nbsp;<span class="ident" id="3882279">adjusted</span>&nbsp;<span class="builtintype" id="3882288">bool</span><span class="op" id="3882292">)</span>&nbsp;<span class="op" id="3882294">(</span><span class="ident" id="3882295">pos</span>&nbsp;<span class="ident" id="3882299"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3882307">)</span>&nbsp;<span class="op" id="3882309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882312">offset</span>&nbsp;<span class="op" id="3882319">:=</span>&nbsp;<span class="builtintype" id="3882322">int</span><span class="op" id="3882325">(</span><span class="ident" id="3882326"><a href="/gostd/go/token/position.go.html#3882272">p</a></span><span class="op" id="3882327">)</span>&nbsp;<span class="op" id="3882329">-</span>&nbsp;<span class="ident" id="3882331"><a href="/gostd/go/token/position.go.html#3882254">f</a></span><span class="op" id="3882332">.</span><span class="ident" id="3882333"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882339"><a href="/gostd/go/token/position.go.html#3882295">pos</a></span><span class="op" id="3882342">.</span><span class="ident" id="3882343"><a href="/gostd/go/token/position.go.html#3874020">Offset</a></span>&nbsp;<span class="op" id="3882350">=</span>&nbsp;<span class="ident" id="3882352"><a href="/gostd/go/token/position.go.html#3882312">offset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882360"><a href="/gostd/go/token/position.go.html#3882295">pos</a></span><span class="op" id="3882363">.</span><span class="ident" id="3882364"><a href="/gostd/go/token/position.go.html#3873983">Filename</a></span><span class="op" id="3882372">,</span>&nbsp;<span class="ident" id="3882374"><a href="/gostd/go/token/position.go.html#3882295">pos</a></span><span class="op" id="3882377">.</span><span class="ident" id="3882378"><a href="/gostd/go/token/position.go.html#3874062">Line</a></span><span class="op" id="3882382">,</span>&nbsp;<span class="ident" id="3882384"><a href="/gostd/go/token/position.go.html#3882295">pos</a></span><span class="op" id="3882387">.</span><span class="ident" id="3882388"><a href="/gostd/go/token/position.go.html#3874109">Column</a></span>&nbsp;<span class="op" id="3882395">=</span>&nbsp;<span class="ident" id="3882397"><a href="/gostd/go/token/position.go.html#3882254">f</a></span><span class="op" id="3882398">.</span><span class="ident" id="3882399"><a href="/gostd/go/token/position.go.html#3881780">unpack</a></span><span class="op" id="3882405">(</span><span class="ident" id="3882406"><a href="/gostd/go/token/position.go.html#3882312">offset</a></span><span class="op" id="3882412">,</span>&nbsp;<span class="ident" id="3882414"><a href="/gostd/go/token/position.go.html#3882279">adjusted</a></span><span class="op" id="3882422">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882425">return</span><br>
<span class="lineno"></span><span class="op" id="3882432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3882435">//&nbsp;PositionFor&nbsp;returns&nbsp;the&nbsp;Position&nbsp;value&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;position&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="3882508">//&nbsp;If&nbsp;adjusted&nbsp;is&nbsp;set,&nbsp;the&nbsp;position&nbsp;may&nbsp;be&nbsp;adjusted&nbsp;by&nbsp;position-altering</span><br>
<span class="lineno">295</span><span class="comment" id="3882581">//&nbsp;//line&nbsp;comments;&nbsp;otherwise&nbsp;those&nbsp;comments&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3882639">//&nbsp;p&nbsp;must&nbsp;be&nbsp;a&nbsp;Pos&nbsp;value&nbsp;in&nbsp;f&nbsp;or&nbsp;NoPos.</span><br>
<span class="lineno"></span><span class="comment" id="3882679">//</span><br>
<span class="lineno"></span><span class="keyword" id="3882682">func</span>&nbsp;<span class="op" id="3882687">(</span><span class="ident" id="3882688">f</span>&nbsp;<span class="op" id="3882690">*</span><span class="ident" id="3882691"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3882695">)</span>&nbsp;<span class="ident" id="3882697">PositionFor</span><span class="op" id="3882708">(</span><span class="ident" id="3882709">p</span>&nbsp;<span class="ident" id="3882711"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3882714">,</span>&nbsp;<span class="ident" id="3882716">adjusted</span>&nbsp;<span class="builtintype" id="3882725">bool</span><span class="op" id="3882729">)</span>&nbsp;<span class="op" id="3882731">(</span><span class="ident" id="3882732">pos</span>&nbsp;<span class="ident" id="3882736"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3882744">)</span>&nbsp;<span class="op" id="3882746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882749">if</span>&nbsp;<span class="ident" id="3882752"><a href="/gostd/go/token/position.go.html#3882709">p</a></span>&nbsp;<span class="op" id="3882754">!=</span>&nbsp;<span class="ident" id="3882757"><a href="/gostd/go/token/position.go.html#3876073">NoPos</a></span>&nbsp;<span class="op" id="3882763">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882767">if</span>&nbsp;<span class="builtintype" id="3882770">int</span><span class="op" id="3882773">(</span><span class="ident" id="3882774"><a href="/gostd/go/token/position.go.html#3882709">p</a></span><span class="op" id="3882775">)</span>&nbsp;<span class="op" id="3882777">&lt;</span>&nbsp;<span class="ident" id="3882779"><a href="/gostd/go/token/position.go.html#3882688">f</a></span><span class="op" id="3882780">.</span><span class="ident" id="3882781"><a href="/gostd/go/token/position.go.html#3876475">base</a></span>&nbsp;<span class="op" id="3882786">||</span>&nbsp;<span class="builtintype" id="3882789">int</span><span class="op" id="3882792">(</span><span class="ident" id="3882793"><a href="/gostd/go/token/position.go.html#3882709">p</a></span><span class="op" id="3882794">)</span>&nbsp;<span class="op" id="3882796">&gt;</span>&nbsp;<span class="ident" id="3882798"><a href="/gostd/go/token/position.go.html#3882688">f</a></span><span class="op" id="3882799">.</span><span class="ident" id="3882800"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><span class="op" id="3882804">+</span><span class="ident" id="3882805"><a href="/gostd/go/token/position.go.html#3882688">f</a></span><span class="op" id="3882806">.</span><span class="ident" id="3882807"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3882812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3882817">panic</span><span class="op" id="3882822">(</span><span class="string" id="3882823">&#34;illegal&nbsp;Pos&nbsp;value&#34;</span><span class="op" id="3882842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3882850"><a href="/gostd/go/token/position.go.html#3882732">pos</a></span>&nbsp;<span class="op" id="3882854">=</span>&nbsp;<span class="ident" id="3882856"><a href="/gostd/go/token/position.go.html#3882688">f</a></span><span class="op" id="3882857">.</span><span class="ident" id="3882858"><a href="/gostd/go/token/position.go.html#3882263">position</a></span><span class="op" id="3882866">(</span><span class="ident" id="3882867"><a href="/gostd/go/token/position.go.html#3882709">p</a></span><span class="op" id="3882868">,</span>&nbsp;<span class="ident" id="3882870"><a href="/gostd/go/token/position.go.html#3882716">adjusted</a></span><span class="op" id="3882878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3882881">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3882884">return</span><br>
<span class="lineno"></span><span class="op" id="3882891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3882894">//&nbsp;Position&nbsp;returns&nbsp;the&nbsp;Position&nbsp;value&nbsp;for&nbsp;the&nbsp;given&nbsp;file&nbsp;position&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="3882964">//&nbsp;Calling&nbsp;f.Position(p)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;f.PositionFor(p,&nbsp;true).</span><br>
<span class="lineno">310</span><span class="comment" id="3883038">//</span><br>
<span class="lineno"></span><span class="keyword" id="3883041">func</span>&nbsp;<span class="op" id="3883046">(</span><span class="ident" id="3883047">f</span>&nbsp;<span class="op" id="3883049">*</span><span class="ident" id="3883050"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3883054">)</span>&nbsp;<span class="ident" id="3883056">Position</span><span class="op" id="3883064">(</span><span class="ident" id="3883065">p</span>&nbsp;<span class="ident" id="3883067"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3883070">)</span>&nbsp;<span class="op" id="3883072">(</span><span class="ident" id="3883073">pos</span>&nbsp;<span class="ident" id="3883077"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3883085">)</span>&nbsp;<span class="op" id="3883087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883090">return</span>&nbsp;<span class="ident" id="3883097"><a href="/gostd/go/token/position.go.html#3883047">f</a></span><span class="op" id="3883098">.</span><span class="ident" id="3883099"><a href="/gostd/go/token/position.go.html#3882697">PositionFor</a></span><span class="op" id="3883110">(</span><span class="ident" id="3883111"><a href="/gostd/go/token/position.go.html#3883065">p</a></span><span class="op" id="3883112">,</span>&nbsp;<span class="builtintype" id="3883114">true</span><span class="op" id="3883118">)</span><br>
<span class="lineno"></span><span class="op" id="3883120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="3883123">//&nbsp;-----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3883204">//&nbsp;FileSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3883216">//&nbsp;A&nbsp;FileSet&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="3883263">//&nbsp;Methods&nbsp;of&nbsp;file&nbsp;sets&nbsp;are&nbsp;synchronized;&nbsp;multiple&nbsp;goroutines</span><br>
<span class="lineno">320</span><span class="comment" id="3883325">//&nbsp;may&nbsp;invoke&nbsp;them&nbsp;concurrently.</span><br>
<span class="lineno"></span><span class="comment" id="3883358">//</span><br>
<span class="lineno"></span><span class="keyword" id="3883361">type</span>&nbsp;<span class="ident" id="3883366">FileSet</span>&nbsp;<span class="keyword" id="3883374">struct</span>&nbsp;<span class="op" id="3883381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883384">mutex</span>&nbsp;<span class="ident" id="3883390"><a href="/gostd/go/token/position.go.html#3873700">sync</a></span><span class="op" id="3883394">.</span><span class="ident" id="3883395"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span>&nbsp;<span class="comment" id="3883403">//&nbsp;protects&nbsp;the&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883429">base</span>&nbsp;&nbsp;<span class="builtintype" id="3883435">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883448">//&nbsp;base&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;file</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883482">files</span>&nbsp;<span class="op" id="3883488">[</span><span class="op" id="3883489">]</span><span class="op" id="3883490">*</span><span class="ident" id="3883491"><a href="/gostd/go/token/position.go.html#3876396">File</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883501">//&nbsp;list&nbsp;of&nbsp;files&nbsp;in&nbsp;the&nbsp;order&nbsp;added&nbsp;to&nbsp;the&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883549">last</span>&nbsp;&nbsp;<span class="op" id="3883555">*</span><span class="ident" id="3883556"><a href="/gostd/go/token/position.go.html#3876396">File</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3883568">//&nbsp;cache&nbsp;of&nbsp;last&nbsp;file&nbsp;looked&nbsp;up</span><br>
<span class="lineno"></span><span class="op" id="3883600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3883603">//&nbsp;NewFileSet&nbsp;creates&nbsp;a&nbsp;new&nbsp;file&nbsp;set.</span><br>
<span class="lineno">330</span><span class="keyword" id="3883641">func</span>&nbsp;<span class="ident" id="3883646">NewFileSet</span><span class="op" id="3883656">(</span><span class="op" id="3883657">)</span>&nbsp;<span class="op" id="3883659">*</span><span class="ident" id="3883660"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span>&nbsp;<span class="op" id="3883668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883671">return</span>&nbsp;<span class="op" id="3883678">&amp;</span><span class="ident" id="3883679"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3883686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883690"><a href="/gostd/go/token/position.go.html#3883429">base</a></span><span class="op" id="3883694">:</span>&nbsp;<span class="num" id="3883696">1</span><span class="op" id="3883697">,</span>&nbsp;<span class="comment" id="3883699">//&nbsp;0&nbsp;==&nbsp;NoPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3883714">}</span><br>
<span class="lineno"></span><span class="op" id="3883716">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="3883719">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;minimum&nbsp;base&nbsp;offset&nbsp;that&nbsp;must&nbsp;be&nbsp;provided&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3883784">//&nbsp;AddFile&nbsp;when&nbsp;adding&nbsp;the&nbsp;next&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="3883822">//</span><br>
<span class="lineno"></span><span class="keyword" id="3883825">func</span>&nbsp;<span class="op" id="3883830">(</span><span class="ident" id="3883831">s</span>&nbsp;<span class="op" id="3883833">*</span><span class="ident" id="3883834"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3883841">)</span>&nbsp;<span class="ident" id="3883843">Base</span><span class="op" id="3883847">(</span><span class="op" id="3883848">)</span>&nbsp;<span class="builtintype" id="3883850">int</span>&nbsp;<span class="op" id="3883854">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883857"><a href="/gostd/go/token/position.go.html#3883831">s</a></span><span class="op" id="3883858">.</span><span class="ident" id="3883859"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3883864">.</span><span class="ident" id="3883865"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="3883870">(</span><span class="op" id="3883871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883874">b</span>&nbsp;<span class="op" id="3883876">:=</span>&nbsp;<span class="ident" id="3883879"><a href="/gostd/go/token/position.go.html#3883831">s</a></span><span class="op" id="3883880">.</span><span class="ident" id="3883881"><a href="/gostd/go/token/position.go.html#3883429">base</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3883887"><a href="/gostd/go/token/position.go.html#3883831">s</a></span><span class="op" id="3883888">.</span><span class="ident" id="3883889"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3883894">.</span><span class="ident" id="3883895"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3883902">(</span><span class="op" id="3883903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3883906">return</span>&nbsp;<span class="ident" id="3883913"><a href="/gostd/go/token/position.go.html#3883874">b</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="op" id="3883916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3883919">//&nbsp;AddFile&nbsp;adds&nbsp;a&nbsp;new&nbsp;file&nbsp;with&nbsp;a&nbsp;given&nbsp;filename,&nbsp;base&nbsp;offset,&nbsp;and&nbsp;file&nbsp;size</span><br>
<span class="lineno"></span><span class="comment" id="3883996">//&nbsp;to&nbsp;the&nbsp;file&nbsp;set&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;file.&nbsp;Multiple&nbsp;files&nbsp;may&nbsp;have&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="3884072">//&nbsp;name.&nbsp;The&nbsp;base&nbsp;offset&nbsp;must&nbsp;not&nbsp;be&nbsp;smaller&nbsp;than&nbsp;the&nbsp;FileSet&#39;s&nbsp;Base(),&nbsp;and</span><br>
<span class="lineno">350</span><span class="comment" id="3884148">//&nbsp;size&nbsp;must&nbsp;not&nbsp;be&nbsp;negative.&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;if&nbsp;a&nbsp;negative&nbsp;base&nbsp;is&nbsp;provided,</span><br>
<span class="lineno"></span><span class="comment" id="3884229">//&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;FileSet&#39;s&nbsp;Base()&nbsp;is&nbsp;used&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3884291">//</span><br>
<span class="lineno"></span><span class="comment" id="3884294">//&nbsp;Adding&nbsp;the&nbsp;file&nbsp;will&nbsp;set&nbsp;the&nbsp;file&nbsp;set&#39;s&nbsp;Base()&nbsp;value&nbsp;to&nbsp;base&nbsp;+&nbsp;size&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="3884369">//&nbsp;as&nbsp;the&nbsp;minimum&nbsp;base&nbsp;value&nbsp;for&nbsp;the&nbsp;next&nbsp;file.&nbsp;The&nbsp;following&nbsp;relationship</span><br>
<span class="lineno">355</span><span class="comment" id="3884444">//&nbsp;exists&nbsp;between&nbsp;a&nbsp;Pos&nbsp;value&nbsp;p&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;offset&nbsp;offs:</span><br>
<span class="lineno"></span><span class="comment" id="3884506">//</span><br>
<span class="lineno"></span><span class="comment" id="3884509">//&nbsp;&nbsp;&nbsp;&nbsp;int(p)&nbsp;=&nbsp;base&nbsp;+&nbsp;offs</span><br>
<span class="lineno"></span><span class="comment" id="3884533">//</span><br>
<span class="lineno"></span><span class="comment" id="3884536">//&nbsp;with&nbsp;offs&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;size]&nbsp;and&nbsp;thus&nbsp;p&nbsp;in&nbsp;the&nbsp;range&nbsp;[base,&nbsp;base+size].</span><br>
<span class="lineno">360</span><span class="comment" id="3884615">//&nbsp;For&nbsp;convenience,&nbsp;File.Pos&nbsp;may&nbsp;be&nbsp;used&nbsp;to&nbsp;create&nbsp;file-specific&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="3884689">//&nbsp;values&nbsp;from&nbsp;a&nbsp;file&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="3884719">//</span><br>
<span class="lineno"></span><span class="keyword" id="3884722">func</span>&nbsp;<span class="op" id="3884727">(</span><span class="ident" id="3884728">s</span>&nbsp;<span class="op" id="3884730">*</span><span class="ident" id="3884731"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3884738">)</span>&nbsp;<span class="ident" id="3884740">AddFile</span><span class="op" id="3884747">(</span><span class="ident" id="3884748">filename</span>&nbsp;<span class="builtintype" id="3884757">string</span><span class="op" id="3884763">,</span>&nbsp;<span class="ident" id="3884765">base</span><span class="op" id="3884769">,</span>&nbsp;<span class="ident" id="3884771">size</span>&nbsp;<span class="builtintype" id="3884776">int</span><span class="op" id="3884779">)</span>&nbsp;<span class="op" id="3884781">*</span><span class="ident" id="3884782"><a href="/gostd/go/token/position.go.html#3876396">File</a></span>&nbsp;<span class="op" id="3884787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884790"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3884791">.</span><span class="ident" id="3884792"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3884797">.</span><span class="ident" id="3884798"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3884802">(</span><span class="op" id="3884803">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884806">defer</span>&nbsp;<span class="ident" id="3884812"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3884813">.</span><span class="ident" id="3884814"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3884819">.</span><span class="ident" id="3884820"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3884826">(</span><span class="op" id="3884827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884830">if</span>&nbsp;<span class="ident" id="3884833"><a href="/gostd/go/token/position.go.html#3884765">base</a></span>&nbsp;<span class="op" id="3884838">&lt;</span>&nbsp;<span class="num" id="3884840">0</span>&nbsp;<span class="op" id="3884842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884846"><a href="/gostd/go/token/position.go.html#3884765">base</a></span>&nbsp;<span class="op" id="3884851">=</span>&nbsp;<span class="ident" id="3884853"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3884854">.</span><span class="ident" id="3884855"><a href="/gostd/go/token/position.go.html#3883429">base</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3884864">if</span>&nbsp;<span class="ident" id="3884867"><a href="/gostd/go/token/position.go.html#3884765">base</a></span>&nbsp;<span class="op" id="3884872">&lt;</span>&nbsp;<span class="ident" id="3884874"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3884875">.</span><span class="ident" id="3884876"><a href="/gostd/go/token/position.go.html#3883429">base</a></span>&nbsp;<span class="op" id="3884881">||</span>&nbsp;<span class="ident" id="3884884"><a href="/gostd/go/token/position.go.html#3884771">size</a></span>&nbsp;<span class="op" id="3884889">&lt;</span>&nbsp;<span class="num" id="3884891">0</span>&nbsp;<span class="op" id="3884893">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3884897">panic</span><span class="op" id="3884902">(</span><span class="string" id="3884903">&#34;illegal&nbsp;base&nbsp;or&nbsp;size&#34;</span><span class="op" id="3884925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3884928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3884931">//&nbsp;base&nbsp;&gt;=&nbsp;s.base&nbsp;&amp;&amp;&nbsp;size&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3884963">f</span>&nbsp;<span class="op" id="3884965">:=</span>&nbsp;<span class="op" id="3884968">&amp;</span><span class="ident" id="3884969"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3884973">{</span><span class="ident" id="3884974"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3884975">,</span>&nbsp;<span class="ident" id="3884977"><a href="/gostd/go/token/position.go.html#3884748">filename</a></span><span class="op" id="3884985">,</span>&nbsp;<span class="ident" id="3884987"><a href="/gostd/go/token/position.go.html#3884765">base</a></span><span class="op" id="3884991">,</span>&nbsp;<span class="ident" id="3884993"><a href="/gostd/go/token/position.go.html#3884771">size</a></span><span class="op" id="3884997">,</span>&nbsp;<span class="op" id="3884999">[</span><span class="op" id="3885000">]</span><span class="builtintype" id="3885001">int</span><span class="op" id="3885004">{</span><span class="num" id="3885005">0</span><span class="op" id="3885006">}</span><span class="op" id="3885007">,</span>&nbsp;<span class="builtintype" id="3885009">nil</span><span class="op" id="3885012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885015"><a href="/gostd/go/token/position.go.html#3884765">base</a></span>&nbsp;<span class="op" id="3885020">+=</span>&nbsp;<span class="ident" id="3885023"><a href="/gostd/go/token/position.go.html#3884771">size</a></span>&nbsp;<span class="op" id="3885028">+</span>&nbsp;<span class="num" id="3885030">1</span>&nbsp;<span class="comment" id="3885032">//&nbsp;+1&nbsp;because&nbsp;EOF&nbsp;also&nbsp;has&nbsp;a&nbsp;position</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885071">if</span>&nbsp;<span class="ident" id="3885074"><a href="/gostd/go/token/position.go.html#3884765">base</a></span>&nbsp;<span class="op" id="3885079">&lt;</span>&nbsp;<span class="num" id="3885081">0</span>&nbsp;<span class="op" id="3885083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3885087">panic</span><span class="op" id="3885092">(</span><span class="string" id="3885093">&#34;token.Pos&nbsp;offset&nbsp;overflow&nbsp;(&gt;&nbsp;2G&nbsp;of&nbsp;source&nbsp;code&nbsp;in&nbsp;file&nbsp;set)&#34;</span><span class="op" id="3885154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3885157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3885160">//&nbsp;add&nbsp;the&nbsp;file&nbsp;to&nbsp;the&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885193"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3885194">.</span><span class="ident" id="3885195"><a href="/gostd/go/token/position.go.html#3883429">base</a></span>&nbsp;<span class="op" id="3885200">=</span>&nbsp;<span class="ident" id="3885202"><a href="/gostd/go/token/position.go.html#3884765">base</a></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885208"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3885209">.</span><span class="ident" id="3885210"><a href="/gostd/go/token/position.go.html#3883482">files</a></span>&nbsp;<span class="op" id="3885216">=</span>&nbsp;<span class="builtinfunc" id="3885218">append</span><span class="op" id="3885224">(</span><span class="ident" id="3885225"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3885226">.</span><span class="ident" id="3885227"><a href="/gostd/go/token/position.go.html#3883482">files</a></span><span class="op" id="3885232">,</span>&nbsp;<span class="ident" id="3885234"><a href="/gostd/go/token/position.go.html#3884963">f</a></span><span class="op" id="3885235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885238"><a href="/gostd/go/token/position.go.html#3884728">s</a></span><span class="op" id="3885239">.</span><span class="ident" id="3885240"><a href="/gostd/go/token/position.go.html#3883549">last</a></span>&nbsp;<span class="op" id="3885245">=</span>&nbsp;<span class="ident" id="3885247"><a href="/gostd/go/token/position.go.html#3884963">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885250">return</span>&nbsp;<span class="ident" id="3885257"><a href="/gostd/go/token/position.go.html#3884963">f</a></span><br>
<span class="lineno"></span><span class="op" id="3885259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="3885262">//&nbsp;Iterate&nbsp;calls&nbsp;f&nbsp;for&nbsp;the&nbsp;files&nbsp;in&nbsp;the&nbsp;file&nbsp;set&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;were&nbsp;added</span><br>
<span class="lineno"></span><span class="comment" id="3885340">//&nbsp;until&nbsp;f&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="3885366">//</span><br>
<span class="lineno"></span><span class="keyword" id="3885369">func</span>&nbsp;<span class="op" id="3885374">(</span><span class="ident" id="3885375">s</span>&nbsp;<span class="op" id="3885377">*</span><span class="ident" id="3885378"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3885385">)</span>&nbsp;<span class="ident" id="3885387">Iterate</span><span class="op" id="3885394">(</span><span class="ident" id="3885395">f</span>&nbsp;<span class="keyword" id="3885397">func</span><span class="op" id="3885401">(</span><span class="op" id="3885402">*</span><span class="ident" id="3885403"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3885407">)</span>&nbsp;<span class="builtintype" id="3885409">bool</span><span class="op" id="3885413">)</span>&nbsp;<span class="op" id="3885415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885418">for</span>&nbsp;<span class="ident" id="3885422">i</span>&nbsp;<span class="op" id="3885424">:=</span>&nbsp;<span class="num" id="3885427">0</span><span class="op" id="3885428">;</span>&nbsp;<span class="op" id="3885430">;</span>&nbsp;<span class="ident" id="3885432"><a href="/gostd/go/token/position.go.html#3885422">i</a></span><span class="op" id="3885433">++</span>&nbsp;<span class="op" id="3885436">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885440">var</span>&nbsp;<span class="ident" id="3885444">file</span>&nbsp;<span class="op" id="3885449">*</span><span class="ident" id="3885450"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885457"><a href="/gostd/go/token/position.go.html#3885375">s</a></span><span class="op" id="3885458">.</span><span class="ident" id="3885459"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3885464">.</span><span class="ident" id="3885465"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="3885470">(</span><span class="op" id="3885471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885475">if</span>&nbsp;<span class="ident" id="3885478"><a href="/gostd/go/token/position.go.html#3885422">i</a></span>&nbsp;<span class="op" id="3885480">&lt;</span>&nbsp;<span class="builtinfunc" id="3885482">len</span><span class="op" id="3885485">(</span><span class="ident" id="3885486"><a href="/gostd/go/token/position.go.html#3885375">s</a></span><span class="op" id="3885487">.</span><span class="ident" id="3885488"><a href="/gostd/go/token/position.go.html#3883482">files</a></span><span class="op" id="3885493">)</span>&nbsp;<span class="op" id="3885495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885500"><a href="/gostd/go/token/position.go.html#3885444">file</a></span>&nbsp;<span class="op" id="3885505">=</span>&nbsp;<span class="ident" id="3885507"><a href="/gostd/go/token/position.go.html#3885375">s</a></span><span class="op" id="3885508">.</span><span class="ident" id="3885509"><a href="/gostd/go/token/position.go.html#3883482">files</a></span><span class="op" id="3885514">[</span><span class="ident" id="3885515"><a href="/gostd/go/token/position.go.html#3885422">i</a></span><span class="op" id="3885516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3885520">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885524"><a href="/gostd/go/token/position.go.html#3885375">s</a></span><span class="op" id="3885525">.</span><span class="ident" id="3885526"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3885531">.</span><span class="ident" id="3885532"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3885539">(</span><span class="op" id="3885540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885544">if</span>&nbsp;<span class="ident" id="3885547"><a href="/gostd/go/token/position.go.html#3885444">file</a></span>&nbsp;<span class="op" id="3885552">==</span>&nbsp;<span class="builtintype" id="3885555">nil</span>&nbsp;<span class="op" id="3885559">||</span>&nbsp;<span class="op" id="3885562">!</span><span class="ident" id="3885563"><a href="/gostd/go/token/position.go.html#3885395">f</a></span><span class="op" id="3885564">(</span><span class="ident" id="3885565"><a href="/gostd/go/token/position.go.html#3885444">file</a></span><span class="op" id="3885569">)</span>&nbsp;<span class="op" id="3885571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885576">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3885584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3885587">}</span><br>
<span class="lineno">400</span><span class="op" id="3885589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3885592">func</span>&nbsp;<span class="ident" id="3885597">searchFiles</span><span class="op" id="3885608">(</span><span class="ident" id="3885609">a</span>&nbsp;<span class="op" id="3885611">[</span><span class="op" id="3885612">]</span><span class="op" id="3885613">*</span><span class="ident" id="3885614"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3885618">,</span>&nbsp;<span class="ident" id="3885620">x</span>&nbsp;<span class="builtintype" id="3885622">int</span><span class="op" id="3885625">)</span>&nbsp;<span class="builtintype" id="3885627">int</span>&nbsp;<span class="op" id="3885631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885634">return</span>&nbsp;<span class="ident" id="3885641"><a href="/gostd/go/token/position.go.html#3873692">sort</a></span><span class="op" id="3885645">.</span><span class="ident" id="3885646"><a href="/gostd/sort/search.go.html#2008959">Search</a></span><span class="op" id="3885652">(</span><span class="builtinfunc" id="3885653">len</span><span class="op" id="3885656">(</span><span class="ident" id="3885657"><a href="/gostd/go/token/position.go.html#3885609">a</a></span><span class="op" id="3885658">)</span><span class="op" id="3885659">,</span>&nbsp;<span class="keyword" id="3885661">func</span><span class="op" id="3885665">(</span><span class="ident" id="3885666">i</span>&nbsp;<span class="builtintype" id="3885668">int</span><span class="op" id="3885671">)</span>&nbsp;<span class="builtintype" id="3885673">bool</span>&nbsp;<span class="op" id="3885678">{</span>&nbsp;<span class="keyword" id="3885680">return</span>&nbsp;<span class="ident" id="3885687"><a href="/gostd/go/token/position.go.html#3885609">a</a></span><span class="op" id="3885688">[</span><span class="ident" id="3885689"><a href="/gostd/go/token/position.go.html#3885666">i</a></span><span class="op" id="3885690">]</span><span class="op" id="3885691">.</span><span class="ident" id="3885692"><a href="/gostd/go/token/position.go.html#3876475">base</a></span>&nbsp;<span class="op" id="3885697">&gt;</span>&nbsp;<span class="ident" id="3885699"><a href="/gostd/go/token/position.go.html#3885620">x</a></span>&nbsp;<span class="op" id="3885701">}</span><span class="op" id="3885702">)</span>&nbsp;<span class="op" id="3885704">-</span>&nbsp;<span class="num" id="3885706">1</span><br>
<span class="lineno"></span><span class="op" id="3885708">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3885711">func</span>&nbsp;<span class="op" id="3885716">(</span><span class="ident" id="3885717">s</span>&nbsp;<span class="op" id="3885719">*</span><span class="ident" id="3885720"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3885727">)</span>&nbsp;<span class="ident" id="3885729">file</span><span class="op" id="3885733">(</span><span class="ident" id="3885734">p</span>&nbsp;<span class="ident" id="3885736"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3885739">)</span>&nbsp;<span class="op" id="3885741">*</span><span class="ident" id="3885742"><a href="/gostd/go/token/position.go.html#3876396">File</a></span>&nbsp;<span class="op" id="3885747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885750"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3885751">.</span><span class="ident" id="3885752"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3885757">.</span><span class="ident" id="3885758"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="3885763">(</span><span class="op" id="3885764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3885767">//&nbsp;common&nbsp;case:&nbsp;p&nbsp;is&nbsp;in&nbsp;last&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885802">if</span>&nbsp;<span class="ident" id="3885805">f</span>&nbsp;<span class="op" id="3885807">:=</span>&nbsp;<span class="ident" id="3885810"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3885811">.</span><span class="ident" id="3885812"><a href="/gostd/go/token/position.go.html#3883549">last</a></span><span class="op" id="3885816">;</span>&nbsp;<span class="ident" id="3885818"><a href="/gostd/go/token/position.go.html#3885805">f</a></span>&nbsp;<span class="op" id="3885820">!=</span>&nbsp;<span class="builtintype" id="3885823">nil</span>&nbsp;<span class="op" id="3885827">&amp;&amp;</span>&nbsp;<span class="ident" id="3885830"><a href="/gostd/go/token/position.go.html#3885805">f</a></span><span class="op" id="3885831">.</span><span class="ident" id="3885832"><a href="/gostd/go/token/position.go.html#3876475">base</a></span>&nbsp;<span class="op" id="3885837">&lt;=</span>&nbsp;<span class="builtintype" id="3885840">int</span><span class="op" id="3885843">(</span><span class="ident" id="3885844"><a href="/gostd/go/token/position.go.html#3885734">p</a></span><span class="op" id="3885845">)</span>&nbsp;<span class="op" id="3885847">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3885850">int</span><span class="op" id="3885853">(</span><span class="ident" id="3885854"><a href="/gostd/go/token/position.go.html#3885734">p</a></span><span class="op" id="3885855">)</span>&nbsp;<span class="op" id="3885857">&lt;=</span>&nbsp;<span class="ident" id="3885860"><a href="/gostd/go/token/position.go.html#3885805">f</a></span><span class="op" id="3885861">.</span><span class="ident" id="3885862"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><span class="op" id="3885866">+</span><span class="ident" id="3885867"><a href="/gostd/go/token/position.go.html#3885805">f</a></span><span class="op" id="3885868">.</span><span class="ident" id="3885869"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3885874">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3885878"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3885879">.</span><span class="ident" id="3885880"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3885885">.</span><span class="ident" id="3885886"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3885893">(</span><span class="op" id="3885894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885898">return</span>&nbsp;<span class="ident" id="3885905"><a href="/gostd/go/token/position.go.html#3885805">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3885908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3885911">//&nbsp;p&nbsp;is&nbsp;not&nbsp;in&nbsp;last&nbsp;file&nbsp;-&nbsp;search&nbsp;all&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3885956">if</span>&nbsp;<span class="ident" id="3885959">i</span>&nbsp;<span class="op" id="3885961">:=</span>&nbsp;<span class="ident" id="3885964"><a href="/gostd/go/token/position.go.html#3885597">searchFiles</a></span><span class="op" id="3885975">(</span><span class="ident" id="3885976"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3885977">.</span><span class="ident" id="3885978"><a href="/gostd/go/token/position.go.html#3883482">files</a></span><span class="op" id="3885983">,</span>&nbsp;<span class="builtintype" id="3885985">int</span><span class="op" id="3885988">(</span><span class="ident" id="3885989"><a href="/gostd/go/token/position.go.html#3885734">p</a></span><span class="op" id="3885990">)</span><span class="op" id="3885991">)</span><span class="op" id="3885992">;</span>&nbsp;<span class="ident" id="3885994"><a href="/gostd/go/token/position.go.html#3885959">i</a></span>&nbsp;<span class="op" id="3885996">&gt;=</span>&nbsp;<span class="num" id="3885999">0</span>&nbsp;<span class="op" id="3886001">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886005">f</span>&nbsp;<span class="op" id="3886007">:=</span>&nbsp;<span class="ident" id="3886010"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886011">.</span><span class="ident" id="3886012"><a href="/gostd/go/token/position.go.html#3883482">files</a></span><span class="op" id="3886017">[</span><span class="ident" id="3886018"><a href="/gostd/go/token/position.go.html#3885959">i</a></span><span class="op" id="3886019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3886023">//&nbsp;f.base&nbsp;&lt;=&nbsp;int(p)&nbsp;by&nbsp;definition&nbsp;of&nbsp;searchFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886074">if</span>&nbsp;<span class="builtintype" id="3886077">int</span><span class="op" id="3886080">(</span><span class="ident" id="3886081"><a href="/gostd/go/token/position.go.html#3885734">p</a></span><span class="op" id="3886082">)</span>&nbsp;<span class="op" id="3886084">&lt;=</span>&nbsp;<span class="ident" id="3886087"><a href="/gostd/go/token/position.go.html#3886005">f</a></span><span class="op" id="3886088">.</span><span class="ident" id="3886089"><a href="/gostd/go/token/position.go.html#3876475">base</a></span><span class="op" id="3886093">+</span><span class="ident" id="3886094"><a href="/gostd/go/token/position.go.html#3886005">f</a></span><span class="op" id="3886095">.</span><span class="ident" id="3886096"><a href="/gostd/go/token/position.go.html#3876543">size</a></span>&nbsp;<span class="op" id="3886101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886106"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886107">.</span><span class="ident" id="3886108"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3886113">.</span><span class="ident" id="3886114"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3886121">(</span><span class="op" id="3886122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886127"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886128">.</span><span class="ident" id="3886129"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3886134">.</span><span class="ident" id="3886135"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="3886139">(</span><span class="op" id="3886140">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886145"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886146">.</span><span class="ident" id="3886147"><a href="/gostd/go/token/position.go.html#3883549">last</a></span>&nbsp;<span class="op" id="3886152">=</span>&nbsp;<span class="ident" id="3886154"><a href="/gostd/go/token/position.go.html#3886005">f</a></span>&nbsp;<span class="comment" id="3886156">//&nbsp;race&nbsp;is&nbsp;ok&nbsp;-&nbsp;s.last&nbsp;is&nbsp;only&nbsp;a&nbsp;cache</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886198"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886199">.</span><span class="ident" id="3886200"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3886205">.</span><span class="ident" id="3886206"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="3886212">(</span><span class="op" id="3886213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886218">return</span>&nbsp;<span class="ident" id="3886225"><a href="/gostd/go/token/position.go.html#3886005">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3886229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3886232">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886235"><a href="/gostd/go/token/position.go.html#3885717">s</a></span><span class="op" id="3886236">.</span><span class="ident" id="3886237"><a href="/gostd/go/token/position.go.html#3883384">mutex</a></span><span class="op" id="3886242">.</span><span class="ident" id="3886243"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="3886250">(</span><span class="op" id="3886251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886254">return</span>&nbsp;<span class="builtintype" id="3886261">nil</span><br>
<span class="lineno"></span><span class="op" id="3886265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3886268">//&nbsp;File&nbsp;returns&nbsp;the&nbsp;file&nbsp;that&nbsp;contains&nbsp;the&nbsp;position&nbsp;p.</span><br>
<span class="lineno">430</span><span class="comment" id="3886323">//&nbsp;If&nbsp;no&nbsp;such&nbsp;file&nbsp;is&nbsp;found&nbsp;(for&nbsp;instance&nbsp;for&nbsp;p&nbsp;==&nbsp;NoPos),</span><br>
<span class="lineno"></span><span class="comment" id="3886382">//&nbsp;the&nbsp;result&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3886404">//</span><br>
<span class="lineno"></span><span class="keyword" id="3886407">func</span>&nbsp;<span class="op" id="3886412">(</span><span class="ident" id="3886413">s</span>&nbsp;<span class="op" id="3886415">*</span><span class="ident" id="3886416"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3886423">)</span>&nbsp;<span class="ident" id="3886425">File</span><span class="op" id="3886429">(</span><span class="ident" id="3886430">p</span>&nbsp;<span class="ident" id="3886432"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3886435">)</span>&nbsp;<span class="op" id="3886437">(</span><span class="ident" id="3886438">f</span>&nbsp;<span class="op" id="3886440">*</span><span class="ident" id="3886441"><a href="/gostd/go/token/position.go.html#3876396">File</a></span><span class="op" id="3886445">)</span>&nbsp;<span class="op" id="3886447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886450">if</span>&nbsp;<span class="ident" id="3886453"><a href="/gostd/go/token/position.go.html#3886430">p</a></span>&nbsp;<span class="op" id="3886455">!=</span>&nbsp;<span class="ident" id="3886458"><a href="/gostd/go/token/position.go.html#3876073">NoPos</a></span>&nbsp;<span class="op" id="3886464">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886468"><a href="/gostd/go/token/position.go.html#3886438">f</a></span>&nbsp;<span class="op" id="3886470">=</span>&nbsp;<span class="ident" id="3886472"><a href="/gostd/go/token/position.go.html#3886413">s</a></span><span class="op" id="3886473">.</span><span class="ident" id="3886474"><a href="/gostd/go/token/position.go.html#3885729">file</a></span><span class="op" id="3886478">(</span><span class="ident" id="3886479"><a href="/gostd/go/token/position.go.html#3886430">p</a></span><span class="op" id="3886480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3886483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886486">return</span><br>
<span class="lineno"></span><span class="op" id="3886493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3886496">//&nbsp;PositionFor&nbsp;converts&nbsp;a&nbsp;Pos&nbsp;p&nbsp;in&nbsp;the&nbsp;fileset&nbsp;into&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3886566">//&nbsp;If&nbsp;adjusted&nbsp;is&nbsp;set,&nbsp;the&nbsp;position&nbsp;may&nbsp;be&nbsp;adjusted&nbsp;by&nbsp;position-altering</span><br>
<span class="lineno"></span><span class="comment" id="3886639">//&nbsp;//line&nbsp;comments;&nbsp;otherwise&nbsp;those&nbsp;comments&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3886697">//&nbsp;p&nbsp;must&nbsp;be&nbsp;a&nbsp;Pos&nbsp;value&nbsp;in&nbsp;s&nbsp;or&nbsp;NoPos.</span><br>
<span class="lineno"></span><span class="comment" id="3886737">//</span><br>
<span class="lineno">445</span><span class="keyword" id="3886740">func</span>&nbsp;<span class="op" id="3886745">(</span><span class="ident" id="3886746">s</span>&nbsp;<span class="op" id="3886748">*</span><span class="ident" id="3886749"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3886756">)</span>&nbsp;<span class="ident" id="3886758">PositionFor</span><span class="op" id="3886769">(</span><span class="ident" id="3886770">p</span>&nbsp;<span class="ident" id="3886772"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3886775">,</span>&nbsp;<span class="ident" id="3886777">adjusted</span>&nbsp;<span class="builtintype" id="3886786">bool</span><span class="op" id="3886790">)</span>&nbsp;<span class="op" id="3886792">(</span><span class="ident" id="3886793">pos</span>&nbsp;<span class="ident" id="3886797"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3886805">)</span>&nbsp;<span class="op" id="3886807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886810">if</span>&nbsp;<span class="ident" id="3886813"><a href="/gostd/go/token/position.go.html#3886770">p</a></span>&nbsp;<span class="op" id="3886815">!=</span>&nbsp;<span class="ident" id="3886818"><a href="/gostd/go/token/position.go.html#3876073">NoPos</a></span>&nbsp;<span class="op" id="3886824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886828">if</span>&nbsp;<span class="ident" id="3886831">f</span>&nbsp;<span class="op" id="3886833">:=</span>&nbsp;<span class="ident" id="3886836"><a href="/gostd/go/token/position.go.html#3886746">s</a></span><span class="op" id="3886837">.</span><span class="ident" id="3886838"><a href="/gostd/go/token/position.go.html#3885729">file</a></span><span class="op" id="3886842">(</span><span class="ident" id="3886843"><a href="/gostd/go/token/position.go.html#3886770">p</a></span><span class="op" id="3886844">)</span><span class="op" id="3886845">;</span>&nbsp;<span class="ident" id="3886847"><a href="/gostd/go/token/position.go.html#3886831">f</a></span>&nbsp;<span class="op" id="3886849">!=</span>&nbsp;<span class="builtintype" id="3886852">nil</span>&nbsp;<span class="op" id="3886856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3886861"><a href="/gostd/go/token/position.go.html#3886793">pos</a></span>&nbsp;<span class="op" id="3886865">=</span>&nbsp;<span class="ident" id="3886867"><a href="/gostd/go/token/position.go.html#3886831">f</a></span><span class="op" id="3886868">.</span><span class="ident" id="3886869"><a href="/gostd/go/token/position.go.html#3882263">position</a></span><span class="op" id="3886877">(</span><span class="ident" id="3886878"><a href="/gostd/go/token/position.go.html#3886770">p</a></span><span class="op" id="3886879">,</span>&nbsp;<span class="ident" id="3886881"><a href="/gostd/go/token/position.go.html#3886777">adjusted</a></span><span class="op" id="3886889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3886893">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3886896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3886899">return</span><br>
<span class="lineno"></span><span class="op" id="3886906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3886909">//&nbsp;Position&nbsp;converts&nbsp;a&nbsp;Pos&nbsp;p&nbsp;in&nbsp;the&nbsp;fileset&nbsp;into&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno">455</span><span class="comment" id="3886976">//&nbsp;Calling&nbsp;s.Position(p)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;s.PositionFor(p,&nbsp;true).</span><br>
<span class="lineno"></span><span class="comment" id="3887050">//</span><br>
<span class="lineno"></span><span class="keyword" id="3887053">func</span>&nbsp;<span class="op" id="3887058">(</span><span class="ident" id="3887059">s</span>&nbsp;<span class="op" id="3887061">*</span><span class="ident" id="3887062"><a href="/gostd/go/token/position.go.html#3883366">FileSet</a></span><span class="op" id="3887069">)</span>&nbsp;<span class="ident" id="3887071">Position</span><span class="op" id="3887079">(</span><span class="ident" id="3887080">p</span>&nbsp;<span class="ident" id="3887082"><a href="/gostd/go/token/position.go.html#3875795">Pos</a></span><span class="op" id="3887085">)</span>&nbsp;<span class="op" id="3887087">(</span><span class="ident" id="3887088">pos</span>&nbsp;<span class="ident" id="3887092"><a href="/gostd/go/token/position.go.html#3873964">Position</a></span><span class="op" id="3887100">)</span>&nbsp;<span class="op" id="3887102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3887105">return</span>&nbsp;<span class="ident" id="3887112"><a href="/gostd/go/token/position.go.html#3887059">s</a></span><span class="op" id="3887113">.</span><span class="ident" id="3887114"><a href="/gostd/go/token/position.go.html#3886758">PositionFor</a></span><span class="op" id="3887125">(</span><span class="ident" id="3887126"><a href="/gostd/go/token/position.go.html#3887080">p</a></span><span class="op" id="3887127">,</span>&nbsp;<span class="builtintype" id="3887129">true</span><span class="op" id="3887133">)</span><br>
<span class="lineno"></span><span class="op" id="3887135">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="comment" id="3887138">//&nbsp;-----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="3887219">//&nbsp;Helper&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3887240">func</span>&nbsp;<span class="ident" id="3887245">searchInts</span><span class="op" id="3887255">(</span><span class="ident" id="3887256">a</span>&nbsp;<span class="op" id="3887258">[</span><span class="op" id="3887259">]</span><span class="builtintype" id="3887260">int</span><span class="op" id="3887263">,</span>&nbsp;<span class="ident" id="3887265">x</span>&nbsp;<span class="builtintype" id="3887267">int</span><span class="op" id="3887270">)</span>&nbsp;<span class="builtintype" id="3887272">int</span>&nbsp;<span class="op" id="3887276">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887279">//&nbsp;This&nbsp;function&nbsp;body&nbsp;is&nbsp;a&nbsp;manually&nbsp;inlined&nbsp;version&nbsp;of:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887336">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887340">//&nbsp;&nbsp;&nbsp;return&nbsp;sort.Search(len(a),&nbsp;func(i&nbsp;int)&nbsp;bool&nbsp;{&nbsp;return&nbsp;a[i]&nbsp;&gt;&nbsp;x&nbsp;})&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887415">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887419">//&nbsp;With&nbsp;better&nbsp;compiler&nbsp;optimizations,&nbsp;this&nbsp;may&nbsp;not&nbsp;be&nbsp;needed&nbsp;in&nbsp;the</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887489">//&nbsp;future,&nbsp;but&nbsp;at&nbsp;the&nbsp;moment&nbsp;this&nbsp;change&nbsp;improves&nbsp;the&nbsp;go/printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887555">//&nbsp;benchmark&nbsp;performance&nbsp;by&nbsp;~30%.&nbsp;This&nbsp;has&nbsp;a&nbsp;direct&nbsp;impact&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887622">//&nbsp;speed&nbsp;of&nbsp;gofmt&nbsp;and&nbsp;thus&nbsp;seems&nbsp;worthwhile&nbsp;(2011-04-29).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887681">//&nbsp;TODO(gri):&nbsp;Remove&nbsp;this&nbsp;when&nbsp;compilers&nbsp;have&nbsp;caught&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3887739">i</span><span class="op" id="3887740">,</span>&nbsp;<span class="ident" id="3887742">j</span>&nbsp;<span class="op" id="3887744">:=</span>&nbsp;<span class="num" id="3887747">0</span><span class="op" id="3887748">,</span>&nbsp;<span class="builtinfunc" id="3887750">len</span><span class="op" id="3887753">(</span><span class="ident" id="3887754"><a href="/gostd/go/token/position.go.html#3887256">a</a></span><span class="op" id="3887755">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3887758">for</span>&nbsp;<span class="ident" id="3887762"><a href="/gostd/go/token/position.go.html#3887739">i</a></span>&nbsp;<span class="op" id="3887764">&lt;</span>&nbsp;<span class="ident" id="3887766"><a href="/gostd/go/token/position.go.html#3887742">j</a></span>&nbsp;<span class="op" id="3887768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3887772">h</span>&nbsp;<span class="op" id="3887774">:=</span>&nbsp;<span class="ident" id="3887777"><a href="/gostd/go/token/position.go.html#3887739">i</a></span>&nbsp;<span class="op" id="3887779">+</span>&nbsp;<span class="op" id="3887781">(</span><span class="ident" id="3887782"><a href="/gostd/go/token/position.go.html#3887742">j</a></span><span class="op" id="3887783">-</span><span class="ident" id="3887784"><a href="/gostd/go/token/position.go.html#3887739">i</a></span><span class="op" id="3887785">)</span><span class="op" id="3887786">/</span><span class="num" id="3887787">2</span>&nbsp;<span class="comment" id="3887789">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3887826">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3887843">if</span>&nbsp;<span class="ident" id="3887846"><a href="/gostd/go/token/position.go.html#3887256">a</a></span><span class="op" id="3887847">[</span><span class="ident" id="3887848"><a href="/gostd/go/token/position.go.html#3887772">h</a></span><span class="op" id="3887849">]</span>&nbsp;<span class="op" id="3887851">&lt;=</span>&nbsp;<span class="ident" id="3887854"><a href="/gostd/go/token/position.go.html#3887265">x</a></span>&nbsp;<span class="op" id="3887856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3887861"><a href="/gostd/go/token/position.go.html#3887739">i</a></span>&nbsp;<span class="op" id="3887863">=</span>&nbsp;<span class="ident" id="3887865"><a href="/gostd/go/token/position.go.html#3887772">h</a></span>&nbsp;<span class="op" id="3887867">+</span>&nbsp;<span class="num" id="3887869">1</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3887873">}</span>&nbsp;<span class="keyword" id="3887875">else</span>&nbsp;<span class="op" id="3887880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3887885"><a href="/gostd/go/token/position.go.html#3887742">j</a></span>&nbsp;<span class="op" id="3887887">=</span>&nbsp;<span class="ident" id="3887889"><a href="/gostd/go/token/position.go.html#3887772">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3887893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3887896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3887899">return</span>&nbsp;<span class="ident" id="3887906"><a href="/gostd/go/token/position.go.html#3887739">i</a></span>&nbsp;<span class="op" id="3887908">-</span>&nbsp;<span class="num" id="3887910">1</span><br>
<span class="lineno">485</span><span class="op" id="3887912">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
