<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2284220">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2284275">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2284329">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2284380">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2284403">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2284449">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2284487">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2284552">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2284609">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2284654">package</span>&nbsp;<span class="ident" id="2284662">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2284671">import</span>&nbsp;<span class="string" id="2284678">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2284688">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2284707">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2284775">func</span>&nbsp;<span class="ident" id="2284780">Open</span><span class="op" id="2284784">(</span><span class="ident" id="2284785">path</span>&nbsp;<span class="builtintype" id="2284790">string</span><span class="op" id="2284796">,</span>&nbsp;<span class="ident" id="2284798">mode</span>&nbsp;<span class="builtintype" id="2284803">int</span><span class="op" id="2284806">,</span>&nbsp;<span class="ident" id="2284808">perm</span>&nbsp;<span class="builtintype" id="2284813">uint32</span><span class="op" id="2284819">)</span>&nbsp;<span class="op" id="2284821">(</span><span class="ident" id="2284822">fd</span>&nbsp;<span class="builtintype" id="2284825">int</span><span class="op" id="2284828">,</span>&nbsp;<span class="ident" id="2284830">err</span>&nbsp;<span class="builtintype" id="2284834">error</span><span class="op" id="2284839">)</span>&nbsp;<span class="op" id="2284841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284844">return</span>&nbsp;<span class="ident" id="2284851">open</span><span class="op" id="2284855">(</span><span class="ident" id="2284856">path</span><span class="op" id="2284860">,</span>&nbsp;<span class="ident" id="2284862">mode</span><span class="op" id="2284866">|</span><span class="ident" id="2284867">O_LARGEFILE</span><span class="op" id="2284878">,</span>&nbsp;<span class="ident" id="2284880">perm</span><span class="op" id="2284884">)</span><br>
<span class="lineno"></span><span class="op" id="2284886">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2284889">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2284971">func</span>&nbsp;<span class="ident" id="2284976">Openat</span><span class="op" id="2284982">(</span><span class="ident" id="2284983">dirfd</span>&nbsp;<span class="builtintype" id="2284989">int</span><span class="op" id="2284992">,</span>&nbsp;<span class="ident" id="2284994">path</span>&nbsp;<span class="builtintype" id="2284999">string</span><span class="op" id="2285005">,</span>&nbsp;<span class="ident" id="2285007">flags</span>&nbsp;<span class="builtintype" id="2285013">int</span><span class="op" id="2285016">,</span>&nbsp;<span class="ident" id="2285018">mode</span>&nbsp;<span class="builtintype" id="2285023">uint32</span><span class="op" id="2285029">)</span>&nbsp;<span class="op" id="2285031">(</span><span class="ident" id="2285032">fd</span>&nbsp;<span class="builtintype" id="2285035">int</span><span class="op" id="2285038">,</span>&nbsp;<span class="ident" id="2285040">err</span>&nbsp;<span class="builtintype" id="2285044">error</span><span class="op" id="2285049">)</span>&nbsp;<span class="op" id="2285051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285054">return</span>&nbsp;<span class="ident" id="2285061">openat</span><span class="op" id="2285067">(</span><span class="ident" id="2285068">dirfd</span><span class="op" id="2285073">,</span>&nbsp;<span class="ident" id="2285075">path</span><span class="op" id="2285079">,</span>&nbsp;<span class="ident" id="2285081">flags</span><span class="op" id="2285086">|</span><span class="ident" id="2285087">O_LARGEFILE</span><span class="op" id="2285098">,</span>&nbsp;<span class="ident" id="2285100">mode</span><span class="op" id="2285104">)</span><br>
<span class="lineno">30</span><span class="op" id="2285106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285109">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2285149">func</span>&nbsp;<span class="ident" id="2285154">Pipe</span><span class="op" id="2285158">(</span><span class="ident" id="2285159">p</span>&nbsp;<span class="op" id="2285161">[</span><span class="op" id="2285162">]</span><span class="builtintype" id="2285163">int</span><span class="op" id="2285166">)</span>&nbsp;<span class="op" id="2285168">(</span><span class="ident" id="2285169">err</span>&nbsp;<span class="builtintype" id="2285173">error</span><span class="op" id="2285178">)</span>&nbsp;<span class="op" id="2285180">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285183">if</span>&nbsp;<span class="builtinfunc" id="2285186">len</span><span class="op" id="2285189">(</span><span class="ident" id="2285190">p</span><span class="op" id="2285191">)</span>&nbsp;<span class="op" id="2285193">!=</span>&nbsp;<span class="num" id="2285196">2</span>&nbsp;<span class="op" id="2285198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285202">return</span>&nbsp;<span class="ident" id="2285209">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285220">var</span>&nbsp;<span class="ident" id="2285224">pp</span>&nbsp;<span class="op" id="2285227">[</span><span class="num" id="2285228">2</span><span class="op" id="2285229">]</span><span class="ident" id="2285230">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285238">err</span>&nbsp;<span class="op" id="2285242">=</span>&nbsp;<span class="ident" id="2285244">pipe</span><span class="op" id="2285248">(</span><span class="op" id="2285249">&amp;</span><span class="ident" id="2285250">pp</span><span class="op" id="2285252">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285255">p</span><span class="op" id="2285256">[</span><span class="num" id="2285257">0</span><span class="op" id="2285258">]</span>&nbsp;<span class="op" id="2285260">=</span>&nbsp;<span class="builtintype" id="2285262">int</span><span class="op" id="2285265">(</span><span class="ident" id="2285266">pp</span><span class="op" id="2285268">[</span><span class="num" id="2285269">0</span><span class="op" id="2285270">]</span><span class="op" id="2285271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285274">p</span><span class="op" id="2285275">[</span><span class="num" id="2285276">1</span><span class="op" id="2285277">]</span>&nbsp;<span class="op" id="2285279">=</span>&nbsp;<span class="builtintype" id="2285281">int</span><span class="op" id="2285284">(</span><span class="ident" id="2285285">pp</span><span class="op" id="2285287">[</span><span class="num" id="2285288">1</span><span class="op" id="2285289">]</span><span class="op" id="2285290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285293">return</span><br>
<span class="lineno"></span><span class="op" id="2285300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2285303">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2285355">func</span>&nbsp;<span class="ident" id="2285360">Pipe2</span><span class="op" id="2285365">(</span><span class="ident" id="2285366">p</span>&nbsp;<span class="op" id="2285368">[</span><span class="op" id="2285369">]</span><span class="builtintype" id="2285370">int</span><span class="op" id="2285373">,</span>&nbsp;<span class="ident" id="2285375">flags</span>&nbsp;<span class="builtintype" id="2285381">int</span><span class="op" id="2285384">)</span>&nbsp;<span class="op" id="2285386">(</span><span class="ident" id="2285387">err</span>&nbsp;<span class="builtintype" id="2285391">error</span><span class="op" id="2285396">)</span>&nbsp;<span class="op" id="2285398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285401">if</span>&nbsp;<span class="builtinfunc" id="2285404">len</span><span class="op" id="2285407">(</span><span class="ident" id="2285408">p</span><span class="op" id="2285409">)</span>&nbsp;<span class="op" id="2285411">!=</span>&nbsp;<span class="num" id="2285414">2</span>&nbsp;<span class="op" id="2285416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285420">return</span>&nbsp;<span class="ident" id="2285427">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285438">var</span>&nbsp;<span class="ident" id="2285442">pp</span>&nbsp;<span class="op" id="2285445">[</span><span class="num" id="2285446">2</span><span class="op" id="2285447">]</span><span class="ident" id="2285448">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285456">err</span>&nbsp;<span class="op" id="2285460">=</span>&nbsp;<span class="ident" id="2285462">pipe2</span><span class="op" id="2285467">(</span><span class="op" id="2285468">&amp;</span><span class="ident" id="2285469">pp</span><span class="op" id="2285471">,</span>&nbsp;<span class="ident" id="2285473">flags</span><span class="op" id="2285478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285481">p</span><span class="op" id="2285482">[</span><span class="num" id="2285483">0</span><span class="op" id="2285484">]</span>&nbsp;<span class="op" id="2285486">=</span>&nbsp;<span class="builtintype" id="2285488">int</span><span class="op" id="2285491">(</span><span class="ident" id="2285492">pp</span><span class="op" id="2285494">[</span><span class="num" id="2285495">0</span><span class="op" id="2285496">]</span><span class="op" id="2285497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285500">p</span><span class="op" id="2285501">[</span><span class="num" id="2285502">1</span><span class="op" id="2285503">]</span>&nbsp;<span class="op" id="2285505">=</span>&nbsp;<span class="builtintype" id="2285507">int</span><span class="op" id="2285510">(</span><span class="ident" id="2285511">pp</span><span class="op" id="2285513">[</span><span class="num" id="2285514">1</span><span class="op" id="2285515">]</span><span class="op" id="2285516">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285519">return</span><br>
<span class="lineno"></span><span class="op" id="2285526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285529">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2285587">func</span>&nbsp;<span class="ident" id="2285592">Utimes</span><span class="op" id="2285598">(</span><span class="ident" id="2285599">path</span>&nbsp;<span class="builtintype" id="2285604">string</span><span class="op" id="2285610">,</span>&nbsp;<span class="ident" id="2285612">tv</span>&nbsp;<span class="op" id="2285615">[</span><span class="op" id="2285616">]</span><span class="ident" id="2285617">Timeval</span><span class="op" id="2285624">)</span>&nbsp;<span class="op" id="2285626">(</span><span class="ident" id="2285627">err</span>&nbsp;<span class="builtintype" id="2285631">error</span><span class="op" id="2285636">)</span>&nbsp;<span class="op" id="2285638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285641">if</span>&nbsp;<span class="builtinfunc" id="2285644">len</span><span class="op" id="2285647">(</span><span class="ident" id="2285648">tv</span><span class="op" id="2285650">)</span>&nbsp;<span class="op" id="2285652">!=</span>&nbsp;<span class="num" id="2285655">2</span>&nbsp;<span class="op" id="2285657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285661">return</span>&nbsp;<span class="ident" id="2285668">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285679">return</span>&nbsp;<span class="ident" id="2285686">utimes</span><span class="op" id="2285692">(</span><span class="ident" id="2285693">path</span><span class="op" id="2285697">,</span>&nbsp;<span class="op" id="2285699">(</span><span class="op" id="2285700">*</span><span class="op" id="2285701">[</span><span class="num" id="2285702">2</span><span class="op" id="2285703">]</span><span class="ident" id="2285704">Timeval</span><span class="op" id="2285711">)</span><span class="op" id="2285712">(</span><span class="ident" id="2285713">unsafe</span><span class="op" id="2285719">.</span><span class="ident" id="2285720">Pointer</span><span class="op" id="2285727">(</span><span class="op" id="2285728">&amp;</span><span class="ident" id="2285729">tv</span><span class="op" id="2285731">[</span><span class="num" id="2285732">0</span><span class="op" id="2285733">]</span><span class="op" id="2285734">)</span><span class="op" id="2285735">)</span><span class="op" id="2285736">)</span><br>
<span class="lineno">65</span><span class="op" id="2285738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285741">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2285814">func</span>&nbsp;<span class="ident" id="2285819">UtimesNano</span><span class="op" id="2285829">(</span><span class="ident" id="2285830">path</span>&nbsp;<span class="builtintype" id="2285835">string</span><span class="op" id="2285841">,</span>&nbsp;<span class="ident" id="2285843">ts</span>&nbsp;<span class="op" id="2285846">[</span><span class="op" id="2285847">]</span><span class="ident" id="2285848">Timespec</span><span class="op" id="2285856">)</span>&nbsp;<span class="op" id="2285858">(</span><span class="ident" id="2285859">err</span>&nbsp;<span class="builtintype" id="2285863">error</span><span class="op" id="2285868">)</span>&nbsp;<span class="op" id="2285870">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285873">if</span>&nbsp;<span class="builtinfunc" id="2285876">len</span><span class="op" id="2285879">(</span><span class="ident" id="2285880">ts</span><span class="op" id="2285882">)</span>&nbsp;<span class="op" id="2285884">!=</span>&nbsp;<span class="num" id="2285887">2</span>&nbsp;<span class="op" id="2285889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285893">return</span>&nbsp;<span class="ident" id="2285900">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285911">err</span>&nbsp;<span class="op" id="2285915">=</span>&nbsp;<span class="ident" id="2285917">utimensat</span><span class="op" id="2285926">(</span><span class="ident" id="2285927">_AT_FDCWD</span><span class="op" id="2285936">,</span>&nbsp;<span class="ident" id="2285938">path</span><span class="op" id="2285942">,</span>&nbsp;<span class="op" id="2285944">(</span><span class="op" id="2285945">*</span><span class="op" id="2285946">[</span><span class="num" id="2285947">2</span><span class="op" id="2285948">]</span><span class="ident" id="2285949">Timespec</span><span class="op" id="2285957">)</span><span class="op" id="2285958">(</span><span class="ident" id="2285959">unsafe</span><span class="op" id="2285965">.</span><span class="ident" id="2285966">Pointer</span><span class="op" id="2285973">(</span><span class="op" id="2285974">&amp;</span><span class="ident" id="2285975">ts</span><span class="op" id="2285977">[</span><span class="num" id="2285978">0</span><span class="op" id="2285979">]</span><span class="op" id="2285980">)</span><span class="op" id="2285981">)</span><span class="op" id="2285982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285985">if</span>&nbsp;<span class="ident" id="2285988">err</span>&nbsp;<span class="op" id="2285992">!=</span>&nbsp;<span class="ident" id="2285995">ENOSYS</span>&nbsp;<span class="op" id="2286002">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286006">return</span>&nbsp;<span class="ident" id="2286013">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286021">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286096">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286159">var</span>&nbsp;<span class="ident" id="2286163">tv</span>&nbsp;<span class="op" id="2286166">[</span><span class="num" id="2286167">2</span><span class="op" id="2286168">]</span><span class="ident" id="2286169">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286178">for</span>&nbsp;<span class="ident" id="2286182">i</span>&nbsp;<span class="op" id="2286184">:=</span>&nbsp;<span class="num" id="2286187">0</span><span class="op" id="2286188">;</span>&nbsp;<span class="ident" id="2286190">i</span>&nbsp;<span class="op" id="2286192">&lt;</span>&nbsp;<span class="num" id="2286194">2</span><span class="op" id="2286195">;</span>&nbsp;<span class="ident" id="2286197">i</span><span class="op" id="2286198">++</span>&nbsp;<span class="op" id="2286201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286205">tv</span><span class="op" id="2286207">[</span><span class="ident" id="2286208">i</span><span class="op" id="2286209">]</span><span class="op" id="2286210">.</span><span class="ident" id="2286211">Sec</span>&nbsp;<span class="op" id="2286215">=</span>&nbsp;<span class="ident" id="2286217">ts</span><span class="op" id="2286219">[</span><span class="ident" id="2286220">i</span><span class="op" id="2286221">]</span><span class="op" id="2286222">.</span><span class="ident" id="2286223">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286229">tv</span><span class="op" id="2286231">[</span><span class="ident" id="2286232">i</span><span class="op" id="2286233">]</span><span class="op" id="2286234">.</span><span class="ident" id="2286235">Usec</span>&nbsp;<span class="op" id="2286240">=</span>&nbsp;<span class="ident" id="2286242">ts</span><span class="op" id="2286244">[</span><span class="ident" id="2286245">i</span><span class="op" id="2286246">]</span><span class="op" id="2286247">.</span><span class="ident" id="2286248">Nsec</span>&nbsp;<span class="op" id="2286253">/</span>&nbsp;<span class="num" id="2286255">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286264">return</span>&nbsp;<span class="ident" id="2286271">utimes</span><span class="op" id="2286277">(</span><span class="ident" id="2286278">path</span><span class="op" id="2286282">,</span>&nbsp;<span class="op" id="2286284">(</span><span class="op" id="2286285">*</span><span class="op" id="2286286">[</span><span class="num" id="2286287">2</span><span class="op" id="2286288">]</span><span class="ident" id="2286289">Timeval</span><span class="op" id="2286296">)</span><span class="op" id="2286297">(</span><span class="ident" id="2286298">unsafe</span><span class="op" id="2286304">.</span><span class="ident" id="2286305">Pointer</span><span class="op" id="2286312">(</span><span class="op" id="2286313">&amp;</span><span class="ident" id="2286314">tv</span><span class="op" id="2286316">[</span><span class="num" id="2286317">0</span><span class="op" id="2286318">]</span><span class="op" id="2286319">)</span><span class="op" id="2286320">)</span><span class="op" id="2286321">)</span><br>
<span class="lineno">85</span><span class="op" id="2286323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286326">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286397">func</span>&nbsp;<span class="ident" id="2286402">Futimesat</span><span class="op" id="2286411">(</span><span class="ident" id="2286412">dirfd</span>&nbsp;<span class="builtintype" id="2286418">int</span><span class="op" id="2286421">,</span>&nbsp;<span class="ident" id="2286423">path</span>&nbsp;<span class="builtintype" id="2286428">string</span><span class="op" id="2286434">,</span>&nbsp;<span class="ident" id="2286436">tv</span>&nbsp;<span class="op" id="2286439">[</span><span class="op" id="2286440">]</span><span class="ident" id="2286441">Timeval</span><span class="op" id="2286448">)</span>&nbsp;<span class="op" id="2286450">(</span><span class="ident" id="2286451">err</span>&nbsp;<span class="builtintype" id="2286455">error</span><span class="op" id="2286460">)</span>&nbsp;<span class="op" id="2286462">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286465">if</span>&nbsp;<span class="builtinfunc" id="2286468">len</span><span class="op" id="2286471">(</span><span class="ident" id="2286472">tv</span><span class="op" id="2286474">)</span>&nbsp;<span class="op" id="2286476">!=</span>&nbsp;<span class="num" id="2286479">2</span>&nbsp;<span class="op" id="2286481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286485">return</span>&nbsp;<span class="ident" id="2286492">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286503">pathp</span><span class="op" id="2286508">,</span>&nbsp;<span class="ident" id="2286510">err</span>&nbsp;<span class="op" id="2286514">:=</span>&nbsp;<span class="ident" id="2286517">BytePtrFromString</span><span class="op" id="2286534">(</span><span class="ident" id="2286535">path</span><span class="op" id="2286539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286542">if</span>&nbsp;<span class="ident" id="2286545">err</span>&nbsp;<span class="op" id="2286549">!=</span>&nbsp;<span class="ident" id="2286552">nil</span>&nbsp;<span class="op" id="2286556">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286560">return</span>&nbsp;<span class="ident" id="2286567">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286575">err</span>&nbsp;<span class="op" id="2286579">=</span>&nbsp;<span class="ident" id="2286581">futimesat</span><span class="op" id="2286590">(</span><span class="ident" id="2286591">dirfd</span><span class="op" id="2286596">,</span>&nbsp;<span class="ident" id="2286598">pathp</span><span class="op" id="2286603">,</span>&nbsp;<span class="op" id="2286605">(</span><span class="op" id="2286606">*</span><span class="op" id="2286607">[</span><span class="num" id="2286608">2</span><span class="op" id="2286609">]</span><span class="ident" id="2286610">Timeval</span><span class="op" id="2286617">)</span><span class="op" id="2286618">(</span><span class="ident" id="2286619">unsafe</span><span class="op" id="2286625">.</span><span class="ident" id="2286626">Pointer</span><span class="op" id="2286633">(</span><span class="op" id="2286634">&amp;</span><span class="ident" id="2286635">tv</span><span class="op" id="2286637">[</span><span class="num" id="2286638">0</span><span class="op" id="2286639">]</span><span class="op" id="2286640">)</span><span class="op" id="2286641">)</span><span class="op" id="2286642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286645">use</span><span class="op" id="2286648">(</span><span class="ident" id="2286649">unsafe</span><span class="op" id="2286655">.</span><span class="ident" id="2286656">Pointer</span><span class="op" id="2286663">(</span><span class="ident" id="2286664">pathp</span><span class="op" id="2286669">)</span><span class="op" id="2286670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286673">return</span>&nbsp;<span class="ident" id="2286680">err</span><br>
<span class="lineno">100</span><span class="op" id="2286684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286687">func</span>&nbsp;<span class="ident" id="2286692">Futimes</span><span class="op" id="2286699">(</span><span class="ident" id="2286700">fd</span>&nbsp;<span class="builtintype" id="2286703">int</span><span class="op" id="2286706">,</span>&nbsp;<span class="ident" id="2286708">tv</span>&nbsp;<span class="op" id="2286711">[</span><span class="op" id="2286712">]</span><span class="ident" id="2286713">Timeval</span><span class="op" id="2286720">)</span>&nbsp;<span class="op" id="2286722">(</span><span class="ident" id="2286723">err</span>&nbsp;<span class="builtintype" id="2286727">error</span><span class="op" id="2286732">)</span>&nbsp;<span class="op" id="2286734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286737">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286796">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286826">return</span>&nbsp;<span class="ident" id="2286833">Utimes</span><span class="op" id="2286839">(</span><span class="string" id="2286840">&#34;/proc/self/fd/&#34;</span><span class="op" id="2286856">+</span><span class="ident" id="2286857">itoa</span><span class="op" id="2286861">(</span><span class="ident" id="2286862">fd</span><span class="op" id="2286864">)</span><span class="op" id="2286865">,</span>&nbsp;<span class="ident" id="2286867">tv</span><span class="op" id="2286869">)</span><br>
<span class="lineno"></span><span class="op" id="2286871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286874">const</span>&nbsp;<span class="ident" id="2286880">ImplementsGetwd</span>&nbsp;<span class="op" id="2286896">=</span>&nbsp;<span class="ident" id="2286898">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2286904">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286949">func</span>&nbsp;<span class="ident" id="2286954">Getwd</span><span class="op" id="2286959">(</span><span class="op" id="2286960">)</span>&nbsp;<span class="op" id="2286962">(</span><span class="ident" id="2286963">wd</span>&nbsp;<span class="builtintype" id="2286966">string</span><span class="op" id="2286972">,</span>&nbsp;<span class="ident" id="2286974">err</span>&nbsp;<span class="builtintype" id="2286978">error</span><span class="op" id="2286983">)</span>&nbsp;<span class="op" id="2286985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286988">var</span>&nbsp;<span class="ident" id="2286992">buf</span>&nbsp;<span class="op" id="2286996">[</span><span class="ident" id="2286997">PathMax</span><span class="op" id="2287004">]</span><span class="builtintype" id="2287005">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287011">n</span><span class="op" id="2287012">,</span>&nbsp;<span class="ident" id="2287014">err</span>&nbsp;<span class="op" id="2287018">:=</span>&nbsp;<span class="ident" id="2287021">Getcwd</span><span class="op" id="2287027">(</span><span class="ident" id="2287028">buf</span><span class="op" id="2287031">[</span><span class="num" id="2287032">0</span><span class="op" id="2287033">:</span><span class="op" id="2287034">]</span><span class="op" id="2287035">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287038">if</span>&nbsp;<span class="ident" id="2287041">err</span>&nbsp;<span class="op" id="2287045">!=</span>&nbsp;<span class="ident" id="2287048">nil</span>&nbsp;<span class="op" id="2287052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287056">return</span>&nbsp;<span class="string" id="2287063">&#34;&#34;</span><span class="op" id="2287065">,</span>&nbsp;<span class="ident" id="2287067">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2287075">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287149">if</span>&nbsp;<span class="ident" id="2287152">n</span>&nbsp;<span class="op" id="2287154">&lt;</span>&nbsp;<span class="num" id="2287156">1</span>&nbsp;<span class="op" id="2287158">||</span>&nbsp;<span class="ident" id="2287161">n</span>&nbsp;<span class="op" id="2287163">&gt;</span>&nbsp;<span class="builtinfunc" id="2287165">len</span><span class="op" id="2287168">(</span><span class="ident" id="2287169">buf</span><span class="op" id="2287172">)</span>&nbsp;<span class="op" id="2287174">||</span>&nbsp;<span class="ident" id="2287177">buf</span><span class="op" id="2287180">[</span><span class="ident" id="2287181">n</span><span class="op" id="2287182">-</span><span class="num" id="2287183">1</span><span class="op" id="2287184">]</span>&nbsp;<span class="op" id="2287186">!=</span>&nbsp;<span class="num" id="2287189">0</span>&nbsp;<span class="op" id="2287191">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287195">return</span>&nbsp;<span class="string" id="2287202">&#34;&#34;</span><span class="op" id="2287204">,</span>&nbsp;<span class="ident" id="2287206">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287217">return</span>&nbsp;<span class="builtintype" id="2287224">string</span><span class="op" id="2287230">(</span><span class="ident" id="2287231">buf</span><span class="op" id="2287234">[</span><span class="num" id="2287235">0</span>&nbsp;<span class="op" id="2287237">:</span>&nbsp;<span class="ident" id="2287239">n</span><span class="op" id="2287240">-</span><span class="num" id="2287241">1</span><span class="op" id="2287242">]</span><span class="op" id="2287243">)</span><span class="op" id="2287244">,</span>&nbsp;<span class="ident" id="2287246">nil</span><br>
<span class="lineno"></span><span class="op" id="2287250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2287253">func</span>&nbsp;<span class="ident" id="2287258">Getgroups</span><span class="op" id="2287267">(</span><span class="op" id="2287268">)</span>&nbsp;<span class="op" id="2287270">(</span><span class="ident" id="2287271">gids</span>&nbsp;<span class="op" id="2287276">[</span><span class="op" id="2287277">]</span><span class="builtintype" id="2287278">int</span><span class="op" id="2287281">,</span>&nbsp;<span class="ident" id="2287283">err</span>&nbsp;<span class="builtintype" id="2287287">error</span><span class="op" id="2287292">)</span>&nbsp;<span class="op" id="2287294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287297">n</span><span class="op" id="2287298">,</span>&nbsp;<span class="ident" id="2287300">err</span>&nbsp;<span class="op" id="2287304">:=</span>&nbsp;<span class="ident" id="2287307">getgroups</span><span class="op" id="2287316">(</span><span class="num" id="2287317">0</span><span class="op" id="2287318">,</span>&nbsp;<span class="ident" id="2287320">nil</span><span class="op" id="2287323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287326">if</span>&nbsp;<span class="ident" id="2287329">err</span>&nbsp;<span class="op" id="2287333">!=</span>&nbsp;<span class="ident" id="2287336">nil</span>&nbsp;<span class="op" id="2287340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287344">return</span>&nbsp;<span class="ident" id="2287351">nil</span><span class="op" id="2287354">,</span>&nbsp;<span class="ident" id="2287356">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287361">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287364">if</span>&nbsp;<span class="ident" id="2287367">n</span>&nbsp;<span class="op" id="2287369">==</span>&nbsp;<span class="num" id="2287372">0</span>&nbsp;<span class="op" id="2287374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287378">return</span>&nbsp;<span class="ident" id="2287385">nil</span><span class="op" id="2287388">,</span>&nbsp;<span class="ident" id="2287390">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2287399">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287453">if</span>&nbsp;<span class="ident" id="2287456">n</span>&nbsp;<span class="op" id="2287458">&lt;</span>&nbsp;<span class="num" id="2287460">0</span>&nbsp;<span class="op" id="2287462">||</span>&nbsp;<span class="ident" id="2287465">n</span>&nbsp;<span class="op" id="2287467">&gt;</span>&nbsp;<span class="num" id="2287469">1</span><span class="op" id="2287470">&lt;&lt;</span><span class="num" id="2287472">20</span>&nbsp;<span class="op" id="2287475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287479">return</span>&nbsp;<span class="ident" id="2287486">nil</span><span class="op" id="2287489">,</span>&nbsp;<span class="ident" id="2287491">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287503">a</span>&nbsp;<span class="op" id="2287505">:=</span>&nbsp;<span class="builtinfunc" id="2287508">make</span><span class="op" id="2287512">(</span><span class="op" id="2287513">[</span><span class="op" id="2287514">]</span><span class="ident" id="2287515">_Gid_t</span><span class="op" id="2287521">,</span>&nbsp;<span class="ident" id="2287523">n</span><span class="op" id="2287524">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287527">n</span><span class="op" id="2287528">,</span>&nbsp;<span class="ident" id="2287530">err</span>&nbsp;<span class="op" id="2287534">=</span>&nbsp;<span class="ident" id="2287536">getgroups</span><span class="op" id="2287545">(</span><span class="ident" id="2287546">n</span><span class="op" id="2287547">,</span>&nbsp;<span class="op" id="2287549">&amp;</span><span class="ident" id="2287550">a</span><span class="op" id="2287551">[</span><span class="num" id="2287552">0</span><span class="op" id="2287553">]</span><span class="op" id="2287554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287557">if</span>&nbsp;<span class="ident" id="2287560">err</span>&nbsp;<span class="op" id="2287564">!=</span>&nbsp;<span class="ident" id="2287567">nil</span>&nbsp;<span class="op" id="2287571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287575">return</span>&nbsp;<span class="ident" id="2287582">nil</span><span class="op" id="2287585">,</span>&nbsp;<span class="ident" id="2287587">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287595">gids</span>&nbsp;<span class="op" id="2287600">=</span>&nbsp;<span class="builtinfunc" id="2287602">make</span><span class="op" id="2287606">(</span><span class="op" id="2287607">[</span><span class="op" id="2287608">]</span><span class="builtintype" id="2287609">int</span><span class="op" id="2287612">,</span>&nbsp;<span class="ident" id="2287614">n</span><span class="op" id="2287615">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287618">for</span>&nbsp;<span class="ident" id="2287622">i</span><span class="op" id="2287623">,</span>&nbsp;<span class="ident" id="2287625">v</span>&nbsp;<span class="op" id="2287627">:=</span>&nbsp;<span class="keyword" id="2287630">range</span>&nbsp;<span class="ident" id="2287636">a</span><span class="op" id="2287637">[</span><span class="num" id="2287638">0</span><span class="op" id="2287639">:</span><span class="ident" id="2287640">n</span><span class="op" id="2287641">]</span>&nbsp;<span class="op" id="2287643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287647">gids</span><span class="op" id="2287651">[</span><span class="ident" id="2287652">i</span><span class="op" id="2287653">]</span>&nbsp;<span class="op" id="2287655">=</span>&nbsp;<span class="builtintype" id="2287657">int</span><span class="op" id="2287660">(</span><span class="ident" id="2287661">v</span><span class="op" id="2287662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287668">return</span><br>
<span class="lineno"></span><span class="op" id="2287675">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2287678">func</span>&nbsp;<span class="ident" id="2287683">Setgroups</span><span class="op" id="2287692">(</span><span class="ident" id="2287693">gids</span>&nbsp;<span class="op" id="2287698">[</span><span class="op" id="2287699">]</span><span class="builtintype" id="2287700">int</span><span class="op" id="2287703">)</span>&nbsp;<span class="op" id="2287705">(</span><span class="ident" id="2287706">err</span>&nbsp;<span class="builtintype" id="2287710">error</span><span class="op" id="2287715">)</span>&nbsp;<span class="op" id="2287717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287720">if</span>&nbsp;<span class="builtinfunc" id="2287723">len</span><span class="op" id="2287726">(</span><span class="ident" id="2287727">gids</span><span class="op" id="2287731">)</span>&nbsp;<span class="op" id="2287733">==</span>&nbsp;<span class="num" id="2287736">0</span>&nbsp;<span class="op" id="2287738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287742">return</span>&nbsp;<span class="ident" id="2287749">setgroups</span><span class="op" id="2287758">(</span><span class="num" id="2287759">0</span><span class="op" id="2287760">,</span>&nbsp;<span class="ident" id="2287762">nil</span><span class="op" id="2287765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287768">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287772">a</span>&nbsp;<span class="op" id="2287774">:=</span>&nbsp;<span class="builtinfunc" id="2287777">make</span><span class="op" id="2287781">(</span><span class="op" id="2287782">[</span><span class="op" id="2287783">]</span><span class="ident" id="2287784">_Gid_t</span><span class="op" id="2287790">,</span>&nbsp;<span class="builtinfunc" id="2287792">len</span><span class="op" id="2287795">(</span><span class="ident" id="2287796">gids</span><span class="op" id="2287800">)</span><span class="op" id="2287801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287804">for</span>&nbsp;<span class="ident" id="2287808">i</span><span class="op" id="2287809">,</span>&nbsp;<span class="ident" id="2287811">v</span>&nbsp;<span class="op" id="2287813">:=</span>&nbsp;<span class="keyword" id="2287816">range</span>&nbsp;<span class="ident" id="2287822">gids</span>&nbsp;<span class="op" id="2287827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287831">a</span><span class="op" id="2287832">[</span><span class="ident" id="2287833">i</span><span class="op" id="2287834">]</span>&nbsp;<span class="op" id="2287836">=</span>&nbsp;<span class="ident" id="2287838">_Gid_t</span><span class="op" id="2287844">(</span><span class="ident" id="2287845">v</span><span class="op" id="2287846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287849">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287852">return</span>&nbsp;<span class="ident" id="2287859">setgroups</span><span class="op" id="2287868">(</span><span class="builtinfunc" id="2287869">len</span><span class="op" id="2287872">(</span><span class="ident" id="2287873">a</span><span class="op" id="2287874">)</span><span class="op" id="2287875">,</span>&nbsp;<span class="op" id="2287877">&amp;</span><span class="ident" id="2287878">a</span><span class="op" id="2287879">[</span><span class="num" id="2287880">0</span><span class="op" id="2287881">]</span><span class="op" id="2287882">)</span><br>
<span class="lineno"></span><span class="op" id="2287884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2287887">type</span>&nbsp;<span class="ident" id="2287892">WaitStatus</span>&nbsp;<span class="builtintype" id="2287903">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2287911">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2287966">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2288025">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2288075">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2288129">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2288180">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2288235">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2288290">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288330">const</span>&nbsp;<span class="op" id="2288336">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288339">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2288347">=</span>&nbsp;<span class="num" id="2288349">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288355">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2288363">=</span>&nbsp;<span class="num" id="2288365">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288371">exited</span>&nbsp;&nbsp;<span class="op" id="2288379">=</span>&nbsp;<span class="num" id="2288381">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288387">stopped</span>&nbsp;<span class="op" id="2288395">=</span>&nbsp;<span class="num" id="2288397">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288403">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2288411">=</span>&nbsp;<span class="num" id="2288413">8</span><br>
<span class="lineno">180</span><span class="op" id="2288415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288418">func</span>&nbsp;<span class="op" id="2288423">(</span><span class="ident" id="2288424">w</span>&nbsp;<span class="ident" id="2288426">WaitStatus</span><span class="op" id="2288436">)</span>&nbsp;<span class="ident" id="2288438">Exited</span><span class="op" id="2288444">(</span><span class="op" id="2288445">)</span>&nbsp;<span class="builtintype" id="2288447">bool</span>&nbsp;<span class="op" id="2288452">{</span>&nbsp;<span class="keyword" id="2288454">return</span>&nbsp;<span class="ident" id="2288461">w</span><span class="op" id="2288462">&amp;</span><span class="ident" id="2288463">mask</span>&nbsp;<span class="op" id="2288468">==</span>&nbsp;<span class="ident" id="2288471">exited</span>&nbsp;<span class="op" id="2288478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288481">func</span>&nbsp;<span class="op" id="2288486">(</span><span class="ident" id="2288487">w</span>&nbsp;<span class="ident" id="2288489">WaitStatus</span><span class="op" id="2288499">)</span>&nbsp;<span class="ident" id="2288501">Signaled</span><span class="op" id="2288509">(</span><span class="op" id="2288510">)</span>&nbsp;<span class="builtintype" id="2288512">bool</span>&nbsp;<span class="op" id="2288517">{</span>&nbsp;<span class="keyword" id="2288519">return</span>&nbsp;<span class="ident" id="2288526">w</span><span class="op" id="2288527">&amp;</span><span class="ident" id="2288528">mask</span>&nbsp;<span class="op" id="2288533">!=</span>&nbsp;<span class="ident" id="2288536">stopped</span>&nbsp;<span class="op" id="2288544">&amp;&amp;</span>&nbsp;<span class="ident" id="2288547">w</span><span class="op" id="2288548">&amp;</span><span class="ident" id="2288549">mask</span>&nbsp;<span class="op" id="2288554">!=</span>&nbsp;<span class="ident" id="2288557">exited</span>&nbsp;<span class="op" id="2288564">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2288567">func</span>&nbsp;<span class="op" id="2288572">(</span><span class="ident" id="2288573">w</span>&nbsp;<span class="ident" id="2288575">WaitStatus</span><span class="op" id="2288585">)</span>&nbsp;<span class="ident" id="2288587">Stopped</span><span class="op" id="2288594">(</span><span class="op" id="2288595">)</span>&nbsp;<span class="builtintype" id="2288597">bool</span>&nbsp;<span class="op" id="2288602">{</span>&nbsp;<span class="keyword" id="2288604">return</span>&nbsp;<span class="ident" id="2288611">w</span><span class="op" id="2288612">&amp;</span><span class="num" id="2288613">0xFF</span>&nbsp;<span class="op" id="2288618">==</span>&nbsp;<span class="ident" id="2288621">stopped</span>&nbsp;<span class="op" id="2288629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288632">func</span>&nbsp;<span class="op" id="2288637">(</span><span class="ident" id="2288638">w</span>&nbsp;<span class="ident" id="2288640">WaitStatus</span><span class="op" id="2288650">)</span>&nbsp;<span class="ident" id="2288652">Continued</span><span class="op" id="2288661">(</span><span class="op" id="2288662">)</span>&nbsp;<span class="builtintype" id="2288664">bool</span>&nbsp;<span class="op" id="2288669">{</span>&nbsp;<span class="keyword" id="2288671">return</span>&nbsp;<span class="ident" id="2288678">w</span>&nbsp;<span class="op" id="2288680">==</span>&nbsp;<span class="num" id="2288683">0xFFFF</span>&nbsp;<span class="op" id="2288690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2288693">func</span>&nbsp;<span class="op" id="2288698">(</span><span class="ident" id="2288699">w</span>&nbsp;<span class="ident" id="2288701">WaitStatus</span><span class="op" id="2288711">)</span>&nbsp;<span class="ident" id="2288713">CoreDump</span><span class="op" id="2288721">(</span><span class="op" id="2288722">)</span>&nbsp;<span class="builtintype" id="2288724">bool</span>&nbsp;<span class="op" id="2288729">{</span>&nbsp;<span class="keyword" id="2288731">return</span>&nbsp;<span class="ident" id="2288738">w</span><span class="op" id="2288739">.</span><span class="ident" id="2288740">Signaled</span><span class="op" id="2288748">(</span><span class="op" id="2288749">)</span>&nbsp;<span class="op" id="2288751">&amp;&amp;</span>&nbsp;<span class="ident" id="2288754">w</span><span class="op" id="2288755">&amp;</span><span class="ident" id="2288756">core</span>&nbsp;<span class="op" id="2288761">!=</span>&nbsp;<span class="num" id="2288764">0</span>&nbsp;<span class="op" id="2288766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288769">func</span>&nbsp;<span class="op" id="2288774">(</span><span class="ident" id="2288775">w</span>&nbsp;<span class="ident" id="2288777">WaitStatus</span><span class="op" id="2288787">)</span>&nbsp;<span class="ident" id="2288789">ExitStatus</span><span class="op" id="2288799">(</span><span class="op" id="2288800">)</span>&nbsp;<span class="builtintype" id="2288802">int</span>&nbsp;<span class="op" id="2288806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288809">if</span>&nbsp;<span class="op" id="2288812">!</span><span class="ident" id="2288813">w</span><span class="op" id="2288814">.</span><span class="ident" id="2288815">Exited</span><span class="op" id="2288821">(</span><span class="op" id="2288822">)</span>&nbsp;<span class="op" id="2288824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288828">return</span>&nbsp;<span class="op" id="2288835">-</span><span class="num" id="2288836">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288842">return</span>&nbsp;<span class="builtintype" id="2288849">int</span><span class="op" id="2288852">(</span><span class="ident" id="2288853">w</span><span class="op" id="2288854">&gt;&gt;</span><span class="ident" id="2288856">shift</span><span class="op" id="2288861">)</span>&nbsp;<span class="op" id="2288863">&amp;</span>&nbsp;<span class="num" id="2288865">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2288870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288873">func</span>&nbsp;<span class="op" id="2288878">(</span><span class="ident" id="2288879">w</span>&nbsp;<span class="ident" id="2288881">WaitStatus</span><span class="op" id="2288891">)</span>&nbsp;<span class="ident" id="2288893">Signal</span><span class="op" id="2288899">(</span><span class="op" id="2288900">)</span>&nbsp;<span class="ident" id="2288902">Signal</span>&nbsp;<span class="op" id="2288909">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288912">if</span>&nbsp;<span class="op" id="2288915">!</span><span class="ident" id="2288916">w</span><span class="op" id="2288917">.</span><span class="ident" id="2288918">Signaled</span><span class="op" id="2288926">(</span><span class="op" id="2288927">)</span>&nbsp;<span class="op" id="2288929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288933">return</span>&nbsp;<span class="op" id="2288940">-</span><span class="num" id="2288941">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288947">return</span>&nbsp;<span class="ident" id="2288954">Signal</span><span class="op" id="2288960">(</span><span class="ident" id="2288961">w</span>&nbsp;<span class="op" id="2288963">&amp;</span>&nbsp;<span class="ident" id="2288965">mask</span><span class="op" id="2288969">)</span><br>
<span class="lineno"></span><span class="op" id="2288971">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2288974">func</span>&nbsp;<span class="op" id="2288979">(</span><span class="ident" id="2288980">w</span>&nbsp;<span class="ident" id="2288982">WaitStatus</span><span class="op" id="2288992">)</span>&nbsp;<span class="ident" id="2288994">StopSignal</span><span class="op" id="2289004">(</span><span class="op" id="2289005">)</span>&nbsp;<span class="ident" id="2289007">Signal</span>&nbsp;<span class="op" id="2289014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289017">if</span>&nbsp;<span class="op" id="2289020">!</span><span class="ident" id="2289021">w</span><span class="op" id="2289022">.</span><span class="ident" id="2289023">Stopped</span><span class="op" id="2289030">(</span><span class="op" id="2289031">)</span>&nbsp;<span class="op" id="2289033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289037">return</span>&nbsp;<span class="op" id="2289044">-</span><span class="num" id="2289045">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289048">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289051">return</span>&nbsp;<span class="ident" id="2289058">Signal</span><span class="op" id="2289064">(</span><span class="ident" id="2289065">w</span><span class="op" id="2289066">&gt;&gt;</span><span class="ident" id="2289068">shift</span><span class="op" id="2289073">)</span>&nbsp;<span class="op" id="2289075">&amp;</span>&nbsp;<span class="num" id="2289077">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2289082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2289085">func</span>&nbsp;<span class="op" id="2289090">(</span><span class="ident" id="2289091">w</span>&nbsp;<span class="ident" id="2289093">WaitStatus</span><span class="op" id="2289103">)</span>&nbsp;<span class="ident" id="2289105">TrapCause</span><span class="op" id="2289114">(</span><span class="op" id="2289115">)</span>&nbsp;<span class="builtintype" id="2289117">int</span>&nbsp;<span class="op" id="2289121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289124">if</span>&nbsp;<span class="ident" id="2289127">w</span><span class="op" id="2289128">.</span><span class="ident" id="2289129">StopSignal</span><span class="op" id="2289139">(</span><span class="op" id="2289140">)</span>&nbsp;<span class="op" id="2289142">!=</span>&nbsp;<span class="ident" id="2289145">SIGTRAP</span>&nbsp;<span class="op" id="2289153">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289157">return</span>&nbsp;<span class="op" id="2289164">-</span><span class="num" id="2289165">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289171">return</span>&nbsp;<span class="builtintype" id="2289178">int</span><span class="op" id="2289181">(</span><span class="ident" id="2289182">w</span><span class="op" id="2289183">&gt;&gt;</span><span class="ident" id="2289185">shift</span><span class="op" id="2289190">)</span>&nbsp;<span class="op" id="2289192">&gt;&gt;</span>&nbsp;<span class="num" id="2289195">8</span><br>
<span class="lineno"></span><span class="op" id="2289197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2289200">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2289290">func</span>&nbsp;<span class="ident" id="2289295">Wait4</span><span class="op" id="2289300">(</span><span class="ident" id="2289301">pid</span>&nbsp;<span class="builtintype" id="2289305">int</span><span class="op" id="2289308">,</span>&nbsp;<span class="ident" id="2289310">wstatus</span>&nbsp;<span class="op" id="2289318">*</span><span class="ident" id="2289319">WaitStatus</span><span class="op" id="2289329">,</span>&nbsp;<span class="ident" id="2289331">options</span>&nbsp;<span class="builtintype" id="2289339">int</span><span class="op" id="2289342">,</span>&nbsp;<span class="ident" id="2289344">rusage</span>&nbsp;<span class="op" id="2289351">*</span><span class="ident" id="2289352">Rusage</span><span class="op" id="2289358">)</span>&nbsp;<span class="op" id="2289360">(</span><span class="ident" id="2289361">wpid</span>&nbsp;<span class="builtintype" id="2289366">int</span><span class="op" id="2289369">,</span>&nbsp;<span class="ident" id="2289371">err</span>&nbsp;<span class="builtintype" id="2289375">error</span><span class="op" id="2289380">)</span>&nbsp;<span class="op" id="2289382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289385">var</span>&nbsp;<span class="ident" id="2289389">status</span>&nbsp;<span class="ident" id="2289396">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289404">wpid</span><span class="op" id="2289408">,</span>&nbsp;<span class="ident" id="2289410">err</span>&nbsp;<span class="op" id="2289414">=</span>&nbsp;<span class="ident" id="2289416">wait4</span><span class="op" id="2289421">(</span><span class="ident" id="2289422">pid</span><span class="op" id="2289425">,</span>&nbsp;<span class="op" id="2289427">&amp;</span><span class="ident" id="2289428">status</span><span class="op" id="2289434">,</span>&nbsp;<span class="ident" id="2289436">options</span><span class="op" id="2289443">,</span>&nbsp;<span class="ident" id="2289445">rusage</span><span class="op" id="2289451">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289454">if</span>&nbsp;<span class="ident" id="2289457">wstatus</span>&nbsp;<span class="op" id="2289465">!=</span>&nbsp;<span class="ident" id="2289468">nil</span>&nbsp;<span class="op" id="2289472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289476">*</span><span class="ident" id="2289477">wstatus</span>&nbsp;<span class="op" id="2289485">=</span>&nbsp;<span class="ident" id="2289487">WaitStatus</span><span class="op" id="2289497">(</span><span class="ident" id="2289498">status</span><span class="op" id="2289504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289510">return</span><br>
<span class="lineno"></span><span class="op" id="2289517">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2289520">func</span>&nbsp;<span class="ident" id="2289525">Mkfifo</span><span class="op" id="2289531">(</span><span class="ident" id="2289532">path</span>&nbsp;<span class="builtintype" id="2289537">string</span><span class="op" id="2289543">,</span>&nbsp;<span class="ident" id="2289545">mode</span>&nbsp;<span class="builtintype" id="2289550">uint32</span><span class="op" id="2289556">)</span>&nbsp;<span class="op" id="2289558">(</span><span class="ident" id="2289559">err</span>&nbsp;<span class="builtintype" id="2289563">error</span><span class="op" id="2289568">)</span>&nbsp;<span class="op" id="2289570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289573">return</span>&nbsp;<span class="ident" id="2289580">Mknod</span><span class="op" id="2289585">(</span><span class="ident" id="2289586">path</span><span class="op" id="2289590">,</span>&nbsp;<span class="ident" id="2289592">mode</span><span class="op" id="2289596">|</span><span class="ident" id="2289597">S_IFIFO</span><span class="op" id="2289604">,</span>&nbsp;<span class="num" id="2289606">0</span><span class="op" id="2289607">)</span><br>
<span class="lineno"></span><span class="op" id="2289609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2289612">func</span>&nbsp;<span class="op" id="2289617">(</span><span class="ident" id="2289618">sa</span>&nbsp;<span class="op" id="2289621">*</span><span class="ident" id="2289622">SockaddrInet4</span><span class="op" id="2289635">)</span>&nbsp;<span class="ident" id="2289637">sockaddr</span><span class="op" id="2289645">(</span><span class="op" id="2289646">)</span>&nbsp;<span class="op" id="2289648">(</span><span class="ident" id="2289649">unsafe</span><span class="op" id="2289655">.</span><span class="ident" id="2289656">Pointer</span><span class="op" id="2289663">,</span>&nbsp;<span class="ident" id="2289665">_Socklen</span><span class="op" id="2289673">,</span>&nbsp;<span class="builtintype" id="2289675">error</span><span class="op" id="2289680">)</span>&nbsp;<span class="op" id="2289682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289685">if</span>&nbsp;<span class="ident" id="2289688">sa</span><span class="op" id="2289690">.</span><span class="ident" id="2289691">Port</span>&nbsp;<span class="op" id="2289696">&lt;</span>&nbsp;<span class="num" id="2289698">0</span>&nbsp;<span class="op" id="2289700">||</span>&nbsp;<span class="ident" id="2289703">sa</span><span class="op" id="2289705">.</span><span class="ident" id="2289706">Port</span>&nbsp;<span class="op" id="2289711">&gt;</span>&nbsp;<span class="num" id="2289713">0xFFFF</span>&nbsp;<span class="op" id="2289720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289724">return</span>&nbsp;<span class="ident" id="2289731">nil</span><span class="op" id="2289734">,</span>&nbsp;<span class="num" id="2289736">0</span><span class="op" id="2289737">,</span>&nbsp;<span class="ident" id="2289739">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289750">sa</span><span class="op" id="2289752">.</span><span class="ident" id="2289753">raw</span><span class="op" id="2289756">.</span><span class="ident" id="2289757">Family</span>&nbsp;<span class="op" id="2289764">=</span>&nbsp;<span class="ident" id="2289766">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289775">p</span>&nbsp;<span class="op" id="2289777">:=</span>&nbsp;<span class="op" id="2289780">(</span><span class="op" id="2289781">*</span><span class="op" id="2289782">[</span><span class="num" id="2289783">2</span><span class="op" id="2289784">]</span><span class="builtintype" id="2289785">byte</span><span class="op" id="2289789">)</span><span class="op" id="2289790">(</span><span class="ident" id="2289791">unsafe</span><span class="op" id="2289797">.</span><span class="ident" id="2289798">Pointer</span><span class="op" id="2289805">(</span><span class="op" id="2289806">&amp;</span><span class="ident" id="2289807">sa</span><span class="op" id="2289809">.</span><span class="ident" id="2289810">raw</span><span class="op" id="2289813">.</span><span class="ident" id="2289814">Port</span><span class="op" id="2289818">)</span><span class="op" id="2289819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289822">p</span><span class="op" id="2289823">[</span><span class="num" id="2289824">0</span><span class="op" id="2289825">]</span>&nbsp;<span class="op" id="2289827">=</span>&nbsp;<span class="builtintype" id="2289829">byte</span><span class="op" id="2289833">(</span><span class="ident" id="2289834">sa</span><span class="op" id="2289836">.</span><span class="ident" id="2289837">Port</span>&nbsp;<span class="op" id="2289842">&gt;&gt;</span>&nbsp;<span class="num" id="2289845">8</span><span class="op" id="2289846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289849">p</span><span class="op" id="2289850">[</span><span class="num" id="2289851">1</span><span class="op" id="2289852">]</span>&nbsp;<span class="op" id="2289854">=</span>&nbsp;<span class="builtintype" id="2289856">byte</span><span class="op" id="2289860">(</span><span class="ident" id="2289861">sa</span><span class="op" id="2289863">.</span><span class="ident" id="2289864">Port</span><span class="op" id="2289868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289871">for</span>&nbsp;<span class="ident" id="2289875">i</span>&nbsp;<span class="op" id="2289877">:=</span>&nbsp;<span class="num" id="2289880">0</span><span class="op" id="2289881">;</span>&nbsp;<span class="ident" id="2289883">i</span>&nbsp;<span class="op" id="2289885">&lt;</span>&nbsp;<span class="builtinfunc" id="2289887">len</span><span class="op" id="2289890">(</span><span class="ident" id="2289891">sa</span><span class="op" id="2289893">.</span><span class="ident" id="2289894">Addr</span><span class="op" id="2289898">)</span><span class="op" id="2289899">;</span>&nbsp;<span class="ident" id="2289901">i</span><span class="op" id="2289902">++</span>&nbsp;<span class="op" id="2289905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289909">sa</span><span class="op" id="2289911">.</span><span class="ident" id="2289912">raw</span><span class="op" id="2289915">.</span><span class="ident" id="2289916">Addr</span><span class="op" id="2289920">[</span><span class="ident" id="2289921">i</span><span class="op" id="2289922">]</span>&nbsp;<span class="op" id="2289924">=</span>&nbsp;<span class="ident" id="2289926">sa</span><span class="op" id="2289928">.</span><span class="ident" id="2289929">Addr</span><span class="op" id="2289933">[</span><span class="ident" id="2289934">i</span><span class="op" id="2289935">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289941">return</span>&nbsp;<span class="ident" id="2289948">unsafe</span><span class="op" id="2289954">.</span><span class="ident" id="2289955">Pointer</span><span class="op" id="2289962">(</span><span class="op" id="2289963">&amp;</span><span class="ident" id="2289964">sa</span><span class="op" id="2289966">.</span><span class="ident" id="2289967">raw</span><span class="op" id="2289970">)</span><span class="op" id="2289971">,</span>&nbsp;<span class="ident" id="2289973">SizeofSockaddrInet4</span><span class="op" id="2289992">,</span>&nbsp;<span class="ident" id="2289994">nil</span><br>
<span class="lineno"></span><span class="op" id="2289998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2290001">func</span>&nbsp;<span class="op" id="2290006">(</span><span class="ident" id="2290007">sa</span>&nbsp;<span class="op" id="2290010">*</span><span class="ident" id="2290011">SockaddrInet6</span><span class="op" id="2290024">)</span>&nbsp;<span class="ident" id="2290026">sockaddr</span><span class="op" id="2290034">(</span><span class="op" id="2290035">)</span>&nbsp;<span class="op" id="2290037">(</span><span class="ident" id="2290038">unsafe</span><span class="op" id="2290044">.</span><span class="ident" id="2290045">Pointer</span><span class="op" id="2290052">,</span>&nbsp;<span class="ident" id="2290054">_Socklen</span><span class="op" id="2290062">,</span>&nbsp;<span class="builtintype" id="2290064">error</span><span class="op" id="2290069">)</span>&nbsp;<span class="op" id="2290071">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290074">if</span>&nbsp;<span class="ident" id="2290077">sa</span><span class="op" id="2290079">.</span><span class="ident" id="2290080">Port</span>&nbsp;<span class="op" id="2290085">&lt;</span>&nbsp;<span class="num" id="2290087">0</span>&nbsp;<span class="op" id="2290089">||</span>&nbsp;<span class="ident" id="2290092">sa</span><span class="op" id="2290094">.</span><span class="ident" id="2290095">Port</span>&nbsp;<span class="op" id="2290100">&gt;</span>&nbsp;<span class="num" id="2290102">0xFFFF</span>&nbsp;<span class="op" id="2290109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290113">return</span>&nbsp;<span class="ident" id="2290120">nil</span><span class="op" id="2290123">,</span>&nbsp;<span class="num" id="2290125">0</span><span class="op" id="2290126">,</span>&nbsp;<span class="ident" id="2290128">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290139">sa</span><span class="op" id="2290141">.</span><span class="ident" id="2290142">raw</span><span class="op" id="2290145">.</span><span class="ident" id="2290146">Family</span>&nbsp;<span class="op" id="2290153">=</span>&nbsp;<span class="ident" id="2290155">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290165">p</span>&nbsp;<span class="op" id="2290167">:=</span>&nbsp;<span class="op" id="2290170">(</span><span class="op" id="2290171">*</span><span class="op" id="2290172">[</span><span class="num" id="2290173">2</span><span class="op" id="2290174">]</span><span class="builtintype" id="2290175">byte</span><span class="op" id="2290179">)</span><span class="op" id="2290180">(</span><span class="ident" id="2290181">unsafe</span><span class="op" id="2290187">.</span><span class="ident" id="2290188">Pointer</span><span class="op" id="2290195">(</span><span class="op" id="2290196">&amp;</span><span class="ident" id="2290197">sa</span><span class="op" id="2290199">.</span><span class="ident" id="2290200">raw</span><span class="op" id="2290203">.</span><span class="ident" id="2290204">Port</span><span class="op" id="2290208">)</span><span class="op" id="2290209">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290212">p</span><span class="op" id="2290213">[</span><span class="num" id="2290214">0</span><span class="op" id="2290215">]</span>&nbsp;<span class="op" id="2290217">=</span>&nbsp;<span class="builtintype" id="2290219">byte</span><span class="op" id="2290223">(</span><span class="ident" id="2290224">sa</span><span class="op" id="2290226">.</span><span class="ident" id="2290227">Port</span>&nbsp;<span class="op" id="2290232">&gt;&gt;</span>&nbsp;<span class="num" id="2290235">8</span><span class="op" id="2290236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290239">p</span><span class="op" id="2290240">[</span><span class="num" id="2290241">1</span><span class="op" id="2290242">]</span>&nbsp;<span class="op" id="2290244">=</span>&nbsp;<span class="builtintype" id="2290246">byte</span><span class="op" id="2290250">(</span><span class="ident" id="2290251">sa</span><span class="op" id="2290253">.</span><span class="ident" id="2290254">Port</span><span class="op" id="2290258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290261">sa</span><span class="op" id="2290263">.</span><span class="ident" id="2290264">raw</span><span class="op" id="2290267">.</span><span class="ident" id="2290268">Scope_id</span>&nbsp;<span class="op" id="2290277">=</span>&nbsp;<span class="ident" id="2290279">sa</span><span class="op" id="2290281">.</span><span class="ident" id="2290282">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290290">for</span>&nbsp;<span class="ident" id="2290294">i</span>&nbsp;<span class="op" id="2290296">:=</span>&nbsp;<span class="num" id="2290299">0</span><span class="op" id="2290300">;</span>&nbsp;<span class="ident" id="2290302">i</span>&nbsp;<span class="op" id="2290304">&lt;</span>&nbsp;<span class="builtinfunc" id="2290306">len</span><span class="op" id="2290309">(</span><span class="ident" id="2290310">sa</span><span class="op" id="2290312">.</span><span class="ident" id="2290313">Addr</span><span class="op" id="2290317">)</span><span class="op" id="2290318">;</span>&nbsp;<span class="ident" id="2290320">i</span><span class="op" id="2290321">++</span>&nbsp;<span class="op" id="2290324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290328">sa</span><span class="op" id="2290330">.</span><span class="ident" id="2290331">raw</span><span class="op" id="2290334">.</span><span class="ident" id="2290335">Addr</span><span class="op" id="2290339">[</span><span class="ident" id="2290340">i</span><span class="op" id="2290341">]</span>&nbsp;<span class="op" id="2290343">=</span>&nbsp;<span class="ident" id="2290345">sa</span><span class="op" id="2290347">.</span><span class="ident" id="2290348">Addr</span><span class="op" id="2290352">[</span><span class="ident" id="2290353">i</span><span class="op" id="2290354">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290360">return</span>&nbsp;<span class="ident" id="2290367">unsafe</span><span class="op" id="2290373">.</span><span class="ident" id="2290374">Pointer</span><span class="op" id="2290381">(</span><span class="op" id="2290382">&amp;</span><span class="ident" id="2290383">sa</span><span class="op" id="2290385">.</span><span class="ident" id="2290386">raw</span><span class="op" id="2290389">)</span><span class="op" id="2290390">,</span>&nbsp;<span class="ident" id="2290392">SizeofSockaddrInet6</span><span class="op" id="2290411">,</span>&nbsp;<span class="ident" id="2290413">nil</span><br>
<span class="lineno"></span><span class="op" id="2290417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2290420">func</span>&nbsp;<span class="op" id="2290425">(</span><span class="ident" id="2290426">sa</span>&nbsp;<span class="op" id="2290429">*</span><span class="ident" id="2290430">SockaddrUnix</span><span class="op" id="2290442">)</span>&nbsp;<span class="ident" id="2290444">sockaddr</span><span class="op" id="2290452">(</span><span class="op" id="2290453">)</span>&nbsp;<span class="op" id="2290455">(</span><span class="ident" id="2290456">unsafe</span><span class="op" id="2290462">.</span><span class="ident" id="2290463">Pointer</span><span class="op" id="2290470">,</span>&nbsp;<span class="ident" id="2290472">_Socklen</span><span class="op" id="2290480">,</span>&nbsp;<span class="builtintype" id="2290482">error</span><span class="op" id="2290487">)</span>&nbsp;<span class="op" id="2290489">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290492">name</span>&nbsp;<span class="op" id="2290497">:=</span>&nbsp;<span class="ident" id="2290500">sa</span><span class="op" id="2290502">.</span><span class="ident" id="2290503">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290509">n</span>&nbsp;<span class="op" id="2290511">:=</span>&nbsp;<span class="builtinfunc" id="2290514">len</span><span class="op" id="2290517">(</span><span class="ident" id="2290518">name</span><span class="op" id="2290522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290525">if</span>&nbsp;<span class="ident" id="2290528">n</span>&nbsp;<span class="op" id="2290530">&gt;=</span>&nbsp;<span class="builtinfunc" id="2290533">len</span><span class="op" id="2290536">(</span><span class="ident" id="2290537">sa</span><span class="op" id="2290539">.</span><span class="ident" id="2290540">raw</span><span class="op" id="2290543">.</span><span class="ident" id="2290544">Path</span><span class="op" id="2290548">)</span>&nbsp;<span class="op" id="2290550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290554">return</span>&nbsp;<span class="ident" id="2290561">nil</span><span class="op" id="2290564">,</span>&nbsp;<span class="num" id="2290566">0</span><span class="op" id="2290567">,</span>&nbsp;<span class="ident" id="2290569">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290577">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290580">sa</span><span class="op" id="2290582">.</span><span class="ident" id="2290583">raw</span><span class="op" id="2290586">.</span><span class="ident" id="2290587">Family</span>&nbsp;<span class="op" id="2290594">=</span>&nbsp;<span class="ident" id="2290596">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290605">for</span>&nbsp;<span class="ident" id="2290609">i</span>&nbsp;<span class="op" id="2290611">:=</span>&nbsp;<span class="num" id="2290614">0</span><span class="op" id="2290615">;</span>&nbsp;<span class="ident" id="2290617">i</span>&nbsp;<span class="op" id="2290619">&lt;</span>&nbsp;<span class="ident" id="2290621">n</span><span class="op" id="2290622">;</span>&nbsp;<span class="ident" id="2290624">i</span><span class="op" id="2290625">++</span>&nbsp;<span class="op" id="2290628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290632">sa</span><span class="op" id="2290634">.</span><span class="ident" id="2290635">raw</span><span class="op" id="2290638">.</span><span class="ident" id="2290639">Path</span><span class="op" id="2290643">[</span><span class="ident" id="2290644">i</span><span class="op" id="2290645">]</span>&nbsp;<span class="op" id="2290647">=</span>&nbsp;<span class="builtintype" id="2290649">int8</span><span class="op" id="2290653">(</span><span class="ident" id="2290654">name</span><span class="op" id="2290658">[</span><span class="ident" id="2290659">i</span><span class="op" id="2290660">]</span><span class="op" id="2290661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2290667">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290709">sl</span>&nbsp;<span class="op" id="2290712">:=</span>&nbsp;<span class="ident" id="2290715">_Socklen</span><span class="op" id="2290723">(</span><span class="num" id="2290724">2</span><span class="op" id="2290725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290728">if</span>&nbsp;<span class="ident" id="2290731">n</span>&nbsp;<span class="op" id="2290733">&gt;</span>&nbsp;<span class="num" id="2290735">0</span>&nbsp;<span class="op" id="2290737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290741">sl</span>&nbsp;<span class="op" id="2290744">+=</span>&nbsp;<span class="ident" id="2290747">_Socklen</span><span class="op" id="2290755">(</span><span class="ident" id="2290756">n</span><span class="op" id="2290757">)</span>&nbsp;<span class="op" id="2290759">+</span>&nbsp;<span class="num" id="2290761">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290767">if</span>&nbsp;<span class="ident" id="2290770">sa</span><span class="op" id="2290772">.</span><span class="ident" id="2290773">raw</span><span class="op" id="2290776">.</span><span class="ident" id="2290777">Path</span><span class="op" id="2290781">[</span><span class="num" id="2290782">0</span><span class="op" id="2290783">]</span>&nbsp;<span class="op" id="2290785">==</span>&nbsp;<span class="string" id="2290788">&#39;@&#39;</span>&nbsp;<span class="op" id="2290792">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290796">sa</span><span class="op" id="2290798">.</span><span class="ident" id="2290799">raw</span><span class="op" id="2290802">.</span><span class="ident" id="2290803">Path</span><span class="op" id="2290807">[</span><span class="num" id="2290808">0</span><span class="op" id="2290809">]</span>&nbsp;<span class="op" id="2290811">=</span>&nbsp;<span class="num" id="2290813">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2290817">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290869">sl</span><span class="op" id="2290871">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290879">return</span>&nbsp;<span class="ident" id="2290886">unsafe</span><span class="op" id="2290892">.</span><span class="ident" id="2290893">Pointer</span><span class="op" id="2290900">(</span><span class="op" id="2290901">&amp;</span><span class="ident" id="2290902">sa</span><span class="op" id="2290904">.</span><span class="ident" id="2290905">raw</span><span class="op" id="2290908">)</span><span class="op" id="2290909">,</span>&nbsp;<span class="ident" id="2290911">sl</span><span class="op" id="2290913">,</span>&nbsp;<span class="ident" id="2290915">nil</span><br>
<span class="lineno"></span><span class="op" id="2290919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2290922">type</span>&nbsp;<span class="ident" id="2290927">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2290945">struct</span>&nbsp;<span class="op" id="2290952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290955">Protocol</span>&nbsp;<span class="builtintype" id="2290964">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290972">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2290981">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290986">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2290995">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291003">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2291012">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291019">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2291028">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291035">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291044">[</span><span class="num" id="2291045">8</span><span class="op" id="2291046">]</span><span class="builtintype" id="2291047">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291053">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291062">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2291083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2291086">func</span>&nbsp;<span class="op" id="2291091">(</span><span class="ident" id="2291092">sa</span>&nbsp;<span class="op" id="2291095">*</span><span class="ident" id="2291096">SockaddrLinklayer</span><span class="op" id="2291113">)</span>&nbsp;<span class="ident" id="2291115">sockaddr</span><span class="op" id="2291123">(</span><span class="op" id="2291124">)</span>&nbsp;<span class="op" id="2291126">(</span><span class="ident" id="2291127">unsafe</span><span class="op" id="2291133">.</span><span class="ident" id="2291134">Pointer</span><span class="op" id="2291141">,</span>&nbsp;<span class="ident" id="2291143">_Socklen</span><span class="op" id="2291151">,</span>&nbsp;<span class="builtintype" id="2291153">error</span><span class="op" id="2291158">)</span>&nbsp;<span class="op" id="2291160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291163">if</span>&nbsp;<span class="ident" id="2291166">sa</span><span class="op" id="2291168">.</span><span class="ident" id="2291169">Ifindex</span>&nbsp;<span class="op" id="2291177">&lt;</span>&nbsp;<span class="num" id="2291179">0</span>&nbsp;<span class="op" id="2291181">||</span>&nbsp;<span class="ident" id="2291184">sa</span><span class="op" id="2291186">.</span><span class="ident" id="2291187">Ifindex</span>&nbsp;<span class="op" id="2291195">&gt;</span>&nbsp;<span class="num" id="2291197">0x7fffffff</span>&nbsp;<span class="op" id="2291208">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291212">return</span>&nbsp;<span class="ident" id="2291219">nil</span><span class="op" id="2291222">,</span>&nbsp;<span class="num" id="2291224">0</span><span class="op" id="2291225">,</span>&nbsp;<span class="ident" id="2291227">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291238">sa</span><span class="op" id="2291240">.</span><span class="ident" id="2291241">raw</span><span class="op" id="2291244">.</span><span class="ident" id="2291245">Family</span>&nbsp;<span class="op" id="2291252">=</span>&nbsp;<span class="ident" id="2291254">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291265">sa</span><span class="op" id="2291267">.</span><span class="ident" id="2291268">raw</span><span class="op" id="2291271">.</span><span class="ident" id="2291272">Protocol</span>&nbsp;<span class="op" id="2291281">=</span>&nbsp;<span class="ident" id="2291283">sa</span><span class="op" id="2291285">.</span><span class="ident" id="2291286">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291296">sa</span><span class="op" id="2291298">.</span><span class="ident" id="2291299">raw</span><span class="op" id="2291302">.</span><span class="ident" id="2291303">Ifindex</span>&nbsp;<span class="op" id="2291311">=</span>&nbsp;<span class="builtintype" id="2291313">int32</span><span class="op" id="2291318">(</span><span class="ident" id="2291319">sa</span><span class="op" id="2291321">.</span><span class="ident" id="2291322">Ifindex</span><span class="op" id="2291329">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291332">sa</span><span class="op" id="2291334">.</span><span class="ident" id="2291335">raw</span><span class="op" id="2291338">.</span><span class="ident" id="2291339">Hatype</span>&nbsp;<span class="op" id="2291346">=</span>&nbsp;<span class="ident" id="2291348">sa</span><span class="op" id="2291350">.</span><span class="ident" id="2291351">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291359">sa</span><span class="op" id="2291361">.</span><span class="ident" id="2291362">raw</span><span class="op" id="2291365">.</span><span class="ident" id="2291366">Pkttype</span>&nbsp;<span class="op" id="2291374">=</span>&nbsp;<span class="ident" id="2291376">sa</span><span class="op" id="2291378">.</span><span class="ident" id="2291379">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291388">sa</span><span class="op" id="2291390">.</span><span class="ident" id="2291391">raw</span><span class="op" id="2291394">.</span><span class="ident" id="2291395">Halen</span>&nbsp;<span class="op" id="2291401">=</span>&nbsp;<span class="ident" id="2291403">sa</span><span class="op" id="2291405">.</span><span class="ident" id="2291406">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291413">for</span>&nbsp;<span class="ident" id="2291417">i</span>&nbsp;<span class="op" id="2291419">:=</span>&nbsp;<span class="num" id="2291422">0</span><span class="op" id="2291423">;</span>&nbsp;<span class="ident" id="2291425">i</span>&nbsp;<span class="op" id="2291427">&lt;</span>&nbsp;<span class="builtinfunc" id="2291429">len</span><span class="op" id="2291432">(</span><span class="ident" id="2291433">sa</span><span class="op" id="2291435">.</span><span class="ident" id="2291436">Addr</span><span class="op" id="2291440">)</span><span class="op" id="2291441">;</span>&nbsp;<span class="ident" id="2291443">i</span><span class="op" id="2291444">++</span>&nbsp;<span class="op" id="2291447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291451">sa</span><span class="op" id="2291453">.</span><span class="ident" id="2291454">raw</span><span class="op" id="2291457">.</span><span class="ident" id="2291458">Addr</span><span class="op" id="2291462">[</span><span class="ident" id="2291463">i</span><span class="op" id="2291464">]</span>&nbsp;<span class="op" id="2291466">=</span>&nbsp;<span class="ident" id="2291468">sa</span><span class="op" id="2291470">.</span><span class="ident" id="2291471">Addr</span><span class="op" id="2291475">[</span><span class="ident" id="2291476">i</span><span class="op" id="2291477">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291483">return</span>&nbsp;<span class="ident" id="2291490">unsafe</span><span class="op" id="2291496">.</span><span class="ident" id="2291497">Pointer</span><span class="op" id="2291504">(</span><span class="op" id="2291505">&amp;</span><span class="ident" id="2291506">sa</span><span class="op" id="2291508">.</span><span class="ident" id="2291509">raw</span><span class="op" id="2291512">)</span><span class="op" id="2291513">,</span>&nbsp;<span class="ident" id="2291515">SizeofSockaddrLinklayer</span><span class="op" id="2291538">,</span>&nbsp;<span class="ident" id="2291540">nil</span><br>
<span class="lineno"></span><span class="op" id="2291544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2291547">type</span>&nbsp;<span class="ident" id="2291552">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2291568">struct</span>&nbsp;<span class="op" id="2291575">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291578">Family</span>&nbsp;<span class="builtintype" id="2291585">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291593">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2291600">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291608">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2291615">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291623">Groups</span>&nbsp;<span class="builtintype" id="2291630">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291638">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291645">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2291664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2291667">func</span>&nbsp;<span class="op" id="2291672">(</span><span class="ident" id="2291673">sa</span>&nbsp;<span class="op" id="2291676">*</span><span class="ident" id="2291677">SockaddrNetlink</span><span class="op" id="2291692">)</span>&nbsp;<span class="ident" id="2291694">sockaddr</span><span class="op" id="2291702">(</span><span class="op" id="2291703">)</span>&nbsp;<span class="op" id="2291705">(</span><span class="ident" id="2291706">unsafe</span><span class="op" id="2291712">.</span><span class="ident" id="2291713">Pointer</span><span class="op" id="2291720">,</span>&nbsp;<span class="ident" id="2291722">_Socklen</span><span class="op" id="2291730">,</span>&nbsp;<span class="builtintype" id="2291732">error</span><span class="op" id="2291737">)</span>&nbsp;<span class="op" id="2291739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291742">sa</span><span class="op" id="2291744">.</span><span class="ident" id="2291745">raw</span><span class="op" id="2291748">.</span><span class="ident" id="2291749">Family</span>&nbsp;<span class="op" id="2291756">=</span>&nbsp;<span class="ident" id="2291758">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291770">sa</span><span class="op" id="2291772">.</span><span class="ident" id="2291773">raw</span><span class="op" id="2291776">.</span><span class="ident" id="2291777">Pad</span>&nbsp;<span class="op" id="2291781">=</span>&nbsp;<span class="ident" id="2291783">sa</span><span class="op" id="2291785">.</span><span class="ident" id="2291786">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291791">sa</span><span class="op" id="2291793">.</span><span class="ident" id="2291794">raw</span><span class="op" id="2291797">.</span><span class="ident" id="2291798">Pid</span>&nbsp;<span class="op" id="2291802">=</span>&nbsp;<span class="ident" id="2291804">sa</span><span class="op" id="2291806">.</span><span class="ident" id="2291807">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291812">sa</span><span class="op" id="2291814">.</span><span class="ident" id="2291815">raw</span><span class="op" id="2291818">.</span><span class="ident" id="2291819">Groups</span>&nbsp;<span class="op" id="2291826">=</span>&nbsp;<span class="ident" id="2291828">sa</span><span class="op" id="2291830">.</span><span class="ident" id="2291831">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291839">return</span>&nbsp;<span class="ident" id="2291846">unsafe</span><span class="op" id="2291852">.</span><span class="ident" id="2291853">Pointer</span><span class="op" id="2291860">(</span><span class="op" id="2291861">&amp;</span><span class="ident" id="2291862">sa</span><span class="op" id="2291864">.</span><span class="ident" id="2291865">raw</span><span class="op" id="2291868">)</span><span class="op" id="2291869">,</span>&nbsp;<span class="ident" id="2291871">SizeofSockaddrNetlink</span><span class="op" id="2291892">,</span>&nbsp;<span class="ident" id="2291894">nil</span><br>
<span class="lineno"></span><span class="op" id="2291898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2291901">func</span>&nbsp;<span class="ident" id="2291906">anyToSockaddr</span><span class="op" id="2291919">(</span><span class="ident" id="2291920">rsa</span>&nbsp;<span class="op" id="2291924">*</span><span class="ident" id="2291925">RawSockaddrAny</span><span class="op" id="2291939">)</span>&nbsp;<span class="op" id="2291941">(</span><span class="ident" id="2291942">Sockaddr</span><span class="op" id="2291950">,</span>&nbsp;<span class="builtintype" id="2291952">error</span><span class="op" id="2291957">)</span>&nbsp;<span class="op" id="2291959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291962">switch</span>&nbsp;<span class="ident" id="2291969">rsa</span><span class="op" id="2291972">.</span><span class="ident" id="2291973">Addr</span><span class="op" id="2291977">.</span><span class="ident" id="2291978">Family</span>&nbsp;<span class="op" id="2291985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291988">case</span>&nbsp;<span class="ident" id="2291993">AF_NETLINK</span><span class="op" id="2292003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292007">pp</span>&nbsp;<span class="op" id="2292010">:=</span>&nbsp;<span class="op" id="2292013">(</span><span class="op" id="2292014">*</span><span class="ident" id="2292015">RawSockaddrNetlink</span><span class="op" id="2292033">)</span><span class="op" id="2292034">(</span><span class="ident" id="2292035">unsafe</span><span class="op" id="2292041">.</span><span class="ident" id="2292042">Pointer</span><span class="op" id="2292049">(</span><span class="ident" id="2292050">rsa</span><span class="op" id="2292053">)</span><span class="op" id="2292054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292058">sa</span>&nbsp;<span class="op" id="2292061">:=</span>&nbsp;<span class="builtinfunc" id="2292064">new</span><span class="op" id="2292067">(</span><span class="ident" id="2292068">SockaddrNetlink</span><span class="op" id="2292083">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292087">sa</span><span class="op" id="2292089">.</span><span class="ident" id="2292090">Family</span>&nbsp;<span class="op" id="2292097">=</span>&nbsp;<span class="ident" id="2292099">pp</span><span class="op" id="2292101">.</span><span class="ident" id="2292102">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292111">sa</span><span class="op" id="2292113">.</span><span class="ident" id="2292114">Pad</span>&nbsp;<span class="op" id="2292118">=</span>&nbsp;<span class="ident" id="2292120">pp</span><span class="op" id="2292122">.</span><span class="ident" id="2292123">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292129">sa</span><span class="op" id="2292131">.</span><span class="ident" id="2292132">Pid</span>&nbsp;<span class="op" id="2292136">=</span>&nbsp;<span class="ident" id="2292138">pp</span><span class="op" id="2292140">.</span><span class="ident" id="2292141">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292147">sa</span><span class="op" id="2292149">.</span><span class="ident" id="2292150">Groups</span>&nbsp;<span class="op" id="2292157">=</span>&nbsp;<span class="ident" id="2292159">pp</span><span class="op" id="2292161">.</span><span class="ident" id="2292162">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292171">return</span>&nbsp;<span class="ident" id="2292178">sa</span><span class="op" id="2292180">,</span>&nbsp;<span class="ident" id="2292182">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292188">case</span>&nbsp;<span class="ident" id="2292193">AF_PACKET</span><span class="op" id="2292202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292206">pp</span>&nbsp;<span class="op" id="2292209">:=</span>&nbsp;<span class="op" id="2292212">(</span><span class="op" id="2292213">*</span><span class="ident" id="2292214">RawSockaddrLinklayer</span><span class="op" id="2292234">)</span><span class="op" id="2292235">(</span><span class="ident" id="2292236">unsafe</span><span class="op" id="2292242">.</span><span class="ident" id="2292243">Pointer</span><span class="op" id="2292250">(</span><span class="ident" id="2292251">rsa</span><span class="op" id="2292254">)</span><span class="op" id="2292255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292259">sa</span>&nbsp;<span class="op" id="2292262">:=</span>&nbsp;<span class="builtinfunc" id="2292265">new</span><span class="op" id="2292268">(</span><span class="ident" id="2292269">SockaddrLinklayer</span><span class="op" id="2292286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292290">sa</span><span class="op" id="2292292">.</span><span class="ident" id="2292293">Protocol</span>&nbsp;<span class="op" id="2292302">=</span>&nbsp;<span class="ident" id="2292304">pp</span><span class="op" id="2292306">.</span><span class="ident" id="2292307">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292318">sa</span><span class="op" id="2292320">.</span><span class="ident" id="2292321">Ifindex</span>&nbsp;<span class="op" id="2292329">=</span>&nbsp;<span class="builtintype" id="2292331">int</span><span class="op" id="2292334">(</span><span class="ident" id="2292335">pp</span><span class="op" id="2292337">.</span><span class="ident" id="2292338">Ifindex</span><span class="op" id="2292345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292349">sa</span><span class="op" id="2292351">.</span><span class="ident" id="2292352">Hatype</span>&nbsp;<span class="op" id="2292359">=</span>&nbsp;<span class="ident" id="2292361">pp</span><span class="op" id="2292363">.</span><span class="ident" id="2292364">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292373">sa</span><span class="op" id="2292375">.</span><span class="ident" id="2292376">Pkttype</span>&nbsp;<span class="op" id="2292384">=</span>&nbsp;<span class="ident" id="2292386">pp</span><span class="op" id="2292388">.</span><span class="ident" id="2292389">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292399">sa</span><span class="op" id="2292401">.</span><span class="ident" id="2292402">Halen</span>&nbsp;<span class="op" id="2292408">=</span>&nbsp;<span class="ident" id="2292410">pp</span><span class="op" id="2292412">.</span><span class="ident" id="2292413">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292421">for</span>&nbsp;<span class="ident" id="2292425">i</span>&nbsp;<span class="op" id="2292427">:=</span>&nbsp;<span class="num" id="2292430">0</span><span class="op" id="2292431">;</span>&nbsp;<span class="ident" id="2292433">i</span>&nbsp;<span class="op" id="2292435">&lt;</span>&nbsp;<span class="builtinfunc" id="2292437">len</span><span class="op" id="2292440">(</span><span class="ident" id="2292441">sa</span><span class="op" id="2292443">.</span><span class="ident" id="2292444">Addr</span><span class="op" id="2292448">)</span><span class="op" id="2292449">;</span>&nbsp;<span class="ident" id="2292451">i</span><span class="op" id="2292452">++</span>&nbsp;<span class="op" id="2292455">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292460">sa</span><span class="op" id="2292462">.</span><span class="ident" id="2292463">Addr</span><span class="op" id="2292467">[</span><span class="ident" id="2292468">i</span><span class="op" id="2292469">]</span>&nbsp;<span class="op" id="2292471">=</span>&nbsp;<span class="ident" id="2292473">pp</span><span class="op" id="2292475">.</span><span class="ident" id="2292476">Addr</span><span class="op" id="2292480">[</span><span class="ident" id="2292481">i</span><span class="op" id="2292482">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292490">return</span>&nbsp;<span class="ident" id="2292497">sa</span><span class="op" id="2292499">,</span>&nbsp;<span class="ident" id="2292501">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292507">case</span>&nbsp;<span class="ident" id="2292512">AF_UNIX</span><span class="op" id="2292519">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292523">pp</span>&nbsp;<span class="op" id="2292526">:=</span>&nbsp;<span class="op" id="2292529">(</span><span class="op" id="2292530">*</span><span class="ident" id="2292531">RawSockaddrUnix</span><span class="op" id="2292546">)</span><span class="op" id="2292547">(</span><span class="ident" id="2292548">unsafe</span><span class="op" id="2292554">.</span><span class="ident" id="2292555">Pointer</span><span class="op" id="2292562">(</span><span class="ident" id="2292563">rsa</span><span class="op" id="2292566">)</span><span class="op" id="2292567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292571">sa</span>&nbsp;<span class="op" id="2292574">:=</span>&nbsp;<span class="builtinfunc" id="2292577">new</span><span class="op" id="2292580">(</span><span class="ident" id="2292581">SockaddrUnix</span><span class="op" id="2292593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292597">if</span>&nbsp;<span class="ident" id="2292600">pp</span><span class="op" id="2292602">.</span><span class="ident" id="2292603">Path</span><span class="op" id="2292607">[</span><span class="num" id="2292608">0</span><span class="op" id="2292609">]</span>&nbsp;<span class="op" id="2292611">==</span>&nbsp;<span class="num" id="2292614">0</span>&nbsp;<span class="op" id="2292616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292621">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292658">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292710">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292751">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292793">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292833">pp</span><span class="op" id="2292835">.</span><span class="ident" id="2292836">Path</span><span class="op" id="2292840">[</span><span class="num" id="2292841">0</span><span class="op" id="2292842">]</span>&nbsp;<span class="op" id="2292844">=</span>&nbsp;<span class="string" id="2292846">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292852">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292857">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292887">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292940">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292993">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2293047">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293083">n</span>&nbsp;<span class="op" id="2293085">:=</span>&nbsp;<span class="num" id="2293088">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293092">for</span>&nbsp;<span class="ident" id="2293096">n</span>&nbsp;<span class="op" id="2293098">&lt;</span>&nbsp;<span class="builtinfunc" id="2293100">len</span><span class="op" id="2293103">(</span><span class="ident" id="2293104">pp</span><span class="op" id="2293106">.</span><span class="ident" id="2293107">Path</span><span class="op" id="2293111">)</span>&nbsp;<span class="op" id="2293113">&amp;&amp;</span>&nbsp;<span class="ident" id="2293116">pp</span><span class="op" id="2293118">.</span><span class="ident" id="2293119">Path</span><span class="op" id="2293123">[</span><span class="ident" id="2293124">n</span><span class="op" id="2293125">]</span>&nbsp;<span class="op" id="2293127">!=</span>&nbsp;<span class="num" id="2293130">0</span>&nbsp;<span class="op" id="2293132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293137">n</span><span class="op" id="2293138">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293143">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293147">bytes</span>&nbsp;<span class="op" id="2293153">:=</span>&nbsp;<span class="op" id="2293156">(</span><span class="op" id="2293157">*</span><span class="op" id="2293158">[</span><span class="num" id="2293159">10000</span><span class="op" id="2293164">]</span><span class="builtintype" id="2293165">byte</span><span class="op" id="2293169">)</span><span class="op" id="2293170">(</span><span class="ident" id="2293171">unsafe</span><span class="op" id="2293177">.</span><span class="ident" id="2293178">Pointer</span><span class="op" id="2293185">(</span><span class="op" id="2293186">&amp;</span><span class="ident" id="2293187">pp</span><span class="op" id="2293189">.</span><span class="ident" id="2293190">Path</span><span class="op" id="2293194">[</span><span class="num" id="2293195">0</span><span class="op" id="2293196">]</span><span class="op" id="2293197">)</span><span class="op" id="2293198">)</span><span class="op" id="2293199">[</span><span class="num" id="2293200">0</span><span class="op" id="2293201">:</span><span class="ident" id="2293202">n</span><span class="op" id="2293203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293207">sa</span><span class="op" id="2293209">.</span><span class="ident" id="2293210">Name</span>&nbsp;<span class="op" id="2293215">=</span>&nbsp;<span class="builtintype" id="2293217">string</span><span class="op" id="2293223">(</span><span class="ident" id="2293224">bytes</span><span class="op" id="2293229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293233">return</span>&nbsp;<span class="ident" id="2293240">sa</span><span class="op" id="2293242">,</span>&nbsp;<span class="ident" id="2293244">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293250">case</span>&nbsp;<span class="ident" id="2293255">AF_INET</span><span class="op" id="2293262">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293266">pp</span>&nbsp;<span class="op" id="2293269">:=</span>&nbsp;<span class="op" id="2293272">(</span><span class="op" id="2293273">*</span><span class="ident" id="2293274">RawSockaddrInet4</span><span class="op" id="2293290">)</span><span class="op" id="2293291">(</span><span class="ident" id="2293292">unsafe</span><span class="op" id="2293298">.</span><span class="ident" id="2293299">Pointer</span><span class="op" id="2293306">(</span><span class="ident" id="2293307">rsa</span><span class="op" id="2293310">)</span><span class="op" id="2293311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293315">sa</span>&nbsp;<span class="op" id="2293318">:=</span>&nbsp;<span class="builtinfunc" id="2293321">new</span><span class="op" id="2293324">(</span><span class="ident" id="2293325">SockaddrInet4</span><span class="op" id="2293338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293342">p</span>&nbsp;<span class="op" id="2293344">:=</span>&nbsp;<span class="op" id="2293347">(</span><span class="op" id="2293348">*</span><span class="op" id="2293349">[</span><span class="num" id="2293350">2</span><span class="op" id="2293351">]</span><span class="builtintype" id="2293352">byte</span><span class="op" id="2293356">)</span><span class="op" id="2293357">(</span><span class="ident" id="2293358">unsafe</span><span class="op" id="2293364">.</span><span class="ident" id="2293365">Pointer</span><span class="op" id="2293372">(</span><span class="op" id="2293373">&amp;</span><span class="ident" id="2293374">pp</span><span class="op" id="2293376">.</span><span class="ident" id="2293377">Port</span><span class="op" id="2293381">)</span><span class="op" id="2293382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293386">sa</span><span class="op" id="2293388">.</span><span class="ident" id="2293389">Port</span>&nbsp;<span class="op" id="2293394">=</span>&nbsp;<span class="builtintype" id="2293396">int</span><span class="op" id="2293399">(</span><span class="ident" id="2293400">p</span><span class="op" id="2293401">[</span><span class="num" id="2293402">0</span><span class="op" id="2293403">]</span><span class="op" id="2293404">)</span><span class="op" id="2293405">&lt;&lt;</span><span class="num" id="2293407">8</span>&nbsp;<span class="op" id="2293409">+</span>&nbsp;<span class="builtintype" id="2293411">int</span><span class="op" id="2293414">(</span><span class="ident" id="2293415">p</span><span class="op" id="2293416">[</span><span class="num" id="2293417">1</span><span class="op" id="2293418">]</span><span class="op" id="2293419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293423">for</span>&nbsp;<span class="ident" id="2293427">i</span>&nbsp;<span class="op" id="2293429">:=</span>&nbsp;<span class="num" id="2293432">0</span><span class="op" id="2293433">;</span>&nbsp;<span class="ident" id="2293435">i</span>&nbsp;<span class="op" id="2293437">&lt;</span>&nbsp;<span class="builtinfunc" id="2293439">len</span><span class="op" id="2293442">(</span><span class="ident" id="2293443">sa</span><span class="op" id="2293445">.</span><span class="ident" id="2293446">Addr</span><span class="op" id="2293450">)</span><span class="op" id="2293451">;</span>&nbsp;<span class="ident" id="2293453">i</span><span class="op" id="2293454">++</span>&nbsp;<span class="op" id="2293457">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293462">sa</span><span class="op" id="2293464">.</span><span class="ident" id="2293465">Addr</span><span class="op" id="2293469">[</span><span class="ident" id="2293470">i</span><span class="op" id="2293471">]</span>&nbsp;<span class="op" id="2293473">=</span>&nbsp;<span class="ident" id="2293475">pp</span><span class="op" id="2293477">.</span><span class="ident" id="2293478">Addr</span><span class="op" id="2293482">[</span><span class="ident" id="2293483">i</span><span class="op" id="2293484">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293492">return</span>&nbsp;<span class="ident" id="2293499">sa</span><span class="op" id="2293501">,</span>&nbsp;<span class="ident" id="2293503">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293509">case</span>&nbsp;<span class="ident" id="2293514">AF_INET6</span><span class="op" id="2293522">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293526">pp</span>&nbsp;<span class="op" id="2293529">:=</span>&nbsp;<span class="op" id="2293532">(</span><span class="op" id="2293533">*</span><span class="ident" id="2293534">RawSockaddrInet6</span><span class="op" id="2293550">)</span><span class="op" id="2293551">(</span><span class="ident" id="2293552">unsafe</span><span class="op" id="2293558">.</span><span class="ident" id="2293559">Pointer</span><span class="op" id="2293566">(</span><span class="ident" id="2293567">rsa</span><span class="op" id="2293570">)</span><span class="op" id="2293571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293575">sa</span>&nbsp;<span class="op" id="2293578">:=</span>&nbsp;<span class="builtinfunc" id="2293581">new</span><span class="op" id="2293584">(</span><span class="ident" id="2293585">SockaddrInet6</span><span class="op" id="2293598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293602">p</span>&nbsp;<span class="op" id="2293604">:=</span>&nbsp;<span class="op" id="2293607">(</span><span class="op" id="2293608">*</span><span class="op" id="2293609">[</span><span class="num" id="2293610">2</span><span class="op" id="2293611">]</span><span class="builtintype" id="2293612">byte</span><span class="op" id="2293616">)</span><span class="op" id="2293617">(</span><span class="ident" id="2293618">unsafe</span><span class="op" id="2293624">.</span><span class="ident" id="2293625">Pointer</span><span class="op" id="2293632">(</span><span class="op" id="2293633">&amp;</span><span class="ident" id="2293634">pp</span><span class="op" id="2293636">.</span><span class="ident" id="2293637">Port</span><span class="op" id="2293641">)</span><span class="op" id="2293642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293646">sa</span><span class="op" id="2293648">.</span><span class="ident" id="2293649">Port</span>&nbsp;<span class="op" id="2293654">=</span>&nbsp;<span class="builtintype" id="2293656">int</span><span class="op" id="2293659">(</span><span class="ident" id="2293660">p</span><span class="op" id="2293661">[</span><span class="num" id="2293662">0</span><span class="op" id="2293663">]</span><span class="op" id="2293664">)</span><span class="op" id="2293665">&lt;&lt;</span><span class="num" id="2293667">8</span>&nbsp;<span class="op" id="2293669">+</span>&nbsp;<span class="builtintype" id="2293671">int</span><span class="op" id="2293674">(</span><span class="ident" id="2293675">p</span><span class="op" id="2293676">[</span><span class="num" id="2293677">1</span><span class="op" id="2293678">]</span><span class="op" id="2293679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293683">sa</span><span class="op" id="2293685">.</span><span class="ident" id="2293686">ZoneId</span>&nbsp;<span class="op" id="2293693">=</span>&nbsp;<span class="ident" id="2293695">pp</span><span class="op" id="2293697">.</span><span class="ident" id="2293698">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293709">for</span>&nbsp;<span class="ident" id="2293713">i</span>&nbsp;<span class="op" id="2293715">:=</span>&nbsp;<span class="num" id="2293718">0</span><span class="op" id="2293719">;</span>&nbsp;<span class="ident" id="2293721">i</span>&nbsp;<span class="op" id="2293723">&lt;</span>&nbsp;<span class="builtinfunc" id="2293725">len</span><span class="op" id="2293728">(</span><span class="ident" id="2293729">sa</span><span class="op" id="2293731">.</span><span class="ident" id="2293732">Addr</span><span class="op" id="2293736">)</span><span class="op" id="2293737">;</span>&nbsp;<span class="ident" id="2293739">i</span><span class="op" id="2293740">++</span>&nbsp;<span class="op" id="2293743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293748">sa</span><span class="op" id="2293750">.</span><span class="ident" id="2293751">Addr</span><span class="op" id="2293755">[</span><span class="ident" id="2293756">i</span><span class="op" id="2293757">]</span>&nbsp;<span class="op" id="2293759">=</span>&nbsp;<span class="ident" id="2293761">pp</span><span class="op" id="2293763">.</span><span class="ident" id="2293764">Addr</span><span class="op" id="2293768">[</span><span class="ident" id="2293769">i</span><span class="op" id="2293770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293778">return</span>&nbsp;<span class="ident" id="2293785">sa</span><span class="op" id="2293787">,</span>&nbsp;<span class="ident" id="2293789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293794">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293797">return</span>&nbsp;<span class="ident" id="2293804">nil</span><span class="op" id="2293807">,</span>&nbsp;<span class="ident" id="2293809">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2293822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2293825">func</span>&nbsp;<span class="ident" id="2293830">Accept</span><span class="op" id="2293836">(</span><span class="ident" id="2293837">fd</span>&nbsp;<span class="builtintype" id="2293840">int</span><span class="op" id="2293843">)</span>&nbsp;<span class="op" id="2293845">(</span><span class="ident" id="2293846">nfd</span>&nbsp;<span class="builtintype" id="2293850">int</span><span class="op" id="2293853">,</span>&nbsp;<span class="ident" id="2293855">sa</span>&nbsp;<span class="ident" id="2293858">Sockaddr</span><span class="op" id="2293866">,</span>&nbsp;<span class="ident" id="2293868">err</span>&nbsp;<span class="builtintype" id="2293872">error</span><span class="op" id="2293877">)</span>&nbsp;<span class="op" id="2293879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293882">var</span>&nbsp;<span class="ident" id="2293886">rsa</span>&nbsp;<span class="ident" id="2293890">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293906">var</span>&nbsp;<span class="builtinfunc" id="2293910">len</span>&nbsp;<span class="ident" id="2293914">_Socklen</span>&nbsp;<span class="op" id="2293923">=</span>&nbsp;<span class="ident" id="2293925">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293944">nfd</span><span class="op" id="2293947">,</span>&nbsp;<span class="ident" id="2293949">err</span>&nbsp;<span class="op" id="2293953">=</span>&nbsp;<span class="ident" id="2293955">accept</span><span class="op" id="2293961">(</span><span class="ident" id="2293962">fd</span><span class="op" id="2293964">,</span>&nbsp;<span class="op" id="2293966">&amp;</span><span class="ident" id="2293967">rsa</span><span class="op" id="2293970">,</span>&nbsp;<span class="op" id="2293972">&amp;</span><span class="builtinfunc" id="2293973">len</span><span class="op" id="2293976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293979">if</span>&nbsp;<span class="ident" id="2293982">err</span>&nbsp;<span class="op" id="2293986">!=</span>&nbsp;<span class="ident" id="2293989">nil</span>&nbsp;<span class="op" id="2293993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293997">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294005">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294008">sa</span><span class="op" id="2294010">,</span>&nbsp;<span class="ident" id="2294012">err</span>&nbsp;<span class="op" id="2294016">=</span>&nbsp;<span class="ident" id="2294018">anyToSockaddr</span><span class="op" id="2294031">(</span><span class="op" id="2294032">&amp;</span><span class="ident" id="2294033">rsa</span><span class="op" id="2294036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294039">if</span>&nbsp;<span class="ident" id="2294042">err</span>&nbsp;<span class="op" id="2294046">!=</span>&nbsp;<span class="ident" id="2294049">nil</span>&nbsp;<span class="op" id="2294053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294057">Close</span><span class="op" id="2294062">(</span><span class="ident" id="2294063">nfd</span><span class="op" id="2294066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294070">nfd</span>&nbsp;<span class="op" id="2294074">=</span>&nbsp;<span class="num" id="2294076">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294079">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294082">return</span><br>
<span class="lineno"></span><span class="op" id="2294089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2294092">func</span>&nbsp;<span class="ident" id="2294097">Accept4</span><span class="op" id="2294104">(</span><span class="ident" id="2294105">fd</span>&nbsp;<span class="builtintype" id="2294108">int</span><span class="op" id="2294111">,</span>&nbsp;<span class="ident" id="2294113">flags</span>&nbsp;<span class="builtintype" id="2294119">int</span><span class="op" id="2294122">)</span>&nbsp;<span class="op" id="2294124">(</span><span class="ident" id="2294125">nfd</span>&nbsp;<span class="builtintype" id="2294129">int</span><span class="op" id="2294132">,</span>&nbsp;<span class="ident" id="2294134">sa</span>&nbsp;<span class="ident" id="2294137">Sockaddr</span><span class="op" id="2294145">,</span>&nbsp;<span class="ident" id="2294147">err</span>&nbsp;<span class="builtintype" id="2294151">error</span><span class="op" id="2294156">)</span>&nbsp;<span class="op" id="2294158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294161">var</span>&nbsp;<span class="ident" id="2294165">rsa</span>&nbsp;<span class="ident" id="2294169">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294185">var</span>&nbsp;<span class="builtinfunc" id="2294189">len</span>&nbsp;<span class="ident" id="2294193">_Socklen</span>&nbsp;<span class="op" id="2294202">=</span>&nbsp;<span class="ident" id="2294204">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294223">nfd</span><span class="op" id="2294226">,</span>&nbsp;<span class="ident" id="2294228">err</span>&nbsp;<span class="op" id="2294232">=</span>&nbsp;<span class="ident" id="2294234">accept4</span><span class="op" id="2294241">(</span><span class="ident" id="2294242">fd</span><span class="op" id="2294244">,</span>&nbsp;<span class="op" id="2294246">&amp;</span><span class="ident" id="2294247">rsa</span><span class="op" id="2294250">,</span>&nbsp;<span class="op" id="2294252">&amp;</span><span class="builtinfunc" id="2294253">len</span><span class="op" id="2294256">,</span>&nbsp;<span class="ident" id="2294258">flags</span><span class="op" id="2294263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294266">if</span>&nbsp;<span class="ident" id="2294269">err</span>&nbsp;<span class="op" id="2294273">!=</span>&nbsp;<span class="ident" id="2294276">nil</span>&nbsp;<span class="op" id="2294280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294284">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294292">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294295">if</span>&nbsp;<span class="builtinfunc" id="2294298">len</span>&nbsp;<span class="op" id="2294302">&gt;</span>&nbsp;<span class="ident" id="2294304">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2294322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2294326">panic</span><span class="op" id="2294331">(</span><span class="string" id="2294332">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2294358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294364">sa</span><span class="op" id="2294366">,</span>&nbsp;<span class="ident" id="2294368">err</span>&nbsp;<span class="op" id="2294372">=</span>&nbsp;<span class="ident" id="2294374">anyToSockaddr</span><span class="op" id="2294387">(</span><span class="op" id="2294388">&amp;</span><span class="ident" id="2294389">rsa</span><span class="op" id="2294392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294395">if</span>&nbsp;<span class="ident" id="2294398">err</span>&nbsp;<span class="op" id="2294402">!=</span>&nbsp;<span class="ident" id="2294405">nil</span>&nbsp;<span class="op" id="2294409">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294413">Close</span><span class="op" id="2294418">(</span><span class="ident" id="2294419">nfd</span><span class="op" id="2294422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294426">nfd</span>&nbsp;<span class="op" id="2294430">=</span>&nbsp;<span class="num" id="2294432">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294438">return</span><br>
<span class="lineno"></span><span class="op" id="2294445">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2294448">func</span>&nbsp;<span class="ident" id="2294453">Getsockname</span><span class="op" id="2294464">(</span><span class="ident" id="2294465">fd</span>&nbsp;<span class="builtintype" id="2294468">int</span><span class="op" id="2294471">)</span>&nbsp;<span class="op" id="2294473">(</span><span class="ident" id="2294474">sa</span>&nbsp;<span class="ident" id="2294477">Sockaddr</span><span class="op" id="2294485">,</span>&nbsp;<span class="ident" id="2294487">err</span>&nbsp;<span class="builtintype" id="2294491">error</span><span class="op" id="2294496">)</span>&nbsp;<span class="op" id="2294498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294501">var</span>&nbsp;<span class="ident" id="2294505">rsa</span>&nbsp;<span class="ident" id="2294509">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294525">var</span>&nbsp;<span class="builtinfunc" id="2294529">len</span>&nbsp;<span class="ident" id="2294533">_Socklen</span>&nbsp;<span class="op" id="2294542">=</span>&nbsp;<span class="ident" id="2294544">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294563">if</span>&nbsp;<span class="ident" id="2294566">err</span>&nbsp;<span class="op" id="2294570">=</span>&nbsp;<span class="ident" id="2294572">getsockname</span><span class="op" id="2294583">(</span><span class="ident" id="2294584">fd</span><span class="op" id="2294586">,</span>&nbsp;<span class="op" id="2294588">&amp;</span><span class="ident" id="2294589">rsa</span><span class="op" id="2294592">,</span>&nbsp;<span class="op" id="2294594">&amp;</span><span class="builtinfunc" id="2294595">len</span><span class="op" id="2294598">)</span><span class="op" id="2294599">;</span>&nbsp;<span class="ident" id="2294601">err</span>&nbsp;<span class="op" id="2294605">!=</span>&nbsp;<span class="ident" id="2294608">nil</span>&nbsp;<span class="op" id="2294612">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294627">return</span>&nbsp;<span class="ident" id="2294634">anyToSockaddr</span><span class="op" id="2294647">(</span><span class="op" id="2294648">&amp;</span><span class="ident" id="2294649">rsa</span><span class="op" id="2294652">)</span><br>
<span class="lineno"></span><span class="op" id="2294654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2294657">func</span>&nbsp;<span class="ident" id="2294662">GetsockoptInet4Addr</span><span class="op" id="2294681">(</span><span class="ident" id="2294682">fd</span><span class="op" id="2294684">,</span>&nbsp;<span class="ident" id="2294686">level</span><span class="op" id="2294691">,</span>&nbsp;<span class="ident" id="2294693">opt</span>&nbsp;<span class="builtintype" id="2294697">int</span><span class="op" id="2294700">)</span>&nbsp;<span class="op" id="2294702">(</span><span class="ident" id="2294703">value</span>&nbsp;<span class="op" id="2294709">[</span><span class="num" id="2294710">4</span><span class="op" id="2294711">]</span><span class="builtintype" id="2294712">byte</span><span class="op" id="2294716">,</span>&nbsp;<span class="ident" id="2294718">err</span>&nbsp;<span class="builtintype" id="2294722">error</span><span class="op" id="2294727">)</span>&nbsp;<span class="op" id="2294729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294732">vallen</span>&nbsp;<span class="op" id="2294739">:=</span>&nbsp;<span class="ident" id="2294742">_Socklen</span><span class="op" id="2294750">(</span><span class="num" id="2294751">4</span><span class="op" id="2294752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294755">err</span>&nbsp;<span class="op" id="2294759">=</span>&nbsp;<span class="ident" id="2294761">getsockopt</span><span class="op" id="2294771">(</span><span class="ident" id="2294772">fd</span><span class="op" id="2294774">,</span>&nbsp;<span class="ident" id="2294776">level</span><span class="op" id="2294781">,</span>&nbsp;<span class="ident" id="2294783">opt</span><span class="op" id="2294786">,</span>&nbsp;<span class="ident" id="2294788">unsafe</span><span class="op" id="2294794">.</span><span class="ident" id="2294795">Pointer</span><span class="op" id="2294802">(</span><span class="op" id="2294803">&amp;</span><span class="ident" id="2294804">value</span><span class="op" id="2294809">[</span><span class="num" id="2294810">0</span><span class="op" id="2294811">]</span><span class="op" id="2294812">)</span><span class="op" id="2294813">,</span>&nbsp;<span class="op" id="2294815">&amp;</span><span class="ident" id="2294816">vallen</span><span class="op" id="2294822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294825">return</span>&nbsp;<span class="ident" id="2294832">value</span><span class="op" id="2294837">,</span>&nbsp;<span class="ident" id="2294839">err</span><br>
<span class="lineno"></span><span class="op" id="2294843">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2294846">func</span>&nbsp;<span class="ident" id="2294851">GetsockoptIPMreq</span><span class="op" id="2294867">(</span><span class="ident" id="2294868">fd</span><span class="op" id="2294870">,</span>&nbsp;<span class="ident" id="2294872">level</span><span class="op" id="2294877">,</span>&nbsp;<span class="ident" id="2294879">opt</span>&nbsp;<span class="builtintype" id="2294883">int</span><span class="op" id="2294886">)</span>&nbsp;<span class="op" id="2294888">(</span><span class="op" id="2294889">*</span><span class="ident" id="2294890">IPMreq</span><span class="op" id="2294896">,</span>&nbsp;<span class="builtintype" id="2294898">error</span><span class="op" id="2294903">)</span>&nbsp;<span class="op" id="2294905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294908">var</span>&nbsp;<span class="ident" id="2294912">value</span>&nbsp;<span class="ident" id="2294918">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294926">vallen</span>&nbsp;<span class="op" id="2294933">:=</span>&nbsp;<span class="ident" id="2294936">_Socklen</span><span class="op" id="2294944">(</span><span class="ident" id="2294945">SizeofIPMreq</span><span class="op" id="2294957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294960">err</span>&nbsp;<span class="op" id="2294964">:=</span>&nbsp;<span class="ident" id="2294967">getsockopt</span><span class="op" id="2294977">(</span><span class="ident" id="2294978">fd</span><span class="op" id="2294980">,</span>&nbsp;<span class="ident" id="2294982">level</span><span class="op" id="2294987">,</span>&nbsp;<span class="ident" id="2294989">opt</span><span class="op" id="2294992">,</span>&nbsp;<span class="ident" id="2294994">unsafe</span><span class="op" id="2295000">.</span><span class="ident" id="2295001">Pointer</span><span class="op" id="2295008">(</span><span class="op" id="2295009">&amp;</span><span class="ident" id="2295010">value</span><span class="op" id="2295015">)</span><span class="op" id="2295016">,</span>&nbsp;<span class="op" id="2295018">&amp;</span><span class="ident" id="2295019">vallen</span><span class="op" id="2295025">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295028">return</span>&nbsp;<span class="op" id="2295035">&amp;</span><span class="ident" id="2295036">value</span><span class="op" id="2295041">,</span>&nbsp;<span class="ident" id="2295043">err</span><br>
<span class="lineno"></span><span class="op" id="2295047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2295050">func</span>&nbsp;<span class="ident" id="2295055">GetsockoptIPMreqn</span><span class="op" id="2295072">(</span><span class="ident" id="2295073">fd</span><span class="op" id="2295075">,</span>&nbsp;<span class="ident" id="2295077">level</span><span class="op" id="2295082">,</span>&nbsp;<span class="ident" id="2295084">opt</span>&nbsp;<span class="builtintype" id="2295088">int</span><span class="op" id="2295091">)</span>&nbsp;<span class="op" id="2295093">(</span><span class="op" id="2295094">*</span><span class="ident" id="2295095">IPMreqn</span><span class="op" id="2295102">,</span>&nbsp;<span class="builtintype" id="2295104">error</span><span class="op" id="2295109">)</span>&nbsp;<span class="op" id="2295111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295114">var</span>&nbsp;<span class="ident" id="2295118">value</span>&nbsp;<span class="ident" id="2295124">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295133">vallen</span>&nbsp;<span class="op" id="2295140">:=</span>&nbsp;<span class="ident" id="2295143">_Socklen</span><span class="op" id="2295151">(</span><span class="ident" id="2295152">SizeofIPMreqn</span><span class="op" id="2295165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295168">err</span>&nbsp;<span class="op" id="2295172">:=</span>&nbsp;<span class="ident" id="2295175">getsockopt</span><span class="op" id="2295185">(</span><span class="ident" id="2295186">fd</span><span class="op" id="2295188">,</span>&nbsp;<span class="ident" id="2295190">level</span><span class="op" id="2295195">,</span>&nbsp;<span class="ident" id="2295197">opt</span><span class="op" id="2295200">,</span>&nbsp;<span class="ident" id="2295202">unsafe</span><span class="op" id="2295208">.</span><span class="ident" id="2295209">Pointer</span><span class="op" id="2295216">(</span><span class="op" id="2295217">&amp;</span><span class="ident" id="2295218">value</span><span class="op" id="2295223">)</span><span class="op" id="2295224">,</span>&nbsp;<span class="op" id="2295226">&amp;</span><span class="ident" id="2295227">vallen</span><span class="op" id="2295233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295236">return</span>&nbsp;<span class="op" id="2295243">&amp;</span><span class="ident" id="2295244">value</span><span class="op" id="2295249">,</span>&nbsp;<span class="ident" id="2295251">err</span><br>
<span class="lineno"></span><span class="op" id="2295255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2295258">func</span>&nbsp;<span class="ident" id="2295263">GetsockoptIPv6Mreq</span><span class="op" id="2295281">(</span><span class="ident" id="2295282">fd</span><span class="op" id="2295284">,</span>&nbsp;<span class="ident" id="2295286">level</span><span class="op" id="2295291">,</span>&nbsp;<span class="ident" id="2295293">opt</span>&nbsp;<span class="builtintype" id="2295297">int</span><span class="op" id="2295300">)</span>&nbsp;<span class="op" id="2295302">(</span><span class="op" id="2295303">*</span><span class="ident" id="2295304">IPv6Mreq</span><span class="op" id="2295312">,</span>&nbsp;<span class="builtintype" id="2295314">error</span><span class="op" id="2295319">)</span>&nbsp;<span class="op" id="2295321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295324">var</span>&nbsp;<span class="ident" id="2295328">value</span>&nbsp;<span class="ident" id="2295334">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295344">vallen</span>&nbsp;<span class="op" id="2295351">:=</span>&nbsp;<span class="ident" id="2295354">_Socklen</span><span class="op" id="2295362">(</span><span class="ident" id="2295363">SizeofIPv6Mreq</span><span class="op" id="2295377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295380">err</span>&nbsp;<span class="op" id="2295384">:=</span>&nbsp;<span class="ident" id="2295387">getsockopt</span><span class="op" id="2295397">(</span><span class="ident" id="2295398">fd</span><span class="op" id="2295400">,</span>&nbsp;<span class="ident" id="2295402">level</span><span class="op" id="2295407">,</span>&nbsp;<span class="ident" id="2295409">opt</span><span class="op" id="2295412">,</span>&nbsp;<span class="ident" id="2295414">unsafe</span><span class="op" id="2295420">.</span><span class="ident" id="2295421">Pointer</span><span class="op" id="2295428">(</span><span class="op" id="2295429">&amp;</span><span class="ident" id="2295430">value</span><span class="op" id="2295435">)</span><span class="op" id="2295436">,</span>&nbsp;<span class="op" id="2295438">&amp;</span><span class="ident" id="2295439">vallen</span><span class="op" id="2295445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295448">return</span>&nbsp;<span class="op" id="2295455">&amp;</span><span class="ident" id="2295456">value</span><span class="op" id="2295461">,</span>&nbsp;<span class="ident" id="2295463">err</span><br>
<span class="lineno">470</span><span class="op" id="2295467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2295470">func</span>&nbsp;<span class="ident" id="2295475">GetsockoptIPv6MTUInfo</span><span class="op" id="2295496">(</span><span class="ident" id="2295497">fd</span><span class="op" id="2295499">,</span>&nbsp;<span class="ident" id="2295501">level</span><span class="op" id="2295506">,</span>&nbsp;<span class="ident" id="2295508">opt</span>&nbsp;<span class="builtintype" id="2295512">int</span><span class="op" id="2295515">)</span>&nbsp;<span class="op" id="2295517">(</span><span class="op" id="2295518">*</span><span class="ident" id="2295519">IPv6MTUInfo</span><span class="op" id="2295530">,</span>&nbsp;<span class="builtintype" id="2295532">error</span><span class="op" id="2295537">)</span>&nbsp;<span class="op" id="2295539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295542">var</span>&nbsp;<span class="ident" id="2295546">value</span>&nbsp;<span class="ident" id="2295552">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295565">vallen</span>&nbsp;<span class="op" id="2295572">:=</span>&nbsp;<span class="ident" id="2295575">_Socklen</span><span class="op" id="2295583">(</span><span class="ident" id="2295584">SizeofIPv6MTUInfo</span><span class="op" id="2295601">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295604">err</span>&nbsp;<span class="op" id="2295608">:=</span>&nbsp;<span class="ident" id="2295611">getsockopt</span><span class="op" id="2295621">(</span><span class="ident" id="2295622">fd</span><span class="op" id="2295624">,</span>&nbsp;<span class="ident" id="2295626">level</span><span class="op" id="2295631">,</span>&nbsp;<span class="ident" id="2295633">opt</span><span class="op" id="2295636">,</span>&nbsp;<span class="ident" id="2295638">unsafe</span><span class="op" id="2295644">.</span><span class="ident" id="2295645">Pointer</span><span class="op" id="2295652">(</span><span class="op" id="2295653">&amp;</span><span class="ident" id="2295654">value</span><span class="op" id="2295659">)</span><span class="op" id="2295660">,</span>&nbsp;<span class="op" id="2295662">&amp;</span><span class="ident" id="2295663">vallen</span><span class="op" id="2295669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295672">return</span>&nbsp;<span class="op" id="2295679">&amp;</span><span class="ident" id="2295680">value</span><span class="op" id="2295685">,</span>&nbsp;<span class="ident" id="2295687">err</span><br>
<span class="lineno"></span><span class="op" id="2295691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2295694">func</span>&nbsp;<span class="ident" id="2295699">GetsockoptICMPv6Filter</span><span class="op" id="2295721">(</span><span class="ident" id="2295722">fd</span><span class="op" id="2295724">,</span>&nbsp;<span class="ident" id="2295726">level</span><span class="op" id="2295731">,</span>&nbsp;<span class="ident" id="2295733">opt</span>&nbsp;<span class="builtintype" id="2295737">int</span><span class="op" id="2295740">)</span>&nbsp;<span class="op" id="2295742">(</span><span class="op" id="2295743">*</span><span class="ident" id="2295744">ICMPv6Filter</span><span class="op" id="2295756">,</span>&nbsp;<span class="builtintype" id="2295758">error</span><span class="op" id="2295763">)</span>&nbsp;<span class="op" id="2295765">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295768">var</span>&nbsp;<span class="ident" id="2295772">value</span>&nbsp;<span class="ident" id="2295778">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295792">vallen</span>&nbsp;<span class="op" id="2295799">:=</span>&nbsp;<span class="ident" id="2295802">_Socklen</span><span class="op" id="2295810">(</span><span class="ident" id="2295811">SizeofICMPv6Filter</span><span class="op" id="2295829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295832">err</span>&nbsp;<span class="op" id="2295836">:=</span>&nbsp;<span class="ident" id="2295839">getsockopt</span><span class="op" id="2295849">(</span><span class="ident" id="2295850">fd</span><span class="op" id="2295852">,</span>&nbsp;<span class="ident" id="2295854">level</span><span class="op" id="2295859">,</span>&nbsp;<span class="ident" id="2295861">opt</span><span class="op" id="2295864">,</span>&nbsp;<span class="ident" id="2295866">unsafe</span><span class="op" id="2295872">.</span><span class="ident" id="2295873">Pointer</span><span class="op" id="2295880">(</span><span class="op" id="2295881">&amp;</span><span class="ident" id="2295882">value</span><span class="op" id="2295887">)</span><span class="op" id="2295888">,</span>&nbsp;<span class="op" id="2295890">&amp;</span><span class="ident" id="2295891">vallen</span><span class="op" id="2295897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295900">return</span>&nbsp;<span class="op" id="2295907">&amp;</span><span class="ident" id="2295908">value</span><span class="op" id="2295913">,</span>&nbsp;<span class="ident" id="2295915">err</span><br>
<span class="lineno"></span><span class="op" id="2295919">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2295922">func</span>&nbsp;<span class="ident" id="2295927">GetsockoptUcred</span><span class="op" id="2295942">(</span><span class="ident" id="2295943">fd</span><span class="op" id="2295945">,</span>&nbsp;<span class="ident" id="2295947">level</span><span class="op" id="2295952">,</span>&nbsp;<span class="ident" id="2295954">opt</span>&nbsp;<span class="builtintype" id="2295958">int</span><span class="op" id="2295961">)</span>&nbsp;<span class="op" id="2295963">(</span><span class="op" id="2295964">*</span><span class="ident" id="2295965">Ucred</span><span class="op" id="2295970">,</span>&nbsp;<span class="builtintype" id="2295972">error</span><span class="op" id="2295977">)</span>&nbsp;<span class="op" id="2295979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295982">var</span>&nbsp;<span class="ident" id="2295986">value</span>&nbsp;<span class="ident" id="2295992">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295999">vallen</span>&nbsp;<span class="op" id="2296006">:=</span>&nbsp;<span class="ident" id="2296009">_Socklen</span><span class="op" id="2296017">(</span><span class="ident" id="2296018">SizeofUcred</span><span class="op" id="2296029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296032">err</span>&nbsp;<span class="op" id="2296036">:=</span>&nbsp;<span class="ident" id="2296039">getsockopt</span><span class="op" id="2296049">(</span><span class="ident" id="2296050">fd</span><span class="op" id="2296052">,</span>&nbsp;<span class="ident" id="2296054">level</span><span class="op" id="2296059">,</span>&nbsp;<span class="ident" id="2296061">opt</span><span class="op" id="2296064">,</span>&nbsp;<span class="ident" id="2296066">unsafe</span><span class="op" id="2296072">.</span><span class="ident" id="2296073">Pointer</span><span class="op" id="2296080">(</span><span class="op" id="2296081">&amp;</span><span class="ident" id="2296082">value</span><span class="op" id="2296087">)</span><span class="op" id="2296088">,</span>&nbsp;<span class="op" id="2296090">&amp;</span><span class="ident" id="2296091">vallen</span><span class="op" id="2296097">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296100">return</span>&nbsp;<span class="op" id="2296107">&amp;</span><span class="ident" id="2296108">value</span><span class="op" id="2296113">,</span>&nbsp;<span class="ident" id="2296115">err</span><br>
<span class="lineno"></span><span class="op" id="2296119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2296122">func</span>&nbsp;<span class="ident" id="2296127">SetsockoptIPMreqn</span><span class="op" id="2296144">(</span><span class="ident" id="2296145">fd</span><span class="op" id="2296147">,</span>&nbsp;<span class="ident" id="2296149">level</span><span class="op" id="2296154">,</span>&nbsp;<span class="ident" id="2296156">opt</span>&nbsp;<span class="builtintype" id="2296160">int</span><span class="op" id="2296163">,</span>&nbsp;<span class="ident" id="2296165">mreq</span>&nbsp;<span class="op" id="2296170">*</span><span class="ident" id="2296171">IPMreqn</span><span class="op" id="2296178">)</span>&nbsp;<span class="op" id="2296180">(</span><span class="ident" id="2296181">err</span>&nbsp;<span class="builtintype" id="2296185">error</span><span class="op" id="2296190">)</span>&nbsp;<span class="op" id="2296192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296195">return</span>&nbsp;<span class="ident" id="2296202">setsockopt</span><span class="op" id="2296212">(</span><span class="ident" id="2296213">fd</span><span class="op" id="2296215">,</span>&nbsp;<span class="ident" id="2296217">level</span><span class="op" id="2296222">,</span>&nbsp;<span class="ident" id="2296224">opt</span><span class="op" id="2296227">,</span>&nbsp;<span class="ident" id="2296229">unsafe</span><span class="op" id="2296235">.</span><span class="ident" id="2296236">Pointer</span><span class="op" id="2296243">(</span><span class="ident" id="2296244">mreq</span><span class="op" id="2296248">)</span><span class="op" id="2296249">,</span>&nbsp;<span class="ident" id="2296251">unsafe</span><span class="op" id="2296257">.</span><span class="ident" id="2296258">Sizeof</span><span class="op" id="2296264">(</span><span class="op" id="2296265">*</span><span class="ident" id="2296266">mreq</span><span class="op" id="2296270">)</span><span class="op" id="2296271">)</span><br>
<span class="lineno">495</span><span class="op" id="2296273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2296276">func</span>&nbsp;<span class="ident" id="2296281">Recvmsg</span><span class="op" id="2296288">(</span><span class="ident" id="2296289">fd</span>&nbsp;<span class="builtintype" id="2296292">int</span><span class="op" id="2296295">,</span>&nbsp;<span class="ident" id="2296297">p</span><span class="op" id="2296298">,</span>&nbsp;<span class="ident" id="2296300">oob</span>&nbsp;<span class="op" id="2296304">[</span><span class="op" id="2296305">]</span><span class="builtintype" id="2296306">byte</span><span class="op" id="2296310">,</span>&nbsp;<span class="ident" id="2296312">flags</span>&nbsp;<span class="builtintype" id="2296318">int</span><span class="op" id="2296321">)</span>&nbsp;<span class="op" id="2296323">(</span><span class="ident" id="2296324">n</span><span class="op" id="2296325">,</span>&nbsp;<span class="ident" id="2296327">oobn</span>&nbsp;<span class="builtintype" id="2296332">int</span><span class="op" id="2296335">,</span>&nbsp;<span class="ident" id="2296337">recvflags</span>&nbsp;<span class="builtintype" id="2296347">int</span><span class="op" id="2296350">,</span>&nbsp;<span class="ident" id="2296352">from</span>&nbsp;<span class="ident" id="2296357">Sockaddr</span><span class="op" id="2296365">,</span>&nbsp;<span class="ident" id="2296367">err</span>&nbsp;<span class="builtintype" id="2296371">error</span><span class="op" id="2296376">)</span>&nbsp;<span class="op" id="2296378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296381">var</span>&nbsp;<span class="ident" id="2296385">msg</span>&nbsp;<span class="ident" id="2296389">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296397">var</span>&nbsp;<span class="ident" id="2296401">rsa</span>&nbsp;<span class="ident" id="2296405">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296421">msg</span><span class="op" id="2296424">.</span><span class="ident" id="2296425">Name</span>&nbsp;<span class="op" id="2296430">=</span>&nbsp;<span class="op" id="2296432">(</span><span class="op" id="2296433">*</span><span class="builtintype" id="2296434">byte</span><span class="op" id="2296438">)</span><span class="op" id="2296439">(</span><span class="ident" id="2296440">unsafe</span><span class="op" id="2296446">.</span><span class="ident" id="2296447">Pointer</span><span class="op" id="2296454">(</span><span class="op" id="2296455">&amp;</span><span class="ident" id="2296456">rsa</span><span class="op" id="2296459">)</span><span class="op" id="2296460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296463">msg</span><span class="op" id="2296466">.</span><span class="ident" id="2296467">Namelen</span>&nbsp;<span class="op" id="2296475">=</span>&nbsp;<span class="builtintype" id="2296477">uint32</span><span class="op" id="2296483">(</span><span class="ident" id="2296484">SizeofSockaddrAny</span><span class="op" id="2296501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296504">var</span>&nbsp;<span class="ident" id="2296508">iov</span>&nbsp;<span class="ident" id="2296512">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296519">if</span>&nbsp;<span class="builtinfunc" id="2296522">len</span><span class="op" id="2296525">(</span><span class="ident" id="2296526">p</span><span class="op" id="2296527">)</span>&nbsp;<span class="op" id="2296529">&gt;</span>&nbsp;<span class="num" id="2296531">0</span>&nbsp;<span class="op" id="2296533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296537">iov</span><span class="op" id="2296540">.</span><span class="ident" id="2296541">Base</span>&nbsp;<span class="op" id="2296546">=</span>&nbsp;<span class="op" id="2296548">(</span><span class="op" id="2296549">*</span><span class="builtintype" id="2296550">byte</span><span class="op" id="2296554">)</span><span class="op" id="2296555">(</span><span class="ident" id="2296556">unsafe</span><span class="op" id="2296562">.</span><span class="ident" id="2296563">Pointer</span><span class="op" id="2296570">(</span><span class="op" id="2296571">&amp;</span><span class="ident" id="2296572">p</span><span class="op" id="2296573">[</span><span class="num" id="2296574">0</span><span class="op" id="2296575">]</span><span class="op" id="2296576">)</span><span class="op" id="2296577">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296581">iov</span><span class="op" id="2296584">.</span><span class="ident" id="2296585">SetLen</span><span class="op" id="2296591">(</span><span class="builtinfunc" id="2296592">len</span><span class="op" id="2296595">(</span><span class="ident" id="2296596">p</span><span class="op" id="2296597">)</span><span class="op" id="2296598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296604">var</span>&nbsp;<span class="ident" id="2296608">dummy</span>&nbsp;<span class="builtintype" id="2296614">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296620">if</span>&nbsp;<span class="builtinfunc" id="2296623">len</span><span class="op" id="2296626">(</span><span class="ident" id="2296627">oob</span><span class="op" id="2296630">)</span>&nbsp;<span class="op" id="2296632">&gt;</span>&nbsp;<span class="num" id="2296634">0</span>&nbsp;<span class="op" id="2296636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2296640">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296678">if</span>&nbsp;<span class="builtinfunc" id="2296681">len</span><span class="op" id="2296684">(</span><span class="ident" id="2296685">p</span><span class="op" id="2296686">)</span>&nbsp;<span class="op" id="2296688">==</span>&nbsp;<span class="num" id="2296691">0</span>&nbsp;<span class="op" id="2296693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296698">iov</span><span class="op" id="2296701">.</span><span class="ident" id="2296702">Base</span>&nbsp;<span class="op" id="2296707">=</span>&nbsp;<span class="op" id="2296709">&amp;</span><span class="ident" id="2296710">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296719">iov</span><span class="op" id="2296722">.</span><span class="ident" id="2296723">SetLen</span><span class="op" id="2296729">(</span><span class="num" id="2296730">1</span><span class="op" id="2296731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296739">msg</span><span class="op" id="2296742">.</span><span class="ident" id="2296743">Control</span>&nbsp;<span class="op" id="2296751">=</span>&nbsp;<span class="op" id="2296753">(</span><span class="op" id="2296754">*</span><span class="builtintype" id="2296755">byte</span><span class="op" id="2296759">)</span><span class="op" id="2296760">(</span><span class="ident" id="2296761">unsafe</span><span class="op" id="2296767">.</span><span class="ident" id="2296768">Pointer</span><span class="op" id="2296775">(</span><span class="op" id="2296776">&amp;</span><span class="ident" id="2296777">oob</span><span class="op" id="2296780">[</span><span class="num" id="2296781">0</span><span class="op" id="2296782">]</span><span class="op" id="2296783">)</span><span class="op" id="2296784">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296788">msg</span><span class="op" id="2296791">.</span><span class="ident" id="2296792">SetControllen</span><span class="op" id="2296805">(</span><span class="builtinfunc" id="2296806">len</span><span class="op" id="2296809">(</span><span class="ident" id="2296810">oob</span><span class="op" id="2296813">)</span><span class="op" id="2296814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296820">msg</span><span class="op" id="2296823">.</span><span class="ident" id="2296824">Iov</span>&nbsp;<span class="op" id="2296828">=</span>&nbsp;<span class="op" id="2296830">&amp;</span><span class="ident" id="2296831">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296836">msg</span><span class="op" id="2296839">.</span><span class="ident" id="2296840">Iovlen</span>&nbsp;<span class="op" id="2296847">=</span>&nbsp;<span class="num" id="2296849">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296852">if</span>&nbsp;<span class="ident" id="2296855">n</span><span class="op" id="2296856">,</span>&nbsp;<span class="ident" id="2296858">err</span>&nbsp;<span class="op" id="2296862">=</span>&nbsp;<span class="ident" id="2296864">recvmsg</span><span class="op" id="2296871">(</span><span class="ident" id="2296872">fd</span><span class="op" id="2296874">,</span>&nbsp;<span class="op" id="2296876">&amp;</span><span class="ident" id="2296877">msg</span><span class="op" id="2296880">,</span>&nbsp;<span class="ident" id="2296882">flags</span><span class="op" id="2296887">)</span><span class="op" id="2296888">;</span>&nbsp;<span class="ident" id="2296890">err</span>&nbsp;<span class="op" id="2296894">!=</span>&nbsp;<span class="ident" id="2296897">nil</span>&nbsp;<span class="op" id="2296901">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296905">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296916">oobn</span>&nbsp;<span class="op" id="2296921">=</span>&nbsp;<span class="builtintype" id="2296923">int</span><span class="op" id="2296926">(</span><span class="ident" id="2296927">msg</span><span class="op" id="2296930">.</span><span class="ident" id="2296931">Controllen</span><span class="op" id="2296941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296944">recvflags</span>&nbsp;<span class="op" id="2296954">=</span>&nbsp;<span class="builtintype" id="2296956">int</span><span class="op" id="2296959">(</span><span class="ident" id="2296960">msg</span><span class="op" id="2296963">.</span><span class="ident" id="2296964">Flags</span><span class="op" id="2296969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2296972">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297038">if</span>&nbsp;<span class="ident" id="2297041">rsa</span><span class="op" id="2297044">.</span><span class="ident" id="2297045">Addr</span><span class="op" id="2297049">.</span><span class="ident" id="2297050">Family</span>&nbsp;<span class="op" id="2297057">!=</span>&nbsp;<span class="ident" id="2297060">AF_UNSPEC</span>&nbsp;<span class="op" id="2297070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297074">from</span><span class="op" id="2297078">,</span>&nbsp;<span class="ident" id="2297080">err</span>&nbsp;<span class="op" id="2297084">=</span>&nbsp;<span class="ident" id="2297086">anyToSockaddr</span><span class="op" id="2297099">(</span><span class="op" id="2297100">&amp;</span><span class="ident" id="2297101">rsa</span><span class="op" id="2297104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297110">return</span><br>
<span class="lineno"></span><span class="op" id="2297117">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2297120">func</span>&nbsp;<span class="ident" id="2297125">Sendmsg</span><span class="op" id="2297132">(</span><span class="ident" id="2297133">fd</span>&nbsp;<span class="builtintype" id="2297136">int</span><span class="op" id="2297139">,</span>&nbsp;<span class="ident" id="2297141">p</span><span class="op" id="2297142">,</span>&nbsp;<span class="ident" id="2297144">oob</span>&nbsp;<span class="op" id="2297148">[</span><span class="op" id="2297149">]</span><span class="builtintype" id="2297150">byte</span><span class="op" id="2297154">,</span>&nbsp;<span class="ident" id="2297156">to</span>&nbsp;<span class="ident" id="2297159">Sockaddr</span><span class="op" id="2297167">,</span>&nbsp;<span class="ident" id="2297169">flags</span>&nbsp;<span class="builtintype" id="2297175">int</span><span class="op" id="2297178">)</span>&nbsp;<span class="op" id="2297180">(</span><span class="ident" id="2297181">err</span>&nbsp;<span class="builtintype" id="2297185">error</span><span class="op" id="2297190">)</span>&nbsp;<span class="op" id="2297192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297195">_</span><span class="op" id="2297196">,</span>&nbsp;<span class="ident" id="2297198">err</span>&nbsp;<span class="op" id="2297202">=</span>&nbsp;<span class="ident" id="2297204">SendmsgN</span><span class="op" id="2297212">(</span><span class="ident" id="2297213">fd</span><span class="op" id="2297215">,</span>&nbsp;<span class="ident" id="2297217">p</span><span class="op" id="2297218">,</span>&nbsp;<span class="ident" id="2297220">oob</span><span class="op" id="2297223">,</span>&nbsp;<span class="ident" id="2297225">to</span><span class="op" id="2297227">,</span>&nbsp;<span class="ident" id="2297229">flags</span><span class="op" id="2297234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297237">return</span><br>
<span class="lineno"></span><span class="op" id="2297244">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2297247">func</span>&nbsp;<span class="ident" id="2297252">SendmsgN</span><span class="op" id="2297260">(</span><span class="ident" id="2297261">fd</span>&nbsp;<span class="builtintype" id="2297264">int</span><span class="op" id="2297267">,</span>&nbsp;<span class="ident" id="2297269">p</span><span class="op" id="2297270">,</span>&nbsp;<span class="ident" id="2297272">oob</span>&nbsp;<span class="op" id="2297276">[</span><span class="op" id="2297277">]</span><span class="builtintype" id="2297278">byte</span><span class="op" id="2297282">,</span>&nbsp;<span class="ident" id="2297284">to</span>&nbsp;<span class="ident" id="2297287">Sockaddr</span><span class="op" id="2297295">,</span>&nbsp;<span class="ident" id="2297297">flags</span>&nbsp;<span class="builtintype" id="2297303">int</span><span class="op" id="2297306">)</span>&nbsp;<span class="op" id="2297308">(</span><span class="ident" id="2297309">n</span>&nbsp;<span class="builtintype" id="2297311">int</span><span class="op" id="2297314">,</span>&nbsp;<span class="ident" id="2297316">err</span>&nbsp;<span class="builtintype" id="2297320">error</span><span class="op" id="2297325">)</span>&nbsp;<span class="op" id="2297327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297330">var</span>&nbsp;<span class="ident" id="2297334">ptr</span>&nbsp;<span class="ident" id="2297338">unsafe</span><span class="op" id="2297344">.</span><span class="ident" id="2297345">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297354">var</span>&nbsp;<span class="ident" id="2297358">salen</span>&nbsp;<span class="ident" id="2297364">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297374">if</span>&nbsp;<span class="ident" id="2297377">to</span>&nbsp;<span class="op" id="2297380">!=</span>&nbsp;<span class="ident" id="2297383">nil</span>&nbsp;<span class="op" id="2297387">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297391">var</span>&nbsp;<span class="ident" id="2297395">err</span>&nbsp;<span class="builtintype" id="2297399">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297407">ptr</span><span class="op" id="2297410">,</span>&nbsp;<span class="ident" id="2297412">salen</span><span class="op" id="2297417">,</span>&nbsp;<span class="ident" id="2297419">err</span>&nbsp;<span class="op" id="2297423">=</span>&nbsp;<span class="ident" id="2297425">to</span><span class="op" id="2297427">.</span><span class="ident" id="2297428">sockaddr</span><span class="op" id="2297436">(</span><span class="op" id="2297437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297441">if</span>&nbsp;<span class="ident" id="2297444">err</span>&nbsp;<span class="op" id="2297448">!=</span>&nbsp;<span class="ident" id="2297451">nil</span>&nbsp;<span class="op" id="2297455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297460">return</span>&nbsp;<span class="num" id="2297467">0</span><span class="op" id="2297468">,</span>&nbsp;<span class="ident" id="2297470">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297476">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297482">var</span>&nbsp;<span class="ident" id="2297486">msg</span>&nbsp;<span class="ident" id="2297490">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297498">msg</span><span class="op" id="2297501">.</span><span class="ident" id="2297502">Name</span>&nbsp;<span class="op" id="2297507">=</span>&nbsp;<span class="op" id="2297509">(</span><span class="op" id="2297510">*</span><span class="builtintype" id="2297511">byte</span><span class="op" id="2297515">)</span><span class="op" id="2297516">(</span><span class="ident" id="2297517">unsafe</span><span class="op" id="2297523">.</span><span class="ident" id="2297524">Pointer</span><span class="op" id="2297531">(</span><span class="ident" id="2297532">ptr</span><span class="op" id="2297535">)</span><span class="op" id="2297536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297539">msg</span><span class="op" id="2297542">.</span><span class="ident" id="2297543">Namelen</span>&nbsp;<span class="op" id="2297551">=</span>&nbsp;<span class="builtintype" id="2297553">uint32</span><span class="op" id="2297559">(</span><span class="ident" id="2297560">salen</span><span class="op" id="2297565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297568">var</span>&nbsp;<span class="ident" id="2297572">iov</span>&nbsp;<span class="ident" id="2297576">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297583">if</span>&nbsp;<span class="builtinfunc" id="2297586">len</span><span class="op" id="2297589">(</span><span class="ident" id="2297590">p</span><span class="op" id="2297591">)</span>&nbsp;<span class="op" id="2297593">&gt;</span>&nbsp;<span class="num" id="2297595">0</span>&nbsp;<span class="op" id="2297597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297601">iov</span><span class="op" id="2297604">.</span><span class="ident" id="2297605">Base</span>&nbsp;<span class="op" id="2297610">=</span>&nbsp;<span class="op" id="2297612">(</span><span class="op" id="2297613">*</span><span class="builtintype" id="2297614">byte</span><span class="op" id="2297618">)</span><span class="op" id="2297619">(</span><span class="ident" id="2297620">unsafe</span><span class="op" id="2297626">.</span><span class="ident" id="2297627">Pointer</span><span class="op" id="2297634">(</span><span class="op" id="2297635">&amp;</span><span class="ident" id="2297636">p</span><span class="op" id="2297637">[</span><span class="num" id="2297638">0</span><span class="op" id="2297639">]</span><span class="op" id="2297640">)</span><span class="op" id="2297641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297645">iov</span><span class="op" id="2297648">.</span><span class="ident" id="2297649">SetLen</span><span class="op" id="2297655">(</span><span class="builtinfunc" id="2297656">len</span><span class="op" id="2297659">(</span><span class="ident" id="2297660">p</span><span class="op" id="2297661">)</span><span class="op" id="2297662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297668">var</span>&nbsp;<span class="ident" id="2297672">dummy</span>&nbsp;<span class="builtintype" id="2297678">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297684">if</span>&nbsp;<span class="builtinfunc" id="2297687">len</span><span class="op" id="2297690">(</span><span class="ident" id="2297691">oob</span><span class="op" id="2297694">)</span>&nbsp;<span class="op" id="2297696">&gt;</span>&nbsp;<span class="num" id="2297698">0</span>&nbsp;<span class="op" id="2297700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2297704">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297739">if</span>&nbsp;<span class="builtinfunc" id="2297742">len</span><span class="op" id="2297745">(</span><span class="ident" id="2297746">p</span><span class="op" id="2297747">)</span>&nbsp;<span class="op" id="2297749">==</span>&nbsp;<span class="num" id="2297752">0</span>&nbsp;<span class="op" id="2297754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297759">iov</span><span class="op" id="2297762">.</span><span class="ident" id="2297763">Base</span>&nbsp;<span class="op" id="2297768">=</span>&nbsp;<span class="op" id="2297770">&amp;</span><span class="ident" id="2297771">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297780">iov</span><span class="op" id="2297783">.</span><span class="ident" id="2297784">SetLen</span><span class="op" id="2297790">(</span><span class="num" id="2297791">1</span><span class="op" id="2297792">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297800">msg</span><span class="op" id="2297803">.</span><span class="ident" id="2297804">Control</span>&nbsp;<span class="op" id="2297812">=</span>&nbsp;<span class="op" id="2297814">(</span><span class="op" id="2297815">*</span><span class="builtintype" id="2297816">byte</span><span class="op" id="2297820">)</span><span class="op" id="2297821">(</span><span class="ident" id="2297822">unsafe</span><span class="op" id="2297828">.</span><span class="ident" id="2297829">Pointer</span><span class="op" id="2297836">(</span><span class="op" id="2297837">&amp;</span><span class="ident" id="2297838">oob</span><span class="op" id="2297841">[</span><span class="num" id="2297842">0</span><span class="op" id="2297843">]</span><span class="op" id="2297844">)</span><span class="op" id="2297845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297849">msg</span><span class="op" id="2297852">.</span><span class="ident" id="2297853">SetControllen</span><span class="op" id="2297866">(</span><span class="builtinfunc" id="2297867">len</span><span class="op" id="2297870">(</span><span class="ident" id="2297871">oob</span><span class="op" id="2297874">)</span><span class="op" id="2297875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297881">msg</span><span class="op" id="2297884">.</span><span class="ident" id="2297885">Iov</span>&nbsp;<span class="op" id="2297889">=</span>&nbsp;<span class="op" id="2297891">&amp;</span><span class="ident" id="2297892">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297897">msg</span><span class="op" id="2297900">.</span><span class="ident" id="2297901">Iovlen</span>&nbsp;<span class="op" id="2297908">=</span>&nbsp;<span class="num" id="2297910">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297913">if</span>&nbsp;<span class="ident" id="2297916">n</span><span class="op" id="2297917">,</span>&nbsp;<span class="ident" id="2297919">err</span>&nbsp;<span class="op" id="2297923">=</span>&nbsp;<span class="ident" id="2297925">sendmsg</span><span class="op" id="2297932">(</span><span class="ident" id="2297933">fd</span><span class="op" id="2297935">,</span>&nbsp;<span class="op" id="2297937">&amp;</span><span class="ident" id="2297938">msg</span><span class="op" id="2297941">,</span>&nbsp;<span class="ident" id="2297943">flags</span><span class="op" id="2297948">)</span><span class="op" id="2297949">;</span>&nbsp;<span class="ident" id="2297951">err</span>&nbsp;<span class="op" id="2297955">!=</span>&nbsp;<span class="ident" id="2297958">nil</span>&nbsp;<span class="op" id="2297962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297966">return</span>&nbsp;<span class="num" id="2297973">0</span><span class="op" id="2297974">,</span>&nbsp;<span class="ident" id="2297976">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297984">if</span>&nbsp;<span class="builtinfunc" id="2297987">len</span><span class="op" id="2297990">(</span><span class="ident" id="2297991">oob</span><span class="op" id="2297994">)</span>&nbsp;<span class="op" id="2297996">&gt;</span>&nbsp;<span class="num" id="2297998">0</span>&nbsp;<span class="op" id="2298000">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2298003">len</span><span class="op" id="2298006">(</span><span class="ident" id="2298007">p</span><span class="op" id="2298008">)</span>&nbsp;<span class="op" id="2298010">==</span>&nbsp;<span class="num" id="2298013">0</span>&nbsp;<span class="op" id="2298015">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298019">n</span>&nbsp;<span class="op" id="2298021">=</span>&nbsp;<span class="num" id="2298023">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298029">return</span>&nbsp;<span class="ident" id="2298036">n</span><span class="op" id="2298037">,</span>&nbsp;<span class="ident" id="2298039">nil</span><br>
<span class="lineno"></span><span class="op" id="2298043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2298046">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2298109">func</span>&nbsp;<span class="ident" id="2298114">BindToDevice</span><span class="op" id="2298126">(</span><span class="ident" id="2298127">fd</span>&nbsp;<span class="builtintype" id="2298130">int</span><span class="op" id="2298133">,</span>&nbsp;<span class="ident" id="2298135">device</span>&nbsp;<span class="builtintype" id="2298142">string</span><span class="op" id="2298148">)</span>&nbsp;<span class="op" id="2298150">(</span><span class="ident" id="2298151">err</span>&nbsp;<span class="builtintype" id="2298155">error</span><span class="op" id="2298160">)</span>&nbsp;<span class="op" id="2298162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298165">return</span>&nbsp;<span class="ident" id="2298172">SetsockoptString</span><span class="op" id="2298188">(</span><span class="ident" id="2298189">fd</span><span class="op" id="2298191">,</span>&nbsp;<span class="ident" id="2298193">SOL_SOCKET</span><span class="op" id="2298203">,</span>&nbsp;<span class="ident" id="2298205">SO_BINDTODEVICE</span><span class="op" id="2298220">,</span>&nbsp;<span class="ident" id="2298222">device</span><span class="op" id="2298228">)</span><br>
<span class="lineno"></span><span class="op" id="2298230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2298233">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2298309">func</span>&nbsp;<span class="ident" id="2298314">ptracePeek</span><span class="op" id="2298324">(</span><span class="ident" id="2298325">req</span>&nbsp;<span class="builtintype" id="2298329">int</span><span class="op" id="2298332">,</span>&nbsp;<span class="ident" id="2298334">pid</span>&nbsp;<span class="builtintype" id="2298338">int</span><span class="op" id="2298341">,</span>&nbsp;<span class="ident" id="2298343">addr</span>&nbsp;<span class="builtintype" id="2298348">uintptr</span><span class="op" id="2298355">,</span>&nbsp;<span class="ident" id="2298357">out</span>&nbsp;<span class="op" id="2298361">[</span><span class="op" id="2298362">]</span><span class="builtintype" id="2298363">byte</span><span class="op" id="2298367">)</span>&nbsp;<span class="op" id="2298369">(</span><span class="ident" id="2298370">count</span>&nbsp;<span class="builtintype" id="2298376">int</span><span class="op" id="2298379">,</span>&nbsp;<span class="ident" id="2298381">err</span>&nbsp;<span class="builtintype" id="2298385">error</span><span class="op" id="2298390">)</span>&nbsp;<span class="op" id="2298392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298395">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298458">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298498">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298550">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298613">var</span>&nbsp;<span class="ident" id="2298617">buf</span>&nbsp;<span class="op" id="2298621">[</span><span class="ident" id="2298622">sizeofPtr</span><span class="op" id="2298631">]</span><span class="builtintype" id="2298632">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298639">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298698">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298757">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298813">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298871">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298885">n</span>&nbsp;<span class="op" id="2298887">:=</span>&nbsp;<span class="num" id="2298890">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298893">if</span>&nbsp;<span class="ident" id="2298896">addr</span><span class="op" id="2298900">%</span><span class="ident" id="2298901">sizeofPtr</span>&nbsp;<span class="op" id="2298911">!=</span>&nbsp;<span class="num" id="2298914">0</span>&nbsp;<span class="op" id="2298916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298920">err</span>&nbsp;<span class="op" id="2298924">=</span>&nbsp;<span class="ident" id="2298926">ptrace</span><span class="op" id="2298932">(</span><span class="ident" id="2298933">req</span><span class="op" id="2298936">,</span>&nbsp;<span class="ident" id="2298938">pid</span><span class="op" id="2298941">,</span>&nbsp;<span class="ident" id="2298943">addr</span><span class="op" id="2298947">-</span><span class="ident" id="2298948">addr</span><span class="op" id="2298952">%</span><span class="ident" id="2298953">sizeofPtr</span><span class="op" id="2298962">,</span>&nbsp;<span class="builtintype" id="2298964">uintptr</span><span class="op" id="2298971">(</span><span class="ident" id="2298972">unsafe</span><span class="op" id="2298978">.</span><span class="ident" id="2298979">Pointer</span><span class="op" id="2298986">(</span><span class="op" id="2298987">&amp;</span><span class="ident" id="2298988">buf</span><span class="op" id="2298991">[</span><span class="num" id="2298992">0</span><span class="op" id="2298993">]</span><span class="op" id="2298994">)</span><span class="op" id="2298995">)</span><span class="op" id="2298996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299000">if</span>&nbsp;<span class="ident" id="2299003">err</span>&nbsp;<span class="op" id="2299007">!=</span>&nbsp;<span class="ident" id="2299010">nil</span>&nbsp;<span class="op" id="2299014">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299019">return</span>&nbsp;<span class="num" id="2299026">0</span><span class="op" id="2299027">,</span>&nbsp;<span class="ident" id="2299029">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299039">n</span>&nbsp;<span class="op" id="2299041">+=</span>&nbsp;<span class="builtinfunc" id="2299044">copy</span><span class="op" id="2299048">(</span><span class="ident" id="2299049">out</span><span class="op" id="2299052">,</span>&nbsp;<span class="ident" id="2299054">buf</span><span class="op" id="2299057">[</span><span class="ident" id="2299058">addr</span><span class="op" id="2299062">%</span><span class="ident" id="2299063">sizeofPtr</span><span class="op" id="2299072">:</span><span class="op" id="2299073">]</span><span class="op" id="2299074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299078">out</span>&nbsp;<span class="op" id="2299082">=</span>&nbsp;<span class="ident" id="2299084">out</span><span class="op" id="2299087">[</span><span class="ident" id="2299088">n</span><span class="op" id="2299089">:</span><span class="op" id="2299090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299093">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299097">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299112">for</span>&nbsp;<span class="builtinfunc" id="2299116">len</span><span class="op" id="2299119">(</span><span class="ident" id="2299120">out</span><span class="op" id="2299123">)</span>&nbsp;<span class="op" id="2299125">&gt;</span>&nbsp;<span class="num" id="2299127">0</span>&nbsp;<span class="op" id="2299129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299133">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299188">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299255">err</span>&nbsp;<span class="op" id="2299259">=</span>&nbsp;<span class="ident" id="2299261">ptrace</span><span class="op" id="2299267">(</span><span class="ident" id="2299268">req</span><span class="op" id="2299271">,</span>&nbsp;<span class="ident" id="2299273">pid</span><span class="op" id="2299276">,</span>&nbsp;<span class="ident" id="2299278">addr</span><span class="op" id="2299282">+</span><span class="builtintype" id="2299283">uintptr</span><span class="op" id="2299290">(</span><span class="ident" id="2299291">n</span><span class="op" id="2299292">)</span><span class="op" id="2299293">,</span>&nbsp;<span class="builtintype" id="2299295">uintptr</span><span class="op" id="2299302">(</span><span class="ident" id="2299303">unsafe</span><span class="op" id="2299309">.</span><span class="ident" id="2299310">Pointer</span><span class="op" id="2299317">(</span><span class="op" id="2299318">&amp;</span><span class="ident" id="2299319">buf</span><span class="op" id="2299322">[</span><span class="num" id="2299323">0</span><span class="op" id="2299324">]</span><span class="op" id="2299325">)</span><span class="op" id="2299326">)</span><span class="op" id="2299327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299331">if</span>&nbsp;<span class="ident" id="2299334">err</span>&nbsp;<span class="op" id="2299338">!=</span>&nbsp;<span class="ident" id="2299341">nil</span>&nbsp;<span class="op" id="2299345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299350">return</span>&nbsp;<span class="ident" id="2299357">n</span><span class="op" id="2299358">,</span>&nbsp;<span class="ident" id="2299360">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299370">copied</span>&nbsp;<span class="op" id="2299377">:=</span>&nbsp;<span class="builtinfunc" id="2299380">copy</span><span class="op" id="2299384">(</span><span class="ident" id="2299385">out</span><span class="op" id="2299388">,</span>&nbsp;<span class="ident" id="2299390">buf</span><span class="op" id="2299393">[</span><span class="num" id="2299394">0</span><span class="op" id="2299395">:</span><span class="op" id="2299396">]</span><span class="op" id="2299397">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299401">n</span>&nbsp;<span class="op" id="2299403">+=</span>&nbsp;<span class="ident" id="2299406">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299415">out</span>&nbsp;<span class="op" id="2299419">=</span>&nbsp;<span class="ident" id="2299421">out</span><span class="op" id="2299424">[</span><span class="ident" id="2299425">copied</span><span class="op" id="2299431">:</span><span class="op" id="2299432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299439">return</span>&nbsp;<span class="ident" id="2299446">n</span><span class="op" id="2299447">,</span>&nbsp;<span class="ident" id="2299449">nil</span><br>
<span class="lineno">620</span><span class="op" id="2299453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2299456">func</span>&nbsp;<span class="ident" id="2299461">PtracePeekText</span><span class="op" id="2299475">(</span><span class="ident" id="2299476">pid</span>&nbsp;<span class="builtintype" id="2299480">int</span><span class="op" id="2299483">,</span>&nbsp;<span class="ident" id="2299485">addr</span>&nbsp;<span class="builtintype" id="2299490">uintptr</span><span class="op" id="2299497">,</span>&nbsp;<span class="ident" id="2299499">out</span>&nbsp;<span class="op" id="2299503">[</span><span class="op" id="2299504">]</span><span class="builtintype" id="2299505">byte</span><span class="op" id="2299509">)</span>&nbsp;<span class="op" id="2299511">(</span><span class="ident" id="2299512">count</span>&nbsp;<span class="builtintype" id="2299518">int</span><span class="op" id="2299521">,</span>&nbsp;<span class="ident" id="2299523">err</span>&nbsp;<span class="builtintype" id="2299527">error</span><span class="op" id="2299532">)</span>&nbsp;<span class="op" id="2299534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299537">return</span>&nbsp;<span class="ident" id="2299544">ptracePeek</span><span class="op" id="2299554">(</span><span class="ident" id="2299555">PTRACE_PEEKTEXT</span><span class="op" id="2299570">,</span>&nbsp;<span class="ident" id="2299572">pid</span><span class="op" id="2299575">,</span>&nbsp;<span class="ident" id="2299577">addr</span><span class="op" id="2299581">,</span>&nbsp;<span class="ident" id="2299583">out</span><span class="op" id="2299586">)</span><br>
<span class="lineno"></span><span class="op" id="2299588">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2299591">func</span>&nbsp;<span class="ident" id="2299596">PtracePeekData</span><span class="op" id="2299610">(</span><span class="ident" id="2299611">pid</span>&nbsp;<span class="builtintype" id="2299615">int</span><span class="op" id="2299618">,</span>&nbsp;<span class="ident" id="2299620">addr</span>&nbsp;<span class="builtintype" id="2299625">uintptr</span><span class="op" id="2299632">,</span>&nbsp;<span class="ident" id="2299634">out</span>&nbsp;<span class="op" id="2299638">[</span><span class="op" id="2299639">]</span><span class="builtintype" id="2299640">byte</span><span class="op" id="2299644">)</span>&nbsp;<span class="op" id="2299646">(</span><span class="ident" id="2299647">count</span>&nbsp;<span class="builtintype" id="2299653">int</span><span class="op" id="2299656">,</span>&nbsp;<span class="ident" id="2299658">err</span>&nbsp;<span class="builtintype" id="2299662">error</span><span class="op" id="2299667">)</span>&nbsp;<span class="op" id="2299669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299672">return</span>&nbsp;<span class="ident" id="2299679">ptracePeek</span><span class="op" id="2299689">(</span><span class="ident" id="2299690">PTRACE_PEEKDATA</span><span class="op" id="2299705">,</span>&nbsp;<span class="ident" id="2299707">pid</span><span class="op" id="2299710">,</span>&nbsp;<span class="ident" id="2299712">addr</span><span class="op" id="2299716">,</span>&nbsp;<span class="ident" id="2299718">out</span><span class="op" id="2299721">)</span><br>
<span class="lineno"></span><span class="op" id="2299723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2299726">func</span>&nbsp;<span class="ident" id="2299731">ptracePoke</span><span class="op" id="2299741">(</span><span class="ident" id="2299742">pokeReq</span>&nbsp;<span class="builtintype" id="2299750">int</span><span class="op" id="2299753">,</span>&nbsp;<span class="ident" id="2299755">peekReq</span>&nbsp;<span class="builtintype" id="2299763">int</span><span class="op" id="2299766">,</span>&nbsp;<span class="ident" id="2299768">pid</span>&nbsp;<span class="builtintype" id="2299772">int</span><span class="op" id="2299775">,</span>&nbsp;<span class="ident" id="2299777">addr</span>&nbsp;<span class="builtintype" id="2299782">uintptr</span><span class="op" id="2299789">,</span>&nbsp;<span class="ident" id="2299791">data</span>&nbsp;<span class="op" id="2299796">[</span><span class="op" id="2299797">]</span><span class="builtintype" id="2299798">byte</span><span class="op" id="2299802">)</span>&nbsp;<span class="op" id="2299804">(</span><span class="ident" id="2299805">count</span>&nbsp;<span class="builtintype" id="2299811">int</span><span class="op" id="2299814">,</span>&nbsp;<span class="ident" id="2299816">err</span>&nbsp;<span class="builtintype" id="2299820">error</span><span class="op" id="2299825">)</span>&nbsp;<span class="op" id="2299827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299830">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299891">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299948">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299966">n</span>&nbsp;<span class="op" id="2299968">:=</span>&nbsp;<span class="num" id="2299971">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299974">if</span>&nbsp;<span class="ident" id="2299977">addr</span><span class="op" id="2299981">%</span><span class="ident" id="2299982">sizeofPtr</span>&nbsp;<span class="op" id="2299992">!=</span>&nbsp;<span class="num" id="2299995">0</span>&nbsp;<span class="op" id="2299997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300001">var</span>&nbsp;<span class="ident" id="2300005">buf</span>&nbsp;<span class="op" id="2300009">[</span><span class="ident" id="2300010">sizeofPtr</span><span class="op" id="2300019">]</span><span class="builtintype" id="2300020">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300027">err</span>&nbsp;<span class="op" id="2300031">=</span>&nbsp;<span class="ident" id="2300033">ptrace</span><span class="op" id="2300039">(</span><span class="ident" id="2300040">peekReq</span><span class="op" id="2300047">,</span>&nbsp;<span class="ident" id="2300049">pid</span><span class="op" id="2300052">,</span>&nbsp;<span class="ident" id="2300054">addr</span><span class="op" id="2300058">-</span><span class="ident" id="2300059">addr</span><span class="op" id="2300063">%</span><span class="ident" id="2300064">sizeofPtr</span><span class="op" id="2300073">,</span>&nbsp;<span class="builtintype" id="2300075">uintptr</span><span class="op" id="2300082">(</span><span class="ident" id="2300083">unsafe</span><span class="op" id="2300089">.</span><span class="ident" id="2300090">Pointer</span><span class="op" id="2300097">(</span><span class="op" id="2300098">&amp;</span><span class="ident" id="2300099">buf</span><span class="op" id="2300102">[</span><span class="num" id="2300103">0</span><span class="op" id="2300104">]</span><span class="op" id="2300105">)</span><span class="op" id="2300106">)</span><span class="op" id="2300107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300111">if</span>&nbsp;<span class="ident" id="2300114">err</span>&nbsp;<span class="op" id="2300118">!=</span>&nbsp;<span class="ident" id="2300121">nil</span>&nbsp;<span class="op" id="2300125">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300130">return</span>&nbsp;<span class="num" id="2300137">0</span><span class="op" id="2300138">,</span>&nbsp;<span class="ident" id="2300140">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300150">n</span>&nbsp;<span class="op" id="2300152">+=</span>&nbsp;<span class="builtinfunc" id="2300155">copy</span><span class="op" id="2300159">(</span><span class="ident" id="2300160">buf</span><span class="op" id="2300163">[</span><span class="ident" id="2300164">addr</span><span class="op" id="2300168">%</span><span class="ident" id="2300169">sizeofPtr</span><span class="op" id="2300178">:</span><span class="op" id="2300179">]</span><span class="op" id="2300180">,</span>&nbsp;<span class="ident" id="2300182">data</span><span class="op" id="2300186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300190">word</span>&nbsp;<span class="op" id="2300195">:=</span>&nbsp;<span class="op" id="2300198">*</span><span class="op" id="2300199">(</span><span class="op" id="2300200">(</span><span class="op" id="2300201">*</span><span class="builtintype" id="2300202">uintptr</span><span class="op" id="2300209">)</span><span class="op" id="2300210">(</span><span class="ident" id="2300211">unsafe</span><span class="op" id="2300217">.</span><span class="ident" id="2300218">Pointer</span><span class="op" id="2300225">(</span><span class="op" id="2300226">&amp;</span><span class="ident" id="2300227">buf</span><span class="op" id="2300230">[</span><span class="num" id="2300231">0</span><span class="op" id="2300232">]</span><span class="op" id="2300233">)</span><span class="op" id="2300234">)</span><span class="op" id="2300235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300239">err</span>&nbsp;<span class="op" id="2300243">=</span>&nbsp;<span class="ident" id="2300245">ptrace</span><span class="op" id="2300251">(</span><span class="ident" id="2300252">pokeReq</span><span class="op" id="2300259">,</span>&nbsp;<span class="ident" id="2300261">pid</span><span class="op" id="2300264">,</span>&nbsp;<span class="ident" id="2300266">addr</span><span class="op" id="2300270">-</span><span class="ident" id="2300271">addr</span><span class="op" id="2300275">%</span><span class="ident" id="2300276">sizeofPtr</span><span class="op" id="2300285">,</span>&nbsp;<span class="ident" id="2300287">word</span><span class="op" id="2300291">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300295">if</span>&nbsp;<span class="ident" id="2300298">err</span>&nbsp;<span class="op" id="2300302">!=</span>&nbsp;<span class="ident" id="2300305">nil</span>&nbsp;<span class="op" id="2300309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300314">return</span>&nbsp;<span class="num" id="2300321">0</span><span class="op" id="2300322">,</span>&nbsp;<span class="ident" id="2300324">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300334">data</span>&nbsp;<span class="op" id="2300339">=</span>&nbsp;<span class="ident" id="2300341">data</span><span class="op" id="2300345">[</span><span class="ident" id="2300346">n</span><span class="op" id="2300347">:</span><span class="op" id="2300348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300351">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2300355">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300369">for</span>&nbsp;<span class="builtinfunc" id="2300373">len</span><span class="op" id="2300376">(</span><span class="ident" id="2300377">data</span><span class="op" id="2300381">)</span>&nbsp;<span class="op" id="2300383">&gt;</span>&nbsp;<span class="ident" id="2300385">sizeofPtr</span>&nbsp;<span class="op" id="2300395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300399">word</span>&nbsp;<span class="op" id="2300404">:=</span>&nbsp;<span class="op" id="2300407">*</span><span class="op" id="2300408">(</span><span class="op" id="2300409">(</span><span class="op" id="2300410">*</span><span class="builtintype" id="2300411">uintptr</span><span class="op" id="2300418">)</span><span class="op" id="2300419">(</span><span class="ident" id="2300420">unsafe</span><span class="op" id="2300426">.</span><span class="ident" id="2300427">Pointer</span><span class="op" id="2300434">(</span><span class="op" id="2300435">&amp;</span><span class="ident" id="2300436">data</span><span class="op" id="2300440">[</span><span class="num" id="2300441">0</span><span class="op" id="2300442">]</span><span class="op" id="2300443">)</span><span class="op" id="2300444">)</span><span class="op" id="2300445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300449">err</span>&nbsp;<span class="op" id="2300453">=</span>&nbsp;<span class="ident" id="2300455">ptrace</span><span class="op" id="2300461">(</span><span class="ident" id="2300462">pokeReq</span><span class="op" id="2300469">,</span>&nbsp;<span class="ident" id="2300471">pid</span><span class="op" id="2300474">,</span>&nbsp;<span class="ident" id="2300476">addr</span><span class="op" id="2300480">+</span><span class="builtintype" id="2300481">uintptr</span><span class="op" id="2300488">(</span><span class="ident" id="2300489">n</span><span class="op" id="2300490">)</span><span class="op" id="2300491">,</span>&nbsp;<span class="ident" id="2300493">word</span><span class="op" id="2300497">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300501">if</span>&nbsp;<span class="ident" id="2300504">err</span>&nbsp;<span class="op" id="2300508">!=</span>&nbsp;<span class="ident" id="2300511">nil</span>&nbsp;<span class="op" id="2300515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300520">return</span>&nbsp;<span class="ident" id="2300527">n</span><span class="op" id="2300528">,</span>&nbsp;<span class="ident" id="2300530">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300540">n</span>&nbsp;<span class="op" id="2300542">+=</span>&nbsp;<span class="ident" id="2300545">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300557">data</span>&nbsp;<span class="op" id="2300562">=</span>&nbsp;<span class="ident" id="2300564">data</span><span class="op" id="2300568">[</span><span class="ident" id="2300569">sizeofPtr</span><span class="op" id="2300578">:</span><span class="op" id="2300579">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2300586">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300605">if</span>&nbsp;<span class="builtinfunc" id="2300608">len</span><span class="op" id="2300611">(</span><span class="ident" id="2300612">data</span><span class="op" id="2300616">)</span>&nbsp;<span class="op" id="2300618">&gt;</span>&nbsp;<span class="num" id="2300620">0</span>&nbsp;<span class="op" id="2300622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300626">var</span>&nbsp;<span class="ident" id="2300630">buf</span>&nbsp;<span class="op" id="2300634">[</span><span class="ident" id="2300635">sizeofPtr</span><span class="op" id="2300644">]</span><span class="builtintype" id="2300645">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300652">err</span>&nbsp;<span class="op" id="2300656">=</span>&nbsp;<span class="ident" id="2300658">ptrace</span><span class="op" id="2300664">(</span><span class="ident" id="2300665">peekReq</span><span class="op" id="2300672">,</span>&nbsp;<span class="ident" id="2300674">pid</span><span class="op" id="2300677">,</span>&nbsp;<span class="ident" id="2300679">addr</span><span class="op" id="2300683">+</span><span class="builtintype" id="2300684">uintptr</span><span class="op" id="2300691">(</span><span class="ident" id="2300692">n</span><span class="op" id="2300693">)</span><span class="op" id="2300694">,</span>&nbsp;<span class="builtintype" id="2300696">uintptr</span><span class="op" id="2300703">(</span><span class="ident" id="2300704">unsafe</span><span class="op" id="2300710">.</span><span class="ident" id="2300711">Pointer</span><span class="op" id="2300718">(</span><span class="op" id="2300719">&amp;</span><span class="ident" id="2300720">buf</span><span class="op" id="2300723">[</span><span class="num" id="2300724">0</span><span class="op" id="2300725">]</span><span class="op" id="2300726">)</span><span class="op" id="2300727">)</span><span class="op" id="2300728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300732">if</span>&nbsp;<span class="ident" id="2300735">err</span>&nbsp;<span class="op" id="2300739">!=</span>&nbsp;<span class="ident" id="2300742">nil</span>&nbsp;<span class="op" id="2300746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300751">return</span>&nbsp;<span class="ident" id="2300758">n</span><span class="op" id="2300759">,</span>&nbsp;<span class="ident" id="2300761">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2300771">copy</span><span class="op" id="2300775">(</span><span class="ident" id="2300776">buf</span><span class="op" id="2300779">[</span><span class="num" id="2300780">0</span><span class="op" id="2300781">:</span><span class="op" id="2300782">]</span><span class="op" id="2300783">,</span>&nbsp;<span class="ident" id="2300785">data</span><span class="op" id="2300789">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300793">word</span>&nbsp;<span class="op" id="2300798">:=</span>&nbsp;<span class="op" id="2300801">*</span><span class="op" id="2300802">(</span><span class="op" id="2300803">(</span><span class="op" id="2300804">*</span><span class="builtintype" id="2300805">uintptr</span><span class="op" id="2300812">)</span><span class="op" id="2300813">(</span><span class="ident" id="2300814">unsafe</span><span class="op" id="2300820">.</span><span class="ident" id="2300821">Pointer</span><span class="op" id="2300828">(</span><span class="op" id="2300829">&amp;</span><span class="ident" id="2300830">buf</span><span class="op" id="2300833">[</span><span class="num" id="2300834">0</span><span class="op" id="2300835">]</span><span class="op" id="2300836">)</span><span class="op" id="2300837">)</span><span class="op" id="2300838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300842">err</span>&nbsp;<span class="op" id="2300846">=</span>&nbsp;<span class="ident" id="2300848">ptrace</span><span class="op" id="2300854">(</span><span class="ident" id="2300855">pokeReq</span><span class="op" id="2300862">,</span>&nbsp;<span class="ident" id="2300864">pid</span><span class="op" id="2300867">,</span>&nbsp;<span class="ident" id="2300869">addr</span><span class="op" id="2300873">+</span><span class="builtintype" id="2300874">uintptr</span><span class="op" id="2300881">(</span><span class="ident" id="2300882">n</span><span class="op" id="2300883">)</span><span class="op" id="2300884">,</span>&nbsp;<span class="ident" id="2300886">word</span><span class="op" id="2300890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300894">if</span>&nbsp;<span class="ident" id="2300897">err</span>&nbsp;<span class="op" id="2300901">!=</span>&nbsp;<span class="ident" id="2300904">nil</span>&nbsp;<span class="op" id="2300908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300913">return</span>&nbsp;<span class="ident" id="2300920">n</span><span class="op" id="2300921">,</span>&nbsp;<span class="ident" id="2300923">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300929">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300933">n</span>&nbsp;<span class="op" id="2300935">+=</span>&nbsp;<span class="builtinfunc" id="2300938">len</span><span class="op" id="2300941">(</span><span class="ident" id="2300942">data</span><span class="op" id="2300946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300953">return</span>&nbsp;<span class="ident" id="2300960">n</span><span class="op" id="2300961">,</span>&nbsp;<span class="ident" id="2300963">nil</span><br>
<span class="lineno"></span><span class="op" id="2300967">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2300970">func</span>&nbsp;<span class="ident" id="2300975">PtracePokeText</span><span class="op" id="2300989">(</span><span class="ident" id="2300990">pid</span>&nbsp;<span class="builtintype" id="2300994">int</span><span class="op" id="2300997">,</span>&nbsp;<span class="ident" id="2300999">addr</span>&nbsp;<span class="builtintype" id="2301004">uintptr</span><span class="op" id="2301011">,</span>&nbsp;<span class="ident" id="2301013">data</span>&nbsp;<span class="op" id="2301018">[</span><span class="op" id="2301019">]</span><span class="builtintype" id="2301020">byte</span><span class="op" id="2301024">)</span>&nbsp;<span class="op" id="2301026">(</span><span class="ident" id="2301027">count</span>&nbsp;<span class="builtintype" id="2301033">int</span><span class="op" id="2301036">,</span>&nbsp;<span class="ident" id="2301038">err</span>&nbsp;<span class="builtintype" id="2301042">error</span><span class="op" id="2301047">)</span>&nbsp;<span class="op" id="2301049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301052">return</span>&nbsp;<span class="ident" id="2301059">ptracePoke</span><span class="op" id="2301069">(</span><span class="ident" id="2301070">PTRACE_POKETEXT</span><span class="op" id="2301085">,</span>&nbsp;<span class="ident" id="2301087">PTRACE_PEEKTEXT</span><span class="op" id="2301102">,</span>&nbsp;<span class="ident" id="2301104">pid</span><span class="op" id="2301107">,</span>&nbsp;<span class="ident" id="2301109">addr</span><span class="op" id="2301113">,</span>&nbsp;<span class="ident" id="2301115">data</span><span class="op" id="2301119">)</span><br>
<span class="lineno"></span><span class="op" id="2301121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2301124">func</span>&nbsp;<span class="ident" id="2301129">PtracePokeData</span><span class="op" id="2301143">(</span><span class="ident" id="2301144">pid</span>&nbsp;<span class="builtintype" id="2301148">int</span><span class="op" id="2301151">,</span>&nbsp;<span class="ident" id="2301153">addr</span>&nbsp;<span class="builtintype" id="2301158">uintptr</span><span class="op" id="2301165">,</span>&nbsp;<span class="ident" id="2301167">data</span>&nbsp;<span class="op" id="2301172">[</span><span class="op" id="2301173">]</span><span class="builtintype" id="2301174">byte</span><span class="op" id="2301178">)</span>&nbsp;<span class="op" id="2301180">(</span><span class="ident" id="2301181">count</span>&nbsp;<span class="builtintype" id="2301187">int</span><span class="op" id="2301190">,</span>&nbsp;<span class="ident" id="2301192">err</span>&nbsp;<span class="builtintype" id="2301196">error</span><span class="op" id="2301201">)</span>&nbsp;<span class="op" id="2301203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301206">return</span>&nbsp;<span class="ident" id="2301213">ptracePoke</span><span class="op" id="2301223">(</span><span class="ident" id="2301224">PTRACE_POKEDATA</span><span class="op" id="2301239">,</span>&nbsp;<span class="ident" id="2301241">PTRACE_PEEKDATA</span><span class="op" id="2301256">,</span>&nbsp;<span class="ident" id="2301258">pid</span><span class="op" id="2301261">,</span>&nbsp;<span class="ident" id="2301263">addr</span><span class="op" id="2301267">,</span>&nbsp;<span class="ident" id="2301269">data</span><span class="op" id="2301273">)</span><br>
<span class="lineno"></span><span class="op" id="2301275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2301278">func</span>&nbsp;<span class="ident" id="2301283">PtraceGetRegs</span><span class="op" id="2301296">(</span><span class="ident" id="2301297">pid</span>&nbsp;<span class="builtintype" id="2301301">int</span><span class="op" id="2301304">,</span>&nbsp;<span class="ident" id="2301306">regsout</span>&nbsp;<span class="op" id="2301314">*</span><span class="ident" id="2301315">PtraceRegs</span><span class="op" id="2301325">)</span>&nbsp;<span class="op" id="2301327">(</span><span class="ident" id="2301328">err</span>&nbsp;<span class="builtintype" id="2301332">error</span><span class="op" id="2301337">)</span>&nbsp;<span class="op" id="2301339">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301342">return</span>&nbsp;<span class="ident" id="2301349">ptrace</span><span class="op" id="2301355">(</span><span class="ident" id="2301356">PTRACE_GETREGS</span><span class="op" id="2301370">,</span>&nbsp;<span class="ident" id="2301372">pid</span><span class="op" id="2301375">,</span>&nbsp;<span class="num" id="2301377">0</span><span class="op" id="2301378">,</span>&nbsp;<span class="builtintype" id="2301380">uintptr</span><span class="op" id="2301387">(</span><span class="ident" id="2301388">unsafe</span><span class="op" id="2301394">.</span><span class="ident" id="2301395">Pointer</span><span class="op" id="2301402">(</span><span class="ident" id="2301403">regsout</span><span class="op" id="2301410">)</span><span class="op" id="2301411">)</span><span class="op" id="2301412">)</span><br>
<span class="lineno"></span><span class="op" id="2301414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2301417">func</span>&nbsp;<span class="ident" id="2301422">PtraceSetRegs</span><span class="op" id="2301435">(</span><span class="ident" id="2301436">pid</span>&nbsp;<span class="builtintype" id="2301440">int</span><span class="op" id="2301443">,</span>&nbsp;<span class="ident" id="2301445">regs</span>&nbsp;<span class="op" id="2301450">*</span><span class="ident" id="2301451">PtraceRegs</span><span class="op" id="2301461">)</span>&nbsp;<span class="op" id="2301463">(</span><span class="ident" id="2301464">err</span>&nbsp;<span class="builtintype" id="2301468">error</span><span class="op" id="2301473">)</span>&nbsp;<span class="op" id="2301475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301478">return</span>&nbsp;<span class="ident" id="2301485">ptrace</span><span class="op" id="2301491">(</span><span class="ident" id="2301492">PTRACE_SETREGS</span><span class="op" id="2301506">,</span>&nbsp;<span class="ident" id="2301508">pid</span><span class="op" id="2301511">,</span>&nbsp;<span class="num" id="2301513">0</span><span class="op" id="2301514">,</span>&nbsp;<span class="builtintype" id="2301516">uintptr</span><span class="op" id="2301523">(</span><span class="ident" id="2301524">unsafe</span><span class="op" id="2301530">.</span><span class="ident" id="2301531">Pointer</span><span class="op" id="2301538">(</span><span class="ident" id="2301539">regs</span><span class="op" id="2301543">)</span><span class="op" id="2301544">)</span><span class="op" id="2301545">)</span><br>
<span class="lineno">695</span><span class="op" id="2301547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2301550">func</span>&nbsp;<span class="ident" id="2301555">PtraceSetOptions</span><span class="op" id="2301571">(</span><span class="ident" id="2301572">pid</span>&nbsp;<span class="builtintype" id="2301576">int</span><span class="op" id="2301579">,</span>&nbsp;<span class="ident" id="2301581">options</span>&nbsp;<span class="builtintype" id="2301589">int</span><span class="op" id="2301592">)</span>&nbsp;<span class="op" id="2301594">(</span><span class="ident" id="2301595">err</span>&nbsp;<span class="builtintype" id="2301599">error</span><span class="op" id="2301604">)</span>&nbsp;<span class="op" id="2301606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301609">return</span>&nbsp;<span class="ident" id="2301616">ptrace</span><span class="op" id="2301622">(</span><span class="ident" id="2301623">PTRACE_SETOPTIONS</span><span class="op" id="2301640">,</span>&nbsp;<span class="ident" id="2301642">pid</span><span class="op" id="2301645">,</span>&nbsp;<span class="num" id="2301647">0</span><span class="op" id="2301648">,</span>&nbsp;<span class="builtintype" id="2301650">uintptr</span><span class="op" id="2301657">(</span><span class="ident" id="2301658">options</span><span class="op" id="2301665">)</span><span class="op" id="2301666">)</span><br>
<span class="lineno"></span><span class="op" id="2301668">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2301671">func</span>&nbsp;<span class="ident" id="2301676">PtraceGetEventMsg</span><span class="op" id="2301693">(</span><span class="ident" id="2301694">pid</span>&nbsp;<span class="builtintype" id="2301698">int</span><span class="op" id="2301701">)</span>&nbsp;<span class="op" id="2301703">(</span><span class="ident" id="2301704">msg</span>&nbsp;<span class="builtintype" id="2301708">uint</span><span class="op" id="2301712">,</span>&nbsp;<span class="ident" id="2301714">err</span>&nbsp;<span class="builtintype" id="2301718">error</span><span class="op" id="2301723">)</span>&nbsp;<span class="op" id="2301725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301728">var</span>&nbsp;<span class="ident" id="2301732">data</span>&nbsp;<span class="ident" id="2301737">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301746">err</span>&nbsp;<span class="op" id="2301750">=</span>&nbsp;<span class="ident" id="2301752">ptrace</span><span class="op" id="2301758">(</span><span class="ident" id="2301759">PTRACE_GETEVENTMSG</span><span class="op" id="2301777">,</span>&nbsp;<span class="ident" id="2301779">pid</span><span class="op" id="2301782">,</span>&nbsp;<span class="num" id="2301784">0</span><span class="op" id="2301785">,</span>&nbsp;<span class="builtintype" id="2301787">uintptr</span><span class="op" id="2301794">(</span><span class="ident" id="2301795">unsafe</span><span class="op" id="2301801">.</span><span class="ident" id="2301802">Pointer</span><span class="op" id="2301809">(</span><span class="op" id="2301810">&amp;</span><span class="ident" id="2301811">data</span><span class="op" id="2301815">)</span><span class="op" id="2301816">)</span><span class="op" id="2301817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301820">msg</span>&nbsp;<span class="op" id="2301824">=</span>&nbsp;<span class="builtintype" id="2301826">uint</span><span class="op" id="2301830">(</span><span class="ident" id="2301831">data</span><span class="op" id="2301835">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301838">return</span><br>
<span class="lineno"></span><span class="op" id="2301845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2301848">func</span>&nbsp;<span class="ident" id="2301853">PtraceCont</span><span class="op" id="2301863">(</span><span class="ident" id="2301864">pid</span>&nbsp;<span class="builtintype" id="2301868">int</span><span class="op" id="2301871">,</span>&nbsp;<span class="ident" id="2301873">signal</span>&nbsp;<span class="builtintype" id="2301880">int</span><span class="op" id="2301883">)</span>&nbsp;<span class="op" id="2301885">(</span><span class="ident" id="2301886">err</span>&nbsp;<span class="builtintype" id="2301890">error</span><span class="op" id="2301895">)</span>&nbsp;<span class="op" id="2301897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301900">return</span>&nbsp;<span class="ident" id="2301907">ptrace</span><span class="op" id="2301913">(</span><span class="ident" id="2301914">PTRACE_CONT</span><span class="op" id="2301925">,</span>&nbsp;<span class="ident" id="2301927">pid</span><span class="op" id="2301930">,</span>&nbsp;<span class="num" id="2301932">0</span><span class="op" id="2301933">,</span>&nbsp;<span class="builtintype" id="2301935">uintptr</span><span class="op" id="2301942">(</span><span class="ident" id="2301943">signal</span><span class="op" id="2301949">)</span><span class="op" id="2301950">)</span><br>
<span class="lineno">710</span><span class="op" id="2301952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2301955">func</span>&nbsp;<span class="ident" id="2301960">PtraceSyscall</span><span class="op" id="2301973">(</span><span class="ident" id="2301974">pid</span>&nbsp;<span class="builtintype" id="2301978">int</span><span class="op" id="2301981">,</span>&nbsp;<span class="ident" id="2301983">signal</span>&nbsp;<span class="builtintype" id="2301990">int</span><span class="op" id="2301993">)</span>&nbsp;<span class="op" id="2301995">(</span><span class="ident" id="2301996">err</span>&nbsp;<span class="builtintype" id="2302000">error</span><span class="op" id="2302005">)</span>&nbsp;<span class="op" id="2302007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302010">return</span>&nbsp;<span class="ident" id="2302017">ptrace</span><span class="op" id="2302023">(</span><span class="ident" id="2302024">PTRACE_SYSCALL</span><span class="op" id="2302038">,</span>&nbsp;<span class="ident" id="2302040">pid</span><span class="op" id="2302043">,</span>&nbsp;<span class="num" id="2302045">0</span><span class="op" id="2302046">,</span>&nbsp;<span class="builtintype" id="2302048">uintptr</span><span class="op" id="2302055">(</span><span class="ident" id="2302056">signal</span><span class="op" id="2302062">)</span><span class="op" id="2302063">)</span><br>
<span class="lineno"></span><span class="op" id="2302065">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2302068">func</span>&nbsp;<span class="ident" id="2302073">PtraceSingleStep</span><span class="op" id="2302089">(</span><span class="ident" id="2302090">pid</span>&nbsp;<span class="builtintype" id="2302094">int</span><span class="op" id="2302097">)</span>&nbsp;<span class="op" id="2302099">(</span><span class="ident" id="2302100">err</span>&nbsp;<span class="builtintype" id="2302104">error</span><span class="op" id="2302109">)</span>&nbsp;<span class="op" id="2302111">{</span>&nbsp;<span class="keyword" id="2302113">return</span>&nbsp;<span class="ident" id="2302120">ptrace</span><span class="op" id="2302126">(</span><span class="ident" id="2302127">PTRACE_SINGLESTEP</span><span class="op" id="2302144">,</span>&nbsp;<span class="ident" id="2302146">pid</span><span class="op" id="2302149">,</span>&nbsp;<span class="num" id="2302151">0</span><span class="op" id="2302152">,</span>&nbsp;<span class="num" id="2302154">0</span><span class="op" id="2302155">)</span>&nbsp;<span class="op" id="2302157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2302160">func</span>&nbsp;<span class="ident" id="2302165">PtraceAttach</span><span class="op" id="2302177">(</span><span class="ident" id="2302178">pid</span>&nbsp;<span class="builtintype" id="2302182">int</span><span class="op" id="2302185">)</span>&nbsp;<span class="op" id="2302187">(</span><span class="ident" id="2302188">err</span>&nbsp;<span class="builtintype" id="2302192">error</span><span class="op" id="2302197">)</span>&nbsp;<span class="op" id="2302199">{</span>&nbsp;<span class="keyword" id="2302201">return</span>&nbsp;<span class="ident" id="2302208">ptrace</span><span class="op" id="2302214">(</span><span class="ident" id="2302215">PTRACE_ATTACH</span><span class="op" id="2302228">,</span>&nbsp;<span class="ident" id="2302230">pid</span><span class="op" id="2302233">,</span>&nbsp;<span class="num" id="2302235">0</span><span class="op" id="2302236">,</span>&nbsp;<span class="num" id="2302238">0</span><span class="op" id="2302239">)</span>&nbsp;<span class="op" id="2302241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2302244">func</span>&nbsp;<span class="ident" id="2302249">PtraceDetach</span><span class="op" id="2302261">(</span><span class="ident" id="2302262">pid</span>&nbsp;<span class="builtintype" id="2302266">int</span><span class="op" id="2302269">)</span>&nbsp;<span class="op" id="2302271">(</span><span class="ident" id="2302272">err</span>&nbsp;<span class="builtintype" id="2302276">error</span><span class="op" id="2302281">)</span>&nbsp;<span class="op" id="2302283">{</span>&nbsp;<span class="keyword" id="2302285">return</span>&nbsp;<span class="ident" id="2302292">ptrace</span><span class="op" id="2302298">(</span><span class="ident" id="2302299">PTRACE_DETACH</span><span class="op" id="2302312">,</span>&nbsp;<span class="ident" id="2302314">pid</span><span class="op" id="2302317">,</span>&nbsp;<span class="num" id="2302319">0</span><span class="op" id="2302320">,</span>&nbsp;<span class="num" id="2302322">0</span><span class="op" id="2302323">)</span>&nbsp;<span class="op" id="2302325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2302328">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2302401">func</span>&nbsp;<span class="ident" id="2302406">Reboot</span><span class="op" id="2302412">(</span><span class="ident" id="2302413">cmd</span>&nbsp;<span class="builtintype" id="2302417">int</span><span class="op" id="2302420">)</span>&nbsp;<span class="op" id="2302422">(</span><span class="ident" id="2302423">err</span>&nbsp;<span class="builtintype" id="2302427">error</span><span class="op" id="2302432">)</span>&nbsp;<span class="op" id="2302434">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302437">return</span>&nbsp;<span class="ident" id="2302444">reboot</span><span class="op" id="2302450">(</span><span class="ident" id="2302451">LINUX_REBOOT_MAGIC1</span><span class="op" id="2302470">,</span>&nbsp;<span class="ident" id="2302472">LINUX_REBOOT_MAGIC2</span><span class="op" id="2302491">,</span>&nbsp;<span class="ident" id="2302493">cmd</span><span class="op" id="2302496">,</span>&nbsp;<span class="string" id="2302498">&#34;&#34;</span><span class="op" id="2302500">)</span><br>
<span class="lineno"></span><span class="op" id="2302502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2302505">func</span>&nbsp;<span class="ident" id="2302510">clen</span><span class="op" id="2302514">(</span><span class="ident" id="2302515">n</span>&nbsp;<span class="op" id="2302517">[</span><span class="op" id="2302518">]</span><span class="builtintype" id="2302519">byte</span><span class="op" id="2302523">)</span>&nbsp;<span class="builtintype" id="2302525">int</span>&nbsp;<span class="op" id="2302529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302532">for</span>&nbsp;<span class="ident" id="2302536">i</span>&nbsp;<span class="op" id="2302538">:=</span>&nbsp;<span class="num" id="2302541">0</span><span class="op" id="2302542">;</span>&nbsp;<span class="ident" id="2302544">i</span>&nbsp;<span class="op" id="2302546">&lt;</span>&nbsp;<span class="builtinfunc" id="2302548">len</span><span class="op" id="2302551">(</span><span class="ident" id="2302552">n</span><span class="op" id="2302553">)</span><span class="op" id="2302554">;</span>&nbsp;<span class="ident" id="2302556">i</span><span class="op" id="2302557">++</span>&nbsp;<span class="op" id="2302560">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302564">if</span>&nbsp;<span class="ident" id="2302567">n</span><span class="op" id="2302568">[</span><span class="ident" id="2302569">i</span><span class="op" id="2302570">]</span>&nbsp;<span class="op" id="2302572">==</span>&nbsp;<span class="num" id="2302575">0</span>&nbsp;<span class="op" id="2302577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302582">return</span>&nbsp;<span class="ident" id="2302589">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302599">return</span>&nbsp;<span class="builtinfunc" id="2302606">len</span><span class="op" id="2302609">(</span><span class="ident" id="2302610">n</span><span class="op" id="2302611">)</span><br>
<span class="lineno">735</span><span class="op" id="2302613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2302616">func</span>&nbsp;<span class="ident" id="2302621">ReadDirent</span><span class="op" id="2302631">(</span><span class="ident" id="2302632">fd</span>&nbsp;<span class="builtintype" id="2302635">int</span><span class="op" id="2302638">,</span>&nbsp;<span class="ident" id="2302640">buf</span>&nbsp;<span class="op" id="2302644">[</span><span class="op" id="2302645">]</span><span class="builtintype" id="2302646">byte</span><span class="op" id="2302650">)</span>&nbsp;<span class="op" id="2302652">(</span><span class="ident" id="2302653">n</span>&nbsp;<span class="builtintype" id="2302655">int</span><span class="op" id="2302658">,</span>&nbsp;<span class="ident" id="2302660">err</span>&nbsp;<span class="builtintype" id="2302664">error</span><span class="op" id="2302669">)</span>&nbsp;<span class="op" id="2302671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302674">return</span>&nbsp;<span class="ident" id="2302681">Getdents</span><span class="op" id="2302689">(</span><span class="ident" id="2302690">fd</span><span class="op" id="2302692">,</span>&nbsp;<span class="ident" id="2302694">buf</span><span class="op" id="2302697">)</span><br>
<span class="lineno"></span><span class="op" id="2302699">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2302702">func</span>&nbsp;<span class="ident" id="2302707">ParseDirent</span><span class="op" id="2302718">(</span><span class="ident" id="2302719">buf</span>&nbsp;<span class="op" id="2302723">[</span><span class="op" id="2302724">]</span><span class="builtintype" id="2302725">byte</span><span class="op" id="2302729">,</span>&nbsp;<span class="ident" id="2302731">max</span>&nbsp;<span class="builtintype" id="2302735">int</span><span class="op" id="2302738">,</span>&nbsp;<span class="ident" id="2302740">names</span>&nbsp;<span class="op" id="2302746">[</span><span class="op" id="2302747">]</span><span class="builtintype" id="2302748">string</span><span class="op" id="2302754">)</span>&nbsp;<span class="op" id="2302756">(</span><span class="ident" id="2302757">consumed</span>&nbsp;<span class="builtintype" id="2302766">int</span><span class="op" id="2302769">,</span>&nbsp;<span class="ident" id="2302771">count</span>&nbsp;<span class="builtintype" id="2302777">int</span><span class="op" id="2302780">,</span>&nbsp;<span class="ident" id="2302782">newnames</span>&nbsp;<span class="op" id="2302791">[</span><span class="op" id="2302792">]</span><span class="builtintype" id="2302793">string</span><span class="op" id="2302799">)</span>&nbsp;<span class="op" id="2302801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302804">origlen</span>&nbsp;<span class="op" id="2302812">:=</span>&nbsp;<span class="builtinfunc" id="2302815">len</span><span class="op" id="2302818">(</span><span class="ident" id="2302819">buf</span><span class="op" id="2302822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302825">count</span>&nbsp;<span class="op" id="2302831">=</span>&nbsp;<span class="num" id="2302833">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302836">for</span>&nbsp;<span class="ident" id="2302840">max</span>&nbsp;<span class="op" id="2302844">!=</span>&nbsp;<span class="num" id="2302847">0</span>&nbsp;<span class="op" id="2302849">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2302852">len</span><span class="op" id="2302855">(</span><span class="ident" id="2302856">buf</span><span class="op" id="2302859">)</span>&nbsp;<span class="op" id="2302861">&gt;</span>&nbsp;<span class="num" id="2302863">0</span>&nbsp;<span class="op" id="2302865">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302869">dirent</span>&nbsp;<span class="op" id="2302876">:=</span>&nbsp;<span class="op" id="2302879">(</span><span class="op" id="2302880">*</span><span class="ident" id="2302881">Dirent</span><span class="op" id="2302887">)</span><span class="op" id="2302888">(</span><span class="ident" id="2302889">unsafe</span><span class="op" id="2302895">.</span><span class="ident" id="2302896">Pointer</span><span class="op" id="2302903">(</span><span class="op" id="2302904">&amp;</span><span class="ident" id="2302905">buf</span><span class="op" id="2302908">[</span><span class="num" id="2302909">0</span><span class="op" id="2302910">]</span><span class="op" id="2302911">)</span><span class="op" id="2302912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302916">buf</span>&nbsp;<span class="op" id="2302920">=</span>&nbsp;<span class="ident" id="2302922">buf</span><span class="op" id="2302925">[</span><span class="ident" id="2302926">dirent</span><span class="op" id="2302932">.</span><span class="ident" id="2302933">Reclen</span><span class="op" id="2302939">:</span><span class="op" id="2302940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302944">if</span>&nbsp;<span class="ident" id="2302947">dirent</span><span class="op" id="2302953">.</span><span class="ident" id="2302954">Ino</span>&nbsp;<span class="op" id="2302958">==</span>&nbsp;<span class="num" id="2302961">0</span>&nbsp;<span class="op" id="2302963">{</span>&nbsp;<span class="comment" id="2302965">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302997">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303008">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303012">bytes</span>&nbsp;<span class="op" id="2303018">:=</span>&nbsp;<span class="op" id="2303021">(</span><span class="op" id="2303022">*</span><span class="op" id="2303023">[</span><span class="num" id="2303024">10000</span><span class="op" id="2303029">]</span><span class="builtintype" id="2303030">byte</span><span class="op" id="2303034">)</span><span class="op" id="2303035">(</span><span class="ident" id="2303036">unsafe</span><span class="op" id="2303042">.</span><span class="ident" id="2303043">Pointer</span><span class="op" id="2303050">(</span><span class="op" id="2303051">&amp;</span><span class="ident" id="2303052">dirent</span><span class="op" id="2303058">.</span><span class="ident" id="2303059">Name</span><span class="op" id="2303063">[</span><span class="num" id="2303064">0</span><span class="op" id="2303065">]</span><span class="op" id="2303066">)</span><span class="op" id="2303067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303071">var</span>&nbsp;<span class="ident" id="2303075">name</span>&nbsp;<span class="op" id="2303080">=</span>&nbsp;<span class="builtintype" id="2303082">string</span><span class="op" id="2303088">(</span><span class="ident" id="2303089">bytes</span><span class="op" id="2303094">[</span><span class="num" id="2303095">0</span><span class="op" id="2303096">:</span><span class="ident" id="2303097">clen</span><span class="op" id="2303101">(</span><span class="ident" id="2303102">bytes</span><span class="op" id="2303107">[</span><span class="op" id="2303108">:</span><span class="op" id="2303109">]</span><span class="op" id="2303110">)</span><span class="op" id="2303111">]</span><span class="op" id="2303112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303116">if</span>&nbsp;<span class="ident" id="2303119">name</span>&nbsp;<span class="op" id="2303124">==</span>&nbsp;<span class="string" id="2303127">&#34;.&#34;</span>&nbsp;<span class="op" id="2303131">||</span>&nbsp;<span class="ident" id="2303134">name</span>&nbsp;<span class="op" id="2303139">==</span>&nbsp;<span class="string" id="2303142">&#34;..&#34;</span>&nbsp;<span class="op" id="2303147">{</span>&nbsp;<span class="comment" id="2303149">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303169">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303180">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303184">max</span><span class="op" id="2303187">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303192">count</span><span class="op" id="2303197">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303202">names</span>&nbsp;<span class="op" id="2303208">=</span>&nbsp;<span class="builtinfunc" id="2303210">append</span><span class="op" id="2303216">(</span><span class="ident" id="2303217">names</span><span class="op" id="2303222">,</span>&nbsp;<span class="ident" id="2303224">name</span><span class="op" id="2303228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303234">return</span>&nbsp;<span class="ident" id="2303241">origlen</span>&nbsp;<span class="op" id="2303249">-</span>&nbsp;<span class="builtinfunc" id="2303251">len</span><span class="op" id="2303254">(</span><span class="ident" id="2303255">buf</span><span class="op" id="2303258">)</span><span class="op" id="2303259">,</span>&nbsp;<span class="ident" id="2303261">count</span><span class="op" id="2303266">,</span>&nbsp;<span class="ident" id="2303268">names</span><br>
<span class="lineno">760</span><span class="op" id="2303274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303277">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2303374">func</span>&nbsp;<span class="ident" id="2303379">Mount</span><span class="op" id="2303384">(</span><span class="ident" id="2303385">source</span>&nbsp;<span class="builtintype" id="2303392">string</span><span class="op" id="2303398">,</span>&nbsp;<span class="ident" id="2303400">target</span>&nbsp;<span class="builtintype" id="2303407">string</span><span class="op" id="2303413">,</span>&nbsp;<span class="ident" id="2303415">fstype</span>&nbsp;<span class="builtintype" id="2303422">string</span><span class="op" id="2303428">,</span>&nbsp;<span class="ident" id="2303430">flags</span>&nbsp;<span class="builtintype" id="2303436">uintptr</span><span class="op" id="2303443">,</span>&nbsp;<span class="ident" id="2303445">data</span>&nbsp;<span class="builtintype" id="2303450">string</span><span class="op" id="2303456">)</span>&nbsp;<span class="op" id="2303458">(</span><span class="ident" id="2303459">err</span>&nbsp;<span class="builtintype" id="2303463">error</span><span class="op" id="2303468">)</span>&nbsp;<span class="op" id="2303470">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303473">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303538">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303590">if</span>&nbsp;<span class="ident" id="2303593">data</span>&nbsp;<span class="op" id="2303598">==</span>&nbsp;<span class="string" id="2303601">&#34;&#34;</span>&nbsp;<span class="op" id="2303604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303608">return</span>&nbsp;<span class="ident" id="2303615">mount</span><span class="op" id="2303620">(</span><span class="ident" id="2303621">source</span><span class="op" id="2303627">,</span>&nbsp;<span class="ident" id="2303629">target</span><span class="op" id="2303635">,</span>&nbsp;<span class="ident" id="2303637">fstype</span><span class="op" id="2303643">,</span>&nbsp;<span class="ident" id="2303645">flags</span><span class="op" id="2303650">,</span>&nbsp;<span class="ident" id="2303652">nil</span><span class="op" id="2303655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303658">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303661">datap</span><span class="op" id="2303666">,</span>&nbsp;<span class="ident" id="2303668">err</span>&nbsp;<span class="op" id="2303672">:=</span>&nbsp;<span class="ident" id="2303675">BytePtrFromString</span><span class="op" id="2303692">(</span><span class="ident" id="2303693">data</span><span class="op" id="2303697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303700">if</span>&nbsp;<span class="ident" id="2303703">err</span>&nbsp;<span class="op" id="2303707">!=</span>&nbsp;<span class="ident" id="2303710">nil</span>&nbsp;<span class="op" id="2303714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303718">return</span>&nbsp;<span class="ident" id="2303725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303733">err</span>&nbsp;<span class="op" id="2303737">=</span>&nbsp;<span class="ident" id="2303739">mount</span><span class="op" id="2303744">(</span><span class="ident" id="2303745">source</span><span class="op" id="2303751">,</span>&nbsp;<span class="ident" id="2303753">target</span><span class="op" id="2303759">,</span>&nbsp;<span class="ident" id="2303761">fstype</span><span class="op" id="2303767">,</span>&nbsp;<span class="ident" id="2303769">flags</span><span class="op" id="2303774">,</span>&nbsp;<span class="ident" id="2303776">datap</span><span class="op" id="2303781">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303784">use</span><span class="op" id="2303787">(</span><span class="ident" id="2303788">unsafe</span><span class="op" id="2303794">.</span><span class="ident" id="2303795">Pointer</span><span class="op" id="2303802">(</span><span class="ident" id="2303803">datap</span><span class="op" id="2303808">)</span><span class="op" id="2303809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303812">return</span>&nbsp;<span class="ident" id="2303819">err</span><br>
<span class="lineno"></span><span class="op" id="2303823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303826">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2303836">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2303848">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303863">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2303887">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2303938">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2303974">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304024">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2304061">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304111">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304149">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304181">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304239">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2304282">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304329">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304387">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304437">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304488">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2304562">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304638">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2304676">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304752">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304823">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2304856">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304902">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2304977">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305057">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305116">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2305152">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305193">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305225">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2305296">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305343">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2305371">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2305398">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2305427">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305487">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305542">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2305569">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305643">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305730">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305772">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305824">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2305898">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2305944">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2306011">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306066">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306128">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2306178">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306241">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306300">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306372">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306436">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2306462">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2306538">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2306636">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306684">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306743">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2306799">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306856">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306943">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2306980">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307022">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2307062">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307109">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307147">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2307194">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2307209">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2307289">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2307364">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2307435">func</span>&nbsp;<span class="ident" id="2307440">Setuid</span><span class="op" id="2307446">(</span><span class="ident" id="2307447">uid</span>&nbsp;<span class="builtintype" id="2307451">int</span><span class="op" id="2307454">)</span>&nbsp;<span class="op" id="2307456">(</span><span class="ident" id="2307457">err</span>&nbsp;<span class="builtintype" id="2307461">error</span><span class="op" id="2307466">)</span>&nbsp;<span class="op" id="2307468">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307471">return</span>&nbsp;<span class="ident" id="2307478">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2307489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2307492">func</span>&nbsp;<span class="ident" id="2307497">Setgid</span><span class="op" id="2307503">(</span><span class="ident" id="2307504">uid</span>&nbsp;<span class="builtintype" id="2307508">int</span><span class="op" id="2307511">)</span>&nbsp;<span class="op" id="2307513">(</span><span class="ident" id="2307514">err</span>&nbsp;<span class="builtintype" id="2307518">error</span><span class="op" id="2307523">)</span>&nbsp;<span class="op" id="2307525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307528">return</span>&nbsp;<span class="ident" id="2307535">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2307546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2307549">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307609">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307686">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2307744">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2307757">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307802">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307871">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2307929">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2307980">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2308018">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308058">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308096">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308147">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2308213">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308250">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308298">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308349">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2308398">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2308448">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2308517">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2308589">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2308645">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2308701">var</span>&nbsp;<span class="ident" id="2308705">mapper</span>&nbsp;<span class="op" id="2308712">=</span>&nbsp;<span class="op" id="2308714">&amp;</span><span class="ident" id="2308715">mmapper</span><span class="op" id="2308722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308725">active</span><span class="op" id="2308731">:</span>&nbsp;<span class="builtinfunc" id="2308733">make</span><span class="op" id="2308737">(</span><span class="keyword" id="2308738">map</span><span class="op" id="2308741">[</span><span class="op" id="2308742">*</span><span class="builtintype" id="2308743">byte</span><span class="op" id="2308747">]</span><span class="op" id="2308748">[</span><span class="op" id="2308749">]</span><span class="builtintype" id="2308750">byte</span><span class="op" id="2308754">)</span><span class="op" id="2308755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308758">mmap</span><span class="op" id="2308762">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2308766">mmap</span><span class="op" id="2308770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308773">munmap</span><span class="op" id="2308779">:</span>&nbsp;<span class="ident" id="2308781">munmap</span><span class="op" id="2308787">,</span><br>
<span class="lineno">890</span><span class="op" id="2308789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2308792">func</span>&nbsp;<span class="ident" id="2308797">Mmap</span><span class="op" id="2308801">(</span><span class="ident" id="2308802">fd</span>&nbsp;<span class="builtintype" id="2308805">int</span><span class="op" id="2308808">,</span>&nbsp;<span class="ident" id="2308810">offset</span>&nbsp;<span class="ident" id="2308817">int64</span><span class="op" id="2308822">,</span>&nbsp;<span class="ident" id="2308824">length</span>&nbsp;<span class="builtintype" id="2308831">int</span><span class="op" id="2308834">,</span>&nbsp;<span class="ident" id="2308836">prot</span>&nbsp;<span class="builtintype" id="2308841">int</span><span class="op" id="2308844">,</span>&nbsp;<span class="ident" id="2308846">flags</span>&nbsp;<span class="builtintype" id="2308852">int</span><span class="op" id="2308855">)</span>&nbsp;<span class="op" id="2308857">(</span><span class="ident" id="2308858">data</span>&nbsp;<span class="op" id="2308863">[</span><span class="op" id="2308864">]</span><span class="builtintype" id="2308865">byte</span><span class="op" id="2308869">,</span>&nbsp;<span class="ident" id="2308871">err</span>&nbsp;<span class="builtintype" id="2308875">error</span><span class="op" id="2308880">)</span>&nbsp;<span class="op" id="2308882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308885">return</span>&nbsp;<span class="ident" id="2308892">mapper</span><span class="op" id="2308898">.</span><span class="ident" id="2308899">Mmap</span><span class="op" id="2308903">(</span><span class="ident" id="2308904">fd</span><span class="op" id="2308906">,</span>&nbsp;<span class="ident" id="2308908">offset</span><span class="op" id="2308914">,</span>&nbsp;<span class="ident" id="2308916">length</span><span class="op" id="2308922">,</span>&nbsp;<span class="ident" id="2308924">prot</span><span class="op" id="2308928">,</span>&nbsp;<span class="ident" id="2308930">flags</span><span class="op" id="2308935">)</span><br>
<span class="lineno"></span><span class="op" id="2308937">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2308940">func</span>&nbsp;<span class="ident" id="2308945">Munmap</span><span class="op" id="2308951">(</span><span class="ident" id="2308952">b</span>&nbsp;<span class="op" id="2308954">[</span><span class="op" id="2308955">]</span><span class="builtintype" id="2308956">byte</span><span class="op" id="2308960">)</span>&nbsp;<span class="op" id="2308962">(</span><span class="ident" id="2308963">err</span>&nbsp;<span class="builtintype" id="2308967">error</span><span class="op" id="2308972">)</span>&nbsp;<span class="op" id="2308974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308977">return</span>&nbsp;<span class="ident" id="2308984">mapper</span><span class="op" id="2308990">.</span><span class="ident" id="2308991">Munmap</span><span class="op" id="2308997">(</span><span class="ident" id="2308998">b</span><span class="op" id="2308999">)</span><br>
<span class="lineno"></span><span class="op" id="2309001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2309004">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2309052">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2309099">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2309133">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2309169">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2309207">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2309239">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2309263">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2309273">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2309287">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2309296">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2309309">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2309316">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2309326">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2309336">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2309351">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2309367">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2309385">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2309401">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2309410">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2309426">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2309442">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2309457">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2309471">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2309487">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2309498">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2309508">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2309521">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2309534">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2309548">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2309556">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2309572">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2309585">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2309594">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2309611">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2309627">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2309644">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2309661">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2309674">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2309685">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2309697">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2309710">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2309725">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2309736">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2309748">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2309757">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2309770">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2309783">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2309796">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2309806">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2309819">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2309833">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2309850">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2309866">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2309879">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2309888">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2309904">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2309915">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2309928">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2309937">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2309950">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2309962">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2309978">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2309990">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2310000">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2310018">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2310033">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2310045">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2310055">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2310065">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2310075">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2310085">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2310095">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2310104">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2310118">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2310132">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2310147">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2310155">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2310164">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2310173">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2310185">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2310195">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2310206">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2310221">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2310233">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2310246">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2310255">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2310273">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2310287">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2310305">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2310320">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2310336">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2310353">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2310371">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2310386">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2310402">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2310420">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2310443">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2310466">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2310486">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2310503">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2310524">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2310546">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2310566">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2310583">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2310597">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2310609">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2310619">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2310629">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2310638">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2310652">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2310668">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2310685">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2310702">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2310719">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2310728">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2310738">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2310747">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2310757">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2310772">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2310784">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2310795">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2310805">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2310814">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2310829">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2310844">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2310863">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2310879">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2310895">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2310906">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2310926">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2310937">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2310948">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2310958">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2310971">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2310980">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2310991">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2311003">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2311014">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2311024">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
