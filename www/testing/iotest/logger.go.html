<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6269759">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6269814">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6269868">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6269919">package</span>&nbsp;<span class="ident" id="6269927">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6269935">import</span>&nbsp;<span class="op" id="6269942">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6269945">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6269951">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6269957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6269960">type</span>&nbsp;<span class="ident" id="6269965">writeLogger</span>&nbsp;<span class="keyword" id="6269977">struct</span>&nbsp;<span class="op" id="6269984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269987">prefix</span>&nbsp;<span class="builtintype" id="6269994">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270002">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270009">io</span><span class="op" id="6270011">.</span><span class="ident" id="6270012">Writer</span><br>
<span class="lineno">15</span><span class="op" id="6270019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6270022">func</span>&nbsp;<span class="op" id="6270027">(</span><span class="ident" id="6270028">l</span>&nbsp;<span class="op" id="6270030">*</span><span class="ident" id="6270031">writeLogger</span><span class="op" id="6270042">)</span>&nbsp;<span class="ident" id="6270044">Write</span><span class="op" id="6270049">(</span><span class="ident" id="6270050">p</span>&nbsp;<span class="op" id="6270052">[</span><span class="op" id="6270053">]</span><span class="builtintype" id="6270054">byte</span><span class="op" id="6270058">)</span>&nbsp;<span class="op" id="6270060">(</span><span class="ident" id="6270061">n</span>&nbsp;<span class="builtintype" id="6270063">int</span><span class="op" id="6270066">,</span>&nbsp;<span class="ident" id="6270068">err</span>&nbsp;<span class="builtintype" id="6270072">error</span><span class="op" id="6270077">)</span>&nbsp;<span class="op" id="6270079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270082">n</span><span class="op" id="6270083">,</span>&nbsp;<span class="ident" id="6270085">err</span>&nbsp;<span class="op" id="6270089">=</span>&nbsp;<span class="ident" id="6270091">l</span><span class="op" id="6270092">.</span><span class="ident" id="6270093">w</span><span class="op" id="6270094">.</span><span class="ident" id="6270095">Write</span><span class="op" id="6270100">(</span><span class="ident" id="6270101">p</span><span class="op" id="6270102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270105">if</span>&nbsp;<span class="ident" id="6270108">err</span>&nbsp;<span class="op" id="6270112">!=</span>&nbsp;<span class="ident" id="6270115">nil</span>&nbsp;<span class="op" id="6270119">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270123">log</span><span class="op" id="6270126">.</span><span class="ident" id="6270127">Printf</span><span class="op" id="6270133">(</span><span class="string" id="6270134">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="6270145">,</span>&nbsp;<span class="ident" id="6270147">l</span><span class="op" id="6270148">.</span><span class="ident" id="6270149">prefix</span><span class="op" id="6270155">,</span>&nbsp;<span class="ident" id="6270157">p</span><span class="op" id="6270158">[</span><span class="num" id="6270159">0</span><span class="op" id="6270160">:</span><span class="ident" id="6270161">n</span><span class="op" id="6270162">]</span><span class="op" id="6270163">,</span>&nbsp;<span class="ident" id="6270165">err</span><span class="op" id="6270168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270171">}</span>&nbsp;<span class="keyword" id="6270173">else</span>&nbsp;<span class="op" id="6270178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270182">log</span><span class="op" id="6270185">.</span><span class="ident" id="6270186">Printf</span><span class="op" id="6270192">(</span><span class="string" id="6270193">&#34;%s&nbsp;%x&#34;</span><span class="op" id="6270200">,</span>&nbsp;<span class="ident" id="6270202">l</span><span class="op" id="6270203">.</span><span class="ident" id="6270204">prefix</span><span class="op" id="6270210">,</span>&nbsp;<span class="ident" id="6270212">p</span><span class="op" id="6270213">[</span><span class="num" id="6270214">0</span><span class="op" id="6270215">:</span><span class="ident" id="6270216">n</span><span class="op" id="6270217">]</span><span class="op" id="6270218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270224">return</span><br>
<span class="lineno">25</span><span class="op" id="6270231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6270234">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="6270296">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="6270361">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="6270418">func</span>&nbsp;<span class="ident" id="6270423">NewWriteLogger</span><span class="op" id="6270437">(</span><span class="ident" id="6270438">prefix</span>&nbsp;<span class="builtintype" id="6270445">string</span><span class="op" id="6270451">,</span>&nbsp;<span class="ident" id="6270453">w</span>&nbsp;<span class="ident" id="6270455">io</span><span class="op" id="6270457">.</span><span class="ident" id="6270458">Writer</span><span class="op" id="6270464">)</span>&nbsp;<span class="ident" id="6270466">io</span><span class="op" id="6270468">.</span><span class="ident" id="6270469">Writer</span>&nbsp;<span class="op" id="6270476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270479">return</span>&nbsp;<span class="op" id="6270486">&amp;</span><span class="ident" id="6270487">writeLogger</span><span class="op" id="6270498">{</span><span class="ident" id="6270499">prefix</span><span class="op" id="6270505">,</span>&nbsp;<span class="ident" id="6270507">w</span><span class="op" id="6270508">}</span><br>
<span class="lineno"></span><span class="op" id="6270510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6270513">type</span>&nbsp;<span class="ident" id="6270518">readLogger</span>&nbsp;<span class="keyword" id="6270529">struct</span>&nbsp;<span class="op" id="6270536">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270539">prefix</span>&nbsp;<span class="builtintype" id="6270546">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270554">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6270561">io</span><span class="op" id="6270563">.</span><span class="ident" id="6270564">Reader</span><br>
<span class="lineno"></span><span class="op" id="6270571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6270574">func</span>&nbsp;<span class="op" id="6270579">(</span><span class="ident" id="6270580">l</span>&nbsp;<span class="op" id="6270582">*</span><span class="ident" id="6270583">readLogger</span><span class="op" id="6270593">)</span>&nbsp;<span class="ident" id="6270595">Read</span><span class="op" id="6270599">(</span><span class="ident" id="6270600">p</span>&nbsp;<span class="op" id="6270602">[</span><span class="op" id="6270603">]</span><span class="builtintype" id="6270604">byte</span><span class="op" id="6270608">)</span>&nbsp;<span class="op" id="6270610">(</span><span class="ident" id="6270611">n</span>&nbsp;<span class="builtintype" id="6270613">int</span><span class="op" id="6270616">,</span>&nbsp;<span class="ident" id="6270618">err</span>&nbsp;<span class="builtintype" id="6270622">error</span><span class="op" id="6270627">)</span>&nbsp;<span class="op" id="6270629">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270632">n</span><span class="op" id="6270633">,</span>&nbsp;<span class="ident" id="6270635">err</span>&nbsp;<span class="op" id="6270639">=</span>&nbsp;<span class="ident" id="6270641">l</span><span class="op" id="6270642">.</span><span class="ident" id="6270643">r</span><span class="op" id="6270644">.</span><span class="ident" id="6270645">Read</span><span class="op" id="6270649">(</span><span class="ident" id="6270650">p</span><span class="op" id="6270651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270654">if</span>&nbsp;<span class="ident" id="6270657">err</span>&nbsp;<span class="op" id="6270661">!=</span>&nbsp;<span class="ident" id="6270664">nil</span>&nbsp;<span class="op" id="6270668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270672">log</span><span class="op" id="6270675">.</span><span class="ident" id="6270676">Printf</span><span class="op" id="6270682">(</span><span class="string" id="6270683">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="6270694">,</span>&nbsp;<span class="ident" id="6270696">l</span><span class="op" id="6270697">.</span><span class="ident" id="6270698">prefix</span><span class="op" id="6270704">,</span>&nbsp;<span class="ident" id="6270706">p</span><span class="op" id="6270707">[</span><span class="num" id="6270708">0</span><span class="op" id="6270709">:</span><span class="ident" id="6270710">n</span><span class="op" id="6270711">]</span><span class="op" id="6270712">,</span>&nbsp;<span class="ident" id="6270714">err</span><span class="op" id="6270717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270720">}</span>&nbsp;<span class="keyword" id="6270722">else</span>&nbsp;<span class="op" id="6270727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270731">log</span><span class="op" id="6270734">.</span><span class="ident" id="6270735">Printf</span><span class="op" id="6270741">(</span><span class="string" id="6270742">&#34;%s&nbsp;%x&#34;</span><span class="op" id="6270749">,</span>&nbsp;<span class="ident" id="6270751">l</span><span class="op" id="6270752">.</span><span class="ident" id="6270753">prefix</span><span class="op" id="6270759">,</span>&nbsp;<span class="ident" id="6270761">p</span><span class="op" id="6270762">[</span><span class="num" id="6270763">0</span><span class="op" id="6270764">:</span><span class="ident" id="6270765">n</span><span class="op" id="6270766">]</span><span class="op" id="6270767">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270773">return</span><br>
<span class="lineno"></span><span class="op" id="6270780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6270783">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="6270844">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="6270907">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="6270964">func</span>&nbsp;<span class="ident" id="6270969">NewReadLogger</span><span class="op" id="6270982">(</span><span class="ident" id="6270983">prefix</span>&nbsp;<span class="builtintype" id="6270990">string</span><span class="op" id="6270996">,</span>&nbsp;<span class="ident" id="6270998">r</span>&nbsp;<span class="ident" id="6271000">io</span><span class="op" id="6271002">.</span><span class="ident" id="6271003">Reader</span><span class="op" id="6271009">)</span>&nbsp;<span class="ident" id="6271011">io</span><span class="op" id="6271013">.</span><span class="ident" id="6271014">Reader</span>&nbsp;<span class="op" id="6271021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6271024">return</span>&nbsp;<span class="op" id="6271031">&amp;</span><span class="ident" id="6271032">readLogger</span><span class="op" id="6271042">{</span><span class="ident" id="6271043">prefix</span><span class="op" id="6271049">,</span>&nbsp;<span class="ident" id="6271051">r</span><span class="op" id="6271052">}</span><br>
<span class="lineno"></span><span class="op" id="6271054">}</span>
</div>
</body>
</html>
