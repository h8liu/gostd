<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1777144">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1777199">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1777253">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1777304">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1777378">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1777402">package</span>&nbsp;<span class="ident" id="1777410">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1777419">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1777486">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1777552">const</span>&nbsp;<span class="op" id="1777558">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777561">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777577">=</span>&nbsp;<span class="string" id="1777579">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1777592">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777630">ReplacementChar</span>&nbsp;<span class="op" id="1777646">=</span>&nbsp;<span class="string" id="1777648">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777661">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777697">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777713">=</span>&nbsp;<span class="string" id="1777715">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777728">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1777753">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777769">=</span>&nbsp;<span class="string" id="1777771">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777784">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1777810">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1777813">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1777889">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1777956">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1778029">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1778092">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1778152">type</span>&nbsp;<span class="ident" id="1778157">RangeTable</span>&nbsp;<span class="keyword" id="1778168">struct</span>&nbsp;<span class="op" id="1778175">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778178">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1778190">[</span><span class="op" id="1778191">]</span><span class="ident" id="1778192">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778201">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1778213">[</span><span class="op" id="1778214">]</span><span class="ident" id="1778215">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778224">LatinOffset</span>&nbsp;<span class="builtintype" id="1778236">int</span>&nbsp;<span class="comment" id="1778240">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1778289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1778292">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1778386">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1778429">type</span>&nbsp;<span class="ident" id="1778434">Range16</span>&nbsp;<span class="keyword" id="1778442">struct</span>&nbsp;<span class="op" id="1778449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778452">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1778459">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778467">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1778474">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778482">Stride</span>&nbsp;<span class="builtintype" id="1778489">uint16</span><br>
<span class="lineno"></span><span class="op" id="1778496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1778499">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1778579">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1778656">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1778734">type</span>&nbsp;<span class="ident" id="1778739">Range32</span>&nbsp;<span class="keyword" id="1778747">struct</span>&nbsp;<span class="op" id="1778754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778757">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1778764">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778772">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1778779">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1778787">Stride</span>&nbsp;<span class="builtintype" id="1778794">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1778801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1778804">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1778875">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1778925">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1779002">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1779075">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1779149">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1779221">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1779297">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1779341">//&nbsp;&nbsp;&nbsp;&nbsp{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1779381">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1779449">type</span>&nbsp;<span class="ident" id="1779454">CaseRange</span>&nbsp;<span class="keyword" id="1779464">struct</span>&nbsp;<span class="op" id="1779471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779474">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1779480">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779488">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1779494">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779502">Delta</span>&nbsp;<span class="ident" id="1779508">d</span><br>
<span class="lineno"></span><span class="op" id="1779510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1779513">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1779588">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1779663">type</span>&nbsp;<span class="ident" id="1779668">SpecialCase</span>&nbsp;<span class="op" id="1779680">[</span><span class="op" id="1779681">]</span><span class="ident" id="1779682">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1779693">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1779762">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1779829">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1779898">const</span>&nbsp;<span class="op" id="1779904">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779907">UpperCase</span>&nbsp;<span class="op" id="1779917">=</span>&nbsp;<span class="ident" id="1779919">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779925">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779936">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1779947">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1779955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1779958">type</span>&nbsp;<span class="ident" id="1779963">d</span>&nbsp;<span class="op" id="1779965">[</span><span class="ident" id="1779966">MaxCase</span><span class="op" id="1779973">]</span><span class="builtintype" id="1779974">rune</span>&nbsp;<span class="comment" id="1779979">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1780019">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1780080">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1780138">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1780166">const</span>&nbsp;<span class="op" id="1780172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780175">UpperLower</span>&nbsp;<span class="op" id="1780186">=</span>&nbsp;<span class="ident" id="1780188">MaxRune</span>&nbsp;<span class="op" id="1780196">+</span>&nbsp;<span class="num" id="1780198">1</span>&nbsp;<span class="comment" id="1780200">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1780230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1780233">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1780311">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1780355">const</span>&nbsp;<span class="ident" id="1780361">linearMax</span>&nbsp;<span class="op" id="1780371">=</span>&nbsp;<span class="num" id="1780373">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1780377">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1780444">func</span>&nbsp;<span class="ident" id="1780449">is16</span><span class="op" id="1780453">(</span><span class="ident" id="1780454">ranges</span>&nbsp;<span class="op" id="1780461">[</span><span class="op" id="1780462">]</span><span class="ident" id="1780463">Range16</span><span class="op" id="1780470">,</span>&nbsp;<span class="ident" id="1780472">r</span>&nbsp;<span class="builtintype" id="1780474">uint16</span><span class="op" id="1780480">)</span>&nbsp;<span class="builtintype" id="1780482">bool</span>&nbsp;<span class="op" id="1780487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780490">if</span>&nbsp;<span class="builtinfunc" id="1780493">len</span><span class="op" id="1780496">(</span><span class="ident" id="1780497">ranges</span><span class="op" id="1780503">)</span>&nbsp;<span class="op" id="1780505">&lt;=</span>&nbsp;<span class="ident" id="1780508">linearMax</span>&nbsp;<span class="op" id="1780518">||</span>&nbsp;<span class="ident" id="1780521">r</span>&nbsp;<span class="op" id="1780523">&lt;=</span>&nbsp;<span class="ident" id="1780526">MaxLatin1</span>&nbsp;<span class="op" id="1780536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780540">for</span>&nbsp;<span class="ident" id="1780544">i</span>&nbsp;<span class="op" id="1780546">:=</span>&nbsp;<span class="keyword" id="1780549">range</span>&nbsp;<span class="ident" id="1780555">ranges</span>&nbsp;<span class="op" id="1780562">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780567">range_</span>&nbsp;<span class="op" id="1780574">:=</span>&nbsp;<span class="op" id="1780577">&amp;</span><span class="ident" id="1780578">ranges</span><span class="op" id="1780584">[</span><span class="ident" id="1780585">i</span><span class="op" id="1780586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780591">if</span>&nbsp;<span class="ident" id="1780594">r</span>&nbsp;<span class="op" id="1780596">&lt;</span>&nbsp;<span class="ident" id="1780598">range_</span><span class="op" id="1780604">.</span><span class="ident" id="1780605">Lo</span>&nbsp;<span class="op" id="1780608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780614">return</span>&nbsp;<span class="builtintype" id="1780621">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780635">if</span>&nbsp;<span class="ident" id="1780638">r</span>&nbsp;<span class="op" id="1780640">&lt;=</span>&nbsp;<span class="ident" id="1780643">range_</span><span class="op" id="1780649">.</span><span class="ident" id="1780650">Hi</span>&nbsp;<span class="op" id="1780653">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780659">return</span>&nbsp;<span class="op" id="1780666">(</span><span class="ident" id="1780667">r</span><span class="op" id="1780668">-</span><span class="ident" id="1780669">range_</span><span class="op" id="1780675">.</span><span class="ident" id="1780676">Lo</span><span class="op" id="1780678">)</span><span class="op" id="1780679">%</span><span class="ident" id="1780680">range_</span><span class="op" id="1780686">.</span><span class="ident" id="1780687">Stride</span>&nbsp;<span class="op" id="1780694">==</span>&nbsp;<span class="num" id="1780697">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780710">return</span>&nbsp;<span class="builtintype" id="1780717">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780724">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1780728">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780758">lo</span>&nbsp;<span class="op" id="1780761">:=</span>&nbsp;<span class="num" id="1780764">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780767">hi</span>&nbsp;<span class="op" id="1780770">:=</span>&nbsp;<span class="builtinfunc" id="1780773">len</span><span class="op" id="1780776">(</span><span class="ident" id="1780777">ranges</span><span class="op" id="1780783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780786">for</span>&nbsp;<span class="ident" id="1780790">lo</span>&nbsp;<span class="op" id="1780793">&lt;</span>&nbsp;<span class="ident" id="1780795">hi</span>&nbsp;<span class="op" id="1780798">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780802">m</span>&nbsp;<span class="op" id="1780804">:=</span>&nbsp;<span class="ident" id="1780807">lo</span>&nbsp;<span class="op" id="1780810">+</span>&nbsp;<span class="op" id="1780812">(</span><span class="ident" id="1780813">hi</span><span class="op" id="1780815">-</span><span class="ident" id="1780816">lo</span><span class="op" id="1780818">)</span><span class="op" id="1780819">/</span><span class="num" id="1780820">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780824">range_</span>&nbsp;<span class="op" id="1780831">:=</span>&nbsp;<span class="op" id="1780834">&amp;</span><span class="ident" id="1780835">ranges</span><span class="op" id="1780841">[</span><span class="ident" id="1780842">m</span><span class="op" id="1780843">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780847">if</span>&nbsp;<span class="ident" id="1780850">range_</span><span class="op" id="1780856">.</span><span class="ident" id="1780857">Lo</span>&nbsp;<span class="op" id="1780860">&lt;=</span>&nbsp;<span class="ident" id="1780863">r</span>&nbsp;<span class="op" id="1780865">&amp;&amp;</span>&nbsp;<span class="ident" id="1780868">r</span>&nbsp;<span class="op" id="1780870">&lt;=</span>&nbsp;<span class="ident" id="1780873">range_</span><span class="op" id="1780879">.</span><span class="ident" id="1780880">Hi</span>&nbsp;<span class="op" id="1780883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780888">return</span>&nbsp;<span class="op" id="1780895">(</span><span class="ident" id="1780896">r</span><span class="op" id="1780897">-</span><span class="ident" id="1780898">range_</span><span class="op" id="1780904">.</span><span class="ident" id="1780905">Lo</span><span class="op" id="1780907">)</span><span class="op" id="1780908">%</span><span class="ident" id="1780909">range_</span><span class="op" id="1780915">.</span><span class="ident" id="1780916">Stride</span>&nbsp;<span class="op" id="1780923">==</span>&nbsp;<span class="num" id="1780926">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780930">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780934">if</span>&nbsp;<span class="ident" id="1780937">r</span>&nbsp;<span class="op" id="1780939">&lt;</span>&nbsp;<span class="ident" id="1780941">range_</span><span class="op" id="1780947">.</span><span class="ident" id="1780948">Lo</span>&nbsp;<span class="op" id="1780951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780956">hi</span>&nbsp;<span class="op" id="1780959">=</span>&nbsp;<span class="ident" id="1780961">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780965">}</span>&nbsp;<span class="keyword" id="1780967">else</span>&nbsp;<span class="op" id="1780972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1780977">lo</span>&nbsp;<span class="op" id="1780980">=</span>&nbsp;<span class="ident" id="1780982">m</span>&nbsp;<span class="op" id="1780984">+</span>&nbsp;<span class="num" id="1780986">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780990">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1780993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1780996">return</span>&nbsp;<span class="builtintype" id="1781003">false</span><br>
<span class="lineno"></span><span class="op" id="1781009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1781012">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1781079">func</span>&nbsp;<span class="ident" id="1781084">is32</span><span class="op" id="1781088">(</span><span class="ident" id="1781089">ranges</span>&nbsp;<span class="op" id="1781096">[</span><span class="op" id="1781097">]</span><span class="ident" id="1781098">Range32</span><span class="op" id="1781105">,</span>&nbsp;<span class="ident" id="1781107">r</span>&nbsp;<span class="builtintype" id="1781109">uint32</span><span class="op" id="1781115">)</span>&nbsp;<span class="builtintype" id="1781117">bool</span>&nbsp;<span class="op" id="1781122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781125">if</span>&nbsp;<span class="builtinfunc" id="1781128">len</span><span class="op" id="1781131">(</span><span class="ident" id="1781132">ranges</span><span class="op" id="1781138">)</span>&nbsp;<span class="op" id="1781140">&lt;=</span>&nbsp;<span class="ident" id="1781143">linearMax</span>&nbsp;<span class="op" id="1781153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781157">for</span>&nbsp;<span class="ident" id="1781161">i</span>&nbsp;<span class="op" id="1781163">:=</span>&nbsp;<span class="keyword" id="1781166">range</span>&nbsp;<span class="ident" id="1781172">ranges</span>&nbsp;<span class="op" id="1781179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781184">range_</span>&nbsp;<span class="op" id="1781191">:=</span>&nbsp;<span class="op" id="1781194">&amp;</span><span class="ident" id="1781195">ranges</span><span class="op" id="1781201">[</span><span class="ident" id="1781202">i</span><span class="op" id="1781203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781208">if</span>&nbsp;<span class="ident" id="1781211">r</span>&nbsp;<span class="op" id="1781213">&lt;</span>&nbsp;<span class="ident" id="1781215">range_</span><span class="op" id="1781221">.</span><span class="ident" id="1781222">Lo</span>&nbsp;<span class="op" id="1781225">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781231">return</span>&nbsp;<span class="builtintype" id="1781238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781252">if</span>&nbsp;<span class="ident" id="1781255">r</span>&nbsp;<span class="op" id="1781257">&lt;=</span>&nbsp;<span class="ident" id="1781260">range_</span><span class="op" id="1781266">.</span><span class="ident" id="1781267">Hi</span>&nbsp;<span class="op" id="1781270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781276">return</span>&nbsp;<span class="op" id="1781283">(</span><span class="ident" id="1781284">r</span><span class="op" id="1781285">-</span><span class="ident" id="1781286">range_</span><span class="op" id="1781292">.</span><span class="ident" id="1781293">Lo</span><span class="op" id="1781295">)</span><span class="op" id="1781296">%</span><span class="ident" id="1781297">range_</span><span class="op" id="1781303">.</span><span class="ident" id="1781304">Stride</span>&nbsp;<span class="op" id="1781311">==</span>&nbsp;<span class="num" id="1781314">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781319">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781327">return</span>&nbsp;<span class="builtintype" id="1781334">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1781345">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781375">lo</span>&nbsp;<span class="op" id="1781378">:=</span>&nbsp;<span class="num" id="1781381">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781384">hi</span>&nbsp;<span class="op" id="1781387">:=</span>&nbsp;<span class="builtinfunc" id="1781390">len</span><span class="op" id="1781393">(</span><span class="ident" id="1781394">ranges</span><span class="op" id="1781400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781403">for</span>&nbsp;<span class="ident" id="1781407">lo</span>&nbsp;<span class="op" id="1781410">&lt;</span>&nbsp;<span class="ident" id="1781412">hi</span>&nbsp;<span class="op" id="1781415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781419">m</span>&nbsp;<span class="op" id="1781421">:=</span>&nbsp;<span class="ident" id="1781424">lo</span>&nbsp;<span class="op" id="1781427">+</span>&nbsp;<span class="op" id="1781429">(</span><span class="ident" id="1781430">hi</span><span class="op" id="1781432">-</span><span class="ident" id="1781433">lo</span><span class="op" id="1781435">)</span><span class="op" id="1781436">/</span><span class="num" id="1781437">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781441">range_</span>&nbsp;<span class="op" id="1781448">:=</span>&nbsp;<span class="ident" id="1781451">ranges</span><span class="op" id="1781457">[</span><span class="ident" id="1781458">m</span><span class="op" id="1781459">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781463">if</span>&nbsp;<span class="ident" id="1781466">range_</span><span class="op" id="1781472">.</span><span class="ident" id="1781473">Lo</span>&nbsp;<span class="op" id="1781476">&lt;=</span>&nbsp;<span class="ident" id="1781479">r</span>&nbsp;<span class="op" id="1781481">&amp;&amp;</span>&nbsp;<span class="ident" id="1781484">r</span>&nbsp;<span class="op" id="1781486">&lt;=</span>&nbsp;<span class="ident" id="1781489">range_</span><span class="op" id="1781495">.</span><span class="ident" id="1781496">Hi</span>&nbsp;<span class="op" id="1781499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781504">return</span>&nbsp;<span class="op" id="1781511">(</span><span class="ident" id="1781512">r</span><span class="op" id="1781513">-</span><span class="ident" id="1781514">range_</span><span class="op" id="1781520">.</span><span class="ident" id="1781521">Lo</span><span class="op" id="1781523">)</span><span class="op" id="1781524">%</span><span class="ident" id="1781525">range_</span><span class="op" id="1781531">.</span><span class="ident" id="1781532">Stride</span>&nbsp;<span class="op" id="1781539">==</span>&nbsp;<span class="num" id="1781542">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781550">if</span>&nbsp;<span class="ident" id="1781553">r</span>&nbsp;<span class="op" id="1781555">&lt;</span>&nbsp;<span class="ident" id="1781557">range_</span><span class="op" id="1781563">.</span><span class="ident" id="1781564">Lo</span>&nbsp;<span class="op" id="1781567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781572">hi</span>&nbsp;<span class="op" id="1781575">=</span>&nbsp;<span class="ident" id="1781577">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781581">}</span>&nbsp;<span class="keyword" id="1781583">else</span>&nbsp;<span class="op" id="1781588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781593">lo</span>&nbsp;<span class="op" id="1781596">=</span>&nbsp;<span class="ident" id="1781598">m</span>&nbsp;<span class="op" id="1781600">+</span>&nbsp;<span class="num" id="1781602">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781612">return</span>&nbsp;<span class="builtintype" id="1781619">false</span><br>
<span class="lineno">155</span><span class="op" id="1781625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1781628">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1781696">func</span>&nbsp;<span class="ident" id="1781701">Is</span><span class="op" id="1781703">(</span><span class="ident" id="1781704">rangeTab</span>&nbsp;<span class="op" id="1781713">*</span><span class="ident" id="1781714">RangeTable</span><span class="op" id="1781724">,</span>&nbsp;<span class="ident" id="1781726">r</span>&nbsp;<span class="builtintype" id="1781728">rune</span><span class="op" id="1781732">)</span>&nbsp;<span class="builtintype" id="1781734">bool</span>&nbsp;<span class="op" id="1781739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781742">r16</span>&nbsp;<span class="op" id="1781746">:=</span>&nbsp;<span class="ident" id="1781749">rangeTab</span><span class="op" id="1781757">.</span><span class="ident" id="1781758">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781763">if</span>&nbsp;<span class="builtinfunc" id="1781766">len</span><span class="op" id="1781769">(</span><span class="ident" id="1781770">r16</span><span class="op" id="1781773">)</span>&nbsp;<span class="op" id="1781775">&gt;</span>&nbsp;<span class="num" id="1781777">0</span>&nbsp;<span class="op" id="1781779">&amp;&amp;</span>&nbsp;<span class="ident" id="1781782">r</span>&nbsp;<span class="op" id="1781784">&lt;=</span>&nbsp;<span class="builtintype" id="1781787">rune</span><span class="op" id="1781791">(</span><span class="ident" id="1781792">r16</span><span class="op" id="1781795">[</span><span class="builtinfunc" id="1781796">len</span><span class="op" id="1781799">(</span><span class="ident" id="1781800">r16</span><span class="op" id="1781803">)</span><span class="op" id="1781804">-</span><span class="num" id="1781805">1</span><span class="op" id="1781806">]</span><span class="op" id="1781807">.</span><span class="ident" id="1781808">Hi</span><span class="op" id="1781810">)</span>&nbsp;<span class="op" id="1781812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781816">return</span>&nbsp;<span class="ident" id="1781823">is16</span><span class="op" id="1781827">(</span><span class="ident" id="1781828">r16</span><span class="op" id="1781831">,</span>&nbsp;<span class="builtintype" id="1781833">uint16</span><span class="op" id="1781839">(</span><span class="ident" id="1781840">r</span><span class="op" id="1781841">)</span><span class="op" id="1781842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1781848">r32</span>&nbsp;<span class="op" id="1781852">:=</span>&nbsp;<span class="ident" id="1781855">rangeTab</span><span class="op" id="1781863">.</span><span class="ident" id="1781864">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781869">if</span>&nbsp;<span class="builtinfunc" id="1781872">len</span><span class="op" id="1781875">(</span><span class="ident" id="1781876">r32</span><span class="op" id="1781879">)</span>&nbsp;<span class="op" id="1781881">&gt;</span>&nbsp;<span class="num" id="1781883">0</span>&nbsp;<span class="op" id="1781885">&amp;&amp;</span>&nbsp;<span class="ident" id="1781888">r</span>&nbsp;<span class="op" id="1781890">&gt;=</span>&nbsp;<span class="builtintype" id="1781893">rune</span><span class="op" id="1781897">(</span><span class="ident" id="1781898">r32</span><span class="op" id="1781901">[</span><span class="num" id="1781902">0</span><span class="op" id="1781903">]</span><span class="op" id="1781904">.</span><span class="ident" id="1781905">Lo</span><span class="op" id="1781907">)</span>&nbsp;<span class="op" id="1781909">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781913">return</span>&nbsp;<span class="ident" id="1781920">is32</span><span class="op" id="1781924">(</span><span class="ident" id="1781925">r32</span><span class="op" id="1781928">,</span>&nbsp;<span class="builtintype" id="1781930">uint32</span><span class="op" id="1781936">(</span><span class="ident" id="1781937">r</span><span class="op" id="1781938">)</span><span class="op" id="1781939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1781942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1781945">return</span>&nbsp;<span class="builtintype" id="1781952">false</span><br>
<span class="lineno"></span><span class="op" id="1781958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1781961">func</span>&nbsp;<span class="ident" id="1781966">isExcludingLatin</span><span class="op" id="1781982">(</span><span class="ident" id="1781983">rangeTab</span>&nbsp;<span class="op" id="1781992">*</span><span class="ident" id="1781993">RangeTable</span><span class="op" id="1782003">,</span>&nbsp;<span class="ident" id="1782005">r</span>&nbsp;<span class="builtintype" id="1782007">rune</span><span class="op" id="1782011">)</span>&nbsp;<span class="builtintype" id="1782013">bool</span>&nbsp;<span class="op" id="1782018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782021">r16</span>&nbsp;<span class="op" id="1782025">:=</span>&nbsp;<span class="ident" id="1782028">rangeTab</span><span class="op" id="1782036">.</span><span class="ident" id="1782037">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782042">if</span>&nbsp;<span class="ident" id="1782045">off</span>&nbsp;<span class="op" id="1782049">:=</span>&nbsp;<span class="ident" id="1782052">rangeTab</span><span class="op" id="1782060">.</span><span class="ident" id="1782061">LatinOffset</span><span class="op" id="1782072">;</span>&nbsp;<span class="builtinfunc" id="1782074">len</span><span class="op" id="1782077">(</span><span class="ident" id="1782078">r16</span><span class="op" id="1782081">)</span>&nbsp;<span class="op" id="1782083">&gt;</span>&nbsp;<span class="ident" id="1782085">off</span>&nbsp;<span class="op" id="1782089">&amp;&amp;</span>&nbsp;<span class="ident" id="1782092">r</span>&nbsp;<span class="op" id="1782094">&lt;=</span>&nbsp;<span class="builtintype" id="1782097">rune</span><span class="op" id="1782101">(</span><span class="ident" id="1782102">r16</span><span class="op" id="1782105">[</span><span class="builtinfunc" id="1782106">len</span><span class="op" id="1782109">(</span><span class="ident" id="1782110">r16</span><span class="op" id="1782113">)</span><span class="op" id="1782114">-</span><span class="num" id="1782115">1</span><span class="op" id="1782116">]</span><span class="op" id="1782117">.</span><span class="ident" id="1782118">Hi</span><span class="op" id="1782120">)</span>&nbsp;<span class="op" id="1782122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782126">return</span>&nbsp;<span class="ident" id="1782133">is16</span><span class="op" id="1782137">(</span><span class="ident" id="1782138">r16</span><span class="op" id="1782141">[</span><span class="ident" id="1782142">off</span><span class="op" id="1782145">:</span><span class="op" id="1782146">]</span><span class="op" id="1782147">,</span>&nbsp;<span class="builtintype" id="1782149">uint16</span><span class="op" id="1782155">(</span><span class="ident" id="1782156">r</span><span class="op" id="1782157">)</span><span class="op" id="1782158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782161">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1782164">r32</span>&nbsp;<span class="op" id="1782168">:=</span>&nbsp;<span class="ident" id="1782171">rangeTab</span><span class="op" id="1782179">.</span><span class="ident" id="1782180">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782185">if</span>&nbsp;<span class="builtinfunc" id="1782188">len</span><span class="op" id="1782191">(</span><span class="ident" id="1782192">r32</span><span class="op" id="1782195">)</span>&nbsp;<span class="op" id="1782197">&gt;</span>&nbsp;<span class="num" id="1782199">0</span>&nbsp;<span class="op" id="1782201">&amp;&amp;</span>&nbsp;<span class="ident" id="1782204">r</span>&nbsp;<span class="op" id="1782206">&gt;=</span>&nbsp;<span class="builtintype" id="1782209">rune</span><span class="op" id="1782213">(</span><span class="ident" id="1782214">r32</span><span class="op" id="1782217">[</span><span class="num" id="1782218">0</span><span class="op" id="1782219">]</span><span class="op" id="1782220">.</span><span class="ident" id="1782221">Lo</span><span class="op" id="1782223">)</span>&nbsp;<span class="op" id="1782225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782229">return</span>&nbsp;<span class="ident" id="1782236">is32</span><span class="op" id="1782240">(</span><span class="ident" id="1782241">r32</span><span class="op" id="1782244">,</span>&nbsp;<span class="builtintype" id="1782246">uint32</span><span class="op" id="1782252">(</span><span class="ident" id="1782253">r</span><span class="op" id="1782254">)</span><span class="op" id="1782255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782261">return</span>&nbsp;<span class="builtintype" id="1782268">false</span><br>
<span class="lineno">180</span><span class="op" id="1782274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1782277">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1782338">func</span>&nbsp;<span class="ident" id="1782343">IsUpper</span><span class="op" id="1782350">(</span><span class="ident" id="1782351">r</span>&nbsp;<span class="builtintype" id="1782353">rune</span><span class="op" id="1782357">)</span>&nbsp;<span class="builtintype" id="1782359">bool</span>&nbsp;<span class="op" id="1782364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782367">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782397">if</span>&nbsp;<span class="builtintype" id="1782400">uint32</span><span class="op" id="1782406">(</span><span class="ident" id="1782407">r</span><span class="op" id="1782408">)</span>&nbsp;<span class="op" id="1782410">&lt;=</span>&nbsp;<span class="ident" id="1782413">MaxLatin1</span>&nbsp;<span class="op" id="1782423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782427">return</span>&nbsp;<span class="ident" id="1782434">properties</span><span class="op" id="1782444">[</span><span class="builtintype" id="1782445">uint8</span><span class="op" id="1782450">(</span><span class="ident" id="1782451">r</span><span class="op" id="1782452">)</span><span class="op" id="1782453">]</span><span class="op" id="1782454">&amp;</span><span class="ident" id="1782455">pLmask</span>&nbsp;<span class="op" id="1782462">==</span>&nbsp;<span class="ident" id="1782465">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782473">return</span>&nbsp;<span class="ident" id="1782480">isExcludingLatin</span><span class="op" id="1782496">(</span><span class="ident" id="1782497">Upper</span><span class="op" id="1782502">,</span>&nbsp;<span class="ident" id="1782504">r</span><span class="op" id="1782505">)</span><br>
<span class="lineno"></span><span class="op" id="1782507">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1782510">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1782570">func</span>&nbsp;<span class="ident" id="1782575">IsLower</span><span class="op" id="1782582">(</span><span class="ident" id="1782583">r</span>&nbsp;<span class="builtintype" id="1782585">rune</span><span class="op" id="1782589">)</span>&nbsp;<span class="builtintype" id="1782591">bool</span>&nbsp;<span class="op" id="1782596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1782599">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782629">if</span>&nbsp;<span class="builtintype" id="1782632">uint32</span><span class="op" id="1782638">(</span><span class="ident" id="1782639">r</span><span class="op" id="1782640">)</span>&nbsp;<span class="op" id="1782642">&lt;=</span>&nbsp;<span class="ident" id="1782645">MaxLatin1</span>&nbsp;<span class="op" id="1782655">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782659">return</span>&nbsp;<span class="ident" id="1782666">properties</span><span class="op" id="1782676">[</span><span class="builtintype" id="1782677">uint8</span><span class="op" id="1782682">(</span><span class="ident" id="1782683">r</span><span class="op" id="1782684">)</span><span class="op" id="1782685">]</span><span class="op" id="1782686">&amp;</span><span class="ident" id="1782687">pLmask</span>&nbsp;<span class="op" id="1782694">==</span>&nbsp;<span class="ident" id="1782697">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782705">return</span>&nbsp;<span class="ident" id="1782712">isExcludingLatin</span><span class="op" id="1782728">(</span><span class="ident" id="1782729">Lower</span><span class="op" id="1782734">,</span>&nbsp;<span class="ident" id="1782736">r</span><span class="op" id="1782737">)</span><br>
<span class="lineno"></span><span class="op" id="1782739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1782742">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1782802">func</span>&nbsp;<span class="ident" id="1782807">IsTitle</span><span class="op" id="1782814">(</span><span class="ident" id="1782815">r</span>&nbsp;<span class="builtintype" id="1782817">rune</span><span class="op" id="1782821">)</span>&nbsp;<span class="builtintype" id="1782823">bool</span>&nbsp;<span class="op" id="1782828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782831">if</span>&nbsp;<span class="ident" id="1782834">r</span>&nbsp;<span class="op" id="1782836">&lt;=</span>&nbsp;<span class="ident" id="1782839">MaxLatin1</span>&nbsp;<span class="op" id="1782849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782853">return</span>&nbsp;<span class="builtintype" id="1782860">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1782867">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1782870">return</span>&nbsp;<span class="ident" id="1782877">isExcludingLatin</span><span class="op" id="1782893">(</span><span class="ident" id="1782894">Title</span><span class="op" id="1782899">,</span>&nbsp;<span class="ident" id="1782901">r</span><span class="op" id="1782902">)</span><br>
<span class="lineno"></span><span class="op" id="1782904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1782907">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1782961">func</span>&nbsp;<span class="ident" id="1782966">to</span><span class="op" id="1782968">(</span><span class="ident" id="1782969">_case</span>&nbsp;<span class="builtintype" id="1782975">int</span><span class="op" id="1782978">,</span>&nbsp;<span class="ident" id="1782980">r</span>&nbsp;<span class="builtintype" id="1782982">rune</span><span class="op" id="1782986">,</span>&nbsp;<span class="ident" id="1782988">caseRange</span>&nbsp;<span class="op" id="1782998">[</span><span class="op" id="1782999">]</span><span class="ident" id="1783000">CaseRange</span><span class="op" id="1783009">)</span>&nbsp;<span class="builtintype" id="1783011">rune</span>&nbsp;<span class="op" id="1783016">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783019">if</span>&nbsp;<span class="ident" id="1783022">_case</span>&nbsp;<span class="op" id="1783028">&lt;</span>&nbsp;<span class="num" id="1783030">0</span>&nbsp;<span class="op" id="1783032">||</span>&nbsp;<span class="ident" id="1783035">MaxCase</span>&nbsp;<span class="op" id="1783043">&lt;=</span>&nbsp;<span class="ident" id="1783046">_case</span>&nbsp;<span class="op" id="1783052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783056">return</span>&nbsp;<span class="ident" id="1783063">ReplacementChar</span>&nbsp;<span class="comment" id="1783079">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1783113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783116">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783146">lo</span>&nbsp;<span class="op" id="1783149">:=</span>&nbsp;<span class="num" id="1783152">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783155">hi</span>&nbsp;<span class="op" id="1783158">:=</span>&nbsp;<span class="builtinfunc" id="1783161">len</span><span class="op" id="1783164">(</span><span class="ident" id="1783165">caseRange</span><span class="op" id="1783174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783177">for</span>&nbsp;<span class="ident" id="1783181">lo</span>&nbsp;<span class="op" id="1783184">&lt;</span>&nbsp;<span class="ident" id="1783186">hi</span>&nbsp;<span class="op" id="1783189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783193">m</span>&nbsp;<span class="op" id="1783195">:=</span>&nbsp;<span class="ident" id="1783198">lo</span>&nbsp;<span class="op" id="1783201">+</span>&nbsp;<span class="op" id="1783203">(</span><span class="ident" id="1783204">hi</span><span class="op" id="1783206">-</span><span class="ident" id="1783207">lo</span><span class="op" id="1783209">)</span><span class="op" id="1783210">/</span><span class="num" id="1783211">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783215">cr</span>&nbsp;<span class="op" id="1783218">:=</span>&nbsp;<span class="ident" id="1783221">caseRange</span><span class="op" id="1783230">[</span><span class="ident" id="1783231">m</span><span class="op" id="1783232">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783236">if</span>&nbsp;<span class="builtintype" id="1783239">rune</span><span class="op" id="1783243">(</span><span class="ident" id="1783244">cr</span><span class="op" id="1783246">.</span><span class="ident" id="1783247">Lo</span><span class="op" id="1783249">)</span>&nbsp;<span class="op" id="1783251">&lt;=</span>&nbsp;<span class="ident" id="1783254">r</span>&nbsp;<span class="op" id="1783256">&amp;&amp;</span>&nbsp;<span class="ident" id="1783259">r</span>&nbsp;<span class="op" id="1783261">&lt;=</span>&nbsp;<span class="builtintype" id="1783264">rune</span><span class="op" id="1783268">(</span><span class="ident" id="1783269">cr</span><span class="op" id="1783271">.</span><span class="ident" id="1783272">Hi</span><span class="op" id="1783274">)</span>&nbsp;<span class="op" id="1783276">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1783281">delta</span>&nbsp;<span class="op" id="1783287">:=</span>&nbsp;<span class="builtintype" id="1783290">rune</span><span class="op" id="1783294">(</span><span class="ident" id="1783295">cr</span><span class="op" id="1783297">.</span><span class="ident" id="1783298">Delta</span><span class="op" id="1783303">[</span><span class="ident" id="1783304">_case</span><span class="op" id="1783309">]</span><span class="op" id="1783310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783315">if</span>&nbsp;<span class="ident" id="1783318">delta</span>&nbsp;<span class="op" id="1783324">&gt;</span>&nbsp;<span class="ident" id="1783326">MaxRune</span>&nbsp;<span class="op" id="1783334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783340">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783400">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783462">//&nbsp;&nbsp;&nbsp;&nbsp{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783508">//&nbsp;&nbsp;&nbsp;&nbsp{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783566">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783630">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783697">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783767">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783802">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1783872">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783921">return</span>&nbsp;<span class="builtintype" id="1783928">rune</span><span class="op" id="1783932">(</span><span class="ident" id="1783933">cr</span><span class="op" id="1783935">.</span><span class="ident" id="1783936">Lo</span><span class="op" id="1783938">)</span>&nbsp;<span class="op" id="1783940">+</span>&nbsp;<span class="op" id="1783942">(</span><span class="op" id="1783943">(</span><span class="ident" id="1783944">r</span><span class="op" id="1783945">-</span><span class="builtintype" id="1783946">rune</span><span class="op" id="1783950">(</span><span class="ident" id="1783951">cr</span><span class="op" id="1783953">.</span><span class="ident" id="1783954">Lo</span><span class="op" id="1783956">)</span><span class="op" id="1783957">)</span><span class="op" id="1783958">&amp;^</span><span class="num" id="1783960">1</span>&nbsp;<span class="op" id="1783962">|</span>&nbsp;<span class="builtintype" id="1783964">rune</span><span class="op" id="1783968">(</span><span class="ident" id="1783969">_case</span><span class="op" id="1783974">&amp;</span><span class="num" id="1783975">1</span><span class="op" id="1783976">)</span><span class="op" id="1783977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1783982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1783987">return</span>&nbsp;<span class="ident" id="1783994">r</span>&nbsp;<span class="op" id="1783996">+</span>&nbsp;<span class="ident" id="1783998">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784010">if</span>&nbsp;<span class="ident" id="1784013">r</span>&nbsp;<span class="op" id="1784015">&lt;</span>&nbsp;<span class="builtintype" id="1784017">rune</span><span class="op" id="1784021">(</span><span class="ident" id="1784022">cr</span><span class="op" id="1784024">.</span><span class="ident" id="1784025">Lo</span><span class="op" id="1784027">)</span>&nbsp;<span class="op" id="1784029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784034">hi</span>&nbsp;<span class="op" id="1784037">=</span>&nbsp;<span class="ident" id="1784039">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784043">}</span>&nbsp;<span class="keyword" id="1784045">else</span>&nbsp;<span class="op" id="1784050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784055">lo</span>&nbsp;<span class="op" id="1784058">=</span>&nbsp;<span class="ident" id="1784060">m</span>&nbsp;<span class="op" id="1784062">+</span>&nbsp;<span class="num" id="1784064">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784074">return</span>&nbsp;<span class="ident" id="1784081">r</span><br>
<span class="lineno"></span><span class="op" id="1784083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1784086">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1784165">func</span>&nbsp;<span class="ident" id="1784170">To</span><span class="op" id="1784172">(</span><span class="ident" id="1784173">_case</span>&nbsp;<span class="builtintype" id="1784179">int</span><span class="op" id="1784182">,</span>&nbsp;<span class="ident" id="1784184">r</span>&nbsp;<span class="builtintype" id="1784186">rune</span><span class="op" id="1784190">)</span>&nbsp;<span class="builtintype" id="1784192">rune</span>&nbsp;<span class="op" id="1784197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784200">return</span>&nbsp;<span class="ident" id="1784207">to</span><span class="op" id="1784209">(</span><span class="ident" id="1784210">_case</span><span class="op" id="1784215">,</span>&nbsp;<span class="ident" id="1784217">r</span><span class="op" id="1784218">,</span>&nbsp;<span class="ident" id="1784220">CaseRanges</span><span class="op" id="1784230">)</span><br>
<span class="lineno"></span><span class="op" id="1784232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1784235">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1784275">func</span>&nbsp;<span class="ident" id="1784280">ToUpper</span><span class="op" id="1784287">(</span><span class="ident" id="1784288">r</span>&nbsp;<span class="builtintype" id="1784290">rune</span><span class="op" id="1784294">)</span>&nbsp;<span class="builtintype" id="1784296">rune</span>&nbsp;<span class="op" id="1784301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784304">if</span>&nbsp;<span class="ident" id="1784307">r</span>&nbsp;<span class="op" id="1784309">&lt;=</span>&nbsp;<span class="ident" id="1784312">MaxASCII</span>&nbsp;<span class="op" id="1784321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784325">if</span>&nbsp;<span class="string" id="1784328">&#39;a&#39;</span>&nbsp;<span class="op" id="1784332">&lt;=</span>&nbsp;<span class="ident" id="1784335">r</span>&nbsp;<span class="op" id="1784337">&amp;&amp;</span>&nbsp;<span class="ident" id="1784340">r</span>&nbsp;<span class="op" id="1784342">&lt;=</span>&nbsp;<span class="string" id="1784345">&#39;z&#39;</span>&nbsp;<span class="op" id="1784349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784354">r</span>&nbsp;<span class="op" id="1784356">-=</span>&nbsp;<span class="string" id="1784359">&#39;a&#39;</span>&nbsp;<span class="op" id="1784363">-</span>&nbsp;<span class="string" id="1784365">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784375">return</span>&nbsp;<span class="ident" id="1784382">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784388">return</span>&nbsp;<span class="ident" id="1784395">To</span><span class="op" id="1784397">(</span><span class="ident" id="1784398">UpperCase</span><span class="op" id="1784407">,</span>&nbsp;<span class="ident" id="1784409">r</span><span class="op" id="1784410">)</span><br>
<span class="lineno"></span><span class="op" id="1784412">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1784415">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1784455">func</span>&nbsp;<span class="ident" id="1784460">ToLower</span><span class="op" id="1784467">(</span><span class="ident" id="1784468">r</span>&nbsp;<span class="builtintype" id="1784470">rune</span><span class="op" id="1784474">)</span>&nbsp;<span class="builtintype" id="1784476">rune</span>&nbsp;<span class="op" id="1784481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784484">if</span>&nbsp;<span class="ident" id="1784487">r</span>&nbsp;<span class="op" id="1784489">&lt;=</span>&nbsp;<span class="ident" id="1784492">MaxASCII</span>&nbsp;<span class="op" id="1784501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784505">if</span>&nbsp;<span class="string" id="1784508">&#39;A&#39;</span>&nbsp;<span class="op" id="1784512">&lt;=</span>&nbsp;<span class="ident" id="1784515">r</span>&nbsp;<span class="op" id="1784517">&amp;&amp;</span>&nbsp;<span class="ident" id="1784520">r</span>&nbsp;<span class="op" id="1784522">&lt;=</span>&nbsp;<span class="string" id="1784525">&#39;Z&#39;</span>&nbsp;<span class="op" id="1784529">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784534">r</span>&nbsp;<span class="op" id="1784536">+=</span>&nbsp;<span class="string" id="1784539">&#39;a&#39;</span>&nbsp;<span class="op" id="1784543">-</span>&nbsp;<span class="string" id="1784545">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784555">return</span>&nbsp;<span class="ident" id="1784562">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784568">return</span>&nbsp;<span class="ident" id="1784575">To</span><span class="op" id="1784577">(</span><span class="ident" id="1784578">LowerCase</span><span class="op" id="1784587">,</span>&nbsp;<span class="ident" id="1784589">r</span><span class="op" id="1784590">)</span><br>
<span class="lineno">270</span><span class="op" id="1784592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1784595">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1784635">func</span>&nbsp;<span class="ident" id="1784640">ToTitle</span><span class="op" id="1784647">(</span><span class="ident" id="1784648">r</span>&nbsp;<span class="builtintype" id="1784650">rune</span><span class="op" id="1784654">)</span>&nbsp;<span class="builtintype" id="1784656">rune</span>&nbsp;<span class="op" id="1784661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784664">if</span>&nbsp;<span class="ident" id="1784667">r</span>&nbsp;<span class="op" id="1784669">&lt;=</span>&nbsp;<span class="ident" id="1784672">MaxASCII</span>&nbsp;<span class="op" id="1784681">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784685">if</span>&nbsp;<span class="string" id="1784688">&#39;a&#39;</span>&nbsp;<span class="op" id="1784692">&lt;=</span>&nbsp;<span class="ident" id="1784695">r</span>&nbsp;<span class="op" id="1784697">&amp;&amp;</span>&nbsp;<span class="ident" id="1784700">r</span>&nbsp;<span class="op" id="1784702">&lt;=</span>&nbsp;<span class="string" id="1784705">&#39;z&#39;</span>&nbsp;<span class="op" id="1784709">{</span>&nbsp;<span class="comment" id="1784711">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784752">r</span>&nbsp;<span class="op" id="1784754">-=</span>&nbsp;<span class="string" id="1784757">&#39;a&#39;</span>&nbsp;<span class="op" id="1784761">-</span>&nbsp;<span class="string" id="1784763">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784773">return</span>&nbsp;<span class="ident" id="1784780">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1784783">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784786">return</span>&nbsp;<span class="ident" id="1784793">To</span><span class="op" id="1784795">(</span><span class="ident" id="1784796">TitleCase</span><span class="op" id="1784805">,</span>&nbsp;<span class="ident" id="1784807">r</span><span class="op" id="1784808">)</span><br>
<span class="lineno"></span><span class="op" id="1784810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1784813">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1784892">func</span>&nbsp;<span class="op" id="1784897">(</span><span class="ident" id="1784898">special</span>&nbsp;<span class="ident" id="1784906">SpecialCase</span><span class="op" id="1784917">)</span>&nbsp;<span class="ident" id="1784919">ToUpper</span><span class="op" id="1784926">(</span><span class="ident" id="1784927">r</span>&nbsp;<span class="builtintype" id="1784929">rune</span><span class="op" id="1784933">)</span>&nbsp;<span class="builtintype" id="1784935">rune</span>&nbsp;<span class="op" id="1784940">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1784943">r1</span>&nbsp;<span class="op" id="1784946">:=</span>&nbsp;<span class="ident" id="1784949">to</span><span class="op" id="1784951">(</span><span class="ident" id="1784952">UpperCase</span><span class="op" id="1784961">,</span>&nbsp;<span class="ident" id="1784963">r</span><span class="op" id="1784964">,</span>&nbsp;<span class="op" id="1784966">[</span><span class="op" id="1784967">]</span><span class="ident" id="1784968">CaseRange</span><span class="op" id="1784977">(</span><span class="ident" id="1784978">special</span><span class="op" id="1784985">)</span><span class="op" id="1784986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1784989">if</span>&nbsp;<span class="ident" id="1784992">r1</span>&nbsp;<span class="op" id="1784995">==</span>&nbsp;<span class="ident" id="1784998">r</span>&nbsp;<span class="op" id="1785000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785004">r1</span>&nbsp;<span class="op" id="1785007">=</span>&nbsp;<span class="ident" id="1785009">ToUpper</span><span class="op" id="1785016">(</span><span class="ident" id="1785017">r</span><span class="op" id="1785018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785024">return</span>&nbsp;<span class="ident" id="1785031">r1</span><br>
<span class="lineno">290</span><span class="op" id="1785034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1785037">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1785116">func</span>&nbsp;<span class="op" id="1785121">(</span><span class="ident" id="1785122">special</span>&nbsp;<span class="ident" id="1785130">SpecialCase</span><span class="op" id="1785141">)</span>&nbsp;<span class="ident" id="1785143">ToTitle</span><span class="op" id="1785150">(</span><span class="ident" id="1785151">r</span>&nbsp;<span class="builtintype" id="1785153">rune</span><span class="op" id="1785157">)</span>&nbsp;<span class="builtintype" id="1785159">rune</span>&nbsp;<span class="op" id="1785164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785167">r1</span>&nbsp;<span class="op" id="1785170">:=</span>&nbsp;<span class="ident" id="1785173">to</span><span class="op" id="1785175">(</span><span class="ident" id="1785176">TitleCase</span><span class="op" id="1785185">,</span>&nbsp;<span class="ident" id="1785187">r</span><span class="op" id="1785188">,</span>&nbsp;<span class="op" id="1785190">[</span><span class="op" id="1785191">]</span><span class="ident" id="1785192">CaseRange</span><span class="op" id="1785201">(</span><span class="ident" id="1785202">special</span><span class="op" id="1785209">)</span><span class="op" id="1785210">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785213">if</span>&nbsp;<span class="ident" id="1785216">r1</span>&nbsp;<span class="op" id="1785219">==</span>&nbsp;<span class="ident" id="1785222">r</span>&nbsp;<span class="op" id="1785224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785228">r1</span>&nbsp;<span class="op" id="1785231">=</span>&nbsp;<span class="ident" id="1785233">ToTitle</span><span class="op" id="1785240">(</span><span class="ident" id="1785241">r</span><span class="op" id="1785242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785248">return</span>&nbsp;<span class="ident" id="1785255">r1</span><br>
<span class="lineno"></span><span class="op" id="1785258">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1785261">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1785340">func</span>&nbsp;<span class="op" id="1785345">(</span><span class="ident" id="1785346">special</span>&nbsp;<span class="ident" id="1785354">SpecialCase</span><span class="op" id="1785365">)</span>&nbsp;<span class="ident" id="1785367">ToLower</span><span class="op" id="1785374">(</span><span class="ident" id="1785375">r</span>&nbsp;<span class="builtintype" id="1785377">rune</span><span class="op" id="1785381">)</span>&nbsp;<span class="builtintype" id="1785383">rune</span>&nbsp;<span class="op" id="1785388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785391">r1</span>&nbsp;<span class="op" id="1785394">:=</span>&nbsp;<span class="ident" id="1785397">to</span><span class="op" id="1785399">(</span><span class="ident" id="1785400">LowerCase</span><span class="op" id="1785409">,</span>&nbsp;<span class="ident" id="1785411">r</span><span class="op" id="1785412">,</span>&nbsp;<span class="op" id="1785414">[</span><span class="op" id="1785415">]</span><span class="ident" id="1785416">CaseRange</span><span class="op" id="1785425">(</span><span class="ident" id="1785426">special</span><span class="op" id="1785433">)</span><span class="op" id="1785434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785437">if</span>&nbsp;<span class="ident" id="1785440">r1</span>&nbsp;<span class="op" id="1785443">==</span>&nbsp;<span class="ident" id="1785446">r</span>&nbsp;<span class="op" id="1785448">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785452">r1</span>&nbsp;<span class="op" id="1785455">=</span>&nbsp;<span class="ident" id="1785457">ToLower</span><span class="op" id="1785464">(</span><span class="ident" id="1785465">r</span><span class="op" id="1785466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1785469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1785472">return</span>&nbsp;<span class="ident" id="1785479">r1</span><br>
<span class="lineno"></span><span class="op" id="1785482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1785485">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1785556">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1785627">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1785704">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1785748">type</span>&nbsp;<span class="ident" id="1785753">foldPair</span>&nbsp;<span class="keyword" id="1785762">struct</span>&nbsp;<span class="op" id="1785769">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785772">From</span>&nbsp;<span class="builtintype" id="1785777">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1785785">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1785790">uint16</span><br>
<span class="lineno"></span><span class="op" id="1785797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1785800">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1785865">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1785932">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1786002">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1786070">//</span><br>
<span class="lineno"></span><span class="comment" id="1786073">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1786089">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1786114">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1786139">//</span><br>
<span class="lineno"></span><span class="comment" id="1786142">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1786167">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;K)</span><br>
<span class="lineno">330</span><span class="comment" id="1786218">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1786248">//</span><br>
<span class="lineno"></span><span class="comment" id="1786251">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1786276">//</span><br>
<span class="lineno"></span><span class="keyword" id="1786279">func</span>&nbsp;<span class="ident" id="1786284">SimpleFold</span><span class="op" id="1786294">(</span><span class="ident" id="1786295">r</span>&nbsp;<span class="builtintype" id="1786297">rune</span><span class="op" id="1786301">)</span>&nbsp;<span class="builtintype" id="1786303">rune</span>&nbsp;<span class="op" id="1786308">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786311">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786358">lo</span>&nbsp;<span class="op" id="1786361">:=</span>&nbsp;<span class="num" id="1786364">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786367">hi</span>&nbsp;<span class="op" id="1786370">:=</span>&nbsp;<span class="builtinfunc" id="1786373">len</span><span class="op" id="1786376">(</span><span class="ident" id="1786377">caseOrbit</span><span class="op" id="1786386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786389">for</span>&nbsp;<span class="ident" id="1786393">lo</span>&nbsp;<span class="op" id="1786396">&lt;</span>&nbsp;<span class="ident" id="1786398">hi</span>&nbsp;<span class="op" id="1786401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786405">m</span>&nbsp;<span class="op" id="1786407">:=</span>&nbsp;<span class="ident" id="1786410">lo</span>&nbsp;<span class="op" id="1786413">+</span>&nbsp;<span class="op" id="1786415">(</span><span class="ident" id="1786416">hi</span><span class="op" id="1786418">-</span><span class="ident" id="1786419">lo</span><span class="op" id="1786421">)</span><span class="op" id="1786422">/</span><span class="num" id="1786423">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786427">if</span>&nbsp;<span class="builtintype" id="1786430">rune</span><span class="op" id="1786434">(</span><span class="ident" id="1786435">caseOrbit</span><span class="op" id="1786444">[</span><span class="ident" id="1786445">m</span><span class="op" id="1786446">]</span><span class="op" id="1786447">.</span><span class="ident" id="1786448">From</span><span class="op" id="1786452">)</span>&nbsp;<span class="op" id="1786454">&lt;</span>&nbsp;<span class="ident" id="1786456">r</span>&nbsp;<span class="op" id="1786458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786463">lo</span>&nbsp;<span class="op" id="1786466">=</span>&nbsp;<span class="ident" id="1786468">m</span>&nbsp;<span class="op" id="1786470">+</span>&nbsp;<span class="num" id="1786472">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786476">}</span>&nbsp;<span class="keyword" id="1786478">else</span>&nbsp;<span class="op" id="1786483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1786488">hi</span>&nbsp;<span class="op" id="1786491">=</span>&nbsp;<span class="ident" id="1786493">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786497">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786503">if</span>&nbsp;<span class="ident" id="1786506">lo</span>&nbsp;<span class="op" id="1786509">&lt;</span>&nbsp;<span class="builtinfunc" id="1786511">len</span><span class="op" id="1786514">(</span><span class="ident" id="1786515">caseOrbit</span><span class="op" id="1786524">)</span>&nbsp;<span class="op" id="1786526">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1786529">rune</span><span class="op" id="1786533">(</span><span class="ident" id="1786534">caseOrbit</span><span class="op" id="1786543">[</span><span class="ident" id="1786544">lo</span><span class="op" id="1786546">]</span><span class="op" id="1786547">.</span><span class="ident" id="1786548">From</span><span class="op" id="1786552">)</span>&nbsp;<span class="op" id="1786554">==</span>&nbsp;<span class="ident" id="1786557">r</span>&nbsp;<span class="op" id="1786559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786563">return</span>&nbsp;<span class="builtintype" id="1786570">rune</span><span class="op" id="1786574">(</span><span class="ident" id="1786575">caseOrbit</span><span class="op" id="1786584">[</span><span class="ident" id="1786585">lo</span><span class="op" id="1786587">]</span><span class="op" id="1786588">.</span><span class="ident" id="1786589">To</span><span class="op" id="1786591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786598">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786655">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1786711">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786766">if</span>&nbsp;<span class="ident" id="1786769">l</span>&nbsp;<span class="op" id="1786771">:=</span>&nbsp;<span class="ident" id="1786774">ToLower</span><span class="op" id="1786781">(</span><span class="ident" id="1786782">r</span><span class="op" id="1786783">)</span><span class="op" id="1786784">;</span>&nbsp;<span class="ident" id="1786786">l</span>&nbsp;<span class="op" id="1786788">!=</span>&nbsp;<span class="ident" id="1786791">r</span>&nbsp;<span class="op" id="1786793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786797">return</span>&nbsp;<span class="ident" id="1786804">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1786807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1786810">return</span>&nbsp;<span class="ident" id="1786817">ToUpper</span><span class="op" id="1786824">(</span><span class="ident" id="1786825">r</span><span class="op" id="1786826">)</span><br>
<span class="lineno"></span><span class="op" id="1786828">}</span>
</div>
</body>
</html>
