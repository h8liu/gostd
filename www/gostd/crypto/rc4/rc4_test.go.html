<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6648734">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6648789">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6648843">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6648894">package</span>&nbsp;<span class="ident" id="6648902">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648907">import</span>&nbsp;<span class="op" id="6648914">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6648917">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6648926">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6648933">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6648943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648946">type</span>&nbsp;<span class="ident" id="6648951">rc4Test</span>&nbsp;<span class="keyword" id="6648959">struct</span>&nbsp;<span class="op" id="6648966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648969">key</span><span class="op" id="6648972">,</span>&nbsp;<span class="ident" id="6648974">keystream</span>&nbsp;<span class="op" id="6648984">[</span><span class="op" id="6648985">]</span><span class="builtintype" id="6648986">byte</span><br>
<span class="lineno">15</span><span class="op" id="6648991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6648994">var</span>&nbsp;<span class="ident" id="6648998">golden</span>&nbsp;<span class="op" id="6649005">=</span>&nbsp;<span class="op" id="6649007">[</span><span class="op" id="6649008">]</span><span class="ident" id="6649009">rc4Test</span><span class="op" id="6649016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6649019">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6649082">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649160">[</span><span class="op" id="6649161">]</span><span class="builtintype" id="6649162">byte</span><span class="op" id="6649166">{</span><span class="num" id="6649167">0x01</span><span class="op" id="6649171">,</span>&nbsp;<span class="num" id="6649173">0x23</span><span class="op" id="6649177">,</span>&nbsp;<span class="num" id="6649179">0x45</span><span class="op" id="6649183">,</span>&nbsp;<span class="num" id="6649185">0x67</span><span class="op" id="6649189">,</span>&nbsp;<span class="num" id="6649191">0x89</span><span class="op" id="6649195">,</span>&nbsp;<span class="num" id="6649197">0xab</span><span class="op" id="6649201">,</span>&nbsp;<span class="num" id="6649203">0xcd</span><span class="op" id="6649207">,</span>&nbsp;<span class="num" id="6649209">0xef</span><span class="op" id="6649213">}</span><span class="op" id="6649214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649218">[</span><span class="op" id="6649219">]</span><span class="builtintype" id="6649220">byte</span><span class="op" id="6649224">{</span><span class="num" id="6649225">0x74</span><span class="op" id="6649229">,</span>&nbsp;<span class="num" id="6649231">0x94</span><span class="op" id="6649235">,</span>&nbsp;<span class="num" id="6649237">0xc2</span><span class="op" id="6649241">,</span>&nbsp;<span class="num" id="6649243">0xe7</span><span class="op" id="6649247">,</span>&nbsp;<span class="num" id="6649249">0x10</span><span class="op" id="6649253">,</span>&nbsp;<span class="num" id="6649255">0x4b</span><span class="op" id="6649259">,</span>&nbsp;<span class="num" id="6649261">0x08</span><span class="op" id="6649265">,</span>&nbsp;<span class="num" id="6649267">0x79</span><span class="op" id="6649271">}</span><span class="op" id="6649272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649275">}</span><span class="op" id="6649276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649279">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649283">[</span><span class="op" id="6649284">]</span><span class="builtintype" id="6649285">byte</span><span class="op" id="6649289">{</span><span class="num" id="6649290">0x00</span><span class="op" id="6649294">,</span>&nbsp;<span class="num" id="6649296">0x00</span><span class="op" id="6649300">,</span>&nbsp;<span class="num" id="6649302">0x00</span><span class="op" id="6649306">,</span>&nbsp;<span class="num" id="6649308">0x00</span><span class="op" id="6649312">,</span>&nbsp;<span class="num" id="6649314">0x00</span><span class="op" id="6649318">,</span>&nbsp;<span class="num" id="6649320">0x00</span><span class="op" id="6649324">,</span>&nbsp;<span class="num" id="6649326">0x00</span><span class="op" id="6649330">,</span>&nbsp;<span class="num" id="6649332">0x00</span><span class="op" id="6649336">}</span><span class="op" id="6649337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649341">[</span><span class="op" id="6649342">]</span><span class="builtintype" id="6649343">byte</span><span class="op" id="6649347">{</span><span class="num" id="6649348">0xde</span><span class="op" id="6649352">,</span>&nbsp;<span class="num" id="6649354">0x18</span><span class="op" id="6649358">,</span>&nbsp;<span class="num" id="6649360">0x89</span><span class="op" id="6649364">,</span>&nbsp;<span class="num" id="6649366">0x41</span><span class="op" id="6649370">,</span>&nbsp;<span class="num" id="6649372">0xa3</span><span class="op" id="6649376">,</span>&nbsp;<span class="num" id="6649378">0x37</span><span class="op" id="6649382">,</span>&nbsp;<span class="num" id="6649384">0x5d</span><span class="op" id="6649388">,</span>&nbsp;<span class="num" id="6649390">0x3a</span><span class="op" id="6649394">}</span><span class="op" id="6649395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649398">}</span><span class="op" id="6649399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649406">[</span><span class="op" id="6649407">]</span><span class="builtintype" id="6649408">byte</span><span class="op" id="6649412">{</span><span class="num" id="6649413">0xef</span><span class="op" id="6649417">,</span>&nbsp;<span class="num" id="6649419">0x01</span><span class="op" id="6649423">,</span>&nbsp;<span class="num" id="6649425">0x23</span><span class="op" id="6649429">,</span>&nbsp;<span class="num" id="6649431">0x45</span><span class="op" id="6649435">}</span><span class="op" id="6649436">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649440">[</span><span class="op" id="6649441">]</span><span class="builtintype" id="6649442">byte</span><span class="op" id="6649446">{</span><span class="num" id="6649447">0xd6</span><span class="op" id="6649451">,</span>&nbsp;<span class="num" id="6649453">0xa1</span><span class="op" id="6649457">,</span>&nbsp;<span class="num" id="6649459">0x41</span><span class="op" id="6649463">,</span>&nbsp;<span class="num" id="6649465">0xa7</span><span class="op" id="6649469">,</span>&nbsp;<span class="num" id="6649471">0xec</span><span class="op" id="6649475">,</span>&nbsp;<span class="num" id="6649477">0x3c</span><span class="op" id="6649481">,</span>&nbsp;<span class="num" id="6649483">0x38</span><span class="op" id="6649487">,</span>&nbsp;<span class="num" id="6649489">0xdf</span><span class="op" id="6649493">,</span>&nbsp;<span class="num" id="6649495">0xbd</span><span class="op" id="6649499">,</span>&nbsp;<span class="num" id="6649501">0x61</span><span class="op" id="6649505">}</span><span class="op" id="6649506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649509">}</span><span class="op" id="6649510">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6649514">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649589">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649593">[</span><span class="op" id="6649594">]</span><span class="builtintype" id="6649595">byte</span><span class="op" id="6649599">{</span><span class="num" id="6649600">0x4b</span><span class="op" id="6649604">,</span>&nbsp;<span class="num" id="6649606">0x65</span><span class="op" id="6649610">,</span>&nbsp;<span class="num" id="6649612">0x79</span><span class="op" id="6649616">}</span><span class="op" id="6649617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649621">[</span><span class="op" id="6649622">]</span><span class="builtintype" id="6649623">byte</span><span class="op" id="6649627">{</span><span class="num" id="6649628">0xeb</span><span class="op" id="6649632">,</span>&nbsp;<span class="num" id="6649634">0x9f</span><span class="op" id="6649638">,</span>&nbsp;<span class="num" id="6649640">0x77</span><span class="op" id="6649644">,</span>&nbsp;<span class="num" id="6649646">0x81</span><span class="op" id="6649650">,</span>&nbsp;<span class="num" id="6649652">0xb7</span><span class="op" id="6649656">,</span>&nbsp;<span class="num" id="6649658">0x34</span><span class="op" id="6649662">,</span>&nbsp;<span class="num" id="6649664">0xca</span><span class="op" id="6649668">,</span>&nbsp;<span class="num" id="6649670">0x72</span><span class="op" id="6649674">,</span>&nbsp;<span class="num" id="6649676">0xa7</span><span class="op" id="6649680">,</span>&nbsp;<span class="num" id="6649682">0x19</span><span class="op" id="6649686">}</span><span class="op" id="6649687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649690">}</span><span class="op" id="6649691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649698">[</span><span class="op" id="6649699">]</span><span class="builtintype" id="6649700">byte</span><span class="op" id="6649704">{</span><span class="num" id="6649705">0x57</span><span class="op" id="6649709">,</span>&nbsp;<span class="num" id="6649711">0x69</span><span class="op" id="6649715">,</span>&nbsp;<span class="num" id="6649717">0x6b</span><span class="op" id="6649721">,</span>&nbsp;<span class="num" id="6649723">0x69</span><span class="op" id="6649727">}</span><span class="op" id="6649728">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649732">[</span><span class="op" id="6649733">]</span><span class="builtintype" id="6649734">byte</span><span class="op" id="6649738">{</span><span class="num" id="6649739">0x60</span><span class="op" id="6649743">,</span>&nbsp;<span class="num" id="6649745">0x44</span><span class="op" id="6649749">,</span>&nbsp;<span class="num" id="6649751">0xdb</span><span class="op" id="6649755">,</span>&nbsp;<span class="num" id="6649757">0x6d</span><span class="op" id="6649761">,</span>&nbsp;<span class="num" id="6649763">0x41</span><span class="op" id="6649767">,</span>&nbsp;<span class="num" id="6649769">0xb7</span><span class="op" id="6649773">}</span><span class="op" id="6649774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649777">}</span><span class="op" id="6649778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649785">[</span><span class="op" id="6649786">]</span><span class="builtintype" id="6649787">byte</span><span class="op" id="6649791">{</span><span class="num" id="6649792">0x00</span><span class="op" id="6649796">,</span>&nbsp;<span class="num" id="6649798">0x00</span><span class="op" id="6649802">,</span>&nbsp;<span class="num" id="6649804">0x00</span><span class="op" id="6649808">,</span>&nbsp;<span class="num" id="6649810">0x00</span><span class="op" id="6649814">,</span>&nbsp;<span class="num" id="6649816">0x00</span><span class="op" id="6649820">,</span>&nbsp;<span class="num" id="6649822">0x00</span><span class="op" id="6649826">,</span>&nbsp;<span class="num" id="6649828">0x00</span><span class="op" id="6649832">,</span>&nbsp;<span class="num" id="6649834">0x00</span><span class="op" id="6649838">}</span><span class="op" id="6649839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6649843">[</span><span class="op" id="6649844">]</span><span class="builtintype" id="6649845">byte</span><span class="op" id="6649849">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6649854">0xde</span><span class="op" id="6649858">,</span>&nbsp;<span class="num" id="6649860">0x18</span><span class="op" id="6649864">,</span>&nbsp;<span class="num" id="6649866">0x89</span><span class="op" id="6649870">,</span>&nbsp;<span class="num" id="6649872">0x41</span><span class="op" id="6649876">,</span>&nbsp;<span class="num" id="6649878">0xa3</span><span class="op" id="6649882">,</span>&nbsp;<span class="num" id="6649884">0x37</span><span class="op" id="6649888">,</span>&nbsp;<span class="num" id="6649890">0x5d</span><span class="op" id="6649894">,</span>&nbsp;<span class="num" id="6649896">0x3a</span><span class="op" id="6649900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6649905">0x8a</span><span class="op" id="6649909">,</span>&nbsp;<span class="num" id="6649911">0x06</span><span class="op" id="6649915">,</span>&nbsp;<span class="num" id="6649917">0x1e</span><span class="op" id="6649921">,</span>&nbsp;<span class="num" id="6649923">0x67</span><span class="op" id="6649927">,</span>&nbsp;<span class="num" id="6649929">0x57</span><span class="op" id="6649933">,</span>&nbsp;<span class="num" id="6649935">0x6e</span><span class="op" id="6649939">,</span>&nbsp;<span class="num" id="6649941">0x92</span><span class="op" id="6649945">,</span>&nbsp;<span class="num" id="6649947">0x6d</span><span class="op" id="6649951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6649956">0xc7</span><span class="op" id="6649960">,</span>&nbsp;<span class="num" id="6649962">0x1a</span><span class="op" id="6649966">,</span>&nbsp;<span class="num" id="6649968">0x7f</span><span class="op" id="6649972">,</span>&nbsp;<span class="num" id="6649974">0xa3</span><span class="op" id="6649978">,</span>&nbsp;<span class="num" id="6649980">0xf0</span><span class="op" id="6649984">,</span>&nbsp;<span class="num" id="6649986">0xcc</span><span class="op" id="6649990">,</span>&nbsp;<span class="num" id="6649992">0xeb</span><span class="op" id="6649996">,</span>&nbsp;<span class="num" id="6649998">0x97</span><span class="op" id="6650002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650007">0x45</span><span class="op" id="6650011">,</span>&nbsp;<span class="num" id="6650013">0x2b</span><span class="op" id="6650017">,</span>&nbsp;<span class="num" id="6650019">0x4d</span><span class="op" id="6650023">,</span>&nbsp;<span class="num" id="6650025">0x32</span><span class="op" id="6650029">,</span>&nbsp;<span class="num" id="6650031">0x27</span><span class="op" id="6650035">,</span>&nbsp;<span class="num" id="6650037">0x96</span><span class="op" id="6650041">,</span>&nbsp;<span class="num" id="6650043">0x5f</span><span class="op" id="6650047">,</span>&nbsp;<span class="num" id="6650049">0x9e</span><span class="op" id="6650053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650058">0xa8</span><span class="op" id="6650062">,</span>&nbsp;<span class="num" id="6650064">0xcc</span><span class="op" id="6650068">,</span>&nbsp;<span class="num" id="6650070">0x75</span><span class="op" id="6650074">,</span>&nbsp;<span class="num" id="6650076">0x07</span><span class="op" id="6650080">,</span>&nbsp;<span class="num" id="6650082">0x6d</span><span class="op" id="6650086">,</span>&nbsp;<span class="num" id="6650088">0x9f</span><span class="op" id="6650092">,</span>&nbsp;<span class="num" id="6650094">0xb9</span><span class="op" id="6650098">,</span>&nbsp;<span class="num" id="6650100">0xc5</span><span class="op" id="6650104">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650109">0x41</span><span class="op" id="6650113">,</span>&nbsp;<span class="num" id="6650115">0x7a</span><span class="op" id="6650119">,</span>&nbsp;<span class="num" id="6650121">0xa5</span><span class="op" id="6650125">,</span>&nbsp;<span class="num" id="6650127">0xcb</span><span class="op" id="6650131">,</span>&nbsp;<span class="num" id="6650133">0x30</span><span class="op" id="6650137">,</span>&nbsp;<span class="num" id="6650139">0xfc</span><span class="op" id="6650143">,</span>&nbsp;<span class="num" id="6650145">0x22</span><span class="op" id="6650149">,</span>&nbsp;<span class="num" id="6650151">0x19</span><span class="op" id="6650155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650160">0x8b</span><span class="op" id="6650164">,</span>&nbsp;<span class="num" id="6650166">0x34</span><span class="op" id="6650170">,</span>&nbsp;<span class="num" id="6650172">0x98</span><span class="op" id="6650176">,</span>&nbsp;<span class="num" id="6650178">0x2d</span><span class="op" id="6650182">,</span>&nbsp;<span class="num" id="6650184">0xbb</span><span class="op" id="6650188">,</span>&nbsp;<span class="num" id="6650190">0x62</span><span class="op" id="6650194">,</span>&nbsp;<span class="num" id="6650196">0x9e</span><span class="op" id="6650200">,</span>&nbsp;<span class="num" id="6650202">0xc0</span><span class="op" id="6650206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650211">0x4b</span><span class="op" id="6650215">,</span>&nbsp;<span class="num" id="6650217">0x4f</span><span class="op" id="6650221">,</span>&nbsp;<span class="num" id="6650223">0x8b</span><span class="op" id="6650227">,</span>&nbsp;<span class="num" id="6650229">0x05</span><span class="op" id="6650233">,</span>&nbsp;<span class="num" id="6650235">0xa0</span><span class="op" id="6650239">,</span>&nbsp;<span class="num" id="6650241">0x71</span><span class="op" id="6650245">,</span>&nbsp;<span class="num" id="6650247">0x08</span><span class="op" id="6650251">,</span>&nbsp;<span class="num" id="6650253">0x50</span><span class="op" id="6650257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650262">0x92</span><span class="op" id="6650266">,</span>&nbsp;<span class="num" id="6650268">0xa0</span><span class="op" id="6650272">,</span>&nbsp;<span class="num" id="6650274">0xc3</span><span class="op" id="6650278">,</span>&nbsp;<span class="num" id="6650280">0x58</span><span class="op" id="6650284">,</span>&nbsp;<span class="num" id="6650286">0x4a</span><span class="op" id="6650290">,</span>&nbsp;<span class="num" id="6650292">0x48</span><span class="op" id="6650296">,</span>&nbsp;<span class="num" id="6650298">0xe4</span><span class="op" id="6650302">,</span>&nbsp;<span class="num" id="6650304">0xa3</span><span class="op" id="6650308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650313">0x0a</span><span class="op" id="6650317">,</span>&nbsp;<span class="num" id="6650319">0x39</span><span class="op" id="6650323">,</span>&nbsp;<span class="num" id="6650325">0x7b</span><span class="op" id="6650329">,</span>&nbsp;<span class="num" id="6650331">0x8a</span><span class="op" id="6650335">,</span>&nbsp;<span class="num" id="6650337">0xcd</span><span class="op" id="6650341">,</span>&nbsp;<span class="num" id="6650343">0x1d</span><span class="op" id="6650347">,</span>&nbsp;<span class="num" id="6650349">0x00</span><span class="op" id="6650353">,</span>&nbsp;<span class="num" id="6650355">0x9e</span><span class="op" id="6650359">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650364">0xc8</span><span class="op" id="6650368">,</span>&nbsp;<span class="num" id="6650370">0x7d</span><span class="op" id="6650374">,</span>&nbsp;<span class="num" id="6650376">0x68</span><span class="op" id="6650380">,</span>&nbsp;<span class="num" id="6650382">0x11</span><span class="op" id="6650386">,</span>&nbsp;<span class="num" id="6650388">0xf2</span><span class="op" id="6650392">,</span>&nbsp;<span class="num" id="6650394">0x2c</span><span class="op" id="6650398">,</span>&nbsp;<span class="num" id="6650400">0xf4</span><span class="op" id="6650404">,</span>&nbsp;<span class="num" id="6650406">0x9c</span><span class="op" id="6650410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650415">0xa3</span><span class="op" id="6650419">,</span>&nbsp;<span class="num" id="6650421">0xe5</span><span class="op" id="6650425">,</span>&nbsp;<span class="num" id="6650427">0x93</span><span class="op" id="6650431">,</span>&nbsp;<span class="num" id="6650433">0x54</span><span class="op" id="6650437">,</span>&nbsp;<span class="num" id="6650439">0xb9</span><span class="op" id="6650443">,</span>&nbsp;<span class="num" id="6650445">0x45</span><span class="op" id="6650449">,</span>&nbsp;<span class="num" id="6650451">0x15</span><span class="op" id="6650455">,</span>&nbsp;<span class="num" id="6650457">0x35</span><span class="op" id="6650461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650466">0xa2</span><span class="op" id="6650470">,</span>&nbsp;<span class="num" id="6650472">0x18</span><span class="op" id="6650476">,</span>&nbsp;<span class="num" id="6650478">0x7a</span><span class="op" id="6650482">,</span>&nbsp;<span class="num" id="6650484">0x86</span><span class="op" id="6650488">,</span>&nbsp;<span class="num" id="6650490">0x42</span><span class="op" id="6650494">,</span>&nbsp;<span class="num" id="6650496">0x6c</span><span class="op" id="6650500">,</span>&nbsp;<span class="num" id="6650502">0xca</span><span class="op" id="6650506">,</span>&nbsp;<span class="num" id="6650508">0x7d</span><span class="op" id="6650512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650517">0x5e</span><span class="op" id="6650521">,</span>&nbsp;<span class="num" id="6650523">0x82</span><span class="op" id="6650527">,</span>&nbsp;<span class="num" id="6650529">0x3e</span><span class="op" id="6650533">,</span>&nbsp;<span class="num" id="6650535">0xba</span><span class="op" id="6650539">,</span>&nbsp;<span class="num" id="6650541">0x00</span><span class="op" id="6650545">,</span>&nbsp;<span class="num" id="6650547">0x44</span><span class="op" id="6650551">,</span>&nbsp;<span class="num" id="6650553">0x12</span><span class="op" id="6650557">,</span>&nbsp;<span class="num" id="6650559">0x67</span><span class="op" id="6650563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650568">0x12</span><span class="op" id="6650572">,</span>&nbsp;<span class="num" id="6650574">0x57</span><span class="op" id="6650578">,</span>&nbsp;<span class="num" id="6650580">0xb8</span><span class="op" id="6650584">,</span>&nbsp;<span class="num" id="6650586">0xd8</span><span class="op" id="6650590">,</span>&nbsp;<span class="num" id="6650592">0x60</span><span class="op" id="6650596">,</span>&nbsp;<span class="num" id="6650598">0xae</span><span class="op" id="6650602">,</span>&nbsp;<span class="num" id="6650604">0x4c</span><span class="op" id="6650608">,</span>&nbsp;<span class="num" id="6650610">0xbd</span><span class="op" id="6650614">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650619">0x4c</span><span class="op" id="6650623">,</span>&nbsp;<span class="num" id="6650625">0x49</span><span class="op" id="6650629">,</span>&nbsp;<span class="num" id="6650631">0x06</span><span class="op" id="6650635">,</span>&nbsp;<span class="num" id="6650637">0xbb</span><span class="op" id="6650641">,</span>&nbsp;<span class="num" id="6650643">0xc5</span><span class="op" id="6650647">,</span>&nbsp;<span class="num" id="6650649">0x35</span><span class="op" id="6650653">,</span>&nbsp;<span class="num" id="6650655">0xef</span><span class="op" id="6650659">,</span>&nbsp;<span class="num" id="6650661">0xe1</span><span class="op" id="6650665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650670">0x58</span><span class="op" id="6650674">,</span>&nbsp;<span class="num" id="6650676">0x7f</span><span class="op" id="6650680">,</span>&nbsp;<span class="num" id="6650682">0x08</span><span class="op" id="6650686">,</span>&nbsp;<span class="num" id="6650688">0xdb</span><span class="op" id="6650692">,</span>&nbsp;<span class="num" id="6650694">0x33</span><span class="op" id="6650698">,</span>&nbsp;<span class="num" id="6650700">0x95</span><span class="op" id="6650704">,</span>&nbsp;<span class="num" id="6650706">0x5c</span><span class="op" id="6650710">,</span>&nbsp;<span class="num" id="6650712">0xdb</span><span class="op" id="6650716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650721">0xcb</span><span class="op" id="6650725">,</span>&nbsp;<span class="num" id="6650727">0xad</span><span class="op" id="6650731">,</span>&nbsp;<span class="num" id="6650733">0x9b</span><span class="op" id="6650737">,</span>&nbsp;<span class="num" id="6650739">0x10</span><span class="op" id="6650743">,</span>&nbsp;<span class="num" id="6650745">0xf5</span><span class="op" id="6650749">,</span>&nbsp;<span class="num" id="6650751">0x3f</span><span class="op" id="6650755">,</span>&nbsp;<span class="num" id="6650757">0xc4</span><span class="op" id="6650761">,</span>&nbsp;<span class="num" id="6650763">0xe5</span><span class="op" id="6650767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650772">0x2c</span><span class="op" id="6650776">,</span>&nbsp;<span class="num" id="6650778">0x59</span><span class="op" id="6650782">,</span>&nbsp;<span class="num" id="6650784">0x15</span><span class="op" id="6650788">,</span>&nbsp;<span class="num" id="6650790">0x65</span><span class="op" id="6650794">,</span>&nbsp;<span class="num" id="6650796">0x51</span><span class="op" id="6650800">,</span>&nbsp;<span class="num" id="6650802">0x84</span><span class="op" id="6650806">,</span>&nbsp;<span class="num" id="6650808">0x87</span><span class="op" id="6650812">,</span>&nbsp;<span class="num" id="6650814">0xfe</span><span class="op" id="6650818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650823">0x08</span><span class="op" id="6650827">,</span>&nbsp;<span class="num" id="6650829">0x4d</span><span class="op" id="6650833">,</span>&nbsp;<span class="num" id="6650835">0x0e</span><span class="op" id="6650839">,</span>&nbsp;<span class="num" id="6650841">0x3f</span><span class="op" id="6650845">,</span>&nbsp;<span class="num" id="6650847">0x03</span><span class="op" id="6650851">,</span>&nbsp;<span class="num" id="6650853">0xde</span><span class="op" id="6650857">,</span>&nbsp;<span class="num" id="6650859">0xbc</span><span class="op" id="6650863">,</span>&nbsp;<span class="num" id="6650865">0xc9</span><span class="op" id="6650869">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650874">0xda</span><span class="op" id="6650878">,</span>&nbsp;<span class="num" id="6650880">0x1c</span><span class="op" id="6650884">,</span>&nbsp;<span class="num" id="6650886">0xe9</span><span class="op" id="6650890">,</span>&nbsp;<span class="num" id="6650892">0x0d</span><span class="op" id="6650896">,</span>&nbsp;<span class="num" id="6650898">0x08</span><span class="op" id="6650902">,</span>&nbsp;<span class="num" id="6650904">0x5c</span><span class="op" id="6650908">,</span>&nbsp;<span class="num" id="6650910">0x2d</span><span class="op" id="6650914">,</span>&nbsp;<span class="num" id="6650916">0x8a</span><span class="op" id="6650920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650925">0x19</span><span class="op" id="6650929">,</span>&nbsp;<span class="num" id="6650931">0xd8</span><span class="op" id="6650935">,</span>&nbsp;<span class="num" id="6650937">0x37</span><span class="op" id="6650941">,</span>&nbsp;<span class="num" id="6650943">0x30</span><span class="op" id="6650947">,</span>&nbsp;<span class="num" id="6650949">0x86</span><span class="op" id="6650953">,</span>&nbsp;<span class="num" id="6650955">0x16</span><span class="op" id="6650959">,</span>&nbsp;<span class="num" id="6650961">0x36</span><span class="op" id="6650965">,</span>&nbsp;<span class="num" id="6650967">0x92</span><span class="op" id="6650971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6650976">0x14</span><span class="op" id="6650980">,</span>&nbsp;<span class="num" id="6650982">0x2b</span><span class="op" id="6650986">,</span>&nbsp;<span class="num" id="6650988">0xd8</span><span class="op" id="6650992">,</span>&nbsp;<span class="num" id="6650994">0xfc</span><span class="op" id="6650998">,</span>&nbsp;<span class="num" id="6651000">0x5d</span><span class="op" id="6651004">,</span>&nbsp;<span class="num" id="6651006">0x7a</span><span class="op" id="6651010">,</span>&nbsp;<span class="num" id="6651012">0x73</span><span class="op" id="6651016">,</span>&nbsp;<span class="num" id="6651018">0x49</span><span class="op" id="6651022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6651027">0x6a</span><span class="op" id="6651031">,</span>&nbsp;<span class="num" id="6651033">0x8e</span><span class="op" id="6651037">,</span>&nbsp;<span class="num" id="6651039">0x59</span><span class="op" id="6651043">,</span>&nbsp;<span class="num" id="6651045">0xee</span><span class="op" id="6651049">,</span>&nbsp;<span class="num" id="6651051">0x7e</span><span class="op" id="6651055">,</span>&nbsp;<span class="num" id="6651057">0xcf</span><span class="op" id="6651061">,</span>&nbsp;<span class="num" id="6651063">0x6b</span><span class="op" id="6651067">,</span>&nbsp;<span class="num" id="6651069">0x94</span><span class="op" id="6651073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6651078">0x06</span><span class="op" id="6651082">,</span>&nbsp;<span class="num" id="6651084">0x63</span><span class="op" id="6651088">,</span>&nbsp;<span class="num" id="6651090">0xf4</span><span class="op" id="6651094">,</span>&nbsp;<span class="num" id="6651096">0xa6</span><span class="op" id="6651100">,</span>&nbsp;<span class="num" id="6651102">0xbe</span><span class="op" id="6651106">,</span>&nbsp;<span class="num" id="6651108">0xe6</span><span class="op" id="6651112">,</span>&nbsp;<span class="num" id="6651114">0x5b</span><span class="op" id="6651118">,</span>&nbsp;<span class="num" id="6651120">0xd2</span><span class="op" id="6651124">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6651129">0xc8</span><span class="op" id="6651133">,</span>&nbsp;<span class="num" id="6651135">0x5c</span><span class="op" id="6651139">,</span>&nbsp;<span class="num" id="6651141">0x46</span><span class="op" id="6651145">,</span>&nbsp;<span class="num" id="6651147">0x98</span><span class="op" id="6651151">,</span>&nbsp;<span class="num" id="6651153">0x6c</span><span class="op" id="6651157">,</span>&nbsp;<span class="num" id="6651159">0x1b</span><span class="op" id="6651163">,</span>&nbsp;<span class="num" id="6651165">0xef</span><span class="op" id="6651169">,</span>&nbsp;<span class="num" id="6651171">0x34</span><span class="op" id="6651175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6651180">0x90</span><span class="op" id="6651184">,</span>&nbsp;<span class="num" id="6651186">0xd3</span><span class="op" id="6651190">,</span>&nbsp;<span class="num" id="6651192">0x7b</span><span class="op" id="6651196">,</span>&nbsp;<span class="num" id="6651198">0x38</span><span class="op" id="6651202">,</span>&nbsp;<span class="num" id="6651204">0xda</span><span class="op" id="6651208">,</span>&nbsp;<span class="num" id="6651210">0x85</span><span class="op" id="6651214">,</span>&nbsp;<span class="num" id="6651216">0xd3</span><span class="op" id="6651220">,</span>&nbsp;<span class="num" id="6651222">0x2e</span><span class="op" id="6651226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6651231">0x97</span><span class="op" id="6651235">,</span>&nbsp;<span class="num" id="6651237">0x39</span><span class="op" id="6651241">,</span>&nbsp;<span class="num" id="6651243">0xcb</span><span class="op" id="6651247">,</span>&nbsp;<span class="num" id="6651249">0x23</span><span class="op" id="6651253">,</span>&nbsp;<span class="num" id="6651255">0x4a</span><span class="op" id="6651259">,</span>&nbsp;<span class="num" id="6651261">0x2b</span><span class="op" id="6651265">,</span>&nbsp;<span class="num" id="6651267">0xe7</span><span class="op" id="6651271">,</span>&nbsp;<span class="num" id="6651273">0x40</span><span class="op" id="6651277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651281">}</span><span class="op" id="6651282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651285">}</span><span class="op" id="6651286">,</span><br>
<span class="lineno">75</span><span class="op" id="6651288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6651291">func</span>&nbsp;<span class="ident" id="6651296">testEncrypt</span><span class="op" id="6651307">(</span><span class="ident" id="6651308">t</span>&nbsp;<span class="op" id="6651310">*</span><span class="ident" id="6651311">testing</span><span class="op" id="6651318">.</span><span class="ident" id="6651319">T</span><span class="op" id="6651320">,</span>&nbsp;<span class="ident" id="6651322">desc</span>&nbsp;<span class="builtintype" id="6651327">string</span><span class="op" id="6651333">,</span>&nbsp;<span class="ident" id="6651335">c</span>&nbsp;<span class="op" id="6651337">*</span><span class="ident" id="6651338">Cipher</span><span class="op" id="6651344">,</span>&nbsp;<span class="ident" id="6651346">src</span><span class="op" id="6651349">,</span>&nbsp;<span class="ident" id="6651351">expect</span>&nbsp;<span class="op" id="6651358">[</span><span class="op" id="6651359">]</span><span class="builtintype" id="6651360">byte</span><span class="op" id="6651364">)</span>&nbsp;<span class="op" id="6651366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651369">dst</span>&nbsp;<span class="op" id="6651373">:=</span>&nbsp;<span class="builtinfunc" id="6651376">make</span><span class="op" id="6651380">(</span><span class="op" id="6651381">[</span><span class="op" id="6651382">]</span><span class="builtintype" id="6651383">byte</span><span class="op" id="6651387">,</span>&nbsp;<span class="builtinfunc" id="6651389">len</span><span class="op" id="6651392">(</span><span class="ident" id="6651393">src</span><span class="op" id="6651396">)</span><span class="op" id="6651397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651400">c</span><span class="op" id="6651401">.</span><span class="ident" id="6651402">XORKeyStream</span><span class="op" id="6651414">(</span><span class="ident" id="6651415">dst</span><span class="op" id="6651418">,</span>&nbsp;<span class="ident" id="6651420">src</span><span class="op" id="6651423">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651426">for</span>&nbsp;<span class="ident" id="6651430">i</span><span class="op" id="6651431">,</span>&nbsp;<span class="ident" id="6651433">v</span>&nbsp;<span class="op" id="6651435">:=</span>&nbsp;<span class="keyword" id="6651438">range</span>&nbsp;<span class="ident" id="6651444">dst</span>&nbsp;<span class="op" id="6651448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651452">if</span>&nbsp;<span class="ident" id="6651455">v</span>&nbsp;<span class="op" id="6651457">!=</span>&nbsp;<span class="ident" id="6651460">expect</span><span class="op" id="6651466">[</span><span class="ident" id="6651467">i</span><span class="op" id="6651468">]</span>&nbsp;<span class="op" id="6651470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651475">t</span><span class="op" id="6651476">.</span><span class="ident" id="6651477">Fatalf</span><span class="op" id="6651483">(</span><span class="string" id="6651484">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="6651528">,</span>&nbsp;<span class="ident" id="6651530">desc</span><span class="op" id="6651534">,</span>&nbsp;<span class="ident" id="6651536">i</span><span class="op" id="6651537">,</span>&nbsp;<span class="ident" id="6651539">dst</span><span class="op" id="6651542">,</span>&nbsp;<span class="ident" id="6651544">expect</span><span class="op" id="6651550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651557">}</span><br>
<span class="lineno">85</span><span class="op" id="6651559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6651562">func</span>&nbsp;<span class="ident" id="6651567">TestGolden</span><span class="op" id="6651577">(</span><span class="ident" id="6651578">t</span>&nbsp;<span class="op" id="6651580">*</span><span class="ident" id="6651581">testing</span><span class="op" id="6651588">.</span><span class="ident" id="6651589">T</span><span class="op" id="6651590">)</span>&nbsp;<span class="op" id="6651592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651595">for</span>&nbsp;<span class="ident" id="6651599">gi</span><span class="op" id="6651601">,</span>&nbsp;<span class="ident" id="6651603">g</span>&nbsp;<span class="op" id="6651605">:=</span>&nbsp;<span class="keyword" id="6651608">range</span>&nbsp;<span class="ident" id="6651614">golden</span>&nbsp;<span class="op" id="6651621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651625">data</span>&nbsp;<span class="op" id="6651630">:=</span>&nbsp;<span class="builtinfunc" id="6651633">make</span><span class="op" id="6651637">(</span><span class="op" id="6651638">[</span><span class="op" id="6651639">]</span><span class="builtintype" id="6651640">byte</span><span class="op" id="6651644">,</span>&nbsp;<span class="builtinfunc" id="6651646">len</span><span class="op" id="6651649">(</span><span class="ident" id="6651650">g</span><span class="op" id="6651651">.</span><span class="ident" id="6651652">keystream</span><span class="op" id="6651661">)</span><span class="op" id="6651662">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651666">for</span>&nbsp;<span class="ident" id="6651670">i</span>&nbsp;<span class="op" id="6651672">:=</span>&nbsp;<span class="keyword" id="6651675">range</span>&nbsp;<span class="ident" id="6651681">data</span>&nbsp;<span class="op" id="6651686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651691">data</span><span class="op" id="6651695">[</span><span class="ident" id="6651696">i</span><span class="op" id="6651697">]</span>&nbsp;<span class="op" id="6651699">=</span>&nbsp;<span class="builtintype" id="6651701">byte</span><span class="op" id="6651705">(</span><span class="ident" id="6651706">i</span><span class="op" id="6651707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651716">expect</span>&nbsp;<span class="op" id="6651723">:=</span>&nbsp;<span class="builtinfunc" id="6651726">make</span><span class="op" id="6651730">(</span><span class="op" id="6651731">[</span><span class="op" id="6651732">]</span><span class="builtintype" id="6651733">byte</span><span class="op" id="6651737">,</span>&nbsp;<span class="builtinfunc" id="6651739">len</span><span class="op" id="6651742">(</span><span class="ident" id="6651743">g</span><span class="op" id="6651744">.</span><span class="ident" id="6651745">keystream</span><span class="op" id="6651754">)</span><span class="op" id="6651755">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651759">for</span>&nbsp;<span class="ident" id="6651763">i</span>&nbsp;<span class="op" id="6651765">:=</span>&nbsp;<span class="keyword" id="6651768">range</span>&nbsp;<span class="ident" id="6651774">expect</span>&nbsp;<span class="op" id="6651781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651786">expect</span><span class="op" id="6651792">[</span><span class="ident" id="6651793">i</span><span class="op" id="6651794">]</span>&nbsp;<span class="op" id="6651796">=</span>&nbsp;<span class="builtintype" id="6651798">byte</span><span class="op" id="6651802">(</span><span class="ident" id="6651803">i</span><span class="op" id="6651804">)</span>&nbsp;<span class="op" id="6651806">^</span>&nbsp;<span class="ident" id="6651808">g</span><span class="op" id="6651809">.</span><span class="ident" id="6651810">keystream</span><span class="op" id="6651819">[</span><span class="ident" id="6651820">i</span><span class="op" id="6651821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651830">for</span>&nbsp;<span class="ident" id="6651834">size</span>&nbsp;<span class="op" id="6651839">:=</span>&nbsp;<span class="num" id="6651842">1</span><span class="op" id="6651843">;</span>&nbsp;<span class="ident" id="6651845">size</span>&nbsp;<span class="op" id="6651850">&lt;=</span>&nbsp;<span class="builtinfunc" id="6651853">len</span><span class="op" id="6651856">(</span><span class="ident" id="6651857">g</span><span class="op" id="6651858">.</span><span class="ident" id="6651859">keystream</span><span class="op" id="6651868">)</span><span class="op" id="6651869">;</span>&nbsp;<span class="ident" id="6651871">size</span><span class="op" id="6651875">++</span>&nbsp;<span class="op" id="6651878">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651883">c</span><span class="op" id="6651884">,</span>&nbsp;<span class="ident" id="6651886">err</span>&nbsp;<span class="op" id="6651890">:=</span>&nbsp;<span class="ident" id="6651893">NewCipher</span><span class="op" id="6651902">(</span><span class="ident" id="6651903">g</span><span class="op" id="6651904">.</span><span class="ident" id="6651905">key</span><span class="op" id="6651908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651913">if</span>&nbsp;<span class="ident" id="6651916">err</span>&nbsp;<span class="op" id="6651920">!=</span>&nbsp;<span class="ident" id="6651923">nil</span>&nbsp;<span class="op" id="6651927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651933">t</span><span class="op" id="6651934">.</span><span class="ident" id="6651935">Fatalf</span><span class="op" id="6651941">(</span><span class="string" id="6651942">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="6651962">,</span>&nbsp;<span class="ident" id="6651964">gi</span><span class="op" id="6651966">,</span>&nbsp;<span class="ident" id="6651968">err</span><span class="op" id="6651971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651982">off</span>&nbsp;<span class="op" id="6651986">:=</span>&nbsp;<span class="num" id="6651989">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651994">for</span>&nbsp;<span class="ident" id="6651998">off</span>&nbsp;<span class="op" id="6652002">&lt;</span>&nbsp;<span class="builtinfunc" id="6652004">len</span><span class="op" id="6652007">(</span><span class="ident" id="6652008">g</span><span class="op" id="6652009">.</span><span class="ident" id="6652010">keystream</span><span class="op" id="6652019">)</span>&nbsp;<span class="op" id="6652021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652027">n</span>&nbsp;<span class="op" id="6652029">:=</span>&nbsp;<span class="builtinfunc" id="6652032">len</span><span class="op" id="6652035">(</span><span class="ident" id="6652036">g</span><span class="op" id="6652037">.</span><span class="ident" id="6652038">keystream</span><span class="op" id="6652047">)</span>&nbsp;<span class="op" id="6652049">-</span>&nbsp;<span class="ident" id="6652051">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652059">if</span>&nbsp;<span class="ident" id="6652062">n</span>&nbsp;<span class="op" id="6652064">&gt;</span>&nbsp;<span class="ident" id="6652066">size</span>&nbsp;<span class="op" id="6652071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652078">n</span>&nbsp;<span class="op" id="6652080">=</span>&nbsp;<span class="ident" id="6652082">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652097">desc</span>&nbsp;<span class="op" id="6652102">:=</span>&nbsp;<span class="ident" id="6652105">fmt</span><span class="op" id="6652108">.</span><span class="ident" id="6652109">Sprintf</span><span class="op" id="6652116">(</span><span class="string" id="6652117">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="6652130">,</span>&nbsp;<span class="ident" id="6652132">gi</span><span class="op" id="6652134">,</span>&nbsp;<span class="ident" id="6652136">off</span><span class="op" id="6652139">,</span>&nbsp;<span class="ident" id="6652141">off</span><span class="op" id="6652144">+</span><span class="ident" id="6652145">n</span><span class="op" id="6652146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652152">testEncrypt</span><span class="op" id="6652163">(</span><span class="ident" id="6652164">t</span><span class="op" id="6652165">,</span>&nbsp;<span class="ident" id="6652167">desc</span><span class="op" id="6652171">,</span>&nbsp;<span class="ident" id="6652173">c</span><span class="op" id="6652174">,</span>&nbsp;<span class="ident" id="6652176">data</span><span class="op" id="6652180">[</span><span class="ident" id="6652181">off</span><span class="op" id="6652184">:</span><span class="ident" id="6652185">off</span><span class="op" id="6652188">+</span><span class="ident" id="6652189">n</span><span class="op" id="6652190">]</span><span class="op" id="6652191">,</span>&nbsp;<span class="ident" id="6652193">expect</span><span class="op" id="6652199">[</span><span class="ident" id="6652200">off</span><span class="op" id="6652203">:</span><span class="ident" id="6652204">off</span><span class="op" id="6652207">+</span><span class="ident" id="6652208">n</span><span class="op" id="6652209">]</span><span class="op" id="6652210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652216">off</span>&nbsp;<span class="op" id="6652220">+=</span>&nbsp;<span class="ident" id="6652223">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652228">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652235">}</span><br>
<span class="lineno"></span><span class="op" id="6652237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6652240">func</span>&nbsp;<span class="ident" id="6652245">TestBlock</span><span class="op" id="6652254">(</span><span class="ident" id="6652255">t</span>&nbsp;<span class="op" id="6652257">*</span><span class="ident" id="6652258">testing</span><span class="op" id="6652265">.</span><span class="ident" id="6652266">T</span><span class="op" id="6652267">)</span>&nbsp;<span class="op" id="6652269">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652272">testBlock</span><span class="op" id="6652281">(</span><span class="ident" id="6652282">t</span><span class="op" id="6652283">,</span>&nbsp;<span class="op" id="6652285">(</span><span class="op" id="6652286">*</span><span class="ident" id="6652287">Cipher</span><span class="op" id="6652293">)</span><span class="op" id="6652294">.</span><span class="ident" id="6652295">XORKeyStream</span><span class="op" id="6652307">)</span><br>
<span class="lineno"></span><span class="op" id="6652309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6652312">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="6652341">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="6652408">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="6652452">func</span>&nbsp;<span class="ident" id="6652457">TestBlockGeneric</span><span class="op" id="6652473">(</span><span class="ident" id="6652474">t</span>&nbsp;<span class="op" id="6652476">*</span><span class="ident" id="6652477">testing</span><span class="op" id="6652484">.</span><span class="ident" id="6652485">T</span><span class="op" id="6652486">)</span>&nbsp;<span class="op" id="6652488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652491">testBlock</span><span class="op" id="6652500">(</span><span class="ident" id="6652501">t</span><span class="op" id="6652502">,</span>&nbsp;<span class="op" id="6652504">(</span><span class="op" id="6652505">*</span><span class="ident" id="6652506">Cipher</span><span class="op" id="6652512">)</span><span class="op" id="6652513">.</span><span class="ident" id="6652514">xorKeyStreamGeneric</span><span class="op" id="6652533">)</span><br>
<span class="lineno"></span><span class="op" id="6652535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="6652538">func</span>&nbsp;<span class="ident" id="6652543">testBlock</span><span class="op" id="6652552">(</span><span class="ident" id="6652553">t</span>&nbsp;<span class="op" id="6652555">*</span><span class="ident" id="6652556">testing</span><span class="op" id="6652563">.</span><span class="ident" id="6652564">T</span><span class="op" id="6652565">,</span>&nbsp;<span class="ident" id="6652567">xor</span>&nbsp;<span class="keyword" id="6652571">func</span><span class="op" id="6652575">(</span><span class="ident" id="6652576">c</span>&nbsp;<span class="op" id="6652578">*</span><span class="ident" id="6652579">Cipher</span><span class="op" id="6652585">,</span>&nbsp;<span class="ident" id="6652587">dst</span><span class="op" id="6652590">,</span>&nbsp;<span class="ident" id="6652592">src</span>&nbsp;<span class="op" id="6652596">[</span><span class="op" id="6652597">]</span><span class="builtintype" id="6652598">byte</span><span class="op" id="6652602">)</span><span class="op" id="6652603">)</span>&nbsp;<span class="op" id="6652605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652608">c1a</span><span class="op" id="6652611">,</span>&nbsp;<span class="ident" id="6652613">_</span>&nbsp;<span class="op" id="6652615">:=</span>&nbsp;<span class="ident" id="6652618">NewCipher</span><span class="op" id="6652627">(</span><span class="ident" id="6652628">golden</span><span class="op" id="6652634">[</span><span class="num" id="6652635">0</span><span class="op" id="6652636">]</span><span class="op" id="6652637">.</span><span class="ident" id="6652638">key</span><span class="op" id="6652641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652644">c1b</span><span class="op" id="6652647">,</span>&nbsp;<span class="ident" id="6652649">_</span>&nbsp;<span class="op" id="6652651">:=</span>&nbsp;<span class="ident" id="6652654">NewCipher</span><span class="op" id="6652663">(</span><span class="ident" id="6652664">golden</span><span class="op" id="6652670">[</span><span class="num" id="6652671">1</span><span class="op" id="6652672">]</span><span class="op" id="6652673">.</span><span class="ident" id="6652674">key</span><span class="op" id="6652677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652680">data1</span>&nbsp;<span class="op" id="6652686">:=</span>&nbsp;<span class="builtinfunc" id="6652689">make</span><span class="op" id="6652693">(</span><span class="op" id="6652694">[</span><span class="op" id="6652695">]</span><span class="builtintype" id="6652696">byte</span><span class="op" id="6652700">,</span>&nbsp;<span class="num" id="6652702">1</span><span class="op" id="6652703">&lt;&lt;</span><span class="num" id="6652705">20</span><span class="op" id="6652707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652710">for</span>&nbsp;<span class="ident" id="6652714">i</span>&nbsp;<span class="op" id="6652716">:=</span>&nbsp;<span class="keyword" id="6652719">range</span>&nbsp;<span class="ident" id="6652725">data1</span>&nbsp;<span class="op" id="6652731">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652735">xor</span><span class="op" id="6652738">(</span><span class="ident" id="6652739">c1a</span><span class="op" id="6652742">,</span>&nbsp;<span class="ident" id="6652744">data1</span><span class="op" id="6652749">[</span><span class="ident" id="6652750">i</span><span class="op" id="6652751">:</span><span class="ident" id="6652752">i</span><span class="op" id="6652753">+</span><span class="num" id="6652754">1</span><span class="op" id="6652755">]</span><span class="op" id="6652756">,</span>&nbsp;<span class="ident" id="6652758">data1</span><span class="op" id="6652763">[</span><span class="ident" id="6652764">i</span><span class="op" id="6652765">:</span><span class="ident" id="6652766">i</span><span class="op" id="6652767">+</span><span class="num" id="6652768">1</span><span class="op" id="6652769">]</span><span class="op" id="6652770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652774">xor</span><span class="op" id="6652777">(</span><span class="ident" id="6652778">c1b</span><span class="op" id="6652781">,</span>&nbsp;<span class="ident" id="6652783">data1</span><span class="op" id="6652788">[</span><span class="ident" id="6652789">i</span><span class="op" id="6652790">:</span><span class="ident" id="6652791">i</span><span class="op" id="6652792">+</span><span class="num" id="6652793">1</span><span class="op" id="6652794">]</span><span class="op" id="6652795">,</span>&nbsp;<span class="ident" id="6652797">data1</span><span class="op" id="6652802">[</span><span class="ident" id="6652803">i</span><span class="op" id="6652804">:</span><span class="ident" id="6652805">i</span><span class="op" id="6652806">+</span><span class="num" id="6652807">1</span><span class="op" id="6652808">]</span><span class="op" id="6652809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652816">c2a</span><span class="op" id="6652819">,</span>&nbsp;<span class="ident" id="6652821">_</span>&nbsp;<span class="op" id="6652823">:=</span>&nbsp;<span class="ident" id="6652826">NewCipher</span><span class="op" id="6652835">(</span><span class="ident" id="6652836">golden</span><span class="op" id="6652842">[</span><span class="num" id="6652843">0</span><span class="op" id="6652844">]</span><span class="op" id="6652845">.</span><span class="ident" id="6652846">key</span><span class="op" id="6652849">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652852">c2b</span><span class="op" id="6652855">,</span>&nbsp;<span class="ident" id="6652857">_</span>&nbsp;<span class="op" id="6652859">:=</span>&nbsp;<span class="ident" id="6652862">NewCipher</span><span class="op" id="6652871">(</span><span class="ident" id="6652872">golden</span><span class="op" id="6652878">[</span><span class="num" id="6652879">1</span><span class="op" id="6652880">]</span><span class="op" id="6652881">.</span><span class="ident" id="6652882">key</span><span class="op" id="6652885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652888">data2</span>&nbsp;<span class="op" id="6652894">:=</span>&nbsp;<span class="builtinfunc" id="6652897">make</span><span class="op" id="6652901">(</span><span class="op" id="6652902">[</span><span class="op" id="6652903">]</span><span class="builtintype" id="6652904">byte</span><span class="op" id="6652908">,</span>&nbsp;<span class="num" id="6652910">1</span><span class="op" id="6652911">&lt;&lt;</span><span class="num" id="6652913">20</span><span class="op" id="6652915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652918">xor</span><span class="op" id="6652921">(</span><span class="ident" id="6652922">c2a</span><span class="op" id="6652925">,</span>&nbsp;<span class="ident" id="6652927">data2</span><span class="op" id="6652932">,</span>&nbsp;<span class="ident" id="6652934">data2</span><span class="op" id="6652939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652942">xor</span><span class="op" id="6652945">(</span><span class="ident" id="6652946">c2b</span><span class="op" id="6652949">,</span>&nbsp;<span class="ident" id="6652951">data2</span><span class="op" id="6652956">,</span>&nbsp;<span class="ident" id="6652958">data2</span><span class="op" id="6652963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652967">if</span>&nbsp;<span class="op" id="6652970">!</span><span class="ident" id="6652971">bytes</span><span class="op" id="6652976">.</span><span class="ident" id="6652977">Equal</span><span class="op" id="6652982">(</span><span class="ident" id="6652983">data1</span><span class="op" id="6652988">,</span>&nbsp;<span class="ident" id="6652990">data2</span><span class="op" id="6652995">)</span>&nbsp;<span class="op" id="6652997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653001">t</span><span class="op" id="6653002">.</span><span class="ident" id="6653003">Fatalf</span><span class="op" id="6653009">(</span><span class="string" id="6653010">&#34;bad&nbsp;block&#34;</span><span class="op" id="6653021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653024">}</span><br>
<span class="lineno"></span><span class="op" id="6653026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6653029">func</span>&nbsp;<span class="ident" id="6653034">benchmark</span><span class="op" id="6653043">(</span><span class="ident" id="6653044">b</span>&nbsp;<span class="op" id="6653046">*</span><span class="ident" id="6653047">testing</span><span class="op" id="6653054">.</span><span class="ident" id="6653055">B</span><span class="op" id="6653056">,</span>&nbsp;<span class="ident" id="6653058">size</span>&nbsp;<span class="ident" id="6653063">int64</span><span class="op" id="6653068">)</span>&nbsp;<span class="op" id="6653070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653073">buf</span>&nbsp;<span class="op" id="6653077">:=</span>&nbsp;<span class="builtinfunc" id="6653080">make</span><span class="op" id="6653084">(</span><span class="op" id="6653085">[</span><span class="op" id="6653086">]</span><span class="builtintype" id="6653087">byte</span><span class="op" id="6653091">,</span>&nbsp;<span class="ident" id="6653093">size</span><span class="op" id="6653097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653100">c</span><span class="op" id="6653101">,</span>&nbsp;<span class="ident" id="6653103">err</span>&nbsp;<span class="op" id="6653107">:=</span>&nbsp;<span class="ident" id="6653110">NewCipher</span><span class="op" id="6653119">(</span><span class="ident" id="6653120">golden</span><span class="op" id="6653126">[</span><span class="num" id="6653127">0</span><span class="op" id="6653128">]</span><span class="op" id="6653129">.</span><span class="ident" id="6653130">key</span><span class="op" id="6653133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6653136">if</span>&nbsp;<span class="ident" id="6653139">err</span>&nbsp;<span class="op" id="6653143">!=</span>&nbsp;<span class="ident" id="6653146">nil</span>&nbsp;<span class="op" id="6653150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6653154">panic</span><span class="op" id="6653159">(</span><span class="ident" id="6653160">err</span><span class="op" id="6653163">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653169">b</span><span class="op" id="6653170">.</span><span class="ident" id="6653171">SetBytes</span><span class="op" id="6653179">(</span><span class="ident" id="6653180">size</span><span class="op" id="6653184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6653188">for</span>&nbsp;<span class="ident" id="6653192">i</span>&nbsp;<span class="op" id="6653194">:=</span>&nbsp;<span class="num" id="6653197">0</span><span class="op" id="6653198">;</span>&nbsp;<span class="ident" id="6653200">i</span>&nbsp;<span class="op" id="6653202">&lt;</span>&nbsp;<span class="ident" id="6653204">b</span><span class="op" id="6653205">.</span><span class="ident" id="6653206">N</span><span class="op" id="6653207">;</span>&nbsp;<span class="ident" id="6653209">i</span><span class="op" id="6653210">++</span>&nbsp;<span class="op" id="6653213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653217">c</span><span class="op" id="6653218">.</span><span class="ident" id="6653219">XORKeyStream</span><span class="op" id="6653231">(</span><span class="ident" id="6653232">buf</span><span class="op" id="6653235">,</span>&nbsp;<span class="ident" id="6653237">buf</span><span class="op" id="6653240">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653243">}</span><br>
<span class="lineno"></span><span class="op" id="6653245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6653248">func</span>&nbsp;<span class="ident" id="6653253">BenchmarkRC4_128</span><span class="op" id="6653269">(</span><span class="ident" id="6653270">b</span>&nbsp;<span class="op" id="6653272">*</span><span class="ident" id="6653273">testing</span><span class="op" id="6653280">.</span><span class="ident" id="6653281">B</span><span class="op" id="6653282">)</span>&nbsp;<span class="op" id="6653284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653287">benchmark</span><span class="op" id="6653296">(</span><span class="ident" id="6653297">b</span><span class="op" id="6653298">,</span>&nbsp;<span class="num" id="6653300">128</span><span class="op" id="6653303">)</span><br>
<span class="lineno">165</span><span class="op" id="6653305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6653308">func</span>&nbsp;<span class="ident" id="6653313">BenchmarkRC4_1K</span><span class="op" id="6653328">(</span><span class="ident" id="6653329">b</span>&nbsp;<span class="op" id="6653331">*</span><span class="ident" id="6653332">testing</span><span class="op" id="6653339">.</span><span class="ident" id="6653340">B</span><span class="op" id="6653341">)</span>&nbsp;<span class="op" id="6653343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653346">benchmark</span><span class="op" id="6653355">(</span><span class="ident" id="6653356">b</span><span class="op" id="6653357">,</span>&nbsp;<span class="num" id="6653359">1024</span><span class="op" id="6653363">)</span><br>
<span class="lineno"></span><span class="op" id="6653365">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6653368">func</span>&nbsp;<span class="ident" id="6653373">BenchmarkRC4_8K</span><span class="op" id="6653388">(</span><span class="ident" id="6653389">b</span>&nbsp;<span class="op" id="6653391">*</span><span class="ident" id="6653392">testing</span><span class="op" id="6653399">.</span><span class="ident" id="6653400">B</span><span class="op" id="6653401">)</span>&nbsp;<span class="op" id="6653403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653406">benchmark</span><span class="op" id="6653415">(</span><span class="ident" id="6653416">b</span><span class="op" id="6653417">,</span>&nbsp;<span class="num" id="6653419">8096</span><span class="op" id="6653423">)</span><br>
<span class="lineno"></span><span class="op" id="6653425">}</span>
</div>
</body>
</html>
