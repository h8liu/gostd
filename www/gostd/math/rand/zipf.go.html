<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3191216">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3191271">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3191325">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3191376">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3191404">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3191449">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3191490">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3191551">package</span>&nbsp;<span class="ident" id="3191559">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3191565">import</span>&nbsp;<span class="string" id="3191572">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3191580">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3191627">type</span>&nbsp;<span class="ident" id="3191632">Zipf</span>&nbsp;<span class="keyword" id="3191637">struct</span>&nbsp;<span class="op" id="3191644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191647">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191660">*</span><span class="ident" id="3191661">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191667">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191680">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191689">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191702">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191711">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191724">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191733">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191746">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191755">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191768">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191777">oneminusQinv</span>&nbsp;<span class="builtintype" id="3191790">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191799">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3191812">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3191821">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3191834">float64</span><br>
<span class="lineno">25</span><span class="op" id="3191842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3191845">func</span>&nbsp;<span class="op" id="3191850">(</span><span class="ident" id="3191851">z</span>&nbsp;<span class="op" id="3191853">*</span><span class="ident" id="3191854">Zipf</span><span class="op" id="3191858">)</span>&nbsp;<span class="ident" id="3191860">h</span><span class="op" id="3191861">(</span><span class="ident" id="3191862">x</span>&nbsp;<span class="builtintype" id="3191864">float64</span><span class="op" id="3191871">)</span>&nbsp;<span class="builtintype" id="3191873">float64</span>&nbsp;<span class="op" id="3191881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3191884">return</span>&nbsp;<span class="ident" id="3191891">math</span><span class="op" id="3191895">.</span><span class="ident" id="3191896">Exp</span><span class="op" id="3191899">(</span><span class="ident" id="3191900">z</span><span class="op" id="3191901">.</span><span class="ident" id="3191902">oneminusQ</span><span class="op" id="3191911">*</span><span class="ident" id="3191912">math</span><span class="op" id="3191916">.</span><span class="ident" id="3191917">Log</span><span class="op" id="3191920">(</span><span class="ident" id="3191921">z</span><span class="op" id="3191922">.</span><span class="ident" id="3191923">v</span><span class="op" id="3191924">+</span><span class="ident" id="3191925">x</span><span class="op" id="3191926">)</span><span class="op" id="3191927">)</span>&nbsp;<span class="op" id="3191929">*</span>&nbsp;<span class="ident" id="3191931">z</span><span class="op" id="3191932">.</span><span class="ident" id="3191933">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3191946">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3191949">func</span>&nbsp;<span class="op" id="3191954">(</span><span class="ident" id="3191955">z</span>&nbsp;<span class="op" id="3191957">*</span><span class="ident" id="3191958">Zipf</span><span class="op" id="3191962">)</span>&nbsp;<span class="ident" id="3191964">hinv</span><span class="op" id="3191968">(</span><span class="ident" id="3191969">x</span>&nbsp;<span class="builtintype" id="3191971">float64</span><span class="op" id="3191978">)</span>&nbsp;<span class="builtintype" id="3191980">float64</span>&nbsp;<span class="op" id="3191988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3191991">return</span>&nbsp;<span class="ident" id="3191998">math</span><span class="op" id="3192002">.</span><span class="ident" id="3192003">Exp</span><span class="op" id="3192006">(</span><span class="ident" id="3192007">z</span><span class="op" id="3192008">.</span><span class="ident" id="3192009">oneminusQinv</span><span class="op" id="3192021">*</span><span class="ident" id="3192022">math</span><span class="op" id="3192026">.</span><span class="ident" id="3192027">Log</span><span class="op" id="3192030">(</span><span class="ident" id="3192031">z</span><span class="op" id="3192032">.</span><span class="ident" id="3192033">oneminusQ</span><span class="op" id="3192042">*</span><span class="ident" id="3192043">x</span><span class="op" id="3192044">)</span><span class="op" id="3192045">)</span>&nbsp;<span class="op" id="3192047">-</span>&nbsp;<span class="ident" id="3192049">z</span><span class="op" id="3192050">.</span><span class="ident" id="3192051">v</span><br>
<span class="lineno"></span><span class="op" id="3192053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3192056">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3192120">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3192181">func</span>&nbsp;<span class="ident" id="3192186">NewZipf</span><span class="op" id="3192193">(</span><span class="ident" id="3192194">r</span>&nbsp;<span class="op" id="3192196">*</span><span class="ident" id="3192197">Rand</span><span class="op" id="3192201">,</span>&nbsp;<span class="ident" id="3192203">s</span>&nbsp;<span class="builtintype" id="3192205">float64</span><span class="op" id="3192212">,</span>&nbsp;<span class="ident" id="3192214">v</span>&nbsp;<span class="builtintype" id="3192216">float64</span><span class="op" id="3192223">,</span>&nbsp;<span class="ident" id="3192225">imax</span>&nbsp;<span class="ident" id="3192230">uint64</span><span class="op" id="3192236">)</span>&nbsp;<span class="op" id="3192238">*</span><span class="ident" id="3192239">Zipf</span>&nbsp;<span class="op" id="3192244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192247">z</span>&nbsp;<span class="op" id="3192249">:=</span>&nbsp;<span class="builtinfunc" id="3192252">new</span><span class="op" id="3192255">(</span><span class="ident" id="3192256">Zipf</span><span class="op" id="3192260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192263">if</span>&nbsp;<span class="ident" id="3192266">s</span>&nbsp;<span class="op" id="3192268">&lt;=</span>&nbsp;<span class="num" id="3192271">1.0</span>&nbsp;<span class="op" id="3192275">||</span>&nbsp;<span class="ident" id="3192278">v</span>&nbsp;<span class="op" id="3192280">&lt;</span>&nbsp;<span class="num" id="3192282">1</span>&nbsp;<span class="op" id="3192284">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192288">return</span>&nbsp;<span class="ident" id="3192295">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3192300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192303">z</span><span class="op" id="3192304">.</span><span class="ident" id="3192305">r</span>&nbsp;<span class="op" id="3192307">=</span>&nbsp;<span class="ident" id="3192309">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192312">z</span><span class="op" id="3192313">.</span><span class="ident" id="3192314">imax</span>&nbsp;<span class="op" id="3192319">=</span>&nbsp;<span class="builtintype" id="3192321">float64</span><span class="op" id="3192328">(</span><span class="ident" id="3192329">imax</span><span class="op" id="3192333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192336">z</span><span class="op" id="3192337">.</span><span class="ident" id="3192338">v</span>&nbsp;<span class="op" id="3192340">=</span>&nbsp;<span class="ident" id="3192342">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192345">z</span><span class="op" id="3192346">.</span><span class="ident" id="3192347">q</span>&nbsp;<span class="op" id="3192349">=</span>&nbsp;<span class="ident" id="3192351">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192354">z</span><span class="op" id="3192355">.</span><span class="ident" id="3192356">oneminusQ</span>&nbsp;<span class="op" id="3192366">=</span>&nbsp;<span class="num" id="3192368">1.0</span>&nbsp;<span class="op" id="3192372">-</span>&nbsp;<span class="ident" id="3192374">z</span><span class="op" id="3192375">.</span><span class="ident" id="3192376">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192379">z</span><span class="op" id="3192380">.</span><span class="ident" id="3192381">oneminusQinv</span>&nbsp;<span class="op" id="3192394">=</span>&nbsp;<span class="num" id="3192396">1.0</span>&nbsp;<span class="op" id="3192400">/</span>&nbsp;<span class="ident" id="3192402">z</span><span class="op" id="3192403">.</span><span class="ident" id="3192404">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192415">z</span><span class="op" id="3192416">.</span><span class="ident" id="3192417">hxm</span>&nbsp;<span class="op" id="3192421">=</span>&nbsp;<span class="ident" id="3192423">z</span><span class="op" id="3192424">.</span><span class="ident" id="3192425">h</span><span class="op" id="3192426">(</span><span class="ident" id="3192427">z</span><span class="op" id="3192428">.</span><span class="ident" id="3192429">imax</span>&nbsp;<span class="op" id="3192434">+</span>&nbsp;<span class="num" id="3192436">0.5</span><span class="op" id="3192439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192442">z</span><span class="op" id="3192443">.</span><span class="ident" id="3192444">hx0minusHxm</span>&nbsp;<span class="op" id="3192456">=</span>&nbsp;<span class="ident" id="3192458">z</span><span class="op" id="3192459">.</span><span class="ident" id="3192460">h</span><span class="op" id="3192461">(</span><span class="num" id="3192462">0.5</span><span class="op" id="3192465">)</span>&nbsp;<span class="op" id="3192467">-</span>&nbsp;<span class="ident" id="3192469">math</span><span class="op" id="3192473">.</span><span class="ident" id="3192474">Exp</span><span class="op" id="3192477">(</span><span class="ident" id="3192478">math</span><span class="op" id="3192482">.</span><span class="ident" id="3192483">Log</span><span class="op" id="3192486">(</span><span class="ident" id="3192487">z</span><span class="op" id="3192488">.</span><span class="ident" id="3192489">v</span><span class="op" id="3192490">)</span><span class="op" id="3192491">*</span><span class="op" id="3192492">(</span><span class="op" id="3192493">-</span><span class="ident" id="3192494">z</span><span class="op" id="3192495">.</span><span class="ident" id="3192496">q</span><span class="op" id="3192497">)</span><span class="op" id="3192498">)</span>&nbsp;<span class="op" id="3192500">-</span>&nbsp;<span class="ident" id="3192502">z</span><span class="op" id="3192503">.</span><span class="ident" id="3192504">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192509">z</span><span class="op" id="3192510">.</span><span class="ident" id="3192511">s</span>&nbsp;<span class="op" id="3192513">=</span>&nbsp;<span class="num" id="3192515">1</span>&nbsp;<span class="op" id="3192517">-</span>&nbsp;<span class="ident" id="3192519">z</span><span class="op" id="3192520">.</span><span class="ident" id="3192521">hinv</span><span class="op" id="3192525">(</span><span class="ident" id="3192526">z</span><span class="op" id="3192527">.</span><span class="ident" id="3192528">h</span><span class="op" id="3192529">(</span><span class="num" id="3192530">1.5</span><span class="op" id="3192533">)</span><span class="op" id="3192534">-</span><span class="ident" id="3192535">math</span><span class="op" id="3192539">.</span><span class="ident" id="3192540">Exp</span><span class="op" id="3192543">(</span><span class="op" id="3192544">-</span><span class="ident" id="3192545">z</span><span class="op" id="3192546">.</span><span class="ident" id="3192547">q</span><span class="op" id="3192548">*</span><span class="ident" id="3192549">math</span><span class="op" id="3192553">.</span><span class="ident" id="3192554">Log</span><span class="op" id="3192557">(</span><span class="ident" id="3192558">z</span><span class="op" id="3192559">.</span><span class="ident" id="3192560">v</span><span class="op" id="3192561">+</span><span class="num" id="3192562">1.0</span><span class="op" id="3192565">)</span><span class="op" id="3192566">)</span><span class="op" id="3192567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192570">return</span>&nbsp;<span class="ident" id="3192577">z</span><br>
<span class="lineno"></span><span class="op" id="3192579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3192582">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3192651">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3192674">func</span>&nbsp;<span class="op" id="3192679">(</span><span class="ident" id="3192680">z</span>&nbsp;<span class="op" id="3192682">*</span><span class="ident" id="3192683">Zipf</span><span class="op" id="3192687">)</span>&nbsp;<span class="ident" id="3192689">Uint64</span><span class="op" id="3192695">(</span><span class="op" id="3192696">)</span>&nbsp;<span class="ident" id="3192698">uint64</span>&nbsp;<span class="op" id="3192705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192708">if</span>&nbsp;<span class="ident" id="3192711">z</span>&nbsp;<span class="op" id="3192713">==</span>&nbsp;<span class="ident" id="3192716">nil</span>&nbsp;<span class="op" id="3192720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3192724">panic</span><span class="op" id="3192729">(</span><span class="string" id="3192730">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3192746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3192749">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192752">k</span>&nbsp;<span class="op" id="3192754">:=</span>&nbsp;<span class="num" id="3192757">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192763">for</span>&nbsp;<span class="op" id="3192767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192771">r</span>&nbsp;<span class="op" id="3192773">:=</span>&nbsp;<span class="ident" id="3192776">z</span><span class="op" id="3192777">.</span><span class="ident" id="3192778">r</span><span class="op" id="3192779">.</span><span class="ident" id="3192780">Float64</span><span class="op" id="3192787">(</span><span class="op" id="3192788">)</span>&nbsp;<span class="comment" id="3192790">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192806">ur</span>&nbsp;<span class="op" id="3192809">:=</span>&nbsp;<span class="ident" id="3192812">z</span><span class="op" id="3192813">.</span><span class="ident" id="3192814">hxm</span>&nbsp;<span class="op" id="3192818">+</span>&nbsp;<span class="ident" id="3192820">r</span><span class="op" id="3192821">*</span><span class="ident" id="3192822">z</span><span class="op" id="3192823">.</span><span class="ident" id="3192824">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192838">x</span>&nbsp;<span class="op" id="3192840">:=</span>&nbsp;<span class="ident" id="3192843">z</span><span class="op" id="3192844">.</span><span class="ident" id="3192845">hinv</span><span class="op" id="3192849">(</span><span class="ident" id="3192850">ur</span><span class="op" id="3192852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3192856">k</span>&nbsp;<span class="op" id="3192858">=</span>&nbsp;<span class="ident" id="3192860">math</span><span class="op" id="3192864">.</span><span class="ident" id="3192865">Floor</span><span class="op" id="3192870">(</span><span class="ident" id="3192871">x</span>&nbsp;<span class="op" id="3192873">+</span>&nbsp;<span class="num" id="3192875">0.5</span><span class="op" id="3192878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192882">if</span>&nbsp;<span class="ident" id="3192885">k</span><span class="op" id="3192886">-</span><span class="ident" id="3192887">x</span>&nbsp;<span class="op" id="3192889">&lt;=</span>&nbsp;<span class="ident" id="3192892">z</span><span class="op" id="3192893">.</span><span class="ident" id="3192894">s</span>&nbsp;<span class="op" id="3192896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192901">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3192909">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192913">if</span>&nbsp;<span class="ident" id="3192916">ur</span>&nbsp;<span class="op" id="3192919">&gt;=</span>&nbsp;<span class="ident" id="3192922">z</span><span class="op" id="3192923">.</span><span class="ident" id="3192924">h</span><span class="op" id="3192925">(</span><span class="ident" id="3192926">k</span><span class="op" id="3192927">+</span><span class="num" id="3192928">0.5</span><span class="op" id="3192931">)</span><span class="op" id="3192932">-</span><span class="ident" id="3192933">math</span><span class="op" id="3192937">.</span><span class="ident" id="3192938">Exp</span><span class="op" id="3192941">(</span><span class="op" id="3192942">-</span><span class="ident" id="3192943">math</span><span class="op" id="3192947">.</span><span class="ident" id="3192948">Log</span><span class="op" id="3192951">(</span><span class="ident" id="3192952">k</span><span class="op" id="3192953">+</span><span class="ident" id="3192954">z</span><span class="op" id="3192955">.</span><span class="ident" id="3192956">v</span><span class="op" id="3192957">)</span><span class="op" id="3192958">*</span><span class="ident" id="3192959">z</span><span class="op" id="3192960">.</span><span class="ident" id="3192961">q</span><span class="op" id="3192962">)</span>&nbsp;<span class="op" id="3192964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192969">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3192977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3192980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3192983">return</span>&nbsp;<span class="ident" id="3192990">uint64</span><span class="op" id="3192996">(</span><span class="ident" id="3192997">k</span><span class="op" id="3192998">)</span><br>
<span class="lineno">75</span><span class="op" id="3193000">}</span>
</div>
</body>
</html>
