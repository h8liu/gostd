<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path/filepath</h2>
<ul>
<li><a href="/gostd/path/filepath/example_unix_test.go.html">example_unix_test.go</a></li>
<li><a href="/gostd/path/filepath/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/path/filepath/match.go.html">match.go</a></li>
<li><a href="/gostd/path/filepath/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/filepath/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/path/filepath/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/path/filepath/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/path/filepath/symlink.go.html">symlink.go</a></li>
<li><a href="/gostd/path/filepath/symlink_unix.go.html">symlink_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3318137">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3318192">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3318246">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3318297">//&nbsp;Package&nbsp;filepath&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;filename&nbsp;paths</span><br>
<span class="lineno"></span><span class="comment" id="3318377">//&nbsp;in&nbsp;a&nbsp;way&nbsp;compatible&nbsp;with&nbsp;the&nbsp;target&nbsp;operating&nbsp;system-defined&nbsp;file&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3318453">package</span>&nbsp;<span class="ident" id="3318461">filepath</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3318471">import</span>&nbsp;<span class="op" id="3318478">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3318481">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3318491">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3318497">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3318505">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3318515">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3318518">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3318568">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="3318626">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3318692">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno">20</span><span class="keyword" id="3318749">type</span>&nbsp;<span class="ident" id="3318754">lazybuf</span>&nbsp;<span class="keyword" id="3318762">struct</span>&nbsp;<span class="op" id="3318769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318772">path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3318783">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318791">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318802">[</span><span class="op" id="3318803">]</span><span class="builtintype" id="3318804">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318810">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3318821">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318826">volAndPath</span>&nbsp;<span class="builtintype" id="3318837">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3318845">volLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3318856">int</span><br>
<span class="lineno"></span><span class="op" id="3318860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3318863">func</span>&nbsp;<span class="op" id="3318868">(</span><span class="ident" id="3318869">b</span>&nbsp;<span class="op" id="3318871">*</span><span class="ident" id="3318872">lazybuf</span><span class="op" id="3318879">)</span>&nbsp;<span class="ident" id="3318881">index</span><span class="op" id="3318886">(</span><span class="ident" id="3318887">i</span>&nbsp;<span class="builtintype" id="3318889">int</span><span class="op" id="3318892">)</span>&nbsp;<span class="builtintype" id="3318894">byte</span>&nbsp;<span class="op" id="3318899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318902">if</span>&nbsp;<span class="ident" id="3318905">b</span><span class="op" id="3318906">.</span><span class="ident" id="3318907">buf</span>&nbsp;<span class="op" id="3318911">!=</span>&nbsp;<span class="builtintype" id="3318914">nil</span>&nbsp;<span class="op" id="3318918">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318922">return</span>&nbsp;<span class="ident" id="3318929">b</span><span class="op" id="3318930">.</span><span class="ident" id="3318931">buf</span><span class="op" id="3318934">[</span><span class="ident" id="3318935">i</span><span class="op" id="3318936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3318939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318942">return</span>&nbsp;<span class="ident" id="3318949">b</span><span class="op" id="3318950">.</span><span class="ident" id="3318951">path</span><span class="op" id="3318955">[</span><span class="ident" id="3318956">i</span><span class="op" id="3318957">]</span><br>
<span class="lineno"></span><span class="op" id="3318959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3318962">func</span>&nbsp;<span class="op" id="3318967">(</span><span class="ident" id="3318968">b</span>&nbsp;<span class="op" id="3318970">*</span><span class="ident" id="3318971">lazybuf</span><span class="op" id="3318978">)</span>&nbsp;<span class="builtinfunc" id="3318980">append</span><span class="op" id="3318986">(</span><span class="ident" id="3318987">c</span>&nbsp;<span class="builtintype" id="3318989">byte</span><span class="op" id="3318993">)</span>&nbsp;<span class="op" id="3318995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3318998">if</span>&nbsp;<span class="ident" id="3319001">b</span><span class="op" id="3319002">.</span><span class="ident" id="3319003">buf</span>&nbsp;<span class="op" id="3319007">==</span>&nbsp;<span class="builtintype" id="3319010">nil</span>&nbsp;<span class="op" id="3319014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3319018">if</span>&nbsp;<span class="ident" id="3319021">b</span><span class="op" id="3319022">.</span><span class="ident" id="3319023">w</span>&nbsp;<span class="op" id="3319025">&lt;</span>&nbsp;<span class="builtinfunc" id="3319027">len</span><span class="op" id="3319030">(</span><span class="ident" id="3319031">b</span><span class="op" id="3319032">.</span><span class="ident" id="3319033">path</span><span class="op" id="3319037">)</span>&nbsp;<span class="op" id="3319039">&amp;&amp;</span>&nbsp;<span class="ident" id="3319042">b</span><span class="op" id="3319043">.</span><span class="ident" id="3319044">path</span><span class="op" id="3319048">[</span><span class="ident" id="3319049">b</span><span class="op" id="3319050">.</span><span class="ident" id="3319051">w</span><span class="op" id="3319052">]</span>&nbsp;<span class="op" id="3319054">==</span>&nbsp;<span class="ident" id="3319057">c</span>&nbsp;<span class="op" id="3319059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319064">b</span><span class="op" id="3319065">.</span><span class="ident" id="3319066">w</span><span class="op" id="3319067">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3319073">return</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3319082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319086">b</span><span class="op" id="3319087">.</span><span class="ident" id="3319088">buf</span>&nbsp;<span class="op" id="3319092">=</span>&nbsp;<span class="builtinfunc" id="3319094">make</span><span class="op" id="3319098">(</span><span class="op" id="3319099">[</span><span class="op" id="3319100">]</span><span class="builtintype" id="3319101">byte</span><span class="op" id="3319105">,</span>&nbsp;<span class="builtinfunc" id="3319107">len</span><span class="op" id="3319110">(</span><span class="ident" id="3319111">b</span><span class="op" id="3319112">.</span><span class="ident" id="3319113">path</span><span class="op" id="3319117">)</span><span class="op" id="3319118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3319122">copy</span><span class="op" id="3319126">(</span><span class="ident" id="3319127">b</span><span class="op" id="3319128">.</span><span class="ident" id="3319129">buf</span><span class="op" id="3319132">,</span>&nbsp;<span class="ident" id="3319134">b</span><span class="op" id="3319135">.</span><span class="ident" id="3319136">path</span><span class="op" id="3319140">[</span><span class="op" id="3319141">:</span><span class="ident" id="3319142">b</span><span class="op" id="3319143">.</span><span class="ident" id="3319144">w</span><span class="op" id="3319145">]</span><span class="op" id="3319146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3319149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319152">b</span><span class="op" id="3319153">.</span><span class="ident" id="3319154">buf</span><span class="op" id="3319157">[</span><span class="ident" id="3319158">b</span><span class="op" id="3319159">.</span><span class="ident" id="3319160">w</span><span class="op" id="3319161">]</span>&nbsp;<span class="op" id="3319163">=</span>&nbsp;<span class="ident" id="3319165">c</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319168">b</span><span class="op" id="3319169">.</span><span class="ident" id="3319170">w</span><span class="op" id="3319171">++</span><br>
<span class="lineno"></span><span class="op" id="3319174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3319177">func</span>&nbsp;<span class="op" id="3319182">(</span><span class="ident" id="3319183">b</span>&nbsp;<span class="op" id="3319185">*</span><span class="ident" id="3319186">lazybuf</span><span class="op" id="3319193">)</span>&nbsp;<span class="builtintype" id="3319195">string</span><span class="op" id="3319201">(</span><span class="op" id="3319202">)</span>&nbsp;<span class="builtintype" id="3319204">string</span>&nbsp;<span class="op" id="3319211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3319214">if</span>&nbsp;<span class="ident" id="3319217">b</span><span class="op" id="3319218">.</span><span class="ident" id="3319219">buf</span>&nbsp;<span class="op" id="3319223">==</span>&nbsp;<span class="builtintype" id="3319226">nil</span>&nbsp;<span class="op" id="3319230">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3319234">return</span>&nbsp;<span class="ident" id="3319241">b</span><span class="op" id="3319242">.</span><span class="ident" id="3319243">volAndPath</span><span class="op" id="3319253">[</span><span class="op" id="3319254">:</span><span class="ident" id="3319255">b</span><span class="op" id="3319256">.</span><span class="ident" id="3319257">volLen</span><span class="op" id="3319263">+</span><span class="ident" id="3319264">b</span><span class="op" id="3319265">.</span><span class="ident" id="3319266">w</span><span class="op" id="3319267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3319270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3319273">return</span>&nbsp;<span class="ident" id="3319280">b</span><span class="op" id="3319281">.</span><span class="ident" id="3319282">volAndPath</span><span class="op" id="3319292">[</span><span class="op" id="3319293">:</span><span class="ident" id="3319294">b</span><span class="op" id="3319295">.</span><span class="ident" id="3319296">volLen</span><span class="op" id="3319302">]</span>&nbsp;<span class="op" id="3319304">+</span>&nbsp;<span class="builtintype" id="3319306">string</span><span class="op" id="3319312">(</span><span class="ident" id="3319313">b</span><span class="op" id="3319314">.</span><span class="ident" id="3319315">buf</span><span class="op" id="3319318">[</span><span class="op" id="3319319">:</span><span class="ident" id="3319320">b</span><span class="op" id="3319321">.</span><span class="ident" id="3319322">w</span><span class="op" id="3319323">]</span><span class="op" id="3319324">)</span><br>
<span class="lineno"></span><span class="op" id="3319326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3319329">const</span>&nbsp;<span class="op" id="3319335">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319338">Separator</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3319352">=</span>&nbsp;<span class="ident" id="3319354">os</span><span class="op" id="3319356">.</span><span class="ident" id="3319357">PathSeparator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3319372">ListSeparator</span>&nbsp;<span class="op" id="3319386">=</span>&nbsp;<span class="ident" id="3319388">os</span><span class="op" id="3319390">.</span><span class="ident" id="3319391">PathListSeparator</span><br>
<span class="lineno"></span><span class="op" id="3319409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3319412">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3319471">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3319536">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3319592">//</span><br>
<span class="lineno"></span><span class="comment" id="3319595">//&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Replace&nbsp;multiple&nbsp;Separator&nbsp;elements&nbsp;with&nbsp;a&nbsp;single&nbsp;one.</span><br>
<span class="lineno">65</span><span class="comment" id="3319656">//&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3319722">//&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3319793">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3319847">//&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3319901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path,</span><br>
<span class="lineno">70</span><span class="comment" id="3319965">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assuming&nbsp;Separator&nbsp;is&nbsp;&#39;/&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="3319998">//</span><br>
<span class="lineno"></span><span class="comment" id="3320001">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;represents&nbsp;a&nbsp;root&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="3320078">//&nbsp;such&nbsp;as&nbsp;&#34;/&#34;&nbsp;on&nbsp;Unix&nbsp;or&nbsp;`C:\`&nbsp;on&nbsp;Windows.</span><br>
<span class="lineno"></span><span class="comment" id="3320122">//</span><br>
<span class="lineno">75</span><span class="comment" id="3320125">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3320184">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3320211">//</span><br>
<span class="lineno"></span><span class="comment" id="3320214">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3320270">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno">80</span><span class="comment" id="3320298">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3320350">func</span>&nbsp;<span class="ident" id="3320355">Clean</span><span class="op" id="3320360">(</span><span class="ident" id="3320361">path</span>&nbsp;<span class="builtintype" id="3320366">string</span><span class="op" id="3320372">)</span>&nbsp;<span class="builtintype" id="3320374">string</span>&nbsp;<span class="op" id="3320381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320384">originalPath</span>&nbsp;<span class="op" id="3320397">:=</span>&nbsp;<span class="ident" id="3320400">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320406">volLen</span>&nbsp;<span class="op" id="3320413">:=</span>&nbsp;<span class="ident" id="3320416">volumeNameLen</span><span class="op" id="3320429">(</span><span class="ident" id="3320430">path</span><span class="op" id="3320434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320437">path</span>&nbsp;<span class="op" id="3320442">=</span>&nbsp;<span class="ident" id="3320444">path</span><span class="op" id="3320448">[</span><span class="ident" id="3320449">volLen</span><span class="op" id="3320455">:</span><span class="op" id="3320456">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3320459">if</span>&nbsp;<span class="ident" id="3320462">path</span>&nbsp;<span class="op" id="3320467">==</span>&nbsp;<span class="string" id="3320470">&#34;&#34;</span>&nbsp;<span class="op" id="3320473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3320477">if</span>&nbsp;<span class="ident" id="3320480">volLen</span>&nbsp;<span class="op" id="3320487">&gt;</span>&nbsp;<span class="num" id="3320489">1</span>&nbsp;<span class="op" id="3320491">&amp;&amp;</span>&nbsp;<span class="ident" id="3320494">originalPath</span><span class="op" id="3320506">[</span><span class="num" id="3320507">1</span><span class="op" id="3320508">]</span>&nbsp;<span class="op" id="3320510">!=</span>&nbsp;<span class="string" id="3320513">&#39;:&#39;</span>&nbsp;<span class="op" id="3320517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320522">//&nbsp;should&nbsp;be&nbsp;UNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3320542">return</span>&nbsp;<span class="ident" id="3320549">FromSlash</span><span class="op" id="3320558">(</span><span class="ident" id="3320559">originalPath</span><span class="op" id="3320571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3320575">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3320579">return</span>&nbsp;<span class="ident" id="3320586">originalPath</span>&nbsp;<span class="op" id="3320599">+</span>&nbsp;<span class="string" id="3320601">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3320606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320609">rooted</span>&nbsp;<span class="op" id="3320616">:=</span>&nbsp;<span class="ident" id="3320619">os</span><span class="op" id="3320621">.</span><span class="ident" id="3320622">IsPathSeparator</span><span class="op" id="3320637">(</span><span class="ident" id="3320638">path</span><span class="op" id="3320642">[</span><span class="num" id="3320643">0</span><span class="op" id="3320644">]</span><span class="op" id="3320645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320649">//&nbsp;Invariants:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320665">//&nbsp;&nbsp;&nbsp;&nbsp;reading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320724">//&nbsp;&nbsp;&nbsp;&nbsp;writing&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320778">//&nbsp;&nbsp;&nbsp;&nbsp;dotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3320840">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320905">n</span>&nbsp;<span class="op" id="3320907">:=</span>&nbsp;<span class="builtinfunc" id="3320910">len</span><span class="op" id="3320913">(</span><span class="ident" id="3320914">path</span><span class="op" id="3320918">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320921">out</span>&nbsp;<span class="op" id="3320925">:=</span>&nbsp;<span class="ident" id="3320928">lazybuf</span><span class="op" id="3320935">{</span><span class="ident" id="3320936">path</span><span class="op" id="3320940">:</span>&nbsp;<span class="ident" id="3320942">path</span><span class="op" id="3320946">,</span>&nbsp;<span class="ident" id="3320948">volAndPath</span><span class="op" id="3320958">:</span>&nbsp;<span class="ident" id="3320960">originalPath</span><span class="op" id="3320972">,</span>&nbsp;<span class="ident" id="3320974">volLen</span><span class="op" id="3320980">:</span>&nbsp;<span class="ident" id="3320982">volLen</span><span class="op" id="3320988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3320991">r</span><span class="op" id="3320992">,</span>&nbsp;<span class="ident" id="3320994">dotdot</span>&nbsp;<span class="op" id="3321001">:=</span>&nbsp;<span class="num" id="3321004">0</span><span class="op" id="3321005">,</span>&nbsp;<span class="num" id="3321007">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321010">if</span>&nbsp;<span class="ident" id="3321013">rooted</span>&nbsp;<span class="op" id="3321020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321024">out</span><span class="op" id="3321027">.</span><span class="builtinfunc" id="3321028">append</span><span class="op" id="3321034">(</span><span class="ident" id="3321035">Separator</span><span class="op" id="3321044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321048">r</span><span class="op" id="3321049">,</span>&nbsp;<span class="ident" id="3321051">dotdot</span>&nbsp;<span class="op" id="3321058">=</span>&nbsp;<span class="num" id="3321060">1</span><span class="op" id="3321061">,</span>&nbsp;<span class="num" id="3321063">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321070">for</span>&nbsp;<span class="ident" id="3321074">r</span>&nbsp;<span class="op" id="3321076">&lt;</span>&nbsp;<span class="ident" id="3321078">n</span>&nbsp;<span class="op" id="3321080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321084">switch</span>&nbsp;<span class="op" id="3321091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321095">case</span>&nbsp;<span class="ident" id="3321100">os</span><span class="op" id="3321102">.</span><span class="ident" id="3321103">IsPathSeparator</span><span class="op" id="3321118">(</span><span class="ident" id="3321119">path</span><span class="op" id="3321123">[</span><span class="ident" id="3321124">r</span><span class="op" id="3321125">]</span><span class="op" id="3321126">)</span><span class="op" id="3321127">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321132">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321157">r</span><span class="op" id="3321158">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321163">case</span>&nbsp;<span class="ident" id="3321168">path</span><span class="op" id="3321172">[</span><span class="ident" id="3321173">r</span><span class="op" id="3321174">]</span>&nbsp;<span class="op" id="3321176">==</span>&nbsp;<span class="string" id="3321179">&#39;.&#39;</span>&nbsp;<span class="op" id="3321183">&amp;&amp;</span>&nbsp;<span class="op" id="3321186">(</span><span class="ident" id="3321187">r</span><span class="op" id="3321188">+</span><span class="num" id="3321189">1</span>&nbsp;<span class="op" id="3321191">==</span>&nbsp;<span class="ident" id="3321194">n</span>&nbsp;<span class="op" id="3321196">||</span>&nbsp;<span class="ident" id="3321199">os</span><span class="op" id="3321201">.</span><span class="ident" id="3321202">IsPathSeparator</span><span class="op" id="3321217">(</span><span class="ident" id="3321218">path</span><span class="op" id="3321222">[</span><span class="ident" id="3321223">r</span><span class="op" id="3321224">+</span><span class="num" id="3321225">1</span><span class="op" id="3321226">]</span><span class="op" id="3321227">)</span><span class="op" id="3321228">)</span><span class="op" id="3321229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321234">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321250">r</span><span class="op" id="3321251">++</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321256">case</span>&nbsp;<span class="ident" id="3321261">path</span><span class="op" id="3321265">[</span><span class="ident" id="3321266">r</span><span class="op" id="3321267">]</span>&nbsp;<span class="op" id="3321269">==</span>&nbsp;<span class="string" id="3321272">&#39;.&#39;</span>&nbsp;<span class="op" id="3321276">&amp;&amp;</span>&nbsp;<span class="ident" id="3321279">path</span><span class="op" id="3321283">[</span><span class="ident" id="3321284">r</span><span class="op" id="3321285">+</span><span class="num" id="3321286">1</span><span class="op" id="3321287">]</span>&nbsp;<span class="op" id="3321289">==</span>&nbsp;<span class="string" id="3321292">&#39;.&#39;</span>&nbsp;<span class="op" id="3321296">&amp;&amp;</span>&nbsp;<span class="op" id="3321299">(</span><span class="ident" id="3321300">r</span><span class="op" id="3321301">+</span><span class="num" id="3321302">2</span>&nbsp;<span class="op" id="3321304">==</span>&nbsp;<span class="ident" id="3321307">n</span>&nbsp;<span class="op" id="3321309">||</span>&nbsp;<span class="ident" id="3321312">os</span><span class="op" id="3321314">.</span><span class="ident" id="3321315">IsPathSeparator</span><span class="op" id="3321330">(</span><span class="ident" id="3321331">path</span><span class="op" id="3321335">[</span><span class="ident" id="3321336">r</span><span class="op" id="3321337">+</span><span class="num" id="3321338">2</span><span class="op" id="3321339">]</span><span class="op" id="3321340">)</span><span class="op" id="3321341">)</span><span class="op" id="3321342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321347">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321390">r</span>&nbsp;<span class="op" id="3321392">+=</span>&nbsp;<span class="num" id="3321395">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321400">switch</span>&nbsp;<span class="op" id="3321407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321412">case</span>&nbsp;<span class="ident" id="3321417">out</span><span class="op" id="3321420">.</span><span class="ident" id="3321421">w</span>&nbsp;<span class="op" id="3321423">&gt;</span>&nbsp;<span class="ident" id="3321425">dotdot</span><span class="op" id="3321431">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321437">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321458">out</span><span class="op" id="3321461">.</span><span class="ident" id="3321462">w</span><span class="op" id="3321463">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321470">for</span>&nbsp;<span class="ident" id="3321474">out</span><span class="op" id="3321477">.</span><span class="ident" id="3321478">w</span>&nbsp;<span class="op" id="3321480">&gt;</span>&nbsp;<span class="ident" id="3321482">dotdot</span>&nbsp;<span class="op" id="3321489">&amp;&amp;</span>&nbsp;<span class="op" id="3321492">!</span><span class="ident" id="3321493">os</span><span class="op" id="3321495">.</span><span class="ident" id="3321496">IsPathSeparator</span><span class="op" id="3321511">(</span><span class="ident" id="3321512">out</span><span class="op" id="3321515">.</span><span class="ident" id="3321516">index</span><span class="op" id="3321521">(</span><span class="ident" id="3321522">out</span><span class="op" id="3321525">.</span><span class="ident" id="3321526">w</span><span class="op" id="3321527">)</span><span class="op" id="3321528">)</span>&nbsp;<span class="op" id="3321530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321537">out</span><span class="op" id="3321540">.</span><span class="ident" id="3321541">w</span><span class="op" id="3321542">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321549">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321554">case</span>&nbsp;<span class="op" id="3321559">!</span><span class="ident" id="3321560">rooted</span><span class="op" id="3321566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321572">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321635">if</span>&nbsp;<span class="ident" id="3321638">out</span><span class="op" id="3321641">.</span><span class="ident" id="3321642">w</span>&nbsp;<span class="op" id="3321644">&gt;</span>&nbsp;<span class="num" id="3321646">0</span>&nbsp;<span class="op" id="3321648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321655">out</span><span class="op" id="3321658">.</span><span class="builtinfunc" id="3321659">append</span><span class="op" id="3321665">(</span><span class="ident" id="3321666">Separator</span><span class="op" id="3321675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321681">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321687">out</span><span class="op" id="3321690">.</span><span class="builtinfunc" id="3321691">append</span><span class="op" id="3321697">(</span><span class="string" id="3321698">&#39;.&#39;</span><span class="op" id="3321701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321707">out</span><span class="op" id="3321710">.</span><span class="builtinfunc" id="3321711">append</span><span class="op" id="3321717">(</span><span class="string" id="3321718">&#39;.&#39;</span><span class="op" id="3321721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321727">dotdot</span>&nbsp;<span class="op" id="3321734">=</span>&nbsp;<span class="ident" id="3321736">out</span><span class="op" id="3321739">.</span><span class="ident" id="3321740">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321749">default</span><span class="op" id="3321756">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321761">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321786">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321812">if</span>&nbsp;<span class="ident" id="3321815">rooted</span>&nbsp;<span class="op" id="3321822">&amp;&amp;</span>&nbsp;<span class="ident" id="3321825">out</span><span class="op" id="3321828">.</span><span class="ident" id="3321829">w</span>&nbsp;<span class="op" id="3321831">!=</span>&nbsp;<span class="num" id="3321834">1</span>&nbsp;<span class="op" id="3321836">||</span>&nbsp;<span class="op" id="3321839">!</span><span class="ident" id="3321840">rooted</span>&nbsp;<span class="op" id="3321847">&amp;&amp;</span>&nbsp;<span class="ident" id="3321850">out</span><span class="op" id="3321853">.</span><span class="ident" id="3321854">w</span>&nbsp;<span class="op" id="3321856">!=</span>&nbsp;<span class="num" id="3321859">0</span>&nbsp;<span class="op" id="3321861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321867">out</span><span class="op" id="3321870">.</span><span class="builtinfunc" id="3321871">append</span><span class="op" id="3321877">(</span><span class="ident" id="3321878">Separator</span><span class="op" id="3321887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321892">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3321897">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3321916">for</span>&nbsp;<span class="op" id="3321920">;</span>&nbsp;<span class="ident" id="3321922">r</span>&nbsp;<span class="op" id="3321924">&lt;</span>&nbsp;<span class="ident" id="3321926">n</span>&nbsp;<span class="op" id="3321928">&amp;&amp;</span>&nbsp;<span class="op" id="3321931">!</span><span class="ident" id="3321932">os</span><span class="op" id="3321934">.</span><span class="ident" id="3321935">IsPathSeparator</span><span class="op" id="3321950">(</span><span class="ident" id="3321951">path</span><span class="op" id="3321955">[</span><span class="ident" id="3321956">r</span><span class="op" id="3321957">]</span><span class="op" id="3321958">)</span><span class="op" id="3321959">;</span>&nbsp;<span class="ident" id="3321961">r</span><span class="op" id="3321962">++</span>&nbsp;<span class="op" id="3321965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3321971">out</span><span class="op" id="3321974">.</span><span class="builtinfunc" id="3321975">append</span><span class="op" id="3321981">(</span><span class="ident" id="3321982">path</span><span class="op" id="3321986">[</span><span class="ident" id="3321987">r</span><span class="op" id="3321988">]</span><span class="op" id="3321989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3321998">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3322001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3322005">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322036">if</span>&nbsp;<span class="ident" id="3322039">out</span><span class="op" id="3322042">.</span><span class="ident" id="3322043">w</span>&nbsp;<span class="op" id="3322045">==</span>&nbsp;<span class="num" id="3322048">0</span>&nbsp;<span class="op" id="3322050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3322054">out</span><span class="op" id="3322057">.</span><span class="builtinfunc" id="3322058">append</span><span class="op" id="3322064">(</span><span class="string" id="3322065">&#39;.&#39;</span><span class="op" id="3322068">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3322071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322075">return</span>&nbsp;<span class="ident" id="3322082">FromSlash</span><span class="op" id="3322091">(</span><span class="ident" id="3322092">out</span><span class="op" id="3322095">.</span><span class="builtintype" id="3322096">string</span><span class="op" id="3322102">(</span><span class="op" id="3322103">)</span><span class="op" id="3322104">)</span><br>
<span class="lineno"></span><span class="op" id="3322106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3322109">//&nbsp;ToSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;separator&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3322177">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character.&nbsp;Multiple&nbsp;separators&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3322242">//&nbsp;replaced&nbsp;by&nbsp;multiple&nbsp;slashes.</span><br>
<span class="lineno"></span><span class="keyword" id="3322275">func</span>&nbsp;<span class="ident" id="3322280">ToSlash</span><span class="op" id="3322287">(</span><span class="ident" id="3322288">path</span>&nbsp;<span class="builtintype" id="3322293">string</span><span class="op" id="3322299">)</span>&nbsp;<span class="builtintype" id="3322301">string</span>&nbsp;<span class="op" id="3322308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322311">if</span>&nbsp;<span class="ident" id="3322314">Separator</span>&nbsp;<span class="op" id="3322324">==</span>&nbsp;<span class="string" id="3322327">&#39;/&#39;</span>&nbsp;<span class="op" id="3322331">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322335">return</span>&nbsp;<span class="ident" id="3322342">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3322348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322351">return</span>&nbsp;<span class="ident" id="3322358">strings</span><span class="op" id="3322365">.</span><span class="ident" id="3322366">Replace</span><span class="op" id="3322373">(</span><span class="ident" id="3322374">path</span><span class="op" id="3322378">,</span>&nbsp;<span class="builtintype" id="3322380">string</span><span class="op" id="3322386">(</span><span class="ident" id="3322387">Separator</span><span class="op" id="3322396">)</span><span class="op" id="3322397">,</span>&nbsp;<span class="string" id="3322399">&#34;/&#34;</span><span class="op" id="3322402">,</span>&nbsp;<span class="op" id="3322404">-</span><span class="num" id="3322405">1</span><span class="op" id="3322406">)</span><br>
<span class="lineno"></span><span class="op" id="3322408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3322411">//&nbsp;FromSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3322483">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;separator&nbsp;character.&nbsp;Multiple&nbsp;slashes&nbsp;are&nbsp;replaced</span><br>
<span class="lineno"></span><span class="comment" id="3322552">//&nbsp;by&nbsp;multiple&nbsp;separators.</span><br>
<span class="lineno"></span><span class="keyword" id="3322579">func</span>&nbsp;<span class="ident" id="3322584">FromSlash</span><span class="op" id="3322593">(</span><span class="ident" id="3322594">path</span>&nbsp;<span class="builtintype" id="3322599">string</span><span class="op" id="3322605">)</span>&nbsp;<span class="builtintype" id="3322607">string</span>&nbsp;<span class="op" id="3322614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322617">if</span>&nbsp;<span class="ident" id="3322620">Separator</span>&nbsp;<span class="op" id="3322630">==</span>&nbsp;<span class="string" id="3322633">&#39;/&#39;</span>&nbsp;<span class="op" id="3322637">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322641">return</span>&nbsp;<span class="ident" id="3322648">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3322654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322657">return</span>&nbsp;<span class="ident" id="3322664">strings</span><span class="op" id="3322671">.</span><span class="ident" id="3322672">Replace</span><span class="op" id="3322679">(</span><span class="ident" id="3322680">path</span><span class="op" id="3322684">,</span>&nbsp;<span class="string" id="3322686">&#34;/&#34;</span><span class="op" id="3322689">,</span>&nbsp;<span class="builtintype" id="3322691">string</span><span class="op" id="3322697">(</span><span class="ident" id="3322698">Separator</span><span class="op" id="3322707">)</span><span class="op" id="3322708">,</span>&nbsp;<span class="op" id="3322710">-</span><span class="num" id="3322711">1</span><span class="op" id="3322712">)</span><br>
<span class="lineno"></span><span class="op" id="3322714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3322717">//&nbsp;SplitList&nbsp;splits&nbsp;a&nbsp;list&nbsp;of&nbsp;paths&nbsp;joined&nbsp;by&nbsp;the&nbsp;OS-specific&nbsp;ListSeparator,</span><br>
<span class="lineno"></span><span class="comment" id="3322794">//&nbsp;usually&nbsp;found&nbsp;in&nbsp;PATH&nbsp;or&nbsp;GOPATH&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><span class="comment" id="3322852">//&nbsp;Unlike&nbsp;strings.Split,&nbsp;SplitList&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;when&nbsp;passed&nbsp;an&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3322939">func</span>&nbsp;<span class="ident" id="3322944">SplitList</span><span class="op" id="3322953">(</span><span class="ident" id="3322954">path</span>&nbsp;<span class="builtintype" id="3322959">string</span><span class="op" id="3322965">)</span>&nbsp;<span class="op" id="3322967">[</span><span class="op" id="3322968">]</span><span class="builtintype" id="3322969">string</span>&nbsp;<span class="op" id="3322976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3322979">return</span>&nbsp;<span class="ident" id="3322986">splitList</span><span class="op" id="3322995">(</span><span class="ident" id="3322996">path</span><span class="op" id="3323000">)</span><br>
<span class="lineno">180</span><span class="op" id="3323002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3323005">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;Separator,</span><br>
<span class="lineno"></span><span class="comment" id="3323069">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3323128">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;Separator&nbsp;in&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir</span><br>
<span class="lineno">185</span><span class="comment" id="3323192">//&nbsp;and&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3323217">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3323280">func</span>&nbsp;<span class="ident" id="3323285">Split</span><span class="op" id="3323290">(</span><span class="ident" id="3323291">path</span>&nbsp;<span class="builtintype" id="3323296">string</span><span class="op" id="3323302">)</span>&nbsp;<span class="op" id="3323304">(</span><span class="ident" id="3323305">dir</span><span class="op" id="3323308">,</span>&nbsp;<span class="ident" id="3323310">file</span>&nbsp;<span class="builtintype" id="3323315">string</span><span class="op" id="3323321">)</span>&nbsp;<span class="op" id="3323323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3323326">vol</span>&nbsp;<span class="op" id="3323330">:=</span>&nbsp;<span class="ident" id="3323333">VolumeName</span><span class="op" id="3323343">(</span><span class="ident" id="3323344">path</span><span class="op" id="3323348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3323351">i</span>&nbsp;<span class="op" id="3323353">:=</span>&nbsp;<span class="builtinfunc" id="3323356">len</span><span class="op" id="3323359">(</span><span class="ident" id="3323360">path</span><span class="op" id="3323364">)</span>&nbsp;<span class="op" id="3323366">-</span>&nbsp;<span class="num" id="3323368">1</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323371">for</span>&nbsp;<span class="ident" id="3323375">i</span>&nbsp;<span class="op" id="3323377">&gt;=</span>&nbsp;<span class="builtinfunc" id="3323380">len</span><span class="op" id="3323383">(</span><span class="ident" id="3323384">vol</span><span class="op" id="3323387">)</span>&nbsp;<span class="op" id="3323389">&amp;&amp;</span>&nbsp;<span class="op" id="3323392">!</span><span class="ident" id="3323393">os</span><span class="op" id="3323395">.</span><span class="ident" id="3323396">IsPathSeparator</span><span class="op" id="3323411">(</span><span class="ident" id="3323412">path</span><span class="op" id="3323416">[</span><span class="ident" id="3323417">i</span><span class="op" id="3323418">]</span><span class="op" id="3323419">)</span>&nbsp;<span class="op" id="3323421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3323425">i</span><span class="op" id="3323426">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3323430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323433">return</span>&nbsp;<span class="ident" id="3323440">path</span><span class="op" id="3323444">[</span><span class="op" id="3323445">:</span><span class="ident" id="3323446">i</span><span class="op" id="3323447">+</span><span class="num" id="3323448">1</span><span class="op" id="3323449">]</span><span class="op" id="3323450">,</span>&nbsp;<span class="ident" id="3323452">path</span><span class="op" id="3323456">[</span><span class="ident" id="3323457">i</span><span class="op" id="3323458">+</span><span class="num" id="3323459">1</span><span class="op" id="3323460">:</span><span class="op" id="3323461">]</span><br>
<span class="lineno"></span><span class="op" id="3323463">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="3323466">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding</span><br>
<span class="lineno"></span><span class="comment" id="3323535">//&nbsp;a&nbsp;Separator&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned,&nbsp;in&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="3323601">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="3323635">func</span>&nbsp;<span class="ident" id="3323640">Join</span><span class="op" id="3323644">(</span><span class="ident" id="3323645">elem</span>&nbsp;<span class="op" id="3323650">...</span><span class="builtintype" id="3323653">string</span><span class="op" id="3323659">)</span>&nbsp;<span class="builtintype" id="3323661">string</span>&nbsp;<span class="op" id="3323668">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323671">for</span>&nbsp;<span class="ident" id="3323675">i</span><span class="op" id="3323676">,</span>&nbsp;<span class="ident" id="3323678">e</span>&nbsp;<span class="op" id="3323680">:=</span>&nbsp;<span class="keyword" id="3323683">range</span>&nbsp;<span class="ident" id="3323689">elem</span>&nbsp;<span class="op" id="3323694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323698">if</span>&nbsp;<span class="ident" id="3323701">e</span>&nbsp;<span class="op" id="3323703">!=</span>&nbsp;<span class="string" id="3323706">&#34;&#34;</span>&nbsp;<span class="op" id="3323709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323714">return</span>&nbsp;<span class="ident" id="3323721">Clean</span><span class="op" id="3323726">(</span><span class="ident" id="3323727">strings</span><span class="op" id="3323734">.</span><span class="ident" id="3323735">Join</span><span class="op" id="3323739">(</span><span class="ident" id="3323740">elem</span><span class="op" id="3323744">[</span><span class="ident" id="3323745">i</span><span class="op" id="3323746">:</span><span class="op" id="3323747">]</span><span class="op" id="3323748">,</span>&nbsp;<span class="builtintype" id="3323750">string</span><span class="op" id="3323756">(</span><span class="ident" id="3323757">Separator</span><span class="op" id="3323766">)</span><span class="op" id="3323767">)</span><span class="op" id="3323768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3323772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3323775">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3323778">return</span>&nbsp;<span class="string" id="3323785">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3323788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3323791">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3323844">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno">210</span><span class="comment" id="3323902">//&nbsp;in&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;path;&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3323959">//&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3323970">func</span>&nbsp;<span class="ident" id="3323975">Ext</span><span class="op" id="3323978">(</span><span class="ident" id="3323979">path</span>&nbsp;<span class="builtintype" id="3323984">string</span><span class="op" id="3323990">)</span>&nbsp;<span class="builtintype" id="3323992">string</span>&nbsp;<span class="op" id="3323999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324002">for</span>&nbsp;<span class="ident" id="3324006">i</span>&nbsp;<span class="op" id="3324008">:=</span>&nbsp;<span class="builtinfunc" id="3324011">len</span><span class="op" id="3324014">(</span><span class="ident" id="3324015">path</span><span class="op" id="3324019">)</span>&nbsp;<span class="op" id="3324021">-</span>&nbsp;<span class="num" id="3324023">1</span><span class="op" id="3324024">;</span>&nbsp;<span class="ident" id="3324026">i</span>&nbsp;<span class="op" id="3324028">&gt;=</span>&nbsp;<span class="num" id="3324031">0</span>&nbsp;<span class="op" id="3324033">&amp;&amp;</span>&nbsp;<span class="op" id="3324036">!</span><span class="ident" id="3324037">os</span><span class="op" id="3324039">.</span><span class="ident" id="3324040">IsPathSeparator</span><span class="op" id="3324055">(</span><span class="ident" id="3324056">path</span><span class="op" id="3324060">[</span><span class="ident" id="3324061">i</span><span class="op" id="3324062">]</span><span class="op" id="3324063">)</span><span class="op" id="3324064">;</span>&nbsp;<span class="ident" id="3324066">i</span><span class="op" id="3324067">--</span>&nbsp;<span class="op" id="3324070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324074">if</span>&nbsp;<span class="ident" id="3324077">path</span><span class="op" id="3324081">[</span><span class="ident" id="3324082">i</span><span class="op" id="3324083">]</span>&nbsp;<span class="op" id="3324085">==</span>&nbsp;<span class="string" id="3324088">&#39;.&#39;</span>&nbsp;<span class="op" id="3324092">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324097">return</span>&nbsp;<span class="ident" id="3324104">path</span><span class="op" id="3324108">[</span><span class="ident" id="3324109">i</span><span class="op" id="3324110">:</span><span class="op" id="3324111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3324115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3324118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324121">return</span>&nbsp;<span class="string" id="3324128">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3324131">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3324134">//&nbsp;EvalSymlinks&nbsp;returns&nbsp;the&nbsp;path&nbsp;name&nbsp;after&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;any&nbsp;symbolic</span><br>
<span class="lineno"></span><span class="comment" id="3324209">//&nbsp;links.</span><br>
<span class="lineno"></span><span class="comment" id="3324219">//&nbsp;If&nbsp;path&nbsp;is&nbsp;relative&nbsp;the&nbsp;result&nbsp;will&nbsp;be&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="3324296">//&nbsp;unless&nbsp;one&nbsp;of&nbsp;the&nbsp;components&nbsp;is&nbsp;an&nbsp;absolute&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno">225</span><span class="keyword" id="3324358">func</span>&nbsp;<span class="ident" id="3324363">EvalSymlinks</span><span class="op" id="3324375">(</span><span class="ident" id="3324376">path</span>&nbsp;<span class="builtintype" id="3324381">string</span><span class="op" id="3324387">)</span>&nbsp;<span class="op" id="3324389">(</span><span class="builtintype" id="3324390">string</span><span class="op" id="3324396">,</span>&nbsp;<span class="builtintype" id="3324398">error</span><span class="op" id="3324403">)</span>&nbsp;<span class="op" id="3324405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324408">return</span>&nbsp;<span class="ident" id="3324415">evalSymlinks</span><span class="op" id="3324427">(</span><span class="ident" id="3324428">path</span><span class="op" id="3324432">)</span><br>
<span class="lineno"></span><span class="op" id="3324434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324437">//&nbsp;Abs&nbsp;returns&nbsp;an&nbsp;absolute&nbsp;representation&nbsp;of&nbsp;path.</span><br>
<span class="lineno">230</span><span class="comment" id="3324488">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;not&nbsp;absolute&nbsp;it&nbsp;will&nbsp;be&nbsp;joined&nbsp;with&nbsp;the&nbsp;current</span><br>
<span class="lineno"></span><span class="comment" id="3324554">//&nbsp;working&nbsp;directory&nbsp;to&nbsp;turn&nbsp;it&nbsp;into&nbsp;an&nbsp;absolute&nbsp;path.&nbsp;&nbsp;The&nbsp;absolute</span><br>
<span class="lineno"></span><span class="comment" id="3324623">//&nbsp;path&nbsp;name&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique.</span><br>
<span class="lineno"></span><span class="keyword" id="3324685">func</span>&nbsp;<span class="ident" id="3324690">Abs</span><span class="op" id="3324693">(</span><span class="ident" id="3324694">path</span>&nbsp;<span class="builtintype" id="3324699">string</span><span class="op" id="3324705">)</span>&nbsp;<span class="op" id="3324707">(</span><span class="builtintype" id="3324708">string</span><span class="op" id="3324714">,</span>&nbsp;<span class="builtintype" id="3324716">error</span><span class="op" id="3324721">)</span>&nbsp;<span class="op" id="3324723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324726">return</span>&nbsp;<span class="ident" id="3324733">abs</span><span class="op" id="3324736">(</span><span class="ident" id="3324737">path</span><span class="op" id="3324741">)</span><br>
<span class="lineno">235</span><span class="op" id="3324743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3324746">func</span>&nbsp;<span class="ident" id="3324751">unixAbs</span><span class="op" id="3324758">(</span><span class="ident" id="3324759">path</span>&nbsp;<span class="builtintype" id="3324764">string</span><span class="op" id="3324770">)</span>&nbsp;<span class="op" id="3324772">(</span><span class="builtintype" id="3324773">string</span><span class="op" id="3324779">,</span>&nbsp;<span class="builtintype" id="3324781">error</span><span class="op" id="3324786">)</span>&nbsp;<span class="op" id="3324788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324791">if</span>&nbsp;<span class="ident" id="3324794">IsAbs</span><span class="op" id="3324799">(</span><span class="ident" id="3324800">path</span><span class="op" id="3324804">)</span>&nbsp;<span class="op" id="3324806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324810">return</span>&nbsp;<span class="ident" id="3324817">Clean</span><span class="op" id="3324822">(</span><span class="ident" id="3324823">path</span><span class="op" id="3324827">)</span><span class="op" id="3324828">,</span>&nbsp;<span class="builtintype" id="3324830">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3324835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3324838">wd</span><span class="op" id="3324840">,</span>&nbsp;<span class="ident" id="3324842">err</span>&nbsp;<span class="op" id="3324846">:=</span>&nbsp;<span class="ident" id="3324849">os</span><span class="op" id="3324851">.</span><span class="ident" id="3324852">Getwd</span><span class="op" id="3324857">(</span><span class="op" id="3324858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324861">if</span>&nbsp;<span class="ident" id="3324864">err</span>&nbsp;<span class="op" id="3324868">!=</span>&nbsp;<span class="builtintype" id="3324871">nil</span>&nbsp;<span class="op" id="3324875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324879">return</span>&nbsp;<span class="string" id="3324886">&#34;&#34;</span><span class="op" id="3324888">,</span>&nbsp;<span class="ident" id="3324890">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3324895">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3324898">return</span>&nbsp;<span class="ident" id="3324905">Join</span><span class="op" id="3324909">(</span><span class="ident" id="3324910">wd</span><span class="op" id="3324912">,</span>&nbsp;<span class="ident" id="3324914">path</span><span class="op" id="3324918">)</span><span class="op" id="3324919">,</span>&nbsp;<span class="builtintype" id="3324921">nil</span><br>
<span class="lineno"></span><span class="op" id="3324925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324928">//&nbsp;Rel&nbsp;returns&nbsp;a&nbsp;relative&nbsp;path&nbsp;that&nbsp;is&nbsp;lexically&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3325005">//&nbsp;joined&nbsp;to&nbsp;basepath&nbsp;with&nbsp;an&nbsp;intervening&nbsp;separator.&nbsp;That&nbsp;is,</span><br>
<span class="lineno">250</span><span class="comment" id="3325067">//&nbsp;Join(basepath,&nbsp;Rel(basepath,&nbsp;targpath))&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="3325144">//&nbsp;On&nbsp;success,&nbsp;the&nbsp;returned&nbsp;path&nbsp;will&nbsp;always&nbsp;be&nbsp;relative&nbsp;to&nbsp;basepath,</span><br>
<span class="lineno"></span><span class="comment" id="3325214">//&nbsp;even&nbsp;if&nbsp;basepath&nbsp;and&nbsp;targpath&nbsp;share&nbsp;no&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="3325266">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;targpath&nbsp;can&#39;t&nbsp;be&nbsp;made&nbsp;relative&nbsp;to&nbsp;basepath&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3325343">//&nbsp;knowing&nbsp;the&nbsp;current&nbsp;working&nbsp;directory&nbsp;would&nbsp;be&nbsp;necessary&nbsp;to&nbsp;compute&nbsp;it.</span><br>
<span class="lineno">255</span><span class="keyword" id="3325418">func</span>&nbsp;<span class="ident" id="3325423">Rel</span><span class="op" id="3325426">(</span><span class="ident" id="3325427">basepath</span><span class="op" id="3325435">,</span>&nbsp;<span class="ident" id="3325437">targpath</span>&nbsp;<span class="builtintype" id="3325446">string</span><span class="op" id="3325452">)</span>&nbsp;<span class="op" id="3325454">(</span><span class="builtintype" id="3325455">string</span><span class="op" id="3325461">,</span>&nbsp;<span class="builtintype" id="3325463">error</span><span class="op" id="3325468">)</span>&nbsp;<span class="op" id="3325470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325473">baseVol</span>&nbsp;<span class="op" id="3325481">:=</span>&nbsp;<span class="ident" id="3325484">VolumeName</span><span class="op" id="3325494">(</span><span class="ident" id="3325495">basepath</span><span class="op" id="3325503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325506">targVol</span>&nbsp;<span class="op" id="3325514">:=</span>&nbsp;<span class="ident" id="3325517">VolumeName</span><span class="op" id="3325527">(</span><span class="ident" id="3325528">targpath</span><span class="op" id="3325536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325539">base</span>&nbsp;<span class="op" id="3325544">:=</span>&nbsp;<span class="ident" id="3325547">Clean</span><span class="op" id="3325552">(</span><span class="ident" id="3325553">basepath</span><span class="op" id="3325561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325564">targ</span>&nbsp;<span class="op" id="3325569">:=</span>&nbsp;<span class="ident" id="3325572">Clean</span><span class="op" id="3325577">(</span><span class="ident" id="3325578">targpath</span><span class="op" id="3325586">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3325589">if</span>&nbsp;<span class="ident" id="3325592">targ</span>&nbsp;<span class="op" id="3325597">==</span>&nbsp;<span class="ident" id="3325600">base</span>&nbsp;<span class="op" id="3325605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3325609">return</span>&nbsp;<span class="string" id="3325616">&#34;.&#34;</span><span class="op" id="3325619">,</span>&nbsp;<span class="builtintype" id="3325621">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3325626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325629">base</span>&nbsp;<span class="op" id="3325634">=</span>&nbsp;<span class="ident" id="3325636">base</span><span class="op" id="3325640">[</span><span class="builtinfunc" id="3325641">len</span><span class="op" id="3325644">(</span><span class="ident" id="3325645">baseVol</span><span class="op" id="3325652">)</span><span class="op" id="3325653">:</span><span class="op" id="3325654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325657">targ</span>&nbsp;<span class="op" id="3325662">=</span>&nbsp;<span class="ident" id="3325664">targ</span><span class="op" id="3325668">[</span><span class="builtinfunc" id="3325669">len</span><span class="op" id="3325672">(</span><span class="ident" id="3325673">targVol</span><span class="op" id="3325680">)</span><span class="op" id="3325681">:</span><span class="op" id="3325682">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3325685">if</span>&nbsp;<span class="ident" id="3325688">base</span>&nbsp;<span class="op" id="3325693">==</span>&nbsp;<span class="string" id="3325696">&#34;.&#34;</span>&nbsp;<span class="op" id="3325700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325704">base</span>&nbsp;<span class="op" id="3325709">=</span>&nbsp;<span class="string" id="3325711">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3325715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3325718">//&nbsp;Can&#39;t&nbsp;use&nbsp;IsAbs&nbsp;-&nbsp;`\a`&nbsp;and&nbsp;`a`&nbsp;are&nbsp;both&nbsp;relative&nbsp;in&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325783">baseSlashed</span>&nbsp;<span class="op" id="3325795">:=</span>&nbsp;<span class="builtinfunc" id="3325798">len</span><span class="op" id="3325801">(</span><span class="ident" id="3325802">base</span><span class="op" id="3325806">)</span>&nbsp;<span class="op" id="3325808">&gt;</span>&nbsp;<span class="num" id="3325810">0</span>&nbsp;<span class="op" id="3325812">&amp;&amp;</span>&nbsp;<span class="ident" id="3325815">base</span><span class="op" id="3325819">[</span><span class="num" id="3325820">0</span><span class="op" id="3325821">]</span>&nbsp;<span class="op" id="3325823">==</span>&nbsp;<span class="ident" id="3325826">Separator</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3325837">targSlashed</span>&nbsp;<span class="op" id="3325849">:=</span>&nbsp;<span class="builtinfunc" id="3325852">len</span><span class="op" id="3325855">(</span><span class="ident" id="3325856">targ</span><span class="op" id="3325860">)</span>&nbsp;<span class="op" id="3325862">&gt;</span>&nbsp;<span class="num" id="3325864">0</span>&nbsp;<span class="op" id="3325866">&amp;&amp;</span>&nbsp;<span class="ident" id="3325869">targ</span><span class="op" id="3325873">[</span><span class="num" id="3325874">0</span><span class="op" id="3325875">]</span>&nbsp;<span class="op" id="3325877">==</span>&nbsp;<span class="ident" id="3325880">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3325891">if</span>&nbsp;<span class="ident" id="3325894">baseSlashed</span>&nbsp;<span class="op" id="3325906">!=</span>&nbsp;<span class="ident" id="3325909">targSlashed</span>&nbsp;<span class="op" id="3325921">||</span>&nbsp;<span class="ident" id="3325924">baseVol</span>&nbsp;<span class="op" id="3325932">!=</span>&nbsp;<span class="ident" id="3325935">targVol</span>&nbsp;<span class="op" id="3325943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3325947">return</span>&nbsp;<span class="string" id="3325954">&#34;&#34;</span><span class="op" id="3325956">,</span>&nbsp;<span class="ident" id="3325958">errors</span><span class="op" id="3325964">.</span><span class="ident" id="3325965">New</span><span class="op" id="3325968">(</span><span class="string" id="3325969">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="3325988">+</span>&nbsp;<span class="ident" id="3325990">targ</span>&nbsp;<span class="op" id="3325995">+</span>&nbsp;<span class="string" id="3325997">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="3326013">+</span>&nbsp;<span class="ident" id="3326015">base</span><span class="op" id="3326019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3326025">//&nbsp;Position&nbsp;base[b0:bi]&nbsp;and&nbsp;targ[t0:ti]&nbsp;at&nbsp;the&nbsp;first&nbsp;differing&nbsp;elements.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326099">bl</span>&nbsp;<span class="op" id="3326102">:=</span>&nbsp;<span class="builtinfunc" id="3326105">len</span><span class="op" id="3326108">(</span><span class="ident" id="3326109">base</span><span class="op" id="3326113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326116">tl</span>&nbsp;<span class="op" id="3326119">:=</span>&nbsp;<span class="builtinfunc" id="3326122">len</span><span class="op" id="3326125">(</span><span class="ident" id="3326126">targ</span><span class="op" id="3326130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326133">var</span>&nbsp;<span class="ident" id="3326137">b0</span><span class="op" id="3326139">,</span>&nbsp;<span class="ident" id="3326141">bi</span><span class="op" id="3326143">,</span>&nbsp;<span class="ident" id="3326145">t0</span><span class="op" id="3326147">,</span>&nbsp;<span class="ident" id="3326149">ti</span>&nbsp;<span class="builtintype" id="3326152">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326157">for</span>&nbsp;<span class="op" id="3326161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326165">for</span>&nbsp;<span class="ident" id="3326169">bi</span>&nbsp;<span class="op" id="3326172">&lt;</span>&nbsp;<span class="ident" id="3326174">bl</span>&nbsp;<span class="op" id="3326177">&amp;&amp;</span>&nbsp;<span class="ident" id="3326180">base</span><span class="op" id="3326184">[</span><span class="ident" id="3326185">bi</span><span class="op" id="3326187">]</span>&nbsp;<span class="op" id="3326189">!=</span>&nbsp;<span class="ident" id="3326192">Separator</span>&nbsp;<span class="op" id="3326202">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326207">bi</span><span class="op" id="3326209">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326218">for</span>&nbsp;<span class="ident" id="3326222">ti</span>&nbsp;<span class="op" id="3326225">&lt;</span>&nbsp;<span class="ident" id="3326227">tl</span>&nbsp;<span class="op" id="3326230">&amp;&amp;</span>&nbsp;<span class="ident" id="3326233">targ</span><span class="op" id="3326237">[</span><span class="ident" id="3326238">ti</span><span class="op" id="3326240">]</span>&nbsp;<span class="op" id="3326242">!=</span>&nbsp;<span class="ident" id="3326245">Separator</span>&nbsp;<span class="op" id="3326255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326260">ti</span><span class="op" id="3326262">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326267">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326271">if</span>&nbsp;<span class="ident" id="3326274">targ</span><span class="op" id="3326278">[</span><span class="ident" id="3326279">t0</span><span class="op" id="3326281">:</span><span class="ident" id="3326282">ti</span><span class="op" id="3326284">]</span>&nbsp;<span class="op" id="3326286">!=</span>&nbsp;<span class="ident" id="3326289">base</span><span class="op" id="3326293">[</span><span class="ident" id="3326294">b0</span><span class="op" id="3326296">:</span><span class="ident" id="3326297">bi</span><span class="op" id="3326299">]</span>&nbsp;<span class="op" id="3326301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326306">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326318">if</span>&nbsp;<span class="ident" id="3326321">bi</span>&nbsp;<span class="op" id="3326324">&lt;</span>&nbsp;<span class="ident" id="3326326">bl</span>&nbsp;<span class="op" id="3326329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326334">bi</span><span class="op" id="3326336">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326345">if</span>&nbsp;<span class="ident" id="3326348">ti</span>&nbsp;<span class="op" id="3326351">&lt;</span>&nbsp;<span class="ident" id="3326353">tl</span>&nbsp;<span class="op" id="3326356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326361">ti</span><span class="op" id="3326363">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326372">b0</span>&nbsp;<span class="op" id="3326375">=</span>&nbsp;<span class="ident" id="3326377">bi</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326382">t0</span>&nbsp;<span class="op" id="3326385">=</span>&nbsp;<span class="ident" id="3326387">ti</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326394">if</span>&nbsp;<span class="ident" id="3326397">base</span><span class="op" id="3326401">[</span><span class="ident" id="3326402">b0</span><span class="op" id="3326404">:</span><span class="ident" id="3326405">bi</span><span class="op" id="3326407">]</span>&nbsp;<span class="op" id="3326409">==</span>&nbsp;<span class="string" id="3326412">&#34;..&#34;</span>&nbsp;<span class="op" id="3326417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326421">return</span>&nbsp;<span class="string" id="3326428">&#34;&#34;</span><span class="op" id="3326430">,</span>&nbsp;<span class="ident" id="3326432">errors</span><span class="op" id="3326438">.</span><span class="ident" id="3326439">New</span><span class="op" id="3326442">(</span><span class="string" id="3326443">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="3326462">+</span>&nbsp;<span class="ident" id="3326464">targ</span>&nbsp;<span class="op" id="3326469">+</span>&nbsp;<span class="string" id="3326471">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="3326487">+</span>&nbsp;<span class="ident" id="3326489">base</span><span class="op" id="3326493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326496">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326499">if</span>&nbsp;<span class="ident" id="3326502">b0</span>&nbsp;<span class="op" id="3326505">!=</span>&nbsp;<span class="ident" id="3326508">bl</span>&nbsp;<span class="op" id="3326511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3326515">//&nbsp;Base&nbsp;elements&nbsp;left.&nbsp;Must&nbsp;go&nbsp;up&nbsp;before&nbsp;going&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326570">seps</span>&nbsp;<span class="op" id="3326575">:=</span>&nbsp;<span class="ident" id="3326578">strings</span><span class="op" id="3326585">.</span><span class="ident" id="3326586">Count</span><span class="op" id="3326591">(</span><span class="ident" id="3326592">base</span><span class="op" id="3326596">[</span><span class="ident" id="3326597">b0</span><span class="op" id="3326599">:</span><span class="ident" id="3326600">bl</span><span class="op" id="3326602">]</span><span class="op" id="3326603">,</span>&nbsp;<span class="builtintype" id="3326605">string</span><span class="op" id="3326611">(</span><span class="ident" id="3326612">Separator</span><span class="op" id="3326621">)</span><span class="op" id="3326622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326626">size</span>&nbsp;<span class="op" id="3326631">:=</span>&nbsp;<span class="num" id="3326634">2</span>&nbsp;<span class="op" id="3326636">+</span>&nbsp;<span class="ident" id="3326638">seps</span><span class="op" id="3326642">*</span><span class="num" id="3326643">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326647">if</span>&nbsp;<span class="ident" id="3326650">tl</span>&nbsp;<span class="op" id="3326653">!=</span>&nbsp;<span class="ident" id="3326656">t0</span>&nbsp;<span class="op" id="3326659">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326664">size</span>&nbsp;<span class="op" id="3326669">+=</span>&nbsp;<span class="num" id="3326672">1</span>&nbsp;<span class="op" id="3326674">+</span>&nbsp;<span class="ident" id="3326676">tl</span>&nbsp;<span class="op" id="3326679">-</span>&nbsp;<span class="ident" id="3326681">t0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326690">buf</span>&nbsp;<span class="op" id="3326694">:=</span>&nbsp;<span class="builtinfunc" id="3326697">make</span><span class="op" id="3326701">(</span><span class="op" id="3326702">[</span><span class="op" id="3326703">]</span><span class="builtintype" id="3326704">byte</span><span class="op" id="3326708">,</span>&nbsp;<span class="ident" id="3326710">size</span><span class="op" id="3326714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326718">n</span>&nbsp;<span class="op" id="3326720">:=</span>&nbsp;<span class="builtinfunc" id="3326723">copy</span><span class="op" id="3326727">(</span><span class="ident" id="3326728">buf</span><span class="op" id="3326731">,</span>&nbsp;<span class="string" id="3326733">&#34;..&#34;</span><span class="op" id="3326737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326741">for</span>&nbsp;<span class="ident" id="3326745">i</span>&nbsp;<span class="op" id="3326747">:=</span>&nbsp;<span class="num" id="3326750">0</span><span class="op" id="3326751">;</span>&nbsp;<span class="ident" id="3326753">i</span>&nbsp;<span class="op" id="3326755">&lt;</span>&nbsp;<span class="ident" id="3326757">seps</span><span class="op" id="3326761">;</span>&nbsp;<span class="ident" id="3326763">i</span><span class="op" id="3326764">++</span>&nbsp;<span class="op" id="3326767">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326772">buf</span><span class="op" id="3326775">[</span><span class="ident" id="3326776">n</span><span class="op" id="3326777">]</span>&nbsp;<span class="op" id="3326779">=</span>&nbsp;<span class="ident" id="3326781">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3326794">copy</span><span class="op" id="3326798">(</span><span class="ident" id="3326799">buf</span><span class="op" id="3326802">[</span><span class="ident" id="3326803">n</span><span class="op" id="3326804">+</span><span class="num" id="3326805">1</span><span class="op" id="3326806">:</span><span class="op" id="3326807">]</span><span class="op" id="3326808">,</span>&nbsp;<span class="string" id="3326810">&#34;..&#34;</span><span class="op" id="3326814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326819">n</span>&nbsp;<span class="op" id="3326821">+=</span>&nbsp;<span class="num" id="3326824">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326832">if</span>&nbsp;<span class="ident" id="3326835">t0</span>&nbsp;<span class="op" id="3326838">!=</span>&nbsp;<span class="ident" id="3326841">tl</span>&nbsp;<span class="op" id="3326844">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3326849">buf</span><span class="op" id="3326852">[</span><span class="ident" id="3326853">n</span><span class="op" id="3326854">]</span>&nbsp;<span class="op" id="3326856">=</span>&nbsp;<span class="ident" id="3326858">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3326871">copy</span><span class="op" id="3326875">(</span><span class="ident" id="3326876">buf</span><span class="op" id="3326879">[</span><span class="ident" id="3326880">n</span><span class="op" id="3326881">+</span><span class="num" id="3326882">1</span><span class="op" id="3326883">:</span><span class="op" id="3326884">]</span><span class="op" id="3326885">,</span>&nbsp;<span class="ident" id="3326887">targ</span><span class="op" id="3326891">[</span><span class="ident" id="3326892">t0</span><span class="op" id="3326894">:</span><span class="op" id="3326895">]</span><span class="op" id="3326896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326904">return</span>&nbsp;<span class="builtintype" id="3326911">string</span><span class="op" id="3326917">(</span><span class="ident" id="3326918">buf</span><span class="op" id="3326921">)</span><span class="op" id="3326922">,</span>&nbsp;<span class="builtintype" id="3326924">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3326929">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326932">return</span>&nbsp;<span class="ident" id="3326939">targ</span><span class="op" id="3326943">[</span><span class="ident" id="3326944">t0</span><span class="op" id="3326946">:</span><span class="op" id="3326947">]</span><span class="op" id="3326948">,</span>&nbsp;<span class="builtintype" id="3326950">nil</span><br>
<span class="lineno"></span><span class="op" id="3326954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3326957">//&nbsp;SkipDir&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;return&nbsp;value&nbsp;from&nbsp;WalkFuncs&nbsp;to&nbsp;indicate&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3327026">//&nbsp;the&nbsp;directory&nbsp;named&nbsp;in&nbsp;the&nbsp;call&nbsp;is&nbsp;to&nbsp;be&nbsp;skipped.&nbsp;It&nbsp;is&nbsp;not&nbsp;returned</span><br>
<span class="lineno">325</span><span class="comment" id="3327098">//&nbsp;as&nbsp;an&nbsp;error&nbsp;by&nbsp;any&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="3327130">var</span>&nbsp;<span class="ident" id="3327134">SkipDir</span>&nbsp;<span class="op" id="3327142">=</span>&nbsp;<span class="ident" id="3327144">errors</span><span class="op" id="3327150">.</span><span class="ident" id="3327151">New</span><span class="op" id="3327154">(</span><span class="string" id="3327155">&#34;skip&nbsp;this&nbsp;directory&#34;</span><span class="op" id="3327176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3327179">//&nbsp;WalkFunc&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;function&nbsp;called&nbsp;for&nbsp;each&nbsp;file&nbsp;or&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="3327253">//&nbsp;visited&nbsp;by&nbsp;Walk.&nbsp;The&nbsp;path&nbsp;argument&nbsp;contains&nbsp;the&nbsp;argument&nbsp;to&nbsp;Walk&nbsp;as&nbsp;a</span><br>
<span class="lineno">330</span><span class="comment" id="3327326">//&nbsp;prefix;&nbsp;that&nbsp;is,&nbsp;if&nbsp;Walk&nbsp;is&nbsp;called&nbsp;with&nbsp;&#34;dir&#34;,&nbsp;which&nbsp;is&nbsp;a&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="3327397">//&nbsp;containing&nbsp;the&nbsp;file&nbsp;&#34;a&#34;,&nbsp;the&nbsp;walk&nbsp;function&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment" id="3327472">//&nbsp;&#34;dir/a&#34;.&nbsp;The&nbsp;info&nbsp;argument&nbsp;is&nbsp;the&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;named&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3327541">//</span><br>
<span class="lineno"></span><span class="comment" id="3327544">//&nbsp;If&nbsp;there&nbsp;was&nbsp;a&nbsp;problem&nbsp;walking&nbsp;to&nbsp;the&nbsp;file&nbsp;or&nbsp;directory&nbsp;named&nbsp;by&nbsp;path,&nbsp;the</span><br>
<span class="lineno">335</span><span class="comment" id="3327622">//&nbsp;incoming&nbsp;error&nbsp;will&nbsp;describe&nbsp;the&nbsp;problem&nbsp;and&nbsp;the&nbsp;function&nbsp;can&nbsp;decide&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="3327698">//&nbsp;to&nbsp;handle&nbsp;that&nbsp;error&nbsp;(and&nbsp;Walk&nbsp;will&nbsp;not&nbsp;descend&nbsp;into&nbsp;that&nbsp;directory).&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="3327774">//&nbsp;an&nbsp;error&nbsp;is&nbsp;returned,&nbsp;processing&nbsp;stops.&nbsp;The&nbsp;sole&nbsp;exception&nbsp;is&nbsp;that&nbsp;if&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3327852">//&nbsp;is&nbsp;a&nbsp;directory&nbsp;and&nbsp;the&nbsp;function&nbsp;returns&nbsp;the&nbsp;special&nbsp;value&nbsp;SkipDir,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3327926">//&nbsp;contents&nbsp;of&nbsp;the&nbsp;directory&nbsp;are&nbsp;skipped&nbsp;and&nbsp;processing&nbsp;continues&nbsp;as&nbsp;usual&nbsp;on</span><br>
<span class="lineno">340</span><span class="comment" id="3328004">//&nbsp;the&nbsp;next&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="3328022">type</span>&nbsp;<span class="ident" id="3328027">WalkFunc</span>&nbsp;<span class="keyword" id="3328036">func</span><span class="op" id="3328040">(</span><span class="ident" id="3328041">path</span>&nbsp;<span class="builtintype" id="3328046">string</span><span class="op" id="3328052">,</span>&nbsp;<span class="ident" id="3328054">info</span>&nbsp;<span class="ident" id="3328059">os</span><span class="op" id="3328061">.</span><span class="ident" id="3328062">FileInfo</span><span class="op" id="3328070">,</span>&nbsp;<span class="ident" id="3328072">err</span>&nbsp;<span class="builtintype" id="3328076">error</span><span class="op" id="3328081">)</span>&nbsp;<span class="builtintype" id="3328083">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3328090">var</span>&nbsp;<span class="ident" id="3328094">lstat</span>&nbsp;<span class="op" id="3328100">=</span>&nbsp;<span class="ident" id="3328102">os</span><span class="op" id="3328104">.</span><span class="ident" id="3328105">Lstat</span>&nbsp;<span class="comment" id="3328111">//&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="3328127">//&nbsp;walk&nbsp;recursively&nbsp;descends&nbsp;path,&nbsp;calling&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="3328173">func</span>&nbsp;<span class="ident" id="3328178">walk</span><span class="op" id="3328182">(</span><span class="ident" id="3328183">path</span>&nbsp;<span class="builtintype" id="3328188">string</span><span class="op" id="3328194">,</span>&nbsp;<span class="ident" id="3328196">info</span>&nbsp;<span class="ident" id="3328201">os</span><span class="op" id="3328203">.</span><span class="ident" id="3328204">FileInfo</span><span class="op" id="3328212">,</span>&nbsp;<span class="ident" id="3328214">walkFn</span>&nbsp;<span class="ident" id="3328221">WalkFunc</span><span class="op" id="3328229">)</span>&nbsp;<span class="builtintype" id="3328231">error</span>&nbsp;<span class="op" id="3328237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3328240">err</span>&nbsp;<span class="op" id="3328244">:=</span>&nbsp;<span class="ident" id="3328247">walkFn</span><span class="op" id="3328253">(</span><span class="ident" id="3328254">path</span><span class="op" id="3328258">,</span>&nbsp;<span class="ident" id="3328260">info</span><span class="op" id="3328264">,</span>&nbsp;<span class="builtintype" id="3328266">nil</span><span class="op" id="3328269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328272">if</span>&nbsp;<span class="ident" id="3328275">err</span>&nbsp;<span class="op" id="3328279">!=</span>&nbsp;<span class="builtintype" id="3328282">nil</span>&nbsp;<span class="op" id="3328286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328290">if</span>&nbsp;<span class="ident" id="3328293">info</span><span class="op" id="3328297">.</span><span class="ident" id="3328298">IsDir</span><span class="op" id="3328303">(</span><span class="op" id="3328304">)</span>&nbsp;<span class="op" id="3328306">&amp;&amp;</span>&nbsp;<span class="ident" id="3328309">err</span>&nbsp;<span class="op" id="3328313">==</span>&nbsp;<span class="ident" id="3328316">SkipDir</span>&nbsp;<span class="op" id="3328324">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328329">return</span>&nbsp;<span class="builtintype" id="3328336">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328346">return</span>&nbsp;<span class="ident" id="3328353">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328362">if</span>&nbsp;<span class="op" id="3328365">!</span><span class="ident" id="3328366">info</span><span class="op" id="3328370">.</span><span class="ident" id="3328371">IsDir</span><span class="op" id="3328376">(</span><span class="op" id="3328377">)</span>&nbsp;<span class="op" id="3328379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328383">return</span>&nbsp;<span class="builtintype" id="3328390">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3328399">names</span><span class="op" id="3328404">,</span>&nbsp;<span class="ident" id="3328406">err</span>&nbsp;<span class="op" id="3328410">:=</span>&nbsp;<span class="ident" id="3328413">readDirNames</span><span class="op" id="3328425">(</span><span class="ident" id="3328426">path</span><span class="op" id="3328430">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328433">if</span>&nbsp;<span class="ident" id="3328436">err</span>&nbsp;<span class="op" id="3328440">!=</span>&nbsp;<span class="builtintype" id="3328443">nil</span>&nbsp;<span class="op" id="3328447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328451">return</span>&nbsp;<span class="ident" id="3328458">walkFn</span><span class="op" id="3328464">(</span><span class="ident" id="3328465">path</span><span class="op" id="3328469">,</span>&nbsp;<span class="ident" id="3328471">info</span><span class="op" id="3328475">,</span>&nbsp;<span class="ident" id="3328477">err</span><span class="op" id="3328480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328487">for</span>&nbsp;<span class="ident" id="3328491">_</span><span class="op" id="3328492">,</span>&nbsp;<span class="ident" id="3328494">name</span>&nbsp;<span class="op" id="3328499">:=</span>&nbsp;<span class="keyword" id="3328502">range</span>&nbsp;<span class="ident" id="3328508">names</span>&nbsp;<span class="op" id="3328514">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3328518">filename</span>&nbsp;<span class="op" id="3328527">:=</span>&nbsp;<span class="ident" id="3328530">Join</span><span class="op" id="3328534">(</span><span class="ident" id="3328535">path</span><span class="op" id="3328539">,</span>&nbsp;<span class="ident" id="3328541">name</span><span class="op" id="3328545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3328549">fileInfo</span><span class="op" id="3328557">,</span>&nbsp;<span class="ident" id="3328559">err</span>&nbsp;<span class="op" id="3328563">:=</span>&nbsp;<span class="ident" id="3328566">lstat</span><span class="op" id="3328571">(</span><span class="ident" id="3328572">filename</span><span class="op" id="3328580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328584">if</span>&nbsp;<span class="ident" id="3328587">err</span>&nbsp;<span class="op" id="3328591">!=</span>&nbsp;<span class="builtintype" id="3328594">nil</span>&nbsp;<span class="op" id="3328598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328603">if</span>&nbsp;<span class="ident" id="3328606">err</span>&nbsp;<span class="op" id="3328610">:=</span>&nbsp;<span class="ident" id="3328613">walkFn</span><span class="op" id="3328619">(</span><span class="ident" id="3328620">filename</span><span class="op" id="3328628">,</span>&nbsp;<span class="ident" id="3328630">fileInfo</span><span class="op" id="3328638">,</span>&nbsp;<span class="ident" id="3328640">err</span><span class="op" id="3328643">)</span><span class="op" id="3328644">;</span>&nbsp;<span class="ident" id="3328646">err</span>&nbsp;<span class="op" id="3328650">!=</span>&nbsp;<span class="builtintype" id="3328653">nil</span>&nbsp;<span class="op" id="3328657">&amp;&amp;</span>&nbsp;<span class="ident" id="3328660">err</span>&nbsp;<span class="op" id="3328664">!=</span>&nbsp;<span class="ident" id="3328667">SkipDir</span>&nbsp;<span class="op" id="3328675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328681">return</span>&nbsp;<span class="ident" id="3328688">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328699">}</span>&nbsp;<span class="keyword" id="3328701">else</span>&nbsp;<span class="op" id="3328706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3328711">err</span>&nbsp;<span class="op" id="3328715">=</span>&nbsp;<span class="ident" id="3328717">walk</span><span class="op" id="3328721">(</span><span class="ident" id="3328722">filename</span><span class="op" id="3328730">,</span>&nbsp;<span class="ident" id="3328732">fileInfo</span><span class="op" id="3328740">,</span>&nbsp;<span class="ident" id="3328742">walkFn</span><span class="op" id="3328748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328753">if</span>&nbsp;<span class="ident" id="3328756">err</span>&nbsp;<span class="op" id="3328760">!=</span>&nbsp;<span class="builtintype" id="3328763">nil</span>&nbsp;<span class="op" id="3328767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328773">if</span>&nbsp;<span class="op" id="3328776">!</span><span class="ident" id="3328777">fileInfo</span><span class="op" id="3328785">.</span><span class="ident" id="3328786">IsDir</span><span class="op" id="3328791">(</span><span class="op" id="3328792">)</span>&nbsp;<span class="op" id="3328794">||</span>&nbsp;<span class="ident" id="3328797">err</span>&nbsp;<span class="op" id="3328801">!=</span>&nbsp;<span class="ident" id="3328804">SkipDir</span>&nbsp;<span class="op" id="3328812">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328819">return</span>&nbsp;<span class="ident" id="3328826">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3328846">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3328849">return</span>&nbsp;<span class="builtintype" id="3328856">nil</span><br>
<span class="lineno"></span><span class="op" id="3328860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3328863">//&nbsp;Walk&nbsp;walks&nbsp;the&nbsp;file&nbsp;tree&nbsp;rooted&nbsp;at&nbsp;root,&nbsp;calling&nbsp;walkFn&nbsp;for&nbsp;each&nbsp;file&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3328939">//&nbsp;directory&nbsp;in&nbsp;the&nbsp;tree,&nbsp;including&nbsp;root.&nbsp;All&nbsp;errors&nbsp;that&nbsp;arise&nbsp;visiting&nbsp;files</span><br>
<span class="lineno">385</span><span class="comment" id="3329018">//&nbsp;and&nbsp;directories&nbsp;are&nbsp;filtered&nbsp;by&nbsp;walkFn.&nbsp;The&nbsp;files&nbsp;are&nbsp;walked&nbsp;in&nbsp;lexical</span><br>
<span class="lineno"></span><span class="comment" id="3329093">//&nbsp;order,&nbsp;which&nbsp;makes&nbsp;the&nbsp;output&nbsp;deterministic&nbsp;but&nbsp;means&nbsp;that&nbsp;for&nbsp;very</span><br>
<span class="lineno"></span><span class="comment" id="3329164">//&nbsp;large&nbsp;directories&nbsp;Walk&nbsp;can&nbsp;be&nbsp;inefficient.</span><br>
<span class="lineno"></span><span class="comment" id="3329210">//&nbsp;Walk&nbsp;does&nbsp;not&nbsp;follow&nbsp;symbolic&nbsp;links.</span><br>
<span class="lineno"></span><span class="keyword" id="3329250">func</span>&nbsp;<span class="ident" id="3329255">Walk</span><span class="op" id="3329259">(</span><span class="ident" id="3329260">root</span>&nbsp;<span class="builtintype" id="3329265">string</span><span class="op" id="3329271">,</span>&nbsp;<span class="ident" id="3329273">walkFn</span>&nbsp;<span class="ident" id="3329280">WalkFunc</span><span class="op" id="3329288">)</span>&nbsp;<span class="builtintype" id="3329290">error</span>&nbsp;<span class="op" id="3329296">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329299">info</span><span class="op" id="3329303">,</span>&nbsp;<span class="ident" id="3329305">err</span>&nbsp;<span class="op" id="3329309">:=</span>&nbsp;<span class="ident" id="3329312">os</span><span class="op" id="3329314">.</span><span class="ident" id="3329315">Lstat</span><span class="op" id="3329320">(</span><span class="ident" id="3329321">root</span><span class="op" id="3329325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329328">if</span>&nbsp;<span class="ident" id="3329331">err</span>&nbsp;<span class="op" id="3329335">!=</span>&nbsp;<span class="builtintype" id="3329338">nil</span>&nbsp;<span class="op" id="3329342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329346">return</span>&nbsp;<span class="ident" id="3329353">walkFn</span><span class="op" id="3329359">(</span><span class="ident" id="3329360">root</span><span class="op" id="3329364">,</span>&nbsp;<span class="builtintype" id="3329366">nil</span><span class="op" id="3329369">,</span>&nbsp;<span class="ident" id="3329371">err</span><span class="op" id="3329374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3329377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329380">return</span>&nbsp;<span class="ident" id="3329387">walk</span><span class="op" id="3329391">(</span><span class="ident" id="3329392">root</span><span class="op" id="3329396">,</span>&nbsp;<span class="ident" id="3329398">info</span><span class="op" id="3329402">,</span>&nbsp;<span class="ident" id="3329404">walkFn</span><span class="op" id="3329410">)</span><br>
<span class="lineno">395</span><span class="op" id="3329412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3329415">//&nbsp;readDirNames&nbsp;reads&nbsp;the&nbsp;directory&nbsp;named&nbsp;by&nbsp;dirname&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3329480">//&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;directory&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="3329519">func</span>&nbsp;<span class="ident" id="3329524">readDirNames</span><span class="op" id="3329536">(</span><span class="ident" id="3329537">dirname</span>&nbsp;<span class="builtintype" id="3329545">string</span><span class="op" id="3329551">)</span>&nbsp;<span class="op" id="3329553">(</span><span class="op" id="3329554">[</span><span class="op" id="3329555">]</span><span class="builtintype" id="3329556">string</span><span class="op" id="3329562">,</span>&nbsp;<span class="builtintype" id="3329564">error</span><span class="op" id="3329569">)</span>&nbsp;<span class="op" id="3329571">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329574">f</span><span class="op" id="3329575">,</span>&nbsp;<span class="ident" id="3329577">err</span>&nbsp;<span class="op" id="3329581">:=</span>&nbsp;<span class="ident" id="3329584">os</span><span class="op" id="3329586">.</span><span class="ident" id="3329587">Open</span><span class="op" id="3329591">(</span><span class="ident" id="3329592">dirname</span><span class="op" id="3329599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329602">if</span>&nbsp;<span class="ident" id="3329605">err</span>&nbsp;<span class="op" id="3329609">!=</span>&nbsp;<span class="builtintype" id="3329612">nil</span>&nbsp;<span class="op" id="3329616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329620">return</span>&nbsp;<span class="builtintype" id="3329627">nil</span><span class="op" id="3329630">,</span>&nbsp;<span class="ident" id="3329632">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3329637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329640">names</span><span class="op" id="3329645">,</span>&nbsp;<span class="ident" id="3329647">err</span>&nbsp;<span class="op" id="3329651">:=</span>&nbsp;<span class="ident" id="3329654">f</span><span class="op" id="3329655">.</span><span class="ident" id="3329656">Readdirnames</span><span class="op" id="3329668">(</span><span class="op" id="3329669">-</span><span class="num" id="3329670">1</span><span class="op" id="3329671">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329674">f</span><span class="op" id="3329675">.</span><span class="ident" id="3329676">Close</span><span class="op" id="3329681">(</span><span class="op" id="3329682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329685">if</span>&nbsp;<span class="ident" id="3329688">err</span>&nbsp;<span class="op" id="3329692">!=</span>&nbsp;<span class="builtintype" id="3329695">nil</span>&nbsp;<span class="op" id="3329699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329703">return</span>&nbsp;<span class="builtintype" id="3329710">nil</span><span class="op" id="3329713">,</span>&nbsp;<span class="ident" id="3329715">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3329720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329723">sort</span><span class="op" id="3329727">.</span><span class="ident" id="3329728">Strings</span><span class="op" id="3329735">(</span><span class="ident" id="3329736">names</span><span class="op" id="3329741">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3329744">return</span>&nbsp;<span class="ident" id="3329751">names</span><span class="op" id="3329756">,</span>&nbsp;<span class="builtintype" id="3329758">nil</span><br>
<span class="lineno"></span><span class="op" id="3329762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3329765">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3329807">//&nbsp;Trailing&nbsp;path&nbsp;separators&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno">415</span><span class="comment" id="3329883">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3329926">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Base&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="keyword" id="3330007">func</span>&nbsp;<span class="ident" id="3330012">Base</span><span class="op" id="3330016">(</span><span class="ident" id="3330017">path</span>&nbsp;<span class="builtintype" id="3330022">string</span><span class="op" id="3330028">)</span>&nbsp;<span class="builtintype" id="3330030">string</span>&nbsp;<span class="op" id="3330037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330040">if</span>&nbsp;<span class="ident" id="3330043">path</span>&nbsp;<span class="op" id="3330048">==</span>&nbsp;<span class="string" id="3330051">&#34;&#34;</span>&nbsp;<span class="op" id="3330054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330058">return</span>&nbsp;<span class="string" id="3330065">&#34;.&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3330073">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330101">for</span>&nbsp;<span class="builtinfunc" id="3330105">len</span><span class="op" id="3330108">(</span><span class="ident" id="3330109">path</span><span class="op" id="3330113">)</span>&nbsp;<span class="op" id="3330115">&gt;</span>&nbsp;<span class="num" id="3330117">0</span>&nbsp;<span class="op" id="3330119">&amp;&amp;</span>&nbsp;<span class="ident" id="3330122">os</span><span class="op" id="3330124">.</span><span class="ident" id="3330125">IsPathSeparator</span><span class="op" id="3330140">(</span><span class="ident" id="3330141">path</span><span class="op" id="3330145">[</span><span class="builtinfunc" id="3330146">len</span><span class="op" id="3330149">(</span><span class="ident" id="3330150">path</span><span class="op" id="3330154">)</span><span class="op" id="3330155">-</span><span class="num" id="3330156">1</span><span class="op" id="3330157">]</span><span class="op" id="3330158">)</span>&nbsp;<span class="op" id="3330160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330164">path</span>&nbsp;<span class="op" id="3330169">=</span>&nbsp;<span class="ident" id="3330171">path</span><span class="op" id="3330175">[</span><span class="num" id="3330176">0</span>&nbsp;<span class="op" id="3330178">:</span>&nbsp;<span class="builtinfunc" id="3330180">len</span><span class="op" id="3330183">(</span><span class="ident" id="3330184">path</span><span class="op" id="3330188">)</span><span class="op" id="3330189">-</span><span class="num" id="3330190">1</span><span class="op" id="3330191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330194">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3330197">//&nbsp;Throw&nbsp;away&nbsp;volume&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330224">path</span>&nbsp;<span class="op" id="3330229">=</span>&nbsp;<span class="ident" id="3330231">path</span><span class="op" id="3330235">[</span><span class="builtinfunc" id="3330236">len</span><span class="op" id="3330239">(</span><span class="ident" id="3330240">VolumeName</span><span class="op" id="3330250">(</span><span class="ident" id="3330251">path</span><span class="op" id="3330255">)</span><span class="op" id="3330256">)</span><span class="op" id="3330257">:</span><span class="op" id="3330258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3330261">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330287">i</span>&nbsp;<span class="op" id="3330289">:=</span>&nbsp;<span class="builtinfunc" id="3330292">len</span><span class="op" id="3330295">(</span><span class="ident" id="3330296">path</span><span class="op" id="3330300">)</span>&nbsp;<span class="op" id="3330302">-</span>&nbsp;<span class="num" id="3330304">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330307">for</span>&nbsp;<span class="ident" id="3330311">i</span>&nbsp;<span class="op" id="3330313">&gt;=</span>&nbsp;<span class="num" id="3330316">0</span>&nbsp;<span class="op" id="3330318">&amp;&amp;</span>&nbsp;<span class="op" id="3330321">!</span><span class="ident" id="3330322">os</span><span class="op" id="3330324">.</span><span class="ident" id="3330325">IsPathSeparator</span><span class="op" id="3330340">(</span><span class="ident" id="3330341">path</span><span class="op" id="3330345">[</span><span class="ident" id="3330346">i</span><span class="op" id="3330347">]</span><span class="op" id="3330348">)</span>&nbsp;<span class="op" id="3330350">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330354">i</span><span class="op" id="3330355">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330362">if</span>&nbsp;<span class="ident" id="3330365">i</span>&nbsp;<span class="op" id="3330367">&gt;=</span>&nbsp;<span class="num" id="3330370">0</span>&nbsp;<span class="op" id="3330372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330376">path</span>&nbsp;<span class="op" id="3330381">=</span>&nbsp;<span class="ident" id="3330383">path</span><span class="op" id="3330387">[</span><span class="ident" id="3330388">i</span><span class="op" id="3330389">+</span><span class="num" id="3330390">1</span><span class="op" id="3330391">:</span><span class="op" id="3330392">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330395">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3330398">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330437">if</span>&nbsp;<span class="ident" id="3330440">path</span>&nbsp;<span class="op" id="3330445">==</span>&nbsp;<span class="string" id="3330448">&#34;&#34;</span>&nbsp;<span class="op" id="3330451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330455">return</span>&nbsp;<span class="builtintype" id="3330462">string</span><span class="op" id="3330468">(</span><span class="ident" id="3330469">Separator</span><span class="op" id="3330478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3330481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330484">return</span>&nbsp;<span class="ident" id="3330491">path</span><br>
<span class="lineno">440</span><span class="op" id="3330496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3330499">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3330580">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3330650">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno">445</span><span class="comment" id="3330674">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3330716">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Dir&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="comment" id="3330796">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a&nbsp;separator&nbsp;unless&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="3330878">func</span>&nbsp;<span class="ident" id="3330883">Dir</span><span class="op" id="3330886">(</span><span class="ident" id="3330887">path</span>&nbsp;<span class="builtintype" id="3330892">string</span><span class="op" id="3330898">)</span>&nbsp;<span class="builtintype" id="3330900">string</span>&nbsp;<span class="op" id="3330907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330910">vol</span>&nbsp;<span class="op" id="3330914">:=</span>&nbsp;<span class="ident" id="3330917">VolumeName</span><span class="op" id="3330927">(</span><span class="ident" id="3330928">path</span><span class="op" id="3330932">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3330935">i</span>&nbsp;<span class="op" id="3330937">:=</span>&nbsp;<span class="builtinfunc" id="3330940">len</span><span class="op" id="3330943">(</span><span class="ident" id="3330944">path</span><span class="op" id="3330948">)</span>&nbsp;<span class="op" id="3330950">-</span>&nbsp;<span class="num" id="3330952">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3330955">for</span>&nbsp;<span class="ident" id="3330959">i</span>&nbsp;<span class="op" id="3330961">&gt;=</span>&nbsp;<span class="builtinfunc" id="3330964">len</span><span class="op" id="3330967">(</span><span class="ident" id="3330968">vol</span><span class="op" id="3330971">)</span>&nbsp;<span class="op" id="3330973">&amp;&amp;</span>&nbsp;<span class="op" id="3330976">!</span><span class="ident" id="3330977">os</span><span class="op" id="3330979">.</span><span class="ident" id="3330980">IsPathSeparator</span><span class="op" id="3330995">(</span><span class="ident" id="3330996">path</span><span class="op" id="3331000">[</span><span class="ident" id="3331001">i</span><span class="op" id="3331002">]</span><span class="op" id="3331003">)</span>&nbsp;<span class="op" id="3331005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3331009">i</span><span class="op" id="3331010">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3331014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3331017">dir</span>&nbsp;<span class="op" id="3331021">:=</span>&nbsp;<span class="ident" id="3331024">Clean</span><span class="op" id="3331029">(</span><span class="ident" id="3331030">path</span><span class="op" id="3331034">[</span><span class="builtinfunc" id="3331035">len</span><span class="op" id="3331038">(</span><span class="ident" id="3331039">vol</span><span class="op" id="3331042">)</span>&nbsp;<span class="op" id="3331044">:</span>&nbsp;<span class="ident" id="3331046">i</span><span class="op" id="3331047">+</span><span class="num" id="3331048">1</span><span class="op" id="3331049">]</span><span class="op" id="3331050">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3331053">return</span>&nbsp;<span class="ident" id="3331060">vol</span>&nbsp;<span class="op" id="3331064">+</span>&nbsp;<span class="ident" id="3331066">dir</span><br>
<span class="lineno"></span><span class="op" id="3331070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3331073">//&nbsp;VolumeName&nbsp;returns&nbsp;leading&nbsp;volume&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3331116">//&nbsp;Given&nbsp;&#34;C:\foo\bar&#34;&nbsp;it&nbsp;returns&nbsp;&#34;C:&#34;&nbsp;under&nbsp;windows.</span><br>
<span class="lineno">460</span><span class="comment" id="3331169">//&nbsp;Given&nbsp;&#34;\\host\share\foo&#34;&nbsp;it&nbsp;returns&nbsp;&#34;\\host\share&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3331224">//&nbsp;On&nbsp;other&nbsp;platforms&nbsp;it&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3331261">func</span>&nbsp;<span class="ident" id="3331266">VolumeName</span><span class="op" id="3331276">(</span><span class="ident" id="3331277">path</span>&nbsp;<span class="builtintype" id="3331282">string</span><span class="op" id="3331288">)</span>&nbsp;<span class="op" id="3331290">(</span><span class="ident" id="3331291">v</span>&nbsp;<span class="builtintype" id="3331293">string</span><span class="op" id="3331299">)</span>&nbsp;<span class="op" id="3331301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3331304">return</span>&nbsp;<span class="ident" id="3331311">path</span><span class="op" id="3331315">[</span><span class="op" id="3331316">:</span><span class="ident" id="3331317">volumeNameLen</span><span class="op" id="3331330">(</span><span class="ident" id="3331331">path</span><span class="op" id="3331335">)</span><span class="op" id="3331336">]</span><br>
<span class="lineno"></span><span class="op" id="3331338">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
