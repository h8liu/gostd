<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3614113">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3614168">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3614222">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3614273">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614346">package</span>&nbsp;<span class="ident" id="3614354">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614359">import</span>&nbsp;<span class="op" id="3614366">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3614369">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3614377">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3614388">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3614395">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3614398">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="3614476">func</span>&nbsp;<span class="ident" id="3614481">runtimeNano</span><span class="op" id="3614492">(</span><span class="op" id="3614493">)</span>&nbsp;<span class="ident" id="3614495">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614502">func</span>&nbsp;<span class="ident" id="3614507">runtime_pollServerInit</span><span class="op" id="3614529">(</span><span class="op" id="3614530">)</span><br>
<span class="lineno"></span><span class="keyword" id="3614532">func</span>&nbsp;<span class="ident" id="3614537">runtime_pollOpen</span><span class="op" id="3614553">(</span><span class="ident" id="3614554">fd</span>&nbsp;<span class="builtintype" id="3614557">uintptr</span><span class="op" id="3614564">)</span>&nbsp;<span class="op" id="3614566">(</span><span class="builtintype" id="3614567">uintptr</span><span class="op" id="3614574">,</span>&nbsp;<span class="builtintype" id="3614576">int</span><span class="op" id="3614579">)</span><br>
<span class="lineno">20</span><span class="keyword" id="3614581">func</span>&nbsp;<span class="ident" id="3614586">runtime_pollClose</span><span class="op" id="3614603">(</span><span class="ident" id="3614604">ctx</span>&nbsp;<span class="builtintype" id="3614608">uintptr</span><span class="op" id="3614615">)</span><br>
<span class="lineno"></span><span class="keyword" id="3614617">func</span>&nbsp;<span class="ident" id="3614622">runtime_pollWait</span><span class="op" id="3614638">(</span><span class="ident" id="3614639">ctx</span>&nbsp;<span class="builtintype" id="3614643">uintptr</span><span class="op" id="3614650">,</span>&nbsp;<span class="ident" id="3614652">mode</span>&nbsp;<span class="builtintype" id="3614657">int</span><span class="op" id="3614660">)</span>&nbsp;<span class="builtintype" id="3614662">int</span><br>
<span class="lineno"></span><span class="keyword" id="3614666">func</span>&nbsp;<span class="ident" id="3614671">runtime_pollWaitCanceled</span><span class="op" id="3614695">(</span><span class="ident" id="3614696">ctx</span>&nbsp;<span class="builtintype" id="3614700">uintptr</span><span class="op" id="3614707">,</span>&nbsp;<span class="ident" id="3614709">mode</span>&nbsp;<span class="builtintype" id="3614714">int</span><span class="op" id="3614717">)</span>&nbsp;<span class="builtintype" id="3614719">int</span><br>
<span class="lineno"></span><span class="keyword" id="3614723">func</span>&nbsp;<span class="ident" id="3614728">runtime_pollReset</span><span class="op" id="3614745">(</span><span class="ident" id="3614746">ctx</span>&nbsp;<span class="builtintype" id="3614750">uintptr</span><span class="op" id="3614757">,</span>&nbsp;<span class="ident" id="3614759">mode</span>&nbsp;<span class="builtintype" id="3614764">int</span><span class="op" id="3614767">)</span>&nbsp;<span class="builtintype" id="3614769">int</span><br>
<span class="lineno"></span><span class="keyword" id="3614773">func</span>&nbsp;<span class="ident" id="3614778">runtime_pollSetDeadline</span><span class="op" id="3614801">(</span><span class="ident" id="3614802">ctx</span>&nbsp;<span class="builtintype" id="3614806">uintptr</span><span class="op" id="3614813">,</span>&nbsp;<span class="ident" id="3614815">d</span>&nbsp;<span class="ident" id="3614817">int64</span><span class="op" id="3614822">,</span>&nbsp;<span class="ident" id="3614824">mode</span>&nbsp;<span class="builtintype" id="3614829">int</span><span class="op" id="3614832">)</span><br>
<span class="lineno">25</span><span class="keyword" id="3614834">func</span>&nbsp;<span class="ident" id="3614839">runtime_pollUnblock</span><span class="op" id="3614858">(</span><span class="ident" id="3614859">ctx</span>&nbsp;<span class="builtintype" id="3614863">uintptr</span><span class="op" id="3614870">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614873">type</span>&nbsp;<span class="ident" id="3614878">pollDesc</span>&nbsp;<span class="keyword" id="3614887">struct</span>&nbsp;<span class="op" id="3614894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614897">runtimeCtx</span>&nbsp;<span class="builtintype" id="3614908">uintptr</span><br>
<span class="lineno"></span><span class="op" id="3614916">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3614919">var</span>&nbsp;<span class="ident" id="3614923">serverInit</span>&nbsp;<span class="ident" id="3614934">sync</span><span class="op" id="3614938">.</span><span class="ident" id="3614939">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614945">func</span>&nbsp;<span class="op" id="3614950">(</span><span class="ident" id="3614951">pd</span>&nbsp;<span class="op" id="3614954">*</span><span class="ident" id="3614955">pollDesc</span><span class="op" id="3614963">)</span>&nbsp;<span class="ident" id="3614965">Init</span><span class="op" id="3614969">(</span><span class="ident" id="3614970">fd</span>&nbsp;<span class="op" id="3614973">*</span><span class="ident" id="3614974">netFD</span><span class="op" id="3614979">)</span>&nbsp;<span class="builtintype" id="3614981">error</span>&nbsp;<span class="op" id="3614987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3614990">serverInit</span><span class="op" id="3615000">.</span><span class="ident" id="3615001">Do</span><span class="op" id="3615003">(</span><span class="ident" id="3615004">runtime_pollServerInit</span><span class="op" id="3615026">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615029">ctx</span><span class="op" id="3615032">,</span>&nbsp;<span class="ident" id="3615034">errno</span>&nbsp;<span class="op" id="3615040">:=</span>&nbsp;<span class="ident" id="3615043">runtime_pollOpen</span><span class="op" id="3615059">(</span><span class="builtintype" id="3615060">uintptr</span><span class="op" id="3615067">(</span><span class="ident" id="3615068">fd</span><span class="op" id="3615070">.</span><span class="ident" id="3615071">sysfd</span><span class="op" id="3615076">)</span><span class="op" id="3615077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615080">if</span>&nbsp;<span class="ident" id="3615083">errno</span>&nbsp;<span class="op" id="3615089">!=</span>&nbsp;<span class="num" id="3615092">0</span>&nbsp;<span class="op" id="3615094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615098">return</span>&nbsp;<span class="ident" id="3615105">syscall</span><span class="op" id="3615112">.</span><span class="ident" id="3615113">Errno</span><span class="op" id="3615118">(</span><span class="ident" id="3615119">errno</span><span class="op" id="3615124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615130">pd</span><span class="op" id="3615132">.</span><span class="ident" id="3615133">runtimeCtx</span>&nbsp;<span class="op" id="3615144">=</span>&nbsp;<span class="ident" id="3615146">ctx</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615151">return</span>&nbsp;<span class="ident" id="3615158">nil</span><br>
<span class="lineno"></span><span class="op" id="3615162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615165">func</span>&nbsp;<span class="op" id="3615170">(</span><span class="ident" id="3615171">pd</span>&nbsp;<span class="op" id="3615174">*</span><span class="ident" id="3615175">pollDesc</span><span class="op" id="3615183">)</span>&nbsp;<span class="ident" id="3615185">Close</span><span class="op" id="3615190">(</span><span class="op" id="3615191">)</span>&nbsp;<span class="op" id="3615193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615196">if</span>&nbsp;<span class="ident" id="3615199">pd</span><span class="op" id="3615201">.</span><span class="ident" id="3615202">runtimeCtx</span>&nbsp;<span class="op" id="3615213">==</span>&nbsp;<span class="num" id="3615216">0</span>&nbsp;<span class="op" id="3615218">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615222">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615233">runtime_pollClose</span><span class="op" id="3615250">(</span><span class="ident" id="3615251">pd</span><span class="op" id="3615253">.</span><span class="ident" id="3615254">runtimeCtx</span><span class="op" id="3615264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615267">pd</span><span class="op" id="3615269">.</span><span class="ident" id="3615270">runtimeCtx</span>&nbsp;<span class="op" id="3615281">=</span>&nbsp;<span class="num" id="3615283">0</span><br>
<span class="lineno"></span><span class="op" id="3615285">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3615288">func</span>&nbsp;<span class="op" id="3615293">(</span><span class="ident" id="3615294">pd</span>&nbsp;<span class="op" id="3615297">*</span><span class="ident" id="3615298">pollDesc</span><span class="op" id="3615306">)</span>&nbsp;<span class="ident" id="3615308">Lock</span><span class="op" id="3615312">(</span><span class="op" id="3615313">)</span>&nbsp;<span class="op" id="3615315">{</span><br>
<span class="lineno"></span><span class="op" id="3615317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615320">func</span>&nbsp;<span class="op" id="3615325">(</span><span class="ident" id="3615326">pd</span>&nbsp;<span class="op" id="3615329">*</span><span class="ident" id="3615330">pollDesc</span><span class="op" id="3615338">)</span>&nbsp;<span class="ident" id="3615340">Unlock</span><span class="op" id="3615346">(</span><span class="op" id="3615347">)</span>&nbsp;<span class="op" id="3615349">{</span><br>
<span class="lineno">55</span><span class="op" id="3615351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615354">func</span>&nbsp;<span class="op" id="3615359">(</span><span class="ident" id="3615360">pd</span>&nbsp;<span class="op" id="3615363">*</span><span class="ident" id="3615364">pollDesc</span><span class="op" id="3615372">)</span>&nbsp;<span class="ident" id="3615374">Wakeup</span><span class="op" id="3615380">(</span><span class="op" id="3615381">)</span>&nbsp;<span class="op" id="3615383">{</span><br>
<span class="lineno"></span><span class="op" id="3615385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3615388">//&nbsp;Evict&nbsp;evicts&nbsp;fd&nbsp;from&nbsp;the&nbsp;pending&nbsp;list,&nbsp;unblocking&nbsp;any&nbsp;I/O&nbsp;running&nbsp;on&nbsp;fd.</span><br>
<span class="lineno"></span><span class="comment" id="3615464">//&nbsp;Return&nbsp;value&nbsp;is&nbsp;whether&nbsp;the&nbsp;pollServer&nbsp;should&nbsp;be&nbsp;woken&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="3615526">func</span>&nbsp;<span class="op" id="3615531">(</span><span class="ident" id="3615532">pd</span>&nbsp;<span class="op" id="3615535">*</span><span class="ident" id="3615536">pollDesc</span><span class="op" id="3615544">)</span>&nbsp;<span class="ident" id="3615546">Evict</span><span class="op" id="3615551">(</span><span class="op" id="3615552">)</span>&nbsp;<span class="builtintype" id="3615554">bool</span>&nbsp;<span class="op" id="3615559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615562">if</span>&nbsp;<span class="ident" id="3615565">pd</span><span class="op" id="3615567">.</span><span class="ident" id="3615568">runtimeCtx</span>&nbsp;<span class="op" id="3615579">==</span>&nbsp;<span class="num" id="3615582">0</span>&nbsp;<span class="op" id="3615584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615588">return</span>&nbsp;<span class="builtintype" id="3615595">false</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3615602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615605">runtime_pollUnblock</span><span class="op" id="3615624">(</span><span class="ident" id="3615625">pd</span><span class="op" id="3615627">.</span><span class="ident" id="3615628">runtimeCtx</span><span class="op" id="3615638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615641">return</span>&nbsp;<span class="builtintype" id="3615648">false</span><br>
<span class="lineno"></span><span class="op" id="3615654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3615657">func</span>&nbsp;<span class="op" id="3615662">(</span><span class="ident" id="3615663">pd</span>&nbsp;<span class="op" id="3615666">*</span><span class="ident" id="3615667">pollDesc</span><span class="op" id="3615675">)</span>&nbsp;<span class="ident" id="3615677">Prepare</span><span class="op" id="3615684">(</span><span class="ident" id="3615685">mode</span>&nbsp;<span class="builtintype" id="3615690">int</span><span class="op" id="3615693">)</span>&nbsp;<span class="builtintype" id="3615695">error</span>&nbsp;<span class="op" id="3615701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615704">res</span>&nbsp;<span class="op" id="3615708">:=</span>&nbsp;<span class="ident" id="3615711">runtime_pollReset</span><span class="op" id="3615728">(</span><span class="ident" id="3615729">pd</span><span class="op" id="3615731">.</span><span class="ident" id="3615732">runtimeCtx</span><span class="op" id="3615742">,</span>&nbsp;<span class="ident" id="3615744">mode</span><span class="op" id="3615748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615751">return</span>&nbsp;<span class="ident" id="3615758">convertErr</span><span class="op" id="3615768">(</span><span class="ident" id="3615769">res</span><span class="op" id="3615772">)</span><br>
<span class="lineno"></span><span class="op" id="3615774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="3615777">func</span>&nbsp;<span class="op" id="3615782">(</span><span class="ident" id="3615783">pd</span>&nbsp;<span class="op" id="3615786">*</span><span class="ident" id="3615787">pollDesc</span><span class="op" id="3615795">)</span>&nbsp;<span class="ident" id="3615797">PrepareRead</span><span class="op" id="3615808">(</span><span class="op" id="3615809">)</span>&nbsp;<span class="builtintype" id="3615811">error</span>&nbsp;<span class="op" id="3615817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615820">return</span>&nbsp;<span class="ident" id="3615827">pd</span><span class="op" id="3615829">.</span><span class="ident" id="3615830">Prepare</span><span class="op" id="3615837">(</span><span class="string" id="3615838">&#39;r&#39;</span><span class="op" id="3615841">)</span><br>
<span class="lineno"></span><span class="op" id="3615843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615846">func</span>&nbsp;<span class="op" id="3615851">(</span><span class="ident" id="3615852">pd</span>&nbsp;<span class="op" id="3615855">*</span><span class="ident" id="3615856">pollDesc</span><span class="op" id="3615864">)</span>&nbsp;<span class="ident" id="3615866">PrepareWrite</span><span class="op" id="3615878">(</span><span class="op" id="3615879">)</span>&nbsp;<span class="builtintype" id="3615881">error</span>&nbsp;<span class="op" id="3615887">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3615890">return</span>&nbsp;<span class="ident" id="3615897">pd</span><span class="op" id="3615899">.</span><span class="ident" id="3615900">Prepare</span><span class="op" id="3615907">(</span><span class="string" id="3615908">&#39;w&#39;</span><span class="op" id="3615911">)</span><br>
<span class="lineno"></span><span class="op" id="3615913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3615916">func</span>&nbsp;<span class="op" id="3615921">(</span><span class="ident" id="3615922">pd</span>&nbsp;<span class="op" id="3615925">*</span><span class="ident" id="3615926">pollDesc</span><span class="op" id="3615934">)</span>&nbsp;<span class="ident" id="3615936">Wait</span><span class="op" id="3615940">(</span><span class="ident" id="3615941">mode</span>&nbsp;<span class="builtintype" id="3615946">int</span><span class="op" id="3615949">)</span>&nbsp;<span class="builtintype" id="3615951">error</span>&nbsp;<span class="op" id="3615957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3615960">res</span>&nbsp;<span class="op" id="3615964">:=</span>&nbsp;<span class="ident" id="3615967">runtime_pollWait</span><span class="op" id="3615983">(</span><span class="ident" id="3615984">pd</span><span class="op" id="3615986">.</span><span class="ident" id="3615987">runtimeCtx</span><span class="op" id="3615997">,</span>&nbsp;<span class="ident" id="3615999">mode</span><span class="op" id="3616003">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616006">return</span>&nbsp;<span class="ident" id="3616013">convertErr</span><span class="op" id="3616023">(</span><span class="ident" id="3616024">res</span><span class="op" id="3616027">)</span><br>
<span class="lineno"></span><span class="op" id="3616029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616032">func</span>&nbsp;<span class="op" id="3616037">(</span><span class="ident" id="3616038">pd</span>&nbsp;<span class="op" id="3616041">*</span><span class="ident" id="3616042">pollDesc</span><span class="op" id="3616050">)</span>&nbsp;<span class="ident" id="3616052">WaitRead</span><span class="op" id="3616060">(</span><span class="op" id="3616061">)</span>&nbsp;<span class="builtintype" id="3616063">error</span>&nbsp;<span class="op" id="3616069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616072">return</span>&nbsp;<span class="ident" id="3616079">pd</span><span class="op" id="3616081">.</span><span class="ident" id="3616082">Wait</span><span class="op" id="3616086">(</span><span class="string" id="3616087">&#39;r&#39;</span><span class="op" id="3616090">)</span><br>
<span class="lineno">90</span><span class="op" id="3616092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616095">func</span>&nbsp;<span class="op" id="3616100">(</span><span class="ident" id="3616101">pd</span>&nbsp;<span class="op" id="3616104">*</span><span class="ident" id="3616105">pollDesc</span><span class="op" id="3616113">)</span>&nbsp;<span class="ident" id="3616115">WaitWrite</span><span class="op" id="3616124">(</span><span class="op" id="3616125">)</span>&nbsp;<span class="builtintype" id="3616127">error</span>&nbsp;<span class="op" id="3616133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616136">return</span>&nbsp;<span class="ident" id="3616143">pd</span><span class="op" id="3616145">.</span><span class="ident" id="3616146">Wait</span><span class="op" id="3616150">(</span><span class="string" id="3616151">&#39;w&#39;</span><span class="op" id="3616154">)</span><br>
<span class="lineno"></span><span class="op" id="3616156">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3616159">func</span>&nbsp;<span class="op" id="3616164">(</span><span class="ident" id="3616165">pd</span>&nbsp;<span class="op" id="3616168">*</span><span class="ident" id="3616169">pollDesc</span><span class="op" id="3616177">)</span>&nbsp;<span class="ident" id="3616179">WaitCanceled</span><span class="op" id="3616191">(</span><span class="ident" id="3616192">mode</span>&nbsp;<span class="builtintype" id="3616197">int</span><span class="op" id="3616200">)</span>&nbsp;<span class="op" id="3616202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616205">runtime_pollWaitCanceled</span><span class="op" id="3616229">(</span><span class="ident" id="3616230">pd</span><span class="op" id="3616232">.</span><span class="ident" id="3616233">runtimeCtx</span><span class="op" id="3616243">,</span>&nbsp;<span class="ident" id="3616245">mode</span><span class="op" id="3616249">)</span><br>
<span class="lineno"></span><span class="op" id="3616251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3616254">func</span>&nbsp;<span class="op" id="3616259">(</span><span class="ident" id="3616260">pd</span>&nbsp;<span class="op" id="3616263">*</span><span class="ident" id="3616264">pollDesc</span><span class="op" id="3616272">)</span>&nbsp;<span class="ident" id="3616274">WaitCanceledRead</span><span class="op" id="3616290">(</span><span class="op" id="3616291">)</span>&nbsp;<span class="op" id="3616293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616296">pd</span><span class="op" id="3616298">.</span><span class="ident" id="3616299">WaitCanceled</span><span class="op" id="3616311">(</span><span class="string" id="3616312">&#39;r&#39;</span><span class="op" id="3616315">)</span><br>
<span class="lineno"></span><span class="op" id="3616317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616320">func</span>&nbsp;<span class="op" id="3616325">(</span><span class="ident" id="3616326">pd</span>&nbsp;<span class="op" id="3616329">*</span><span class="ident" id="3616330">pollDesc</span><span class="op" id="3616338">)</span>&nbsp;<span class="ident" id="3616340">WaitCanceledWrite</span><span class="op" id="3616357">(</span><span class="op" id="3616358">)</span>&nbsp;<span class="op" id="3616360">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616363">pd</span><span class="op" id="3616365">.</span><span class="ident" id="3616366">WaitCanceled</span><span class="op" id="3616378">(</span><span class="string" id="3616379">&#39;w&#39;</span><span class="op" id="3616382">)</span><br>
<span class="lineno"></span><span class="op" id="3616384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616387">func</span>&nbsp;<span class="ident" id="3616392">convertErr</span><span class="op" id="3616402">(</span><span class="ident" id="3616403">res</span>&nbsp;<span class="builtintype" id="3616407">int</span><span class="op" id="3616410">)</span>&nbsp;<span class="builtintype" id="3616412">error</span>&nbsp;<span class="op" id="3616418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616421">switch</span>&nbsp;<span class="ident" id="3616428">res</span>&nbsp;<span class="op" id="3616432">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616435">case</span>&nbsp;<span class="num" id="3616440">0</span><span class="op" id="3616441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616445">return</span>&nbsp;<span class="ident" id="3616452">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616457">case</span>&nbsp;<span class="num" id="3616462">1</span><span class="op" id="3616463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616467">return</span>&nbsp;<span class="ident" id="3616474">errClosing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616486">case</span>&nbsp;<span class="num" id="3616491">2</span><span class="op" id="3616492">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616496">return</span>&nbsp;<span class="ident" id="3616503">errTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3616518">println</span><span class="op" id="3616525">(</span><span class="string" id="3616526">&#34;unreachable:&nbsp;&#34;</span><span class="op" id="3616541">,</span>&nbsp;<span class="ident" id="3616543">res</span><span class="op" id="3616546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3616549">panic</span><span class="op" id="3616554">(</span><span class="string" id="3616555">&#34;unreachable&#34;</span><span class="op" id="3616568">)</span><br>
<span class="lineno"></span><span class="op" id="3616570">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3616573">func</span>&nbsp;<span class="op" id="3616578">(</span><span class="ident" id="3616579">fd</span>&nbsp;<span class="op" id="3616582">*</span><span class="ident" id="3616583">netFD</span><span class="op" id="3616588">)</span>&nbsp;<span class="ident" id="3616590">setDeadline</span><span class="op" id="3616601">(</span><span class="ident" id="3616602">t</span>&nbsp;<span class="ident" id="3616604">time</span><span class="op" id="3616608">.</span><span class="ident" id="3616609">Time</span><span class="op" id="3616613">)</span>&nbsp;<span class="builtintype" id="3616615">error</span>&nbsp;<span class="op" id="3616621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616624">return</span>&nbsp;<span class="ident" id="3616631">setDeadlineImpl</span><span class="op" id="3616646">(</span><span class="ident" id="3616647">fd</span><span class="op" id="3616649">,</span>&nbsp;<span class="ident" id="3616651">t</span><span class="op" id="3616652">,</span>&nbsp;<span class="string" id="3616654">&#39;r&#39;</span><span class="op" id="3616657">+</span><span class="string" id="3616658">&#39;w&#39;</span><span class="op" id="3616661">)</span><br>
<span class="lineno"></span><span class="op" id="3616663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3616666">func</span>&nbsp;<span class="op" id="3616671">(</span><span class="ident" id="3616672">fd</span>&nbsp;<span class="op" id="3616675">*</span><span class="ident" id="3616676">netFD</span><span class="op" id="3616681">)</span>&nbsp;<span class="ident" id="3616683">setReadDeadline</span><span class="op" id="3616698">(</span><span class="ident" id="3616699">t</span>&nbsp;<span class="ident" id="3616701">time</span><span class="op" id="3616705">.</span><span class="ident" id="3616706">Time</span><span class="op" id="3616710">)</span>&nbsp;<span class="builtintype" id="3616712">error</span>&nbsp;<span class="op" id="3616718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616721">return</span>&nbsp;<span class="ident" id="3616728">setDeadlineImpl</span><span class="op" id="3616743">(</span><span class="ident" id="3616744">fd</span><span class="op" id="3616746">,</span>&nbsp;<span class="ident" id="3616748">t</span><span class="op" id="3616749">,</span>&nbsp;<span class="string" id="3616751">&#39;r&#39;</span><span class="op" id="3616754">)</span><br>
<span class="lineno"></span><span class="op" id="3616756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616759">func</span>&nbsp;<span class="op" id="3616764">(</span><span class="ident" id="3616765">fd</span>&nbsp;<span class="op" id="3616768">*</span><span class="ident" id="3616769">netFD</span><span class="op" id="3616774">)</span>&nbsp;<span class="ident" id="3616776">setWriteDeadline</span><span class="op" id="3616792">(</span><span class="ident" id="3616793">t</span>&nbsp;<span class="ident" id="3616795">time</span><span class="op" id="3616799">.</span><span class="ident" id="3616800">Time</span><span class="op" id="3616804">)</span>&nbsp;<span class="builtintype" id="3616806">error</span>&nbsp;<span class="op" id="3616812">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616815">return</span>&nbsp;<span class="ident" id="3616822">setDeadlineImpl</span><span class="op" id="3616837">(</span><span class="ident" id="3616838">fd</span><span class="op" id="3616840">,</span>&nbsp;<span class="ident" id="3616842">t</span><span class="op" id="3616843">,</span>&nbsp;<span class="string" id="3616845">&#39;w&#39;</span><span class="op" id="3616848">)</span><br>
<span class="lineno"></span><span class="op" id="3616850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616853">func</span>&nbsp;<span class="ident" id="3616858">setDeadlineImpl</span><span class="op" id="3616873">(</span><span class="ident" id="3616874">fd</span>&nbsp;<span class="op" id="3616877">*</span><span class="ident" id="3616878">netFD</span><span class="op" id="3616883">,</span>&nbsp;<span class="ident" id="3616885">t</span>&nbsp;<span class="ident" id="3616887">time</span><span class="op" id="3616891">.</span><span class="ident" id="3616892">Time</span><span class="op" id="3616896">,</span>&nbsp;<span class="ident" id="3616898">mode</span>&nbsp;<span class="builtintype" id="3616903">int</span><span class="op" id="3616906">)</span>&nbsp;<span class="builtintype" id="3616908">error</span>&nbsp;<span class="op" id="3616914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616917">d</span>&nbsp;<span class="op" id="3616919">:=</span>&nbsp;<span class="ident" id="3616922">runtimeNano</span><span class="op" id="3616933">(</span><span class="op" id="3616934">)</span>&nbsp;<span class="op" id="3616936">+</span>&nbsp;<span class="ident" id="3616938">int64</span><span class="op" id="3616943">(</span><span class="ident" id="3616944">t</span><span class="op" id="3616945">.</span><span class="ident" id="3616946">Sub</span><span class="op" id="3616949">(</span><span class="ident" id="3616950">time</span><span class="op" id="3616954">.</span><span class="ident" id="3616955">Now</span><span class="op" id="3616958">(</span><span class="op" id="3616959">)</span><span class="op" id="3616960">)</span><span class="op" id="3616961">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616964">if</span>&nbsp;<span class="ident" id="3616967">t</span><span class="op" id="3616968">.</span><span class="ident" id="3616969">IsZero</span><span class="op" id="3616975">(</span><span class="op" id="3616976">)</span>&nbsp;<span class="op" id="3616978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3616982">d</span>&nbsp;<span class="op" id="3616984">=</span>&nbsp;<span class="num" id="3616986">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3616989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3616992">if</span>&nbsp;<span class="ident" id="3616995">err</span>&nbsp;<span class="op" id="3616999">:=</span>&nbsp;<span class="ident" id="3617002">fd</span><span class="op" id="3617004">.</span><span class="ident" id="3617005">incref</span><span class="op" id="3617011">(</span><span class="op" id="3617012">)</span><span class="op" id="3617013">;</span>&nbsp;<span class="ident" id="3617015">err</span>&nbsp;<span class="op" id="3617019">!=</span>&nbsp;<span class="ident" id="3617022">nil</span>&nbsp;<span class="op" id="3617026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617030">return</span>&nbsp;<span class="ident" id="3617037">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3617042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617045">runtime_pollSetDeadline</span><span class="op" id="3617068">(</span><span class="ident" id="3617069">fd</span><span class="op" id="3617071">.</span><span class="ident" id="3617072">pd</span><span class="op" id="3617074">.</span><span class="ident" id="3617075">runtimeCtx</span><span class="op" id="3617085">,</span>&nbsp;<span class="ident" id="3617087">d</span><span class="op" id="3617088">,</span>&nbsp;<span class="ident" id="3617090">mode</span><span class="op" id="3617094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3617097">fd</span><span class="op" id="3617099">.</span><span class="ident" id="3617100">decref</span><span class="op" id="3617106">(</span><span class="op" id="3617107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3617110">return</span>&nbsp;<span class="ident" id="3617117">nil</span><br>
<span class="lineno"></span><span class="op" id="3617121">}</span>
</div>
</body>
</html>
