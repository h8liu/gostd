<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html" class="current">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7263465">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7263520">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7263574">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7263625">package</span>&nbsp;<span class="ident" id="7263633">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7263638">import</span>&nbsp;<span class="op" id="7263645">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263648">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263657">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263664">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263670">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263681">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263692">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7263702">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7263705">//&nbsp;Test&nbsp;basic&nbsp;operations&nbsp;in&nbsp;a&nbsp;safe&nbsp;manner.</span><br>
<span class="lineno"></span><span class="keyword" id="7263748">func</span>&nbsp;<span class="ident" id="7263753">TestBasicEncoderDecoder</span><span class="op" id="7263776">(</span><span class="ident" id="7263777">t</span>&nbsp;<span class="op" id="7263779">*</span><span class="ident" id="7263780">testing</span><span class="op" id="7263787">.</span><span class="ident" id="7263788">T</span><span class="op" id="7263789">)</span>&nbsp;<span class="op" id="7263791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7263794">var</span>&nbsp;<span class="ident" id="7263798">values</span>&nbsp;<span class="op" id="7263805">=</span>&nbsp;<span class="op" id="7263807">[</span><span class="op" id="7263808">]</span><span class="keyword" id="7263809">interface</span><span class="op" id="7263818">{</span><span class="op" id="7263819">}</span><span class="op" id="7263820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263824">true</span><span class="op" id="7263828">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263832">int</span><span class="op" id="7263835">(</span><span class="num" id="7263836">123</span><span class="op" id="7263839">)</span><span class="op" id="7263840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263844">int8</span><span class="op" id="7263848">(</span><span class="num" id="7263849">123</span><span class="op" id="7263852">)</span><span class="op" id="7263853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263857">int16</span><span class="op" id="7263862">(</span><span class="op" id="7263863">-</span><span class="num" id="7263864">12345</span><span class="op" id="7263869">)</span><span class="op" id="7263870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263874">int32</span><span class="op" id="7263879">(</span><span class="num" id="7263880">123456</span><span class="op" id="7263886">)</span><span class="op" id="7263887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263891">int64</span><span class="op" id="7263896">(</span><span class="op" id="7263897">-</span><span class="num" id="7263898">1234567</span><span class="op" id="7263905">)</span><span class="op" id="7263906">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263910">uint</span><span class="op" id="7263914">(</span><span class="num" id="7263915">123</span><span class="op" id="7263918">)</span><span class="op" id="7263919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263923">uint8</span><span class="op" id="7263928">(</span><span class="num" id="7263929">123</span><span class="op" id="7263932">)</span><span class="op" id="7263933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263937">uint16</span><span class="op" id="7263943">(</span><span class="num" id="7263944">12345</span><span class="op" id="7263949">)</span><span class="op" id="7263950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263954">uint32</span><span class="op" id="7263960">(</span><span class="num" id="7263961">123456</span><span class="op" id="7263967">)</span><span class="op" id="7263968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263972">uint64</span><span class="op" id="7263978">(</span><span class="num" id="7263979">1234567</span><span class="op" id="7263986">)</span><span class="op" id="7263987">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7263991">uintptr</span><span class="op" id="7263998">(</span><span class="num" id="7263999">12345678</span><span class="op" id="7264007">)</span><span class="op" id="7264008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264012">float32</span><span class="op" id="7264019">(</span><span class="num" id="7264020">1.2345</span><span class="op" id="7264026">)</span><span class="op" id="7264027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264031">float64</span><span class="op" id="7264038">(</span><span class="num" id="7264039">1.2345678</span><span class="op" id="7264048">)</span><span class="op" id="7264049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264053">complex64</span><span class="op" id="7264062">(</span><span class="num" id="7264063">1.2345</span>&nbsp;<span class="op" id="7264070">+</span>&nbsp;<span class="num" id="7264072">2.3456i</span><span class="op" id="7264079">)</span><span class="op" id="7264080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264084">complex128</span><span class="op" id="7264094">(</span><span class="num" id="7264095">1.2345678</span>&nbsp;<span class="op" id="7264105">+</span>&nbsp;<span class="num" id="7264107">2.3456789i</span><span class="op" id="7264117">)</span><span class="op" id="7264118">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264122">[</span><span class="op" id="7264123">]</span><span class="builtintype" id="7264124">byte</span><span class="op" id="7264128">(</span><span class="string" id="7264129">&#34;hello&#34;</span><span class="op" id="7264136">)</span><span class="op" id="7264137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264141">string</span><span class="op" id="7264147">(</span><span class="string" id="7264148">&#34;hello&#34;</span><span class="op" id="7264155">)</span><span class="op" id="7264156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264162">for</span>&nbsp;<span class="ident" id="7264166">_</span><span class="op" id="7264167">,</span>&nbsp;<span class="ident" id="7264169">value</span>&nbsp;<span class="op" id="7264175">:=</span>&nbsp;<span class="keyword" id="7264178">range</span>&nbsp;<span class="ident" id="7264184">values</span>&nbsp;<span class="op" id="7264191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264195">b</span>&nbsp;<span class="op" id="7264197">:=</span>&nbsp;<span class="builtinfunc" id="7264200">new</span><span class="op" id="7264203">(</span><span class="ident" id="7264204">bytes</span><span class="op" id="7264209">.</span><span class="ident" id="7264210">Buffer</span><span class="op" id="7264216">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264220">enc</span>&nbsp;<span class="op" id="7264224">:=</span>&nbsp;<span class="ident" id="7264227">NewEncoder</span><span class="op" id="7264237">(</span><span class="ident" id="7264238">b</span><span class="op" id="7264239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264243">err</span>&nbsp;<span class="op" id="7264247">:=</span>&nbsp;<span class="ident" id="7264250">enc</span><span class="op" id="7264253">.</span><span class="ident" id="7264254">Encode</span><span class="op" id="7264260">(</span><span class="ident" id="7264261">value</span><span class="op" id="7264266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264270">if</span>&nbsp;<span class="ident" id="7264273">err</span>&nbsp;<span class="op" id="7264277">!=</span>&nbsp;<span class="builtintype" id="7264280">nil</span>&nbsp;<span class="op" id="7264284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264289">t</span><span class="op" id="7264290">.</span><span class="ident" id="7264291">Error</span><span class="op" id="7264296">(</span><span class="string" id="7264297">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7264312">,</span>&nbsp;<span class="ident" id="7264314">err</span><span class="op" id="7264317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264321">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264325">dec</span>&nbsp;<span class="op" id="7264329">:=</span>&nbsp;<span class="ident" id="7264332">NewDecoder</span><span class="op" id="7264342">(</span><span class="ident" id="7264343">b</span><span class="op" id="7264344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264348">result</span>&nbsp;<span class="op" id="7264355">:=</span>&nbsp;<span class="ident" id="7264358">reflect</span><span class="op" id="7264365">.</span><span class="ident" id="7264366">New</span><span class="op" id="7264369">(</span><span class="ident" id="7264370">reflect</span><span class="op" id="7264377">.</span><span class="ident" id="7264378">TypeOf</span><span class="op" id="7264384">(</span><span class="ident" id="7264385">value</span><span class="op" id="7264390">)</span><span class="op" id="7264391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264395">err</span>&nbsp;<span class="op" id="7264399">=</span>&nbsp;<span class="ident" id="7264401">dec</span><span class="op" id="7264404">.</span><span class="ident" id="7264405">Decode</span><span class="op" id="7264411">(</span><span class="ident" id="7264412">result</span><span class="op" id="7264418">.</span><span class="ident" id="7264419">Interface</span><span class="op" id="7264428">(</span><span class="op" id="7264429">)</span><span class="op" id="7264430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264434">if</span>&nbsp;<span class="ident" id="7264437">err</span>&nbsp;<span class="op" id="7264441">!=</span>&nbsp;<span class="builtintype" id="7264444">nil</span>&nbsp;<span class="op" id="7264448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264453">t</span><span class="op" id="7264454">.</span><span class="ident" id="7264455">Fatalf</span><span class="op" id="7264461">(</span><span class="string" id="7264462">&#34;error&nbsp;decoding&nbsp;%T:&nbsp;%v:&#34;</span><span class="op" id="7264486">,</span>&nbsp;<span class="ident" id="7264488">reflect</span><span class="op" id="7264495">.</span><span class="ident" id="7264496">TypeOf</span><span class="op" id="7264502">(</span><span class="ident" id="7264503">value</span><span class="op" id="7264508">)</span><span class="op" id="7264509">,</span>&nbsp;<span class="ident" id="7264511">err</span><span class="op" id="7264514">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264522">if</span>&nbsp;<span class="op" id="7264525">!</span><span class="ident" id="7264526">reflect</span><span class="op" id="7264533">.</span><span class="ident" id="7264534">DeepEqual</span><span class="op" id="7264543">(</span><span class="ident" id="7264544">value</span><span class="op" id="7264549">,</span>&nbsp;<span class="ident" id="7264551">result</span><span class="op" id="7264557">.</span><span class="ident" id="7264558">Elem</span><span class="op" id="7264562">(</span><span class="op" id="7264563">)</span><span class="op" id="7264564">.</span><span class="ident" id="7264565">Interface</span><span class="op" id="7264574">(</span><span class="op" id="7264575">)</span><span class="op" id="7264576">)</span>&nbsp;<span class="op" id="7264578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264583">t</span><span class="op" id="7264584">.</span><span class="ident" id="7264585">Fatalf</span><span class="op" id="7264591">(</span><span class="string" id="7264592">&#34;%T:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7264616">,</span>&nbsp;<span class="ident" id="7264618">value</span><span class="op" id="7264623">,</span>&nbsp;<span class="ident" id="7264625">value</span><span class="op" id="7264630">,</span>&nbsp;<span class="ident" id="7264632">result</span><span class="op" id="7264638">.</span><span class="ident" id="7264639">Elem</span><span class="op" id="7264643">(</span><span class="op" id="7264644">)</span><span class="op" id="7264645">.</span><span class="ident" id="7264646">Interface</span><span class="op" id="7264655">(</span><span class="op" id="7264656">)</span><span class="op" id="7264657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264664">}</span><br>
<span class="lineno">55</span><span class="op" id="7264666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264669">type</span>&nbsp;<span class="ident" id="7264674">ET0</span>&nbsp;<span class="keyword" id="7264678">struct</span>&nbsp;<span class="op" id="7264685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264688">A</span>&nbsp;<span class="builtintype" id="7264690">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264695">B</span>&nbsp;<span class="builtintype" id="7264697">string</span><br>
<span class="lineno">60</span><span class="op" id="7264704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264707">type</span>&nbsp;<span class="ident" id="7264712">ET2</span>&nbsp;<span class="keyword" id="7264716">struct</span>&nbsp;<span class="op" id="7264723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264726">X</span>&nbsp;<span class="builtintype" id="7264728">string</span><br>
<span class="lineno"></span><span class="op" id="7264735">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7264738">type</span>&nbsp;<span class="ident" id="7264743">ET1</span>&nbsp;<span class="keyword" id="7264747">struct</span>&nbsp;<span class="op" id="7264754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264757">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264762">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264767">Et2</span>&nbsp;&nbsp;<span class="op" id="7264772">*</span><span class="ident" id="7264773">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264778">Next</span>&nbsp;<span class="op" id="7264783">*</span><span class="ident" id="7264784">ET1</span><br>
<span class="lineno">70</span><span class="op" id="7264788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7264791">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="7264841">type</span>&nbsp;<span class="ident" id="7264846">ET3</span>&nbsp;<span class="keyword" id="7264850">struct</span>&nbsp;<span class="op" id="7264857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264860">A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264874">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264879">Et2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264893">*</span><span class="ident" id="7264894">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264899">DifferentNext</span>&nbsp;<span class="op" id="7264913">*</span><span class="ident" id="7264914">ET1</span><br>
<span class="lineno"></span><span class="op" id="7264918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7264921">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;type&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno">80</span><span class="keyword" id="7264971">type</span>&nbsp;<span class="ident" id="7264976">ET4</span>&nbsp;<span class="keyword" id="7264980">struct</span>&nbsp;<span class="op" id="7264987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264990">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7264995">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265000">Et2</span>&nbsp;&nbsp;<span class="builtintype" id="7265005">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265014">Next</span>&nbsp;<span class="builtintype" id="7265019">int</span><br>
<span class="lineno"></span><span class="op" id="7265023">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7265026">func</span>&nbsp;<span class="ident" id="7265031">TestEncoderDecoder</span><span class="op" id="7265049">(</span><span class="ident" id="7265050">t</span>&nbsp;<span class="op" id="7265052">*</span><span class="ident" id="7265053">testing</span><span class="op" id="7265060">.</span><span class="ident" id="7265061">T</span><span class="op" id="7265062">)</span>&nbsp;<span class="op" id="7265064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265067">b</span>&nbsp;<span class="op" id="7265069">:=</span>&nbsp;<span class="builtinfunc" id="7265072">new</span><span class="op" id="7265075">(</span><span class="ident" id="7265076">bytes</span><span class="op" id="7265081">.</span><span class="ident" id="7265082">Buffer</span><span class="op" id="7265088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265091">enc</span>&nbsp;<span class="op" id="7265095">:=</span>&nbsp;<span class="ident" id="7265098">NewEncoder</span><span class="op" id="7265108">(</span><span class="ident" id="7265109">b</span><span class="op" id="7265110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265113">et0</span>&nbsp;<span class="op" id="7265117">:=</span>&nbsp;<span class="builtinfunc" id="7265120">new</span><span class="op" id="7265123">(</span><span class="ident" id="7265124">ET0</span><span class="op" id="7265127">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265130">et0</span><span class="op" id="7265133">.</span><span class="ident" id="7265134">A</span>&nbsp;<span class="op" id="7265136">=</span>&nbsp;<span class="num" id="7265138">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265141">et0</span><span class="op" id="7265144">.</span><span class="ident" id="7265145">B</span>&nbsp;<span class="op" id="7265147">=</span>&nbsp;<span class="string" id="7265149">&#34;gobs&nbsp;of&nbsp;fun&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265164">err</span>&nbsp;<span class="op" id="7265168">:=</span>&nbsp;<span class="ident" id="7265171">enc</span><span class="op" id="7265174">.</span><span class="ident" id="7265175">Encode</span><span class="op" id="7265181">(</span><span class="ident" id="7265182">et0</span><span class="op" id="7265185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265188">if</span>&nbsp;<span class="ident" id="7265191">err</span>&nbsp;<span class="op" id="7265195">!=</span>&nbsp;<span class="builtintype" id="7265198">nil</span>&nbsp;<span class="op" id="7265202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265206">t</span><span class="op" id="7265207">.</span><span class="ident" id="7265208">Error</span><span class="op" id="7265213">(</span><span class="string" id="7265214">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7265229">,</span>&nbsp;<span class="ident" id="7265231">err</span><span class="op" id="7265234">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7265240">//fmt.Printf(&#34;%&nbsp;x&nbsp;%q\n&#34;,&nbsp;b,&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7265272">//Debug(b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265284">dec</span>&nbsp;<span class="op" id="7265288">:=</span>&nbsp;<span class="ident" id="7265291">NewDecoder</span><span class="op" id="7265301">(</span><span class="ident" id="7265302">b</span><span class="op" id="7265303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265306">newEt0</span>&nbsp;<span class="op" id="7265313">:=</span>&nbsp;<span class="builtinfunc" id="7265316">new</span><span class="op" id="7265319">(</span><span class="ident" id="7265320">ET0</span><span class="op" id="7265323">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265326">err</span>&nbsp;<span class="op" id="7265330">=</span>&nbsp;<span class="ident" id="7265332">dec</span><span class="op" id="7265335">.</span><span class="ident" id="7265336">Decode</span><span class="op" id="7265342">(</span><span class="ident" id="7265343">newEt0</span><span class="op" id="7265349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265352">if</span>&nbsp;<span class="ident" id="7265355">err</span>&nbsp;<span class="op" id="7265359">!=</span>&nbsp;<span class="builtintype" id="7265362">nil</span>&nbsp;<span class="op" id="7265366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265370">t</span><span class="op" id="7265371">.</span><span class="ident" id="7265372">Fatal</span><span class="op" id="7265377">(</span><span class="string" id="7265378">&#34;error&nbsp;decoding&nbsp;ET0:&#34;</span><span class="op" id="7265399">,</span>&nbsp;<span class="ident" id="7265401">err</span><span class="op" id="7265404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265411">if</span>&nbsp;<span class="op" id="7265414">!</span><span class="ident" id="7265415">reflect</span><span class="op" id="7265422">.</span><span class="ident" id="7265423">DeepEqual</span><span class="op" id="7265432">(</span><span class="ident" id="7265433">et0</span><span class="op" id="7265436">,</span>&nbsp;<span class="ident" id="7265438">newEt0</span><span class="op" id="7265444">)</span>&nbsp;<span class="op" id="7265446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265450">t</span><span class="op" id="7265451">.</span><span class="ident" id="7265452">Fatalf</span><span class="op" id="7265458">(</span><span class="string" id="7265459">&#34;invalid&nbsp;data&nbsp;for&nbsp;et0:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7265504">,</span>&nbsp;<span class="op" id="7265506">*</span><span class="ident" id="7265507">et0</span><span class="op" id="7265510">,</span>&nbsp;<span class="op" id="7265512">*</span><span class="ident" id="7265513">newEt0</span><span class="op" id="7265519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265525">if</span>&nbsp;<span class="ident" id="7265528">b</span><span class="op" id="7265529">.</span><span class="ident" id="7265530">Len</span><span class="op" id="7265533">(</span><span class="op" id="7265534">)</span>&nbsp;<span class="op" id="7265536">!=</span>&nbsp;<span class="num" id="7265539">0</span>&nbsp;<span class="op" id="7265541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265545">t</span><span class="op" id="7265546">.</span><span class="ident" id="7265547">Error</span><span class="op" id="7265552">(</span><span class="string" id="7265553">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7265566">,</span>&nbsp;<span class="ident" id="7265568">b</span><span class="op" id="7265569">.</span><span class="ident" id="7265570">Len</span><span class="op" id="7265573">(</span><span class="op" id="7265574">)</span><span class="op" id="7265575">,</span>&nbsp;<span class="string" id="7265577">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7265589">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7265595">//&nbsp;&nbsp;&nbsp;&nbsp;t.FailNow()</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265612">b</span>&nbsp;<span class="op" id="7265614">=</span>&nbsp;<span class="builtinfunc" id="7265616">new</span><span class="op" id="7265619">(</span><span class="ident" id="7265620">bytes</span><span class="op" id="7265625">.</span><span class="ident" id="7265626">Buffer</span><span class="op" id="7265632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265635">enc</span>&nbsp;<span class="op" id="7265639">=</span>&nbsp;<span class="ident" id="7265641">NewEncoder</span><span class="op" id="7265651">(</span><span class="ident" id="7265652">b</span><span class="op" id="7265653">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265656">et1</span>&nbsp;<span class="op" id="7265660">:=</span>&nbsp;<span class="builtinfunc" id="7265663">new</span><span class="op" id="7265666">(</span><span class="ident" id="7265667">ET1</span><span class="op" id="7265670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265673">et1</span><span class="op" id="7265676">.</span><span class="ident" id="7265677">A</span>&nbsp;<span class="op" id="7265679">=</span>&nbsp;<span class="num" id="7265681">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265684">et1</span><span class="op" id="7265687">.</span><span class="ident" id="7265688">Et2</span>&nbsp;<span class="op" id="7265692">=</span>&nbsp;<span class="builtinfunc" id="7265694">new</span><span class="op" id="7265697">(</span><span class="ident" id="7265698">ET2</span><span class="op" id="7265701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265704">err</span>&nbsp;<span class="op" id="7265708">=</span>&nbsp;<span class="ident" id="7265710">enc</span><span class="op" id="7265713">.</span><span class="ident" id="7265714">Encode</span><span class="op" id="7265720">(</span><span class="ident" id="7265721">et1</span><span class="op" id="7265724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265727">if</span>&nbsp;<span class="ident" id="7265730">err</span>&nbsp;<span class="op" id="7265734">!=</span>&nbsp;<span class="builtintype" id="7265737">nil</span>&nbsp;<span class="op" id="7265741">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265745">t</span><span class="op" id="7265746">.</span><span class="ident" id="7265747">Error</span><span class="op" id="7265752">(</span><span class="string" id="7265753">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7265768">,</span>&nbsp;<span class="ident" id="7265770">err</span><span class="op" id="7265773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265779">dec</span>&nbsp;<span class="op" id="7265783">=</span>&nbsp;<span class="ident" id="7265785">NewDecoder</span><span class="op" id="7265795">(</span><span class="ident" id="7265796">b</span><span class="op" id="7265797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265800">newEt1</span>&nbsp;<span class="op" id="7265807">:=</span>&nbsp;<span class="builtinfunc" id="7265810">new</span><span class="op" id="7265813">(</span><span class="ident" id="7265814">ET1</span><span class="op" id="7265817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265820">err</span>&nbsp;<span class="op" id="7265824">=</span>&nbsp;<span class="ident" id="7265826">dec</span><span class="op" id="7265829">.</span><span class="ident" id="7265830">Decode</span><span class="op" id="7265836">(</span><span class="ident" id="7265837">newEt1</span><span class="op" id="7265843">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265846">if</span>&nbsp;<span class="ident" id="7265849">err</span>&nbsp;<span class="op" id="7265853">!=</span>&nbsp;<span class="builtintype" id="7265856">nil</span>&nbsp;<span class="op" id="7265860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265864">t</span><span class="op" id="7265865">.</span><span class="ident" id="7265866">Fatal</span><span class="op" id="7265871">(</span><span class="string" id="7265872">&#34;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7265893">,</span>&nbsp;<span class="ident" id="7265895">err</span><span class="op" id="7265898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265905">if</span>&nbsp;<span class="op" id="7265908">!</span><span class="ident" id="7265909">reflect</span><span class="op" id="7265916">.</span><span class="ident" id="7265917">DeepEqual</span><span class="op" id="7265926">(</span><span class="ident" id="7265927">et1</span><span class="op" id="7265930">,</span>&nbsp;<span class="ident" id="7265932">newEt1</span><span class="op" id="7265938">)</span>&nbsp;<span class="op" id="7265940">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265944">t</span><span class="op" id="7265945">.</span><span class="ident" id="7265946">Fatalf</span><span class="op" id="7265952">(</span><span class="string" id="7265953">&#34;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7265998">,</span>&nbsp;<span class="op" id="7266000">*</span><span class="ident" id="7266001">et1</span><span class="op" id="7266004">,</span>&nbsp;<span class="op" id="7266006">*</span><span class="ident" id="7266007">newEt1</span><span class="op" id="7266013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266019">if</span>&nbsp;<span class="ident" id="7266022">b</span><span class="op" id="7266023">.</span><span class="ident" id="7266024">Len</span><span class="op" id="7266027">(</span><span class="op" id="7266028">)</span>&nbsp;<span class="op" id="7266030">!=</span>&nbsp;<span class="num" id="7266033">0</span>&nbsp;<span class="op" id="7266035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266039">t</span><span class="op" id="7266040">.</span><span class="ident" id="7266041">Error</span><span class="op" id="7266046">(</span><span class="string" id="7266047">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7266060">,</span>&nbsp;<span class="ident" id="7266062">b</span><span class="op" id="7266063">.</span><span class="ident" id="7266064">Len</span><span class="op" id="7266067">(</span><span class="op" id="7266068">)</span><span class="op" id="7266069">,</span>&nbsp;<span class="string" id="7266071">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7266083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266086">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266090">enc</span><span class="op" id="7266093">.</span><span class="ident" id="7266094">Encode</span><span class="op" id="7266100">(</span><span class="ident" id="7266101">et1</span><span class="op" id="7266104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266107">newEt1</span>&nbsp;<span class="op" id="7266114">=</span>&nbsp;<span class="builtinfunc" id="7266116">new</span><span class="op" id="7266119">(</span><span class="ident" id="7266120">ET1</span><span class="op" id="7266123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266126">err</span>&nbsp;<span class="op" id="7266130">=</span>&nbsp;<span class="ident" id="7266132">dec</span><span class="op" id="7266135">.</span><span class="ident" id="7266136">Decode</span><span class="op" id="7266142">(</span><span class="ident" id="7266143">newEt1</span><span class="op" id="7266149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266152">if</span>&nbsp;<span class="ident" id="7266155">err</span>&nbsp;<span class="op" id="7266159">!=</span>&nbsp;<span class="builtintype" id="7266162">nil</span>&nbsp;<span class="op" id="7266166">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266170">t</span><span class="op" id="7266171">.</span><span class="ident" id="7266172">Fatal</span><span class="op" id="7266177">(</span><span class="string" id="7266178">&#34;round&nbsp;2:&nbsp;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7266208">,</span>&nbsp;<span class="ident" id="7266210">err</span><span class="op" id="7266213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266219">if</span>&nbsp;<span class="op" id="7266222">!</span><span class="ident" id="7266223">reflect</span><span class="op" id="7266230">.</span><span class="ident" id="7266231">DeepEqual</span><span class="op" id="7266240">(</span><span class="ident" id="7266241">et1</span><span class="op" id="7266244">,</span>&nbsp;<span class="ident" id="7266246">newEt1</span><span class="op" id="7266252">)</span>&nbsp;<span class="op" id="7266254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266258">t</span><span class="op" id="7266259">.</span><span class="ident" id="7266260">Fatalf</span><span class="op" id="7266266">(</span><span class="string" id="7266267">&#34;round&nbsp;2:&nbsp;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7266321">,</span>&nbsp;<span class="op" id="7266323">*</span><span class="ident" id="7266324">et1</span><span class="op" id="7266327">,</span>&nbsp;<span class="op" id="7266329">*</span><span class="ident" id="7266330">newEt1</span><span class="op" id="7266336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266339">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266342">if</span>&nbsp;<span class="ident" id="7266345">b</span><span class="op" id="7266346">.</span><span class="ident" id="7266347">Len</span><span class="op" id="7266350">(</span><span class="op" id="7266351">)</span>&nbsp;<span class="op" id="7266353">!=</span>&nbsp;<span class="num" id="7266356">0</span>&nbsp;<span class="op" id="7266358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266362">t</span><span class="op" id="7266363">.</span><span class="ident" id="7266364">Error</span><span class="op" id="7266369">(</span><span class="string" id="7266370">&#34;round&nbsp;2:&nbsp;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7266392">,</span>&nbsp;<span class="ident" id="7266394">b</span><span class="op" id="7266395">.</span><span class="ident" id="7266396">Len</span><span class="op" id="7266399">(</span><span class="op" id="7266400">)</span><span class="op" id="7266401">,</span>&nbsp;<span class="string" id="7266403">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7266415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7266422">//&nbsp;Now&nbsp;test&nbsp;with&nbsp;a&nbsp;running&nbsp;encoder/decoder&nbsp;pair&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;type&nbsp;mismatch.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266506">err</span>&nbsp;<span class="op" id="7266510">=</span>&nbsp;<span class="ident" id="7266512">enc</span><span class="op" id="7266515">.</span><span class="ident" id="7266516">Encode</span><span class="op" id="7266522">(</span><span class="ident" id="7266523">et1</span><span class="op" id="7266526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266529">if</span>&nbsp;<span class="ident" id="7266532">err</span>&nbsp;<span class="op" id="7266536">!=</span>&nbsp;<span class="builtintype" id="7266539">nil</span>&nbsp;<span class="op" id="7266543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266547">t</span><span class="op" id="7266548">.</span><span class="ident" id="7266549">Error</span><span class="op" id="7266554">(</span><span class="string" id="7266555">&#34;round&nbsp;3:&nbsp;encoder&nbsp;fail:&#34;</span><span class="op" id="7266579">,</span>&nbsp;<span class="ident" id="7266581">err</span><span class="op" id="7266584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266590">newEt2</span>&nbsp;<span class="op" id="7266597">:=</span>&nbsp;<span class="builtinfunc" id="7266600">new</span><span class="op" id="7266603">(</span><span class="ident" id="7266604">ET2</span><span class="op" id="7266607">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266610">err</span>&nbsp;<span class="op" id="7266614">=</span>&nbsp;<span class="ident" id="7266616">dec</span><span class="op" id="7266619">.</span><span class="ident" id="7266620">Decode</span><span class="op" id="7266626">(</span><span class="ident" id="7266627">newEt2</span><span class="op" id="7266633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266636">if</span>&nbsp;<span class="ident" id="7266639">err</span>&nbsp;<span class="op" id="7266643">==</span>&nbsp;<span class="builtintype" id="7266646">nil</span>&nbsp;<span class="op" id="7266650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266654">t</span><span class="op" id="7266655">.</span><span class="ident" id="7266656">Fatal</span><span class="op" id="7266661">(</span><span class="string" id="7266662">&#34;round&nbsp;3:&nbsp;expected&nbsp;`bad&nbsp;type&#39;&nbsp;error&nbsp;decoding&nbsp;ET2&#34;</span><span class="op" id="7266711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266714">}</span><br>
<span class="lineno"></span><span class="op" id="7266716">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7266719">//&nbsp;Run&nbsp;one&nbsp;value&nbsp;through&nbsp;the&nbsp;encoder/decoder,&nbsp;but&nbsp;use&nbsp;the&nbsp;wrong&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="7266789">//&nbsp;Input&nbsp;is&nbsp;always&nbsp;an&nbsp;ET1;&nbsp;we&nbsp;compare&nbsp;it&nbsp;to&nbsp;whatever&nbsp;is&nbsp;under&nbsp;&#39;e&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="7266856">func</span>&nbsp;<span class="ident" id="7266861">badTypeCheck</span><span class="op" id="7266873">(</span><span class="ident" id="7266874">e</span>&nbsp;<span class="keyword" id="7266876">interface</span><span class="op" id="7266885">{</span><span class="op" id="7266886">}</span><span class="op" id="7266887">,</span>&nbsp;<span class="ident" id="7266889">shouldFail</span>&nbsp;<span class="builtintype" id="7266900">bool</span><span class="op" id="7266904">,</span>&nbsp;<span class="ident" id="7266906">msg</span>&nbsp;<span class="builtintype" id="7266910">string</span><span class="op" id="7266916">,</span>&nbsp;<span class="ident" id="7266918">t</span>&nbsp;<span class="op" id="7266920">*</span><span class="ident" id="7266921">testing</span><span class="op" id="7266928">.</span><span class="ident" id="7266929">T</span><span class="op" id="7266930">)</span>&nbsp;<span class="op" id="7266932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266935">b</span>&nbsp;<span class="op" id="7266937">:=</span>&nbsp;<span class="builtinfunc" id="7266940">new</span><span class="op" id="7266943">(</span><span class="ident" id="7266944">bytes</span><span class="op" id="7266949">.</span><span class="ident" id="7266950">Buffer</span><span class="op" id="7266956">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266959">enc</span>&nbsp;<span class="op" id="7266963">:=</span>&nbsp;<span class="ident" id="7266966">NewEncoder</span><span class="op" id="7266976">(</span><span class="ident" id="7266977">b</span><span class="op" id="7266978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266981">et1</span>&nbsp;<span class="op" id="7266985">:=</span>&nbsp;<span class="builtinfunc" id="7266988">new</span><span class="op" id="7266991">(</span><span class="ident" id="7266992">ET1</span><span class="op" id="7266995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266998">et1</span><span class="op" id="7267001">.</span><span class="ident" id="7267002">A</span>&nbsp;<span class="op" id="7267004">=</span>&nbsp;<span class="num" id="7267006">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267009">et1</span><span class="op" id="7267012">.</span><span class="ident" id="7267013">Et2</span>&nbsp;<span class="op" id="7267017">=</span>&nbsp;<span class="builtinfunc" id="7267019">new</span><span class="op" id="7267022">(</span><span class="ident" id="7267023">ET2</span><span class="op" id="7267026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267029">err</span>&nbsp;<span class="op" id="7267033">:=</span>&nbsp;<span class="ident" id="7267036">enc</span><span class="op" id="7267039">.</span><span class="ident" id="7267040">Encode</span><span class="op" id="7267046">(</span><span class="ident" id="7267047">et1</span><span class="op" id="7267050">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267053">if</span>&nbsp;<span class="ident" id="7267056">err</span>&nbsp;<span class="op" id="7267060">!=</span>&nbsp;<span class="builtintype" id="7267063">nil</span>&nbsp;<span class="op" id="7267067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267071">t</span><span class="op" id="7267072">.</span><span class="ident" id="7267073">Error</span><span class="op" id="7267078">(</span><span class="string" id="7267079">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7267094">,</span>&nbsp;<span class="ident" id="7267096">err</span><span class="op" id="7267099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267105">dec</span>&nbsp;<span class="op" id="7267109">:=</span>&nbsp;<span class="ident" id="7267112">NewDecoder</span><span class="op" id="7267122">(</span><span class="ident" id="7267123">b</span><span class="op" id="7267124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267127">err</span>&nbsp;<span class="op" id="7267131">=</span>&nbsp;<span class="ident" id="7267133">dec</span><span class="op" id="7267136">.</span><span class="ident" id="7267137">Decode</span><span class="op" id="7267143">(</span><span class="ident" id="7267144">e</span><span class="op" id="7267145">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267148">if</span>&nbsp;<span class="ident" id="7267151">shouldFail</span>&nbsp;<span class="op" id="7267162">&amp;&amp;</span>&nbsp;<span class="ident" id="7267165">err</span>&nbsp;<span class="op" id="7267169">==</span>&nbsp;<span class="builtintype" id="7267172">nil</span>&nbsp;<span class="op" id="7267176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267180">t</span><span class="op" id="7267181">.</span><span class="ident" id="7267182">Error</span><span class="op" id="7267187">(</span><span class="string" id="7267188">&#34;expected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7267208">,</span>&nbsp;<span class="ident" id="7267210">msg</span><span class="op" id="7267213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267219">if</span>&nbsp;<span class="op" id="7267222">!</span><span class="ident" id="7267223">shouldFail</span>&nbsp;<span class="op" id="7267234">&amp;&amp;</span>&nbsp;<span class="ident" id="7267237">err</span>&nbsp;<span class="op" id="7267241">!=</span>&nbsp;<span class="builtintype" id="7267244">nil</span>&nbsp;<span class="op" id="7267248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267252">t</span><span class="op" id="7267253">.</span><span class="ident" id="7267254">Error</span><span class="op" id="7267259">(</span><span class="string" id="7267260">&#34;unexpected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7267282">,</span>&nbsp;<span class="ident" id="7267284">msg</span><span class="op" id="7267287">,</span>&nbsp;<span class="ident" id="7267289">err</span><span class="op" id="7267292">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267295">}</span><br>
<span class="lineno"></span><span class="op" id="7267297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7267300">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;bad&nbsp;type&nbsp;the&nbsp;first&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="7267353">func</span>&nbsp;<span class="ident" id="7267358">TestWrongTypeDecoder</span><span class="op" id="7267378">(</span><span class="ident" id="7267379">t</span>&nbsp;<span class="op" id="7267381">*</span><span class="ident" id="7267382">testing</span><span class="op" id="7267389">.</span><span class="ident" id="7267390">T</span><span class="op" id="7267391">)</span>&nbsp;<span class="op" id="7267393">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267396">badTypeCheck</span><span class="op" id="7267408">(</span><span class="builtinfunc" id="7267409">new</span><span class="op" id="7267412">(</span><span class="ident" id="7267413">ET2</span><span class="op" id="7267416">)</span><span class="op" id="7267417">,</span>&nbsp;<span class="builtintype" id="7267419">true</span><span class="op" id="7267423">,</span>&nbsp;<span class="string" id="7267425">&#34;no&nbsp;fields&nbsp;in&nbsp;common&#34;</span><span class="op" id="7267446">,</span>&nbsp;<span class="ident" id="7267448">t</span><span class="op" id="7267449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267452">badTypeCheck</span><span class="op" id="7267464">(</span><span class="builtinfunc" id="7267465">new</span><span class="op" id="7267468">(</span><span class="ident" id="7267469">ET3</span><span class="op" id="7267472">)</span><span class="op" id="7267473">,</span>&nbsp;<span class="builtintype" id="7267475">false</span><span class="op" id="7267480">,</span>&nbsp;<span class="string" id="7267482">&#34;different&nbsp;name&nbsp;of&nbsp;field&#34;</span><span class="op" id="7267507">,</span>&nbsp;<span class="ident" id="7267509">t</span><span class="op" id="7267510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267513">badTypeCheck</span><span class="op" id="7267525">(</span><span class="builtinfunc" id="7267526">new</span><span class="op" id="7267529">(</span><span class="ident" id="7267530">ET4</span><span class="op" id="7267533">)</span><span class="op" id="7267534">,</span>&nbsp;<span class="builtintype" id="7267536">true</span><span class="op" id="7267540">,</span>&nbsp;<span class="string" id="7267542">&#34;different&nbsp;type&nbsp;of&nbsp;field&#34;</span><span class="op" id="7267567">,</span>&nbsp;<span class="ident" id="7267569">t</span><span class="op" id="7267570">)</span><br>
<span class="lineno"></span><span class="op" id="7267572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7267575">func</span>&nbsp;<span class="ident" id="7267580">corruptDataCheck</span><span class="op" id="7267596">(</span><span class="ident" id="7267597">s</span>&nbsp;<span class="builtintype" id="7267599">string</span><span class="op" id="7267605">,</span>&nbsp;<span class="ident" id="7267607">err</span>&nbsp;<span class="builtintype" id="7267611">error</span><span class="op" id="7267616">,</span>&nbsp;<span class="ident" id="7267618">t</span>&nbsp;<span class="op" id="7267620">*</span><span class="ident" id="7267621">testing</span><span class="op" id="7267628">.</span><span class="ident" id="7267629">T</span><span class="op" id="7267630">)</span>&nbsp;<span class="op" id="7267632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267635">b</span>&nbsp;<span class="op" id="7267637">:=</span>&nbsp;<span class="ident" id="7267640">bytes</span><span class="op" id="7267645">.</span><span class="ident" id="7267646">NewBufferString</span><span class="op" id="7267661">(</span><span class="ident" id="7267662">s</span><span class="op" id="7267663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267666">dec</span>&nbsp;<span class="op" id="7267670">:=</span>&nbsp;<span class="ident" id="7267673">NewDecoder</span><span class="op" id="7267683">(</span><span class="ident" id="7267684">b</span><span class="op" id="7267685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267688">err1</span>&nbsp;<span class="op" id="7267693">:=</span>&nbsp;<span class="ident" id="7267696">dec</span><span class="op" id="7267699">.</span><span class="ident" id="7267700">Decode</span><span class="op" id="7267706">(</span><span class="builtinfunc" id="7267707">new</span><span class="op" id="7267710">(</span><span class="ident" id="7267711">ET2</span><span class="op" id="7267714">)</span><span class="op" id="7267715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267718">if</span>&nbsp;<span class="ident" id="7267721">err1</span>&nbsp;<span class="op" id="7267726">!=</span>&nbsp;<span class="ident" id="7267729">err</span>&nbsp;<span class="op" id="7267733">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267737">t</span><span class="op" id="7267738">.</span><span class="ident" id="7267739">Errorf</span><span class="op" id="7267745">(</span><span class="string" id="7267746">&#34;from&nbsp;%q&nbsp;expected&nbsp;error&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7267781">,</span>&nbsp;<span class="ident" id="7267783">s</span><span class="op" id="7267784">,</span>&nbsp;<span class="ident" id="7267786">err</span><span class="op" id="7267789">,</span>&nbsp;<span class="ident" id="7267791">err1</span><span class="op" id="7267795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267798">}</span><br>
<span class="lineno"></span><span class="op" id="7267800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7267803">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;survive&nbsp;bad&nbsp;data.</span><br>
<span class="lineno">200</span><span class="keyword" id="7267838">func</span>&nbsp;<span class="ident" id="7267843">TestBadData</span><span class="op" id="7267854">(</span><span class="ident" id="7267855">t</span>&nbsp;<span class="op" id="7267857">*</span><span class="ident" id="7267858">testing</span><span class="op" id="7267865">.</span><span class="ident" id="7267866">T</span><span class="op" id="7267867">)</span>&nbsp;<span class="op" id="7267869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267872">corruptDataCheck</span><span class="op" id="7267888">(</span><span class="string" id="7267889">&#34;&#34;</span><span class="op" id="7267891">,</span>&nbsp;<span class="ident" id="7267893">io</span><span class="op" id="7267895">.</span><span class="ident" id="7267896">EOF</span><span class="op" id="7267899">,</span>&nbsp;<span class="ident" id="7267901">t</span><span class="op" id="7267902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267905">corruptDataCheck</span><span class="op" id="7267921">(</span><span class="string" id="7267922">&#34;\x7Fhi&#34;</span><span class="op" id="7267930">,</span>&nbsp;<span class="ident" id="7267932">io</span><span class="op" id="7267934">.</span><span class="ident" id="7267935">ErrUnexpectedEOF</span><span class="op" id="7267951">,</span>&nbsp;<span class="ident" id="7267953">t</span><span class="op" id="7267954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267957">corruptDataCheck</span><span class="op" id="7267973">(</span><span class="string" id="7267974">&#34;\x03now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&#34;</span><span class="op" id="7268012">,</span>&nbsp;<span class="ident" id="7268014">errBadType</span><span class="op" id="7268024">,</span>&nbsp;<span class="ident" id="7268026">t</span><span class="op" id="7268027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268030">//&nbsp;issue&nbsp;6323.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268046">corruptDataCheck</span><span class="op" id="7268062">(</span><span class="string" id="7268063">&#34;\x04\x24foo&#34;</span><span class="op" id="7268076">,</span>&nbsp;<span class="ident" id="7268078">errRange</span><span class="op" id="7268086">,</span>&nbsp;<span class="ident" id="7268088">t</span><span class="op" id="7268089">)</span><br>
<span class="lineno"></span><span class="op" id="7268091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7268094">//&nbsp;Types&nbsp;not&nbsp;supported&nbsp;at&nbsp;top&nbsp;level&nbsp;by&nbsp;the&nbsp;Encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="7268146">var</span>&nbsp;<span class="ident" id="7268150">unsupportedValues</span>&nbsp;<span class="op" id="7268168">=</span>&nbsp;<span class="op" id="7268170">[</span><span class="op" id="7268171">]</span><span class="keyword" id="7268172">interface</span><span class="op" id="7268181">{</span><span class="op" id="7268182">}</span><span class="op" id="7268183">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7268186">make</span><span class="op" id="7268190">(</span><span class="keyword" id="7268191">chan</span>&nbsp;<span class="builtintype" id="7268196">int</span><span class="op" id="7268199">)</span><span class="op" id="7268200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268203">func</span><span class="op" id="7268207">(</span><span class="ident" id="7268208">a</span>&nbsp;<span class="builtintype" id="7268210">int</span><span class="op" id="7268213">)</span>&nbsp;<span class="builtintype" id="7268215">bool</span>&nbsp;<span class="op" id="7268220">{</span>&nbsp;<span class="keyword" id="7268222">return</span>&nbsp;<span class="builtintype" id="7268229">true</span>&nbsp;<span class="op" id="7268234">}</span><span class="op" id="7268235">,</span><br>
<span class="lineno"></span><span class="op" id="7268237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7268240">func</span>&nbsp;<span class="ident" id="7268245">TestUnsupported</span><span class="op" id="7268260">(</span><span class="ident" id="7268261">t</span>&nbsp;<span class="op" id="7268263">*</span><span class="ident" id="7268264">testing</span><span class="op" id="7268271">.</span><span class="ident" id="7268272">T</span><span class="op" id="7268273">)</span>&nbsp;<span class="op" id="7268275">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268278">var</span>&nbsp;<span class="ident" id="7268282">b</span>&nbsp;<span class="ident" id="7268284">bytes</span><span class="op" id="7268289">.</span><span class="ident" id="7268290">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268298">enc</span>&nbsp;<span class="op" id="7268302">:=</span>&nbsp;<span class="ident" id="7268305">NewEncoder</span><span class="op" id="7268315">(</span><span class="op" id="7268316">&amp;</span><span class="ident" id="7268317">b</span><span class="op" id="7268318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268321">for</span>&nbsp;<span class="ident" id="7268325">_</span><span class="op" id="7268326">,</span>&nbsp;<span class="ident" id="7268328">v</span>&nbsp;<span class="op" id="7268330">:=</span>&nbsp;<span class="keyword" id="7268333">range</span>&nbsp;<span class="ident" id="7268339">unsupportedValues</span>&nbsp;<span class="op" id="7268357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268361">err</span>&nbsp;<span class="op" id="7268365">:=</span>&nbsp;<span class="ident" id="7268368">enc</span><span class="op" id="7268371">.</span><span class="ident" id="7268372">Encode</span><span class="op" id="7268378">(</span><span class="ident" id="7268379">v</span><span class="op" id="7268380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268384">if</span>&nbsp;<span class="ident" id="7268387">err</span>&nbsp;<span class="op" id="7268391">==</span>&nbsp;<span class="builtintype" id="7268394">nil</span>&nbsp;<span class="op" id="7268398">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268403">t</span><span class="op" id="7268404">.</span><span class="ident" id="7268405">Errorf</span><span class="op" id="7268411">(</span><span class="string" id="7268412">&#34;expected&nbsp;error&nbsp;for&nbsp;%T;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7268445">,</span>&nbsp;<span class="ident" id="7268447">v</span><span class="op" id="7268448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268455">}</span><br>
<span class="lineno"></span><span class="op" id="7268457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7268460">func</span>&nbsp;<span class="ident" id="7268465">encAndDec</span><span class="op" id="7268474">(</span><span class="ident" id="7268475">in</span><span class="op" id="7268477">,</span>&nbsp;<span class="ident" id="7268479">out</span>&nbsp;<span class="keyword" id="7268483">interface</span><span class="op" id="7268492">{</span><span class="op" id="7268493">}</span><span class="op" id="7268494">)</span>&nbsp;<span class="builtintype" id="7268496">error</span>&nbsp;<span class="op" id="7268502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268505">b</span>&nbsp;<span class="op" id="7268507">:=</span>&nbsp;<span class="builtinfunc" id="7268510">new</span><span class="op" id="7268513">(</span><span class="ident" id="7268514">bytes</span><span class="op" id="7268519">.</span><span class="ident" id="7268520">Buffer</span><span class="op" id="7268526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268529">enc</span>&nbsp;<span class="op" id="7268533">:=</span>&nbsp;<span class="ident" id="7268536">NewEncoder</span><span class="op" id="7268546">(</span><span class="ident" id="7268547">b</span><span class="op" id="7268548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268551">err</span>&nbsp;<span class="op" id="7268555">:=</span>&nbsp;<span class="ident" id="7268558">enc</span><span class="op" id="7268561">.</span><span class="ident" id="7268562">Encode</span><span class="op" id="7268568">(</span><span class="ident" id="7268569">in</span><span class="op" id="7268571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268574">if</span>&nbsp;<span class="ident" id="7268577">err</span>&nbsp;<span class="op" id="7268581">!=</span>&nbsp;<span class="builtintype" id="7268584">nil</span>&nbsp;<span class="op" id="7268588">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268592">return</span>&nbsp;<span class="ident" id="7268599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268607">dec</span>&nbsp;<span class="op" id="7268611">:=</span>&nbsp;<span class="ident" id="7268614">NewDecoder</span><span class="op" id="7268624">(</span><span class="ident" id="7268625">b</span><span class="op" id="7268626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268629">err</span>&nbsp;<span class="op" id="7268633">=</span>&nbsp;<span class="ident" id="7268635">dec</span><span class="op" id="7268638">.</span><span class="ident" id="7268639">Decode</span><span class="op" id="7268645">(</span><span class="ident" id="7268646">out</span><span class="op" id="7268649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268652">if</span>&nbsp;<span class="ident" id="7268655">err</span>&nbsp;<span class="op" id="7268659">!=</span>&nbsp;<span class="builtintype" id="7268662">nil</span>&nbsp;<span class="op" id="7268666">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268670">return</span>&nbsp;<span class="ident" id="7268677">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268685">return</span>&nbsp;<span class="builtintype" id="7268692">nil</span><br>
<span class="lineno"></span><span class="op" id="7268696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7268699">func</span>&nbsp;<span class="ident" id="7268704">TestTypeToPtrType</span><span class="op" id="7268721">(</span><span class="ident" id="7268722">t</span>&nbsp;<span class="op" id="7268724">*</span><span class="ident" id="7268725">testing</span><span class="op" id="7268732">.</span><span class="ident" id="7268733">T</span><span class="op" id="7268734">)</span>&nbsp;<span class="op" id="7268736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268739">//&nbsp;Encode&nbsp;a&nbsp;T,&nbsp;decode&nbsp;a&nbsp;*T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268767">type</span>&nbsp;<span class="ident" id="7268772">Type0</span>&nbsp;<span class="keyword" id="7268778">struct</span>&nbsp;<span class="op" id="7268785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268789">A</span>&nbsp;<span class="builtintype" id="7268791">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268796">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268799">t0</span>&nbsp;<span class="op" id="7268802">:=</span>&nbsp;<span class="ident" id="7268805">Type0</span><span class="op" id="7268810">{</span><span class="num" id="7268811">7</span><span class="op" id="7268812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268815">t0p</span>&nbsp;<span class="op" id="7268819">:=</span>&nbsp;<span class="builtinfunc" id="7268822">new</span><span class="op" id="7268825">(</span><span class="ident" id="7268826">Type0</span><span class="op" id="7268831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268834">if</span>&nbsp;<span class="ident" id="7268837">err</span>&nbsp;<span class="op" id="7268841">:=</span>&nbsp;<span class="ident" id="7268844">encAndDec</span><span class="op" id="7268853">(</span><span class="ident" id="7268854">t0</span><span class="op" id="7268856">,</span>&nbsp;<span class="ident" id="7268858">t0p</span><span class="op" id="7268861">)</span><span class="op" id="7268862">;</span>&nbsp;<span class="ident" id="7268864">err</span>&nbsp;<span class="op" id="7268868">!=</span>&nbsp;<span class="builtintype" id="7268871">nil</span>&nbsp;<span class="op" id="7268875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268879">t</span><span class="op" id="7268880">.</span><span class="ident" id="7268881">Error</span><span class="op" id="7268886">(</span><span class="ident" id="7268887">err</span><span class="op" id="7268890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268893">}</span><br>
<span class="lineno">250</span><span class="op" id="7268895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7268898">func</span>&nbsp;<span class="ident" id="7268903">TestPtrTypeToType</span><span class="op" id="7268920">(</span><span class="ident" id="7268921">t</span>&nbsp;<span class="op" id="7268923">*</span><span class="ident" id="7268924">testing</span><span class="op" id="7268931">.</span><span class="ident" id="7268932">T</span><span class="op" id="7268933">)</span>&nbsp;<span class="op" id="7268935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268938">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268966">type</span>&nbsp;<span class="ident" id="7268971">Type1</span>&nbsp;<span class="keyword" id="7268977">struct</span>&nbsp;<span class="op" id="7268984">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268988">A</span>&nbsp;<span class="builtintype" id="7268990">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268999">t1p</span>&nbsp;<span class="op" id="7269003">:=</span>&nbsp;<span class="op" id="7269006">&amp;</span><span class="ident" id="7269007">Type1</span><span class="op" id="7269012">{</span><span class="num" id="7269013">17</span><span class="op" id="7269015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269018">var</span>&nbsp;<span class="ident" id="7269022">t1</span>&nbsp;<span class="ident" id="7269025">Type1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269032">if</span>&nbsp;<span class="ident" id="7269035">err</span>&nbsp;<span class="op" id="7269039">:=</span>&nbsp;<span class="ident" id="7269042">encAndDec</span><span class="op" id="7269051">(</span><span class="ident" id="7269052">t1</span><span class="op" id="7269054">,</span>&nbsp;<span class="ident" id="7269056">t1p</span><span class="op" id="7269059">)</span><span class="op" id="7269060">;</span>&nbsp;<span class="ident" id="7269062">err</span>&nbsp;<span class="op" id="7269066">!=</span>&nbsp;<span class="builtintype" id="7269069">nil</span>&nbsp;<span class="op" id="7269073">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269077">t</span><span class="op" id="7269078">.</span><span class="ident" id="7269079">Error</span><span class="op" id="7269084">(</span><span class="ident" id="7269085">err</span><span class="op" id="7269088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269091">}</span><br>
<span class="lineno"></span><span class="op" id="7269093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7269096">func</span>&nbsp;<span class="ident" id="7269101">TestTypeToPtrPtrPtrPtrType</span><span class="op" id="7269127">(</span><span class="ident" id="7269128">t</span>&nbsp;<span class="op" id="7269130">*</span><span class="ident" id="7269131">testing</span><span class="op" id="7269138">.</span><span class="ident" id="7269139">T</span><span class="op" id="7269140">)</span>&nbsp;<span class="op" id="7269142">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269145">type</span>&nbsp;<span class="ident" id="7269150">Type2</span>&nbsp;<span class="keyword" id="7269156">struct</span>&nbsp;<span class="op" id="7269163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269167">A</span>&nbsp;<span class="op" id="7269169">*</span><span class="op" id="7269170">*</span><span class="op" id="7269171">*</span><span class="op" id="7269172">*</span><span class="builtintype" id="7269173">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269185">t2</span>&nbsp;<span class="op" id="7269188">:=</span>&nbsp;<span class="ident" id="7269191">Type2</span><span class="op" id="7269196">{</span><span class="op" id="7269197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269200">t2</span><span class="op" id="7269202">.</span><span class="ident" id="7269203">A</span>&nbsp;<span class="op" id="7269205">=</span>&nbsp;<span class="builtinfunc" id="7269207">new</span><span class="op" id="7269210">(</span><span class="op" id="7269211">*</span><span class="op" id="7269212">*</span><span class="op" id="7269213">*</span><span class="builtintype" id="7269214">float64</span><span class="op" id="7269221">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269224">*</span><span class="ident" id="7269225">t2</span><span class="op" id="7269227">.</span><span class="ident" id="7269228">A</span>&nbsp;<span class="op" id="7269230">=</span>&nbsp;<span class="builtinfunc" id="7269232">new</span><span class="op" id="7269235">(</span><span class="op" id="7269236">*</span><span class="op" id="7269237">*</span><span class="builtintype" id="7269238">float64</span><span class="op" id="7269245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269248">*</span><span class="op" id="7269249">*</span><span class="ident" id="7269250">t2</span><span class="op" id="7269252">.</span><span class="ident" id="7269253">A</span>&nbsp;<span class="op" id="7269255">=</span>&nbsp;<span class="builtinfunc" id="7269257">new</span><span class="op" id="7269260">(</span><span class="op" id="7269261">*</span><span class="builtintype" id="7269262">float64</span><span class="op" id="7269269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269272">*</span><span class="op" id="7269273">*</span><span class="op" id="7269274">*</span><span class="ident" id="7269275">t2</span><span class="op" id="7269277">.</span><span class="ident" id="7269278">A</span>&nbsp;<span class="op" id="7269280">=</span>&nbsp;<span class="builtinfunc" id="7269282">new</span><span class="op" id="7269285">(</span><span class="builtintype" id="7269286">float64</span><span class="op" id="7269293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269296">*</span><span class="op" id="7269297">*</span><span class="op" id="7269298">*</span><span class="op" id="7269299">*</span><span class="ident" id="7269300">t2</span><span class="op" id="7269302">.</span><span class="ident" id="7269303">A</span>&nbsp;<span class="op" id="7269305">=</span>&nbsp;<span class="num" id="7269307">27.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269313">t2pppp</span>&nbsp;<span class="op" id="7269320">:=</span>&nbsp;<span class="builtinfunc" id="7269323">new</span><span class="op" id="7269326">(</span><span class="op" id="7269327">*</span><span class="op" id="7269328">*</span><span class="op" id="7269329">*</span><span class="ident" id="7269330">Type2</span><span class="op" id="7269335">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269338">if</span>&nbsp;<span class="ident" id="7269341">err</span>&nbsp;<span class="op" id="7269345">:=</span>&nbsp;<span class="ident" id="7269348">encAndDec</span><span class="op" id="7269357">(</span><span class="ident" id="7269358">t2</span><span class="op" id="7269360">,</span>&nbsp;<span class="ident" id="7269362">t2pppp</span><span class="op" id="7269368">)</span><span class="op" id="7269369">;</span>&nbsp;<span class="ident" id="7269371">err</span>&nbsp;<span class="op" id="7269375">!=</span>&nbsp;<span class="builtintype" id="7269378">nil</span>&nbsp;<span class="op" id="7269382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269386">t</span><span class="op" id="7269387">.</span><span class="ident" id="7269388">Fatal</span><span class="op" id="7269393">(</span><span class="ident" id="7269394">err</span><span class="op" id="7269397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269403">if</span>&nbsp;<span class="op" id="7269406">*</span><span class="op" id="7269407">*</span><span class="op" id="7269408">*</span><span class="op" id="7269409">*</span><span class="op" id="7269410">(</span><span class="op" id="7269411">*</span><span class="op" id="7269412">*</span><span class="op" id="7269413">*</span><span class="op" id="7269414">*</span><span class="ident" id="7269415">t2pppp</span><span class="op" id="7269421">)</span><span class="op" id="7269422">.</span><span class="ident" id="7269423">A</span>&nbsp;<span class="op" id="7269425">!=</span>&nbsp;<span class="op" id="7269428">*</span><span class="op" id="7269429">*</span><span class="op" id="7269430">*</span><span class="op" id="7269431">*</span><span class="ident" id="7269432">t2</span><span class="op" id="7269434">.</span><span class="ident" id="7269435">A</span>&nbsp;<span class="op" id="7269437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269441">t</span><span class="op" id="7269442">.</span><span class="ident" id="7269443">Errorf</span><span class="op" id="7269449">(</span><span class="string" id="7269450">&#34;wrong&nbsp;value&nbsp;after&nbsp;decode:&nbsp;%g&nbsp;not&nbsp;%g&#34;</span><span class="op" id="7269487">,</span>&nbsp;<span class="op" id="7269489">*</span><span class="op" id="7269490">*</span><span class="op" id="7269491">*</span><span class="op" id="7269492">*</span><span class="op" id="7269493">(</span><span class="op" id="7269494">*</span><span class="op" id="7269495">*</span><span class="op" id="7269496">*</span><span class="op" id="7269497">*</span><span class="ident" id="7269498">t2pppp</span><span class="op" id="7269504">)</span><span class="op" id="7269505">.</span><span class="ident" id="7269506">A</span><span class="op" id="7269507">,</span>&nbsp;<span class="op" id="7269509">*</span><span class="op" id="7269510">*</span><span class="op" id="7269511">*</span><span class="op" id="7269512">*</span><span class="ident" id="7269513">t2</span><span class="op" id="7269515">.</span><span class="ident" id="7269516">A</span><span class="op" id="7269517">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269520">}</span><br>
<span class="lineno"></span><span class="op" id="7269522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7269525">func</span>&nbsp;<span class="ident" id="7269530">TestSlice</span><span class="op" id="7269539">(</span><span class="ident" id="7269540">t</span>&nbsp;<span class="op" id="7269542">*</span><span class="ident" id="7269543">testing</span><span class="op" id="7269550">.</span><span class="ident" id="7269551">T</span><span class="op" id="7269552">)</span>&nbsp;<span class="op" id="7269554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269557">type</span>&nbsp;<span class="ident" id="7269562">Type3</span>&nbsp;<span class="keyword" id="7269568">struct</span>&nbsp;<span class="op" id="7269575">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269579">A</span>&nbsp;<span class="op" id="7269581">[</span><span class="op" id="7269582">]</span><span class="builtintype" id="7269583">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269594">t3p</span>&nbsp;<span class="op" id="7269598">:=</span>&nbsp;<span class="op" id="7269601">&amp;</span><span class="ident" id="7269602">Type3</span><span class="op" id="7269607">{</span><span class="op" id="7269608">[</span><span class="op" id="7269609">]</span><span class="builtintype" id="7269610">string</span><span class="op" id="7269616">{</span><span class="string" id="7269617">&#34;hello&#34;</span><span class="op" id="7269624">,</span>&nbsp;<span class="string" id="7269626">&#34;world&#34;</span><span class="op" id="7269633">}</span><span class="op" id="7269634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269637">var</span>&nbsp;<span class="ident" id="7269641">t3</span>&nbsp;<span class="ident" id="7269644">Type3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269651">if</span>&nbsp;<span class="ident" id="7269654">err</span>&nbsp;<span class="op" id="7269658">:=</span>&nbsp;<span class="ident" id="7269661">encAndDec</span><span class="op" id="7269670">(</span><span class="ident" id="7269671">t3</span><span class="op" id="7269673">,</span>&nbsp;<span class="ident" id="7269675">t3p</span><span class="op" id="7269678">)</span><span class="op" id="7269679">;</span>&nbsp;<span class="ident" id="7269681">err</span>&nbsp;<span class="op" id="7269685">!=</span>&nbsp;<span class="builtintype" id="7269688">nil</span>&nbsp;<span class="op" id="7269692">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269696">t</span><span class="op" id="7269697">.</span><span class="ident" id="7269698">Error</span><span class="op" id="7269703">(</span><span class="ident" id="7269704">err</span><span class="op" id="7269707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269710">}</span><br>
<span class="lineno"></span><span class="op" id="7269712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7269715">func</span>&nbsp;<span class="ident" id="7269720">TestValueError</span><span class="op" id="7269734">(</span><span class="ident" id="7269735">t</span>&nbsp;<span class="op" id="7269737">*</span><span class="ident" id="7269738">testing</span><span class="op" id="7269745">.</span><span class="ident" id="7269746">T</span><span class="op" id="7269747">)</span>&nbsp;<span class="op" id="7269749">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7269752">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269780">type</span>&nbsp;<span class="ident" id="7269785">Type4</span>&nbsp;<span class="keyword" id="7269791">struct</span>&nbsp;<span class="op" id="7269798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269802">A</span>&nbsp;<span class="builtintype" id="7269804">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269812">t4p</span>&nbsp;<span class="op" id="7269816">:=</span>&nbsp;<span class="op" id="7269819">&amp;</span><span class="ident" id="7269820">Type4</span><span class="op" id="7269825">{</span><span class="num" id="7269826">3</span><span class="op" id="7269827">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269830">var</span>&nbsp;<span class="ident" id="7269834">t4</span>&nbsp;<span class="ident" id="7269837">Type4</span>&nbsp;<span class="comment" id="7269843">//&nbsp;note:&nbsp;not&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269868">if</span>&nbsp;<span class="ident" id="7269871">err</span>&nbsp;<span class="op" id="7269875">:=</span>&nbsp;<span class="ident" id="7269878">encAndDec</span><span class="op" id="7269887">(</span><span class="ident" id="7269888">t4p</span><span class="op" id="7269891">,</span>&nbsp;<span class="ident" id="7269893">t4</span><span class="op" id="7269895">)</span><span class="op" id="7269896">;</span>&nbsp;<span class="ident" id="7269898">err</span>&nbsp;<span class="op" id="7269902">==</span>&nbsp;<span class="builtintype" id="7269905">nil</span>&nbsp;<span class="op" id="7269909">||</span>&nbsp;<span class="ident" id="7269912">strings</span><span class="op" id="7269919">.</span><span class="ident" id="7269920">Index</span><span class="op" id="7269925">(</span><span class="ident" id="7269926">err</span><span class="op" id="7269929">.</span><span class="ident" id="7269930">Error</span><span class="op" id="7269935">(</span><span class="op" id="7269936">)</span><span class="op" id="7269937">,</span>&nbsp;<span class="string" id="7269939">&#34;pointer&#34;</span><span class="op" id="7269948">)</span>&nbsp;<span class="op" id="7269950">&lt;</span>&nbsp;<span class="num" id="7269952">0</span>&nbsp;<span class="op" id="7269954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269958">t</span><span class="op" id="7269959">.</span><span class="ident" id="7269960">Error</span><span class="op" id="7269965">(</span><span class="string" id="7269966">&#34;expected&nbsp;error&nbsp;about&nbsp;pointer;&nbsp;got&#34;</span><span class="op" id="7270001">,</span>&nbsp;<span class="ident" id="7270003">err</span><span class="op" id="7270006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270009">}</span><br>
<span class="lineno"></span><span class="op" id="7270011">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="7270014">func</span>&nbsp;<span class="ident" id="7270019">TestArray</span><span class="op" id="7270028">(</span><span class="ident" id="7270029">t</span>&nbsp;<span class="op" id="7270031">*</span><span class="ident" id="7270032">testing</span><span class="op" id="7270039">.</span><span class="ident" id="7270040">T</span><span class="op" id="7270041">)</span>&nbsp;<span class="op" id="7270043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270046">type</span>&nbsp;<span class="ident" id="7270051">Type5</span>&nbsp;<span class="keyword" id="7270057">struct</span>&nbsp;<span class="op" id="7270064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270068">A</span>&nbsp;<span class="op" id="7270070">[</span><span class="num" id="7270071">3</span><span class="op" id="7270072">]</span><span class="builtintype" id="7270073">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270082">B</span>&nbsp;<span class="op" id="7270084">[</span><span class="num" id="7270085">3</span><span class="op" id="7270086">]</span><span class="builtintype" id="7270087">byte</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270096">type</span>&nbsp;<span class="ident" id="7270101">Type6</span>&nbsp;<span class="keyword" id="7270107">struct</span>&nbsp;<span class="op" id="7270114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270118">A</span>&nbsp;<span class="op" id="7270120">[</span><span class="num" id="7270121">2</span><span class="op" id="7270122">]</span><span class="builtintype" id="7270123">string</span>&nbsp;<span class="comment" id="7270130">//&nbsp;can&#39;t&nbsp;hold&nbsp;t5.a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270153">t5</span>&nbsp;<span class="op" id="7270156">:=</span>&nbsp;<span class="ident" id="7270159">Type5</span><span class="op" id="7270164">{</span><span class="op" id="7270165">[</span><span class="num" id="7270166">3</span><span class="op" id="7270167">]</span><span class="builtintype" id="7270168">string</span><span class="op" id="7270174">{</span><span class="string" id="7270175">&#34;hello&#34;</span><span class="op" id="7270182">,</span>&nbsp;<span class="string" id="7270184">&#34;,&#34;</span><span class="op" id="7270187">,</span>&nbsp;<span class="string" id="7270189">&#34;world&#34;</span><span class="op" id="7270196">}</span><span class="op" id="7270197">,</span>&nbsp;<span class="op" id="7270199">[</span><span class="num" id="7270200">3</span><span class="op" id="7270201">]</span><span class="builtintype" id="7270202">byte</span><span class="op" id="7270206">{</span><span class="num" id="7270207">1</span><span class="op" id="7270208">,</span>&nbsp;<span class="num" id="7270210">2</span><span class="op" id="7270211">,</span>&nbsp;<span class="num" id="7270213">3</span><span class="op" id="7270214">}</span><span class="op" id="7270215">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270218">var</span>&nbsp;<span class="ident" id="7270222">t5p</span>&nbsp;<span class="ident" id="7270226">Type5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270233">if</span>&nbsp;<span class="ident" id="7270236">err</span>&nbsp;<span class="op" id="7270240">:=</span>&nbsp;<span class="ident" id="7270243">encAndDec</span><span class="op" id="7270252">(</span><span class="ident" id="7270253">t5</span><span class="op" id="7270255">,</span>&nbsp;<span class="op" id="7270257">&amp;</span><span class="ident" id="7270258">t5p</span><span class="op" id="7270261">)</span><span class="op" id="7270262">;</span>&nbsp;<span class="ident" id="7270264">err</span>&nbsp;<span class="op" id="7270268">!=</span>&nbsp;<span class="builtintype" id="7270271">nil</span>&nbsp;<span class="op" id="7270275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270279">t</span><span class="op" id="7270280">.</span><span class="ident" id="7270281">Error</span><span class="op" id="7270286">(</span><span class="ident" id="7270287">err</span><span class="op" id="7270290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270296">var</span>&nbsp;<span class="ident" id="7270300">t6</span>&nbsp;<span class="ident" id="7270303">Type6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270310">if</span>&nbsp;<span class="ident" id="7270313">err</span>&nbsp;<span class="op" id="7270317">:=</span>&nbsp;<span class="ident" id="7270320">encAndDec</span><span class="op" id="7270329">(</span><span class="ident" id="7270330">t5</span><span class="op" id="7270332">,</span>&nbsp;<span class="op" id="7270334">&amp;</span><span class="ident" id="7270335">t6</span><span class="op" id="7270337">)</span><span class="op" id="7270338">;</span>&nbsp;<span class="ident" id="7270340">err</span>&nbsp;<span class="op" id="7270344">==</span>&nbsp;<span class="builtintype" id="7270347">nil</span>&nbsp;<span class="op" id="7270351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270355">t</span><span class="op" id="7270356">.</span><span class="ident" id="7270357">Error</span><span class="op" id="7270362">(</span><span class="string" id="7270363">&#34;should&nbsp;fail&nbsp;with&nbsp;mismatched&nbsp;array&nbsp;sizes&#34;</span><span class="op" id="7270404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270407">}</span><br>
<span class="lineno"></span><span class="op" id="7270409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="7270412">func</span>&nbsp;<span class="ident" id="7270417">TestRecursiveMapType</span><span class="op" id="7270437">(</span><span class="ident" id="7270438">t</span>&nbsp;<span class="op" id="7270440">*</span><span class="ident" id="7270441">testing</span><span class="op" id="7270448">.</span><span class="ident" id="7270449">T</span><span class="op" id="7270450">)</span>&nbsp;<span class="op" id="7270452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270455">type</span>&nbsp;<span class="ident" id="7270460">recursiveMap</span>&nbsp;<span class="keyword" id="7270473">map</span><span class="op" id="7270476">[</span><span class="builtintype" id="7270477">string</span><span class="op" id="7270483">]</span><span class="ident" id="7270484">recursiveMap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270498">r1</span>&nbsp;<span class="op" id="7270501">:=</span>&nbsp;<span class="ident" id="7270504">recursiveMap</span><span class="op" id="7270516">{</span><span class="string" id="7270517">&#34;A&#34;</span><span class="op" id="7270520">:</span>&nbsp;<span class="ident" id="7270522">recursiveMap</span><span class="op" id="7270534">{</span><span class="string" id="7270535">&#34;B&#34;</span><span class="op" id="7270538">:</span>&nbsp;<span class="builtintype" id="7270540">nil</span><span class="op" id="7270543">,</span>&nbsp;<span class="string" id="7270545">&#34;C&#34;</span><span class="op" id="7270548">:</span>&nbsp;<span class="builtintype" id="7270550">nil</span><span class="op" id="7270553">}</span><span class="op" id="7270554">,</span>&nbsp;<span class="string" id="7270556">&#34;D&#34;</span><span class="op" id="7270559">:</span>&nbsp;<span class="builtintype" id="7270561">nil</span><span class="op" id="7270564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270567">r2</span>&nbsp;<span class="op" id="7270570">:=</span>&nbsp;<span class="builtinfunc" id="7270573">make</span><span class="op" id="7270577">(</span><span class="ident" id="7270578">recursiveMap</span><span class="op" id="7270590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270593">if</span>&nbsp;<span class="ident" id="7270596">err</span>&nbsp;<span class="op" id="7270600">:=</span>&nbsp;<span class="ident" id="7270603">encAndDec</span><span class="op" id="7270612">(</span><span class="ident" id="7270613">r1</span><span class="op" id="7270615">,</span>&nbsp;<span class="op" id="7270617">&amp;</span><span class="ident" id="7270618">r2</span><span class="op" id="7270620">)</span><span class="op" id="7270621">;</span>&nbsp;<span class="ident" id="7270623">err</span>&nbsp;<span class="op" id="7270627">!=</span>&nbsp;<span class="builtintype" id="7270630">nil</span>&nbsp;<span class="op" id="7270634">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270638">t</span><span class="op" id="7270639">.</span><span class="ident" id="7270640">Error</span><span class="op" id="7270645">(</span><span class="ident" id="7270646">err</span><span class="op" id="7270649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270652">}</span><br>
<span class="lineno"></span><span class="op" id="7270654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7270657">func</span>&nbsp;<span class="ident" id="7270662">TestRecursiveSliceType</span><span class="op" id="7270684">(</span><span class="ident" id="7270685">t</span>&nbsp;<span class="op" id="7270687">*</span><span class="ident" id="7270688">testing</span><span class="op" id="7270695">.</span><span class="ident" id="7270696">T</span><span class="op" id="7270697">)</span>&nbsp;<span class="op" id="7270699">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270702">type</span>&nbsp;<span class="ident" id="7270707">recursiveSlice</span>&nbsp;<span class="op" id="7270722">[</span><span class="op" id="7270723">]</span><span class="ident" id="7270724">recursiveSlice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270740">r1</span>&nbsp;<span class="op" id="7270743">:=</span>&nbsp;<span class="ident" id="7270746">recursiveSlice</span><span class="op" id="7270760">{</span><span class="num" id="7270761">0</span><span class="op" id="7270762">:</span>&nbsp;<span class="ident" id="7270764">recursiveSlice</span><span class="op" id="7270778">{</span><span class="num" id="7270779">0</span><span class="op" id="7270780">:</span>&nbsp;<span class="builtintype" id="7270782">nil</span><span class="op" id="7270785">}</span><span class="op" id="7270786">,</span>&nbsp;<span class="num" id="7270788">1</span><span class="op" id="7270789">:</span>&nbsp;<span class="builtintype" id="7270791">nil</span><span class="op" id="7270794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270797">r2</span>&nbsp;<span class="op" id="7270800">:=</span>&nbsp;<span class="builtinfunc" id="7270803">make</span><span class="op" id="7270807">(</span><span class="ident" id="7270808">recursiveSlice</span><span class="op" id="7270822">,</span>&nbsp;<span class="num" id="7270824">0</span><span class="op" id="7270825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270828">if</span>&nbsp;<span class="ident" id="7270831">err</span>&nbsp;<span class="op" id="7270835">:=</span>&nbsp;<span class="ident" id="7270838">encAndDec</span><span class="op" id="7270847">(</span><span class="ident" id="7270848">r1</span><span class="op" id="7270850">,</span>&nbsp;<span class="op" id="7270852">&amp;</span><span class="ident" id="7270853">r2</span><span class="op" id="7270855">)</span><span class="op" id="7270856">;</span>&nbsp;<span class="ident" id="7270858">err</span>&nbsp;<span class="op" id="7270862">!=</span>&nbsp;<span class="builtintype" id="7270865">nil</span>&nbsp;<span class="op" id="7270869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270873">t</span><span class="op" id="7270874">.</span><span class="ident" id="7270875">Error</span><span class="op" id="7270880">(</span><span class="ident" id="7270881">err</span><span class="op" id="7270884">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270887">}</span><br>
<span class="lineno"></span><span class="op" id="7270889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7270892">//&nbsp;Regression&nbsp;test&nbsp;for&nbsp;bug:&nbsp;must&nbsp;send&nbsp;zero&nbsp;values&nbsp;inside&nbsp;arrays</span><br>
<span class="lineno"></span><span class="keyword" id="7270956">func</span>&nbsp;<span class="ident" id="7270961">TestDefaultsInArray</span><span class="op" id="7270980">(</span><span class="ident" id="7270981">t</span>&nbsp;<span class="op" id="7270983">*</span><span class="ident" id="7270984">testing</span><span class="op" id="7270991">.</span><span class="ident" id="7270992">T</span><span class="op" id="7270993">)</span>&nbsp;<span class="op" id="7270995">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270998">type</span>&nbsp;<span class="ident" id="7271003">Type7</span>&nbsp;<span class="keyword" id="7271009">struct</span>&nbsp;<span class="op" id="7271016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271020">B</span>&nbsp;<span class="op" id="7271022">[</span><span class="op" id="7271023">]</span><span class="builtintype" id="7271024">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271031">I</span>&nbsp;<span class="op" id="7271033">[</span><span class="op" id="7271034">]</span><span class="builtintype" id="7271035">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271041">S</span>&nbsp;<span class="op" id="7271043">[</span><span class="op" id="7271044">]</span><span class="builtintype" id="7271045">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271054">F</span>&nbsp;<span class="op" id="7271056">[</span><span class="op" id="7271057">]</span><span class="builtintype" id="7271058">float64</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271070">t7</span>&nbsp;<span class="op" id="7271073">:=</span>&nbsp;<span class="ident" id="7271076">Type7</span><span class="op" id="7271081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271085">[</span><span class="op" id="7271086">]</span><span class="builtintype" id="7271087">bool</span><span class="op" id="7271091">{</span><span class="builtintype" id="7271092">false</span><span class="op" id="7271097">,</span>&nbsp;<span class="builtintype" id="7271099">false</span><span class="op" id="7271104">,</span>&nbsp;<span class="builtintype" id="7271106">true</span><span class="op" id="7271110">}</span><span class="op" id="7271111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271115">[</span><span class="op" id="7271116">]</span><span class="builtintype" id="7271117">int</span><span class="op" id="7271120">{</span><span class="num" id="7271121">0</span><span class="op" id="7271122">,</span>&nbsp;<span class="num" id="7271124">0</span><span class="op" id="7271125">,</span>&nbsp;<span class="num" id="7271127">1</span><span class="op" id="7271128">}</span><span class="op" id="7271129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271133">[</span><span class="op" id="7271134">]</span><span class="builtintype" id="7271135">string</span><span class="op" id="7271141">{</span><span class="string" id="7271142">&#34;hi&#34;</span><span class="op" id="7271146">,</span>&nbsp;<span class="string" id="7271148">&#34;&#34;</span><span class="op" id="7271150">,</span>&nbsp;<span class="string" id="7271152">&#34;there&#34;</span><span class="op" id="7271159">}</span><span class="op" id="7271160">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271164">[</span><span class="op" id="7271165">]</span><span class="builtintype" id="7271166">float64</span><span class="op" id="7271173">{</span><span class="num" id="7271174">0</span><span class="op" id="7271175">,</span>&nbsp;<span class="num" id="7271177">0</span><span class="op" id="7271178">,</span>&nbsp;<span class="num" id="7271180">1</span><span class="op" id="7271181">}</span><span class="op" id="7271182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271188">var</span>&nbsp;<span class="ident" id="7271192">t7p</span>&nbsp;<span class="ident" id="7271196">Type7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7271203">if</span>&nbsp;<span class="ident" id="7271206">err</span>&nbsp;<span class="op" id="7271210">:=</span>&nbsp;<span class="ident" id="7271213">encAndDec</span><span class="op" id="7271222">(</span><span class="ident" id="7271223">t7</span><span class="op" id="7271225">,</span>&nbsp;<span class="op" id="7271227">&amp;</span><span class="ident" id="7271228">t7p</span><span class="op" id="7271231">)</span><span class="op" id="7271232">;</span>&nbsp;<span class="ident" id="7271234">err</span>&nbsp;<span class="op" id="7271238">!=</span>&nbsp;<span class="builtintype" id="7271241">nil</span>&nbsp;<span class="op" id="7271245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271249">t</span><span class="op" id="7271250">.</span><span class="ident" id="7271251">Error</span><span class="op" id="7271256">(</span><span class="ident" id="7271257">err</span><span class="op" id="7271260">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271263">}</span><br>
<span class="lineno"></span><span class="op" id="7271265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7271268">var</span>&nbsp;<span class="ident" id="7271272">testInt</span>&nbsp;<span class="builtintype" id="7271280">int</span><br>
<span class="lineno"></span><span class="keyword" id="7271284">var</span>&nbsp;<span class="ident" id="7271288">testFloat32</span>&nbsp;<span class="builtintype" id="7271300">float32</span><br>
<span class="lineno">365</span><span class="keyword" id="7271308">var</span>&nbsp;<span class="ident" id="7271312">testString</span>&nbsp;<span class="builtintype" id="7271323">string</span><br>
<span class="lineno"></span><span class="keyword" id="7271330">var</span>&nbsp;<span class="ident" id="7271334">testSlice</span>&nbsp;<span class="op" id="7271344">[</span><span class="op" id="7271345">]</span><span class="builtintype" id="7271346">string</span><br>
<span class="lineno"></span><span class="keyword" id="7271353">var</span>&nbsp;<span class="ident" id="7271357">testMap</span>&nbsp;<span class="keyword" id="7271365">map</span><span class="op" id="7271368">[</span><span class="builtintype" id="7271369">string</span><span class="op" id="7271375">]</span><span class="builtintype" id="7271376">int</span><br>
<span class="lineno"></span><span class="keyword" id="7271380">var</span>&nbsp;<span class="ident" id="7271384">testArray</span>&nbsp;<span class="op" id="7271394">[</span><span class="num" id="7271395">7</span><span class="op" id="7271396">]</span><span class="builtintype" id="7271397">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="7271402">type</span>&nbsp;<span class="ident" id="7271407">SingleTest</span>&nbsp;<span class="keyword" id="7271418">struct</span>&nbsp;<span class="op" id="7271425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271428">in</span>&nbsp;&nbsp;<span class="keyword" id="7271432">interface</span><span class="op" id="7271441">{</span><span class="op" id="7271442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271445">out</span>&nbsp;<span class="keyword" id="7271449">interface</span><span class="op" id="7271458">{</span><span class="op" id="7271459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271462">err</span>&nbsp;<span class="builtintype" id="7271466">string</span><br>
<span class="lineno"></span><span class="op" id="7271473">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="7271476">var</span>&nbsp;<span class="ident" id="7271480">singleTests</span>&nbsp;<span class="op" id="7271492">=</span>&nbsp;<span class="op" id="7271494">[</span><span class="op" id="7271495">]</span><span class="ident" id="7271496">SingleTest</span><span class="op" id="7271506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271509">{</span><span class="num" id="7271510">17</span><span class="op" id="7271512">,</span>&nbsp;<span class="op" id="7271514">&amp;</span><span class="ident" id="7271515">testInt</span><span class="op" id="7271522">,</span>&nbsp;<span class="string" id="7271524">&#34;&#34;</span><span class="op" id="7271526">}</span><span class="op" id="7271527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271530">{</span><span class="builtintype" id="7271531">float32</span><span class="op" id="7271538">(</span><span class="num" id="7271539">17.5</span><span class="op" id="7271543">)</span><span class="op" id="7271544">,</span>&nbsp;<span class="op" id="7271546">&amp;</span><span class="ident" id="7271547">testFloat32</span><span class="op" id="7271558">,</span>&nbsp;<span class="string" id="7271560">&#34;&#34;</span><span class="op" id="7271562">}</span><span class="op" id="7271563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271566">{</span><span class="string" id="7271567">&#34;bike&nbsp;shed&#34;</span><span class="op" id="7271578">,</span>&nbsp;<span class="op" id="7271580">&amp;</span><span class="ident" id="7271581">testString</span><span class="op" id="7271591">,</span>&nbsp;<span class="string" id="7271593">&#34;&#34;</span><span class="op" id="7271595">}</span><span class="op" id="7271596">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271599">{</span><span class="op" id="7271600">[</span><span class="op" id="7271601">]</span><span class="builtintype" id="7271602">string</span><span class="op" id="7271608">{</span><span class="string" id="7271609">&#34;bike&#34;</span><span class="op" id="7271615">,</span>&nbsp;<span class="string" id="7271617">&#34;shed&#34;</span><span class="op" id="7271623">,</span>&nbsp;<span class="string" id="7271625">&#34;paint&#34;</span><span class="op" id="7271632">,</span>&nbsp;<span class="string" id="7271634">&#34;color&#34;</span><span class="op" id="7271641">}</span><span class="op" id="7271642">,</span>&nbsp;<span class="op" id="7271644">&amp;</span><span class="ident" id="7271645">testSlice</span><span class="op" id="7271654">,</span>&nbsp;<span class="string" id="7271656">&#34;&#34;</span><span class="op" id="7271658">}</span><span class="op" id="7271659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271662">{</span><span class="keyword" id="7271663">map</span><span class="op" id="7271666">[</span><span class="builtintype" id="7271667">string</span><span class="op" id="7271673">]</span><span class="builtintype" id="7271674">int</span><span class="op" id="7271677">{</span><span class="string" id="7271678">&#34;seven&#34;</span><span class="op" id="7271685">:</span>&nbsp;<span class="num" id="7271687">7</span><span class="op" id="7271688">,</span>&nbsp;<span class="string" id="7271690">&#34;twelve&#34;</span><span class="op" id="7271698">:</span>&nbsp;<span class="num" id="7271700">12</span><span class="op" id="7271702">}</span><span class="op" id="7271703">,</span>&nbsp;<span class="op" id="7271705">&amp;</span><span class="ident" id="7271706">testMap</span><span class="op" id="7271713">,</span>&nbsp;<span class="string" id="7271715">&#34;&#34;</span><span class="op" id="7271717">}</span><span class="op" id="7271718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271721">{</span><span class="op" id="7271722">[</span><span class="num" id="7271723">7</span><span class="op" id="7271724">]</span><span class="builtintype" id="7271725">int</span><span class="op" id="7271728">{</span><span class="num" id="7271729">4</span><span class="op" id="7271730">,</span>&nbsp;<span class="num" id="7271732">55</span><span class="op" id="7271734">,</span>&nbsp;<span class="num" id="7271736">0</span><span class="op" id="7271737">,</span>&nbsp;<span class="num" id="7271739">0</span><span class="op" id="7271740">,</span>&nbsp;<span class="num" id="7271742">0</span><span class="op" id="7271743">,</span>&nbsp;<span class="num" id="7271745">0</span><span class="op" id="7271746">,</span>&nbsp;<span class="num" id="7271748">0</span><span class="op" id="7271749">}</span><span class="op" id="7271750">,</span>&nbsp;<span class="op" id="7271752">&amp;</span><span class="ident" id="7271753">testArray</span><span class="op" id="7271762">,</span>&nbsp;<span class="string" id="7271764">&#34;&#34;</span><span class="op" id="7271766">}</span><span class="op" id="7271767">,</span>&nbsp;<span class="comment" id="7271769">//&nbsp;case&nbsp;that&nbsp;once&nbsp;triggered&nbsp;a&nbsp;bug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271804">{</span><span class="op" id="7271805">[</span><span class="num" id="7271806">7</span><span class="op" id="7271807">]</span><span class="builtintype" id="7271808">int</span><span class="op" id="7271811">{</span><span class="num" id="7271812">4</span><span class="op" id="7271813">,</span>&nbsp;<span class="num" id="7271815">55</span><span class="op" id="7271817">,</span>&nbsp;<span class="num" id="7271819">1</span><span class="op" id="7271820">,</span>&nbsp;<span class="num" id="7271822">44</span><span class="op" id="7271824">,</span>&nbsp;<span class="num" id="7271826">22</span><span class="op" id="7271828">,</span>&nbsp;<span class="num" id="7271830">66</span><span class="op" id="7271832">,</span>&nbsp;<span class="num" id="7271834">1234</span><span class="op" id="7271838">}</span><span class="op" id="7271839">,</span>&nbsp;<span class="op" id="7271841">&amp;</span><span class="ident" id="7271842">testArray</span><span class="op" id="7271851">,</span>&nbsp;<span class="string" id="7271853">&#34;&#34;</span><span class="op" id="7271855">}</span><span class="op" id="7271856">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7271860">//&nbsp;Decode&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271878">{</span><span class="num" id="7271879">172</span><span class="op" id="7271882">,</span>&nbsp;<span class="op" id="7271884">&amp;</span><span class="ident" id="7271885">testFloat32</span><span class="op" id="7271896">,</span>&nbsp;<span class="string" id="7271898">&#34;type&#34;</span><span class="op" id="7271904">}</span><span class="op" id="7271905">,</span><br>
<span class="lineno"></span><span class="op" id="7271907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7271910">func</span>&nbsp;<span class="ident" id="7271915">TestSingletons</span><span class="op" id="7271929">(</span><span class="ident" id="7271930">t</span>&nbsp;<span class="op" id="7271932">*</span><span class="ident" id="7271933">testing</span><span class="op" id="7271940">.</span><span class="ident" id="7271941">T</span><span class="op" id="7271942">)</span>&nbsp;<span class="op" id="7271944">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271947">b</span>&nbsp;<span class="op" id="7271949">:=</span>&nbsp;<span class="builtinfunc" id="7271952">new</span><span class="op" id="7271955">(</span><span class="ident" id="7271956">bytes</span><span class="op" id="7271961">.</span><span class="ident" id="7271962">Buffer</span><span class="op" id="7271968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271971">enc</span>&nbsp;<span class="op" id="7271975">:=</span>&nbsp;<span class="ident" id="7271978">NewEncoder</span><span class="op" id="7271988">(</span><span class="ident" id="7271989">b</span><span class="op" id="7271990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271993">dec</span>&nbsp;<span class="op" id="7271997">:=</span>&nbsp;<span class="ident" id="7272000">NewDecoder</span><span class="op" id="7272010">(</span><span class="ident" id="7272011">b</span><span class="op" id="7272012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272015">for</span>&nbsp;<span class="ident" id="7272019">_</span><span class="op" id="7272020">,</span>&nbsp;<span class="ident" id="7272022">test</span>&nbsp;<span class="op" id="7272027">:=</span>&nbsp;<span class="keyword" id="7272030">range</span>&nbsp;<span class="ident" id="7272036">singleTests</span>&nbsp;<span class="op" id="7272048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272052">b</span><span class="op" id="7272053">.</span><span class="ident" id="7272054">Reset</span><span class="op" id="7272059">(</span><span class="op" id="7272060">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272064">err</span>&nbsp;<span class="op" id="7272068">:=</span>&nbsp;<span class="ident" id="7272071">enc</span><span class="op" id="7272074">.</span><span class="ident" id="7272075">Encode</span><span class="op" id="7272081">(</span><span class="ident" id="7272082">test</span><span class="op" id="7272086">.</span><span class="ident" id="7272087">in</span><span class="op" id="7272089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272093">if</span>&nbsp;<span class="ident" id="7272096">err</span>&nbsp;<span class="op" id="7272100">!=</span>&nbsp;<span class="builtintype" id="7272103">nil</span>&nbsp;<span class="op" id="7272107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272112">t</span><span class="op" id="7272113">.</span><span class="ident" id="7272114">Errorf</span><span class="op" id="7272120">(</span><span class="string" id="7272121">&#34;error&nbsp;encoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7272144">,</span>&nbsp;<span class="ident" id="7272146">test</span><span class="op" id="7272150">.</span><span class="ident" id="7272151">in</span><span class="op" id="7272153">,</span>&nbsp;<span class="ident" id="7272155">err</span><span class="op" id="7272158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272163">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272174">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272178">err</span>&nbsp;<span class="op" id="7272182">=</span>&nbsp;<span class="ident" id="7272184">dec</span><span class="op" id="7272187">.</span><span class="ident" id="7272188">Decode</span><span class="op" id="7272194">(</span><span class="ident" id="7272195">test</span><span class="op" id="7272199">.</span><span class="ident" id="7272200">out</span><span class="op" id="7272203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272207">switch</span>&nbsp;<span class="op" id="7272214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272218">case</span>&nbsp;<span class="ident" id="7272223">err</span>&nbsp;<span class="op" id="7272227">!=</span>&nbsp;<span class="builtintype" id="7272230">nil</span>&nbsp;<span class="op" id="7272234">&amp;&amp;</span>&nbsp;<span class="ident" id="7272237">test</span><span class="op" id="7272241">.</span><span class="ident" id="7272242">err</span>&nbsp;<span class="op" id="7272246">==</span>&nbsp;<span class="string" id="7272249">&#34;&#34;</span><span class="op" id="7272251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272256">t</span><span class="op" id="7272257">.</span><span class="ident" id="7272258">Errorf</span><span class="op" id="7272264">(</span><span class="string" id="7272265">&#34;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7272288">,</span>&nbsp;<span class="ident" id="7272290">test</span><span class="op" id="7272294">.</span><span class="ident" id="7272295">in</span><span class="op" id="7272297">,</span>&nbsp;<span class="ident" id="7272299">err</span><span class="op" id="7272302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272307">continue</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272318">case</span>&nbsp;<span class="ident" id="7272323">err</span>&nbsp;<span class="op" id="7272327">==</span>&nbsp;<span class="builtintype" id="7272330">nil</span>&nbsp;<span class="op" id="7272334">&amp;&amp;</span>&nbsp;<span class="ident" id="7272337">test</span><span class="op" id="7272341">.</span><span class="ident" id="7272342">err</span>&nbsp;<span class="op" id="7272346">!=</span>&nbsp;<span class="string" id="7272349">&#34;&#34;</span><span class="op" id="7272351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272356">t</span><span class="op" id="7272357">.</span><span class="ident" id="7272358">Errorf</span><span class="op" id="7272364">(</span><span class="string" id="7272365">&#34;expected&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7272397">,</span>&nbsp;<span class="ident" id="7272399">test</span><span class="op" id="7272403">.</span><span class="ident" id="7272404">in</span><span class="op" id="7272406">,</span>&nbsp;<span class="ident" id="7272408">test</span><span class="op" id="7272412">.</span><span class="ident" id="7272413">err</span><span class="op" id="7272416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272421">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272432">case</span>&nbsp;<span class="ident" id="7272437">err</span>&nbsp;<span class="op" id="7272441">!=</span>&nbsp;<span class="builtintype" id="7272444">nil</span>&nbsp;<span class="op" id="7272448">&amp;&amp;</span>&nbsp;<span class="ident" id="7272451">test</span><span class="op" id="7272455">.</span><span class="ident" id="7272456">err</span>&nbsp;<span class="op" id="7272460">!=</span>&nbsp;<span class="string" id="7272463">&#34;&#34;</span><span class="op" id="7272465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272470">if</span>&nbsp;<span class="ident" id="7272473">strings</span><span class="op" id="7272480">.</span><span class="ident" id="7272481">Index</span><span class="op" id="7272486">(</span><span class="ident" id="7272487">err</span><span class="op" id="7272490">.</span><span class="ident" id="7272491">Error</span><span class="op" id="7272496">(</span><span class="op" id="7272497">)</span><span class="op" id="7272498">,</span>&nbsp;<span class="ident" id="7272500">test</span><span class="op" id="7272504">.</span><span class="ident" id="7272505">err</span><span class="op" id="7272508">)</span>&nbsp;<span class="op" id="7272510">&lt;</span>&nbsp;<span class="num" id="7272512">0</span>&nbsp;<span class="op" id="7272514">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272520">t</span><span class="op" id="7272521">.</span><span class="ident" id="7272522">Errorf</span><span class="op" id="7272528">(</span><span class="string" id="7272529">&#34;wrong&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;wanted&nbsp;%s,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7272573">,</span>&nbsp;<span class="ident" id="7272575">test</span><span class="op" id="7272579">.</span><span class="ident" id="7272580">in</span><span class="op" id="7272582">,</span>&nbsp;<span class="ident" id="7272584">test</span><span class="op" id="7272588">.</span><span class="ident" id="7272589">err</span><span class="op" id="7272592">,</span>&nbsp;<span class="ident" id="7272594">err</span><span class="op" id="7272597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272607">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7272622">//&nbsp;Get&nbsp;rid&nbsp;of&nbsp;the&nbsp;pointer&nbsp;in&nbsp;the&nbsp;rhs</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272661">val</span>&nbsp;<span class="op" id="7272665">:=</span>&nbsp;<span class="ident" id="7272668">reflect</span><span class="op" id="7272675">.</span><span class="ident" id="7272676">ValueOf</span><span class="op" id="7272683">(</span><span class="ident" id="7272684">test</span><span class="op" id="7272688">.</span><span class="ident" id="7272689">out</span><span class="op" id="7272692">)</span><span class="op" id="7272693">.</span><span class="ident" id="7272694">Elem</span><span class="op" id="7272698">(</span><span class="op" id="7272699">)</span><span class="op" id="7272700">.</span><span class="ident" id="7272701">Interface</span><span class="op" id="7272710">(</span><span class="op" id="7272711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272715">if</span>&nbsp;<span class="op" id="7272718">!</span><span class="ident" id="7272719">reflect</span><span class="op" id="7272726">.</span><span class="ident" id="7272727">DeepEqual</span><span class="op" id="7272736">(</span><span class="ident" id="7272737">test</span><span class="op" id="7272741">.</span><span class="ident" id="7272742">in</span><span class="op" id="7272744">,</span>&nbsp;<span class="ident" id="7272746">val</span><span class="op" id="7272749">)</span>&nbsp;<span class="op" id="7272751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272756">t</span><span class="op" id="7272757">.</span><span class="ident" id="7272758">Errorf</span><span class="op" id="7272764">(</span><span class="string" id="7272765">&#34;decoding&nbsp;singleton:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7272805">,</span>&nbsp;<span class="ident" id="7272807">test</span><span class="op" id="7272811">.</span><span class="ident" id="7272812">in</span><span class="op" id="7272814">,</span>&nbsp;<span class="ident" id="7272816">val</span><span class="op" id="7272819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272826">}</span><br>
<span class="lineno">420</span><span class="op" id="7272828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7272831">func</span>&nbsp;<span class="ident" id="7272836">TestStructNonStruct</span><span class="op" id="7272855">(</span><span class="ident" id="7272856">t</span>&nbsp;<span class="op" id="7272858">*</span><span class="ident" id="7272859">testing</span><span class="op" id="7272866">.</span><span class="ident" id="7272867">T</span><span class="op" id="7272868">)</span>&nbsp;<span class="op" id="7272870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272873">type</span>&nbsp;<span class="ident" id="7272878">Struct</span>&nbsp;<span class="keyword" id="7272885">struct</span>&nbsp;<span class="op" id="7272892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272896">A</span>&nbsp;<span class="builtintype" id="7272898">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7272906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272909">type</span>&nbsp;<span class="ident" id="7272914">NonStruct</span>&nbsp;<span class="builtintype" id="7272924">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7272932">s</span>&nbsp;<span class="op" id="7272934">:=</span>&nbsp;<span class="ident" id="7272937">Struct</span><span class="op" id="7272943">{</span><span class="string" id="7272944">&#34;hello&#34;</span><span class="op" id="7272951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272954">var</span>&nbsp;<span class="ident" id="7272958">sp</span>&nbsp;<span class="ident" id="7272961">Struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7272969">if</span>&nbsp;<span class="ident" id="7272972">err</span>&nbsp;<span class="op" id="7272976">:=</span>&nbsp;<span class="ident" id="7272979">encAndDec</span><span class="op" id="7272988">(</span><span class="ident" id="7272989">s</span><span class="op" id="7272990">,</span>&nbsp;<span class="op" id="7272992">&amp;</span><span class="ident" id="7272993">sp</span><span class="op" id="7272995">)</span><span class="op" id="7272996">;</span>&nbsp;<span class="ident" id="7272998">err</span>&nbsp;<span class="op" id="7273002">!=</span>&nbsp;<span class="builtintype" id="7273005">nil</span>&nbsp;<span class="op" id="7273009">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273013">t</span><span class="op" id="7273014">.</span><span class="ident" id="7273015">Error</span><span class="op" id="7273020">(</span><span class="ident" id="7273021">err</span><span class="op" id="7273024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273030">var</span>&nbsp;<span class="ident" id="7273034">ns</span>&nbsp;<span class="ident" id="7273037">NonStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273048">if</span>&nbsp;<span class="ident" id="7273051">err</span>&nbsp;<span class="op" id="7273055">:=</span>&nbsp;<span class="ident" id="7273058">encAndDec</span><span class="op" id="7273067">(</span><span class="ident" id="7273068">s</span><span class="op" id="7273069">,</span>&nbsp;<span class="op" id="7273071">&amp;</span><span class="ident" id="7273072">ns</span><span class="op" id="7273074">)</span><span class="op" id="7273075">;</span>&nbsp;<span class="ident" id="7273077">err</span>&nbsp;<span class="op" id="7273081">==</span>&nbsp;<span class="builtintype" id="7273084">nil</span>&nbsp;<span class="op" id="7273088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273092">t</span><span class="op" id="7273093">.</span><span class="ident" id="7273094">Error</span><span class="op" id="7273099">(</span><span class="string" id="7273100">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;struct/non-struct&#34;</span><span class="op" id="7273140">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273143">}</span>&nbsp;<span class="keyword" id="7273145">else</span>&nbsp;<span class="keyword" id="7273150">if</span>&nbsp;<span class="ident" id="7273153">strings</span><span class="op" id="7273160">.</span><span class="ident" id="7273161">Index</span><span class="op" id="7273166">(</span><span class="ident" id="7273167">err</span><span class="op" id="7273170">.</span><span class="ident" id="7273171">Error</span><span class="op" id="7273176">(</span><span class="op" id="7273177">)</span><span class="op" id="7273178">,</span>&nbsp;<span class="string" id="7273180">&#34;type&#34;</span><span class="op" id="7273186">)</span>&nbsp;<span class="op" id="7273188">&lt;</span>&nbsp;<span class="num" id="7273190">0</span>&nbsp;<span class="op" id="7273192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273196">t</span><span class="op" id="7273197">.</span><span class="ident" id="7273198">Error</span><span class="op" id="7273203">(</span><span class="string" id="7273204">&#34;for&nbsp;struct/non-struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7273252">,</span>&nbsp;<span class="ident" id="7273254">err</span><span class="op" id="7273257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7273263">//&nbsp;Now&nbsp;try&nbsp;the&nbsp;other&nbsp;way</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273289">var</span>&nbsp;<span class="ident" id="7273293">nsp</span>&nbsp;<span class="ident" id="7273297">NonStruct</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273308">if</span>&nbsp;<span class="ident" id="7273311">err</span>&nbsp;<span class="op" id="7273315">:=</span>&nbsp;<span class="ident" id="7273318">encAndDec</span><span class="op" id="7273327">(</span><span class="ident" id="7273328">ns</span><span class="op" id="7273330">,</span>&nbsp;<span class="op" id="7273332">&amp;</span><span class="ident" id="7273333">nsp</span><span class="op" id="7273336">)</span><span class="op" id="7273337">;</span>&nbsp;<span class="ident" id="7273339">err</span>&nbsp;<span class="op" id="7273343">!=</span>&nbsp;<span class="builtintype" id="7273346">nil</span>&nbsp;<span class="op" id="7273350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273354">t</span><span class="op" id="7273355">.</span><span class="ident" id="7273356">Error</span><span class="op" id="7273361">(</span><span class="ident" id="7273362">err</span><span class="op" id="7273365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273371">if</span>&nbsp;<span class="ident" id="7273374">err</span>&nbsp;<span class="op" id="7273378">:=</span>&nbsp;<span class="ident" id="7273381">encAndDec</span><span class="op" id="7273390">(</span><span class="ident" id="7273391">ns</span><span class="op" id="7273393">,</span>&nbsp;<span class="op" id="7273395">&amp;</span><span class="ident" id="7273396">s</span><span class="op" id="7273397">)</span><span class="op" id="7273398">;</span>&nbsp;<span class="ident" id="7273400">err</span>&nbsp;<span class="op" id="7273404">==</span>&nbsp;<span class="builtintype" id="7273407">nil</span>&nbsp;<span class="op" id="7273411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273415">t</span><span class="op" id="7273416">.</span><span class="ident" id="7273417">Error</span><span class="op" id="7273422">(</span><span class="string" id="7273423">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;non-struct/struct&#34;</span><span class="op" id="7273463">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273466">}</span>&nbsp;<span class="keyword" id="7273468">else</span>&nbsp;<span class="keyword" id="7273473">if</span>&nbsp;<span class="ident" id="7273476">strings</span><span class="op" id="7273483">.</span><span class="ident" id="7273484">Index</span><span class="op" id="7273489">(</span><span class="ident" id="7273490">err</span><span class="op" id="7273493">.</span><span class="ident" id="7273494">Error</span><span class="op" id="7273499">(</span><span class="op" id="7273500">)</span><span class="op" id="7273501">,</span>&nbsp;<span class="string" id="7273503">&#34;type&#34;</span><span class="op" id="7273509">)</span>&nbsp;<span class="op" id="7273511">&lt;</span>&nbsp;<span class="num" id="7273513">0</span>&nbsp;<span class="op" id="7273515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273519">t</span><span class="op" id="7273520">.</span><span class="ident" id="7273521">Error</span><span class="op" id="7273526">(</span><span class="string" id="7273527">&#34;for&nbsp;non-struct/struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7273575">,</span>&nbsp;<span class="ident" id="7273577">err</span><span class="op" id="7273580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7273583">}</span><br>
<span class="lineno"></span><span class="op" id="7273585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span><span class="keyword" id="7273588">type</span>&nbsp;<span class="ident" id="7273593">interfaceIndirectTestI</span>&nbsp;<span class="keyword" id="7273616">interface</span>&nbsp;<span class="op" id="7273626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273629">F</span><span class="op" id="7273630">(</span><span class="op" id="7273631">)</span>&nbsp;<span class="builtintype" id="7273633">bool</span><br>
<span class="lineno"></span><span class="op" id="7273638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7273641">type</span>&nbsp;<span class="ident" id="7273646">interfaceIndirectTestT</span>&nbsp;<span class="keyword" id="7273669">struct</span><span class="op" id="7273675">{</span><span class="op" id="7273676">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="7273679">func</span>&nbsp;<span class="op" id="7273684">(</span><span class="ident" id="7273685">this</span>&nbsp;<span class="op" id="7273690">*</span><span class="ident" id="7273691">interfaceIndirectTestT</span><span class="op" id="7273713">)</span>&nbsp;<span class="ident" id="7273715">F</span><span class="op" id="7273716">(</span><span class="op" id="7273717">)</span>&nbsp;<span class="builtintype" id="7273719">bool</span>&nbsp;<span class="op" id="7273724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7273727">return</span>&nbsp;<span class="builtintype" id="7273734">true</span><br>
<span class="lineno"></span><span class="op" id="7273739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="comment" id="7273742">//&nbsp;A&nbsp;version&nbsp;of&nbsp;a&nbsp;bug&nbsp;reported&nbsp;on&nbsp;golang-nuts.&nbsp;&nbsp;Also&nbsp;tests&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="7273811">//&nbsp;slice&nbsp;of&nbsp;interfaces.&nbsp;&nbsp;The&nbsp;issue&nbsp;was&nbsp;registering&nbsp;*T&nbsp;caused&nbsp;T&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="7273880">//&nbsp;stored&nbsp;as&nbsp;the&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="7273912">func</span>&nbsp;<span class="ident" id="7273917">TestInterfaceIndirect</span><span class="op" id="7273938">(</span><span class="ident" id="7273939">t</span>&nbsp;<span class="op" id="7273941">*</span><span class="ident" id="7273942">testing</span><span class="op" id="7273949">.</span><span class="ident" id="7273950">T</span><span class="op" id="7273951">)</span>&nbsp;<span class="op" id="7273953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273956">Register</span><span class="op" id="7273964">(</span><span class="op" id="7273965">&amp;</span><span class="ident" id="7273966">interfaceIndirectTestT</span><span class="op" id="7273988">{</span><span class="op" id="7273989">}</span><span class="op" id="7273990">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7273993">b</span>&nbsp;<span class="op" id="7273995">:=</span>&nbsp;<span class="builtinfunc" id="7273998">new</span><span class="op" id="7274001">(</span><span class="ident" id="7274002">bytes</span><span class="op" id="7274007">.</span><span class="ident" id="7274008">Buffer</span><span class="op" id="7274014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274017">w</span>&nbsp;<span class="op" id="7274019">:=</span>&nbsp;<span class="op" id="7274022">[</span><span class="op" id="7274023">]</span><span class="ident" id="7274024">interfaceIndirectTestI</span><span class="op" id="7274046">{</span><span class="op" id="7274047">&amp;</span><span class="ident" id="7274048">interfaceIndirectTestT</span><span class="op" id="7274070">{</span><span class="op" id="7274071">}</span><span class="op" id="7274072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274075">err</span>&nbsp;<span class="op" id="7274079">:=</span>&nbsp;<span class="ident" id="7274082">NewEncoder</span><span class="op" id="7274092">(</span><span class="ident" id="7274093">b</span><span class="op" id="7274094">)</span><span class="op" id="7274095">.</span><span class="ident" id="7274096">Encode</span><span class="op" id="7274102">(</span><span class="ident" id="7274103">w</span><span class="op" id="7274104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274107">if</span>&nbsp;<span class="ident" id="7274110">err</span>&nbsp;<span class="op" id="7274114">!=</span>&nbsp;<span class="builtintype" id="7274117">nil</span>&nbsp;<span class="op" id="7274121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274125">t</span><span class="op" id="7274126">.</span><span class="ident" id="7274127">Fatal</span><span class="op" id="7274132">(</span><span class="string" id="7274133">&#34;encode&nbsp;error:&#34;</span><span class="op" id="7274148">,</span>&nbsp;<span class="ident" id="7274150">err</span><span class="op" id="7274153">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274160">var</span>&nbsp;<span class="ident" id="7274164">r</span>&nbsp;<span class="op" id="7274166">[</span><span class="op" id="7274167">]</span><span class="ident" id="7274168">interfaceIndirectTestI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274192">err</span>&nbsp;<span class="op" id="7274196">=</span>&nbsp;<span class="ident" id="7274198">NewDecoder</span><span class="op" id="7274208">(</span><span class="ident" id="7274209">b</span><span class="op" id="7274210">)</span><span class="op" id="7274211">.</span><span class="ident" id="7274212">Decode</span><span class="op" id="7274218">(</span><span class="op" id="7274219">&amp;</span><span class="ident" id="7274220">r</span><span class="op" id="7274221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7274224">if</span>&nbsp;<span class="ident" id="7274227">err</span>&nbsp;<span class="op" id="7274231">!=</span>&nbsp;<span class="builtintype" id="7274234">nil</span>&nbsp;<span class="op" id="7274238">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274242">t</span><span class="op" id="7274243">.</span><span class="ident" id="7274244">Fatal</span><span class="op" id="7274249">(</span><span class="string" id="7274250">&#34;decode&nbsp;error:&#34;</span><span class="op" id="7274265">,</span>&nbsp;<span class="ident" id="7274267">err</span><span class="op" id="7274270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274273">}</span><br>
<span class="lineno"></span><span class="op" id="7274275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7274278">//&nbsp;Now&nbsp;follow&nbsp;various&nbsp;tests&nbsp;that&nbsp;decode&nbsp;into&nbsp;things&nbsp;that&nbsp;can&#39;t&nbsp;represent&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="7274355">//&nbsp;encoded&nbsp;value,&nbsp;all&nbsp;of&nbsp;which&nbsp;should&nbsp;be&nbsp;legal.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7274404">//&nbsp;Also,&nbsp;when&nbsp;the&nbsp;ignored&nbsp;object&nbsp;contains&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;may&nbsp;define</span><br>
<span class="lineno"></span><span class="comment" id="7274480">//&nbsp;types.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;skipping&nbsp;the&nbsp;value&nbsp;still&nbsp;defines&nbsp;the&nbsp;types&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="7274557">//&nbsp;the&nbsp;encoder/decoder&nbsp;pair&nbsp;to&nbsp;send&nbsp;a&nbsp;value&nbsp;afterwards.&nbsp;&nbsp;If&nbsp;an&nbsp;interface</span><br>
<span class="lineno">485</span><span class="comment" id="7274630">//&nbsp;is&nbsp;sent,&nbsp;its&nbsp;type&nbsp;in&nbsp;the&nbsp;test&nbsp;is&nbsp;always&nbsp;NewType0,&nbsp;so&nbsp;this&nbsp;checks&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7274707">//&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;don&#39;t&nbsp;skew&nbsp;with&nbsp;respect&nbsp;to&nbsp;type&nbsp;definitions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7274776">type</span>&nbsp;<span class="ident" id="7274781">Struct0</span>&nbsp;<span class="keyword" id="7274789">struct</span>&nbsp;<span class="op" id="7274796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274799">I</span>&nbsp;<span class="keyword" id="7274801">interface</span><span class="op" id="7274810">{</span><span class="op" id="7274811">}</span><br>
<span class="lineno">490</span><span class="op" id="7274813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7274816">type</span>&nbsp;<span class="ident" id="7274821">NewType0</span>&nbsp;<span class="keyword" id="7274830">struct</span>&nbsp;<span class="op" id="7274837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274840">S</span>&nbsp;<span class="builtintype" id="7274842">string</span><br>
<span class="lineno"></span><span class="op" id="7274849">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="7274852">type</span>&nbsp;<span class="ident" id="7274857">ignoreTest</span>&nbsp;<span class="keyword" id="7274868">struct</span>&nbsp;<span class="op" id="7274875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7274878">in</span><span class="op" id="7274880">,</span>&nbsp;<span class="ident" id="7274882">out</span>&nbsp;<span class="keyword" id="7274886">interface</span><span class="op" id="7274895">{</span><span class="op" id="7274896">}</span><br>
<span class="lineno"></span><span class="op" id="7274898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="7274901">var</span>&nbsp;<span class="ident" id="7274905">ignoreTests</span>&nbsp;<span class="op" id="7274917">=</span>&nbsp;<span class="op" id="7274919">[</span><span class="op" id="7274920">]</span><span class="ident" id="7274921">ignoreTest</span><span class="op" id="7274931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7274934">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;an&nbsp;empty&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7274980">{</span><span class="op" id="7274981">&amp;</span><span class="keyword" id="7274982">struct</span><span class="op" id="7274988">{</span>&nbsp;<span class="ident" id="7274990">A</span>&nbsp;<span class="builtintype" id="7274992">int</span>&nbsp;<span class="op" id="7274996">}</span><span class="op" id="7274997">{</span><span class="num" id="7274998">23</span><span class="op" id="7275000">}</span><span class="op" id="7275001">,</span>&nbsp;<span class="op" id="7275003">&amp;</span><span class="keyword" id="7275004">struct</span><span class="op" id="7275010">{</span><span class="op" id="7275011">}</span><span class="op" id="7275012">{</span><span class="op" id="7275013">}</span><span class="op" id="7275014">}</span><span class="op" id="7275015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275018">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275055">{</span><span class="op" id="7275056">&amp;</span><span class="keyword" id="7275057">struct</span><span class="op" id="7275063">{</span>&nbsp;<span class="ident" id="7275065">A</span>&nbsp;<span class="builtintype" id="7275067">int</span>&nbsp;<span class="op" id="7275071">}</span><span class="op" id="7275072">{</span><span class="num" id="7275073">23</span><span class="op" id="7275075">}</span><span class="op" id="7275076">,</span>&nbsp;<span class="builtintype" id="7275078">nil</span><span class="op" id="7275081">}</span><span class="op" id="7275082">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275085">//&nbsp;Decode&nbsp;singleton&nbsp;string&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275125">{</span><span class="string" id="7275126">&#34;hello,&nbsp;world&#34;</span><span class="op" id="7275140">,</span>&nbsp;<span class="builtintype" id="7275142">nil</span><span class="op" id="7275145">}</span><span class="op" id="7275146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275149">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275188">{</span><span class="op" id="7275189">[</span><span class="op" id="7275190">]</span><span class="builtintype" id="7275191">int</span><span class="op" id="7275194">{</span><span class="num" id="7275195">1</span><span class="op" id="7275196">,</span>&nbsp;<span class="num" id="7275198">2</span><span class="op" id="7275199">,</span>&nbsp;<span class="num" id="7275201">3</span><span class="op" id="7275202">,</span>&nbsp;<span class="num" id="7275204">4</span><span class="op" id="7275205">}</span><span class="op" id="7275206">,</span>&nbsp;<span class="builtintype" id="7275208">nil</span><span class="op" id="7275211">}</span><span class="op" id="7275212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275215">//&nbsp;Decode&nbsp;struct&nbsp;containing&nbsp;an&nbsp;interface&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275269">{</span><span class="op" id="7275270">&amp;</span><span class="ident" id="7275271">Struct0</span><span class="op" id="7275278">{</span><span class="op" id="7275279">&amp;</span><span class="ident" id="7275280">NewType0</span><span class="op" id="7275288">{</span><span class="string" id="7275289">&#34;value0&#34;</span><span class="op" id="7275297">}</span><span class="op" id="7275298">}</span><span class="op" id="7275299">,</span>&nbsp;<span class="builtintype" id="7275301">nil</span><span class="op" id="7275304">}</span><span class="op" id="7275305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275308">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;of&nbsp;interfaces&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275361">{</span><span class="op" id="7275362">[</span><span class="op" id="7275363">]</span><span class="keyword" id="7275364">interface</span><span class="op" id="7275373">{</span><span class="op" id="7275374">}</span><span class="op" id="7275375">{</span><span class="string" id="7275376">&#34;hi&#34;</span><span class="op" id="7275380">,</span>&nbsp;<span class="op" id="7275382">&amp;</span><span class="ident" id="7275383">NewType0</span><span class="op" id="7275391">{</span><span class="string" id="7275392">&#34;value1&#34;</span><span class="op" id="7275400">}</span><span class="op" id="7275401">,</span>&nbsp;<span class="num" id="7275403">23</span><span class="op" id="7275405">}</span><span class="op" id="7275406">,</span>&nbsp;<span class="builtintype" id="7275408">nil</span><span class="op" id="7275411">}</span><span class="op" id="7275412">,</span><br>
<span class="lineno"></span><span class="op" id="7275414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7275417">func</span>&nbsp;<span class="ident" id="7275422">TestDecodeIntoNothing</span><span class="op" id="7275443">(</span><span class="ident" id="7275444">t</span>&nbsp;<span class="op" id="7275446">*</span><span class="ident" id="7275447">testing</span><span class="op" id="7275454">.</span><span class="ident" id="7275455">T</span><span class="op" id="7275456">)</span>&nbsp;<span class="op" id="7275458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275461">Register</span><span class="op" id="7275469">(</span><span class="builtinfunc" id="7275470">new</span><span class="op" id="7275473">(</span><span class="ident" id="7275474">NewType0</span><span class="op" id="7275482">)</span><span class="op" id="7275483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275486">for</span>&nbsp;<span class="ident" id="7275490">i</span><span class="op" id="7275491">,</span>&nbsp;<span class="ident" id="7275493">test</span>&nbsp;<span class="op" id="7275498">:=</span>&nbsp;<span class="keyword" id="7275501">range</span>&nbsp;<span class="ident" id="7275507">ignoreTests</span>&nbsp;<span class="op" id="7275519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275523">b</span>&nbsp;<span class="op" id="7275525">:=</span>&nbsp;<span class="builtinfunc" id="7275528">new</span><span class="op" id="7275531">(</span><span class="ident" id="7275532">bytes</span><span class="op" id="7275537">.</span><span class="ident" id="7275538">Buffer</span><span class="op" id="7275544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275548">enc</span>&nbsp;<span class="op" id="7275552">:=</span>&nbsp;<span class="ident" id="7275555">NewEncoder</span><span class="op" id="7275565">(</span><span class="ident" id="7275566">b</span><span class="op" id="7275567">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275571">err</span>&nbsp;<span class="op" id="7275575">:=</span>&nbsp;<span class="ident" id="7275578">enc</span><span class="op" id="7275581">.</span><span class="ident" id="7275582">Encode</span><span class="op" id="7275588">(</span><span class="ident" id="7275589">test</span><span class="op" id="7275593">.</span><span class="ident" id="7275594">in</span><span class="op" id="7275596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275600">if</span>&nbsp;<span class="ident" id="7275603">err</span>&nbsp;<span class="op" id="7275607">!=</span>&nbsp;<span class="builtintype" id="7275610">nil</span>&nbsp;<span class="op" id="7275614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275619">t</span><span class="op" id="7275620">.</span><span class="ident" id="7275621">Errorf</span><span class="op" id="7275627">(</span><span class="string" id="7275628">&#34;%d:&nbsp;encode&nbsp;error&nbsp;%s:&#34;</span><span class="op" id="7275650">,</span>&nbsp;<span class="ident" id="7275652">i</span><span class="op" id="7275653">,</span>&nbsp;<span class="ident" id="7275655">err</span><span class="op" id="7275658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275663">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275674">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275678">dec</span>&nbsp;<span class="op" id="7275682">:=</span>&nbsp;<span class="ident" id="7275685">NewDecoder</span><span class="op" id="7275695">(</span><span class="ident" id="7275696">b</span><span class="op" id="7275697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275701">err</span>&nbsp;<span class="op" id="7275705">=</span>&nbsp;<span class="ident" id="7275707">dec</span><span class="op" id="7275710">.</span><span class="ident" id="7275711">Decode</span><span class="op" id="7275717">(</span><span class="ident" id="7275718">test</span><span class="op" id="7275722">.</span><span class="ident" id="7275723">out</span><span class="op" id="7275726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275730">if</span>&nbsp;<span class="ident" id="7275733">err</span>&nbsp;<span class="op" id="7275737">!=</span>&nbsp;<span class="builtintype" id="7275740">nil</span>&nbsp;<span class="op" id="7275744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275749">t</span><span class="op" id="7275750">.</span><span class="ident" id="7275751">Errorf</span><span class="op" id="7275757">(</span><span class="string" id="7275758">&#34;%d:&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7275780">,</span>&nbsp;<span class="ident" id="7275782">i</span><span class="op" id="7275783">,</span>&nbsp;<span class="ident" id="7275785">err</span><span class="op" id="7275788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275793">continue</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7275804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7275808">//&nbsp;Now&nbsp;see&nbsp;if&nbsp;the&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275875">str</span>&nbsp;<span class="op" id="7275879">:=</span>&nbsp;<span class="ident" id="7275882">fmt</span><span class="op" id="7275885">.</span><span class="ident" id="7275886">Sprintf</span><span class="op" id="7275893">(</span><span class="string" id="7275894">&#34;Value&nbsp;%d&#34;</span><span class="op" id="7275904">,</span>&nbsp;<span class="ident" id="7275906">i</span><span class="op" id="7275907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275911">err</span>&nbsp;<span class="op" id="7275915">=</span>&nbsp;<span class="ident" id="7275917">enc</span><span class="op" id="7275920">.</span><span class="ident" id="7275921">Encode</span><span class="op" id="7275927">(</span><span class="op" id="7275928">&amp;</span><span class="ident" id="7275929">NewType0</span><span class="op" id="7275937">{</span><span class="ident" id="7275938">str</span><span class="op" id="7275941">}</span><span class="op" id="7275942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7275946">if</span>&nbsp;<span class="ident" id="7275949">err</span>&nbsp;<span class="op" id="7275953">!=</span>&nbsp;<span class="builtintype" id="7275956">nil</span>&nbsp;<span class="op" id="7275960">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7275965">t</span><span class="op" id="7275966">.</span><span class="ident" id="7275967">Fatalf</span><span class="op" id="7275973">(</span><span class="string" id="7275974">&#34;%d:&nbsp;NewType0&nbsp;encode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7276005">,</span>&nbsp;<span class="ident" id="7276007">i</span><span class="op" id="7276008">,</span>&nbsp;<span class="ident" id="7276010">err</span><span class="op" id="7276013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276021">ns</span>&nbsp;<span class="op" id="7276024">:=</span>&nbsp;<span class="builtinfunc" id="7276027">new</span><span class="op" id="7276030">(</span><span class="ident" id="7276031">NewType0</span><span class="op" id="7276039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276043">err</span>&nbsp;<span class="op" id="7276047">=</span>&nbsp;<span class="ident" id="7276049">dec</span><span class="op" id="7276052">.</span><span class="ident" id="7276053">Decode</span><span class="op" id="7276059">(</span><span class="ident" id="7276060">ns</span><span class="op" id="7276062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276066">if</span>&nbsp;<span class="ident" id="7276069">err</span>&nbsp;<span class="op" id="7276073">!=</span>&nbsp;<span class="builtintype" id="7276076">nil</span>&nbsp;<span class="op" id="7276080">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276085">t</span><span class="op" id="7276086">.</span><span class="ident" id="7276087">Fatalf</span><span class="op" id="7276093">(</span><span class="string" id="7276094">&#34;%d:&nbsp;NewType0&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7276125">,</span>&nbsp;<span class="ident" id="7276127">i</span><span class="op" id="7276128">,</span>&nbsp;<span class="ident" id="7276130">err</span><span class="op" id="7276133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276141">if</span>&nbsp;<span class="ident" id="7276144">ns</span><span class="op" id="7276146">.</span><span class="ident" id="7276147">S</span>&nbsp;<span class="op" id="7276149">!=</span>&nbsp;<span class="ident" id="7276152">str</span>&nbsp;<span class="op" id="7276156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276161">t</span><span class="op" id="7276162">.</span><span class="ident" id="7276163">Fatalf</span><span class="op" id="7276169">(</span><span class="string" id="7276170">&#34;%d:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7276194">,</span>&nbsp;<span class="ident" id="7276196">i</span><span class="op" id="7276197">,</span>&nbsp;<span class="ident" id="7276199">str</span><span class="op" id="7276202">,</span>&nbsp;<span class="ident" id="7276204">ns</span><span class="op" id="7276206">.</span><span class="ident" id="7276207">S</span><span class="op" id="7276208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276212">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276215">}</span><br>
<span class="lineno"></span><span class="op" id="7276217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7276220">//&nbsp;Another&nbsp;bug&nbsp;from&nbsp;golang-nuts,&nbsp;involving&nbsp;nested&nbsp;interfaces.</span><br>
<span class="lineno"></span><span class="keyword" id="7276282">type</span>&nbsp;<span class="ident" id="7276287">Bug0Outer</span>&nbsp;<span class="keyword" id="7276297">struct</span>&nbsp;<span class="op" id="7276304">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276307">Bug0Field</span>&nbsp;<span class="keyword" id="7276317">interface</span><span class="op" id="7276326">{</span><span class="op" id="7276327">}</span><br>
<span class="lineno"></span><span class="op" id="7276329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7276332">type</span>&nbsp;<span class="ident" id="7276337">Bug0Inner</span>&nbsp;<span class="keyword" id="7276347">struct</span>&nbsp;<span class="op" id="7276354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276357">A</span>&nbsp;<span class="builtintype" id="7276359">int</span><br>
<span class="lineno">555</span><span class="op" id="7276363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7276366">func</span>&nbsp;<span class="ident" id="7276371">TestNestedInterfaces</span><span class="op" id="7276391">(</span><span class="ident" id="7276392">t</span>&nbsp;<span class="op" id="7276394">*</span><span class="ident" id="7276395">testing</span><span class="op" id="7276402">.</span><span class="ident" id="7276403">T</span><span class="op" id="7276404">)</span>&nbsp;<span class="op" id="7276406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276409">var</span>&nbsp;<span class="ident" id="7276413">buf</span>&nbsp;<span class="ident" id="7276417">bytes</span><span class="op" id="7276422">.</span><span class="ident" id="7276423">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276431">e</span>&nbsp;<span class="op" id="7276433">:=</span>&nbsp;<span class="ident" id="7276436">NewEncoder</span><span class="op" id="7276446">(</span><span class="op" id="7276447">&amp;</span><span class="ident" id="7276448">buf</span><span class="op" id="7276451">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276454">d</span>&nbsp;<span class="op" id="7276456">:=</span>&nbsp;<span class="ident" id="7276459">NewDecoder</span><span class="op" id="7276469">(</span><span class="op" id="7276470">&amp;</span><span class="ident" id="7276471">buf</span><span class="op" id="7276474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276477">Register</span><span class="op" id="7276485">(</span><span class="builtinfunc" id="7276486">new</span><span class="op" id="7276489">(</span><span class="ident" id="7276490">Bug0Outer</span><span class="op" id="7276499">)</span><span class="op" id="7276500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276503">Register</span><span class="op" id="7276511">(</span><span class="builtinfunc" id="7276512">new</span><span class="op" id="7276515">(</span><span class="ident" id="7276516">Bug0Inner</span><span class="op" id="7276525">)</span><span class="op" id="7276526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276529">f</span>&nbsp;<span class="op" id="7276531">:=</span>&nbsp;<span class="op" id="7276534">&amp;</span><span class="ident" id="7276535">Bug0Outer</span><span class="op" id="7276544">{</span><span class="op" id="7276545">&amp;</span><span class="ident" id="7276546">Bug0Outer</span><span class="op" id="7276555">{</span><span class="op" id="7276556">&amp;</span><span class="ident" id="7276557">Bug0Inner</span><span class="op" id="7276566">{</span><span class="num" id="7276567">7</span><span class="op" id="7276568">}</span><span class="op" id="7276569">}</span><span class="op" id="7276570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276573">var</span>&nbsp;<span class="ident" id="7276577">v</span>&nbsp;<span class="keyword" id="7276579">interface</span><span class="op" id="7276588">{</span><span class="op" id="7276589">}</span>&nbsp;<span class="op" id="7276591">=</span>&nbsp;<span class="ident" id="7276593">f</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276596">err</span>&nbsp;<span class="op" id="7276600">:=</span>&nbsp;<span class="ident" id="7276603">e</span><span class="op" id="7276604">.</span><span class="ident" id="7276605">Encode</span><span class="op" id="7276611">(</span><span class="op" id="7276612">&amp;</span><span class="ident" id="7276613">v</span><span class="op" id="7276614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276617">if</span>&nbsp;<span class="ident" id="7276620">err</span>&nbsp;<span class="op" id="7276624">!=</span>&nbsp;<span class="builtintype" id="7276627">nil</span>&nbsp;<span class="op" id="7276631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276635">t</span><span class="op" id="7276636">.</span><span class="ident" id="7276637">Fatal</span><span class="op" id="7276642">(</span><span class="string" id="7276643">&#34;Encode:&#34;</span><span class="op" id="7276652">,</span>&nbsp;<span class="ident" id="7276654">err</span><span class="op" id="7276657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276663">err</span>&nbsp;<span class="op" id="7276667">=</span>&nbsp;<span class="ident" id="7276669">d</span><span class="op" id="7276670">.</span><span class="ident" id="7276671">Decode</span><span class="op" id="7276677">(</span><span class="op" id="7276678">&amp;</span><span class="ident" id="7276679">v</span><span class="op" id="7276680">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276683">if</span>&nbsp;<span class="ident" id="7276686">err</span>&nbsp;<span class="op" id="7276690">!=</span>&nbsp;<span class="builtintype" id="7276693">nil</span>&nbsp;<span class="op" id="7276697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276701">t</span><span class="op" id="7276702">.</span><span class="ident" id="7276703">Fatal</span><span class="op" id="7276708">(</span><span class="string" id="7276709">&#34;Decode:&#34;</span><span class="op" id="7276718">,</span>&nbsp;<span class="ident" id="7276720">err</span><span class="op" id="7276723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7276729">//&nbsp;Make&nbsp;sure&nbsp;it&nbsp;decoded&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276765">outer1</span><span class="op" id="7276771">,</span>&nbsp;<span class="ident" id="7276773">ok</span>&nbsp;<span class="op" id="7276776">:=</span>&nbsp;<span class="ident" id="7276779">v</span><span class="op" id="7276780">.</span><span class="op" id="7276781">(</span><span class="op" id="7276782">*</span><span class="ident" id="7276783">Bug0Outer</span><span class="op" id="7276792">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276795">if</span>&nbsp;<span class="op" id="7276798">!</span><span class="ident" id="7276799">ok</span>&nbsp;<span class="op" id="7276802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276806">t</span><span class="op" id="7276807">.</span><span class="ident" id="7276808">Fatalf</span><span class="op" id="7276814">(</span><span class="string" id="7276815">&#34;v&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7276836">,</span>&nbsp;<span class="ident" id="7276838">v</span><span class="op" id="7276839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276845">outer2</span><span class="op" id="7276851">,</span>&nbsp;<span class="ident" id="7276853">ok</span>&nbsp;<span class="op" id="7276856">:=</span>&nbsp;<span class="ident" id="7276859">outer1</span><span class="op" id="7276865">.</span><span class="ident" id="7276866">Bug0Field</span><span class="op" id="7276875">.</span><span class="op" id="7276876">(</span><span class="op" id="7276877">*</span><span class="ident" id="7276878">Bug0Outer</span><span class="op" id="7276887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7276890">if</span>&nbsp;<span class="op" id="7276893">!</span><span class="ident" id="7276894">ok</span>&nbsp;<span class="op" id="7276897">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276901">t</span><span class="op" id="7276902">.</span><span class="ident" id="7276903">Fatalf</span><span class="op" id="7276909">(</span><span class="string" id="7276910">&#34;v.Bug0Field&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7276941">,</span>&nbsp;<span class="ident" id="7276943">outer1</span><span class="op" id="7276949">.</span><span class="ident" id="7276950">Bug0Field</span><span class="op" id="7276959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7276962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7276965">inner</span><span class="op" id="7276970">,</span>&nbsp;<span class="ident" id="7276972">ok</span>&nbsp;<span class="op" id="7276975">:=</span>&nbsp;<span class="ident" id="7276978">outer2</span><span class="op" id="7276984">.</span><span class="ident" id="7276985">Bug0Field</span><span class="op" id="7276994">.</span><span class="op" id="7276995">(</span><span class="op" id="7276996">*</span><span class="ident" id="7276997">Bug0Inner</span><span class="op" id="7277006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277009">if</span>&nbsp;<span class="op" id="7277012">!</span><span class="ident" id="7277013">ok</span>&nbsp;<span class="op" id="7277016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277020">t</span><span class="op" id="7277021">.</span><span class="ident" id="7277022">Fatalf</span><span class="op" id="7277028">(</span><span class="string" id="7277029">&#34;v.Bug0Field.Bug0Field&nbsp;not&nbsp;Bug0Inner:&nbsp;%T&#34;</span><span class="op" id="7277070">,</span>&nbsp;<span class="ident" id="7277072">outer2</span><span class="op" id="7277078">.</span><span class="ident" id="7277079">Bug0Field</span><span class="op" id="7277088">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277094">if</span>&nbsp;<span class="ident" id="7277097">inner</span><span class="op" id="7277102">.</span><span class="ident" id="7277103">A</span>&nbsp;<span class="op" id="7277105">!=</span>&nbsp;<span class="num" id="7277108">7</span>&nbsp;<span class="op" id="7277110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277114">t</span><span class="op" id="7277115">.</span><span class="ident" id="7277116">Fatalf</span><span class="op" id="7277122">(</span><span class="string" id="7277123">&#34;final&nbsp;value&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7277152">,</span>&nbsp;<span class="ident" id="7277154">inner</span><span class="op" id="7277159">.</span><span class="ident" id="7277160">A</span><span class="op" id="7277161">,</span>&nbsp;<span class="num" id="7277163">7</span><span class="op" id="7277164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277167">}</span><br>
<span class="lineno"></span><span class="op" id="7277169">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="7277172">//&nbsp;The&nbsp;bugs&nbsp;keep&nbsp;coming.&nbsp;We&nbsp;forgot&nbsp;to&nbsp;send&nbsp;map&nbsp;subtypes&nbsp;before&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7277245">type</span>&nbsp;<span class="ident" id="7277250">Bug1Elem</span>&nbsp;<span class="keyword" id="7277259">struct</span>&nbsp;<span class="op" id="7277266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277269">Name</span>&nbsp;<span class="builtintype" id="7277274">string</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277282">Id</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7277287">int</span><br>
<span class="lineno"></span><span class="op" id="7277291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7277294">type</span>&nbsp;<span class="ident" id="7277299">Bug1StructMap</span>&nbsp;<span class="keyword" id="7277313">map</span><span class="op" id="7277316">[</span><span class="builtintype" id="7277317">string</span><span class="op" id="7277323">]</span><span class="ident" id="7277324">Bug1Elem</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span><span class="keyword" id="7277334">func</span>&nbsp;<span class="ident" id="7277339">bug1EncDec</span><span class="op" id="7277349">(</span><span class="ident" id="7277350">in</span>&nbsp;<span class="ident" id="7277353">Bug1StructMap</span><span class="op" id="7277366">,</span>&nbsp;<span class="ident" id="7277368">out</span>&nbsp;<span class="op" id="7277372">*</span><span class="ident" id="7277373">Bug1StructMap</span><span class="op" id="7277386">)</span>&nbsp;<span class="builtintype" id="7277388">error</span>&nbsp;<span class="op" id="7277394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277397">return</span>&nbsp;<span class="builtintype" id="7277404">nil</span><br>
<span class="lineno"></span><span class="op" id="7277408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7277411">func</span>&nbsp;<span class="ident" id="7277416">TestMapBug1</span><span class="op" id="7277427">(</span><span class="ident" id="7277428">t</span>&nbsp;<span class="op" id="7277430">*</span><span class="ident" id="7277431">testing</span><span class="op" id="7277438">.</span><span class="ident" id="7277439">T</span><span class="op" id="7277440">)</span>&nbsp;<span class="op" id="7277442">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277445">in</span>&nbsp;<span class="op" id="7277448">:=</span>&nbsp;<span class="builtinfunc" id="7277451">make</span><span class="op" id="7277455">(</span><span class="ident" id="7277456">Bug1StructMap</span><span class="op" id="7277469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277472">in</span><span class="op" id="7277474">[</span><span class="string" id="7277475">&#34;val1&#34;</span><span class="op" id="7277481">]</span>&nbsp;<span class="op" id="7277483">=</span>&nbsp;<span class="ident" id="7277485">Bug1Elem</span><span class="op" id="7277493">{</span><span class="string" id="7277494">&#34;elem1&#34;</span><span class="op" id="7277501">,</span>&nbsp;<span class="num" id="7277503">1</span><span class="op" id="7277504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277507">in</span><span class="op" id="7277509">[</span><span class="string" id="7277510">&#34;val2&#34;</span><span class="op" id="7277516">]</span>&nbsp;<span class="op" id="7277518">=</span>&nbsp;<span class="ident" id="7277520">Bug1Elem</span><span class="op" id="7277528">{</span><span class="string" id="7277529">&#34;elem2&#34;</span><span class="op" id="7277536">,</span>&nbsp;<span class="num" id="7277538">2</span><span class="op" id="7277539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277543">b</span>&nbsp;<span class="op" id="7277545">:=</span>&nbsp;<span class="builtinfunc" id="7277548">new</span><span class="op" id="7277551">(</span><span class="ident" id="7277552">bytes</span><span class="op" id="7277557">.</span><span class="ident" id="7277558">Buffer</span><span class="op" id="7277564">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277567">enc</span>&nbsp;<span class="op" id="7277571">:=</span>&nbsp;<span class="ident" id="7277574">NewEncoder</span><span class="op" id="7277584">(</span><span class="ident" id="7277585">b</span><span class="op" id="7277586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277589">err</span>&nbsp;<span class="op" id="7277593">:=</span>&nbsp;<span class="ident" id="7277596">enc</span><span class="op" id="7277599">.</span><span class="ident" id="7277600">Encode</span><span class="op" id="7277606">(</span><span class="ident" id="7277607">in</span><span class="op" id="7277609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277612">if</span>&nbsp;<span class="ident" id="7277615">err</span>&nbsp;<span class="op" id="7277619">!=</span>&nbsp;<span class="builtintype" id="7277622">nil</span>&nbsp;<span class="op" id="7277626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277630">t</span><span class="op" id="7277631">.</span><span class="ident" id="7277632">Fatal</span><span class="op" id="7277637">(</span><span class="string" id="7277638">&#34;encode:&#34;</span><span class="op" id="7277647">,</span>&nbsp;<span class="ident" id="7277649">err</span><span class="op" id="7277652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277655">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277658">dec</span>&nbsp;<span class="op" id="7277662">:=</span>&nbsp;<span class="ident" id="7277665">NewDecoder</span><span class="op" id="7277675">(</span><span class="ident" id="7277676">b</span><span class="op" id="7277677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277680">out</span>&nbsp;<span class="op" id="7277684">:=</span>&nbsp;<span class="builtinfunc" id="7277687">make</span><span class="op" id="7277691">(</span><span class="ident" id="7277692">Bug1StructMap</span><span class="op" id="7277705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277708">err</span>&nbsp;<span class="op" id="7277712">=</span>&nbsp;<span class="ident" id="7277714">dec</span><span class="op" id="7277717">.</span><span class="ident" id="7277718">Decode</span><span class="op" id="7277724">(</span><span class="op" id="7277725">&amp;</span><span class="ident" id="7277726">out</span><span class="op" id="7277729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277732">if</span>&nbsp;<span class="ident" id="7277735">err</span>&nbsp;<span class="op" id="7277739">!=</span>&nbsp;<span class="builtintype" id="7277742">nil</span>&nbsp;<span class="op" id="7277746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277750">t</span><span class="op" id="7277751">.</span><span class="ident" id="7277752">Fatal</span><span class="op" id="7277757">(</span><span class="string" id="7277758">&#34;decode:&#34;</span><span class="op" id="7277767">,</span>&nbsp;<span class="ident" id="7277769">err</span><span class="op" id="7277772">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7277778">if</span>&nbsp;<span class="op" id="7277781">!</span><span class="ident" id="7277782">reflect</span><span class="op" id="7277789">.</span><span class="ident" id="7277790">DeepEqual</span><span class="op" id="7277799">(</span><span class="ident" id="7277800">in</span><span class="op" id="7277802">,</span>&nbsp;<span class="ident" id="7277804">out</span><span class="op" id="7277807">)</span>&nbsp;<span class="op" id="7277809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277813">t</span><span class="op" id="7277814">.</span><span class="ident" id="7277815">Errorf</span><span class="op" id="7277821">(</span><span class="string" id="7277822">&#34;mismatch:&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="7277839">,</span>&nbsp;<span class="ident" id="7277841">in</span><span class="op" id="7277843">,</span>&nbsp;<span class="ident" id="7277845">out</span><span class="op" id="7277848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7277851">}</span><br>
<span class="lineno"></span><span class="op" id="7277853">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7277856">func</span>&nbsp;<span class="ident" id="7277861">TestGobMapInterfaceEncode</span><span class="op" id="7277886">(</span><span class="ident" id="7277887">t</span>&nbsp;<span class="op" id="7277889">*</span><span class="ident" id="7277890">testing</span><span class="op" id="7277897">.</span><span class="ident" id="7277898">T</span><span class="op" id="7277899">)</span>&nbsp;<span class="op" id="7277901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7277904">m</span>&nbsp;<span class="op" id="7277906">:=</span>&nbsp;<span class="keyword" id="7277909">map</span><span class="op" id="7277912">[</span><span class="builtintype" id="7277913">string</span><span class="op" id="7277919">]</span><span class="keyword" id="7277920">interface</span><span class="op" id="7277929">{</span><span class="op" id="7277930">}</span><span class="op" id="7277931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7277935">&#34;up&#34;</span><span class="op" id="7277939">:</span>&nbsp;<span class="builtintype" id="7277941">uintptr</span><span class="op" id="7277948">(</span><span class="num" id="7277949">0</span><span class="op" id="7277950">)</span><span class="op" id="7277951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7277955">&#34;i0&#34;</span><span class="op" id="7277959">:</span>&nbsp;<span class="op" id="7277961">[</span><span class="op" id="7277962">]</span><span class="builtintype" id="7277963">int</span><span class="op" id="7277966">{</span><span class="op" id="7277967">-</span><span class="num" id="7277968">1</span><span class="op" id="7277969">}</span><span class="op" id="7277970">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7277974">&#34;i1&#34;</span><span class="op" id="7277978">:</span>&nbsp;<span class="op" id="7277980">[</span><span class="op" id="7277981">]</span><span class="builtintype" id="7277982">int8</span><span class="op" id="7277986">{</span><span class="op" id="7277987">-</span><span class="num" id="7277988">1</span><span class="op" id="7277989">}</span><span class="op" id="7277990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7277994">&#34;i2&#34;</span><span class="op" id="7277998">:</span>&nbsp;<span class="op" id="7278000">[</span><span class="op" id="7278001">]</span><span class="builtintype" id="7278002">int16</span><span class="op" id="7278007">{</span><span class="op" id="7278008">-</span><span class="num" id="7278009">1</span><span class="op" id="7278010">}</span><span class="op" id="7278011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278015">&#34;i3&#34;</span><span class="op" id="7278019">:</span>&nbsp;<span class="op" id="7278021">[</span><span class="op" id="7278022">]</span><span class="builtintype" id="7278023">int32</span><span class="op" id="7278028">{</span><span class="op" id="7278029">-</span><span class="num" id="7278030">1</span><span class="op" id="7278031">}</span><span class="op" id="7278032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278036">&#34;i4&#34;</span><span class="op" id="7278040">:</span>&nbsp;<span class="op" id="7278042">[</span><span class="op" id="7278043">]</span><span class="builtintype" id="7278044">int64</span><span class="op" id="7278049">{</span><span class="op" id="7278050">-</span><span class="num" id="7278051">1</span><span class="op" id="7278052">}</span><span class="op" id="7278053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278057">&#34;u0&#34;</span><span class="op" id="7278061">:</span>&nbsp;<span class="op" id="7278063">[</span><span class="op" id="7278064">]</span><span class="builtintype" id="7278065">uint</span><span class="op" id="7278069">{</span><span class="num" id="7278070">1</span><span class="op" id="7278071">}</span><span class="op" id="7278072">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278076">&#34;u1&#34;</span><span class="op" id="7278080">:</span>&nbsp;<span class="op" id="7278082">[</span><span class="op" id="7278083">]</span><span class="builtintype" id="7278084">uint8</span><span class="op" id="7278089">{</span><span class="num" id="7278090">1</span><span class="op" id="7278091">}</span><span class="op" id="7278092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278096">&#34;u2&#34;</span><span class="op" id="7278100">:</span>&nbsp;<span class="op" id="7278102">[</span><span class="op" id="7278103">]</span><span class="builtintype" id="7278104">uint16</span><span class="op" id="7278110">{</span><span class="num" id="7278111">1</span><span class="op" id="7278112">}</span><span class="op" id="7278113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278117">&#34;u3&#34;</span><span class="op" id="7278121">:</span>&nbsp;<span class="op" id="7278123">[</span><span class="op" id="7278124">]</span><span class="builtintype" id="7278125">uint32</span><span class="op" id="7278131">{</span><span class="num" id="7278132">1</span><span class="op" id="7278133">}</span><span class="op" id="7278134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278138">&#34;u4&#34;</span><span class="op" id="7278142">:</span>&nbsp;<span class="op" id="7278144">[</span><span class="op" id="7278145">]</span><span class="builtintype" id="7278146">uint64</span><span class="op" id="7278152">{</span><span class="num" id="7278153">1</span><span class="op" id="7278154">}</span><span class="op" id="7278155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278159">&#34;f0&#34;</span><span class="op" id="7278163">:</span>&nbsp;<span class="op" id="7278165">[</span><span class="op" id="7278166">]</span><span class="builtintype" id="7278167">float32</span><span class="op" id="7278174">{</span><span class="num" id="7278175">1</span><span class="op" id="7278176">}</span><span class="op" id="7278177">,</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278181">&#34;f1&#34;</span><span class="op" id="7278185">:</span>&nbsp;<span class="op" id="7278187">[</span><span class="op" id="7278188">]</span><span class="builtintype" id="7278189">float64</span><span class="op" id="7278196">{</span><span class="num" id="7278197">1</span><span class="op" id="7278198">}</span><span class="op" id="7278199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278203">&#34;c0&#34;</span><span class="op" id="7278207">:</span>&nbsp;<span class="op" id="7278209">[</span><span class="op" id="7278210">]</span><span class="builtintype" id="7278211">complex64</span><span class="op" id="7278220">{</span><span class="builtinfunc" id="7278221">complex</span><span class="op" id="7278228">(</span><span class="num" id="7278229">2</span><span class="op" id="7278230">,</span>&nbsp;<span class="op" id="7278232">-</span><span class="num" id="7278233">2</span><span class="op" id="7278234">)</span><span class="op" id="7278235">}</span><span class="op" id="7278236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278240">&#34;c1&#34;</span><span class="op" id="7278244">:</span>&nbsp;<span class="op" id="7278246">[</span><span class="op" id="7278247">]</span><span class="builtintype" id="7278248">complex128</span><span class="op" id="7278258">{</span><span class="builtinfunc" id="7278259">complex</span><span class="op" id="7278266">(</span><span class="num" id="7278267">2</span><span class="op" id="7278268">,</span>&nbsp;<span class="builtintype" id="7278270">float64</span><span class="op" id="7278277">(</span><span class="op" id="7278278">-</span><span class="num" id="7278279">2</span><span class="op" id="7278280">)</span><span class="op" id="7278281">)</span><span class="op" id="7278282">}</span><span class="op" id="7278283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278287">&#34;us&#34;</span><span class="op" id="7278291">:</span>&nbsp;<span class="op" id="7278293">[</span><span class="op" id="7278294">]</span><span class="builtintype" id="7278295">uintptr</span><span class="op" id="7278302">{</span><span class="num" id="7278303">0</span><span class="op" id="7278304">}</span><span class="op" id="7278305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278309">&#34;bo&#34;</span><span class="op" id="7278313">:</span>&nbsp;<span class="op" id="7278315">[</span><span class="op" id="7278316">]</span><span class="builtintype" id="7278317">bool</span><span class="op" id="7278321">{</span><span class="builtintype" id="7278322">false</span><span class="op" id="7278327">}</span><span class="op" id="7278328">,</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7278332">&#34;st&#34;</span><span class="op" id="7278336">:</span>&nbsp;<span class="op" id="7278338">[</span><span class="op" id="7278339">]</span><span class="builtintype" id="7278340">string</span><span class="op" id="7278346">{</span><span class="string" id="7278347">&#34;s&#34;</span><span class="op" id="7278350">}</span><span class="op" id="7278351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278357">enc</span>&nbsp;<span class="op" id="7278361">:=</span>&nbsp;<span class="ident" id="7278364">NewEncoder</span><span class="op" id="7278374">(</span><span class="builtinfunc" id="7278375">new</span><span class="op" id="7278378">(</span><span class="ident" id="7278379">bytes</span><span class="op" id="7278384">.</span><span class="ident" id="7278385">Buffer</span><span class="op" id="7278391">)</span><span class="op" id="7278392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278395">err</span>&nbsp;<span class="op" id="7278399">:=</span>&nbsp;<span class="ident" id="7278402">enc</span><span class="op" id="7278405">.</span><span class="ident" id="7278406">Encode</span><span class="op" id="7278412">(</span><span class="ident" id="7278413">m</span><span class="op" id="7278414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278417">if</span>&nbsp;<span class="ident" id="7278420">err</span>&nbsp;<span class="op" id="7278424">!=</span>&nbsp;<span class="builtintype" id="7278427">nil</span>&nbsp;<span class="op" id="7278431">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278435">t</span><span class="op" id="7278436">.</span><span class="ident" id="7278437">Errorf</span><span class="op" id="7278443">(</span><span class="string" id="7278444">&#34;encode&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="7278460">,</span>&nbsp;<span class="ident" id="7278462">err</span><span class="op" id="7278465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278468">}</span><br>
<span class="lineno"></span><span class="op" id="7278470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7278473">func</span>&nbsp;<span class="ident" id="7278478">TestSliceReusesMemory</span><span class="op" id="7278499">(</span><span class="ident" id="7278500">t</span>&nbsp;<span class="op" id="7278502">*</span><span class="ident" id="7278503">testing</span><span class="op" id="7278510">.</span><span class="ident" id="7278511">T</span><span class="op" id="7278512">)</span>&nbsp;<span class="op" id="7278514">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278517">buf</span>&nbsp;<span class="op" id="7278521">:=</span>&nbsp;<span class="builtinfunc" id="7278524">new</span><span class="op" id="7278527">(</span><span class="ident" id="7278528">bytes</span><span class="op" id="7278533">.</span><span class="ident" id="7278534">Buffer</span><span class="op" id="7278540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7278543">//&nbsp;Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278557">x</span>&nbsp;<span class="op" id="7278559">:=</span>&nbsp;<span class="op" id="7278562">[</span><span class="op" id="7278563">]</span><span class="builtintype" id="7278564">byte</span><span class="op" id="7278568">(</span><span class="string" id="7278569">&#34;abcd&#34;</span><span class="op" id="7278575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278579">enc</span>&nbsp;<span class="op" id="7278583">:=</span>&nbsp;<span class="ident" id="7278586">NewEncoder</span><span class="op" id="7278596">(</span><span class="ident" id="7278597">buf</span><span class="op" id="7278600">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278604">err</span>&nbsp;<span class="op" id="7278608">:=</span>&nbsp;<span class="ident" id="7278611">enc</span><span class="op" id="7278614">.</span><span class="ident" id="7278615">Encode</span><span class="op" id="7278621">(</span><span class="ident" id="7278622">x</span><span class="op" id="7278623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278627">if</span>&nbsp;<span class="ident" id="7278630">err</span>&nbsp;<span class="op" id="7278634">!=</span>&nbsp;<span class="builtintype" id="7278637">nil</span>&nbsp;<span class="op" id="7278641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278646">t</span><span class="op" id="7278647">.</span><span class="ident" id="7278648">Errorf</span><span class="op" id="7278654">(</span><span class="string" id="7278655">&#34;bytes:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7278674">,</span>&nbsp;<span class="ident" id="7278676">err</span><span class="op" id="7278679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7278687">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278728">y</span>&nbsp;<span class="op" id="7278730">:=</span>&nbsp;<span class="op" id="7278733">[</span><span class="op" id="7278734">]</span><span class="builtintype" id="7278735">byte</span><span class="op" id="7278739">(</span><span class="string" id="7278740">&#34;ABCDE&#34;</span><span class="op" id="7278747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278751">addr</span>&nbsp;<span class="op" id="7278756">:=</span>&nbsp;<span class="op" id="7278759">&amp;</span><span class="ident" id="7278760">y</span><span class="op" id="7278761">[</span><span class="num" id="7278762">0</span><span class="op" id="7278763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278767">dec</span>&nbsp;<span class="op" id="7278771">:=</span>&nbsp;<span class="ident" id="7278774">NewDecoder</span><span class="op" id="7278784">(</span><span class="ident" id="7278785">buf</span><span class="op" id="7278788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278792">err</span>&nbsp;<span class="op" id="7278796">=</span>&nbsp;<span class="ident" id="7278798">dec</span><span class="op" id="7278801">.</span><span class="ident" id="7278802">Decode</span><span class="op" id="7278808">(</span><span class="op" id="7278809">&amp;</span><span class="ident" id="7278810">y</span><span class="op" id="7278811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278815">if</span>&nbsp;<span class="ident" id="7278818">err</span>&nbsp;<span class="op" id="7278822">!=</span>&nbsp;<span class="builtintype" id="7278825">nil</span>&nbsp;<span class="op" id="7278829">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278834">t</span><span class="op" id="7278835">.</span><span class="ident" id="7278836">Fatal</span><span class="op" id="7278841">(</span><span class="string" id="7278842">&#34;bytes:&nbsp;decode:&#34;</span><span class="op" id="7278858">,</span>&nbsp;<span class="ident" id="7278860">err</span><span class="op" id="7278863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278871">if</span>&nbsp;<span class="op" id="7278874">!</span><span class="ident" id="7278875">bytes</span><span class="op" id="7278880">.</span><span class="ident" id="7278881">Equal</span><span class="op" id="7278886">(</span><span class="ident" id="7278887">x</span><span class="op" id="7278888">,</span>&nbsp;<span class="ident" id="7278890">y</span><span class="op" id="7278891">)</span>&nbsp;<span class="op" id="7278893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278898">t</span><span class="op" id="7278899">.</span><span class="ident" id="7278900">Errorf</span><span class="op" id="7278906">(</span><span class="string" id="7278907">&#34;bytes:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7278936">,</span>&nbsp;<span class="ident" id="7278938">x</span><span class="op" id="7278939">,</span>&nbsp;<span class="ident" id="7278941">y</span><span class="op" id="7278942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7278946">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7278950">if</span>&nbsp;<span class="ident" id="7278953">addr</span>&nbsp;<span class="op" id="7278958">!=</span>&nbsp;<span class="op" id="7278961">&amp;</span><span class="ident" id="7278962">y</span><span class="op" id="7278963">[</span><span class="num" id="7278964">0</span><span class="op" id="7278965">]</span>&nbsp;<span class="op" id="7278967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7278972">t</span><span class="op" id="7278973">.</span><span class="ident" id="7278974">Errorf</span><span class="op" id="7278980">(</span><span class="string" id="7278981">&#34;bytes:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7279014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7279024">//&nbsp;general&nbsp;slice</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279046">x</span>&nbsp;<span class="op" id="7279048">:=</span>&nbsp;<span class="op" id="7279051">[</span><span class="op" id="7279052">]</span><span class="builtintype" id="7279053">rune</span><span class="op" id="7279057">(</span><span class="string" id="7279058">&#34;abcd&#34;</span><span class="op" id="7279064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279068">enc</span>&nbsp;<span class="op" id="7279072">:=</span>&nbsp;<span class="ident" id="7279075">NewEncoder</span><span class="op" id="7279085">(</span><span class="ident" id="7279086">buf</span><span class="op" id="7279089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279093">err</span>&nbsp;<span class="op" id="7279097">:=</span>&nbsp;<span class="ident" id="7279100">enc</span><span class="op" id="7279103">.</span><span class="ident" id="7279104">Encode</span><span class="op" id="7279110">(</span><span class="ident" id="7279111">x</span><span class="op" id="7279112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7279116">if</span>&nbsp;<span class="ident" id="7279119">err</span>&nbsp;<span class="op" id="7279123">!=</span>&nbsp;<span class="builtintype" id="7279126">nil</span>&nbsp;<span class="op" id="7279130">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279135">t</span><span class="op" id="7279136">.</span><span class="ident" id="7279137">Errorf</span><span class="op" id="7279143">(</span><span class="string" id="7279144">&#34;ints:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7279162">,</span>&nbsp;<span class="ident" id="7279164">err</span><span class="op" id="7279167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7279175">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279216">y</span>&nbsp;<span class="op" id="7279218">:=</span>&nbsp;<span class="op" id="7279221">[</span><span class="op" id="7279222">]</span><span class="builtintype" id="7279223">rune</span><span class="op" id="7279227">(</span><span class="string" id="7279228">&#34;ABCDE&#34;</span><span class="op" id="7279235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279239">addr</span>&nbsp;<span class="op" id="7279244">:=</span>&nbsp;<span class="op" id="7279247">&amp;</span><span class="ident" id="7279248">y</span><span class="op" id="7279249">[</span><span class="num" id="7279250">0</span><span class="op" id="7279251">]</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279255">dec</span>&nbsp;<span class="op" id="7279259">:=</span>&nbsp;<span class="ident" id="7279262">NewDecoder</span><span class="op" id="7279272">(</span><span class="ident" id="7279273">buf</span><span class="op" id="7279276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279280">err</span>&nbsp;<span class="op" id="7279284">=</span>&nbsp;<span class="ident" id="7279286">dec</span><span class="op" id="7279289">.</span><span class="ident" id="7279290">Decode</span><span class="op" id="7279296">(</span><span class="op" id="7279297">&amp;</span><span class="ident" id="7279298">y</span><span class="op" id="7279299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7279303">if</span>&nbsp;<span class="ident" id="7279306">err</span>&nbsp;<span class="op" id="7279310">!=</span>&nbsp;<span class="builtintype" id="7279313">nil</span>&nbsp;<span class="op" id="7279317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279322">t</span><span class="op" id="7279323">.</span><span class="ident" id="7279324">Fatal</span><span class="op" id="7279329">(</span><span class="string" id="7279330">&#34;ints:&nbsp;decode:&#34;</span><span class="op" id="7279345">,</span>&nbsp;<span class="ident" id="7279347">err</span><span class="op" id="7279350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279354">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7279358">if</span>&nbsp;<span class="op" id="7279361">!</span><span class="ident" id="7279362">reflect</span><span class="op" id="7279369">.</span><span class="ident" id="7279370">DeepEqual</span><span class="op" id="7279379">(</span><span class="ident" id="7279380">x</span><span class="op" id="7279381">,</span>&nbsp;<span class="ident" id="7279383">y</span><span class="op" id="7279384">)</span>&nbsp;<span class="op" id="7279386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279391">t</span><span class="op" id="7279392">.</span><span class="ident" id="7279393">Errorf</span><span class="op" id="7279399">(</span><span class="string" id="7279400">&#34;ints:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7279428">,</span>&nbsp;<span class="ident" id="7279430">x</span><span class="op" id="7279431">,</span>&nbsp;<span class="ident" id="7279433">y</span><span class="op" id="7279434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7279442">if</span>&nbsp;<span class="ident" id="7279445">addr</span>&nbsp;<span class="op" id="7279450">!=</span>&nbsp;<span class="op" id="7279453">&amp;</span><span class="ident" id="7279454">y</span><span class="op" id="7279455">[</span><span class="num" id="7279456">0</span><span class="op" id="7279457">]</span>&nbsp;<span class="op" id="7279459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279464">t</span><span class="op" id="7279465">.</span><span class="ident" id="7279466">Errorf</span><span class="op" id="7279472">(</span><span class="string" id="7279473">&#34;ints:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7279505">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279512">}</span><br>
<span class="lineno"></span><span class="op" id="7279514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7279517">//&nbsp;Used&nbsp;to&nbsp;crash:&nbsp;negative&nbsp;count&nbsp;in&nbsp;recvMessage.</span><br>
<span class="lineno">705</span><span class="keyword" id="7279566">func</span>&nbsp;<span class="ident" id="7279571">TestBadCount</span><span class="op" id="7279583">(</span><span class="ident" id="7279584">t</span>&nbsp;<span class="op" id="7279586">*</span><span class="ident" id="7279587">testing</span><span class="op" id="7279594">.</span><span class="ident" id="7279595">T</span><span class="op" id="7279596">)</span>&nbsp;<span class="op" id="7279598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279601">b</span>&nbsp;<span class="op" id="7279603">:=</span>&nbsp;<span class="op" id="7279606">[</span><span class="op" id="7279607">]</span><span class="builtintype" id="7279608">byte</span><span class="op" id="7279612">{</span><span class="num" id="7279613">0xfb</span><span class="op" id="7279617">,</span>&nbsp;<span class="num" id="7279619">0xa5</span><span class="op" id="7279623">,</span>&nbsp;<span class="num" id="7279625">0x82</span><span class="op" id="7279629">,</span>&nbsp;<span class="num" id="7279631">0x2f</span><span class="op" id="7279635">,</span>&nbsp;<span class="num" id="7279637">0xca</span><span class="op" id="7279641">,</span>&nbsp;<span class="num" id="7279643">0x1</span><span class="op" id="7279646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7279649">if</span>&nbsp;<span class="ident" id="7279652">err</span>&nbsp;<span class="op" id="7279656">:=</span>&nbsp;<span class="ident" id="7279659">NewDecoder</span><span class="op" id="7279669">(</span><span class="ident" id="7279670">bytes</span><span class="op" id="7279675">.</span><span class="ident" id="7279676">NewReader</span><span class="op" id="7279685">(</span><span class="ident" id="7279686">b</span><span class="op" id="7279687">)</span><span class="op" id="7279688">)</span><span class="op" id="7279689">.</span><span class="ident" id="7279690">Decode</span><span class="op" id="7279696">(</span><span class="builtintype" id="7279697">nil</span><span class="op" id="7279700">)</span><span class="op" id="7279701">;</span>&nbsp;<span class="ident" id="7279703">err</span>&nbsp;<span class="op" id="7279707">==</span>&nbsp;<span class="builtintype" id="7279710">nil</span>&nbsp;<span class="op" id="7279714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279718">t</span><span class="op" id="7279719">.</span><span class="ident" id="7279720">Error</span><span class="op" id="7279725">(</span><span class="string" id="7279726">&#34;expected&nbsp;error&nbsp;from&nbsp;bad&nbsp;count&#34;</span><span class="op" id="7279757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279760">}</span>&nbsp;<span class="keyword" id="7279762">else</span>&nbsp;<span class="keyword" id="7279767">if</span>&nbsp;<span class="ident" id="7279770">err</span><span class="op" id="7279773">.</span><span class="ident" id="7279774">Error</span><span class="op" id="7279779">(</span><span class="op" id="7279780">)</span>&nbsp;<span class="op" id="7279782">!=</span>&nbsp;<span class="ident" id="7279785">errBadCount</span><span class="op" id="7279796">.</span><span class="ident" id="7279797">Error</span><span class="op" id="7279802">(</span><span class="op" id="7279803">)</span>&nbsp;<span class="op" id="7279805">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7279809">t</span><span class="op" id="7279810">.</span><span class="ident" id="7279811">Error</span><span class="op" id="7279816">(</span><span class="string" id="7279817">&#34;expected&nbsp;bad&nbsp;count&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7279848">,</span>&nbsp;<span class="ident" id="7279850">err</span><span class="op" id="7279853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7279856">}</span><br>
<span class="lineno"></span><span class="op" id="7279858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7279861">//&nbsp;Verify&nbsp;that&nbsp;sequential&nbsp;Decoders&nbsp;built&nbsp;on&nbsp;a&nbsp;single&nbsp;input&nbsp;will</span><br>
<span class="lineno">715</span><span class="comment" id="7279925">//&nbsp;succeed&nbsp;if&nbsp;the&nbsp;input&nbsp;implements&nbsp;ReadByte&nbsp;and&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="7279985">//&nbsp;type&nbsp;information&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="7280020">func</span>&nbsp;<span class="ident" id="7280025">TestSequentialDecoder</span><span class="op" id="7280046">(</span><span class="ident" id="7280047">t</span>&nbsp;<span class="op" id="7280049">*</span><span class="ident" id="7280050">testing</span><span class="op" id="7280057">.</span><span class="ident" id="7280058">T</span><span class="op" id="7280059">)</span>&nbsp;<span class="op" id="7280061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280064">b</span>&nbsp;<span class="op" id="7280066">:=</span>&nbsp;<span class="builtinfunc" id="7280069">new</span><span class="op" id="7280072">(</span><span class="ident" id="7280073">bytes</span><span class="op" id="7280078">.</span><span class="ident" id="7280079">Buffer</span><span class="op" id="7280085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280088">enc</span>&nbsp;<span class="op" id="7280092">:=</span>&nbsp;<span class="ident" id="7280095">NewEncoder</span><span class="op" id="7280105">(</span><span class="ident" id="7280106">b</span><span class="op" id="7280107">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280110">const</span>&nbsp;<span class="ident" id="7280116">count</span>&nbsp;<span class="op" id="7280122">=</span>&nbsp;<span class="num" id="7280124">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280128">for</span>&nbsp;<span class="ident" id="7280132">i</span>&nbsp;<span class="op" id="7280134">:=</span>&nbsp;<span class="num" id="7280137">0</span><span class="op" id="7280138">;</span>&nbsp;<span class="ident" id="7280140">i</span>&nbsp;<span class="op" id="7280142">&lt;</span>&nbsp;<span class="ident" id="7280144">count</span><span class="op" id="7280149">;</span>&nbsp;<span class="ident" id="7280151">i</span><span class="op" id="7280152">++</span>&nbsp;<span class="op" id="7280155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280159">s</span>&nbsp;<span class="op" id="7280161">:=</span>&nbsp;<span class="ident" id="7280164">fmt</span><span class="op" id="7280167">.</span><span class="ident" id="7280168">Sprintf</span><span class="op" id="7280175">(</span><span class="string" id="7280176">&#34;%d&#34;</span><span class="op" id="7280180">,</span>&nbsp;<span class="ident" id="7280182">i</span><span class="op" id="7280183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280187">if</span>&nbsp;<span class="ident" id="7280190">err</span>&nbsp;<span class="op" id="7280194">:=</span>&nbsp;<span class="ident" id="7280197">enc</span><span class="op" id="7280200">.</span><span class="ident" id="7280201">Encode</span><span class="op" id="7280207">(</span><span class="ident" id="7280208">s</span><span class="op" id="7280209">)</span><span class="op" id="7280210">;</span>&nbsp;<span class="ident" id="7280212">err</span>&nbsp;<span class="op" id="7280216">!=</span>&nbsp;<span class="builtintype" id="7280219">nil</span>&nbsp;<span class="op" id="7280223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280228">t</span><span class="op" id="7280229">.</span><span class="ident" id="7280230">Error</span><span class="op" id="7280235">(</span><span class="string" id="7280236">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7280251">,</span>&nbsp;<span class="ident" id="7280253">err</span><span class="op" id="7280256">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280266">for</span>&nbsp;<span class="ident" id="7280270">i</span>&nbsp;<span class="op" id="7280272">:=</span>&nbsp;<span class="num" id="7280275">0</span><span class="op" id="7280276">;</span>&nbsp;<span class="ident" id="7280278">i</span>&nbsp;<span class="op" id="7280280">&lt;</span>&nbsp;<span class="ident" id="7280282">count</span><span class="op" id="7280287">;</span>&nbsp;<span class="ident" id="7280289">i</span><span class="op" id="7280290">++</span>&nbsp;<span class="op" id="7280293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280297">dec</span>&nbsp;<span class="op" id="7280301">:=</span>&nbsp;<span class="ident" id="7280304">NewDecoder</span><span class="op" id="7280314">(</span><span class="ident" id="7280315">b</span><span class="op" id="7280316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280320">var</span>&nbsp;<span class="ident" id="7280324">s</span>&nbsp;<span class="builtintype" id="7280326">string</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280335">if</span>&nbsp;<span class="ident" id="7280338">err</span>&nbsp;<span class="op" id="7280342">:=</span>&nbsp;<span class="ident" id="7280345">dec</span><span class="op" id="7280348">.</span><span class="ident" id="7280349">Decode</span><span class="op" id="7280355">(</span><span class="op" id="7280356">&amp;</span><span class="ident" id="7280357">s</span><span class="op" id="7280358">)</span><span class="op" id="7280359">;</span>&nbsp;<span class="ident" id="7280361">err</span>&nbsp;<span class="op" id="7280365">!=</span>&nbsp;<span class="builtintype" id="7280368">nil</span>&nbsp;<span class="op" id="7280372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280377">t</span><span class="op" id="7280378">.</span><span class="ident" id="7280379">Fatal</span><span class="op" id="7280384">(</span><span class="string" id="7280385">&#34;decoder&nbsp;fail:&#34;</span><span class="op" id="7280400">,</span>&nbsp;<span class="ident" id="7280402">err</span><span class="op" id="7280405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280413">if</span>&nbsp;<span class="ident" id="7280416">s</span>&nbsp;<span class="op" id="7280418">!=</span>&nbsp;<span class="ident" id="7280421">fmt</span><span class="op" id="7280424">.</span><span class="ident" id="7280425">Sprintf</span><span class="op" id="7280432">(</span><span class="string" id="7280433">&#34;%d&#34;</span><span class="op" id="7280437">,</span>&nbsp;<span class="ident" id="7280439">i</span><span class="op" id="7280440">)</span>&nbsp;<span class="op" id="7280442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280447">t</span><span class="op" id="7280448">.</span><span class="ident" id="7280449">Fatalf</span><span class="op" id="7280455">(</span><span class="string" id="7280456">&#34;decode&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7280483">,</span>&nbsp;<span class="ident" id="7280485">i</span><span class="op" id="7280486">,</span>&nbsp;<span class="ident" id="7280488">s</span><span class="op" id="7280489">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280496">}</span><br>
<span class="lineno"></span><span class="op" id="7280498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7280501">//&nbsp;Should&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;unrepresentable&nbsp;fields&nbsp;(chan,&nbsp;func,&nbsp;*chan&nbsp;etc.);&nbsp;we&nbsp;just&nbsp;ignore&nbsp;them.</span><br>
<span class="lineno">740</span><span class="keyword" id="7280597">type</span>&nbsp;<span class="ident" id="7280602">Bug2</span>&nbsp;<span class="keyword" id="7280607">struct</span>&nbsp;<span class="op" id="7280614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280617">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7280621">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280626">C</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280630">chan</span>&nbsp;<span class="builtintype" id="7280635">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280640">CP</span>&nbsp;&nbsp;<span class="op" id="7280644">*</span><span class="keyword" id="7280645">chan</span>&nbsp;<span class="builtintype" id="7280650">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280655">F</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280659">func</span><span class="op" id="7280663">(</span><span class="op" id="7280664">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280667">FPP</span>&nbsp;<span class="op" id="7280671">*</span><span class="op" id="7280672">*</span><span class="keyword" id="7280673">func</span><span class="op" id="7280677">(</span><span class="op" id="7280678">)</span><br>
<span class="lineno"></span><span class="op" id="7280680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7280683">func</span>&nbsp;<span class="ident" id="7280688">TestChanFuncIgnored</span><span class="op" id="7280707">(</span><span class="ident" id="7280708">t</span>&nbsp;<span class="op" id="7280710">*</span><span class="ident" id="7280711">testing</span><span class="op" id="7280718">.</span><span class="ident" id="7280719">T</span><span class="op" id="7280720">)</span>&nbsp;<span class="op" id="7280722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280725">c</span>&nbsp;<span class="op" id="7280727">:=</span>&nbsp;<span class="builtinfunc" id="7280730">make</span><span class="op" id="7280734">(</span><span class="keyword" id="7280735">chan</span>&nbsp;<span class="builtintype" id="7280740">int</span><span class="op" id="7280743">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280746">f</span>&nbsp;<span class="op" id="7280748">:=</span>&nbsp;<span class="keyword" id="7280751">func</span><span class="op" id="7280755">(</span><span class="op" id="7280756">)</span>&nbsp;<span class="op" id="7280758">{</span><span class="op" id="7280759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280762">fp</span>&nbsp;<span class="op" id="7280765">:=</span>&nbsp;<span class="op" id="7280768">&amp;</span><span class="ident" id="7280769">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280772">b0</span>&nbsp;<span class="op" id="7280775">:=</span>&nbsp;<span class="ident" id="7280778">Bug2</span><span class="op" id="7280782">{</span><span class="num" id="7280783">23</span><span class="op" id="7280785">,</span>&nbsp;<span class="ident" id="7280787">c</span><span class="op" id="7280788">,</span>&nbsp;<span class="op" id="7280790">&amp;</span><span class="ident" id="7280791">c</span><span class="op" id="7280792">,</span>&nbsp;<span class="ident" id="7280794">f</span><span class="op" id="7280795">,</span>&nbsp;<span class="op" id="7280797">&amp;</span><span class="ident" id="7280798">fp</span><span class="op" id="7280800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280803">var</span>&nbsp;<span class="ident" id="7280807">buf</span>&nbsp;<span class="ident" id="7280811">bytes</span><span class="op" id="7280816">.</span><span class="ident" id="7280817">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280825">enc</span>&nbsp;<span class="op" id="7280829">:=</span>&nbsp;<span class="ident" id="7280832">NewEncoder</span><span class="op" id="7280842">(</span><span class="op" id="7280843">&amp;</span><span class="ident" id="7280844">buf</span><span class="op" id="7280847">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280850">if</span>&nbsp;<span class="ident" id="7280853">err</span>&nbsp;<span class="op" id="7280857">:=</span>&nbsp;<span class="ident" id="7280860">enc</span><span class="op" id="7280863">.</span><span class="ident" id="7280864">Encode</span><span class="op" id="7280870">(</span><span class="ident" id="7280871">b0</span><span class="op" id="7280873">)</span><span class="op" id="7280874">;</span>&nbsp;<span class="ident" id="7280876">err</span>&nbsp;<span class="op" id="7280880">!=</span>&nbsp;<span class="builtintype" id="7280883">nil</span>&nbsp;<span class="op" id="7280887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280891">t</span><span class="op" id="7280892">.</span><span class="ident" id="7280893">Fatal</span><span class="op" id="7280898">(</span><span class="string" id="7280899">&#34;error&nbsp;encoding:&#34;</span><span class="op" id="7280916">,</span>&nbsp;<span class="ident" id="7280918">err</span><span class="op" id="7280921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7280924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280927">var</span>&nbsp;<span class="ident" id="7280931">b1</span>&nbsp;<span class="ident" id="7280934">Bug2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280940">err</span>&nbsp;<span class="op" id="7280944">:=</span>&nbsp;<span class="ident" id="7280947">NewDecoder</span><span class="op" id="7280957">(</span><span class="op" id="7280958">&amp;</span><span class="ident" id="7280959">buf</span><span class="op" id="7280962">)</span><span class="op" id="7280963">.</span><span class="ident" id="7280964">Decode</span><span class="op" id="7280970">(</span><span class="op" id="7280971">&amp;</span><span class="ident" id="7280972">b1</span><span class="op" id="7280974">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7280977">if</span>&nbsp;<span class="ident" id="7280980">err</span>&nbsp;<span class="op" id="7280984">!=</span>&nbsp;<span class="builtintype" id="7280987">nil</span>&nbsp;<span class="op" id="7280991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7280995">t</span><span class="op" id="7280996">.</span><span class="ident" id="7280997">Fatal</span><span class="op" id="7281002">(</span><span class="string" id="7281003">&#34;decode:&#34;</span><span class="op" id="7281012">,</span>&nbsp;<span class="ident" id="7281014">err</span><span class="op" id="7281017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281023">if</span>&nbsp;<span class="ident" id="7281026">b1</span><span class="op" id="7281028">.</span><span class="ident" id="7281029">A</span>&nbsp;<span class="op" id="7281031">!=</span>&nbsp;<span class="ident" id="7281034">b0</span><span class="op" id="7281036">.</span><span class="ident" id="7281037">A</span>&nbsp;<span class="op" id="7281039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281043">t</span><span class="op" id="7281044">.</span><span class="ident" id="7281045">Fatalf</span><span class="op" id="7281051">(</span><span class="string" id="7281052">&#34;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7281068">,</span>&nbsp;<span class="ident" id="7281070">b1</span><span class="op" id="7281072">.</span><span class="ident" id="7281073">A</span><span class="op" id="7281074">,</span>&nbsp;<span class="ident" id="7281076">b0</span><span class="op" id="7281078">.</span><span class="ident" id="7281079">A</span><span class="op" id="7281080">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281086">if</span>&nbsp;<span class="ident" id="7281089">b1</span><span class="op" id="7281091">.</span><span class="ident" id="7281092">C</span>&nbsp;<span class="op" id="7281094">!=</span>&nbsp;<span class="builtintype" id="7281097">nil</span>&nbsp;<span class="op" id="7281101">||</span>&nbsp;<span class="ident" id="7281104">b1</span><span class="op" id="7281106">.</span><span class="ident" id="7281107">CP</span>&nbsp;<span class="op" id="7281110">!=</span>&nbsp;<span class="builtintype" id="7281113">nil</span>&nbsp;<span class="op" id="7281117">||</span>&nbsp;<span class="ident" id="7281120">b1</span><span class="op" id="7281122">.</span><span class="ident" id="7281123">F</span>&nbsp;<span class="op" id="7281125">!=</span>&nbsp;<span class="builtintype" id="7281128">nil</span>&nbsp;<span class="op" id="7281132">||</span>&nbsp;<span class="ident" id="7281135">b1</span><span class="op" id="7281137">.</span><span class="ident" id="7281138">FPP</span>&nbsp;<span class="op" id="7281142">!=</span>&nbsp;<span class="builtintype" id="7281145">nil</span>&nbsp;<span class="op" id="7281149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281153">t</span><span class="op" id="7281154">.</span><span class="ident" id="7281155">Fatal</span><span class="op" id="7281160">(</span><span class="string" id="7281161">&#34;unexpected&nbsp;value&nbsp;for&nbsp;chan&nbsp;or&nbsp;func&#34;</span><span class="op" id="7281196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281199">}</span><br>
<span class="lineno"></span><span class="op" id="7281201">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="keyword" id="7281204">func</span>&nbsp;<span class="ident" id="7281209">TestSliceIncompatibility</span><span class="op" id="7281233">(</span><span class="ident" id="7281234">t</span>&nbsp;<span class="op" id="7281236">*</span><span class="ident" id="7281237">testing</span><span class="op" id="7281244">.</span><span class="ident" id="7281245">T</span><span class="op" id="7281246">)</span>&nbsp;<span class="op" id="7281248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281251">var</span>&nbsp;<span class="ident" id="7281255">in</span>&nbsp;<span class="op" id="7281258">=</span>&nbsp;<span class="op" id="7281260">[</span><span class="op" id="7281261">]</span><span class="builtintype" id="7281262">byte</span><span class="op" id="7281266">{</span><span class="num" id="7281267">1</span><span class="op" id="7281268">,</span>&nbsp;<span class="num" id="7281270">2</span><span class="op" id="7281271">,</span>&nbsp;<span class="num" id="7281273">3</span><span class="op" id="7281274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281277">var</span>&nbsp;<span class="ident" id="7281281">out</span>&nbsp;<span class="op" id="7281285">[</span><span class="op" id="7281286">]</span><span class="builtintype" id="7281287">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281292">if</span>&nbsp;<span class="ident" id="7281295">err</span>&nbsp;<span class="op" id="7281299">:=</span>&nbsp;<span class="ident" id="7281302">encAndDec</span><span class="op" id="7281311">(</span><span class="ident" id="7281312">in</span><span class="op" id="7281314">,</span>&nbsp;<span class="op" id="7281316">&amp;</span><span class="ident" id="7281317">out</span><span class="op" id="7281320">)</span><span class="op" id="7281321">;</span>&nbsp;<span class="ident" id="7281323">err</span>&nbsp;<span class="op" id="7281327">==</span>&nbsp;<span class="builtintype" id="7281330">nil</span>&nbsp;<span class="op" id="7281334">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281338">t</span><span class="op" id="7281339">.</span><span class="ident" id="7281340">Error</span><span class="op" id="7281345">(</span><span class="string" id="7281346">&#34;expected&nbsp;compatibility&nbsp;error&#34;</span><span class="op" id="7281376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281379">}</span><br>
<span class="lineno"></span><span class="op" id="7281381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7281384">//&nbsp;Mutually&nbsp;recursive&nbsp;slices&nbsp;of&nbsp;structs&nbsp;caused&nbsp;problems.</span><br>
<span class="lineno">780</span><span class="keyword" id="7281441">type</span>&nbsp;<span class="ident" id="7281446">Bug3</span>&nbsp;<span class="keyword" id="7281451">struct</span>&nbsp;<span class="op" id="7281458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281461">Num</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7281470">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281475">Children</span>&nbsp;<span class="op" id="7281484">[</span><span class="op" id="7281485">]</span><span class="op" id="7281486">*</span><span class="ident" id="7281487">Bug3</span><br>
<span class="lineno"></span><span class="op" id="7281492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">785</span><span class="keyword" id="7281495">func</span>&nbsp;<span class="ident" id="7281500">TestGobPtrSlices</span><span class="op" id="7281516">(</span><span class="ident" id="7281517">t</span>&nbsp;<span class="op" id="7281519">*</span><span class="ident" id="7281520">testing</span><span class="op" id="7281527">.</span><span class="ident" id="7281528">T</span><span class="op" id="7281529">)</span>&nbsp;<span class="op" id="7281531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281534">in</span>&nbsp;<span class="op" id="7281537">:=</span>&nbsp;<span class="op" id="7281540">[</span><span class="op" id="7281541">]</span><span class="op" id="7281542">*</span><span class="ident" id="7281543">Bug3</span><span class="op" id="7281547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281551">{</span><span class="num" id="7281552">1</span><span class="op" id="7281553">,</span>&nbsp;<span class="builtintype" id="7281555">nil</span><span class="op" id="7281558">}</span><span class="op" id="7281559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281563">{</span><span class="num" id="7281564">2</span><span class="op" id="7281565">,</span>&nbsp;<span class="builtintype" id="7281567">nil</span><span class="op" id="7281570">}</span><span class="op" id="7281571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281574">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281577">b</span>&nbsp;<span class="op" id="7281579">:=</span>&nbsp;<span class="builtinfunc" id="7281582">new</span><span class="op" id="7281585">(</span><span class="ident" id="7281586">bytes</span><span class="op" id="7281591">.</span><span class="ident" id="7281592">Buffer</span><span class="op" id="7281598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281601">err</span>&nbsp;<span class="op" id="7281605">:=</span>&nbsp;<span class="ident" id="7281608">NewEncoder</span><span class="op" id="7281618">(</span><span class="ident" id="7281619">b</span><span class="op" id="7281620">)</span><span class="op" id="7281621">.</span><span class="ident" id="7281622">Encode</span><span class="op" id="7281628">(</span><span class="op" id="7281629">&amp;</span><span class="ident" id="7281630">in</span><span class="op" id="7281632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281635">if</span>&nbsp;<span class="ident" id="7281638">err</span>&nbsp;<span class="op" id="7281642">!=</span>&nbsp;<span class="builtintype" id="7281645">nil</span>&nbsp;<span class="op" id="7281649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281653">t</span><span class="op" id="7281654">.</span><span class="ident" id="7281655">Fatal</span><span class="op" id="7281660">(</span><span class="string" id="7281661">&#34;encode:&#34;</span><span class="op" id="7281670">,</span>&nbsp;<span class="ident" id="7281672">err</span><span class="op" id="7281675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281678">}</span><br>
<span class="lineno">795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281682">var</span>&nbsp;<span class="ident" id="7281686">out</span>&nbsp;<span class="op" id="7281690">[</span><span class="op" id="7281691">]</span><span class="op" id="7281692">*</span><span class="ident" id="7281693">Bug3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281699">err</span>&nbsp;<span class="op" id="7281703">=</span>&nbsp;<span class="ident" id="7281705">NewDecoder</span><span class="op" id="7281715">(</span><span class="ident" id="7281716">b</span><span class="op" id="7281717">)</span><span class="op" id="7281718">.</span><span class="ident" id="7281719">Decode</span><span class="op" id="7281725">(</span><span class="op" id="7281726">&amp;</span><span class="ident" id="7281727">out</span><span class="op" id="7281730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281733">if</span>&nbsp;<span class="ident" id="7281736">err</span>&nbsp;<span class="op" id="7281740">!=</span>&nbsp;<span class="builtintype" id="7281743">nil</span>&nbsp;<span class="op" id="7281747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281751">t</span><span class="op" id="7281752">.</span><span class="ident" id="7281753">Fatal</span><span class="op" id="7281758">(</span><span class="string" id="7281759">&#34;decode:&#34;</span><span class="op" id="7281768">,</span>&nbsp;<span class="ident" id="7281770">err</span><span class="op" id="7281773">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7281779">if</span>&nbsp;<span class="op" id="7281782">!</span><span class="ident" id="7281783">reflect</span><span class="op" id="7281790">.</span><span class="ident" id="7281791">DeepEqual</span><span class="op" id="7281800">(</span><span class="ident" id="7281801">in</span><span class="op" id="7281803">,</span>&nbsp;<span class="ident" id="7281805">out</span><span class="op" id="7281808">)</span>&nbsp;<span class="op" id="7281810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7281814">t</span><span class="op" id="7281815">.</span><span class="ident" id="7281816">Fatalf</span><span class="op" id="7281822">(</span><span class="string" id="7281823">&#34;got&nbsp;%v;&nbsp;wanted&nbsp;%v&#34;</span><span class="op" id="7281842">,</span>&nbsp;<span class="ident" id="7281844">out</span><span class="op" id="7281847">,</span>&nbsp;<span class="ident" id="7281849">in</span><span class="op" id="7281851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7281854">}</span><br>
<span class="lineno"></span><span class="op" id="7281856">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment" id="7281859">//&nbsp;getDecEnginePtr&nbsp;cached&nbsp;engine&nbsp;for&nbsp;ut.base&nbsp;instead&nbsp;of&nbsp;ut.user&nbsp;so&nbsp;we&nbsp;passed</span><br>
<span class="lineno"></span><span class="comment" id="7281936">//&nbsp;a&nbsp;*map&nbsp;and&nbsp;then&nbsp;tried&nbsp;to&nbsp;reuse&nbsp;its&nbsp;engine&nbsp;to&nbsp;decode&nbsp;the&nbsp;inner&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="7282006">func</span>&nbsp;<span class="ident" id="7282011">TestPtrToMapOfMap</span><span class="op" id="7282028">(</span><span class="ident" id="7282029">t</span>&nbsp;<span class="op" id="7282031">*</span><span class="ident" id="7282032">testing</span><span class="op" id="7282039">.</span><span class="ident" id="7282040">T</span><span class="op" id="7282041">)</span>&nbsp;<span class="op" id="7282043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282046">Register</span><span class="op" id="7282054">(</span><span class="builtinfunc" id="7282055">make</span><span class="op" id="7282059">(</span><span class="keyword" id="7282060">map</span><span class="op" id="7282063">[</span><span class="builtintype" id="7282064">string</span><span class="op" id="7282070">]</span><span class="keyword" id="7282071">interface</span><span class="op" id="7282080">{</span><span class="op" id="7282081">}</span><span class="op" id="7282082">)</span><span class="op" id="7282083">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282086">subdata</span>&nbsp;<span class="op" id="7282094">:=</span>&nbsp;<span class="builtinfunc" id="7282097">make</span><span class="op" id="7282101">(</span><span class="keyword" id="7282102">map</span><span class="op" id="7282105">[</span><span class="builtintype" id="7282106">string</span><span class="op" id="7282112">]</span><span class="keyword" id="7282113">interface</span><span class="op" id="7282122">{</span><span class="op" id="7282123">}</span><span class="op" id="7282124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282127">subdata</span><span class="op" id="7282134">[</span><span class="string" id="7282135">&#34;bar&#34;</span><span class="op" id="7282140">]</span>&nbsp;<span class="op" id="7282142">=</span>&nbsp;<span class="string" id="7282144">&#34;baz&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282151">data</span>&nbsp;<span class="op" id="7282156">:=</span>&nbsp;<span class="builtinfunc" id="7282159">make</span><span class="op" id="7282163">(</span><span class="keyword" id="7282164">map</span><span class="op" id="7282167">[</span><span class="builtintype" id="7282168">string</span><span class="op" id="7282174">]</span><span class="keyword" id="7282175">interface</span><span class="op" id="7282184">{</span><span class="op" id="7282185">}</span><span class="op" id="7282186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282189">data</span><span class="op" id="7282193">[</span><span class="string" id="7282194">&#34;foo&#34;</span><span class="op" id="7282199">]</span>&nbsp;<span class="op" id="7282201">=</span>&nbsp;<span class="ident" id="7282203">subdata</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282213">b</span>&nbsp;<span class="op" id="7282215">:=</span>&nbsp;<span class="builtinfunc" id="7282218">new</span><span class="op" id="7282221">(</span><span class="ident" id="7282222">bytes</span><span class="op" id="7282227">.</span><span class="ident" id="7282228">Buffer</span><span class="op" id="7282234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282237">err</span>&nbsp;<span class="op" id="7282241">:=</span>&nbsp;<span class="ident" id="7282244">NewEncoder</span><span class="op" id="7282254">(</span><span class="ident" id="7282255">b</span><span class="op" id="7282256">)</span><span class="op" id="7282257">.</span><span class="ident" id="7282258">Encode</span><span class="op" id="7282264">(</span><span class="ident" id="7282265">data</span><span class="op" id="7282269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282272">if</span>&nbsp;<span class="ident" id="7282275">err</span>&nbsp;<span class="op" id="7282279">!=</span>&nbsp;<span class="builtintype" id="7282282">nil</span>&nbsp;<span class="op" id="7282286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282290">t</span><span class="op" id="7282291">.</span><span class="ident" id="7282292">Fatal</span><span class="op" id="7282297">(</span><span class="string" id="7282298">&#34;encode:&#34;</span><span class="op" id="7282307">,</span>&nbsp;<span class="ident" id="7282309">err</span><span class="op" id="7282312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7282315">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282318">var</span>&nbsp;<span class="ident" id="7282322">newData</span>&nbsp;<span class="keyword" id="7282330">map</span><span class="op" id="7282333">[</span><span class="builtintype" id="7282334">string</span><span class="op" id="7282340">]</span><span class="keyword" id="7282341">interface</span><span class="op" id="7282350">{</span><span class="op" id="7282351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282354">err</span>&nbsp;<span class="op" id="7282358">=</span>&nbsp;<span class="ident" id="7282360">NewDecoder</span><span class="op" id="7282370">(</span><span class="ident" id="7282371">b</span><span class="op" id="7282372">)</span><span class="op" id="7282373">.</span><span class="ident" id="7282374">Decode</span><span class="op" id="7282380">(</span><span class="op" id="7282381">&amp;</span><span class="ident" id="7282382">newData</span><span class="op" id="7282389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282392">if</span>&nbsp;<span class="ident" id="7282395">err</span>&nbsp;<span class="op" id="7282399">!=</span>&nbsp;<span class="builtintype" id="7282402">nil</span>&nbsp;<span class="op" id="7282406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282410">t</span><span class="op" id="7282411">.</span><span class="ident" id="7282412">Fatal</span><span class="op" id="7282417">(</span><span class="string" id="7282418">&#34;decode:&#34;</span><span class="op" id="7282427">,</span>&nbsp;<span class="ident" id="7282429">err</span><span class="op" id="7282432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7282435">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282438">if</span>&nbsp;<span class="op" id="7282441">!</span><span class="ident" id="7282442">reflect</span><span class="op" id="7282449">.</span><span class="ident" id="7282450">DeepEqual</span><span class="op" id="7282459">(</span><span class="ident" id="7282460">data</span><span class="op" id="7282464">,</span>&nbsp;<span class="ident" id="7282466">newData</span><span class="op" id="7282473">)</span>&nbsp;<span class="op" id="7282475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282479">t</span><span class="op" id="7282480">.</span><span class="ident" id="7282481">Fatalf</span><span class="op" id="7282487">(</span><span class="string" id="7282488">&#34;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7282508">,</span>&nbsp;<span class="ident" id="7282510">data</span><span class="op" id="7282514">,</span>&nbsp;<span class="ident" id="7282516">newData</span><span class="op" id="7282523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7282526">}</span><br>
<span class="lineno"></span><span class="op" id="7282528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="comment" id="7282531">//&nbsp;A&nbsp;top-level&nbsp;nil&nbsp;pointer&nbsp;generates&nbsp;a&nbsp;panic&nbsp;with&nbsp;a&nbsp;helpful&nbsp;string-valued&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="7282614">func</span>&nbsp;<span class="ident" id="7282619">TestTopLevelNilPointer</span><span class="op" id="7282641">(</span><span class="ident" id="7282642">t</span>&nbsp;<span class="op" id="7282644">*</span><span class="ident" id="7282645">testing</span><span class="op" id="7282652">.</span><span class="ident" id="7282653">T</span><span class="op" id="7282654">)</span>&nbsp;<span class="op" id="7282656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282659">errMsg</span>&nbsp;<span class="op" id="7282666">:=</span>&nbsp;<span class="ident" id="7282669">topLevelNilPanic</span><span class="op" id="7282685">(</span><span class="ident" id="7282686">t</span><span class="op" id="7282687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282690">if</span>&nbsp;<span class="ident" id="7282693">errMsg</span>&nbsp;<span class="op" id="7282700">==</span>&nbsp;<span class="string" id="7282703">&#34;&#34;</span>&nbsp;<span class="op" id="7282706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282710">t</span><span class="op" id="7282711">.</span><span class="ident" id="7282712">Fatal</span><span class="op" id="7282717">(</span><span class="string" id="7282718">&#34;top-level&nbsp;nil&nbsp;pointer&nbsp;did&nbsp;not&nbsp;panic&#34;</span><span class="op" id="7282755">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7282758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282761">if</span>&nbsp;<span class="op" id="7282764">!</span><span class="ident" id="7282765">strings</span><span class="op" id="7282772">.</span><span class="ident" id="7282773">Contains</span><span class="op" id="7282781">(</span><span class="ident" id="7282782">errMsg</span><span class="op" id="7282788">,</span>&nbsp;<span class="string" id="7282790">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7282803">)</span>&nbsp;<span class="op" id="7282805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282809">t</span><span class="op" id="7282810">.</span><span class="ident" id="7282811">Fatal</span><span class="op" id="7282816">(</span><span class="string" id="7282817">&#34;expected&nbsp;nil&nbsp;pointer&nbsp;error,&nbsp;got:&#34;</span><span class="op" id="7282851">,</span>&nbsp;<span class="ident" id="7282853">errMsg</span><span class="op" id="7282859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7282862">}</span><br>
<span class="lineno"></span><span class="op" id="7282864">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="7282867">func</span>&nbsp;<span class="ident" id="7282872">topLevelNilPanic</span><span class="op" id="7282888">(</span><span class="ident" id="7282889">t</span>&nbsp;<span class="op" id="7282891">*</span><span class="ident" id="7282892">testing</span><span class="op" id="7282899">.</span><span class="ident" id="7282900">T</span><span class="op" id="7282901">)</span>&nbsp;<span class="op" id="7282903">(</span><span class="ident" id="7282904">panicErr</span>&nbsp;<span class="builtintype" id="7282913">string</span><span class="op" id="7282919">)</span>&nbsp;<span class="op" id="7282921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282924">defer</span>&nbsp;<span class="keyword" id="7282930">func</span><span class="op" id="7282934">(</span><span class="op" id="7282935">)</span>&nbsp;<span class="op" id="7282937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282941">e</span>&nbsp;<span class="op" id="7282943">:=</span>&nbsp;<span class="builtinfunc" id="7282946">recover</span><span class="op" id="7282953">(</span><span class="op" id="7282954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7282958">if</span>&nbsp;<span class="ident" id="7282961">err</span><span class="op" id="7282964">,</span>&nbsp;<span class="ident" id="7282966">ok</span>&nbsp;<span class="op" id="7282969">:=</span>&nbsp;<span class="ident" id="7282972">e</span><span class="op" id="7282973">.</span><span class="op" id="7282974">(</span><span class="builtintype" id="7282975">string</span><span class="op" id="7282981">)</span><span class="op" id="7282982">;</span>&nbsp;<span class="ident" id="7282984">ok</span>&nbsp;<span class="op" id="7282987">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7282992">panicErr</span>&nbsp;<span class="op" id="7283001">=</span>&nbsp;<span class="ident" id="7283003">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283012">}</span><span class="op" id="7283013">(</span><span class="op" id="7283014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283017">var</span>&nbsp;<span class="ident" id="7283021">ip</span>&nbsp;<span class="op" id="7283024">*</span><span class="builtintype" id="7283025">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283030">buf</span>&nbsp;<span class="op" id="7283034">:=</span>&nbsp;<span class="builtinfunc" id="7283037">new</span><span class="op" id="7283040">(</span><span class="ident" id="7283041">bytes</span><span class="op" id="7283046">.</span><span class="ident" id="7283047">Buffer</span><span class="op" id="7283053">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283056">if</span>&nbsp;<span class="ident" id="7283059">err</span>&nbsp;<span class="op" id="7283063">:=</span>&nbsp;<span class="ident" id="7283066">NewEncoder</span><span class="op" id="7283076">(</span><span class="ident" id="7283077">buf</span><span class="op" id="7283080">)</span><span class="op" id="7283081">.</span><span class="ident" id="7283082">Encode</span><span class="op" id="7283088">(</span><span class="ident" id="7283089">ip</span><span class="op" id="7283091">)</span><span class="op" id="7283092">;</span>&nbsp;<span class="ident" id="7283094">err</span>&nbsp;<span class="op" id="7283098">!=</span>&nbsp;<span class="builtintype" id="7283101">nil</span>&nbsp;<span class="op" id="7283105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283109">t</span><span class="op" id="7283110">.</span><span class="ident" id="7283111">Fatal</span><span class="op" id="7283116">(</span><span class="string" id="7283117">&#34;error&nbsp;in&nbsp;encode:&#34;</span><span class="op" id="7283135">,</span>&nbsp;<span class="ident" id="7283137">err</span><span class="op" id="7283140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283146">return</span><br>
<span class="lineno"></span><span class="op" id="7283153">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span><span class="keyword" id="7283156">func</span>&nbsp;<span class="ident" id="7283161">TestNilPointerInsideInterface</span><span class="op" id="7283190">(</span><span class="ident" id="7283191">t</span>&nbsp;<span class="op" id="7283193">*</span><span class="ident" id="7283194">testing</span><span class="op" id="7283201">.</span><span class="ident" id="7283202">T</span><span class="op" id="7283203">)</span>&nbsp;<span class="op" id="7283205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283208">var</span>&nbsp;<span class="ident" id="7283212">ip</span>&nbsp;<span class="op" id="7283215">*</span><span class="builtintype" id="7283216">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283221">si</span>&nbsp;<span class="op" id="7283224">:=</span>&nbsp;<span class="keyword" id="7283227">struct</span>&nbsp;<span class="op" id="7283234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283238">I</span>&nbsp;<span class="keyword" id="7283240">interface</span><span class="op" id="7283249">{</span><span class="op" id="7283250">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283253">}</span><span class="op" id="7283254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283258">I</span><span class="op" id="7283259">:</span>&nbsp;<span class="ident" id="7283261">ip</span><span class="op" id="7283263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283269">buf</span>&nbsp;<span class="op" id="7283273">:=</span>&nbsp;<span class="builtinfunc" id="7283276">new</span><span class="op" id="7283279">(</span><span class="ident" id="7283280">bytes</span><span class="op" id="7283285">.</span><span class="ident" id="7283286">Buffer</span><span class="op" id="7283292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283295">err</span>&nbsp;<span class="op" id="7283299">:=</span>&nbsp;<span class="ident" id="7283302">NewEncoder</span><span class="op" id="7283312">(</span><span class="ident" id="7283313">buf</span><span class="op" id="7283316">)</span><span class="op" id="7283317">.</span><span class="ident" id="7283318">Encode</span><span class="op" id="7283324">(</span><span class="ident" id="7283325">si</span><span class="op" id="7283327">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283330">if</span>&nbsp;<span class="ident" id="7283333">err</span>&nbsp;<span class="op" id="7283337">==</span>&nbsp;<span class="builtintype" id="7283340">nil</span>&nbsp;<span class="op" id="7283344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283348">t</span><span class="op" id="7283349">.</span><span class="ident" id="7283350">Fatal</span><span class="op" id="7283355">(</span><span class="string" id="7283356">&#34;expected&nbsp;error,&nbsp;got&nbsp;none&#34;</span><span class="op" id="7283382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283388">errMsg</span>&nbsp;<span class="op" id="7283395">:=</span>&nbsp;<span class="ident" id="7283398">err</span><span class="op" id="7283401">.</span><span class="ident" id="7283402">Error</span><span class="op" id="7283407">(</span><span class="op" id="7283408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283411">if</span>&nbsp;<span class="op" id="7283414">!</span><span class="ident" id="7283415">strings</span><span class="op" id="7283422">.</span><span class="ident" id="7283423">Contains</span><span class="op" id="7283431">(</span><span class="ident" id="7283432">errMsg</span><span class="op" id="7283438">,</span>&nbsp;<span class="string" id="7283440">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7283453">)</span>&nbsp;<span class="op" id="7283455">||</span>&nbsp;<span class="op" id="7283458">!</span><span class="ident" id="7283459">strings</span><span class="op" id="7283466">.</span><span class="ident" id="7283467">Contains</span><span class="op" id="7283475">(</span><span class="ident" id="7283476">errMsg</span><span class="op" id="7283482">,</span>&nbsp;<span class="string" id="7283484">&#34;interface&#34;</span><span class="op" id="7283495">)</span>&nbsp;<span class="op" id="7283497">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283501">t</span><span class="op" id="7283502">.</span><span class="ident" id="7283503">Fatal</span><span class="op" id="7283508">(</span><span class="string" id="7283509">&#34;expected&nbsp;error&nbsp;about&nbsp;nil&nbsp;pointer&nbsp;and&nbsp;interface,&nbsp;got:&#34;</span><span class="op" id="7283563">,</span>&nbsp;<span class="ident" id="7283565">errMsg</span><span class="op" id="7283571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283574">}</span><br>
<span class="lineno"></span><span class="op" id="7283576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283579">type</span>&nbsp;<span class="ident" id="7283584">Bug4Public</span>&nbsp;<span class="keyword" id="7283595">struct</span>&nbsp;<span class="op" id="7283602">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283605">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7283612">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283620">Secret</span>&nbsp;<span class="ident" id="7283627">Bug4Secret</span><br>
<span class="lineno"></span><span class="op" id="7283638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7283641">type</span>&nbsp;<span class="ident" id="7283646">Bug4Secret</span>&nbsp;<span class="keyword" id="7283657">struct</span>&nbsp;<span class="op" id="7283664">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283667">a</span>&nbsp;<span class="builtintype" id="7283669">int</span>&nbsp;<span class="comment" id="7283673">//&nbsp;error:&nbsp;no&nbsp;exported&nbsp;fields.</span><br>
<span class="lineno"></span><span class="op" id="7283703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7283706">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;failed&nbsp;compilation&nbsp;doesn&#39;t&nbsp;leave&nbsp;around&nbsp;an&nbsp;executable&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="7283784">//&nbsp;Issue&nbsp;3273.</span><br>
<span class="lineno">885</span><span class="keyword" id="7283799">func</span>&nbsp;<span class="ident" id="7283804">TestMutipleEncodingsOfBadType</span><span class="op" id="7283833">(</span><span class="ident" id="7283834">t</span>&nbsp;<span class="op" id="7283836">*</span><span class="ident" id="7283837">testing</span><span class="op" id="7283844">.</span><span class="ident" id="7283845">T</span><span class="op" id="7283846">)</span>&nbsp;<span class="op" id="7283848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283851">x</span>&nbsp;<span class="op" id="7283853">:=</span>&nbsp;<span class="ident" id="7283856">Bug4Public</span><span class="op" id="7283866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283870">Name</span><span class="op" id="7283874">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7283878">&#34;name&#34;</span><span class="op" id="7283884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283888">Secret</span><span class="op" id="7283894">:</span>&nbsp;<span class="ident" id="7283896">Bug4Secret</span><span class="op" id="7283906">{</span><span class="num" id="7283907">1</span><span class="op" id="7283908">}</span><span class="op" id="7283909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7283912">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283915">buf</span>&nbsp;<span class="op" id="7283919">:=</span>&nbsp;<span class="builtinfunc" id="7283922">new</span><span class="op" id="7283925">(</span><span class="ident" id="7283926">bytes</span><span class="op" id="7283931">.</span><span class="ident" id="7283932">Buffer</span><span class="op" id="7283938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283941">enc</span>&nbsp;<span class="op" id="7283945">:=</span>&nbsp;<span class="ident" id="7283948">NewEncoder</span><span class="op" id="7283958">(</span><span class="ident" id="7283959">buf</span><span class="op" id="7283962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7283965">err</span>&nbsp;<span class="op" id="7283969">:=</span>&nbsp;<span class="ident" id="7283972">enc</span><span class="op" id="7283975">.</span><span class="ident" id="7283976">Encode</span><span class="op" id="7283982">(</span><span class="ident" id="7283983">x</span><span class="op" id="7283984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7283987">if</span>&nbsp;<span class="ident" id="7283990">err</span>&nbsp;<span class="op" id="7283994">==</span>&nbsp;<span class="builtintype" id="7283997">nil</span>&nbsp;<span class="op" id="7284001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284005">t</span><span class="op" id="7284006">.</span><span class="ident" id="7284007">Fatal</span><span class="op" id="7284012">(</span><span class="string" id="7284013">&#34;first&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7284045">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7284048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284051">buf</span><span class="op" id="7284054">.</span><span class="ident" id="7284055">Reset</span><span class="op" id="7284060">(</span><span class="op" id="7284061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284064">enc</span>&nbsp;<span class="op" id="7284068">=</span>&nbsp;<span class="ident" id="7284070">NewEncoder</span><span class="op" id="7284080">(</span><span class="ident" id="7284081">buf</span><span class="op" id="7284084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284087">err</span>&nbsp;<span class="op" id="7284091">=</span>&nbsp;<span class="ident" id="7284093">enc</span><span class="op" id="7284096">.</span><span class="ident" id="7284097">Encode</span><span class="op" id="7284103">(</span><span class="ident" id="7284104">x</span><span class="op" id="7284105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284108">if</span>&nbsp;<span class="ident" id="7284111">err</span>&nbsp;<span class="op" id="7284115">==</span>&nbsp;<span class="builtintype" id="7284118">nil</span>&nbsp;<span class="op" id="7284122">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284126">t</span><span class="op" id="7284127">.</span><span class="ident" id="7284128">Fatal</span><span class="op" id="7284133">(</span><span class="string" id="7284134">&#34;second&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7284167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7284170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284173">if</span>&nbsp;<span class="op" id="7284176">!</span><span class="ident" id="7284177">strings</span><span class="op" id="7284184">.</span><span class="ident" id="7284185">Contains</span><span class="op" id="7284193">(</span><span class="ident" id="7284194">err</span><span class="op" id="7284197">.</span><span class="ident" id="7284198">Error</span><span class="op" id="7284203">(</span><span class="op" id="7284204">)</span><span class="op" id="7284205">,</span>&nbsp;<span class="string" id="7284207">&#34;no&nbsp;exported&nbsp;fields&#34;</span><span class="op" id="7284227">)</span>&nbsp;<span class="op" id="7284229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284233">t</span><span class="op" id="7284234">.</span><span class="ident" id="7284235">Errorf</span><span class="op" id="7284241">(</span><span class="string" id="7284242">&#34;expected&nbsp;error&nbsp;about&nbsp;no&nbsp;exported&nbsp;fields;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7284291">,</span>&nbsp;<span class="ident" id="7284293">err</span><span class="op" id="7284296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7284299">}</span><br>
<span class="lineno">905</span><span class="op" id="7284301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7284304">//&nbsp;There&nbsp;was&nbsp;an&nbsp;error&nbsp;check&nbsp;comparing&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;input&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7284375">//&nbsp;length&nbsp;of&nbsp;the&nbsp;slice&nbsp;being&nbsp;decoded.&nbsp;It&nbsp;was&nbsp;wrong&nbsp;because&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="7284443">//&nbsp;thing&nbsp;in&nbsp;the&nbsp;input&nbsp;might&nbsp;be&nbsp;a&nbsp;type&nbsp;definition,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to</span><br>
<span class="lineno">910</span><span class="comment" id="7284513">//&nbsp;an&nbsp;incorrect&nbsp;length&nbsp;check.&nbsp;&nbsp;This&nbsp;test&nbsp;reproduces&nbsp;the&nbsp;corner&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7284583">type</span>&nbsp;<span class="ident" id="7284588">Z</span>&nbsp;<span class="keyword" id="7284590">struct</span>&nbsp;<span class="op" id="7284597">{</span><br>
<span class="lineno"></span><span class="op" id="7284599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="7284602">func</span>&nbsp;<span class="ident" id="7284607">Test29ElementSlice</span><span class="op" id="7284625">(</span><span class="ident" id="7284626">t</span>&nbsp;<span class="op" id="7284628">*</span><span class="ident" id="7284629">testing</span><span class="op" id="7284636">.</span><span class="ident" id="7284637">T</span><span class="op" id="7284638">)</span>&nbsp;<span class="op" id="7284640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284643">Register</span><span class="op" id="7284651">(</span><span class="ident" id="7284652">Z</span><span class="op" id="7284653">{</span><span class="op" id="7284654">}</span><span class="op" id="7284655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284658">src</span>&nbsp;<span class="op" id="7284662">:=</span>&nbsp;<span class="builtinfunc" id="7284665">make</span><span class="op" id="7284669">(</span><span class="op" id="7284670">[</span><span class="op" id="7284671">]</span><span class="keyword" id="7284672">interface</span><span class="op" id="7284681">{</span><span class="op" id="7284682">}</span><span class="op" id="7284683">,</span>&nbsp;<span class="num" id="7284685">100</span><span class="op" id="7284688">)</span>&nbsp;<span class="comment" id="7284690">//&nbsp;Size&nbsp;needs&nbsp;to&nbsp;be&nbsp;bigger&nbsp;than&nbsp;size&nbsp;of&nbsp;type&nbsp;definition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284748">for</span>&nbsp;<span class="ident" id="7284752">i</span>&nbsp;<span class="op" id="7284754">:=</span>&nbsp;<span class="keyword" id="7284757">range</span>&nbsp;<span class="ident" id="7284763">src</span>&nbsp;<span class="op" id="7284767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284771">src</span><span class="op" id="7284774">[</span><span class="ident" id="7284775">i</span><span class="op" id="7284776">]</span>&nbsp;<span class="op" id="7284778">=</span>&nbsp;<span class="ident" id="7284780">Z</span><span class="op" id="7284781">{</span><span class="op" id="7284782">}</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7284785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284788">buf</span>&nbsp;<span class="op" id="7284792">:=</span>&nbsp;<span class="builtinfunc" id="7284795">new</span><span class="op" id="7284798">(</span><span class="ident" id="7284799">bytes</span><span class="op" id="7284804">.</span><span class="ident" id="7284805">Buffer</span><span class="op" id="7284811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284814">err</span>&nbsp;<span class="op" id="7284818">:=</span>&nbsp;<span class="ident" id="7284821">NewEncoder</span><span class="op" id="7284831">(</span><span class="ident" id="7284832">buf</span><span class="op" id="7284835">)</span><span class="op" id="7284836">.</span><span class="ident" id="7284837">Encode</span><span class="op" id="7284843">(</span><span class="ident" id="7284844">src</span><span class="op" id="7284847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284850">if</span>&nbsp;<span class="ident" id="7284853">err</span>&nbsp;<span class="op" id="7284857">!=</span>&nbsp;<span class="builtintype" id="7284860">nil</span>&nbsp;<span class="op" id="7284864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284868">t</span><span class="op" id="7284869">.</span><span class="ident" id="7284870">Fatalf</span><span class="op" id="7284876">(</span><span class="string" id="7284877">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="7284889">,</span>&nbsp;<span class="ident" id="7284891">err</span><span class="op" id="7284894">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284898">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7284906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284910">var</span>&nbsp;<span class="ident" id="7284914">dst</span>&nbsp;<span class="op" id="7284918">[</span><span class="op" id="7284919">]</span><span class="keyword" id="7284920">interface</span><span class="op" id="7284929">{</span><span class="op" id="7284930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284933">err</span>&nbsp;<span class="op" id="7284937">=</span>&nbsp;<span class="ident" id="7284939">NewDecoder</span><span class="op" id="7284949">(</span><span class="ident" id="7284950">buf</span><span class="op" id="7284953">)</span><span class="op" id="7284954">.</span><span class="ident" id="7284955">Decode</span><span class="op" id="7284961">(</span><span class="op" id="7284962">&amp;</span><span class="ident" id="7284963">dst</span><span class="op" id="7284966">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7284969">if</span>&nbsp;<span class="ident" id="7284972">err</span>&nbsp;<span class="op" id="7284976">!=</span>&nbsp;<span class="builtintype" id="7284979">nil</span>&nbsp;<span class="op" id="7284983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7284987">t</span><span class="op" id="7284988">.</span><span class="ident" id="7284989">Errorf</span><span class="op" id="7284995">(</span><span class="string" id="7284996">&#34;decode:&nbsp;%v&#34;</span><span class="op" id="7285008">,</span>&nbsp;<span class="ident" id="7285010">err</span><span class="op" id="7285013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7285017">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7285025">}</span><br>
<span class="lineno"></span><span class="op" id="7285027">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="7285030">//&nbsp;Don&#39;t&nbsp;crash,&nbsp;just&nbsp;give&nbsp;error&nbsp;when&nbsp;allocating&nbsp;a&nbsp;huge&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="7285092">//&nbsp;Issue&nbsp;8084.</span><br>
<span class="lineno"></span><span class="keyword" id="7285107">func</span>&nbsp;<span class="ident" id="7285112">TestErrorForHugeSlice</span><span class="op" id="7285133">(</span><span class="ident" id="7285134">t</span>&nbsp;<span class="op" id="7285136">*</span><span class="ident" id="7285137">testing</span><span class="op" id="7285144">.</span><span class="ident" id="7285145">T</span><span class="op" id="7285146">)</span>&nbsp;<span class="op" id="7285148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7285151">//&nbsp;Encode&nbsp;an&nbsp;int&nbsp;slice.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285176">buf</span>&nbsp;<span class="op" id="7285180">:=</span>&nbsp;<span class="builtinfunc" id="7285183">new</span><span class="op" id="7285186">(</span><span class="ident" id="7285187">bytes</span><span class="op" id="7285192">.</span><span class="ident" id="7285193">Buffer</span><span class="op" id="7285199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285202">slice</span>&nbsp;<span class="op" id="7285208">:=</span>&nbsp;<span class="op" id="7285211">[</span><span class="op" id="7285212">]</span><span class="builtintype" id="7285213">int</span><span class="op" id="7285216">{</span><span class="num" id="7285217">1</span><span class="op" id="7285218">,</span>&nbsp;<span class="num" id="7285220">1</span><span class="op" id="7285221">,</span>&nbsp;<span class="num" id="7285223">1</span><span class="op" id="7285224">,</span>&nbsp;<span class="num" id="7285226">1</span><span class="op" id="7285227">,</span>&nbsp;<span class="num" id="7285229">1</span><span class="op" id="7285230">,</span>&nbsp;<span class="num" id="7285232">1</span><span class="op" id="7285233">,</span>&nbsp;<span class="num" id="7285235">1</span><span class="op" id="7285236">,</span>&nbsp;<span class="num" id="7285238">1</span><span class="op" id="7285239">,</span>&nbsp;<span class="num" id="7285241">1</span><span class="op" id="7285242">,</span>&nbsp;<span class="num" id="7285244">1</span><span class="op" id="7285245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285248">err</span>&nbsp;<span class="op" id="7285252">:=</span>&nbsp;<span class="ident" id="7285255">NewEncoder</span><span class="op" id="7285265">(</span><span class="ident" id="7285266">buf</span><span class="op" id="7285269">)</span><span class="op" id="7285270">.</span><span class="ident" id="7285271">Encode</span><span class="op" id="7285277">(</span><span class="ident" id="7285278">slice</span><span class="op" id="7285283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7285286">if</span>&nbsp;<span class="ident" id="7285289">err</span>&nbsp;<span class="op" id="7285293">!=</span>&nbsp;<span class="builtintype" id="7285296">nil</span>&nbsp;<span class="op" id="7285300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285304">t</span><span class="op" id="7285305">.</span><span class="ident" id="7285306">Fatal</span><span class="op" id="7285311">(</span><span class="string" id="7285312">&#34;encode:&#34;</span><span class="op" id="7285321">,</span>&nbsp;<span class="ident" id="7285323">err</span><span class="op" id="7285326">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7285329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7285332">//&nbsp;Reach&nbsp;into&nbsp;the&nbsp;buffer&nbsp;and&nbsp;smash&nbsp;the&nbsp;count&nbsp;to&nbsp;make&nbsp;the&nbsp;encoded&nbsp;slice&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285415">buf</span><span class="op" id="7285418">.</span><span class="ident" id="7285419">Bytes</span><span class="op" id="7285424">(</span><span class="op" id="7285425">)</span><span class="op" id="7285426">[</span><span class="ident" id="7285427">buf</span><span class="op" id="7285430">.</span><span class="ident" id="7285431">Len</span><span class="op" id="7285434">(</span><span class="op" id="7285435">)</span><span class="op" id="7285436">-</span><span class="builtinfunc" id="7285437">len</span><span class="op" id="7285440">(</span><span class="ident" id="7285441">slice</span><span class="op" id="7285446">)</span><span class="op" id="7285447">-</span><span class="num" id="7285448">1</span><span class="op" id="7285449">]</span>&nbsp;<span class="op" id="7285451">=</span>&nbsp;<span class="num" id="7285453">0xfa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7285459">//&nbsp;Decode&nbsp;and&nbsp;see&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285485">err</span>&nbsp;<span class="op" id="7285489">=</span>&nbsp;<span class="ident" id="7285491">NewDecoder</span><span class="op" id="7285501">(</span><span class="ident" id="7285502">buf</span><span class="op" id="7285505">)</span><span class="op" id="7285506">.</span><span class="ident" id="7285507">Decode</span><span class="op" id="7285513">(</span><span class="op" id="7285514">&amp;</span><span class="ident" id="7285515">slice</span><span class="op" id="7285520">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7285523">if</span>&nbsp;<span class="ident" id="7285526">err</span>&nbsp;<span class="op" id="7285530">==</span>&nbsp;<span class="builtintype" id="7285533">nil</span>&nbsp;<span class="op" id="7285537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285541">t</span><span class="op" id="7285542">.</span><span class="ident" id="7285543">Fatal</span><span class="op" id="7285548">(</span><span class="string" id="7285549">&#34;decode:&nbsp;no&nbsp;error&#34;</span><span class="op" id="7285567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7285570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7285573">if</span>&nbsp;<span class="op" id="7285576">!</span><span class="ident" id="7285577">strings</span><span class="op" id="7285584">.</span><span class="ident" id="7285585">Contains</span><span class="op" id="7285593">(</span><span class="ident" id="7285594">err</span><span class="op" id="7285597">.</span><span class="ident" id="7285598">Error</span><span class="op" id="7285603">(</span><span class="op" id="7285604">)</span><span class="op" id="7285605">,</span>&nbsp;<span class="string" id="7285607">&#34;slice&nbsp;too&nbsp;big&#34;</span><span class="op" id="7285622">)</span>&nbsp;<span class="op" id="7285624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7285628">t</span><span class="op" id="7285629">.</span><span class="ident" id="7285630">Fatal</span><span class="op" id="7285635">(</span><span class="string" id="7285636">&#34;decode:&nbsp;expected&nbsp;slice&nbsp;too&nbsp;big&nbsp;error,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7285682">,</span>&nbsp;<span class="ident" id="7285684">err</span><span class="op" id="7285687">.</span><span class="ident" id="7285688">Error</span><span class="op" id="7285693">(</span><span class="op" id="7285694">)</span><span class="op" id="7285695">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7285698">}</span><br>
<span class="lineno"></span><span class="op" id="7285700">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
