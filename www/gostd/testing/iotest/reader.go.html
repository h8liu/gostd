<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6120931">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6120986">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6121040">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6121091">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6121167">package</span>&nbsp;<span class="ident" id="6121175">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121183">import</span>&nbsp;<span class="op" id="6121190">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121193">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6121203">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6121208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6121211">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="6121261">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="6121312">func</span>&nbsp;<span class="ident" id="6121317">OneByteReader</span><span class="op" id="6121330">(</span><span class="ident" id="6121331">r</span>&nbsp;<span class="ident" id="6121333">io</span><span class="op" id="6121335">.</span><span class="ident" id="6121336">Reader</span><span class="op" id="6121342">)</span>&nbsp;<span class="ident" id="6121344">io</span><span class="op" id="6121346">.</span><span class="ident" id="6121347">Reader</span>&nbsp;<span class="op" id="6121354">{</span>&nbsp;<span class="keyword" id="6121356">return</span>&nbsp;<span class="op" id="6121363">&amp;</span><span class="ident" id="6121364">oneByteReader</span><span class="op" id="6121377">{</span><span class="ident" id="6121378">r</span><span class="op" id="6121379">}</span>&nbsp;<span class="op" id="6121381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121384">type</span>&nbsp;<span class="ident" id="6121389">oneByteReader</span>&nbsp;<span class="keyword" id="6121403">struct</span>&nbsp;<span class="op" id="6121410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121413">r</span>&nbsp;<span class="ident" id="6121415">io</span><span class="op" id="6121417">.</span><span class="ident" id="6121418">Reader</span><br>
<span class="lineno"></span><span class="op" id="6121425">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6121428">func</span>&nbsp;<span class="op" id="6121433">(</span><span class="ident" id="6121434">r</span>&nbsp;<span class="op" id="6121436">*</span><span class="ident" id="6121437">oneByteReader</span><span class="op" id="6121450">)</span>&nbsp;<span class="ident" id="6121452">Read</span><span class="op" id="6121456">(</span><span class="ident" id="6121457">p</span>&nbsp;<span class="op" id="6121459">[</span><span class="op" id="6121460">]</span><span class="builtintype" id="6121461">byte</span><span class="op" id="6121465">)</span>&nbsp;<span class="op" id="6121467">(</span><span class="builtintype" id="6121468">int</span><span class="op" id="6121471">,</span>&nbsp;<span class="builtintype" id="6121473">error</span><span class="op" id="6121478">)</span>&nbsp;<span class="op" id="6121480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121483">if</span>&nbsp;<span class="builtinfunc" id="6121486">len</span><span class="op" id="6121489">(</span><span class="ident" id="6121490">p</span><span class="op" id="6121491">)</span>&nbsp;<span class="op" id="6121493">==</span>&nbsp;<span class="num" id="6121496">0</span>&nbsp;<span class="op" id="6121498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121502">return</span>&nbsp;<span class="num" id="6121509">0</span><span class="op" id="6121510">,</span>&nbsp;<span class="ident" id="6121512">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121517">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121520">return</span>&nbsp;<span class="ident" id="6121527">r</span><span class="op" id="6121528">.</span><span class="ident" id="6121529">r</span><span class="op" id="6121530">.</span><span class="ident" id="6121531">Read</span><span class="op" id="6121535">(</span><span class="ident" id="6121536">p</span><span class="op" id="6121537">[</span><span class="num" id="6121538">0</span><span class="op" id="6121539">:</span><span class="num" id="6121540">1</span><span class="op" id="6121541">]</span><span class="op" id="6121542">)</span><br>
<span class="lineno"></span><span class="op" id="6121544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6121547">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="6121599">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="6121650">func</span>&nbsp;<span class="ident" id="6121655">HalfReader</span><span class="op" id="6121665">(</span><span class="ident" id="6121666">r</span>&nbsp;<span class="ident" id="6121668">io</span><span class="op" id="6121670">.</span><span class="ident" id="6121671">Reader</span><span class="op" id="6121677">)</span>&nbsp;<span class="ident" id="6121679">io</span><span class="op" id="6121681">.</span><span class="ident" id="6121682">Reader</span>&nbsp;<span class="op" id="6121689">{</span>&nbsp;<span class="keyword" id="6121691">return</span>&nbsp;<span class="op" id="6121698">&amp;</span><span class="ident" id="6121699">halfReader</span><span class="op" id="6121709">{</span><span class="ident" id="6121710">r</span><span class="op" id="6121711">}</span>&nbsp;<span class="op" id="6121713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6121716">type</span>&nbsp;<span class="ident" id="6121721">halfReader</span>&nbsp;<span class="keyword" id="6121732">struct</span>&nbsp;<span class="op" id="6121739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121742">r</span>&nbsp;<span class="ident" id="6121744">io</span><span class="op" id="6121746">.</span><span class="ident" id="6121747">Reader</span><br>
<span class="lineno"></span><span class="op" id="6121754">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6121757">func</span>&nbsp;<span class="op" id="6121762">(</span><span class="ident" id="6121763">r</span>&nbsp;<span class="op" id="6121765">*</span><span class="ident" id="6121766">halfReader</span><span class="op" id="6121776">)</span>&nbsp;<span class="ident" id="6121778">Read</span><span class="op" id="6121782">(</span><span class="ident" id="6121783">p</span>&nbsp;<span class="op" id="6121785">[</span><span class="op" id="6121786">]</span><span class="builtintype" id="6121787">byte</span><span class="op" id="6121791">)</span>&nbsp;<span class="op" id="6121793">(</span><span class="builtintype" id="6121794">int</span><span class="op" id="6121797">,</span>&nbsp;<span class="builtintype" id="6121799">error</span><span class="op" id="6121804">)</span>&nbsp;<span class="op" id="6121806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121809">return</span>&nbsp;<span class="ident" id="6121816">r</span><span class="op" id="6121817">.</span><span class="ident" id="6121818">r</span><span class="op" id="6121819">.</span><span class="ident" id="6121820">Read</span><span class="op" id="6121824">(</span><span class="ident" id="6121825">p</span><span class="op" id="6121826">[</span><span class="num" id="6121827">0</span>&nbsp;<span class="op" id="6121829">:</span>&nbsp;<span class="op" id="6121831">(</span><span class="builtinfunc" id="6121832">len</span><span class="op" id="6121835">(</span><span class="ident" id="6121836">p</span><span class="op" id="6121837">)</span><span class="op" id="6121838">+</span><span class="num" id="6121839">1</span><span class="op" id="6121840">)</span><span class="op" id="6121841">/</span><span class="num" id="6121842">2</span><span class="op" id="6121843">]</span><span class="op" id="6121844">)</span><br>
<span class="lineno"></span><span class="op" id="6121846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6121849">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6121926">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6122004">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6122080">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="6122158">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="6122204">func</span>&nbsp;<span class="ident" id="6122209">DataErrReader</span><span class="op" id="6122222">(</span><span class="ident" id="6122223">r</span>&nbsp;<span class="ident" id="6122225">io</span><span class="op" id="6122227">.</span><span class="ident" id="6122228">Reader</span><span class="op" id="6122234">)</span>&nbsp;<span class="ident" id="6122236">io</span><span class="op" id="6122238">.</span><span class="ident" id="6122239">Reader</span>&nbsp;<span class="op" id="6122246">{</span>&nbsp;<span class="keyword" id="6122248">return</span>&nbsp;<span class="op" id="6122255">&amp;</span><span class="ident" id="6122256">dataErrReader</span><span class="op" id="6122269">{</span><span class="ident" id="6122270">r</span><span class="op" id="6122271">,</span>&nbsp;<span class="ident" id="6122273">nil</span><span class="op" id="6122276">,</span>&nbsp;<span class="builtinfunc" id="6122278">make</span><span class="op" id="6122282">(</span><span class="op" id="6122283">[</span><span class="op" id="6122284">]</span><span class="builtintype" id="6122285">byte</span><span class="op" id="6122289">,</span>&nbsp;<span class="num" id="6122291">1024</span><span class="op" id="6122295">)</span><span class="op" id="6122296">}</span>&nbsp;<span class="op" id="6122298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6122301">type</span>&nbsp;<span class="ident" id="6122306">dataErrReader</span>&nbsp;<span class="keyword" id="6122320">struct</span>&nbsp;<span class="op" id="6122327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122330">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6122337">io</span><span class="op" id="6122339">.</span><span class="ident" id="6122340">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122348">unread</span>&nbsp;<span class="op" id="6122355">[</span><span class="op" id="6122356">]</span><span class="builtintype" id="6122357">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122363">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6122370">[</span><span class="op" id="6122371">]</span><span class="builtintype" id="6122372">byte</span><br>
<span class="lineno"></span><span class="op" id="6122377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6122380">func</span>&nbsp;<span class="op" id="6122385">(</span><span class="ident" id="6122386">r</span>&nbsp;<span class="op" id="6122388">*</span><span class="ident" id="6122389">dataErrReader</span><span class="op" id="6122402">)</span>&nbsp;<span class="ident" id="6122404">Read</span><span class="op" id="6122408">(</span><span class="ident" id="6122409">p</span>&nbsp;<span class="op" id="6122411">[</span><span class="op" id="6122412">]</span><span class="builtintype" id="6122413">byte</span><span class="op" id="6122417">)</span>&nbsp;<span class="op" id="6122419">(</span><span class="ident" id="6122420">n</span>&nbsp;<span class="builtintype" id="6122422">int</span><span class="op" id="6122425">,</span>&nbsp;<span class="ident" id="6122427">err</span>&nbsp;<span class="builtintype" id="6122431">error</span><span class="op" id="6122436">)</span>&nbsp;<span class="op" id="6122438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122441">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6122486">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122541">for</span>&nbsp;<span class="op" id="6122545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122549">if</span>&nbsp;<span class="builtinfunc" id="6122552">len</span><span class="op" id="6122555">(</span><span class="ident" id="6122556">r</span><span class="op" id="6122557">.</span><span class="ident" id="6122558">unread</span><span class="op" id="6122564">)</span>&nbsp;<span class="op" id="6122566">==</span>&nbsp;<span class="num" id="6122569">0</span>&nbsp;<span class="op" id="6122571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122576">n1</span><span class="op" id="6122578">,</span>&nbsp;<span class="ident" id="6122580">err1</span>&nbsp;<span class="op" id="6122585">:=</span>&nbsp;<span class="ident" id="6122588">r</span><span class="op" id="6122589">.</span><span class="ident" id="6122590">r</span><span class="op" id="6122591">.</span><span class="ident" id="6122592">Read</span><span class="op" id="6122596">(</span><span class="ident" id="6122597">r</span><span class="op" id="6122598">.</span><span class="ident" id="6122599">data</span><span class="op" id="6122603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122608">r</span><span class="op" id="6122609">.</span><span class="ident" id="6122610">unread</span>&nbsp;<span class="op" id="6122617">=</span>&nbsp;<span class="ident" id="6122619">r</span><span class="op" id="6122620">.</span><span class="ident" id="6122621">data</span><span class="op" id="6122625">[</span><span class="num" id="6122626">0</span><span class="op" id="6122627">:</span><span class="ident" id="6122628">n1</span><span class="op" id="6122630">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122635">err</span>&nbsp;<span class="op" id="6122639">=</span>&nbsp;<span class="ident" id="6122641">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122652">if</span>&nbsp;<span class="ident" id="6122655">n</span>&nbsp;<span class="op" id="6122657">&gt;</span>&nbsp;<span class="num" id="6122659">0</span>&nbsp;<span class="op" id="6122661">||</span>&nbsp;<span class="ident" id="6122664">err</span>&nbsp;<span class="op" id="6122668">!=</span>&nbsp;<span class="ident" id="6122671">nil</span>&nbsp;<span class="op" id="6122675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122680">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122688">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122692">n</span>&nbsp;<span class="op" id="6122694">=</span>&nbsp;<span class="builtinfunc" id="6122696">copy</span><span class="op" id="6122700">(</span><span class="ident" id="6122701">p</span><span class="op" id="6122702">,</span>&nbsp;<span class="ident" id="6122704">r</span><span class="op" id="6122705">.</span><span class="ident" id="6122706">unread</span><span class="op" id="6122712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122716">r</span><span class="op" id="6122717">.</span><span class="ident" id="6122718">unread</span>&nbsp;<span class="op" id="6122725">=</span>&nbsp;<span class="ident" id="6122727">r</span><span class="op" id="6122728">.</span><span class="ident" id="6122729">unread</span><span class="op" id="6122735">[</span><span class="ident" id="6122736">n</span><span class="op" id="6122737">:</span><span class="op" id="6122738">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122744">return</span><br>
<span class="lineno"></span><span class="op" id="6122751">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6122754">var</span>&nbsp;<span class="ident" id="6122758">ErrTimeout</span>&nbsp;<span class="op" id="6122769">=</span>&nbsp;<span class="ident" id="6122771">errors</span><span class="op" id="6122777">.</span><span class="ident" id="6122778">New</span><span class="op" id="6122781">(</span><span class="string" id="6122782">&#34;timeout&#34;</span><span class="op" id="6122791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6122794">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="6122849">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="6122901">func</span>&nbsp;<span class="ident" id="6122906">TimeoutReader</span><span class="op" id="6122919">(</span><span class="ident" id="6122920">r</span>&nbsp;<span class="ident" id="6122922">io</span><span class="op" id="6122924">.</span><span class="ident" id="6122925">Reader</span><span class="op" id="6122931">)</span>&nbsp;<span class="ident" id="6122933">io</span><span class="op" id="6122935">.</span><span class="ident" id="6122936">Reader</span>&nbsp;<span class="op" id="6122943">{</span>&nbsp;<span class="keyword" id="6122945">return</span>&nbsp;<span class="op" id="6122952">&amp;</span><span class="ident" id="6122953">timeoutReader</span><span class="op" id="6122966">{</span><span class="ident" id="6122967">r</span><span class="op" id="6122968">,</span>&nbsp;<span class="num" id="6122970">0</span><span class="op" id="6122971">}</span>&nbsp;<span class="op" id="6122973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6122976">type</span>&nbsp;<span class="ident" id="6122981">timeoutReader</span>&nbsp;<span class="keyword" id="6122995">struct</span>&nbsp;<span class="op" id="6123002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123005">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6123011">io</span><span class="op" id="6123013">.</span><span class="ident" id="6123014">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123022">count</span>&nbsp;<span class="builtintype" id="6123028">int</span><br>
<span class="lineno">80</span><span class="op" id="6123032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6123035">func</span>&nbsp;<span class="op" id="6123040">(</span><span class="ident" id="6123041">r</span>&nbsp;<span class="op" id="6123043">*</span><span class="ident" id="6123044">timeoutReader</span><span class="op" id="6123057">)</span>&nbsp;<span class="ident" id="6123059">Read</span><span class="op" id="6123063">(</span><span class="ident" id="6123064">p</span>&nbsp;<span class="op" id="6123066">[</span><span class="op" id="6123067">]</span><span class="builtintype" id="6123068">byte</span><span class="op" id="6123072">)</span>&nbsp;<span class="op" id="6123074">(</span><span class="builtintype" id="6123075">int</span><span class="op" id="6123078">,</span>&nbsp;<span class="builtintype" id="6123080">error</span><span class="op" id="6123085">)</span>&nbsp;<span class="op" id="6123087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123090">r</span><span class="op" id="6123091">.</span><span class="ident" id="6123092">count</span><span class="op" id="6123097">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123101">if</span>&nbsp;<span class="ident" id="6123104">r</span><span class="op" id="6123105">.</span><span class="ident" id="6123106">count</span>&nbsp;<span class="op" id="6123112">==</span>&nbsp;<span class="num" id="6123115">2</span>&nbsp;<span class="op" id="6123117">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123121">return</span>&nbsp;<span class="num" id="6123128">0</span><span class="op" id="6123129">,</span>&nbsp;<span class="ident" id="6123131">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123146">return</span>&nbsp;<span class="ident" id="6123153">r</span><span class="op" id="6123154">.</span><span class="ident" id="6123155">r</span><span class="op" id="6123156">.</span><span class="ident" id="6123157">Read</span><span class="op" id="6123161">(</span><span class="ident" id="6123162">p</span><span class="op" id="6123163">)</span><br>
<span class="lineno"></span><span class="op" id="6123165">}</span>
</div>
</body>
</html>
