<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4812997">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4813053">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4813107">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4813158">//&nbsp;Package&nbsp;pprof&nbsp;writes&nbsp;runtime&nbsp;profiling&nbsp;data&nbsp;in&nbsp;the&nbsp;format&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4813228">//&nbsp;by&nbsp;the&nbsp;pprof&nbsp;visualization&nbsp;tool.</span><br>
<span class="lineno"></span><span class="comment" id="4813264">//&nbsp;For&nbsp;more&nbsp;information&nbsp;about&nbsp;pprof,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="4813305">//&nbsp;http://code.google.com/p/google-perftools/.</span><br>
<span class="lineno"></span><span class="keyword" id="4813352">package</span>&nbsp;<span class="ident" id="4813360">pprof</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4813367">import</span>&nbsp;<span class="op" id="4813374">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813377">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813386">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813395">&#34;fmt&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813402">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813408">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813419">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813427">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813438">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4813446">&#34;text/tabwriter&#34;</span><br>
<span class="lineno"></span><span class="op" id="4813463">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4813466">//&nbsp;BUG(rsc):&nbsp;Profiles&nbsp;are&nbsp;incomplete&nbsp;and&nbsp;inaccurate&nbsp;on&nbsp;NetBSD&nbsp;and&nbsp;OS&nbsp;X.</span><br>
<span class="lineno"></span><span class="comment" id="4813538">//&nbsp;See&nbsp;http://golang.org/issue/6047&nbsp;for&nbsp;details.</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4813588">//&nbsp;A&nbsp;Profile&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;stack&nbsp;traces&nbsp;showing&nbsp;the&nbsp;call&nbsp;sequences</span><br>
<span class="lineno"></span><span class="comment" id="4813660">//&nbsp;that&nbsp;led&nbsp;to&nbsp;instances&nbsp;of&nbsp;a&nbsp;particular&nbsp;event,&nbsp;such&nbsp;as&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="comment" id="4813728">//&nbsp;Packages&nbsp;can&nbsp;create&nbsp;and&nbsp;maintain&nbsp;their&nbsp;own&nbsp;profiles;&nbsp;the&nbsp;most&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4813800">//&nbsp;use&nbsp;is&nbsp;for&nbsp;tracking&nbsp;resources&nbsp;that&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;closed,&nbsp;such&nbsp;as&nbsp;files</span><br>
<span class="lineno">30</span><span class="comment" id="4813879">//&nbsp;or&nbsp;network&nbsp;connections.</span><br>
<span class="lineno"></span><span class="comment" id="4813906">//</span><br>
<span class="lineno"></span><span class="comment" id="4813909">//&nbsp;A&nbsp;Profile&#39;s&nbsp;methods&nbsp;can&nbsp;be&nbsp;called&nbsp;from&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="4813987">//</span><br>
<span class="lineno"></span><span class="comment" id="4813990">//&nbsp;Each&nbsp;Profile&nbsp;has&nbsp;a&nbsp;unique&nbsp;name.&nbsp;&nbsp;A&nbsp;few&nbsp;profiles&nbsp;are&nbsp;predefined:</span><br>
<span class="lineno">35</span><span class="comment" id="4814057">//</span><br>
<span class="lineno"></span><span class="comment" id="4814060">//&nbsp;&nbsp;&nbsp;&nbspgoroutine&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;of&nbsp;all&nbsp;current&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="4814117">//&nbsp;&nbsp;&nbsp;&nbspheap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;sampling&nbsp;of&nbsp;all&nbsp;heap&nbsp;allocations</span><br>
<span class="lineno"></span><span class="comment" id="4814170">//&nbsp;&nbsp;&nbsp;&nbspthreadcreate&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;the&nbsp;creation&nbsp;of&nbsp;new&nbsp;OS&nbsp;threads</span><br>
<span class="lineno"></span><span class="comment" id="4814244">//&nbsp;&nbsp;&nbsp;&nbspblock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;stack&nbsp;traces&nbsp;that&nbsp;led&nbsp;to&nbsp;blocking&nbsp;on&nbsp;synchronization&nbsp;primitives</span><br>
<span class="lineno">40</span><span class="comment" id="4814326">//</span><br>
<span class="lineno"></span><span class="comment" id="4814329">//&nbsp;These&nbsp;predefined&nbsp;profiles&nbsp;maintain&nbsp;themselves&nbsp;and&nbsp;panic&nbsp;on&nbsp;an&nbsp;explicit</span><br>
<span class="lineno"></span><span class="comment" id="4814403">//&nbsp;Add&nbsp;or&nbsp;Remove&nbsp;method&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="4814433">//</span><br>
<span class="lineno"></span><span class="comment" id="4814436">//&nbsp;The&nbsp;CPU&nbsp;profile&nbsp;is&nbsp;not&nbsp;available&nbsp;as&nbsp;a&nbsp;Profile.&nbsp;&nbsp;It&nbsp;has&nbsp;a&nbsp;special&nbsp;API,</span><br>
<span class="lineno">45</span><span class="comment" id="4814509">//&nbsp;the&nbsp;StartCPUProfile&nbsp;and&nbsp;StopCPUProfile&nbsp;functions,&nbsp;because&nbsp;it&nbsp;streams</span><br>
<span class="lineno"></span><span class="comment" id="4814581">//&nbsp;output&nbsp;to&nbsp;a&nbsp;writer&nbsp;during&nbsp;profiling.</span><br>
<span class="lineno"></span><span class="comment" id="4814621">//</span><br>
<span class="lineno"></span><span class="keyword" id="4814624">type</span>&nbsp;<span class="ident" id="4814629">Profile</span>&nbsp;<span class="keyword" id="4814637">struct</span>&nbsp;<span class="op" id="4814644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814647">name</span>&nbsp;&nbsp;<span class="builtintype" id="4814653">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814661">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4814667"><a href="/runtime/pprof/pprof.go.html#4813438">sync</a></span><span class="op" id="4814671">.</span><span class="ident" id="4814672">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814679">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4814685">map</span><span class="op" id="4814688">[</span><span class="keyword" id="4814689">interface</span><span class="op" id="4814698">{</span><span class="op" id="4814699">}</span><span class="op" id="4814700">]</span><span class="op" id="4814701">[</span><span class="op" id="4814702">]</span><span class="builtintype" id="4814703">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814712">count</span>&nbsp;<span class="keyword" id="4814718">func</span><span class="op" id="4814722">(</span><span class="op" id="4814723">)</span>&nbsp;<span class="builtintype" id="4814725">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814730">write</span>&nbsp;<span class="keyword" id="4814736">func</span><span class="op" id="4814740">(</span><span class="ident" id="4814741"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4814743">.</span><span class="ident" id="4814744">Writer</span><span class="op" id="4814750">,</span>&nbsp;<span class="builtintype" id="4814752">int</span><span class="op" id="4814755">)</span>&nbsp;<span class="builtintype" id="4814757">error</span><br>
<span class="lineno"></span><span class="op" id="4814763">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4814766">//&nbsp;profiles&nbsp;records&nbsp;all&nbsp;registered&nbsp;profiles.</span><br>
<span class="lineno"></span><span class="keyword" id="4814811">var</span>&nbsp;<span class="ident" id="4814815">profiles</span>&nbsp;<span class="keyword" id="4814824">struct</span>&nbsp;<span class="op" id="4814831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814834">mu</span>&nbsp;<span class="ident" id="4814837"><a href="/runtime/pprof/pprof.go.html#4813438">sync</a></span><span class="op" id="4814841">.</span><span class="ident" id="4814842">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814849">m</span>&nbsp;&nbsp;<span class="keyword" id="4814852">map</span><span class="op" id="4814855">[</span><span class="builtintype" id="4814856">string</span><span class="op" id="4814862">]</span><span class="op" id="4814863">*</span><span class="ident" id="4814864"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><br>
<span class="lineno">60</span><span class="op" id="4814872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4814875">var</span>&nbsp;<span class="ident" id="4814879">goroutineProfile</span>&nbsp;<span class="op" id="4814896">=</span>&nbsp;<span class="op" id="4814898">&amp;</span><span class="ident" id="4814899"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4814906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814909">name</span><span class="op" id="4814913">:</span>&nbsp;&nbsp;<span class="string" id="4814916">&#34;goroutine&#34;</span><span class="op" id="4814927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814930">count</span><span class="op" id="4814935">:</span>&nbsp;<span class="ident" id="4814937"><a href="/runtime/pprof/pprof.go.html#4826971">countGoroutine</a></span><span class="op" id="4814951">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4814954">write</span><span class="op" id="4814959">:</span>&nbsp;<span class="ident" id="4814961"><a href="/runtime/pprof/pprof.go.html#4827101">writeGoroutine</a></span><span class="op" id="4814975">,</span><br>
<span class="lineno"></span><span class="op" id="4814977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4814980">var</span>&nbsp;<span class="ident" id="4814984">threadcreateProfile</span>&nbsp;<span class="op" id="4815004">=</span>&nbsp;<span class="op" id="4815006">&amp;</span><span class="ident" id="4815007"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4815014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815017">name</span><span class="op" id="4815021">:</span>&nbsp;&nbsp;<span class="string" id="4815024">&#34;threadcreate&#34;</span><span class="op" id="4815038">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815041">count</span><span class="op" id="4815046">:</span>&nbsp;<span class="ident" id="4815048"><a href="/runtime/pprof/pprof.go.html#4826618">countThreadCreate</a></span><span class="op" id="4815065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815068">write</span><span class="op" id="4815073">:</span>&nbsp;<span class="ident" id="4815075"><a href="/runtime/pprof/pprof.go.html#4826778">writeThreadCreate</a></span><span class="op" id="4815092">,</span><br>
<span class="lineno"></span><span class="op" id="4815094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4815097">var</span>&nbsp;<span class="ident" id="4815101">heapProfile</span>&nbsp;<span class="op" id="4815113">=</span>&nbsp;<span class="op" id="4815115">&amp;</span><span class="ident" id="4815116"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4815123">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815126">name</span><span class="op" id="4815130">:</span>&nbsp;&nbsp;<span class="string" id="4815133">&#34;heap&#34;</span><span class="op" id="4815139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815142">count</span><span class="op" id="4815147">:</span>&nbsp;<span class="ident" id="4815149"><a href="/runtime/pprof/pprof.go.html#4823268">countHeap</a></span><span class="op" id="4815158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815161">write</span><span class="op" id="4815166">:</span>&nbsp;<span class="ident" id="4815168"><a href="/runtime/pprof/pprof.go.html#4823402">writeHeap</a></span><span class="op" id="4815177">,</span><br>
<span class="lineno"></span><span class="op" id="4815179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4815182">var</span>&nbsp;<span class="ident" id="4815186">blockProfile</span>&nbsp;<span class="op" id="4815199">=</span>&nbsp;<span class="op" id="4815201">&amp;</span><span class="ident" id="4815202"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4815209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815212">name</span><span class="op" id="4815216">:</span>&nbsp;&nbsp;<span class="string" id="4815219">&#34;block&#34;</span><span class="op" id="4815226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815229">count</span><span class="op" id="4815234">:</span>&nbsp;<span class="ident" id="4815236"><a href="/runtime/pprof/pprof.go.html#4830716">countBlock</a></span><span class="op" id="4815246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815249">write</span><span class="op" id="4815254">:</span>&nbsp;<span class="ident" id="4815256"><a href="/runtime/pprof/pprof.go.html#4830844">writeBlock</a></span><span class="op" id="4815266">,</span><br>
<span class="lineno"></span><span class="op" id="4815268">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4815271">func</span>&nbsp;<span class="ident" id="4815276">lockProfiles</span><span class="op" id="4815288">(</span><span class="op" id="4815289">)</span>&nbsp;<span class="op" id="4815291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815294"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4815302">.</span><span class="ident" id="4815303">mu</span><span class="op" id="4815305">.</span><span class="ident" id="4815306">Lock</span><span class="op" id="4815310">(</span><span class="op" id="4815311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4815314">if</span>&nbsp;<span class="ident" id="4815317"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4815325">.</span><span class="ident" id="4815326">m</span>&nbsp;<span class="op" id="4815328">==</span>&nbsp;<span class="ident" id="4815331">nil</span>&nbsp;<span class="op" id="4815335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4815339">//&nbsp;Initial&nbsp;built-in&nbsp;profiles.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815371"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4815379">.</span><span class="ident" id="4815380">m</span>&nbsp;<span class="op" id="4815382">=</span>&nbsp;<span class="keyword" id="4815384">map</span><span class="op" id="4815387">[</span><span class="builtintype" id="4815388">string</span><span class="op" id="4815394">]</span><span class="op" id="4815395">*</span><span class="ident" id="4815396"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4815403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4815408">&#34;goroutine&#34;</span><span class="op" id="4815419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815424"><a href="/runtime/pprof/pprof.go.html#4814879">goroutineProfile</a></span><span class="op" id="4815440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4815445">&#34;threadcreate&#34;</span><span class="op" id="4815459">:</span>&nbsp;<span class="ident" id="4815461"><a href="/runtime/pprof/pprof.go.html#4814984">threadcreateProfile</a></span><span class="op" id="4815480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4815485">&#34;heap&#34;</span><span class="op" id="4815491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815501"><a href="/runtime/pprof/pprof.go.html#4815101">heapProfile</a></span><span class="op" id="4815512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4815517">&#34;block&#34;</span><span class="op" id="4815524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815533"><a href="/runtime/pprof/pprof.go.html#4815186">blockProfile</a></span><span class="op" id="4815545">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4815549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4815552">}</span><br>
<span class="lineno"></span><span class="op" id="4815554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4815557">func</span>&nbsp;<span class="ident" id="4815562">unlockProfiles</span><span class="op" id="4815576">(</span><span class="op" id="4815577">)</span>&nbsp;<span class="op" id="4815579">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815582"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4815590">.</span><span class="ident" id="4815591">mu</span><span class="op" id="4815593">.</span><span class="ident" id="4815594">Unlock</span><span class="op" id="4815600">(</span><span class="op" id="4815601">)</span><br>
<span class="lineno"></span><span class="op" id="4815603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4815606">//&nbsp;NewProfile&nbsp;creates&nbsp;a&nbsp;new&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4815663">//&nbsp;If&nbsp;a&nbsp;profile&nbsp;with&nbsp;that&nbsp;name&nbsp;already&nbsp;exists,&nbsp;NewProfile&nbsp;panics.</span><br>
<span class="lineno">105</span><span class="comment" id="4815729">//&nbsp;The&nbsp;convention&nbsp;is&nbsp;to&nbsp;use&nbsp;a&nbsp;&#39;import/path.&#39;&nbsp;prefix&nbsp;to&nbsp;create</span><br>
<span class="lineno"></span><span class="comment" id="4815791">//&nbsp;separate&nbsp;name&nbsp;spaces&nbsp;for&nbsp;each&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="4815833">func</span>&nbsp;<span class="ident" id="4815838">NewProfile</span><span class="op" id="4815848">(</span><span class="ident" id="4815849">name</span>&nbsp;<span class="builtintype" id="4815854">string</span><span class="op" id="4815860">)</span>&nbsp;<span class="op" id="4815862">*</span><span class="ident" id="4815863"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span>&nbsp;<span class="op" id="4815871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4815874"><a href="/runtime/pprof/pprof.go.html#4815276">lockProfiles</a></span><span class="op" id="4815886">(</span><span class="op" id="4815887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4815890">defer</span>&nbsp;<span class="ident" id="4815896"><a href="/runtime/pprof/pprof.go.html#4815562">unlockProfiles</a></span><span class="op" id="4815910">(</span><span class="op" id="4815911">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4815914">if</span>&nbsp;<span class="ident" id="4815917"><a href="/runtime/pprof/pprof.go.html#4815849">name</a></span>&nbsp;<span class="op" id="4815922">==</span>&nbsp;<span class="string" id="4815925">&#34;&#34;</span>&nbsp;<span class="op" id="4815928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4815932">panic</span><span class="op" id="4815937">(</span><span class="string" id="4815938">&#34;pprof:&nbsp;NewProfile&nbsp;with&nbsp;empty&nbsp;name&#34;</span><span class="op" id="4815973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4815976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4815979">if</span>&nbsp;<span class="ident" id="4815982"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4815990">.</span><span class="ident" id="4815991">m</span><span class="op" id="4815992">[</span><span class="ident" id="4815993"><a href="/runtime/pprof/pprof.go.html#4815849">name</a></span><span class="op" id="4815997">]</span>&nbsp;<span class="op" id="4815999">!=</span>&nbsp;<span class="ident" id="4816002">nil</span>&nbsp;<span class="op" id="4816006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4816010">panic</span><span class="op" id="4816015">(</span><span class="string" id="4816016">&#34;pprof:&nbsp;NewProfile&nbsp;name&nbsp;already&nbsp;in&nbsp;use:&nbsp;&#34;</span>&nbsp;<span class="op" id="4816058">+</span>&nbsp;<span class="ident" id="4816060"><a href="/runtime/pprof/pprof.go.html#4815849">name</a></span><span class="op" id="4816064">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4816067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816070">p</span>&nbsp;<span class="op" id="4816072">:=</span>&nbsp;<span class="op" id="4816075">&amp;</span><span class="ident" id="4816076"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4816083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816087">name</span><span class="op" id="4816091">:</span>&nbsp;<span class="ident" id="4816093"><a href="/runtime/pprof/pprof.go.html#4815849">name</a></span><span class="op" id="4816097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816101">m</span><span class="op" id="4816102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816107">map</span><span class="op" id="4816110">[</span><span class="keyword" id="4816111">interface</span><span class="op" id="4816120">{</span><span class="op" id="4816121">}</span><span class="op" id="4816122">]</span><span class="op" id="4816123">[</span><span class="op" id="4816124">]</span><span class="builtintype" id="4816125">uintptr</span><span class="op" id="4816132">{</span><span class="op" id="4816133">}</span><span class="op" id="4816134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4816137">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816140"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4816148">.</span><span class="ident" id="4816149">m</span><span class="op" id="4816150">[</span><span class="ident" id="4816151"><a href="/runtime/pprof/pprof.go.html#4815849">name</a></span><span class="op" id="4816155">]</span>&nbsp;<span class="op" id="4816157">=</span>&nbsp;<span class="ident" id="4816159"><a href="/runtime/pprof/pprof.go.html#4816070">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816162">return</span>&nbsp;<span class="ident" id="4816169"><a href="/runtime/pprof/pprof.go.html#4816070">p</a></span><br>
<span class="lineno"></span><span class="op" id="4816171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4816174">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;profile&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such&nbsp;profile&nbsp;exists.</span><br>
<span class="lineno">125</span><span class="keyword" id="4816259">func</span>&nbsp;<span class="ident" id="4816264">Lookup</span><span class="op" id="4816270">(</span><span class="ident" id="4816271">name</span>&nbsp;<span class="builtintype" id="4816276">string</span><span class="op" id="4816282">)</span>&nbsp;<span class="op" id="4816284">*</span><span class="ident" id="4816285"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span>&nbsp;<span class="op" id="4816293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816296"><a href="/runtime/pprof/pprof.go.html#4815276">lockProfiles</a></span><span class="op" id="4816308">(</span><span class="op" id="4816309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816312">defer</span>&nbsp;<span class="ident" id="4816318"><a href="/runtime/pprof/pprof.go.html#4815562">unlockProfiles</a></span><span class="op" id="4816332">(</span><span class="op" id="4816333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816336">return</span>&nbsp;<span class="ident" id="4816343"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4816351">.</span><span class="ident" id="4816352">m</span><span class="op" id="4816353">[</span><span class="ident" id="4816354"><a href="/runtime/pprof/pprof.go.html#4816271">name</a></span><span class="op" id="4816358">]</span><br>
<span class="lineno"></span><span class="op" id="4816360">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4816363">//&nbsp;Profiles&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;known&nbsp;profiles,&nbsp;sorted&nbsp;by&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4816434">func</span>&nbsp;<span class="ident" id="4816439">Profiles</span><span class="op" id="4816447">(</span><span class="op" id="4816448">)</span>&nbsp;<span class="op" id="4816450">[</span><span class="op" id="4816451">]</span><span class="op" id="4816452">*</span><span class="ident" id="4816453"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span>&nbsp;<span class="op" id="4816461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816464"><a href="/runtime/pprof/pprof.go.html#4815276">lockProfiles</a></span><span class="op" id="4816476">(</span><span class="op" id="4816477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816480">defer</span>&nbsp;<span class="ident" id="4816486"><a href="/runtime/pprof/pprof.go.html#4815562">unlockProfiles</a></span><span class="op" id="4816500">(</span><span class="op" id="4816501">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816505">var</span>&nbsp;<span class="ident" id="4816509">all</span>&nbsp;<span class="op" id="4816513">[</span><span class="op" id="4816514">]</span><span class="op" id="4816515">*</span><span class="ident" id="4816516"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816525">for</span>&nbsp;<span class="ident" id="4816529">_</span><span class="op" id="4816530">,</span>&nbsp;<span class="ident" id="4816532">p</span>&nbsp;<span class="op" id="4816534">:=</span>&nbsp;<span class="keyword" id="4816537">range</span>&nbsp;<span class="ident" id="4816543"><a href="/runtime/pprof/pprof.go.html#4814815">profiles</a></span><span class="op" id="4816551">.</span><span class="ident" id="4816552">m</span>&nbsp;<span class="op" id="4816554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816558"><a href="/runtime/pprof/pprof.go.html#4816509">all</a></span>&nbsp;<span class="op" id="4816562">=</span>&nbsp;<span class="builtinfunc" id="4816564">append</span><span class="op" id="4816570">(</span><span class="ident" id="4816571"><a href="/runtime/pprof/pprof.go.html#4816509">all</a></span><span class="op" id="4816574">,</span>&nbsp;<span class="ident" id="4816576"><a href="/runtime/pprof/pprof.go.html#4816532">p</a></span><span class="op" id="4816577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4816580">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4816584"><a href="/runtime/pprof/pprof.go.html#4813419">sort</a></span><span class="op" id="4816588">.</span><span class="ident" id="4816589">Sort</span><span class="op" id="4816593">(</span><span class="ident" id="4816594"><a href="/runtime/pprof/pprof.go.html#4816627">byName</a></span><span class="op" id="4816600">(</span><span class="ident" id="4816601"><a href="/runtime/pprof/pprof.go.html#4816509">all</a></span><span class="op" id="4816604">)</span><span class="op" id="4816605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816608">return</span>&nbsp;<span class="ident" id="4816615"><a href="/runtime/pprof/pprof.go.html#4816509">all</a></span><br>
<span class="lineno"></span><span class="op" id="4816619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="4816622">type</span>&nbsp;<span class="ident" id="4816627">byName</span>&nbsp;<span class="op" id="4816634">[</span><span class="op" id="4816635">]</span><span class="op" id="4816636">*</span><span class="ident" id="4816637"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4816646">func</span>&nbsp;<span class="op" id="4816651">(</span><span class="ident" id="4816652">x</span>&nbsp;<span class="ident" id="4816654"><a href="/runtime/pprof/pprof.go.html#4816627">byName</a></span><span class="op" id="4816660">)</span>&nbsp;<span class="ident" id="4816662">Len</span><span class="op" id="4816665">(</span><span class="op" id="4816666">)</span>&nbsp;<span class="builtintype" id="4816668">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816682">{</span>&nbsp;<span class="keyword" id="4816684">return</span>&nbsp;<span class="builtinfunc" id="4816691">len</span><span class="op" id="4816694">(</span><span class="ident" id="4816695"><a href="/runtime/pprof/pprof.go.html#4816652">x</a></span><span class="op" id="4816696">)</span>&nbsp;<span class="op" id="4816698">}</span><br>
<span class="lineno"></span><span class="keyword" id="4816700">func</span>&nbsp;<span class="op" id="4816705">(</span><span class="ident" id="4816706">x</span>&nbsp;<span class="ident" id="4816708"><a href="/runtime/pprof/pprof.go.html#4816627">byName</a></span><span class="op" id="4816714">)</span>&nbsp;<span class="ident" id="4816716">Swap</span><span class="op" id="4816720">(</span><span class="ident" id="4816721">i</span><span class="op" id="4816722">,</span>&nbsp;<span class="ident" id="4816724">j</span>&nbsp;<span class="builtintype" id="4816726">int</span><span class="op" id="4816729">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816736">{</span>&nbsp;<span class="ident" id="4816738"><a href="/runtime/pprof/pprof.go.html#4816706">x</a></span><span class="op" id="4816739">[</span><span class="ident" id="4816740"><a href="/runtime/pprof/pprof.go.html#4816721">i</a></span><span class="op" id="4816741">]</span><span class="op" id="4816742">,</span>&nbsp;<span class="ident" id="4816744"><a href="/runtime/pprof/pprof.go.html#4816706">x</a></span><span class="op" id="4816745">[</span><span class="ident" id="4816746"><a href="/runtime/pprof/pprof.go.html#4816724">j</a></span><span class="op" id="4816747">]</span>&nbsp;<span class="op" id="4816749">=</span>&nbsp;<span class="ident" id="4816751"><a href="/runtime/pprof/pprof.go.html#4816706">x</a></span><span class="op" id="4816752">[</span><span class="ident" id="4816753"><a href="/runtime/pprof/pprof.go.html#4816724">j</a></span><span class="op" id="4816754">]</span><span class="op" id="4816755">,</span>&nbsp;<span class="ident" id="4816757"><a href="/runtime/pprof/pprof.go.html#4816706">x</a></span><span class="op" id="4816758">[</span><span class="ident" id="4816759"><a href="/runtime/pprof/pprof.go.html#4816721">i</a></span><span class="op" id="4816760">]</span>&nbsp;<span class="op" id="4816762">}</span><br>
<span class="lineno"></span><span class="keyword" id="4816764">func</span>&nbsp;<span class="op" id="4816769">(</span><span class="ident" id="4816770">x</span>&nbsp;<span class="ident" id="4816772"><a href="/runtime/pprof/pprof.go.html#4816627">byName</a></span><span class="op" id="4816778">)</span>&nbsp;<span class="ident" id="4816780">Less</span><span class="op" id="4816784">(</span><span class="ident" id="4816785">i</span><span class="op" id="4816786">,</span>&nbsp;<span class="ident" id="4816788">j</span>&nbsp;<span class="builtintype" id="4816790">int</span><span class="op" id="4816793">)</span>&nbsp;<span class="builtintype" id="4816795">bool</span>&nbsp;<span class="op" id="4816800">{</span>&nbsp;<span class="keyword" id="4816802">return</span>&nbsp;<span class="ident" id="4816809"><a href="/runtime/pprof/pprof.go.html#4816770">x</a></span><span class="op" id="4816810">[</span><span class="ident" id="4816811"><a href="/runtime/pprof/pprof.go.html#4816785">i</a></span><span class="op" id="4816812">]</span><span class="op" id="4816813">.</span><span class="ident" id="4816814">name</span>&nbsp;<span class="op" id="4816819">&lt;</span>&nbsp;<span class="ident" id="4816821"><a href="/runtime/pprof/pprof.go.html#4816770">x</a></span><span class="op" id="4816822">[</span><span class="ident" id="4816823"><a href="/runtime/pprof/pprof.go.html#4816788">j</a></span><span class="op" id="4816824">]</span><span class="op" id="4816825">.</span><span class="ident" id="4816826">name</span>&nbsp;<span class="op" id="4816831">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="4816834">//&nbsp;Name&nbsp;returns&nbsp;this&nbsp;profile&#39;s&nbsp;name,&nbsp;which&nbsp;can&nbsp;be&nbsp;passed&nbsp;to&nbsp;Lookup&nbsp;to&nbsp;reobtain&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4816926">func</span>&nbsp;<span class="op" id="4816931">(</span><span class="ident" id="4816932">p</span>&nbsp;<span class="op" id="4816934">*</span><span class="ident" id="4816935"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4816942">)</span>&nbsp;<span class="ident" id="4816944">Name</span><span class="op" id="4816948">(</span><span class="op" id="4816949">)</span>&nbsp;<span class="builtintype" id="4816951">string</span>&nbsp;<span class="op" id="4816958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4816961">return</span>&nbsp;<span class="ident" id="4816968"><a href="/runtime/pprof/pprof.go.html#4816932">p</a></span><span class="op" id="4816969">.</span><span class="ident" id="4816970">name</span><br>
<span class="lineno"></span><span class="op" id="4816975">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4816978">//&nbsp;Count&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;execution&nbsp;stacks&nbsp;currently&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4817052">func</span>&nbsp;<span class="op" id="4817057">(</span><span class="ident" id="4817058">p</span>&nbsp;<span class="op" id="4817060">*</span><span class="ident" id="4817061"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4817068">)</span>&nbsp;<span class="ident" id="4817070">Count</span><span class="op" id="4817075">(</span><span class="op" id="4817076">)</span>&nbsp;<span class="builtintype" id="4817078">int</span>&nbsp;<span class="op" id="4817082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4817085"><a href="/runtime/pprof/pprof.go.html#4817058">p</a></span><span class="op" id="4817086">.</span><span class="ident" id="4817087">mu</span><span class="op" id="4817089">.</span><span class="ident" id="4817090">Lock</span><span class="op" id="4817094">(</span><span class="op" id="4817095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4817098">defer</span>&nbsp;<span class="ident" id="4817104"><a href="/runtime/pprof/pprof.go.html#4817058">p</a></span><span class="op" id="4817105">.</span><span class="ident" id="4817106">mu</span><span class="op" id="4817108">.</span><span class="ident" id="4817109">Unlock</span><span class="op" id="4817115">(</span><span class="op" id="4817116">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4817119">if</span>&nbsp;<span class="ident" id="4817122"><a href="/runtime/pprof/pprof.go.html#4817058">p</a></span><span class="op" id="4817123">.</span><span class="ident" id="4817124">count</span>&nbsp;<span class="op" id="4817130">!=</span>&nbsp;<span class="ident" id="4817133">nil</span>&nbsp;<span class="op" id="4817137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4817141">return</span>&nbsp;<span class="ident" id="4817148"><a href="/runtime/pprof/pprof.go.html#4817058">p</a></span><span class="op" id="4817149">.</span><span class="ident" id="4817150">count</span><span class="op" id="4817155">(</span><span class="op" id="4817156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4817159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4817162">return</span>&nbsp;<span class="builtinfunc" id="4817169">len</span><span class="op" id="4817172">(</span><span class="ident" id="4817173"><a href="/runtime/pprof/pprof.go.html#4817058">p</a></span><span class="op" id="4817174">.</span><span class="ident" id="4817175">m</span><span class="op" id="4817176">)</span><br>
<span class="lineno"></span><span class="op" id="4817178">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4817181">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;current&nbsp;execution&nbsp;stack&nbsp;to&nbsp;the&nbsp;profile,&nbsp;associated&nbsp;with&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4817260">//&nbsp;Add&nbsp;stores&nbsp;value&nbsp;in&nbsp;an&nbsp;internal&nbsp;map,&nbsp;so&nbsp;value&nbsp;must&nbsp;be&nbsp;suitable&nbsp;for&nbsp;use&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4817337">//&nbsp;a&nbsp;map&nbsp;key&nbsp;and&nbsp;will&nbsp;not&nbsp;be&nbsp;garbage&nbsp;collected&nbsp;until&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="4817408">//&nbsp;call&nbsp;to&nbsp;Remove.&nbsp;&nbsp;Add&nbsp;panics&nbsp;if&nbsp;the&nbsp;profile&nbsp;already&nbsp;contains&nbsp;a&nbsp;stack&nbsp;for&nbsp;value.</span><br>
<span class="lineno">170</span><span class="comment" id="4817490">//</span><br>
<span class="lineno"></span><span class="comment" id="4817493">//&nbsp;The&nbsp;skip&nbsp;parameter&nbsp;has&nbsp;the&nbsp;same&nbsp;meaning&nbsp;as&nbsp;runtime.Caller&#39;s&nbsp;skip</span><br>
<span class="lineno"></span><span class="comment" id="4817561">//&nbsp;and&nbsp;controls&nbsp;where&nbsp;the&nbsp;stack&nbsp;trace&nbsp;begins.&nbsp;&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4817634">//&nbsp;trace&nbsp;in&nbsp;the&nbsp;function&nbsp;calling&nbsp;Add.&nbsp;&nbsp;For&nbsp;example,&nbsp;given&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4817697">//&nbsp;execution&nbsp;stack:</span><br>
<span class="lineno">175</span><span class="comment" id="4817717">//</span><br>
<span class="lineno"></span><span class="comment" id="4817720">//&nbsp;&nbsp;&nbsp;&nbspAdd</span><br>
<span class="lineno"></span><span class="comment" id="4817727">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;rpc.NewClient</span><br>
<span class="lineno"></span><span class="comment" id="4817756">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;mypkg.Run</span><br>
<span class="lineno"></span><span class="comment" id="4817781">//&nbsp;&nbsp;&nbsp;&nbspcalled&nbsp;from&nbsp;main.main</span><br>
<span class="lineno">180</span><span class="comment" id="4817806">//</span><br>
<span class="lineno"></span><span class="comment" id="4817809">//&nbsp;Passing&nbsp;skip=0&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;Add&nbsp;inside&nbsp;rpc.NewClient.</span><br>
<span class="lineno"></span><span class="comment" id="4817891">//&nbsp;Passing&nbsp;skip=1&nbsp;begins&nbsp;the&nbsp;stack&nbsp;trace&nbsp;at&nbsp;the&nbsp;call&nbsp;to&nbsp;NewClient&nbsp;inside&nbsp;mypkg.Run.</span><br>
<span class="lineno"></span><span class="comment" id="4817975">//</span><br>
<span class="lineno"></span><span class="keyword" id="4817978">func</span>&nbsp;<span class="op" id="4817983">(</span><span class="ident" id="4817984">p</span>&nbsp;<span class="op" id="4817986">*</span><span class="ident" id="4817987"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4817994">)</span>&nbsp;<span class="ident" id="4817996">Add</span><span class="op" id="4817999">(</span><span class="ident" id="4818000">value</span>&nbsp;<span class="keyword" id="4818006">interface</span><span class="op" id="4818015">{</span><span class="op" id="4818016">}</span><span class="op" id="4818017">,</span>&nbsp;<span class="ident" id="4818019">skip</span>&nbsp;<span class="builtintype" id="4818024">int</span><span class="op" id="4818027">)</span>&nbsp;<span class="op" id="4818029">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4818032">if</span>&nbsp;<span class="ident" id="4818035"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818036">.</span><span class="ident" id="4818037">name</span>&nbsp;<span class="op" id="4818042">==</span>&nbsp;<span class="string" id="4818045">&#34;&#34;</span>&nbsp;<span class="op" id="4818048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4818052">panic</span><span class="op" id="4818057">(</span><span class="string" id="4818058">&#34;pprof:&nbsp;use&nbsp;of&nbsp;uninitialized&nbsp;Profile&#34;</span><span class="op" id="4818095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4818098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4818101">if</span>&nbsp;<span class="ident" id="4818104"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818105">.</span><span class="ident" id="4818106">write</span>&nbsp;<span class="op" id="4818112">!=</span>&nbsp;<span class="ident" id="4818115">nil</span>&nbsp;<span class="op" id="4818119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4818123">panic</span><span class="op" id="4818128">(</span><span class="string" id="4818129">&#34;pprof:&nbsp;Add&nbsp;called&nbsp;on&nbsp;built-in&nbsp;Profile&nbsp;&#34;</span>&nbsp;<span class="op" id="4818170">+</span>&nbsp;<span class="ident" id="4818172"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818173">.</span><span class="ident" id="4818174">name</span><span class="op" id="4818178">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4818181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4818185">stk</span>&nbsp;<span class="op" id="4818189">:=</span>&nbsp;<span class="builtinfunc" id="4818192">make</span><span class="op" id="4818196">(</span><span class="op" id="4818197">[</span><span class="op" id="4818198">]</span><span class="builtintype" id="4818199">uintptr</span><span class="op" id="4818206">,</span>&nbsp;<span class="num" id="4818208">32</span><span class="op" id="4818210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4818213">n</span>&nbsp;<span class="op" id="4818215">:=</span>&nbsp;<span class="ident" id="4818218"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4818225">.</span><span class="ident" id="4818226">Callers</span><span class="op" id="4818233">(</span><span class="ident" id="4818234"><a href="/runtime/pprof/pprof.go.html#4818019">skip</a></span><span class="op" id="4818238">+</span><span class="num" id="4818239">1</span><span class="op" id="4818240">,</span>&nbsp;<span class="ident" id="4818242"><a href="/runtime/pprof/pprof.go.html#4818185">stk</a></span><span class="op" id="4818245">[</span><span class="op" id="4818246">:</span><span class="op" id="4818247">]</span><span class="op" id="4818248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4818252"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818253">.</span><span class="ident" id="4818254">mu</span><span class="op" id="4818256">.</span><span class="ident" id="4818257">Lock</span><span class="op" id="4818261">(</span><span class="op" id="4818262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4818265">defer</span>&nbsp;<span class="ident" id="4818271"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818272">.</span><span class="ident" id="4818273">mu</span><span class="op" id="4818275">.</span><span class="ident" id="4818276">Unlock</span><span class="op" id="4818282">(</span><span class="op" id="4818283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4818286">if</span>&nbsp;<span class="ident" id="4818289"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818290">.</span><span class="ident" id="4818291">m</span><span class="op" id="4818292">[</span><span class="ident" id="4818293"><a href="/runtime/pprof/pprof.go.html#4818000">value</a></span><span class="op" id="4818298">]</span>&nbsp;<span class="op" id="4818300">!=</span>&nbsp;<span class="ident" id="4818303">nil</span>&nbsp;<span class="op" id="4818307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4818311">panic</span><span class="op" id="4818316">(</span><span class="string" id="4818317">&#34;pprof:&nbsp;Profile.Add&nbsp;of&nbsp;duplicate&nbsp;value&#34;</span><span class="op" id="4818356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4818359">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4818362"><a href="/runtime/pprof/pprof.go.html#4817984">p</a></span><span class="op" id="4818363">.</span><span class="ident" id="4818364">m</span><span class="op" id="4818365">[</span><span class="ident" id="4818366"><a href="/runtime/pprof/pprof.go.html#4818000">value</a></span><span class="op" id="4818371">]</span>&nbsp;<span class="op" id="4818373">=</span>&nbsp;<span class="ident" id="4818375"><a href="/runtime/pprof/pprof.go.html#4818185">stk</a></span><span class="op" id="4818378">[</span><span class="op" id="4818379">:</span><span class="ident" id="4818380"><a href="/runtime/pprof/pprof.go.html#4818213">n</a></span><span class="op" id="4818381">]</span><br>
<span class="lineno"></span><span class="op" id="4818383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4818386">//&nbsp;Remove&nbsp;removes&nbsp;the&nbsp;execution&nbsp;stack&nbsp;associated&nbsp;with&nbsp;value&nbsp;from&nbsp;the&nbsp;profile.</span><br>
<span class="lineno"></span><span class="comment" id="4818464">//&nbsp;It&nbsp;is&nbsp;a&nbsp;no-op&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;profile.</span><br>
<span class="lineno">205</span><span class="keyword" id="4818517">func</span>&nbsp;<span class="op" id="4818522">(</span><span class="ident" id="4818523">p</span>&nbsp;<span class="op" id="4818525">*</span><span class="ident" id="4818526"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4818533">)</span>&nbsp;<span class="ident" id="4818535">Remove</span><span class="op" id="4818541">(</span><span class="ident" id="4818542">value</span>&nbsp;<span class="keyword" id="4818548">interface</span><span class="op" id="4818557">{</span><span class="op" id="4818558">}</span><span class="op" id="4818559">)</span>&nbsp;<span class="op" id="4818561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4818564"><a href="/runtime/pprof/pprof.go.html#4818523">p</a></span><span class="op" id="4818565">.</span><span class="ident" id="4818566">mu</span><span class="op" id="4818568">.</span><span class="ident" id="4818569">Lock</span><span class="op" id="4818573">(</span><span class="op" id="4818574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4818577">defer</span>&nbsp;<span class="ident" id="4818583"><a href="/runtime/pprof/pprof.go.html#4818523">p</a></span><span class="op" id="4818584">.</span><span class="ident" id="4818585">mu</span><span class="op" id="4818587">.</span><span class="ident" id="4818588">Unlock</span><span class="op" id="4818594">(</span><span class="op" id="4818595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4818598">delete</span><span class="op" id="4818604">(</span><span class="ident" id="4818605"><a href="/runtime/pprof/pprof.go.html#4818523">p</a></span><span class="op" id="4818606">.</span><span class="ident" id="4818607">m</span><span class="op" id="4818608">,</span>&nbsp;<span class="ident" id="4818610"><a href="/runtime/pprof/pprof.go.html#4818542">value</a></span><span class="op" id="4818615">)</span><br>
<span class="lineno"></span><span class="op" id="4818617">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="4818620">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;pprof-formatted&nbsp;snapshot&nbsp;of&nbsp;the&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4818686">//&nbsp;If&nbsp;a&nbsp;write&nbsp;to&nbsp;w&nbsp;returns&nbsp;an&nbsp;error,&nbsp;WriteTo&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4818751">//&nbsp;Otherwise,&nbsp;WriteTo&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4818786">//</span><br>
<span class="lineno">215</span><span class="comment" id="4818789">//&nbsp;The&nbsp;debug&nbsp;parameter&nbsp;enables&nbsp;additional&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="4818839">//&nbsp;Passing&nbsp;debug=0&nbsp;prints&nbsp;only&nbsp;the&nbsp;hexadecimal&nbsp;addresses&nbsp;that&nbsp;pprof&nbsp;needs.</span><br>
<span class="lineno"></span><span class="comment" id="4818914">//&nbsp;Passing&nbsp;debug=1&nbsp;adds&nbsp;comments&nbsp;translating&nbsp;addresses&nbsp;to&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span><span class="comment" id="4818987">//&nbsp;and&nbsp;line&nbsp;numbers,&nbsp;so&nbsp;that&nbsp;a&nbsp;programmer&nbsp;can&nbsp;read&nbsp;the&nbsp;profile&nbsp;without&nbsp;tools.</span><br>
<span class="lineno"></span><span class="comment" id="4819065">//</span><br>
<span class="lineno">220</span><span class="comment" id="4819068">//&nbsp;The&nbsp;predefined&nbsp;profiles&nbsp;may&nbsp;assign&nbsp;meaning&nbsp;to&nbsp;other&nbsp;debug&nbsp;values;</span><br>
<span class="lineno"></span><span class="comment" id="4819137">//&nbsp;for&nbsp;example,&nbsp;when&nbsp;printing&nbsp;the&nbsp;&#34;goroutine&#34;&nbsp;profile,&nbsp;debug=2&nbsp;means&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4819209">//&nbsp;print&nbsp;the&nbsp;goroutine&nbsp;stacks&nbsp;in&nbsp;the&nbsp;same&nbsp;form&nbsp;that&nbsp;a&nbsp;Go&nbsp;program&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4819279">//&nbsp;when&nbsp;dying&nbsp;due&nbsp;to&nbsp;an&nbsp;unrecovered&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="4819322">func</span>&nbsp;<span class="op" id="4819327">(</span><span class="ident" id="4819328">p</span>&nbsp;<span class="op" id="4819330">*</span><span class="ident" id="4819331"><a href="/runtime/pprof/pprof.go.html#4814629">Profile</a></span><span class="op" id="4819338">)</span>&nbsp;<span class="ident" id="4819340">WriteTo</span><span class="op" id="4819347">(</span><span class="ident" id="4819348">w</span>&nbsp;<span class="ident" id="4819350"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4819352">.</span><span class="ident" id="4819353">Writer</span><span class="op" id="4819359">,</span>&nbsp;<span class="ident" id="4819361">debug</span>&nbsp;<span class="builtintype" id="4819367">int</span><span class="op" id="4819370">)</span>&nbsp;<span class="builtintype" id="4819372">error</span>&nbsp;<span class="op" id="4819378">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819381">if</span>&nbsp;<span class="ident" id="4819384"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819385">.</span><span class="ident" id="4819386">name</span>&nbsp;<span class="op" id="4819391">==</span>&nbsp;<span class="string" id="4819394">&#34;&#34;</span>&nbsp;<span class="op" id="4819397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4819401">panic</span><span class="op" id="4819406">(</span><span class="string" id="4819407">&#34;pprof:&nbsp;use&nbsp;of&nbsp;zero&nbsp;Profile&#34;</span><span class="op" id="4819435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4819438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819441">if</span>&nbsp;<span class="ident" id="4819444"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819445">.</span><span class="ident" id="4819446">write</span>&nbsp;<span class="op" id="4819452">!=</span>&nbsp;<span class="ident" id="4819455">nil</span>&nbsp;<span class="op" id="4819459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819463">return</span>&nbsp;<span class="ident" id="4819470"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819471">.</span><span class="ident" id="4819472">write</span><span class="op" id="4819477">(</span><span class="ident" id="4819478"><a href="/runtime/pprof/pprof.go.html#4819348">w</a></span><span class="op" id="4819479">,</span>&nbsp;<span class="ident" id="4819481"><a href="/runtime/pprof/pprof.go.html#4819361">debug</a></span><span class="op" id="4819486">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4819489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4819493">//&nbsp;Obtain&nbsp;consistent&nbsp;snapshot&nbsp;under&nbsp;lock;&nbsp;then&nbsp;process&nbsp;without&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819563">var</span>&nbsp;<span class="ident" id="4819567">all</span>&nbsp;<span class="op" id="4819571">[</span><span class="op" id="4819572">]</span><span class="op" id="4819573">[</span><span class="op" id="4819574">]</span><span class="builtintype" id="4819575">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4819584"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819585">.</span><span class="ident" id="4819586">mu</span><span class="op" id="4819588">.</span><span class="ident" id="4819589">Lock</span><span class="op" id="4819593">(</span><span class="op" id="4819594">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819597">for</span>&nbsp;<span class="ident" id="4819601">_</span><span class="op" id="4819602">,</span>&nbsp;<span class="ident" id="4819604">stk</span>&nbsp;<span class="op" id="4819608">:=</span>&nbsp;<span class="keyword" id="4819611">range</span>&nbsp;<span class="ident" id="4819617"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819618">.</span><span class="ident" id="4819619">m</span>&nbsp;<span class="op" id="4819621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4819625"><a href="/runtime/pprof/pprof.go.html#4819567">all</a></span>&nbsp;<span class="op" id="4819629">=</span>&nbsp;<span class="builtinfunc" id="4819631">append</span><span class="op" id="4819637">(</span><span class="ident" id="4819638"><a href="/runtime/pprof/pprof.go.html#4819567">all</a></span><span class="op" id="4819641">,</span>&nbsp;<span class="ident" id="4819643"><a href="/runtime/pprof/pprof.go.html#4819604">stk</a></span><span class="op" id="4819646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4819649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4819652"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819653">.</span><span class="ident" id="4819654">mu</span><span class="op" id="4819656">.</span><span class="ident" id="4819657">Unlock</span><span class="op" id="4819663">(</span><span class="op" id="4819664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4819668">//&nbsp;Map&nbsp;order&nbsp;is&nbsp;non-deterministic;&nbsp;make&nbsp;output&nbsp;deterministic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4819731"><a href="/runtime/pprof/pprof.go.html#4813419">sort</a></span><span class="op" id="4819735">.</span><span class="ident" id="4819736">Sort</span><span class="op" id="4819740">(</span><span class="ident" id="4819741"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4819753">(</span><span class="ident" id="4819754"><a href="/runtime/pprof/pprof.go.html#4819567">all</a></span><span class="op" id="4819757">)</span><span class="op" id="4819758">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4819762">return</span>&nbsp;<span class="ident" id="4819769"><a href="/runtime/pprof/pprof.go.html#4820621">printCountProfile</a></span><span class="op" id="4819786">(</span><span class="ident" id="4819787"><a href="/runtime/pprof/pprof.go.html#4819348">w</a></span><span class="op" id="4819788">,</span>&nbsp;<span class="ident" id="4819790"><a href="/runtime/pprof/pprof.go.html#4819361">debug</a></span><span class="op" id="4819795">,</span>&nbsp;<span class="ident" id="4819797"><a href="/runtime/pprof/pprof.go.html#4819328">p</a></span><span class="op" id="4819798">.</span><span class="ident" id="4819799">name</span><span class="op" id="4819803">,</span>&nbsp;<span class="ident" id="4819805"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4819817">(</span><span class="ident" id="4819818"><a href="/runtime/pprof/pprof.go.html#4819567">all</a></span><span class="op" id="4819821">)</span><span class="op" id="4819822">)</span><br>
<span class="lineno"></span><span class="op" id="4819824">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4819827">type</span>&nbsp;<span class="ident" id="4819832">stackProfile</span>&nbsp;<span class="op" id="4819845">[</span><span class="op" id="4819846">]</span><span class="op" id="4819847">[</span><span class="op" id="4819848">]</span><span class="builtintype" id="4819849">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4819858">func</span>&nbsp;<span class="op" id="4819863">(</span><span class="ident" id="4819864">x</span>&nbsp;<span class="ident" id="4819866"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4819878">)</span>&nbsp;<span class="ident" id="4819880">Len</span><span class="op" id="4819883">(</span><span class="op" id="4819884">)</span>&nbsp;<span class="builtintype" id="4819886">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4819903">{</span>&nbsp;<span class="keyword" id="4819905">return</span>&nbsp;<span class="builtinfunc" id="4819912">len</span><span class="op" id="4819915">(</span><span class="ident" id="4819916"><a href="/runtime/pprof/pprof.go.html#4819864">x</a></span><span class="op" id="4819917">)</span>&nbsp;<span class="op" id="4819919">}</span><br>
<span class="lineno"></span><span class="keyword" id="4819921">func</span>&nbsp;<span class="op" id="4819926">(</span><span class="ident" id="4819927">x</span>&nbsp;<span class="ident" id="4819929"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4819941">)</span>&nbsp;<span class="ident" id="4819943">Stack</span><span class="op" id="4819948">(</span><span class="ident" id="4819949">i</span>&nbsp;<span class="builtintype" id="4819951">int</span><span class="op" id="4819954">)</span>&nbsp;<span class="op" id="4819956">[</span><span class="op" id="4819957">]</span><span class="builtintype" id="4819958">uintptr</span>&nbsp;<span class="op" id="4819966">{</span>&nbsp;<span class="keyword" id="4819968">return</span>&nbsp;<span class="ident" id="4819975"><a href="/runtime/pprof/pprof.go.html#4819927">x</a></span><span class="op" id="4819976">[</span><span class="ident" id="4819977"><a href="/runtime/pprof/pprof.go.html#4819949">i</a></span><span class="op" id="4819978">]</span>&nbsp;<span class="op" id="4819980">}</span><br>
<span class="lineno">250</span><span class="keyword" id="4819982">func</span>&nbsp;<span class="op" id="4819987">(</span><span class="ident" id="4819988">x</span>&nbsp;<span class="ident" id="4819990"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4820002">)</span>&nbsp;<span class="ident" id="4820004">Swap</span><span class="op" id="4820008">(</span><span class="ident" id="4820009">i</span><span class="op" id="4820010">,</span>&nbsp;<span class="ident" id="4820012">j</span>&nbsp;<span class="builtintype" id="4820014">int</span><span class="op" id="4820017">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4820027">{</span>&nbsp;<span class="ident" id="4820029"><a href="/runtime/pprof/pprof.go.html#4819988">x</a></span><span class="op" id="4820030">[</span><span class="ident" id="4820031"><a href="/runtime/pprof/pprof.go.html#4820009">i</a></span><span class="op" id="4820032">]</span><span class="op" id="4820033">,</span>&nbsp;<span class="ident" id="4820035"><a href="/runtime/pprof/pprof.go.html#4819988">x</a></span><span class="op" id="4820036">[</span><span class="ident" id="4820037"><a href="/runtime/pprof/pprof.go.html#4820012">j</a></span><span class="op" id="4820038">]</span>&nbsp;<span class="op" id="4820040">=</span>&nbsp;<span class="ident" id="4820042"><a href="/runtime/pprof/pprof.go.html#4819988">x</a></span><span class="op" id="4820043">[</span><span class="ident" id="4820044"><a href="/runtime/pprof/pprof.go.html#4820012">j</a></span><span class="op" id="4820045">]</span><span class="op" id="4820046">,</span>&nbsp;<span class="ident" id="4820048"><a href="/runtime/pprof/pprof.go.html#4819988">x</a></span><span class="op" id="4820049">[</span><span class="ident" id="4820050"><a href="/runtime/pprof/pprof.go.html#4820009">i</a></span><span class="op" id="4820051">]</span>&nbsp;<span class="op" id="4820053">}</span><br>
<span class="lineno"></span><span class="keyword" id="4820055">func</span>&nbsp;<span class="op" id="4820060">(</span><span class="ident" id="4820061">x</span>&nbsp;<span class="ident" id="4820063"><a href="/runtime/pprof/pprof.go.html#4819832">stackProfile</a></span><span class="op" id="4820075">)</span>&nbsp;<span class="ident" id="4820077">Less</span><span class="op" id="4820081">(</span><span class="ident" id="4820082">i</span><span class="op" id="4820083">,</span>&nbsp;<span class="ident" id="4820085">j</span>&nbsp;<span class="builtintype" id="4820087">int</span><span class="op" id="4820090">)</span>&nbsp;<span class="builtintype" id="4820092">bool</span>&nbsp;<span class="op" id="4820097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820100">t</span><span class="op" id="4820101">,</span>&nbsp;<span class="ident" id="4820103">u</span>&nbsp;<span class="op" id="4820105">:=</span>&nbsp;<span class="ident" id="4820108"><a href="/runtime/pprof/pprof.go.html#4820061">x</a></span><span class="op" id="4820109">[</span><span class="ident" id="4820110"><a href="/runtime/pprof/pprof.go.html#4820082">i</a></span><span class="op" id="4820111">]</span><span class="op" id="4820112">,</span>&nbsp;<span class="ident" id="4820114"><a href="/runtime/pprof/pprof.go.html#4820061">x</a></span><span class="op" id="4820115">[</span><span class="ident" id="4820116"><a href="/runtime/pprof/pprof.go.html#4820085">j</a></span><span class="op" id="4820117">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820120">for</span>&nbsp;<span class="ident" id="4820124">k</span>&nbsp;<span class="op" id="4820126">:=</span>&nbsp;<span class="num" id="4820129">0</span><span class="op" id="4820130">;</span>&nbsp;<span class="ident" id="4820132"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span>&nbsp;<span class="op" id="4820134">&lt;</span>&nbsp;<span class="builtinfunc" id="4820136">len</span><span class="op" id="4820139">(</span><span class="ident" id="4820140"><a href="/runtime/pprof/pprof.go.html#4820100">t</a></span><span class="op" id="4820141">)</span>&nbsp;<span class="op" id="4820143">&amp;&amp;</span>&nbsp;<span class="ident" id="4820146"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span>&nbsp;<span class="op" id="4820148">&lt;</span>&nbsp;<span class="builtinfunc" id="4820150">len</span><span class="op" id="4820153">(</span><span class="ident" id="4820154"><a href="/runtime/pprof/pprof.go.html#4820103">u</a></span><span class="op" id="4820155">)</span><span class="op" id="4820156">;</span>&nbsp;<span class="ident" id="4820158"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span><span class="op" id="4820159">++</span>&nbsp;<span class="op" id="4820162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820166">if</span>&nbsp;<span class="ident" id="4820169"><a href="/runtime/pprof/pprof.go.html#4820100">t</a></span><span class="op" id="4820170">[</span><span class="ident" id="4820171"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span><span class="op" id="4820172">]</span>&nbsp;<span class="op" id="4820174">!=</span>&nbsp;<span class="ident" id="4820177"><a href="/runtime/pprof/pprof.go.html#4820103">u</a></span><span class="op" id="4820178">[</span><span class="ident" id="4820179"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span><span class="op" id="4820180">]</span>&nbsp;<span class="op" id="4820182">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820187">return</span>&nbsp;<span class="ident" id="4820194"><a href="/runtime/pprof/pprof.go.html#4820100">t</a></span><span class="op" id="4820195">[</span><span class="ident" id="4820196"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span><span class="op" id="4820197">]</span>&nbsp;<span class="op" id="4820199">&lt;</span>&nbsp;<span class="ident" id="4820201"><a href="/runtime/pprof/pprof.go.html#4820103">u</a></span><span class="op" id="4820202">[</span><span class="ident" id="4820203"><a href="/runtime/pprof/pprof.go.html#4820124">k</a></span><span class="op" id="4820204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4820208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4820211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820214">return</span>&nbsp;<span class="builtinfunc" id="4820221">len</span><span class="op" id="4820224">(</span><span class="ident" id="4820225"><a href="/runtime/pprof/pprof.go.html#4820100">t</a></span><span class="op" id="4820226">)</span>&nbsp;<span class="op" id="4820228">&lt;</span>&nbsp;<span class="builtinfunc" id="4820230">len</span><span class="op" id="4820233">(</span><span class="ident" id="4820234"><a href="/runtime/pprof/pprof.go.html#4820103">u</a></span><span class="op" id="4820235">)</span><br>
<span class="lineno"></span><span class="op" id="4820237">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="4820240">//&nbsp;A&nbsp;countProfile&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;stack&nbsp;traces&nbsp;to&nbsp;be&nbsp;printed&nbsp;as&nbsp;counts</span><br>
<span class="lineno"></span><span class="comment" id="4820307">//&nbsp;grouped&nbsp;by&nbsp;stack&nbsp;trace.&nbsp;&nbsp;There&nbsp;are&nbsp;multiple&nbsp;implementations:</span><br>
<span class="lineno"></span><span class="comment" id="4820371">//&nbsp;all&nbsp;that&nbsp;matters&nbsp;is&nbsp;that&nbsp;we&nbsp;can&nbsp;find&nbsp;out&nbsp;how&nbsp;many&nbsp;traces&nbsp;there&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4820441">//&nbsp;and&nbsp;obtain&nbsp;each&nbsp;trace&nbsp;in&nbsp;turn.</span><br>
<span class="lineno">265</span><span class="keyword" id="4820475">type</span>&nbsp;<span class="ident" id="4820480">countProfile</span>&nbsp;<span class="keyword" id="4820493">interface</span>&nbsp;<span class="op" id="4820503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820506">Len</span><span class="op" id="4820509">(</span><span class="op" id="4820510">)</span>&nbsp;<span class="builtintype" id="4820512">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820517">Stack</span><span class="op" id="4820522">(</span><span class="ident" id="4820523">i</span>&nbsp;<span class="builtintype" id="4820525">int</span><span class="op" id="4820528">)</span>&nbsp;<span class="op" id="4820530">[</span><span class="op" id="4820531">]</span><span class="builtintype" id="4820532">uintptr</span><br>
<span class="lineno"></span><span class="op" id="4820540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="4820543">//&nbsp;printCountProfile&nbsp;prints&nbsp;a&nbsp;countProfile&nbsp;at&nbsp;the&nbsp;specified&nbsp;debug&nbsp;level.</span><br>
<span class="lineno"></span><span class="keyword" id="4820616">func</span>&nbsp;<span class="ident" id="4820621">printCountProfile</span><span class="op" id="4820638">(</span><span class="ident" id="4820639">w</span>&nbsp;<span class="ident" id="4820641"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4820643">.</span><span class="ident" id="4820644">Writer</span><span class="op" id="4820650">,</span>&nbsp;<span class="ident" id="4820652">debug</span>&nbsp;<span class="builtintype" id="4820658">int</span><span class="op" id="4820661">,</span>&nbsp;<span class="ident" id="4820663">name</span>&nbsp;<span class="builtintype" id="4820668">string</span><span class="op" id="4820674">,</span>&nbsp;<span class="ident" id="4820676">p</span>&nbsp;<span class="ident" id="4820678"><a href="/runtime/pprof/pprof.go.html#4820480">countProfile</a></span><span class="op" id="4820690">)</span>&nbsp;<span class="builtintype" id="4820692">error</span>&nbsp;<span class="op" id="4820698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820701">b</span>&nbsp;<span class="op" id="4820703">:=</span>&nbsp;<span class="ident" id="4820706"><a href="/runtime/pprof/pprof.go.html#4813377">bufio</a></span><span class="op" id="4820711">.</span><span class="ident" id="4820712">NewWriter</span><span class="op" id="4820721">(</span><span class="ident" id="4820722"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span><span class="op" id="4820723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820726">var</span>&nbsp;<span class="ident" id="4820730">tw</span>&nbsp;<span class="op" id="4820733">*</span><span class="ident" id="4820734"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4820743">.</span><span class="ident" id="4820744">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820752"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span>&nbsp;<span class="op" id="4820754">=</span>&nbsp;<span class="ident" id="4820756"><a href="/runtime/pprof/pprof.go.html#4820701">b</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820759">if</span>&nbsp;<span class="ident" id="4820762"><a href="/runtime/pprof/pprof.go.html#4820652">debug</a></span>&nbsp;<span class="op" id="4820768">&gt;</span>&nbsp;<span class="num" id="4820770">0</span>&nbsp;<span class="op" id="4820772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820776"><a href="/runtime/pprof/pprof.go.html#4820730">tw</a></span>&nbsp;<span class="op" id="4820779">=</span>&nbsp;<span class="ident" id="4820781"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4820790">.</span><span class="ident" id="4820791">NewWriter</span><span class="op" id="4820800">(</span><span class="ident" id="4820801"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span><span class="op" id="4820802">,</span>&nbsp;<span class="num" id="4820804">1</span><span class="op" id="4820805">,</span>&nbsp;<span class="num" id="4820807">8</span><span class="op" id="4820808">,</span>&nbsp;<span class="num" id="4820810">1</span><span class="op" id="4820811">,</span>&nbsp;<span class="string" id="4820813">&#39;\t&#39;</span><span class="op" id="4820817">,</span>&nbsp;<span class="num" id="4820819">0</span><span class="op" id="4820820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820824"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span>&nbsp;<span class="op" id="4820826">=</span>&nbsp;<span class="ident" id="4820828"><a href="/runtime/pprof/pprof.go.html#4820730">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4820832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820836"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4820839">.</span><span class="ident" id="4820840">Fprintf</span><span class="op" id="4820847">(</span><span class="ident" id="4820848"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span><span class="op" id="4820849">,</span>&nbsp;<span class="string" id="4820851">&#34;%s&nbsp;profile:&nbsp;total&nbsp;%d\n&#34;</span><span class="op" id="4820875">,</span>&nbsp;<span class="ident" id="4820877"><a href="/runtime/pprof/pprof.go.html#4820663">name</a></span><span class="op" id="4820881">,</span>&nbsp;<span class="ident" id="4820883"><a href="/runtime/pprof/pprof.go.html#4820676">p</a></span><span class="op" id="4820884">.</span><span class="ident" id="4820885">Len</span><span class="op" id="4820888">(</span><span class="op" id="4820889">)</span><span class="op" id="4820890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4820894">//&nbsp;Build&nbsp;count&nbsp;of&nbsp;each&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4820925">var</span>&nbsp;<span class="ident" id="4820929">buf</span>&nbsp;<span class="ident" id="4820933"><a href="/runtime/pprof/pprof.go.html#4813386">bytes</a></span><span class="op" id="4820938">.</span><span class="ident" id="4820939">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820947">key</span>&nbsp;<span class="op" id="4820951">:=</span>&nbsp;<span class="keyword" id="4820954">func</span><span class="op" id="4820958">(</span><span class="ident" id="4820959">stk</span>&nbsp;<span class="op" id="4820963">[</span><span class="op" id="4820964">]</span><span class="builtintype" id="4820965">uintptr</span><span class="op" id="4820972">)</span>&nbsp;<span class="builtintype" id="4820974">string</span>&nbsp;<span class="op" id="4820981">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820985"><a href="/runtime/pprof/pprof.go.html#4820929">buf</a></span><span class="op" id="4820988">.</span><span class="ident" id="4820989">Reset</span><span class="op" id="4820994">(</span><span class="op" id="4820995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4820999"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4821002">.</span><span class="ident" id="4821003">Fprintf</span><span class="op" id="4821010">(</span><span class="op" id="4821011">&amp;</span><span class="ident" id="4821012"><a href="/runtime/pprof/pprof.go.html#4820929">buf</a></span><span class="op" id="4821015">,</span>&nbsp;<span class="string" id="4821017">&#34;@&#34;</span><span class="op" id="4821020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821024">for</span>&nbsp;<span class="ident" id="4821028">_</span><span class="op" id="4821029">,</span>&nbsp;<span class="ident" id="4821031">pc</span>&nbsp;<span class="op" id="4821034">:=</span>&nbsp;<span class="keyword" id="4821037">range</span>&nbsp;<span class="ident" id="4821043"><a href="/runtime/pprof/pprof.go.html#4820959">stk</a></span>&nbsp;<span class="op" id="4821047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821052"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4821055">.</span><span class="ident" id="4821056">Fprintf</span><span class="op" id="4821063">(</span><span class="op" id="4821064">&amp;</span><span class="ident" id="4821065"><a href="/runtime/pprof/pprof.go.html#4820929">buf</a></span><span class="op" id="4821068">,</span>&nbsp;<span class="string" id="4821070">&#34;&nbsp;%#x&#34;</span><span class="op" id="4821076">,</span>&nbsp;<span class="ident" id="4821078"><a href="/runtime/pprof/pprof.go.html#4821031">pc</a></span><span class="op" id="4821080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821084">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821088">return</span>&nbsp;<span class="ident" id="4821095"><a href="/runtime/pprof/pprof.go.html#4820929">buf</a></span><span class="op" id="4821098">.</span><span class="ident" id="4821099">String</span><span class="op" id="4821105">(</span><span class="op" id="4821106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821112">m</span>&nbsp;<span class="op" id="4821114">:=</span>&nbsp;<span class="keyword" id="4821117">map</span><span class="op" id="4821120">[</span><span class="builtintype" id="4821121">string</span><span class="op" id="4821127">]</span><span class="builtintype" id="4821128">int</span><span class="op" id="4821131">{</span><span class="op" id="4821132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821135">n</span>&nbsp;<span class="op" id="4821137">:=</span>&nbsp;<span class="ident" id="4821140"><a href="/runtime/pprof/pprof.go.html#4820676">p</a></span><span class="op" id="4821141">.</span><span class="ident" id="4821142">Len</span><span class="op" id="4821145">(</span><span class="op" id="4821146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821149">for</span>&nbsp;<span class="ident" id="4821153">i</span>&nbsp;<span class="op" id="4821155">:=</span>&nbsp;<span class="num" id="4821158">0</span><span class="op" id="4821159">;</span>&nbsp;<span class="ident" id="4821161"><a href="/runtime/pprof/pprof.go.html#4821153">i</a></span>&nbsp;<span class="op" id="4821163">&lt;</span>&nbsp;<span class="ident" id="4821165"><a href="/runtime/pprof/pprof.go.html#4821135">n</a></span><span class="op" id="4821166">;</span>&nbsp;<span class="ident" id="4821168"><a href="/runtime/pprof/pprof.go.html#4821153">i</a></span><span class="op" id="4821169">++</span>&nbsp;<span class="op" id="4821172">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821176"><a href="/runtime/pprof/pprof.go.html#4821112">m</a></span><span class="op" id="4821177">[</span><span class="ident" id="4821178"><a href="/runtime/pprof/pprof.go.html#4820947">key</a></span><span class="op" id="4821181">(</span><span class="ident" id="4821182"><a href="/runtime/pprof/pprof.go.html#4820676">p</a></span><span class="op" id="4821183">.</span><span class="ident" id="4821184">Stack</span><span class="op" id="4821189">(</span><span class="ident" id="4821190"><a href="/runtime/pprof/pprof.go.html#4821153">i</a></span><span class="op" id="4821191">)</span><span class="op" id="4821192">)</span><span class="op" id="4821193">]</span><span class="op" id="4821194">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4821202">//&nbsp;Print&nbsp;stacks,&nbsp;listing&nbsp;count&nbsp;on&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;a&nbsp;unique&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821273">for</span>&nbsp;<span class="ident" id="4821277">i</span>&nbsp;<span class="op" id="4821279">:=</span>&nbsp;<span class="num" id="4821282">0</span><span class="op" id="4821283">;</span>&nbsp;<span class="ident" id="4821285"><a href="/runtime/pprof/pprof.go.html#4821277">i</a></span>&nbsp;<span class="op" id="4821287">&lt;</span>&nbsp;<span class="ident" id="4821289"><a href="/runtime/pprof/pprof.go.html#4821135">n</a></span><span class="op" id="4821290">;</span>&nbsp;<span class="ident" id="4821292"><a href="/runtime/pprof/pprof.go.html#4821277">i</a></span><span class="op" id="4821293">++</span>&nbsp;<span class="op" id="4821296">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821300">stk</span>&nbsp;<span class="op" id="4821304">:=</span>&nbsp;<span class="ident" id="4821307"><a href="/runtime/pprof/pprof.go.html#4820676">p</a></span><span class="op" id="4821308">.</span><span class="ident" id="4821309">Stack</span><span class="op" id="4821314">(</span><span class="ident" id="4821315"><a href="/runtime/pprof/pprof.go.html#4821277">i</a></span><span class="op" id="4821316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821320">s</span>&nbsp;<span class="op" id="4821322">:=</span>&nbsp;<span class="ident" id="4821325"><a href="/runtime/pprof/pprof.go.html#4820947">key</a></span><span class="op" id="4821328">(</span><span class="ident" id="4821329"><a href="/runtime/pprof/pprof.go.html#4821300">stk</a></span><span class="op" id="4821332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821336">if</span>&nbsp;<span class="ident" id="4821339">count</span>&nbsp;<span class="op" id="4821345">:=</span>&nbsp;<span class="ident" id="4821348"><a href="/runtime/pprof/pprof.go.html#4821112">m</a></span><span class="op" id="4821349">[</span><span class="ident" id="4821350"><a href="/runtime/pprof/pprof.go.html#4821320">s</a></span><span class="op" id="4821351">]</span><span class="op" id="4821352">;</span>&nbsp;<span class="ident" id="4821354"><a href="/runtime/pprof/pprof.go.html#4821339">count</a></span>&nbsp;<span class="op" id="4821360">!=</span>&nbsp;<span class="num" id="4821363">0</span>&nbsp;<span class="op" id="4821365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821370"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4821373">.</span><span class="ident" id="4821374">Fprintf</span><span class="op" id="4821381">(</span><span class="ident" id="4821382"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span><span class="op" id="4821383">,</span>&nbsp;<span class="string" id="4821385">&#34;%d&nbsp;%s\n&#34;</span><span class="op" id="4821394">,</span>&nbsp;<span class="ident" id="4821396"><a href="/runtime/pprof/pprof.go.html#4821339">count</a></span><span class="op" id="4821401">,</span>&nbsp;<span class="ident" id="4821403"><a href="/runtime/pprof/pprof.go.html#4821320">s</a></span><span class="op" id="4821404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821409">if</span>&nbsp;<span class="ident" id="4821412"><a href="/runtime/pprof/pprof.go.html#4820652">debug</a></span>&nbsp;<span class="op" id="4821418">&gt;</span>&nbsp;<span class="num" id="4821420">0</span>&nbsp;<span class="op" id="4821422">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821428"><a href="/runtime/pprof/pprof.go.html#4821642">printStackRecord</a></span><span class="op" id="4821444">(</span><span class="ident" id="4821445"><a href="/runtime/pprof/pprof.go.html#4820639">w</a></span><span class="op" id="4821446">,</span>&nbsp;<span class="ident" id="4821448"><a href="/runtime/pprof/pprof.go.html#4821300">stk</a></span><span class="op" id="4821451">,</span>&nbsp;<span class="builtintype" id="4821453">false</span><span class="op" id="4821458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4821468">delete</span><span class="op" id="4821474">(</span><span class="ident" id="4821475"><a href="/runtime/pprof/pprof.go.html#4821112">m</a></span><span class="op" id="4821476">,</span>&nbsp;<span class="ident" id="4821478"><a href="/runtime/pprof/pprof.go.html#4821320">s</a></span><span class="op" id="4821479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821486">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821490">if</span>&nbsp;<span class="ident" id="4821493"><a href="/runtime/pprof/pprof.go.html#4820730">tw</a></span>&nbsp;<span class="op" id="4821496">!=</span>&nbsp;<span class="ident" id="4821499">nil</span>&nbsp;<span class="op" id="4821503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821507"><a href="/runtime/pprof/pprof.go.html#4820730">tw</a></span><span class="op" id="4821509">.</span><span class="ident" id="4821510">Flush</span><span class="op" id="4821515">(</span><span class="op" id="4821516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821522">return</span>&nbsp;<span class="ident" id="4821529"><a href="/runtime/pprof/pprof.go.html#4820701">b</a></span><span class="op" id="4821530">.</span><span class="ident" id="4821531">Flush</span><span class="op" id="4821536">(</span><span class="op" id="4821537">)</span><br>
<span class="lineno">315</span><span class="op" id="4821539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4821542">//&nbsp;printStackRecord&nbsp;prints&nbsp;the&nbsp;function&nbsp;+&nbsp;source&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="4821608">//&nbsp;for&nbsp;a&nbsp;single&nbsp;stack&nbsp;trace.</span><br>
<span class="lineno"></span><span class="keyword" id="4821637">func</span>&nbsp;<span class="ident" id="4821642">printStackRecord</span><span class="op" id="4821658">(</span><span class="ident" id="4821659">w</span>&nbsp;<span class="ident" id="4821661"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4821663">.</span><span class="ident" id="4821664">Writer</span><span class="op" id="4821670">,</span>&nbsp;<span class="ident" id="4821672">stk</span>&nbsp;<span class="op" id="4821676">[</span><span class="op" id="4821677">]</span><span class="builtintype" id="4821678">uintptr</span><span class="op" id="4821685">,</span>&nbsp;<span class="ident" id="4821687">allFrames</span>&nbsp;<span class="builtintype" id="4821697">bool</span><span class="op" id="4821701">)</span>&nbsp;<span class="op" id="4821703">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821706">show</span>&nbsp;<span class="op" id="4821711">:=</span>&nbsp;<span class="ident" id="4821714"><a href="/runtime/pprof/pprof.go.html#4821687">allFrames</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821725">wasPanic</span>&nbsp;<span class="op" id="4821734">:=</span>&nbsp;<span class="builtintype" id="4821737">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821744">for</span>&nbsp;<span class="ident" id="4821748">i</span><span class="op" id="4821749">,</span>&nbsp;<span class="ident" id="4821751">pc</span>&nbsp;<span class="op" id="4821754">:=</span>&nbsp;<span class="keyword" id="4821757">range</span>&nbsp;<span class="ident" id="4821763"><a href="/runtime/pprof/pprof.go.html#4821672">stk</a></span>&nbsp;<span class="op" id="4821767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821771">f</span>&nbsp;<span class="op" id="4821773">:=</span>&nbsp;<span class="ident" id="4821776"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4821783">.</span><span class="ident" id="4821784">FuncForPC</span><span class="op" id="4821793">(</span><span class="ident" id="4821794"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span><span class="op" id="4821796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821800">if</span>&nbsp;<span class="ident" id="4821803"><a href="/runtime/pprof/pprof.go.html#4821771">f</a></span>&nbsp;<span class="op" id="4821805">==</span>&nbsp;<span class="ident" id="4821808">nil</span>&nbsp;<span class="op" id="4821812">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821817"><a href="/runtime/pprof/pprof.go.html#4821706">show</a></span>&nbsp;<span class="op" id="4821822">=</span>&nbsp;<span class="builtintype" id="4821824">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821832"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4821835">.</span><span class="ident" id="4821836">Fprintf</span><span class="op" id="4821843">(</span><span class="ident" id="4821844"><a href="/runtime/pprof/pprof.go.html#4821659">w</a></span><span class="op" id="4821845">,</span>&nbsp;<span class="string" id="4821847">&#34;#\t%#x\n&#34;</span><span class="op" id="4821857">,</span>&nbsp;<span class="ident" id="4821859"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span><span class="op" id="4821861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821866"><a href="/runtime/pprof/pprof.go.html#4821725">wasPanic</a></span>&nbsp;<span class="op" id="4821875">=</span>&nbsp;<span class="builtintype" id="4821877">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4821885">}</span>&nbsp;<span class="keyword" id="4821887">else</span>&nbsp;<span class="op" id="4821892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4821897">tracepc</span>&nbsp;<span class="op" id="4821905">:=</span>&nbsp;<span class="ident" id="4821908"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4821914">//&nbsp;Back&nbsp;up&nbsp;to&nbsp;call&nbsp;instruction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821949">if</span>&nbsp;<span class="ident" id="4821952"><a href="/runtime/pprof/pprof.go.html#4821748">i</a></span>&nbsp;<span class="op" id="4821954">&gt;</span>&nbsp;<span class="num" id="4821956">0</span>&nbsp;<span class="op" id="4821958">&amp;&amp;</span>&nbsp;<span class="ident" id="4821961"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span>&nbsp;<span class="op" id="4821964">&gt;</span>&nbsp;<span class="ident" id="4821966"><a href="/runtime/pprof/pprof.go.html#4821771">f</a></span><span class="op" id="4821967">.</span><span class="ident" id="4821968">Entry</span><span class="op" id="4821973">(</span><span class="op" id="4821974">)</span>&nbsp;<span class="op" id="4821976">&amp;&amp;</span>&nbsp;<span class="op" id="4821979">!</span><span class="ident" id="4821980"><a href="/runtime/pprof/pprof.go.html#4821725">wasPanic</a></span>&nbsp;<span class="op" id="4821989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4821995">if</span>&nbsp;<span class="ident" id="4821998"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4822005">.</span><span class="ident" id="4822006">GOARCH</span>&nbsp;<span class="op" id="4822013">==</span>&nbsp;<span class="string" id="4822016">&#34;386&#34;</span>&nbsp;<span class="op" id="4822022">||</span>&nbsp;<span class="ident" id="4822025"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4822032">.</span><span class="ident" id="4822033">GOARCH</span>&nbsp;<span class="op" id="4822040">==</span>&nbsp;<span class="string" id="4822043">&#34;amd64&#34;</span>&nbsp;<span class="op" id="4822051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822058"><a href="/runtime/pprof/pprof.go.html#4821897">tracepc</a></span><span class="op" id="4822065">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822072">}</span>&nbsp;<span class="keyword" id="4822074">else</span>&nbsp;<span class="op" id="4822079">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822086"><a href="/runtime/pprof/pprof.go.html#4821897">tracepc</a></span>&nbsp;<span class="op" id="4822094">-=</span>&nbsp;<span class="num" id="4822097">4</span>&nbsp;<span class="comment" id="4822099">//&nbsp;arm,&nbsp;etc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822125">file</span><span class="op" id="4822129">,</span>&nbsp;<span class="ident" id="4822131">line</span>&nbsp;<span class="op" id="4822136">:=</span>&nbsp;<span class="ident" id="4822139"><a href="/runtime/pprof/pprof.go.html#4821771">f</a></span><span class="op" id="4822140">.</span><span class="ident" id="4822141">FileLine</span><span class="op" id="4822149">(</span><span class="ident" id="4822150"><a href="/runtime/pprof/pprof.go.html#4821897">tracepc</a></span><span class="op" id="4822157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822162">name</span>&nbsp;<span class="op" id="4822167">:=</span>&nbsp;<span class="ident" id="4822170"><a href="/runtime/pprof/pprof.go.html#4821771">f</a></span><span class="op" id="4822171">.</span><span class="ident" id="4822172">Name</span><span class="op" id="4822176">(</span><span class="op" id="4822177">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4822182">//&nbsp;Hide&nbsp;runtime.goexit&nbsp;and&nbsp;any&nbsp;runtime&nbsp;functions&nbsp;at&nbsp;the&nbsp;beginning.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4822252">//&nbsp;This&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;allocation&nbsp;traces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822303"><a href="/runtime/pprof/pprof.go.html#4821725">wasPanic</a></span>&nbsp;<span class="op" id="4822312">=</span>&nbsp;<span class="ident" id="4822314"><a href="/runtime/pprof/pprof.go.html#4822162">name</a></span>&nbsp;<span class="op" id="4822319">==</span>&nbsp;<span class="string" id="4822322">&#34;runtime.panic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4822341">if</span>&nbsp;<span class="ident" id="4822344"><a href="/runtime/pprof/pprof.go.html#4822162">name</a></span>&nbsp;<span class="op" id="4822349">==</span>&nbsp;<span class="string" id="4822352">&#34;runtime.goexit&#34;</span>&nbsp;<span class="op" id="4822369">||</span>&nbsp;<span class="op" id="4822372">!</span><span class="ident" id="4822373"><a href="/runtime/pprof/pprof.go.html#4821706">show</a></span>&nbsp;<span class="op" id="4822378">&amp;&amp;</span>&nbsp;<span class="ident" id="4822381"><a href="/runtime/pprof/pprof.go.html#4813427">strings</a></span><span class="op" id="4822388">.</span><span class="ident" id="4822389">HasPrefix</span><span class="op" id="4822398">(</span><span class="ident" id="4822399"><a href="/runtime/pprof/pprof.go.html#4822162">name</a></span><span class="op" id="4822403">,</span>&nbsp;<span class="string" id="4822405">&#34;runtime.&#34;</span><span class="op" id="4822415">)</span>&nbsp;<span class="op" id="4822417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4822423">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822440"><a href="/runtime/pprof/pprof.go.html#4821706">show</a></span>&nbsp;<span class="op" id="4822445">=</span>&nbsp;<span class="builtintype" id="4822447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822455"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4822458">.</span><span class="ident" id="4822459">Fprintf</span><span class="op" id="4822466">(</span><span class="ident" id="4822467"><a href="/runtime/pprof/pprof.go.html#4821659">w</a></span><span class="op" id="4822468">,</span>&nbsp;<span class="string" id="4822470">&#34;#\t%#x\t%s+%#x\t%s:%d\n&#34;</span><span class="op" id="4822495">,</span>&nbsp;<span class="ident" id="4822497"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span><span class="op" id="4822499">,</span>&nbsp;<span class="ident" id="4822501"><a href="/runtime/pprof/pprof.go.html#4822162">name</a></span><span class="op" id="4822505">,</span>&nbsp;<span class="ident" id="4822507"><a href="/runtime/pprof/pprof.go.html#4821751">pc</a></span><span class="op" id="4822509">-</span><span class="ident" id="4822510"><a href="/runtime/pprof/pprof.go.html#4821771">f</a></span><span class="op" id="4822511">.</span><span class="ident" id="4822512">Entry</span><span class="op" id="4822517">(</span><span class="op" id="4822518">)</span><span class="op" id="4822519">,</span>&nbsp;<span class="ident" id="4822521"><a href="/runtime/pprof/pprof.go.html#4822125">file</a></span><span class="op" id="4822525">,</span>&nbsp;<span class="ident" id="4822527"><a href="/runtime/pprof/pprof.go.html#4822131">line</a></span><span class="op" id="4822531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822538">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4822541">if</span>&nbsp;<span class="op" id="4822544">!</span><span class="ident" id="4822545"><a href="/runtime/pprof/pprof.go.html#4821706">show</a></span>&nbsp;<span class="op" id="4822550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4822554">//&nbsp;We&nbsp;didn&#39;t&nbsp;print&nbsp;anything;&nbsp;do&nbsp;it&nbsp;again,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4822598">//&nbsp;and&nbsp;this&nbsp;time&nbsp;include&nbsp;runtime&nbsp;functions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822644"><a href="/runtime/pprof/pprof.go.html#4821642">printStackRecord</a></span><span class="op" id="4822660">(</span><span class="ident" id="4822661"><a href="/runtime/pprof/pprof.go.html#4821659">w</a></span><span class="op" id="4822662">,</span>&nbsp;<span class="ident" id="4822664"><a href="/runtime/pprof/pprof.go.html#4821672">stk</a></span><span class="op" id="4822667">,</span>&nbsp;<span class="builtintype" id="4822669">true</span><span class="op" id="4822673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4822677">return</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4822685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4822688"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4822691">.</span><span class="ident" id="4822692">Fprintf</span><span class="op" id="4822699">(</span><span class="ident" id="4822700"><a href="/runtime/pprof/pprof.go.html#4821659">w</a></span><span class="op" id="4822701">,</span>&nbsp;<span class="string" id="4822703">&#34;\n&#34;</span><span class="op" id="4822707">)</span><br>
<span class="lineno"></span><span class="op" id="4822709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4822712">//&nbsp;Interface&nbsp;to&nbsp;system&nbsp;profiles.</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4822746">type</span>&nbsp;<span class="ident" id="4822751">byInUseBytes</span>&nbsp;<span class="op" id="4822764">[</span><span class="op" id="4822765">]</span><span class="ident" id="4822766"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4822773">.</span><span class="ident" id="4822774">MemProfileRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4822792">func</span>&nbsp;<span class="op" id="4822797">(</span><span class="ident" id="4822798">x</span>&nbsp;<span class="ident" id="4822800"><a href="/runtime/pprof/pprof.go.html#4822751">byInUseBytes</a></span><span class="op" id="4822812">)</span>&nbsp;<span class="ident" id="4822814">Len</span><span class="op" id="4822817">(</span><span class="op" id="4822818">)</span>&nbsp;<span class="builtintype" id="4822820">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822834">{</span>&nbsp;<span class="keyword" id="4822836">return</span>&nbsp;<span class="builtinfunc" id="4822843">len</span><span class="op" id="4822846">(</span><span class="ident" id="4822847"><a href="/runtime/pprof/pprof.go.html#4822798">x</a></span><span class="op" id="4822848">)</span>&nbsp;<span class="op" id="4822850">}</span><br>
<span class="lineno"></span><span class="keyword" id="4822852">func</span>&nbsp;<span class="op" id="4822857">(</span><span class="ident" id="4822858">x</span>&nbsp;<span class="ident" id="4822860"><a href="/runtime/pprof/pprof.go.html#4822751">byInUseBytes</a></span><span class="op" id="4822872">)</span>&nbsp;<span class="ident" id="4822874">Swap</span><span class="op" id="4822878">(</span><span class="ident" id="4822879">i</span><span class="op" id="4822880">,</span>&nbsp;<span class="ident" id="4822882">j</span>&nbsp;<span class="builtintype" id="4822884">int</span><span class="op" id="4822887">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4822894">{</span>&nbsp;<span class="ident" id="4822896"><a href="/runtime/pprof/pprof.go.html#4822858">x</a></span><span class="op" id="4822897">[</span><span class="ident" id="4822898"><a href="/runtime/pprof/pprof.go.html#4822879">i</a></span><span class="op" id="4822899">]</span><span class="op" id="4822900">,</span>&nbsp;<span class="ident" id="4822902"><a href="/runtime/pprof/pprof.go.html#4822858">x</a></span><span class="op" id="4822903">[</span><span class="ident" id="4822904"><a href="/runtime/pprof/pprof.go.html#4822882">j</a></span><span class="op" id="4822905">]</span>&nbsp;<span class="op" id="4822907">=</span>&nbsp;<span class="ident" id="4822909"><a href="/runtime/pprof/pprof.go.html#4822858">x</a></span><span class="op" id="4822910">[</span><span class="ident" id="4822911"><a href="/runtime/pprof/pprof.go.html#4822882">j</a></span><span class="op" id="4822912">]</span><span class="op" id="4822913">,</span>&nbsp;<span class="ident" id="4822915"><a href="/runtime/pprof/pprof.go.html#4822858">x</a></span><span class="op" id="4822916">[</span><span class="ident" id="4822917"><a href="/runtime/pprof/pprof.go.html#4822879">i</a></span><span class="op" id="4822918">]</span>&nbsp;<span class="op" id="4822920">}</span><br>
<span class="lineno">365</span><span class="keyword" id="4822922">func</span>&nbsp;<span class="op" id="4822927">(</span><span class="ident" id="4822928">x</span>&nbsp;<span class="ident" id="4822930"><a href="/runtime/pprof/pprof.go.html#4822751">byInUseBytes</a></span><span class="op" id="4822942">)</span>&nbsp;<span class="ident" id="4822944">Less</span><span class="op" id="4822948">(</span><span class="ident" id="4822949">i</span><span class="op" id="4822950">,</span>&nbsp;<span class="ident" id="4822952">j</span>&nbsp;<span class="builtintype" id="4822954">int</span><span class="op" id="4822957">)</span>&nbsp;<span class="builtintype" id="4822959">bool</span>&nbsp;<span class="op" id="4822964">{</span>&nbsp;<span class="keyword" id="4822966">return</span>&nbsp;<span class="ident" id="4822973"><a href="/runtime/pprof/pprof.go.html#4822928">x</a></span><span class="op" id="4822974">[</span><span class="ident" id="4822975"><a href="/runtime/pprof/pprof.go.html#4822949">i</a></span><span class="op" id="4822976">]</span><span class="op" id="4822977">.</span><span class="ident" id="4822978">InUseBytes</span><span class="op" id="4822988">(</span><span class="op" id="4822989">)</span>&nbsp;<span class="op" id="4822991">&gt;</span>&nbsp;<span class="ident" id="4822993"><a href="/runtime/pprof/pprof.go.html#4822928">x</a></span><span class="op" id="4822994">[</span><span class="ident" id="4822995"><a href="/runtime/pprof/pprof.go.html#4822952">j</a></span><span class="op" id="4822996">]</span><span class="op" id="4822997">.</span><span class="ident" id="4822998">InUseBytes</span><span class="op" id="4823008">(</span><span class="op" id="4823009">)</span>&nbsp;<span class="op" id="4823011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4823014">//&nbsp;WriteHeapProfile&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Lookup(&#34;heap&#34;).WriteTo(w,&nbsp;0).</span><br>
<span class="lineno"></span><span class="comment" id="4823081">//&nbsp;It&nbsp;is&nbsp;preserved&nbsp;for&nbsp;backwards&nbsp;compatibility.</span><br>
<span class="lineno"></span><span class="keyword" id="4823129">func</span>&nbsp;<span class="ident" id="4823134">WriteHeapProfile</span><span class="op" id="4823150">(</span><span class="ident" id="4823151">w</span>&nbsp;<span class="ident" id="4823153"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4823155">.</span><span class="ident" id="4823156">Writer</span><span class="op" id="4823162">)</span>&nbsp;<span class="builtintype" id="4823164">error</span>&nbsp;<span class="op" id="4823170">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4823173">return</span>&nbsp;<span class="ident" id="4823180"><a href="/runtime/pprof/pprof.go.html#4823402">writeHeap</a></span><span class="op" id="4823189">(</span><span class="ident" id="4823190"><a href="/runtime/pprof/pprof.go.html#4823151">w</a></span><span class="op" id="4823191">,</span>&nbsp;<span class="num" id="4823193">0</span><span class="op" id="4823194">)</span><br>
<span class="lineno"></span><span class="op" id="4823196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4823199">//&nbsp;countHeap&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;heap&nbsp;profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4823263">func</span>&nbsp;<span class="ident" id="4823268">countHeap</span><span class="op" id="4823277">(</span><span class="op" id="4823278">)</span>&nbsp;<span class="builtintype" id="4823280">int</span>&nbsp;<span class="op" id="4823284">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4823287">n</span><span class="op" id="4823288">,</span>&nbsp;<span class="ident" id="4823290">_</span>&nbsp;<span class="op" id="4823292">:=</span>&nbsp;<span class="ident" id="4823295"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4823302">.</span><span class="ident" id="4823303">MemProfile</span><span class="op" id="4823313">(</span><span class="ident" id="4823314">nil</span><span class="op" id="4823317">,</span>&nbsp;<span class="builtintype" id="4823319">true</span><span class="op" id="4823323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4823326">return</span>&nbsp;<span class="ident" id="4823333"><a href="/runtime/pprof/pprof.go.html#4823287">n</a></span><br>
<span class="lineno"></span><span class="op" id="4823335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4823338">//&nbsp;writeHeap&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;heap&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno">380</span><span class="keyword" id="4823397">func</span>&nbsp;<span class="ident" id="4823402">writeHeap</span><span class="op" id="4823411">(</span><span class="ident" id="4823412">w</span>&nbsp;<span class="ident" id="4823414"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4823416">.</span><span class="ident" id="4823417">Writer</span><span class="op" id="4823423">,</span>&nbsp;<span class="ident" id="4823425">debug</span>&nbsp;<span class="builtintype" id="4823431">int</span><span class="op" id="4823434">)</span>&nbsp;<span class="builtintype" id="4823436">error</span>&nbsp;<span class="op" id="4823442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823445">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(MemProfile(nil,&nbsp;true)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823510">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823560">//&nbsp;There&#39;s&nbsp;a&nbsp;racemore&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823617">//&nbsp;the&nbsp;two&nbsp;callsso&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823680">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823726">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4823793">var</span>&nbsp;<span class="ident" id="4823797">p</span>&nbsp;<span class="op" id="4823799">[</span><span class="op" id="4823800">]</span><span class="ident" id="4823801"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4823808">.</span><span class="ident" id="4823809">MemProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4823827">n</span><span class="op" id="4823828">,</span>&nbsp;<span class="ident" id="4823830">ok</span>&nbsp;<span class="op" id="4823833">:=</span>&nbsp;<span class="ident" id="4823836"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4823843">.</span><span class="ident" id="4823844">MemProfile</span><span class="op" id="4823854">(</span><span class="ident" id="4823855">nil</span><span class="op" id="4823858">,</span>&nbsp;<span class="builtintype" id="4823860">true</span><span class="op" id="4823864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4823867">for</span>&nbsp;<span class="op" id="4823871">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823875">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823925">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4823973">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;MemProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824008"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span>&nbsp;<span class="op" id="4824010">=</span>&nbsp;<span class="builtinfunc" id="4824012">make</span><span class="op" id="4824016">(</span><span class="op" id="4824017">[</span><span class="op" id="4824018">]</span><span class="ident" id="4824019"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4824026">.</span><span class="ident" id="4824027">MemProfileRecord</span><span class="op" id="4824043">,</span>&nbsp;<span class="ident" id="4824045"><a href="/runtime/pprof/pprof.go.html#4823827">n</a></span><span class="op" id="4824046">+</span><span class="num" id="4824047">50</span><span class="op" id="4824049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824053"><a href="/runtime/pprof/pprof.go.html#4823827">n</a></span><span class="op" id="4824054">,</span>&nbsp;<span class="ident" id="4824056"><a href="/runtime/pprof/pprof.go.html#4823830">ok</a></span>&nbsp;<span class="op" id="4824059">=</span>&nbsp;<span class="ident" id="4824061"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4824068">.</span><span class="ident" id="4824069">MemProfile</span><span class="op" id="4824079">(</span><span class="ident" id="4824080"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span><span class="op" id="4824081">,</span>&nbsp;<span class="builtintype" id="4824083">true</span><span class="op" id="4824087">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824091">if</span>&nbsp;<span class="ident" id="4824094"><a href="/runtime/pprof/pprof.go.html#4823830">ok</a></span>&nbsp;<span class="op" id="4824097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824102"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span>&nbsp;<span class="op" id="4824104">=</span>&nbsp;<span class="ident" id="4824106"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span><span class="op" id="4824107">[</span><span class="num" id="4824108">0</span><span class="op" id="4824109">:</span><span class="ident" id="4824110"><a href="/runtime/pprof/pprof.go.html#4823827">n</a></span><span class="op" id="4824111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824116">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4824124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4824128">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4824157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824161"><a href="/runtime/pprof/pprof.go.html#4813419">sort</a></span><span class="op" id="4824165">.</span><span class="ident" id="4824166">Sort</span><span class="op" id="4824170">(</span><span class="ident" id="4824171"><a href="/runtime/pprof/pprof.go.html#4822751">byInUseBytes</a></span><span class="op" id="4824183">(</span><span class="ident" id="4824184"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span><span class="op" id="4824185">)</span><span class="op" id="4824186">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824190">b</span>&nbsp;<span class="op" id="4824192">:=</span>&nbsp;<span class="ident" id="4824195"><a href="/runtime/pprof/pprof.go.html#4813377">bufio</a></span><span class="op" id="4824200">.</span><span class="ident" id="4824201">NewWriter</span><span class="op" id="4824210">(</span><span class="ident" id="4824211"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4824212">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824215">var</span>&nbsp;<span class="ident" id="4824219">tw</span>&nbsp;<span class="op" id="4824222">*</span><span class="ident" id="4824223"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4824232">.</span><span class="ident" id="4824233">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824241"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span>&nbsp;<span class="op" id="4824243">=</span>&nbsp;<span class="ident" id="4824245"><a href="/runtime/pprof/pprof.go.html#4824190">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824248">if</span>&nbsp;<span class="ident" id="4824251"><a href="/runtime/pprof/pprof.go.html#4823425">debug</a></span>&nbsp;<span class="op" id="4824257">&gt;</span>&nbsp;<span class="num" id="4824259">0</span>&nbsp;<span class="op" id="4824261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824265"><a href="/runtime/pprof/pprof.go.html#4824219">tw</a></span>&nbsp;<span class="op" id="4824268">=</span>&nbsp;<span class="ident" id="4824270"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4824279">.</span><span class="ident" id="4824280">NewWriter</span><span class="op" id="4824289">(</span><span class="ident" id="4824290"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4824291">,</span>&nbsp;<span class="num" id="4824293">1</span><span class="op" id="4824294">,</span>&nbsp;<span class="num" id="4824296">8</span><span class="op" id="4824297">,</span>&nbsp;<span class="num" id="4824299">1</span><span class="op" id="4824300">,</span>&nbsp;<span class="string" id="4824302">&#39;\t&#39;</span><span class="op" id="4824306">,</span>&nbsp;<span class="num" id="4824308">0</span><span class="op" id="4824309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824313"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span>&nbsp;<span class="op" id="4824315">=</span>&nbsp;<span class="ident" id="4824317"><a href="/runtime/pprof/pprof.go.html#4824219">tw</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4824321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824325">var</span>&nbsp;<span class="ident" id="4824329">total</span>&nbsp;<span class="ident" id="4824335"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4824342">.</span><span class="ident" id="4824343">MemProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824361">for</span>&nbsp;<span class="ident" id="4824365">i</span>&nbsp;<span class="op" id="4824367">:=</span>&nbsp;<span class="keyword" id="4824370">range</span>&nbsp;<span class="ident" id="4824376"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span>&nbsp;<span class="op" id="4824378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824382">r</span>&nbsp;<span class="op" id="4824384">:=</span>&nbsp;<span class="op" id="4824387">&amp;</span><span class="ident" id="4824388"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span><span class="op" id="4824389">[</span><span class="ident" id="4824390"><a href="/runtime/pprof/pprof.go.html#4824365">i</a></span><span class="op" id="4824391">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824395"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824400">.</span><span class="ident" id="4824401">AllocBytes</span>&nbsp;<span class="op" id="4824412">+=</span>&nbsp;<span class="ident" id="4824415"><a href="/runtime/pprof/pprof.go.html#4824382">r</a></span><span class="op" id="4824416">.</span><span class="ident" id="4824417">AllocBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824430"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824435">.</span><span class="ident" id="4824436">AllocObjects</span>&nbsp;<span class="op" id="4824449">+=</span>&nbsp;<span class="ident" id="4824452"><a href="/runtime/pprof/pprof.go.html#4824382">r</a></span><span class="op" id="4824453">.</span><span class="ident" id="4824454">AllocObjects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824469"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824474">.</span><span class="ident" id="4824475">FreeBytes</span>&nbsp;<span class="op" id="4824485">+=</span>&nbsp;<span class="ident" id="4824488"><a href="/runtime/pprof/pprof.go.html#4824382">r</a></span><span class="op" id="4824489">.</span><span class="ident" id="4824490">FreeBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824502"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824507">.</span><span class="ident" id="4824508">FreeObjects</span>&nbsp;<span class="op" id="4824520">+=</span>&nbsp;<span class="ident" id="4824523"><a href="/runtime/pprof/pprof.go.html#4824382">r</a></span><span class="op" id="4824524">.</span><span class="ident" id="4824525">FreeObjects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4824538">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4824542">//&nbsp;Technically&nbsp;the&nbsp;rate&nbsp;is&nbsp;MemProfileRate&nbsp;not&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4824607">//&nbsp;but&nbsp;early&nbsp;versions&nbsp;of&nbsp;the&nbsp;C++&nbsp;heap&nbsp;profiler&nbsp;reported&nbsp;2*MemProfileRate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4824682">//&nbsp;so&nbsp;that&#39;s&nbsp;what&nbsp;pprof&nbsp;has&nbsp;come&nbsp;to&nbsp;expect.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824727"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4824730">.</span><span class="ident" id="4824731">Fprintf</span><span class="op" id="4824738">(</span><span class="ident" id="4824739"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4824740">,</span>&nbsp;<span class="string" id="4824742">&#34;heap&nbsp;profile:&nbsp;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&nbsp;heap/%d\n&#34;</span><span class="op" id="4824785">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824789"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824794">.</span><span class="ident" id="4824795">InUseObjects</span><span class="op" id="4824807">(</span><span class="op" id="4824808">)</span><span class="op" id="4824809">,</span>&nbsp;<span class="ident" id="4824811"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824816">.</span><span class="ident" id="4824817">InUseBytes</span><span class="op" id="4824827">(</span><span class="op" id="4824828">)</span><span class="op" id="4824829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824833"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824838">.</span><span class="ident" id="4824839">AllocObjects</span><span class="op" id="4824851">,</span>&nbsp;<span class="ident" id="4824853"><a href="/runtime/pprof/pprof.go.html#4824329">total</a></span><span class="op" id="4824858">.</span><span class="ident" id="4824859">AllocBytes</span><span class="op" id="4824869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4824873">2</span><span class="op" id="4824874">*</span><span class="ident" id="4824875"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4824882">.</span><span class="ident" id="4824883">MemProfileRate</span><span class="op" id="4824897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4824901">for</span>&nbsp;<span class="ident" id="4824905">i</span>&nbsp;<span class="op" id="4824907">:=</span>&nbsp;<span class="keyword" id="4824910">range</span>&nbsp;<span class="ident" id="4824916"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span>&nbsp;<span class="op" id="4824918">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824922">r</span>&nbsp;<span class="op" id="4824924">:=</span>&nbsp;<span class="op" id="4824927">&amp;</span><span class="ident" id="4824928"><a href="/runtime/pprof/pprof.go.html#4823797">p</a></span><span class="op" id="4824929">[</span><span class="ident" id="4824930"><a href="/runtime/pprof/pprof.go.html#4824905">i</a></span><span class="op" id="4824931">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824935"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4824938">.</span><span class="ident" id="4824939">Fprintf</span><span class="op" id="4824946">(</span><span class="ident" id="4824947"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4824948">,</span>&nbsp;<span class="string" id="4824950">&#34;%d:&nbsp;%d&nbsp;[%d:&nbsp;%d]&nbsp;@&#34;</span><span class="op" id="4824969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4824974"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4824975">.</span><span class="ident" id="4824976">InUseObjects</span><span class="op" id="4824988">(</span><span class="op" id="4824989">)</span><span class="op" id="4824990">,</span>&nbsp;<span class="ident" id="4824992"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4824993">.</span><span class="ident" id="4824994">InUseBytes</span><span class="op" id="4825004">(</span><span class="op" id="4825005">)</span><span class="op" id="4825006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825011"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4825012">.</span><span class="ident" id="4825013">AllocObjects</span><span class="op" id="4825025">,</span>&nbsp;<span class="ident" id="4825027"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4825028">.</span><span class="ident" id="4825029">AllocBytes</span><span class="op" id="4825039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825043">for</span>&nbsp;<span class="ident" id="4825047">_</span><span class="op" id="4825048">,</span>&nbsp;<span class="ident" id="4825050">pc</span>&nbsp;<span class="op" id="4825053">:=</span>&nbsp;<span class="keyword" id="4825056">range</span>&nbsp;<span class="ident" id="4825062"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4825063">.</span><span class="ident" id="4825064">Stack</span><span class="op" id="4825069">(</span><span class="op" id="4825070">)</span>&nbsp;<span class="op" id="4825072">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825077"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825080">.</span><span class="ident" id="4825081">Fprintf</span><span class="op" id="4825088">(</span><span class="ident" id="4825089"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825090">,</span>&nbsp;<span class="string" id="4825092">&#34;&nbsp;%#x&#34;</span><span class="op" id="4825098">,</span>&nbsp;<span class="ident" id="4825100"><a href="/runtime/pprof/pprof.go.html#4825050">pc</a></span><span class="op" id="4825102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825110"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825113">.</span><span class="ident" id="4825114">Fprintf</span><span class="op" id="4825121">(</span><span class="ident" id="4825122"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825123">,</span>&nbsp;<span class="string" id="4825125">&#34;\n&#34;</span><span class="op" id="4825129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825133">if</span>&nbsp;<span class="ident" id="4825136"><a href="/runtime/pprof/pprof.go.html#4823425">debug</a></span>&nbsp;<span class="op" id="4825142">&gt;</span>&nbsp;<span class="num" id="4825144">0</span>&nbsp;<span class="op" id="4825146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825151"><a href="/runtime/pprof/pprof.go.html#4821642">printStackRecord</a></span><span class="op" id="4825167">(</span><span class="ident" id="4825168"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825169">,</span>&nbsp;<span class="ident" id="4825171"><a href="/runtime/pprof/pprof.go.html#4824922">r</a></span><span class="op" id="4825172">.</span><span class="ident" id="4825173">Stack</span><span class="op" id="4825178">(</span><span class="op" id="4825179">)</span><span class="op" id="4825180">,</span>&nbsp;<span class="builtintype" id="4825182">false</span><span class="op" id="4825187">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4825194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825198">//&nbsp;Print&nbsp;memstats&nbsp;information&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4825234">//&nbsp;Pprof&nbsp;will&nbsp;ignore,&nbsp;but&nbsp;useful&nbsp;for&nbsp;people</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4825279">if</span>&nbsp;<span class="ident" id="4825282"><a href="/runtime/pprof/pprof.go.html#4823425">debug</a></span>&nbsp;<span class="op" id="4825288">&gt;</span>&nbsp;<span class="num" id="4825290">0</span>&nbsp;<span class="op" id="4825292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825296">s</span>&nbsp;<span class="op" id="4825298">:=</span>&nbsp;<span class="builtinfunc" id="4825301">new</span><span class="op" id="4825304">(</span><span class="ident" id="4825305"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4825312">.</span><span class="ident" id="4825313">MemStats</span><span class="op" id="4825321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825325"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4825332">.</span><span class="ident" id="4825333">ReadMemStats</span><span class="op" id="4825345">(</span><span class="ident" id="4825346"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825351"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825354">.</span><span class="ident" id="4825355">Fprintf</span><span class="op" id="4825362">(</span><span class="ident" id="4825363"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825364">,</span>&nbsp;<span class="string" id="4825366">&#34;\n#&nbsp;runtime.MemStats\n&#34;</span><span class="op" id="4825390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825394"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825397">.</span><span class="ident" id="4825398">Fprintf</span><span class="op" id="4825405">(</span><span class="ident" id="4825406"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825407">,</span>&nbsp;<span class="string" id="4825409">&#34;#&nbsp;Alloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825425">,</span>&nbsp;<span class="ident" id="4825427"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825428">.</span><span class="ident" id="4825429">Alloc</span><span class="op" id="4825434">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825438"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825441">.</span><span class="ident" id="4825442">Fprintf</span><span class="op" id="4825449">(</span><span class="ident" id="4825450"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825451">,</span>&nbsp;<span class="string" id="4825453">&#34;#&nbsp;TotalAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825474">,</span>&nbsp;<span class="ident" id="4825476"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825477">.</span><span class="ident" id="4825478">TotalAlloc</span><span class="op" id="4825488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825492"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825495">.</span><span class="ident" id="4825496">Fprintf</span><span class="op" id="4825503">(</span><span class="ident" id="4825504"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825505">,</span>&nbsp;<span class="string" id="4825507">&#34;#&nbsp;Sys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825521">,</span>&nbsp;<span class="ident" id="4825523"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825524">.</span><span class="ident" id="4825525">Sys</span><span class="op" id="4825528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825532"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825535">.</span><span class="ident" id="4825536">Fprintf</span><span class="op" id="4825543">(</span><span class="ident" id="4825544"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825545">,</span>&nbsp;<span class="string" id="4825547">&#34;#&nbsp;Lookups&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825565">,</span>&nbsp;<span class="ident" id="4825567"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825568">.</span><span class="ident" id="4825569">Lookups</span><span class="op" id="4825576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825580"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825583">.</span><span class="ident" id="4825584">Fprintf</span><span class="op" id="4825591">(</span><span class="ident" id="4825592"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825593">,</span>&nbsp;<span class="string" id="4825595">&#34;#&nbsp;Mallocs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825613">,</span>&nbsp;<span class="ident" id="4825615"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825616">.</span><span class="ident" id="4825617">Mallocs</span><span class="op" id="4825624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825628"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825631">.</span><span class="ident" id="4825632">Fprintf</span><span class="op" id="4825639">(</span><span class="ident" id="4825640"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825641">,</span>&nbsp;<span class="string" id="4825643">&#34;#&nbsp;Frees&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825659">,</span>&nbsp;<span class="ident" id="4825661"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825662">.</span><span class="ident" id="4825663">Frees</span><span class="op" id="4825668">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825673"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825676">.</span><span class="ident" id="4825677">Fprintf</span><span class="op" id="4825684">(</span><span class="ident" id="4825685"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825686">,</span>&nbsp;<span class="string" id="4825688">&#34;#&nbsp;HeapAlloc&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825708">,</span>&nbsp;<span class="ident" id="4825710"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825711">.</span><span class="ident" id="4825712">HeapAlloc</span><span class="op" id="4825721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825725"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825728">.</span><span class="ident" id="4825729">Fprintf</span><span class="op" id="4825736">(</span><span class="ident" id="4825737"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825738">,</span>&nbsp;<span class="string" id="4825740">&#34;#&nbsp;HeapSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825758">,</span>&nbsp;<span class="ident" id="4825760"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825761">.</span><span class="ident" id="4825762">HeapSys</span><span class="op" id="4825769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825773"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825776">.</span><span class="ident" id="4825777">Fprintf</span><span class="op" id="4825784">(</span><span class="ident" id="4825785"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825786">,</span>&nbsp;<span class="string" id="4825788">&#34;#&nbsp;HeapIdle&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825807">,</span>&nbsp;<span class="ident" id="4825809"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825810">.</span><span class="ident" id="4825811">HeapIdle</span><span class="op" id="4825819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825823"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825826">.</span><span class="ident" id="4825827">Fprintf</span><span class="op" id="4825834">(</span><span class="ident" id="4825835"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825836">,</span>&nbsp;<span class="string" id="4825838">&#34;#&nbsp;HeapInuse&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825858">,</span>&nbsp;<span class="ident" id="4825860"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825861">.</span><span class="ident" id="4825862">HeapInuse</span><span class="op" id="4825871">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825875"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825878">.</span><span class="ident" id="4825879">Fprintf</span><span class="op" id="4825886">(</span><span class="ident" id="4825887"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825888">,</span>&nbsp;<span class="string" id="4825890">&#34;#&nbsp;HeapReleased&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825913">,</span>&nbsp;<span class="ident" id="4825915"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825916">.</span><span class="ident" id="4825917">HeapReleased</span><span class="op" id="4825929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825933"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825936">.</span><span class="ident" id="4825937">Fprintf</span><span class="op" id="4825944">(</span><span class="ident" id="4825945"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4825946">,</span>&nbsp;<span class="string" id="4825948">&#34;#&nbsp;HeapObjects&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4825970">,</span>&nbsp;<span class="ident" id="4825972"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4825973">.</span><span class="ident" id="4825974">HeapObjects</span><span class="op" id="4825985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4825990"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4825993">.</span><span class="ident" id="4825994">Fprintf</span><span class="op" id="4826001">(</span><span class="ident" id="4826002"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826003">,</span>&nbsp;<span class="string" id="4826005">&#34;#&nbsp;Stack&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4826026">,</span>&nbsp;<span class="ident" id="4826028"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826029">.</span><span class="ident" id="4826030">StackInuse</span><span class="op" id="4826040">,</span>&nbsp;<span class="ident" id="4826042"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826043">.</span><span class="ident" id="4826044">StackSys</span><span class="op" id="4826052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826056"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826059">.</span><span class="ident" id="4826060">Fprintf</span><span class="op" id="4826067">(</span><span class="ident" id="4826068"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826069">,</span>&nbsp;<span class="string" id="4826071">&#34;#&nbsp;MSpan&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4826092">,</span>&nbsp;<span class="ident" id="4826094"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826095">.</span><span class="ident" id="4826096">MSpanInuse</span><span class="op" id="4826106">,</span>&nbsp;<span class="ident" id="4826108"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826109">.</span><span class="ident" id="4826110">MSpanSys</span><span class="op" id="4826118">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826122"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826125">.</span><span class="ident" id="4826126">Fprintf</span><span class="op" id="4826133">(</span><span class="ident" id="4826134"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826135">,</span>&nbsp;<span class="string" id="4826137">&#34;#&nbsp;MCache&nbsp;=&nbsp;%d&nbsp;/&nbsp;%d\n&#34;</span><span class="op" id="4826159">,</span>&nbsp;<span class="ident" id="4826161"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826162">.</span><span class="ident" id="4826163">MCacheInuse</span><span class="op" id="4826174">,</span>&nbsp;<span class="ident" id="4826176"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826177">.</span><span class="ident" id="4826178">MCacheSys</span><span class="op" id="4826187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826191"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826194">.</span><span class="ident" id="4826195">Fprintf</span><span class="op" id="4826202">(</span><span class="ident" id="4826203"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826204">,</span>&nbsp;<span class="string" id="4826206">&#34;#&nbsp;BuckHashSys&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4826228">,</span>&nbsp;<span class="ident" id="4826230"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826231">.</span><span class="ident" id="4826232">BuckHashSys</span><span class="op" id="4826243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826248"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826251">.</span><span class="ident" id="4826252">Fprintf</span><span class="op" id="4826259">(</span><span class="ident" id="4826260"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826261">,</span>&nbsp;<span class="string" id="4826263">&#34;#&nbsp;NextGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4826280">,</span>&nbsp;<span class="ident" id="4826282"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826283">.</span><span class="ident" id="4826284">NextGC</span><span class="op" id="4826290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826294"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826297">.</span><span class="ident" id="4826298">Fprintf</span><span class="op" id="4826305">(</span><span class="ident" id="4826306"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826307">,</span>&nbsp;<span class="string" id="4826309">&#34;#&nbsp;PauseNs&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4826327">,</span>&nbsp;<span class="ident" id="4826329"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826330">.</span><span class="ident" id="4826331">PauseNs</span><span class="op" id="4826338">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826342"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826345">.</span><span class="ident" id="4826346">Fprintf</span><span class="op" id="4826353">(</span><span class="ident" id="4826354"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826355">,</span>&nbsp;<span class="string" id="4826357">&#34;#&nbsp;NumGC&nbsp;=&nbsp;%d\n&#34;</span><span class="op" id="4826373">,</span>&nbsp;<span class="ident" id="4826375"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826376">.</span><span class="ident" id="4826377">NumGC</span><span class="op" id="4826382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826386"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826389">.</span><span class="ident" id="4826390">Fprintf</span><span class="op" id="4826397">(</span><span class="ident" id="4826398"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826399">,</span>&nbsp;<span class="string" id="4826401">&#34;#&nbsp;EnableGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="4826420">,</span>&nbsp;<span class="ident" id="4826422"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826423">.</span><span class="ident" id="4826424">EnableGC</span><span class="op" id="4826432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826436"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4826439">.</span><span class="ident" id="4826440">Fprintf</span><span class="op" id="4826447">(</span><span class="ident" id="4826448"><a href="/runtime/pprof/pprof.go.html#4823412">w</a></span><span class="op" id="4826449">,</span>&nbsp;<span class="string" id="4826451">&#34;#&nbsp;DebugGC&nbsp;=&nbsp;%v\n&#34;</span><span class="op" id="4826469">,</span>&nbsp;<span class="ident" id="4826471"><a href="/runtime/pprof/pprof.go.html#4825296">s</a></span><span class="op" id="4826472">.</span><span class="ident" id="4826473">DebugGC</span><span class="op" id="4826480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826487">if</span>&nbsp;<span class="ident" id="4826490"><a href="/runtime/pprof/pprof.go.html#4824219">tw</a></span>&nbsp;<span class="op" id="4826493">!=</span>&nbsp;<span class="ident" id="4826496">nil</span>&nbsp;<span class="op" id="4826500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826504"><a href="/runtime/pprof/pprof.go.html#4824219">tw</a></span><span class="op" id="4826506">.</span><span class="ident" id="4826507">Flush</span><span class="op" id="4826512">(</span><span class="op" id="4826513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4826516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826519">return</span>&nbsp;<span class="ident" id="4826526"><a href="/runtime/pprof/pprof.go.html#4824190">b</a></span><span class="op" id="4826527">.</span><span class="ident" id="4826528">Flush</span><span class="op" id="4826533">(</span><span class="op" id="4826534">)</span><br>
<span class="lineno"></span><span class="op" id="4826536">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="4826539">//&nbsp;countThreadCreate&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;current&nbsp;ThreadCreateProfile.</span><br>
<span class="lineno"></span><span class="keyword" id="4826613">func</span>&nbsp;<span class="ident" id="4826618">countThreadCreate</span><span class="op" id="4826635">(</span><span class="op" id="4826636">)</span>&nbsp;<span class="builtintype" id="4826638">int</span>&nbsp;<span class="op" id="4826642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4826645">n</span><span class="op" id="4826646">,</span>&nbsp;<span class="ident" id="4826648">_</span>&nbsp;<span class="op" id="4826650">:=</span>&nbsp;<span class="ident" id="4826653"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4826660">.</span><span class="ident" id="4826661">ThreadCreateProfile</span><span class="op" id="4826680">(</span><span class="ident" id="4826681">nil</span><span class="op" id="4826684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826687">return</span>&nbsp;<span class="ident" id="4826694"><a href="/runtime/pprof/pprof.go.html#4826645">n</a></span><br>
<span class="lineno">485</span><span class="op" id="4826696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4826699">//&nbsp;writeThreadCreate&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;ThreadCreateProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4826773">func</span>&nbsp;<span class="ident" id="4826778">writeThreadCreate</span><span class="op" id="4826795">(</span><span class="ident" id="4826796">w</span>&nbsp;<span class="ident" id="4826798"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4826800">.</span><span class="ident" id="4826801">Writer</span><span class="op" id="4826807">,</span>&nbsp;<span class="ident" id="4826809">debug</span>&nbsp;<span class="builtintype" id="4826815">int</span><span class="op" id="4826818">)</span>&nbsp;<span class="builtintype" id="4826820">error</span>&nbsp;<span class="op" id="4826826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826829">return</span>&nbsp;<span class="ident" id="4826836"><a href="/runtime/pprof/pprof.go.html#4827815">writeRuntimeProfile</a></span><span class="op" id="4826855">(</span><span class="ident" id="4826856"><a href="/runtime/pprof/pprof.go.html#4826796">w</a></span><span class="op" id="4826857">,</span>&nbsp;<span class="ident" id="4826859"><a href="/runtime/pprof/pprof.go.html#4826809">debug</a></span><span class="op" id="4826864">,</span>&nbsp;<span class="string" id="4826866">&#34;threadcreate&#34;</span><span class="op" id="4826880">,</span>&nbsp;<span class="ident" id="4826882"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4826889">.</span><span class="ident" id="4826890">ThreadCreateProfile</span><span class="op" id="4826909">)</span><br>
<span class="lineno">490</span><span class="op" id="4826911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4826914">//&nbsp;countGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="4826966">func</span>&nbsp;<span class="ident" id="4826971">countGoroutine</span><span class="op" id="4826985">(</span><span class="op" id="4826986">)</span>&nbsp;<span class="builtintype" id="4826988">int</span>&nbsp;<span class="op" id="4826992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4826995">return</span>&nbsp;<span class="ident" id="4827002"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4827009">.</span><span class="ident" id="4827010">NumGoroutine</span><span class="op" id="4827022">(</span><span class="op" id="4827023">)</span><br>
<span class="lineno">495</span><span class="op" id="4827025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4827028">//&nbsp;writeGoroutine&nbsp;writes&nbsp;the&nbsp;current&nbsp;runtime&nbsp;GoroutineProfile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4827096">func</span>&nbsp;<span class="ident" id="4827101">writeGoroutine</span><span class="op" id="4827115">(</span><span class="ident" id="4827116">w</span>&nbsp;<span class="ident" id="4827118"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4827120">.</span><span class="ident" id="4827121">Writer</span><span class="op" id="4827127">,</span>&nbsp;<span class="ident" id="4827129">debug</span>&nbsp;<span class="builtintype" id="4827135">int</span><span class="op" id="4827138">)</span>&nbsp;<span class="builtintype" id="4827140">error</span>&nbsp;<span class="op" id="4827146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827149">if</span>&nbsp;<span class="ident" id="4827152"><a href="/runtime/pprof/pprof.go.html#4827129">debug</a></span>&nbsp;<span class="op" id="4827158">&gt;=</span>&nbsp;<span class="num" id="4827161">2</span>&nbsp;<span class="op" id="4827163">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827167">return</span>&nbsp;<span class="ident" id="4827174"><a href="/runtime/pprof/pprof.go.html#4827286">writeGoroutineStacks</a></span><span class="op" id="4827194">(</span><span class="ident" id="4827195"><a href="/runtime/pprof/pprof.go.html#4827116">w</a></span><span class="op" id="4827196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827202">return</span>&nbsp;<span class="ident" id="4827209"><a href="/runtime/pprof/pprof.go.html#4827815">writeRuntimeProfile</a></span><span class="op" id="4827228">(</span><span class="ident" id="4827229"><a href="/runtime/pprof/pprof.go.html#4827116">w</a></span><span class="op" id="4827230">,</span>&nbsp;<span class="ident" id="4827232"><a href="/runtime/pprof/pprof.go.html#4827129">debug</a></span><span class="op" id="4827237">,</span>&nbsp;<span class="string" id="4827239">&#34;goroutine&#34;</span><span class="op" id="4827250">,</span>&nbsp;<span class="ident" id="4827252"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4827259">.</span><span class="ident" id="4827260">GoroutineProfile</span><span class="op" id="4827276">)</span><br>
<span class="lineno"></span><span class="op" id="4827278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="4827281">func</span>&nbsp;<span class="ident" id="4827286">writeGoroutineStacks</span><span class="op" id="4827306">(</span><span class="ident" id="4827307">w</span>&nbsp;<span class="ident" id="4827309"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4827311">.</span><span class="ident" id="4827312">Writer</span><span class="op" id="4827318">)</span>&nbsp;<span class="builtintype" id="4827320">error</span>&nbsp;<span class="op" id="4827326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827329">//&nbsp;We&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;big&nbsp;the&nbsp;buffer&nbsp;needs&nbsp;to&nbsp;be&nbsp;to&nbsp;collect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827389">//&nbsp;all&nbsp;the&nbsp;goroutines.&nbsp;&nbsp;Start&nbsp;with&nbsp;1&nbsp;MB&nbsp;and&nbsp;try&nbsp;a&nbsp;few&nbsp;times,&nbsp;doubling&nbsp;each&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827471">//&nbsp;Give&nbsp;up&nbsp;and&nbsp;use&nbsp;a&nbsp;truncated&nbsp;trace&nbsp;if&nbsp;64&nbsp;MB&nbsp;is&nbsp;not&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827533">buf</span>&nbsp;<span class="op" id="4827537">:=</span>&nbsp;<span class="builtinfunc" id="4827540">make</span><span class="op" id="4827544">(</span><span class="op" id="4827545">[</span><span class="op" id="4827546">]</span><span class="builtintype" id="4827547">byte</span><span class="op" id="4827551">,</span>&nbsp;<span class="num" id="4827553">1</span><span class="op" id="4827554">&lt;&lt;</span><span class="num" id="4827556">20</span><span class="op" id="4827558">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827561">for</span>&nbsp;<span class="ident" id="4827565">i</span>&nbsp;<span class="op" id="4827567">:=</span>&nbsp;<span class="num" id="4827570">0</span><span class="op" id="4827571">;</span>&nbsp;<span class="op" id="4827573">;</span>&nbsp;<span class="ident" id="4827575"><a href="/runtime/pprof/pprof.go.html#4827565">i</a></span><span class="op" id="4827576">++</span>&nbsp;<span class="op" id="4827579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827583">n</span>&nbsp;<span class="op" id="4827585">:=</span>&nbsp;<span class="ident" id="4827588"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4827595">.</span><span class="ident" id="4827596">Stack</span><span class="op" id="4827601">(</span><span class="ident" id="4827602"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827605">,</span>&nbsp;<span class="builtintype" id="4827607">true</span><span class="op" id="4827611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827615">if</span>&nbsp;<span class="ident" id="4827618"><a href="/runtime/pprof/pprof.go.html#4827583">n</a></span>&nbsp;<span class="op" id="4827620">&lt;</span>&nbsp;<span class="builtinfunc" id="4827622">len</span><span class="op" id="4827625">(</span><span class="ident" id="4827626"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827629">)</span>&nbsp;<span class="op" id="4827631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827636"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span>&nbsp;<span class="op" id="4827640">=</span>&nbsp;<span class="ident" id="4827642"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827645">[</span><span class="op" id="4827646">:</span><span class="ident" id="4827647"><a href="/runtime/pprof/pprof.go.html#4827583">n</a></span><span class="op" id="4827648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827653">break</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827665">if</span>&nbsp;<span class="builtinfunc" id="4827668">len</span><span class="op" id="4827671">(</span><span class="ident" id="4827672"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827675">)</span>&nbsp;<span class="op" id="4827677">&gt;=</span>&nbsp;<span class="num" id="4827680">64</span><span class="op" id="4827682">&lt;&lt;</span><span class="num" id="4827684">20</span>&nbsp;<span class="op" id="4827687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827692">//&nbsp;Filled&nbsp;64&nbsp;MB&nbsp;-&nbsp;stop&nbsp;there.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827725">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827733">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827737"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span>&nbsp;<span class="op" id="4827741">=</span>&nbsp;<span class="builtinfunc" id="4827743">make</span><span class="op" id="4827747">(</span><span class="op" id="4827748">[</span><span class="op" id="4827749">]</span><span class="builtintype" id="4827750">byte</span><span class="op" id="4827754">,</span>&nbsp;<span class="num" id="4827756">2</span><span class="op" id="4827757">*</span><span class="builtinfunc" id="4827758">len</span><span class="op" id="4827761">(</span><span class="ident" id="4827762"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827765">)</span><span class="op" id="4827766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4827769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4827772">_</span><span class="op" id="4827773">,</span>&nbsp;<span class="ident" id="4827775">err</span>&nbsp;<span class="op" id="4827779">:=</span>&nbsp;<span class="ident" id="4827782"><a href="/runtime/pprof/pprof.go.html#4827307">w</a></span><span class="op" id="4827783">.</span><span class="ident" id="4827784">Write</span><span class="op" id="4827789">(</span><span class="ident" id="4827790"><a href="/runtime/pprof/pprof.go.html#4827533">buf</a></span><span class="op" id="4827793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4827796">return</span>&nbsp;<span class="ident" id="4827803"><a href="/runtime/pprof/pprof.go.html#4827775">err</a></span><br>
<span class="lineno"></span><span class="op" id="4827807">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="4827810">func</span>&nbsp;<span class="ident" id="4827815">writeRuntimeProfile</span><span class="op" id="4827834">(</span><span class="ident" id="4827835">w</span>&nbsp;<span class="ident" id="4827837"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4827839">.</span><span class="ident" id="4827840">Writer</span><span class="op" id="4827846">,</span>&nbsp;<span class="ident" id="4827848">debug</span>&nbsp;<span class="builtintype" id="4827854">int</span><span class="op" id="4827857">,</span>&nbsp;<span class="ident" id="4827859">name</span>&nbsp;<span class="builtintype" id="4827864">string</span><span class="op" id="4827870">,</span>&nbsp;<span class="ident" id="4827872">fetch</span>&nbsp;<span class="keyword" id="4827878">func</span><span class="op" id="4827882">(</span><span class="op" id="4827883">[</span><span class="op" id="4827884">]</span><span class="ident" id="4827885"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4827892">.</span><span class="ident" id="4827893">StackRecord</span><span class="op" id="4827904">)</span>&nbsp;<span class="op" id="4827906">(</span><span class="builtintype" id="4827907">int</span><span class="op" id="4827910">,</span>&nbsp;<span class="builtintype" id="4827912">bool</span><span class="op" id="4827916">)</span><span class="op" id="4827917">)</span>&nbsp;<span class="builtintype" id="4827919">error</span>&nbsp;<span class="op" id="4827925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827928">//&nbsp;Find&nbsp;out&nbsp;how&nbsp;many&nbsp;records&nbsp;there&nbsp;are&nbsp;(fetch(nil)),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4827982">//&nbsp;allocate&nbsp;that&nbsp;many&nbsp;records,&nbsp;and&nbsp;get&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828032">//&nbsp;There&#39;s&nbsp;a&nbsp;racemore&nbsp;records&nbsp;might&nbsp;be&nbsp;added&nbsp;between</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828089">//&nbsp;the&nbsp;two&nbsp;callsso&nbsp;allocate&nbsp;a&nbsp;few&nbsp;extra&nbsp;records&nbsp;for&nbsp;safety</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828152">//&nbsp;and&nbsp;also&nbsp;try&nbsp;again&nbsp;if&nbsp;we&#39;re&nbsp;very&nbsp;unlucky.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828198">//&nbsp;The&nbsp;loop&nbsp;should&nbsp;only&nbsp;execute&nbsp;one&nbsp;iteration&nbsp;in&nbsp;the&nbsp;common&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828265">var</span>&nbsp;<span class="ident" id="4828269">p</span>&nbsp;<span class="op" id="4828271">[</span><span class="op" id="4828272">]</span><span class="ident" id="4828273"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4828280">.</span><span class="ident" id="4828281">StackRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828294">n</span><span class="op" id="4828295">,</span>&nbsp;<span class="ident" id="4828297">ok</span>&nbsp;<span class="op" id="4828300">:=</span>&nbsp;<span class="ident" id="4828303"><a href="/runtime/pprof/pprof.go.html#4827872">fetch</a></span><span class="op" id="4828308">(</span><span class="ident" id="4828309">nil</span><span class="op" id="4828312">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828315">for</span>&nbsp;<span class="op" id="4828319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828323">//&nbsp;Allocate&nbsp;room&nbsp;for&nbsp;a&nbsp;slightly&nbsp;bigger&nbsp;profile,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828373">//&nbsp;in&nbsp;case&nbsp;a&nbsp;few&nbsp;more&nbsp;entries&nbsp;have&nbsp;been&nbsp;added</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828421">//&nbsp;since&nbsp;the&nbsp;call&nbsp;to&nbsp;ThreadProfile.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828459"><a href="/runtime/pprof/pprof.go.html#4828269">p</a></span>&nbsp;<span class="op" id="4828461">=</span>&nbsp;<span class="builtinfunc" id="4828463">make</span><span class="op" id="4828467">(</span><span class="op" id="4828468">[</span><span class="op" id="4828469">]</span><span class="ident" id="4828470"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4828477">.</span><span class="ident" id="4828478">StackRecord</span><span class="op" id="4828489">,</span>&nbsp;<span class="ident" id="4828491"><a href="/runtime/pprof/pprof.go.html#4828294">n</a></span><span class="op" id="4828492">+</span><span class="num" id="4828493">10</span><span class="op" id="4828495">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828499"><a href="/runtime/pprof/pprof.go.html#4828294">n</a></span><span class="op" id="4828500">,</span>&nbsp;<span class="ident" id="4828502"><a href="/runtime/pprof/pprof.go.html#4828297">ok</a></span>&nbsp;<span class="op" id="4828505">=</span>&nbsp;<span class="ident" id="4828507"><a href="/runtime/pprof/pprof.go.html#4827872">fetch</a></span><span class="op" id="4828512">(</span><span class="ident" id="4828513"><a href="/runtime/pprof/pprof.go.html#4828269">p</a></span><span class="op" id="4828514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828518">if</span>&nbsp;<span class="ident" id="4828521"><a href="/runtime/pprof/pprof.go.html#4828297">ok</a></span>&nbsp;<span class="op" id="4828524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828529"><a href="/runtime/pprof/pprof.go.html#4828269">p</a></span>&nbsp;<span class="op" id="4828531">=</span>&nbsp;<span class="ident" id="4828533"><a href="/runtime/pprof/pprof.go.html#4828269">p</a></span><span class="op" id="4828534">[</span><span class="num" id="4828535">0</span><span class="op" id="4828536">:</span><span class="ident" id="4828537"><a href="/runtime/pprof/pprof.go.html#4828294">n</a></span><span class="op" id="4828538">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828543">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828551">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4828555">//&nbsp;Profile&nbsp;grew;&nbsp;try&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4828584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4828588">return</span>&nbsp;<span class="ident" id="4828595"><a href="/runtime/pprof/pprof.go.html#4820621">printCountProfile</a></span><span class="op" id="4828612">(</span><span class="ident" id="4828613"><a href="/runtime/pprof/pprof.go.html#4827835">w</a></span><span class="op" id="4828614">,</span>&nbsp;<span class="ident" id="4828616"><a href="/runtime/pprof/pprof.go.html#4827848">debug</a></span><span class="op" id="4828621">,</span>&nbsp;<span class="ident" id="4828623"><a href="/runtime/pprof/pprof.go.html#4827859">name</a></span><span class="op" id="4828627">,</span>&nbsp;<span class="ident" id="4828629"><a href="/runtime/pprof/pprof.go.html#4828656">runtimeProfile</a></span><span class="op" id="4828643">(</span><span class="ident" id="4828644"><a href="/runtime/pprof/pprof.go.html#4828269">p</a></span><span class="op" id="4828645">)</span><span class="op" id="4828646">)</span><br>
<span class="lineno"></span><span class="op" id="4828648">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="keyword" id="4828651">type</span>&nbsp;<span class="ident" id="4828656">runtimeProfile</span>&nbsp;<span class="op" id="4828671">[</span><span class="op" id="4828672">]</span><span class="ident" id="4828673"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4828680">.</span><span class="ident" id="4828681">StackRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4828694">func</span>&nbsp;<span class="op" id="4828699">(</span><span class="ident" id="4828700">p</span>&nbsp;<span class="ident" id="4828702"><a href="/runtime/pprof/pprof.go.html#4828656">runtimeProfile</a></span><span class="op" id="4828716">)</span>&nbsp;<span class="ident" id="4828718">Len</span><span class="op" id="4828721">(</span><span class="op" id="4828722">)</span>&nbsp;<span class="builtintype" id="4828724">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4828741">{</span>&nbsp;<span class="keyword" id="4828743">return</span>&nbsp;<span class="builtinfunc" id="4828750">len</span><span class="op" id="4828753">(</span><span class="ident" id="4828754"><a href="/runtime/pprof/pprof.go.html#4828700">p</a></span><span class="op" id="4828755">)</span>&nbsp;<span class="op" id="4828757">}</span><br>
<span class="lineno"></span><span class="keyword" id="4828759">func</span>&nbsp;<span class="op" id="4828764">(</span><span class="ident" id="4828765">p</span>&nbsp;<span class="ident" id="4828767"><a href="/runtime/pprof/pprof.go.html#4828656">runtimeProfile</a></span><span class="op" id="4828781">)</span>&nbsp;<span class="ident" id="4828783">Stack</span><span class="op" id="4828788">(</span><span class="ident" id="4828789">i</span>&nbsp;<span class="builtintype" id="4828791">int</span><span class="op" id="4828794">)</span>&nbsp;<span class="op" id="4828796">[</span><span class="op" id="4828797">]</span><span class="builtintype" id="4828798">uintptr</span>&nbsp;<span class="op" id="4828806">{</span>&nbsp;<span class="keyword" id="4828808">return</span>&nbsp;<span class="ident" id="4828815"><a href="/runtime/pprof/pprof.go.html#4828765">p</a></span><span class="op" id="4828816">[</span><span class="ident" id="4828817"><a href="/runtime/pprof/pprof.go.html#4828789">i</a></span><span class="op" id="4828818">]</span><span class="op" id="4828819">.</span><span class="ident" id="4828820">Stack</span><span class="op" id="4828825">(</span><span class="op" id="4828826">)</span>&nbsp;<span class="op" id="4828828">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="4828831">var</span>&nbsp;<span class="ident" id="4828835">cpu</span>&nbsp;<span class="keyword" id="4828839">struct</span>&nbsp;<span class="op" id="4828846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828849"><a href="/runtime/pprof/pprof.go.html#4813438">sync</a></span><span class="op" id="4828853">.</span><span class="ident" id="4828854">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828861">profiling</span>&nbsp;<span class="builtintype" id="4828871">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4828877">done</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4828887">chan</span>&nbsp;<span class="builtintype" id="4828892">bool</span><br>
<span class="lineno">560</span><span class="op" id="4828897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4828900">//&nbsp;StartCPUProfile&nbsp;enables&nbsp;CPU&nbsp;profiling&nbsp;for&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="4828966">//&nbsp;While&nbsp;profiling,&nbsp;the&nbsp;profile&nbsp;will&nbsp;be&nbsp;buffered&nbsp;and&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="4829033">//&nbsp;StartCPUProfile&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;profiling&nbsp;is&nbsp;already&nbsp;enabled.</span><br>
<span class="lineno">565</span><span class="keyword" id="4829102">func</span>&nbsp;<span class="ident" id="4829107">StartCPUProfile</span><span class="op" id="4829122">(</span><span class="ident" id="4829123">w</span>&nbsp;<span class="ident" id="4829125"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4829127">.</span><span class="ident" id="4829128">Writer</span><span class="op" id="4829134">)</span>&nbsp;<span class="builtintype" id="4829136">error</span>&nbsp;<span class="op" id="4829142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829145">//&nbsp;The&nbsp;runtime&nbsp;routines&nbsp;allow&nbsp;a&nbsp;variable&nbsp;profiling&nbsp;rate,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829203">//&nbsp;but&nbsp;in&nbsp;practice&nbsp;operating&nbsp;systems&nbsp;cannot&nbsp;trigger&nbsp;signals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829264">//&nbsp;at&nbsp;more&nbsp;than&nbsp;about&nbsp;500&nbsp;Hz,&nbsp;and&nbsp;our&nbsp;processing&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829321">//&nbsp;signal&nbsp;is&nbsp;not&nbsp;cheap&nbsp;(mostly&nbsp;getting&nbsp;the&nbsp;stack&nbsp;trace).</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829379">//&nbsp;100&nbsp;Hz&nbsp;is&nbsp;a&nbsp;reasonable&nbsp;choice:&nbsp;it&nbsp;is&nbsp;frequent&nbsp;enough&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829439">//&nbsp;produce&nbsp;useful&nbsp;data,&nbsp;rare&nbsp;enough&nbsp;not&nbsp;to&nbsp;bog&nbsp;down&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829496">//&nbsp;system,&nbsp;and&nbsp;a&nbsp;nice&nbsp;round&nbsp;number&nbsp;to&nbsp;make&nbsp;it&nbsp;easy&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829551">//&nbsp;convert&nbsp;sample&nbsp;counts&nbsp;to&nbsp;seconds.&nbsp;&nbsp;Instead&nbsp;of&nbsp;requiring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829611">//&nbsp;each&nbsp;client&nbsp;to&nbsp;specify&nbsp;the&nbsp;frequency,&nbsp;we&nbsp;hard&nbsp;code&nbsp;it.</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829670">const</span>&nbsp;<span class="ident" id="4829676">hz</span>&nbsp;<span class="op" id="4829679">=</span>&nbsp;<span class="num" id="4829681">100</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829687"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829690">.</span><span class="ident" id="4829691">Lock</span><span class="op" id="4829695">(</span><span class="op" id="4829696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829699">defer</span>&nbsp;<span class="ident" id="4829705"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829708">.</span><span class="ident" id="4829709">Unlock</span><span class="op" id="4829715">(</span><span class="op" id="4829716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829719">if</span>&nbsp;<span class="ident" id="4829722"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829725">.</span><span class="ident" id="4829726">done</span>&nbsp;<span class="op" id="4829731">==</span>&nbsp;<span class="ident" id="4829734">nil</span>&nbsp;<span class="op" id="4829738">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829742"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829745">.</span><span class="ident" id="4829746">done</span>&nbsp;<span class="op" id="4829751">=</span>&nbsp;<span class="builtinfunc" id="4829753">make</span><span class="op" id="4829757">(</span><span class="keyword" id="4829758">chan</span>&nbsp;<span class="builtintype" id="4829763">bool</span><span class="op" id="4829767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4829773">//&nbsp;Double-check.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829791">if</span>&nbsp;<span class="ident" id="4829794"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829797">.</span><span class="ident" id="4829798">profiling</span>&nbsp;<span class="op" id="4829808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829812">return</span>&nbsp;<span class="ident" id="4829819"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4829822">.</span><span class="ident" id="4829823">Errorf</span><span class="op" id="4829829">(</span><span class="string" id="4829830">&#34;cpu&nbsp;profiling&nbsp;already&nbsp;in&nbsp;use&#34;</span><span class="op" id="4829860">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4829863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829866"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4829869">.</span><span class="ident" id="4829870">profiling</span>&nbsp;<span class="op" id="4829880">=</span>&nbsp;<span class="builtintype" id="4829882">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829888"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4829895">.</span><span class="ident" id="4829896">SetCPUProfileRate</span><span class="op" id="4829913">(</span><span class="ident" id="4829914"><a href="/runtime/pprof/pprof.go.html#4829676">hz</a></span><span class="op" id="4829916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829919">go</span>&nbsp;<span class="ident" id="4829922"><a href="/runtime/pprof/pprof.go.html#4829959">profileWriter</a></span><span class="op" id="4829935">(</span><span class="ident" id="4829936"><a href="/runtime/pprof/pprof.go.html#4829123">w</a></span><span class="op" id="4829937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829940">return</span>&nbsp;<span class="ident" id="4829947">nil</span><br>
<span class="lineno">590</span><span class="op" id="4829951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4829954">func</span>&nbsp;<span class="ident" id="4829959">profileWriter</span><span class="op" id="4829972">(</span><span class="ident" id="4829973">w</span>&nbsp;<span class="ident" id="4829975"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4829977">.</span><span class="ident" id="4829978">Writer</span><span class="op" id="4829984">)</span>&nbsp;<span class="op" id="4829986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4829989">for</span>&nbsp;<span class="op" id="4829993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4829997">data</span>&nbsp;<span class="op" id="4830002">:=</span>&nbsp;<span class="ident" id="4830005"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830012">.</span><span class="ident" id="4830013">CPUProfile</span><span class="op" id="4830023">(</span><span class="op" id="4830024">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830028">if</span>&nbsp;<span class="ident" id="4830031"><a href="/runtime/pprof/pprof.go.html#4829997">data</a></span>&nbsp;<span class="op" id="4830036">==</span>&nbsp;<span class="ident" id="4830039">nil</span>&nbsp;<span class="op" id="4830043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830048">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830060"><a href="/runtime/pprof/pprof.go.html#4829973">w</a></span><span class="op" id="4830061">.</span><span class="ident" id="4830062">Write</span><span class="op" id="4830067">(</span><span class="ident" id="4830068"><a href="/runtime/pprof/pprof.go.html#4829997">data</a></span><span class="op" id="4830072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830075">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830078"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830081">.</span><span class="ident" id="4830082">done</span>&nbsp;<span class="op" id="4830087">&lt;-</span>&nbsp;<span class="builtintype" id="4830090">true</span><br>
<span class="lineno"></span><span class="op" id="4830095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830098">//&nbsp;StopCPUProfile&nbsp;stops&nbsp;the&nbsp;current&nbsp;CPU&nbsp;profile,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="4830155">//&nbsp;StopCPUProfile&nbsp;only&nbsp;returns&nbsp;after&nbsp;all&nbsp;the&nbsp;writes&nbsp;for&nbsp;the</span><br>
<span class="lineno">605</span><span class="comment" id="4830215">//&nbsp;profile&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="keyword" id="4830242">func</span>&nbsp;<span class="ident" id="4830247">StopCPUProfile</span><span class="op" id="4830261">(</span><span class="op" id="4830262">)</span>&nbsp;<span class="op" id="4830264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830267"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830270">.</span><span class="ident" id="4830271">Lock</span><span class="op" id="4830275">(</span><span class="op" id="4830276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830279">defer</span>&nbsp;<span class="ident" id="4830285"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830288">.</span><span class="ident" id="4830289">Unlock</span><span class="op" id="4830295">(</span><span class="op" id="4830296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830300">if</span>&nbsp;<span class="op" id="4830303">!</span><span class="ident" id="4830304"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830307">.</span><span class="ident" id="4830308">profiling</span>&nbsp;<span class="op" id="4830318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830333"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830336">.</span><span class="ident" id="4830337">profiling</span>&nbsp;<span class="op" id="4830347">=</span>&nbsp;<span class="builtintype" id="4830349">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830356"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830363">.</span><span class="ident" id="4830364">SetCPUProfileRate</span><span class="op" id="4830381">(</span><span class="num" id="4830382">0</span><span class="op" id="4830383">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4830386">&lt;-</span><span class="ident" id="4830388"><a href="/runtime/pprof/pprof.go.html#4828835">cpu</a></span><span class="op" id="4830391">.</span><span class="ident" id="4830392">done</span><br>
<span class="lineno"></span><span class="op" id="4830397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4830400">type</span>&nbsp;<span class="ident" id="4830405">byCycles</span>&nbsp;<span class="op" id="4830414">[</span><span class="op" id="4830415">]</span><span class="ident" id="4830416"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830423">.</span><span class="ident" id="4830424">BlockProfileRecord</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="keyword" id="4830444">func</span>&nbsp;<span class="op" id="4830449">(</span><span class="ident" id="4830450">x</span>&nbsp;<span class="ident" id="4830452"><a href="/runtime/pprof/pprof.go.html#4830405">byCycles</a></span><span class="op" id="4830460">)</span>&nbsp;<span class="ident" id="4830462">Len</span><span class="op" id="4830465">(</span><span class="op" id="4830466">)</span>&nbsp;<span class="builtintype" id="4830468">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4830482">{</span>&nbsp;<span class="keyword" id="4830484">return</span>&nbsp;<span class="builtinfunc" id="4830491">len</span><span class="op" id="4830494">(</span><span class="ident" id="4830495"><a href="/runtime/pprof/pprof.go.html#4830450">x</a></span><span class="op" id="4830496">)</span>&nbsp;<span class="op" id="4830498">}</span><br>
<span class="lineno"></span><span class="keyword" id="4830500">func</span>&nbsp;<span class="op" id="4830505">(</span><span class="ident" id="4830506">x</span>&nbsp;<span class="ident" id="4830508"><a href="/runtime/pprof/pprof.go.html#4830405">byCycles</a></span><span class="op" id="4830516">)</span>&nbsp;<span class="ident" id="4830518">Swap</span><span class="op" id="4830522">(</span><span class="ident" id="4830523">i</span><span class="op" id="4830524">,</span>&nbsp;<span class="ident" id="4830526">j</span>&nbsp;<span class="builtintype" id="4830528">int</span><span class="op" id="4830531">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4830538">{</span>&nbsp;<span class="ident" id="4830540"><a href="/runtime/pprof/pprof.go.html#4830506">x</a></span><span class="op" id="4830541">[</span><span class="ident" id="4830542"><a href="/runtime/pprof/pprof.go.html#4830523">i</a></span><span class="op" id="4830543">]</span><span class="op" id="4830544">,</span>&nbsp;<span class="ident" id="4830546"><a href="/runtime/pprof/pprof.go.html#4830506">x</a></span><span class="op" id="4830547">[</span><span class="ident" id="4830548"><a href="/runtime/pprof/pprof.go.html#4830526">j</a></span><span class="op" id="4830549">]</span>&nbsp;<span class="op" id="4830551">=</span>&nbsp;<span class="ident" id="4830553"><a href="/runtime/pprof/pprof.go.html#4830506">x</a></span><span class="op" id="4830554">[</span><span class="ident" id="4830555"><a href="/runtime/pprof/pprof.go.html#4830526">j</a></span><span class="op" id="4830556">]</span><span class="op" id="4830557">,</span>&nbsp;<span class="ident" id="4830559"><a href="/runtime/pprof/pprof.go.html#4830506">x</a></span><span class="op" id="4830560">[</span><span class="ident" id="4830561"><a href="/runtime/pprof/pprof.go.html#4830523">i</a></span><span class="op" id="4830562">]</span>&nbsp;<span class="op" id="4830564">}</span><br>
<span class="lineno"></span><span class="keyword" id="4830566">func</span>&nbsp;<span class="op" id="4830571">(</span><span class="ident" id="4830572">x</span>&nbsp;<span class="ident" id="4830574"><a href="/runtime/pprof/pprof.go.html#4830405">byCycles</a></span><span class="op" id="4830582">)</span>&nbsp;<span class="ident" id="4830584">Less</span><span class="op" id="4830588">(</span><span class="ident" id="4830589">i</span><span class="op" id="4830590">,</span>&nbsp;<span class="ident" id="4830592">j</span>&nbsp;<span class="builtintype" id="4830594">int</span><span class="op" id="4830597">)</span>&nbsp;<span class="builtintype" id="4830599">bool</span>&nbsp;<span class="op" id="4830604">{</span>&nbsp;<span class="keyword" id="4830606">return</span>&nbsp;<span class="ident" id="4830613"><a href="/runtime/pprof/pprof.go.html#4830572">x</a></span><span class="op" id="4830614">[</span><span class="ident" id="4830615"><a href="/runtime/pprof/pprof.go.html#4830589">i</a></span><span class="op" id="4830616">]</span><span class="op" id="4830617">.</span><span class="ident" id="4830618">Cycles</span>&nbsp;<span class="op" id="4830625">&gt;</span>&nbsp;<span class="ident" id="4830627"><a href="/runtime/pprof/pprof.go.html#4830572">x</a></span><span class="op" id="4830628">[</span><span class="ident" id="4830629"><a href="/runtime/pprof/pprof.go.html#4830592">j</a></span><span class="op" id="4830630">]</span><span class="op" id="4830631">.</span><span class="ident" id="4830632">Cycles</span>&nbsp;<span class="op" id="4830639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4830642">//&nbsp;countBlock&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;records&nbsp;in&nbsp;the&nbsp;blocking&nbsp;profile.</span><br>
<span class="lineno">625</span><span class="keyword" id="4830711">func</span>&nbsp;<span class="ident" id="4830716">countBlock</span><span class="op" id="4830726">(</span><span class="op" id="4830727">)</span>&nbsp;<span class="builtintype" id="4830729">int</span>&nbsp;<span class="op" id="4830733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830736">n</span><span class="op" id="4830737">,</span>&nbsp;<span class="ident" id="4830739">_</span>&nbsp;<span class="op" id="4830741">:=</span>&nbsp;<span class="ident" id="4830744"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830751">.</span><span class="ident" id="4830752">BlockProfile</span><span class="op" id="4830764">(</span><span class="ident" id="4830765">nil</span><span class="op" id="4830768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830771">return</span>&nbsp;<span class="ident" id="4830778"><a href="/runtime/pprof/pprof.go.html#4830736">n</a></span><br>
<span class="lineno"></span><span class="op" id="4830780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="comment" id="4830783">//&nbsp;writeBlock&nbsp;writes&nbsp;the&nbsp;current&nbsp;blocking&nbsp;profile&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4830839">func</span>&nbsp;<span class="ident" id="4830844">writeBlock</span><span class="op" id="4830854">(</span><span class="ident" id="4830855">w</span>&nbsp;<span class="ident" id="4830857"><a href="/runtime/pprof/pprof.go.html#4813402">io</a></span><span class="op" id="4830859">.</span><span class="ident" id="4830860">Writer</span><span class="op" id="4830866">,</span>&nbsp;<span class="ident" id="4830868">debug</span>&nbsp;<span class="builtintype" id="4830874">int</span><span class="op" id="4830877">)</span>&nbsp;<span class="builtintype" id="4830879">error</span>&nbsp;<span class="op" id="4830885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830888">var</span>&nbsp;<span class="ident" id="4830892">p</span>&nbsp;<span class="op" id="4830894">[</span><span class="op" id="4830895">]</span><span class="ident" id="4830896"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830903">.</span><span class="ident" id="4830904">BlockProfileRecord</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830924">n</span><span class="op" id="4830925">,</span>&nbsp;<span class="ident" id="4830927">ok</span>&nbsp;<span class="op" id="4830930">:=</span>&nbsp;<span class="ident" id="4830933"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830940">.</span><span class="ident" id="4830941">BlockProfile</span><span class="op" id="4830953">(</span><span class="ident" id="4830954">nil</span><span class="op" id="4830957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4830960">for</span>&nbsp;<span class="op" id="4830964">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4830968"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span>&nbsp;<span class="op" id="4830970">=</span>&nbsp;<span class="builtinfunc" id="4830972">make</span><span class="op" id="4830976">(</span><span class="op" id="4830977">[</span><span class="op" id="4830978">]</span><span class="ident" id="4830979"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4830986">.</span><span class="ident" id="4830987">BlockProfileRecord</span><span class="op" id="4831005">,</span>&nbsp;<span class="ident" id="4831007"><a href="/runtime/pprof/pprof.go.html#4830924">n</a></span><span class="op" id="4831008">+</span><span class="num" id="4831009">50</span><span class="op" id="4831011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831015"><a href="/runtime/pprof/pprof.go.html#4830924">n</a></span><span class="op" id="4831016">,</span>&nbsp;<span class="ident" id="4831018"><a href="/runtime/pprof/pprof.go.html#4830927">ok</a></span>&nbsp;<span class="op" id="4831021">=</span>&nbsp;<span class="ident" id="4831023"><a href="/runtime/pprof/pprof.go.html#4813408">runtime</a></span><span class="op" id="4831030">.</span><span class="ident" id="4831031">BlockProfile</span><span class="op" id="4831043">(</span><span class="ident" id="4831044"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span><span class="op" id="4831045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831049">if</span>&nbsp;<span class="ident" id="4831052"><a href="/runtime/pprof/pprof.go.html#4830927">ok</a></span>&nbsp;<span class="op" id="4831055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831060"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span>&nbsp;<span class="op" id="4831062">=</span>&nbsp;<span class="ident" id="4831064"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span><span class="op" id="4831065">[</span><span class="op" id="4831066">:</span><span class="ident" id="4831067"><a href="/runtime/pprof/pprof.go.html#4830924">n</a></span><span class="op" id="4831068">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831073">break</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831088"><a href="/runtime/pprof/pprof.go.html#4813419">sort</a></span><span class="op" id="4831092">.</span><span class="ident" id="4831093">Sort</span><span class="op" id="4831097">(</span><span class="ident" id="4831098"><a href="/runtime/pprof/pprof.go.html#4830405">byCycles</a></span><span class="op" id="4831106">(</span><span class="ident" id="4831107"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span><span class="op" id="4831108">)</span><span class="op" id="4831109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831113">b</span>&nbsp;<span class="op" id="4831115">:=</span>&nbsp;<span class="ident" id="4831118"><a href="/runtime/pprof/pprof.go.html#4813377">bufio</a></span><span class="op" id="4831123">.</span><span class="ident" id="4831124">NewWriter</span><span class="op" id="4831133">(</span><span class="ident" id="4831134"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831138">var</span>&nbsp;<span class="ident" id="4831142">tw</span>&nbsp;<span class="op" id="4831145">*</span><span class="ident" id="4831146"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4831155">.</span><span class="ident" id="4831156">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831164"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span>&nbsp;<span class="op" id="4831166">=</span>&nbsp;<span class="ident" id="4831168"><a href="/runtime/pprof/pprof.go.html#4831113">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831171">if</span>&nbsp;<span class="ident" id="4831174"><a href="/runtime/pprof/pprof.go.html#4830868">debug</a></span>&nbsp;<span class="op" id="4831180">&gt;</span>&nbsp;<span class="num" id="4831182">0</span>&nbsp;<span class="op" id="4831184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831188"><a href="/runtime/pprof/pprof.go.html#4831142">tw</a></span>&nbsp;<span class="op" id="4831191">=</span>&nbsp;<span class="ident" id="4831193"><a href="/runtime/pprof/pprof.go.html#4813446">tabwriter</a></span><span class="op" id="4831202">.</span><span class="ident" id="4831203">NewWriter</span><span class="op" id="4831212">(</span><span class="ident" id="4831213"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831214">,</span>&nbsp;<span class="num" id="4831216">1</span><span class="op" id="4831217">,</span>&nbsp;<span class="num" id="4831219">8</span><span class="op" id="4831220">,</span>&nbsp;<span class="num" id="4831222">1</span><span class="op" id="4831223">,</span>&nbsp;<span class="string" id="4831225">&#39;\t&#39;</span><span class="op" id="4831229">,</span>&nbsp;<span class="num" id="4831231">0</span><span class="op" id="4831232">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831236"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span>&nbsp;<span class="op" id="4831238">=</span>&nbsp;<span class="ident" id="4831240"><a href="/runtime/pprof/pprof.go.html#4831142">tw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831248"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4831251">.</span><span class="ident" id="4831252">Fprintf</span><span class="op" id="4831259">(</span><span class="ident" id="4831260"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831261">,</span>&nbsp;<span class="string" id="4831263">&#34;---&nbsp;contention:\n&#34;</span><span class="op" id="4831282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831285"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4831288">.</span><span class="ident" id="4831289">Fprintf</span><span class="op" id="4831296">(</span><span class="ident" id="4831297"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831298">,</span>&nbsp;<span class="string" id="4831300">&#34;cycles/second=%v\n&#34;</span><span class="op" id="4831320">,</span>&nbsp;<span class="ident" id="4831322"><a href="/runtime/pprof/pprof.go.html#4831641">runtime_cyclesPerSecond</a></span><span class="op" id="4831345">(</span><span class="op" id="4831346">)</span><span class="op" id="4831347">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831350">for</span>&nbsp;<span class="ident" id="4831354">i</span>&nbsp;<span class="op" id="4831356">:=</span>&nbsp;<span class="keyword" id="4831359">range</span>&nbsp;<span class="ident" id="4831365"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span>&nbsp;<span class="op" id="4831367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831371">r</span>&nbsp;<span class="op" id="4831373">:=</span>&nbsp;<span class="op" id="4831376">&amp;</span><span class="ident" id="4831377"><a href="/runtime/pprof/pprof.go.html#4830892">p</a></span><span class="op" id="4831378">[</span><span class="ident" id="4831379"><a href="/runtime/pprof/pprof.go.html#4831354">i</a></span><span class="op" id="4831380">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831384"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4831387">.</span><span class="ident" id="4831388">Fprintf</span><span class="op" id="4831395">(</span><span class="ident" id="4831396"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831397">,</span>&nbsp;<span class="string" id="4831399">&#34;%v&nbsp;%v&nbsp;@&#34;</span><span class="op" id="4831408">,</span>&nbsp;<span class="ident" id="4831410"><a href="/runtime/pprof/pprof.go.html#4831371">r</a></span><span class="op" id="4831411">.</span><span class="ident" id="4831412">Cycles</span><span class="op" id="4831418">,</span>&nbsp;<span class="ident" id="4831420"><a href="/runtime/pprof/pprof.go.html#4831371">r</a></span><span class="op" id="4831421">.</span><span class="ident" id="4831422">Count</span><span class="op" id="4831427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831431">for</span>&nbsp;<span class="ident" id="4831435">_</span><span class="op" id="4831436">,</span>&nbsp;<span class="ident" id="4831438">pc</span>&nbsp;<span class="op" id="4831441">:=</span>&nbsp;<span class="keyword" id="4831444">range</span>&nbsp;<span class="ident" id="4831450"><a href="/runtime/pprof/pprof.go.html#4831371">r</a></span><span class="op" id="4831451">.</span><span class="ident" id="4831452">Stack</span><span class="op" id="4831457">(</span><span class="op" id="4831458">)</span>&nbsp;<span class="op" id="4831460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831465"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4831468">.</span><span class="ident" id="4831469">Fprintf</span><span class="op" id="4831476">(</span><span class="ident" id="4831477"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831478">,</span>&nbsp;<span class="string" id="4831480">&#34;&nbsp;%#x&#34;</span><span class="op" id="4831486">,</span>&nbsp;<span class="ident" id="4831488"><a href="/runtime/pprof/pprof.go.html#4831438">pc</a></span><span class="op" id="4831490">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831498"><a href="/runtime/pprof/pprof.go.html#4813395">fmt</a></span><span class="op" id="4831501">.</span><span class="ident" id="4831502">Fprint</span><span class="op" id="4831508">(</span><span class="ident" id="4831509"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831510">,</span>&nbsp;<span class="string" id="4831512">&#34;\n&#34;</span><span class="op" id="4831516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831520">if</span>&nbsp;<span class="ident" id="4831523"><a href="/runtime/pprof/pprof.go.html#4830868">debug</a></span>&nbsp;<span class="op" id="4831529">&gt;</span>&nbsp;<span class="num" id="4831531">0</span>&nbsp;<span class="op" id="4831533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831538"><a href="/runtime/pprof/pprof.go.html#4821642">printStackRecord</a></span><span class="op" id="4831554">(</span><span class="ident" id="4831555"><a href="/runtime/pprof/pprof.go.html#4830855">w</a></span><span class="op" id="4831556">,</span>&nbsp;<span class="ident" id="4831558"><a href="/runtime/pprof/pprof.go.html#4831371">r</a></span><span class="op" id="4831559">.</span><span class="ident" id="4831560">Stack</span><span class="op" id="4831565">(</span><span class="op" id="4831566">)</span><span class="op" id="4831567">,</span>&nbsp;<span class="builtintype" id="4831569">true</span><span class="op" id="4831573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831577">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831584">if</span>&nbsp;<span class="ident" id="4831587"><a href="/runtime/pprof/pprof.go.html#4831142">tw</a></span>&nbsp;<span class="op" id="4831590">!=</span>&nbsp;<span class="ident" id="4831593">nil</span>&nbsp;<span class="op" id="4831597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4831601"><a href="/runtime/pprof/pprof.go.html#4831142">tw</a></span><span class="op" id="4831603">.</span><span class="ident" id="4831604">Flush</span><span class="op" id="4831609">(</span><span class="op" id="4831610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4831613">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4831616">return</span>&nbsp;<span class="ident" id="4831623"><a href="/runtime/pprof/pprof.go.html#4831113">b</a></span><span class="op" id="4831624">.</span><span class="ident" id="4831625">Flush</span><span class="op" id="4831630">(</span><span class="op" id="4831631">)</span><br>
<span class="lineno"></span><span class="op" id="4831633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4831636">func</span>&nbsp;<span class="ident" id="4831641">runtime_cyclesPerSecond</span><span class="op" id="4831664">(</span><span class="op" id="4831665">)</span>&nbsp;<span class="ident" id="4831667">int64</span>
</div>
</body>
</html>
