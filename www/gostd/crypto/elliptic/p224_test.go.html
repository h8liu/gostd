<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6422139">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6422195">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6422249">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6422300">package</span>&nbsp;<span class="ident" id="6422308">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422318">import</span>&nbsp;<span class="op" id="6422325">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422328">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422340">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6422350">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422353">var</span>&nbsp;<span class="ident" id="6422357">toFromBigTests</span>&nbsp;<span class="op" id="6422372">=</span>&nbsp;<span class="op" id="6422374">[</span><span class="op" id="6422375">]</span><span class="builtintype" id="6422376">string</span><span class="op" id="6422382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422385">&#34;0&#34;</span><span class="op" id="6422388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422391">&#34;1&#34;</span><span class="op" id="6422394">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422397">&#34;23&#34;</span><span class="op" id="6422401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422404">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6422462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6422465">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6422523">,</span><br>
<span class="lineno"></span><span class="op" id="6422525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6422528">func</span>&nbsp;<span class="ident" id="6422533">p224AlternativeToBig</span><span class="op" id="6422553">(</span><span class="ident" id="6422554">in</span>&nbsp;<span class="op" id="6422557">*</span><span class="ident" id="6422558">p224FieldElement</span><span class="op" id="6422574">)</span>&nbsp;<span class="op" id="6422576">*</span><span class="ident" id="6422577">big</span><span class="op" id="6422580">.</span><span class="ident" id="6422581">Int</span>&nbsp;<span class="op" id="6422585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422588">ret</span>&nbsp;<span class="op" id="6422592">:=</span>&nbsp;<span class="builtinfunc" id="6422595">new</span><span class="op" id="6422598">(</span><span class="ident" id="6422599">big</span><span class="op" id="6422602">.</span><span class="ident" id="6422603">Int</span><span class="op" id="6422606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422609">tmp</span>&nbsp;<span class="op" id="6422613">:=</span>&nbsp;<span class="builtinfunc" id="6422616">new</span><span class="op" id="6422619">(</span><span class="ident" id="6422620">big</span><span class="op" id="6422623">.</span><span class="ident" id="6422624">Int</span><span class="op" id="6422627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422631">for</span>&nbsp;<span class="ident" id="6422635">i</span>&nbsp;<span class="op" id="6422637">:=</span>&nbsp;<span class="builtintype" id="6422640">uint</span><span class="op" id="6422644">(</span><span class="num" id="6422645">0</span><span class="op" id="6422646">)</span><span class="op" id="6422647">;</span>&nbsp;<span class="ident" id="6422649">i</span>&nbsp;<span class="op" id="6422651">&lt;</span>&nbsp;<span class="num" id="6422653">8</span><span class="op" id="6422654">;</span>&nbsp;<span class="ident" id="6422656">i</span><span class="op" id="6422657">++</span>&nbsp;<span class="op" id="6422660">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422664">tmp</span><span class="op" id="6422667">.</span><span class="ident" id="6422668">SetInt64</span><span class="op" id="6422676">(</span><span class="ident" id="6422677">int64</span><span class="op" id="6422682">(</span><span class="ident" id="6422683">in</span><span class="op" id="6422685">[</span><span class="ident" id="6422686">i</span><span class="op" id="6422687">]</span><span class="op" id="6422688">)</span><span class="op" id="6422689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422693">tmp</span><span class="op" id="6422696">.</span><span class="ident" id="6422697">Lsh</span><span class="op" id="6422700">(</span><span class="ident" id="6422701">tmp</span><span class="op" id="6422704">,</span>&nbsp;<span class="num" id="6422706">28</span><span class="op" id="6422708">*</span><span class="ident" id="6422709">i</span><span class="op" id="6422710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422714">ret</span><span class="op" id="6422717">.</span><span class="ident" id="6422718">Add</span><span class="op" id="6422721">(</span><span class="ident" id="6422722">ret</span><span class="op" id="6422725">,</span>&nbsp;<span class="ident" id="6422727">tmp</span><span class="op" id="6422730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422736">ret</span><span class="op" id="6422739">.</span><span class="ident" id="6422740">Mod</span><span class="op" id="6422743">(</span><span class="ident" id="6422744">ret</span><span class="op" id="6422747">,</span>&nbsp;<span class="ident" id="6422749">p224</span><span class="op" id="6422753">.</span><span class="ident" id="6422754">P</span><span class="op" id="6422755">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422758">return</span>&nbsp;<span class="ident" id="6422765">ret</span><br>
<span class="lineno"></span><span class="op" id="6422769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6422772">func</span>&nbsp;<span class="ident" id="6422777">TestToFromBig</span><span class="op" id="6422790">(</span><span class="ident" id="6422791">t</span>&nbsp;<span class="op" id="6422793">*</span><span class="ident" id="6422794">testing</span><span class="op" id="6422801">.</span><span class="ident" id="6422802">T</span><span class="op" id="6422803">)</span>&nbsp;<span class="op" id="6422805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422808">for</span>&nbsp;<span class="ident" id="6422812">i</span><span class="op" id="6422813">,</span>&nbsp;<span class="ident" id="6422815">test</span>&nbsp;<span class="op" id="6422820">:=</span>&nbsp;<span class="keyword" id="6422823">range</span>&nbsp;<span class="ident" id="6422829">toFromBigTests</span>&nbsp;<span class="op" id="6422844">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422848">n</span><span class="op" id="6422849">,</span>&nbsp;<span class="ident" id="6422851">_</span>&nbsp;<span class="op" id="6422853">:=</span>&nbsp;<span class="builtinfunc" id="6422856">new</span><span class="op" id="6422859">(</span><span class="ident" id="6422860">big</span><span class="op" id="6422863">.</span><span class="ident" id="6422864">Int</span><span class="op" id="6422867">)</span><span class="op" id="6422868">.</span><span class="ident" id="6422869">SetString</span><span class="op" id="6422878">(</span><span class="ident" id="6422879">test</span><span class="op" id="6422883">,</span>&nbsp;<span class="num" id="6422885">16</span><span class="op" id="6422887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422891">var</span>&nbsp;<span class="ident" id="6422895">x</span>&nbsp;<span class="ident" id="6422897">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422916">p224FromBig</span><span class="op" id="6422927">(</span><span class="op" id="6422928">&amp;</span><span class="ident" id="6422929">x</span><span class="op" id="6422930">,</span>&nbsp;<span class="ident" id="6422932">n</span><span class="op" id="6422933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422937">m</span>&nbsp;<span class="op" id="6422939">:=</span>&nbsp;<span class="ident" id="6422942">p224ToBig</span><span class="op" id="6422951">(</span><span class="op" id="6422952">&amp;</span><span class="ident" id="6422953">x</span><span class="op" id="6422954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422958">if</span>&nbsp;<span class="ident" id="6422961">n</span><span class="op" id="6422962">.</span><span class="ident" id="6422963">Cmp</span><span class="op" id="6422966">(</span><span class="ident" id="6422967">m</span><span class="op" id="6422968">)</span>&nbsp;<span class="op" id="6422970">!=</span>&nbsp;<span class="num" id="6422973">0</span>&nbsp;<span class="op" id="6422975">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422980">t</span><span class="op" id="6422981">.</span><span class="ident" id="6422982">Errorf</span><span class="op" id="6422988">(</span><span class="string" id="6422989">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6423004">,</span>&nbsp;<span class="ident" id="6423006">i</span><span class="op" id="6423007">,</span>&nbsp;<span class="ident" id="6423009">n</span><span class="op" id="6423010">,</span>&nbsp;<span class="ident" id="6423012">m</span><span class="op" id="6423013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423021">q</span>&nbsp;<span class="op" id="6423023">:=</span>&nbsp;<span class="ident" id="6423026">p224AlternativeToBig</span><span class="op" id="6423046">(</span><span class="op" id="6423047">&amp;</span><span class="ident" id="6423048">x</span><span class="op" id="6423049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423053">if</span>&nbsp;<span class="ident" id="6423056">n</span><span class="op" id="6423057">.</span><span class="ident" id="6423058">Cmp</span><span class="op" id="6423061">(</span><span class="ident" id="6423062">q</span><span class="op" id="6423063">)</span>&nbsp;<span class="op" id="6423065">!=</span>&nbsp;<span class="num" id="6423068">0</span>&nbsp;<span class="op" id="6423070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423075">t</span><span class="op" id="6423076">.</span><span class="ident" id="6423077">Errorf</span><span class="op" id="6423083">(</span><span class="string" id="6423084">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6423113">,</span>&nbsp;<span class="ident" id="6423115">i</span><span class="op" id="6423116">,</span>&nbsp;<span class="ident" id="6423118">n</span><span class="op" id="6423119">,</span>&nbsp;<span class="ident" id="6423121">m</span><span class="op" id="6423122">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423129">}</span><br>
<span class="lineno"></span><span class="op" id="6423131">}</span>
</div>
</body>
</html>
