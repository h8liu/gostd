<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2966609">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2966664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2966718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2966769">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="2966844">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2966918">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="2966934">package</span>&nbsp;<span class="ident" id="2966942">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2966949">import</span>&nbsp;<span class="op" id="2966956">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2966959">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2966967">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="2966974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="2966977">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2967020">const</span>&nbsp;<span class="ident" id="2967026">Size</span>&nbsp;<span class="op" id="2967031">=</span>&nbsp;<span class="num" id="2967033">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2967036">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="2967063">const</span>&nbsp;<span class="op" id="2967069">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967072">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967135">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967202">IEEE</span>&nbsp;<span class="op" id="2967207">=</span>&nbsp;<span class="num" id="2967209">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967222">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967266">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967324">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967364">Castagnoli</span>&nbsp;<span class="op" id="2967375">=</span>&nbsp;<span class="num" id="2967377">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967390">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967416">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2967479">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967526">Koopman</span>&nbsp;<span class="op" id="2967534">=</span>&nbsp;<span class="num" id="2967536">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="2967547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="2967550">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="2967633">type</span>&nbsp;<span class="ident" id="2967638">Table</span>&nbsp;<span class="op" id="2967644">[</span><span class="num" id="2967645">256</span><span class="op" id="2967648">]</span><span class="builtintype" id="2967649">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2967657">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="2967732">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="2967808">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2967884">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="2967910">var</span>&nbsp;<span class="ident" id="2967914">castagnoliTable</span>&nbsp;<span class="op" id="2967930">*</span><span class="ident" id="2967931">Table</span><br>
<span class="lineno"></span><span class="keyword" id="2967937">var</span>&nbsp;<span class="ident" id="2967941">castagnoliOnce</span>&nbsp;<span class="ident" id="2967956">sync</span><span class="op" id="2967960">.</span><span class="ident" id="2967961">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="2967967">func</span>&nbsp;<span class="ident" id="2967972">castagnoliInit</span><span class="op" id="2967986">(</span><span class="op" id="2967987">)</span>&nbsp;<span class="op" id="2967989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967992">castagnoliTable</span>&nbsp;<span class="op" id="2968008">=</span>&nbsp;<span class="ident" id="2968010">makeTable</span><span class="op" id="2968019">(</span><span class="ident" id="2968020">Castagnoli</span><span class="op" id="2968030">)</span><br>
<span class="lineno"></span><span class="op" id="2968032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968035">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="2968086">var</span>&nbsp;<span class="ident" id="2968090">IEEETable</span>&nbsp;<span class="op" id="2968100">=</span>&nbsp;<span class="ident" id="2968102">makeTable</span><span class="op" id="2968111">(</span><span class="ident" id="2968112">IEEE</span><span class="op" id="2968116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968119">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="2968193">func</span>&nbsp;<span class="ident" id="2968198">MakeTable</span><span class="op" id="2968207">(</span><span class="ident" id="2968208">poly</span>&nbsp;<span class="builtintype" id="2968213">uint32</span><span class="op" id="2968219">)</span>&nbsp;<span class="op" id="2968221">*</span><span class="ident" id="2968222">Table</span>&nbsp;<span class="op" id="2968228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968231">switch</span>&nbsp;<span class="ident" id="2968238">poly</span>&nbsp;<span class="op" id="2968243">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968246">case</span>&nbsp;<span class="ident" id="2968251">IEEE</span><span class="op" id="2968255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968259">return</span>&nbsp;<span class="ident" id="2968266">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968277">case</span>&nbsp;<span class="ident" id="2968282">Castagnoli</span><span class="op" id="2968292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968296">castagnoliOnce</span><span class="op" id="2968310">.</span><span class="ident" id="2968311">Do</span><span class="op" id="2968313">(</span><span class="ident" id="2968314">castagnoliInit</span><span class="op" id="2968328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968332">return</span>&nbsp;<span class="ident" id="2968339">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968359">return</span>&nbsp;<span class="ident" id="2968366">makeTable</span><span class="op" id="2968375">(</span><span class="ident" id="2968376">poly</span><span class="op" id="2968380">)</span><br>
<span class="lineno"></span><span class="op" id="2968382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968385">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="2968459">func</span>&nbsp;<span class="ident" id="2968464">makeTable</span><span class="op" id="2968473">(</span><span class="ident" id="2968474">poly</span>&nbsp;<span class="builtintype" id="2968479">uint32</span><span class="op" id="2968485">)</span>&nbsp;<span class="op" id="2968487">*</span><span class="ident" id="2968488">Table</span>&nbsp;<span class="op" id="2968494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968497">t</span>&nbsp;<span class="op" id="2968499">:=</span>&nbsp;<span class="builtinfunc" id="2968502">new</span><span class="op" id="2968505">(</span><span class="ident" id="2968506">Table</span><span class="op" id="2968511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968514">for</span>&nbsp;<span class="ident" id="2968518">i</span>&nbsp;<span class="op" id="2968520">:=</span>&nbsp;<span class="num" id="2968523">0</span><span class="op" id="2968524">;</span>&nbsp;<span class="ident" id="2968526">i</span>&nbsp;<span class="op" id="2968528">&lt;</span>&nbsp;<span class="num" id="2968530">256</span><span class="op" id="2968533">;</span>&nbsp;<span class="ident" id="2968535">i</span><span class="op" id="2968536">++</span>&nbsp;<span class="op" id="2968539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968543">crc</span>&nbsp;<span class="op" id="2968547">:=</span>&nbsp;<span class="builtintype" id="2968550">uint32</span><span class="op" id="2968556">(</span><span class="ident" id="2968557">i</span><span class="op" id="2968558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968562">for</span>&nbsp;<span class="ident" id="2968566">j</span>&nbsp;<span class="op" id="2968568">:=</span>&nbsp;<span class="num" id="2968571">0</span><span class="op" id="2968572">;</span>&nbsp;<span class="ident" id="2968574">j</span>&nbsp;<span class="op" id="2968576">&lt;</span>&nbsp;<span class="num" id="2968578">8</span><span class="op" id="2968579">;</span>&nbsp;<span class="ident" id="2968581">j</span><span class="op" id="2968582">++</span>&nbsp;<span class="op" id="2968585">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968590">if</span>&nbsp;<span class="ident" id="2968593">crc</span><span class="op" id="2968596">&amp;</span><span class="num" id="2968597">1</span>&nbsp;<span class="op" id="2968599">==</span>&nbsp;<span class="num" id="2968602">1</span>&nbsp;<span class="op" id="2968604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968610">crc</span>&nbsp;<span class="op" id="2968614">=</span>&nbsp;<span class="op" id="2968616">(</span><span class="ident" id="2968617">crc</span>&nbsp;<span class="op" id="2968621">&gt;&gt;</span>&nbsp;<span class="num" id="2968624">1</span><span class="op" id="2968625">)</span>&nbsp;<span class="op" id="2968627">^</span>&nbsp;<span class="ident" id="2968629">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968637">}</span>&nbsp;<span class="keyword" id="2968639">else</span>&nbsp;<span class="op" id="2968644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968650">crc</span>&nbsp;<span class="op" id="2968654">&gt;&gt;=</span>&nbsp;<span class="num" id="2968658">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968663">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968671">t</span><span class="op" id="2968672">[</span><span class="ident" id="2968673">i</span><span class="op" id="2968674">]</span>&nbsp;<span class="op" id="2968676">=</span>&nbsp;<span class="ident" id="2968678">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968686">return</span>&nbsp;<span class="ident" id="2968693">t</span><br>
<span class="lineno"></span><span class="op" id="2968695">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2968698">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="2968757">type</span>&nbsp;<span class="ident" id="2968762">digest</span>&nbsp;<span class="keyword" id="2968769">struct</span>&nbsp;<span class="op" id="2968776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968779">crc</span>&nbsp;<span class="builtintype" id="2968783">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968791">tab</span>&nbsp;<span class="op" id="2968795">*</span><span class="ident" id="2968796">Table</span><br>
<span class="lineno">85</span><span class="op" id="2968802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968805">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="2968868">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="2968918">func</span>&nbsp;<span class="ident" id="2968923">New</span><span class="op" id="2968926">(</span><span class="ident" id="2968927">tab</span>&nbsp;<span class="op" id="2968931">*</span><span class="ident" id="2968932">Table</span><span class="op" id="2968937">)</span>&nbsp;<span class="ident" id="2968939">hash</span><span class="op" id="2968943">.</span><span class="ident" id="2968944">Hash32</span>&nbsp;<span class="op" id="2968951">{</span>&nbsp;<span class="keyword" id="2968953">return</span>&nbsp;<span class="op" id="2968960">&amp;</span><span class="ident" id="2968961">digest</span><span class="op" id="2968967">{</span><span class="num" id="2968968">0</span><span class="op" id="2968969">,</span>&nbsp;<span class="ident" id="2968971">tab</span><span class="op" id="2968974">}</span>&nbsp;<span class="op" id="2968976">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="2968979">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="2969046">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="2969076">func</span>&nbsp;<span class="ident" id="2969081">NewIEEE</span><span class="op" id="2969088">(</span><span class="op" id="2969089">)</span>&nbsp;<span class="ident" id="2969091">hash</span><span class="op" id="2969095">.</span><span class="ident" id="2969096">Hash32</span>&nbsp;<span class="op" id="2969103">{</span>&nbsp;<span class="keyword" id="2969105">return</span>&nbsp;<span class="ident" id="2969112">New</span><span class="op" id="2969115">(</span><span class="ident" id="2969116">IEEETable</span><span class="op" id="2969125">)</span>&nbsp;<span class="op" id="2969127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="2969130">func</span>&nbsp;<span class="op" id="2969135">(</span><span class="ident" id="2969136">d</span>&nbsp;<span class="op" id="2969138">*</span><span class="ident" id="2969139">digest</span><span class="op" id="2969145">)</span>&nbsp;<span class="ident" id="2969147">Size</span><span class="op" id="2969151">(</span><span class="op" id="2969152">)</span>&nbsp;<span class="builtintype" id="2969154">int</span>&nbsp;<span class="op" id="2969158">{</span>&nbsp;<span class="keyword" id="2969160">return</span>&nbsp;<span class="ident" id="2969167">Size</span>&nbsp;<span class="op" id="2969172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969175">func</span>&nbsp;<span class="op" id="2969180">(</span><span class="ident" id="2969181">d</span>&nbsp;<span class="op" id="2969183">*</span><span class="ident" id="2969184">digest</span><span class="op" id="2969190">)</span>&nbsp;<span class="ident" id="2969192">BlockSize</span><span class="op" id="2969201">(</span><span class="op" id="2969202">)</span>&nbsp;<span class="builtintype" id="2969204">int</span>&nbsp;<span class="op" id="2969208">{</span>&nbsp;<span class="keyword" id="2969210">return</span>&nbsp;<span class="num" id="2969217">1</span>&nbsp;<span class="op" id="2969219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969222">func</span>&nbsp;<span class="op" id="2969227">(</span><span class="ident" id="2969228">d</span>&nbsp;<span class="op" id="2969230">*</span><span class="ident" id="2969231">digest</span><span class="op" id="2969237">)</span>&nbsp;<span class="ident" id="2969239">Reset</span><span class="op" id="2969244">(</span><span class="op" id="2969245">)</span>&nbsp;<span class="op" id="2969247">{</span>&nbsp;<span class="ident" id="2969249">d</span><span class="op" id="2969250">.</span><span class="ident" id="2969251">crc</span>&nbsp;<span class="op" id="2969255">=</span>&nbsp;<span class="num" id="2969257">0</span>&nbsp;<span class="op" id="2969259">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="2969262">func</span>&nbsp;<span class="ident" id="2969267">update</span><span class="op" id="2969273">(</span><span class="ident" id="2969274">crc</span>&nbsp;<span class="builtintype" id="2969278">uint32</span><span class="op" id="2969284">,</span>&nbsp;<span class="ident" id="2969286">tab</span>&nbsp;<span class="op" id="2969290">*</span><span class="ident" id="2969291">Table</span><span class="op" id="2969296">,</span>&nbsp;<span class="ident" id="2969298">p</span>&nbsp;<span class="op" id="2969300">[</span><span class="op" id="2969301">]</span><span class="builtintype" id="2969302">byte</span><span class="op" id="2969306">)</span>&nbsp;<span class="builtintype" id="2969308">uint32</span>&nbsp;<span class="op" id="2969315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969318">crc</span>&nbsp;<span class="op" id="2969322">=</span>&nbsp;<span class="op" id="2969324">^</span><span class="ident" id="2969325">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969330">for</span>&nbsp;<span class="ident" id="2969334">_</span><span class="op" id="2969335">,</span>&nbsp;<span class="ident" id="2969337">v</span>&nbsp;<span class="op" id="2969339">:=</span>&nbsp;<span class="keyword" id="2969342">range</span>&nbsp;<span class="ident" id="2969348">p</span>&nbsp;<span class="op" id="2969350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969354">crc</span>&nbsp;<span class="op" id="2969358">=</span>&nbsp;<span class="ident" id="2969360">tab</span><span class="op" id="2969363">[</span><span class="builtintype" id="2969364">byte</span><span class="op" id="2969368">(</span><span class="ident" id="2969369">crc</span><span class="op" id="2969372">)</span><span class="op" id="2969373">^</span><span class="ident" id="2969374">v</span><span class="op" id="2969375">]</span>&nbsp;<span class="op" id="2969377">^</span>&nbsp;<span class="op" id="2969379">(</span><span class="ident" id="2969380">crc</span>&nbsp;<span class="op" id="2969384">&gt;&gt;</span>&nbsp;<span class="num" id="2969387">8</span><span class="op" id="2969388">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2969391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969394">return</span>&nbsp;<span class="op" id="2969401">^</span><span class="ident" id="2969402">crc</span><br>
<span class="lineno"></span><span class="op" id="2969406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2969409">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="2969475">func</span>&nbsp;<span class="ident" id="2969480">Update</span><span class="op" id="2969486">(</span><span class="ident" id="2969487">crc</span>&nbsp;<span class="builtintype" id="2969491">uint32</span><span class="op" id="2969497">,</span>&nbsp;<span class="ident" id="2969499">tab</span>&nbsp;<span class="op" id="2969503">*</span><span class="ident" id="2969504">Table</span><span class="op" id="2969509">,</span>&nbsp;<span class="ident" id="2969511">p</span>&nbsp;<span class="op" id="2969513">[</span><span class="op" id="2969514">]</span><span class="builtintype" id="2969515">byte</span><span class="op" id="2969519">)</span>&nbsp;<span class="builtintype" id="2969521">uint32</span>&nbsp;<span class="op" id="2969528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969531">if</span>&nbsp;<span class="ident" id="2969534">tab</span>&nbsp;<span class="op" id="2969538">==</span>&nbsp;<span class="ident" id="2969541">castagnoliTable</span>&nbsp;<span class="op" id="2969557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969561">return</span>&nbsp;<span class="ident" id="2969568">updateCastagnoli</span><span class="op" id="2969584">(</span><span class="ident" id="2969585">crc</span><span class="op" id="2969588">,</span>&nbsp;<span class="ident" id="2969590">p</span><span class="op" id="2969591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2969594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969597">return</span>&nbsp;<span class="ident" id="2969604">update</span><span class="op" id="2969610">(</span><span class="ident" id="2969611">crc</span><span class="op" id="2969614">,</span>&nbsp;<span class="ident" id="2969616">tab</span><span class="op" id="2969619">,</span>&nbsp;<span class="ident" id="2969621">p</span><span class="op" id="2969622">)</span><br>
<span class="lineno">115</span><span class="op" id="2969624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969627">func</span>&nbsp;<span class="op" id="2969632">(</span><span class="ident" id="2969633">d</span>&nbsp;<span class="op" id="2969635">*</span><span class="ident" id="2969636">digest</span><span class="op" id="2969642">)</span>&nbsp;<span class="ident" id="2969644">Write</span><span class="op" id="2969649">(</span><span class="ident" id="2969650">p</span>&nbsp;<span class="op" id="2969652">[</span><span class="op" id="2969653">]</span><span class="builtintype" id="2969654">byte</span><span class="op" id="2969658">)</span>&nbsp;<span class="op" id="2969660">(</span><span class="ident" id="2969661">n</span>&nbsp;<span class="builtintype" id="2969663">int</span><span class="op" id="2969666">,</span>&nbsp;<span class="ident" id="2969668">err</span>&nbsp;<span class="builtintype" id="2969672">error</span><span class="op" id="2969677">)</span>&nbsp;<span class="op" id="2969679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969682">d</span><span class="op" id="2969683">.</span><span class="ident" id="2969684">crc</span>&nbsp;<span class="op" id="2969688">=</span>&nbsp;<span class="ident" id="2969690">Update</span><span class="op" id="2969696">(</span><span class="ident" id="2969697">d</span><span class="op" id="2969698">.</span><span class="ident" id="2969699">crc</span><span class="op" id="2969702">,</span>&nbsp;<span class="ident" id="2969704">d</span><span class="op" id="2969705">.</span><span class="ident" id="2969706">tab</span><span class="op" id="2969709">,</span>&nbsp;<span class="ident" id="2969711">p</span><span class="op" id="2969712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969715">return</span>&nbsp;<span class="builtinfunc" id="2969722">len</span><span class="op" id="2969725">(</span><span class="ident" id="2969726">p</span><span class="op" id="2969727">)</span><span class="op" id="2969728">,</span>&nbsp;<span class="ident" id="2969730">nil</span><br>
<span class="lineno">120</span><span class="op" id="2969734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969737">func</span>&nbsp;<span class="op" id="2969742">(</span><span class="ident" id="2969743">d</span>&nbsp;<span class="op" id="2969745">*</span><span class="ident" id="2969746">digest</span><span class="op" id="2969752">)</span>&nbsp;<span class="ident" id="2969754">Sum32</span><span class="op" id="2969759">(</span><span class="op" id="2969760">)</span>&nbsp;<span class="builtintype" id="2969762">uint32</span>&nbsp;<span class="op" id="2969769">{</span>&nbsp;<span class="keyword" id="2969771">return</span>&nbsp;<span class="ident" id="2969778">d</span><span class="op" id="2969779">.</span><span class="ident" id="2969780">crc</span>&nbsp;<span class="op" id="2969784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969787">func</span>&nbsp;<span class="op" id="2969792">(</span><span class="ident" id="2969793">d</span>&nbsp;<span class="op" id="2969795">*</span><span class="ident" id="2969796">digest</span><span class="op" id="2969802">)</span>&nbsp;<span class="ident" id="2969804">Sum</span><span class="op" id="2969807">(</span><span class="ident" id="2969808">in</span>&nbsp;<span class="op" id="2969811">[</span><span class="op" id="2969812">]</span><span class="builtintype" id="2969813">byte</span><span class="op" id="2969817">)</span>&nbsp;<span class="op" id="2969819">[</span><span class="op" id="2969820">]</span><span class="builtintype" id="2969821">byte</span>&nbsp;<span class="op" id="2969826">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969829">s</span>&nbsp;<span class="op" id="2969831">:=</span>&nbsp;<span class="ident" id="2969834">d</span><span class="op" id="2969835">.</span><span class="ident" id="2969836">Sum32</span><span class="op" id="2969841">(</span><span class="op" id="2969842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969845">return</span>&nbsp;<span class="builtinfunc" id="2969852">append</span><span class="op" id="2969858">(</span><span class="ident" id="2969859">in</span><span class="op" id="2969861">,</span>&nbsp;<span class="builtintype" id="2969863">byte</span><span class="op" id="2969867">(</span><span class="ident" id="2969868">s</span><span class="op" id="2969869">&gt;&gt;</span><span class="num" id="2969871">24</span><span class="op" id="2969873">)</span><span class="op" id="2969874">,</span>&nbsp;<span class="builtintype" id="2969876">byte</span><span class="op" id="2969880">(</span><span class="ident" id="2969881">s</span><span class="op" id="2969882">&gt;&gt;</span><span class="num" id="2969884">16</span><span class="op" id="2969886">)</span><span class="op" id="2969887">,</span>&nbsp;<span class="builtintype" id="2969889">byte</span><span class="op" id="2969893">(</span><span class="ident" id="2969894">s</span><span class="op" id="2969895">&gt;&gt;</span><span class="num" id="2969897">8</span><span class="op" id="2969898">)</span><span class="op" id="2969899">,</span>&nbsp;<span class="builtintype" id="2969901">byte</span><span class="op" id="2969905">(</span><span class="ident" id="2969906">s</span><span class="op" id="2969907">)</span><span class="op" id="2969908">)</span><br>
<span class="lineno"></span><span class="op" id="2969910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2969913">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="2969961">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="2970011">func</span>&nbsp;<span class="ident" id="2970016">Checksum</span><span class="op" id="2970024">(</span><span class="ident" id="2970025">data</span>&nbsp;<span class="op" id="2970030">[</span><span class="op" id="2970031">]</span><span class="builtintype" id="2970032">byte</span><span class="op" id="2970036">,</span>&nbsp;<span class="ident" id="2970038">tab</span>&nbsp;<span class="op" id="2970042">*</span><span class="ident" id="2970043">Table</span><span class="op" id="2970048">)</span>&nbsp;<span class="builtintype" id="2970050">uint32</span>&nbsp;<span class="op" id="2970057">{</span>&nbsp;<span class="keyword" id="2970059">return</span>&nbsp;<span class="ident" id="2970066">Update</span><span class="op" id="2970072">(</span><span class="num" id="2970073">0</span><span class="op" id="2970074">,</span>&nbsp;<span class="ident" id="2970076">tab</span><span class="op" id="2970079">,</span>&nbsp;<span class="ident" id="2970081">data</span><span class="op" id="2970085">)</span>&nbsp;<span class="op" id="2970087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2970090">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="2970142">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="2970172">func</span>&nbsp;<span class="ident" id="2970177">ChecksumIEEE</span><span class="op" id="2970189">(</span><span class="ident" id="2970190">data</span>&nbsp;<span class="op" id="2970195">[</span><span class="op" id="2970196">]</span><span class="builtintype" id="2970197">byte</span><span class="op" id="2970201">)</span>&nbsp;<span class="builtintype" id="2970203">uint32</span>&nbsp;<span class="op" id="2970210">{</span>&nbsp;<span class="keyword" id="2970212">return</span>&nbsp;<span class="ident" id="2970219">update</span><span class="op" id="2970225">(</span><span class="num" id="2970226">0</span><span class="op" id="2970227">,</span>&nbsp;<span class="ident" id="2970229">IEEETable</span><span class="op" id="2970238">,</span>&nbsp;<span class="ident" id="2970240">data</span><span class="op" id="2970244">)</span>&nbsp;<span class="op" id="2970246">}</span>
</div>
</body>
</html>
