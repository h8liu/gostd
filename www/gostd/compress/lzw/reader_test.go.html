<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/lzw</h2>
<ul>
<li><a href="/gostd/compress/lzw/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/lzw/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/lzw/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/lzw/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7578025">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7578080">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7578134">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7578185">package</span>&nbsp;<span class="ident" id="7578193">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7578198">import</span>&nbsp;<span class="op" id="7578205">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578208">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578217">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578223">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578236">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578247">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578258">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578269">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7578279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7578282">type</span>&nbsp;<span class="ident" id="7578287">lzwTest</span>&nbsp;<span class="keyword" id="7578295">struct</span>&nbsp;<span class="op" id="7578302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578305">desc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7578316">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578324">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7578335">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578343">compressed</span>&nbsp;<span class="builtintype" id="7578354">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578362">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7578373">error</span><br>
<span class="lineno"></span><span class="op" id="7578379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7578382">var</span>&nbsp;<span class="ident" id="7578386">lzwTests</span>&nbsp;<span class="op" id="7578395">=</span>&nbsp;<span class="op" id="7578397">[</span><span class="op" id="7578398">]</span><span class="ident" id="7578399">lzwTest</span><span class="op" id="7578406">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578413">&#34;empty;LSB;8&#34;</span><span class="op" id="7578426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578430">&#34;&#34;</span><span class="op" id="7578432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578436">&#34;\x01\x01&#34;</span><span class="op" id="7578446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578450">nil</span><span class="op" id="7578453">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578456">}</span><span class="op" id="7578457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578464">&#34;empty;MSB;8&#34;</span><span class="op" id="7578477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578481">&#34;&#34;</span><span class="op" id="7578483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578487">&#34;\x80\x80&#34;</span><span class="op" id="7578497">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578501">nil</span><span class="op" id="7578504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578507">}</span><span class="op" id="7578508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578515">&#34;tobe;LSB;7&#34;</span><span class="op" id="7578527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578531">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7578557">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578561">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="7578631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578635">nil</span><span class="op" id="7578638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578641">}</span><span class="op" id="7578642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578649">&#34;tobe;LSB;8&#34;</span><span class="op" id="7578661">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578665">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7578691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578695">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04\x12\x34\xb8\xb0\xe0\xc1\x84\x01\x01&#34;</span><span class="op" id="7578777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578781">nil</span><span class="op" id="7578784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578787">}</span><span class="op" id="7578788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578791">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578795">&#34;tobe;MSB;7&#34;</span><span class="op" id="7578807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578811">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7578837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578841">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="7578911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578915">nil</span><span class="op" id="7578918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578921">}</span><span class="op" id="7578922">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578929">&#34;tobe;MSB;8&#34;</span><span class="op" id="7578941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578945">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7578971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7578975">&#34;\x2a\x13\xc8\x44\x52\x79\x48\x9c\x4f\x2a\x40\xa0\x90\x68\x5c\x16\x0f\x09\x80\x80&#34;</span><span class="op" id="7579057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579061">nil</span><span class="op" id="7579064">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579067">}</span><span class="op" id="7579068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579075">&#34;tobe-truncated;LSB;8&#34;</span><span class="op" id="7579097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579101">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7579127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579131">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04&#34;</span><span class="op" id="7579177">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579181">io</span><span class="op" id="7579183">.</span><span class="ident" id="7579184">ErrUnexpectedEOF</span><span class="op" id="7579200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579203">}</span><span class="op" id="7579204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7579207">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://en.wikipedia.org/wiki/Graphics_Interchange_Format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579297">&#34;gif;LSB;8&#34;</span><span class="op" id="7579308">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579312">&#34;\x28\xff\xff\xff\x28\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&#34;</span><span class="op" id="7579374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579378">&#34;\x00\x51\xfc\x1b\x28\x70\xa0\xc1\x83\x01\x01&#34;</span><span class="op" id="7579424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579428">nil</span><span class="op" id="7579431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579434">}</span><span class="op" id="7579435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7579438">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://compgroups.net/comp.lang.ruby/Decompressing-LZW-compression-from-PDF-file</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579551">&#34;pdf;MSB;8&#34;</span><span class="op" id="7579562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579566">&#34;-----A---B&#34;</span><span class="op" id="7579578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7579582">&#34;\x80\x0b\x60\x50\x22\x0c\x0c\x85\x01&#34;</span><span class="op" id="7579620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579624">nil</span><span class="op" id="7579627">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579630">}</span><span class="op" id="7579631">,</span><br>
<span class="lineno"></span><span class="op" id="7579633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7579636">func</span>&nbsp;<span class="ident" id="7579641">TestReader</span><span class="op" id="7579651">(</span><span class="ident" id="7579652">t</span>&nbsp;<span class="op" id="7579654">*</span><span class="ident" id="7579655">testing</span><span class="op" id="7579662">.</span><span class="ident" id="7579663">T</span><span class="op" id="7579664">)</span>&nbsp;<span class="op" id="7579666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579669">var</span>&nbsp;<span class="ident" id="7579673">b</span>&nbsp;<span class="ident" id="7579675">bytes</span><span class="op" id="7579680">.</span><span class="ident" id="7579681">Buffer</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579689">for</span>&nbsp;<span class="ident" id="7579693">_</span><span class="op" id="7579694">,</span>&nbsp;<span class="ident" id="7579696">tt</span>&nbsp;<span class="op" id="7579699">:=</span>&nbsp;<span class="keyword" id="7579702">range</span>&nbsp;<span class="ident" id="7579708">lzwTests</span>&nbsp;<span class="op" id="7579717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579721">d</span>&nbsp;<span class="op" id="7579723">:=</span>&nbsp;<span class="ident" id="7579726">strings</span><span class="op" id="7579733">.</span><span class="ident" id="7579734">Split</span><span class="op" id="7579739">(</span><span class="ident" id="7579740">tt</span><span class="op" id="7579742">.</span><span class="ident" id="7579743">desc</span><span class="op" id="7579747">,</span>&nbsp;<span class="string" id="7579749">&#34;;&#34;</span><span class="op" id="7579752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579756">var</span>&nbsp;<span class="ident" id="7579760">order</span>&nbsp;<span class="ident" id="7579766">Order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579774">switch</span>&nbsp;<span class="ident" id="7579781">d</span><span class="op" id="7579782">[</span><span class="num" id="7579783">1</span><span class="op" id="7579784">]</span>&nbsp;<span class="op" id="7579786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579790">case</span>&nbsp;<span class="string" id="7579795">&#34;LSB&#34;</span><span class="op" id="7579800">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579805">order</span>&nbsp;<span class="op" id="7579811">=</span>&nbsp;<span class="ident" id="7579813">LSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579819">case</span>&nbsp;<span class="string" id="7579824">&#34;MSB&#34;</span><span class="op" id="7579829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579834">order</span>&nbsp;<span class="op" id="7579840">=</span>&nbsp;<span class="ident" id="7579842">MSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579848">default</span><span class="op" id="7579855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579860">t</span><span class="op" id="7579861">.</span><span class="ident" id="7579862">Errorf</span><span class="op" id="7579868">(</span><span class="string" id="7579869">&#34;%s:&nbsp;bad&nbsp;order&nbsp;%q&#34;</span><span class="op" id="7579887">,</span>&nbsp;<span class="ident" id="7579889">tt</span><span class="op" id="7579891">.</span><span class="ident" id="7579892">desc</span><span class="op" id="7579896">,</span>&nbsp;<span class="ident" id="7579898">d</span><span class="op" id="7579899">[</span><span class="num" id="7579900">1</span><span class="op" id="7579901">]</span><span class="op" id="7579902">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579910">litWidth</span><span class="op" id="7579918">,</span>&nbsp;<span class="ident" id="7579920">_</span>&nbsp;<span class="op" id="7579922">:=</span>&nbsp;<span class="ident" id="7579925">strconv</span><span class="op" id="7579932">.</span><span class="ident" id="7579933">Atoi</span><span class="op" id="7579937">(</span><span class="ident" id="7579938">d</span><span class="op" id="7579939">[</span><span class="num" id="7579940">2</span><span class="op" id="7579941">]</span><span class="op" id="7579942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579946">rc</span>&nbsp;<span class="op" id="7579949">:=</span>&nbsp;<span class="ident" id="7579952">NewReader</span><span class="op" id="7579961">(</span><span class="ident" id="7579962">strings</span><span class="op" id="7579969">.</span><span class="ident" id="7579970">NewReader</span><span class="op" id="7579979">(</span><span class="ident" id="7579980">tt</span><span class="op" id="7579982">.</span><span class="ident" id="7579983">compressed</span><span class="op" id="7579993">)</span><span class="op" id="7579994">,</span>&nbsp;<span class="ident" id="7579996">order</span><span class="op" id="7580001">,</span>&nbsp;<span class="ident" id="7580003">litWidth</span><span class="op" id="7580011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580015">defer</span>&nbsp;<span class="ident" id="7580021">rc</span><span class="op" id="7580023">.</span><span class="ident" id="7580024">Close</span><span class="op" id="7580029">(</span><span class="op" id="7580030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580034">b</span><span class="op" id="7580035">.</span><span class="ident" id="7580036">Reset</span><span class="op" id="7580041">(</span><span class="op" id="7580042">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580046">n</span><span class="op" id="7580047">,</span>&nbsp;<span class="ident" id="7580049">err</span>&nbsp;<span class="op" id="7580053">:=</span>&nbsp;<span class="ident" id="7580056">io</span><span class="op" id="7580058">.</span><span class="ident" id="7580059">Copy</span><span class="op" id="7580063">(</span><span class="op" id="7580064">&amp;</span><span class="ident" id="7580065">b</span><span class="op" id="7580066">,</span>&nbsp;<span class="ident" id="7580068">rc</span><span class="op" id="7580070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580074">if</span>&nbsp;<span class="ident" id="7580077">err</span>&nbsp;<span class="op" id="7580081">!=</span>&nbsp;<span class="ident" id="7580084">nil</span>&nbsp;<span class="op" id="7580088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580093">if</span>&nbsp;<span class="ident" id="7580096">err</span>&nbsp;<span class="op" id="7580100">!=</span>&nbsp;<span class="ident" id="7580103">tt</span><span class="op" id="7580105">.</span><span class="ident" id="7580106">err</span>&nbsp;<span class="op" id="7580110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580116">t</span><span class="op" id="7580117">.</span><span class="ident" id="7580118">Errorf</span><span class="op" id="7580124">(</span><span class="string" id="7580125">&#34;%s:&nbsp;io.Copy:&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7580150">,</span>&nbsp;<span class="ident" id="7580152">tt</span><span class="op" id="7580154">.</span><span class="ident" id="7580155">desc</span><span class="op" id="7580159">,</span>&nbsp;<span class="ident" id="7580161">err</span><span class="op" id="7580164">,</span>&nbsp;<span class="ident" id="7580166">tt</span><span class="op" id="7580168">.</span><span class="ident" id="7580169">err</span><span class="op" id="7580172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580177">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580182">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580197">s</span>&nbsp;<span class="op" id="7580199">:=</span>&nbsp;<span class="ident" id="7580202">b</span><span class="op" id="7580203">.</span><span class="ident" id="7580204">String</span><span class="op" id="7580210">(</span><span class="op" id="7580211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580215">if</span>&nbsp;<span class="ident" id="7580218">s</span>&nbsp;<span class="op" id="7580220">!=</span>&nbsp;<span class="ident" id="7580223">tt</span><span class="op" id="7580225">.</span><span class="ident" id="7580226">raw</span>&nbsp;<span class="op" id="7580230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580235">t</span><span class="op" id="7580236">.</span><span class="ident" id="7580237">Errorf</span><span class="op" id="7580243">(</span><span class="string" id="7580244">&#34;%s:&nbsp;got&nbsp;%d-byte&nbsp;%q&nbsp;want&nbsp;%d-byte&nbsp;%q&#34;</span><span class="op" id="7580280">,</span>&nbsp;<span class="ident" id="7580282">tt</span><span class="op" id="7580284">.</span><span class="ident" id="7580285">desc</span><span class="op" id="7580289">,</span>&nbsp;<span class="ident" id="7580291">n</span><span class="op" id="7580292">,</span>&nbsp;<span class="ident" id="7580294">s</span><span class="op" id="7580295">,</span>&nbsp;<span class="builtinfunc" id="7580297">len</span><span class="op" id="7580300">(</span><span class="ident" id="7580301">tt</span><span class="op" id="7580303">.</span><span class="ident" id="7580304">raw</span><span class="op" id="7580307">)</span><span class="op" id="7580308">,</span>&nbsp;<span class="ident" id="7580310">tt</span><span class="op" id="7580312">.</span><span class="ident" id="7580313">raw</span><span class="op" id="7580316">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580323">}</span><br>
<span class="lineno"></span><span class="op" id="7580325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580328">func</span>&nbsp;<span class="ident" id="7580333">benchmarkDecoder</span><span class="op" id="7580349">(</span><span class="ident" id="7580350">b</span>&nbsp;<span class="op" id="7580352">*</span><span class="ident" id="7580353">testing</span><span class="op" id="7580360">.</span><span class="ident" id="7580361">B</span><span class="op" id="7580362">,</span>&nbsp;<span class="ident" id="7580364">n</span>&nbsp;<span class="builtintype" id="7580366">int</span><span class="op" id="7580369">)</span>&nbsp;<span class="op" id="7580371">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580374">b</span><span class="op" id="7580375">.</span><span class="ident" id="7580376">StopTimer</span><span class="op" id="7580385">(</span><span class="op" id="7580386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580389">b</span><span class="op" id="7580390">.</span><span class="ident" id="7580391">SetBytes</span><span class="op" id="7580399">(</span><span class="ident" id="7580400">int64</span><span class="op" id="7580405">(</span><span class="ident" id="7580406">n</span><span class="op" id="7580407">)</span><span class="op" id="7580408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580411">buf0</span><span class="op" id="7580415">,</span>&nbsp;<span class="ident" id="7580417">err</span>&nbsp;<span class="op" id="7580421">:=</span>&nbsp;<span class="ident" id="7580424">ioutil</span><span class="op" id="7580430">.</span><span class="ident" id="7580431">ReadFile</span><span class="op" id="7580439">(</span><span class="string" id="7580440">&#34;../testdata/e.txt&#34;</span><span class="op" id="7580459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580462">if</span>&nbsp;<span class="ident" id="7580465">err</span>&nbsp;<span class="op" id="7580469">!=</span>&nbsp;<span class="ident" id="7580472">nil</span>&nbsp;<span class="op" id="7580476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580480">b</span><span class="op" id="7580481">.</span><span class="ident" id="7580482">Fatal</span><span class="op" id="7580487">(</span><span class="ident" id="7580488">err</span><span class="op" id="7580491">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580497">if</span>&nbsp;<span class="builtinfunc" id="7580500">len</span><span class="op" id="7580503">(</span><span class="ident" id="7580504">buf0</span><span class="op" id="7580508">)</span>&nbsp;<span class="op" id="7580510">==</span>&nbsp;<span class="num" id="7580513">0</span>&nbsp;<span class="op" id="7580515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580519">b</span><span class="op" id="7580520">.</span><span class="ident" id="7580521">Fatalf</span><span class="op" id="7580527">(</span><span class="string" id="7580528">&#34;test&nbsp;file&nbsp;has&nbsp;no&nbsp;data&#34;</span><span class="op" id="7580551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580557">compressed</span>&nbsp;<span class="op" id="7580568">:=</span>&nbsp;<span class="builtinfunc" id="7580571">new</span><span class="op" id="7580574">(</span><span class="ident" id="7580575">bytes</span><span class="op" id="7580580">.</span><span class="ident" id="7580581">Buffer</span><span class="op" id="7580587">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580590">w</span>&nbsp;<span class="op" id="7580592">:=</span>&nbsp;<span class="ident" id="7580595">NewWriter</span><span class="op" id="7580604">(</span><span class="ident" id="7580605">compressed</span><span class="op" id="7580615">,</span>&nbsp;<span class="ident" id="7580617">LSB</span><span class="op" id="7580620">,</span>&nbsp;<span class="num" id="7580622">8</span><span class="op" id="7580623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580626">for</span>&nbsp;<span class="ident" id="7580630">i</span>&nbsp;<span class="op" id="7580632">:=</span>&nbsp;<span class="num" id="7580635">0</span><span class="op" id="7580636">;</span>&nbsp;<span class="ident" id="7580638">i</span>&nbsp;<span class="op" id="7580640">&lt;</span>&nbsp;<span class="ident" id="7580642">n</span><span class="op" id="7580643">;</span>&nbsp;<span class="ident" id="7580645">i</span>&nbsp;<span class="op" id="7580647">+=</span>&nbsp;<span class="builtinfunc" id="7580650">len</span><span class="op" id="7580653">(</span><span class="ident" id="7580654">buf0</span><span class="op" id="7580658">)</span>&nbsp;<span class="op" id="7580660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580664">if</span>&nbsp;<span class="builtinfunc" id="7580667">len</span><span class="op" id="7580670">(</span><span class="ident" id="7580671">buf0</span><span class="op" id="7580675">)</span>&nbsp;<span class="op" id="7580677">&gt;</span>&nbsp;<span class="ident" id="7580679">n</span><span class="op" id="7580680">-</span><span class="ident" id="7580681">i</span>&nbsp;<span class="op" id="7580683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580688">buf0</span>&nbsp;<span class="op" id="7580693">=</span>&nbsp;<span class="ident" id="7580695">buf0</span><span class="op" id="7580699">[</span><span class="op" id="7580700">:</span><span class="ident" id="7580701">n</span><span class="op" id="7580702">-</span><span class="ident" id="7580703">i</span><span class="op" id="7580704">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580708">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580712">w</span><span class="op" id="7580713">.</span><span class="ident" id="7580714">Write</span><span class="op" id="7580719">(</span><span class="ident" id="7580720">buf0</span><span class="op" id="7580724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580730">w</span><span class="op" id="7580731">.</span><span class="ident" id="7580732">Close</span><span class="op" id="7580737">(</span><span class="op" id="7580738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580741">buf1</span>&nbsp;<span class="op" id="7580746">:=</span>&nbsp;<span class="ident" id="7580749">compressed</span><span class="op" id="7580759">.</span><span class="ident" id="7580760">Bytes</span><span class="op" id="7580765">(</span><span class="op" id="7580766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580769">buf0</span><span class="op" id="7580773">,</span>&nbsp;<span class="ident" id="7580775">compressed</span><span class="op" id="7580785">,</span>&nbsp;<span class="ident" id="7580787">w</span>&nbsp;<span class="op" id="7580789">=</span>&nbsp;<span class="ident" id="7580791">nil</span><span class="op" id="7580794">,</span>&nbsp;<span class="ident" id="7580796">nil</span><span class="op" id="7580799">,</span>&nbsp;<span class="ident" id="7580801">nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580806">runtime</span><span class="op" id="7580813">.</span><span class="ident" id="7580814">GC</span><span class="op" id="7580816">(</span><span class="op" id="7580817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580820">b</span><span class="op" id="7580821">.</span><span class="ident" id="7580822">StartTimer</span><span class="op" id="7580832">(</span><span class="op" id="7580833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7580836">for</span>&nbsp;<span class="ident" id="7580840">i</span>&nbsp;<span class="op" id="7580842">:=</span>&nbsp;<span class="num" id="7580845">0</span><span class="op" id="7580846">;</span>&nbsp;<span class="ident" id="7580848">i</span>&nbsp;<span class="op" id="7580850">&lt;</span>&nbsp;<span class="ident" id="7580852">b</span><span class="op" id="7580853">.</span><span class="ident" id="7580854">N</span><span class="op" id="7580855">;</span>&nbsp;<span class="ident" id="7580857">i</span><span class="op" id="7580858">++</span>&nbsp;<span class="op" id="7580861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580865">io</span><span class="op" id="7580867">.</span><span class="ident" id="7580868">Copy</span><span class="op" id="7580872">(</span><span class="ident" id="7580873">ioutil</span><span class="op" id="7580879">.</span><span class="ident" id="7580880">Discard</span><span class="op" id="7580887">,</span>&nbsp;<span class="ident" id="7580889">NewReader</span><span class="op" id="7580898">(</span><span class="ident" id="7580899">bytes</span><span class="op" id="7580904">.</span><span class="ident" id="7580905">NewReader</span><span class="op" id="7580914">(</span><span class="ident" id="7580915">buf1</span><span class="op" id="7580919">)</span><span class="op" id="7580920">,</span>&nbsp;<span class="ident" id="7580922">LSB</span><span class="op" id="7580925">,</span>&nbsp;<span class="num" id="7580927">8</span><span class="op" id="7580928">)</span><span class="op" id="7580929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580932">}</span><br>
<span class="lineno">140</span><span class="op" id="7580934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580937">func</span>&nbsp;<span class="ident" id="7580942">BenchmarkDecoder1e4</span><span class="op" id="7580961">(</span><span class="ident" id="7580962">b</span>&nbsp;<span class="op" id="7580964">*</span><span class="ident" id="7580965">testing</span><span class="op" id="7580972">.</span><span class="ident" id="7580973">B</span><span class="op" id="7580974">)</span>&nbsp;<span class="op" id="7580976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580979">benchmarkDecoder</span><span class="op" id="7580995">(</span><span class="ident" id="7580996">b</span><span class="op" id="7580997">,</span>&nbsp;<span class="num" id="7580999">1e4</span><span class="op" id="7581002">)</span><br>
<span class="lineno"></span><span class="op" id="7581004">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7581007">func</span>&nbsp;<span class="ident" id="7581012">BenchmarkDecoder1e5</span><span class="op" id="7581031">(</span><span class="ident" id="7581032">b</span>&nbsp;<span class="op" id="7581034">*</span><span class="ident" id="7581035">testing</span><span class="op" id="7581042">.</span><span class="ident" id="7581043">B</span><span class="op" id="7581044">)</span>&nbsp;<span class="op" id="7581046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581049">benchmarkDecoder</span><span class="op" id="7581065">(</span><span class="ident" id="7581066">b</span><span class="op" id="7581067">,</span>&nbsp;<span class="num" id="7581069">1e5</span><span class="op" id="7581072">)</span><br>
<span class="lineno"></span><span class="op" id="7581074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7581077">func</span>&nbsp;<span class="ident" id="7581082">BenchmarkDecoder1e6</span><span class="op" id="7581101">(</span><span class="ident" id="7581102">b</span>&nbsp;<span class="op" id="7581104">*</span><span class="ident" id="7581105">testing</span><span class="op" id="7581112">.</span><span class="ident" id="7581113">B</span><span class="op" id="7581114">)</span>&nbsp;<span class="op" id="7581116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7581119">benchmarkDecoder</span><span class="op" id="7581135">(</span><span class="ident" id="7581136">b</span><span class="op" id="7581137">,</span>&nbsp;<span class="num" id="7581139">1e6</span><span class="op" id="7581142">)</span><br>
<span class="lineno"></span><span class="op" id="7581144">}</span>
</div>
</body>
</html>
