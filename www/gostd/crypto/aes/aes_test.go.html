<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html" class="current">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6960077">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6960132">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6960186">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6960237">package</span>&nbsp;<span class="ident" id="6960245">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6960250">import</span>&nbsp;<span class="op" id="6960257">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6960260">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6960270">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="6960273">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6960317">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="6960361">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="6960406">func</span>&nbsp;<span class="ident" id="6960411">TestPowx</span><span class="op" id="6960419">(</span><span class="ident" id="6960420">t</span>&nbsp;<span class="op" id="6960422">*</span><span class="ident" id="6960423">testing</span><span class="op" id="6960430">.</span><span class="ident" id="6960431">T</span><span class="op" id="6960432">)</span>&nbsp;<span class="op" id="6960434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960437">p</span>&nbsp;<span class="op" id="6960439">:=</span>&nbsp;<span class="num" id="6960442">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960445">for</span>&nbsp;<span class="ident" id="6960449">i</span>&nbsp;<span class="op" id="6960451">:=</span>&nbsp;<span class="num" id="6960454">0</span><span class="op" id="6960455">;</span>&nbsp;<span class="ident" id="6960457">i</span>&nbsp;<span class="op" id="6960459">&lt;</span>&nbsp;<span class="builtinfunc" id="6960461">len</span><span class="op" id="6960464">(</span><span class="ident" id="6960465">powx</span><span class="op" id="6960469">)</span><span class="op" id="6960470">;</span>&nbsp;<span class="ident" id="6960472">i</span><span class="op" id="6960473">++</span>&nbsp;<span class="op" id="6960476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960480">if</span>&nbsp;<span class="ident" id="6960483">powx</span><span class="op" id="6960487">[</span><span class="ident" id="6960488">i</span><span class="op" id="6960489">]</span>&nbsp;<span class="op" id="6960491">!=</span>&nbsp;<span class="builtintype" id="6960494">byte</span><span class="op" id="6960498">(</span><span class="ident" id="6960499">p</span><span class="op" id="6960500">)</span>&nbsp;<span class="op" id="6960502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960507">t</span><span class="op" id="6960508">.</span><span class="ident" id="6960509">Errorf</span><span class="op" id="6960515">(</span><span class="string" id="6960516">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6960542">,</span>&nbsp;<span class="ident" id="6960544">i</span><span class="op" id="6960545">,</span>&nbsp;<span class="ident" id="6960547">powx</span><span class="op" id="6960551">[</span><span class="ident" id="6960552">i</span><span class="op" id="6960553">]</span><span class="op" id="6960554">,</span>&nbsp;<span class="ident" id="6960556">p</span><span class="op" id="6960557">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960565">p</span>&nbsp;<span class="op" id="6960567">&lt;&lt;=</span>&nbsp;<span class="num" id="6960571">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960575">if</span>&nbsp;<span class="ident" id="6960578">p</span><span class="op" id="6960579">&amp;</span><span class="num" id="6960580">0x100</span>&nbsp;<span class="op" id="6960586">!=</span>&nbsp;<span class="num" id="6960589">0</span>&nbsp;<span class="op" id="6960591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960596">p</span>&nbsp;<span class="op" id="6960598">^=</span>&nbsp;<span class="ident" id="6960601">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960608">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960611">}</span><br>
<span class="lineno"></span><span class="op" id="6960613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6960616">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="6960669">func</span>&nbsp;<span class="ident" id="6960674">mul</span><span class="op" id="6960677">(</span><span class="ident" id="6960678">b</span><span class="op" id="6960679">,</span>&nbsp;<span class="ident" id="6960681">c</span>&nbsp;<span class="builtintype" id="6960683">uint32</span><span class="op" id="6960689">)</span>&nbsp;<span class="builtintype" id="6960691">uint32</span>&nbsp;<span class="op" id="6960698">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960701">i</span>&nbsp;<span class="op" id="6960703">:=</span>&nbsp;<span class="ident" id="6960706">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960709">j</span>&nbsp;<span class="op" id="6960711">:=</span>&nbsp;<span class="ident" id="6960714">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960717">s</span>&nbsp;<span class="op" id="6960719">:=</span>&nbsp;<span class="builtintype" id="6960722">uint32</span><span class="op" id="6960728">(</span><span class="num" id="6960729">0</span><span class="op" id="6960730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960733">for</span>&nbsp;<span class="ident" id="6960737">k</span>&nbsp;<span class="op" id="6960739">:=</span>&nbsp;<span class="builtintype" id="6960742">uint32</span><span class="op" id="6960748">(</span><span class="num" id="6960749">1</span><span class="op" id="6960750">)</span><span class="op" id="6960751">;</span>&nbsp;<span class="ident" id="6960753">k</span>&nbsp;<span class="op" id="6960755">&lt;</span>&nbsp;<span class="num" id="6960757">0x100</span>&nbsp;<span class="op" id="6960763">&amp;&amp;</span>&nbsp;<span class="ident" id="6960766">j</span>&nbsp;<span class="op" id="6960768">!=</span>&nbsp;<span class="num" id="6960771">0</span><span class="op" id="6960772">;</span>&nbsp;<span class="ident" id="6960774">k</span>&nbsp;<span class="op" id="6960776">&lt;&lt;=</span>&nbsp;<span class="num" id="6960780">1</span>&nbsp;<span class="op" id="6960782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6960786">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960828">if</span>&nbsp;<span class="ident" id="6960831">j</span><span class="op" id="6960832">&amp;</span><span class="ident" id="6960833">k</span>&nbsp;<span class="op" id="6960835">!=</span>&nbsp;<span class="num" id="6960838">0</span>&nbsp;<span class="op" id="6960840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6960845">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960882">s</span>&nbsp;<span class="op" id="6960884">^=</span>&nbsp;<span class="ident" id="6960887">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960892">j</span>&nbsp;<span class="op" id="6960894">^=</span>&nbsp;<span class="ident" id="6960897">k</span>&nbsp;<span class="comment" id="6960899">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6960935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6960940">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6960983">i</span>&nbsp;<span class="op" id="6960985">&lt;&lt;=</span>&nbsp;<span class="num" id="6960989">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6960993">if</span>&nbsp;<span class="ident" id="6960996">i</span><span class="op" id="6960997">&amp;</span><span class="num" id="6960998">0x100</span>&nbsp;<span class="op" id="6961004">!=</span>&nbsp;<span class="num" id="6961007">0</span>&nbsp;<span class="op" id="6961009">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961014">i</span>&nbsp;<span class="op" id="6961016">^=</span>&nbsp;<span class="ident" id="6961019">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961032">return</span>&nbsp;<span class="ident" id="6961039">s</span><br>
<span class="lineno"></span><span class="op" id="6961041">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="6961044">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="6961101">func</span>&nbsp;<span class="ident" id="6961106">TestMul</span><span class="op" id="6961113">(</span><span class="ident" id="6961114">t</span>&nbsp;<span class="op" id="6961116">*</span><span class="ident" id="6961117">testing</span><span class="op" id="6961124">.</span><span class="ident" id="6961125">T</span><span class="op" id="6961126">)</span>&nbsp;<span class="op" id="6961128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961131">for</span>&nbsp;<span class="ident" id="6961135">i</span>&nbsp;<span class="op" id="6961137">:=</span>&nbsp;<span class="builtintype" id="6961140">uint32</span><span class="op" id="6961146">(</span><span class="num" id="6961147">0</span><span class="op" id="6961148">)</span><span class="op" id="6961149">;</span>&nbsp;<span class="ident" id="6961151">i</span>&nbsp;<span class="op" id="6961153">&lt;</span>&nbsp;<span class="num" id="6961155">256</span><span class="op" id="6961158">;</span>&nbsp;<span class="ident" id="6961160">i</span><span class="op" id="6961161">++</span>&nbsp;<span class="op" id="6961164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961168">for</span>&nbsp;<span class="ident" id="6961172">j</span>&nbsp;<span class="op" id="6961174">:=</span>&nbsp;<span class="builtintype" id="6961177">uint32</span><span class="op" id="6961183">(</span><span class="num" id="6961184">0</span><span class="op" id="6961185">)</span><span class="op" id="6961186">;</span>&nbsp;<span class="ident" id="6961188">j</span>&nbsp;<span class="op" id="6961190">&lt;</span>&nbsp;<span class="num" id="6961192">256</span><span class="op" id="6961195">;</span>&nbsp;<span class="ident" id="6961197">j</span><span class="op" id="6961198">++</span>&nbsp;<span class="op" id="6961201">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6961206">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961238">s</span>&nbsp;<span class="op" id="6961240">:=</span>&nbsp;<span class="builtintype" id="6961243">uint8</span><span class="op" id="6961248">(</span><span class="num" id="6961249">0</span><span class="op" id="6961250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961255">for</span>&nbsp;<span class="ident" id="6961259">k</span>&nbsp;<span class="op" id="6961261">:=</span>&nbsp;<span class="builtintype" id="6961264">uint</span><span class="op" id="6961268">(</span><span class="num" id="6961269">0</span><span class="op" id="6961270">)</span><span class="op" id="6961271">;</span>&nbsp;<span class="ident" id="6961273">k</span>&nbsp;<span class="op" id="6961275">&lt;</span>&nbsp;<span class="num" id="6961277">8</span><span class="op" id="6961278">;</span>&nbsp;<span class="ident" id="6961280">k</span><span class="op" id="6961281">++</span>&nbsp;<span class="op" id="6961284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961290">for</span>&nbsp;<span class="ident" id="6961294">l</span>&nbsp;<span class="op" id="6961296">:=</span>&nbsp;<span class="builtintype" id="6961299">uint</span><span class="op" id="6961303">(</span><span class="num" id="6961304">0</span><span class="op" id="6961305">)</span><span class="op" id="6961306">;</span>&nbsp;<span class="ident" id="6961308">l</span>&nbsp;<span class="op" id="6961310">&lt;</span>&nbsp;<span class="num" id="6961312">8</span><span class="op" id="6961313">;</span>&nbsp;<span class="ident" id="6961315">l</span><span class="op" id="6961316">++</span>&nbsp;<span class="op" id="6961319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961326">if</span>&nbsp;<span class="ident" id="6961329">i</span><span class="op" id="6961330">&amp;</span><span class="op" id="6961331">(</span><span class="num" id="6961332">1</span><span class="op" id="6961333">&lt;&lt;</span><span class="ident" id="6961335">k</span><span class="op" id="6961336">)</span>&nbsp;<span class="op" id="6961338">!=</span>&nbsp;<span class="num" id="6961341">0</span>&nbsp;<span class="op" id="6961343">&amp;&amp;</span>&nbsp;<span class="ident" id="6961346">j</span><span class="op" id="6961347">&amp;</span><span class="op" id="6961348">(</span><span class="num" id="6961349">1</span><span class="op" id="6961350">&lt;&lt;</span><span class="ident" id="6961352">l</span><span class="op" id="6961353">)</span>&nbsp;<span class="op" id="6961355">!=</span>&nbsp;<span class="num" id="6961358">0</span>&nbsp;<span class="op" id="6961360">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961368">s</span>&nbsp;<span class="op" id="6961370">^=</span>&nbsp;<span class="ident" id="6961373">powx</span><span class="op" id="6961377">[</span><span class="ident" id="6961378">k</span><span class="op" id="6961379">+</span><span class="ident" id="6961380">l</span><span class="op" id="6961381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961404">if</span>&nbsp;<span class="ident" id="6961407">x</span>&nbsp;<span class="op" id="6961409">:=</span>&nbsp;<span class="ident" id="6961412">mul</span><span class="op" id="6961415">(</span><span class="ident" id="6961416">i</span><span class="op" id="6961417">,</span>&nbsp;<span class="ident" id="6961419">j</span><span class="op" id="6961420">)</span><span class="op" id="6961421">;</span>&nbsp;<span class="ident" id="6961423">x</span>&nbsp;<span class="op" id="6961425">!=</span>&nbsp;<span class="builtintype" id="6961428">uint32</span><span class="op" id="6961434">(</span><span class="ident" id="6961435">s</span><span class="op" id="6961436">)</span>&nbsp;<span class="op" id="6961438">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961444">t</span><span class="op" id="6961445">.</span><span class="ident" id="6961446">Fatalf</span><span class="op" id="6961452">(</span><span class="string" id="6961453">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6961484">,</span>&nbsp;<span class="ident" id="6961486">i</span><span class="op" id="6961487">,</span>&nbsp;<span class="ident" id="6961489">j</span><span class="op" id="6961490">,</span>&nbsp;<span class="ident" id="6961492">x</span><span class="op" id="6961493">,</span>&nbsp;<span class="ident" id="6961495">s</span><span class="op" id="6961496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961508">}</span><br>
<span class="lineno"></span><span class="op" id="6961510">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="6961513">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="6961563">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="6961611">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="6961660">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="6961707">func</span>&nbsp;<span class="ident" id="6961712">TestSboxes</span><span class="op" id="6961722">(</span><span class="ident" id="6961723">t</span>&nbsp;<span class="op" id="6961725">*</span><span class="ident" id="6961726">testing</span><span class="op" id="6961733">.</span><span class="ident" id="6961734">T</span><span class="op" id="6961735">)</span>&nbsp;<span class="op" id="6961737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961740">for</span>&nbsp;<span class="ident" id="6961744">i</span>&nbsp;<span class="op" id="6961746">:=</span>&nbsp;<span class="num" id="6961749">0</span><span class="op" id="6961750">;</span>&nbsp;<span class="ident" id="6961752">i</span>&nbsp;<span class="op" id="6961754">&lt;</span>&nbsp;<span class="num" id="6961756">256</span><span class="op" id="6961759">;</span>&nbsp;<span class="ident" id="6961761">i</span><span class="op" id="6961762">++</span>&nbsp;<span class="op" id="6961765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961769">if</span>&nbsp;<span class="ident" id="6961772">j</span>&nbsp;<span class="op" id="6961774">:=</span>&nbsp;<span class="ident" id="6961777">sbox0</span><span class="op" id="6961782">[</span><span class="ident" id="6961783">sbox1</span><span class="op" id="6961788">[</span><span class="ident" id="6961789">i</span><span class="op" id="6961790">]</span><span class="op" id="6961791">]</span><span class="op" id="6961792">;</span>&nbsp;<span class="ident" id="6961794">j</span>&nbsp;<span class="op" id="6961796">!=</span>&nbsp;<span class="builtintype" id="6961799">byte</span><span class="op" id="6961803">(</span><span class="ident" id="6961804">i</span><span class="op" id="6961805">)</span>&nbsp;<span class="op" id="6961807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961812">t</span><span class="op" id="6961813">.</span><span class="ident" id="6961814">Errorf</span><span class="op" id="6961820">(</span><span class="string" id="6961821">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6961846">,</span>&nbsp;<span class="ident" id="6961848">i</span><span class="op" id="6961849">,</span>&nbsp;<span class="ident" id="6961851">j</span><span class="op" id="6961852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961856">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6961860">if</span>&nbsp;<span class="ident" id="6961863">j</span>&nbsp;<span class="op" id="6961865">:=</span>&nbsp;<span class="ident" id="6961868">sbox1</span><span class="op" id="6961873">[</span><span class="ident" id="6961874">sbox0</span><span class="op" id="6961879">[</span><span class="ident" id="6961880">i</span><span class="op" id="6961881">]</span><span class="op" id="6961882">]</span><span class="op" id="6961883">;</span>&nbsp;<span class="ident" id="6961885">j</span>&nbsp;<span class="op" id="6961887">!=</span>&nbsp;<span class="builtintype" id="6961890">byte</span><span class="op" id="6961894">(</span><span class="ident" id="6961895">i</span><span class="op" id="6961896">)</span>&nbsp;<span class="op" id="6961898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6961903">t</span><span class="op" id="6961904">.</span><span class="ident" id="6961905">Errorf</span><span class="op" id="6961911">(</span><span class="string" id="6961912">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6961937">,</span>&nbsp;<span class="ident" id="6961939">i</span><span class="op" id="6961940">,</span>&nbsp;<span class="ident" id="6961942">j</span><span class="op" id="6961943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6961950">}</span><br>
<span class="lineno"></span><span class="op" id="6961952">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="6961955">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="6961999">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6962046">func</span>&nbsp;<span class="ident" id="6962051">TestTe</span><span class="op" id="6962057">(</span><span class="ident" id="6962058">t</span>&nbsp;<span class="op" id="6962060">*</span><span class="ident" id="6962061">testing</span><span class="op" id="6962068">.</span><span class="ident" id="6962069">T</span><span class="op" id="6962070">)</span>&nbsp;<span class="op" id="6962072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962075">for</span>&nbsp;<span class="ident" id="6962079">i</span>&nbsp;<span class="op" id="6962081">:=</span>&nbsp;<span class="num" id="6962084">0</span><span class="op" id="6962085">;</span>&nbsp;<span class="ident" id="6962087">i</span>&nbsp;<span class="op" id="6962089">&lt;</span>&nbsp;<span class="num" id="6962091">256</span><span class="op" id="6962094">;</span>&nbsp;<span class="ident" id="6962096">i</span><span class="op" id="6962097">++</span>&nbsp;<span class="op" id="6962100">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962104">s</span>&nbsp;<span class="op" id="6962106">:=</span>&nbsp;<span class="builtintype" id="6962109">uint32</span><span class="op" id="6962115">(</span><span class="ident" id="6962116">sbox0</span><span class="op" id="6962121">[</span><span class="ident" id="6962122">i</span><span class="op" id="6962123">]</span><span class="op" id="6962124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962128">s2</span>&nbsp;<span class="op" id="6962131">:=</span>&nbsp;<span class="ident" id="6962134">mul</span><span class="op" id="6962137">(</span><span class="ident" id="6962138">s</span><span class="op" id="6962139">,</span>&nbsp;<span class="num" id="6962141">2</span><span class="op" id="6962142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962146">s3</span>&nbsp;<span class="op" id="6962149">:=</span>&nbsp;<span class="ident" id="6962152">mul</span><span class="op" id="6962155">(</span><span class="ident" id="6962156">s</span><span class="op" id="6962157">,</span>&nbsp;<span class="num" id="6962159">3</span><span class="op" id="6962160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962164">w</span>&nbsp;<span class="op" id="6962166">:=</span>&nbsp;<span class="ident" id="6962169">s2</span><span class="op" id="6962171">&lt;&lt;</span><span class="num" id="6962173">24</span>&nbsp;<span class="op" id="6962176">|</span>&nbsp;<span class="ident" id="6962178">s</span><span class="op" id="6962179">&lt;&lt;</span><span class="num" id="6962181">16</span>&nbsp;<span class="op" id="6962184">|</span>&nbsp;<span class="ident" id="6962186">s</span><span class="op" id="6962187">&lt;&lt;</span><span class="num" id="6962189">8</span>&nbsp;<span class="op" id="6962191">|</span>&nbsp;<span class="ident" id="6962193">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962198">te</span>&nbsp;<span class="op" id="6962201">:=</span>&nbsp;<span class="op" id="6962204">[</span><span class="op" id="6962205">]</span><span class="op" id="6962206">[</span><span class="num" id="6962207">256</span><span class="op" id="6962210">]</span><span class="builtintype" id="6962211">uint32</span><span class="op" id="6962217">{</span><span class="ident" id="6962218">te0</span><span class="op" id="6962221">,</span>&nbsp;<span class="ident" id="6962223">te1</span><span class="op" id="6962226">,</span>&nbsp;<span class="ident" id="6962228">te2</span><span class="op" id="6962231">,</span>&nbsp;<span class="ident" id="6962233">te3</span><span class="op" id="6962236">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962240">for</span>&nbsp;<span class="ident" id="6962244">j</span>&nbsp;<span class="op" id="6962246">:=</span>&nbsp;<span class="num" id="6962249">0</span><span class="op" id="6962250">;</span>&nbsp;<span class="ident" id="6962252">j</span>&nbsp;<span class="op" id="6962254">&lt;</span>&nbsp;<span class="num" id="6962256">4</span><span class="op" id="6962257">;</span>&nbsp;<span class="ident" id="6962259">j</span><span class="op" id="6962260">++</span>&nbsp;<span class="op" id="6962263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962268">if</span>&nbsp;<span class="ident" id="6962271">x</span>&nbsp;<span class="op" id="6962273">:=</span>&nbsp;<span class="ident" id="6962276">te</span><span class="op" id="6962278">[</span><span class="ident" id="6962279">j</span><span class="op" id="6962280">]</span><span class="op" id="6962281">[</span><span class="ident" id="6962282">i</span><span class="op" id="6962283">]</span><span class="op" id="6962284">;</span>&nbsp;<span class="ident" id="6962286">x</span>&nbsp;<span class="op" id="6962288">!=</span>&nbsp;<span class="ident" id="6962291">w</span>&nbsp;<span class="op" id="6962293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962299">t</span><span class="op" id="6962300">.</span><span class="ident" id="6962301">Fatalf</span><span class="op" id="6962307">(</span><span class="string" id="6962308">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6962336">,</span>&nbsp;<span class="ident" id="6962338">j</span><span class="op" id="6962339">,</span>&nbsp;<span class="ident" id="6962341">i</span><span class="op" id="6962342">,</span>&nbsp;<span class="ident" id="6962344">x</span><span class="op" id="6962345">,</span>&nbsp;<span class="ident" id="6962347">w</span><span class="op" id="6962348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962358">w</span>&nbsp;<span class="op" id="6962360">=</span>&nbsp;<span class="ident" id="6962362">w</span><span class="op" id="6962363">&lt;&lt;</span><span class="num" id="6962365">24</span>&nbsp;<span class="op" id="6962368">|</span>&nbsp;<span class="ident" id="6962370">w</span><span class="op" id="6962371">&gt;&gt;</span><span class="num" id="6962373">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962380">}</span><br>
<span class="lineno"></span><span class="op" id="6962382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6962385">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="6962429">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6962476">func</span>&nbsp;<span class="ident" id="6962481">TestTd</span><span class="op" id="6962487">(</span><span class="ident" id="6962488">t</span>&nbsp;<span class="op" id="6962490">*</span><span class="ident" id="6962491">testing</span><span class="op" id="6962498">.</span><span class="ident" id="6962499">T</span><span class="op" id="6962500">)</span>&nbsp;<span class="op" id="6962502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962505">for</span>&nbsp;<span class="ident" id="6962509">i</span>&nbsp;<span class="op" id="6962511">:=</span>&nbsp;<span class="num" id="6962514">0</span><span class="op" id="6962515">;</span>&nbsp;<span class="ident" id="6962517">i</span>&nbsp;<span class="op" id="6962519">&lt;</span>&nbsp;<span class="num" id="6962521">256</span><span class="op" id="6962524">;</span>&nbsp;<span class="ident" id="6962526">i</span><span class="op" id="6962527">++</span>&nbsp;<span class="op" id="6962530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962534">s</span>&nbsp;<span class="op" id="6962536">:=</span>&nbsp;<span class="builtintype" id="6962539">uint32</span><span class="op" id="6962545">(</span><span class="ident" id="6962546">sbox1</span><span class="op" id="6962551">[</span><span class="ident" id="6962552">i</span><span class="op" id="6962553">]</span><span class="op" id="6962554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962558">s9</span>&nbsp;<span class="op" id="6962561">:=</span>&nbsp;<span class="ident" id="6962564">mul</span><span class="op" id="6962567">(</span><span class="ident" id="6962568">s</span><span class="op" id="6962569">,</span>&nbsp;<span class="num" id="6962571">0x9</span><span class="op" id="6962574">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962578">sb</span>&nbsp;<span class="op" id="6962581">:=</span>&nbsp;<span class="ident" id="6962584">mul</span><span class="op" id="6962587">(</span><span class="ident" id="6962588">s</span><span class="op" id="6962589">,</span>&nbsp;<span class="num" id="6962591">0xb</span><span class="op" id="6962594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962598">sd</span>&nbsp;<span class="op" id="6962601">:=</span>&nbsp;<span class="ident" id="6962604">mul</span><span class="op" id="6962607">(</span><span class="ident" id="6962608">s</span><span class="op" id="6962609">,</span>&nbsp;<span class="num" id="6962611">0xd</span><span class="op" id="6962614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962618">se</span>&nbsp;<span class="op" id="6962621">:=</span>&nbsp;<span class="ident" id="6962624">mul</span><span class="op" id="6962627">(</span><span class="ident" id="6962628">s</span><span class="op" id="6962629">,</span>&nbsp;<span class="num" id="6962631">0xe</span><span class="op" id="6962634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962638">w</span>&nbsp;<span class="op" id="6962640">:=</span>&nbsp;<span class="ident" id="6962643">se</span><span class="op" id="6962645">&lt;&lt;</span><span class="num" id="6962647">24</span>&nbsp;<span class="op" id="6962650">|</span>&nbsp;<span class="ident" id="6962652">s9</span><span class="op" id="6962654">&lt;&lt;</span><span class="num" id="6962656">16</span>&nbsp;<span class="op" id="6962659">|</span>&nbsp;<span class="ident" id="6962661">sd</span><span class="op" id="6962663">&lt;&lt;</span><span class="num" id="6962665">8</span>&nbsp;<span class="op" id="6962667">|</span>&nbsp;<span class="ident" id="6962669">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962674">td</span>&nbsp;<span class="op" id="6962677">:=</span>&nbsp;<span class="op" id="6962680">[</span><span class="op" id="6962681">]</span><span class="op" id="6962682">[</span><span class="num" id="6962683">256</span><span class="op" id="6962686">]</span><span class="builtintype" id="6962687">uint32</span><span class="op" id="6962693">{</span><span class="ident" id="6962694">td0</span><span class="op" id="6962697">,</span>&nbsp;<span class="ident" id="6962699">td1</span><span class="op" id="6962702">,</span>&nbsp;<span class="ident" id="6962704">td2</span><span class="op" id="6962707">,</span>&nbsp;<span class="ident" id="6962709">td3</span><span class="op" id="6962712">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962716">for</span>&nbsp;<span class="ident" id="6962720">j</span>&nbsp;<span class="op" id="6962722">:=</span>&nbsp;<span class="num" id="6962725">0</span><span class="op" id="6962726">;</span>&nbsp;<span class="ident" id="6962728">j</span>&nbsp;<span class="op" id="6962730">&lt;</span>&nbsp;<span class="num" id="6962732">4</span><span class="op" id="6962733">;</span>&nbsp;<span class="ident" id="6962735">j</span><span class="op" id="6962736">++</span>&nbsp;<span class="op" id="6962739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6962744">if</span>&nbsp;<span class="ident" id="6962747">x</span>&nbsp;<span class="op" id="6962749">:=</span>&nbsp;<span class="ident" id="6962752">td</span><span class="op" id="6962754">[</span><span class="ident" id="6962755">j</span><span class="op" id="6962756">]</span><span class="op" id="6962757">[</span><span class="ident" id="6962758">i</span><span class="op" id="6962759">]</span><span class="op" id="6962760">;</span>&nbsp;<span class="ident" id="6962762">x</span>&nbsp;<span class="op" id="6962764">!=</span>&nbsp;<span class="ident" id="6962767">w</span>&nbsp;<span class="op" id="6962769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962775">t</span><span class="op" id="6962776">.</span><span class="ident" id="6962777">Fatalf</span><span class="op" id="6962783">(</span><span class="string" id="6962784">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6962812">,</span>&nbsp;<span class="ident" id="6962814">j</span><span class="op" id="6962815">,</span>&nbsp;<span class="ident" id="6962817">i</span><span class="op" id="6962818">,</span>&nbsp;<span class="ident" id="6962820">x</span><span class="op" id="6962821">,</span>&nbsp;<span class="ident" id="6962823">w</span><span class="op" id="6962824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6962834">w</span>&nbsp;<span class="op" id="6962836">=</span>&nbsp;<span class="ident" id="6962838">w</span><span class="op" id="6962839">&lt;&lt;</span><span class="num" id="6962841">24</span>&nbsp;<span class="op" id="6962844">|</span>&nbsp;<span class="ident" id="6962846">w</span><span class="op" id="6962847">&gt;&gt;</span><span class="num" id="6962849">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6962856">}</span><br>
<span class="lineno"></span><span class="op" id="6962858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6962861">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="6962896">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6962964">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="6963014">type</span>&nbsp;<span class="ident" id="6963019">KeyTest</span>&nbsp;<span class="keyword" id="6963027">struct</span>&nbsp;<span class="op" id="6963034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963037">key</span>&nbsp;<span class="op" id="6963041">[</span><span class="op" id="6963042">]</span><span class="builtintype" id="6963043">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963049">enc</span>&nbsp;<span class="op" id="6963053">[</span><span class="op" id="6963054">]</span><span class="builtintype" id="6963055">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6963063">dec</span>&nbsp;<span class="op" id="6963067">[</span><span class="op" id="6963068">]</span><span class="builtintype" id="6963069">uint32</span>&nbsp;<span class="comment" id="6963076">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="6963150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6963153">var</span>&nbsp;<span class="ident" id="6963157">keyTests</span>&nbsp;<span class="op" id="6963166">=</span>&nbsp;<span class="op" id="6963168">[</span><span class="op" id="6963169">]</span><span class="ident" id="6963170">KeyTest</span><span class="op" id="6963177">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6963184">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963229">[</span><span class="op" id="6963230">]</span><span class="builtintype" id="6963231">byte</span><span class="op" id="6963235">{</span><span class="num" id="6963236">0x2b</span><span class="op" id="6963240">,</span>&nbsp;<span class="num" id="6963242">0x7e</span><span class="op" id="6963246">,</span>&nbsp;<span class="num" id="6963248">0x15</span><span class="op" id="6963252">,</span>&nbsp;<span class="num" id="6963254">0x16</span><span class="op" id="6963258">,</span>&nbsp;<span class="num" id="6963260">0x28</span><span class="op" id="6963264">,</span>&nbsp;<span class="num" id="6963266">0xae</span><span class="op" id="6963270">,</span>&nbsp;<span class="num" id="6963272">0xd2</span><span class="op" id="6963276">,</span>&nbsp;<span class="num" id="6963278">0xa6</span><span class="op" id="6963282">,</span>&nbsp;<span class="num" id="6963284">0xab</span><span class="op" id="6963288">,</span>&nbsp;<span class="num" id="6963290">0xf7</span><span class="op" id="6963294">,</span>&nbsp;<span class="num" id="6963296">0x15</span><span class="op" id="6963300">,</span>&nbsp;<span class="num" id="6963302">0x88</span><span class="op" id="6963306">,</span>&nbsp;<span class="num" id="6963308">0x09</span><span class="op" id="6963312">,</span>&nbsp;<span class="num" id="6963314">0xcf</span><span class="op" id="6963318">,</span>&nbsp;<span class="num" id="6963320">0x4f</span><span class="op" id="6963324">,</span>&nbsp;<span class="num" id="6963326">0x3c</span><span class="op" id="6963330">}</span><span class="op" id="6963331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963335">[</span><span class="op" id="6963336">]</span><span class="builtintype" id="6963337">uint32</span><span class="op" id="6963343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963348">0x2b7e1516</span><span class="op" id="6963358">,</span>&nbsp;<span class="num" id="6963360">0x28aed2a6</span><span class="op" id="6963370">,</span>&nbsp;<span class="num" id="6963372">0xabf71588</span><span class="op" id="6963382">,</span>&nbsp;<span class="num" id="6963384">0x09cf4f3c</span><span class="op" id="6963394">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963399">0xa0fafe17</span><span class="op" id="6963409">,</span>&nbsp;<span class="num" id="6963411">0x88542cb1</span><span class="op" id="6963421">,</span>&nbsp;<span class="num" id="6963423">0x23a33939</span><span class="op" id="6963433">,</span>&nbsp;<span class="num" id="6963435">0x2a6c7605</span><span class="op" id="6963445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963450">0xf2c295f2</span><span class="op" id="6963460">,</span>&nbsp;<span class="num" id="6963462">0x7a96b943</span><span class="op" id="6963472">,</span>&nbsp;<span class="num" id="6963474">0x5935807a</span><span class="op" id="6963484">,</span>&nbsp;<span class="num" id="6963486">0x7359f67f</span><span class="op" id="6963496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963501">0x3d80477d</span><span class="op" id="6963511">,</span>&nbsp;<span class="num" id="6963513">0x4716fe3e</span><span class="op" id="6963523">,</span>&nbsp;<span class="num" id="6963525">0x1e237e44</span><span class="op" id="6963535">,</span>&nbsp;<span class="num" id="6963537">0x6d7a883b</span><span class="op" id="6963547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963552">0xef44a541</span><span class="op" id="6963562">,</span>&nbsp;<span class="num" id="6963564">0xa8525b7f</span><span class="op" id="6963574">,</span>&nbsp;<span class="num" id="6963576">0xb671253b</span><span class="op" id="6963586">,</span>&nbsp;<span class="num" id="6963588">0xdb0bad00</span><span class="op" id="6963598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963603">0xd4d1c6f8</span><span class="op" id="6963613">,</span>&nbsp;<span class="num" id="6963615">0x7c839d87</span><span class="op" id="6963625">,</span>&nbsp;<span class="num" id="6963627">0xcaf2b8bc</span><span class="op" id="6963637">,</span>&nbsp;<span class="num" id="6963639">0x11f915bc</span><span class="op" id="6963649">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963654">0x6d88a37a</span><span class="op" id="6963664">,</span>&nbsp;<span class="num" id="6963666">0x110b3efd</span><span class="op" id="6963676">,</span>&nbsp;<span class="num" id="6963678">0xdbf98641</span><span class="op" id="6963688">,</span>&nbsp;<span class="num" id="6963690">0xca0093fd</span><span class="op" id="6963700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963705">0x4e54f70e</span><span class="op" id="6963715">,</span>&nbsp;<span class="num" id="6963717">0x5f5fc9f3</span><span class="op" id="6963727">,</span>&nbsp;<span class="num" id="6963729">0x84a64fb2</span><span class="op" id="6963739">,</span>&nbsp;<span class="num" id="6963741">0x4ea6dc4f</span><span class="op" id="6963751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963756">0xead27321</span><span class="op" id="6963766">,</span>&nbsp;<span class="num" id="6963768">0xb58dbad2</span><span class="op" id="6963778">,</span>&nbsp;<span class="num" id="6963780">0x312bf560</span><span class="op" id="6963790">,</span>&nbsp;<span class="num" id="6963792">0x7f8d292f</span><span class="op" id="6963802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963807">0xac7766f3</span><span class="op" id="6963817">,</span>&nbsp;<span class="num" id="6963819">0x19fadc21</span><span class="op" id="6963829">,</span>&nbsp;<span class="num" id="6963831">0x28d12941</span><span class="op" id="6963841">,</span>&nbsp;<span class="num" id="6963843">0x575c006e</span><span class="op" id="6963853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963858">0xd014f9a8</span><span class="op" id="6963868">,</span>&nbsp;<span class="num" id="6963870">0xc9ee2589</span><span class="op" id="6963880">,</span>&nbsp;<span class="num" id="6963882">0xe13f0cc8</span><span class="op" id="6963892">,</span>&nbsp;<span class="num" id="6963894">0xb6630ca6</span><span class="op" id="6963904">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963908">}</span><span class="op" id="6963909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6963913">[</span><span class="op" id="6963914">]</span><span class="builtintype" id="6963915">uint32</span><span class="op" id="6963921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963926">0xd014f9a8</span><span class="op" id="6963936">,</span>&nbsp;<span class="num" id="6963938">0xc9ee2589</span><span class="op" id="6963948">,</span>&nbsp;<span class="num" id="6963950">0xe13f0cc8</span><span class="op" id="6963960">,</span>&nbsp;<span class="num" id="6963962">0xb6630ca6</span><span class="op" id="6963972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6963977">0xc7b5a63</span><span class="op" id="6963986">,</span>&nbsp;<span class="num" id="6963988">0x1319eafe</span><span class="op" id="6963998">,</span>&nbsp;<span class="num" id="6964000">0xb0398890</span><span class="op" id="6964010">,</span>&nbsp;<span class="num" id="6964012">0x664cfbb4</span><span class="op" id="6964022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964027">0xdf7d925a</span><span class="op" id="6964037">,</span>&nbsp;<span class="num" id="6964039">0x1f62b09d</span><span class="op" id="6964049">,</span>&nbsp;<span class="num" id="6964051">0xa320626e</span><span class="op" id="6964061">,</span>&nbsp;<span class="num" id="6964063">0xd6757324</span><span class="op" id="6964073">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964078">0x12c07647</span><span class="op" id="6964088">,</span>&nbsp;<span class="num" id="6964090">0xc01f22c7</span><span class="op" id="6964100">,</span>&nbsp;<span class="num" id="6964102">0xbc42d2f3</span><span class="op" id="6964112">,</span>&nbsp;<span class="num" id="6964114">0x7555114a</span><span class="op" id="6964124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964129">0x6efcd876</span><span class="op" id="6964139">,</span>&nbsp;<span class="num" id="6964141">0xd2df5480</span><span class="op" id="6964151">,</span>&nbsp;<span class="num" id="6964153">0x7c5df034</span><span class="op" id="6964163">,</span>&nbsp;<span class="num" id="6964165">0xc917c3b9</span><span class="op" id="6964175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964180">0x6ea30afc</span><span class="op" id="6964190">,</span>&nbsp;<span class="num" id="6964192">0xbc238cf6</span><span class="op" id="6964202">,</span>&nbsp;<span class="num" id="6964204">0xae82a4b4</span><span class="op" id="6964214">,</span>&nbsp;<span class="num" id="6964216">0xb54a338d</span><span class="op" id="6964226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964231">0x90884413</span><span class="op" id="6964241">,</span>&nbsp;<span class="num" id="6964243">0xd280860a</span><span class="op" id="6964253">,</span>&nbsp;<span class="num" id="6964255">0x12a12842</span><span class="op" id="6964265">,</span>&nbsp;<span class="num" id="6964267">0x1bc89739</span><span class="op" id="6964277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964282">0x7c1f13f7</span><span class="op" id="6964292">,</span>&nbsp;<span class="num" id="6964294">0x4208c219</span><span class="op" id="6964304">,</span>&nbsp;<span class="num" id="6964306">0xc021ae48</span><span class="op" id="6964316">,</span>&nbsp;<span class="num" id="6964318">0x969bf7b</span><span class="op" id="6964327">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964332">0xcc7505eb</span><span class="op" id="6964342">,</span>&nbsp;<span class="num" id="6964344">0x3e17d1ee</span><span class="op" id="6964354">,</span>&nbsp;<span class="num" id="6964356">0x82296c51</span><span class="op" id="6964366">,</span>&nbsp;<span class="num" id="6964368">0xc9481133</span><span class="op" id="6964378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964383">0x2b3708a7</span><span class="op" id="6964393">,</span>&nbsp;<span class="num" id="6964395">0xf262d405</span><span class="op" id="6964405">,</span>&nbsp;<span class="num" id="6964407">0xbc3ebdbf</span><span class="op" id="6964417">,</span>&nbsp;<span class="num" id="6964419">0x4b617d62</span><span class="op" id="6964429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964434">0x2b7e1516</span><span class="op" id="6964444">,</span>&nbsp;<span class="num" id="6964446">0x28aed2a6</span><span class="op" id="6964456">,</span>&nbsp;<span class="num" id="6964458">0xabf71588</span><span class="op" id="6964468">,</span>&nbsp;<span class="num" id="6964470">0x9cf4f3c</span><span class="op" id="6964479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964483">}</span><span class="op" id="6964484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964487">}</span><span class="op" id="6964488">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6964495">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964540">[</span><span class="op" id="6964541">]</span><span class="builtintype" id="6964542">byte</span><span class="op" id="6964546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964551">0x8e</span><span class="op" id="6964555">,</span>&nbsp;<span class="num" id="6964557">0x73</span><span class="op" id="6964561">,</span>&nbsp;<span class="num" id="6964563">0xb0</span><span class="op" id="6964567">,</span>&nbsp;<span class="num" id="6964569">0xf7</span><span class="op" id="6964573">,</span>&nbsp;<span class="num" id="6964575">0xda</span><span class="op" id="6964579">,</span>&nbsp;<span class="num" id="6964581">0x0e</span><span class="op" id="6964585">,</span>&nbsp;<span class="num" id="6964587">0x64</span><span class="op" id="6964591">,</span>&nbsp;<span class="num" id="6964593">0x52</span><span class="op" id="6964597">,</span>&nbsp;<span class="num" id="6964599">0xc8</span><span class="op" id="6964603">,</span>&nbsp;<span class="num" id="6964605">0x10</span><span class="op" id="6964609">,</span>&nbsp;<span class="num" id="6964611">0xf3</span><span class="op" id="6964615">,</span>&nbsp;<span class="num" id="6964617">0x2b</span><span class="op" id="6964621">,</span>&nbsp;<span class="num" id="6964623">0x80</span><span class="op" id="6964627">,</span>&nbsp;<span class="num" id="6964629">0x90</span><span class="op" id="6964633">,</span>&nbsp;<span class="num" id="6964635">0x79</span><span class="op" id="6964639">,</span>&nbsp;<span class="num" id="6964641">0xe5</span><span class="op" id="6964645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964650">0x62</span><span class="op" id="6964654">,</span>&nbsp;<span class="num" id="6964656">0xf8</span><span class="op" id="6964660">,</span>&nbsp;<span class="num" id="6964662">0xea</span><span class="op" id="6964666">,</span>&nbsp;<span class="num" id="6964668">0xd2</span><span class="op" id="6964672">,</span>&nbsp;<span class="num" id="6964674">0x52</span><span class="op" id="6964678">,</span>&nbsp;<span class="num" id="6964680">0x2c</span><span class="op" id="6964684">,</span>&nbsp;<span class="num" id="6964686">0x6b</span><span class="op" id="6964690">,</span>&nbsp;<span class="num" id="6964692">0x7b</span><span class="op" id="6964696">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964700">}</span><span class="op" id="6964701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6964705">[</span><span class="op" id="6964706">]</span><span class="builtintype" id="6964707">uint32</span><span class="op" id="6964713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964718">0x8e73b0f7</span><span class="op" id="6964728">,</span>&nbsp;<span class="num" id="6964730">0xda0e6452</span><span class="op" id="6964740">,</span>&nbsp;<span class="num" id="6964742">0xc810f32b</span><span class="op" id="6964752">,</span>&nbsp;<span class="num" id="6964754">0x809079e5</span><span class="op" id="6964764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964769">0x62f8ead2</span><span class="op" id="6964779">,</span>&nbsp;<span class="num" id="6964781">0x522c6b7b</span><span class="op" id="6964791">,</span>&nbsp;<span class="num" id="6964793">0xfe0c91f7</span><span class="op" id="6964803">,</span>&nbsp;<span class="num" id="6964805">0x2402f5a5</span><span class="op" id="6964815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964820">0xec12068e</span><span class="op" id="6964830">,</span>&nbsp;<span class="num" id="6964832">0x6c827f6b</span><span class="op" id="6964842">,</span>&nbsp;<span class="num" id="6964844">0x0e7a95b9</span><span class="op" id="6964854">,</span>&nbsp;<span class="num" id="6964856">0x5c56fec2</span><span class="op" id="6964866">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964871">0x4db7b4bd</span><span class="op" id="6964881">,</span>&nbsp;<span class="num" id="6964883">0x69b54118</span><span class="op" id="6964893">,</span>&nbsp;<span class="num" id="6964895">0x85a74796</span><span class="op" id="6964905">,</span>&nbsp;<span class="num" id="6964907">0xe92538fd</span><span class="op" id="6964917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964922">0xe75fad44</span><span class="op" id="6964932">,</span>&nbsp;<span class="num" id="6964934">0xbb095386</span><span class="op" id="6964944">,</span>&nbsp;<span class="num" id="6964946">0x485af057</span><span class="op" id="6964956">,</span>&nbsp;<span class="num" id="6964958">0x21efb14f</span><span class="op" id="6964968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6964973">0xa448f6d9</span><span class="op" id="6964983">,</span>&nbsp;<span class="num" id="6964985">0x4d6dce24</span><span class="op" id="6964995">,</span>&nbsp;<span class="num" id="6964997">0xaa326360</span><span class="op" id="6965007">,</span>&nbsp;<span class="num" id="6965009">0x113b30e6</span><span class="op" id="6965019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965024">0xa25e7ed5</span><span class="op" id="6965034">,</span>&nbsp;<span class="num" id="6965036">0x83b1cf9a</span><span class="op" id="6965046">,</span>&nbsp;<span class="num" id="6965048">0x27f93943</span><span class="op" id="6965058">,</span>&nbsp;<span class="num" id="6965060">0x6a94f767</span><span class="op" id="6965070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965075">0xc0a69407</span><span class="op" id="6965085">,</span>&nbsp;<span class="num" id="6965087">0xd19da4e1</span><span class="op" id="6965097">,</span>&nbsp;<span class="num" id="6965099">0xec1786eb</span><span class="op" id="6965109">,</span>&nbsp;<span class="num" id="6965111">0x6fa64971</span><span class="op" id="6965121">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965126">0x485f7032</span><span class="op" id="6965136">,</span>&nbsp;<span class="num" id="6965138">0x22cb8755</span><span class="op" id="6965148">,</span>&nbsp;<span class="num" id="6965150">0xe26d1352</span><span class="op" id="6965160">,</span>&nbsp;<span class="num" id="6965162">0x33f0b7b3</span><span class="op" id="6965172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965177">0x40beeb28</span><span class="op" id="6965187">,</span>&nbsp;<span class="num" id="6965189">0x2f18a259</span><span class="op" id="6965199">,</span>&nbsp;<span class="num" id="6965201">0x6747d26b</span><span class="op" id="6965211">,</span>&nbsp;<span class="num" id="6965213">0x458c553e</span><span class="op" id="6965223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965228">0xa7e1466c</span><span class="op" id="6965238">,</span>&nbsp;<span class="num" id="6965240">0x9411f1df</span><span class="op" id="6965250">,</span>&nbsp;<span class="num" id="6965252">0x821f750a</span><span class="op" id="6965262">,</span>&nbsp;<span class="num" id="6965264">0xad07d753</span><span class="op" id="6965274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965279">0xca400538</span><span class="op" id="6965289">,</span>&nbsp;<span class="num" id="6965291">0x8fcc5006</span><span class="op" id="6965301">,</span>&nbsp;<span class="num" id="6965303">0x282d166a</span><span class="op" id="6965313">,</span>&nbsp;<span class="num" id="6965315">0xbc3ce7b5</span><span class="op" id="6965325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965330">0xe98ba06f</span><span class="op" id="6965340">,</span>&nbsp;<span class="num" id="6965342">0x448c773c</span><span class="op" id="6965352">,</span>&nbsp;<span class="num" id="6965354">0x8ecc7204</span><span class="op" id="6965364">,</span>&nbsp;<span class="num" id="6965366">0x01002202</span><span class="op" id="6965376">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965380">}</span><span class="op" id="6965381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6965385">nil</span><span class="op" id="6965388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965391">}</span><span class="op" id="6965392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6965399">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965444">[</span><span class="op" id="6965445">]</span><span class="builtintype" id="6965446">byte</span><span class="op" id="6965450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965455">0x60</span><span class="op" id="6965459">,</span>&nbsp;<span class="num" id="6965461">0x3d</span><span class="op" id="6965465">,</span>&nbsp;<span class="num" id="6965467">0xeb</span><span class="op" id="6965471">,</span>&nbsp;<span class="num" id="6965473">0x10</span><span class="op" id="6965477">,</span>&nbsp;<span class="num" id="6965479">0x15</span><span class="op" id="6965483">,</span>&nbsp;<span class="num" id="6965485">0xca</span><span class="op" id="6965489">,</span>&nbsp;<span class="num" id="6965491">0x71</span><span class="op" id="6965495">,</span>&nbsp;<span class="num" id="6965497">0xbe</span><span class="op" id="6965501">,</span>&nbsp;<span class="num" id="6965503">0x2b</span><span class="op" id="6965507">,</span>&nbsp;<span class="num" id="6965509">0x73</span><span class="op" id="6965513">,</span>&nbsp;<span class="num" id="6965515">0xae</span><span class="op" id="6965519">,</span>&nbsp;<span class="num" id="6965521">0xf0</span><span class="op" id="6965525">,</span>&nbsp;<span class="num" id="6965527">0x85</span><span class="op" id="6965531">,</span>&nbsp;<span class="num" id="6965533">0x7d</span><span class="op" id="6965537">,</span>&nbsp;<span class="num" id="6965539">0x77</span><span class="op" id="6965543">,</span>&nbsp;<span class="num" id="6965545">0x81</span><span class="op" id="6965549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965554">0x1f</span><span class="op" id="6965558">,</span>&nbsp;<span class="num" id="6965560">0x35</span><span class="op" id="6965564">,</span>&nbsp;<span class="num" id="6965566">0x2c</span><span class="op" id="6965570">,</span>&nbsp;<span class="num" id="6965572">0x07</span><span class="op" id="6965576">,</span>&nbsp;<span class="num" id="6965578">0x3b</span><span class="op" id="6965582">,</span>&nbsp;<span class="num" id="6965584">0x61</span><span class="op" id="6965588">,</span>&nbsp;<span class="num" id="6965590">0x08</span><span class="op" id="6965594">,</span>&nbsp;<span class="num" id="6965596">0xd7</span><span class="op" id="6965600">,</span>&nbsp;<span class="num" id="6965602">0x2d</span><span class="op" id="6965606">,</span>&nbsp;<span class="num" id="6965608">0x98</span><span class="op" id="6965612">,</span>&nbsp;<span class="num" id="6965614">0x10</span><span class="op" id="6965618">,</span>&nbsp;<span class="num" id="6965620">0xa3</span><span class="op" id="6965624">,</span>&nbsp;<span class="num" id="6965626">0x09</span><span class="op" id="6965630">,</span>&nbsp;<span class="num" id="6965632">0x14</span><span class="op" id="6965636">,</span>&nbsp;<span class="num" id="6965638">0xdf</span><span class="op" id="6965642">,</span>&nbsp;<span class="num" id="6965644">0xf4</span><span class="op" id="6965648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965652">}</span><span class="op" id="6965653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6965657">[</span><span class="op" id="6965658">]</span><span class="builtintype" id="6965659">uint32</span><span class="op" id="6965665">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965670">0x603deb10</span><span class="op" id="6965680">,</span>&nbsp;<span class="num" id="6965682">0x15ca71be</span><span class="op" id="6965692">,</span>&nbsp;<span class="num" id="6965694">0x2b73aef0</span><span class="op" id="6965704">,</span>&nbsp;<span class="num" id="6965706">0x857d7781</span><span class="op" id="6965716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965721">0x1f352c07</span><span class="op" id="6965731">,</span>&nbsp;<span class="num" id="6965733">0x3b6108d7</span><span class="op" id="6965743">,</span>&nbsp;<span class="num" id="6965745">0x2d9810a3</span><span class="op" id="6965755">,</span>&nbsp;<span class="num" id="6965757">0x0914dff4</span><span class="op" id="6965767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965772">0x9ba35411</span><span class="op" id="6965782">,</span>&nbsp;<span class="num" id="6965784">0x8e6925af</span><span class="op" id="6965794">,</span>&nbsp;<span class="num" id="6965796">0xa51a8b5f</span><span class="op" id="6965806">,</span>&nbsp;<span class="num" id="6965808">0x2067fcde</span><span class="op" id="6965818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965823">0xa8b09c1a</span><span class="op" id="6965833">,</span>&nbsp;<span class="num" id="6965835">0x93d194cd</span><span class="op" id="6965845">,</span>&nbsp;<span class="num" id="6965847">0xbe49846e</span><span class="op" id="6965857">,</span>&nbsp;<span class="num" id="6965859">0xb75d5b9a</span><span class="op" id="6965869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965874">0xd59aecb8</span><span class="op" id="6965884">,</span>&nbsp;<span class="num" id="6965886">0x5bf3c917</span><span class="op" id="6965896">,</span>&nbsp;<span class="num" id="6965898">0xfee94248</span><span class="op" id="6965908">,</span>&nbsp;<span class="num" id="6965910">0xde8ebe96</span><span class="op" id="6965920">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965925">0xb5a9328a</span><span class="op" id="6965935">,</span>&nbsp;<span class="num" id="6965937">0x2678a647</span><span class="op" id="6965947">,</span>&nbsp;<span class="num" id="6965949">0x98312229</span><span class="op" id="6965959">,</span>&nbsp;<span class="num" id="6965961">0x2f6c79b3</span><span class="op" id="6965971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6965976">0x812c81ad</span><span class="op" id="6965986">,</span>&nbsp;<span class="num" id="6965988">0xdadf48ba</span><span class="op" id="6965998">,</span>&nbsp;<span class="num" id="6966000">0x24360af2</span><span class="op" id="6966010">,</span>&nbsp;<span class="num" id="6966012">0xfab8b464</span><span class="op" id="6966022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966027">0x98c5bfc9</span><span class="op" id="6966037">,</span>&nbsp;<span class="num" id="6966039">0xbebd198e</span><span class="op" id="6966049">,</span>&nbsp;<span class="num" id="6966051">0x268c3ba7</span><span class="op" id="6966061">,</span>&nbsp;<span class="num" id="6966063">0x09e04214</span><span class="op" id="6966073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966078">0x68007bac</span><span class="op" id="6966088">,</span>&nbsp;<span class="num" id="6966090">0xb2df3316</span><span class="op" id="6966100">,</span>&nbsp;<span class="num" id="6966102">0x96e939e4</span><span class="op" id="6966112">,</span>&nbsp;<span class="num" id="6966114">0x6c518d80</span><span class="op" id="6966124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966129">0xc814e204</span><span class="op" id="6966139">,</span>&nbsp;<span class="num" id="6966141">0x76a9fb8a</span><span class="op" id="6966151">,</span>&nbsp;<span class="num" id="6966153">0x5025c02d</span><span class="op" id="6966163">,</span>&nbsp;<span class="num" id="6966165">0x59c58239</span><span class="op" id="6966175">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966180">0xde136967</span><span class="op" id="6966190">,</span>&nbsp;<span class="num" id="6966192">0x6ccc5a71</span><span class="op" id="6966202">,</span>&nbsp;<span class="num" id="6966204">0xfa256395</span><span class="op" id="6966214">,</span>&nbsp;<span class="num" id="6966216">0x9674ee15</span><span class="op" id="6966226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966231">0x5886ca5d</span><span class="op" id="6966241">,</span>&nbsp;<span class="num" id="6966243">0x2e2f31d7</span><span class="op" id="6966253">,</span>&nbsp;<span class="num" id="6966255">0x7e0af1fa</span><span class="op" id="6966265">,</span>&nbsp;<span class="num" id="6966267">0x27cf73c3</span><span class="op" id="6966277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966282">0x749c47ab</span><span class="op" id="6966292">,</span>&nbsp;<span class="num" id="6966294">0x18501dda</span><span class="op" id="6966304">,</span>&nbsp;<span class="num" id="6966306">0xe2757e4f</span><span class="op" id="6966316">,</span>&nbsp;<span class="num" id="6966318">0x7401905a</span><span class="op" id="6966328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966333">0xcafaaae3</span><span class="op" id="6966343">,</span>&nbsp;<span class="num" id="6966345">0xe4d59b34</span><span class="op" id="6966355">,</span>&nbsp;<span class="num" id="6966357">0x9adf6ace</span><span class="op" id="6966367">,</span>&nbsp;<span class="num" id="6966369">0xbd10190d</span><span class="op" id="6966379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6966384">0xfe4890d1</span><span class="op" id="6966394">,</span>&nbsp;<span class="num" id="6966396">0xe6188d0b</span><span class="op" id="6966406">,</span>&nbsp;<span class="num" id="6966408">0x046df344</span><span class="op" id="6966418">,</span>&nbsp;<span class="num" id="6966420">0x706c631e</span><span class="op" id="6966430">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966434">}</span><span class="op" id="6966435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966439">nil</span><span class="op" id="6966442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966445">}</span><span class="op" id="6966446">,</span><br>
<span class="lineno"></span><span class="op" id="6966448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="6966451">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6966500">func</span>&nbsp;<span class="ident" id="6966505">TestExpandKey</span><span class="op" id="6966518">(</span><span class="ident" id="6966519">t</span>&nbsp;<span class="op" id="6966521">*</span><span class="ident" id="6966522">testing</span><span class="op" id="6966529">.</span><span class="ident" id="6966530">T</span><span class="op" id="6966531">)</span>&nbsp;<span class="op" id="6966533">{</span><br>
<span class="lineno"></span><span class="ident" id="6966535">L</span><span class="op" id="6966536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966539">for</span>&nbsp;<span class="ident" id="6966543">i</span><span class="op" id="6966544">,</span>&nbsp;<span class="ident" id="6966546">tt</span>&nbsp;<span class="op" id="6966549">:=</span>&nbsp;<span class="keyword" id="6966552">range</span>&nbsp;<span class="ident" id="6966558">keyTests</span>&nbsp;<span class="op" id="6966567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966571">enc</span>&nbsp;<span class="op" id="6966575">:=</span>&nbsp;<span class="builtinfunc" id="6966578">make</span><span class="op" id="6966582">(</span><span class="op" id="6966583">[</span><span class="op" id="6966584">]</span><span class="builtintype" id="6966585">uint32</span><span class="op" id="6966591">,</span>&nbsp;<span class="builtinfunc" id="6966593">len</span><span class="op" id="6966596">(</span><span class="ident" id="6966597">tt</span><span class="op" id="6966599">.</span><span class="ident" id="6966600">enc</span><span class="op" id="6966603">)</span><span class="op" id="6966604">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966608">var</span>&nbsp;<span class="ident" id="6966612">dec</span>&nbsp;<span class="op" id="6966616">[</span><span class="op" id="6966617">]</span><span class="builtintype" id="6966618">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966627">if</span>&nbsp;<span class="ident" id="6966630">tt</span><span class="op" id="6966632">.</span><span class="ident" id="6966633">dec</span>&nbsp;<span class="op" id="6966637">!=</span>&nbsp;<span class="ident" id="6966640">nil</span>&nbsp;<span class="op" id="6966644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966649">dec</span>&nbsp;<span class="op" id="6966653">=</span>&nbsp;<span class="builtinfunc" id="6966655">make</span><span class="op" id="6966659">(</span><span class="op" id="6966660">[</span><span class="op" id="6966661">]</span><span class="builtintype" id="6966662">uint32</span><span class="op" id="6966668">,</span>&nbsp;<span class="builtinfunc" id="6966670">len</span><span class="op" id="6966673">(</span><span class="ident" id="6966674">tt</span><span class="op" id="6966676">.</span><span class="ident" id="6966677">dec</span><span class="op" id="6966680">)</span><span class="op" id="6966681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6966685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6966689">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6966756">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6966821">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966890">expandKeyGo</span><span class="op" id="6966901">(</span><span class="ident" id="6966902">tt</span><span class="op" id="6966904">.</span><span class="ident" id="6966905">key</span><span class="op" id="6966908">,</span>&nbsp;<span class="ident" id="6966910">enc</span><span class="op" id="6966913">,</span>&nbsp;<span class="ident" id="6966915">dec</span><span class="op" id="6966918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966922">for</span>&nbsp;<span class="ident" id="6966926">j</span><span class="op" id="6966927">,</span>&nbsp;<span class="ident" id="6966929">v</span>&nbsp;<span class="op" id="6966931">:=</span>&nbsp;<span class="keyword" id="6966934">range</span>&nbsp;<span class="ident" id="6966940">enc</span>&nbsp;<span class="op" id="6966944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6966949">if</span>&nbsp;<span class="ident" id="6966952">v</span>&nbsp;<span class="op" id="6966954">!=</span>&nbsp;<span class="ident" id="6966957">tt</span><span class="op" id="6966959">.</span><span class="ident" id="6966960">enc</span><span class="op" id="6966963">[</span><span class="ident" id="6966964">j</span><span class="op" id="6966965">]</span>&nbsp;<span class="op" id="6966967">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6966973">t</span><span class="op" id="6966974">.</span><span class="ident" id="6966975">Errorf</span><span class="op" id="6966981">(</span><span class="string" id="6966982">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6967015">,</span>&nbsp;<span class="ident" id="6967017">i</span><span class="op" id="6967018">,</span>&nbsp;<span class="ident" id="6967020">j</span><span class="op" id="6967021">,</span>&nbsp;<span class="ident" id="6967023">v</span><span class="op" id="6967024">,</span>&nbsp;<span class="ident" id="6967026">tt</span><span class="op" id="6967028">.</span><span class="ident" id="6967029">enc</span><span class="op" id="6967032">[</span><span class="ident" id="6967033">j</span><span class="op" id="6967034">]</span><span class="op" id="6967035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967041">continue</span>&nbsp;<span class="ident" id="6967050">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967063">if</span>&nbsp;<span class="ident" id="6967066">dec</span>&nbsp;<span class="op" id="6967070">!=</span>&nbsp;<span class="ident" id="6967073">nil</span>&nbsp;<span class="op" id="6967077">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967082">for</span>&nbsp;<span class="ident" id="6967086">j</span><span class="op" id="6967087">,</span>&nbsp;<span class="ident" id="6967089">v</span>&nbsp;<span class="op" id="6967091">:=</span>&nbsp;<span class="keyword" id="6967094">range</span>&nbsp;<span class="ident" id="6967100">dec</span>&nbsp;<span class="op" id="6967104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967110">if</span>&nbsp;<span class="ident" id="6967113">v</span>&nbsp;<span class="op" id="6967115">!=</span>&nbsp;<span class="ident" id="6967118">tt</span><span class="op" id="6967120">.</span><span class="ident" id="6967121">dec</span><span class="op" id="6967124">[</span><span class="ident" id="6967125">j</span><span class="op" id="6967126">]</span>&nbsp;<span class="op" id="6967128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967135">t</span><span class="op" id="6967136">.</span><span class="ident" id="6967137">Errorf</span><span class="op" id="6967143">(</span><span class="string" id="6967144">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6967177">,</span>&nbsp;<span class="ident" id="6967179">i</span><span class="op" id="6967180">,</span>&nbsp;<span class="ident" id="6967182">j</span><span class="op" id="6967183">,</span>&nbsp;<span class="ident" id="6967185">v</span><span class="op" id="6967186">,</span>&nbsp;<span class="ident" id="6967188">tt</span><span class="op" id="6967190">.</span><span class="ident" id="6967191">dec</span><span class="op" id="6967194">[</span><span class="ident" id="6967195">j</span><span class="op" id="6967196">]</span><span class="op" id="6967197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6967204">continue</span>&nbsp;<span class="ident" id="6967213">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967219">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967231">}</span><br>
<span class="lineno"></span><span class="op" id="6967233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="6967236">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="6967300">type</span>&nbsp;<span class="ident" id="6967305">CryptTest</span>&nbsp;<span class="keyword" id="6967315">struct</span>&nbsp;<span class="op" id="6967322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967325">key</span>&nbsp;<span class="op" id="6967329">[</span><span class="op" id="6967330">]</span><span class="builtintype" id="6967331">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967337">in</span>&nbsp;&nbsp;<span class="op" id="6967341">[</span><span class="op" id="6967342">]</span><span class="builtintype" id="6967343">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6967349">out</span>&nbsp;<span class="op" id="6967353">[</span><span class="op" id="6967354">]</span><span class="builtintype" id="6967355">byte</span><br>
<span class="lineno">250</span><span class="op" id="6967360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6967363">var</span>&nbsp;<span class="ident" id="6967367">encryptTests</span>&nbsp;<span class="op" id="6967380">=</span>&nbsp;<span class="op" id="6967382">[</span><span class="op" id="6967383">]</span><span class="ident" id="6967384">CryptTest</span><span class="op" id="6967393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6967400">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967417">[</span><span class="op" id="6967418">]</span><span class="builtintype" id="6967419">byte</span><span class="op" id="6967423">{</span><span class="num" id="6967424">0x2b</span><span class="op" id="6967428">,</span>&nbsp;<span class="num" id="6967430">0x7e</span><span class="op" id="6967434">,</span>&nbsp;<span class="num" id="6967436">0x15</span><span class="op" id="6967440">,</span>&nbsp;<span class="num" id="6967442">0x16</span><span class="op" id="6967446">,</span>&nbsp;<span class="num" id="6967448">0x28</span><span class="op" id="6967452">,</span>&nbsp;<span class="num" id="6967454">0xae</span><span class="op" id="6967458">,</span>&nbsp;<span class="num" id="6967460">0xd2</span><span class="op" id="6967464">,</span>&nbsp;<span class="num" id="6967466">0xa6</span><span class="op" id="6967470">,</span>&nbsp;<span class="num" id="6967472">0xab</span><span class="op" id="6967476">,</span>&nbsp;<span class="num" id="6967478">0xf7</span><span class="op" id="6967482">,</span>&nbsp;<span class="num" id="6967484">0x15</span><span class="op" id="6967488">,</span>&nbsp;<span class="num" id="6967490">0x88</span><span class="op" id="6967494">,</span>&nbsp;<span class="num" id="6967496">0x09</span><span class="op" id="6967500">,</span>&nbsp;<span class="num" id="6967502">0xcf</span><span class="op" id="6967506">,</span>&nbsp;<span class="num" id="6967508">0x4f</span><span class="op" id="6967512">,</span>&nbsp;<span class="num" id="6967514">0x3c</span><span class="op" id="6967518">}</span><span class="op" id="6967519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967523">[</span><span class="op" id="6967524">]</span><span class="builtintype" id="6967525">byte</span><span class="op" id="6967529">{</span><span class="num" id="6967530">0x32</span><span class="op" id="6967534">,</span>&nbsp;<span class="num" id="6967536">0x43</span><span class="op" id="6967540">,</span>&nbsp;<span class="num" id="6967542">0xf6</span><span class="op" id="6967546">,</span>&nbsp;<span class="num" id="6967548">0xa8</span><span class="op" id="6967552">,</span>&nbsp;<span class="num" id="6967554">0x88</span><span class="op" id="6967558">,</span>&nbsp;<span class="num" id="6967560">0x5a</span><span class="op" id="6967564">,</span>&nbsp;<span class="num" id="6967566">0x30</span><span class="op" id="6967570">,</span>&nbsp;<span class="num" id="6967572">0x8d</span><span class="op" id="6967576">,</span>&nbsp;<span class="num" id="6967578">0x31</span><span class="op" id="6967582">,</span>&nbsp;<span class="num" id="6967584">0x31</span><span class="op" id="6967588">,</span>&nbsp;<span class="num" id="6967590">0x98</span><span class="op" id="6967594">,</span>&nbsp;<span class="num" id="6967596">0xa2</span><span class="op" id="6967600">,</span>&nbsp;<span class="num" id="6967602">0xe0</span><span class="op" id="6967606">,</span>&nbsp;<span class="num" id="6967608">0x37</span><span class="op" id="6967612">,</span>&nbsp;<span class="num" id="6967614">0x07</span><span class="op" id="6967618">,</span>&nbsp;<span class="num" id="6967620">0x34</span><span class="op" id="6967624">}</span><span class="op" id="6967625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967629">[</span><span class="op" id="6967630">]</span><span class="builtintype" id="6967631">byte</span><span class="op" id="6967635">{</span><span class="num" id="6967636">0x39</span><span class="op" id="6967640">,</span>&nbsp;<span class="num" id="6967642">0x25</span><span class="op" id="6967646">,</span>&nbsp;<span class="num" id="6967648">0x84</span><span class="op" id="6967652">,</span>&nbsp;<span class="num" id="6967654">0x1d</span><span class="op" id="6967658">,</span>&nbsp;<span class="num" id="6967660">0x02</span><span class="op" id="6967664">,</span>&nbsp;<span class="num" id="6967666">0xdc</span><span class="op" id="6967670">,</span>&nbsp;<span class="num" id="6967672">0x09</span><span class="op" id="6967676">,</span>&nbsp;<span class="num" id="6967678">0xfb</span><span class="op" id="6967682">,</span>&nbsp;<span class="num" id="6967684">0xdc</span><span class="op" id="6967688">,</span>&nbsp;<span class="num" id="6967690">0x11</span><span class="op" id="6967694">,</span>&nbsp;<span class="num" id="6967696">0x85</span><span class="op" id="6967700">,</span>&nbsp;<span class="num" id="6967702">0x97</span><span class="op" id="6967706">,</span>&nbsp;<span class="num" id="6967708">0x19</span><span class="op" id="6967712">,</span>&nbsp;<span class="num" id="6967714">0x6a</span><span class="op" id="6967718">,</span>&nbsp;<span class="num" id="6967720">0x0b</span><span class="op" id="6967724">,</span>&nbsp;<span class="num" id="6967726">0x32</span><span class="op" id="6967730">}</span><span class="op" id="6967731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967734">}</span><span class="op" id="6967735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967738">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6967742">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967770">[</span><span class="op" id="6967771">]</span><span class="builtintype" id="6967772">byte</span><span class="op" id="6967776">{</span><span class="num" id="6967777">0x00</span><span class="op" id="6967781">,</span>&nbsp;<span class="num" id="6967783">0x01</span><span class="op" id="6967787">,</span>&nbsp;<span class="num" id="6967789">0x02</span><span class="op" id="6967793">,</span>&nbsp;<span class="num" id="6967795">0x03</span><span class="op" id="6967799">,</span>&nbsp;<span class="num" id="6967801">0x04</span><span class="op" id="6967805">,</span>&nbsp;<span class="num" id="6967807">0x05</span><span class="op" id="6967811">,</span>&nbsp;<span class="num" id="6967813">0x06</span><span class="op" id="6967817">,</span>&nbsp;<span class="num" id="6967819">0x07</span><span class="op" id="6967823">,</span>&nbsp;<span class="num" id="6967825">0x08</span><span class="op" id="6967829">,</span>&nbsp;<span class="num" id="6967831">0x09</span><span class="op" id="6967835">,</span>&nbsp;<span class="num" id="6967837">0x0a</span><span class="op" id="6967841">,</span>&nbsp;<span class="num" id="6967843">0x0b</span><span class="op" id="6967847">,</span>&nbsp;<span class="num" id="6967849">0x0c</span><span class="op" id="6967853">,</span>&nbsp;<span class="num" id="6967855">0x0d</span><span class="op" id="6967859">,</span>&nbsp;<span class="num" id="6967861">0x0e</span><span class="op" id="6967865">,</span>&nbsp;<span class="num" id="6967867">0x0f</span><span class="op" id="6967871">}</span><span class="op" id="6967872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967876">[</span><span class="op" id="6967877">]</span><span class="builtintype" id="6967878">byte</span><span class="op" id="6967882">{</span><span class="num" id="6967883">0x00</span><span class="op" id="6967887">,</span>&nbsp;<span class="num" id="6967889">0x11</span><span class="op" id="6967893">,</span>&nbsp;<span class="num" id="6967895">0x22</span><span class="op" id="6967899">,</span>&nbsp;<span class="num" id="6967901">0x33</span><span class="op" id="6967905">,</span>&nbsp;<span class="num" id="6967907">0x44</span><span class="op" id="6967911">,</span>&nbsp;<span class="num" id="6967913">0x55</span><span class="op" id="6967917">,</span>&nbsp;<span class="num" id="6967919">0x66</span><span class="op" id="6967923">,</span>&nbsp;<span class="num" id="6967925">0x77</span><span class="op" id="6967929">,</span>&nbsp;<span class="num" id="6967931">0x88</span><span class="op" id="6967935">,</span>&nbsp;<span class="num" id="6967937">0x99</span><span class="op" id="6967941">,</span>&nbsp;<span class="num" id="6967943">0xaa</span><span class="op" id="6967947">,</span>&nbsp;<span class="num" id="6967949">0xbb</span><span class="op" id="6967953">,</span>&nbsp;<span class="num" id="6967955">0xcc</span><span class="op" id="6967959">,</span>&nbsp;<span class="num" id="6967961">0xdd</span><span class="op" id="6967965">,</span>&nbsp;<span class="num" id="6967967">0xee</span><span class="op" id="6967971">,</span>&nbsp;<span class="num" id="6967973">0xff</span><span class="op" id="6967977">}</span><span class="op" id="6967978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6967982">[</span><span class="op" id="6967983">]</span><span class="builtintype" id="6967984">byte</span><span class="op" id="6967988">{</span><span class="num" id="6967989">0x69</span><span class="op" id="6967993">,</span>&nbsp;<span class="num" id="6967995">0xc4</span><span class="op" id="6967999">,</span>&nbsp;<span class="num" id="6968001">0xe0</span><span class="op" id="6968005">,</span>&nbsp;<span class="num" id="6968007">0xd8</span><span class="op" id="6968011">,</span>&nbsp;<span class="num" id="6968013">0x6a</span><span class="op" id="6968017">,</span>&nbsp;<span class="num" id="6968019">0x7b</span><span class="op" id="6968023">,</span>&nbsp;<span class="num" id="6968025">0x04</span><span class="op" id="6968029">,</span>&nbsp;<span class="num" id="6968031">0x30</span><span class="op" id="6968035">,</span>&nbsp;<span class="num" id="6968037">0xd8</span><span class="op" id="6968041">,</span>&nbsp;<span class="num" id="6968043">0xcd</span><span class="op" id="6968047">,</span>&nbsp;<span class="num" id="6968049">0xb7</span><span class="op" id="6968053">,</span>&nbsp;<span class="num" id="6968055">0x80</span><span class="op" id="6968059">,</span>&nbsp;<span class="num" id="6968061">0x70</span><span class="op" id="6968065">,</span>&nbsp;<span class="num" id="6968067">0xb4</span><span class="op" id="6968071">,</span>&nbsp;<span class="num" id="6968073">0xc5</span><span class="op" id="6968077">,</span>&nbsp;<span class="num" id="6968079">0x5a</span><span class="op" id="6968083">}</span><span class="op" id="6968084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968087">}</span><span class="op" id="6968088">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6968095">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968123">[</span><span class="op" id="6968124">]</span><span class="builtintype" id="6968125">byte</span><span class="op" id="6968129">{</span><span class="num" id="6968130">0x00</span><span class="op" id="6968134">,</span>&nbsp;<span class="num" id="6968136">0x01</span><span class="op" id="6968140">,</span>&nbsp;<span class="num" id="6968142">0x02</span><span class="op" id="6968146">,</span>&nbsp;<span class="num" id="6968148">0x03</span><span class="op" id="6968152">,</span>&nbsp;<span class="num" id="6968154">0x04</span><span class="op" id="6968158">,</span>&nbsp;<span class="num" id="6968160">0x05</span><span class="op" id="6968164">,</span>&nbsp;<span class="num" id="6968166">0x06</span><span class="op" id="6968170">,</span>&nbsp;<span class="num" id="6968172">0x07</span><span class="op" id="6968176">,</span>&nbsp;<span class="num" id="6968178">0x08</span><span class="op" id="6968182">,</span>&nbsp;<span class="num" id="6968184">0x09</span><span class="op" id="6968188">,</span>&nbsp;<span class="num" id="6968190">0x0a</span><span class="op" id="6968194">,</span>&nbsp;<span class="num" id="6968196">0x0b</span><span class="op" id="6968200">,</span>&nbsp;<span class="num" id="6968202">0x0c</span><span class="op" id="6968206">,</span>&nbsp;<span class="num" id="6968208">0x0d</span><span class="op" id="6968212">,</span>&nbsp;<span class="num" id="6968214">0x0e</span><span class="op" id="6968218">,</span>&nbsp;<span class="num" id="6968220">0x0f</span><span class="op" id="6968224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6968229">0x10</span><span class="op" id="6968233">,</span>&nbsp;<span class="num" id="6968235">0x11</span><span class="op" id="6968239">,</span>&nbsp;<span class="num" id="6968241">0x12</span><span class="op" id="6968245">,</span>&nbsp;<span class="num" id="6968247">0x13</span><span class="op" id="6968251">,</span>&nbsp;<span class="num" id="6968253">0x14</span><span class="op" id="6968257">,</span>&nbsp;<span class="num" id="6968259">0x15</span><span class="op" id="6968263">,</span>&nbsp;<span class="num" id="6968265">0x16</span><span class="op" id="6968269">,</span>&nbsp;<span class="num" id="6968271">0x17</span><span class="op" id="6968275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968279">}</span><span class="op" id="6968280">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968284">[</span><span class="op" id="6968285">]</span><span class="builtintype" id="6968286">byte</span><span class="op" id="6968290">{</span><span class="num" id="6968291">0x00</span><span class="op" id="6968295">,</span>&nbsp;<span class="num" id="6968297">0x11</span><span class="op" id="6968301">,</span>&nbsp;<span class="num" id="6968303">0x22</span><span class="op" id="6968307">,</span>&nbsp;<span class="num" id="6968309">0x33</span><span class="op" id="6968313">,</span>&nbsp;<span class="num" id="6968315">0x44</span><span class="op" id="6968319">,</span>&nbsp;<span class="num" id="6968321">0x55</span><span class="op" id="6968325">,</span>&nbsp;<span class="num" id="6968327">0x66</span><span class="op" id="6968331">,</span>&nbsp;<span class="num" id="6968333">0x77</span><span class="op" id="6968337">,</span>&nbsp;<span class="num" id="6968339">0x88</span><span class="op" id="6968343">,</span>&nbsp;<span class="num" id="6968345">0x99</span><span class="op" id="6968349">,</span>&nbsp;<span class="num" id="6968351">0xaa</span><span class="op" id="6968355">,</span>&nbsp;<span class="num" id="6968357">0xbb</span><span class="op" id="6968361">,</span>&nbsp;<span class="num" id="6968363">0xcc</span><span class="op" id="6968367">,</span>&nbsp;<span class="num" id="6968369">0xdd</span><span class="op" id="6968373">,</span>&nbsp;<span class="num" id="6968375">0xee</span><span class="op" id="6968379">,</span>&nbsp;<span class="num" id="6968381">0xff</span><span class="op" id="6968385">}</span><span class="op" id="6968386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968390">[</span><span class="op" id="6968391">]</span><span class="builtintype" id="6968392">byte</span><span class="op" id="6968396">{</span><span class="num" id="6968397">0xdd</span><span class="op" id="6968401">,</span>&nbsp;<span class="num" id="6968403">0xa9</span><span class="op" id="6968407">,</span>&nbsp;<span class="num" id="6968409">0x7c</span><span class="op" id="6968413">,</span>&nbsp;<span class="num" id="6968415">0xa4</span><span class="op" id="6968419">,</span>&nbsp;<span class="num" id="6968421">0x86</span><span class="op" id="6968425">,</span>&nbsp;<span class="num" id="6968427">0x4c</span><span class="op" id="6968431">,</span>&nbsp;<span class="num" id="6968433">0xdf</span><span class="op" id="6968437">,</span>&nbsp;<span class="num" id="6968439">0xe0</span><span class="op" id="6968443">,</span>&nbsp;<span class="num" id="6968445">0x6e</span><span class="op" id="6968449">,</span>&nbsp;<span class="num" id="6968451">0xaf</span><span class="op" id="6968455">,</span>&nbsp;<span class="num" id="6968457">0x70</span><span class="op" id="6968461">,</span>&nbsp;<span class="num" id="6968463">0xa0</span><span class="op" id="6968467">,</span>&nbsp;<span class="num" id="6968469">0xec</span><span class="op" id="6968473">,</span>&nbsp;<span class="num" id="6968475">0x0d</span><span class="op" id="6968479">,</span>&nbsp;<span class="num" id="6968481">0x71</span><span class="op" id="6968485">,</span>&nbsp;<span class="num" id="6968487">0x91</span><span class="op" id="6968491">}</span><span class="op" id="6968492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968495">}</span><span class="op" id="6968496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6968503">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968531">[</span><span class="op" id="6968532">]</span><span class="builtintype" id="6968533">byte</span><span class="op" id="6968537">{</span><span class="num" id="6968538">0x00</span><span class="op" id="6968542">,</span>&nbsp;<span class="num" id="6968544">0x01</span><span class="op" id="6968548">,</span>&nbsp;<span class="num" id="6968550">0x02</span><span class="op" id="6968554">,</span>&nbsp;<span class="num" id="6968556">0x03</span><span class="op" id="6968560">,</span>&nbsp;<span class="num" id="6968562">0x04</span><span class="op" id="6968566">,</span>&nbsp;<span class="num" id="6968568">0x05</span><span class="op" id="6968572">,</span>&nbsp;<span class="num" id="6968574">0x06</span><span class="op" id="6968578">,</span>&nbsp;<span class="num" id="6968580">0x07</span><span class="op" id="6968584">,</span>&nbsp;<span class="num" id="6968586">0x08</span><span class="op" id="6968590">,</span>&nbsp;<span class="num" id="6968592">0x09</span><span class="op" id="6968596">,</span>&nbsp;<span class="num" id="6968598">0x0a</span><span class="op" id="6968602">,</span>&nbsp;<span class="num" id="6968604">0x0b</span><span class="op" id="6968608">,</span>&nbsp;<span class="num" id="6968610">0x0c</span><span class="op" id="6968614">,</span>&nbsp;<span class="num" id="6968616">0x0d</span><span class="op" id="6968620">,</span>&nbsp;<span class="num" id="6968622">0x0e</span><span class="op" id="6968626">,</span>&nbsp;<span class="num" id="6968628">0x0f</span><span class="op" id="6968632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6968637">0x10</span><span class="op" id="6968641">,</span>&nbsp;<span class="num" id="6968643">0x11</span><span class="op" id="6968647">,</span>&nbsp;<span class="num" id="6968649">0x12</span><span class="op" id="6968653">,</span>&nbsp;<span class="num" id="6968655">0x13</span><span class="op" id="6968659">,</span>&nbsp;<span class="num" id="6968661">0x14</span><span class="op" id="6968665">,</span>&nbsp;<span class="num" id="6968667">0x15</span><span class="op" id="6968671">,</span>&nbsp;<span class="num" id="6968673">0x16</span><span class="op" id="6968677">,</span>&nbsp;<span class="num" id="6968679">0x17</span><span class="op" id="6968683">,</span>&nbsp;<span class="num" id="6968685">0x18</span><span class="op" id="6968689">,</span>&nbsp;<span class="num" id="6968691">0x19</span><span class="op" id="6968695">,</span>&nbsp;<span class="num" id="6968697">0x1a</span><span class="op" id="6968701">,</span>&nbsp;<span class="num" id="6968703">0x1b</span><span class="op" id="6968707">,</span>&nbsp;<span class="num" id="6968709">0x1c</span><span class="op" id="6968713">,</span>&nbsp;<span class="num" id="6968715">0x1d</span><span class="op" id="6968719">,</span>&nbsp;<span class="num" id="6968721">0x1e</span><span class="op" id="6968725">,</span>&nbsp;<span class="num" id="6968727">0x1f</span><span class="op" id="6968731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968735">}</span><span class="op" id="6968736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968740">[</span><span class="op" id="6968741">]</span><span class="builtintype" id="6968742">byte</span><span class="op" id="6968746">{</span><span class="num" id="6968747">0x00</span><span class="op" id="6968751">,</span>&nbsp;<span class="num" id="6968753">0x11</span><span class="op" id="6968757">,</span>&nbsp;<span class="num" id="6968759">0x22</span><span class="op" id="6968763">,</span>&nbsp;<span class="num" id="6968765">0x33</span><span class="op" id="6968769">,</span>&nbsp;<span class="num" id="6968771">0x44</span><span class="op" id="6968775">,</span>&nbsp;<span class="num" id="6968777">0x55</span><span class="op" id="6968781">,</span>&nbsp;<span class="num" id="6968783">0x66</span><span class="op" id="6968787">,</span>&nbsp;<span class="num" id="6968789">0x77</span><span class="op" id="6968793">,</span>&nbsp;<span class="num" id="6968795">0x88</span><span class="op" id="6968799">,</span>&nbsp;<span class="num" id="6968801">0x99</span><span class="op" id="6968805">,</span>&nbsp;<span class="num" id="6968807">0xaa</span><span class="op" id="6968811">,</span>&nbsp;<span class="num" id="6968813">0xbb</span><span class="op" id="6968817">,</span>&nbsp;<span class="num" id="6968819">0xcc</span><span class="op" id="6968823">,</span>&nbsp;<span class="num" id="6968825">0xdd</span><span class="op" id="6968829">,</span>&nbsp;<span class="num" id="6968831">0xee</span><span class="op" id="6968835">,</span>&nbsp;<span class="num" id="6968837">0xff</span><span class="op" id="6968841">}</span><span class="op" id="6968842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968846">[</span><span class="op" id="6968847">]</span><span class="builtintype" id="6968848">byte</span><span class="op" id="6968852">{</span><span class="num" id="6968853">0x8e</span><span class="op" id="6968857">,</span>&nbsp;<span class="num" id="6968859">0xa2</span><span class="op" id="6968863">,</span>&nbsp;<span class="num" id="6968865">0xb7</span><span class="op" id="6968869">,</span>&nbsp;<span class="num" id="6968871">0xca</span><span class="op" id="6968875">,</span>&nbsp;<span class="num" id="6968877">0x51</span><span class="op" id="6968881">,</span>&nbsp;<span class="num" id="6968883">0x67</span><span class="op" id="6968887">,</span>&nbsp;<span class="num" id="6968889">0x45</span><span class="op" id="6968893">,</span>&nbsp;<span class="num" id="6968895">0xbf</span><span class="op" id="6968899">,</span>&nbsp;<span class="num" id="6968901">0xea</span><span class="op" id="6968905">,</span>&nbsp;<span class="num" id="6968907">0xfc</span><span class="op" id="6968911">,</span>&nbsp;<span class="num" id="6968913">0x49</span><span class="op" id="6968917">,</span>&nbsp;<span class="num" id="6968919">0x90</span><span class="op" id="6968923">,</span>&nbsp;<span class="num" id="6968925">0x4b</span><span class="op" id="6968929">,</span>&nbsp;<span class="num" id="6968931">0x49</span><span class="op" id="6968935">,</span>&nbsp;<span class="num" id="6968937">0x60</span><span class="op" id="6968941">,</span>&nbsp;<span class="num" id="6968943">0x89</span><span class="op" id="6968947">}</span><span class="op" id="6968948">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6968951">}</span><span class="op" id="6968952">,</span><br>
<span class="lineno"></span><span class="op" id="6968954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6968957">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6969005">func</span>&nbsp;<span class="ident" id="6969010">TestEncryptBlock</span><span class="op" id="6969026">(</span><span class="ident" id="6969027">t</span>&nbsp;<span class="op" id="6969029">*</span><span class="ident" id="6969030">testing</span><span class="op" id="6969037">.</span><span class="ident" id="6969038">T</span><span class="op" id="6969039">)</span>&nbsp;<span class="op" id="6969041">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969044">for</span>&nbsp;<span class="ident" id="6969048">i</span><span class="op" id="6969049">,</span>&nbsp;<span class="ident" id="6969051">tt</span>&nbsp;<span class="op" id="6969054">:=</span>&nbsp;<span class="keyword" id="6969057">range</span>&nbsp;<span class="ident" id="6969063">encryptTests</span>&nbsp;<span class="op" id="6969076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969080">n</span>&nbsp;<span class="op" id="6969082">:=</span>&nbsp;<span class="builtinfunc" id="6969085">len</span><span class="op" id="6969088">(</span><span class="ident" id="6969089">tt</span><span class="op" id="6969091">.</span><span class="ident" id="6969092">key</span><span class="op" id="6969095">)</span>&nbsp;<span class="op" id="6969097">+</span>&nbsp;<span class="num" id="6969099">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969104">enc</span>&nbsp;<span class="op" id="6969108">:=</span>&nbsp;<span class="builtinfunc" id="6969111">make</span><span class="op" id="6969115">(</span><span class="op" id="6969116">[</span><span class="op" id="6969117">]</span><span class="builtintype" id="6969118">uint32</span><span class="op" id="6969124">,</span>&nbsp;<span class="ident" id="6969126">n</span><span class="op" id="6969127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969131">dec</span>&nbsp;<span class="op" id="6969135">:=</span>&nbsp;<span class="builtinfunc" id="6969138">make</span><span class="op" id="6969142">(</span><span class="op" id="6969143">[</span><span class="op" id="6969144">]</span><span class="builtintype" id="6969145">uint32</span><span class="op" id="6969151">,</span>&nbsp;<span class="ident" id="6969153">n</span><span class="op" id="6969154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969158">expandKey</span><span class="op" id="6969167">(</span><span class="ident" id="6969168">tt</span><span class="op" id="6969170">.</span><span class="ident" id="6969171">key</span><span class="op" id="6969174">,</span>&nbsp;<span class="ident" id="6969176">enc</span><span class="op" id="6969179">,</span>&nbsp;<span class="ident" id="6969181">dec</span><span class="op" id="6969184">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969188">out</span>&nbsp;<span class="op" id="6969192">:=</span>&nbsp;<span class="builtinfunc" id="6969195">make</span><span class="op" id="6969199">(</span><span class="op" id="6969200">[</span><span class="op" id="6969201">]</span><span class="builtintype" id="6969202">byte</span><span class="op" id="6969206">,</span>&nbsp;<span class="builtinfunc" id="6969208">len</span><span class="op" id="6969211">(</span><span class="ident" id="6969212">tt</span><span class="op" id="6969214">.</span><span class="ident" id="6969215">in</span><span class="op" id="6969217">)</span><span class="op" id="6969218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969222">encryptBlock</span><span class="op" id="6969234">(</span><span class="ident" id="6969235">enc</span><span class="op" id="6969238">,</span>&nbsp;<span class="ident" id="6969240">out</span><span class="op" id="6969243">,</span>&nbsp;<span class="ident" id="6969245">tt</span><span class="op" id="6969247">.</span><span class="ident" id="6969248">in</span><span class="op" id="6969250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969254">for</span>&nbsp;<span class="ident" id="6969258">j</span><span class="op" id="6969259">,</span>&nbsp;<span class="ident" id="6969261">v</span>&nbsp;<span class="op" id="6969263">:=</span>&nbsp;<span class="keyword" id="6969266">range</span>&nbsp;<span class="ident" id="6969272">out</span>&nbsp;<span class="op" id="6969276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969281">if</span>&nbsp;<span class="ident" id="6969284">v</span>&nbsp;<span class="op" id="6969286">!=</span>&nbsp;<span class="ident" id="6969289">tt</span><span class="op" id="6969291">.</span><span class="ident" id="6969292">out</span><span class="op" id="6969295">[</span><span class="ident" id="6969296">j</span><span class="op" id="6969297">]</span>&nbsp;<span class="op" id="6969299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969305">t</span><span class="op" id="6969306">.</span><span class="ident" id="6969307">Errorf</span><span class="op" id="6969313">(</span><span class="string" id="6969314">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6969356">,</span>&nbsp;<span class="ident" id="6969358">i</span><span class="op" id="6969359">,</span>&nbsp;<span class="ident" id="6969361">j</span><span class="op" id="6969362">,</span>&nbsp;<span class="ident" id="6969364">v</span><span class="op" id="6969365">,</span>&nbsp;<span class="ident" id="6969367">tt</span><span class="op" id="6969369">.</span><span class="ident" id="6969370">out</span><span class="op" id="6969373">[</span><span class="ident" id="6969374">j</span><span class="op" id="6969375">]</span><span class="op" id="6969376">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969382">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969398">}</span><br>
<span class="lineno"></span><span class="op" id="6969400">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="6969403">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6969451">func</span>&nbsp;<span class="ident" id="6969456">TestDecryptBlock</span><span class="op" id="6969472">(</span><span class="ident" id="6969473">t</span>&nbsp;<span class="op" id="6969475">*</span><span class="ident" id="6969476">testing</span><span class="op" id="6969483">.</span><span class="ident" id="6969484">T</span><span class="op" id="6969485">)</span>&nbsp;<span class="op" id="6969487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969490">for</span>&nbsp;<span class="ident" id="6969494">i</span><span class="op" id="6969495">,</span>&nbsp;<span class="ident" id="6969497">tt</span>&nbsp;<span class="op" id="6969500">:=</span>&nbsp;<span class="keyword" id="6969503">range</span>&nbsp;<span class="ident" id="6969509">encryptTests</span>&nbsp;<span class="op" id="6969522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969526">n</span>&nbsp;<span class="op" id="6969528">:=</span>&nbsp;<span class="builtinfunc" id="6969531">len</span><span class="op" id="6969534">(</span><span class="ident" id="6969535">tt</span><span class="op" id="6969537">.</span><span class="ident" id="6969538">key</span><span class="op" id="6969541">)</span>&nbsp;<span class="op" id="6969543">+</span>&nbsp;<span class="num" id="6969545">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969550">enc</span>&nbsp;<span class="op" id="6969554">:=</span>&nbsp;<span class="builtinfunc" id="6969557">make</span><span class="op" id="6969561">(</span><span class="op" id="6969562">[</span><span class="op" id="6969563">]</span><span class="builtintype" id="6969564">uint32</span><span class="op" id="6969570">,</span>&nbsp;<span class="ident" id="6969572">n</span><span class="op" id="6969573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969577">dec</span>&nbsp;<span class="op" id="6969581">:=</span>&nbsp;<span class="builtinfunc" id="6969584">make</span><span class="op" id="6969588">(</span><span class="op" id="6969589">[</span><span class="op" id="6969590">]</span><span class="builtintype" id="6969591">uint32</span><span class="op" id="6969597">,</span>&nbsp;<span class="ident" id="6969599">n</span><span class="op" id="6969600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969604">expandKey</span><span class="op" id="6969613">(</span><span class="ident" id="6969614">tt</span><span class="op" id="6969616">.</span><span class="ident" id="6969617">key</span><span class="op" id="6969620">,</span>&nbsp;<span class="ident" id="6969622">enc</span><span class="op" id="6969625">,</span>&nbsp;<span class="ident" id="6969627">dec</span><span class="op" id="6969630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969634">plain</span>&nbsp;<span class="op" id="6969640">:=</span>&nbsp;<span class="builtinfunc" id="6969643">make</span><span class="op" id="6969647">(</span><span class="op" id="6969648">[</span><span class="op" id="6969649">]</span><span class="builtintype" id="6969650">byte</span><span class="op" id="6969654">,</span>&nbsp;<span class="builtinfunc" id="6969656">len</span><span class="op" id="6969659">(</span><span class="ident" id="6969660">tt</span><span class="op" id="6969662">.</span><span class="ident" id="6969663">in</span><span class="op" id="6969665">)</span><span class="op" id="6969666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969670">decryptBlock</span><span class="op" id="6969682">(</span><span class="ident" id="6969683">dec</span><span class="op" id="6969686">,</span>&nbsp;<span class="ident" id="6969688">plain</span><span class="op" id="6969693">,</span>&nbsp;<span class="ident" id="6969695">tt</span><span class="op" id="6969697">.</span><span class="ident" id="6969698">out</span><span class="op" id="6969701">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969705">for</span>&nbsp;<span class="ident" id="6969709">j</span><span class="op" id="6969710">,</span>&nbsp;<span class="ident" id="6969712">v</span>&nbsp;<span class="op" id="6969714">:=</span>&nbsp;<span class="keyword" id="6969717">range</span>&nbsp;<span class="ident" id="6969723">plain</span>&nbsp;<span class="op" id="6969729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969734">if</span>&nbsp;<span class="ident" id="6969737">v</span>&nbsp;<span class="op" id="6969739">!=</span>&nbsp;<span class="ident" id="6969742">tt</span><span class="op" id="6969744">.</span><span class="ident" id="6969745">in</span><span class="op" id="6969747">[</span><span class="ident" id="6969748">j</span><span class="op" id="6969749">]</span>&nbsp;<span class="op" id="6969751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969757">t</span><span class="op" id="6969758">.</span><span class="ident" id="6969759">Errorf</span><span class="op" id="6969765">(</span><span class="string" id="6969766">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6969810">,</span>&nbsp;<span class="ident" id="6969812">i</span><span class="op" id="6969813">,</span>&nbsp;<span class="ident" id="6969815">j</span><span class="op" id="6969816">,</span>&nbsp;<span class="ident" id="6969818">v</span><span class="op" id="6969819">,</span>&nbsp;<span class="ident" id="6969821">tt</span><span class="op" id="6969823">.</span><span class="ident" id="6969824">in</span><span class="op" id="6969826">[</span><span class="ident" id="6969827">j</span><span class="op" id="6969828">]</span><span class="op" id="6969829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969835">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969844">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6969851">}</span><br>
<span class="lineno"></span><span class="op" id="6969853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6969856">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="6969913">func</span>&nbsp;<span class="ident" id="6969918">TestCipherEncrypt</span><span class="op" id="6969935">(</span><span class="ident" id="6969936">t</span>&nbsp;<span class="op" id="6969938">*</span><span class="ident" id="6969939">testing</span><span class="op" id="6969946">.</span><span class="ident" id="6969947">T</span><span class="op" id="6969948">)</span>&nbsp;<span class="op" id="6969950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6969953">for</span>&nbsp;<span class="ident" id="6969957">i</span><span class="op" id="6969958">,</span>&nbsp;<span class="ident" id="6969960">tt</span>&nbsp;<span class="op" id="6969963">:=</span>&nbsp;<span class="keyword" id="6969966">range</span>&nbsp;<span class="ident" id="6969972">encryptTests</span>&nbsp;<span class="op" id="6969985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6969989">c</span><span class="op" id="6969990">,</span>&nbsp;<span class="ident" id="6969992">err</span>&nbsp;<span class="op" id="6969996">:=</span>&nbsp;<span class="ident" id="6969999">NewCipher</span><span class="op" id="6970008">(</span><span class="ident" id="6970009">tt</span><span class="op" id="6970011">.</span><span class="ident" id="6970012">key</span><span class="op" id="6970015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970019">if</span>&nbsp;<span class="ident" id="6970022">err</span>&nbsp;<span class="op" id="6970026">!=</span>&nbsp;<span class="ident" id="6970029">nil</span>&nbsp;<span class="op" id="6970033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970038">t</span><span class="op" id="6970039">.</span><span class="ident" id="6970040">Errorf</span><span class="op" id="6970046">(</span><span class="string" id="6970047">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6970073">,</span>&nbsp;<span class="builtinfunc" id="6970075">len</span><span class="op" id="6970078">(</span><span class="ident" id="6970079">tt</span><span class="op" id="6970081">.</span><span class="ident" id="6970082">key</span><span class="op" id="6970085">)</span><span class="op" id="6970086">,</span>&nbsp;<span class="ident" id="6970088">err</span><span class="op" id="6970091">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970111">out</span>&nbsp;<span class="op" id="6970115">:=</span>&nbsp;<span class="builtinfunc" id="6970118">make</span><span class="op" id="6970122">(</span><span class="op" id="6970123">[</span><span class="op" id="6970124">]</span><span class="builtintype" id="6970125">byte</span><span class="op" id="6970129">,</span>&nbsp;<span class="builtinfunc" id="6970131">len</span><span class="op" id="6970134">(</span><span class="ident" id="6970135">tt</span><span class="op" id="6970137">.</span><span class="ident" id="6970138">in</span><span class="op" id="6970140">)</span><span class="op" id="6970141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970145">c</span><span class="op" id="6970146">.</span><span class="ident" id="6970147">Encrypt</span><span class="op" id="6970154">(</span><span class="ident" id="6970155">out</span><span class="op" id="6970158">,</span>&nbsp;<span class="ident" id="6970160">tt</span><span class="op" id="6970162">.</span><span class="ident" id="6970163">in</span><span class="op" id="6970165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970169">for</span>&nbsp;<span class="ident" id="6970173">j</span><span class="op" id="6970174">,</span>&nbsp;<span class="ident" id="6970176">v</span>&nbsp;<span class="op" id="6970178">:=</span>&nbsp;<span class="keyword" id="6970181">range</span>&nbsp;<span class="ident" id="6970187">out</span>&nbsp;<span class="op" id="6970191">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970196">if</span>&nbsp;<span class="ident" id="6970199">v</span>&nbsp;<span class="op" id="6970201">!=</span>&nbsp;<span class="ident" id="6970204">tt</span><span class="op" id="6970206">.</span><span class="ident" id="6970207">out</span><span class="op" id="6970210">[</span><span class="ident" id="6970211">j</span><span class="op" id="6970212">]</span>&nbsp;<span class="op" id="6970214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970220">t</span><span class="op" id="6970221">.</span><span class="ident" id="6970222">Errorf</span><span class="op" id="6970228">(</span><span class="string" id="6970229">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6970273">,</span>&nbsp;<span class="ident" id="6970275">i</span><span class="op" id="6970276">,</span>&nbsp;<span class="ident" id="6970278">j</span><span class="op" id="6970279">,</span>&nbsp;<span class="ident" id="6970281">v</span><span class="op" id="6970282">,</span>&nbsp;<span class="ident" id="6970284">tt</span><span class="op" id="6970286">.</span><span class="ident" id="6970287">out</span><span class="op" id="6970290">[</span><span class="ident" id="6970291">j</span><span class="op" id="6970292">]</span><span class="op" id="6970293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970299">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970312">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970315">}</span><br>
<span class="lineno"></span><span class="op" id="6970317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6970320">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6970370">func</span>&nbsp;<span class="ident" id="6970375">TestCipherDecrypt</span><span class="op" id="6970392">(</span><span class="ident" id="6970393">t</span>&nbsp;<span class="op" id="6970395">*</span><span class="ident" id="6970396">testing</span><span class="op" id="6970403">.</span><span class="ident" id="6970404">T</span><span class="op" id="6970405">)</span>&nbsp;<span class="op" id="6970407">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970410">for</span>&nbsp;<span class="ident" id="6970414">i</span><span class="op" id="6970415">,</span>&nbsp;<span class="ident" id="6970417">tt</span>&nbsp;<span class="op" id="6970420">:=</span>&nbsp;<span class="keyword" id="6970423">range</span>&nbsp;<span class="ident" id="6970429">encryptTests</span>&nbsp;<span class="op" id="6970442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970446">c</span><span class="op" id="6970447">,</span>&nbsp;<span class="ident" id="6970449">err</span>&nbsp;<span class="op" id="6970453">:=</span>&nbsp;<span class="ident" id="6970456">NewCipher</span><span class="op" id="6970465">(</span><span class="ident" id="6970466">tt</span><span class="op" id="6970468">.</span><span class="ident" id="6970469">key</span><span class="op" id="6970472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970476">if</span>&nbsp;<span class="ident" id="6970479">err</span>&nbsp;<span class="op" id="6970483">!=</span>&nbsp;<span class="ident" id="6970486">nil</span>&nbsp;<span class="op" id="6970490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970495">t</span><span class="op" id="6970496">.</span><span class="ident" id="6970497">Errorf</span><span class="op" id="6970503">(</span><span class="string" id="6970504">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6970530">,</span>&nbsp;<span class="builtinfunc" id="6970532">len</span><span class="op" id="6970535">(</span><span class="ident" id="6970536">tt</span><span class="op" id="6970538">.</span><span class="ident" id="6970539">key</span><span class="op" id="6970542">)</span><span class="op" id="6970543">,</span>&nbsp;<span class="ident" id="6970545">err</span><span class="op" id="6970548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970553">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970568">plain</span>&nbsp;<span class="op" id="6970574">:=</span>&nbsp;<span class="builtinfunc" id="6970577">make</span><span class="op" id="6970581">(</span><span class="op" id="6970582">[</span><span class="op" id="6970583">]</span><span class="builtintype" id="6970584">byte</span><span class="op" id="6970588">,</span>&nbsp;<span class="builtinfunc" id="6970590">len</span><span class="op" id="6970593">(</span><span class="ident" id="6970594">tt</span><span class="op" id="6970596">.</span><span class="ident" id="6970597">in</span><span class="op" id="6970599">)</span><span class="op" id="6970600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970604">c</span><span class="op" id="6970605">.</span><span class="ident" id="6970606">Decrypt</span><span class="op" id="6970613">(</span><span class="ident" id="6970614">plain</span><span class="op" id="6970619">,</span>&nbsp;<span class="ident" id="6970621">tt</span><span class="op" id="6970623">.</span><span class="ident" id="6970624">out</span><span class="op" id="6970627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970631">for</span>&nbsp;<span class="ident" id="6970635">j</span><span class="op" id="6970636">,</span>&nbsp;<span class="ident" id="6970638">v</span>&nbsp;<span class="op" id="6970640">:=</span>&nbsp;<span class="keyword" id="6970643">range</span>&nbsp;<span class="ident" id="6970649">plain</span>&nbsp;<span class="op" id="6970655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970660">if</span>&nbsp;<span class="ident" id="6970663">v</span>&nbsp;<span class="op" id="6970665">!=</span>&nbsp;<span class="ident" id="6970668">tt</span><span class="op" id="6970670">.</span><span class="ident" id="6970671">in</span><span class="op" id="6970673">[</span><span class="ident" id="6970674">j</span><span class="op" id="6970675">]</span>&nbsp;<span class="op" id="6970677">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970683">t</span><span class="op" id="6970684">.</span><span class="ident" id="6970685">Errorf</span><span class="op" id="6970691">(</span><span class="string" id="6970692">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6970736">,</span>&nbsp;<span class="ident" id="6970738">i</span><span class="op" id="6970739">,</span>&nbsp;<span class="ident" id="6970741">j</span><span class="op" id="6970742">,</span>&nbsp;<span class="ident" id="6970744">v</span><span class="op" id="6970745">,</span>&nbsp;<span class="ident" id="6970747">tt</span><span class="op" id="6970749">.</span><span class="ident" id="6970750">in</span><span class="op" id="6970752">[</span><span class="ident" id="6970753">j</span><span class="op" id="6970754">]</span><span class="op" id="6970755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6970761">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6970777">}</span><br>
<span class="lineno">355</span><span class="op" id="6970779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6970782">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="6970810">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="6970842">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="6970861">func</span>&nbsp;<span class="ident" id="6970866">TestShortBlocks</span><span class="op" id="6970881">(</span><span class="ident" id="6970882">t</span>&nbsp;<span class="op" id="6970884">*</span><span class="ident" id="6970885">testing</span><span class="op" id="6970892">.</span><span class="ident" id="6970893">T</span><span class="op" id="6970894">)</span>&nbsp;<span class="op" id="6970896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970899">bytes</span>&nbsp;<span class="op" id="6970905">:=</span>&nbsp;<span class="keyword" id="6970908">func</span><span class="op" id="6970912">(</span><span class="ident" id="6970913">n</span>&nbsp;<span class="builtintype" id="6970915">int</span><span class="op" id="6970918">)</span>&nbsp;<span class="op" id="6970920">[</span><span class="op" id="6970921">]</span><span class="builtintype" id="6970922">byte</span>&nbsp;<span class="op" id="6970927">{</span>&nbsp;<span class="keyword" id="6970929">return</span>&nbsp;<span class="builtinfunc" id="6970936">make</span><span class="op" id="6970940">(</span><span class="op" id="6970941">[</span><span class="op" id="6970942">]</span><span class="builtintype" id="6970943">byte</span><span class="op" id="6970947">,</span>&nbsp;<span class="ident" id="6970949">n</span><span class="op" id="6970950">)</span>&nbsp;<span class="op" id="6970952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970956">c</span><span class="op" id="6970957">,</span>&nbsp;<span class="ident" id="6970959">_</span>&nbsp;<span class="op" id="6970961">:=</span>&nbsp;<span class="ident" id="6970964">NewCipher</span><span class="op" id="6970973">(</span><span class="ident" id="6970974">bytes</span><span class="op" id="6970979">(</span><span class="num" id="6970980">16</span><span class="op" id="6970982">)</span><span class="op" id="6970983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6970987">mustPanic</span><span class="op" id="6970996">(</span><span class="ident" id="6970997">t</span><span class="op" id="6970998">,</span>&nbsp;<span class="string" id="6971000">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971034">,</span>&nbsp;<span class="keyword" id="6971036">func</span><span class="op" id="6971040">(</span><span class="op" id="6971041">)</span>&nbsp;<span class="op" id="6971043">{</span>&nbsp;<span class="ident" id="6971045">c</span><span class="op" id="6971046">.</span><span class="ident" id="6971047">Encrypt</span><span class="op" id="6971054">(</span><span class="ident" id="6971055">bytes</span><span class="op" id="6971060">(</span><span class="num" id="6971061">1</span><span class="op" id="6971062">)</span><span class="op" id="6971063">,</span>&nbsp;<span class="ident" id="6971065">bytes</span><span class="op" id="6971070">(</span><span class="num" id="6971071">1</span><span class="op" id="6971072">)</span><span class="op" id="6971073">)</span>&nbsp;<span class="op" id="6971075">}</span><span class="op" id="6971076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971079">mustPanic</span><span class="op" id="6971088">(</span><span class="ident" id="6971089">t</span><span class="op" id="6971090">,</span>&nbsp;<span class="string" id="6971092">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971126">,</span>&nbsp;<span class="keyword" id="6971128">func</span><span class="op" id="6971132">(</span><span class="op" id="6971133">)</span>&nbsp;<span class="op" id="6971135">{</span>&nbsp;<span class="ident" id="6971137">c</span><span class="op" id="6971138">.</span><span class="ident" id="6971139">Decrypt</span><span class="op" id="6971146">(</span><span class="ident" id="6971147">bytes</span><span class="op" id="6971152">(</span><span class="num" id="6971153">1</span><span class="op" id="6971154">)</span><span class="op" id="6971155">,</span>&nbsp;<span class="ident" id="6971157">bytes</span><span class="op" id="6971162">(</span><span class="num" id="6971163">1</span><span class="op" id="6971164">)</span><span class="op" id="6971165">)</span>&nbsp;<span class="op" id="6971167">}</span><span class="op" id="6971168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971171">mustPanic</span><span class="op" id="6971180">(</span><span class="ident" id="6971181">t</span><span class="op" id="6971182">,</span>&nbsp;<span class="string" id="6971184">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971218">,</span>&nbsp;<span class="keyword" id="6971220">func</span><span class="op" id="6971224">(</span><span class="op" id="6971225">)</span>&nbsp;<span class="op" id="6971227">{</span>&nbsp;<span class="ident" id="6971229">c</span><span class="op" id="6971230">.</span><span class="ident" id="6971231">Encrypt</span><span class="op" id="6971238">(</span><span class="ident" id="6971239">bytes</span><span class="op" id="6971244">(</span><span class="num" id="6971245">100</span><span class="op" id="6971248">)</span><span class="op" id="6971249">,</span>&nbsp;<span class="ident" id="6971251">bytes</span><span class="op" id="6971256">(</span><span class="num" id="6971257">1</span><span class="op" id="6971258">)</span><span class="op" id="6971259">)</span>&nbsp;<span class="op" id="6971261">}</span><span class="op" id="6971262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971265">mustPanic</span><span class="op" id="6971274">(</span><span class="ident" id="6971275">t</span><span class="op" id="6971276">,</span>&nbsp;<span class="string" id="6971278">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971312">,</span>&nbsp;<span class="keyword" id="6971314">func</span><span class="op" id="6971318">(</span><span class="op" id="6971319">)</span>&nbsp;<span class="op" id="6971321">{</span>&nbsp;<span class="ident" id="6971323">c</span><span class="op" id="6971324">.</span><span class="ident" id="6971325">Decrypt</span><span class="op" id="6971332">(</span><span class="ident" id="6971333">bytes</span><span class="op" id="6971338">(</span><span class="num" id="6971339">100</span><span class="op" id="6971342">)</span><span class="op" id="6971343">,</span>&nbsp;<span class="ident" id="6971345">bytes</span><span class="op" id="6971350">(</span><span class="num" id="6971351">1</span><span class="op" id="6971352">)</span><span class="op" id="6971353">)</span>&nbsp;<span class="op" id="6971355">}</span><span class="op" id="6971356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971359">mustPanic</span><span class="op" id="6971368">(</span><span class="ident" id="6971369">t</span><span class="op" id="6971370">,</span>&nbsp;<span class="string" id="6971372">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971407">,</span>&nbsp;<span class="keyword" id="6971409">func</span><span class="op" id="6971413">(</span><span class="op" id="6971414">)</span>&nbsp;<span class="op" id="6971416">{</span>&nbsp;<span class="ident" id="6971418">c</span><span class="op" id="6971419">.</span><span class="ident" id="6971420">Encrypt</span><span class="op" id="6971427">(</span><span class="ident" id="6971428">bytes</span><span class="op" id="6971433">(</span><span class="num" id="6971434">1</span><span class="op" id="6971435">)</span><span class="op" id="6971436">,</span>&nbsp;<span class="ident" id="6971438">bytes</span><span class="op" id="6971443">(</span><span class="num" id="6971444">100</span><span class="op" id="6971447">)</span><span class="op" id="6971448">)</span>&nbsp;<span class="op" id="6971450">}</span><span class="op" id="6971451">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971454">mustPanic</span><span class="op" id="6971463">(</span><span class="ident" id="6971464">t</span><span class="op" id="6971465">,</span>&nbsp;<span class="string" id="6971467">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6971502">,</span>&nbsp;<span class="keyword" id="6971504">func</span><span class="op" id="6971508">(</span><span class="op" id="6971509">)</span>&nbsp;<span class="op" id="6971511">{</span>&nbsp;<span class="ident" id="6971513">c</span><span class="op" id="6971514">.</span><span class="ident" id="6971515">Decrypt</span><span class="op" id="6971522">(</span><span class="ident" id="6971523">bytes</span><span class="op" id="6971528">(</span><span class="num" id="6971529">1</span><span class="op" id="6971530">)</span><span class="op" id="6971531">,</span>&nbsp;<span class="ident" id="6971533">bytes</span><span class="op" id="6971538">(</span><span class="num" id="6971539">100</span><span class="op" id="6971542">)</span><span class="op" id="6971543">)</span>&nbsp;<span class="op" id="6971545">}</span><span class="op" id="6971546">)</span><br>
<span class="lineno"></span><span class="op" id="6971548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6971551">func</span>&nbsp;<span class="ident" id="6971556">mustPanic</span><span class="op" id="6971565">(</span><span class="ident" id="6971566">t</span>&nbsp;<span class="op" id="6971568">*</span><span class="ident" id="6971569">testing</span><span class="op" id="6971576">.</span><span class="ident" id="6971577">T</span><span class="op" id="6971578">,</span>&nbsp;<span class="ident" id="6971580">msg</span>&nbsp;<span class="builtintype" id="6971584">string</span><span class="op" id="6971590">,</span>&nbsp;<span class="ident" id="6971592">f</span>&nbsp;<span class="keyword" id="6971594">func</span><span class="op" id="6971598">(</span><span class="op" id="6971599">)</span><span class="op" id="6971600">)</span>&nbsp;<span class="op" id="6971602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971605">defer</span>&nbsp;<span class="keyword" id="6971611">func</span><span class="op" id="6971615">(</span><span class="op" id="6971616">)</span>&nbsp;<span class="op" id="6971618">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971622">err</span>&nbsp;<span class="op" id="6971626">:=</span>&nbsp;<span class="builtinfunc" id="6971629">recover</span><span class="op" id="6971636">(</span><span class="op" id="6971637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971641">if</span>&nbsp;<span class="ident" id="6971644">err</span>&nbsp;<span class="op" id="6971648">==</span>&nbsp;<span class="ident" id="6971651">nil</span>&nbsp;<span class="op" id="6971655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971660">t</span><span class="op" id="6971661">.</span><span class="ident" id="6971662">Errorf</span><span class="op" id="6971668">(</span><span class="string" id="6971669">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6971704">,</span>&nbsp;<span class="ident" id="6971706">msg</span><span class="op" id="6971709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971713">}</span>&nbsp;<span class="keyword" id="6971715">else</span>&nbsp;<span class="keyword" id="6971720">if</span>&nbsp;<span class="ident" id="6971723">err</span>&nbsp;<span class="op" id="6971727">!=</span>&nbsp;<span class="ident" id="6971730">msg</span>&nbsp;<span class="op" id="6971734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971739">t</span><span class="op" id="6971740">.</span><span class="ident" id="6971741">Errorf</span><span class="op" id="6971747">(</span><span class="string" id="6971748">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6971773">,</span>&nbsp;<span class="ident" id="6971775">err</span><span class="op" id="6971778">,</span>&nbsp;<span class="ident" id="6971780">msg</span><span class="op" id="6971783">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971790">}</span><span class="op" id="6971791">(</span><span class="op" id="6971792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971795">f</span><span class="op" id="6971796">(</span><span class="op" id="6971797">)</span><br>
<span class="lineno"></span><span class="op" id="6971799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6971802">func</span>&nbsp;<span class="ident" id="6971807">BenchmarkEncrypt</span><span class="op" id="6971823">(</span><span class="ident" id="6971824">b</span>&nbsp;<span class="op" id="6971826">*</span><span class="ident" id="6971827">testing</span><span class="op" id="6971834">.</span><span class="ident" id="6971835">B</span><span class="op" id="6971836">)</span>&nbsp;<span class="op" id="6971838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971841">tt</span>&nbsp;<span class="op" id="6971844">:=</span>&nbsp;<span class="ident" id="6971847">encryptTests</span><span class="op" id="6971859">[</span><span class="num" id="6971860">0</span><span class="op" id="6971861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971864">c</span><span class="op" id="6971865">,</span>&nbsp;<span class="ident" id="6971867">err</span>&nbsp;<span class="op" id="6971871">:=</span>&nbsp;<span class="ident" id="6971874">NewCipher</span><span class="op" id="6971883">(</span><span class="ident" id="6971884">tt</span><span class="op" id="6971886">.</span><span class="ident" id="6971887">key</span><span class="op" id="6971890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6971893">if</span>&nbsp;<span class="ident" id="6971896">err</span>&nbsp;<span class="op" id="6971900">!=</span>&nbsp;<span class="ident" id="6971903">nil</span>&nbsp;<span class="op" id="6971907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971911">b</span><span class="op" id="6971912">.</span><span class="ident" id="6971913">Fatal</span><span class="op" id="6971918">(</span><span class="string" id="6971919">&#34;NewCipher:&#34;</span><span class="op" id="6971931">,</span>&nbsp;<span class="ident" id="6971933">err</span><span class="op" id="6971936">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6971939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971942">out</span>&nbsp;<span class="op" id="6971946">:=</span>&nbsp;<span class="builtinfunc" id="6971949">make</span><span class="op" id="6971953">(</span><span class="op" id="6971954">[</span><span class="op" id="6971955">]</span><span class="builtintype" id="6971956">byte</span><span class="op" id="6971960">,</span>&nbsp;<span class="builtinfunc" id="6971962">len</span><span class="op" id="6971965">(</span><span class="ident" id="6971966">tt</span><span class="op" id="6971968">.</span><span class="ident" id="6971969">in</span><span class="op" id="6971971">)</span><span class="op" id="6971972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6971975">b</span><span class="op" id="6971976">.</span><span class="ident" id="6971977">SetBytes</span><span class="op" id="6971985">(</span><span class="ident" id="6971986">int64</span><span class="op" id="6971991">(</span><span class="builtinfunc" id="6971992">len</span><span class="op" id="6971995">(</span><span class="ident" id="6971996">out</span><span class="op" id="6971999">)</span><span class="op" id="6972000">)</span><span class="op" id="6972001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972004">b</span><span class="op" id="6972005">.</span><span class="ident" id="6972006">ResetTimer</span><span class="op" id="6972016">(</span><span class="op" id="6972017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972020">for</span>&nbsp;<span class="ident" id="6972024">i</span>&nbsp;<span class="op" id="6972026">:=</span>&nbsp;<span class="num" id="6972029">0</span><span class="op" id="6972030">;</span>&nbsp;<span class="ident" id="6972032">i</span>&nbsp;<span class="op" id="6972034">&lt;</span>&nbsp;<span class="ident" id="6972036">b</span><span class="op" id="6972037">.</span><span class="ident" id="6972038">N</span><span class="op" id="6972039">;</span>&nbsp;<span class="ident" id="6972041">i</span><span class="op" id="6972042">++</span>&nbsp;<span class="op" id="6972045">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972049">c</span><span class="op" id="6972050">.</span><span class="ident" id="6972051">Encrypt</span><span class="op" id="6972058">(</span><span class="ident" id="6972059">out</span><span class="op" id="6972062">,</span>&nbsp;<span class="ident" id="6972064">tt</span><span class="op" id="6972066">.</span><span class="ident" id="6972067">in</span><span class="op" id="6972069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972072">}</span><br>
<span class="lineno"></span><span class="op" id="6972074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6972077">func</span>&nbsp;<span class="ident" id="6972082">BenchmarkDecrypt</span><span class="op" id="6972098">(</span><span class="ident" id="6972099">b</span>&nbsp;<span class="op" id="6972101">*</span><span class="ident" id="6972102">testing</span><span class="op" id="6972109">.</span><span class="ident" id="6972110">B</span><span class="op" id="6972111">)</span>&nbsp;<span class="op" id="6972113">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972116">tt</span>&nbsp;<span class="op" id="6972119">:=</span>&nbsp;<span class="ident" id="6972122">encryptTests</span><span class="op" id="6972134">[</span><span class="num" id="6972135">0</span><span class="op" id="6972136">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972139">c</span><span class="op" id="6972140">,</span>&nbsp;<span class="ident" id="6972142">err</span>&nbsp;<span class="op" id="6972146">:=</span>&nbsp;<span class="ident" id="6972149">NewCipher</span><span class="op" id="6972158">(</span><span class="ident" id="6972159">tt</span><span class="op" id="6972161">.</span><span class="ident" id="6972162">key</span><span class="op" id="6972165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972168">if</span>&nbsp;<span class="ident" id="6972171">err</span>&nbsp;<span class="op" id="6972175">!=</span>&nbsp;<span class="ident" id="6972178">nil</span>&nbsp;<span class="op" id="6972182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972186">b</span><span class="op" id="6972187">.</span><span class="ident" id="6972188">Fatal</span><span class="op" id="6972193">(</span><span class="string" id="6972194">&#34;NewCipher:&#34;</span><span class="op" id="6972206">,</span>&nbsp;<span class="ident" id="6972208">err</span><span class="op" id="6972211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972214">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972217">out</span>&nbsp;<span class="op" id="6972221">:=</span>&nbsp;<span class="builtinfunc" id="6972224">make</span><span class="op" id="6972228">(</span><span class="op" id="6972229">[</span><span class="op" id="6972230">]</span><span class="builtintype" id="6972231">byte</span><span class="op" id="6972235">,</span>&nbsp;<span class="builtinfunc" id="6972237">len</span><span class="op" id="6972240">(</span><span class="ident" id="6972241">tt</span><span class="op" id="6972243">.</span><span class="ident" id="6972244">out</span><span class="op" id="6972247">)</span><span class="op" id="6972248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972251">b</span><span class="op" id="6972252">.</span><span class="ident" id="6972253">SetBytes</span><span class="op" id="6972261">(</span><span class="ident" id="6972262">int64</span><span class="op" id="6972267">(</span><span class="builtinfunc" id="6972268">len</span><span class="op" id="6972271">(</span><span class="ident" id="6972272">out</span><span class="op" id="6972275">)</span><span class="op" id="6972276">)</span><span class="op" id="6972277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972280">b</span><span class="op" id="6972281">.</span><span class="ident" id="6972282">ResetTimer</span><span class="op" id="6972292">(</span><span class="op" id="6972293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972296">for</span>&nbsp;<span class="ident" id="6972300">i</span>&nbsp;<span class="op" id="6972302">:=</span>&nbsp;<span class="num" id="6972305">0</span><span class="op" id="6972306">;</span>&nbsp;<span class="ident" id="6972308">i</span>&nbsp;<span class="op" id="6972310">&lt;</span>&nbsp;<span class="ident" id="6972312">b</span><span class="op" id="6972313">.</span><span class="ident" id="6972314">N</span><span class="op" id="6972315">;</span>&nbsp;<span class="ident" id="6972317">i</span><span class="op" id="6972318">++</span>&nbsp;<span class="op" id="6972321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972325">c</span><span class="op" id="6972326">.</span><span class="ident" id="6972327">Decrypt</span><span class="op" id="6972334">(</span><span class="ident" id="6972335">out</span><span class="op" id="6972338">,</span>&nbsp;<span class="ident" id="6972340">tt</span><span class="op" id="6972342">.</span><span class="ident" id="6972343">out</span><span class="op" id="6972346">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972349">}</span><br>
<span class="lineno"></span><span class="op" id="6972351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6972354">func</span>&nbsp;<span class="ident" id="6972359">BenchmarkExpand</span><span class="op" id="6972374">(</span><span class="ident" id="6972375">b</span>&nbsp;<span class="op" id="6972377">*</span><span class="ident" id="6972378">testing</span><span class="op" id="6972385">.</span><span class="ident" id="6972386">B</span><span class="op" id="6972387">)</span>&nbsp;<span class="op" id="6972389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972392">tt</span>&nbsp;<span class="op" id="6972395">:=</span>&nbsp;<span class="ident" id="6972398">encryptTests</span><span class="op" id="6972410">[</span><span class="num" id="6972411">0</span><span class="op" id="6972412">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972415">n</span>&nbsp;<span class="op" id="6972417">:=</span>&nbsp;<span class="builtinfunc" id="6972420">len</span><span class="op" id="6972423">(</span><span class="ident" id="6972424">tt</span><span class="op" id="6972426">.</span><span class="ident" id="6972427">key</span><span class="op" id="6972430">)</span>&nbsp;<span class="op" id="6972432">+</span>&nbsp;<span class="num" id="6972434">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972438">c</span>&nbsp;<span class="op" id="6972440">:=</span>&nbsp;<span class="op" id="6972443">&amp;</span><span class="ident" id="6972444">aesCipher</span><span class="op" id="6972453">{</span><span class="builtinfunc" id="6972454">make</span><span class="op" id="6972458">(</span><span class="op" id="6972459">[</span><span class="op" id="6972460">]</span><span class="builtintype" id="6972461">uint32</span><span class="op" id="6972467">,</span>&nbsp;<span class="ident" id="6972469">n</span><span class="op" id="6972470">)</span><span class="op" id="6972471">,</span>&nbsp;<span class="builtinfunc" id="6972473">make</span><span class="op" id="6972477">(</span><span class="op" id="6972478">[</span><span class="op" id="6972479">]</span><span class="builtintype" id="6972480">uint32</span><span class="op" id="6972486">,</span>&nbsp;<span class="ident" id="6972488">n</span><span class="op" id="6972489">)</span><span class="op" id="6972490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972493">b</span><span class="op" id="6972494">.</span><span class="ident" id="6972495">ResetTimer</span><span class="op" id="6972505">(</span><span class="op" id="6972506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6972509">for</span>&nbsp;<span class="ident" id="6972513">i</span>&nbsp;<span class="op" id="6972515">:=</span>&nbsp;<span class="num" id="6972518">0</span><span class="op" id="6972519">;</span>&nbsp;<span class="ident" id="6972521">i</span>&nbsp;<span class="op" id="6972523">&lt;</span>&nbsp;<span class="ident" id="6972525">b</span><span class="op" id="6972526">.</span><span class="ident" id="6972527">N</span><span class="op" id="6972528">;</span>&nbsp;<span class="ident" id="6972530">i</span><span class="op" id="6972531">++</span>&nbsp;<span class="op" id="6972534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6972538">expandKey</span><span class="op" id="6972547">(</span><span class="ident" id="6972548">tt</span><span class="op" id="6972550">.</span><span class="ident" id="6972551">key</span><span class="op" id="6972554">,</span>&nbsp;<span class="ident" id="6972556">c</span><span class="op" id="6972557">.</span><span class="ident" id="6972558">enc</span><span class="op" id="6972561">,</span>&nbsp;<span class="ident" id="6972563">c</span><span class="op" id="6972564">.</span><span class="ident" id="6972565">dec</span><span class="op" id="6972568">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6972571">}</span><br>
<span class="lineno"></span><span class="op" id="6972573">}</span>
</div>
</body>
</html>
