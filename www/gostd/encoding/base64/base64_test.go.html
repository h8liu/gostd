<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7441581">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7441636">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7441690">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7441741">package</span>&nbsp;<span class="ident" id="7441749">base64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7441757">import</span>&nbsp;<span class="op" id="7441764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441767">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441776">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441786">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441792">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441805">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441816">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441827">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7441838">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7441845">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7441848">type</span>&nbsp;<span class="ident" id="7441853">testpair</span>&nbsp;<span class="keyword" id="7441862">struct</span>&nbsp;<span class="op" id="7441869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7441872">decoded</span><span class="op" id="7441879">,</span>&nbsp;<span class="ident" id="7441881">encoded</span>&nbsp;<span class="builtintype" id="7441889">string</span><br>
<span class="lineno">20</span><span class="op" id="7441896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7441899">var</span>&nbsp;<span class="ident" id="7441903">pairs</span>&nbsp;<span class="op" id="7441909">=</span>&nbsp;<span class="op" id="7441911">[</span><span class="op" id="7441912">]</span><span class="ident" id="7441913">testpair</span><span class="op" id="7441921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7441924">//&nbsp;RFC&nbsp;3548&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441946">{</span><span class="string" id="7441947">&#34;\x14\xfb\x9c\x03\xd9\x7e&#34;</span><span class="op" id="7441973">,</span>&nbsp;<span class="string" id="7441975">&#34;FPucA9l+&#34;</span><span class="op" id="7441985">}</span><span class="op" id="7441986">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7441989">{</span><span class="string" id="7441990">&#34;\x14\xfb\x9c\x03\xd9&#34;</span><span class="op" id="7442012">,</span>&nbsp;<span class="string" id="7442014">&#34;FPucA9k=&#34;</span><span class="op" id="7442024">}</span><span class="op" id="7442025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442028">{</span><span class="string" id="7442029">&#34;\x14\xfb\x9c\x03&#34;</span><span class="op" id="7442047">,</span>&nbsp;<span class="string" id="7442049">&#34;FPucAw==&#34;</span><span class="op" id="7442059">}</span><span class="op" id="7442060">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442064">//&nbsp;RFC&nbsp;4648&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442086">{</span><span class="string" id="7442087">&#34;&#34;</span><span class="op" id="7442089">,</span>&nbsp;<span class="string" id="7442091">&#34;&#34;</span><span class="op" id="7442093">}</span><span class="op" id="7442094">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442097">{</span><span class="string" id="7442098">&#34;f&#34;</span><span class="op" id="7442101">,</span>&nbsp;<span class="string" id="7442103">&#34;Zg==&#34;</span><span class="op" id="7442109">}</span><span class="op" id="7442110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442113">{</span><span class="string" id="7442114">&#34;fo&#34;</span><span class="op" id="7442118">,</span>&nbsp;<span class="string" id="7442120">&#34;Zm8=&#34;</span><span class="op" id="7442126">}</span><span class="op" id="7442127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442130">{</span><span class="string" id="7442131">&#34;foo&#34;</span><span class="op" id="7442136">,</span>&nbsp;<span class="string" id="7442138">&#34;Zm9v&#34;</span><span class="op" id="7442144">}</span><span class="op" id="7442145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442148">{</span><span class="string" id="7442149">&#34;foob&#34;</span><span class="op" id="7442155">,</span>&nbsp;<span class="string" id="7442157">&#34;Zm9vYg==&#34;</span><span class="op" id="7442167">}</span><span class="op" id="7442168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442171">{</span><span class="string" id="7442172">&#34;fooba&#34;</span><span class="op" id="7442179">,</span>&nbsp;<span class="string" id="7442181">&#34;Zm9vYmE=&#34;</span><span class="op" id="7442191">}</span><span class="op" id="7442192">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442195">{</span><span class="string" id="7442196">&#34;foobar&#34;</span><span class="op" id="7442204">,</span>&nbsp;<span class="string" id="7442206">&#34;Zm9vYmFy&#34;</span><span class="op" id="7442216">}</span><span class="op" id="7442217">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7442221">//&nbsp;Wikipedia&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442244">{</span><span class="string" id="7442245">&#34;sure.&#34;</span><span class="op" id="7442252">,</span>&nbsp;<span class="string" id="7442254">&#34;c3VyZS4=&#34;</span><span class="op" id="7442264">}</span><span class="op" id="7442265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442268">{</span><span class="string" id="7442269">&#34;sure&#34;</span><span class="op" id="7442275">,</span>&nbsp;<span class="string" id="7442277">&#34;c3VyZQ==&#34;</span><span class="op" id="7442287">}</span><span class="op" id="7442288">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442291">{</span><span class="string" id="7442292">&#34;sur&#34;</span><span class="op" id="7442297">,</span>&nbsp;<span class="string" id="7442299">&#34;c3Vy&#34;</span><span class="op" id="7442305">}</span><span class="op" id="7442306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442309">{</span><span class="string" id="7442310">&#34;su&#34;</span><span class="op" id="7442314">,</span>&nbsp;<span class="string" id="7442316">&#34;c3U=&#34;</span><span class="op" id="7442322">}</span><span class="op" id="7442323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442326">{</span><span class="string" id="7442327">&#34;leasure.&#34;</span><span class="op" id="7442337">,</span>&nbsp;<span class="string" id="7442339">&#34;bGVhc3VyZS4=&#34;</span><span class="op" id="7442353">}</span><span class="op" id="7442354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442357">{</span><span class="string" id="7442358">&#34;easure.&#34;</span><span class="op" id="7442367">,</span>&nbsp;<span class="string" id="7442369">&#34;ZWFzdXJlLg==&#34;</span><span class="op" id="7442383">}</span><span class="op" id="7442384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442387">{</span><span class="string" id="7442388">&#34;asure.&#34;</span><span class="op" id="7442396">,</span>&nbsp;<span class="string" id="7442398">&#34;YXN1cmUu&#34;</span><span class="op" id="7442408">}</span><span class="op" id="7442409">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442412">{</span><span class="string" id="7442413">&#34;sure.&#34;</span><span class="op" id="7442420">,</span>&nbsp;<span class="string" id="7442422">&#34;c3VyZS4=&#34;</span><span class="op" id="7442432">}</span><span class="op" id="7442433">,</span><br>
<span class="lineno"></span><span class="op" id="7442435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7442438">var</span>&nbsp;<span class="ident" id="7442442">bigtest</span>&nbsp;<span class="op" id="7442450">=</span>&nbsp;<span class="ident" id="7442452">testpair</span><span class="op" id="7442460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442463">&#34;Twas&nbsp;brillig,&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves&#34;</span><span class="op" id="7442499">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7442502">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7442552">,</span><br>
<span class="lineno"></span><span class="op" id="7442554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7442557">func</span>&nbsp;<span class="ident" id="7442562">testEqual</span><span class="op" id="7442571">(</span><span class="ident" id="7442572">t</span>&nbsp;<span class="op" id="7442574">*</span><span class="ident" id="7442575">testing</span><span class="op" id="7442582">.</span><span class="ident" id="7442583">T</span><span class="op" id="7442584">,</span>&nbsp;<span class="ident" id="7442586">msg</span>&nbsp;<span class="builtintype" id="7442590">string</span><span class="op" id="7442596">,</span>&nbsp;<span class="ident" id="7442598">args</span>&nbsp;<span class="op" id="7442603">...</span><span class="keyword" id="7442606">interface</span><span class="op" id="7442615">{</span><span class="op" id="7442616">}</span><span class="op" id="7442617">)</span>&nbsp;<span class="builtintype" id="7442619">bool</span>&nbsp;<span class="op" id="7442624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7442627">if</span>&nbsp;<span class="ident" id="7442630">args</span><span class="op" id="7442634">[</span><span class="builtinfunc" id="7442635">len</span><span class="op" id="7442638">(</span><span class="ident" id="7442639">args</span><span class="op" id="7442643">)</span><span class="op" id="7442644">-</span><span class="num" id="7442645">2</span><span class="op" id="7442646">]</span>&nbsp;<span class="op" id="7442648">!=</span>&nbsp;<span class="ident" id="7442651">args</span><span class="op" id="7442655">[</span><span class="builtinfunc" id="7442656">len</span><span class="op" id="7442659">(</span><span class="ident" id="7442660">args</span><span class="op" id="7442664">)</span><span class="op" id="7442665">-</span><span class="num" id="7442666">1</span><span class="op" id="7442667">]</span>&nbsp;<span class="op" id="7442669">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442673">t</span><span class="op" id="7442674">.</span><span class="ident" id="7442675">Errorf</span><span class="op" id="7442681">(</span><span class="ident" id="7442682">msg</span><span class="op" id="7442685">,</span>&nbsp;<span class="ident" id="7442687">args</span><span class="op" id="7442691">...</span><span class="op" id="7442694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7442698">return</span>&nbsp;<span class="builtintype" id="7442705">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7442715">return</span>&nbsp;<span class="builtintype" id="7442722">true</span><br>
<span class="lineno"></span><span class="op" id="7442727">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7442730">func</span>&nbsp;<span class="ident" id="7442735">TestEncode</span><span class="op" id="7442745">(</span><span class="ident" id="7442746">t</span>&nbsp;<span class="op" id="7442748">*</span><span class="ident" id="7442749">testing</span><span class="op" id="7442756">.</span><span class="ident" id="7442757">T</span><span class="op" id="7442758">)</span>&nbsp;<span class="op" id="7442760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7442763">for</span>&nbsp;<span class="ident" id="7442767">_</span><span class="op" id="7442768">,</span>&nbsp;<span class="ident" id="7442770">p</span>&nbsp;<span class="op" id="7442772">:=</span>&nbsp;<span class="keyword" id="7442775">range</span>&nbsp;<span class="ident" id="7442781">pairs</span>&nbsp;<span class="op" id="7442787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442791">got</span>&nbsp;<span class="op" id="7442795">:=</span>&nbsp;<span class="ident" id="7442798">StdEncoding</span><span class="op" id="7442809">.</span><span class="ident" id="7442810">EncodeToString</span><span class="op" id="7442824">(</span><span class="op" id="7442825">[</span><span class="op" id="7442826">]</span><span class="builtintype" id="7442827">byte</span><span class="op" id="7442831">(</span><span class="ident" id="7442832">p</span><span class="op" id="7442833">.</span><span class="ident" id="7442834">decoded</span><span class="op" id="7442841">)</span><span class="op" id="7442842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442846">testEqual</span><span class="op" id="7442855">(</span><span class="ident" id="7442856">t</span><span class="op" id="7442857">,</span>&nbsp;<span class="string" id="7442859">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7442885">,</span>&nbsp;<span class="ident" id="7442887">p</span><span class="op" id="7442888">.</span><span class="ident" id="7442889">decoded</span><span class="op" id="7442896">,</span>&nbsp;<span class="ident" id="7442898">got</span><span class="op" id="7442901">,</span>&nbsp;<span class="ident" id="7442903">p</span><span class="op" id="7442904">.</span><span class="ident" id="7442905">encoded</span><span class="op" id="7442912">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7442915">}</span><br>
<span class="lineno"></span><span class="op" id="7442917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7442920">func</span>&nbsp;<span class="ident" id="7442925">TestEncoder</span><span class="op" id="7442936">(</span><span class="ident" id="7442937">t</span>&nbsp;<span class="op" id="7442939">*</span><span class="ident" id="7442940">testing</span><span class="op" id="7442947">.</span><span class="ident" id="7442948">T</span><span class="op" id="7442949">)</span>&nbsp;<span class="op" id="7442951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7442954">for</span>&nbsp;<span class="ident" id="7442958">_</span><span class="op" id="7442959">,</span>&nbsp;<span class="ident" id="7442961">p</span>&nbsp;<span class="op" id="7442963">:=</span>&nbsp;<span class="keyword" id="7442966">range</span>&nbsp;<span class="ident" id="7442972">pairs</span>&nbsp;<span class="op" id="7442978">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7442982">bb</span>&nbsp;<span class="op" id="7442985">:=</span>&nbsp;<span class="op" id="7442988">&amp;</span><span class="ident" id="7442989">bytes</span><span class="op" id="7442994">.</span><span class="ident" id="7442995">Buffer</span><span class="op" id="7443001">{</span><span class="op" id="7443002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443006">encoder</span>&nbsp;<span class="op" id="7443014">:=</span>&nbsp;<span class="ident" id="7443017">NewEncoder</span><span class="op" id="7443027">(</span><span class="ident" id="7443028">StdEncoding</span><span class="op" id="7443039">,</span>&nbsp;<span class="ident" id="7443041">bb</span><span class="op" id="7443043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443047">encoder</span><span class="op" id="7443054">.</span><span class="ident" id="7443055">Write</span><span class="op" id="7443060">(</span><span class="op" id="7443061">[</span><span class="op" id="7443062">]</span><span class="builtintype" id="7443063">byte</span><span class="op" id="7443067">(</span><span class="ident" id="7443068">p</span><span class="op" id="7443069">.</span><span class="ident" id="7443070">decoded</span><span class="op" id="7443077">)</span><span class="op" id="7443078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443082">encoder</span><span class="op" id="7443089">.</span><span class="ident" id="7443090">Close</span><span class="op" id="7443095">(</span><span class="op" id="7443096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443100">testEqual</span><span class="op" id="7443109">(</span><span class="ident" id="7443110">t</span><span class="op" id="7443111">,</span>&nbsp;<span class="string" id="7443113">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7443139">,</span>&nbsp;<span class="ident" id="7443141">p</span><span class="op" id="7443142">.</span><span class="ident" id="7443143">decoded</span><span class="op" id="7443150">,</span>&nbsp;<span class="ident" id="7443152">bb</span><span class="op" id="7443154">.</span><span class="ident" id="7443155">String</span><span class="op" id="7443161">(</span><span class="op" id="7443162">)</span><span class="op" id="7443163">,</span>&nbsp;<span class="ident" id="7443165">p</span><span class="op" id="7443166">.</span><span class="ident" id="7443167">encoded</span><span class="op" id="7443174">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443177">}</span><br>
<span class="lineno"></span><span class="op" id="7443179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7443182">func</span>&nbsp;<span class="ident" id="7443187">TestEncoderBuffering</span><span class="op" id="7443207">(</span><span class="ident" id="7443208">t</span>&nbsp;<span class="op" id="7443210">*</span><span class="ident" id="7443211">testing</span><span class="op" id="7443218">.</span><span class="ident" id="7443219">T</span><span class="op" id="7443220">)</span>&nbsp;<span class="op" id="7443222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443225">input</span>&nbsp;<span class="op" id="7443231">:=</span>&nbsp;<span class="op" id="7443234">[</span><span class="op" id="7443235">]</span><span class="builtintype" id="7443236">byte</span><span class="op" id="7443240">(</span><span class="ident" id="7443241">bigtest</span><span class="op" id="7443248">.</span><span class="ident" id="7443249">decoded</span><span class="op" id="7443256">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443259">for</span>&nbsp;<span class="ident" id="7443263">bs</span>&nbsp;<span class="op" id="7443266">:=</span>&nbsp;<span class="num" id="7443269">1</span><span class="op" id="7443270">;</span>&nbsp;<span class="ident" id="7443272">bs</span>&nbsp;<span class="op" id="7443275">&lt;=</span>&nbsp;<span class="num" id="7443278">12</span><span class="op" id="7443280">;</span>&nbsp;<span class="ident" id="7443282">bs</span><span class="op" id="7443284">++</span>&nbsp;<span class="op" id="7443287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443291">bb</span>&nbsp;<span class="op" id="7443294">:=</span>&nbsp;<span class="op" id="7443297">&amp;</span><span class="ident" id="7443298">bytes</span><span class="op" id="7443303">.</span><span class="ident" id="7443304">Buffer</span><span class="op" id="7443310">{</span><span class="op" id="7443311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443315">encoder</span>&nbsp;<span class="op" id="7443323">:=</span>&nbsp;<span class="ident" id="7443326">NewEncoder</span><span class="op" id="7443336">(</span><span class="ident" id="7443337">StdEncoding</span><span class="op" id="7443348">,</span>&nbsp;<span class="ident" id="7443350">bb</span><span class="op" id="7443352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443356">for</span>&nbsp;<span class="ident" id="7443360">pos</span>&nbsp;<span class="op" id="7443364">:=</span>&nbsp;<span class="num" id="7443367">0</span><span class="op" id="7443368">;</span>&nbsp;<span class="ident" id="7443370">pos</span>&nbsp;<span class="op" id="7443374">&lt;</span>&nbsp;<span class="builtinfunc" id="7443376">len</span><span class="op" id="7443379">(</span><span class="ident" id="7443380">input</span><span class="op" id="7443385">)</span><span class="op" id="7443386">;</span>&nbsp;<span class="ident" id="7443388">pos</span>&nbsp;<span class="op" id="7443392">+=</span>&nbsp;<span class="ident" id="7443395">bs</span>&nbsp;<span class="op" id="7443398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443403">end</span>&nbsp;<span class="op" id="7443407">:=</span>&nbsp;<span class="ident" id="7443410">pos</span>&nbsp;<span class="op" id="7443414">+</span>&nbsp;<span class="ident" id="7443416">bs</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443422">if</span>&nbsp;<span class="ident" id="7443425">end</span>&nbsp;<span class="op" id="7443429">&gt;</span>&nbsp;<span class="builtinfunc" id="7443431">len</span><span class="op" id="7443434">(</span><span class="ident" id="7443435">input</span><span class="op" id="7443440">)</span>&nbsp;<span class="op" id="7443442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443448">end</span>&nbsp;<span class="op" id="7443452">=</span>&nbsp;<span class="builtinfunc" id="7443454">len</span><span class="op" id="7443457">(</span><span class="ident" id="7443458">input</span><span class="op" id="7443463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443473">n</span><span class="op" id="7443474">,</span>&nbsp;<span class="ident" id="7443476">err</span>&nbsp;<span class="op" id="7443480">:=</span>&nbsp;<span class="ident" id="7443483">encoder</span><span class="op" id="7443490">.</span><span class="ident" id="7443491">Write</span><span class="op" id="7443496">(</span><span class="ident" id="7443497">input</span><span class="op" id="7443502">[</span><span class="ident" id="7443503">pos</span><span class="op" id="7443506">:</span><span class="ident" id="7443507">end</span><span class="op" id="7443510">]</span><span class="op" id="7443511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443516">testEqual</span><span class="op" id="7443525">(</span><span class="ident" id="7443526">t</span><span class="op" id="7443527">,</span>&nbsp;<span class="string" id="7443529">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7443563">,</span>&nbsp;<span class="ident" id="7443565">input</span><span class="op" id="7443570">[</span><span class="ident" id="7443571">pos</span><span class="op" id="7443574">:</span><span class="ident" id="7443575">end</span><span class="op" id="7443578">]</span><span class="op" id="7443579">,</span>&nbsp;<span class="ident" id="7443581">err</span><span class="op" id="7443584">,</span>&nbsp;<span class="builtintype" id="7443586">error</span><span class="op" id="7443591">(</span><span class="ident" id="7443592">nil</span><span class="op" id="7443595">)</span><span class="op" id="7443596">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443601">testEqual</span><span class="op" id="7443610">(</span><span class="ident" id="7443611">t</span><span class="op" id="7443612">,</span>&nbsp;<span class="string" id="7443614">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7443649">,</span>&nbsp;<span class="ident" id="7443651">input</span><span class="op" id="7443656">[</span><span class="ident" id="7443657">pos</span><span class="op" id="7443660">:</span><span class="ident" id="7443661">end</span><span class="op" id="7443664">]</span><span class="op" id="7443665">,</span>&nbsp;<span class="ident" id="7443667">n</span><span class="op" id="7443668">,</span>&nbsp;<span class="ident" id="7443670">end</span><span class="op" id="7443673">-</span><span class="ident" id="7443674">pos</span><span class="op" id="7443677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443685">err</span>&nbsp;<span class="op" id="7443689">:=</span>&nbsp;<span class="ident" id="7443692">encoder</span><span class="op" id="7443699">.</span><span class="ident" id="7443700">Close</span><span class="op" id="7443705">(</span><span class="op" id="7443706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443710">testEqual</span><span class="op" id="7443719">(</span><span class="ident" id="7443720">t</span><span class="op" id="7443721">,</span>&nbsp;<span class="string" id="7443723">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7443753">,</span>&nbsp;<span class="ident" id="7443755">err</span><span class="op" id="7443758">,</span>&nbsp;<span class="builtintype" id="7443760">error</span><span class="op" id="7443765">(</span><span class="ident" id="7443766">nil</span><span class="op" id="7443769">)</span><span class="op" id="7443770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443774">testEqual</span><span class="op" id="7443783">(</span><span class="ident" id="7443784">t</span><span class="op" id="7443785">,</span>&nbsp;<span class="string" id="7443787">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7443820">,</span>&nbsp;<span class="ident" id="7443822">bs</span><span class="op" id="7443824">,</span>&nbsp;<span class="ident" id="7443826">bigtest</span><span class="op" id="7443833">.</span><span class="ident" id="7443834">decoded</span><span class="op" id="7443841">,</span>&nbsp;<span class="ident" id="7443843">bb</span><span class="op" id="7443845">.</span><span class="ident" id="7443846">String</span><span class="op" id="7443852">(</span><span class="op" id="7443853">)</span><span class="op" id="7443854">,</span>&nbsp;<span class="ident" id="7443856">bigtest</span><span class="op" id="7443863">.</span><span class="ident" id="7443864">encoded</span><span class="op" id="7443871">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7443874">}</span><br>
<span class="lineno"></span><span class="op" id="7443876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7443879">func</span>&nbsp;<span class="ident" id="7443884">TestDecode</span><span class="op" id="7443894">(</span><span class="ident" id="7443895">t</span>&nbsp;<span class="op" id="7443897">*</span><span class="ident" id="7443898">testing</span><span class="op" id="7443905">.</span><span class="ident" id="7443906">T</span><span class="op" id="7443907">)</span>&nbsp;<span class="op" id="7443909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7443912">for</span>&nbsp;<span class="ident" id="7443916">_</span><span class="op" id="7443917">,</span>&nbsp;<span class="ident" id="7443919">p</span>&nbsp;<span class="op" id="7443921">:=</span>&nbsp;<span class="keyword" id="7443924">range</span>&nbsp;<span class="ident" id="7443930">pairs</span>&nbsp;<span class="op" id="7443936">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7443940">dbuf</span>&nbsp;<span class="op" id="7443945">:=</span>&nbsp;<span class="builtinfunc" id="7443948">make</span><span class="op" id="7443952">(</span><span class="op" id="7443953">[</span><span class="op" id="7443954">]</span><span class="builtintype" id="7443955">byte</span><span class="op" id="7443959">,</span>&nbsp;<span class="ident" id="7443961">StdEncoding</span><span class="op" id="7443972">.</span><span class="ident" id="7443973">DecodedLen</span><span class="op" id="7443983">(</span><span class="builtinfunc" id="7443984">len</span><span class="op" id="7443987">(</span><span class="ident" id="7443988">p</span><span class="op" id="7443989">.</span><span class="ident" id="7443990">encoded</span><span class="op" id="7443997">)</span><span class="op" id="7443998">)</span><span class="op" id="7443999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444003">count</span><span class="op" id="7444008">,</span>&nbsp;<span class="ident" id="7444010">end</span><span class="op" id="7444013">,</span>&nbsp;<span class="ident" id="7444015">err</span>&nbsp;<span class="op" id="7444019">:=</span>&nbsp;<span class="ident" id="7444022">StdEncoding</span><span class="op" id="7444033">.</span><span class="ident" id="7444034">decode</span><span class="op" id="7444040">(</span><span class="ident" id="7444041">dbuf</span><span class="op" id="7444045">,</span>&nbsp;<span class="op" id="7444047">[</span><span class="op" id="7444048">]</span><span class="builtintype" id="7444049">byte</span><span class="op" id="7444053">(</span><span class="ident" id="7444054">p</span><span class="op" id="7444055">.</span><span class="ident" id="7444056">encoded</span><span class="op" id="7444063">)</span><span class="op" id="7444064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444068">testEqual</span><span class="op" id="7444077">(</span><span class="ident" id="7444078">t</span><span class="op" id="7444079">,</span>&nbsp;<span class="string" id="7444081">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7444113">,</span>&nbsp;<span class="ident" id="7444115">p</span><span class="op" id="7444116">.</span><span class="ident" id="7444117">encoded</span><span class="op" id="7444124">,</span>&nbsp;<span class="ident" id="7444126">err</span><span class="op" id="7444129">,</span>&nbsp;<span class="builtintype" id="7444131">error</span><span class="op" id="7444136">(</span><span class="ident" id="7444137">nil</span><span class="op" id="7444140">)</span><span class="op" id="7444141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444145">testEqual</span><span class="op" id="7444154">(</span><span class="ident" id="7444155">t</span><span class="op" id="7444156">,</span>&nbsp;<span class="string" id="7444158">&#34;Decode(%q)&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7444191">,</span>&nbsp;<span class="ident" id="7444193">p</span><span class="op" id="7444194">.</span><span class="ident" id="7444195">encoded</span><span class="op" id="7444202">,</span>&nbsp;<span class="ident" id="7444204">count</span><span class="op" id="7444209">,</span>&nbsp;<span class="builtinfunc" id="7444211">len</span><span class="op" id="7444214">(</span><span class="ident" id="7444215">p</span><span class="op" id="7444216">.</span><span class="ident" id="7444217">decoded</span><span class="op" id="7444224">)</span><span class="op" id="7444225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7444229">if</span>&nbsp;<span class="builtinfunc" id="7444232">len</span><span class="op" id="7444235">(</span><span class="ident" id="7444236">p</span><span class="op" id="7444237">.</span><span class="ident" id="7444238">encoded</span><span class="op" id="7444245">)</span>&nbsp;<span class="op" id="7444247">&gt;</span>&nbsp;<span class="num" id="7444249">0</span>&nbsp;<span class="op" id="7444251">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444256">testEqual</span><span class="op" id="7444265">(</span><span class="ident" id="7444266">t</span><span class="op" id="7444267">,</span>&nbsp;<span class="string" id="7444269">&#34;Decode(%q)&nbsp;=&nbsp;end&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7444299">,</span>&nbsp;<span class="ident" id="7444301">p</span><span class="op" id="7444302">.</span><span class="ident" id="7444303">encoded</span><span class="op" id="7444310">,</span>&nbsp;<span class="ident" id="7444312">end</span><span class="op" id="7444315">,</span>&nbsp;<span class="op" id="7444317">(</span><span class="ident" id="7444318">p</span><span class="op" id="7444319">.</span><span class="ident" id="7444320">encoded</span><span class="op" id="7444327">[</span><span class="builtinfunc" id="7444328">len</span><span class="op" id="7444331">(</span><span class="ident" id="7444332">p</span><span class="op" id="7444333">.</span><span class="ident" id="7444334">encoded</span><span class="op" id="7444341">)</span><span class="op" id="7444342">-</span><span class="num" id="7444343">1</span><span class="op" id="7444344">]</span>&nbsp;<span class="op" id="7444346">==</span>&nbsp;<span class="string" id="7444349">&#39;=&#39;</span><span class="op" id="7444352">)</span><span class="op" id="7444353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444361">testEqual</span><span class="op" id="7444370">(</span><span class="ident" id="7444371">t</span><span class="op" id="7444372">,</span>&nbsp;<span class="string" id="7444374">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7444400">,</span>&nbsp;<span class="ident" id="7444402">p</span><span class="op" id="7444403">.</span><span class="ident" id="7444404">encoded</span><span class="op" id="7444411">,</span>&nbsp;<span class="builtintype" id="7444413">string</span><span class="op" id="7444419">(</span><span class="ident" id="7444420">dbuf</span><span class="op" id="7444424">[</span><span class="num" id="7444425">0</span><span class="op" id="7444426">:</span><span class="ident" id="7444427">count</span><span class="op" id="7444432">]</span><span class="op" id="7444433">)</span><span class="op" id="7444434">,</span>&nbsp;<span class="ident" id="7444436">p</span><span class="op" id="7444437">.</span><span class="ident" id="7444438">decoded</span><span class="op" id="7444445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444450">dbuf</span><span class="op" id="7444454">,</span>&nbsp;<span class="ident" id="7444456">err</span>&nbsp;<span class="op" id="7444460">=</span>&nbsp;<span class="ident" id="7444462">StdEncoding</span><span class="op" id="7444473">.</span><span class="ident" id="7444474">DecodeString</span><span class="op" id="7444486">(</span><span class="ident" id="7444487">p</span><span class="op" id="7444488">.</span><span class="ident" id="7444489">encoded</span><span class="op" id="7444496">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444500">testEqual</span><span class="op" id="7444509">(</span><span class="ident" id="7444510">t</span><span class="op" id="7444511">,</span>&nbsp;<span class="string" id="7444513">&#34;DecodeString(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7444551">,</span>&nbsp;<span class="ident" id="7444553">p</span><span class="op" id="7444554">.</span><span class="ident" id="7444555">encoded</span><span class="op" id="7444562">,</span>&nbsp;<span class="ident" id="7444564">err</span><span class="op" id="7444567">,</span>&nbsp;<span class="builtintype" id="7444569">error</span><span class="op" id="7444574">(</span><span class="ident" id="7444575">nil</span><span class="op" id="7444578">)</span><span class="op" id="7444579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444583">testEqual</span><span class="op" id="7444592">(</span><span class="ident" id="7444593">t</span><span class="op" id="7444594">,</span>&nbsp;<span class="string" id="7444596">&#34;DecodeString(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7444628">,</span>&nbsp;<span class="builtintype" id="7444630">string</span><span class="op" id="7444636">(</span><span class="ident" id="7444637">dbuf</span><span class="op" id="7444641">)</span><span class="op" id="7444642">,</span>&nbsp;<span class="ident" id="7444644">p</span><span class="op" id="7444645">.</span><span class="ident" id="7444646">decoded</span><span class="op" id="7444653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444656">}</span><br>
<span class="lineno"></span><span class="op" id="7444658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7444661">func</span>&nbsp;<span class="ident" id="7444666">TestDecoder</span><span class="op" id="7444677">(</span><span class="ident" id="7444678">t</span>&nbsp;<span class="op" id="7444680">*</span><span class="ident" id="7444681">testing</span><span class="op" id="7444688">.</span><span class="ident" id="7444689">T</span><span class="op" id="7444690">)</span>&nbsp;<span class="op" id="7444692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7444695">for</span>&nbsp;<span class="ident" id="7444699">_</span><span class="op" id="7444700">,</span>&nbsp;<span class="ident" id="7444702">p</span>&nbsp;<span class="op" id="7444704">:=</span>&nbsp;<span class="keyword" id="7444707">range</span>&nbsp;<span class="ident" id="7444713">pairs</span>&nbsp;<span class="op" id="7444719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444723">decoder</span>&nbsp;<span class="op" id="7444731">:=</span>&nbsp;<span class="ident" id="7444734">NewDecoder</span><span class="op" id="7444744">(</span><span class="ident" id="7444745">StdEncoding</span><span class="op" id="7444756">,</span>&nbsp;<span class="ident" id="7444758">strings</span><span class="op" id="7444765">.</span><span class="ident" id="7444766">NewReader</span><span class="op" id="7444775">(</span><span class="ident" id="7444776">p</span><span class="op" id="7444777">.</span><span class="ident" id="7444778">encoded</span><span class="op" id="7444785">)</span><span class="op" id="7444786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444790">dbuf</span>&nbsp;<span class="op" id="7444795">:=</span>&nbsp;<span class="builtinfunc" id="7444798">make</span><span class="op" id="7444802">(</span><span class="op" id="7444803">[</span><span class="op" id="7444804">]</span><span class="builtintype" id="7444805">byte</span><span class="op" id="7444809">,</span>&nbsp;<span class="ident" id="7444811">StdEncoding</span><span class="op" id="7444822">.</span><span class="ident" id="7444823">DecodedLen</span><span class="op" id="7444833">(</span><span class="builtinfunc" id="7444834">len</span><span class="op" id="7444837">(</span><span class="ident" id="7444838">p</span><span class="op" id="7444839">.</span><span class="ident" id="7444840">encoded</span><span class="op" id="7444847">)</span><span class="op" id="7444848">)</span><span class="op" id="7444849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444853">count</span><span class="op" id="7444858">,</span>&nbsp;<span class="ident" id="7444860">err</span>&nbsp;<span class="op" id="7444864">:=</span>&nbsp;<span class="ident" id="7444867">decoder</span><span class="op" id="7444874">.</span><span class="ident" id="7444875">Read</span><span class="op" id="7444879">(</span><span class="ident" id="7444880">dbuf</span><span class="op" id="7444884">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7444888">if</span>&nbsp;<span class="ident" id="7444891">err</span>&nbsp;<span class="op" id="7444895">!=</span>&nbsp;<span class="ident" id="7444898">nil</span>&nbsp;<span class="op" id="7444902">&amp;&amp;</span>&nbsp;<span class="ident" id="7444905">err</span>&nbsp;<span class="op" id="7444909">!=</span>&nbsp;<span class="ident" id="7444912">io</span><span class="op" id="7444914">.</span><span class="ident" id="7444915">EOF</span>&nbsp;<span class="op" id="7444919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444924">t</span><span class="op" id="7444925">.</span><span class="ident" id="7444926">Fatal</span><span class="op" id="7444931">(</span><span class="string" id="7444932">&#34;Read&nbsp;failed&#34;</span><span class="op" id="7444945">,</span>&nbsp;<span class="ident" id="7444947">err</span><span class="op" id="7444950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7444954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7444958">testEqual</span><span class="op" id="7444967">(</span><span class="ident" id="7444968">t</span><span class="op" id="7444969">,</span>&nbsp;<span class="string" id="7444971">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7445006">,</span>&nbsp;<span class="ident" id="7445008">p</span><span class="op" id="7445009">.</span><span class="ident" id="7445010">encoded</span><span class="op" id="7445017">,</span>&nbsp;<span class="ident" id="7445019">count</span><span class="op" id="7445024">,</span>&nbsp;<span class="builtinfunc" id="7445026">len</span><span class="op" id="7445029">(</span><span class="ident" id="7445030">p</span><span class="op" id="7445031">.</span><span class="ident" id="7445032">decoded</span><span class="op" id="7445039">)</span><span class="op" id="7445040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445044">testEqual</span><span class="op" id="7445053">(</span><span class="ident" id="7445054">t</span><span class="op" id="7445055">,</span>&nbsp;<span class="string" id="7445057">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7445087">,</span>&nbsp;<span class="ident" id="7445089">p</span><span class="op" id="7445090">.</span><span class="ident" id="7445091">encoded</span><span class="op" id="7445098">,</span>&nbsp;<span class="builtintype" id="7445100">string</span><span class="op" id="7445106">(</span><span class="ident" id="7445107">dbuf</span><span class="op" id="7445111">[</span><span class="num" id="7445112">0</span><span class="op" id="7445113">:</span><span class="ident" id="7445114">count</span><span class="op" id="7445119">]</span><span class="op" id="7445120">)</span><span class="op" id="7445121">,</span>&nbsp;<span class="ident" id="7445123">p</span><span class="op" id="7445124">.</span><span class="ident" id="7445125">decoded</span><span class="op" id="7445132">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445136">if</span>&nbsp;<span class="ident" id="7445139">err</span>&nbsp;<span class="op" id="7445143">!=</span>&nbsp;<span class="ident" id="7445146">io</span><span class="op" id="7445148">.</span><span class="ident" id="7445149">EOF</span>&nbsp;<span class="op" id="7445153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445158">count</span><span class="op" id="7445163">,</span>&nbsp;<span class="ident" id="7445165">err</span>&nbsp;<span class="op" id="7445169">=</span>&nbsp;<span class="ident" id="7445171">decoder</span><span class="op" id="7445178">.</span><span class="ident" id="7445179">Read</span><span class="op" id="7445183">(</span><span class="ident" id="7445184">dbuf</span><span class="op" id="7445188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445196">testEqual</span><span class="op" id="7445205">(</span><span class="ident" id="7445206">t</span><span class="op" id="7445207">,</span>&nbsp;<span class="string" id="7445209">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7445237">,</span>&nbsp;<span class="ident" id="7445239">p</span><span class="op" id="7445240">.</span><span class="ident" id="7445241">encoded</span><span class="op" id="7445248">,</span>&nbsp;<span class="ident" id="7445250">err</span><span class="op" id="7445253">,</span>&nbsp;<span class="ident" id="7445255">io</span><span class="op" id="7445257">.</span><span class="ident" id="7445258">EOF</span><span class="op" id="7445261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445264">}</span><br>
<span class="lineno">130</span><span class="op" id="7445266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7445269">func</span>&nbsp;<span class="ident" id="7445274">TestDecoderBuffering</span><span class="op" id="7445294">(</span><span class="ident" id="7445295">t</span>&nbsp;<span class="op" id="7445297">*</span><span class="ident" id="7445298">testing</span><span class="op" id="7445305">.</span><span class="ident" id="7445306">T</span><span class="op" id="7445307">)</span>&nbsp;<span class="op" id="7445309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445312">for</span>&nbsp;<span class="ident" id="7445316">bs</span>&nbsp;<span class="op" id="7445319">:=</span>&nbsp;<span class="num" id="7445322">1</span><span class="op" id="7445323">;</span>&nbsp;<span class="ident" id="7445325">bs</span>&nbsp;<span class="op" id="7445328">&lt;=</span>&nbsp;<span class="num" id="7445331">12</span><span class="op" id="7445333">;</span>&nbsp;<span class="ident" id="7445335">bs</span><span class="op" id="7445337">++</span>&nbsp;<span class="op" id="7445340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445344">decoder</span>&nbsp;<span class="op" id="7445352">:=</span>&nbsp;<span class="ident" id="7445355">NewDecoder</span><span class="op" id="7445365">(</span><span class="ident" id="7445366">StdEncoding</span><span class="op" id="7445377">,</span>&nbsp;<span class="ident" id="7445379">strings</span><span class="op" id="7445386">.</span><span class="ident" id="7445387">NewReader</span><span class="op" id="7445396">(</span><span class="ident" id="7445397">bigtest</span><span class="op" id="7445404">.</span><span class="ident" id="7445405">encoded</span><span class="op" id="7445412">)</span><span class="op" id="7445413">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445417">buf</span>&nbsp;<span class="op" id="7445421">:=</span>&nbsp;<span class="builtinfunc" id="7445424">make</span><span class="op" id="7445428">(</span><span class="op" id="7445429">[</span><span class="op" id="7445430">]</span><span class="builtintype" id="7445431">byte</span><span class="op" id="7445435">,</span>&nbsp;<span class="builtinfunc" id="7445437">len</span><span class="op" id="7445440">(</span><span class="ident" id="7445441">bigtest</span><span class="op" id="7445448">.</span><span class="ident" id="7445449">decoded</span><span class="op" id="7445456">)</span><span class="op" id="7445457">+</span><span class="num" id="7445458">12</span><span class="op" id="7445460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445464">var</span>&nbsp;<span class="ident" id="7445468">total</span>&nbsp;<span class="builtintype" id="7445474">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7445480">for</span>&nbsp;<span class="ident" id="7445484">total</span>&nbsp;<span class="op" id="7445490">=</span>&nbsp;<span class="num" id="7445492">0</span><span class="op" id="7445493">;</span>&nbsp;<span class="ident" id="7445495">total</span>&nbsp;<span class="op" id="7445501">&lt;</span>&nbsp;<span class="builtinfunc" id="7445503">len</span><span class="op" id="7445506">(</span><span class="ident" id="7445507">bigtest</span><span class="op" id="7445514">.</span><span class="ident" id="7445515">decoded</span><span class="op" id="7445522">)</span><span class="op" id="7445523">;</span>&nbsp;<span class="op" id="7445525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445530">n</span><span class="op" id="7445531">,</span>&nbsp;<span class="ident" id="7445533">err</span>&nbsp;<span class="op" id="7445537">:=</span>&nbsp;<span class="ident" id="7445540">decoder</span><span class="op" id="7445547">.</span><span class="ident" id="7445548">Read</span><span class="op" id="7445552">(</span><span class="ident" id="7445553">buf</span><span class="op" id="7445556">[</span><span class="ident" id="7445557">total</span>&nbsp;<span class="op" id="7445563">:</span>&nbsp;<span class="ident" id="7445565">total</span><span class="op" id="7445570">+</span><span class="ident" id="7445571">bs</span><span class="op" id="7445573">]</span><span class="op" id="7445574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445579">testEqual</span><span class="op" id="7445588">(</span><span class="ident" id="7445589">t</span><span class="op" id="7445590">,</span>&nbsp;<span class="string" id="7445592">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7445637">,</span>&nbsp;<span class="ident" id="7445639">bigtest</span><span class="op" id="7445646">.</span><span class="ident" id="7445647">encoded</span><span class="op" id="7445654">,</span>&nbsp;<span class="ident" id="7445656">total</span><span class="op" id="7445661">,</span>&nbsp;<span class="ident" id="7445663">n</span><span class="op" id="7445664">,</span>&nbsp;<span class="ident" id="7445666">err</span><span class="op" id="7445669">,</span>&nbsp;<span class="builtintype" id="7445671">error</span><span class="op" id="7445676">(</span><span class="ident" id="7445677">nil</span><span class="op" id="7445680">)</span><span class="op" id="7445681">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445686">total</span>&nbsp;<span class="op" id="7445692">+=</span>&nbsp;<span class="ident" id="7445695">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445703">testEqual</span><span class="op" id="7445712">(</span><span class="ident" id="7445713">t</span><span class="op" id="7445714">,</span>&nbsp;<span class="string" id="7445716">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7445749">,</span>&nbsp;<span class="ident" id="7445751">bs</span><span class="op" id="7445753">,</span>&nbsp;<span class="ident" id="7445755">bigtest</span><span class="op" id="7445762">.</span><span class="ident" id="7445763">encoded</span><span class="op" id="7445770">,</span>&nbsp;<span class="builtintype" id="7445772">string</span><span class="op" id="7445778">(</span><span class="ident" id="7445779">buf</span><span class="op" id="7445782">[</span><span class="num" id="7445783">0</span><span class="op" id="7445784">:</span><span class="ident" id="7445785">total</span><span class="op" id="7445790">]</span><span class="op" id="7445791">)</span><span class="op" id="7445792">,</span>&nbsp;<span class="ident" id="7445794">bigtest</span><span class="op" id="7445801">.</span><span class="ident" id="7445802">decoded</span><span class="op" id="7445809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445812">}</span><br>
<span class="lineno"></span><span class="op" id="7445814">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7445817">func</span>&nbsp;<span class="ident" id="7445822">TestDecodeCorrupt</span><span class="op" id="7445839">(</span><span class="ident" id="7445840">t</span>&nbsp;<span class="op" id="7445842">*</span><span class="ident" id="7445843">testing</span><span class="op" id="7445850">.</span><span class="ident" id="7445851">T</span><span class="op" id="7445852">)</span>&nbsp;<span class="op" id="7445854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445857">testCases</span>&nbsp;<span class="op" id="7445867">:=</span>&nbsp;<span class="op" id="7445870">[</span><span class="op" id="7445871">]</span><span class="keyword" id="7445872">struct</span>&nbsp;<span class="op" id="7445879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445883">input</span>&nbsp;&nbsp;<span class="builtintype" id="7445890">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7445899">offset</span>&nbsp;<span class="builtintype" id="7445906">int</span>&nbsp;<span class="comment" id="7445910">//&nbsp;-1&nbsp;means&nbsp;no&nbsp;corruption.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445938">}</span><span class="op" id="7445939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445943">{</span><span class="string" id="7445944">&#34;&#34;</span><span class="op" id="7445946">,</span>&nbsp;<span class="op" id="7445948">-</span><span class="num" id="7445949">1</span><span class="op" id="7445950">}</span><span class="op" id="7445951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445955">{</span><span class="string" id="7445956">&#34;!!!!&#34;</span><span class="op" id="7445962">,</span>&nbsp;<span class="num" id="7445964">0</span><span class="op" id="7445965">}</span><span class="op" id="7445966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445970">{</span><span class="string" id="7445971">&#34;====&#34;</span><span class="op" id="7445977">,</span>&nbsp;<span class="num" id="7445979">0</span><span class="op" id="7445980">}</span><span class="op" id="7445981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7445985">{</span><span class="string" id="7445986">&#34;x===&#34;</span><span class="op" id="7445992">,</span>&nbsp;<span class="num" id="7445994">1</span><span class="op" id="7445995">}</span><span class="op" id="7445996">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446000">{</span><span class="string" id="7446001">&#34;=AAA&#34;</span><span class="op" id="7446007">,</span>&nbsp;<span class="num" id="7446009">0</span><span class="op" id="7446010">}</span><span class="op" id="7446011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446015">{</span><span class="string" id="7446016">&#34;A=AA&#34;</span><span class="op" id="7446022">,</span>&nbsp;<span class="num" id="7446024">1</span><span class="op" id="7446025">}</span><span class="op" id="7446026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446030">{</span><span class="string" id="7446031">&#34;AA=A&#34;</span><span class="op" id="7446037">,</span>&nbsp;<span class="num" id="7446039">2</span><span class="op" id="7446040">}</span><span class="op" id="7446041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446045">{</span><span class="string" id="7446046">&#34;AA==A&#34;</span><span class="op" id="7446053">,</span>&nbsp;<span class="num" id="7446055">4</span><span class="op" id="7446056">}</span><span class="op" id="7446057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446061">{</span><span class="string" id="7446062">&#34;AAA=AAAA&#34;</span><span class="op" id="7446072">,</span>&nbsp;<span class="num" id="7446074">4</span><span class="op" id="7446075">}</span><span class="op" id="7446076">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446080">{</span><span class="string" id="7446081">&#34;AAAAA&#34;</span><span class="op" id="7446088">,</span>&nbsp;<span class="num" id="7446090">4</span><span class="op" id="7446091">}</span><span class="op" id="7446092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446096">{</span><span class="string" id="7446097">&#34;AAAAAA&#34;</span><span class="op" id="7446105">,</span>&nbsp;<span class="num" id="7446107">4</span><span class="op" id="7446108">}</span><span class="op" id="7446109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446113">{</span><span class="string" id="7446114">&#34;A=&#34;</span><span class="op" id="7446118">,</span>&nbsp;<span class="num" id="7446120">1</span><span class="op" id="7446121">}</span><span class="op" id="7446122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446126">{</span><span class="string" id="7446127">&#34;A==&#34;</span><span class="op" id="7446132">,</span>&nbsp;<span class="num" id="7446134">1</span><span class="op" id="7446135">}</span><span class="op" id="7446136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446140">{</span><span class="string" id="7446141">&#34;AA=&#34;</span><span class="op" id="7446146">,</span>&nbsp;<span class="num" id="7446148">3</span><span class="op" id="7446149">}</span><span class="op" id="7446150">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446154">{</span><span class="string" id="7446155">&#34;AA==&#34;</span><span class="op" id="7446161">,</span>&nbsp;<span class="op" id="7446163">-</span><span class="num" id="7446164">1</span><span class="op" id="7446165">}</span><span class="op" id="7446166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446170">{</span><span class="string" id="7446171">&#34;AAA=&#34;</span><span class="op" id="7446177">,</span>&nbsp;<span class="op" id="7446179">-</span><span class="num" id="7446180">1</span><span class="op" id="7446181">}</span><span class="op" id="7446182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446186">{</span><span class="string" id="7446187">&#34;AAAA&#34;</span><span class="op" id="7446193">,</span>&nbsp;<span class="op" id="7446195">-</span><span class="num" id="7446196">1</span><span class="op" id="7446197">}</span><span class="op" id="7446198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446202">{</span><span class="string" id="7446203">&#34;AAAAAA=&#34;</span><span class="op" id="7446212">,</span>&nbsp;<span class="num" id="7446214">7</span><span class="op" id="7446215">}</span><span class="op" id="7446216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446220">{</span><span class="string" id="7446221">&#34;YWJjZA=====&#34;</span><span class="op" id="7446234">,</span>&nbsp;<span class="num" id="7446236">8</span><span class="op" id="7446237">}</span><span class="op" id="7446238">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446244">for</span>&nbsp;<span class="ident" id="7446248">_</span><span class="op" id="7446249">,</span>&nbsp;<span class="ident" id="7446251">tc</span>&nbsp;<span class="op" id="7446254">:=</span>&nbsp;<span class="keyword" id="7446257">range</span>&nbsp;<span class="ident" id="7446263">testCases</span>&nbsp;<span class="op" id="7446273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446277">dbuf</span>&nbsp;<span class="op" id="7446282">:=</span>&nbsp;<span class="builtinfunc" id="7446285">make</span><span class="op" id="7446289">(</span><span class="op" id="7446290">[</span><span class="op" id="7446291">]</span><span class="builtintype" id="7446292">byte</span><span class="op" id="7446296">,</span>&nbsp;<span class="ident" id="7446298">StdEncoding</span><span class="op" id="7446309">.</span><span class="ident" id="7446310">DecodedLen</span><span class="op" id="7446320">(</span><span class="builtinfunc" id="7446321">len</span><span class="op" id="7446324">(</span><span class="ident" id="7446325">tc</span><span class="op" id="7446327">.</span><span class="ident" id="7446328">input</span><span class="op" id="7446333">)</span><span class="op" id="7446334">)</span><span class="op" id="7446335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446339">_</span><span class="op" id="7446340">,</span>&nbsp;<span class="ident" id="7446342">err</span>&nbsp;<span class="op" id="7446346">:=</span>&nbsp;<span class="ident" id="7446349">StdEncoding</span><span class="op" id="7446360">.</span><span class="ident" id="7446361">Decode</span><span class="op" id="7446367">(</span><span class="ident" id="7446368">dbuf</span><span class="op" id="7446372">,</span>&nbsp;<span class="op" id="7446374">[</span><span class="op" id="7446375">]</span><span class="builtintype" id="7446376">byte</span><span class="op" id="7446380">(</span><span class="ident" id="7446381">tc</span><span class="op" id="7446383">.</span><span class="ident" id="7446384">input</span><span class="op" id="7446389">)</span><span class="op" id="7446390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446394">if</span>&nbsp;<span class="ident" id="7446397">tc</span><span class="op" id="7446399">.</span><span class="ident" id="7446400">offset</span>&nbsp;<span class="op" id="7446407">==</span>&nbsp;<span class="op" id="7446410">-</span><span class="num" id="7446411">1</span>&nbsp;<span class="op" id="7446413">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446418">if</span>&nbsp;<span class="ident" id="7446421">err</span>&nbsp;<span class="op" id="7446425">!=</span>&nbsp;<span class="ident" id="7446428">nil</span>&nbsp;<span class="op" id="7446432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446438">t</span><span class="op" id="7446439">.</span><span class="ident" id="7446440">Error</span><span class="op" id="7446445">(</span><span class="string" id="7446446">&#34;Decoder&nbsp;wrongly&nbsp;detected&nbsp;coruption&nbsp;in&#34;</span><span class="op" id="7446485">,</span>&nbsp;<span class="ident" id="7446487">tc</span><span class="op" id="7446489">.</span><span class="ident" id="7446490">input</span><span class="op" id="7446495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446505">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446516">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446520">switch</span>&nbsp;<span class="ident" id="7446527">err</span>&nbsp;<span class="op" id="7446531">:=</span>&nbsp;<span class="ident" id="7446534">err</span><span class="op" id="7446537">.</span><span class="op" id="7446538">(</span><span class="keyword" id="7446539">type</span><span class="op" id="7446543">)</span>&nbsp;<span class="op" id="7446545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446549">case</span>&nbsp;<span class="ident" id="7446554">CorruptInputError</span><span class="op" id="7446571">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446576">testEqual</span><span class="op" id="7446585">(</span><span class="ident" id="7446586">t</span><span class="op" id="7446587">,</span>&nbsp;<span class="string" id="7446589">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7446629">,</span>&nbsp;<span class="ident" id="7446631">tc</span><span class="op" id="7446633">.</span><span class="ident" id="7446634">input</span><span class="op" id="7446639">,</span>&nbsp;<span class="builtintype" id="7446641">int</span><span class="op" id="7446644">(</span><span class="ident" id="7446645">err</span><span class="op" id="7446648">)</span><span class="op" id="7446649">,</span>&nbsp;<span class="ident" id="7446651">tc</span><span class="op" id="7446653">.</span><span class="ident" id="7446654">offset</span><span class="op" id="7446660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446664">default</span><span class="op" id="7446671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446676">t</span><span class="op" id="7446677">.</span><span class="ident" id="7446678">Error</span><span class="op" id="7446683">(</span><span class="string" id="7446684">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="7446724">,</span>&nbsp;<span class="ident" id="7446726">tc</span><span class="op" id="7446728">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446735">}</span><br>
<span class="lineno"></span><span class="op" id="7446737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7446740">func</span>&nbsp;<span class="ident" id="7446745">TestBig</span><span class="op" id="7446752">(</span><span class="ident" id="7446753">t</span>&nbsp;<span class="op" id="7446755">*</span><span class="ident" id="7446756">testing</span><span class="op" id="7446763">.</span><span class="ident" id="7446764">T</span><span class="op" id="7446765">)</span>&nbsp;<span class="op" id="7446767">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446770">n</span>&nbsp;<span class="op" id="7446772">:=</span>&nbsp;<span class="num" id="7446775">3</span><span class="op" id="7446776">*</span><span class="num" id="7446777">1000</span>&nbsp;<span class="op" id="7446782">+</span>&nbsp;<span class="num" id="7446784">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446787">raw</span>&nbsp;<span class="op" id="7446791">:=</span>&nbsp;<span class="builtinfunc" id="7446794">make</span><span class="op" id="7446798">(</span><span class="op" id="7446799">[</span><span class="op" id="7446800">]</span><span class="builtintype" id="7446801">byte</span><span class="op" id="7446805">,</span>&nbsp;<span class="ident" id="7446807">n</span><span class="op" id="7446808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446811">const</span>&nbsp;<span class="ident" id="7446817">alpha</span>&nbsp;<span class="op" id="7446823">=</span>&nbsp;<span class="string" id="7446825">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7446891">for</span>&nbsp;<span class="ident" id="7446895">i</span>&nbsp;<span class="op" id="7446897">:=</span>&nbsp;<span class="num" id="7446900">0</span><span class="op" id="7446901">;</span>&nbsp;<span class="ident" id="7446903">i</span>&nbsp;<span class="op" id="7446905">&lt;</span>&nbsp;<span class="ident" id="7446907">n</span><span class="op" id="7446908">;</span>&nbsp;<span class="ident" id="7446910">i</span><span class="op" id="7446911">++</span>&nbsp;<span class="op" id="7446914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446918">raw</span><span class="op" id="7446921">[</span><span class="ident" id="7446922">i</span><span class="op" id="7446923">]</span>&nbsp;<span class="op" id="7446925">=</span>&nbsp;<span class="ident" id="7446927">alpha</span><span class="op" id="7446932">[</span><span class="ident" id="7446933">i</span><span class="op" id="7446934">%</span><span class="builtinfunc" id="7446935">len</span><span class="op" id="7446938">(</span><span class="ident" id="7446939">alpha</span><span class="op" id="7446944">)</span><span class="op" id="7446945">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7446948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446951">encoded</span>&nbsp;<span class="op" id="7446959">:=</span>&nbsp;<span class="builtinfunc" id="7446962">new</span><span class="op" id="7446965">(</span><span class="ident" id="7446966">bytes</span><span class="op" id="7446971">.</span><span class="ident" id="7446972">Buffer</span><span class="op" id="7446978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7446981">w</span>&nbsp;<span class="op" id="7446983">:=</span>&nbsp;<span class="ident" id="7446986">NewEncoder</span><span class="op" id="7446996">(</span><span class="ident" id="7446997">StdEncoding</span><span class="op" id="7447008">,</span>&nbsp;<span class="ident" id="7447010">encoded</span><span class="op" id="7447017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447020">nn</span><span class="op" id="7447022">,</span>&nbsp;<span class="ident" id="7447024">err</span>&nbsp;<span class="op" id="7447028">:=</span>&nbsp;<span class="ident" id="7447031">w</span><span class="op" id="7447032">.</span><span class="ident" id="7447033">Write</span><span class="op" id="7447038">(</span><span class="ident" id="7447039">raw</span><span class="op" id="7447042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447045">if</span>&nbsp;<span class="ident" id="7447048">nn</span>&nbsp;<span class="op" id="7447051">!=</span>&nbsp;<span class="ident" id="7447054">n</span>&nbsp;<span class="op" id="7447056">||</span>&nbsp;<span class="ident" id="7447059">err</span>&nbsp;<span class="op" id="7447063">!=</span>&nbsp;<span class="ident" id="7447066">nil</span>&nbsp;<span class="op" id="7447070">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447074">t</span><span class="op" id="7447075">.</span><span class="ident" id="7447076">Fatalf</span><span class="op" id="7447082">(</span><span class="string" id="7447083">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="7447125">,</span>&nbsp;<span class="ident" id="7447127">nn</span><span class="op" id="7447129">,</span>&nbsp;<span class="ident" id="7447131">err</span><span class="op" id="7447134">,</span>&nbsp;<span class="ident" id="7447136">n</span><span class="op" id="7447137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447143">err</span>&nbsp;<span class="op" id="7447147">=</span>&nbsp;<span class="ident" id="7447149">w</span><span class="op" id="7447150">.</span><span class="ident" id="7447151">Close</span><span class="op" id="7447156">(</span><span class="op" id="7447157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447160">if</span>&nbsp;<span class="ident" id="7447163">err</span>&nbsp;<span class="op" id="7447167">!=</span>&nbsp;<span class="ident" id="7447170">nil</span>&nbsp;<span class="op" id="7447174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447178">t</span><span class="op" id="7447179">.</span><span class="ident" id="7447180">Fatalf</span><span class="op" id="7447186">(</span><span class="string" id="7447187">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7447218">,</span>&nbsp;<span class="ident" id="7447220">err</span><span class="op" id="7447223">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447229">decoded</span><span class="op" id="7447236">,</span>&nbsp;<span class="ident" id="7447238">err</span>&nbsp;<span class="op" id="7447242">:=</span>&nbsp;<span class="ident" id="7447245">ioutil</span><span class="op" id="7447251">.</span><span class="ident" id="7447252">ReadAll</span><span class="op" id="7447259">(</span><span class="ident" id="7447260">NewDecoder</span><span class="op" id="7447270">(</span><span class="ident" id="7447271">StdEncoding</span><span class="op" id="7447282">,</span>&nbsp;<span class="ident" id="7447284">encoded</span><span class="op" id="7447291">)</span><span class="op" id="7447292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447295">if</span>&nbsp;<span class="ident" id="7447298">err</span>&nbsp;<span class="op" id="7447302">!=</span>&nbsp;<span class="ident" id="7447305">nil</span>&nbsp;<span class="op" id="7447309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447313">t</span><span class="op" id="7447314">.</span><span class="ident" id="7447315">Fatalf</span><span class="op" id="7447321">(</span><span class="string" id="7447322">&#34;ioutil.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="7447359">,</span>&nbsp;<span class="ident" id="7447361">err</span><span class="op" id="7447364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447367">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447371">if</span>&nbsp;<span class="op" id="7447374">!</span><span class="ident" id="7447375">bytes</span><span class="op" id="7447380">.</span><span class="ident" id="7447381">Equal</span><span class="op" id="7447386">(</span><span class="ident" id="7447387">raw</span><span class="op" id="7447390">,</span>&nbsp;<span class="ident" id="7447392">decoded</span><span class="op" id="7447399">)</span>&nbsp;<span class="op" id="7447401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447405">var</span>&nbsp;<span class="ident" id="7447409">i</span>&nbsp;<span class="builtintype" id="7447411">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447417">for</span>&nbsp;<span class="ident" id="7447421">i</span>&nbsp;<span class="op" id="7447423">=</span>&nbsp;<span class="num" id="7447425">0</span><span class="op" id="7447426">;</span>&nbsp;<span class="ident" id="7447428">i</span>&nbsp;<span class="op" id="7447430">&lt;</span>&nbsp;<span class="builtinfunc" id="7447432">len</span><span class="op" id="7447435">(</span><span class="ident" id="7447436">decoded</span><span class="op" id="7447443">)</span>&nbsp;<span class="op" id="7447445">&amp;&amp;</span>&nbsp;<span class="ident" id="7447448">i</span>&nbsp;<span class="op" id="7447450">&lt;</span>&nbsp;<span class="builtinfunc" id="7447452">len</span><span class="op" id="7447455">(</span><span class="ident" id="7447456">raw</span><span class="op" id="7447459">)</span><span class="op" id="7447460">;</span>&nbsp;<span class="ident" id="7447462">i</span><span class="op" id="7447463">++</span>&nbsp;<span class="op" id="7447466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447471">if</span>&nbsp;<span class="ident" id="7447474">decoded</span><span class="op" id="7447481">[</span><span class="ident" id="7447482">i</span><span class="op" id="7447483">]</span>&nbsp;<span class="op" id="7447485">!=</span>&nbsp;<span class="ident" id="7447488">raw</span><span class="op" id="7447491">[</span><span class="ident" id="7447492">i</span><span class="op" id="7447493">]</span>&nbsp;<span class="op" id="7447495">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447501">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447518">t</span><span class="op" id="7447519">.</span><span class="ident" id="7447520">Errorf</span><span class="op" id="7447526">(</span><span class="string" id="7447527">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="7447579">,</span>&nbsp;<span class="ident" id="7447581">n</span><span class="op" id="7447582">,</span>&nbsp;<span class="ident" id="7447584">i</span><span class="op" id="7447585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447588">}</span><br>
<span class="lineno">220</span><span class="op" id="7447590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7447593">func</span>&nbsp;<span class="ident" id="7447598">TestNewLineCharacters</span><span class="op" id="7447619">(</span><span class="ident" id="7447620">t</span>&nbsp;<span class="op" id="7447622">*</span><span class="ident" id="7447623">testing</span><span class="op" id="7447630">.</span><span class="ident" id="7447631">T</span><span class="op" id="7447632">)</span>&nbsp;<span class="op" id="7447634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7447637">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;should&nbsp;decode&nbsp;to&nbsp;the&nbsp;string&nbsp;&#34;sure&#34;,&nbsp;without&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447707">const</span>&nbsp;<span class="ident" id="7447713">expected</span>&nbsp;<span class="op" id="7447722">=</span>&nbsp;<span class="string" id="7447724">&#34;sure&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447732">examples</span>&nbsp;<span class="op" id="7447741">:=</span>&nbsp;<span class="op" id="7447744">[</span><span class="op" id="7447745">]</span><span class="builtintype" id="7447746">string</span><span class="op" id="7447752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447756">&#34;c3VyZQ==&#34;</span><span class="op" id="7447766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447770">&#34;c3VyZQ==\r&#34;</span><span class="op" id="7447782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447786">&#34;c3VyZQ==\n&#34;</span><span class="op" id="7447798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447802">&#34;c3VyZQ==\r\n&#34;</span><span class="op" id="7447816">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447820">&#34;c3VyZ\r\nQ==&#34;</span><span class="op" id="7447834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447838">&#34;c3V\ryZ\nQ==&#34;</span><span class="op" id="7447852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447856">&#34;c3V\nyZ\rQ==&#34;</span><span class="op" id="7447870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447874">&#34;c3VyZ\nQ==&#34;</span><span class="op" id="7447886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447890">&#34;c3VyZQ\n==&#34;</span><span class="op" id="7447902">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447906">&#34;c3VyZQ=\n=&#34;</span><span class="op" id="7447918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7447922">&#34;c3VyZQ=\r\n\r\n=&#34;</span><span class="op" id="7447940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7447943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7447946">for</span>&nbsp;<span class="ident" id="7447950">_</span><span class="op" id="7447951">,</span>&nbsp;<span class="ident" id="7447953">e</span>&nbsp;<span class="op" id="7447955">:=</span>&nbsp;<span class="keyword" id="7447958">range</span>&nbsp;<span class="ident" id="7447964">examples</span>&nbsp;<span class="op" id="7447973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7447977">buf</span><span class="op" id="7447980">,</span>&nbsp;<span class="ident" id="7447982">err</span>&nbsp;<span class="op" id="7447986">:=</span>&nbsp;<span class="ident" id="7447989">StdEncoding</span><span class="op" id="7448000">.</span><span class="ident" id="7448001">DecodeString</span><span class="op" id="7448013">(</span><span class="ident" id="7448014">e</span><span class="op" id="7448015">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448019">if</span>&nbsp;<span class="ident" id="7448022">err</span>&nbsp;<span class="op" id="7448026">!=</span>&nbsp;<span class="ident" id="7448029">nil</span>&nbsp;<span class="op" id="7448033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448038">t</span><span class="op" id="7448039">.</span><span class="ident" id="7448040">Errorf</span><span class="op" id="7448046">(</span><span class="string" id="7448047">&#34;Decode(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7448070">,</span>&nbsp;<span class="ident" id="7448072">e</span><span class="op" id="7448073">,</span>&nbsp;<span class="ident" id="7448075">err</span><span class="op" id="7448078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448083">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448098">if</span>&nbsp;<span class="ident" id="7448101">s</span>&nbsp;<span class="op" id="7448103">:=</span>&nbsp;<span class="builtintype" id="7448106">string</span><span class="op" id="7448112">(</span><span class="ident" id="7448113">buf</span><span class="op" id="7448116">)</span><span class="op" id="7448117">;</span>&nbsp;<span class="ident" id="7448119">s</span>&nbsp;<span class="op" id="7448121">!=</span>&nbsp;<span class="ident" id="7448124">expected</span>&nbsp;<span class="op" id="7448133">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448138">t</span><span class="op" id="7448139">.</span><span class="ident" id="7448140">Errorf</span><span class="op" id="7448146">(</span><span class="string" id="7448147">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7448173">,</span>&nbsp;<span class="ident" id="7448175">e</span><span class="op" id="7448176">,</span>&nbsp;<span class="ident" id="7448178">s</span><span class="op" id="7448179">,</span>&nbsp;<span class="ident" id="7448181">expected</span><span class="op" id="7448189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448196">}</span><br>
<span class="lineno"></span><span class="op" id="7448198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7448201">type</span>&nbsp;<span class="ident" id="7448206">nextRead</span>&nbsp;<span class="keyword" id="7448215">struct</span>&nbsp;<span class="op" id="7448222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448225">n</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7448229">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7448235">//&nbsp;bytes&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448255">err</span>&nbsp;<span class="builtintype" id="7448259">error</span>&nbsp;<span class="comment" id="7448265">//&nbsp;error&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="op" id="7448284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="7448287">//&nbsp;faultInjectReader&nbsp;returns&nbsp;data&nbsp;from&nbsp;source,&nbsp;rate-limited</span><br>
<span class="lineno"></span><span class="comment" id="7448347">//&nbsp;and&nbsp;with&nbsp;the&nbsp;errors&nbsp;as&nbsp;written&nbsp;to&nbsp;nextc.</span><br>
<span class="lineno"></span><span class="keyword" id="7448391">type</span>&nbsp;<span class="ident" id="7448396">faultInjectReader</span>&nbsp;<span class="keyword" id="7448414">struct</span>&nbsp;<span class="op" id="7448421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448424">source</span>&nbsp;<span class="builtintype" id="7448431">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448439">nextc</span>&nbsp;&nbsp;<span class="op" id="7448446">&lt;-</span><span class="keyword" id="7448448">chan</span>&nbsp;<span class="ident" id="7448453">nextRead</span><br>
<span class="lineno">260</span><span class="op" id="7448462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7448465">func</span>&nbsp;<span class="op" id="7448470">(</span><span class="ident" id="7448471">r</span>&nbsp;<span class="op" id="7448473">*</span><span class="ident" id="7448474">faultInjectReader</span><span class="op" id="7448491">)</span>&nbsp;<span class="ident" id="7448493">Read</span><span class="op" id="7448497">(</span><span class="ident" id="7448498">p</span>&nbsp;<span class="op" id="7448500">[</span><span class="op" id="7448501">]</span><span class="builtintype" id="7448502">byte</span><span class="op" id="7448506">)</span>&nbsp;<span class="op" id="7448508">(</span><span class="builtintype" id="7448509">int</span><span class="op" id="7448512">,</span>&nbsp;<span class="builtintype" id="7448514">error</span><span class="op" id="7448519">)</span>&nbsp;<span class="op" id="7448521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448524">nr</span>&nbsp;<span class="op" id="7448527">:=</span>&nbsp;<span class="op" id="7448530">&lt;-</span><span class="ident" id="7448532">r</span><span class="op" id="7448533">.</span><span class="ident" id="7448534">nextc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448541">if</span>&nbsp;<span class="builtinfunc" id="7448544">len</span><span class="op" id="7448547">(</span><span class="ident" id="7448548">p</span><span class="op" id="7448549">)</span>&nbsp;<span class="op" id="7448551">&gt;</span>&nbsp;<span class="ident" id="7448553">nr</span><span class="op" id="7448555">.</span><span class="ident" id="7448556">n</span>&nbsp;<span class="op" id="7448558">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448562">p</span>&nbsp;<span class="op" id="7448564">=</span>&nbsp;<span class="ident" id="7448566">p</span><span class="op" id="7448567">[</span><span class="op" id="7448568">:</span><span class="ident" id="7448569">nr</span><span class="op" id="7448571">.</span><span class="ident" id="7448572">n</span><span class="op" id="7448573">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7448576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448579">n</span>&nbsp;<span class="op" id="7448581">:=</span>&nbsp;<span class="builtinfunc" id="7448584">copy</span><span class="op" id="7448588">(</span><span class="ident" id="7448589">p</span><span class="op" id="7448590">,</span>&nbsp;<span class="ident" id="7448592">r</span><span class="op" id="7448593">.</span><span class="ident" id="7448594">source</span><span class="op" id="7448600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448603">r</span><span class="op" id="7448604">.</span><span class="ident" id="7448605">source</span>&nbsp;<span class="op" id="7448612">=</span>&nbsp;<span class="ident" id="7448614">r</span><span class="op" id="7448615">.</span><span class="ident" id="7448616">source</span><span class="op" id="7448622">[</span><span class="ident" id="7448623">n</span><span class="op" id="7448624">:</span><span class="op" id="7448625">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7448628">return</span>&nbsp;<span class="ident" id="7448635">n</span><span class="op" id="7448636">,</span>&nbsp;<span class="ident" id="7448638">nr</span><span class="op" id="7448640">.</span><span class="ident" id="7448641">err</span><br>
<span class="lineno">270</span><span class="op" id="7448645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7448648">//&nbsp;tests&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;ignore&nbsp;errors&nbsp;from&nbsp;our&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span><span class="keyword" id="7448712">func</span>&nbsp;<span class="ident" id="7448717">TestDecoderIssue3577</span><span class="op" id="7448737">(</span><span class="ident" id="7448738">t</span>&nbsp;<span class="op" id="7448740">*</span><span class="ident" id="7448741">testing</span><span class="op" id="7448748">.</span><span class="ident" id="7448749">T</span><span class="op" id="7448750">)</span>&nbsp;<span class="op" id="7448752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448755">next</span>&nbsp;<span class="op" id="7448760">:=</span>&nbsp;<span class="builtinfunc" id="7448763">make</span><span class="op" id="7448767">(</span><span class="keyword" id="7448768">chan</span>&nbsp;<span class="ident" id="7448773">nextRead</span><span class="op" id="7448781">,</span>&nbsp;<span class="num" id="7448783">10</span><span class="op" id="7448785">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448788">wantErr</span>&nbsp;<span class="op" id="7448796">:=</span>&nbsp;<span class="ident" id="7448799">errors</span><span class="op" id="7448805">.</span><span class="ident" id="7448806">New</span><span class="op" id="7448809">(</span><span class="string" id="7448810">&#34;my&nbsp;error&#34;</span><span class="op" id="7448820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448823">next</span>&nbsp;<span class="op" id="7448828">&lt;-</span>&nbsp;<span class="ident" id="7448831">nextRead</span><span class="op" id="7448839">{</span><span class="num" id="7448840">5</span><span class="op" id="7448841">,</span>&nbsp;<span class="ident" id="7448843">nil</span><span class="op" id="7448846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448849">next</span>&nbsp;<span class="op" id="7448854">&lt;-</span>&nbsp;<span class="ident" id="7448857">nextRead</span><span class="op" id="7448865">{</span><span class="num" id="7448866">10</span><span class="op" id="7448868">,</span>&nbsp;<span class="ident" id="7448870">wantErr</span><span class="op" id="7448877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448880">next</span>&nbsp;<span class="op" id="7448885">&lt;-</span>&nbsp;<span class="ident" id="7448888">nextRead</span><span class="op" id="7448896">{</span><span class="num" id="7448897">0</span><span class="op" id="7448898">,</span>&nbsp;<span class="ident" id="7448900">wantErr</span><span class="op" id="7448907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448910">d</span>&nbsp;<span class="op" id="7448912">:=</span>&nbsp;<span class="ident" id="7448915">NewDecoder</span><span class="op" id="7448925">(</span><span class="ident" id="7448926">StdEncoding</span><span class="op" id="7448937">,</span>&nbsp;<span class="op" id="7448939">&amp;</span><span class="ident" id="7448940">faultInjectReader</span><span class="op" id="7448957">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7448961">source</span><span class="op" id="7448967">:</span>&nbsp;<span class="string" id="7448969">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="7449019">,</span>&nbsp;<span class="comment" id="7449021">//&nbsp;twas&nbsp;brillig...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449042">nextc</span><span class="op" id="7449047">:</span>&nbsp;&nbsp;<span class="ident" id="7449050">next</span><span class="op" id="7449054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449057">}</span><span class="op" id="7449058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449061">errc</span>&nbsp;<span class="op" id="7449066">:=</span>&nbsp;<span class="builtinfunc" id="7449069">make</span><span class="op" id="7449073">(</span><span class="keyword" id="7449074">chan</span>&nbsp;<span class="builtintype" id="7449079">error</span><span class="op" id="7449084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449087">go</span>&nbsp;<span class="keyword" id="7449090">func</span><span class="op" id="7449094">(</span><span class="op" id="7449095">)</span>&nbsp;<span class="op" id="7449097">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449101">_</span><span class="op" id="7449102">,</span>&nbsp;<span class="ident" id="7449104">err</span>&nbsp;<span class="op" id="7449108">:=</span>&nbsp;<span class="ident" id="7449111">ioutil</span><span class="op" id="7449117">.</span><span class="ident" id="7449118">ReadAll</span><span class="op" id="7449125">(</span><span class="ident" id="7449126">d</span><span class="op" id="7449127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449131">errc</span>&nbsp;<span class="op" id="7449136">&lt;-</span>&nbsp;<span class="ident" id="7449139">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449144">}</span><span class="op" id="7449145">(</span><span class="op" id="7449146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449149">select</span>&nbsp;<span class="op" id="7449156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449159">case</span>&nbsp;<span class="ident" id="7449164">err</span>&nbsp;<span class="op" id="7449168">:=</span>&nbsp;<span class="op" id="7449171">&lt;-</span><span class="ident" id="7449173">errc</span><span class="op" id="7449177">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449181">if</span>&nbsp;<span class="ident" id="7449184">err</span>&nbsp;<span class="op" id="7449188">!=</span>&nbsp;<span class="ident" id="7449191">wantErr</span>&nbsp;<span class="op" id="7449199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449204">t</span><span class="op" id="7449205">.</span><span class="ident" id="7449206">Errorf</span><span class="op" id="7449212">(</span><span class="string" id="7449213">&#34;got&nbsp;error&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7449236">,</span>&nbsp;<span class="ident" id="7449238">err</span><span class="op" id="7449241">,</span>&nbsp;<span class="ident" id="7449243">wantErr</span><span class="op" id="7449250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7449257">case</span>&nbsp;<span class="op" id="7449262">&lt;-</span><span class="ident" id="7449264">time</span><span class="op" id="7449268">.</span><span class="ident" id="7449269">After</span><span class="op" id="7449274">(</span><span class="num" id="7449275">5</span>&nbsp;<span class="op" id="7449277">*</span>&nbsp;<span class="ident" id="7449279">time</span><span class="op" id="7449283">.</span><span class="ident" id="7449284">Second</span><span class="op" id="7449290">)</span><span class="op" id="7449291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449295">t</span><span class="op" id="7449296">.</span><span class="ident" id="7449297">Errorf</span><span class="op" id="7449303">(</span><span class="string" id="7449304">&#34;timeout;&nbsp;Decoder&nbsp;blocked&nbsp;without&nbsp;returning&nbsp;an&nbsp;error&#34;</span><span class="op" id="7449357">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7449360">}</span><br>
<span class="lineno"></span><span class="op" id="7449362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7449365">func</span>&nbsp;<span class="ident" id="7449370">TestDecoderIssue4779</span><span class="op" id="7449390">(</span><span class="ident" id="7449391">t</span>&nbsp;<span class="op" id="7449393">*</span><span class="ident" id="7449394">testing</span><span class="op" id="7449401">.</span><span class="ident" id="7449402">T</span><span class="op" id="7449403">)</span>&nbsp;<span class="op" id="7449405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7449408">encoded</span>&nbsp;<span class="op" id="7449416">:=</span>&nbsp;<span class="string" id="7449419">`CP/EAT8AAAEF<br>
<span class="lineno">300</span>AQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAAB<br>
<span class="lineno"></span>BAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHx<br>
<span class="lineno"></span>Y3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm<br>
<span class="lineno"></span>9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS<br>
<span class="lineno"></span>0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0<br>
<span class="lineno">305</span>pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A9VSSSSUpJJJJSkkkJ+Tj<br>
<span class="lineno"></span>1kiy1jCJJDnAcCTykpKkuQ6p/jN6FgmxlNduXawwAzaGH+V6jn/R/wCt71zdn+N/qL3kVYFNYB4N<br>
<span class="lineno"></span>ji6PDVjWpKp9TSXnvTf8bFNjg3qOEa2n6VlLpj/rT/pf567DpX1i6L1hs9Py67X8mqdtg/rUWbbf<br>
<span class="lineno"></span>+gkp0kkkklKSSSSUpJJJJT//0PVUkkklKVLq3WMDpGI7KzrNjADtYNXvI/Mqr/Pd/q9W3vaxjnvM<br>
<span class="lineno"></span>NaCXE9gNSvGPrf8AWS3qmba5jjsJhoB0DAf0NDf6sevf+/lf8Hj0JJATfWT6/dV6oXU1uOLQeKKn<br>
<span class="lineno">310</span>EQP+Hubtfe/+R7Mf/g7f5xcocp++Z11JMCJPgFBxOg7/AOuqDx8I/ikpkXkmSdU8mJIJA/O8EMAy<br>
<span class="lineno"></span>j+mSARB/17pKVXYWHXjsj7yIex0PadzXMO1zT5KHoNA3HT8ietoGhgjsfA+CSnvvqh/jJtqsrwOv<br>
<span class="lineno"></span>2b6NGNzXfTYexzJ+nU7/ALkf4P8Awv6P9KvTQQ4AgyDqCF85Pho3CTB7eHwXoH+LT65uZbX9X+o2<br>
<span class="lineno"></span>bqbPb06551Y4<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450450">encodedShort</span>&nbsp;<span class="op" id="7450463">:=</span>&nbsp;<span class="ident" id="7450466">strings</span><span class="op" id="7450473">.</span><span class="ident" id="7450474">Replace</span><span class="op" id="7450481">(</span><span class="ident" id="7450482">encoded</span><span class="op" id="7450489">,</span>&nbsp;<span class="string" id="7450491">&#34;\n&#34;</span><span class="op" id="7450495">,</span>&nbsp;<span class="string" id="7450497">&#34;&#34;</span><span class="op" id="7450499">,</span>&nbsp;<span class="op" id="7450501">-</span><span class="num" id="7450502">1</span><span class="op" id="7450503">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450507">dec</span>&nbsp;<span class="op" id="7450511">:=</span>&nbsp;<span class="ident" id="7450514">NewDecoder</span><span class="op" id="7450524">(</span><span class="ident" id="7450525">StdEncoding</span><span class="op" id="7450536">,</span>&nbsp;<span class="ident" id="7450538">strings</span><span class="op" id="7450545">.</span><span class="ident" id="7450546">NewReader</span><span class="op" id="7450555">(</span><span class="ident" id="7450556">encoded</span><span class="op" id="7450563">)</span><span class="op" id="7450564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450567">res1</span><span class="op" id="7450571">,</span>&nbsp;<span class="ident" id="7450573">err</span>&nbsp;<span class="op" id="7450577">:=</span>&nbsp;<span class="ident" id="7450580">ioutil</span><span class="op" id="7450586">.</span><span class="ident" id="7450587">ReadAll</span><span class="op" id="7450594">(</span><span class="ident" id="7450595">dec</span><span class="op" id="7450598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450601">if</span>&nbsp;<span class="ident" id="7450604">err</span>&nbsp;<span class="op" id="7450608">!=</span>&nbsp;<span class="ident" id="7450611">nil</span>&nbsp;<span class="op" id="7450615">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450619">t</span><span class="op" id="7450620">.</span><span class="ident" id="7450621">Errorf</span><span class="op" id="7450627">(</span><span class="string" id="7450628">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7450648">,</span>&nbsp;<span class="ident" id="7450650">err</span><span class="op" id="7450653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7450656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450660">dec</span>&nbsp;<span class="op" id="7450664">=</span>&nbsp;<span class="ident" id="7450666">NewDecoder</span><span class="op" id="7450676">(</span><span class="ident" id="7450677">StdEncoding</span><span class="op" id="7450688">,</span>&nbsp;<span class="ident" id="7450690">strings</span><span class="op" id="7450697">.</span><span class="ident" id="7450698">NewReader</span><span class="op" id="7450707">(</span><span class="ident" id="7450708">encodedShort</span><span class="op" id="7450720">)</span><span class="op" id="7450721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450724">var</span>&nbsp;<span class="ident" id="7450728">res2</span>&nbsp;<span class="op" id="7450733">[</span><span class="op" id="7450734">]</span><span class="builtintype" id="7450735">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450741">res2</span><span class="op" id="7450745">,</span>&nbsp;<span class="ident" id="7450747">err</span>&nbsp;<span class="op" id="7450751">=</span>&nbsp;<span class="ident" id="7450753">ioutil</span><span class="op" id="7450759">.</span><span class="ident" id="7450760">ReadAll</span><span class="op" id="7450767">(</span><span class="ident" id="7450768">dec</span><span class="op" id="7450771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450774">if</span>&nbsp;<span class="ident" id="7450777">err</span>&nbsp;<span class="op" id="7450781">!=</span>&nbsp;<span class="ident" id="7450784">nil</span>&nbsp;<span class="op" id="7450788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450792">t</span><span class="op" id="7450793">.</span><span class="ident" id="7450794">Errorf</span><span class="op" id="7450800">(</span><span class="string" id="7450801">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7450821">,</span>&nbsp;<span class="ident" id="7450823">err</span><span class="op" id="7450826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7450829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7450833">if</span>&nbsp;<span class="op" id="7450836">!</span><span class="ident" id="7450837">bytes</span><span class="op" id="7450842">.</span><span class="ident" id="7450843">Equal</span><span class="op" id="7450848">(</span><span class="ident" id="7450849">res1</span><span class="op" id="7450853">,</span>&nbsp;<span class="ident" id="7450855">res2</span><span class="op" id="7450859">)</span>&nbsp;<span class="op" id="7450861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450865">t</span><span class="op" id="7450866">.</span><span class="ident" id="7450867">Error</span><span class="op" id="7450872">(</span><span class="string" id="7450873">&#34;Decoded&nbsp;results&nbsp;not&nbsp;equal&#34;</span><span class="op" id="7450900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7450903">}</span><br>
<span class="lineno"></span><span class="op" id="7450905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="7450908">func</span>&nbsp;<span class="ident" id="7450913">TestDecoderIssue7733</span><span class="op" id="7450933">(</span><span class="ident" id="7450934">t</span>&nbsp;<span class="op" id="7450936">*</span><span class="ident" id="7450937">testing</span><span class="op" id="7450944">.</span><span class="ident" id="7450945">T</span><span class="op" id="7450946">)</span>&nbsp;<span class="op" id="7450948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7450951">s</span><span class="op" id="7450952">,</span>&nbsp;<span class="ident" id="7450954">err</span>&nbsp;<span class="op" id="7450958">:=</span>&nbsp;<span class="ident" id="7450961">StdEncoding</span><span class="op" id="7450972">.</span><span class="ident" id="7450973">DecodeString</span><span class="op" id="7450985">(</span><span class="string" id="7450986">&#34;YWJjZA=====&#34;</span><span class="op" id="7450999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451002">want</span>&nbsp;<span class="op" id="7451007">:=</span>&nbsp;<span class="ident" id="7451010">CorruptInputError</span><span class="op" id="7451027">(</span><span class="num" id="7451028">8</span><span class="op" id="7451029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451032">if</span>&nbsp;<span class="op" id="7451035">!</span><span class="ident" id="7451036">reflect</span><span class="op" id="7451043">.</span><span class="ident" id="7451044">DeepEqual</span><span class="op" id="7451053">(</span><span class="ident" id="7451054">want</span><span class="op" id="7451058">,</span>&nbsp;<span class="ident" id="7451060">err</span><span class="op" id="7451063">)</span>&nbsp;<span class="op" id="7451065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451069">t</span><span class="op" id="7451070">.</span><span class="ident" id="7451071">Errorf</span><span class="op" id="7451077">(</span><span class="string" id="7451078">&#34;Error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;CorruptInputError(8)&#34;</span><span class="op" id="7451117">,</span>&nbsp;<span class="ident" id="7451119">err</span><span class="op" id="7451122">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451128">if</span>&nbsp;<span class="builtintype" id="7451131">string</span><span class="op" id="7451137">(</span><span class="ident" id="7451138">s</span><span class="op" id="7451139">)</span>&nbsp;<span class="op" id="7451141">!=</span>&nbsp;<span class="string" id="7451144">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7451151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451155">t</span><span class="op" id="7451156">.</span><span class="ident" id="7451157">Errorf</span><span class="op" id="7451163">(</span><span class="string" id="7451164">&#34;DecodeString&nbsp;=&nbsp;%q;&nbsp;want&nbsp;abcd&#34;</span><span class="op" id="7451194">,</span>&nbsp;<span class="ident" id="7451196">s</span><span class="op" id="7451197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451200">}</span><br>
<span class="lineno"></span><span class="op" id="7451202">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7451205">func</span>&nbsp;<span class="ident" id="7451210">BenchmarkEncodeToString</span><span class="op" id="7451233">(</span><span class="ident" id="7451234">b</span>&nbsp;<span class="op" id="7451236">*</span><span class="ident" id="7451237">testing</span><span class="op" id="7451244">.</span><span class="ident" id="7451245">B</span><span class="op" id="7451246">)</span>&nbsp;<span class="op" id="7451248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451251">data</span>&nbsp;<span class="op" id="7451256">:=</span>&nbsp;<span class="builtinfunc" id="7451259">make</span><span class="op" id="7451263">(</span><span class="op" id="7451264">[</span><span class="op" id="7451265">]</span><span class="builtintype" id="7451266">byte</span><span class="op" id="7451270">,</span>&nbsp;<span class="num" id="7451272">8192</span><span class="op" id="7451276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451279">b</span><span class="op" id="7451280">.</span><span class="ident" id="7451281">SetBytes</span><span class="op" id="7451289">(</span><span class="ident" id="7451290">int64</span><span class="op" id="7451295">(</span><span class="builtinfunc" id="7451296">len</span><span class="op" id="7451299">(</span><span class="ident" id="7451300">data</span><span class="op" id="7451304">)</span><span class="op" id="7451305">)</span><span class="op" id="7451306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451309">for</span>&nbsp;<span class="ident" id="7451313">i</span>&nbsp;<span class="op" id="7451315">:=</span>&nbsp;<span class="num" id="7451318">0</span><span class="op" id="7451319">;</span>&nbsp;<span class="ident" id="7451321">i</span>&nbsp;<span class="op" id="7451323">&lt;</span>&nbsp;<span class="ident" id="7451325">b</span><span class="op" id="7451326">.</span><span class="ident" id="7451327">N</span><span class="op" id="7451328">;</span>&nbsp;<span class="ident" id="7451330">i</span><span class="op" id="7451331">++</span>&nbsp;<span class="op" id="7451334">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451338">StdEncoding</span><span class="op" id="7451349">.</span><span class="ident" id="7451350">EncodeToString</span><span class="op" id="7451364">(</span><span class="ident" id="7451365">data</span><span class="op" id="7451369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451372">}</span><br>
<span class="lineno"></span><span class="op" id="7451374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7451377">func</span>&nbsp;<span class="ident" id="7451382">BenchmarkDecodeString</span><span class="op" id="7451403">(</span><span class="ident" id="7451404">b</span>&nbsp;<span class="op" id="7451406">*</span><span class="ident" id="7451407">testing</span><span class="op" id="7451414">.</span><span class="ident" id="7451415">B</span><span class="op" id="7451416">)</span>&nbsp;<span class="op" id="7451418">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451421">data</span>&nbsp;<span class="op" id="7451426">:=</span>&nbsp;<span class="ident" id="7451429">StdEncoding</span><span class="op" id="7451440">.</span><span class="ident" id="7451441">EncodeToString</span><span class="op" id="7451455">(</span><span class="builtinfunc" id="7451456">make</span><span class="op" id="7451460">(</span><span class="op" id="7451461">[</span><span class="op" id="7451462">]</span><span class="builtintype" id="7451463">byte</span><span class="op" id="7451467">,</span>&nbsp;<span class="num" id="7451469">8192</span><span class="op" id="7451473">)</span><span class="op" id="7451474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451477">b</span><span class="op" id="7451478">.</span><span class="ident" id="7451479">SetBytes</span><span class="op" id="7451487">(</span><span class="ident" id="7451488">int64</span><span class="op" id="7451493">(</span><span class="builtinfunc" id="7451494">len</span><span class="op" id="7451497">(</span><span class="ident" id="7451498">data</span><span class="op" id="7451502">)</span><span class="op" id="7451503">)</span><span class="op" id="7451504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7451507">for</span>&nbsp;<span class="ident" id="7451511">i</span>&nbsp;<span class="op" id="7451513">:=</span>&nbsp;<span class="num" id="7451516">0</span><span class="op" id="7451517">;</span>&nbsp;<span class="ident" id="7451519">i</span>&nbsp;<span class="op" id="7451521">&lt;</span>&nbsp;<span class="ident" id="7451523">b</span><span class="op" id="7451524">.</span><span class="ident" id="7451525">N</span><span class="op" id="7451526">;</span>&nbsp;<span class="ident" id="7451528">i</span><span class="op" id="7451529">++</span>&nbsp;<span class="op" id="7451532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7451536">StdEncoding</span><span class="op" id="7451547">.</span><span class="ident" id="7451548">DecodeString</span><span class="op" id="7451560">(</span><span class="ident" id="7451561">data</span><span class="op" id="7451565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7451568">}</span><br>
<span class="lineno">360</span><span class="op" id="7451570">}</span>
</div>
</body>
</html>
