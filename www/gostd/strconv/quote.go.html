<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html" class="current">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2299697">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2299752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2299806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2299857">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2299913">package</span>&nbsp;<span class="ident" id="2299921">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2299930">import</span>&nbsp;<span class="op" id="2299937">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2299940">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2299955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2299958">const</span>&nbsp;<span class="ident" id="2299964">lowerhex</span>&nbsp;<span class="op" id="2299973">=</span>&nbsp;<span class="string" id="2299975">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2299995">func</span>&nbsp;<span class="ident" id="2300000">quoteWith</span><span class="op" id="2300009">(</span><span class="ident" id="2300010">s</span>&nbsp;<span class="builtintype" id="2300012">string</span><span class="op" id="2300018">,</span>&nbsp;<span class="ident" id="2300020">quote</span>&nbsp;<span class="builtintype" id="2300026">byte</span><span class="op" id="2300030">,</span>&nbsp;<span class="ident" id="2300032">ASCIIonly</span>&nbsp;<span class="builtintype" id="2300042">bool</span><span class="op" id="2300046">)</span>&nbsp;<span class="builtintype" id="2300048">string</span>&nbsp;<span class="op" id="2300055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300058">var</span>&nbsp;<span class="ident" id="2300062">runeTmp</span>&nbsp;<span class="op" id="2300070">[</span><span class="ident" id="2300071">utf8</span><span class="op" id="2300075">.</span><span class="ident" id="2300076">UTFMax</span><span class="op" id="2300082">]</span><span class="builtintype" id="2300083">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300089">buf</span>&nbsp;<span class="op" id="2300093">:=</span>&nbsp;<span class="builtinfunc" id="2300096">make</span><span class="op" id="2300100">(</span><span class="op" id="2300101">[</span><span class="op" id="2300102">]</span><span class="builtintype" id="2300103">byte</span><span class="op" id="2300107">,</span>&nbsp;<span class="num" id="2300109">0</span><span class="op" id="2300110">,</span>&nbsp;<span class="num" id="2300112">3</span><span class="op" id="2300113">*</span><span class="builtinfunc" id="2300114">len</span><span class="op" id="2300117">(</span><span class="ident" id="2300118">s</span><span class="op" id="2300119">)</span><span class="op" id="2300120">/</span><span class="num" id="2300121">2</span><span class="op" id="2300122">)</span>&nbsp;<span class="comment" id="2300124">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300159">buf</span>&nbsp;<span class="op" id="2300163">=</span>&nbsp;<span class="builtinfunc" id="2300165">append</span><span class="op" id="2300171">(</span><span class="ident" id="2300172">buf</span><span class="op" id="2300175">,</span>&nbsp;<span class="ident" id="2300177">quote</span><span class="op" id="2300182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300185">for</span>&nbsp;<span class="ident" id="2300189">width</span>&nbsp;<span class="op" id="2300195">:=</span>&nbsp;<span class="num" id="2300198">0</span><span class="op" id="2300199">;</span>&nbsp;<span class="builtinfunc" id="2300201">len</span><span class="op" id="2300204">(</span><span class="ident" id="2300205">s</span><span class="op" id="2300206">)</span>&nbsp;<span class="op" id="2300208">&gt;</span>&nbsp;<span class="num" id="2300210">0</span><span class="op" id="2300211">;</span>&nbsp;<span class="ident" id="2300213">s</span>&nbsp;<span class="op" id="2300215">=</span>&nbsp;<span class="ident" id="2300217">s</span><span class="op" id="2300218">[</span><span class="ident" id="2300219">width</span><span class="op" id="2300224">:</span><span class="op" id="2300225">]</span>&nbsp;<span class="op" id="2300227">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300231">r</span>&nbsp;<span class="op" id="2300233">:=</span>&nbsp;<span class="builtintype" id="2300236">rune</span><span class="op" id="2300240">(</span><span class="ident" id="2300241">s</span><span class="op" id="2300242">[</span><span class="num" id="2300243">0</span><span class="op" id="2300244">]</span><span class="op" id="2300245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300249">width</span>&nbsp;<span class="op" id="2300255">=</span>&nbsp;<span class="num" id="2300257">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300261">if</span>&nbsp;<span class="ident" id="2300264">r</span>&nbsp;<span class="op" id="2300266">&gt;=</span>&nbsp;<span class="ident" id="2300269">utf8</span><span class="op" id="2300273">.</span><span class="ident" id="2300274">RuneSelf</span>&nbsp;<span class="op" id="2300283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300288">r</span><span class="op" id="2300289">,</span>&nbsp;<span class="ident" id="2300291">width</span>&nbsp;<span class="op" id="2300297">=</span>&nbsp;<span class="ident" id="2300299">utf8</span><span class="op" id="2300303">.</span><span class="ident" id="2300304">DecodeRuneInString</span><span class="op" id="2300322">(</span><span class="ident" id="2300323">s</span><span class="op" id="2300324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300328">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300332">if</span>&nbsp;<span class="ident" id="2300335">width</span>&nbsp;<span class="op" id="2300341">==</span>&nbsp;<span class="num" id="2300344">1</span>&nbsp;<span class="op" id="2300346">&amp;&amp;</span>&nbsp;<span class="ident" id="2300349">r</span>&nbsp;<span class="op" id="2300351">==</span>&nbsp;<span class="ident" id="2300354">utf8</span><span class="op" id="2300358">.</span><span class="ident" id="2300359">RuneError</span>&nbsp;<span class="op" id="2300369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300374">buf</span>&nbsp;<span class="op" id="2300378">=</span>&nbsp;<span class="builtinfunc" id="2300380">append</span><span class="op" id="2300386">(</span><span class="ident" id="2300387">buf</span><span class="op" id="2300390">,</span>&nbsp;<span class="string" id="2300392">`\x`</span><span class="op" id="2300396">...</span><span class="op" id="2300399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300404">buf</span>&nbsp;<span class="op" id="2300408">=</span>&nbsp;<span class="builtinfunc" id="2300410">append</span><span class="op" id="2300416">(</span><span class="ident" id="2300417">buf</span><span class="op" id="2300420">,</span>&nbsp;<span class="ident" id="2300422">lowerhex</span><span class="op" id="2300430">[</span><span class="ident" id="2300431">s</span><span class="op" id="2300432">[</span><span class="num" id="2300433">0</span><span class="op" id="2300434">]</span><span class="op" id="2300435">&gt;&gt;</span><span class="num" id="2300437">4</span><span class="op" id="2300438">]</span><span class="op" id="2300439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300444">buf</span>&nbsp;<span class="op" id="2300448">=</span>&nbsp;<span class="builtinfunc" id="2300450">append</span><span class="op" id="2300456">(</span><span class="ident" id="2300457">buf</span><span class="op" id="2300460">,</span>&nbsp;<span class="ident" id="2300462">lowerhex</span><span class="op" id="2300470">[</span><span class="ident" id="2300471">s</span><span class="op" id="2300472">[</span><span class="num" id="2300473">0</span><span class="op" id="2300474">]</span><span class="op" id="2300475">&amp;</span><span class="num" id="2300476">0xF</span><span class="op" id="2300479">]</span><span class="op" id="2300480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300485">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300500">if</span>&nbsp;<span class="ident" id="2300503">r</span>&nbsp;<span class="op" id="2300505">==</span>&nbsp;<span class="builtintype" id="2300508">rune</span><span class="op" id="2300512">(</span><span class="ident" id="2300513">quote</span><span class="op" id="2300518">)</span>&nbsp;<span class="op" id="2300520">||</span>&nbsp;<span class="ident" id="2300523">r</span>&nbsp;<span class="op" id="2300525">==</span>&nbsp;<span class="string" id="2300528">&#39;\\&#39;</span>&nbsp;<span class="op" id="2300533">{</span>&nbsp;<span class="comment" id="2300535">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300560">buf</span>&nbsp;<span class="op" id="2300564">=</span>&nbsp;<span class="builtinfunc" id="2300566">append</span><span class="op" id="2300572">(</span><span class="ident" id="2300573">buf</span><span class="op" id="2300576">,</span>&nbsp;<span class="string" id="2300578">&#39;\\&#39;</span><span class="op" id="2300582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300587">buf</span>&nbsp;<span class="op" id="2300591">=</span>&nbsp;<span class="builtinfunc" id="2300593">append</span><span class="op" id="2300599">(</span><span class="ident" id="2300600">buf</span><span class="op" id="2300603">,</span>&nbsp;<span class="builtintype" id="2300605">byte</span><span class="op" id="2300609">(</span><span class="ident" id="2300610">r</span><span class="op" id="2300611">)</span><span class="op" id="2300612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300617">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300632">if</span>&nbsp;<span class="ident" id="2300635">ASCIIonly</span>&nbsp;<span class="op" id="2300645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300650">if</span>&nbsp;<span class="ident" id="2300653">r</span>&nbsp;<span class="op" id="2300655">&lt;</span>&nbsp;<span class="ident" id="2300657">utf8</span><span class="op" id="2300661">.</span><span class="ident" id="2300662">RuneSelf</span>&nbsp;<span class="op" id="2300671">&amp;&amp;</span>&nbsp;<span class="ident" id="2300674">IsPrint</span><span class="op" id="2300681">(</span><span class="ident" id="2300682">r</span><span class="op" id="2300683">)</span>&nbsp;<span class="op" id="2300685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300691">buf</span>&nbsp;<span class="op" id="2300695">=</span>&nbsp;<span class="builtinfunc" id="2300697">append</span><span class="op" id="2300703">(</span><span class="ident" id="2300704">buf</span><span class="op" id="2300707">,</span>&nbsp;<span class="builtintype" id="2300709">byte</span><span class="op" id="2300713">(</span><span class="ident" id="2300714">r</span><span class="op" id="2300715">)</span><span class="op" id="2300716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300722">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300738">}</span>&nbsp;<span class="keyword" id="2300740">else</span>&nbsp;<span class="keyword" id="2300745">if</span>&nbsp;<span class="ident" id="2300748">IsPrint</span><span class="op" id="2300755">(</span><span class="ident" id="2300756">r</span><span class="op" id="2300757">)</span>&nbsp;<span class="op" id="2300759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300764">n</span>&nbsp;<span class="op" id="2300766">:=</span>&nbsp;<span class="ident" id="2300769">utf8</span><span class="op" id="2300773">.</span><span class="ident" id="2300774">EncodeRune</span><span class="op" id="2300784">(</span><span class="ident" id="2300785">runeTmp</span><span class="op" id="2300792">[</span><span class="op" id="2300793">:</span><span class="op" id="2300794">]</span><span class="op" id="2300795">,</span>&nbsp;<span class="ident" id="2300797">r</span><span class="op" id="2300798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300803">buf</span>&nbsp;<span class="op" id="2300807">=</span>&nbsp;<span class="builtinfunc" id="2300809">append</span><span class="op" id="2300815">(</span><span class="ident" id="2300816">buf</span><span class="op" id="2300819">,</span>&nbsp;<span class="ident" id="2300821">runeTmp</span><span class="op" id="2300828">[</span><span class="op" id="2300829">:</span><span class="ident" id="2300830">n</span><span class="op" id="2300831">]</span><span class="op" id="2300832">...</span><span class="op" id="2300835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300840">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300855">switch</span>&nbsp;<span class="ident" id="2300862">r</span>&nbsp;<span class="op" id="2300864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300868">case</span>&nbsp;<span class="string" id="2300873">&#39;\a&#39;</span><span class="op" id="2300877">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300882">buf</span>&nbsp;<span class="op" id="2300886">=</span>&nbsp;<span class="builtinfunc" id="2300888">append</span><span class="op" id="2300894">(</span><span class="ident" id="2300895">buf</span><span class="op" id="2300898">,</span>&nbsp;<span class="string" id="2300900">`\a`</span><span class="op" id="2300904">...</span><span class="op" id="2300907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300911">case</span>&nbsp;<span class="string" id="2300916">&#39;\b&#39;</span><span class="op" id="2300920">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300925">buf</span>&nbsp;<span class="op" id="2300929">=</span>&nbsp;<span class="builtinfunc" id="2300931">append</span><span class="op" id="2300937">(</span><span class="ident" id="2300938">buf</span><span class="op" id="2300941">,</span>&nbsp;<span class="string" id="2300943">`\b`</span><span class="op" id="2300947">...</span><span class="op" id="2300950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300954">case</span>&nbsp;<span class="string" id="2300959">&#39;\f&#39;</span><span class="op" id="2300963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300968">buf</span>&nbsp;<span class="op" id="2300972">=</span>&nbsp;<span class="builtinfunc" id="2300974">append</span><span class="op" id="2300980">(</span><span class="ident" id="2300981">buf</span><span class="op" id="2300984">,</span>&nbsp;<span class="string" id="2300986">`\f`</span><span class="op" id="2300990">...</span><span class="op" id="2300993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300997">case</span>&nbsp;<span class="string" id="2301002">&#39;\n&#39;</span><span class="op" id="2301006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301011">buf</span>&nbsp;<span class="op" id="2301015">=</span>&nbsp;<span class="builtinfunc" id="2301017">append</span><span class="op" id="2301023">(</span><span class="ident" id="2301024">buf</span><span class="op" id="2301027">,</span>&nbsp;<span class="string" id="2301029">`\n`</span><span class="op" id="2301033">...</span><span class="op" id="2301036">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301040">case</span>&nbsp;<span class="string" id="2301045">&#39;\r&#39;</span><span class="op" id="2301049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301054">buf</span>&nbsp;<span class="op" id="2301058">=</span>&nbsp;<span class="builtinfunc" id="2301060">append</span><span class="op" id="2301066">(</span><span class="ident" id="2301067">buf</span><span class="op" id="2301070">,</span>&nbsp;<span class="string" id="2301072">`\r`</span><span class="op" id="2301076">...</span><span class="op" id="2301079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301083">case</span>&nbsp;<span class="string" id="2301088">&#39;\t&#39;</span><span class="op" id="2301092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301097">buf</span>&nbsp;<span class="op" id="2301101">=</span>&nbsp;<span class="builtinfunc" id="2301103">append</span><span class="op" id="2301109">(</span><span class="ident" id="2301110">buf</span><span class="op" id="2301113">,</span>&nbsp;<span class="string" id="2301115">`\t`</span><span class="op" id="2301119">...</span><span class="op" id="2301122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301126">case</span>&nbsp;<span class="string" id="2301131">&#39;\v&#39;</span><span class="op" id="2301135">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301140">buf</span>&nbsp;<span class="op" id="2301144">=</span>&nbsp;<span class="builtinfunc" id="2301146">append</span><span class="op" id="2301152">(</span><span class="ident" id="2301153">buf</span><span class="op" id="2301156">,</span>&nbsp;<span class="string" id="2301158">`\v`</span><span class="op" id="2301162">...</span><span class="op" id="2301165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301169">default</span><span class="op" id="2301176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301181">switch</span>&nbsp;<span class="op" id="2301188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301193">case</span>&nbsp;<span class="ident" id="2301198">r</span>&nbsp;<span class="op" id="2301200">&lt;</span>&nbsp;<span class="string" id="2301202">&#39;&nbsp;&#39;</span><span class="op" id="2301205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301211">buf</span>&nbsp;<span class="op" id="2301215">=</span>&nbsp;<span class="builtinfunc" id="2301217">append</span><span class="op" id="2301223">(</span><span class="ident" id="2301224">buf</span><span class="op" id="2301227">,</span>&nbsp;<span class="string" id="2301229">`\x`</span><span class="op" id="2301233">...</span><span class="op" id="2301236">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301242">buf</span>&nbsp;<span class="op" id="2301246">=</span>&nbsp;<span class="builtinfunc" id="2301248">append</span><span class="op" id="2301254">(</span><span class="ident" id="2301255">buf</span><span class="op" id="2301258">,</span>&nbsp;<span class="ident" id="2301260">lowerhex</span><span class="op" id="2301268">[</span><span class="ident" id="2301269">s</span><span class="op" id="2301270">[</span><span class="num" id="2301271">0</span><span class="op" id="2301272">]</span><span class="op" id="2301273">&gt;&gt;</span><span class="num" id="2301275">4</span><span class="op" id="2301276">]</span><span class="op" id="2301277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301283">buf</span>&nbsp;<span class="op" id="2301287">=</span>&nbsp;<span class="builtinfunc" id="2301289">append</span><span class="op" id="2301295">(</span><span class="ident" id="2301296">buf</span><span class="op" id="2301299">,</span>&nbsp;<span class="ident" id="2301301">lowerhex</span><span class="op" id="2301309">[</span><span class="ident" id="2301310">s</span><span class="op" id="2301311">[</span><span class="num" id="2301312">0</span><span class="op" id="2301313">]</span><span class="op" id="2301314">&amp;</span><span class="num" id="2301315">0xF</span><span class="op" id="2301318">]</span><span class="op" id="2301319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301324">case</span>&nbsp;<span class="ident" id="2301329">r</span>&nbsp;<span class="op" id="2301331">&gt;</span>&nbsp;<span class="ident" id="2301333">utf8</span><span class="op" id="2301337">.</span><span class="ident" id="2301338">MaxRune</span><span class="op" id="2301345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301351">r</span>&nbsp;<span class="op" id="2301353">=</span>&nbsp;<span class="num" id="2301355">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301366">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301381">case</span>&nbsp;<span class="ident" id="2301386">r</span>&nbsp;<span class="op" id="2301388">&lt;</span>&nbsp;<span class="num" id="2301390">0x10000</span><span class="op" id="2301397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301403">buf</span>&nbsp;<span class="op" id="2301407">=</span>&nbsp;<span class="builtinfunc" id="2301409">append</span><span class="op" id="2301415">(</span><span class="ident" id="2301416">buf</span><span class="op" id="2301419">,</span>&nbsp;<span class="string" id="2301421">`\u`</span><span class="op" id="2301425">...</span><span class="op" id="2301428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301434">for</span>&nbsp;<span class="ident" id="2301438">s</span>&nbsp;<span class="op" id="2301440">:=</span>&nbsp;<span class="num" id="2301443">12</span><span class="op" id="2301445">;</span>&nbsp;<span class="ident" id="2301447">s</span>&nbsp;<span class="op" id="2301449">&gt;=</span>&nbsp;<span class="num" id="2301452">0</span><span class="op" id="2301453">;</span>&nbsp;<span class="ident" id="2301455">s</span>&nbsp;<span class="op" id="2301457">-=</span>&nbsp;<span class="num" id="2301460">4</span>&nbsp;<span class="op" id="2301462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301469">buf</span>&nbsp;<span class="op" id="2301473">=</span>&nbsp;<span class="builtinfunc" id="2301475">append</span><span class="op" id="2301481">(</span><span class="ident" id="2301482">buf</span><span class="op" id="2301485">,</span>&nbsp;<span class="ident" id="2301487">lowerhex</span><span class="op" id="2301495">[</span><span class="ident" id="2301496">r</span><span class="op" id="2301497">&gt;&gt;</span><span class="builtintype" id="2301499">uint</span><span class="op" id="2301503">(</span><span class="ident" id="2301504">s</span><span class="op" id="2301505">)</span><span class="op" id="2301506">&amp;</span><span class="num" id="2301507">0xF</span><span class="op" id="2301510">]</span><span class="op" id="2301511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301517">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301522">default</span><span class="op" id="2301529">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301535">buf</span>&nbsp;<span class="op" id="2301539">=</span>&nbsp;<span class="builtinfunc" id="2301541">append</span><span class="op" id="2301547">(</span><span class="ident" id="2301548">buf</span><span class="op" id="2301551">,</span>&nbsp;<span class="string" id="2301553">`\U`</span><span class="op" id="2301557">...</span><span class="op" id="2301560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301566">for</span>&nbsp;<span class="ident" id="2301570">s</span>&nbsp;<span class="op" id="2301572">:=</span>&nbsp;<span class="num" id="2301575">28</span><span class="op" id="2301577">;</span>&nbsp;<span class="ident" id="2301579">s</span>&nbsp;<span class="op" id="2301581">&gt;=</span>&nbsp;<span class="num" id="2301584">0</span><span class="op" id="2301585">;</span>&nbsp;<span class="ident" id="2301587">s</span>&nbsp;<span class="op" id="2301589">-=</span>&nbsp;<span class="num" id="2301592">4</span>&nbsp;<span class="op" id="2301594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301601">buf</span>&nbsp;<span class="op" id="2301605">=</span>&nbsp;<span class="builtinfunc" id="2301607">append</span><span class="op" id="2301613">(</span><span class="ident" id="2301614">buf</span><span class="op" id="2301617">,</span>&nbsp;<span class="ident" id="2301619">lowerhex</span><span class="op" id="2301627">[</span><span class="ident" id="2301628">r</span><span class="op" id="2301629">&gt;&gt;</span><span class="builtintype" id="2301631">uint</span><span class="op" id="2301635">(</span><span class="ident" id="2301636">s</span><span class="op" id="2301637">)</span><span class="op" id="2301638">&amp;</span><span class="num" id="2301639">0xF</span><span class="op" id="2301642">]</span><span class="op" id="2301643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301649">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301664">buf</span>&nbsp;<span class="op" id="2301668">=</span>&nbsp;<span class="builtinfunc" id="2301670">append</span><span class="op" id="2301676">(</span><span class="ident" id="2301677">buf</span><span class="op" id="2301680">,</span>&nbsp;<span class="ident" id="2301682">quote</span><span class="op" id="2301687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301690">return</span>&nbsp;<span class="builtintype" id="2301697">string</span><span class="op" id="2301703">(</span><span class="ident" id="2301704">buf</span><span class="op" id="2301707">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="2301710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2301713">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="2301785">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="2301856">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2301921">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2301933">func</span>&nbsp;<span class="ident" id="2301938">Quote</span><span class="op" id="2301943">(</span><span class="ident" id="2301944">s</span>&nbsp;<span class="builtintype" id="2301946">string</span><span class="op" id="2301952">)</span>&nbsp;<span class="builtintype" id="2301954">string</span>&nbsp;<span class="op" id="2301961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301964">return</span>&nbsp;<span class="ident" id="2301971">quoteWith</span><span class="op" id="2301980">(</span><span class="ident" id="2301981">s</span><span class="op" id="2301982">,</span>&nbsp;<span class="string" id="2301984">&#39;&#34;&#39;</span><span class="op" id="2301987">,</span>&nbsp;<span class="builtintype" id="2301989">false</span><span class="op" id="2301994">)</span><br>
<span class="lineno"></span><span class="op" id="2301996">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="2301999">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="2302072">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2302138">func</span>&nbsp;<span class="ident" id="2302143">AppendQuote</span><span class="op" id="2302154">(</span><span class="ident" id="2302155">dst</span>&nbsp;<span class="op" id="2302159">[</span><span class="op" id="2302160">]</span><span class="builtintype" id="2302161">byte</span><span class="op" id="2302165">,</span>&nbsp;<span class="ident" id="2302167">s</span>&nbsp;<span class="builtintype" id="2302169">string</span><span class="op" id="2302175">)</span>&nbsp;<span class="op" id="2302177">[</span><span class="op" id="2302178">]</span><span class="builtintype" id="2302179">byte</span>&nbsp;<span class="op" id="2302184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302187">return</span>&nbsp;<span class="builtinfunc" id="2302194">append</span><span class="op" id="2302200">(</span><span class="ident" id="2302201">dst</span><span class="op" id="2302204">,</span>&nbsp;<span class="ident" id="2302206">Quote</span><span class="op" id="2302211">(</span><span class="ident" id="2302212">s</span><span class="op" id="2302213">)</span><span class="op" id="2302214">...</span><span class="op" id="2302217">)</span><br>
<span class="lineno">100</span><span class="op" id="2302219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2302222">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2302296">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2302371">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="2302447">func</span>&nbsp;<span class="ident" id="2302452">QuoteToASCII</span><span class="op" id="2302464">(</span><span class="ident" id="2302465">s</span>&nbsp;<span class="builtintype" id="2302467">string</span><span class="op" id="2302473">)</span>&nbsp;<span class="builtintype" id="2302475">string</span>&nbsp;<span class="op" id="2302482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302485">return</span>&nbsp;<span class="ident" id="2302492">quoteWith</span><span class="op" id="2302501">(</span><span class="ident" id="2302502">s</span><span class="op" id="2302503">,</span>&nbsp;<span class="string" id="2302505">&#39;&#34;&#39;</span><span class="op" id="2302508">,</span>&nbsp;<span class="builtintype" id="2302510">true</span><span class="op" id="2302514">)</span><br>
<span class="lineno"></span><span class="op" id="2302516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2302519">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="2302599">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="2302672">func</span>&nbsp;<span class="ident" id="2302677">AppendQuoteToASCII</span><span class="op" id="2302695">(</span><span class="ident" id="2302696">dst</span>&nbsp;<span class="op" id="2302700">[</span><span class="op" id="2302701">]</span><span class="builtintype" id="2302702">byte</span><span class="op" id="2302706">,</span>&nbsp;<span class="ident" id="2302708">s</span>&nbsp;<span class="builtintype" id="2302710">string</span><span class="op" id="2302716">)</span>&nbsp;<span class="op" id="2302718">[</span><span class="op" id="2302719">]</span><span class="builtintype" id="2302720">byte</span>&nbsp;<span class="op" id="2302725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302728">return</span>&nbsp;<span class="builtinfunc" id="2302735">append</span><span class="op" id="2302741">(</span><span class="ident" id="2302742">dst</span><span class="op" id="2302745">,</span>&nbsp;<span class="ident" id="2302747">QuoteToASCII</span><span class="op" id="2302759">(</span><span class="ident" id="2302760">s</span><span class="op" id="2302761">)</span><span class="op" id="2302762">...</span><span class="op" id="2302765">)</span><br>
<span class="lineno"></span><span class="op" id="2302767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="2302770">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2302845">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="2302923">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2303001">func</span>&nbsp;<span class="ident" id="2303006">QuoteRune</span><span class="op" id="2303015">(</span><span class="ident" id="2303016">r</span>&nbsp;<span class="builtintype" id="2303018">rune</span><span class="op" id="2303022">)</span>&nbsp;<span class="builtintype" id="2303024">string</span>&nbsp;<span class="op" id="2303031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303034">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303071">return</span>&nbsp;<span class="ident" id="2303078">quoteWith</span><span class="op" id="2303087">(</span><span class="builtintype" id="2303088">string</span><span class="op" id="2303094">(</span><span class="ident" id="2303095">r</span><span class="op" id="2303096">)</span><span class="op" id="2303097">,</span>&nbsp;<span class="string" id="2303099">&#39;\&#39;&#39;</span><span class="op" id="2303103">,</span>&nbsp;<span class="builtintype" id="2303105">false</span><span class="op" id="2303110">)</span><br>
<span class="lineno"></span><span class="op" id="2303112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303115">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2303202">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="2303272">func</span>&nbsp;<span class="ident" id="2303277">AppendQuoteRune</span><span class="op" id="2303292">(</span><span class="ident" id="2303293">dst</span>&nbsp;<span class="op" id="2303297">[</span><span class="op" id="2303298">]</span><span class="builtintype" id="2303299">byte</span><span class="op" id="2303303">,</span>&nbsp;<span class="ident" id="2303305">r</span>&nbsp;<span class="builtintype" id="2303307">rune</span><span class="op" id="2303311">)</span>&nbsp;<span class="op" id="2303313">[</span><span class="op" id="2303314">]</span><span class="builtintype" id="2303315">byte</span>&nbsp;<span class="op" id="2303320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303323">return</span>&nbsp;<span class="builtinfunc" id="2303330">append</span><span class="op" id="2303336">(</span><span class="ident" id="2303337">dst</span><span class="op" id="2303340">,</span>&nbsp;<span class="ident" id="2303342">QuoteRune</span><span class="op" id="2303351">(</span><span class="ident" id="2303352">r</span><span class="op" id="2303353">)</span><span class="op" id="2303354">...</span><span class="op" id="2303357">)</span><br>
<span class="lineno"></span><span class="op" id="2303359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303362">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="2303440">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="2303514">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="2303590">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="2303605">func</span>&nbsp;<span class="ident" id="2303610">QuoteRuneToASCII</span><span class="op" id="2303626">(</span><span class="ident" id="2303627">r</span>&nbsp;<span class="builtintype" id="2303629">rune</span><span class="op" id="2303633">)</span>&nbsp;<span class="builtintype" id="2303635">string</span>&nbsp;<span class="op" id="2303642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303645">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303682">return</span>&nbsp;<span class="ident" id="2303689">quoteWith</span><span class="op" id="2303698">(</span><span class="builtintype" id="2303699">string</span><span class="op" id="2303705">(</span><span class="ident" id="2303706">r</span><span class="op" id="2303707">)</span><span class="op" id="2303708">,</span>&nbsp;<span class="string" id="2303710">&#39;\&#39;&#39;</span><span class="op" id="2303714">,</span>&nbsp;<span class="builtintype" id="2303716">true</span><span class="op" id="2303720">)</span><br>
<span class="lineno"></span><span class="op" id="2303722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303725">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="2303819">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="2303896">func</span>&nbsp;<span class="ident" id="2303901">AppendQuoteRuneToASCII</span><span class="op" id="2303923">(</span><span class="ident" id="2303924">dst</span>&nbsp;<span class="op" id="2303928">[</span><span class="op" id="2303929">]</span><span class="builtintype" id="2303930">byte</span><span class="op" id="2303934">,</span>&nbsp;<span class="ident" id="2303936">r</span>&nbsp;<span class="builtintype" id="2303938">rune</span><span class="op" id="2303942">)</span>&nbsp;<span class="op" id="2303944">[</span><span class="op" id="2303945">]</span><span class="builtintype" id="2303946">byte</span>&nbsp;<span class="op" id="2303951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303954">return</span>&nbsp;<span class="builtinfunc" id="2303961">append</span><span class="op" id="2303967">(</span><span class="ident" id="2303968">dst</span><span class="op" id="2303971">,</span>&nbsp;<span class="ident" id="2303973">QuoteRuneToASCII</span><span class="op" id="2303989">(</span><span class="ident" id="2303990">r</span><span class="op" id="2303991">)</span><span class="op" id="2303992">...</span><span class="op" id="2303995">)</span><br>
<span class="lineno"></span><span class="op" id="2303997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2304000">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="2304064">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2304128">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="2304158">func</span>&nbsp;<span class="ident" id="2304163">CanBackquote</span><span class="op" id="2304175">(</span><span class="ident" id="2304176">s</span>&nbsp;<span class="builtintype" id="2304178">string</span><span class="op" id="2304184">)</span>&nbsp;<span class="builtintype" id="2304186">bool</span>&nbsp;<span class="op" id="2304191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304194">for</span>&nbsp;<span class="builtinfunc" id="2304198">len</span><span class="op" id="2304201">(</span><span class="ident" id="2304202">s</span><span class="op" id="2304203">)</span>&nbsp;<span class="op" id="2304205">&gt;</span>&nbsp;<span class="num" id="2304207">0</span>&nbsp;<span class="op" id="2304209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304213">r</span><span class="op" id="2304214">,</span>&nbsp;<span class="ident" id="2304216">wid</span>&nbsp;<span class="op" id="2304220">:=</span>&nbsp;<span class="ident" id="2304223">utf8</span><span class="op" id="2304227">.</span><span class="ident" id="2304228">DecodeRuneInString</span><span class="op" id="2304246">(</span><span class="ident" id="2304247">s</span><span class="op" id="2304248">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304252">s</span>&nbsp;<span class="op" id="2304254">=</span>&nbsp;<span class="ident" id="2304256">s</span><span class="op" id="2304257">[</span><span class="ident" id="2304258">wid</span><span class="op" id="2304261">:</span><span class="op" id="2304262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304266">if</span>&nbsp;<span class="ident" id="2304269">wid</span>&nbsp;<span class="op" id="2304273">&gt;</span>&nbsp;<span class="num" id="2304275">1</span>&nbsp;<span class="op" id="2304277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304282">if</span>&nbsp;<span class="ident" id="2304285">r</span>&nbsp;<span class="op" id="2304287">==</span>&nbsp;<span class="string" id="2304290">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="2304299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304305">return</span>&nbsp;<span class="builtintype" id="2304312">false</span>&nbsp;<span class="comment" id="2304318">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304369">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304374">continue</span>&nbsp;<span class="comment" id="2304383">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304463">if</span>&nbsp;<span class="ident" id="2304466">r</span>&nbsp;<span class="op" id="2304468">==</span>&nbsp;<span class="ident" id="2304471">utf8</span><span class="op" id="2304475">.</span><span class="ident" id="2304476">RuneError</span>&nbsp;<span class="op" id="2304486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304491">return</span>&nbsp;<span class="builtintype" id="2304498">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304506">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304510">if</span>&nbsp;<span class="op" id="2304513">(</span><span class="ident" id="2304514">r</span>&nbsp;<span class="op" id="2304516">&lt;</span>&nbsp;<span class="string" id="2304518">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2304522">&amp;&amp;</span>&nbsp;<span class="ident" id="2304525">r</span>&nbsp;<span class="op" id="2304527">!=</span>&nbsp;<span class="string" id="2304530">&#39;\t&#39;</span><span class="op" id="2304534">)</span>&nbsp;<span class="op" id="2304536">||</span>&nbsp;<span class="ident" id="2304539">r</span>&nbsp;<span class="op" id="2304541">==</span>&nbsp;<span class="string" id="2304544">&#39;`&#39;</span>&nbsp;<span class="op" id="2304548">||</span>&nbsp;<span class="ident" id="2304551">r</span>&nbsp;<span class="op" id="2304553">==</span>&nbsp;<span class="string" id="2304556">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="2304565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304570">return</span>&nbsp;<span class="builtintype" id="2304577">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304591">return</span>&nbsp;<span class="builtintype" id="2304598">true</span><br>
<span class="lineno">165</span><span class="op" id="2304603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2304606">func</span>&nbsp;<span class="ident" id="2304611">unhex</span><span class="op" id="2304616">(</span><span class="ident" id="2304617">b</span>&nbsp;<span class="builtintype" id="2304619">byte</span><span class="op" id="2304623">)</span>&nbsp;<span class="op" id="2304625">(</span><span class="ident" id="2304626">v</span>&nbsp;<span class="builtintype" id="2304628">rune</span><span class="op" id="2304632">,</span>&nbsp;<span class="ident" id="2304634">ok</span>&nbsp;<span class="builtintype" id="2304637">bool</span><span class="op" id="2304641">)</span>&nbsp;<span class="op" id="2304643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304646">c</span>&nbsp;<span class="op" id="2304648">:=</span>&nbsp;<span class="builtintype" id="2304651">rune</span><span class="op" id="2304655">(</span><span class="ident" id="2304656">b</span><span class="op" id="2304657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304660">switch</span>&nbsp;<span class="op" id="2304667">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304670">case</span>&nbsp;<span class="string" id="2304675">&#39;0&#39;</span>&nbsp;<span class="op" id="2304679">&lt;=</span>&nbsp;<span class="ident" id="2304682">c</span>&nbsp;<span class="op" id="2304684">&amp;&amp;</span>&nbsp;<span class="ident" id="2304687">c</span>&nbsp;<span class="op" id="2304689">&lt;=</span>&nbsp;<span class="string" id="2304692">&#39;9&#39;</span><span class="op" id="2304695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304699">return</span>&nbsp;<span class="ident" id="2304706">c</span>&nbsp;<span class="op" id="2304708">-</span>&nbsp;<span class="string" id="2304710">&#39;0&#39;</span><span class="op" id="2304713">,</span>&nbsp;<span class="builtintype" id="2304715">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304721">case</span>&nbsp;<span class="string" id="2304726">&#39;a&#39;</span>&nbsp;<span class="op" id="2304730">&lt;=</span>&nbsp;<span class="ident" id="2304733">c</span>&nbsp;<span class="op" id="2304735">&amp;&amp;</span>&nbsp;<span class="ident" id="2304738">c</span>&nbsp;<span class="op" id="2304740">&lt;=</span>&nbsp;<span class="string" id="2304743">&#39;f&#39;</span><span class="op" id="2304746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304750">return</span>&nbsp;<span class="ident" id="2304757">c</span>&nbsp;<span class="op" id="2304759">-</span>&nbsp;<span class="string" id="2304761">&#39;a&#39;</span>&nbsp;<span class="op" id="2304765">+</span>&nbsp;<span class="num" id="2304767">10</span><span class="op" id="2304769">,</span>&nbsp;<span class="builtintype" id="2304771">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304777">case</span>&nbsp;<span class="string" id="2304782">&#39;A&#39;</span>&nbsp;<span class="op" id="2304786">&lt;=</span>&nbsp;<span class="ident" id="2304789">c</span>&nbsp;<span class="op" id="2304791">&amp;&amp;</span>&nbsp;<span class="ident" id="2304794">c</span>&nbsp;<span class="op" id="2304796">&lt;=</span>&nbsp;<span class="string" id="2304799">&#39;F&#39;</span><span class="op" id="2304802">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304806">return</span>&nbsp;<span class="ident" id="2304813">c</span>&nbsp;<span class="op" id="2304815">-</span>&nbsp;<span class="string" id="2304817">&#39;A&#39;</span>&nbsp;<span class="op" id="2304821">+</span>&nbsp;<span class="num" id="2304823">10</span><span class="op" id="2304825">,</span>&nbsp;<span class="builtintype" id="2304827">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304836">return</span><br>
<span class="lineno"></span><span class="op" id="2304843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2304846">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2304919">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2304972">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="2304999">//</span><br>
<span class="lineno"></span><span class="comment" id="2305002">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="2305061">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="2305172">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2305237">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="2305310">//</span><br>
<span class="lineno"></span><span class="comment" id="2305313">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="2305387">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="2305448">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2305531">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2305601">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="2305707">func</span>&nbsp;<span class="ident" id="2305712">UnquoteChar</span><span class="op" id="2305723">(</span><span class="ident" id="2305724">s</span>&nbsp;<span class="builtintype" id="2305726">string</span><span class="op" id="2305732">,</span>&nbsp;<span class="ident" id="2305734">quote</span>&nbsp;<span class="builtintype" id="2305740">byte</span><span class="op" id="2305744">)</span>&nbsp;<span class="op" id="2305746">(</span><span class="ident" id="2305747">value</span>&nbsp;<span class="builtintype" id="2305753">rune</span><span class="op" id="2305757">,</span>&nbsp;<span class="ident" id="2305759">multibyte</span>&nbsp;<span class="builtintype" id="2305769">bool</span><span class="op" id="2305773">,</span>&nbsp;<span class="ident" id="2305775">tail</span>&nbsp;<span class="builtintype" id="2305780">string</span><span class="op" id="2305786">,</span>&nbsp;<span class="ident" id="2305788">err</span>&nbsp;<span class="builtintype" id="2305792">error</span><span class="op" id="2305797">)</span>&nbsp;<span class="op" id="2305799">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305802">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305817">switch</span>&nbsp;<span class="ident" id="2305824">c</span>&nbsp;<span class="op" id="2305826">:=</span>&nbsp;<span class="ident" id="2305829">s</span><span class="op" id="2305830">[</span><span class="num" id="2305831">0</span><span class="op" id="2305832">]</span><span class="op" id="2305833">;</span>&nbsp;<span class="op" id="2305835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305838">case</span>&nbsp;<span class="ident" id="2305843">c</span>&nbsp;<span class="op" id="2305845">==</span>&nbsp;<span class="ident" id="2305848">quote</span>&nbsp;<span class="op" id="2305854">&amp;&amp;</span>&nbsp;<span class="op" id="2305857">(</span><span class="ident" id="2305858">quote</span>&nbsp;<span class="op" id="2305864">==</span>&nbsp;<span class="string" id="2305867">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2305872">||</span>&nbsp;<span class="ident" id="2305875">quote</span>&nbsp;<span class="op" id="2305881">==</span>&nbsp;<span class="string" id="2305884">&#39;&#34;&#39;</span><span class="op" id="2305887">)</span><span class="op" id="2305888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305892">err</span>&nbsp;<span class="op" id="2305896">=</span>&nbsp;<span class="ident" id="2305898">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305910">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305918">case</span>&nbsp;<span class="ident" id="2305923">c</span>&nbsp;<span class="op" id="2305925">&gt;=</span>&nbsp;<span class="ident" id="2305928">utf8</span><span class="op" id="2305932">.</span><span class="ident" id="2305933">RuneSelf</span><span class="op" id="2305941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305945">r</span><span class="op" id="2305946">,</span>&nbsp;<span class="ident" id="2305948">size</span>&nbsp;<span class="op" id="2305953">:=</span>&nbsp;<span class="ident" id="2305956">utf8</span><span class="op" id="2305960">.</span><span class="ident" id="2305961">DecodeRuneInString</span><span class="op" id="2305979">(</span><span class="ident" id="2305980">s</span><span class="op" id="2305981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305985">return</span>&nbsp;<span class="ident" id="2305992">r</span><span class="op" id="2305993">,</span>&nbsp;<span class="builtintype" id="2305995">true</span><span class="op" id="2305999">,</span>&nbsp;<span class="ident" id="2306001">s</span><span class="op" id="2306002">[</span><span class="ident" id="2306003">size</span><span class="op" id="2306007">:</span><span class="op" id="2306008">]</span><span class="op" id="2306009">,</span>&nbsp;<span class="ident" id="2306011">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306016">case</span>&nbsp;<span class="ident" id="2306021">c</span>&nbsp;<span class="op" id="2306023">!=</span>&nbsp;<span class="string" id="2306026">&#39;\\&#39;</span><span class="op" id="2306030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306034">return</span>&nbsp;<span class="builtintype" id="2306041">rune</span><span class="op" id="2306045">(</span><span class="ident" id="2306046">s</span><span class="op" id="2306047">[</span><span class="num" id="2306048">0</span><span class="op" id="2306049">]</span><span class="op" id="2306050">)</span><span class="op" id="2306051">,</span>&nbsp;<span class="builtintype" id="2306053">false</span><span class="op" id="2306058">,</span>&nbsp;<span class="ident" id="2306060">s</span><span class="op" id="2306061">[</span><span class="num" id="2306062">1</span><span class="op" id="2306063">:</span><span class="op" id="2306064">]</span><span class="op" id="2306065">,</span>&nbsp;<span class="ident" id="2306067">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2306076">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306106">if</span>&nbsp;<span class="builtinfunc" id="2306109">len</span><span class="op" id="2306112">(</span><span class="ident" id="2306113">s</span><span class="op" id="2306114">)</span>&nbsp;<span class="op" id="2306116">&lt;=</span>&nbsp;<span class="num" id="2306119">1</span>&nbsp;<span class="op" id="2306121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306125">err</span>&nbsp;<span class="op" id="2306129">=</span>&nbsp;<span class="ident" id="2306131">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306143">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306154">c</span>&nbsp;<span class="op" id="2306156">:=</span>&nbsp;<span class="ident" id="2306159">s</span><span class="op" id="2306160">[</span><span class="num" id="2306161">1</span><span class="op" id="2306162">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306165">s</span>&nbsp;<span class="op" id="2306167">=</span>&nbsp;<span class="ident" id="2306169">s</span><span class="op" id="2306170">[</span><span class="num" id="2306171">2</span><span class="op" id="2306172">:</span><span class="op" id="2306173">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306177">switch</span>&nbsp;<span class="ident" id="2306184">c</span>&nbsp;<span class="op" id="2306186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306189">case</span>&nbsp;<span class="string" id="2306194">&#39;a&#39;</span><span class="op" id="2306197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306201">value</span>&nbsp;<span class="op" id="2306207">=</span>&nbsp;<span class="string" id="2306209">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306215">case</span>&nbsp;<span class="string" id="2306220">&#39;b&#39;</span><span class="op" id="2306223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306227">value</span>&nbsp;<span class="op" id="2306233">=</span>&nbsp;<span class="string" id="2306235">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306241">case</span>&nbsp;<span class="string" id="2306246">&#39;f&#39;</span><span class="op" id="2306249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306253">value</span>&nbsp;<span class="op" id="2306259">=</span>&nbsp;<span class="string" id="2306261">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306267">case</span>&nbsp;<span class="string" id="2306272">&#39;n&#39;</span><span class="op" id="2306275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306279">value</span>&nbsp;<span class="op" id="2306285">=</span>&nbsp;<span class="string" id="2306287">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306293">case</span>&nbsp;<span class="string" id="2306298">&#39;r&#39;</span><span class="op" id="2306301">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306305">value</span>&nbsp;<span class="op" id="2306311">=</span>&nbsp;<span class="string" id="2306313">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306319">case</span>&nbsp;<span class="string" id="2306324">&#39;t&#39;</span><span class="op" id="2306327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306331">value</span>&nbsp;<span class="op" id="2306337">=</span>&nbsp;<span class="string" id="2306339">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306345">case</span>&nbsp;<span class="string" id="2306350">&#39;v&#39;</span><span class="op" id="2306353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306357">value</span>&nbsp;<span class="op" id="2306363">=</span>&nbsp;<span class="string" id="2306365">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306371">case</span>&nbsp;<span class="string" id="2306376">&#39;x&#39;</span><span class="op" id="2306379">,</span>&nbsp;<span class="string" id="2306381">&#39;u&#39;</span><span class="op" id="2306384">,</span>&nbsp;<span class="string" id="2306386">&#39;U&#39;</span><span class="op" id="2306389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306393">n</span>&nbsp;<span class="op" id="2306395">:=</span>&nbsp;<span class="num" id="2306398">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306402">switch</span>&nbsp;<span class="ident" id="2306409">c</span>&nbsp;<span class="op" id="2306411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306415">case</span>&nbsp;<span class="string" id="2306420">&#39;x&#39;</span><span class="op" id="2306423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306428">n</span>&nbsp;<span class="op" id="2306430">=</span>&nbsp;<span class="num" id="2306432">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306436">case</span>&nbsp;<span class="string" id="2306441">&#39;u&#39;</span><span class="op" id="2306444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306449">n</span>&nbsp;<span class="op" id="2306451">=</span>&nbsp;<span class="num" id="2306453">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306457">case</span>&nbsp;<span class="string" id="2306462">&#39;U&#39;</span><span class="op" id="2306465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306470">n</span>&nbsp;<span class="op" id="2306472">=</span>&nbsp;<span class="num" id="2306474">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306478">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306482">var</span>&nbsp;<span class="ident" id="2306486">v</span>&nbsp;<span class="builtintype" id="2306488">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306495">if</span>&nbsp;<span class="builtinfunc" id="2306498">len</span><span class="op" id="2306501">(</span><span class="ident" id="2306502">s</span><span class="op" id="2306503">)</span>&nbsp;<span class="op" id="2306505">&lt;</span>&nbsp;<span class="ident" id="2306507">n</span>&nbsp;<span class="op" id="2306509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306514">err</span>&nbsp;<span class="op" id="2306518">=</span>&nbsp;<span class="ident" id="2306520">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306542">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306546">for</span>&nbsp;<span class="ident" id="2306550">j</span>&nbsp;<span class="op" id="2306552">:=</span>&nbsp;<span class="num" id="2306555">0</span><span class="op" id="2306556">;</span>&nbsp;<span class="ident" id="2306558">j</span>&nbsp;<span class="op" id="2306560">&lt;</span>&nbsp;<span class="ident" id="2306562">n</span><span class="op" id="2306563">;</span>&nbsp;<span class="ident" id="2306565">j</span><span class="op" id="2306566">++</span>&nbsp;<span class="op" id="2306569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306574">x</span><span class="op" id="2306575">,</span>&nbsp;<span class="ident" id="2306577">ok</span>&nbsp;<span class="op" id="2306580">:=</span>&nbsp;<span class="ident" id="2306583">unhex</span><span class="op" id="2306588">(</span><span class="ident" id="2306589">s</span><span class="op" id="2306590">[</span><span class="ident" id="2306591">j</span><span class="op" id="2306592">]</span><span class="op" id="2306593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306598">if</span>&nbsp;<span class="op" id="2306601">!</span><span class="ident" id="2306602">ok</span>&nbsp;<span class="op" id="2306605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306611">err</span>&nbsp;<span class="op" id="2306615">=</span>&nbsp;<span class="ident" id="2306617">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306631">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306646">v</span>&nbsp;<span class="op" id="2306648">=</span>&nbsp;<span class="ident" id="2306650">v</span><span class="op" id="2306651">&lt;&lt;</span><span class="num" id="2306653">4</span>&nbsp;<span class="op" id="2306655">|</span>&nbsp;<span class="ident" id="2306657">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306665">s</span>&nbsp;<span class="op" id="2306667">=</span>&nbsp;<span class="ident" id="2306669">s</span><span class="op" id="2306670">[</span><span class="ident" id="2306671">n</span><span class="op" id="2306672">:</span><span class="op" id="2306673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306677">if</span>&nbsp;<span class="ident" id="2306680">c</span>&nbsp;<span class="op" id="2306682">==</span>&nbsp;<span class="string" id="2306685">&#39;x&#39;</span>&nbsp;<span class="op" id="2306689">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2306694">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306739">value</span>&nbsp;<span class="op" id="2306745">=</span>&nbsp;<span class="ident" id="2306747">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306752">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306764">if</span>&nbsp;<span class="ident" id="2306767">v</span>&nbsp;<span class="op" id="2306769">&gt;</span>&nbsp;<span class="ident" id="2306771">utf8</span><span class="op" id="2306775">.</span><span class="ident" id="2306776">MaxRune</span>&nbsp;<span class="op" id="2306784">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306789">err</span>&nbsp;<span class="op" id="2306793">=</span>&nbsp;<span class="ident" id="2306795">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306808">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306821">value</span>&nbsp;<span class="op" id="2306827">=</span>&nbsp;<span class="ident" id="2306829">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306833">multibyte</span>&nbsp;<span class="op" id="2306843">=</span>&nbsp;<span class="builtintype" id="2306845">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306851">case</span>&nbsp;<span class="string" id="2306856">&#39;0&#39;</span><span class="op" id="2306859">,</span>&nbsp;<span class="string" id="2306861">&#39;1&#39;</span><span class="op" id="2306864">,</span>&nbsp;<span class="string" id="2306866">&#39;2&#39;</span><span class="op" id="2306869">,</span>&nbsp;<span class="string" id="2306871">&#39;3&#39;</span><span class="op" id="2306874">,</span>&nbsp;<span class="string" id="2306876">&#39;4&#39;</span><span class="op" id="2306879">,</span>&nbsp;<span class="string" id="2306881">&#39;5&#39;</span><span class="op" id="2306884">,</span>&nbsp;<span class="string" id="2306886">&#39;6&#39;</span><span class="op" id="2306889">,</span>&nbsp;<span class="string" id="2306891">&#39;7&#39;</span><span class="op" id="2306894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306898">v</span>&nbsp;<span class="op" id="2306900">:=</span>&nbsp;<span class="builtintype" id="2306903">rune</span><span class="op" id="2306907">(</span><span class="ident" id="2306908">c</span><span class="op" id="2306909">)</span>&nbsp;<span class="op" id="2306911">-</span>&nbsp;<span class="string" id="2306913">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306919">if</span>&nbsp;<span class="builtinfunc" id="2306922">len</span><span class="op" id="2306925">(</span><span class="ident" id="2306926">s</span><span class="op" id="2306927">)</span>&nbsp;<span class="op" id="2306929">&lt;</span>&nbsp;<span class="num" id="2306931">2</span>&nbsp;<span class="op" id="2306933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306938">err</span>&nbsp;<span class="op" id="2306942">=</span>&nbsp;<span class="ident" id="2306944">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306957">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306970">for</span>&nbsp;<span class="ident" id="2306974">j</span>&nbsp;<span class="op" id="2306976">:=</span>&nbsp;<span class="num" id="2306979">0</span><span class="op" id="2306980">;</span>&nbsp;<span class="ident" id="2306982">j</span>&nbsp;<span class="op" id="2306984">&lt;</span>&nbsp;<span class="num" id="2306986">2</span><span class="op" id="2306987">;</span>&nbsp;<span class="ident" id="2306989">j</span><span class="op" id="2306990">++</span>&nbsp;<span class="op" id="2306993">{</span>&nbsp;<span class="comment" id="2306995">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307029">x</span>&nbsp;<span class="op" id="2307031">:=</span>&nbsp;<span class="builtintype" id="2307034">rune</span><span class="op" id="2307038">(</span><span class="ident" id="2307039">s</span><span class="op" id="2307040">[</span><span class="ident" id="2307041">j</span><span class="op" id="2307042">]</span><span class="op" id="2307043">)</span>&nbsp;<span class="op" id="2307045">-</span>&nbsp;<span class="string" id="2307047">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307054">if</span>&nbsp;<span class="ident" id="2307057">x</span>&nbsp;<span class="op" id="2307059">&lt;</span>&nbsp;<span class="num" id="2307061">0</span>&nbsp;<span class="op" id="2307063">||</span>&nbsp;<span class="ident" id="2307066">x</span>&nbsp;<span class="op" id="2307068">&gt;</span>&nbsp;<span class="num" id="2307070">7</span>&nbsp;<span class="op" id="2307072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307078">err</span>&nbsp;<span class="op" id="2307082">=</span>&nbsp;<span class="ident" id="2307084">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307113">v</span>&nbsp;<span class="op" id="2307115">=</span>&nbsp;<span class="op" id="2307117">(</span><span class="ident" id="2307118">v</span>&nbsp;<span class="op" id="2307120">&lt;&lt;</span>&nbsp;<span class="num" id="2307123">3</span><span class="op" id="2307124">)</span>&nbsp;<span class="op" id="2307126">|</span>&nbsp;<span class="ident" id="2307128">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307136">s</span>&nbsp;<span class="op" id="2307138">=</span>&nbsp;<span class="ident" id="2307140">s</span><span class="op" id="2307141">[</span><span class="num" id="2307142">2</span><span class="op" id="2307143">:</span><span class="op" id="2307144">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307148">if</span>&nbsp;<span class="ident" id="2307151">v</span>&nbsp;<span class="op" id="2307153">&gt;</span>&nbsp;<span class="num" id="2307155">255</span>&nbsp;<span class="op" id="2307159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307164">err</span>&nbsp;<span class="op" id="2307168">=</span>&nbsp;<span class="ident" id="2307170">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307183">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307196">value</span>&nbsp;<span class="op" id="2307202">=</span>&nbsp;<span class="ident" id="2307204">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307207">case</span>&nbsp;<span class="string" id="2307212">&#39;\\&#39;</span><span class="op" id="2307216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307220">value</span>&nbsp;<span class="op" id="2307226">=</span>&nbsp;<span class="string" id="2307228">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307234">case</span>&nbsp;<span class="string" id="2307239">&#39;\&#39;&#39;</span><span class="op" id="2307243">,</span>&nbsp;<span class="string" id="2307245">&#39;&#34;&#39;</span><span class="op" id="2307248">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307252">if</span>&nbsp;<span class="ident" id="2307255">c</span>&nbsp;<span class="op" id="2307257">!=</span>&nbsp;<span class="ident" id="2307260">quote</span>&nbsp;<span class="op" id="2307266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307271">err</span>&nbsp;<span class="op" id="2307275">=</span>&nbsp;<span class="ident" id="2307277">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307290">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307303">value</span>&nbsp;<span class="op" id="2307309">=</span>&nbsp;<span class="builtintype" id="2307311">rune</span><span class="op" id="2307315">(</span><span class="ident" id="2307316">c</span><span class="op" id="2307317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307320">default</span><span class="op" id="2307327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307331">err</span>&nbsp;<span class="op" id="2307335">=</span>&nbsp;<span class="ident" id="2307337">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307349">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307360">tail</span>&nbsp;<span class="op" id="2307365">=</span>&nbsp;<span class="ident" id="2307367">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307370">return</span><br>
<span class="lineno"></span><span class="op" id="2307377">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2307380">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="2307439">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2307502">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="2307562">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="2307618">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="2307644">func</span>&nbsp;<span class="ident" id="2307649">Unquote</span><span class="op" id="2307656">(</span><span class="ident" id="2307657">s</span>&nbsp;<span class="builtintype" id="2307659">string</span><span class="op" id="2307665">)</span>&nbsp;<span class="op" id="2307667">(</span><span class="ident" id="2307668">t</span>&nbsp;<span class="builtintype" id="2307670">string</span><span class="op" id="2307676">,</span>&nbsp;<span class="ident" id="2307678">err</span>&nbsp;<span class="builtintype" id="2307682">error</span><span class="op" id="2307687">)</span>&nbsp;<span class="op" id="2307689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307692">n</span>&nbsp;<span class="op" id="2307694">:=</span>&nbsp;<span class="builtinfunc" id="2307697">len</span><span class="op" id="2307700">(</span><span class="ident" id="2307701">s</span><span class="op" id="2307702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307705">if</span>&nbsp;<span class="ident" id="2307708">n</span>&nbsp;<span class="op" id="2307710">&lt;</span>&nbsp;<span class="num" id="2307712">2</span>&nbsp;<span class="op" id="2307714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307718">return</span>&nbsp;<span class="string" id="2307725">&#34;&#34;</span><span class="op" id="2307727">,</span>&nbsp;<span class="ident" id="2307729">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307743">quote</span>&nbsp;<span class="op" id="2307749">:=</span>&nbsp;<span class="ident" id="2307752">s</span><span class="op" id="2307753">[</span><span class="num" id="2307754">0</span><span class="op" id="2307755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307758">if</span>&nbsp;<span class="ident" id="2307761">quote</span>&nbsp;<span class="op" id="2307767">!=</span>&nbsp;<span class="ident" id="2307770">s</span><span class="op" id="2307771">[</span><span class="ident" id="2307772">n</span><span class="op" id="2307773">-</span><span class="num" id="2307774">1</span><span class="op" id="2307775">]</span>&nbsp;<span class="op" id="2307777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307781">return</span>&nbsp;<span class="string" id="2307788">&#34;&#34;</span><span class="op" id="2307790">,</span>&nbsp;<span class="ident" id="2307792">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307803">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2307806">s</span>&nbsp;<span class="op" id="2307808">=</span>&nbsp;<span class="ident" id="2307810">s</span><span class="op" id="2307811">[</span><span class="num" id="2307812">1</span>&nbsp;<span class="op" id="2307814">:</span>&nbsp;<span class="ident" id="2307816">n</span><span class="op" id="2307817">-</span><span class="num" id="2307818">1</span><span class="op" id="2307819">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307823">if</span>&nbsp;<span class="ident" id="2307826">quote</span>&nbsp;<span class="op" id="2307832">==</span>&nbsp;<span class="string" id="2307835">&#39;`&#39;</span>&nbsp;<span class="op" id="2307839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307843">if</span>&nbsp;<span class="ident" id="2307846">contains</span><span class="op" id="2307854">(</span><span class="ident" id="2307855">s</span><span class="op" id="2307856">,</span>&nbsp;<span class="string" id="2307858">&#39;`&#39;</span><span class="op" id="2307861">)</span>&nbsp;<span class="op" id="2307863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307868">return</span>&nbsp;<span class="string" id="2307875">&#34;&#34;</span><span class="op" id="2307877">,</span>&nbsp;<span class="ident" id="2307879">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307895">return</span>&nbsp;<span class="ident" id="2307902">s</span><span class="op" id="2307903">,</span>&nbsp;<span class="ident" id="2307905">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307913">if</span>&nbsp;<span class="ident" id="2307916">quote</span>&nbsp;<span class="op" id="2307922">!=</span>&nbsp;<span class="string" id="2307925">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2307929">&amp;&amp;</span>&nbsp;<span class="ident" id="2307932">quote</span>&nbsp;<span class="op" id="2307938">!=</span>&nbsp;<span class="string" id="2307941">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2307946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307950">return</span>&nbsp;<span class="string" id="2307957">&#34;&#34;</span><span class="op" id="2307959">,</span>&nbsp;<span class="ident" id="2307961">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2307972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2307975">if</span>&nbsp;<span class="ident" id="2307978">contains</span><span class="op" id="2307986">(</span><span class="ident" id="2307987">s</span><span class="op" id="2307988">,</span>&nbsp;<span class="string" id="2307990">&#39;\n&#39;</span><span class="op" id="2307994">)</span>&nbsp;<span class="op" id="2307996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308000">return</span>&nbsp;<span class="string" id="2308007">&#34;&#34;</span><span class="op" id="2308009">,</span>&nbsp;<span class="ident" id="2308011">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2308026">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308064">if</span>&nbsp;<span class="op" id="2308067">!</span><span class="ident" id="2308068">contains</span><span class="op" id="2308076">(</span><span class="ident" id="2308077">s</span><span class="op" id="2308078">,</span>&nbsp;<span class="string" id="2308080">&#39;\\&#39;</span><span class="op" id="2308084">)</span>&nbsp;<span class="op" id="2308086">&amp;&amp;</span>&nbsp;<span class="op" id="2308089">!</span><span class="ident" id="2308090">contains</span><span class="op" id="2308098">(</span><span class="ident" id="2308099">s</span><span class="op" id="2308100">,</span>&nbsp;<span class="ident" id="2308102">quote</span><span class="op" id="2308107">)</span>&nbsp;<span class="op" id="2308109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308113">switch</span>&nbsp;<span class="ident" id="2308120">quote</span>&nbsp;<span class="op" id="2308126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308130">case</span>&nbsp;<span class="string" id="2308135">&#39;&#34;&#39;</span><span class="op" id="2308138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308143">return</span>&nbsp;<span class="ident" id="2308150">s</span><span class="op" id="2308151">,</span>&nbsp;<span class="ident" id="2308153">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308159">case</span>&nbsp;<span class="string" id="2308164">&#39;\&#39;&#39;</span><span class="op" id="2308168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308173">r</span><span class="op" id="2308174">,</span>&nbsp;<span class="ident" id="2308176">size</span>&nbsp;<span class="op" id="2308181">:=</span>&nbsp;<span class="ident" id="2308184">utf8</span><span class="op" id="2308188">.</span><span class="ident" id="2308189">DecodeRuneInString</span><span class="op" id="2308207">(</span><span class="ident" id="2308208">s</span><span class="op" id="2308209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308214">if</span>&nbsp;<span class="ident" id="2308217">size</span>&nbsp;<span class="op" id="2308222">==</span>&nbsp;<span class="builtinfunc" id="2308225">len</span><span class="op" id="2308228">(</span><span class="ident" id="2308229">s</span><span class="op" id="2308230">)</span>&nbsp;<span class="op" id="2308232">&amp;&amp;</span>&nbsp;<span class="op" id="2308235">(</span><span class="ident" id="2308236">r</span>&nbsp;<span class="op" id="2308238">!=</span>&nbsp;<span class="ident" id="2308241">utf8</span><span class="op" id="2308245">.</span><span class="ident" id="2308246">RuneError</span>&nbsp;<span class="op" id="2308256">||</span>&nbsp;<span class="ident" id="2308259">size</span>&nbsp;<span class="op" id="2308264">!=</span>&nbsp;<span class="num" id="2308267">1</span><span class="op" id="2308268">)</span>&nbsp;<span class="op" id="2308270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308276">return</span>&nbsp;<span class="ident" id="2308283">s</span><span class="op" id="2308284">,</span>&nbsp;<span class="ident" id="2308286">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308293">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308304">var</span>&nbsp;<span class="ident" id="2308308">runeTmp</span>&nbsp;<span class="op" id="2308316">[</span><span class="ident" id="2308317">utf8</span><span class="op" id="2308321">.</span><span class="ident" id="2308322">UTFMax</span><span class="op" id="2308328">]</span><span class="builtintype" id="2308329">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308335">buf</span>&nbsp;<span class="op" id="2308339">:=</span>&nbsp;<span class="builtinfunc" id="2308342">make</span><span class="op" id="2308346">(</span><span class="op" id="2308347">[</span><span class="op" id="2308348">]</span><span class="builtintype" id="2308349">byte</span><span class="op" id="2308353">,</span>&nbsp;<span class="num" id="2308355">0</span><span class="op" id="2308356">,</span>&nbsp;<span class="num" id="2308358">3</span><span class="op" id="2308359">*</span><span class="builtinfunc" id="2308360">len</span><span class="op" id="2308363">(</span><span class="ident" id="2308364">s</span><span class="op" id="2308365">)</span><span class="op" id="2308366">/</span><span class="num" id="2308367">2</span><span class="op" id="2308368">)</span>&nbsp;<span class="comment" id="2308370">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308405">for</span>&nbsp;<span class="builtinfunc" id="2308409">len</span><span class="op" id="2308412">(</span><span class="ident" id="2308413">s</span><span class="op" id="2308414">)</span>&nbsp;<span class="op" id="2308416">&gt;</span>&nbsp;<span class="num" id="2308418">0</span>&nbsp;<span class="op" id="2308420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308424">c</span><span class="op" id="2308425">,</span>&nbsp;<span class="ident" id="2308427">multibyte</span><span class="op" id="2308436">,</span>&nbsp;<span class="ident" id="2308438">ss</span><span class="op" id="2308440">,</span>&nbsp;<span class="ident" id="2308442">err</span>&nbsp;<span class="op" id="2308446">:=</span>&nbsp;<span class="ident" id="2308449">UnquoteChar</span><span class="op" id="2308460">(</span><span class="ident" id="2308461">s</span><span class="op" id="2308462">,</span>&nbsp;<span class="ident" id="2308464">quote</span><span class="op" id="2308469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308473">if</span>&nbsp;<span class="ident" id="2308476">err</span>&nbsp;<span class="op" id="2308480">!=</span>&nbsp;<span class="ident" id="2308483">nil</span>&nbsp;<span class="op" id="2308487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308492">return</span>&nbsp;<span class="string" id="2308499">&#34;&#34;</span><span class="op" id="2308501">,</span>&nbsp;<span class="ident" id="2308503">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308509">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308513">s</span>&nbsp;<span class="op" id="2308515">=</span>&nbsp;<span class="ident" id="2308517">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308522">if</span>&nbsp;<span class="ident" id="2308525">c</span>&nbsp;<span class="op" id="2308527">&lt;</span>&nbsp;<span class="ident" id="2308529">utf8</span><span class="op" id="2308533">.</span><span class="ident" id="2308534">RuneSelf</span>&nbsp;<span class="op" id="2308543">||</span>&nbsp;<span class="op" id="2308546">!</span><span class="ident" id="2308547">multibyte</span>&nbsp;<span class="op" id="2308557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308562">buf</span>&nbsp;<span class="op" id="2308566">=</span>&nbsp;<span class="builtinfunc" id="2308568">append</span><span class="op" id="2308574">(</span><span class="ident" id="2308575">buf</span><span class="op" id="2308578">,</span>&nbsp;<span class="builtintype" id="2308580">byte</span><span class="op" id="2308584">(</span><span class="ident" id="2308585">c</span><span class="op" id="2308586">)</span><span class="op" id="2308587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308591">}</span>&nbsp;<span class="keyword" id="2308593">else</span>&nbsp;<span class="op" id="2308598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308603">n</span>&nbsp;<span class="op" id="2308605">:=</span>&nbsp;<span class="ident" id="2308608">utf8</span><span class="op" id="2308612">.</span><span class="ident" id="2308613">EncodeRune</span><span class="op" id="2308623">(</span><span class="ident" id="2308624">runeTmp</span><span class="op" id="2308631">[</span><span class="op" id="2308632">:</span><span class="op" id="2308633">]</span><span class="op" id="2308634">,</span>&nbsp;<span class="ident" id="2308636">c</span><span class="op" id="2308637">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2308642">buf</span>&nbsp;<span class="op" id="2308646">=</span>&nbsp;<span class="builtinfunc" id="2308648">append</span><span class="op" id="2308654">(</span><span class="ident" id="2308655">buf</span><span class="op" id="2308658">,</span>&nbsp;<span class="ident" id="2308660">runeTmp</span><span class="op" id="2308667">[</span><span class="op" id="2308668">:</span><span class="ident" id="2308669">n</span><span class="op" id="2308670">]</span><span class="op" id="2308671">...</span><span class="op" id="2308674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308682">if</span>&nbsp;<span class="ident" id="2308685">quote</span>&nbsp;<span class="op" id="2308691">==</span>&nbsp;<span class="string" id="2308694">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2308699">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2308702">len</span><span class="op" id="2308705">(</span><span class="ident" id="2308706">s</span><span class="op" id="2308707">)</span>&nbsp;<span class="op" id="2308709">!=</span>&nbsp;<span class="num" id="2308712">0</span>&nbsp;<span class="op" id="2308714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2308719">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308764">return</span>&nbsp;<span class="string" id="2308771">&#34;&#34;</span><span class="op" id="2308773">,</span>&nbsp;<span class="ident" id="2308775">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308793">return</span>&nbsp;<span class="builtintype" id="2308800">string</span><span class="op" id="2308806">(</span><span class="ident" id="2308807">buf</span><span class="op" id="2308810">)</span><span class="op" id="2308811">,</span>&nbsp;<span class="ident" id="2308813">nil</span><br>
<span class="lineno"></span><span class="op" id="2308817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="2308820">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2308880">func</span>&nbsp;<span class="ident" id="2308885">contains</span><span class="op" id="2308893">(</span><span class="ident" id="2308894">s</span>&nbsp;<span class="builtintype" id="2308896">string</span><span class="op" id="2308902">,</span>&nbsp;<span class="ident" id="2308904">c</span>&nbsp;<span class="builtintype" id="2308906">byte</span><span class="op" id="2308910">)</span>&nbsp;<span class="builtintype" id="2308912">bool</span>&nbsp;<span class="op" id="2308917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308920">for</span>&nbsp;<span class="ident" id="2308924">i</span>&nbsp;<span class="op" id="2308926">:=</span>&nbsp;<span class="num" id="2308929">0</span><span class="op" id="2308930">;</span>&nbsp;<span class="ident" id="2308932">i</span>&nbsp;<span class="op" id="2308934">&lt;</span>&nbsp;<span class="builtinfunc" id="2308936">len</span><span class="op" id="2308939">(</span><span class="ident" id="2308940">s</span><span class="op" id="2308941">)</span><span class="op" id="2308942">;</span>&nbsp;<span class="ident" id="2308944">i</span><span class="op" id="2308945">++</span>&nbsp;<span class="op" id="2308948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308952">if</span>&nbsp;<span class="ident" id="2308955">s</span><span class="op" id="2308956">[</span><span class="ident" id="2308957">i</span><span class="op" id="2308958">]</span>&nbsp;<span class="op" id="2308960">==</span>&nbsp;<span class="ident" id="2308963">c</span>&nbsp;<span class="op" id="2308965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308970">return</span>&nbsp;<span class="builtintype" id="2308977">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2308987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2308990">return</span>&nbsp;<span class="builtintype" id="2308997">false</span><br>
<span class="lineno"></span><span class="op" id="2309003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2309006">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2309063">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2309115">func</span>&nbsp;<span class="ident" id="2309120">bsearch16</span><span class="op" id="2309129">(</span><span class="ident" id="2309130">a</span>&nbsp;<span class="op" id="2309132">[</span><span class="op" id="2309133">]</span><span class="builtintype" id="2309134">uint16</span><span class="op" id="2309140">,</span>&nbsp;<span class="ident" id="2309142">x</span>&nbsp;<span class="builtintype" id="2309144">uint16</span><span class="op" id="2309150">)</span>&nbsp;<span class="builtintype" id="2309152">int</span>&nbsp;<span class="op" id="2309156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309159">i</span><span class="op" id="2309160">,</span>&nbsp;<span class="ident" id="2309162">j</span>&nbsp;<span class="op" id="2309164">:=</span>&nbsp;<span class="num" id="2309167">0</span><span class="op" id="2309168">,</span>&nbsp;<span class="builtinfunc" id="2309170">len</span><span class="op" id="2309173">(</span><span class="ident" id="2309174">a</span><span class="op" id="2309175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309178">for</span>&nbsp;<span class="ident" id="2309182">i</span>&nbsp;<span class="op" id="2309184">&lt;</span>&nbsp;<span class="ident" id="2309186">j</span>&nbsp;<span class="op" id="2309188">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309192">h</span>&nbsp;<span class="op" id="2309194">:=</span>&nbsp;<span class="ident" id="2309197">i</span>&nbsp;<span class="op" id="2309199">+</span>&nbsp;<span class="op" id="2309201">(</span><span class="ident" id="2309202">j</span><span class="op" id="2309203">-</span><span class="ident" id="2309204">i</span><span class="op" id="2309205">)</span><span class="op" id="2309206">/</span><span class="num" id="2309207">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309211">if</span>&nbsp;<span class="ident" id="2309214">a</span><span class="op" id="2309215">[</span><span class="ident" id="2309216">h</span><span class="op" id="2309217">]</span>&nbsp;<span class="op" id="2309219">&lt;</span>&nbsp;<span class="ident" id="2309221">x</span>&nbsp;<span class="op" id="2309223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309228">i</span>&nbsp;<span class="op" id="2309230">=</span>&nbsp;<span class="ident" id="2309232">h</span>&nbsp;<span class="op" id="2309234">+</span>&nbsp;<span class="num" id="2309236">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309240">}</span>&nbsp;<span class="keyword" id="2309242">else</span>&nbsp;<span class="op" id="2309247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309252">j</span>&nbsp;<span class="op" id="2309254">=</span>&nbsp;<span class="ident" id="2309256">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309266">return</span>&nbsp;<span class="ident" id="2309273">i</span><br>
<span class="lineno"></span><span class="op" id="2309275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="2309278">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2309335">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="2309387">func</span>&nbsp;<span class="ident" id="2309392">bsearch32</span><span class="op" id="2309401">(</span><span class="ident" id="2309402">a</span>&nbsp;<span class="op" id="2309404">[</span><span class="op" id="2309405">]</span><span class="builtintype" id="2309406">uint32</span><span class="op" id="2309412">,</span>&nbsp;<span class="ident" id="2309414">x</span>&nbsp;<span class="builtintype" id="2309416">uint32</span><span class="op" id="2309422">)</span>&nbsp;<span class="builtintype" id="2309424">int</span>&nbsp;<span class="op" id="2309428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309431">i</span><span class="op" id="2309432">,</span>&nbsp;<span class="ident" id="2309434">j</span>&nbsp;<span class="op" id="2309436">:=</span>&nbsp;<span class="num" id="2309439">0</span><span class="op" id="2309440">,</span>&nbsp;<span class="builtinfunc" id="2309442">len</span><span class="op" id="2309445">(</span><span class="ident" id="2309446">a</span><span class="op" id="2309447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309450">for</span>&nbsp;<span class="ident" id="2309454">i</span>&nbsp;<span class="op" id="2309456">&lt;</span>&nbsp;<span class="ident" id="2309458">j</span>&nbsp;<span class="op" id="2309460">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309464">h</span>&nbsp;<span class="op" id="2309466">:=</span>&nbsp;<span class="ident" id="2309469">i</span>&nbsp;<span class="op" id="2309471">+</span>&nbsp;<span class="op" id="2309473">(</span><span class="ident" id="2309474">j</span><span class="op" id="2309475">-</span><span class="ident" id="2309476">i</span><span class="op" id="2309477">)</span><span class="op" id="2309478">/</span><span class="num" id="2309479">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309483">if</span>&nbsp;<span class="ident" id="2309486">a</span><span class="op" id="2309487">[</span><span class="ident" id="2309488">h</span><span class="op" id="2309489">]</span>&nbsp;<span class="op" id="2309491">&lt;</span>&nbsp;<span class="ident" id="2309493">x</span>&nbsp;<span class="op" id="2309495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309500">i</span>&nbsp;<span class="op" id="2309502">=</span>&nbsp;<span class="ident" id="2309504">h</span>&nbsp;<span class="op" id="2309506">+</span>&nbsp;<span class="num" id="2309508">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309512">}</span>&nbsp;<span class="keyword" id="2309514">else</span>&nbsp;<span class="op" id="2309519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2309524">j</span>&nbsp;<span class="op" id="2309526">=</span>&nbsp;<span class="ident" id="2309528">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2309535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2309538">return</span>&nbsp;<span class="ident" id="2309545">i</span><br>
<span class="lineno"></span><span class="op" id="2309547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="2309550">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="2309635">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="2309712">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2309791">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="2309861">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="2309885">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2309957">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="2310031">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="2310059">func</span>&nbsp;<span class="ident" id="2310064">IsPrint</span><span class="op" id="2310071">(</span><span class="ident" id="2310072">r</span>&nbsp;<span class="builtintype" id="2310074">rune</span><span class="op" id="2310078">)</span>&nbsp;<span class="builtintype" id="2310080">bool</span>&nbsp;<span class="op" id="2310085">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310088">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310115">if</span>&nbsp;<span class="ident" id="2310118">r</span>&nbsp;<span class="op" id="2310120">&lt;=</span>&nbsp;<span class="num" id="2310123">0xFF</span>&nbsp;<span class="op" id="2310128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310132">if</span>&nbsp;<span class="num" id="2310135">0x20</span>&nbsp;<span class="op" id="2310140">&lt;=</span>&nbsp;<span class="ident" id="2310143">r</span>&nbsp;<span class="op" id="2310145">&amp;&amp;</span>&nbsp;<span class="ident" id="2310148">r</span>&nbsp;<span class="op" id="2310150">&lt;=</span>&nbsp;<span class="num" id="2310153">0x7E</span>&nbsp;<span class="op" id="2310158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310163">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310222">return</span>&nbsp;<span class="builtintype" id="2310229">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2310236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310240">if</span>&nbsp;<span class="num" id="2310243">0xA1</span>&nbsp;<span class="op" id="2310248">&lt;=</span>&nbsp;<span class="ident" id="2310251">r</span>&nbsp;<span class="op" id="2310253">&amp;&amp;</span>&nbsp;<span class="ident" id="2310256">r</span>&nbsp;<span class="op" id="2310258">&lt;=</span>&nbsp;<span class="num" id="2310261">0xFF</span>&nbsp;<span class="op" id="2310266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310271">//&nbsp;Similarly&nbsp;for&nbsp;¡&nbsp;through&nbsp;ÿ...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310308">return</span>&nbsp;<span class="ident" id="2310315">r</span>&nbsp;<span class="op" id="2310317">!=</span>&nbsp;<span class="num" id="2310320">0xAD</span>&nbsp;<span class="comment" id="2310325">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2310369">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310373">return</span>&nbsp;<span class="builtintype" id="2310380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2310387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310391">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310445">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310496">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310574">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2310647">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310716">if</span>&nbsp;<span class="num" id="2310719">0</span>&nbsp;<span class="op" id="2310721">&lt;=</span>&nbsp;<span class="ident" id="2310724">r</span>&nbsp;<span class="op" id="2310726">&amp;&amp;</span>&nbsp;<span class="ident" id="2310729">r</span>&nbsp;<span class="op" id="2310731">&lt;</span>&nbsp;<span class="num" id="2310733">1</span><span class="op" id="2310734">&lt;&lt;</span><span class="num" id="2310736">16</span>&nbsp;<span class="op" id="2310739">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2310743">rr</span><span class="op" id="2310745">,</span>&nbsp;<span class="ident" id="2310747">isPrint</span><span class="op" id="2310754">,</span>&nbsp;<span class="ident" id="2310756">isNotPrint</span>&nbsp;<span class="op" id="2310767">:=</span>&nbsp;<span class="builtintype" id="2310770">uint16</span><span class="op" id="2310776">(</span><span class="ident" id="2310777">r</span><span class="op" id="2310778">)</span><span class="op" id="2310779">,</span>&nbsp;<span class="ident" id="2310781">isPrint16</span><span class="op" id="2310790">,</span>&nbsp;<span class="ident" id="2310792">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2310807">i</span>&nbsp;<span class="op" id="2310809">:=</span>&nbsp;<span class="ident" id="2310812">bsearch16</span><span class="op" id="2310821">(</span><span class="ident" id="2310822">isPrint</span><span class="op" id="2310829">,</span>&nbsp;<span class="ident" id="2310831">rr</span><span class="op" id="2310833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310837">if</span>&nbsp;<span class="ident" id="2310840">i</span>&nbsp;<span class="op" id="2310842">&gt;=</span>&nbsp;<span class="builtinfunc" id="2310845">len</span><span class="op" id="2310848">(</span><span class="ident" id="2310849">isPrint</span><span class="op" id="2310856">)</span>&nbsp;<span class="op" id="2310858">||</span>&nbsp;<span class="ident" id="2310861">rr</span>&nbsp;<span class="op" id="2310864">&lt;</span>&nbsp;<span class="ident" id="2310866">isPrint</span><span class="op" id="2310873">[</span><span class="ident" id="2310874">i</span><span class="op" id="2310875">&amp;^</span><span class="num" id="2310877">1</span><span class="op" id="2310878">]</span>&nbsp;<span class="op" id="2310880">||</span>&nbsp;<span class="ident" id="2310883">isPrint</span><span class="op" id="2310890">[</span><span class="ident" id="2310891">i</span><span class="op" id="2310892">|</span><span class="num" id="2310893">1</span><span class="op" id="2310894">]</span>&nbsp;<span class="op" id="2310896">&lt;</span>&nbsp;<span class="ident" id="2310898">rr</span>&nbsp;<span class="op" id="2310901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310906">return</span>&nbsp;<span class="builtintype" id="2310913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2310921">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2310925">j</span>&nbsp;<span class="op" id="2310927">:=</span>&nbsp;<span class="ident" id="2310930">bsearch16</span><span class="op" id="2310939">(</span><span class="ident" id="2310940">isNotPrint</span><span class="op" id="2310950">,</span>&nbsp;<span class="ident" id="2310952">rr</span><span class="op" id="2310954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2310958">return</span>&nbsp;<span class="ident" id="2310965">j</span>&nbsp;<span class="op" id="2310967">&gt;=</span>&nbsp;<span class="builtinfunc" id="2310970">len</span><span class="op" id="2310973">(</span><span class="ident" id="2310974">isNotPrint</span><span class="op" id="2310984">)</span>&nbsp;<span class="op" id="2310986">||</span>&nbsp;<span class="ident" id="2310989">isNotPrint</span><span class="op" id="2310999">[</span><span class="ident" id="2311000">j</span><span class="op" id="2311001">]</span>&nbsp;<span class="op" id="2311003">!=</span>&nbsp;<span class="ident" id="2311006">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2311010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2311014">rr</span><span class="op" id="2311016">,</span>&nbsp;<span class="ident" id="2311018">isPrint</span><span class="op" id="2311025">,</span>&nbsp;<span class="ident" id="2311027">isNotPrint</span>&nbsp;<span class="op" id="2311038">:=</span>&nbsp;<span class="builtintype" id="2311041">uint32</span><span class="op" id="2311047">(</span><span class="ident" id="2311048">r</span><span class="op" id="2311049">)</span><span class="op" id="2311050">,</span>&nbsp;<span class="ident" id="2311052">isPrint32</span><span class="op" id="2311061">,</span>&nbsp;<span class="ident" id="2311063">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2311077">i</span>&nbsp;<span class="op" id="2311079">:=</span>&nbsp;<span class="ident" id="2311082">bsearch32</span><span class="op" id="2311091">(</span><span class="ident" id="2311092">isPrint</span><span class="op" id="2311099">,</span>&nbsp;<span class="ident" id="2311101">rr</span><span class="op" id="2311103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2311106">if</span>&nbsp;<span class="ident" id="2311109">i</span>&nbsp;<span class="op" id="2311111">&gt;=</span>&nbsp;<span class="builtinfunc" id="2311114">len</span><span class="op" id="2311117">(</span><span class="ident" id="2311118">isPrint</span><span class="op" id="2311125">)</span>&nbsp;<span class="op" id="2311127">||</span>&nbsp;<span class="ident" id="2311130">rr</span>&nbsp;<span class="op" id="2311133">&lt;</span>&nbsp;<span class="ident" id="2311135">isPrint</span><span class="op" id="2311142">[</span><span class="ident" id="2311143">i</span><span class="op" id="2311144">&amp;^</span><span class="num" id="2311146">1</span><span class="op" id="2311147">]</span>&nbsp;<span class="op" id="2311149">||</span>&nbsp;<span class="ident" id="2311152">isPrint</span><span class="op" id="2311159">[</span><span class="ident" id="2311160">i</span><span class="op" id="2311161">|</span><span class="num" id="2311162">1</span><span class="op" id="2311163">]</span>&nbsp;<span class="op" id="2311165">&lt;</span>&nbsp;<span class="ident" id="2311167">rr</span>&nbsp;<span class="op" id="2311170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2311174">return</span>&nbsp;<span class="builtintype" id="2311181">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2311188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2311191">if</span>&nbsp;<span class="ident" id="2311194">r</span>&nbsp;<span class="op" id="2311196">&gt;=</span>&nbsp;<span class="num" id="2311199">0x20000</span>&nbsp;<span class="op" id="2311207">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2311211">return</span>&nbsp;<span class="builtintype" id="2311218">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2311224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2311227">r</span>&nbsp;<span class="op" id="2311229">-=</span>&nbsp;<span class="num" id="2311232">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2311241">j</span>&nbsp;<span class="op" id="2311243">:=</span>&nbsp;<span class="ident" id="2311246">bsearch16</span><span class="op" id="2311255">(</span><span class="ident" id="2311256">isNotPrint</span><span class="op" id="2311266">,</span>&nbsp;<span class="builtintype" id="2311268">uint16</span><span class="op" id="2311274">(</span><span class="ident" id="2311275">r</span><span class="op" id="2311276">)</span><span class="op" id="2311277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2311280">return</span>&nbsp;<span class="ident" id="2311287">j</span>&nbsp;<span class="op" id="2311289">&gt;=</span>&nbsp;<span class="builtinfunc" id="2311292">len</span><span class="op" id="2311295">(</span><span class="ident" id="2311296">isNotPrint</span><span class="op" id="2311306">)</span>&nbsp;<span class="op" id="2311308">||</span>&nbsp;<span class="ident" id="2311311">isNotPrint</span><span class="op" id="2311321">[</span><span class="ident" id="2311322">j</span><span class="op" id="2311323">]</span>&nbsp;<span class="op" id="2311325">!=</span>&nbsp;<span class="builtintype" id="2311328">uint16</span><span class="op" id="2311334">(</span><span class="ident" id="2311335">r</span><span class="op" id="2311336">)</span><br>
<span class="lineno">455</span><span class="op" id="2311338">}</span>
</div>
</body>
</html>
