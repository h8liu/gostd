<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html" class="current">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5414133">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5414189">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5414243">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5414294">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="5414365">package</span>&nbsp;<span class="ident" id="5414373">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414380">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5414443">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="5414498">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5414574">const</span>&nbsp;<span class="op" id="5414580">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414583">replacementChar</span>&nbsp;<span class="op" id="5414599">=</span>&nbsp;<span class="string" id="5414601">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5414614">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414648">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5414664">=</span>&nbsp;<span class="string" id="5414666">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="5414679">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="5414716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5414719">const</span>&nbsp;<span class="op" id="5414725">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5414728">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5414782">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5414835">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414880">surr1</span>&nbsp;<span class="op" id="5414886">=</span>&nbsp;<span class="num" id="5414888">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414896">surr2</span>&nbsp;<span class="op" id="5414902">=</span>&nbsp;<span class="num" id="5414904">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414912">surr3</span>&nbsp;<span class="op" id="5414918">=</span>&nbsp;<span class="num" id="5414920">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5414929">surrSelf</span>&nbsp;<span class="op" id="5414938">=</span>&nbsp;<span class="num" id="5414940">0x10000</span><br>
<span class="lineno"></span><span class="op" id="5414948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5414951">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="5415015">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="5415050">func</span>&nbsp;<span class="ident" id="5415055">IsSurrogate</span><span class="op" id="5415066">(</span><span class="ident" id="5415067">r</span>&nbsp;<span class="builtintype" id="5415069">rune</span><span class="op" id="5415073">)</span>&nbsp;<span class="builtintype" id="5415075">bool</span>&nbsp;<span class="op" id="5415080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415083">return</span>&nbsp;<span class="ident" id="5415090">surr1</span>&nbsp;<span class="op" id="5415096">&lt;=</span>&nbsp;<span class="ident" id="5415099">r</span>&nbsp;<span class="op" id="5415101">&amp;&amp;</span>&nbsp;<span class="ident" id="5415104">r</span>&nbsp;<span class="op" id="5415106">&lt;</span>&nbsp;<span class="ident" id="5415108">surr3</span><br>
<span class="lineno"></span><span class="op" id="5415114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415117">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="5415180">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5415252">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5415298">func</span>&nbsp;<span class="ident" id="5415303">DecodeRune</span><span class="op" id="5415313">(</span><span class="ident" id="5415314">r1</span><span class="op" id="5415316">,</span>&nbsp;<span class="ident" id="5415318">r2</span>&nbsp;<span class="builtintype" id="5415321">rune</span><span class="op" id="5415325">)</span>&nbsp;<span class="builtintype" id="5415327">rune</span>&nbsp;<span class="op" id="5415332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415335">if</span>&nbsp;<span class="ident" id="5415338">surr1</span>&nbsp;<span class="op" id="5415344">&lt;=</span>&nbsp;<span class="ident" id="5415347">r1</span>&nbsp;<span class="op" id="5415350">&amp;&amp;</span>&nbsp;<span class="ident" id="5415353">r1</span>&nbsp;<span class="op" id="5415356">&lt;</span>&nbsp;<span class="ident" id="5415358">surr2</span>&nbsp;<span class="op" id="5415364">&amp;&amp;</span>&nbsp;<span class="ident" id="5415367">surr2</span>&nbsp;<span class="op" id="5415373">&lt;=</span>&nbsp;<span class="ident" id="5415376">r2</span>&nbsp;<span class="op" id="5415379">&amp;&amp;</span>&nbsp;<span class="ident" id="5415382">r2</span>&nbsp;<span class="op" id="5415385">&lt;</span>&nbsp;<span class="ident" id="5415387">surr3</span>&nbsp;<span class="op" id="5415393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415397">return</span>&nbsp;<span class="op" id="5415404">(</span><span class="ident" id="5415405">r1</span><span class="op" id="5415407">-</span><span class="ident" id="5415408">surr1</span><span class="op" id="5415413">)</span><span class="op" id="5415414">&lt;&lt;</span><span class="num" id="5415416">10</span>&nbsp;<span class="op" id="5415419">|</span>&nbsp;<span class="op" id="5415421">(</span><span class="ident" id="5415422">r2</span>&nbsp;<span class="op" id="5415425">-</span>&nbsp;<span class="ident" id="5415427">surr2</span><span class="op" id="5415432">)</span>&nbsp;<span class="op" id="5415434">+</span>&nbsp;<span class="num" id="5415436">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415448">return</span>&nbsp;<span class="ident" id="5415455">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="5415471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5415474">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="5415549">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="5415625">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5415663">func</span>&nbsp;<span class="ident" id="5415668">EncodeRune</span><span class="op" id="5415678">(</span><span class="ident" id="5415679">r</span>&nbsp;<span class="builtintype" id="5415681">rune</span><span class="op" id="5415685">)</span>&nbsp;<span class="op" id="5415687">(</span><span class="ident" id="5415688">r1</span><span class="op" id="5415690">,</span>&nbsp;<span class="ident" id="5415692">r2</span>&nbsp;<span class="builtintype" id="5415695">rune</span><span class="op" id="5415699">)</span>&nbsp;<span class="op" id="5415701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415704">if</span>&nbsp;<span class="ident" id="5415707">r</span>&nbsp;<span class="op" id="5415709">&lt;</span>&nbsp;<span class="ident" id="5415711">surrSelf</span>&nbsp;<span class="op" id="5415720">||</span>&nbsp;<span class="ident" id="5415723">r</span>&nbsp;<span class="op" id="5415725">&gt;</span>&nbsp;<span class="ident" id="5415727">maxRune</span>&nbsp;<span class="op" id="5415735">||</span>&nbsp;<span class="ident" id="5415738">IsSurrogate</span><span class="op" id="5415749">(</span><span class="ident" id="5415750">r</span><span class="op" id="5415751">)</span>&nbsp;<span class="op" id="5415753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415757">return</span>&nbsp;<span class="ident" id="5415764">replacementChar</span><span class="op" id="5415779">,</span>&nbsp;<span class="ident" id="5415781">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5415798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415801">r</span>&nbsp;<span class="op" id="5415803">-=</span>&nbsp;<span class="ident" id="5415806">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415816">return</span>&nbsp;<span class="ident" id="5415823">surr1</span>&nbsp;<span class="op" id="5415829">+</span>&nbsp;<span class="op" id="5415831">(</span><span class="ident" id="5415832">r</span><span class="op" id="5415833">&gt;&gt;</span><span class="num" id="5415835">10</span><span class="op" id="5415837">)</span><span class="op" id="5415838">&amp;</span><span class="num" id="5415839">0x3ff</span><span class="op" id="5415844">,</span>&nbsp;<span class="ident" id="5415846">surr2</span>&nbsp;<span class="op" id="5415852">+</span>&nbsp;<span class="ident" id="5415854">r</span><span class="op" id="5415855">&amp;</span><span class="num" id="5415856">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="5415862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="5415865">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5415941">func</span>&nbsp;<span class="ident" id="5415946">Encode</span><span class="op" id="5415952">(</span><span class="ident" id="5415953">s</span>&nbsp;<span class="op" id="5415955">[</span><span class="op" id="5415956">]</span><span class="builtintype" id="5415957">rune</span><span class="op" id="5415961">)</span>&nbsp;<span class="op" id="5415963">[</span><span class="op" id="5415964">]</span><span class="builtintype" id="5415965">uint16</span>&nbsp;<span class="op" id="5415972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5415975">n</span>&nbsp;<span class="op" id="5415977">:=</span>&nbsp;<span class="builtinfunc" id="5415980">len</span><span class="op" id="5415983">(</span><span class="ident" id="5415984">s</span><span class="op" id="5415985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5415988">for</span>&nbsp;<span class="ident" id="5415992">_</span><span class="op" id="5415993">,</span>&nbsp;<span class="ident" id="5415995">v</span>&nbsp;<span class="op" id="5415997">:=</span>&nbsp;<span class="keyword" id="5416000">range</span>&nbsp;<span class="ident" id="5416006">s</span>&nbsp;<span class="op" id="5416008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416012">if</span>&nbsp;<span class="ident" id="5416015">v</span>&nbsp;<span class="op" id="5416017">&gt;=</span>&nbsp;<span class="ident" id="5416020">surrSelf</span>&nbsp;<span class="op" id="5416029">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416034">n</span><span class="op" id="5416035">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416047">a</span>&nbsp;<span class="op" id="5416049">:=</span>&nbsp;<span class="builtinfunc" id="5416052">make</span><span class="op" id="5416056">(</span><span class="op" id="5416057">[</span><span class="op" id="5416058">]</span><span class="builtintype" id="5416059">uint16</span><span class="op" id="5416065">,</span>&nbsp;<span class="ident" id="5416067">n</span><span class="op" id="5416068">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416071">n</span>&nbsp;<span class="op" id="5416073">=</span>&nbsp;<span class="num" id="5416075">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416078">for</span>&nbsp;<span class="ident" id="5416082">_</span><span class="op" id="5416083">,</span>&nbsp;<span class="ident" id="5416085">v</span>&nbsp;<span class="op" id="5416087">:=</span>&nbsp;<span class="keyword" id="5416090">range</span>&nbsp;<span class="ident" id="5416096">s</span>&nbsp;<span class="op" id="5416098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416102">switch</span>&nbsp;<span class="op" id="5416109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416113">case</span>&nbsp;<span class="ident" id="5416118">v</span>&nbsp;<span class="op" id="5416120">&lt;</span>&nbsp;<span class="num" id="5416122">0</span><span class="op" id="5416123">,</span>&nbsp;<span class="ident" id="5416125">surr1</span>&nbsp;<span class="op" id="5416131">&lt;=</span>&nbsp;<span class="ident" id="5416134">v</span>&nbsp;<span class="op" id="5416136">&amp;&amp;</span>&nbsp;<span class="ident" id="5416139">v</span>&nbsp;<span class="op" id="5416141">&lt;</span>&nbsp;<span class="ident" id="5416143">surr3</span><span class="op" id="5416148">,</span>&nbsp;<span class="ident" id="5416150">v</span>&nbsp;<span class="op" id="5416152">&gt;</span>&nbsp;<span class="ident" id="5416154">maxRune</span><span class="op" id="5416161">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416166">v</span>&nbsp;<span class="op" id="5416168">=</span>&nbsp;<span class="ident" id="5416170">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416189">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416203">case</span>&nbsp;<span class="ident" id="5416208">v</span>&nbsp;<span class="op" id="5416210">&lt;</span>&nbsp;<span class="ident" id="5416212">surrSelf</span><span class="op" id="5416220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416225">a</span><span class="op" id="5416226">[</span><span class="ident" id="5416227">n</span><span class="op" id="5416228">]</span>&nbsp;<span class="op" id="5416230">=</span>&nbsp;<span class="builtintype" id="5416232">uint16</span><span class="op" id="5416238">(</span><span class="ident" id="5416239">v</span><span class="op" id="5416240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416245">n</span><span class="op" id="5416246">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416251">default</span><span class="op" id="5416258">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416263">r1</span><span class="op" id="5416265">,</span>&nbsp;<span class="ident" id="5416267">r2</span>&nbsp;<span class="op" id="5416270">:=</span>&nbsp;<span class="ident" id="5416273">EncodeRune</span><span class="op" id="5416283">(</span><span class="ident" id="5416284">v</span><span class="op" id="5416285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416290">a</span><span class="op" id="5416291">[</span><span class="ident" id="5416292">n</span><span class="op" id="5416293">]</span>&nbsp;<span class="op" id="5416295">=</span>&nbsp;<span class="builtintype" id="5416297">uint16</span><span class="op" id="5416303">(</span><span class="ident" id="5416304">r1</span><span class="op" id="5416306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416311">a</span><span class="op" id="5416312">[</span><span class="ident" id="5416313">n</span><span class="op" id="5416314">+</span><span class="num" id="5416315">1</span><span class="op" id="5416316">]</span>&nbsp;<span class="op" id="5416318">=</span>&nbsp;<span class="builtintype" id="5416320">uint16</span><span class="op" id="5416326">(</span><span class="ident" id="5416327">r2</span><span class="op" id="5416329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416334">n</span>&nbsp;<span class="op" id="5416336">+=</span>&nbsp;<span class="num" id="5416339">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416343">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416349">return</span>&nbsp;<span class="ident" id="5416356">a</span><span class="op" id="5416357">[</span><span class="num" id="5416358">0</span><span class="op" id="5416359">:</span><span class="ident" id="5416360">n</span><span class="op" id="5416361">]</span><br>
<span class="lineno"></span><span class="op" id="5416363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5416366">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="5416428">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5416457">func</span>&nbsp;<span class="ident" id="5416462">Decode</span><span class="op" id="5416468">(</span><span class="ident" id="5416469">s</span>&nbsp;<span class="op" id="5416471">[</span><span class="op" id="5416472">]</span><span class="builtintype" id="5416473">uint16</span><span class="op" id="5416479">)</span>&nbsp;<span class="op" id="5416481">[</span><span class="op" id="5416482">]</span><span class="builtintype" id="5416483">rune</span>&nbsp;<span class="op" id="5416488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416491">a</span>&nbsp;<span class="op" id="5416493">:=</span>&nbsp;<span class="builtinfunc" id="5416496">make</span><span class="op" id="5416500">(</span><span class="op" id="5416501">[</span><span class="op" id="5416502">]</span><span class="builtintype" id="5416503">rune</span><span class="op" id="5416507">,</span>&nbsp;<span class="builtinfunc" id="5416509">len</span><span class="op" id="5416512">(</span><span class="ident" id="5416513">s</span><span class="op" id="5416514">)</span><span class="op" id="5416515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416518">n</span>&nbsp;<span class="op" id="5416520">:=</span>&nbsp;<span class="num" id="5416523">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416526">for</span>&nbsp;<span class="ident" id="5416530">i</span>&nbsp;<span class="op" id="5416532">:=</span>&nbsp;<span class="num" id="5416535">0</span><span class="op" id="5416536">;</span>&nbsp;<span class="ident" id="5416538">i</span>&nbsp;<span class="op" id="5416540">&lt;</span>&nbsp;<span class="builtinfunc" id="5416542">len</span><span class="op" id="5416545">(</span><span class="ident" id="5416546">s</span><span class="op" id="5416547">)</span><span class="op" id="5416548">;</span>&nbsp;<span class="ident" id="5416550">i</span><span class="op" id="5416551">++</span>&nbsp;<span class="op" id="5416554">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416558">switch</span>&nbsp;<span class="ident" id="5416565">r</span>&nbsp;<span class="op" id="5416567">:=</span>&nbsp;<span class="ident" id="5416570">s</span><span class="op" id="5416571">[</span><span class="ident" id="5416572">i</span><span class="op" id="5416573">]</span><span class="op" id="5416574">;</span>&nbsp;<span class="op" id="5416576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416580">case</span>&nbsp;<span class="ident" id="5416585">surr1</span>&nbsp;<span class="op" id="5416591">&lt;=</span>&nbsp;<span class="ident" id="5416594">r</span>&nbsp;<span class="op" id="5416596">&amp;&amp;</span>&nbsp;<span class="ident" id="5416599">r</span>&nbsp;<span class="op" id="5416601">&lt;</span>&nbsp;<span class="ident" id="5416603">surr2</span>&nbsp;<span class="op" id="5416609">&amp;&amp;</span>&nbsp;<span class="ident" id="5416612">i</span><span class="op" id="5416613">+</span><span class="num" id="5416614">1</span>&nbsp;<span class="op" id="5416616">&lt;</span>&nbsp;<span class="builtinfunc" id="5416618">len</span><span class="op" id="5416621">(</span><span class="ident" id="5416622">s</span><span class="op" id="5416623">)</span>&nbsp;<span class="op" id="5416625">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416631">surr2</span>&nbsp;<span class="op" id="5416637">&lt;=</span>&nbsp;<span class="ident" id="5416640">s</span><span class="op" id="5416641">[</span><span class="ident" id="5416642">i</span><span class="op" id="5416643">+</span><span class="num" id="5416644">1</span><span class="op" id="5416645">]</span>&nbsp;<span class="op" id="5416647">&amp;&amp;</span>&nbsp;<span class="ident" id="5416650">s</span><span class="op" id="5416651">[</span><span class="ident" id="5416652">i</span><span class="op" id="5416653">+</span><span class="num" id="5416654">1</span><span class="op" id="5416655">]</span>&nbsp;<span class="op" id="5416657">&lt;</span>&nbsp;<span class="ident" id="5416659">surr3</span><span class="op" id="5416664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5416669">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416700">a</span><span class="op" id="5416701">[</span><span class="ident" id="5416702">n</span><span class="op" id="5416703">]</span>&nbsp;<span class="op" id="5416705">=</span>&nbsp;<span class="ident" id="5416707">DecodeRune</span><span class="op" id="5416717">(</span><span class="builtintype" id="5416718">rune</span><span class="op" id="5416722">(</span><span class="ident" id="5416723">r</span><span class="op" id="5416724">)</span><span class="op" id="5416725">,</span>&nbsp;<span class="builtintype" id="5416727">rune</span><span class="op" id="5416731">(</span><span class="ident" id="5416732">s</span><span class="op" id="5416733">[</span><span class="ident" id="5416734">i</span><span class="op" id="5416735">+</span><span class="num" id="5416736">1</span><span class="op" id="5416737">]</span><span class="op" id="5416738">)</span><span class="op" id="5416739">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416744">i</span><span class="op" id="5416745">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416751">n</span><span class="op" id="5416752">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416757">case</span>&nbsp;<span class="ident" id="5416762">surr1</span>&nbsp;<span class="op" id="5416768">&lt;=</span>&nbsp;<span class="ident" id="5416771">r</span>&nbsp;<span class="op" id="5416773">&amp;&amp;</span>&nbsp;<span class="ident" id="5416776">r</span>&nbsp;<span class="op" id="5416778">&lt;</span>&nbsp;<span class="ident" id="5416780">surr3</span><span class="op" id="5416785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5416790">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416823">a</span><span class="op" id="5416824">[</span><span class="ident" id="5416825">n</span><span class="op" id="5416826">]</span>&nbsp;<span class="op" id="5416828">=</span>&nbsp;<span class="ident" id="5416830">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416849">n</span><span class="op" id="5416850">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416855">default</span><span class="op" id="5416862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5416867">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416885">a</span><span class="op" id="5416886">[</span><span class="ident" id="5416887">n</span><span class="op" id="5416888">]</span>&nbsp;<span class="op" id="5416890">=</span>&nbsp;<span class="builtintype" id="5416892">rune</span><span class="op" id="5416896">(</span><span class="ident" id="5416897">r</span><span class="op" id="5416898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5416903">n</span><span class="op" id="5416904">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5416912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5416915">return</span>&nbsp;<span class="ident" id="5416922">a</span><span class="op" id="5416923">[</span><span class="num" id="5416924">0</span><span class="op" id="5416925">:</span><span class="ident" id="5416926">n</span><span class="op" id="5416927">]</span><br>
<span class="lineno"></span><span class="op" id="5416929">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
