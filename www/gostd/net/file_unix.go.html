<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3013697">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3013752">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3013806">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3013857">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3013922">package</span>&nbsp;<span class="ident" id="3013930">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3013935">import</span>&nbsp;<span class="op" id="3013942">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013945">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3013951">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3013961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3013964">func</span>&nbsp;<span class="ident" id="3013969">newFileFD</span><span class="op" id="3013978">(</span><span class="ident" id="3013979">f</span>&nbsp;<span class="op" id="3013981">*</span><span class="ident" id="3013982">os</span><span class="op" id="3013984">.</span><span class="ident" id="3013985">File</span><span class="op" id="3013989">)</span>&nbsp;<span class="op" id="3013991">(</span><span class="op" id="3013992">*</span><span class="ident" id="3013993">netFD</span><span class="op" id="3013998">,</span>&nbsp;<span class="builtintype" id="3014000">error</span><span class="op" id="3014005">)</span>&nbsp;<span class="op" id="3014007">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014010">fd</span><span class="op" id="3014012">,</span>&nbsp;<span class="ident" id="3014014">err</span>&nbsp;<span class="op" id="3014018">:=</span>&nbsp;<span class="ident" id="3014021">dupCloseOnExec</span><span class="op" id="3014035">(</span><span class="builtintype" id="3014036">int</span><span class="op" id="3014039">(</span><span class="ident" id="3014040">f</span><span class="op" id="3014041">.</span><span class="ident" id="3014042">Fd</span><span class="op" id="3014044">(</span><span class="op" id="3014045">)</span><span class="op" id="3014046">)</span><span class="op" id="3014047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014050">if</span>&nbsp;<span class="ident" id="3014053">err</span>&nbsp;<span class="op" id="3014057">!=</span>&nbsp;<span class="ident" id="3014060">nil</span>&nbsp;<span class="op" id="3014064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014068">return</span>&nbsp;<span class="ident" id="3014075">nil</span><span class="op" id="3014078">,</span>&nbsp;<span class="ident" id="3014080">os</span><span class="op" id="3014082">.</span><span class="ident" id="3014083">NewSyscallError</span><span class="op" id="3014098">(</span><span class="string" id="3014099">&#34;dup&#34;</span><span class="op" id="3014104">,</span>&nbsp;<span class="ident" id="3014106">err</span><span class="op" id="3014109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014116">if</span>&nbsp;<span class="ident" id="3014119">err</span>&nbsp;<span class="op" id="3014123">=</span>&nbsp;<span class="ident" id="3014125">syscall</span><span class="op" id="3014132">.</span><span class="ident" id="3014133">SetNonblock</span><span class="op" id="3014144">(</span><span class="ident" id="3014145">fd</span><span class="op" id="3014147">,</span>&nbsp;<span class="builtintype" id="3014149">true</span><span class="op" id="3014153">)</span><span class="op" id="3014154">;</span>&nbsp;<span class="ident" id="3014156">err</span>&nbsp;<span class="op" id="3014160">!=</span>&nbsp;<span class="ident" id="3014163">nil</span>&nbsp;<span class="op" id="3014167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014171">closesocket</span><span class="op" id="3014182">(</span><span class="ident" id="3014183">fd</span><span class="op" id="3014185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014189">return</span>&nbsp;<span class="ident" id="3014196">nil</span><span class="op" id="3014199">,</span>&nbsp;<span class="ident" id="3014201">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014210">sotype</span><span class="op" id="3014216">,</span>&nbsp;<span class="ident" id="3014218">err</span>&nbsp;<span class="op" id="3014222">:=</span>&nbsp;<span class="ident" id="3014225">syscall</span><span class="op" id="3014232">.</span><span class="ident" id="3014233">GetsockoptInt</span><span class="op" id="3014246">(</span><span class="ident" id="3014247">fd</span><span class="op" id="3014249">,</span>&nbsp;<span class="ident" id="3014251">syscall</span><span class="op" id="3014258">.</span><span class="ident" id="3014259">SOL_SOCKET</span><span class="op" id="3014269">,</span>&nbsp;<span class="ident" id="3014271">syscall</span><span class="op" id="3014278">.</span><span class="ident" id="3014279">SO_TYPE</span><span class="op" id="3014286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014289">if</span>&nbsp;<span class="ident" id="3014292">err</span>&nbsp;<span class="op" id="3014296">!=</span>&nbsp;<span class="ident" id="3014299">nil</span>&nbsp;<span class="op" id="3014303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014307">closesocket</span><span class="op" id="3014318">(</span><span class="ident" id="3014319">fd</span><span class="op" id="3014321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014325">return</span>&nbsp;<span class="ident" id="3014332">nil</span><span class="op" id="3014335">,</span>&nbsp;<span class="ident" id="3014337">os</span><span class="op" id="3014339">.</span><span class="ident" id="3014340">NewSyscallError</span><span class="op" id="3014355">(</span><span class="string" id="3014356">&#34;getsockopt&#34;</span><span class="op" id="3014368">,</span>&nbsp;<span class="ident" id="3014370">err</span><span class="op" id="3014373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014376">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014380">family</span>&nbsp;<span class="op" id="3014387">:=</span>&nbsp;<span class="ident" id="3014390">syscall</span><span class="op" id="3014397">.</span><span class="ident" id="3014398">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014409">toAddr</span>&nbsp;<span class="op" id="3014416">:=</span>&nbsp;<span class="ident" id="3014419">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014434">lsa</span><span class="op" id="3014437">,</span>&nbsp;<span class="ident" id="3014439">_</span>&nbsp;<span class="op" id="3014441">:=</span>&nbsp;<span class="ident" id="3014444">syscall</span><span class="op" id="3014451">.</span><span class="ident" id="3014452">Getsockname</span><span class="op" id="3014463">(</span><span class="ident" id="3014464">fd</span><span class="op" id="3014466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014469">switch</span>&nbsp;<span class="ident" id="3014476">lsa</span><span class="op" id="3014479">.</span><span class="op" id="3014480">(</span><span class="keyword" id="3014481">type</span><span class="op" id="3014485">)</span>&nbsp;<span class="op" id="3014487">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014490">default</span><span class="op" id="3014497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014501">closesocket</span><span class="op" id="3014512">(</span><span class="ident" id="3014513">fd</span><span class="op" id="3014515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014519">return</span>&nbsp;<span class="ident" id="3014526">nil</span><span class="op" id="3014529">,</span>&nbsp;<span class="ident" id="3014531">syscall</span><span class="op" id="3014538">.</span><span class="ident" id="3014539">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014547">case</span>&nbsp;<span class="op" id="3014552">*</span><span class="ident" id="3014553">syscall</span><span class="op" id="3014560">.</span><span class="ident" id="3014561">SockaddrInet4</span><span class="op" id="3014574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014578">family</span>&nbsp;<span class="op" id="3014585">=</span>&nbsp;<span class="ident" id="3014587">syscall</span><span class="op" id="3014594">.</span><span class="ident" id="3014595">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014605">if</span>&nbsp;<span class="ident" id="3014608">sotype</span>&nbsp;<span class="op" id="3014615">==</span>&nbsp;<span class="ident" id="3014618">syscall</span><span class="op" id="3014625">.</span><span class="ident" id="3014626">SOCK_DGRAM</span>&nbsp;<span class="op" id="3014637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014642">toAddr</span>&nbsp;<span class="op" id="3014649">=</span>&nbsp;<span class="ident" id="3014651">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014667">}</span>&nbsp;<span class="keyword" id="3014669">else</span>&nbsp;<span class="keyword" id="3014674">if</span>&nbsp;<span class="ident" id="3014677">sotype</span>&nbsp;<span class="op" id="3014684">==</span>&nbsp;<span class="ident" id="3014687">syscall</span><span class="op" id="3014694">.</span><span class="ident" id="3014695">SOCK_RAW</span>&nbsp;<span class="op" id="3014704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014709">toAddr</span>&nbsp;<span class="op" id="3014716">=</span>&nbsp;<span class="ident" id="3014718">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014733">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014736">case</span>&nbsp;<span class="op" id="3014741">*</span><span class="ident" id="3014742">syscall</span><span class="op" id="3014749">.</span><span class="ident" id="3014750">SockaddrInet6</span><span class="op" id="3014763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014767">family</span>&nbsp;<span class="op" id="3014774">=</span>&nbsp;<span class="ident" id="3014776">syscall</span><span class="op" id="3014783">.</span><span class="ident" id="3014784">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014795">if</span>&nbsp;<span class="ident" id="3014798">sotype</span>&nbsp;<span class="op" id="3014805">==</span>&nbsp;<span class="ident" id="3014808">syscall</span><span class="op" id="3014815">.</span><span class="ident" id="3014816">SOCK_DGRAM</span>&nbsp;<span class="op" id="3014827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014832">toAddr</span>&nbsp;<span class="op" id="3014839">=</span>&nbsp;<span class="ident" id="3014841">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014857">}</span>&nbsp;<span class="keyword" id="3014859">else</span>&nbsp;<span class="keyword" id="3014864">if</span>&nbsp;<span class="ident" id="3014867">sotype</span>&nbsp;<span class="op" id="3014874">==</span>&nbsp;<span class="ident" id="3014877">syscall</span><span class="op" id="3014884">.</span><span class="ident" id="3014885">SOCK_RAW</span>&nbsp;<span class="op" id="3014894">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014899">toAddr</span>&nbsp;<span class="op" id="3014906">=</span>&nbsp;<span class="ident" id="3014908">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3014923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3014926">case</span>&nbsp;<span class="op" id="3014931">*</span><span class="ident" id="3014932">syscall</span><span class="op" id="3014939">.</span><span class="ident" id="3014940">SockaddrUnix</span><span class="op" id="3014952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014956">family</span>&nbsp;<span class="op" id="3014963">=</span>&nbsp;<span class="ident" id="3014965">syscall</span><span class="op" id="3014972">.</span><span class="ident" id="3014973">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3014983">toAddr</span>&nbsp;<span class="op" id="3014990">=</span>&nbsp;<span class="ident" id="3014992">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015009">if</span>&nbsp;<span class="ident" id="3015012">sotype</span>&nbsp;<span class="op" id="3015019">==</span>&nbsp;<span class="ident" id="3015022">syscall</span><span class="op" id="3015029">.</span><span class="ident" id="3015030">SOCK_DGRAM</span>&nbsp;<span class="op" id="3015041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015046">toAddr</span>&nbsp;<span class="op" id="3015053">=</span>&nbsp;<span class="ident" id="3015055">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015076">}</span>&nbsp;<span class="keyword" id="3015078">else</span>&nbsp;<span class="keyword" id="3015083">if</span>&nbsp;<span class="ident" id="3015086">sotype</span>&nbsp;<span class="op" id="3015093">==</span>&nbsp;<span class="ident" id="3015096">syscall</span><span class="op" id="3015103">.</span><span class="ident" id="3015104">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3015119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015124">toAddr</span>&nbsp;<span class="op" id="3015131">=</span>&nbsp;<span class="ident" id="3015133">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015156">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015162">laddr</span>&nbsp;<span class="op" id="3015168">:=</span>&nbsp;<span class="ident" id="3015171">toAddr</span><span class="op" id="3015177">(</span><span class="ident" id="3015178">lsa</span><span class="op" id="3015181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015184">rsa</span><span class="op" id="3015187">,</span>&nbsp;<span class="ident" id="3015189">_</span>&nbsp;<span class="op" id="3015191">:=</span>&nbsp;<span class="ident" id="3015194">syscall</span><span class="op" id="3015201">.</span><span class="ident" id="3015202">Getpeername</span><span class="op" id="3015213">(</span><span class="ident" id="3015214">fd</span><span class="op" id="3015216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015219">raddr</span>&nbsp;<span class="op" id="3015225">:=</span>&nbsp;<span class="ident" id="3015228">toAddr</span><span class="op" id="3015234">(</span><span class="ident" id="3015235">rsa</span><span class="op" id="3015238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015242">netfd</span><span class="op" id="3015247">,</span>&nbsp;<span class="ident" id="3015249">err</span>&nbsp;<span class="op" id="3015253">:=</span>&nbsp;<span class="ident" id="3015256">newFD</span><span class="op" id="3015261">(</span><span class="ident" id="3015262">fd</span><span class="op" id="3015264">,</span>&nbsp;<span class="ident" id="3015266">family</span><span class="op" id="3015272">,</span>&nbsp;<span class="ident" id="3015274">sotype</span><span class="op" id="3015280">,</span>&nbsp;<span class="ident" id="3015282">laddr</span><span class="op" id="3015287">.</span><span class="ident" id="3015288">Network</span><span class="op" id="3015295">(</span><span class="op" id="3015296">)</span><span class="op" id="3015297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015300">if</span>&nbsp;<span class="ident" id="3015303">err</span>&nbsp;<span class="op" id="3015307">!=</span>&nbsp;<span class="ident" id="3015310">nil</span>&nbsp;<span class="op" id="3015314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015318">closesocket</span><span class="op" id="3015329">(</span><span class="ident" id="3015330">fd</span><span class="op" id="3015332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015336">return</span>&nbsp;<span class="ident" id="3015343">nil</span><span class="op" id="3015346">,</span>&nbsp;<span class="ident" id="3015348">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015353">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015356">if</span>&nbsp;<span class="ident" id="3015359">err</span>&nbsp;<span class="op" id="3015363">:=</span>&nbsp;<span class="ident" id="3015366">netfd</span><span class="op" id="3015371">.</span><span class="ident" id="3015372">init</span><span class="op" id="3015376">(</span><span class="op" id="3015377">)</span><span class="op" id="3015378">;</span>&nbsp;<span class="ident" id="3015380">err</span>&nbsp;<span class="op" id="3015384">!=</span>&nbsp;<span class="ident" id="3015387">nil</span>&nbsp;<span class="op" id="3015391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015395">netfd</span><span class="op" id="3015400">.</span><span class="ident" id="3015401">Close</span><span class="op" id="3015406">(</span><span class="op" id="3015407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015411">return</span>&nbsp;<span class="ident" id="3015418">nil</span><span class="op" id="3015421">,</span>&nbsp;<span class="ident" id="3015423">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015431">netfd</span><span class="op" id="3015436">.</span><span class="ident" id="3015437">setAddr</span><span class="op" id="3015444">(</span><span class="ident" id="3015445">laddr</span><span class="op" id="3015450">,</span>&nbsp;<span class="ident" id="3015452">raddr</span><span class="op" id="3015457">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015460">return</span>&nbsp;<span class="ident" id="3015467">netfd</span><span class="op" id="3015472">,</span>&nbsp;<span class="ident" id="3015474">nil</span><br>
<span class="lineno"></span><span class="op" id="3015478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3015481">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3015551">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3015622">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3015688">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3015701">func</span>&nbsp;<span class="ident" id="3015706">FileConn</span><span class="op" id="3015714">(</span><span class="ident" id="3015715">f</span>&nbsp;<span class="op" id="3015717">*</span><span class="ident" id="3015718">os</span><span class="op" id="3015720">.</span><span class="ident" id="3015721">File</span><span class="op" id="3015725">)</span>&nbsp;<span class="op" id="3015727">(</span><span class="ident" id="3015728">c</span>&nbsp;<span class="ident" id="3015730">Conn</span><span class="op" id="3015734">,</span>&nbsp;<span class="ident" id="3015736">err</span>&nbsp;<span class="builtintype" id="3015740">error</span><span class="op" id="3015745">)</span>&nbsp;<span class="op" id="3015747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3015750">fd</span><span class="op" id="3015752">,</span>&nbsp;<span class="ident" id="3015754">err</span>&nbsp;<span class="op" id="3015758">:=</span>&nbsp;<span class="ident" id="3015761">newFileFD</span><span class="op" id="3015770">(</span><span class="ident" id="3015771">f</span><span class="op" id="3015772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015775">if</span>&nbsp;<span class="ident" id="3015778">err</span>&nbsp;<span class="op" id="3015782">!=</span>&nbsp;<span class="ident" id="3015785">nil</span>&nbsp;<span class="op" id="3015789">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015793">return</span>&nbsp;<span class="ident" id="3015800">nil</span><span class="op" id="3015803">,</span>&nbsp;<span class="ident" id="3015805">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3015810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015813">switch</span>&nbsp;<span class="ident" id="3015820">fd</span><span class="op" id="3015822">.</span><span class="ident" id="3015823">laddr</span><span class="op" id="3015828">.</span><span class="op" id="3015829">(</span><span class="keyword" id="3015830">type</span><span class="op" id="3015834">)</span>&nbsp;<span class="op" id="3015836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015839">case</span>&nbsp;<span class="op" id="3015844">*</span><span class="ident" id="3015845">TCPAddr</span><span class="op" id="3015852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015856">return</span>&nbsp;<span class="ident" id="3015863">newTCPConn</span><span class="op" id="3015873">(</span><span class="ident" id="3015874">fd</span><span class="op" id="3015876">)</span><span class="op" id="3015877">,</span>&nbsp;<span class="ident" id="3015879">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015884">case</span>&nbsp;<span class="op" id="3015889">*</span><span class="ident" id="3015890">UDPAddr</span><span class="op" id="3015897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015901">return</span>&nbsp;<span class="ident" id="3015908">newUDPConn</span><span class="op" id="3015918">(</span><span class="ident" id="3015919">fd</span><span class="op" id="3015921">)</span><span class="op" id="3015922">,</span>&nbsp;<span class="ident" id="3015924">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015929">case</span>&nbsp;<span class="op" id="3015934">*</span><span class="ident" id="3015935">IPAddr</span><span class="op" id="3015941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015945">return</span>&nbsp;<span class="ident" id="3015952">newIPConn</span><span class="op" id="3015961">(</span><span class="ident" id="3015962">fd</span><span class="op" id="3015964">)</span><span class="op" id="3015965">,</span>&nbsp;<span class="ident" id="3015967">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015972">case</span>&nbsp;<span class="op" id="3015977">*</span><span class="ident" id="3015978">UnixAddr</span><span class="op" id="3015986">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3015990">return</span>&nbsp;<span class="ident" id="3015997">newUnixConn</span><span class="op" id="3016008">(</span><span class="ident" id="3016009">fd</span><span class="op" id="3016011">)</span><span class="op" id="3016012">,</span>&nbsp;<span class="ident" id="3016014">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016022">fd</span><span class="op" id="3016024">.</span><span class="ident" id="3016025">Close</span><span class="op" id="3016030">(</span><span class="op" id="3016031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016034">return</span>&nbsp;<span class="ident" id="3016041">nil</span><span class="op" id="3016044">,</span>&nbsp;<span class="ident" id="3016046">syscall</span><span class="op" id="3016053">.</span><span class="ident" id="3016054">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3016061">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3016064">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3016133">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3016202">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3016273">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3016286">func</span>&nbsp;<span class="ident" id="3016291">FileListener</span><span class="op" id="3016303">(</span><span class="ident" id="3016304">f</span>&nbsp;<span class="op" id="3016306">*</span><span class="ident" id="3016307">os</span><span class="op" id="3016309">.</span><span class="ident" id="3016310">File</span><span class="op" id="3016314">)</span>&nbsp;<span class="op" id="3016316">(</span><span class="ident" id="3016317">l</span>&nbsp;<span class="ident" id="3016319">Listener</span><span class="op" id="3016327">,</span>&nbsp;<span class="ident" id="3016329">err</span>&nbsp;<span class="builtintype" id="3016333">error</span><span class="op" id="3016338">)</span>&nbsp;<span class="op" id="3016340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016343">fd</span><span class="op" id="3016345">,</span>&nbsp;<span class="ident" id="3016347">err</span>&nbsp;<span class="op" id="3016351">:=</span>&nbsp;<span class="ident" id="3016354">newFileFD</span><span class="op" id="3016363">(</span><span class="ident" id="3016364">f</span><span class="op" id="3016365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016368">if</span>&nbsp;<span class="ident" id="3016371">err</span>&nbsp;<span class="op" id="3016375">!=</span>&nbsp;<span class="ident" id="3016378">nil</span>&nbsp;<span class="op" id="3016382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016386">return</span>&nbsp;<span class="ident" id="3016393">nil</span><span class="op" id="3016396">,</span>&nbsp;<span class="ident" id="3016398">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016403">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016406">switch</span>&nbsp;<span class="ident" id="3016413">laddr</span>&nbsp;<span class="op" id="3016419">:=</span>&nbsp;<span class="ident" id="3016422">fd</span><span class="op" id="3016424">.</span><span class="ident" id="3016425">laddr</span><span class="op" id="3016430">.</span><span class="op" id="3016431">(</span><span class="keyword" id="3016432">type</span><span class="op" id="3016436">)</span>&nbsp;<span class="op" id="3016438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016441">case</span>&nbsp;<span class="op" id="3016446">*</span><span class="ident" id="3016447">TCPAddr</span><span class="op" id="3016454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016458">return</span>&nbsp;<span class="op" id="3016465">&amp;</span><span class="ident" id="3016466">TCPListener</span><span class="op" id="3016477">{</span><span class="ident" id="3016478">fd</span><span class="op" id="3016480">}</span><span class="op" id="3016481">,</span>&nbsp;<span class="ident" id="3016483">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016488">case</span>&nbsp;<span class="op" id="3016493">*</span><span class="ident" id="3016494">UnixAddr</span><span class="op" id="3016502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016506">return</span>&nbsp;<span class="op" id="3016513">&amp;</span><span class="ident" id="3016514">UnixListener</span><span class="op" id="3016526">{</span><span class="ident" id="3016527">fd</span><span class="op" id="3016529">,</span>&nbsp;<span class="ident" id="3016531">laddr</span><span class="op" id="3016536">.</span><span class="ident" id="3016537">Name</span><span class="op" id="3016541">}</span><span class="op" id="3016542">,</span>&nbsp;<span class="ident" id="3016544">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016552">fd</span><span class="op" id="3016554">.</span><span class="ident" id="3016555">Close</span><span class="op" id="3016560">(</span><span class="op" id="3016561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016564">return</span>&nbsp;<span class="ident" id="3016571">nil</span><span class="op" id="3016574">,</span>&nbsp;<span class="ident" id="3016576">syscall</span><span class="op" id="3016583">.</span><span class="ident" id="3016584">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3016591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3016594">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3016660">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3016717">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3016788">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3016827">func</span>&nbsp;<span class="ident" id="3016832">FilePacketConn</span><span class="op" id="3016846">(</span><span class="ident" id="3016847">f</span>&nbsp;<span class="op" id="3016849">*</span><span class="ident" id="3016850">os</span><span class="op" id="3016852">.</span><span class="ident" id="3016853">File</span><span class="op" id="3016857">)</span>&nbsp;<span class="op" id="3016859">(</span><span class="ident" id="3016860">c</span>&nbsp;<span class="ident" id="3016862">PacketConn</span><span class="op" id="3016872">,</span>&nbsp;<span class="ident" id="3016874">err</span>&nbsp;<span class="builtintype" id="3016878">error</span><span class="op" id="3016883">)</span>&nbsp;<span class="op" id="3016885">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3016888">fd</span><span class="op" id="3016890">,</span>&nbsp;<span class="ident" id="3016892">err</span>&nbsp;<span class="op" id="3016896">:=</span>&nbsp;<span class="ident" id="3016899">newFileFD</span><span class="op" id="3016908">(</span><span class="ident" id="3016909">f</span><span class="op" id="3016910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016913">if</span>&nbsp;<span class="ident" id="3016916">err</span>&nbsp;<span class="op" id="3016920">!=</span>&nbsp;<span class="ident" id="3016923">nil</span>&nbsp;<span class="op" id="3016927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016931">return</span>&nbsp;<span class="ident" id="3016938">nil</span><span class="op" id="3016941">,</span>&nbsp;<span class="ident" id="3016943">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3016948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016951">switch</span>&nbsp;<span class="ident" id="3016958">fd</span><span class="op" id="3016960">.</span><span class="ident" id="3016961">laddr</span><span class="op" id="3016966">.</span><span class="op" id="3016967">(</span><span class="keyword" id="3016968">type</span><span class="op" id="3016972">)</span>&nbsp;<span class="op" id="3016974">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016977">case</span>&nbsp;<span class="op" id="3016982">*</span><span class="ident" id="3016983">UDPAddr</span><span class="op" id="3016990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3016994">return</span>&nbsp;<span class="ident" id="3017001">newUDPConn</span><span class="op" id="3017011">(</span><span class="ident" id="3017012">fd</span><span class="op" id="3017014">)</span><span class="op" id="3017015">,</span>&nbsp;<span class="ident" id="3017017">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017022">case</span>&nbsp;<span class="op" id="3017027">*</span><span class="ident" id="3017028">IPAddr</span><span class="op" id="3017034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017038">return</span>&nbsp;<span class="ident" id="3017045">newIPConn</span><span class="op" id="3017054">(</span><span class="ident" id="3017055">fd</span><span class="op" id="3017057">)</span><span class="op" id="3017058">,</span>&nbsp;<span class="ident" id="3017060">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017065">case</span>&nbsp;<span class="op" id="3017070">*</span><span class="ident" id="3017071">UnixAddr</span><span class="op" id="3017079">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017083">return</span>&nbsp;<span class="ident" id="3017090">newUnixConn</span><span class="op" id="3017101">(</span><span class="ident" id="3017102">fd</span><span class="op" id="3017104">)</span><span class="op" id="3017105">,</span>&nbsp;<span class="ident" id="3017107">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3017112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3017115">fd</span><span class="op" id="3017117">.</span><span class="ident" id="3017118">Close</span><span class="op" id="3017123">(</span><span class="op" id="3017124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3017127">return</span>&nbsp;<span class="ident" id="3017134">nil</span><span class="op" id="3017137">,</span>&nbsp;<span class="ident" id="3017139">syscall</span><span class="op" id="3017146">.</span><span class="ident" id="3017147">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3017154">}</span>
</div>
</body>
</html>
