<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6486494">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6486549">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6486603">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6486654">package</span>&nbsp;<span class="ident" id="6486662">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6486672">import</span>&nbsp;<span class="op" id="6486679">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6486682">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6486695">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6486707">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6486717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6486720">func</span>&nbsp;<span class="ident" id="6486725">TestServer</span><span class="op" id="6486735">(</span><span class="ident" id="6486736">t</span>&nbsp;<span class="op" id="6486738">*</span><span class="ident" id="6486739">testing</span><span class="op" id="6486746">.</span><span class="ident" id="6486747">T</span><span class="op" id="6486748">)</span>&nbsp;<span class="op" id="6486750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486753">ts</span>&nbsp;<span class="op" id="6486756">:=</span>&nbsp;<span class="ident" id="6486759">NewServer</span><span class="op" id="6486768">(</span><span class="ident" id="6486769">http</span><span class="op" id="6486773">.</span><span class="ident" id="6486774">HandlerFunc</span><span class="op" id="6486785">(</span><span class="keyword" id="6486786">func</span><span class="op" id="6486790">(</span><span class="ident" id="6486791">w</span>&nbsp;<span class="ident" id="6486793">http</span><span class="op" id="6486797">.</span><span class="ident" id="6486798">ResponseWriter</span><span class="op" id="6486812">,</span>&nbsp;<span class="ident" id="6486814">r</span>&nbsp;<span class="op" id="6486816">*</span><span class="ident" id="6486817">http</span><span class="op" id="6486821">.</span><span class="ident" id="6486822">Request</span><span class="op" id="6486829">)</span>&nbsp;<span class="op" id="6486831">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486835">w</span><span class="op" id="6486836">.</span><span class="ident" id="6486837">Write</span><span class="op" id="6486842">(</span><span class="op" id="6486843">[</span><span class="op" id="6486844">]</span><span class="builtintype" id="6486845">byte</span><span class="op" id="6486849">(</span><span class="string" id="6486850">&#34;hello&#34;</span><span class="op" id="6486857">)</span><span class="op" id="6486858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486861">}</span><span class="op" id="6486862">)</span><span class="op" id="6486863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486866">defer</span>&nbsp;<span class="ident" id="6486872">ts</span><span class="op" id="6486874">.</span><span class="ident" id="6486875">Close</span><span class="op" id="6486880">(</span><span class="op" id="6486881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486884">res</span><span class="op" id="6486887">,</span>&nbsp;<span class="ident" id="6486889">err</span>&nbsp;<span class="op" id="6486893">:=</span>&nbsp;<span class="ident" id="6486896">http</span><span class="op" id="6486900">.</span><span class="ident" id="6486901">Get</span><span class="op" id="6486904">(</span><span class="ident" id="6486905">ts</span><span class="op" id="6486907">.</span><span class="ident" id="6486908">URL</span><span class="op" id="6486911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486914">if</span>&nbsp;<span class="ident" id="6486917">err</span>&nbsp;<span class="op" id="6486921">!=</span>&nbsp;<span class="ident" id="6486924">nil</span>&nbsp;<span class="op" id="6486928">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486932">t</span><span class="op" id="6486933">.</span><span class="ident" id="6486934">Fatal</span><span class="op" id="6486939">(</span><span class="ident" id="6486940">err</span><span class="op" id="6486943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6486946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6486949">got</span><span class="op" id="6486952">,</span>&nbsp;<span class="ident" id="6486954">err</span>&nbsp;<span class="op" id="6486958">:=</span>&nbsp;<span class="ident" id="6486961">ioutil</span><span class="op" id="6486967">.</span><span class="ident" id="6486968">ReadAll</span><span class="op" id="6486975">(</span><span class="ident" id="6486976">res</span><span class="op" id="6486979">.</span><span class="ident" id="6486980">Body</span><span class="op" id="6486984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6486987">if</span>&nbsp;<span class="ident" id="6486990">err</span>&nbsp;<span class="op" id="6486994">!=</span>&nbsp;<span class="ident" id="6486997">nil</span>&nbsp;<span class="op" id="6487001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487005">t</span><span class="op" id="6487006">.</span><span class="ident" id="6487007">Fatal</span><span class="op" id="6487012">(</span><span class="ident" id="6487013">err</span><span class="op" id="6487016">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6487022">if</span>&nbsp;<span class="builtintype" id="6487025">string</span><span class="op" id="6487031">(</span><span class="ident" id="6487032">got</span><span class="op" id="6487035">)</span>&nbsp;<span class="op" id="6487037">!=</span>&nbsp;<span class="string" id="6487040">&#34;hello&#34;</span>&nbsp;<span class="op" id="6487048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6487052">t</span><span class="op" id="6487053">.</span><span class="ident" id="6487054">Errorf</span><span class="op" id="6487060">(</span><span class="string" id="6487061">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="6487081">,</span>&nbsp;<span class="builtintype" id="6487083">string</span><span class="op" id="6487089">(</span><span class="ident" id="6487090">got</span><span class="op" id="6487093">)</span><span class="op" id="6487094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6487097">}</span><br>
<span class="lineno"></span><span class="op" id="6487099">}</span>
</div>
</body>
</html>
