<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3423659">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3423715">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3423769">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3423820">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3423896">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3423949">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3423964">package</span>&nbsp;<span class="ident" id="3423972">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3423978">import</span>&nbsp;<span class="op" id="3423985">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3423988">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3423997">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424011">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424028">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424034">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424040">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424051">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3424059">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3424066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3424069">const</span>&nbsp;<span class="ident" id="3424075">urandomDevice</span>&nbsp;<span class="op" id="3424089">=</span>&nbsp;<span class="string" id="3424091">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3424107">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="3424155">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3424207">func</span>&nbsp;<span class="ident" id="3424212">init</span><span class="op" id="3424216">(</span><span class="op" id="3424217">)</span>&nbsp;<span class="op" id="3424219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424222">if</span>&nbsp;<span class="ident" id="3424225">runtime</span><span class="op" id="3424232">.</span><span class="ident" id="3424233">GOOS</span>&nbsp;<span class="op" id="3424238">==</span>&nbsp;<span class="string" id="3424241">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3424249">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424253">Reader</span>&nbsp;<span class="op" id="3424260">=</span>&nbsp;<span class="ident" id="3424262">newReader</span><span class="op" id="3424271">(</span><span class="ident" id="3424272">nil</span><span class="op" id="3424275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424278">}</span>&nbsp;<span class="keyword" id="3424280">else</span>&nbsp;<span class="op" id="3424285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424289">Reader</span>&nbsp;<span class="op" id="3424296">=</span>&nbsp;<span class="op" id="3424298">&amp;</span><span class="ident" id="3424299">devReader</span><span class="op" id="3424308">{</span><span class="ident" id="3424309">name</span><span class="op" id="3424313">:</span>&nbsp;<span class="ident" id="3424315">urandomDevice</span><span class="op" id="3424328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424331">}</span><br>
<span class="lineno"></span><span class="op" id="3424333">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3424336">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3424399">type</span>&nbsp;<span class="ident" id="3424404">devReader</span>&nbsp;<span class="keyword" id="3424414">struct</span>&nbsp;<span class="op" id="3424421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424424">name</span>&nbsp;<span class="builtintype" id="3424429">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424437">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424442">io</span><span class="op" id="3424444">.</span><span class="ident" id="3424445">Reader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424453">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3424458">sync</span><span class="op" id="3424462">.</span><span class="ident" id="3424463">Mutex</span><br>
<span class="lineno"></span><span class="op" id="3424469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3424472">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="3424540">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="3424569">var</span>&nbsp;<span class="ident" id="3424573">altGetRandom</span>&nbsp;<span class="keyword" id="3424586">func</span><span class="op" id="3424590">(</span><span class="op" id="3424591">[</span><span class="op" id="3424592">]</span><span class="builtintype" id="3424593">byte</span><span class="op" id="3424597">)</span>&nbsp;<span class="op" id="3424599">(</span><span class="ident" id="3424600">ok</span>&nbsp;<span class="builtintype" id="3424603">bool</span><span class="op" id="3424607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3424610">func</span>&nbsp;<span class="op" id="3424615">(</span><span class="ident" id="3424616">r</span>&nbsp;<span class="op" id="3424618">*</span><span class="ident" id="3424619">devReader</span><span class="op" id="3424628">)</span>&nbsp;<span class="ident" id="3424630">Read</span><span class="op" id="3424634">(</span><span class="ident" id="3424635">b</span>&nbsp;<span class="op" id="3424637">[</span><span class="op" id="3424638">]</span><span class="builtintype" id="3424639">byte</span><span class="op" id="3424643">)</span>&nbsp;<span class="op" id="3424645">(</span><span class="ident" id="3424646">n</span>&nbsp;<span class="builtintype" id="3424648">int</span><span class="op" id="3424651">,</span>&nbsp;<span class="ident" id="3424653">err</span>&nbsp;<span class="builtintype" id="3424657">error</span><span class="op" id="3424662">)</span>&nbsp;<span class="op" id="3424664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424667">if</span>&nbsp;<span class="ident" id="3424670">altGetRandom</span>&nbsp;<span class="op" id="3424683">!=</span>&nbsp;<span class="ident" id="3424686">nil</span>&nbsp;<span class="op" id="3424690">&amp;&amp;</span>&nbsp;<span class="ident" id="3424693">r</span><span class="op" id="3424694">.</span><span class="ident" id="3424695">name</span>&nbsp;<span class="op" id="3424700">==</span>&nbsp;<span class="ident" id="3424703">urandomDevice</span>&nbsp;<span class="op" id="3424717">&amp;&amp;</span>&nbsp;<span class="ident" id="3424720">altGetRandom</span><span class="op" id="3424732">(</span><span class="ident" id="3424733">b</span><span class="op" id="3424734">)</span>&nbsp;<span class="op" id="3424736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424740">return</span>&nbsp;<span class="builtinfunc" id="3424747">len</span><span class="op" id="3424750">(</span><span class="ident" id="3424751">b</span><span class="op" id="3424752">)</span><span class="op" id="3424753">,</span>&nbsp;<span class="ident" id="3424755">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424763">r</span><span class="op" id="3424764">.</span><span class="ident" id="3424765">mu</span><span class="op" id="3424767">.</span><span class="ident" id="3424768">Lock</span><span class="op" id="3424772">(</span><span class="op" id="3424773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424776">defer</span>&nbsp;<span class="ident" id="3424782">r</span><span class="op" id="3424783">.</span><span class="ident" id="3424784">mu</span><span class="op" id="3424786">.</span><span class="ident" id="3424787">Unlock</span><span class="op" id="3424793">(</span><span class="op" id="3424794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424797">if</span>&nbsp;<span class="ident" id="3424800">r</span><span class="op" id="3424801">.</span><span class="ident" id="3424802">f</span>&nbsp;<span class="op" id="3424804">==</span>&nbsp;<span class="ident" id="3424807">nil</span>&nbsp;<span class="op" id="3424811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424815">f</span><span class="op" id="3424816">,</span>&nbsp;<span class="ident" id="3424818">err</span>&nbsp;<span class="op" id="3424822">:=</span>&nbsp;<span class="ident" id="3424825">os</span><span class="op" id="3424827">.</span><span class="ident" id="3424828">Open</span><span class="op" id="3424832">(</span><span class="ident" id="3424833">r</span><span class="op" id="3424834">.</span><span class="ident" id="3424835">name</span><span class="op" id="3424839">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424843">if</span>&nbsp;<span class="ident" id="3424846">f</span>&nbsp;<span class="op" id="3424848">==</span>&nbsp;<span class="ident" id="3424851">nil</span>&nbsp;<span class="op" id="3424855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424860">return</span>&nbsp;<span class="num" id="3424867">0</span><span class="op" id="3424868">,</span>&nbsp;<span class="ident" id="3424870">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424880">if</span>&nbsp;<span class="ident" id="3424883">runtime</span><span class="op" id="3424890">.</span><span class="ident" id="3424891">GOOS</span>&nbsp;<span class="op" id="3424896">==</span>&nbsp;<span class="string" id="3424899">&#34;plan9&#34;</span>&nbsp;<span class="op" id="3424907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424912">r</span><span class="op" id="3424913">.</span><span class="ident" id="3424914">f</span>&nbsp;<span class="op" id="3424916">=</span>&nbsp;<span class="ident" id="3424918">f</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424922">}</span>&nbsp;<span class="keyword" id="3424924">else</span>&nbsp;<span class="op" id="3424929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424934">r</span><span class="op" id="3424935">.</span><span class="ident" id="3424936">f</span>&nbsp;<span class="op" id="3424938">=</span>&nbsp;<span class="ident" id="3424940">bufio</span><span class="op" id="3424945">.</span><span class="ident" id="3424946">NewReader</span><span class="op" id="3424955">(</span><span class="ident" id="3424956">f</span><span class="op" id="3424957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424967">return</span>&nbsp;<span class="ident" id="3424974">r</span><span class="op" id="3424975">.</span><span class="ident" id="3424976">f</span><span class="op" id="3424977">.</span><span class="ident" id="3424978">Read</span><span class="op" id="3424982">(</span><span class="ident" id="3424983">b</span><span class="op" id="3424984">)</span><br>
<span class="lineno">65</span><span class="op" id="3424986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3424989">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3425042">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3425087">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3425142">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="3425203">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3425262">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="3425313">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="3425370">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3425429">//</span><br>
<span class="lineno"></span><span class="comment" id="3425432">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="3425488">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3425537">func</span>&nbsp;<span class="ident" id="3425542">newReader</span><span class="op" id="3425551">(</span><span class="ident" id="3425552">entropy</span>&nbsp;<span class="ident" id="3425560">io</span><span class="op" id="3425562">.</span><span class="ident" id="3425563">Reader</span><span class="op" id="3425569">)</span>&nbsp;<span class="ident" id="3425571">io</span><span class="op" id="3425573">.</span><span class="ident" id="3425574">Reader</span>&nbsp;<span class="op" id="3425581">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425584">if</span>&nbsp;<span class="ident" id="3425587">entropy</span>&nbsp;<span class="op" id="3425595">==</span>&nbsp;<span class="ident" id="3425598">nil</span>&nbsp;<span class="op" id="3425602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425606">entropy</span>&nbsp;<span class="op" id="3425614">=</span>&nbsp;<span class="op" id="3425616">&amp;</span><span class="ident" id="3425617">devReader</span><span class="op" id="3425626">{</span><span class="ident" id="3425627">name</span><span class="op" id="3425631">:</span>&nbsp;<span class="string" id="3425633">&#34;/dev/random&#34;</span><span class="op" id="3425646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425652">return</span>&nbsp;<span class="op" id="3425659">&amp;</span><span class="ident" id="3425660">reader</span><span class="op" id="3425666">{</span><span class="ident" id="3425667">entropy</span><span class="op" id="3425674">:</span>&nbsp;<span class="ident" id="3425676">entropy</span><span class="op" id="3425683">}</span><br>
<span class="lineno"></span><span class="op" id="3425685">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="3425688">type</span>&nbsp;<span class="ident" id="3425693">reader</span>&nbsp;<span class="keyword" id="3425700">struct</span>&nbsp;<span class="op" id="3425707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425710">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425731">sync</span><span class="op" id="3425735">.</span><span class="ident" id="3425736">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425743">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3425764">int</span>&nbsp;<span class="comment" id="3425768">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425810">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425831">cipher</span><span class="op" id="3425837">.</span><span class="ident" id="3425838">Block</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425845">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425866">io</span><span class="op" id="3425868">.</span><span class="ident" id="3425869">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425877">time</span><span class="op" id="3425881">,</span>&nbsp;<span class="ident" id="3425883">seed</span><span class="op" id="3425887">,</span>&nbsp;<span class="ident" id="3425889">dst</span><span class="op" id="3425892">,</span>&nbsp;<span class="ident" id="3425894">key</span>&nbsp;<span class="op" id="3425898">[</span><span class="ident" id="3425899">aes</span><span class="op" id="3425902">.</span><span class="ident" id="3425903">BlockSize</span><span class="op" id="3425912">]</span><span class="builtintype" id="3425913">byte</span><br>
<span class="lineno"></span><span class="op" id="3425918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3425921">func</span>&nbsp;<span class="op" id="3425926">(</span><span class="ident" id="3425927">r</span>&nbsp;<span class="op" id="3425929">*</span><span class="ident" id="3425930">reader</span><span class="op" id="3425936">)</span>&nbsp;<span class="ident" id="3425938">Read</span><span class="op" id="3425942">(</span><span class="ident" id="3425943">b</span>&nbsp;<span class="op" id="3425945">[</span><span class="op" id="3425946">]</span><span class="builtintype" id="3425947">byte</span><span class="op" id="3425951">)</span>&nbsp;<span class="op" id="3425953">(</span><span class="ident" id="3425954">n</span>&nbsp;<span class="builtintype" id="3425956">int</span><span class="op" id="3425959">,</span>&nbsp;<span class="ident" id="3425961">err</span>&nbsp;<span class="builtintype" id="3425965">error</span><span class="op" id="3425970">)</span>&nbsp;<span class="op" id="3425972">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425975">r</span><span class="op" id="3425976">.</span><span class="ident" id="3425977">mu</span><span class="op" id="3425979">.</span><span class="ident" id="3425980">Lock</span><span class="op" id="3425984">(</span><span class="op" id="3425985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425988">defer</span>&nbsp;<span class="ident" id="3425994">r</span><span class="op" id="3425995">.</span><span class="ident" id="3425996">mu</span><span class="op" id="3425998">.</span><span class="ident" id="3425999">Unlock</span><span class="op" id="3426005">(</span><span class="op" id="3426006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426009">n</span>&nbsp;<span class="op" id="3426011">=</span>&nbsp;<span class="builtinfunc" id="3426013">len</span><span class="op" id="3426016">(</span><span class="ident" id="3426017">b</span><span class="op" id="3426018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426022">for</span>&nbsp;<span class="builtinfunc" id="3426026">len</span><span class="op" id="3426029">(</span><span class="ident" id="3426030">b</span><span class="op" id="3426031">)</span>&nbsp;<span class="op" id="3426033">&gt;</span>&nbsp;<span class="num" id="3426035">0</span>&nbsp;<span class="op" id="3426037">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426041">if</span>&nbsp;<span class="ident" id="3426044">r</span><span class="op" id="3426045">.</span><span class="ident" id="3426046">budget</span>&nbsp;<span class="op" id="3426053">==</span>&nbsp;<span class="num" id="3426056">0</span>&nbsp;<span class="op" id="3426058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426063">_</span><span class="op" id="3426064">,</span>&nbsp;<span class="ident" id="3426066">err</span>&nbsp;<span class="op" id="3426070">:=</span>&nbsp;<span class="ident" id="3426073">io</span><span class="op" id="3426075">.</span><span class="ident" id="3426076">ReadFull</span><span class="op" id="3426084">(</span><span class="ident" id="3426085">r</span><span class="op" id="3426086">.</span><span class="ident" id="3426087">entropy</span><span class="op" id="3426094">,</span>&nbsp;<span class="ident" id="3426096">r</span><span class="op" id="3426097">.</span><span class="ident" id="3426098">seed</span><span class="op" id="3426102">[</span><span class="num" id="3426103">0</span><span class="op" id="3426104">:</span><span class="op" id="3426105">]</span><span class="op" id="3426106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426111">if</span>&nbsp;<span class="ident" id="3426114">err</span>&nbsp;<span class="op" id="3426118">!=</span>&nbsp;<span class="ident" id="3426121">nil</span>&nbsp;<span class="op" id="3426125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426131">return</span>&nbsp;<span class="ident" id="3426138">n</span>&nbsp;<span class="op" id="3426140">-</span>&nbsp;<span class="builtinfunc" id="3426142">len</span><span class="op" id="3426145">(</span><span class="ident" id="3426146">b</span><span class="op" id="3426147">)</span><span class="op" id="3426148">,</span>&nbsp;<span class="ident" id="3426150">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426157">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426162">_</span><span class="op" id="3426163">,</span>&nbsp;<span class="ident" id="3426165">err</span>&nbsp;<span class="op" id="3426169">=</span>&nbsp;<span class="ident" id="3426171">io</span><span class="op" id="3426173">.</span><span class="ident" id="3426174">ReadFull</span><span class="op" id="3426182">(</span><span class="ident" id="3426183">r</span><span class="op" id="3426184">.</span><span class="ident" id="3426185">entropy</span><span class="op" id="3426192">,</span>&nbsp;<span class="ident" id="3426194">r</span><span class="op" id="3426195">.</span><span class="ident" id="3426196">key</span><span class="op" id="3426199">[</span><span class="num" id="3426200">0</span><span class="op" id="3426201">:</span><span class="op" id="3426202">]</span><span class="op" id="3426203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426208">if</span>&nbsp;<span class="ident" id="3426211">err</span>&nbsp;<span class="op" id="3426215">!=</span>&nbsp;<span class="ident" id="3426218">nil</span>&nbsp;<span class="op" id="3426222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426228">return</span>&nbsp;<span class="ident" id="3426235">n</span>&nbsp;<span class="op" id="3426237">-</span>&nbsp;<span class="builtinfunc" id="3426239">len</span><span class="op" id="3426242">(</span><span class="ident" id="3426243">b</span><span class="op" id="3426244">)</span><span class="op" id="3426245">,</span>&nbsp;<span class="ident" id="3426247">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426259">r</span><span class="op" id="3426260">.</span><span class="ident" id="3426261">cipher</span><span class="op" id="3426267">,</span>&nbsp;<span class="ident" id="3426269">err</span>&nbsp;<span class="op" id="3426273">=</span>&nbsp;<span class="ident" id="3426275">aes</span><span class="op" id="3426278">.</span><span class="ident" id="3426279">NewCipher</span><span class="op" id="3426288">(</span><span class="ident" id="3426289">r</span><span class="op" id="3426290">.</span><span class="ident" id="3426291">key</span><span class="op" id="3426294">[</span><span class="num" id="3426295">0</span><span class="op" id="3426296">:</span><span class="op" id="3426297">]</span><span class="op" id="3426298">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426303">if</span>&nbsp;<span class="ident" id="3426306">err</span>&nbsp;<span class="op" id="3426310">!=</span>&nbsp;<span class="ident" id="3426313">nil</span>&nbsp;<span class="op" id="3426317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426323">return</span>&nbsp;<span class="ident" id="3426330">n</span>&nbsp;<span class="op" id="3426332">-</span>&nbsp;<span class="builtinfunc" id="3426334">len</span><span class="op" id="3426337">(</span><span class="ident" id="3426338">b</span><span class="op" id="3426339">)</span><span class="op" id="3426340">,</span>&nbsp;<span class="ident" id="3426342">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426354">r</span><span class="op" id="3426355">.</span><span class="ident" id="3426356">budget</span>&nbsp;<span class="op" id="3426363">=</span>&nbsp;<span class="num" id="3426365">1</span>&nbsp;<span class="op" id="3426367">&lt;&lt;</span>&nbsp;<span class="num" id="3426370">20</span>&nbsp;<span class="comment" id="3426373">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426406">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426410">r</span><span class="op" id="3426411">.</span><span class="ident" id="3426412">budget</span>&nbsp;<span class="op" id="3426419">-=</span>&nbsp;<span class="ident" id="3426422">aes</span><span class="op" id="3426425">.</span><span class="ident" id="3426426">BlockSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426439">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426509">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426514">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426533">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426556">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426583">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426610">ns</span>&nbsp;<span class="op" id="3426613">:=</span>&nbsp;<span class="ident" id="3426616">time</span><span class="op" id="3426620">.</span><span class="ident" id="3426621">Now</span><span class="op" id="3426624">(</span><span class="op" id="3426625">)</span><span class="op" id="3426626">.</span><span class="ident" id="3426627">UnixNano</span><span class="op" id="3426635">(</span><span class="op" id="3426636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426640">r</span><span class="op" id="3426641">.</span><span class="ident" id="3426642">time</span><span class="op" id="3426646">[</span><span class="num" id="3426647">0</span><span class="op" id="3426648">]</span>&nbsp;<span class="op" id="3426650">=</span>&nbsp;<span class="builtintype" id="3426652">byte</span><span class="op" id="3426656">(</span><span class="ident" id="3426657">ns</span>&nbsp;<span class="op" id="3426660">&gt;&gt;</span>&nbsp;<span class="num" id="3426663">56</span><span class="op" id="3426665">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426669">r</span><span class="op" id="3426670">.</span><span class="ident" id="3426671">time</span><span class="op" id="3426675">[</span><span class="num" id="3426676">1</span><span class="op" id="3426677">]</span>&nbsp;<span class="op" id="3426679">=</span>&nbsp;<span class="builtintype" id="3426681">byte</span><span class="op" id="3426685">(</span><span class="ident" id="3426686">ns</span>&nbsp;<span class="op" id="3426689">&gt;&gt;</span>&nbsp;<span class="num" id="3426692">48</span><span class="op" id="3426694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426698">r</span><span class="op" id="3426699">.</span><span class="ident" id="3426700">time</span><span class="op" id="3426704">[</span><span class="num" id="3426705">2</span><span class="op" id="3426706">]</span>&nbsp;<span class="op" id="3426708">=</span>&nbsp;<span class="builtintype" id="3426710">byte</span><span class="op" id="3426714">(</span><span class="ident" id="3426715">ns</span>&nbsp;<span class="op" id="3426718">&gt;&gt;</span>&nbsp;<span class="num" id="3426721">40</span><span class="op" id="3426723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426727">r</span><span class="op" id="3426728">.</span><span class="ident" id="3426729">time</span><span class="op" id="3426733">[</span><span class="num" id="3426734">3</span><span class="op" id="3426735">]</span>&nbsp;<span class="op" id="3426737">=</span>&nbsp;<span class="builtintype" id="3426739">byte</span><span class="op" id="3426743">(</span><span class="ident" id="3426744">ns</span>&nbsp;<span class="op" id="3426747">&gt;&gt;</span>&nbsp;<span class="num" id="3426750">32</span><span class="op" id="3426752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426756">r</span><span class="op" id="3426757">.</span><span class="ident" id="3426758">time</span><span class="op" id="3426762">[</span><span class="num" id="3426763">4</span><span class="op" id="3426764">]</span>&nbsp;<span class="op" id="3426766">=</span>&nbsp;<span class="builtintype" id="3426768">byte</span><span class="op" id="3426772">(</span><span class="ident" id="3426773">ns</span>&nbsp;<span class="op" id="3426776">&gt;&gt;</span>&nbsp;<span class="num" id="3426779">24</span><span class="op" id="3426781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426785">r</span><span class="op" id="3426786">.</span><span class="ident" id="3426787">time</span><span class="op" id="3426791">[</span><span class="num" id="3426792">5</span><span class="op" id="3426793">]</span>&nbsp;<span class="op" id="3426795">=</span>&nbsp;<span class="builtintype" id="3426797">byte</span><span class="op" id="3426801">(</span><span class="ident" id="3426802">ns</span>&nbsp;<span class="op" id="3426805">&gt;&gt;</span>&nbsp;<span class="num" id="3426808">16</span><span class="op" id="3426810">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426814">r</span><span class="op" id="3426815">.</span><span class="ident" id="3426816">time</span><span class="op" id="3426820">[</span><span class="num" id="3426821">6</span><span class="op" id="3426822">]</span>&nbsp;<span class="op" id="3426824">=</span>&nbsp;<span class="builtintype" id="3426826">byte</span><span class="op" id="3426830">(</span><span class="ident" id="3426831">ns</span>&nbsp;<span class="op" id="3426834">&gt;&gt;</span>&nbsp;<span class="num" id="3426837">8</span><span class="op" id="3426838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426842">r</span><span class="op" id="3426843">.</span><span class="ident" id="3426844">time</span><span class="op" id="3426848">[</span><span class="num" id="3426849">7</span><span class="op" id="3426850">]</span>&nbsp;<span class="op" id="3426852">=</span>&nbsp;<span class="builtintype" id="3426854">byte</span><span class="op" id="3426858">(</span><span class="ident" id="3426859">ns</span><span class="op" id="3426861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426865">r</span><span class="op" id="3426866">.</span><span class="ident" id="3426867">cipher</span><span class="op" id="3426873">.</span><span class="ident" id="3426874">Encrypt</span><span class="op" id="3426881">(</span><span class="ident" id="3426882">r</span><span class="op" id="3426883">.</span><span class="ident" id="3426884">time</span><span class="op" id="3426888">[</span><span class="num" id="3426889">0</span><span class="op" id="3426890">:</span><span class="op" id="3426891">]</span><span class="op" id="3426892">,</span>&nbsp;<span class="ident" id="3426894">r</span><span class="op" id="3426895">.</span><span class="ident" id="3426896">time</span><span class="op" id="3426900">[</span><span class="num" id="3426901">0</span><span class="op" id="3426902">:</span><span class="op" id="3426903">]</span><span class="op" id="3426904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426908">for</span>&nbsp;<span class="ident" id="3426912">i</span>&nbsp;<span class="op" id="3426914">:=</span>&nbsp;<span class="num" id="3426917">0</span><span class="op" id="3426918">;</span>&nbsp;<span class="ident" id="3426920">i</span>&nbsp;<span class="op" id="3426922">&lt;</span>&nbsp;<span class="ident" id="3426924">aes</span><span class="op" id="3426927">.</span><span class="ident" id="3426928">BlockSize</span><span class="op" id="3426937">;</span>&nbsp;<span class="ident" id="3426939">i</span><span class="op" id="3426940">++</span>&nbsp;<span class="op" id="3426943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426948">r</span><span class="op" id="3426949">.</span><span class="ident" id="3426950">dst</span><span class="op" id="3426953">[</span><span class="ident" id="3426954">i</span><span class="op" id="3426955">]</span>&nbsp;<span class="op" id="3426957">=</span>&nbsp;<span class="ident" id="3426959">r</span><span class="op" id="3426960">.</span><span class="ident" id="3426961">time</span><span class="op" id="3426965">[</span><span class="ident" id="3426966">i</span><span class="op" id="3426967">]</span>&nbsp;<span class="op" id="3426969">^</span>&nbsp;<span class="ident" id="3426971">r</span><span class="op" id="3426972">.</span><span class="ident" id="3426973">seed</span><span class="op" id="3426977">[</span><span class="ident" id="3426978">i</span><span class="op" id="3426979">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426987">r</span><span class="op" id="3426988">.</span><span class="ident" id="3426989">cipher</span><span class="op" id="3426995">.</span><span class="ident" id="3426996">Encrypt</span><span class="op" id="3427003">(</span><span class="ident" id="3427004">r</span><span class="op" id="3427005">.</span><span class="ident" id="3427006">dst</span><span class="op" id="3427009">[</span><span class="num" id="3427010">0</span><span class="op" id="3427011">:</span><span class="op" id="3427012">]</span><span class="op" id="3427013">,</span>&nbsp;<span class="ident" id="3427015">r</span><span class="op" id="3427016">.</span><span class="ident" id="3427017">dst</span><span class="op" id="3427020">[</span><span class="num" id="3427021">0</span><span class="op" id="3427022">:</span><span class="op" id="3427023">]</span><span class="op" id="3427024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427028">for</span>&nbsp;<span class="ident" id="3427032">i</span>&nbsp;<span class="op" id="3427034">:=</span>&nbsp;<span class="num" id="3427037">0</span><span class="op" id="3427038">;</span>&nbsp;<span class="ident" id="3427040">i</span>&nbsp;<span class="op" id="3427042">&lt;</span>&nbsp;<span class="ident" id="3427044">aes</span><span class="op" id="3427047">.</span><span class="ident" id="3427048">BlockSize</span><span class="op" id="3427057">;</span>&nbsp;<span class="ident" id="3427059">i</span><span class="op" id="3427060">++</span>&nbsp;<span class="op" id="3427063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427068">r</span><span class="op" id="3427069">.</span><span class="ident" id="3427070">seed</span><span class="op" id="3427074">[</span><span class="ident" id="3427075">i</span><span class="op" id="3427076">]</span>&nbsp;<span class="op" id="3427078">=</span>&nbsp;<span class="ident" id="3427080">r</span><span class="op" id="3427081">.</span><span class="ident" id="3427082">time</span><span class="op" id="3427086">[</span><span class="ident" id="3427087">i</span><span class="op" id="3427088">]</span>&nbsp;<span class="op" id="3427090">^</span>&nbsp;<span class="ident" id="3427092">r</span><span class="op" id="3427093">.</span><span class="ident" id="3427094">dst</span><span class="op" id="3427097">[</span><span class="ident" id="3427098">i</span><span class="op" id="3427099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427103">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427107">r</span><span class="op" id="3427108">.</span><span class="ident" id="3427109">cipher</span><span class="op" id="3427115">.</span><span class="ident" id="3427116">Encrypt</span><span class="op" id="3427123">(</span><span class="ident" id="3427124">r</span><span class="op" id="3427125">.</span><span class="ident" id="3427126">seed</span><span class="op" id="3427130">[</span><span class="num" id="3427131">0</span><span class="op" id="3427132">:</span><span class="op" id="3427133">]</span><span class="op" id="3427134">,</span>&nbsp;<span class="ident" id="3427136">r</span><span class="op" id="3427137">.</span><span class="ident" id="3427138">seed</span><span class="op" id="3427142">[</span><span class="num" id="3427143">0</span><span class="op" id="3427144">:</span><span class="op" id="3427145">]</span><span class="op" id="3427146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427151">m</span>&nbsp;<span class="op" id="3427153">:=</span>&nbsp;<span class="builtinfunc" id="3427156">copy</span><span class="op" id="3427160">(</span><span class="ident" id="3427161">b</span><span class="op" id="3427162">,</span>&nbsp;<span class="ident" id="3427164">r</span><span class="op" id="3427165">.</span><span class="ident" id="3427166">dst</span><span class="op" id="3427169">[</span><span class="num" id="3427170">0</span><span class="op" id="3427171">:</span><span class="op" id="3427172">]</span><span class="op" id="3427173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427177">b</span>&nbsp;<span class="op" id="3427179">=</span>&nbsp;<span class="ident" id="3427181">b</span><span class="op" id="3427182">[</span><span class="ident" id="3427183">m</span><span class="op" id="3427184">:</span><span class="op" id="3427185">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427188">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427192">return</span>&nbsp;<span class="ident" id="3427199">n</span><span class="op" id="3427200">,</span>&nbsp;<span class="ident" id="3427202">nil</span><br>
<span class="lineno"></span><span class="op" id="3427206">}</span>
</div>
</body>
</html>
