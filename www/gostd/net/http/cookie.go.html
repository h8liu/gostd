<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3476607">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3476662">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3476716">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3476767">package</span>&nbsp;<span class="ident" id="3476775">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3476781">import</span>&nbsp;<span class="op" id="3476788">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476791">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476800">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476807">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476814">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476821">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476832">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3476843">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3476850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3476853">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="3476907">//</span><br>
<span class="lineno"></span><span class="comment" id="3476910">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3476952">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3477029">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3477087">type</span>&nbsp;<span class="ident" id="3477092">Cookie</span>&nbsp;<span class="keyword" id="3477099">struct</span>&nbsp;<span class="op" id="3477106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477109">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477120">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477128">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477139">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477147">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477158">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477166">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477177">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477185">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477196">time</span><span class="op" id="3477200">.</span><span class="ident" id="3477201">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477207">RawExpires</span>&nbsp;<span class="builtintype" id="3477218">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3477227">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3477280">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3477344">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477410">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477419">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477424">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477433">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477439">HttpOnly</span>&nbsp;<span class="builtintype" id="3477448">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477454">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3477463">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477471">Unparsed</span>&nbsp;<span class="op" id="3477480">[</span><span class="op" id="3477481">]</span><span class="builtintype" id="3477482">string</span>&nbsp;<span class="comment" id="3477489">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="3477535">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3477538">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3477592">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="3477653">func</span>&nbsp;<span class="ident" id="3477658">readSetCookies</span><span class="op" id="3477672">(</span><span class="ident" id="3477673">h</span>&nbsp;<span class="ident" id="3477675">Header</span><span class="op" id="3477681">)</span>&nbsp;<span class="op" id="3477683">[</span><span class="op" id="3477684">]</span><span class="op" id="3477685">*</span><span class="ident" id="3477686">Cookie</span>&nbsp;<span class="op" id="3477693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477696">cookies</span>&nbsp;<span class="op" id="3477704">:=</span>&nbsp;<span class="op" id="3477707">[</span><span class="op" id="3477708">]</span><span class="op" id="3477709">*</span><span class="ident" id="3477710">Cookie</span><span class="op" id="3477716">{</span><span class="op" id="3477717">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3477720">for</span>&nbsp;<span class="ident" id="3477724">_</span><span class="op" id="3477725">,</span>&nbsp;<span class="ident" id="3477727">line</span>&nbsp;<span class="op" id="3477732">:=</span>&nbsp;<span class="keyword" id="3477735">range</span>&nbsp;<span class="ident" id="3477741">h</span><span class="op" id="3477742">[</span><span class="string" id="3477743">&#34;Set-Cookie&#34;</span><span class="op" id="3477755">]</span>&nbsp;<span class="op" id="3477757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477761">parts</span>&nbsp;<span class="op" id="3477767">:=</span>&nbsp;<span class="ident" id="3477770">strings</span><span class="op" id="3477777">.</span><span class="ident" id="3477778">Split</span><span class="op" id="3477783">(</span><span class="ident" id="3477784">strings</span><span class="op" id="3477791">.</span><span class="ident" id="3477792">TrimSpace</span><span class="op" id="3477801">(</span><span class="ident" id="3477802">line</span><span class="op" id="3477806">)</span><span class="op" id="3477807">,</span>&nbsp;<span class="string" id="3477809">&#34;;&#34;</span><span class="op" id="3477812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3477816">if</span>&nbsp;<span class="builtinfunc" id="3477819">len</span><span class="op" id="3477822">(</span><span class="ident" id="3477823">parts</span><span class="op" id="3477828">)</span>&nbsp;<span class="op" id="3477830">==</span>&nbsp;<span class="num" id="3477833">1</span>&nbsp;<span class="op" id="3477835">&amp;&amp;</span>&nbsp;<span class="ident" id="3477838">parts</span><span class="op" id="3477843">[</span><span class="num" id="3477844">0</span><span class="op" id="3477845">]</span>&nbsp;<span class="op" id="3477847">==</span>&nbsp;<span class="string" id="3477850">&#34;&#34;</span>&nbsp;<span class="op" id="3477853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3477858">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3477869">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477873">parts</span><span class="op" id="3477878">[</span><span class="num" id="3477879">0</span><span class="op" id="3477880">]</span>&nbsp;<span class="op" id="3477882">=</span>&nbsp;<span class="ident" id="3477884">strings</span><span class="op" id="3477891">.</span><span class="ident" id="3477892">TrimSpace</span><span class="op" id="3477901">(</span><span class="ident" id="3477902">parts</span><span class="op" id="3477907">[</span><span class="num" id="3477908">0</span><span class="op" id="3477909">]</span><span class="op" id="3477910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477914">j</span>&nbsp;<span class="op" id="3477916">:=</span>&nbsp;<span class="ident" id="3477919">strings</span><span class="op" id="3477926">.</span><span class="ident" id="3477927">Index</span><span class="op" id="3477932">(</span><span class="ident" id="3477933">parts</span><span class="op" id="3477938">[</span><span class="num" id="3477939">0</span><span class="op" id="3477940">]</span><span class="op" id="3477941">,</span>&nbsp;<span class="string" id="3477943">&#34;=&#34;</span><span class="op" id="3477946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3477950">if</span>&nbsp;<span class="ident" id="3477953">j</span>&nbsp;<span class="op" id="3477955">&lt;</span>&nbsp;<span class="num" id="3477957">0</span>&nbsp;<span class="op" id="3477959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3477964">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3477975">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3477979">name</span><span class="op" id="3477983">,</span>&nbsp;<span class="ident" id="3477985">value</span>&nbsp;<span class="op" id="3477991">:=</span>&nbsp;<span class="ident" id="3477994">parts</span><span class="op" id="3477999">[</span><span class="num" id="3478000">0</span><span class="op" id="3478001">]</span><span class="op" id="3478002">[</span><span class="op" id="3478003">:</span><span class="ident" id="3478004">j</span><span class="op" id="3478005">]</span><span class="op" id="3478006">,</span>&nbsp;<span class="ident" id="3478008">parts</span><span class="op" id="3478013">[</span><span class="num" id="3478014">0</span><span class="op" id="3478015">]</span><span class="op" id="3478016">[</span><span class="ident" id="3478017">j</span><span class="op" id="3478018">+</span><span class="num" id="3478019">1</span><span class="op" id="3478020">:</span><span class="op" id="3478021">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478025">if</span>&nbsp;<span class="op" id="3478028">!</span><span class="ident" id="3478029">isCookieNameValid</span><span class="op" id="3478046">(</span><span class="ident" id="3478047">name</span><span class="op" id="3478051">)</span>&nbsp;<span class="op" id="3478053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478058">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478073">value</span><span class="op" id="3478078">,</span>&nbsp;<span class="ident" id="3478080">success</span>&nbsp;<span class="op" id="3478088">:=</span>&nbsp;<span class="ident" id="3478091">parseCookieValue</span><span class="op" id="3478107">(</span><span class="ident" id="3478108">value</span><span class="op" id="3478113">,</span>&nbsp;<span class="builtintype" id="3478115">true</span><span class="op" id="3478119">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478123">if</span>&nbsp;<span class="op" id="3478126">!</span><span class="ident" id="3478127">success</span>&nbsp;<span class="op" id="3478135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478140">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478155">c</span>&nbsp;<span class="op" id="3478157">:=</span>&nbsp;<span class="op" id="3478160">&amp;</span><span class="ident" id="3478161">Cookie</span><span class="op" id="3478167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478172">Name</span><span class="op" id="3478176">:</span>&nbsp;&nbsp;<span class="ident" id="3478179">name</span><span class="op" id="3478183">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478188">Value</span><span class="op" id="3478193">:</span>&nbsp;<span class="ident" id="3478195">value</span><span class="op" id="3478200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478205">Raw</span><span class="op" id="3478208">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3478212">line</span><span class="op" id="3478216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478224">for</span>&nbsp;<span class="ident" id="3478228">i</span>&nbsp;<span class="op" id="3478230">:=</span>&nbsp;<span class="num" id="3478233">1</span><span class="op" id="3478234">;</span>&nbsp;<span class="ident" id="3478236">i</span>&nbsp;<span class="op" id="3478238">&lt;</span>&nbsp;<span class="builtinfunc" id="3478240">len</span><span class="op" id="3478243">(</span><span class="ident" id="3478244">parts</span><span class="op" id="3478249">)</span><span class="op" id="3478250">;</span>&nbsp;<span class="ident" id="3478252">i</span><span class="op" id="3478253">++</span>&nbsp;<span class="op" id="3478256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478261">parts</span><span class="op" id="3478266">[</span><span class="ident" id="3478267">i</span><span class="op" id="3478268">]</span>&nbsp;<span class="op" id="3478270">=</span>&nbsp;<span class="ident" id="3478272">strings</span><span class="op" id="3478279">.</span><span class="ident" id="3478280">TrimSpace</span><span class="op" id="3478289">(</span><span class="ident" id="3478290">parts</span><span class="op" id="3478295">[</span><span class="ident" id="3478296">i</span><span class="op" id="3478297">]</span><span class="op" id="3478298">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478303">if</span>&nbsp;<span class="builtinfunc" id="3478306">len</span><span class="op" id="3478309">(</span><span class="ident" id="3478310">parts</span><span class="op" id="3478315">[</span><span class="ident" id="3478316">i</span><span class="op" id="3478317">]</span><span class="op" id="3478318">)</span>&nbsp;<span class="op" id="3478320">==</span>&nbsp;<span class="num" id="3478323">0</span>&nbsp;<span class="op" id="3478325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478331">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478349">attr</span><span class="op" id="3478353">,</span>&nbsp;<span class="ident" id="3478355">val</span>&nbsp;<span class="op" id="3478359">:=</span>&nbsp;<span class="ident" id="3478362">parts</span><span class="op" id="3478367">[</span><span class="ident" id="3478368">i</span><span class="op" id="3478369">]</span><span class="op" id="3478370">,</span>&nbsp;<span class="string" id="3478372">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478378">if</span>&nbsp;<span class="ident" id="3478381">j</span>&nbsp;<span class="op" id="3478383">:=</span>&nbsp;<span class="ident" id="3478386">strings</span><span class="op" id="3478393">.</span><span class="ident" id="3478394">Index</span><span class="op" id="3478399">(</span><span class="ident" id="3478400">attr</span><span class="op" id="3478404">,</span>&nbsp;<span class="string" id="3478406">&#34;=&#34;</span><span class="op" id="3478409">)</span><span class="op" id="3478410">;</span>&nbsp;<span class="ident" id="3478412">j</span>&nbsp;<span class="op" id="3478414">&gt;=</span>&nbsp;<span class="num" id="3478417">0</span>&nbsp;<span class="op" id="3478419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478425">attr</span><span class="op" id="3478429">,</span>&nbsp;<span class="ident" id="3478431">val</span>&nbsp;<span class="op" id="3478435">=</span>&nbsp;<span class="ident" id="3478437">attr</span><span class="op" id="3478441">[</span><span class="op" id="3478442">:</span><span class="ident" id="3478443">j</span><span class="op" id="3478444">]</span><span class="op" id="3478445">,</span>&nbsp;<span class="ident" id="3478447">attr</span><span class="op" id="3478451">[</span><span class="ident" id="3478452">j</span><span class="op" id="3478453">+</span><span class="num" id="3478454">1</span><span class="op" id="3478455">:</span><span class="op" id="3478456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478466">lowerAttr</span>&nbsp;<span class="op" id="3478476">:=</span>&nbsp;<span class="ident" id="3478479">strings</span><span class="op" id="3478486">.</span><span class="ident" id="3478487">ToLower</span><span class="op" id="3478494">(</span><span class="ident" id="3478495">attr</span><span class="op" id="3478499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478504">val</span><span class="op" id="3478507">,</span>&nbsp;<span class="ident" id="3478509">success</span>&nbsp;<span class="op" id="3478517">=</span>&nbsp;<span class="ident" id="3478519">parseCookieValue</span><span class="op" id="3478535">(</span><span class="ident" id="3478536">val</span><span class="op" id="3478539">,</span>&nbsp;<span class="builtintype" id="3478541">false</span><span class="op" id="3478546">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478551">if</span>&nbsp;<span class="op" id="3478554">!</span><span class="ident" id="3478555">success</span>&nbsp;<span class="op" id="3478563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478569">c</span><span class="op" id="3478570">.</span><span class="ident" id="3478571">Unparsed</span>&nbsp;<span class="op" id="3478580">=</span>&nbsp;<span class="builtinfunc" id="3478582">append</span><span class="op" id="3478588">(</span><span class="ident" id="3478589">c</span><span class="op" id="3478590">.</span><span class="ident" id="3478591">Unparsed</span><span class="op" id="3478599">,</span>&nbsp;<span class="ident" id="3478601">parts</span><span class="op" id="3478606">[</span><span class="ident" id="3478607">i</span><span class="op" id="3478608">]</span><span class="op" id="3478609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478615">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478632">switch</span>&nbsp;<span class="ident" id="3478639">lowerAttr</span>&nbsp;<span class="op" id="3478649">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478654">case</span>&nbsp;<span class="string" id="3478659">&#34;secure&#34;</span><span class="op" id="3478667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478673">c</span><span class="op" id="3478674">.</span><span class="ident" id="3478675">Secure</span>&nbsp;<span class="op" id="3478682">=</span>&nbsp;<span class="builtintype" id="3478684">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478693">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478705">case</span>&nbsp;<span class="string" id="3478710">&#34;httponly&#34;</span><span class="op" id="3478720">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478726">c</span><span class="op" id="3478727">.</span><span class="ident" id="3478728">HttpOnly</span>&nbsp;<span class="op" id="3478737">=</span>&nbsp;<span class="builtintype" id="3478739">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478748">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478760">case</span>&nbsp;<span class="string" id="3478765">&#34;domain&#34;</span><span class="op" id="3478773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478779">c</span><span class="op" id="3478780">.</span><span class="ident" id="3478781">Domain</span>&nbsp;<span class="op" id="3478788">=</span>&nbsp;<span class="ident" id="3478790">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478798">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478810">case</span>&nbsp;<span class="string" id="3478815">&#34;max-age&#34;</span><span class="op" id="3478824">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478830">secs</span><span class="op" id="3478834">,</span>&nbsp;<span class="ident" id="3478836">err</span>&nbsp;<span class="op" id="3478840">:=</span>&nbsp;<span class="ident" id="3478843">strconv</span><span class="op" id="3478850">.</span><span class="ident" id="3478851">Atoi</span><span class="op" id="3478855">(</span><span class="ident" id="3478856">val</span><span class="op" id="3478859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478865">if</span>&nbsp;<span class="ident" id="3478868">err</span>&nbsp;<span class="op" id="3478872">!=</span>&nbsp;<span class="builtintype" id="3478875">nil</span>&nbsp;<span class="op" id="3478879">||</span>&nbsp;<span class="ident" id="3478882">secs</span>&nbsp;<span class="op" id="3478887">!=</span>&nbsp;<span class="num" id="3478890">0</span>&nbsp;<span class="op" id="3478892">&amp;&amp;</span>&nbsp;<span class="ident" id="3478895">val</span><span class="op" id="3478898">[</span><span class="num" id="3478899">0</span><span class="op" id="3478900">]</span>&nbsp;<span class="op" id="3478902">==</span>&nbsp;<span class="string" id="3478905">&#39;0&#39;</span>&nbsp;<span class="op" id="3478909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478916">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3478932">if</span>&nbsp;<span class="ident" id="3478935">secs</span>&nbsp;<span class="op" id="3478940">&lt;=</span>&nbsp;<span class="num" id="3478943">0</span>&nbsp;<span class="op" id="3478945">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478952">c</span><span class="op" id="3478953">.</span><span class="ident" id="3478954">MaxAge</span>&nbsp;<span class="op" id="3478961">=</span>&nbsp;<span class="op" id="3478963">-</span><span class="num" id="3478964">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3478970">}</span>&nbsp;<span class="keyword" id="3478972">else</span>&nbsp;<span class="op" id="3478977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3478984">c</span><span class="op" id="3478985">.</span><span class="ident" id="3478986">MaxAge</span>&nbsp;<span class="op" id="3478993">=</span>&nbsp;<span class="ident" id="3478995">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479010">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479022">case</span>&nbsp;<span class="string" id="3479027">&#34;expires&#34;</span><span class="op" id="3479036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479042">c</span><span class="op" id="3479043">.</span><span class="ident" id="3479044">RawExpires</span>&nbsp;<span class="op" id="3479055">=</span>&nbsp;<span class="ident" id="3479057">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479065">exptime</span><span class="op" id="3479072">,</span>&nbsp;<span class="ident" id="3479074">err</span>&nbsp;<span class="op" id="3479078">:=</span>&nbsp;<span class="ident" id="3479081">time</span><span class="op" id="3479085">.</span><span class="ident" id="3479086">Parse</span><span class="op" id="3479091">(</span><span class="ident" id="3479092">time</span><span class="op" id="3479096">.</span><span class="ident" id="3479097">RFC1123</span><span class="op" id="3479104">,</span>&nbsp;<span class="ident" id="3479106">val</span><span class="op" id="3479109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479115">if</span>&nbsp;<span class="ident" id="3479118">err</span>&nbsp;<span class="op" id="3479122">!=</span>&nbsp;<span class="builtintype" id="3479125">nil</span>&nbsp;<span class="op" id="3479129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479136">exptime</span><span class="op" id="3479143">,</span>&nbsp;<span class="ident" id="3479145">err</span>&nbsp;<span class="op" id="3479149">=</span>&nbsp;<span class="ident" id="3479151">time</span><span class="op" id="3479155">.</span><span class="ident" id="3479156">Parse</span><span class="op" id="3479161">(</span><span class="string" id="3479162">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="3479193">,</span>&nbsp;<span class="ident" id="3479195">val</span><span class="op" id="3479198">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479205">if</span>&nbsp;<span class="ident" id="3479208">err</span>&nbsp;<span class="op" id="3479212">!=</span>&nbsp;<span class="builtintype" id="3479215">nil</span>&nbsp;<span class="op" id="3479219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479227">c</span><span class="op" id="3479228">.</span><span class="ident" id="3479229">Expires</span>&nbsp;<span class="op" id="3479237">=</span>&nbsp;<span class="ident" id="3479239">time</span><span class="op" id="3479243">.</span><span class="ident" id="3479244">Time</span><span class="op" id="3479248">{</span><span class="op" id="3479249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479257">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479274">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479280">c</span><span class="op" id="3479281">.</span><span class="ident" id="3479282">Expires</span>&nbsp;<span class="op" id="3479290">=</span>&nbsp;<span class="ident" id="3479292">exptime</span><span class="op" id="3479299">.</span><span class="ident" id="3479300">UTC</span><span class="op" id="3479303">(</span><span class="op" id="3479304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479310">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479322">case</span>&nbsp;<span class="string" id="3479327">&#34;path&#34;</span><span class="op" id="3479333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479339">c</span><span class="op" id="3479340">.</span><span class="ident" id="3479341">Path</span>&nbsp;<span class="op" id="3479346">=</span>&nbsp;<span class="ident" id="3479348">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479356">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479373">c</span><span class="op" id="3479374">.</span><span class="ident" id="3479375">Unparsed</span>&nbsp;<span class="op" id="3479384">=</span>&nbsp;<span class="builtinfunc" id="3479386">append</span><span class="op" id="3479392">(</span><span class="ident" id="3479393">c</span><span class="op" id="3479394">.</span><span class="ident" id="3479395">Unparsed</span><span class="op" id="3479403">,</span>&nbsp;<span class="ident" id="3479405">parts</span><span class="op" id="3479410">[</span><span class="ident" id="3479411">i</span><span class="op" id="3479412">]</span><span class="op" id="3479413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479421">cookies</span>&nbsp;<span class="op" id="3479429">=</span>&nbsp;<span class="builtinfunc" id="3479431">append</span><span class="op" id="3479437">(</span><span class="ident" id="3479438">cookies</span><span class="op" id="3479445">,</span>&nbsp;<span class="ident" id="3479447">c</span><span class="op" id="3479448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479451">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479454">return</span>&nbsp;<span class="ident" id="3479461">cookies</span><br>
<span class="lineno"></span><span class="op" id="3479469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479472">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="3479552">func</span>&nbsp;<span class="ident" id="3479557">SetCookie</span><span class="op" id="3479566">(</span><span class="ident" id="3479567">w</span>&nbsp;<span class="ident" id="3479569">ResponseWriter</span><span class="op" id="3479583">,</span>&nbsp;<span class="ident" id="3479585">cookie</span>&nbsp;<span class="op" id="3479592">*</span><span class="ident" id="3479593">Cookie</span><span class="op" id="3479599">)</span>&nbsp;<span class="op" id="3479601">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479604">w</span><span class="op" id="3479605">.</span><span class="ident" id="3479606">Header</span><span class="op" id="3479612">(</span><span class="op" id="3479613">)</span><span class="op" id="3479614">.</span><span class="ident" id="3479615">Add</span><span class="op" id="3479618">(</span><span class="string" id="3479619">&#34;Set-Cookie&#34;</span><span class="op" id="3479631">,</span>&nbsp;<span class="ident" id="3479633">cookie</span><span class="op" id="3479639">.</span><span class="ident" id="3479640">String</span><span class="op" id="3479646">(</span><span class="op" id="3479647">)</span><span class="op" id="3479648">)</span><br>
<span class="lineno"></span><span class="op" id="3479650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479653">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="3479723">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="3479791">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="3479828">func</span>&nbsp;<span class="op" id="3479833">(</span><span class="ident" id="3479834">c</span>&nbsp;<span class="op" id="3479836">*</span><span class="ident" id="3479837">Cookie</span><span class="op" id="3479843">)</span>&nbsp;<span class="ident" id="3479845">String</span><span class="op" id="3479851">(</span><span class="op" id="3479852">)</span>&nbsp;<span class="builtintype" id="3479854">string</span>&nbsp;<span class="op" id="3479861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479864">var</span>&nbsp;<span class="ident" id="3479868">b</span>&nbsp;<span class="ident" id="3479870">bytes</span><span class="op" id="3479875">.</span><span class="ident" id="3479876">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479884">fmt</span><span class="op" id="3479887">.</span><span class="ident" id="3479888">Fprintf</span><span class="op" id="3479895">(</span><span class="op" id="3479896">&amp;</span><span class="ident" id="3479897">b</span><span class="op" id="3479898">,</span>&nbsp;<span class="string" id="3479900">&#34;%s=%s&#34;</span><span class="op" id="3479907">,</span>&nbsp;<span class="ident" id="3479909">sanitizeCookieName</span><span class="op" id="3479927">(</span><span class="ident" id="3479928">c</span><span class="op" id="3479929">.</span><span class="ident" id="3479930">Name</span><span class="op" id="3479934">)</span><span class="op" id="3479935">,</span>&nbsp;<span class="ident" id="3479937">sanitizeCookieValue</span><span class="op" id="3479956">(</span><span class="ident" id="3479957">c</span><span class="op" id="3479958">.</span><span class="ident" id="3479959">Value</span><span class="op" id="3479964">)</span><span class="op" id="3479965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3479968">if</span>&nbsp;<span class="builtinfunc" id="3479971">len</span><span class="op" id="3479974">(</span><span class="ident" id="3479975">c</span><span class="op" id="3479976">.</span><span class="ident" id="3479977">Path</span><span class="op" id="3479981">)</span>&nbsp;<span class="op" id="3479983">&gt;</span>&nbsp;<span class="num" id="3479985">0</span>&nbsp;<span class="op" id="3479987">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3479991">fmt</span><span class="op" id="3479994">.</span><span class="ident" id="3479995">Fprintf</span><span class="op" id="3480002">(</span><span class="op" id="3480003">&amp;</span><span class="ident" id="3480004">b</span><span class="op" id="3480005">,</span>&nbsp;<span class="string" id="3480007">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="3480018">,</span>&nbsp;<span class="ident" id="3480020">sanitizeCookiePath</span><span class="op" id="3480038">(</span><span class="ident" id="3480039">c</span><span class="op" id="3480040">.</span><span class="ident" id="3480041">Path</span><span class="op" id="3480045">)</span><span class="op" id="3480046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480052">if</span>&nbsp;<span class="builtinfunc" id="3480055">len</span><span class="op" id="3480058">(</span><span class="ident" id="3480059">c</span><span class="op" id="3480060">.</span><span class="ident" id="3480061">Domain</span><span class="op" id="3480067">)</span>&nbsp;<span class="op" id="3480069">&gt;</span>&nbsp;<span class="num" id="3480071">0</span>&nbsp;<span class="op" id="3480073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480077">if</span>&nbsp;<span class="ident" id="3480080">validCookieDomain</span><span class="op" id="3480097">(</span><span class="ident" id="3480098">c</span><span class="op" id="3480099">.</span><span class="ident" id="3480100">Domain</span><span class="op" id="3480106">)</span>&nbsp;<span class="op" id="3480108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3480113">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3480167">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3480225">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3480278">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480303">d</span>&nbsp;<span class="op" id="3480305">:=</span>&nbsp;<span class="ident" id="3480308">c</span><span class="op" id="3480309">.</span><span class="ident" id="3480310">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480320">if</span>&nbsp;<span class="ident" id="3480323">d</span><span class="op" id="3480324">[</span><span class="num" id="3480325">0</span><span class="op" id="3480326">]</span>&nbsp;<span class="op" id="3480328">==</span>&nbsp;<span class="string" id="3480331">&#39;.&#39;</span>&nbsp;<span class="op" id="3480335">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480341">d</span>&nbsp;<span class="op" id="3480343">=</span>&nbsp;<span class="ident" id="3480345">d</span><span class="op" id="3480346">[</span><span class="num" id="3480347">1</span><span class="op" id="3480348">:</span><span class="op" id="3480349">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480359">fmt</span><span class="op" id="3480362">.</span><span class="ident" id="3480363">Fprintf</span><span class="op" id="3480370">(</span><span class="op" id="3480371">&amp;</span><span class="ident" id="3480372">b</span><span class="op" id="3480373">,</span>&nbsp;<span class="string" id="3480375">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="3480388">,</span>&nbsp;<span class="ident" id="3480390">d</span><span class="op" id="3480391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480395">}</span>&nbsp;<span class="keyword" id="3480397">else</span>&nbsp;<span class="op" id="3480402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480407">log</span><span class="op" id="3480410">.</span><span class="ident" id="3480411">Printf</span><span class="op" id="3480417">(</span><span class="string" id="3480418">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3480481">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480487">c</span><span class="op" id="3480488">.</span><span class="ident" id="3480489">Domain</span><span class="op" id="3480495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480505">if</span>&nbsp;<span class="ident" id="3480508">c</span><span class="op" id="3480509">.</span><span class="ident" id="3480510">Expires</span><span class="op" id="3480517">.</span><span class="ident" id="3480518">Unix</span><span class="op" id="3480522">(</span><span class="op" id="3480523">)</span>&nbsp;<span class="op" id="3480525">&gt;</span>&nbsp;<span class="num" id="3480527">0</span>&nbsp;<span class="op" id="3480529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480533">fmt</span><span class="op" id="3480536">.</span><span class="ident" id="3480537">Fprintf</span><span class="op" id="3480544">(</span><span class="op" id="3480545">&amp;</span><span class="ident" id="3480546">b</span><span class="op" id="3480547">,</span>&nbsp;<span class="string" id="3480549">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="3480563">,</span>&nbsp;<span class="ident" id="3480565">c</span><span class="op" id="3480566">.</span><span class="ident" id="3480567">Expires</span><span class="op" id="3480574">.</span><span class="ident" id="3480575">UTC</span><span class="op" id="3480578">(</span><span class="op" id="3480579">)</span><span class="op" id="3480580">.</span><span class="ident" id="3480581">Format</span><span class="op" id="3480587">(</span><span class="ident" id="3480588">time</span><span class="op" id="3480592">.</span><span class="ident" id="3480593">RFC1123</span><span class="op" id="3480600">)</span><span class="op" id="3480601">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480607">if</span>&nbsp;<span class="ident" id="3480610">c</span><span class="op" id="3480611">.</span><span class="ident" id="3480612">MaxAge</span>&nbsp;<span class="op" id="3480619">&gt;</span>&nbsp;<span class="num" id="3480621">0</span>&nbsp;<span class="op" id="3480623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480627">fmt</span><span class="op" id="3480630">.</span><span class="ident" id="3480631">Fprintf</span><span class="op" id="3480638">(</span><span class="op" id="3480639">&amp;</span><span class="ident" id="3480640">b</span><span class="op" id="3480641">,</span>&nbsp;<span class="string" id="3480643">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="3480657">,</span>&nbsp;<span class="ident" id="3480659">c</span><span class="op" id="3480660">.</span><span class="ident" id="3480661">MaxAge</span><span class="op" id="3480667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480670">}</span>&nbsp;<span class="keyword" id="3480672">else</span>&nbsp;<span class="keyword" id="3480677">if</span>&nbsp;<span class="ident" id="3480680">c</span><span class="op" id="3480681">.</span><span class="ident" id="3480682">MaxAge</span>&nbsp;<span class="op" id="3480689">&lt;</span>&nbsp;<span class="num" id="3480691">0</span>&nbsp;<span class="op" id="3480693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480697">fmt</span><span class="op" id="3480700">.</span><span class="ident" id="3480701">Fprintf</span><span class="op" id="3480708">(</span><span class="op" id="3480709">&amp;</span><span class="ident" id="3480710">b</span><span class="op" id="3480711">,</span>&nbsp;<span class="string" id="3480713">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="3480726">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480732">if</span>&nbsp;<span class="ident" id="3480735">c</span><span class="op" id="3480736">.</span><span class="ident" id="3480737">HttpOnly</span>&nbsp;<span class="op" id="3480746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480750">fmt</span><span class="op" id="3480753">.</span><span class="ident" id="3480754">Fprintf</span><span class="op" id="3480761">(</span><span class="op" id="3480762">&amp;</span><span class="ident" id="3480763">b</span><span class="op" id="3480764">,</span>&nbsp;<span class="string" id="3480766">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="3480778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480784">if</span>&nbsp;<span class="ident" id="3480787">c</span><span class="op" id="3480788">.</span><span class="ident" id="3480789">Secure</span>&nbsp;<span class="op" id="3480796">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3480800">fmt</span><span class="op" id="3480803">.</span><span class="ident" id="3480804">Fprintf</span><span class="op" id="3480811">(</span><span class="op" id="3480812">&amp;</span><span class="ident" id="3480813">b</span><span class="op" id="3480814">,</span>&nbsp;<span class="string" id="3480816">&#34;;&nbsp;Secure&#34;</span><span class="op" id="3480826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3480832">return</span>&nbsp;<span class="ident" id="3480839">b</span><span class="op" id="3480840">.</span><span class="ident" id="3480841">String</span><span class="op" id="3480847">(</span><span class="op" id="3480848">)</span><br>
<span class="lineno"></span><span class="op" id="3480850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3480853">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3480917">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="3480961">//</span><br>
<span class="lineno"></span><span class="comment" id="3480964">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="3481029">func</span>&nbsp;<span class="ident" id="3481034">readCookies</span><span class="op" id="3481045">(</span><span class="ident" id="3481046">h</span>&nbsp;<span class="ident" id="3481048">Header</span><span class="op" id="3481054">,</span>&nbsp;<span class="ident" id="3481056">filter</span>&nbsp;<span class="builtintype" id="3481063">string</span><span class="op" id="3481069">)</span>&nbsp;<span class="op" id="3481071">[</span><span class="op" id="3481072">]</span><span class="op" id="3481073">*</span><span class="ident" id="3481074">Cookie</span>&nbsp;<span class="op" id="3481081">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481084">cookies</span>&nbsp;<span class="op" id="3481092">:=</span>&nbsp;<span class="op" id="3481095">[</span><span class="op" id="3481096">]</span><span class="op" id="3481097">*</span><span class="ident" id="3481098">Cookie</span><span class="op" id="3481104">{</span><span class="op" id="3481105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481108">lines</span><span class="op" id="3481113">,</span>&nbsp;<span class="ident" id="3481115">ok</span>&nbsp;<span class="op" id="3481118">:=</span>&nbsp;<span class="ident" id="3481121">h</span><span class="op" id="3481122">[</span><span class="string" id="3481123">&#34;Cookie&#34;</span><span class="op" id="3481131">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481134">if</span>&nbsp;<span class="op" id="3481137">!</span><span class="ident" id="3481138">ok</span>&nbsp;<span class="op" id="3481141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481145">return</span>&nbsp;<span class="ident" id="3481152">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481161">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481165">for</span>&nbsp;<span class="ident" id="3481169">_</span><span class="op" id="3481170">,</span>&nbsp;<span class="ident" id="3481172">line</span>&nbsp;<span class="op" id="3481177">:=</span>&nbsp;<span class="keyword" id="3481180">range</span>&nbsp;<span class="ident" id="3481186">lines</span>&nbsp;<span class="op" id="3481192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481196">parts</span>&nbsp;<span class="op" id="3481202">:=</span>&nbsp;<span class="ident" id="3481205">strings</span><span class="op" id="3481212">.</span><span class="ident" id="3481213">Split</span><span class="op" id="3481218">(</span><span class="ident" id="3481219">strings</span><span class="op" id="3481226">.</span><span class="ident" id="3481227">TrimSpace</span><span class="op" id="3481236">(</span><span class="ident" id="3481237">line</span><span class="op" id="3481241">)</span><span class="op" id="3481242">,</span>&nbsp;<span class="string" id="3481244">&#34;;&#34;</span><span class="op" id="3481247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481251">if</span>&nbsp;<span class="builtinfunc" id="3481254">len</span><span class="op" id="3481257">(</span><span class="ident" id="3481258">parts</span><span class="op" id="3481263">)</span>&nbsp;<span class="op" id="3481265">==</span>&nbsp;<span class="num" id="3481268">1</span>&nbsp;<span class="op" id="3481270">&amp;&amp;</span>&nbsp;<span class="ident" id="3481273">parts</span><span class="op" id="3481278">[</span><span class="num" id="3481279">0</span><span class="op" id="3481280">]</span>&nbsp;<span class="op" id="3481282">==</span>&nbsp;<span class="string" id="3481285">&#34;&#34;</span>&nbsp;<span class="op" id="3481288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481293">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3481308">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481333">parsedPairs</span>&nbsp;<span class="op" id="3481345">:=</span>&nbsp;<span class="num" id="3481348">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481352">for</span>&nbsp;<span class="ident" id="3481356">i</span>&nbsp;<span class="op" id="3481358">:=</span>&nbsp;<span class="num" id="3481361">0</span><span class="op" id="3481362">;</span>&nbsp;<span class="ident" id="3481364">i</span>&nbsp;<span class="op" id="3481366">&lt;</span>&nbsp;<span class="builtinfunc" id="3481368">len</span><span class="op" id="3481371">(</span><span class="ident" id="3481372">parts</span><span class="op" id="3481377">)</span><span class="op" id="3481378">;</span>&nbsp;<span class="ident" id="3481380">i</span><span class="op" id="3481381">++</span>&nbsp;<span class="op" id="3481384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481389">parts</span><span class="op" id="3481394">[</span><span class="ident" id="3481395">i</span><span class="op" id="3481396">]</span>&nbsp;<span class="op" id="3481398">=</span>&nbsp;<span class="ident" id="3481400">strings</span><span class="op" id="3481407">.</span><span class="ident" id="3481408">TrimSpace</span><span class="op" id="3481417">(</span><span class="ident" id="3481418">parts</span><span class="op" id="3481423">[</span><span class="ident" id="3481424">i</span><span class="op" id="3481425">]</span><span class="op" id="3481426">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481431">if</span>&nbsp;<span class="builtinfunc" id="3481434">len</span><span class="op" id="3481437">(</span><span class="ident" id="3481438">parts</span><span class="op" id="3481443">[</span><span class="ident" id="3481444">i</span><span class="op" id="3481445">]</span><span class="op" id="3481446">)</span>&nbsp;<span class="op" id="3481448">==</span>&nbsp;<span class="num" id="3481451">0</span>&nbsp;<span class="op" id="3481453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481459">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481476">name</span><span class="op" id="3481480">,</span>&nbsp;<span class="ident" id="3481482">val</span>&nbsp;<span class="op" id="3481486">:=</span>&nbsp;<span class="ident" id="3481489">parts</span><span class="op" id="3481494">[</span><span class="ident" id="3481495">i</span><span class="op" id="3481496">]</span><span class="op" id="3481497">,</span>&nbsp;<span class="string" id="3481499">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481505">if</span>&nbsp;<span class="ident" id="3481508">j</span>&nbsp;<span class="op" id="3481510">:=</span>&nbsp;<span class="ident" id="3481513">strings</span><span class="op" id="3481520">.</span><span class="ident" id="3481521">Index</span><span class="op" id="3481526">(</span><span class="ident" id="3481527">name</span><span class="op" id="3481531">,</span>&nbsp;<span class="string" id="3481533">&#34;=&#34;</span><span class="op" id="3481536">)</span><span class="op" id="3481537">;</span>&nbsp;<span class="ident" id="3481539">j</span>&nbsp;<span class="op" id="3481541">&gt;=</span>&nbsp;<span class="num" id="3481544">0</span>&nbsp;<span class="op" id="3481546">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481552">name</span><span class="op" id="3481556">,</span>&nbsp;<span class="ident" id="3481558">val</span>&nbsp;<span class="op" id="3481562">=</span>&nbsp;<span class="ident" id="3481564">name</span><span class="op" id="3481568">[</span><span class="op" id="3481569">:</span><span class="ident" id="3481570">j</span><span class="op" id="3481571">]</span><span class="op" id="3481572">,</span>&nbsp;<span class="ident" id="3481574">name</span><span class="op" id="3481578">[</span><span class="ident" id="3481579">j</span><span class="op" id="3481580">+</span><span class="num" id="3481581">1</span><span class="op" id="3481582">:</span><span class="op" id="3481583">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481593">if</span>&nbsp;<span class="op" id="3481596">!</span><span class="ident" id="3481597">isCookieNameValid</span><span class="op" id="3481614">(</span><span class="ident" id="3481615">name</span><span class="op" id="3481619">)</span>&nbsp;<span class="op" id="3481621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481627">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481639">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481644">if</span>&nbsp;<span class="ident" id="3481647">filter</span>&nbsp;<span class="op" id="3481654">!=</span>&nbsp;<span class="string" id="3481657">&#34;&#34;</span>&nbsp;<span class="op" id="3481660">&amp;&amp;</span>&nbsp;<span class="ident" id="3481663">filter</span>&nbsp;<span class="op" id="3481670">!=</span>&nbsp;<span class="ident" id="3481673">name</span>&nbsp;<span class="op" id="3481678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481684">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481701">val</span><span class="op" id="3481704">,</span>&nbsp;<span class="ident" id="3481706">success</span>&nbsp;<span class="op" id="3481714">:=</span>&nbsp;<span class="ident" id="3481717">parseCookieValue</span><span class="op" id="3481733">(</span><span class="ident" id="3481734">val</span><span class="op" id="3481737">,</span>&nbsp;<span class="builtintype" id="3481739">true</span><span class="op" id="3481743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481748">if</span>&nbsp;<span class="op" id="3481751">!</span><span class="ident" id="3481752">success</span>&nbsp;<span class="op" id="3481760">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481766">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481783">cookies</span>&nbsp;<span class="op" id="3481791">=</span>&nbsp;<span class="builtinfunc" id="3481793">append</span><span class="op" id="3481799">(</span><span class="ident" id="3481800">cookies</span><span class="op" id="3481807">,</span>&nbsp;<span class="op" id="3481809">&amp;</span><span class="ident" id="3481810">Cookie</span><span class="op" id="3481816">{</span><span class="ident" id="3481817">Name</span><span class="op" id="3481821">:</span>&nbsp;<span class="ident" id="3481823">name</span><span class="op" id="3481827">,</span>&nbsp;<span class="ident" id="3481829">Value</span><span class="op" id="3481834">:</span>&nbsp;<span class="ident" id="3481836">val</span><span class="op" id="3481839">}</span><span class="op" id="3481840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3481845">parsedPairs</span><span class="op" id="3481856">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481861">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3481864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481867">return</span>&nbsp;<span class="ident" id="3481874">cookies</span><br>
<span class="lineno"></span><span class="op" id="3481882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3481885">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="3481955">func</span>&nbsp;<span class="ident" id="3481960">validCookieDomain</span><span class="op" id="3481977">(</span><span class="ident" id="3481978">v</span>&nbsp;<span class="builtintype" id="3481980">string</span><span class="op" id="3481986">)</span>&nbsp;<span class="builtintype" id="3481988">bool</span>&nbsp;<span class="op" id="3481993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3481996">if</span>&nbsp;<span class="ident" id="3481999">isCookieDomainName</span><span class="op" id="3482017">(</span><span class="ident" id="3482018">v</span><span class="op" id="3482019">)</span>&nbsp;<span class="op" id="3482021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482025">return</span>&nbsp;<span class="builtintype" id="3482032">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482041">if</span>&nbsp;<span class="ident" id="3482044">net</span><span class="op" id="3482047">.</span><span class="ident" id="3482048">ParseIP</span><span class="op" id="3482055">(</span><span class="ident" id="3482056">v</span><span class="op" id="3482057">)</span>&nbsp;<span class="op" id="3482059">!=</span>&nbsp;<span class="builtintype" id="3482062">nil</span>&nbsp;<span class="op" id="3482066">&amp;&amp;</span>&nbsp;<span class="op" id="3482069">!</span><span class="ident" id="3482070">strings</span><span class="op" id="3482077">.</span><span class="ident" id="3482078">Contains</span><span class="op" id="3482086">(</span><span class="ident" id="3482087">v</span><span class="op" id="3482088">,</span>&nbsp;<span class="string" id="3482090">&#34;:&#34;</span><span class="op" id="3482093">)</span>&nbsp;<span class="op" id="3482095">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482099">return</span>&nbsp;<span class="builtintype" id="3482106">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482115">return</span>&nbsp;<span class="builtintype" id="3482122">false</span><br>
<span class="lineno"></span><span class="op" id="3482128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="3482131">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="3482205">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3482275">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="3482306">func</span>&nbsp;<span class="ident" id="3482311">isCookieDomainName</span><span class="op" id="3482329">(</span><span class="ident" id="3482330">s</span>&nbsp;<span class="builtintype" id="3482332">string</span><span class="op" id="3482338">)</span>&nbsp;<span class="builtintype" id="3482340">bool</span>&nbsp;<span class="op" id="3482345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482348">if</span>&nbsp;<span class="builtinfunc" id="3482351">len</span><span class="op" id="3482354">(</span><span class="ident" id="3482355">s</span><span class="op" id="3482356">)</span>&nbsp;<span class="op" id="3482358">==</span>&nbsp;<span class="num" id="3482361">0</span>&nbsp;<span class="op" id="3482363">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482367">return</span>&nbsp;<span class="builtintype" id="3482374">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482384">if</span>&nbsp;<span class="builtinfunc" id="3482387">len</span><span class="op" id="3482390">(</span><span class="ident" id="3482391">s</span><span class="op" id="3482392">)</span>&nbsp;<span class="op" id="3482394">&gt;</span>&nbsp;<span class="num" id="3482396">255</span>&nbsp;<span class="op" id="3482400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482404">return</span>&nbsp;<span class="builtintype" id="3482411">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482418">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482422">if</span>&nbsp;<span class="ident" id="3482425">s</span><span class="op" id="3482426">[</span><span class="num" id="3482427">0</span><span class="op" id="3482428">]</span>&nbsp;<span class="op" id="3482430">==</span>&nbsp;<span class="string" id="3482433">&#39;.&#39;</span>&nbsp;<span class="op" id="3482437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3482441">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482504">s</span>&nbsp;<span class="op" id="3482506">=</span>&nbsp;<span class="ident" id="3482508">s</span><span class="op" id="3482509">[</span><span class="num" id="3482510">1</span><span class="op" id="3482511">:</span><span class="op" id="3482512">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482515">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482518">last</span>&nbsp;<span class="op" id="3482523">:=</span>&nbsp;<span class="builtintype" id="3482526">byte</span><span class="op" id="3482530">(</span><span class="string" id="3482531">&#39;.&#39;</span><span class="op" id="3482534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482537">ok</span>&nbsp;<span class="op" id="3482540">:=</span>&nbsp;<span class="builtintype" id="3482543">false</span>&nbsp;<span class="comment" id="3482549">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482582">partlen</span>&nbsp;<span class="op" id="3482590">:=</span>&nbsp;<span class="num" id="3482593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482596">for</span>&nbsp;<span class="ident" id="3482600">i</span>&nbsp;<span class="op" id="3482602">:=</span>&nbsp;<span class="num" id="3482605">0</span><span class="op" id="3482606">;</span>&nbsp;<span class="ident" id="3482608">i</span>&nbsp;<span class="op" id="3482610">&lt;</span>&nbsp;<span class="builtinfunc" id="3482612">len</span><span class="op" id="3482615">(</span><span class="ident" id="3482616">s</span><span class="op" id="3482617">)</span><span class="op" id="3482618">;</span>&nbsp;<span class="ident" id="3482620">i</span><span class="op" id="3482621">++</span>&nbsp;<span class="op" id="3482624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482628">c</span>&nbsp;<span class="op" id="3482630">:=</span>&nbsp;<span class="ident" id="3482633">s</span><span class="op" id="3482634">[</span><span class="ident" id="3482635">i</span><span class="op" id="3482636">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482640">switch</span>&nbsp;<span class="op" id="3482647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482651">default</span><span class="op" id="3482658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482663">return</span>&nbsp;<span class="builtintype" id="3482670">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482678">case</span>&nbsp;<span class="string" id="3482683">&#39;a&#39;</span>&nbsp;<span class="op" id="3482687">&lt;=</span>&nbsp;<span class="ident" id="3482690">c</span>&nbsp;<span class="op" id="3482692">&amp;&amp;</span>&nbsp;<span class="ident" id="3482695">c</span>&nbsp;<span class="op" id="3482697">&lt;=</span>&nbsp;<span class="string" id="3482700">&#39;z&#39;</span>&nbsp;<span class="op" id="3482704">||</span>&nbsp;<span class="string" id="3482707">&#39;A&#39;</span>&nbsp;<span class="op" id="3482711">&lt;=</span>&nbsp;<span class="ident" id="3482714">c</span>&nbsp;<span class="op" id="3482716">&amp;&amp;</span>&nbsp;<span class="ident" id="3482719">c</span>&nbsp;<span class="op" id="3482721">&lt;=</span>&nbsp;<span class="string" id="3482724">&#39;Z&#39;</span><span class="op" id="3482727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3482732">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482788">ok</span>&nbsp;<span class="op" id="3482791">=</span>&nbsp;<span class="builtintype" id="3482793">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482801">partlen</span><span class="op" id="3482808">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482813">case</span>&nbsp;<span class="string" id="3482818">&#39;0&#39;</span>&nbsp;<span class="op" id="3482822">&lt;=</span>&nbsp;<span class="ident" id="3482825">c</span>&nbsp;<span class="op" id="3482827">&amp;&amp;</span>&nbsp;<span class="ident" id="3482830">c</span>&nbsp;<span class="op" id="3482832">&lt;=</span>&nbsp;<span class="string" id="3482835">&#39;9&#39;</span><span class="op" id="3482838">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3482843">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482854">partlen</span><span class="op" id="3482861">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482866">case</span>&nbsp;<span class="ident" id="3482871">c</span>&nbsp;<span class="op" id="3482873">==</span>&nbsp;<span class="string" id="3482876">&#39;-&#39;</span><span class="op" id="3482879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3482884">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482922">if</span>&nbsp;<span class="ident" id="3482925">last</span>&nbsp;<span class="op" id="3482930">==</span>&nbsp;<span class="string" id="3482933">&#39;.&#39;</span>&nbsp;<span class="op" id="3482937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482943">return</span>&nbsp;<span class="builtintype" id="3482950">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482959">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3482964">partlen</span><span class="op" id="3482971">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3482976">case</span>&nbsp;<span class="ident" id="3482981">c</span>&nbsp;<span class="op" id="3482983">==</span>&nbsp;<span class="string" id="3482986">&#39;.&#39;</span><span class="op" id="3482989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3482994">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483037">if</span>&nbsp;<span class="ident" id="3483040">last</span>&nbsp;<span class="op" id="3483045">==</span>&nbsp;<span class="string" id="3483048">&#39;.&#39;</span>&nbsp;<span class="op" id="3483052">||</span>&nbsp;<span class="ident" id="3483055">last</span>&nbsp;<span class="op" id="3483060">==</span>&nbsp;<span class="string" id="3483063">&#39;-&#39;</span>&nbsp;<span class="op" id="3483067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483073">return</span>&nbsp;<span class="builtintype" id="3483080">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483094">if</span>&nbsp;<span class="ident" id="3483097">partlen</span>&nbsp;<span class="op" id="3483105">&gt;</span>&nbsp;<span class="num" id="3483107">63</span>&nbsp;<span class="op" id="3483110">||</span>&nbsp;<span class="ident" id="3483113">partlen</span>&nbsp;<span class="op" id="3483121">==</span>&nbsp;<span class="num" id="3483124">0</span>&nbsp;<span class="op" id="3483126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483132">return</span>&nbsp;<span class="builtintype" id="3483139">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3483153">partlen</span>&nbsp;<span class="op" id="3483161">=</span>&nbsp;<span class="num" id="3483163">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3483171">last</span>&nbsp;<span class="op" id="3483176">=</span>&nbsp;<span class="ident" id="3483178">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483184">if</span>&nbsp;<span class="ident" id="3483187">last</span>&nbsp;<span class="op" id="3483192">==</span>&nbsp;<span class="string" id="3483195">&#39;-&#39;</span>&nbsp;<span class="op" id="3483199">||</span>&nbsp;<span class="ident" id="3483202">partlen</span>&nbsp;<span class="op" id="3483210">&gt;</span>&nbsp;<span class="num" id="3483212">63</span>&nbsp;<span class="op" id="3483215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483219">return</span>&nbsp;<span class="builtintype" id="3483226">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483237">return</span>&nbsp;<span class="ident" id="3483244">ok</span><br>
<span class="lineno"></span><span class="op" id="3483247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3483250">var</span>&nbsp;<span class="ident" id="3483254">cookieNameSanitizer</span>&nbsp;<span class="op" id="3483274">=</span>&nbsp;<span class="ident" id="3483276">strings</span><span class="op" id="3483283">.</span><span class="ident" id="3483284">NewReplacer</span><span class="op" id="3483295">(</span><span class="string" id="3483296">&#34;\n&#34;</span><span class="op" id="3483300">,</span>&nbsp;<span class="string" id="3483302">&#34;-&#34;</span><span class="op" id="3483305">,</span>&nbsp;<span class="string" id="3483307">&#34;\r&#34;</span><span class="op" id="3483311">,</span>&nbsp;<span class="string" id="3483313">&#34;-&#34;</span><span class="op" id="3483316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3483319">func</span>&nbsp;<span class="ident" id="3483324">sanitizeCookieName</span><span class="op" id="3483342">(</span><span class="ident" id="3483343">n</span>&nbsp;<span class="builtintype" id="3483345">string</span><span class="op" id="3483351">)</span>&nbsp;<span class="builtintype" id="3483353">string</span>&nbsp;<span class="op" id="3483360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3483363">return</span>&nbsp;<span class="ident" id="3483370">cookieNameSanitizer</span><span class="op" id="3483389">.</span><span class="ident" id="3483390">Replace</span><span class="op" id="3483397">(</span><span class="ident" id="3483398">n</span><span class="op" id="3483399">)</span><br>
<span class="lineno"></span><span class="op" id="3483401">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3483404">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="3483456">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="3483527">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="3483595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="3483646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="3483698">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="3483727">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3483794">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3483863">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="3483889">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="3483945">func</span>&nbsp;<span class="ident" id="3483950">sanitizeCookieValue</span><span class="op" id="3483969">(</span><span class="ident" id="3483970">v</span>&nbsp;<span class="builtintype" id="3483972">string</span><span class="op" id="3483978">)</span>&nbsp;<span class="builtintype" id="3483980">string</span>&nbsp;<span class="op" id="3483987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3483990">v</span>&nbsp;<span class="op" id="3483992">=</span>&nbsp;<span class="ident" id="3483994">sanitizeOrWarn</span><span class="op" id="3484008">(</span><span class="string" id="3484009">&#34;Cookie.Value&#34;</span><span class="op" id="3484023">,</span>&nbsp;<span class="ident" id="3484025">validCookieValueByte</span><span class="op" id="3484045">,</span>&nbsp;<span class="ident" id="3484047">v</span><span class="op" id="3484048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484051">if</span>&nbsp;<span class="builtinfunc" id="3484054">len</span><span class="op" id="3484057">(</span><span class="ident" id="3484058">v</span><span class="op" id="3484059">)</span>&nbsp;<span class="op" id="3484061">==</span>&nbsp;<span class="num" id="3484064">0</span>&nbsp;<span class="op" id="3484066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484070">return</span>&nbsp;<span class="ident" id="3484077">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3484080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484083">if</span>&nbsp;<span class="ident" id="3484086">v</span><span class="op" id="3484087">[</span><span class="num" id="3484088">0</span><span class="op" id="3484089">]</span>&nbsp;<span class="op" id="3484091">==</span>&nbsp;<span class="string" id="3484094">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3484098">||</span>&nbsp;<span class="ident" id="3484101">v</span><span class="op" id="3484102">[</span><span class="num" id="3484103">0</span><span class="op" id="3484104">]</span>&nbsp;<span class="op" id="3484106">==</span>&nbsp;<span class="string" id="3484109">&#39;,&#39;</span>&nbsp;<span class="op" id="3484113">||</span>&nbsp;<span class="ident" id="3484116">v</span><span class="op" id="3484117">[</span><span class="builtinfunc" id="3484118">len</span><span class="op" id="3484121">(</span><span class="ident" id="3484122">v</span><span class="op" id="3484123">)</span><span class="op" id="3484124">-</span><span class="num" id="3484125">1</span><span class="op" id="3484126">]</span>&nbsp;<span class="op" id="3484128">==</span>&nbsp;<span class="string" id="3484131">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3484135">||</span>&nbsp;<span class="ident" id="3484138">v</span><span class="op" id="3484139">[</span><span class="builtinfunc" id="3484140">len</span><span class="op" id="3484143">(</span><span class="ident" id="3484144">v</span><span class="op" id="3484145">)</span><span class="op" id="3484146">-</span><span class="num" id="3484147">1</span><span class="op" id="3484148">]</span>&nbsp;<span class="op" id="3484150">==</span>&nbsp;<span class="string" id="3484153">&#39;,&#39;</span>&nbsp;<span class="op" id="3484157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484161">return</span>&nbsp;<span class="string" id="3484168">`&#34;`</span>&nbsp;<span class="op" id="3484172">+</span>&nbsp;<span class="ident" id="3484174">v</span>&nbsp;<span class="op" id="3484176">+</span>&nbsp;<span class="string" id="3484178">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3484183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484186">return</span>&nbsp;<span class="ident" id="3484193">v</span><br>
<span class="lineno">310</span><span class="op" id="3484195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484198">func</span>&nbsp;<span class="ident" id="3484203">validCookieValueByte</span><span class="op" id="3484223">(</span><span class="ident" id="3484224">b</span>&nbsp;<span class="builtintype" id="3484226">byte</span><span class="op" id="3484230">)</span>&nbsp;<span class="builtintype" id="3484232">bool</span>&nbsp;<span class="op" id="3484237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484240">return</span>&nbsp;<span class="num" id="3484247">0x20</span>&nbsp;<span class="op" id="3484252">&lt;=</span>&nbsp;<span class="ident" id="3484255">b</span>&nbsp;<span class="op" id="3484257">&amp;&amp;</span>&nbsp;<span class="ident" id="3484260">b</span>&nbsp;<span class="op" id="3484262">&lt;</span>&nbsp;<span class="num" id="3484264">0x7f</span>&nbsp;<span class="op" id="3484269">&amp;&amp;</span>&nbsp;<span class="ident" id="3484272">b</span>&nbsp;<span class="op" id="3484274">!=</span>&nbsp;<span class="string" id="3484277">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3484281">&amp;&amp;</span>&nbsp;<span class="ident" id="3484284">b</span>&nbsp;<span class="op" id="3484286">!=</span>&nbsp;<span class="string" id="3484289">&#39;;&#39;</span>&nbsp;<span class="op" id="3484293">&amp;&amp;</span>&nbsp;<span class="ident" id="3484296">b</span>&nbsp;<span class="op" id="3484298">!=</span>&nbsp;<span class="string" id="3484301">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="3484306">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3484309">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="3484351">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="3484404">func</span>&nbsp;<span class="ident" id="3484409">sanitizeCookiePath</span><span class="op" id="3484427">(</span><span class="ident" id="3484428">v</span>&nbsp;<span class="builtintype" id="3484430">string</span><span class="op" id="3484436">)</span>&nbsp;<span class="builtintype" id="3484438">string</span>&nbsp;<span class="op" id="3484445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484448">return</span>&nbsp;<span class="ident" id="3484455">sanitizeOrWarn</span><span class="op" id="3484469">(</span><span class="string" id="3484470">&#34;Cookie.Path&#34;</span><span class="op" id="3484483">,</span>&nbsp;<span class="ident" id="3484485">validCookiePathByte</span><span class="op" id="3484504">,</span>&nbsp;<span class="ident" id="3484506">v</span><span class="op" id="3484507">)</span><br>
<span class="lineno">320</span><span class="op" id="3484509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484512">func</span>&nbsp;<span class="ident" id="3484517">validCookiePathByte</span><span class="op" id="3484536">(</span><span class="ident" id="3484537">b</span>&nbsp;<span class="builtintype" id="3484539">byte</span><span class="op" id="3484543">)</span>&nbsp;<span class="builtintype" id="3484545">bool</span>&nbsp;<span class="op" id="3484550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484553">return</span>&nbsp;<span class="num" id="3484560">0x20</span>&nbsp;<span class="op" id="3484565">&lt;=</span>&nbsp;<span class="ident" id="3484568">b</span>&nbsp;<span class="op" id="3484570">&amp;&amp;</span>&nbsp;<span class="ident" id="3484573">b</span>&nbsp;<span class="op" id="3484575">&lt;</span>&nbsp;<span class="num" id="3484577">0x7f</span>&nbsp;<span class="op" id="3484582">&amp;&amp;</span>&nbsp;<span class="ident" id="3484585">b</span>&nbsp;<span class="op" id="3484587">!=</span>&nbsp;<span class="string" id="3484590">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="3484594">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3484597">func</span>&nbsp;<span class="ident" id="3484602">sanitizeOrWarn</span><span class="op" id="3484616">(</span><span class="ident" id="3484617">fieldName</span>&nbsp;<span class="builtintype" id="3484627">string</span><span class="op" id="3484633">,</span>&nbsp;<span class="ident" id="3484635">valid</span>&nbsp;<span class="keyword" id="3484641">func</span><span class="op" id="3484645">(</span><span class="builtintype" id="3484646">byte</span><span class="op" id="3484650">)</span>&nbsp;<span class="builtintype" id="3484652">bool</span><span class="op" id="3484656">,</span>&nbsp;<span class="ident" id="3484658">v</span>&nbsp;<span class="builtintype" id="3484660">string</span><span class="op" id="3484666">)</span>&nbsp;<span class="builtintype" id="3484668">string</span>&nbsp;<span class="op" id="3484675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3484678">ok</span>&nbsp;<span class="op" id="3484681">:=</span>&nbsp;<span class="builtintype" id="3484684">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484690">for</span>&nbsp;<span class="ident" id="3484694">i</span>&nbsp;<span class="op" id="3484696">:=</span>&nbsp;<span class="num" id="3484699">0</span><span class="op" id="3484700">;</span>&nbsp;<span class="ident" id="3484702">i</span>&nbsp;<span class="op" id="3484704">&lt;</span>&nbsp;<span class="builtinfunc" id="3484706">len</span><span class="op" id="3484709">(</span><span class="ident" id="3484710">v</span><span class="op" id="3484711">)</span><span class="op" id="3484712">;</span>&nbsp;<span class="ident" id="3484714">i</span><span class="op" id="3484715">++</span>&nbsp;<span class="op" id="3484718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484722">if</span>&nbsp;<span class="ident" id="3484725">valid</span><span class="op" id="3484730">(</span><span class="ident" id="3484731">v</span><span class="op" id="3484732">[</span><span class="ident" id="3484733">i</span><span class="op" id="3484734">]</span><span class="op" id="3484735">)</span>&nbsp;<span class="op" id="3484737">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484742">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3484753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3484757">log</span><span class="op" id="3484760">.</span><span class="ident" id="3484761">Printf</span><span class="op" id="3484767">(</span><span class="string" id="3484768">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="3484825">,</span>&nbsp;<span class="ident" id="3484827">v</span><span class="op" id="3484828">[</span><span class="ident" id="3484829">i</span><span class="op" id="3484830">]</span><span class="op" id="3484831">,</span>&nbsp;<span class="ident" id="3484833">fieldName</span><span class="op" id="3484842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3484846">ok</span>&nbsp;<span class="op" id="3484849">=</span>&nbsp;<span class="builtintype" id="3484851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484859">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3484866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484869">if</span>&nbsp;<span class="ident" id="3484872">ok</span>&nbsp;<span class="op" id="3484875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484879">return</span>&nbsp;<span class="ident" id="3484886">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3484889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3484892">buf</span>&nbsp;<span class="op" id="3484896">:=</span>&nbsp;<span class="builtinfunc" id="3484899">make</span><span class="op" id="3484903">(</span><span class="op" id="3484904">[</span><span class="op" id="3484905">]</span><span class="builtintype" id="3484906">byte</span><span class="op" id="3484910">,</span>&nbsp;<span class="num" id="3484912">0</span><span class="op" id="3484913">,</span>&nbsp;<span class="builtinfunc" id="3484915">len</span><span class="op" id="3484918">(</span><span class="ident" id="3484919">v</span><span class="op" id="3484920">)</span><span class="op" id="3484921">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484924">for</span>&nbsp;<span class="ident" id="3484928">i</span>&nbsp;<span class="op" id="3484930">:=</span>&nbsp;<span class="num" id="3484933">0</span><span class="op" id="3484934">;</span>&nbsp;<span class="ident" id="3484936">i</span>&nbsp;<span class="op" id="3484938">&lt;</span>&nbsp;<span class="builtinfunc" id="3484940">len</span><span class="op" id="3484943">(</span><span class="ident" id="3484944">v</span><span class="op" id="3484945">)</span><span class="op" id="3484946">;</span>&nbsp;<span class="ident" id="3484948">i</span><span class="op" id="3484949">++</span>&nbsp;<span class="op" id="3484952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3484956">if</span>&nbsp;<span class="ident" id="3484959">b</span>&nbsp;<span class="op" id="3484961">:=</span>&nbsp;<span class="ident" id="3484964">v</span><span class="op" id="3484965">[</span><span class="ident" id="3484966">i</span><span class="op" id="3484967">]</span><span class="op" id="3484968">;</span>&nbsp;<span class="ident" id="3484970">valid</span><span class="op" id="3484975">(</span><span class="ident" id="3484976">b</span><span class="op" id="3484977">)</span>&nbsp;<span class="op" id="3484979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3484984">buf</span>&nbsp;<span class="op" id="3484988">=</span>&nbsp;<span class="builtinfunc" id="3484990">append</span><span class="op" id="3484996">(</span><span class="ident" id="3484997">buf</span><span class="op" id="3485000">,</span>&nbsp;<span class="ident" id="3485002">b</span><span class="op" id="3485003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485010">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485013">return</span>&nbsp;<span class="builtintype" id="3485020">string</span><span class="op" id="3485026">(</span><span class="ident" id="3485027">buf</span><span class="op" id="3485030">)</span><br>
<span class="lineno"></span><span class="op" id="3485032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3485035">func</span>&nbsp;<span class="ident" id="3485040">parseCookieValue</span><span class="op" id="3485056">(</span><span class="ident" id="3485057">raw</span>&nbsp;<span class="builtintype" id="3485061">string</span><span class="op" id="3485067">,</span>&nbsp;<span class="ident" id="3485069">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="3485086">bool</span><span class="op" id="3485090">)</span>&nbsp;<span class="op" id="3485092">(</span><span class="builtintype" id="3485093">string</span><span class="op" id="3485099">,</span>&nbsp;<span class="builtintype" id="3485101">bool</span><span class="op" id="3485105">)</span>&nbsp;<span class="op" id="3485107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485110">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485144">if</span>&nbsp;<span class="ident" id="3485147">allowDoubleQuote</span>&nbsp;<span class="op" id="3485164">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3485167">len</span><span class="op" id="3485170">(</span><span class="ident" id="3485171">raw</span><span class="op" id="3485174">)</span>&nbsp;<span class="op" id="3485176">&gt;</span>&nbsp;<span class="num" id="3485178">1</span>&nbsp;<span class="op" id="3485180">&amp;&amp;</span>&nbsp;<span class="ident" id="3485183">raw</span><span class="op" id="3485186">[</span><span class="num" id="3485187">0</span><span class="op" id="3485188">]</span>&nbsp;<span class="op" id="3485190">==</span>&nbsp;<span class="string" id="3485193">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3485197">&amp;&amp;</span>&nbsp;<span class="ident" id="3485200">raw</span><span class="op" id="3485203">[</span><span class="builtinfunc" id="3485204">len</span><span class="op" id="3485207">(</span><span class="ident" id="3485208">raw</span><span class="op" id="3485211">)</span><span class="op" id="3485212">-</span><span class="num" id="3485213">1</span><span class="op" id="3485214">]</span>&nbsp;<span class="op" id="3485216">==</span>&nbsp;<span class="string" id="3485219">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3485223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3485227">raw</span>&nbsp;<span class="op" id="3485231">=</span>&nbsp;<span class="ident" id="3485233">raw</span><span class="op" id="3485236">[</span><span class="num" id="3485237">1</span>&nbsp;<span class="op" id="3485239">:</span>&nbsp;<span class="builtinfunc" id="3485241">len</span><span class="op" id="3485244">(</span><span class="ident" id="3485245">raw</span><span class="op" id="3485248">)</span><span class="op" id="3485249">-</span><span class="num" id="3485250">1</span><span class="op" id="3485251">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485257">for</span>&nbsp;<span class="ident" id="3485261">i</span>&nbsp;<span class="op" id="3485263">:=</span>&nbsp;<span class="num" id="3485266">0</span><span class="op" id="3485267">;</span>&nbsp;<span class="ident" id="3485269">i</span>&nbsp;<span class="op" id="3485271">&lt;</span>&nbsp;<span class="builtinfunc" id="3485273">len</span><span class="op" id="3485276">(</span><span class="ident" id="3485277">raw</span><span class="op" id="3485280">)</span><span class="op" id="3485281">;</span>&nbsp;<span class="ident" id="3485283">i</span><span class="op" id="3485284">++</span>&nbsp;<span class="op" id="3485287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485291">if</span>&nbsp;<span class="op" id="3485294">!</span><span class="ident" id="3485295">validCookieValueByte</span><span class="op" id="3485315">(</span><span class="ident" id="3485316">raw</span><span class="op" id="3485319">[</span><span class="ident" id="3485320">i</span><span class="op" id="3485321">]</span><span class="op" id="3485322">)</span>&nbsp;<span class="op" id="3485324">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485329">return</span>&nbsp;<span class="string" id="3485336">&#34;&#34;</span><span class="op" id="3485338">,</span>&nbsp;<span class="builtintype" id="3485340">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485354">return</span>&nbsp;<span class="ident" id="3485361">raw</span><span class="op" id="3485364">,</span>&nbsp;<span class="builtintype" id="3485366">true</span><br>
<span class="lineno"></span><span class="op" id="3485371">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="3485374">func</span>&nbsp;<span class="ident" id="3485379">isCookieNameValid</span><span class="op" id="3485396">(</span><span class="ident" id="3485397">raw</span>&nbsp;<span class="builtintype" id="3485401">string</span><span class="op" id="3485407">)</span>&nbsp;<span class="builtintype" id="3485409">bool</span>&nbsp;<span class="op" id="3485414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3485417">return</span>&nbsp;<span class="ident" id="3485424">strings</span><span class="op" id="3485431">.</span><span class="ident" id="3485432">IndexFunc</span><span class="op" id="3485441">(</span><span class="ident" id="3485442">raw</span><span class="op" id="3485445">,</span>&nbsp;<span class="ident" id="3485447">isNotToken</span><span class="op" id="3485457">)</span>&nbsp;<span class="op" id="3485459">&lt;</span>&nbsp;<span class="num" id="3485461">0</span><br>
<span class="lineno"></span><span class="op" id="3485463">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
