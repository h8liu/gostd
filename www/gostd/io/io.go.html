<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1374719">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1374774">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1374828">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1374879">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1374938">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1375013">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1375080">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1375147">//</span><br>
<span class="lineno">10</span><span class="comment" id="1375150">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1375226">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1375299">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1375347">package</span>&nbsp;<span class="ident" id="1375355">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1375359">import</span>&nbsp;<span class="op" id="1375366">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1375369">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1375378">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1375381">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1375453">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1375496">var</span>&nbsp;<span class="ident" id="1375500">ErrShortWrite</span>&nbsp;<span class="op" id="1375514">=</span>&nbsp;<span class="ident" id="1375516">errors</span><span class="op" id="1375522">.</span><span class="ident" id="1375523">New</span><span class="op" id="1375526">(</span><span class="string" id="1375527">&#34;short&nbsp;write&#34;</span><span class="op" id="1375540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1375543">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1375623">var</span>&nbsp;<span class="ident" id="1375627">ErrShortBuffer</span>&nbsp;<span class="op" id="1375642">=</span>&nbsp;<span class="ident" id="1375644">errors</span><span class="op" id="1375650">.</span><span class="ident" id="1375651">New</span><span class="op" id="1375654">(</span><span class="string" id="1375655">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1375669">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1375672">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1375742">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1375813">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1375876">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1375948">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1375971">var</span>&nbsp;<span class="ident" id="1375975">EOF</span>&nbsp;<span class="op" id="1375979">=</span>&nbsp;<span class="ident" id="1375981">errors</span><span class="op" id="1375987">.</span><span class="ident" id="1375988">New</span><span class="op" id="1375991">(</span><span class="string" id="1375992">&#34;EOF&#34;</span><span class="op" id="1375997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376000">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1376058">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1376117">var</span>&nbsp;<span class="ident" id="1376121">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1376138">=</span>&nbsp;<span class="ident" id="1376140">errors</span><span class="op" id="1376146">.</span><span class="ident" id="1376147">New</span><span class="op" id="1376150">(</span><span class="string" id="1376151">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1376167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376170">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1376236">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1376299">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1376357">var</span>&nbsp;<span class="ident" id="1376361">ErrNoProgress</span>&nbsp;<span class="op" id="1376375">=</span>&nbsp;<span class="ident" id="1376377">errors</span><span class="op" id="1376383">.</span><span class="ident" id="1376384">New</span><span class="op" id="1376387">(</span><span class="string" id="1376388">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1376433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1376436">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1376497">//</span><br>
<span class="lineno"></span><span class="comment" id="1376500">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1376573">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1376641">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1376718">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1376789">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1376847">//</span><br>
<span class="lineno">50</span><span class="comment" id="1376850">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1376914">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1376976">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1377045">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1377105">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1377168">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1377233">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1377298">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1377327">//</span><br>
<span class="lineno"></span><span class="comment" id="1377330">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1377395">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1377464">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1377525">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1377551">//</span><br>
<span class="lineno"></span><span class="comment" id="1377554">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1377614">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1377676">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1377741">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1377802">//</span><br>
<span class="lineno"></span><span class="comment" id="1377805">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1377843">type</span>&nbsp;<span class="ident" id="1377848">Reader</span>&nbsp;<span class="keyword" id="1377855">interface</span>&nbsp;<span class="op" id="1377865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1377868">Read</span><span class="op" id="1377872">(</span><span class="ident" id="1377873">p</span>&nbsp;<span class="op" id="1377875">[</span><span class="op" id="1377876">]</span><span class="builtintype" id="1377877">byte</span><span class="op" id="1377881">)</span>&nbsp;<span class="op" id="1377883">(</span><span class="ident" id="1377884">n</span>&nbsp;<span class="builtintype" id="1377886">int</span><span class="op" id="1377889">,</span>&nbsp;<span class="ident" id="1377891">err</span>&nbsp;<span class="builtintype" id="1377895">error</span><span class="op" id="1377900">)</span><br>
<span class="lineno"></span><span class="op" id="1377902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1377905">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1377967">//</span><br>
<span class="lineno"></span><span class="comment" id="1377970">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1378037">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1378105">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1378171">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1378234">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1378293">//</span><br>
<span class="lineno"></span><span class="comment" id="1378296">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1378334">type</span>&nbsp;<span class="ident" id="1378339">Writer</span>&nbsp;<span class="keyword" id="1378346">interface</span>&nbsp;<span class="op" id="1378356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378359">Write</span><span class="op" id="1378364">(</span><span class="ident" id="1378365">p</span>&nbsp;<span class="op" id="1378367">[</span><span class="op" id="1378368">]</span><span class="builtintype" id="1378369">byte</span><span class="op" id="1378373">)</span>&nbsp;<span class="op" id="1378375">(</span><span class="ident" id="1378376">n</span>&nbsp;<span class="builtintype" id="1378378">int</span><span class="op" id="1378381">,</span>&nbsp;<span class="ident" id="1378383">err</span>&nbsp;<span class="builtintype" id="1378387">error</span><span class="op" id="1378392">)</span><br>
<span class="lineno">85</span><span class="op" id="1378394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1378397">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1378459">//</span><br>
<span class="lineno"></span><span class="comment" id="1378462">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1378522">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1378583">type</span>&nbsp;<span class="ident" id="1378588">Closer</span>&nbsp;<span class="keyword" id="1378595">interface</span>&nbsp;<span class="op" id="1378605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1378608">Close</span><span class="op" id="1378613">(</span><span class="op" id="1378614">)</span>&nbsp;<span class="builtintype" id="1378616">error</span><br>
<span class="lineno"></span><span class="op" id="1378622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1378625">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1378686">//</span><br>
<span class="lineno"></span><span class="comment" id="1378689">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1378751">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1378821">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1378886">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1378956">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1378964">//</span><br>
<span class="lineno"></span><span class="comment" id="1378967">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1379036">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1379105">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1379159">type</span>&nbsp;<span class="ident" id="1379164">Seeker</span>&nbsp;<span class="keyword" id="1379171">interface</span>&nbsp;<span class="op" id="1379181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379184">Seek</span><span class="op" id="1379188">(</span><span class="ident" id="1379189">offset</span>&nbsp;<span class="ident" id="1379196">int64</span><span class="op" id="1379201">,</span>&nbsp;<span class="ident" id="1379203">whence</span>&nbsp;<span class="builtintype" id="1379210">int</span><span class="op" id="1379213">)</span>&nbsp;<span class="op" id="1379215">(</span><span class="ident" id="1379216">int64</span><span class="op" id="1379221">,</span>&nbsp;<span class="builtintype" id="1379223">error</span><span class="op" id="1379228">)</span><br>
<span class="lineno"></span><span class="op" id="1379230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1379233">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379310">type</span>&nbsp;<span class="ident" id="1379315">ReadWriter</span>&nbsp;<span class="keyword" id="1379326">interface</span>&nbsp;<span class="op" id="1379336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379339">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379347">Writer</span><br>
<span class="lineno"></span><span class="op" id="1379354">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1379357">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379434">type</span>&nbsp;<span class="ident" id="1379439">ReadCloser</span>&nbsp;<span class="keyword" id="1379450">interface</span>&nbsp;<span class="op" id="1379460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379463">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379471">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1379478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379481">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379560">type</span>&nbsp;<span class="ident" id="1379565">WriteCloser</span>&nbsp;<span class="keyword" id="1379577">interface</span>&nbsp;<span class="op" id="1379587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379590">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379598">Closer</span><br>
<span class="lineno"></span><span class="op" id="1379605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1379608">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379697">type</span>&nbsp;<span class="ident" id="1379702">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1379718">interface</span>&nbsp;<span class="op" id="1379728">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379731">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379739">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379747">Closer</span><br>
<span class="lineno"></span><span class="op" id="1379754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1379757">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379833">type</span>&nbsp;<span class="ident" id="1379838">ReadSeeker</span>&nbsp;<span class="keyword" id="1379849">interface</span>&nbsp;<span class="op" id="1379859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379862">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379870">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1379877">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1379880">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1379958">type</span>&nbsp;<span class="ident" id="1379963">WriteSeeker</span>&nbsp;<span class="keyword" id="1379975">interface</span>&nbsp;<span class="op" id="1379985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379988">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1379996">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1380003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1380006">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1380094">type</span>&nbsp;<span class="ident" id="1380099">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1380115">interface</span>&nbsp;<span class="op" id="1380125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380128">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380136">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380144">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1380151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1380154">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1380217">//</span><br>
<span class="lineno"></span><span class="comment" id="1380220">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1380270">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1380321">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1380394">//</span><br>
<span class="lineno">160</span><span class="comment" id="1380397">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1380448">type</span>&nbsp;<span class="ident" id="1380453">ReaderFrom</span>&nbsp;<span class="keyword" id="1380464">interface</span>&nbsp;<span class="op" id="1380474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380477">ReadFrom</span><span class="op" id="1380485">(</span><span class="ident" id="1380486">r</span>&nbsp;<span class="ident" id="1380488">Reader</span><span class="op" id="1380494">)</span>&nbsp;<span class="op" id="1380496">(</span><span class="ident" id="1380497">n</span>&nbsp;<span class="ident" id="1380499">int64</span><span class="op" id="1380504">,</span>&nbsp;<span class="ident" id="1380506">err</span>&nbsp;<span class="builtintype" id="1380510">error</span><span class="op" id="1380515">)</span><br>
<span class="lineno"></span><span class="op" id="1380517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1380520">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1380580">//</span><br>
<span class="lineno"></span><span class="comment" id="1380583">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1380650">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1380717">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1380786">//</span><br>
<span class="lineno"></span><span class="comment" id="1380789">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1380838">type</span>&nbsp;<span class="ident" id="1380843">WriterTo</span>&nbsp;<span class="keyword" id="1380852">interface</span>&nbsp;<span class="op" id="1380862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1380865">WriteTo</span><span class="op" id="1380872">(</span><span class="ident" id="1380873">w</span>&nbsp;<span class="ident" id="1380875">Writer</span><span class="op" id="1380881">)</span>&nbsp;<span class="op" id="1380883">(</span><span class="ident" id="1380884">n</span>&nbsp;<span class="ident" id="1380886">int64</span><span class="op" id="1380891">,</span>&nbsp;<span class="ident" id="1380893">err</span>&nbsp;<span class="builtintype" id="1380897">error</span><span class="op" id="1380902">)</span><br>
<span class="lineno"></span><span class="op" id="1380904">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1380907">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1380972">//</span><br>
<span class="lineno"></span><span class="comment" id="1380975">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1381041">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1381101">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1381155">//</span><br>
<span class="lineno"></span><span class="comment" id="1381158">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1381220">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1381286">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1381319">//</span><br>
<span class="lineno"></span><span class="comment" id="1381322">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1381391">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1381466">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1381542">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1381592">//</span><br>
<span class="lineno"></span><span class="comment" id="1381595">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1381663">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1381731">//</span><br>
<span class="lineno"></span><span class="comment" id="1381734">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1381799">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1381861">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1381877">//</span><br>
<span class="lineno"></span><span class="comment" id="1381880">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1381942">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1381964">//</span><br>
<span class="lineno"></span><span class="comment" id="1381967">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1382005">type</span>&nbsp;<span class="ident" id="1382010">ReaderAt</span>&nbsp;<span class="keyword" id="1382019">interface</span>&nbsp;<span class="op" id="1382029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1382032">ReadAt</span><span class="op" id="1382038">(</span><span class="ident" id="1382039">p</span>&nbsp;<span class="op" id="1382041">[</span><span class="op" id="1382042">]</span><span class="builtintype" id="1382043">byte</span><span class="op" id="1382047">,</span>&nbsp;<span class="ident" id="1382049">off</span>&nbsp;<span class="ident" id="1382053">int64</span><span class="op" id="1382058">)</span>&nbsp;<span class="op" id="1382060">(</span><span class="ident" id="1382061">n</span>&nbsp;<span class="builtintype" id="1382063">int</span><span class="op" id="1382066">,</span>&nbsp;<span class="ident" id="1382068">err</span>&nbsp;<span class="builtintype" id="1382072">error</span><span class="op" id="1382077">)</span><br>
<span class="lineno"></span><span class="op" id="1382079">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1382082">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1382148">//</span><br>
<span class="lineno"></span><span class="comment" id="1382151">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1382219">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1382303">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1382369">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1382434">//</span><br>
<span class="lineno"></span><span class="comment" id="1382437">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1382499">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1382562">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1382578">//</span><br>
<span class="lineno"></span><span class="comment" id="1382581">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1382650">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1382695">//</span><br>
<span class="lineno">220</span><span class="comment" id="1382698">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1382736">type</span>&nbsp;<span class="ident" id="1382741">WriterAt</span>&nbsp;<span class="keyword" id="1382750">interface</span>&nbsp;<span class="op" id="1382760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1382763">WriteAt</span><span class="op" id="1382770">(</span><span class="ident" id="1382771">p</span>&nbsp;<span class="op" id="1382773">[</span><span class="op" id="1382774">]</span><span class="builtintype" id="1382775">byte</span><span class="op" id="1382779">,</span>&nbsp;<span class="ident" id="1382781">off</span>&nbsp;<span class="ident" id="1382785">int64</span><span class="op" id="1382790">)</span>&nbsp;<span class="op" id="1382792">(</span><span class="ident" id="1382793">n</span>&nbsp;<span class="builtintype" id="1382795">int</span><span class="op" id="1382798">,</span>&nbsp;<span class="ident" id="1382800">err</span>&nbsp;<span class="builtintype" id="1382804">error</span><span class="op" id="1382809">)</span><br>
<span class="lineno"></span><span class="op" id="1382811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1382814">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1382877">//</span><br>
<span class="lineno"></span><span class="comment" id="1382880">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1382940">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1382985">type</span>&nbsp;<span class="ident" id="1382990">ByteReader</span>&nbsp;<span class="keyword" id="1383001">interface</span>&nbsp;<span class="op" id="1383011">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1383014">ReadByte</span><span class="op" id="1383022">(</span><span class="op" id="1383023">)</span>&nbsp;<span class="op" id="1383025">(</span><span class="ident" id="1383026">c</span>&nbsp;<span class="builtintype" id="1383028">byte</span><span class="op" id="1383032">,</span>&nbsp;<span class="ident" id="1383034">err</span>&nbsp;<span class="builtintype" id="1383038">error</span><span class="op" id="1383043">)</span><br>
<span class="lineno"></span><span class="op" id="1383045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1383048">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1383119">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1383145">//</span><br>
<span class="lineno"></span><span class="comment" id="1383148">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1383219">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1383256">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1383326">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1383347">type</span>&nbsp;<span class="ident" id="1383352">ByteScanner</span>&nbsp;<span class="keyword" id="1383364">interface</span>&nbsp;<span class="op" id="1383374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1383377">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1383389">UnreadByte</span><span class="op" id="1383399">(</span><span class="op" id="1383400">)</span>&nbsp;<span class="builtintype" id="1383402">error</span><br>
<span class="lineno"></span><span class="op" id="1383408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1383411">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1383475">type</span>&nbsp;<span class="ident" id="1383480">ByteWriter</span>&nbsp;<span class="keyword" id="1383491">interface</span>&nbsp;<span class="op" id="1383501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1383504">WriteByte</span><span class="op" id="1383513">(</span><span class="ident" id="1383514">c</span>&nbsp;<span class="builtintype" id="1383516">byte</span><span class="op" id="1383520">)</span>&nbsp;<span class="builtintype" id="1383522">error</span><br>
<span class="lineno"></span><span class="op" id="1383528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1383531">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1383594">//</span><br>
<span class="lineno"></span><span class="comment" id="1383597">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1383656">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1383722">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1383753">type</span>&nbsp;<span class="ident" id="1383758">RuneReader</span>&nbsp;<span class="keyword" id="1383769">interface</span>&nbsp;<span class="op" id="1383779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1383782">ReadRune</span><span class="op" id="1383790">(</span><span class="op" id="1383791">)</span>&nbsp;<span class="op" id="1383793">(</span><span class="ident" id="1383794">r</span>&nbsp;<span class="builtintype" id="1383796">rune</span><span class="op" id="1383800">,</span>&nbsp;<span class="ident" id="1383802">size</span>&nbsp;<span class="builtintype" id="1383807">int</span><span class="op" id="1383810">,</span>&nbsp;<span class="ident" id="1383812">err</span>&nbsp;<span class="builtintype" id="1383816">error</span><span class="op" id="1383821">)</span><br>
<span class="lineno"></span><span class="op" id="1383823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1383826">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1383897">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1383923">//</span><br>
<span class="lineno"></span><span class="comment" id="1383926">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1383997">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1384034">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1384104">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1384125">type</span>&nbsp;<span class="ident" id="1384130">RuneScanner</span>&nbsp;<span class="keyword" id="1384142">interface</span>&nbsp;<span class="op" id="1384152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1384155">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1384167">UnreadRune</span><span class="op" id="1384177">(</span><span class="op" id="1384178">)</span>&nbsp;<span class="builtintype" id="1384180">error</span><br>
<span class="lineno"></span><span class="op" id="1384186">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1384189">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1384257">type</span>&nbsp;<span class="ident" id="1384262">stringWriter</span>&nbsp;<span class="keyword" id="1384275">interface</span>&nbsp;<span class="op" id="1384285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1384288">WriteString</span><span class="op" id="1384299">(</span><span class="ident" id="1384300">s</span>&nbsp;<span class="builtintype" id="1384302">string</span><span class="op" id="1384308">)</span>&nbsp;<span class="op" id="1384310">(</span><span class="ident" id="1384311">n</span>&nbsp;<span class="builtintype" id="1384313">int</span><span class="op" id="1384316">,</span>&nbsp;<span class="ident" id="1384318">err</span>&nbsp;<span class="builtintype" id="1384322">error</span><span class="op" id="1384327">)</span><br>
<span class="lineno"></span><span class="op" id="1384329">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1384332">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1384422">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1384495">func</span>&nbsp;<span class="ident" id="1384500">WriteString</span><span class="op" id="1384511">(</span><span class="ident" id="1384512">w</span>&nbsp;<span class="ident" id="1384514">Writer</span><span class="op" id="1384520">,</span>&nbsp;<span class="ident" id="1384522">s</span>&nbsp;<span class="builtintype" id="1384524">string</span><span class="op" id="1384530">)</span>&nbsp;<span class="op" id="1384532">(</span><span class="ident" id="1384533">n</span>&nbsp;<span class="builtintype" id="1384535">int</span><span class="op" id="1384538">,</span>&nbsp;<span class="ident" id="1384540">err</span>&nbsp;<span class="builtintype" id="1384544">error</span><span class="op" id="1384549">)</span>&nbsp;<span class="op" id="1384551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1384554">if</span>&nbsp;<span class="ident" id="1384557">sw</span><span class="op" id="1384559">,</span>&nbsp;<span class="ident" id="1384561">ok</span>&nbsp;<span class="op" id="1384564">:=</span>&nbsp;<span class="ident" id="1384567">w</span><span class="op" id="1384568">.</span><span class="op" id="1384569">(</span><span class="ident" id="1384570">stringWriter</span><span class="op" id="1384582">)</span><span class="op" id="1384583">;</span>&nbsp;<span class="ident" id="1384585">ok</span>&nbsp;<span class="op" id="1384588">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1384592">return</span>&nbsp;<span class="ident" id="1384599">sw</span><span class="op" id="1384601">.</span><span class="ident" id="1384602">WriteString</span><span class="op" id="1384613">(</span><span class="ident" id="1384614">s</span><span class="op" id="1384615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1384618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1384621">return</span>&nbsp;<span class="ident" id="1384628">w</span><span class="op" id="1384629">.</span><span class="ident" id="1384630">Write</span><span class="op" id="1384635">(</span><span class="op" id="1384636">[</span><span class="op" id="1384637">]</span><span class="builtintype" id="1384638">byte</span><span class="op" id="1384642">(</span><span class="ident" id="1384643">s</span><span class="op" id="1384644">)</span><span class="op" id="1384645">)</span><br>
<span class="lineno"></span><span class="op" id="1384647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1384650">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1384725">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1384805">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1384853">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1384910">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1384951">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1385032">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1385082">func</span>&nbsp;<span class="ident" id="1385087">ReadAtLeast</span><span class="op" id="1385098">(</span><span class="ident" id="1385099">r</span>&nbsp;<span class="ident" id="1385101">Reader</span><span class="op" id="1385107">,</span>&nbsp;<span class="ident" id="1385109">buf</span>&nbsp;<span class="op" id="1385113">[</span><span class="op" id="1385114">]</span><span class="builtintype" id="1385115">byte</span><span class="op" id="1385119">,</span>&nbsp;<span class="ident" id="1385121">min</span>&nbsp;<span class="builtintype" id="1385125">int</span><span class="op" id="1385128">)</span>&nbsp;<span class="op" id="1385130">(</span><span class="ident" id="1385131">n</span>&nbsp;<span class="builtintype" id="1385133">int</span><span class="op" id="1385136">,</span>&nbsp;<span class="ident" id="1385138">err</span>&nbsp;<span class="builtintype" id="1385142">error</span><span class="op" id="1385147">)</span>&nbsp;<span class="op" id="1385149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385152">if</span>&nbsp;<span class="builtinfunc" id="1385155">len</span><span class="op" id="1385158">(</span><span class="ident" id="1385159">buf</span><span class="op" id="1385162">)</span>&nbsp;<span class="op" id="1385164">&lt;</span>&nbsp;<span class="ident" id="1385166">min</span>&nbsp;<span class="op" id="1385170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385174">return</span>&nbsp;<span class="num" id="1385181">0</span><span class="op" id="1385182">,</span>&nbsp;<span class="ident" id="1385184">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1385200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385203">for</span>&nbsp;<span class="ident" id="1385207">n</span>&nbsp;<span class="op" id="1385209">&lt;</span>&nbsp;<span class="ident" id="1385211">min</span>&nbsp;<span class="op" id="1385215">&amp;&amp;</span>&nbsp;<span class="ident" id="1385218">err</span>&nbsp;<span class="op" id="1385222">==</span>&nbsp;<span class="ident" id="1385225">nil</span>&nbsp;<span class="op" id="1385229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385233">var</span>&nbsp;<span class="ident" id="1385237">nn</span>&nbsp;<span class="builtintype" id="1385240">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1385246">nn</span><span class="op" id="1385248">,</span>&nbsp;<span class="ident" id="1385250">err</span>&nbsp;<span class="op" id="1385254">=</span>&nbsp;<span class="ident" id="1385256">r</span><span class="op" id="1385257">.</span><span class="ident" id="1385258">Read</span><span class="op" id="1385262">(</span><span class="ident" id="1385263">buf</span><span class="op" id="1385266">[</span><span class="ident" id="1385267">n</span><span class="op" id="1385268">:</span><span class="op" id="1385269">]</span><span class="op" id="1385270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1385274">n</span>&nbsp;<span class="op" id="1385276">+=</span>&nbsp;<span class="ident" id="1385279">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1385283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385286">if</span>&nbsp;<span class="ident" id="1385289">n</span>&nbsp;<span class="op" id="1385291">&gt;=</span>&nbsp;<span class="ident" id="1385294">min</span>&nbsp;<span class="op" id="1385298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1385302">err</span>&nbsp;<span class="op" id="1385306">=</span>&nbsp;<span class="ident" id="1385308">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1385313">}</span>&nbsp;<span class="keyword" id="1385315">else</span>&nbsp;<span class="keyword" id="1385320">if</span>&nbsp;<span class="ident" id="1385323">n</span>&nbsp;<span class="op" id="1385325">&gt;</span>&nbsp;<span class="num" id="1385327">0</span>&nbsp;<span class="op" id="1385329">&amp;&amp;</span>&nbsp;<span class="ident" id="1385332">err</span>&nbsp;<span class="op" id="1385336">==</span>&nbsp;<span class="ident" id="1385339">EOF</span>&nbsp;<span class="op" id="1385343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1385347">err</span>&nbsp;<span class="op" id="1385351">=</span>&nbsp;<span class="ident" id="1385353">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1385371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385374">return</span><br>
<span class="lineno"></span><span class="op" id="1385381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1385384">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1385442">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1385522">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1385570">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1385633">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1385671">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1385726">func</span>&nbsp;<span class="ident" id="1385731">ReadFull</span><span class="op" id="1385739">(</span><span class="ident" id="1385740">r</span>&nbsp;<span class="ident" id="1385742">Reader</span><span class="op" id="1385748">,</span>&nbsp;<span class="ident" id="1385750">buf</span>&nbsp;<span class="op" id="1385754">[</span><span class="op" id="1385755">]</span><span class="builtintype" id="1385756">byte</span><span class="op" id="1385760">)</span>&nbsp;<span class="op" id="1385762">(</span><span class="ident" id="1385763">n</span>&nbsp;<span class="builtintype" id="1385765">int</span><span class="op" id="1385768">,</span>&nbsp;<span class="ident" id="1385770">err</span>&nbsp;<span class="builtintype" id="1385774">error</span><span class="op" id="1385779">)</span>&nbsp;<span class="op" id="1385781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1385784">return</span>&nbsp;<span class="ident" id="1385791">ReadAtLeast</span><span class="op" id="1385802">(</span><span class="ident" id="1385803">r</span><span class="op" id="1385804">,</span>&nbsp;<span class="ident" id="1385806">buf</span><span class="op" id="1385809">,</span>&nbsp;<span class="builtinfunc" id="1385811">len</span><span class="op" id="1385814">(</span><span class="ident" id="1385815">buf</span><span class="op" id="1385818">)</span><span class="op" id="1385819">)</span><br>
<span class="lineno"></span><span class="op" id="1385821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1385824">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1385885">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1385943">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1385979">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1386033">//</span><br>
<span class="lineno"></span><span class="comment" id="1386036">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1386083">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1386120">func</span>&nbsp;<span class="ident" id="1386125">CopyN</span><span class="op" id="1386130">(</span><span class="ident" id="1386131">dst</span>&nbsp;<span class="ident" id="1386135">Writer</span><span class="op" id="1386141">,</span>&nbsp;<span class="ident" id="1386143">src</span>&nbsp;<span class="ident" id="1386147">Reader</span><span class="op" id="1386153">,</span>&nbsp;<span class="ident" id="1386155">n</span>&nbsp;<span class="ident" id="1386157">int64</span><span class="op" id="1386162">)</span>&nbsp;<span class="op" id="1386164">(</span><span class="ident" id="1386165">written</span>&nbsp;<span class="ident" id="1386173">int64</span><span class="op" id="1386178">,</span>&nbsp;<span class="ident" id="1386180">err</span>&nbsp;<span class="builtintype" id="1386184">error</span><span class="op" id="1386189">)</span>&nbsp;<span class="op" id="1386191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386194">written</span><span class="op" id="1386201">,</span>&nbsp;<span class="ident" id="1386203">err</span>&nbsp;<span class="op" id="1386207">=</span>&nbsp;<span class="ident" id="1386209">Copy</span><span class="op" id="1386213">(</span><span class="ident" id="1386214">dst</span><span class="op" id="1386217">,</span>&nbsp;<span class="ident" id="1386219">LimitReader</span><span class="op" id="1386230">(</span><span class="ident" id="1386231">src</span><span class="op" id="1386234">,</span>&nbsp;<span class="ident" id="1386236">n</span><span class="op" id="1386237">)</span><span class="op" id="1386238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386241">if</span>&nbsp;<span class="ident" id="1386244">written</span>&nbsp;<span class="op" id="1386252">==</span>&nbsp;<span class="ident" id="1386255">n</span>&nbsp;<span class="op" id="1386257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386261">return</span>&nbsp;<span class="ident" id="1386268">n</span><span class="op" id="1386269">,</span>&nbsp;<span class="ident" id="1386271">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386279">if</span>&nbsp;<span class="ident" id="1386282">written</span>&nbsp;<span class="op" id="1386290">&lt;</span>&nbsp;<span class="ident" id="1386292">n</span>&nbsp;<span class="op" id="1386294">&amp;&amp;</span>&nbsp;<span class="ident" id="1386297">err</span>&nbsp;<span class="op" id="1386301">==</span>&nbsp;<span class="ident" id="1386304">nil</span>&nbsp;<span class="op" id="1386308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1386312">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386356">err</span>&nbsp;<span class="op" id="1386360">=</span>&nbsp;<span class="ident" id="1386362">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386367">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386370">return</span><br>
<span class="lineno"></span><span class="op" id="1386377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1386380">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1386439">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1386501">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1386566">//</span><br>
<span class="lineno"></span><span class="comment" id="1386569">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1386626">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1386689">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1386747">//</span><br>
<span class="lineno"></span><span class="comment" id="1386750">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1386795">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1386851">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1386909">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1386966">func</span>&nbsp;<span class="ident" id="1386971">Copy</span><span class="op" id="1386975">(</span><span class="ident" id="1386976">dst</span>&nbsp;<span class="ident" id="1386980">Writer</span><span class="op" id="1386986">,</span>&nbsp;<span class="ident" id="1386988">src</span>&nbsp;<span class="ident" id="1386992">Reader</span><span class="op" id="1386998">)</span>&nbsp;<span class="op" id="1387000">(</span><span class="ident" id="1387001">written</span>&nbsp;<span class="ident" id="1387009">int64</span><span class="op" id="1387014">,</span>&nbsp;<span class="ident" id="1387016">err</span>&nbsp;<span class="builtintype" id="1387020">error</span><span class="op" id="1387025">)</span>&nbsp;<span class="op" id="1387027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1387030">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1387093">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387130">if</span>&nbsp;<span class="ident" id="1387133">wt</span><span class="op" id="1387135">,</span>&nbsp;<span class="ident" id="1387137">ok</span>&nbsp;<span class="op" id="1387140">:=</span>&nbsp;<span class="ident" id="1387143">src</span><span class="op" id="1387146">.</span><span class="op" id="1387147">(</span><span class="ident" id="1387148">WriterTo</span><span class="op" id="1387156">)</span><span class="op" id="1387157">;</span>&nbsp;<span class="ident" id="1387159">ok</span>&nbsp;<span class="op" id="1387162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387166">return</span>&nbsp;<span class="ident" id="1387173">wt</span><span class="op" id="1387175">.</span><span class="ident" id="1387176">WriteTo</span><span class="op" id="1387183">(</span><span class="ident" id="1387184">dst</span><span class="op" id="1387187">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1387193">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387268">if</span>&nbsp;<span class="ident" id="1387271">rt</span><span class="op" id="1387273">,</span>&nbsp;<span class="ident" id="1387275">ok</span>&nbsp;<span class="op" id="1387278">:=</span>&nbsp;<span class="ident" id="1387281">dst</span><span class="op" id="1387284">.</span><span class="op" id="1387285">(</span><span class="ident" id="1387286">ReaderFrom</span><span class="op" id="1387296">)</span><span class="op" id="1387297">;</span>&nbsp;<span class="ident" id="1387299">ok</span>&nbsp;<span class="op" id="1387302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387306">return</span>&nbsp;<span class="ident" id="1387313">rt</span><span class="op" id="1387315">.</span><span class="ident" id="1387316">ReadFrom</span><span class="op" id="1387324">(</span><span class="ident" id="1387325">src</span><span class="op" id="1387328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387331">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387334">buf</span>&nbsp;<span class="op" id="1387338">:=</span>&nbsp;<span class="builtinfunc" id="1387341">make</span><span class="op" id="1387345">(</span><span class="op" id="1387346">[</span><span class="op" id="1387347">]</span><span class="builtintype" id="1387348">byte</span><span class="op" id="1387352">,</span>&nbsp;<span class="num" id="1387354">32</span><span class="op" id="1387356">*</span><span class="num" id="1387357">1024</span><span class="op" id="1387361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387364">for</span>&nbsp;<span class="op" id="1387368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387372">nr</span><span class="op" id="1387374">,</span>&nbsp;<span class="ident" id="1387376">er</span>&nbsp;<span class="op" id="1387379">:=</span>&nbsp;<span class="ident" id="1387382">src</span><span class="op" id="1387385">.</span><span class="ident" id="1387386">Read</span><span class="op" id="1387390">(</span><span class="ident" id="1387391">buf</span><span class="op" id="1387394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387398">if</span>&nbsp;<span class="ident" id="1387401">nr</span>&nbsp;<span class="op" id="1387404">&gt;</span>&nbsp;<span class="num" id="1387406">0</span>&nbsp;<span class="op" id="1387408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387413">nw</span><span class="op" id="1387415">,</span>&nbsp;<span class="ident" id="1387417">ew</span>&nbsp;<span class="op" id="1387420">:=</span>&nbsp;<span class="ident" id="1387423">dst</span><span class="op" id="1387426">.</span><span class="ident" id="1387427">Write</span><span class="op" id="1387432">(</span><span class="ident" id="1387433">buf</span><span class="op" id="1387436">[</span><span class="num" id="1387437">0</span><span class="op" id="1387438">:</span><span class="ident" id="1387439">nr</span><span class="op" id="1387441">]</span><span class="op" id="1387442">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387447">if</span>&nbsp;<span class="ident" id="1387450">nw</span>&nbsp;<span class="op" id="1387453">&gt;</span>&nbsp;<span class="num" id="1387455">0</span>&nbsp;<span class="op" id="1387457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387463">written</span>&nbsp;<span class="op" id="1387471">+=</span>&nbsp;<span class="ident" id="1387474">int64</span><span class="op" id="1387479">(</span><span class="ident" id="1387480">nw</span><span class="op" id="1387482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387492">if</span>&nbsp;<span class="ident" id="1387495">ew</span>&nbsp;<span class="op" id="1387498">!=</span>&nbsp;<span class="ident" id="1387501">nil</span>&nbsp;<span class="op" id="1387505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387511">err</span>&nbsp;<span class="op" id="1387515">=</span>&nbsp;<span class="ident" id="1387517">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387524">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387538">if</span>&nbsp;<span class="ident" id="1387541">nr</span>&nbsp;<span class="op" id="1387544">!=</span>&nbsp;<span class="ident" id="1387547">nw</span>&nbsp;<span class="op" id="1387550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387556">err</span>&nbsp;<span class="op" id="1387560">=</span>&nbsp;<span class="ident" id="1387562">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387580">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387597">if</span>&nbsp;<span class="ident" id="1387600">er</span>&nbsp;<span class="op" id="1387603">==</span>&nbsp;<span class="ident" id="1387606">EOF</span>&nbsp;<span class="op" id="1387610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387615">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387623">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387627">if</span>&nbsp;<span class="ident" id="1387630">er</span>&nbsp;<span class="op" id="1387633">!=</span>&nbsp;<span class="ident" id="1387636">nil</span>&nbsp;<span class="op" id="1387640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387645">err</span>&nbsp;<span class="op" id="1387649">=</span>&nbsp;<span class="ident" id="1387651">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387657">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387668">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387671">return</span>&nbsp;<span class="ident" id="1387678">written</span><span class="op" id="1387685">,</span>&nbsp;<span class="ident" id="1387687">err</span><br>
<span class="lineno"></span><span class="op" id="1387691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1387694">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1387744">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1387781">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1387835">func</span>&nbsp;<span class="ident" id="1387840">LimitReader</span><span class="op" id="1387851">(</span><span class="ident" id="1387852">r</span>&nbsp;<span class="ident" id="1387854">Reader</span><span class="op" id="1387860">,</span>&nbsp;<span class="ident" id="1387862">n</span>&nbsp;<span class="ident" id="1387864">int64</span><span class="op" id="1387869">)</span>&nbsp;<span class="ident" id="1387871">Reader</span>&nbsp;<span class="op" id="1387878">{</span>&nbsp;<span class="keyword" id="1387880">return</span>&nbsp;<span class="op" id="1387887">&amp;</span><span class="ident" id="1387888">LimitedReader</span><span class="op" id="1387901">{</span><span class="ident" id="1387902">r</span><span class="op" id="1387903">,</span>&nbsp;<span class="ident" id="1387905">n</span><span class="op" id="1387906">}</span>&nbsp;<span class="op" id="1387908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1387911">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1387968">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1388020">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1388070">type</span>&nbsp;<span class="ident" id="1388075">LimitedReader</span>&nbsp;<span class="keyword" id="1388089">struct</span>&nbsp;<span class="op" id="1388096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388099">R</span>&nbsp;<span class="ident" id="1388101">Reader</span>&nbsp;<span class="comment" id="1388108">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388130">N</span>&nbsp;<span class="ident" id="1388132">int64</span>&nbsp;&nbsp;<span class="comment" id="1388139">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1388162">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1388165">func</span>&nbsp;<span class="op" id="1388170">(</span><span class="ident" id="1388171">l</span>&nbsp;<span class="op" id="1388173">*</span><span class="ident" id="1388174">LimitedReader</span><span class="op" id="1388187">)</span>&nbsp;<span class="ident" id="1388189">Read</span><span class="op" id="1388193">(</span><span class="ident" id="1388194">p</span>&nbsp;<span class="op" id="1388196">[</span><span class="op" id="1388197">]</span><span class="builtintype" id="1388198">byte</span><span class="op" id="1388202">)</span>&nbsp;<span class="op" id="1388204">(</span><span class="ident" id="1388205">n</span>&nbsp;<span class="builtintype" id="1388207">int</span><span class="op" id="1388210">,</span>&nbsp;<span class="ident" id="1388212">err</span>&nbsp;<span class="builtintype" id="1388216">error</span><span class="op" id="1388221">)</span>&nbsp;<span class="op" id="1388223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388226">if</span>&nbsp;<span class="ident" id="1388229">l</span><span class="op" id="1388230">.</span><span class="ident" id="1388231">N</span>&nbsp;<span class="op" id="1388233">&lt;=</span>&nbsp;<span class="num" id="1388236">0</span>&nbsp;<span class="op" id="1388238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388242">return</span>&nbsp;<span class="num" id="1388249">0</span><span class="op" id="1388250">,</span>&nbsp;<span class="ident" id="1388252">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388257">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388260">if</span>&nbsp;<span class="ident" id="1388263">int64</span><span class="op" id="1388268">(</span><span class="builtinfunc" id="1388269">len</span><span class="op" id="1388272">(</span><span class="ident" id="1388273">p</span><span class="op" id="1388274">)</span><span class="op" id="1388275">)</span>&nbsp;<span class="op" id="1388277">&gt;</span>&nbsp;<span class="ident" id="1388279">l</span><span class="op" id="1388280">.</span><span class="ident" id="1388281">N</span>&nbsp;<span class="op" id="1388283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388287">p</span>&nbsp;<span class="op" id="1388289">=</span>&nbsp;<span class="ident" id="1388291">p</span><span class="op" id="1388292">[</span><span class="num" id="1388293">0</span><span class="op" id="1388294">:</span><span class="ident" id="1388295">l</span><span class="op" id="1388296">.</span><span class="ident" id="1388297">N</span><span class="op" id="1388298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388304">n</span><span class="op" id="1388305">,</span>&nbsp;<span class="ident" id="1388307">err</span>&nbsp;<span class="op" id="1388311">=</span>&nbsp;<span class="ident" id="1388313">l</span><span class="op" id="1388314">.</span><span class="ident" id="1388315">R</span><span class="op" id="1388316">.</span><span class="ident" id="1388317">Read</span><span class="op" id="1388321">(</span><span class="ident" id="1388322">p</span><span class="op" id="1388323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388326">l</span><span class="op" id="1388327">.</span><span class="ident" id="1388328">N</span>&nbsp;<span class="op" id="1388330">-=</span>&nbsp;<span class="ident" id="1388333">int64</span><span class="op" id="1388338">(</span><span class="ident" id="1388339">n</span><span class="op" id="1388340">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388343">return</span><br>
<span class="lineno"></span><span class="op" id="1388350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388353">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1388415">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1388475">func</span>&nbsp;<span class="ident" id="1388480">NewSectionReader</span><span class="op" id="1388496">(</span><span class="ident" id="1388497">r</span>&nbsp;<span class="ident" id="1388499">ReaderAt</span><span class="op" id="1388507">,</span>&nbsp;<span class="ident" id="1388509">off</span>&nbsp;<span class="ident" id="1388513">int64</span><span class="op" id="1388518">,</span>&nbsp;<span class="ident" id="1388520">n</span>&nbsp;<span class="ident" id="1388522">int64</span><span class="op" id="1388527">)</span>&nbsp;<span class="op" id="1388529">*</span><span class="ident" id="1388530">SectionReader</span>&nbsp;<span class="op" id="1388544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388547">return</span>&nbsp;<span class="op" id="1388554">&amp;</span><span class="ident" id="1388555">SectionReader</span><span class="op" id="1388568">{</span><span class="ident" id="1388569">r</span><span class="op" id="1388570">,</span>&nbsp;<span class="ident" id="1388572">off</span><span class="op" id="1388575">,</span>&nbsp;<span class="ident" id="1388577">off</span><span class="op" id="1388580">,</span>&nbsp;<span class="ident" id="1388582">off</span>&nbsp;<span class="op" id="1388586">+</span>&nbsp;<span class="ident" id="1388588">n</span><span class="op" id="1388589">}</span><br>
<span class="lineno"></span><span class="op" id="1388591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388594">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1388658">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1388688">type</span>&nbsp;<span class="ident" id="1388693">SectionReader</span>&nbsp;<span class="keyword" id="1388707">struct</span>&nbsp;<span class="op" id="1388714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388717">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1388723">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388733">base</span>&nbsp;&nbsp;<span class="ident" id="1388739">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388746">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1388752">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388759">limit</span>&nbsp;<span class="ident" id="1388765">int64</span><br>
<span class="lineno"></span><span class="op" id="1388771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1388774">func</span>&nbsp;<span class="op" id="1388779">(</span><span class="ident" id="1388780">s</span>&nbsp;<span class="op" id="1388782">*</span><span class="ident" id="1388783">SectionReader</span><span class="op" id="1388796">)</span>&nbsp;<span class="ident" id="1388798">Read</span><span class="op" id="1388802">(</span><span class="ident" id="1388803">p</span>&nbsp;<span class="op" id="1388805">[</span><span class="op" id="1388806">]</span><span class="builtintype" id="1388807">byte</span><span class="op" id="1388811">)</span>&nbsp;<span class="op" id="1388813">(</span><span class="ident" id="1388814">n</span>&nbsp;<span class="builtintype" id="1388816">int</span><span class="op" id="1388819">,</span>&nbsp;<span class="ident" id="1388821">err</span>&nbsp;<span class="builtintype" id="1388825">error</span><span class="op" id="1388830">)</span>&nbsp;<span class="op" id="1388832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388835">if</span>&nbsp;<span class="ident" id="1388838">s</span><span class="op" id="1388839">.</span><span class="ident" id="1388840">off</span>&nbsp;<span class="op" id="1388844">&gt;=</span>&nbsp;<span class="ident" id="1388847">s</span><span class="op" id="1388848">.</span><span class="ident" id="1388849">limit</span>&nbsp;<span class="op" id="1388855">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388859">return</span>&nbsp;<span class="num" id="1388866">0</span><span class="op" id="1388867">,</span>&nbsp;<span class="ident" id="1388869">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388877">if</span>&nbsp;<span class="ident" id="1388880">max</span>&nbsp;<span class="op" id="1388884">:=</span>&nbsp;<span class="ident" id="1388887">s</span><span class="op" id="1388888">.</span><span class="ident" id="1388889">limit</span>&nbsp;<span class="op" id="1388895">-</span>&nbsp;<span class="ident" id="1388897">s</span><span class="op" id="1388898">.</span><span class="ident" id="1388899">off</span><span class="op" id="1388902">;</span>&nbsp;<span class="ident" id="1388904">int64</span><span class="op" id="1388909">(</span><span class="builtinfunc" id="1388910">len</span><span class="op" id="1388913">(</span><span class="ident" id="1388914">p</span><span class="op" id="1388915">)</span><span class="op" id="1388916">)</span>&nbsp;<span class="op" id="1388918">&gt;</span>&nbsp;<span class="ident" id="1388920">max</span>&nbsp;<span class="op" id="1388924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388928">p</span>&nbsp;<span class="op" id="1388930">=</span>&nbsp;<span class="ident" id="1388932">p</span><span class="op" id="1388933">[</span><span class="num" id="1388934">0</span><span class="op" id="1388935">:</span><span class="ident" id="1388936">max</span><span class="op" id="1388939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388942">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388945">n</span><span class="op" id="1388946">,</span>&nbsp;<span class="ident" id="1388948">err</span>&nbsp;<span class="op" id="1388952">=</span>&nbsp;<span class="ident" id="1388954">s</span><span class="op" id="1388955">.</span><span class="ident" id="1388956">r</span><span class="op" id="1388957">.</span><span class="ident" id="1388958">ReadAt</span><span class="op" id="1388964">(</span><span class="ident" id="1388965">p</span><span class="op" id="1388966">,</span>&nbsp;<span class="ident" id="1388968">s</span><span class="op" id="1388969">.</span><span class="ident" id="1388970">off</span><span class="op" id="1388973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388976">s</span><span class="op" id="1388977">.</span><span class="ident" id="1388978">off</span>&nbsp;<span class="op" id="1388982">+=</span>&nbsp;<span class="ident" id="1388985">int64</span><span class="op" id="1388990">(</span><span class="ident" id="1388991">n</span><span class="op" id="1388992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388995">return</span><br>
<span class="lineno"></span><span class="op" id="1389002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1389005">var</span>&nbsp;<span class="ident" id="1389009">errWhence</span>&nbsp;<span class="op" id="1389019">=</span>&nbsp;<span class="ident" id="1389021">errors</span><span class="op" id="1389027">.</span><span class="ident" id="1389028">New</span><span class="op" id="1389031">(</span><span class="string" id="1389032">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1389054">)</span><br>
<span class="lineno"></span><span class="keyword" id="1389056">var</span>&nbsp;<span class="ident" id="1389060">errOffset</span>&nbsp;<span class="op" id="1389070">=</span>&nbsp;<span class="ident" id="1389072">errors</span><span class="op" id="1389078">.</span><span class="ident" id="1389079">New</span><span class="op" id="1389082">(</span><span class="string" id="1389083">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1389105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1389108">func</span>&nbsp;<span class="op" id="1389113">(</span><span class="ident" id="1389114">s</span>&nbsp;<span class="op" id="1389116">*</span><span class="ident" id="1389117">SectionReader</span><span class="op" id="1389130">)</span>&nbsp;<span class="ident" id="1389132">Seek</span><span class="op" id="1389136">(</span><span class="ident" id="1389137">offset</span>&nbsp;<span class="ident" id="1389144">int64</span><span class="op" id="1389149">,</span>&nbsp;<span class="ident" id="1389151">whence</span>&nbsp;<span class="builtintype" id="1389158">int</span><span class="op" id="1389161">)</span>&nbsp;<span class="op" id="1389163">(</span><span class="ident" id="1389164">int64</span><span class="op" id="1389169">,</span>&nbsp;<span class="builtintype" id="1389171">error</span><span class="op" id="1389176">)</span>&nbsp;<span class="op" id="1389178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389181">switch</span>&nbsp;<span class="ident" id="1389188">whence</span>&nbsp;<span class="op" id="1389195">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389198">default</span><span class="op" id="1389205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389209">return</span>&nbsp;<span class="num" id="1389216">0</span><span class="op" id="1389217">,</span>&nbsp;<span class="ident" id="1389219">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389230">case</span>&nbsp;<span class="num" id="1389235">0</span><span class="op" id="1389236">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389240">offset</span>&nbsp;<span class="op" id="1389247">+=</span>&nbsp;<span class="ident" id="1389250">s</span><span class="op" id="1389251">.</span><span class="ident" id="1389252">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389258">case</span>&nbsp;<span class="num" id="1389263">1</span><span class="op" id="1389264">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389268">offset</span>&nbsp;<span class="op" id="1389275">+=</span>&nbsp;<span class="ident" id="1389278">s</span><span class="op" id="1389279">.</span><span class="ident" id="1389280">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389285">case</span>&nbsp;<span class="num" id="1389290">2</span><span class="op" id="1389291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389295">offset</span>&nbsp;<span class="op" id="1389302">+=</span>&nbsp;<span class="ident" id="1389305">s</span><span class="op" id="1389306">.</span><span class="ident" id="1389307">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389317">if</span>&nbsp;<span class="ident" id="1389320">offset</span>&nbsp;<span class="op" id="1389327">&lt;</span>&nbsp;<span class="ident" id="1389329">s</span><span class="op" id="1389330">.</span><span class="ident" id="1389331">base</span>&nbsp;<span class="op" id="1389336">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389340">return</span>&nbsp;<span class="num" id="1389347">0</span><span class="op" id="1389348">,</span>&nbsp;<span class="ident" id="1389350">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389364">s</span><span class="op" id="1389365">.</span><span class="ident" id="1389366">off</span>&nbsp;<span class="op" id="1389370">=</span>&nbsp;<span class="ident" id="1389372">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389380">return</span>&nbsp;<span class="ident" id="1389387">offset</span>&nbsp;<span class="op" id="1389394">-</span>&nbsp;<span class="ident" id="1389396">s</span><span class="op" id="1389397">.</span><span class="ident" id="1389398">base</span><span class="op" id="1389402">,</span>&nbsp;<span class="ident" id="1389404">nil</span><br>
<span class="lineno"></span><span class="op" id="1389408">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1389411">func</span>&nbsp;<span class="op" id="1389416">(</span><span class="ident" id="1389417">s</span>&nbsp;<span class="op" id="1389419">*</span><span class="ident" id="1389420">SectionReader</span><span class="op" id="1389433">)</span>&nbsp;<span class="ident" id="1389435">ReadAt</span><span class="op" id="1389441">(</span><span class="ident" id="1389442">p</span>&nbsp;<span class="op" id="1389444">[</span><span class="op" id="1389445">]</span><span class="builtintype" id="1389446">byte</span><span class="op" id="1389450">,</span>&nbsp;<span class="ident" id="1389452">off</span>&nbsp;<span class="ident" id="1389456">int64</span><span class="op" id="1389461">)</span>&nbsp;<span class="op" id="1389463">(</span><span class="ident" id="1389464">n</span>&nbsp;<span class="builtintype" id="1389466">int</span><span class="op" id="1389469">,</span>&nbsp;<span class="ident" id="1389471">err</span>&nbsp;<span class="builtintype" id="1389475">error</span><span class="op" id="1389480">)</span>&nbsp;<span class="op" id="1389482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389485">if</span>&nbsp;<span class="ident" id="1389488">off</span>&nbsp;<span class="op" id="1389492">&lt;</span>&nbsp;<span class="num" id="1389494">0</span>&nbsp;<span class="op" id="1389496">||</span>&nbsp;<span class="ident" id="1389499">off</span>&nbsp;<span class="op" id="1389503">&gt;=</span>&nbsp;<span class="ident" id="1389506">s</span><span class="op" id="1389507">.</span><span class="ident" id="1389508">limit</span><span class="op" id="1389513">-</span><span class="ident" id="1389514">s</span><span class="op" id="1389515">.</span><span class="ident" id="1389516">base</span>&nbsp;<span class="op" id="1389521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389525">return</span>&nbsp;<span class="num" id="1389532">0</span><span class="op" id="1389533">,</span>&nbsp;<span class="ident" id="1389535">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389540">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389543">off</span>&nbsp;<span class="op" id="1389547">+=</span>&nbsp;<span class="ident" id="1389550">s</span><span class="op" id="1389551">.</span><span class="ident" id="1389552">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389558">if</span>&nbsp;<span class="ident" id="1389561">max</span>&nbsp;<span class="op" id="1389565">:=</span>&nbsp;<span class="ident" id="1389568">s</span><span class="op" id="1389569">.</span><span class="ident" id="1389570">limit</span>&nbsp;<span class="op" id="1389576">-</span>&nbsp;<span class="ident" id="1389578">off</span><span class="op" id="1389581">;</span>&nbsp;<span class="ident" id="1389583">int64</span><span class="op" id="1389588">(</span><span class="builtinfunc" id="1389589">len</span><span class="op" id="1389592">(</span><span class="ident" id="1389593">p</span><span class="op" id="1389594">)</span><span class="op" id="1389595">)</span>&nbsp;<span class="op" id="1389597">&gt;</span>&nbsp;<span class="ident" id="1389599">max</span>&nbsp;<span class="op" id="1389603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389607">p</span>&nbsp;<span class="op" id="1389609">=</span>&nbsp;<span class="ident" id="1389611">p</span><span class="op" id="1389612">[</span><span class="num" id="1389613">0</span><span class="op" id="1389614">:</span><span class="ident" id="1389615">max</span><span class="op" id="1389618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389622">n</span><span class="op" id="1389623">,</span>&nbsp;<span class="ident" id="1389625">err</span>&nbsp;<span class="op" id="1389629">=</span>&nbsp;<span class="ident" id="1389631">s</span><span class="op" id="1389632">.</span><span class="ident" id="1389633">r</span><span class="op" id="1389634">.</span><span class="ident" id="1389635">ReadAt</span><span class="op" id="1389641">(</span><span class="ident" id="1389642">p</span><span class="op" id="1389643">,</span>&nbsp;<span class="ident" id="1389645">off</span><span class="op" id="1389648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389652">if</span>&nbsp;<span class="ident" id="1389655">err</span>&nbsp;<span class="op" id="1389659">==</span>&nbsp;<span class="ident" id="1389662">nil</span>&nbsp;<span class="op" id="1389666">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389671">err</span>&nbsp;<span class="op" id="1389675">=</span>&nbsp;<span class="ident" id="1389677">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389687">return</span>&nbsp;<span class="ident" id="1389694">n</span><span class="op" id="1389695">,</span>&nbsp;<span class="ident" id="1389697">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389705">return</span>&nbsp;<span class="ident" id="1389712">s</span><span class="op" id="1389713">.</span><span class="ident" id="1389714">r</span><span class="op" id="1389715">.</span><span class="ident" id="1389716">ReadAt</span><span class="op" id="1389722">(</span><span class="ident" id="1389723">p</span><span class="op" id="1389724">,</span>&nbsp;<span class="ident" id="1389726">off</span><span class="op" id="1389729">)</span><br>
<span class="lineno">475</span><span class="op" id="1389731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389734">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1389784">func</span>&nbsp;<span class="op" id="1389789">(</span><span class="ident" id="1389790">s</span>&nbsp;<span class="op" id="1389792">*</span><span class="ident" id="1389793">SectionReader</span><span class="op" id="1389806">)</span>&nbsp;<span class="ident" id="1389808">Size</span><span class="op" id="1389812">(</span><span class="op" id="1389813">)</span>&nbsp;<span class="ident" id="1389815">int64</span>&nbsp;<span class="op" id="1389821">{</span>&nbsp;<span class="keyword" id="1389823">return</span>&nbsp;<span class="ident" id="1389830">s</span><span class="op" id="1389831">.</span><span class="ident" id="1389832">limit</span>&nbsp;<span class="op" id="1389838">-</span>&nbsp;<span class="ident" id="1389840">s</span><span class="op" id="1389841">.</span><span class="ident" id="1389842">base</span>&nbsp;<span class="op" id="1389847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1389850">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1389919">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1389977">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1390041">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1390095">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1390163">func</span>&nbsp;<span class="ident" id="1390168">TeeReader</span><span class="op" id="1390177">(</span><span class="ident" id="1390178">r</span>&nbsp;<span class="ident" id="1390180">Reader</span><span class="op" id="1390186">,</span>&nbsp;<span class="ident" id="1390188">w</span>&nbsp;<span class="ident" id="1390190">Writer</span><span class="op" id="1390196">)</span>&nbsp;<span class="ident" id="1390198">Reader</span>&nbsp;<span class="op" id="1390205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390208">return</span>&nbsp;<span class="op" id="1390215">&amp;</span><span class="ident" id="1390216">teeReader</span><span class="op" id="1390225">{</span><span class="ident" id="1390226">r</span><span class="op" id="1390227">,</span>&nbsp;<span class="ident" id="1390229">w</span><span class="op" id="1390230">}</span><br>
<span class="lineno"></span><span class="op" id="1390232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1390235">type</span>&nbsp;<span class="ident" id="1390240">teeReader</span>&nbsp;<span class="keyword" id="1390250">struct</span>&nbsp;<span class="op" id="1390257">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390260">r</span>&nbsp;<span class="ident" id="1390262">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390270">w</span>&nbsp;<span class="ident" id="1390272">Writer</span><br>
<span class="lineno"></span><span class="op" id="1390279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1390282">func</span>&nbsp;<span class="op" id="1390287">(</span><span class="ident" id="1390288">t</span>&nbsp;<span class="op" id="1390290">*</span><span class="ident" id="1390291">teeReader</span><span class="op" id="1390300">)</span>&nbsp;<span class="ident" id="1390302">Read</span><span class="op" id="1390306">(</span><span class="ident" id="1390307">p</span>&nbsp;<span class="op" id="1390309">[</span><span class="op" id="1390310">]</span><span class="builtintype" id="1390311">byte</span><span class="op" id="1390315">)</span>&nbsp;<span class="op" id="1390317">(</span><span class="ident" id="1390318">n</span>&nbsp;<span class="builtintype" id="1390320">int</span><span class="op" id="1390323">,</span>&nbsp;<span class="ident" id="1390325">err</span>&nbsp;<span class="builtintype" id="1390329">error</span><span class="op" id="1390334">)</span>&nbsp;<span class="op" id="1390336">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390339">n</span><span class="op" id="1390340">,</span>&nbsp;<span class="ident" id="1390342">err</span>&nbsp;<span class="op" id="1390346">=</span>&nbsp;<span class="ident" id="1390348">t</span><span class="op" id="1390349">.</span><span class="ident" id="1390350">r</span><span class="op" id="1390351">.</span><span class="ident" id="1390352">Read</span><span class="op" id="1390356">(</span><span class="ident" id="1390357">p</span><span class="op" id="1390358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390361">if</span>&nbsp;<span class="ident" id="1390364">n</span>&nbsp;<span class="op" id="1390366">&gt;</span>&nbsp;<span class="num" id="1390368">0</span>&nbsp;<span class="op" id="1390370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390374">if</span>&nbsp;<span class="ident" id="1390377">n</span><span class="op" id="1390378">,</span>&nbsp;<span class="ident" id="1390380">err</span>&nbsp;<span class="op" id="1390384">:=</span>&nbsp;<span class="ident" id="1390387">t</span><span class="op" id="1390388">.</span><span class="ident" id="1390389">w</span><span class="op" id="1390390">.</span><span class="ident" id="1390391">Write</span><span class="op" id="1390396">(</span><span class="ident" id="1390397">p</span><span class="op" id="1390398">[</span><span class="op" id="1390399">:</span><span class="ident" id="1390400">n</span><span class="op" id="1390401">]</span><span class="op" id="1390402">)</span><span class="op" id="1390403">;</span>&nbsp;<span class="ident" id="1390405">err</span>&nbsp;<span class="op" id="1390409">!=</span>&nbsp;<span class="ident" id="1390412">nil</span>&nbsp;<span class="op" id="1390416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390421">return</span>&nbsp;<span class="ident" id="1390428">n</span><span class="op" id="1390429">,</span>&nbsp;<span class="ident" id="1390431">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1390437">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1390440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390443">return</span><br>
<span class="lineno"></span><span class="op" id="1390450">}</span>
</div>
</body>
</html>
