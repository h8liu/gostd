<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4065520">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4065575">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4065629">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4065680">//&nbsp;Package&nbsp;cipher&nbsp;implements&nbsp;standard&nbsp;block&nbsp;cipher&nbsp;modes&nbsp;that&nbsp;can&nbsp;be&nbsp;wrapped</span><br>
<span class="lineno"></span><span class="comment" id="4065757">//&nbsp;around&nbsp;low-level&nbsp;block&nbsp;cipher&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="comment" id="4065807">//&nbsp;See&nbsp;http://csrc.nist.gov/groups/ST/toolkit/BCM/current_modes.html</span><br>
<span class="lineno"></span><span class="comment" id="4065876">//&nbsp;and&nbsp;NIST&nbsp;Special&nbsp;Publication&nbsp;800-38A.</span><br>
<span class="lineno"></span><span class="keyword" id="4065917">package</span>&nbsp;<span class="ident" id="4065925">cipher</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4065933">//&nbsp;A&nbsp;Block&nbsp;represents&nbsp;an&nbsp;implementation&nbsp;of&nbsp;block&nbsp;cipher</span><br>
<span class="lineno"></span><span class="comment" id="4065989">//&nbsp;using&nbsp;a&nbsp;given&nbsp;key.&nbsp;&nbsp;It&nbsp;provides&nbsp;the&nbsp;capability&nbsp;to&nbsp;encrypt</span><br>
<span class="lineno"></span><span class="comment" id="4066050">//&nbsp;or&nbsp;decrypt&nbsp;individual&nbsp;blocks.&nbsp;&nbsp;The&nbsp;mode&nbsp;implementations</span><br>
<span class="lineno"></span><span class="comment" id="4066109">//&nbsp;extend&nbsp;that&nbsp;capability&nbsp;to&nbsp;streams&nbsp;of&nbsp;blocks.</span><br>
<span class="lineno">15</span><span class="keyword" id="4066157">type</span>&nbsp;<span class="ident" id="4066162">Block</span>&nbsp;<span class="keyword" id="4066168">interface</span>&nbsp;<span class="op" id="4066178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066181">//&nbsp;BlockSize&nbsp;returns&nbsp;the&nbsp;cipher&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066228">BlockSize</span><span class="op" id="4066237">(</span><span class="op" id="4066238">)</span>&nbsp;<span class="builtintype" id="4066240">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066246">//&nbsp;Encrypt&nbsp;encrypts&nbsp;the&nbsp;first&nbsp;block&nbsp;in&nbsp;src&nbsp;into&nbsp;dst.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066300">//&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;point&nbsp;at&nbsp;the&nbsp;same&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066346">Encrypt</span><span class="op" id="4066353">(</span><span class="ident" id="4066354">dst</span><span class="op" id="4066357">,</span>&nbsp;<span class="ident" id="4066359">src</span>&nbsp;<span class="op" id="4066363">[</span><span class="op" id="4066364">]</span><span class="builtintype" id="4066365">byte</span><span class="op" id="4066369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066373">//&nbsp;Decrypt&nbsp;decrypts&nbsp;the&nbsp;first&nbsp;block&nbsp;in&nbsp;src&nbsp;into&nbsp;dst.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066427">//&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;point&nbsp;at&nbsp;the&nbsp;same&nbsp;memory.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066473">Decrypt</span><span class="op" id="4066480">(</span><span class="ident" id="4066481">dst</span><span class="op" id="4066484">,</span>&nbsp;<span class="ident" id="4066486">src</span>&nbsp;<span class="op" id="4066490">[</span><span class="op" id="4066491">]</span><span class="builtintype" id="4066492">byte</span><span class="op" id="4066496">)</span><br>
<span class="lineno"></span><span class="op" id="4066498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4066501">//&nbsp;A&nbsp;Stream&nbsp;represents&nbsp;a&nbsp;stream&nbsp;cipher.</span><br>
<span class="lineno"></span><span class="keyword" id="4066541">type</span>&nbsp;<span class="ident" id="4066546">Stream</span>&nbsp;<span class="keyword" id="4066553">interface</span>&nbsp;<span class="op" id="4066563">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066566">//&nbsp;XORKeyStream&nbsp;XORs&nbsp;each&nbsp;byte&nbsp;in&nbsp;the&nbsp;given&nbsp;slice&nbsp;with&nbsp;a&nbsp;byte&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066638">//&nbsp;cipher&#39;s&nbsp;key&nbsp;stream.&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066705">XORKeyStream</span><span class="op" id="4066717">(</span><span class="ident" id="4066718">dst</span><span class="op" id="4066721">,</span>&nbsp;<span class="ident" id="4066723">src</span>&nbsp;<span class="op" id="4066727">[</span><span class="op" id="4066728">]</span><span class="builtintype" id="4066729">byte</span><span class="op" id="4066733">)</span><br>
<span class="lineno"></span><span class="op" id="4066735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4066738">//&nbsp;A&nbsp;BlockMode&nbsp;represents&nbsp;a&nbsp;block&nbsp;cipher&nbsp;running&nbsp;in&nbsp;a&nbsp;block-based&nbsp;mode&nbsp;(CBC,</span><br>
<span class="lineno"></span><span class="comment" id="4066815">//&nbsp;ECB&nbsp;etc).</span><br>
<span class="lineno"></span><span class="keyword" id="4066828">type</span>&nbsp;<span class="ident" id="4066833">BlockMode</span>&nbsp;<span class="keyword" id="4066843">interface</span>&nbsp;<span class="op" id="4066853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066856">//&nbsp;BlockSize&nbsp;returns&nbsp;the&nbsp;mode&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4066901">BlockSize</span><span class="op" id="4066910">(</span><span class="op" id="4066911">)</span>&nbsp;<span class="builtintype" id="4066913">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066919">//&nbsp;CryptBlocks&nbsp;encrypts&nbsp;or&nbsp;decrypts&nbsp;a&nbsp;number&nbsp;of&nbsp;blocks.&nbsp;The&nbsp;length&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4066990">//&nbsp;src&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;the&nbsp;block&nbsp;size.&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;point&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4067061">//&nbsp;the&nbsp;same&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067082">CryptBlocks</span><span class="op" id="4067093">(</span><span class="ident" id="4067094">dst</span><span class="op" id="4067097">,</span>&nbsp;<span class="ident" id="4067099">src</span>&nbsp;<span class="op" id="4067103">[</span><span class="op" id="4067104">]</span><span class="builtintype" id="4067105">byte</span><span class="op" id="4067109">)</span><br>
<span class="lineno">45</span><span class="op" id="4067111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067114">//&nbsp;Utility&nbsp;routines</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4067135">func</span>&nbsp;<span class="ident" id="4067140">dup</span><span class="op" id="4067143">(</span><span class="ident" id="4067144">p</span>&nbsp;<span class="op" id="4067146">[</span><span class="op" id="4067147">]</span><span class="builtintype" id="4067148">byte</span><span class="op" id="4067152">)</span>&nbsp;<span class="op" id="4067154">[</span><span class="op" id="4067155">]</span><span class="builtintype" id="4067156">byte</span>&nbsp;<span class="op" id="4067161">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4067164">q</span>&nbsp;<span class="op" id="4067166">:=</span>&nbsp;<span class="builtinfunc" id="4067169">make</span><span class="op" id="4067173">(</span><span class="op" id="4067174">[</span><span class="op" id="4067175">]</span><span class="builtintype" id="4067176">byte</span><span class="op" id="4067180">,</span>&nbsp;<span class="builtinfunc" id="4067182">len</span><span class="op" id="4067185">(</span><span class="ident" id="4067186"><a href="/crypto/cipher/cipher.go.html#4067144">p</a></span><span class="op" id="4067187">)</span><span class="op" id="4067188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4067191">copy</span><span class="op" id="4067195">(</span><span class="ident" id="4067196"><a href="/crypto/cipher/cipher.go.html#4067164">q</a></span><span class="op" id="4067197">,</span>&nbsp;<span class="ident" id="4067199"><a href="/crypto/cipher/cipher.go.html#4067144">p</a></span><span class="op" id="4067200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4067203">return</span>&nbsp;<span class="ident" id="4067210"><a href="/crypto/cipher/cipher.go.html#4067164">q</a></span><br>
<span class="lineno"></span><span class="op" id="4067212">}</span>
</div>
</body>
</html>
