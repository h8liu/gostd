<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1751258">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1751313">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1751367">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1751418">package</span>&nbsp;<span class="ident" id="1751426">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1751435">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="1751506">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1751569">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="1751641">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="1751665">type</span>&nbsp;<span class="ident" id="1751670">extFloat</span>&nbsp;<span class="keyword" id="1751679">struct</span>&nbsp;<span class="op" id="1751686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751689">mant</span>&nbsp;<span class="ident" id="1751694">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751702">exp</span>&nbsp;&nbsp;<span class="builtintype" id="1751707">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751712">neg</span>&nbsp;&nbsp;<span class="builtintype" id="1751717">bool</span><br>
<span class="lineno">15</span><span class="op" id="1751722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1751725">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="1751780">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="1751827">const</span>&nbsp;<span class="op" id="1751833">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751836">firstPowerOfTen</span>&nbsp;<span class="op" id="1751852">=</span>&nbsp;<span class="op" id="1751854">-</span><span class="num" id="1751855">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751860">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="1751876">=</span>&nbsp;<span class="num" id="1751878">8</span><br>
<span class="lineno"></span><span class="op" id="1751880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1751883">var</span>&nbsp;<span class="ident" id="1751887">smallPowersOfTen</span>&nbsp;<span class="op" id="1751904">=</span>&nbsp;<span class="op" id="1751906">[</span><span class="op" id="1751907">...</span><span class="op" id="1751910">]</span><span class="ident" id="1751911">extFloat</span><span class="op" id="1751919">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751922">{</span><span class="num" id="1751923">1</span>&nbsp;<span class="op" id="1751925">&lt;&lt;</span>&nbsp;<span class="num" id="1751928">63</span><span class="op" id="1751930">,</span>&nbsp;<span class="op" id="1751932">-</span><span class="num" id="1751933">63</span><span class="op" id="1751935">,</span>&nbsp;<span class="builtintype" id="1751937">false</span><span class="op" id="1751942">}</span><span class="op" id="1751943">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1751952">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751958">{</span><span class="num" id="1751959">0xa</span>&nbsp;<span class="op" id="1751963">&lt;&lt;</span>&nbsp;<span class="num" id="1751966">60</span><span class="op" id="1751968">,</span>&nbsp;<span class="op" id="1751970">-</span><span class="num" id="1751971">60</span><span class="op" id="1751973">,</span>&nbsp;<span class="builtintype" id="1751975">false</span><span class="op" id="1751980">}</span><span class="op" id="1751981">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1751988">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751996">{</span><span class="num" id="1751997">0x64</span>&nbsp;<span class="op" id="1752002">&lt;&lt;</span>&nbsp;<span class="num" id="1752005">57</span><span class="op" id="1752007">,</span>&nbsp;<span class="op" id="1752009">-</span><span class="num" id="1752010">57</span><span class="op" id="1752012">,</span>&nbsp;<span class="builtintype" id="1752014">false</span><span class="op" id="1752019">}</span><span class="op" id="1752020">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1752026">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752034">{</span><span class="num" id="1752035">0x3e8</span>&nbsp;<span class="op" id="1752041">&lt;&lt;</span>&nbsp;<span class="num" id="1752044">54</span><span class="op" id="1752046">,</span>&nbsp;<span class="op" id="1752048">-</span><span class="num" id="1752049">54</span><span class="op" id="1752051">,</span>&nbsp;<span class="builtintype" id="1752053">false</span><span class="op" id="1752058">}</span><span class="op" id="1752059">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1752064">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752072">{</span><span class="num" id="1752073">0x2710</span>&nbsp;<span class="op" id="1752080">&lt;&lt;</span>&nbsp;<span class="num" id="1752083">50</span><span class="op" id="1752085">,</span>&nbsp;<span class="op" id="1752087">-</span><span class="num" id="1752088">50</span><span class="op" id="1752090">,</span>&nbsp;<span class="builtintype" id="1752092">false</span><span class="op" id="1752097">}</span><span class="op" id="1752098">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1752102">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752110">{</span><span class="num" id="1752111">0x186a0</span>&nbsp;<span class="op" id="1752119">&lt;&lt;</span>&nbsp;<span class="num" id="1752122">47</span><span class="op" id="1752124">,</span>&nbsp;<span class="op" id="1752126">-</span><span class="num" id="1752127">47</span><span class="op" id="1752129">,</span>&nbsp;<span class="builtintype" id="1752131">false</span><span class="op" id="1752136">}</span><span class="op" id="1752137">,</span>&nbsp;&nbsp;<span class="comment" id="1752140">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752148">{</span><span class="num" id="1752149">0xf4240</span>&nbsp;<span class="op" id="1752157">&lt;&lt;</span>&nbsp;<span class="num" id="1752160">44</span><span class="op" id="1752162">,</span>&nbsp;<span class="op" id="1752164">-</span><span class="num" id="1752165">44</span><span class="op" id="1752167">,</span>&nbsp;<span class="builtintype" id="1752169">false</span><span class="op" id="1752174">}</span><span class="op" id="1752175">,</span>&nbsp;&nbsp;<span class="comment" id="1752178">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752186">{</span><span class="num" id="1752187">0x989680</span>&nbsp;<span class="op" id="1752196">&lt;&lt;</span>&nbsp;<span class="num" id="1752199">40</span><span class="op" id="1752201">,</span>&nbsp;<span class="op" id="1752203">-</span><span class="num" id="1752204">40</span><span class="op" id="1752206">,</span>&nbsp;<span class="builtintype" id="1752208">false</span><span class="op" id="1752213">}</span><span class="op" id="1752214">,</span>&nbsp;<span class="comment" id="1752216">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="1752223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="1752226">var</span>&nbsp;<span class="ident" id="1752230">powersOfTen</span>&nbsp;<span class="op" id="1752242">=</span>&nbsp;<span class="op" id="1752244">[</span><span class="op" id="1752245">...</span><span class="op" id="1752248">]</span><span class="ident" id="1752249">extFloat</span><span class="op" id="1752257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752260">{</span><span class="num" id="1752261">0xfa8fd5a0081c0288</span><span class="op" id="1752279">,</span>&nbsp;<span class="op" id="1752281">-</span><span class="num" id="1752282">1220</span><span class="op" id="1752286">,</span>&nbsp;<span class="builtintype" id="1752288">false</span><span class="op" id="1752293">}</span><span class="op" id="1752294">,</span>&nbsp;<span class="comment" id="1752296">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752308">{</span><span class="num" id="1752309">0xbaaee17fa23ebf76</span><span class="op" id="1752327">,</span>&nbsp;<span class="op" id="1752329">-</span><span class="num" id="1752330">1193</span><span class="op" id="1752334">,</span>&nbsp;<span class="builtintype" id="1752336">false</span><span class="op" id="1752341">}</span><span class="op" id="1752342">,</span>&nbsp;<span class="comment" id="1752344">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752356">{</span><span class="num" id="1752357">0x8b16fb203055ac76</span><span class="op" id="1752375">,</span>&nbsp;<span class="op" id="1752377">-</span><span class="num" id="1752378">1166</span><span class="op" id="1752382">,</span>&nbsp;<span class="builtintype" id="1752384">false</span><span class="op" id="1752389">}</span><span class="op" id="1752390">,</span>&nbsp;<span class="comment" id="1752392">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752404">{</span><span class="num" id="1752405">0xcf42894a5dce35ea</span><span class="op" id="1752423">,</span>&nbsp;<span class="op" id="1752425">-</span><span class="num" id="1752426">1140</span><span class="op" id="1752430">,</span>&nbsp;<span class="builtintype" id="1752432">false</span><span class="op" id="1752437">}</span><span class="op" id="1752438">,</span>&nbsp;<span class="comment" id="1752440">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752452">{</span><span class="num" id="1752453">0x9a6bb0aa55653b2d</span><span class="op" id="1752471">,</span>&nbsp;<span class="op" id="1752473">-</span><span class="num" id="1752474">1113</span><span class="op" id="1752478">,</span>&nbsp;<span class="builtintype" id="1752480">false</span><span class="op" id="1752485">}</span><span class="op" id="1752486">,</span>&nbsp;<span class="comment" id="1752488">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752500">{</span><span class="num" id="1752501">0xe61acf033d1a45df</span><span class="op" id="1752519">,</span>&nbsp;<span class="op" id="1752521">-</span><span class="num" id="1752522">1087</span><span class="op" id="1752526">,</span>&nbsp;<span class="builtintype" id="1752528">false</span><span class="op" id="1752533">}</span><span class="op" id="1752534">,</span>&nbsp;<span class="comment" id="1752536">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752548">{</span><span class="num" id="1752549">0xab70fe17c79ac6ca</span><span class="op" id="1752567">,</span>&nbsp;<span class="op" id="1752569">-</span><span class="num" id="1752570">1060</span><span class="op" id="1752574">,</span>&nbsp;<span class="builtintype" id="1752576">false</span><span class="op" id="1752581">}</span><span class="op" id="1752582">,</span>&nbsp;<span class="comment" id="1752584">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752596">{</span><span class="num" id="1752597">0xff77b1fcbebcdc4f</span><span class="op" id="1752615">,</span>&nbsp;<span class="op" id="1752617">-</span><span class="num" id="1752618">1034</span><span class="op" id="1752622">,</span>&nbsp;<span class="builtintype" id="1752624">false</span><span class="op" id="1752629">}</span><span class="op" id="1752630">,</span>&nbsp;<span class="comment" id="1752632">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752644">{</span><span class="num" id="1752645">0xbe5691ef416bd60c</span><span class="op" id="1752663">,</span>&nbsp;<span class="op" id="1752665">-</span><span class="num" id="1752666">1007</span><span class="op" id="1752670">,</span>&nbsp;<span class="builtintype" id="1752672">false</span><span class="op" id="1752677">}</span><span class="op" id="1752678">,</span>&nbsp;<span class="comment" id="1752680">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752692">{</span><span class="num" id="1752693">0x8dd01fad907ffc3c</span><span class="op" id="1752711">,</span>&nbsp;<span class="op" id="1752713">-</span><span class="num" id="1752714">980</span><span class="op" id="1752717">,</span>&nbsp;<span class="builtintype" id="1752719">false</span><span class="op" id="1752724">}</span><span class="op" id="1752725">,</span>&nbsp;&nbsp;<span class="comment" id="1752728">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752740">{</span><span class="num" id="1752741">0xd3515c2831559a83</span><span class="op" id="1752759">,</span>&nbsp;<span class="op" id="1752761">-</span><span class="num" id="1752762">954</span><span class="op" id="1752765">,</span>&nbsp;<span class="builtintype" id="1752767">false</span><span class="op" id="1752772">}</span><span class="op" id="1752773">,</span>&nbsp;&nbsp;<span class="comment" id="1752776">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752788">{</span><span class="num" id="1752789">0x9d71ac8fada6c9b5</span><span class="op" id="1752807">,</span>&nbsp;<span class="op" id="1752809">-</span><span class="num" id="1752810">927</span><span class="op" id="1752813">,</span>&nbsp;<span class="builtintype" id="1752815">false</span><span class="op" id="1752820">}</span><span class="op" id="1752821">,</span>&nbsp;&nbsp;<span class="comment" id="1752824">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752836">{</span><span class="num" id="1752837">0xea9c227723ee8bcb</span><span class="op" id="1752855">,</span>&nbsp;<span class="op" id="1752857">-</span><span class="num" id="1752858">901</span><span class="op" id="1752861">,</span>&nbsp;<span class="builtintype" id="1752863">false</span><span class="op" id="1752868">}</span><span class="op" id="1752869">,</span>&nbsp;&nbsp;<span class="comment" id="1752872">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752884">{</span><span class="num" id="1752885">0xaecc49914078536d</span><span class="op" id="1752903">,</span>&nbsp;<span class="op" id="1752905">-</span><span class="num" id="1752906">874</span><span class="op" id="1752909">,</span>&nbsp;<span class="builtintype" id="1752911">false</span><span class="op" id="1752916">}</span><span class="op" id="1752917">,</span>&nbsp;&nbsp;<span class="comment" id="1752920">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752932">{</span><span class="num" id="1752933">0x823c12795db6ce57</span><span class="op" id="1752951">,</span>&nbsp;<span class="op" id="1752953">-</span><span class="num" id="1752954">847</span><span class="op" id="1752957">,</span>&nbsp;<span class="builtintype" id="1752959">false</span><span class="op" id="1752964">}</span><span class="op" id="1752965">,</span>&nbsp;&nbsp;<span class="comment" id="1752968">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752980">{</span><span class="num" id="1752981">0xc21094364dfb5637</span><span class="op" id="1752999">,</span>&nbsp;<span class="op" id="1753001">-</span><span class="num" id="1753002">821</span><span class="op" id="1753005">,</span>&nbsp;<span class="builtintype" id="1753007">false</span><span class="op" id="1753012">}</span><span class="op" id="1753013">,</span>&nbsp;&nbsp;<span class="comment" id="1753016">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753028">{</span><span class="num" id="1753029">0x9096ea6f3848984f</span><span class="op" id="1753047">,</span>&nbsp;<span class="op" id="1753049">-</span><span class="num" id="1753050">794</span><span class="op" id="1753053">,</span>&nbsp;<span class="builtintype" id="1753055">false</span><span class="op" id="1753060">}</span><span class="op" id="1753061">,</span>&nbsp;&nbsp;<span class="comment" id="1753064">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753076">{</span><span class="num" id="1753077">0xd77485cb25823ac7</span><span class="op" id="1753095">,</span>&nbsp;<span class="op" id="1753097">-</span><span class="num" id="1753098">768</span><span class="op" id="1753101">,</span>&nbsp;<span class="builtintype" id="1753103">false</span><span class="op" id="1753108">}</span><span class="op" id="1753109">,</span>&nbsp;&nbsp;<span class="comment" id="1753112">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753124">{</span><span class="num" id="1753125">0xa086cfcd97bf97f4</span><span class="op" id="1753143">,</span>&nbsp;<span class="op" id="1753145">-</span><span class="num" id="1753146">741</span><span class="op" id="1753149">,</span>&nbsp;<span class="builtintype" id="1753151">false</span><span class="op" id="1753156">}</span><span class="op" id="1753157">,</span>&nbsp;&nbsp;<span class="comment" id="1753160">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753172">{</span><span class="num" id="1753173">0xef340a98172aace5</span><span class="op" id="1753191">,</span>&nbsp;<span class="op" id="1753193">-</span><span class="num" id="1753194">715</span><span class="op" id="1753197">,</span>&nbsp;<span class="builtintype" id="1753199">false</span><span class="op" id="1753204">}</span><span class="op" id="1753205">,</span>&nbsp;&nbsp;<span class="comment" id="1753208">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753220">{</span><span class="num" id="1753221">0xb23867fb2a35b28e</span><span class="op" id="1753239">,</span>&nbsp;<span class="op" id="1753241">-</span><span class="num" id="1753242">688</span><span class="op" id="1753245">,</span>&nbsp;<span class="builtintype" id="1753247">false</span><span class="op" id="1753252">}</span><span class="op" id="1753253">,</span>&nbsp;&nbsp;<span class="comment" id="1753256">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753268">{</span><span class="num" id="1753269">0x84c8d4dfd2c63f3b</span><span class="op" id="1753287">,</span>&nbsp;<span class="op" id="1753289">-</span><span class="num" id="1753290">661</span><span class="op" id="1753293">,</span>&nbsp;<span class="builtintype" id="1753295">false</span><span class="op" id="1753300">}</span><span class="op" id="1753301">,</span>&nbsp;&nbsp;<span class="comment" id="1753304">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753316">{</span><span class="num" id="1753317">0xc5dd44271ad3cdba</span><span class="op" id="1753335">,</span>&nbsp;<span class="op" id="1753337">-</span><span class="num" id="1753338">635</span><span class="op" id="1753341">,</span>&nbsp;<span class="builtintype" id="1753343">false</span><span class="op" id="1753348">}</span><span class="op" id="1753349">,</span>&nbsp;&nbsp;<span class="comment" id="1753352">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753364">{</span><span class="num" id="1753365">0x936b9fcebb25c996</span><span class="op" id="1753383">,</span>&nbsp;<span class="op" id="1753385">-</span><span class="num" id="1753386">608</span><span class="op" id="1753389">,</span>&nbsp;<span class="builtintype" id="1753391">false</span><span class="op" id="1753396">}</span><span class="op" id="1753397">,</span>&nbsp;&nbsp;<span class="comment" id="1753400">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753412">{</span><span class="num" id="1753413">0xdbac6c247d62a584</span><span class="op" id="1753431">,</span>&nbsp;<span class="op" id="1753433">-</span><span class="num" id="1753434">582</span><span class="op" id="1753437">,</span>&nbsp;<span class="builtintype" id="1753439">false</span><span class="op" id="1753444">}</span><span class="op" id="1753445">,</span>&nbsp;&nbsp;<span class="comment" id="1753448">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753460">{</span><span class="num" id="1753461">0xa3ab66580d5fdaf6</span><span class="op" id="1753479">,</span>&nbsp;<span class="op" id="1753481">-</span><span class="num" id="1753482">555</span><span class="op" id="1753485">,</span>&nbsp;<span class="builtintype" id="1753487">false</span><span class="op" id="1753492">}</span><span class="op" id="1753493">,</span>&nbsp;&nbsp;<span class="comment" id="1753496">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753508">{</span><span class="num" id="1753509">0xf3e2f893dec3f126</span><span class="op" id="1753527">,</span>&nbsp;<span class="op" id="1753529">-</span><span class="num" id="1753530">529</span><span class="op" id="1753533">,</span>&nbsp;<span class="builtintype" id="1753535">false</span><span class="op" id="1753540">}</span><span class="op" id="1753541">,</span>&nbsp;&nbsp;<span class="comment" id="1753544">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753556">{</span><span class="num" id="1753557">0xb5b5ada8aaff80b8</span><span class="op" id="1753575">,</span>&nbsp;<span class="op" id="1753577">-</span><span class="num" id="1753578">502</span><span class="op" id="1753581">,</span>&nbsp;<span class="builtintype" id="1753583">false</span><span class="op" id="1753588">}</span><span class="op" id="1753589">,</span>&nbsp;&nbsp;<span class="comment" id="1753592">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753604">{</span><span class="num" id="1753605">0x87625f056c7c4a8b</span><span class="op" id="1753623">,</span>&nbsp;<span class="op" id="1753625">-</span><span class="num" id="1753626">475</span><span class="op" id="1753629">,</span>&nbsp;<span class="builtintype" id="1753631">false</span><span class="op" id="1753636">}</span><span class="op" id="1753637">,</span>&nbsp;&nbsp;<span class="comment" id="1753640">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753652">{</span><span class="num" id="1753653">0xc9bcff6034c13053</span><span class="op" id="1753671">,</span>&nbsp;<span class="op" id="1753673">-</span><span class="num" id="1753674">449</span><span class="op" id="1753677">,</span>&nbsp;<span class="builtintype" id="1753679">false</span><span class="op" id="1753684">}</span><span class="op" id="1753685">,</span>&nbsp;&nbsp;<span class="comment" id="1753688">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753700">{</span><span class="num" id="1753701">0x964e858c91ba2655</span><span class="op" id="1753719">,</span>&nbsp;<span class="op" id="1753721">-</span><span class="num" id="1753722">422</span><span class="op" id="1753725">,</span>&nbsp;<span class="builtintype" id="1753727">false</span><span class="op" id="1753732">}</span><span class="op" id="1753733">,</span>&nbsp;&nbsp;<span class="comment" id="1753736">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753748">{</span><span class="num" id="1753749">0xdff9772470297ebd</span><span class="op" id="1753767">,</span>&nbsp;<span class="op" id="1753769">-</span><span class="num" id="1753770">396</span><span class="op" id="1753773">,</span>&nbsp;<span class="builtintype" id="1753775">false</span><span class="op" id="1753780">}</span><span class="op" id="1753781">,</span>&nbsp;&nbsp;<span class="comment" id="1753784">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753796">{</span><span class="num" id="1753797">0xa6dfbd9fb8e5b88f</span><span class="op" id="1753815">,</span>&nbsp;<span class="op" id="1753817">-</span><span class="num" id="1753818">369</span><span class="op" id="1753821">,</span>&nbsp;<span class="builtintype" id="1753823">false</span><span class="op" id="1753828">}</span><span class="op" id="1753829">,</span>&nbsp;&nbsp;<span class="comment" id="1753832">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753843">{</span><span class="num" id="1753844">0xf8a95fcf88747d94</span><span class="op" id="1753862">,</span>&nbsp;<span class="op" id="1753864">-</span><span class="num" id="1753865">343</span><span class="op" id="1753868">,</span>&nbsp;<span class="builtintype" id="1753870">false</span><span class="op" id="1753875">}</span><span class="op" id="1753876">,</span>&nbsp;&nbsp;<span class="comment" id="1753879">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753890">{</span><span class="num" id="1753891">0xb94470938fa89bcf</span><span class="op" id="1753909">,</span>&nbsp;<span class="op" id="1753911">-</span><span class="num" id="1753912">316</span><span class="op" id="1753915">,</span>&nbsp;<span class="builtintype" id="1753917">false</span><span class="op" id="1753922">}</span><span class="op" id="1753923">,</span>&nbsp;&nbsp;<span class="comment" id="1753926">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753937">{</span><span class="num" id="1753938">0x8a08f0f8bf0f156b</span><span class="op" id="1753956">,</span>&nbsp;<span class="op" id="1753958">-</span><span class="num" id="1753959">289</span><span class="op" id="1753962">,</span>&nbsp;<span class="builtintype" id="1753964">false</span><span class="op" id="1753969">}</span><span class="op" id="1753970">,</span>&nbsp;&nbsp;<span class="comment" id="1753973">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1753984">{</span><span class="num" id="1753985">0xcdb02555653131b6</span><span class="op" id="1754003">,</span>&nbsp;<span class="op" id="1754005">-</span><span class="num" id="1754006">263</span><span class="op" id="1754009">,</span>&nbsp;<span class="builtintype" id="1754011">false</span><span class="op" id="1754016">}</span><span class="op" id="1754017">,</span>&nbsp;&nbsp;<span class="comment" id="1754020">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754031">{</span><span class="num" id="1754032">0x993fe2c6d07b7fac</span><span class="op" id="1754050">,</span>&nbsp;<span class="op" id="1754052">-</span><span class="num" id="1754053">236</span><span class="op" id="1754056">,</span>&nbsp;<span class="builtintype" id="1754058">false</span><span class="op" id="1754063">}</span><span class="op" id="1754064">,</span>&nbsp;&nbsp;<span class="comment" id="1754067">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754078">{</span><span class="num" id="1754079">0xe45c10c42a2b3b06</span><span class="op" id="1754097">,</span>&nbsp;<span class="op" id="1754099">-</span><span class="num" id="1754100">210</span><span class="op" id="1754103">,</span>&nbsp;<span class="builtintype" id="1754105">false</span><span class="op" id="1754110">}</span><span class="op" id="1754111">,</span>&nbsp;&nbsp;<span class="comment" id="1754114">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754125">{</span><span class="num" id="1754126">0xaa242499697392d3</span><span class="op" id="1754144">,</span>&nbsp;<span class="op" id="1754146">-</span><span class="num" id="1754147">183</span><span class="op" id="1754150">,</span>&nbsp;<span class="builtintype" id="1754152">false</span><span class="op" id="1754157">}</span><span class="op" id="1754158">,</span>&nbsp;&nbsp;<span class="comment" id="1754161">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754172">{</span><span class="num" id="1754173">0xfd87b5f28300ca0e</span><span class="op" id="1754191">,</span>&nbsp;<span class="op" id="1754193">-</span><span class="num" id="1754194">157</span><span class="op" id="1754197">,</span>&nbsp;<span class="builtintype" id="1754199">false</span><span class="op" id="1754204">}</span><span class="op" id="1754205">,</span>&nbsp;&nbsp;<span class="comment" id="1754208">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754219">{</span><span class="num" id="1754220">0xbce5086492111aeb</span><span class="op" id="1754238">,</span>&nbsp;<span class="op" id="1754240">-</span><span class="num" id="1754241">130</span><span class="op" id="1754244">,</span>&nbsp;<span class="builtintype" id="1754246">false</span><span class="op" id="1754251">}</span><span class="op" id="1754252">,</span>&nbsp;&nbsp;<span class="comment" id="1754255">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754266">{</span><span class="num" id="1754267">0x8cbccc096f5088cc</span><span class="op" id="1754285">,</span>&nbsp;<span class="op" id="1754287">-</span><span class="num" id="1754288">103</span><span class="op" id="1754291">,</span>&nbsp;<span class="builtintype" id="1754293">false</span><span class="op" id="1754298">}</span><span class="op" id="1754299">,</span>&nbsp;&nbsp;<span class="comment" id="1754302">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754313">{</span><span class="num" id="1754314">0xd1b71758e219652c</span><span class="op" id="1754332">,</span>&nbsp;<span class="op" id="1754334">-</span><span class="num" id="1754335">77</span><span class="op" id="1754337">,</span>&nbsp;<span class="builtintype" id="1754339">false</span><span class="op" id="1754344">}</span><span class="op" id="1754345">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754349">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754359">{</span><span class="num" id="1754360">0x9c40000000000000</span><span class="op" id="1754378">,</span>&nbsp;<span class="op" id="1754380">-</span><span class="num" id="1754381">50</span><span class="op" id="1754383">,</span>&nbsp;<span class="builtintype" id="1754385">false</span><span class="op" id="1754390">}</span><span class="op" id="1754391">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754395">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754404">{</span><span class="num" id="1754405">0xe8d4a51000000000</span><span class="op" id="1754423">,</span>&nbsp;<span class="op" id="1754425">-</span><span class="num" id="1754426">24</span><span class="op" id="1754428">,</span>&nbsp;<span class="builtintype" id="1754430">false</span><span class="op" id="1754435">}</span><span class="op" id="1754436">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754440">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754450">{</span><span class="num" id="1754451">0xad78ebc5ac620000</span><span class="op" id="1754469">,</span>&nbsp;<span class="num" id="1754471">3</span><span class="op" id="1754472">,</span>&nbsp;<span class="builtintype" id="1754474">false</span><span class="op" id="1754479">}</span><span class="op" id="1754480">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1754486">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754496">{</span><span class="num" id="1754497">0x813f3978f8940984</span><span class="op" id="1754515">,</span>&nbsp;<span class="num" id="1754517">30</span><span class="op" id="1754519">,</span>&nbsp;<span class="builtintype" id="1754521">false</span><span class="op" id="1754526">}</span><span class="op" id="1754527">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1754532">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754542">{</span><span class="num" id="1754543">0xc097ce7bc90715b3</span><span class="op" id="1754561">,</span>&nbsp;<span class="num" id="1754563">56</span><span class="op" id="1754565">,</span>&nbsp;<span class="builtintype" id="1754567">false</span><span class="op" id="1754572">}</span><span class="op" id="1754573">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1754578">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754588">{</span><span class="num" id="1754589">0x8f7e32ce7bea5c70</span><span class="op" id="1754607">,</span>&nbsp;<span class="num" id="1754609">83</span><span class="op" id="1754611">,</span>&nbsp;<span class="builtintype" id="1754613">false</span><span class="op" id="1754618">}</span><span class="op" id="1754619">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1754624">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754634">{</span><span class="num" id="1754635">0xd5d238a4abe98068</span><span class="op" id="1754653">,</span>&nbsp;<span class="num" id="1754655">109</span><span class="op" id="1754658">,</span>&nbsp;<span class="builtintype" id="1754660">false</span><span class="op" id="1754665">}</span><span class="op" id="1754666">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754670">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754680">{</span><span class="num" id="1754681">0x9f4f2726179a2245</span><span class="op" id="1754699">,</span>&nbsp;<span class="num" id="1754701">136</span><span class="op" id="1754704">,</span>&nbsp;<span class="builtintype" id="1754706">false</span><span class="op" id="1754711">}</span><span class="op" id="1754712">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754716">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754726">{</span><span class="num" id="1754727">0xed63a231d4c4fb27</span><span class="op" id="1754745">,</span>&nbsp;<span class="num" id="1754747">162</span><span class="op" id="1754750">,</span>&nbsp;<span class="builtintype" id="1754752">false</span><span class="op" id="1754757">}</span><span class="op" id="1754758">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754762">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754772">{</span><span class="num" id="1754773">0xb0de65388cc8ada8</span><span class="op" id="1754791">,</span>&nbsp;<span class="num" id="1754793">189</span><span class="op" id="1754796">,</span>&nbsp;<span class="builtintype" id="1754798">false</span><span class="op" id="1754803">}</span><span class="op" id="1754804">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754808">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754818">{</span><span class="num" id="1754819">0x83c7088e1aab65db</span><span class="op" id="1754837">,</span>&nbsp;<span class="num" id="1754839">216</span><span class="op" id="1754842">,</span>&nbsp;<span class="builtintype" id="1754844">false</span><span class="op" id="1754849">}</span><span class="op" id="1754850">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754854">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754864">{</span><span class="num" id="1754865">0xc45d1df942711d9a</span><span class="op" id="1754883">,</span>&nbsp;<span class="num" id="1754885">242</span><span class="op" id="1754888">,</span>&nbsp;<span class="builtintype" id="1754890">false</span><span class="op" id="1754895">}</span><span class="op" id="1754896">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754900">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754910">{</span><span class="num" id="1754911">0x924d692ca61be758</span><span class="op" id="1754929">,</span>&nbsp;<span class="num" id="1754931">269</span><span class="op" id="1754934">,</span>&nbsp;<span class="builtintype" id="1754936">false</span><span class="op" id="1754941">}</span><span class="op" id="1754942">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754946">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1754957">{</span><span class="num" id="1754958">0xda01ee641a708dea</span><span class="op" id="1754976">,</span>&nbsp;<span class="num" id="1754978">295</span><span class="op" id="1754981">,</span>&nbsp;<span class="builtintype" id="1754983">false</span><span class="op" id="1754988">}</span><span class="op" id="1754989">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1754993">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755004">{</span><span class="num" id="1755005">0xa26da3999aef774a</span><span class="op" id="1755023">,</span>&nbsp;<span class="num" id="1755025">322</span><span class="op" id="1755028">,</span>&nbsp;<span class="builtintype" id="1755030">false</span><span class="op" id="1755035">}</span><span class="op" id="1755036">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755040">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755051">{</span><span class="num" id="1755052">0xf209787bb47d6b85</span><span class="op" id="1755070">,</span>&nbsp;<span class="num" id="1755072">348</span><span class="op" id="1755075">,</span>&nbsp;<span class="builtintype" id="1755077">false</span><span class="op" id="1755082">}</span><span class="op" id="1755083">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755087">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755098">{</span><span class="num" id="1755099">0xb454e4a179dd1877</span><span class="op" id="1755117">,</span>&nbsp;<span class="num" id="1755119">375</span><span class="op" id="1755122">,</span>&nbsp;<span class="builtintype" id="1755124">false</span><span class="op" id="1755129">}</span><span class="op" id="1755130">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755134">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755145">{</span><span class="num" id="1755146">0x865b86925b9bc5c2</span><span class="op" id="1755164">,</span>&nbsp;<span class="num" id="1755166">402</span><span class="op" id="1755169">,</span>&nbsp;<span class="builtintype" id="1755171">false</span><span class="op" id="1755176">}</span><span class="op" id="1755177">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755181">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755192">{</span><span class="num" id="1755193">0xc83553c5c8965d3d</span><span class="op" id="1755211">,</span>&nbsp;<span class="num" id="1755213">428</span><span class="op" id="1755216">,</span>&nbsp;<span class="builtintype" id="1755218">false</span><span class="op" id="1755223">}</span><span class="op" id="1755224">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755228">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755239">{</span><span class="num" id="1755240">0x952ab45cfa97a0b3</span><span class="op" id="1755258">,</span>&nbsp;<span class="num" id="1755260">455</span><span class="op" id="1755263">,</span>&nbsp;<span class="builtintype" id="1755265">false</span><span class="op" id="1755270">}</span><span class="op" id="1755271">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755275">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755286">{</span><span class="num" id="1755287">0xde469fbd99a05fe3</span><span class="op" id="1755305">,</span>&nbsp;<span class="num" id="1755307">481</span><span class="op" id="1755310">,</span>&nbsp;<span class="builtintype" id="1755312">false</span><span class="op" id="1755317">}</span><span class="op" id="1755318">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755322">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755333">{</span><span class="num" id="1755334">0xa59bc234db398c25</span><span class="op" id="1755352">,</span>&nbsp;<span class="num" id="1755354">508</span><span class="op" id="1755357">,</span>&nbsp;<span class="builtintype" id="1755359">false</span><span class="op" id="1755364">}</span><span class="op" id="1755365">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755369">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755380">{</span><span class="num" id="1755381">0xf6c69a72a3989f5c</span><span class="op" id="1755399">,</span>&nbsp;<span class="num" id="1755401">534</span><span class="op" id="1755404">,</span>&nbsp;<span class="builtintype" id="1755406">false</span><span class="op" id="1755411">}</span><span class="op" id="1755412">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755416">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755427">{</span><span class="num" id="1755428">0xb7dcbf5354e9bece</span><span class="op" id="1755446">,</span>&nbsp;<span class="num" id="1755448">561</span><span class="op" id="1755451">,</span>&nbsp;<span class="builtintype" id="1755453">false</span><span class="op" id="1755458">}</span><span class="op" id="1755459">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755463">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755474">{</span><span class="num" id="1755475">0x88fcf317f22241e2</span><span class="op" id="1755493">,</span>&nbsp;<span class="num" id="1755495">588</span><span class="op" id="1755498">,</span>&nbsp;<span class="builtintype" id="1755500">false</span><span class="op" id="1755505">}</span><span class="op" id="1755506">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755510">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755521">{</span><span class="num" id="1755522">0xcc20ce9bd35c78a5</span><span class="op" id="1755540">,</span>&nbsp;<span class="num" id="1755542">614</span><span class="op" id="1755545">,</span>&nbsp;<span class="builtintype" id="1755547">false</span><span class="op" id="1755552">}</span><span class="op" id="1755553">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755557">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755568">{</span><span class="num" id="1755569">0x98165af37b2153df</span><span class="op" id="1755587">,</span>&nbsp;<span class="num" id="1755589">641</span><span class="op" id="1755592">,</span>&nbsp;<span class="builtintype" id="1755594">false</span><span class="op" id="1755599">}</span><span class="op" id="1755600">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755604">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755615">{</span><span class="num" id="1755616">0xe2a0b5dc971f303a</span><span class="op" id="1755634">,</span>&nbsp;<span class="num" id="1755636">667</span><span class="op" id="1755639">,</span>&nbsp;<span class="builtintype" id="1755641">false</span><span class="op" id="1755646">}</span><span class="op" id="1755647">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755651">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755662">{</span><span class="num" id="1755663">0xa8d9d1535ce3b396</span><span class="op" id="1755681">,</span>&nbsp;<span class="num" id="1755683">694</span><span class="op" id="1755686">,</span>&nbsp;<span class="builtintype" id="1755688">false</span><span class="op" id="1755693">}</span><span class="op" id="1755694">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755698">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755709">{</span><span class="num" id="1755710">0xfb9b7cd9a4a7443c</span><span class="op" id="1755728">,</span>&nbsp;<span class="num" id="1755730">720</span><span class="op" id="1755733">,</span>&nbsp;<span class="builtintype" id="1755735">false</span><span class="op" id="1755740">}</span><span class="op" id="1755741">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755745">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755756">{</span><span class="num" id="1755757">0xbb764c4ca7a44410</span><span class="op" id="1755775">,</span>&nbsp;<span class="num" id="1755777">747</span><span class="op" id="1755780">,</span>&nbsp;<span class="builtintype" id="1755782">false</span><span class="op" id="1755787">}</span><span class="op" id="1755788">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755792">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755803">{</span><span class="num" id="1755804">0x8bab8eefb6409c1a</span><span class="op" id="1755822">,</span>&nbsp;<span class="num" id="1755824">774</span><span class="op" id="1755827">,</span>&nbsp;<span class="builtintype" id="1755829">false</span><span class="op" id="1755834">}</span><span class="op" id="1755835">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755839">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755850">{</span><span class="num" id="1755851">0xd01fef10a657842c</span><span class="op" id="1755869">,</span>&nbsp;<span class="num" id="1755871">800</span><span class="op" id="1755874">,</span>&nbsp;<span class="builtintype" id="1755876">false</span><span class="op" id="1755881">}</span><span class="op" id="1755882">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755886">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755897">{</span><span class="num" id="1755898">0x9b10a4e5e9913129</span><span class="op" id="1755916">,</span>&nbsp;<span class="num" id="1755918">827</span><span class="op" id="1755921">,</span>&nbsp;<span class="builtintype" id="1755923">false</span><span class="op" id="1755928">}</span><span class="op" id="1755929">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755933">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755944">{</span><span class="num" id="1755945">0xe7109bfba19c0c9d</span><span class="op" id="1755963">,</span>&nbsp;<span class="num" id="1755965">853</span><span class="op" id="1755968">,</span>&nbsp;<span class="builtintype" id="1755970">false</span><span class="op" id="1755975">}</span><span class="op" id="1755976">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1755980">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1755991">{</span><span class="num" id="1755992">0xac2820d9623bf429</span><span class="op" id="1756010">,</span>&nbsp;<span class="num" id="1756012">880</span><span class="op" id="1756015">,</span>&nbsp;<span class="builtintype" id="1756017">false</span><span class="op" id="1756022">}</span><span class="op" id="1756023">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1756027">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756038">{</span><span class="num" id="1756039">0x80444b5e7aa7cf85</span><span class="op" id="1756057">,</span>&nbsp;<span class="num" id="1756059">907</span><span class="op" id="1756062">,</span>&nbsp;<span class="builtintype" id="1756064">false</span><span class="op" id="1756069">}</span><span class="op" id="1756070">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1756074">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756085">{</span><span class="num" id="1756086">0xbf21e44003acdd2d</span><span class="op" id="1756104">,</span>&nbsp;<span class="num" id="1756106">933</span><span class="op" id="1756109">,</span>&nbsp;<span class="builtintype" id="1756111">false</span><span class="op" id="1756116">}</span><span class="op" id="1756117">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1756121">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756132">{</span><span class="num" id="1756133">0x8e679c2f5e44ff8f</span><span class="op" id="1756151">,</span>&nbsp;<span class="num" id="1756153">960</span><span class="op" id="1756156">,</span>&nbsp;<span class="builtintype" id="1756158">false</span><span class="op" id="1756163">}</span><span class="op" id="1756164">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1756168">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756179">{</span><span class="num" id="1756180">0xd433179d9c8cb841</span><span class="op" id="1756198">,</span>&nbsp;<span class="num" id="1756200">986</span><span class="op" id="1756203">,</span>&nbsp;<span class="builtintype" id="1756205">false</span><span class="op" id="1756210">}</span><span class="op" id="1756211">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1756215">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756226">{</span><span class="num" id="1756227">0x9e19db92b4e31ba9</span><span class="op" id="1756245">,</span>&nbsp;<span class="num" id="1756247">1013</span><span class="op" id="1756251">,</span>&nbsp;<span class="builtintype" id="1756253">false</span><span class="op" id="1756258">}</span><span class="op" id="1756259">,</span>&nbsp;&nbsp;<span class="comment" id="1756262">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756273">{</span><span class="num" id="1756274">0xeb96bf6ebadf77d9</span><span class="op" id="1756292">,</span>&nbsp;<span class="num" id="1756294">1039</span><span class="op" id="1756298">,</span>&nbsp;<span class="builtintype" id="1756300">false</span><span class="op" id="1756305">}</span><span class="op" id="1756306">,</span>&nbsp;&nbsp;<span class="comment" id="1756309">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756320">{</span><span class="num" id="1756321">0xaf87023b9bf0ee6b</span><span class="op" id="1756339">,</span>&nbsp;<span class="num" id="1756341">1066</span><span class="op" id="1756345">,</span>&nbsp;<span class="builtintype" id="1756347">false</span><span class="op" id="1756352">}</span><span class="op" id="1756353">,</span>&nbsp;&nbsp;<span class="comment" id="1756356">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="1756366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1756369">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="1756437">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1756500">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="1756535">func</span>&nbsp;<span class="op" id="1756540">(</span><span class="ident" id="1756541">f</span>&nbsp;<span class="op" id="1756543">*</span><span class="ident" id="1756544">extFloat</span><span class="op" id="1756552">)</span>&nbsp;<span class="ident" id="1756554">floatBits</span><span class="op" id="1756563">(</span><span class="ident" id="1756564">flt</span>&nbsp;<span class="op" id="1756568">*</span><span class="ident" id="1756569">floatInfo</span><span class="op" id="1756578">)</span>&nbsp;<span class="op" id="1756580">(</span><span class="ident" id="1756581">bits</span>&nbsp;<span class="ident" id="1756586">uint64</span><span class="op" id="1756592">,</span>&nbsp;<span class="ident" id="1756594">overflow</span>&nbsp;<span class="builtintype" id="1756603">bool</span><span class="op" id="1756607">)</span>&nbsp;<span class="op" id="1756609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756612">f</span><span class="op" id="1756613">.</span><span class="ident" id="1756614">Normalize</span><span class="op" id="1756623">(</span><span class="op" id="1756624">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756628">exp</span>&nbsp;<span class="op" id="1756632">:=</span>&nbsp;<span class="ident" id="1756635">f</span><span class="op" id="1756636">.</span><span class="ident" id="1756637">exp</span>&nbsp;<span class="op" id="1756641">+</span>&nbsp;<span class="num" id="1756643">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756648">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756672">if</span>&nbsp;<span class="ident" id="1756675">exp</span>&nbsp;<span class="op" id="1756679">&lt;</span>&nbsp;<span class="ident" id="1756681">flt</span><span class="op" id="1756684">.</span><span class="ident" id="1756685">bias</span><span class="op" id="1756689">+</span><span class="num" id="1756690">1</span>&nbsp;<span class="op" id="1756692">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756696">n</span>&nbsp;<span class="op" id="1756698">:=</span>&nbsp;<span class="ident" id="1756701">flt</span><span class="op" id="1756704">.</span><span class="ident" id="1756705">bias</span>&nbsp;<span class="op" id="1756710">+</span>&nbsp;<span class="num" id="1756712">1</span>&nbsp;<span class="op" id="1756714">-</span>&nbsp;<span class="ident" id="1756716">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756722">f</span><span class="op" id="1756723">.</span><span class="ident" id="1756724">mant</span>&nbsp;<span class="op" id="1756729">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1756733">uint</span><span class="op" id="1756737">(</span><span class="ident" id="1756738">n</span><span class="op" id="1756739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756743">exp</span>&nbsp;<span class="op" id="1756747">+=</span>&nbsp;<span class="ident" id="1756750">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756757">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756815">mant</span>&nbsp;<span class="op" id="1756820">:=</span>&nbsp;<span class="ident" id="1756823">f</span><span class="op" id="1756824">.</span><span class="ident" id="1756825">mant</span>&nbsp;<span class="op" id="1756830">&gt;&gt;</span>&nbsp;<span class="op" id="1756833">(</span><span class="num" id="1756834">63</span>&nbsp;<span class="op" id="1756837">-</span>&nbsp;<span class="ident" id="1756839">flt</span><span class="op" id="1756842">.</span><span class="ident" id="1756843">mantbits</span><span class="op" id="1756851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756854">if</span>&nbsp;<span class="ident" id="1756857">f</span><span class="op" id="1756858">.</span><span class="ident" id="1756859">mant</span><span class="op" id="1756863">&amp;</span><span class="op" id="1756864">(</span><span class="num" id="1756865">1</span><span class="op" id="1756866">&lt;&lt;</span><span class="op" id="1756868">(</span><span class="num" id="1756869">62</span><span class="op" id="1756871">-</span><span class="ident" id="1756872">flt</span><span class="op" id="1756875">.</span><span class="ident" id="1756876">mantbits</span><span class="op" id="1756884">)</span><span class="op" id="1756885">)</span>&nbsp;<span class="op" id="1756887">!=</span>&nbsp;<span class="num" id="1756890">0</span>&nbsp;<span class="op" id="1756892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756896">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1756911">mant</span>&nbsp;<span class="op" id="1756916">+=</span>&nbsp;<span class="num" id="1756919">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1756922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1756926">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1756975">if</span>&nbsp;<span class="ident" id="1756978">mant</span>&nbsp;<span class="op" id="1756983">==</span>&nbsp;<span class="num" id="1756986">2</span><span class="op" id="1756987">&lt;&lt;</span><span class="ident" id="1756989">flt</span><span class="op" id="1756992">.</span><span class="ident" id="1756993">mantbits</span>&nbsp;<span class="op" id="1757002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757006">mant</span>&nbsp;<span class="op" id="1757011">&gt;&gt;=</span>&nbsp;<span class="num" id="1757015">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757019">exp</span><span class="op" id="1757022">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757030">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757046">if</span>&nbsp;<span class="ident" id="1757049">exp</span><span class="op" id="1757052">-</span><span class="ident" id="1757053">flt</span><span class="op" id="1757056">.</span><span class="ident" id="1757057">bias</span>&nbsp;<span class="op" id="1757062">&gt;=</span>&nbsp;<span class="num" id="1757065">1</span><span class="op" id="1757066">&lt;&lt;</span><span class="ident" id="1757068">flt</span><span class="op" id="1757071">.</span><span class="ident" id="1757072">expbits</span><span class="op" id="1757079">-</span><span class="num" id="1757080">1</span>&nbsp;<span class="op" id="1757082">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757086">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757097">mant</span>&nbsp;<span class="op" id="1757102">=</span>&nbsp;<span class="num" id="1757104">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757108">exp</span>&nbsp;<span class="op" id="1757112">=</span>&nbsp;<span class="num" id="1757114">1</span><span class="op" id="1757115">&lt;&lt;</span><span class="ident" id="1757117">flt</span><span class="op" id="1757120">.</span><span class="ident" id="1757121">expbits</span>&nbsp;<span class="op" id="1757129">-</span>&nbsp;<span class="num" id="1757131">1</span>&nbsp;<span class="op" id="1757133">+</span>&nbsp;<span class="ident" id="1757135">flt</span><span class="op" id="1757138">.</span><span class="ident" id="1757139">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757146">overflow</span>&nbsp;<span class="op" id="1757155">=</span>&nbsp;<span class="builtintype" id="1757157">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757163">}</span>&nbsp;<span class="keyword" id="1757165">else</span>&nbsp;<span class="keyword" id="1757170">if</span>&nbsp;<span class="ident" id="1757173">mant</span><span class="op" id="1757177">&amp;</span><span class="op" id="1757178">(</span><span class="num" id="1757179">1</span><span class="op" id="1757180">&lt;&lt;</span><span class="ident" id="1757182">flt</span><span class="op" id="1757185">.</span><span class="ident" id="1757186">mantbits</span><span class="op" id="1757194">)</span>&nbsp;<span class="op" id="1757196">==</span>&nbsp;<span class="num" id="1757199">0</span>&nbsp;<span class="op" id="1757201">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757205">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757224">exp</span>&nbsp;<span class="op" id="1757228">=</span>&nbsp;<span class="ident" id="1757230">flt</span><span class="op" id="1757233">.</span><span class="ident" id="1757234">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757243">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757262">bits</span>&nbsp;<span class="op" id="1757267">=</span>&nbsp;<span class="ident" id="1757269">mant</span>&nbsp;<span class="op" id="1757274">&amp;</span>&nbsp;<span class="op" id="1757276">(</span><span class="ident" id="1757277">uint64</span><span class="op" id="1757283">(</span><span class="num" id="1757284">1</span><span class="op" id="1757285">)</span><span class="op" id="1757286">&lt;&lt;</span><span class="ident" id="1757288">flt</span><span class="op" id="1757291">.</span><span class="ident" id="1757292">mantbits</span>&nbsp;<span class="op" id="1757301">-</span>&nbsp;<span class="num" id="1757303">1</span><span class="op" id="1757304">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757307">bits</span>&nbsp;<span class="op" id="1757312">|=</span>&nbsp;<span class="ident" id="1757315">uint64</span><span class="op" id="1757321">(</span><span class="op" id="1757322">(</span><span class="ident" id="1757323">exp</span><span class="op" id="1757326">-</span><span class="ident" id="1757327">flt</span><span class="op" id="1757330">.</span><span class="ident" id="1757331">bias</span><span class="op" id="1757335">)</span><span class="op" id="1757336">&amp;</span><span class="op" id="1757337">(</span><span class="num" id="1757338">1</span><span class="op" id="1757339">&lt;&lt;</span><span class="ident" id="1757341">flt</span><span class="op" id="1757344">.</span><span class="ident" id="1757345">expbits</span><span class="op" id="1757352">-</span><span class="num" id="1757353">1</span><span class="op" id="1757354">)</span><span class="op" id="1757355">)</span>&nbsp;<span class="op" id="1757357">&lt;&lt;</span>&nbsp;<span class="ident" id="1757360">flt</span><span class="op" id="1757363">.</span><span class="ident" id="1757364">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757374">if</span>&nbsp;<span class="ident" id="1757377">f</span><span class="op" id="1757378">.</span><span class="ident" id="1757379">neg</span>&nbsp;<span class="op" id="1757383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757387">bits</span>&nbsp;<span class="op" id="1757392">|=</span>&nbsp;<span class="num" id="1757395">1</span>&nbsp;<span class="op" id="1757397">&lt;&lt;</span>&nbsp;<span class="op" id="1757400">(</span><span class="ident" id="1757401">flt</span><span class="op" id="1757404">.</span><span class="ident" id="1757405">mantbits</span>&nbsp;<span class="op" id="1757414">+</span>&nbsp;<span class="ident" id="1757416">flt</span><span class="op" id="1757419">.</span><span class="ident" id="1757420">expbits</span><span class="op" id="1757427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1757430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757433">return</span><br>
<span class="lineno">170</span><span class="op" id="1757440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1757443">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="1757501">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1757564">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="1757624">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="1757695">func</span>&nbsp;<span class="op" id="1757700">(</span><span class="ident" id="1757701">f</span>&nbsp;<span class="op" id="1757703">*</span><span class="ident" id="1757704">extFloat</span><span class="op" id="1757712">)</span>&nbsp;<span class="ident" id="1757714">AssignComputeBounds</span><span class="op" id="1757733">(</span><span class="ident" id="1757734">mant</span>&nbsp;<span class="ident" id="1757739">uint64</span><span class="op" id="1757745">,</span>&nbsp;<span class="ident" id="1757747">exp</span>&nbsp;<span class="builtintype" id="1757751">int</span><span class="op" id="1757754">,</span>&nbsp;<span class="ident" id="1757756">neg</span>&nbsp;<span class="builtintype" id="1757760">bool</span><span class="op" id="1757764">,</span>&nbsp;<span class="ident" id="1757766">flt</span>&nbsp;<span class="op" id="1757770">*</span><span class="ident" id="1757771">floatInfo</span><span class="op" id="1757780">)</span>&nbsp;<span class="op" id="1757782">(</span><span class="ident" id="1757783">lower</span><span class="op" id="1757788">,</span>&nbsp;<span class="ident" id="1757790">upper</span>&nbsp;<span class="ident" id="1757796">extFloat</span><span class="op" id="1757804">)</span>&nbsp;<span class="op" id="1757806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757809">f</span><span class="op" id="1757810">.</span><span class="ident" id="1757811">mant</span>&nbsp;<span class="op" id="1757816">=</span>&nbsp;<span class="ident" id="1757818">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757824">f</span><span class="op" id="1757825">.</span><span class="ident" id="1757826">exp</span>&nbsp;<span class="op" id="1757830">=</span>&nbsp;<span class="ident" id="1757832">exp</span>&nbsp;<span class="op" id="1757836">-</span>&nbsp;<span class="builtintype" id="1757838">int</span><span class="op" id="1757841">(</span><span class="ident" id="1757842">flt</span><span class="op" id="1757845">.</span><span class="ident" id="1757846">mantbits</span><span class="op" id="1757854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757857">f</span><span class="op" id="1757858">.</span><span class="ident" id="1757859">neg</span>&nbsp;<span class="op" id="1757863">=</span>&nbsp;<span class="ident" id="1757865">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757870">if</span>&nbsp;<span class="ident" id="1757873">f</span><span class="op" id="1757874">.</span><span class="ident" id="1757875">exp</span>&nbsp;<span class="op" id="1757879">&lt;=</span>&nbsp;<span class="num" id="1757882">0</span>&nbsp;<span class="op" id="1757884">&amp;&amp;</span>&nbsp;<span class="ident" id="1757887">mant</span>&nbsp;<span class="op" id="1757892">==</span>&nbsp;<span class="op" id="1757895">(</span><span class="ident" id="1757896">mant</span><span class="op" id="1757900">&gt;&gt;</span><span class="builtintype" id="1757902">uint</span><span class="op" id="1757906">(</span><span class="op" id="1757907">-</span><span class="ident" id="1757908">f</span><span class="op" id="1757909">.</span><span class="ident" id="1757910">exp</span><span class="op" id="1757913">)</span><span class="op" id="1757914">)</span><span class="op" id="1757915">&lt;&lt;</span><span class="builtintype" id="1757917">uint</span><span class="op" id="1757921">(</span><span class="op" id="1757922">-</span><span class="ident" id="1757923">f</span><span class="op" id="1757924">.</span><span class="ident" id="1757925">exp</span><span class="op" id="1757928">)</span>&nbsp;<span class="op" id="1757930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1757934">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757956">f</span><span class="op" id="1757957">.</span><span class="ident" id="1757958">mant</span>&nbsp;<span class="op" id="1757963">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1757967">uint</span><span class="op" id="1757971">(</span><span class="op" id="1757972">-</span><span class="ident" id="1757973">f</span><span class="op" id="1757974">.</span><span class="ident" id="1757975">exp</span><span class="op" id="1757978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1757982">f</span><span class="op" id="1757983">.</span><span class="ident" id="1757984">exp</span>&nbsp;<span class="op" id="1757988">=</span>&nbsp;<span class="num" id="1757990">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1757994">return</span>&nbsp;<span class="op" id="1758001">*</span><span class="ident" id="1758002">f</span><span class="op" id="1758003">,</span>&nbsp;<span class="op" id="1758005">*</span><span class="ident" id="1758006">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758012">expBiased</span>&nbsp;<span class="op" id="1758022">:=</span>&nbsp;<span class="ident" id="1758025">exp</span>&nbsp;<span class="op" id="1758029">-</span>&nbsp;<span class="ident" id="1758031">flt</span><span class="op" id="1758034">.</span><span class="ident" id="1758035">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758042">upper</span>&nbsp;<span class="op" id="1758048">=</span>&nbsp;<span class="ident" id="1758050">extFloat</span><span class="op" id="1758058">{</span><span class="ident" id="1758059">mant</span><span class="op" id="1758063">:</span>&nbsp;<span class="num" id="1758065">2</span><span class="op" id="1758066">*</span><span class="ident" id="1758067">f</span><span class="op" id="1758068">.</span><span class="ident" id="1758069">mant</span>&nbsp;<span class="op" id="1758074">+</span>&nbsp;<span class="num" id="1758076">1</span><span class="op" id="1758077">,</span>&nbsp;<span class="ident" id="1758079">exp</span><span class="op" id="1758082">:</span>&nbsp;<span class="ident" id="1758084">f</span><span class="op" id="1758085">.</span><span class="ident" id="1758086">exp</span>&nbsp;<span class="op" id="1758090">-</span>&nbsp;<span class="num" id="1758092">1</span><span class="op" id="1758093">,</span>&nbsp;<span class="ident" id="1758095">neg</span><span class="op" id="1758098">:</span>&nbsp;<span class="ident" id="1758100">f</span><span class="op" id="1758101">.</span><span class="ident" id="1758102">neg</span><span class="op" id="1758105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758108">if</span>&nbsp;<span class="ident" id="1758111">mant</span>&nbsp;<span class="op" id="1758116">!=</span>&nbsp;<span class="num" id="1758119">1</span><span class="op" id="1758120">&lt;&lt;</span><span class="ident" id="1758122">flt</span><span class="op" id="1758125">.</span><span class="ident" id="1758126">mantbits</span>&nbsp;<span class="op" id="1758135">||</span>&nbsp;<span class="ident" id="1758138">expBiased</span>&nbsp;<span class="op" id="1758148">==</span>&nbsp;<span class="num" id="1758151">1</span>&nbsp;<span class="op" id="1758153">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758157">lower</span>&nbsp;<span class="op" id="1758163">=</span>&nbsp;<span class="ident" id="1758165">extFloat</span><span class="op" id="1758173">{</span><span class="ident" id="1758174">mant</span><span class="op" id="1758178">:</span>&nbsp;<span class="num" id="1758180">2</span><span class="op" id="1758181">*</span><span class="ident" id="1758182">f</span><span class="op" id="1758183">.</span><span class="ident" id="1758184">mant</span>&nbsp;<span class="op" id="1758189">-</span>&nbsp;<span class="num" id="1758191">1</span><span class="op" id="1758192">,</span>&nbsp;<span class="ident" id="1758194">exp</span><span class="op" id="1758197">:</span>&nbsp;<span class="ident" id="1758199">f</span><span class="op" id="1758200">.</span><span class="ident" id="1758201">exp</span>&nbsp;<span class="op" id="1758205">-</span>&nbsp;<span class="num" id="1758207">1</span><span class="op" id="1758208">,</span>&nbsp;<span class="ident" id="1758210">neg</span><span class="op" id="1758213">:</span>&nbsp;<span class="ident" id="1758215">f</span><span class="op" id="1758216">.</span><span class="ident" id="1758217">neg</span><span class="op" id="1758220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758223">}</span>&nbsp;<span class="keyword" id="1758225">else</span>&nbsp;<span class="op" id="1758230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758234">lower</span>&nbsp;<span class="op" id="1758240">=</span>&nbsp;<span class="ident" id="1758242">extFloat</span><span class="op" id="1758250">{</span><span class="ident" id="1758251">mant</span><span class="op" id="1758255">:</span>&nbsp;<span class="num" id="1758257">4</span><span class="op" id="1758258">*</span><span class="ident" id="1758259">f</span><span class="op" id="1758260">.</span><span class="ident" id="1758261">mant</span>&nbsp;<span class="op" id="1758266">-</span>&nbsp;<span class="num" id="1758268">1</span><span class="op" id="1758269">,</span>&nbsp;<span class="ident" id="1758271">exp</span><span class="op" id="1758274">:</span>&nbsp;<span class="ident" id="1758276">f</span><span class="op" id="1758277">.</span><span class="ident" id="1758278">exp</span>&nbsp;<span class="op" id="1758282">-</span>&nbsp;<span class="num" id="1758284">2</span><span class="op" id="1758285">,</span>&nbsp;<span class="ident" id="1758287">neg</span><span class="op" id="1758290">:</span>&nbsp;<span class="ident" id="1758292">f</span><span class="op" id="1758293">.</span><span class="ident" id="1758294">neg</span><span class="op" id="1758297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758303">return</span><br>
<span class="lineno">195</span><span class="op" id="1758310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1758313">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1758382">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="1758453">func</span>&nbsp;<span class="op" id="1758458">(</span><span class="ident" id="1758459">f</span>&nbsp;<span class="op" id="1758461">*</span><span class="ident" id="1758462">extFloat</span><span class="op" id="1758470">)</span>&nbsp;<span class="ident" id="1758472">Normalize</span><span class="op" id="1758481">(</span><span class="op" id="1758482">)</span>&nbsp;<span class="op" id="1758484">(</span><span class="ident" id="1758485">shift</span>&nbsp;<span class="builtintype" id="1758491">uint</span><span class="op" id="1758495">)</span>&nbsp;<span class="op" id="1758497">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758500">mant</span><span class="op" id="1758504">,</span>&nbsp;<span class="ident" id="1758506">exp</span>&nbsp;<span class="op" id="1758510">:=</span>&nbsp;<span class="ident" id="1758513">f</span><span class="op" id="1758514">.</span><span class="ident" id="1758515">mant</span><span class="op" id="1758519">,</span>&nbsp;<span class="ident" id="1758521">f</span><span class="op" id="1758522">.</span><span class="ident" id="1758523">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758528">if</span>&nbsp;<span class="ident" id="1758531">mant</span>&nbsp;<span class="op" id="1758536">==</span>&nbsp;<span class="num" id="1758539">0</span>&nbsp;<span class="op" id="1758541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758545">return</span>&nbsp;<span class="num" id="1758552">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758558">if</span>&nbsp;<span class="ident" id="1758561">mant</span><span class="op" id="1758565">&gt;&gt;</span><span class="op" id="1758567">(</span><span class="num" id="1758568">64</span><span class="op" id="1758570">-</span><span class="num" id="1758571">32</span><span class="op" id="1758573">)</span>&nbsp;<span class="op" id="1758575">==</span>&nbsp;<span class="num" id="1758578">0</span>&nbsp;<span class="op" id="1758580">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758584">mant</span>&nbsp;<span class="op" id="1758589">&lt;&lt;=</span>&nbsp;<span class="num" id="1758593">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758598">exp</span>&nbsp;<span class="op" id="1758602">-=</span>&nbsp;<span class="num" id="1758605">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758612">if</span>&nbsp;<span class="ident" id="1758615">mant</span><span class="op" id="1758619">&gt;&gt;</span><span class="op" id="1758621">(</span><span class="num" id="1758622">64</span><span class="op" id="1758624">-</span><span class="num" id="1758625">16</span><span class="op" id="1758627">)</span>&nbsp;<span class="op" id="1758629">==</span>&nbsp;<span class="num" id="1758632">0</span>&nbsp;<span class="op" id="1758634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758638">mant</span>&nbsp;<span class="op" id="1758643">&lt;&lt;=</span>&nbsp;<span class="num" id="1758647">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758652">exp</span>&nbsp;<span class="op" id="1758656">-=</span>&nbsp;<span class="num" id="1758659">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758666">if</span>&nbsp;<span class="ident" id="1758669">mant</span><span class="op" id="1758673">&gt;&gt;</span><span class="op" id="1758675">(</span><span class="num" id="1758676">64</span><span class="op" id="1758678">-</span><span class="num" id="1758679">8</span><span class="op" id="1758680">)</span>&nbsp;<span class="op" id="1758682">==</span>&nbsp;<span class="num" id="1758685">0</span>&nbsp;<span class="op" id="1758687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758691">mant</span>&nbsp;<span class="op" id="1758696">&lt;&lt;=</span>&nbsp;<span class="num" id="1758700">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758704">exp</span>&nbsp;<span class="op" id="1758708">-=</span>&nbsp;<span class="num" id="1758711">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758717">if</span>&nbsp;<span class="ident" id="1758720">mant</span><span class="op" id="1758724">&gt;&gt;</span><span class="op" id="1758726">(</span><span class="num" id="1758727">64</span><span class="op" id="1758729">-</span><span class="num" id="1758730">4</span><span class="op" id="1758731">)</span>&nbsp;<span class="op" id="1758733">==</span>&nbsp;<span class="num" id="1758736">0</span>&nbsp;<span class="op" id="1758738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758742">mant</span>&nbsp;<span class="op" id="1758747">&lt;&lt;=</span>&nbsp;<span class="num" id="1758751">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758755">exp</span>&nbsp;<span class="op" id="1758759">-=</span>&nbsp;<span class="num" id="1758762">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758765">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758768">if</span>&nbsp;<span class="ident" id="1758771">mant</span><span class="op" id="1758775">&gt;&gt;</span><span class="op" id="1758777">(</span><span class="num" id="1758778">64</span><span class="op" id="1758780">-</span><span class="num" id="1758781">2</span><span class="op" id="1758782">)</span>&nbsp;<span class="op" id="1758784">==</span>&nbsp;<span class="num" id="1758787">0</span>&nbsp;<span class="op" id="1758789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758793">mant</span>&nbsp;<span class="op" id="1758798">&lt;&lt;=</span>&nbsp;<span class="num" id="1758802">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758806">exp</span>&nbsp;<span class="op" id="1758810">-=</span>&nbsp;<span class="num" id="1758813">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758819">if</span>&nbsp;<span class="ident" id="1758822">mant</span><span class="op" id="1758826">&gt;&gt;</span><span class="op" id="1758828">(</span><span class="num" id="1758829">64</span><span class="op" id="1758831">-</span><span class="num" id="1758832">1</span><span class="op" id="1758833">)</span>&nbsp;<span class="op" id="1758835">==</span>&nbsp;<span class="num" id="1758838">0</span>&nbsp;<span class="op" id="1758840">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758844">mant</span>&nbsp;<span class="op" id="1758849">&lt;&lt;=</span>&nbsp;<span class="num" id="1758853">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758857">exp</span>&nbsp;<span class="op" id="1758861">-=</span>&nbsp;<span class="num" id="1758864">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1758867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758870">shift</span>&nbsp;<span class="op" id="1758876">=</span>&nbsp;<span class="builtintype" id="1758878">uint</span><span class="op" id="1758882">(</span><span class="ident" id="1758883">f</span><span class="op" id="1758884">.</span><span class="ident" id="1758885">exp</span>&nbsp;<span class="op" id="1758889">-</span>&nbsp;<span class="ident" id="1758891">exp</span><span class="op" id="1758894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1758897">f</span><span class="op" id="1758898">.</span><span class="ident" id="1758899">mant</span><span class="op" id="1758903">,</span>&nbsp;<span class="ident" id="1758905">f</span><span class="op" id="1758906">.</span><span class="ident" id="1758907">exp</span>&nbsp;<span class="op" id="1758911">=</span>&nbsp;<span class="ident" id="1758913">mant</span><span class="op" id="1758917">,</span>&nbsp;<span class="ident" id="1758919">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1758924">return</span><br>
<span class="lineno"></span><span class="op" id="1758931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1758934">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="1759006">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="1759029">func</span>&nbsp;<span class="op" id="1759034">(</span><span class="ident" id="1759035">f</span>&nbsp;<span class="op" id="1759037">*</span><span class="ident" id="1759038">extFloat</span><span class="op" id="1759046">)</span>&nbsp;<span class="ident" id="1759048">Multiply</span><span class="op" id="1759056">(</span><span class="ident" id="1759057">g</span>&nbsp;<span class="ident" id="1759059">extFloat</span><span class="op" id="1759067">)</span>&nbsp;<span class="op" id="1759069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759072">fhi</span><span class="op" id="1759075">,</span>&nbsp;<span class="ident" id="1759077">flo</span>&nbsp;<span class="op" id="1759081">:=</span>&nbsp;<span class="ident" id="1759084">f</span><span class="op" id="1759085">.</span><span class="ident" id="1759086">mant</span><span class="op" id="1759090">&gt;&gt;</span><span class="num" id="1759092">32</span><span class="op" id="1759094">,</span>&nbsp;<span class="ident" id="1759096">uint64</span><span class="op" id="1759102">(</span><span class="builtintype" id="1759103">uint32</span><span class="op" id="1759109">(</span><span class="ident" id="1759110">f</span><span class="op" id="1759111">.</span><span class="ident" id="1759112">mant</span><span class="op" id="1759116">)</span><span class="op" id="1759117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759120">ghi</span><span class="op" id="1759123">,</span>&nbsp;<span class="ident" id="1759125">glo</span>&nbsp;<span class="op" id="1759129">:=</span>&nbsp;<span class="ident" id="1759132">g</span><span class="op" id="1759133">.</span><span class="ident" id="1759134">mant</span><span class="op" id="1759138">&gt;&gt;</span><span class="num" id="1759140">32</span><span class="op" id="1759142">,</span>&nbsp;<span class="ident" id="1759144">uint64</span><span class="op" id="1759150">(</span><span class="builtintype" id="1759151">uint32</span><span class="op" id="1759157">(</span><span class="ident" id="1759158">g</span><span class="op" id="1759159">.</span><span class="ident" id="1759160">mant</span><span class="op" id="1759164">)</span><span class="op" id="1759165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1759169">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759189">cross1</span>&nbsp;<span class="op" id="1759196">:=</span>&nbsp;<span class="ident" id="1759199">fhi</span>&nbsp;<span class="op" id="1759203">*</span>&nbsp;<span class="ident" id="1759205">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759210">cross2</span>&nbsp;<span class="op" id="1759217">:=</span>&nbsp;<span class="ident" id="1759220">flo</span>&nbsp;<span class="op" id="1759224">*</span>&nbsp;<span class="ident" id="1759226">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1759232">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759301">f</span><span class="op" id="1759302">.</span><span class="ident" id="1759303">mant</span>&nbsp;<span class="op" id="1759308">=</span>&nbsp;<span class="ident" id="1759310">fhi</span><span class="op" id="1759313">*</span><span class="ident" id="1759314">ghi</span>&nbsp;<span class="op" id="1759318">+</span>&nbsp;<span class="op" id="1759320">(</span><span class="ident" id="1759321">cross1</span>&nbsp;<span class="op" id="1759328">&gt;&gt;</span>&nbsp;<span class="num" id="1759331">32</span><span class="op" id="1759333">)</span>&nbsp;<span class="op" id="1759335">+</span>&nbsp;<span class="op" id="1759337">(</span><span class="ident" id="1759338">cross2</span>&nbsp;<span class="op" id="1759345">&gt;&gt;</span>&nbsp;<span class="num" id="1759348">32</span><span class="op" id="1759350">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759353">rem</span>&nbsp;<span class="op" id="1759357">:=</span>&nbsp;<span class="ident" id="1759360">uint64</span><span class="op" id="1759366">(</span><span class="builtintype" id="1759367">uint32</span><span class="op" id="1759373">(</span><span class="ident" id="1759374">cross1</span><span class="op" id="1759380">)</span><span class="op" id="1759381">)</span>&nbsp;<span class="op" id="1759383">+</span>&nbsp;<span class="ident" id="1759385">uint64</span><span class="op" id="1759391">(</span><span class="builtintype" id="1759392">uint32</span><span class="op" id="1759398">(</span><span class="ident" id="1759399">cross2</span><span class="op" id="1759405">)</span><span class="op" id="1759406">)</span>&nbsp;<span class="op" id="1759408">+</span>&nbsp;<span class="op" id="1759410">(</span><span class="op" id="1759411">(</span><span class="ident" id="1759412">flo</span>&nbsp;<span class="op" id="1759416">*</span>&nbsp;<span class="ident" id="1759418">glo</span><span class="op" id="1759421">)</span>&nbsp;<span class="op" id="1759423">&gt;&gt;</span>&nbsp;<span class="num" id="1759426">32</span><span class="op" id="1759428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1759431">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759445">rem</span>&nbsp;<span class="op" id="1759449">+=</span>&nbsp;<span class="op" id="1759452">(</span><span class="num" id="1759453">1</span>&nbsp;<span class="op" id="1759455">&lt;&lt;</span>&nbsp;<span class="num" id="1759458">31</span><span class="op" id="1759460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759464">f</span><span class="op" id="1759465">.</span><span class="ident" id="1759466">mant</span>&nbsp;<span class="op" id="1759471">+=</span>&nbsp;<span class="op" id="1759474">(</span><span class="ident" id="1759475">rem</span>&nbsp;<span class="op" id="1759479">&gt;&gt;</span>&nbsp;<span class="num" id="1759482">32</span><span class="op" id="1759484">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1759487">f</span><span class="op" id="1759488">.</span><span class="ident" id="1759489">exp</span>&nbsp;<span class="op" id="1759493">=</span>&nbsp;<span class="ident" id="1759495">f</span><span class="op" id="1759496">.</span><span class="ident" id="1759497">exp</span>&nbsp;<span class="op" id="1759501">+</span>&nbsp;<span class="ident" id="1759503">g</span><span class="op" id="1759504">.</span><span class="ident" id="1759505">exp</span>&nbsp;<span class="op" id="1759509">+</span>&nbsp;<span class="num" id="1759511">64</span><br>
<span class="lineno"></span><span class="op" id="1759514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1759517">var</span>&nbsp;<span class="ident" id="1759521">uint64pow10</span>&nbsp;<span class="op" id="1759533">=</span>&nbsp;<span class="op" id="1759535">[</span><span class="op" id="1759536">...</span><span class="op" id="1759539">]</span><span class="ident" id="1759540">uint64</span><span class="op" id="1759546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1759549">1</span><span class="op" id="1759550">,</span>&nbsp;<span class="num" id="1759552">1e1</span><span class="op" id="1759555">,</span>&nbsp;<span class="num" id="1759557">1e2</span><span class="op" id="1759560">,</span>&nbsp;<span class="num" id="1759562">1e3</span><span class="op" id="1759565">,</span>&nbsp;<span class="num" id="1759567">1e4</span><span class="op" id="1759570">,</span>&nbsp;<span class="num" id="1759572">1e5</span><span class="op" id="1759575">,</span>&nbsp;<span class="num" id="1759577">1e6</span><span class="op" id="1759580">,</span>&nbsp;<span class="num" id="1759582">1e7</span><span class="op" id="1759585">,</span>&nbsp;<span class="num" id="1759587">1e8</span><span class="op" id="1759590">,</span>&nbsp;<span class="num" id="1759592">1e9</span><span class="op" id="1759595">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1759598">1e10</span><span class="op" id="1759602">,</span>&nbsp;<span class="num" id="1759604">1e11</span><span class="op" id="1759608">,</span>&nbsp;<span class="num" id="1759610">1e12</span><span class="op" id="1759614">,</span>&nbsp;<span class="num" id="1759616">1e13</span><span class="op" id="1759620">,</span>&nbsp;<span class="num" id="1759622">1e14</span><span class="op" id="1759626">,</span>&nbsp;<span class="num" id="1759628">1e15</span><span class="op" id="1759632">,</span>&nbsp;<span class="num" id="1759634">1e16</span><span class="op" id="1759638">,</span>&nbsp;<span class="num" id="1759640">1e17</span><span class="op" id="1759644">,</span>&nbsp;<span class="num" id="1759646">1e18</span><span class="op" id="1759650">,</span>&nbsp;<span class="num" id="1759652">1e19</span><span class="op" id="1759656">,</span><br>
<span class="lineno"></span><span class="op" id="1759658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1759661">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1759729">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1759799">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1759862">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="1759891">func</span>&nbsp;<span class="op" id="1759896">(</span><span class="ident" id="1759897">f</span>&nbsp;<span class="op" id="1759899">*</span><span class="ident" id="1759900">extFloat</span><span class="op" id="1759908">)</span>&nbsp;<span class="ident" id="1759910">AssignDecimal</span><span class="op" id="1759923">(</span><span class="ident" id="1759924">mantissa</span>&nbsp;<span class="ident" id="1759933">uint64</span><span class="op" id="1759939">,</span>&nbsp;<span class="ident" id="1759941">exp10</span>&nbsp;<span class="builtintype" id="1759947">int</span><span class="op" id="1759950">,</span>&nbsp;<span class="ident" id="1759952">neg</span>&nbsp;<span class="builtintype" id="1759956">bool</span><span class="op" id="1759960">,</span>&nbsp;<span class="ident" id="1759962">trunc</span>&nbsp;<span class="builtintype" id="1759968">bool</span><span class="op" id="1759972">,</span>&nbsp;<span class="ident" id="1759974">flt</span>&nbsp;<span class="op" id="1759978">*</span><span class="ident" id="1759979">floatInfo</span><span class="op" id="1759988">)</span>&nbsp;<span class="op" id="1759990">(</span><span class="ident" id="1759991">ok</span>&nbsp;<span class="builtintype" id="1759994">bool</span><span class="op" id="1759998">)</span>&nbsp;<span class="op" id="1760000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760003">const</span>&nbsp;<span class="ident" id="1760009">uint64digits</span>&nbsp;<span class="op" id="1760022">=</span>&nbsp;<span class="num" id="1760024">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760028">const</span>&nbsp;<span class="ident" id="1760034">errorscale</span>&nbsp;<span class="op" id="1760045">=</span>&nbsp;<span class="num" id="1760047">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760050">errors</span>&nbsp;<span class="op" id="1760057">:=</span>&nbsp;<span class="num" id="1760060">0</span>&nbsp;<span class="comment" id="1760062">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760120">if</span>&nbsp;<span class="ident" id="1760123">trunc</span>&nbsp;<span class="op" id="1760129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760133">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760172">errors</span>&nbsp;<span class="op" id="1760179">+=</span>&nbsp;<span class="ident" id="1760182">errorscale</span>&nbsp;<span class="op" id="1760193">/</span>&nbsp;<span class="num" id="1760195">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1760198">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760202">f</span><span class="op" id="1760203">.</span><span class="ident" id="1760204">mant</span>&nbsp;<span class="op" id="1760209">=</span>&nbsp;<span class="ident" id="1760211">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760221">f</span><span class="op" id="1760222">.</span><span class="ident" id="1760223">exp</span>&nbsp;<span class="op" id="1760227">=</span>&nbsp;<span class="num" id="1760229">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760232">f</span><span class="op" id="1760233">.</span><span class="ident" id="1760234">neg</span>&nbsp;<span class="op" id="1760238">=</span>&nbsp;<span class="ident" id="1760240">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760246">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760277">i</span>&nbsp;<span class="op" id="1760279">:=</span>&nbsp;<span class="op" id="1760282">(</span><span class="ident" id="1760283">exp10</span>&nbsp;<span class="op" id="1760289">-</span>&nbsp;<span class="ident" id="1760291">firstPowerOfTen</span><span class="op" id="1760306">)</span>&nbsp;<span class="op" id="1760308">/</span>&nbsp;<span class="ident" id="1760310">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760326">if</span>&nbsp;<span class="ident" id="1760329">exp10</span>&nbsp;<span class="op" id="1760335">&lt;</span>&nbsp;<span class="ident" id="1760337">firstPowerOfTen</span>&nbsp;<span class="op" id="1760353">||</span>&nbsp;<span class="ident" id="1760356">i</span>&nbsp;<span class="op" id="1760358">&gt;=</span>&nbsp;<span class="builtinfunc" id="1760361">len</span><span class="op" id="1760364">(</span><span class="ident" id="1760365">powersOfTen</span><span class="op" id="1760376">)</span>&nbsp;<span class="op" id="1760378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760382">return</span>&nbsp;<span class="builtintype" id="1760389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1760396">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760399">adjExp</span>&nbsp;<span class="op" id="1760406">:=</span>&nbsp;<span class="op" id="1760409">(</span><span class="ident" id="1760410">exp10</span>&nbsp;<span class="op" id="1760416">-</span>&nbsp;<span class="ident" id="1760418">firstPowerOfTen</span><span class="op" id="1760433">)</span>&nbsp;<span class="op" id="1760435">%</span>&nbsp;<span class="ident" id="1760437">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760454">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760482">if</span>&nbsp;<span class="ident" id="1760485">adjExp</span>&nbsp;<span class="op" id="1760492">&lt;</span>&nbsp;<span class="ident" id="1760494">uint64digits</span>&nbsp;<span class="op" id="1760507">&amp;&amp;</span>&nbsp;<span class="ident" id="1760510">mantissa</span>&nbsp;<span class="op" id="1760519">&lt;</span>&nbsp;<span class="ident" id="1760521">uint64pow10</span><span class="op" id="1760532">[</span><span class="ident" id="1760533">uint64digits</span><span class="op" id="1760545">-</span><span class="ident" id="1760546">adjExp</span><span class="op" id="1760552">]</span>&nbsp;<span class="op" id="1760554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760558">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760601">f</span><span class="op" id="1760602">.</span><span class="ident" id="1760603">mant</span>&nbsp;<span class="op" id="1760608">*=</span>&nbsp;<span class="ident" id="1760611">uint64pow10</span><span class="op" id="1760622">[</span><span class="ident" id="1760623">adjExp</span><span class="op" id="1760629">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760633">f</span><span class="op" id="1760634">.</span><span class="ident" id="1760635">Normalize</span><span class="op" id="1760644">(</span><span class="op" id="1760645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1760648">}</span>&nbsp;<span class="keyword" id="1760650">else</span>&nbsp;<span class="op" id="1760655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760659">f</span><span class="op" id="1760660">.</span><span class="ident" id="1760661">Normalize</span><span class="op" id="1760670">(</span><span class="op" id="1760671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760675">f</span><span class="op" id="1760676">.</span><span class="ident" id="1760677">Multiply</span><span class="op" id="1760685">(</span><span class="ident" id="1760686">smallPowersOfTen</span><span class="op" id="1760702">[</span><span class="ident" id="1760703">adjExp</span><span class="op" id="1760709">]</span><span class="op" id="1760710">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760714">errors</span>&nbsp;<span class="op" id="1760721">+=</span>&nbsp;<span class="ident" id="1760724">errorscale</span>&nbsp;<span class="op" id="1760735">/</span>&nbsp;<span class="num" id="1760737">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1760740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760744">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760789">f</span><span class="op" id="1760790">.</span><span class="ident" id="1760791">Multiply</span><span class="op" id="1760799">(</span><span class="ident" id="1760800">powersOfTen</span><span class="op" id="1760811">[</span><span class="ident" id="1760812">i</span><span class="op" id="1760813">]</span><span class="op" id="1760814">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1760817">if</span>&nbsp;<span class="ident" id="1760820">errors</span>&nbsp;<span class="op" id="1760827">&gt;</span>&nbsp;<span class="num" id="1760829">0</span>&nbsp;<span class="op" id="1760831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760835">errors</span>&nbsp;<span class="op" id="1760842">+=</span>&nbsp;<span class="num" id="1760845">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1760848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760851">errors</span>&nbsp;<span class="op" id="1760858">+=</span>&nbsp;<span class="ident" id="1760861">errorscale</span>&nbsp;<span class="op" id="1760872">/</span>&nbsp;<span class="num" id="1760874">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760878">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760892">shift</span>&nbsp;<span class="op" id="1760898">:=</span>&nbsp;<span class="ident" id="1760901">f</span><span class="op" id="1760902">.</span><span class="ident" id="1760903">Normalize</span><span class="op" id="1760912">(</span><span class="op" id="1760913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1760916">errors</span>&nbsp;<span class="op" id="1760923">&lt;&lt;=</span>&nbsp;<span class="ident" id="1760927">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760935">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1760985">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761052">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761120">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761189">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761193">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761250">denormalExp</span>&nbsp;<span class="op" id="1761262">:=</span>&nbsp;<span class="ident" id="1761265">flt</span><span class="op" id="1761268">.</span><span class="ident" id="1761269">bias</span>&nbsp;<span class="op" id="1761274">-</span>&nbsp;<span class="num" id="1761276">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1761280">var</span>&nbsp;<span class="ident" id="1761284">extrabits</span>&nbsp;<span class="builtintype" id="1761294">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1761300">if</span>&nbsp;<span class="ident" id="1761303">f</span><span class="op" id="1761304">.</span><span class="ident" id="1761305">exp</span>&nbsp;<span class="op" id="1761309">&lt;=</span>&nbsp;<span class="ident" id="1761312">denormalExp</span>&nbsp;<span class="op" id="1761324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761328">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761382">extrabits</span>&nbsp;<span class="op" id="1761392">=</span>&nbsp;<span class="builtintype" id="1761394">uint</span><span class="op" id="1761398">(</span><span class="num" id="1761399">63</span>&nbsp;<span class="op" id="1761402">-</span>&nbsp;<span class="ident" id="1761404">flt</span><span class="op" id="1761407">.</span><span class="ident" id="1761408">mantbits</span>&nbsp;<span class="op" id="1761417">+</span>&nbsp;<span class="num" id="1761419">1</span>&nbsp;<span class="op" id="1761421">+</span>&nbsp;<span class="builtintype" id="1761423">uint</span><span class="op" id="1761427">(</span><span class="ident" id="1761428">denormalExp</span><span class="op" id="1761439">-</span><span class="ident" id="1761440">f</span><span class="op" id="1761441">.</span><span class="ident" id="1761442">exp</span><span class="op" id="1761445">)</span><span class="op" id="1761446">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1761449">}</span>&nbsp;<span class="keyword" id="1761451">else</span>&nbsp;<span class="op" id="1761456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761460">extrabits</span>&nbsp;<span class="op" id="1761470">=</span>&nbsp;<span class="builtintype" id="1761472">uint</span><span class="op" id="1761476">(</span><span class="num" id="1761477">63</span>&nbsp;<span class="op" id="1761480">-</span>&nbsp;<span class="ident" id="1761482">flt</span><span class="op" id="1761485">.</span><span class="ident" id="1761486">mantbits</span><span class="op" id="1761494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1761497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761501">halfway</span>&nbsp;<span class="op" id="1761509">:=</span>&nbsp;<span class="ident" id="1761512">uint64</span><span class="op" id="1761518">(</span><span class="num" id="1761519">1</span><span class="op" id="1761520">)</span>&nbsp;<span class="op" id="1761522">&lt;&lt;</span>&nbsp;<span class="op" id="1761525">(</span><span class="ident" id="1761526">extrabits</span>&nbsp;<span class="op" id="1761536">-</span>&nbsp;<span class="num" id="1761538">1</span><span class="op" id="1761539">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761542">mant_extra</span>&nbsp;<span class="op" id="1761553">:=</span>&nbsp;<span class="ident" id="1761556">f</span><span class="op" id="1761557">.</span><span class="ident" id="1761558">mant</span>&nbsp;<span class="op" id="1761563">&amp;</span>&nbsp;<span class="op" id="1761565">(</span><span class="num" id="1761566">1</span><span class="op" id="1761567">&lt;&lt;</span><span class="ident" id="1761569">extrabits</span>&nbsp;<span class="op" id="1761579">-</span>&nbsp;<span class="num" id="1761581">1</span><span class="op" id="1761582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761586">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761652">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1761717">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1761759">if</span>&nbsp;<span class="ident" id="1761762">int64</span><span class="op" id="1761767">(</span><span class="ident" id="1761768">halfway</span><span class="op" id="1761775">)</span><span class="op" id="1761776">-</span><span class="ident" id="1761777">int64</span><span class="op" id="1761782">(</span><span class="ident" id="1761783">errors</span><span class="op" id="1761789">)</span>&nbsp;<span class="op" id="1761791">&lt;</span>&nbsp;<span class="ident" id="1761793">int64</span><span class="op" id="1761798">(</span><span class="ident" id="1761799">mant_extra</span><span class="op" id="1761809">)</span>&nbsp;<span class="op" id="1761811">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1761816">int64</span><span class="op" id="1761821">(</span><span class="ident" id="1761822">mant_extra</span><span class="op" id="1761832">)</span>&nbsp;<span class="op" id="1761834">&lt;</span>&nbsp;<span class="ident" id="1761836">int64</span><span class="op" id="1761841">(</span><span class="ident" id="1761842">halfway</span><span class="op" id="1761849">)</span><span class="op" id="1761850">+</span><span class="ident" id="1761851">int64</span><span class="op" id="1761856">(</span><span class="ident" id="1761857">errors</span><span class="op" id="1761863">)</span>&nbsp;<span class="op" id="1761865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1761869">return</span>&nbsp;<span class="builtintype" id="1761876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1761883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1761886">return</span>&nbsp;<span class="builtintype" id="1761893">true</span><br>
<span class="lineno">330</span><span class="op" id="1761898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1761901">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="1761971">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="1762038">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="1762104">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="1762165">func</span>&nbsp;<span class="op" id="1762170">(</span><span class="ident" id="1762171">f</span>&nbsp;<span class="op" id="1762173">*</span><span class="ident" id="1762174">extFloat</span><span class="op" id="1762182">)</span>&nbsp;<span class="ident" id="1762184">frexp10</span><span class="op" id="1762191">(</span><span class="op" id="1762192">)</span>&nbsp;<span class="op" id="1762194">(</span><span class="ident" id="1762195">exp10</span><span class="op" id="1762200">,</span>&nbsp;<span class="ident" id="1762202">index</span>&nbsp;<span class="builtintype" id="1762208">int</span><span class="op" id="1762211">)</span>&nbsp;<span class="op" id="1762213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762216">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762285">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762355">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762424">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762497">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762508">const</span>&nbsp;<span class="ident" id="1762514">expMin</span>&nbsp;<span class="op" id="1762521">=</span>&nbsp;<span class="op" id="1762523">-</span><span class="num" id="1762524">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762528">const</span>&nbsp;<span class="ident" id="1762534">expMax</span>&nbsp;<span class="op" id="1762541">=</span>&nbsp;<span class="op" id="1762543">-</span><span class="num" id="1762544">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762548">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762611">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1762642">approxExp10</span>&nbsp;<span class="op" id="1762654">:=</span>&nbsp;<span class="op" id="1762657">(</span><span class="op" id="1762658">(</span><span class="ident" id="1762659">expMin</span><span class="op" id="1762665">+</span><span class="ident" id="1762666">expMax</span><span class="op" id="1762672">)</span><span class="op" id="1762673">/</span><span class="num" id="1762674">2</span>&nbsp;<span class="op" id="1762676">-</span>&nbsp;<span class="ident" id="1762678">f</span><span class="op" id="1762679">.</span><span class="ident" id="1762680">exp</span><span class="op" id="1762683">)</span>&nbsp;<span class="op" id="1762685">*</span>&nbsp;<span class="num" id="1762687">28</span>&nbsp;<span class="op" id="1762690">/</span>&nbsp;<span class="num" id="1762692">93</span>&nbsp;<span class="comment" id="1762695">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1762733">i</span>&nbsp;<span class="op" id="1762735">:=</span>&nbsp;<span class="op" id="1762738">(</span><span class="ident" id="1762739">approxExp10</span>&nbsp;<span class="op" id="1762751">-</span>&nbsp;<span class="ident" id="1762753">firstPowerOfTen</span><span class="op" id="1762768">)</span>&nbsp;<span class="op" id="1762770">/</span>&nbsp;<span class="ident" id="1762772">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="1762787">Loop</span><span class="op" id="1762791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762794">for</span>&nbsp;<span class="op" id="1762798">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1762802">exp</span>&nbsp;<span class="op" id="1762806">:=</span>&nbsp;<span class="ident" id="1762809">f</span><span class="op" id="1762810">.</span><span class="ident" id="1762811">exp</span>&nbsp;<span class="op" id="1762815">+</span>&nbsp;<span class="ident" id="1762817">powersOfTen</span><span class="op" id="1762828">[</span><span class="ident" id="1762829">i</span><span class="op" id="1762830">]</span><span class="op" id="1762831">.</span><span class="ident" id="1762832">exp</span>&nbsp;<span class="op" id="1762836">+</span>&nbsp;<span class="num" id="1762838">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762843">switch</span>&nbsp;<span class="op" id="1762850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762854">case</span>&nbsp;<span class="ident" id="1762859">exp</span>&nbsp;<span class="op" id="1762863">&lt;</span>&nbsp;<span class="ident" id="1762865">expMin</span><span class="op" id="1762871">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1762876">i</span><span class="op" id="1762877">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762882">case</span>&nbsp;<span class="ident" id="1762887">exp</span>&nbsp;<span class="op" id="1762891">&gt;</span>&nbsp;<span class="ident" id="1762893">expMax</span><span class="op" id="1762899">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1762904">i</span><span class="op" id="1762905">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762910">default</span><span class="op" id="1762917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1762922">break</span>&nbsp;<span class="ident" id="1762928">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1762935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1762938">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1762941">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1763005">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763068">f</span><span class="op" id="1763069">.</span><span class="ident" id="1763070">Multiply</span><span class="op" id="1763078">(</span><span class="ident" id="1763079">powersOfTen</span><span class="op" id="1763090">[</span><span class="ident" id="1763091">i</span><span class="op" id="1763092">]</span><span class="op" id="1763093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1763097">return</span>&nbsp;<span class="op" id="1763104">-</span><span class="op" id="1763105">(</span><span class="ident" id="1763106">firstPowerOfTen</span>&nbsp;<span class="op" id="1763122">+</span>&nbsp;<span class="ident" id="1763124">i</span><span class="op" id="1763125">*</span><span class="ident" id="1763126">stepPowerOfTen</span><span class="op" id="1763140">)</span><span class="op" id="1763141">,</span>&nbsp;<span class="ident" id="1763143">i</span><br>
<span class="lineno">365</span><span class="op" id="1763145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1763148">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="1763216">func</span>&nbsp;<span class="ident" id="1763221">frexp10Many</span><span class="op" id="1763232">(</span><span class="ident" id="1763233">a</span><span class="op" id="1763234">,</span>&nbsp;<span class="ident" id="1763236">b</span><span class="op" id="1763237">,</span>&nbsp;<span class="ident" id="1763239">c</span>&nbsp;<span class="op" id="1763241">*</span><span class="ident" id="1763242">extFloat</span><span class="op" id="1763250">)</span>&nbsp;<span class="op" id="1763252">(</span><span class="ident" id="1763253">exp10</span>&nbsp;<span class="builtintype" id="1763259">int</span><span class="op" id="1763262">)</span>&nbsp;<span class="op" id="1763264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763267">exp10</span><span class="op" id="1763272">,</span>&nbsp;<span class="ident" id="1763274">i</span>&nbsp;<span class="op" id="1763276">:=</span>&nbsp;<span class="ident" id="1763279">c</span><span class="op" id="1763280">.</span><span class="ident" id="1763281">frexp10</span><span class="op" id="1763288">(</span><span class="op" id="1763289">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763292">a</span><span class="op" id="1763293">.</span><span class="ident" id="1763294">Multiply</span><span class="op" id="1763302">(</span><span class="ident" id="1763303">powersOfTen</span><span class="op" id="1763314">[</span><span class="ident" id="1763315">i</span><span class="op" id="1763316">]</span><span class="op" id="1763317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763320">b</span><span class="op" id="1763321">.</span><span class="ident" id="1763322">Multiply</span><span class="op" id="1763330">(</span><span class="ident" id="1763331">powersOfTen</span><span class="op" id="1763342">[</span><span class="ident" id="1763343">i</span><span class="op" id="1763344">]</span><span class="op" id="1763345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1763348">return</span><br>
<span class="lineno"></span><span class="op" id="1763355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="1763358">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1763417">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1763473">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="1763512">func</span>&nbsp;<span class="op" id="1763517">(</span><span class="ident" id="1763518">f</span>&nbsp;<span class="op" id="1763520">*</span><span class="ident" id="1763521">extFloat</span><span class="op" id="1763529">)</span>&nbsp;<span class="ident" id="1763531">FixedDecimal</span><span class="op" id="1763543">(</span><span class="ident" id="1763544">d</span>&nbsp;<span class="op" id="1763546">*</span><span class="ident" id="1763547">decimalSlice</span><span class="op" id="1763559">,</span>&nbsp;<span class="ident" id="1763561">n</span>&nbsp;<span class="builtintype" id="1763563">int</span><span class="op" id="1763566">)</span>&nbsp;<span class="builtintype" id="1763568">bool</span>&nbsp;<span class="op" id="1763573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1763576">if</span>&nbsp;<span class="ident" id="1763579">f</span><span class="op" id="1763580">.</span><span class="ident" id="1763581">mant</span>&nbsp;<span class="op" id="1763586">==</span>&nbsp;<span class="num" id="1763589">0</span>&nbsp;<span class="op" id="1763591">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763595">d</span><span class="op" id="1763596">.</span><span class="ident" id="1763597">nd</span>&nbsp;<span class="op" id="1763600">=</span>&nbsp;<span class="num" id="1763602">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763606">d</span><span class="op" id="1763607">.</span><span class="ident" id="1763608">dp</span>&nbsp;<span class="op" id="1763611">=</span>&nbsp;<span class="num" id="1763613">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763617">d</span><span class="op" id="1763618">.</span><span class="ident" id="1763619">neg</span>&nbsp;<span class="op" id="1763623">=</span>&nbsp;<span class="ident" id="1763625">f</span><span class="op" id="1763626">.</span><span class="ident" id="1763627">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1763633">return</span>&nbsp;<span class="builtintype" id="1763640">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1763646">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1763649">if</span>&nbsp;<span class="ident" id="1763652">n</span>&nbsp;<span class="op" id="1763654">==</span>&nbsp;<span class="num" id="1763657">0</span>&nbsp;<span class="op" id="1763659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1763663">panic</span><span class="op" id="1763668">(</span><span class="string" id="1763669">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="1763736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1763739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1763742">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1763807">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763830">f</span><span class="op" id="1763831">.</span><span class="ident" id="1763832">Normalize</span><span class="op" id="1763841">(</span><span class="op" id="1763842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763845">exp10</span><span class="op" id="1763850">,</span>&nbsp;<span class="ident" id="1763852">_</span>&nbsp;<span class="op" id="1763854">:=</span>&nbsp;<span class="ident" id="1763857">f</span><span class="op" id="1763858">.</span><span class="ident" id="1763859">frexp10</span><span class="op" id="1763866">(</span><span class="op" id="1763867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763871">shift</span>&nbsp;<span class="op" id="1763877">:=</span>&nbsp;<span class="builtintype" id="1763880">uint</span><span class="op" id="1763884">(</span><span class="op" id="1763885">-</span><span class="ident" id="1763886">f</span><span class="op" id="1763887">.</span><span class="ident" id="1763888">exp</span><span class="op" id="1763891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763894">integer</span>&nbsp;<span class="op" id="1763902">:=</span>&nbsp;<span class="builtintype" id="1763905">uint32</span><span class="op" id="1763911">(</span><span class="ident" id="1763912">f</span><span class="op" id="1763913">.</span><span class="ident" id="1763914">mant</span>&nbsp;<span class="op" id="1763919">&gt;&gt;</span>&nbsp;<span class="ident" id="1763922">shift</span><span class="op" id="1763927">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763930">fraction</span>&nbsp;<span class="op" id="1763939">:=</span>&nbsp;<span class="ident" id="1763942">f</span><span class="op" id="1763943">.</span><span class="ident" id="1763944">mant</span>&nbsp;<span class="op" id="1763949">-</span>&nbsp;<span class="op" id="1763951">(</span><span class="ident" id="1763952">uint64</span><span class="op" id="1763958">(</span><span class="ident" id="1763959">integer</span><span class="op" id="1763966">)</span>&nbsp;<span class="op" id="1763968">&lt;&lt;</span>&nbsp;<span class="ident" id="1763971">shift</span><span class="op" id="1763976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1763979">ε</span>&nbsp;<span class="op" id="1763982">:=</span>&nbsp;<span class="ident" id="1763985">uint64</span><span class="op" id="1763991">(</span><span class="num" id="1763992">1</span><span class="op" id="1763993">)</span>&nbsp;<span class="comment" id="1763995">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1764052">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764085">needed</span>&nbsp;<span class="op" id="1764092">:=</span>&nbsp;<span class="ident" id="1764095">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1764104">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764143">integerDigits</span>&nbsp;<span class="op" id="1764157">:=</span>&nbsp;<span class="num" id="1764160">0</span>&nbsp;<span class="comment" id="1764162">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764207">pow10</span>&nbsp;<span class="op" id="1764213">:=</span>&nbsp;<span class="ident" id="1764216">uint64</span><span class="op" id="1764222">(</span><span class="num" id="1764223">1</span><span class="op" id="1764224">)</span>&nbsp;<span class="comment" id="1764226">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764270">for</span>&nbsp;<span class="ident" id="1764274">i</span><span class="op" id="1764275">,</span>&nbsp;<span class="ident" id="1764277">pow</span>&nbsp;<span class="op" id="1764281">:=</span>&nbsp;<span class="num" id="1764284">0</span><span class="op" id="1764285">,</span>&nbsp;<span class="ident" id="1764287">uint64</span><span class="op" id="1764293">(</span><span class="num" id="1764294">1</span><span class="op" id="1764295">)</span><span class="op" id="1764296">;</span>&nbsp;<span class="ident" id="1764298">i</span>&nbsp;<span class="op" id="1764300">&lt;</span>&nbsp;<span class="num" id="1764302">20</span><span class="op" id="1764304">;</span>&nbsp;<span class="ident" id="1764306">i</span><span class="op" id="1764307">++</span>&nbsp;<span class="op" id="1764310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764314">if</span>&nbsp;<span class="ident" id="1764317">pow</span>&nbsp;<span class="op" id="1764321">&gt;</span>&nbsp;<span class="ident" id="1764323">uint64</span><span class="op" id="1764329">(</span><span class="ident" id="1764330">integer</span><span class="op" id="1764337">)</span>&nbsp;<span class="op" id="1764339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764344">integerDigits</span>&nbsp;<span class="op" id="1764358">=</span>&nbsp;<span class="ident" id="1764360">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764365">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764377">pow</span>&nbsp;<span class="op" id="1764381">*=</span>&nbsp;<span class="num" id="1764384">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764391">rest</span>&nbsp;<span class="op" id="1764396">:=</span>&nbsp;<span class="ident" id="1764399">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764408">if</span>&nbsp;<span class="ident" id="1764411">integerDigits</span>&nbsp;<span class="op" id="1764425">&gt;</span>&nbsp;<span class="ident" id="1764427">needed</span>&nbsp;<span class="op" id="1764434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1764438">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764501">pow10</span>&nbsp;<span class="op" id="1764507">=</span>&nbsp;<span class="ident" id="1764509">uint64pow10</span><span class="op" id="1764520">[</span><span class="ident" id="1764521">integerDigits</span><span class="op" id="1764534">-</span><span class="ident" id="1764535">needed</span><span class="op" id="1764541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764545">integer</span>&nbsp;<span class="op" id="1764553">/=</span>&nbsp;<span class="builtintype" id="1764556">uint32</span><span class="op" id="1764562">(</span><span class="ident" id="1764563">pow10</span><span class="op" id="1764568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764572">rest</span>&nbsp;<span class="op" id="1764577">-=</span>&nbsp;<span class="ident" id="1764580">integer</span>&nbsp;<span class="op" id="1764588">*</span>&nbsp;<span class="builtintype" id="1764590">uint32</span><span class="op" id="1764596">(</span><span class="ident" id="1764597">pow10</span><span class="op" id="1764602">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764605">}</span>&nbsp;<span class="keyword" id="1764607">else</span>&nbsp;<span class="op" id="1764612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764616">rest</span>&nbsp;<span class="op" id="1764621">=</span>&nbsp;<span class="num" id="1764623">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1764630">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764695">var</span>&nbsp;<span class="ident" id="1764699">buf</span>&nbsp;<span class="op" id="1764703">[</span><span class="num" id="1764704">32</span><span class="op" id="1764706">]</span><span class="builtintype" id="1764707">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764713">pos</span>&nbsp;<span class="op" id="1764717">:=</span>&nbsp;<span class="builtinfunc" id="1764720">len</span><span class="op" id="1764723">(</span><span class="ident" id="1764724">buf</span><span class="op" id="1764727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764730">for</span>&nbsp;<span class="ident" id="1764734">v</span>&nbsp;<span class="op" id="1764736">:=</span>&nbsp;<span class="ident" id="1764739">integer</span><span class="op" id="1764746">;</span>&nbsp;<span class="ident" id="1764748">v</span>&nbsp;<span class="op" id="1764750">&gt;</span>&nbsp;<span class="num" id="1764752">0</span><span class="op" id="1764753">;</span>&nbsp;<span class="op" id="1764755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764759">v1</span>&nbsp;<span class="op" id="1764762">:=</span>&nbsp;<span class="ident" id="1764765">v</span>&nbsp;<span class="op" id="1764767">/</span>&nbsp;<span class="num" id="1764769">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764774">v</span>&nbsp;<span class="op" id="1764776">-=</span>&nbsp;<span class="num" id="1764779">10</span>&nbsp;<span class="op" id="1764782">*</span>&nbsp;<span class="ident" id="1764784">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764789">pos</span><span class="op" id="1764792">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764797">buf</span><span class="op" id="1764800">[</span><span class="ident" id="1764801">pos</span><span class="op" id="1764804">]</span>&nbsp;<span class="op" id="1764806">=</span>&nbsp;<span class="builtintype" id="1764808">byte</span><span class="op" id="1764812">(</span><span class="ident" id="1764813">v</span>&nbsp;<span class="op" id="1764815">+</span>&nbsp;<span class="string" id="1764817">&#39;0&#39;</span><span class="op" id="1764820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764824">v</span>&nbsp;<span class="op" id="1764826">=</span>&nbsp;<span class="ident" id="1764828">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764835">for</span>&nbsp;<span class="ident" id="1764839">i</span>&nbsp;<span class="op" id="1764841">:=</span>&nbsp;<span class="ident" id="1764844">pos</span><span class="op" id="1764847">;</span>&nbsp;<span class="ident" id="1764849">i</span>&nbsp;<span class="op" id="1764851">&lt;</span>&nbsp;<span class="builtinfunc" id="1764853">len</span><span class="op" id="1764856">(</span><span class="ident" id="1764857">buf</span><span class="op" id="1764860">)</span><span class="op" id="1764861">;</span>&nbsp;<span class="ident" id="1764863">i</span><span class="op" id="1764864">++</span>&nbsp;<span class="op" id="1764867">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764871">d</span><span class="op" id="1764872">.</span><span class="ident" id="1764873">d</span><span class="op" id="1764874">[</span><span class="ident" id="1764875">i</span><span class="op" id="1764876">-</span><span class="ident" id="1764877">pos</span><span class="op" id="1764880">]</span>&nbsp;<span class="op" id="1764882">=</span>&nbsp;<span class="ident" id="1764884">buf</span><span class="op" id="1764887">[</span><span class="ident" id="1764888">i</span><span class="op" id="1764889">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1764892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764895">nd</span>&nbsp;<span class="op" id="1764898">:=</span>&nbsp;<span class="builtinfunc" id="1764901">len</span><span class="op" id="1764904">(</span><span class="ident" id="1764905">buf</span><span class="op" id="1764908">)</span>&nbsp;<span class="op" id="1764910">-</span>&nbsp;<span class="ident" id="1764912">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764917">d</span><span class="op" id="1764918">.</span><span class="ident" id="1764919">nd</span>&nbsp;<span class="op" id="1764922">=</span>&nbsp;<span class="ident" id="1764924">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764928">d</span><span class="op" id="1764929">.</span><span class="ident" id="1764930">dp</span>&nbsp;<span class="op" id="1764933">=</span>&nbsp;<span class="ident" id="1764935">integerDigits</span>&nbsp;<span class="op" id="1764949">+</span>&nbsp;<span class="ident" id="1764951">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1764958">needed</span>&nbsp;<span class="op" id="1764965">-=</span>&nbsp;<span class="ident" id="1764968">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764973">if</span>&nbsp;<span class="ident" id="1764976">needed</span>&nbsp;<span class="op" id="1764983">&gt;</span>&nbsp;<span class="num" id="1764985">0</span>&nbsp;<span class="op" id="1764987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1764991">if</span>&nbsp;<span class="ident" id="1764994">rest</span>&nbsp;<span class="op" id="1764999">!=</span>&nbsp;<span class="num" id="1765002">0</span>&nbsp;<span class="op" id="1765004">||</span>&nbsp;<span class="ident" id="1765007">pow10</span>&nbsp;<span class="op" id="1765013">!=</span>&nbsp;<span class="num" id="1765016">1</span>&nbsp;<span class="op" id="1765018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1765023">panic</span><span class="op" id="1765028">(</span><span class="string" id="1765029">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="1765080">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1765084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765088">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765153">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1765193">for</span>&nbsp;<span class="ident" id="1765197">needed</span>&nbsp;<span class="op" id="1765204">&gt;</span>&nbsp;<span class="num" id="1765206">0</span>&nbsp;<span class="op" id="1765208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765213">fraction</span>&nbsp;<span class="op" id="1765222">*=</span>&nbsp;<span class="num" id="1765225">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765231">ε</span>&nbsp;<span class="op" id="1765234">*=</span>&nbsp;<span class="num" id="1765237">10</span>&nbsp;<span class="comment" id="1765240">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1765292">if</span>&nbsp;<span class="num" id="1765295">2</span><span class="op" id="1765296">*</span><span class="ident" id="1765297">ε</span>&nbsp;<span class="op" id="1765300">&gt;</span>&nbsp;<span class="num" id="1765302">1</span><span class="op" id="1765303">&lt;&lt;</span><span class="ident" id="1765305">shift</span>&nbsp;<span class="op" id="1765311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765317">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1765391">return</span>&nbsp;<span class="builtintype" id="1765398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1765407">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765412">digit</span>&nbsp;<span class="op" id="1765418">:=</span>&nbsp;<span class="ident" id="1765421">fraction</span>&nbsp;<span class="op" id="1765430">&gt;&gt;</span>&nbsp;<span class="ident" id="1765433">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765442">d</span><span class="op" id="1765443">.</span><span class="ident" id="1765444">d</span><span class="op" id="1765445">[</span><span class="ident" id="1765446">nd</span><span class="op" id="1765448">]</span>&nbsp;<span class="op" id="1765450">=</span>&nbsp;<span class="builtintype" id="1765452">byte</span><span class="op" id="1765456">(</span><span class="ident" id="1765457">digit</span>&nbsp;<span class="op" id="1765463">+</span>&nbsp;<span class="string" id="1765465">&#39;0&#39;</span><span class="op" id="1765468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765473">fraction</span>&nbsp;<span class="op" id="1765482">-=</span>&nbsp;<span class="ident" id="1765485">digit</span>&nbsp;<span class="op" id="1765491">&lt;&lt;</span>&nbsp;<span class="ident" id="1765494">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765503">nd</span><span class="op" id="1765505">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765511">needed</span><span class="op" id="1765517">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1765522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1765526">d</span><span class="op" id="1765527">.</span><span class="ident" id="1765528">nd</span>&nbsp;<span class="op" id="1765531">=</span>&nbsp;<span class="ident" id="1765533">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1765537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765541">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765623">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765707">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765722">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765726">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765758">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765809">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765862">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765948">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765952">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1765998">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766029">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766082">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766086">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766156">ok</span>&nbsp;<span class="op" id="1766159">:=</span>&nbsp;<span class="ident" id="1766162">adjustLastDigitFixed</span><span class="op" id="1766182">(</span><span class="ident" id="1766183">d</span><span class="op" id="1766184">,</span>&nbsp;<span class="ident" id="1766186">uint64</span><span class="op" id="1766192">(</span><span class="ident" id="1766193">rest</span><span class="op" id="1766197">)</span><span class="op" id="1766198">&lt;&lt;</span><span class="ident" id="1766200">shift</span><span class="op" id="1766205">|</span><span class="ident" id="1766206">fraction</span><span class="op" id="1766214">,</span>&nbsp;<span class="ident" id="1766216">pow10</span><span class="op" id="1766221">,</span>&nbsp;<span class="ident" id="1766223">shift</span><span class="op" id="1766228">,</span>&nbsp;<span class="ident" id="1766230">ε</span><span class="op" id="1766232">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766235">if</span>&nbsp;<span class="op" id="1766238">!</span><span class="ident" id="1766239">ok</span>&nbsp;<span class="op" id="1766242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766246">return</span>&nbsp;<span class="builtintype" id="1766253">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1766260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1766263">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766288">for</span>&nbsp;<span class="ident" id="1766292">i</span>&nbsp;<span class="op" id="1766294">:=</span>&nbsp;<span class="ident" id="1766297">d</span><span class="op" id="1766298">.</span><span class="ident" id="1766299">nd</span>&nbsp;<span class="op" id="1766302">-</span>&nbsp;<span class="num" id="1766304">1</span><span class="op" id="1766305">;</span>&nbsp;<span class="ident" id="1766307">i</span>&nbsp;<span class="op" id="1766309">&gt;=</span>&nbsp;<span class="num" id="1766312">0</span><span class="op" id="1766313">;</span>&nbsp;<span class="ident" id="1766315">i</span><span class="op" id="1766316">--</span>&nbsp;<span class="op" id="1766319">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766323">if</span>&nbsp;<span class="ident" id="1766326">d</span><span class="op" id="1766327">.</span><span class="ident" id="1766328">d</span><span class="op" id="1766329">[</span><span class="ident" id="1766330">i</span><span class="op" id="1766331">]</span>&nbsp;<span class="op" id="1766333">!=</span>&nbsp;<span class="string" id="1766336">&#39;0&#39;</span>&nbsp;<span class="op" id="1766340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1766345">d</span><span class="op" id="1766346">.</span><span class="ident" id="1766347">nd</span>&nbsp;<span class="op" id="1766350">=</span>&nbsp;<span class="ident" id="1766352">i</span>&nbsp;<span class="op" id="1766354">+</span>&nbsp;<span class="num" id="1766356">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766361">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1766369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1766372">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766375">return</span>&nbsp;<span class="builtintype" id="1766382">true</span><br>
<span class="lineno"></span><span class="op" id="1766387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1766390">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="1766473">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="1766553">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1766631">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="1766652">//</span><br>
<span class="lineno"></span><span class="comment" id="1766655">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="1766740">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="1766825">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="1766865">func</span>&nbsp;<span class="ident" id="1766870">adjustLastDigitFixed</span><span class="op" id="1766890">(</span><span class="ident" id="1766891">d</span>&nbsp;<span class="op" id="1766893">*</span><span class="ident" id="1766894">decimalSlice</span><span class="op" id="1766906">,</span>&nbsp;<span class="ident" id="1766908">num</span><span class="op" id="1766911">,</span>&nbsp;<span class="ident" id="1766913">den</span>&nbsp;<span class="ident" id="1766917">uint64</span><span class="op" id="1766923">,</span>&nbsp;<span class="ident" id="1766925">shift</span>&nbsp;<span class="builtintype" id="1766931">uint</span><span class="op" id="1766935">,</span>&nbsp;<span class="ident" id="1766937">ε</span>&nbsp;<span class="ident" id="1766940">uint64</span><span class="op" id="1766946">)</span>&nbsp;<span class="builtintype" id="1766948">bool</span>&nbsp;<span class="op" id="1766953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1766956">if</span>&nbsp;<span class="ident" id="1766959">num</span>&nbsp;<span class="op" id="1766963">&gt;</span>&nbsp;<span class="ident" id="1766965">den</span><span class="op" id="1766968">&lt;&lt;</span><span class="ident" id="1766970">shift</span>&nbsp;<span class="op" id="1766976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1766980">panic</span><span class="op" id="1766985">(</span><span class="string" id="1766986">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="1767037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767040">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767043">if</span>&nbsp;<span class="num" id="1767046">2</span><span class="op" id="1767047">*</span><span class="ident" id="1767048">ε</span>&nbsp;<span class="op" id="1767051">&gt;</span>&nbsp;<span class="ident" id="1767053">den</span><span class="op" id="1767056">&lt;&lt;</span><span class="ident" id="1767058">shift</span>&nbsp;<span class="op" id="1767064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1767068">panic</span><span class="op" id="1767073">(</span><span class="string" id="1767074">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="1767104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767110">if</span>&nbsp;<span class="num" id="1767113">2</span><span class="op" id="1767114">*</span><span class="op" id="1767115">(</span><span class="ident" id="1767116">num</span><span class="op" id="1767119">+</span><span class="ident" id="1767120">ε</span><span class="op" id="1767122">)</span>&nbsp;<span class="op" id="1767124">&lt;</span>&nbsp;<span class="ident" id="1767126">den</span><span class="op" id="1767129">&lt;&lt;</span><span class="ident" id="1767131">shift</span>&nbsp;<span class="op" id="1767137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767141">return</span>&nbsp;<span class="builtintype" id="1767148">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767157">if</span>&nbsp;<span class="num" id="1767160">2</span><span class="op" id="1767161">*</span><span class="op" id="1767162">(</span><span class="ident" id="1767163">num</span><span class="op" id="1767166">-</span><span class="ident" id="1767167">ε</span><span class="op" id="1767169">)</span>&nbsp;<span class="op" id="1767171">&gt;</span>&nbsp;<span class="ident" id="1767173">den</span><span class="op" id="1767176">&lt;&lt;</span><span class="ident" id="1767178">shift</span>&nbsp;<span class="op" id="1767184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767188">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767211">i</span>&nbsp;<span class="op" id="1767213">:=</span>&nbsp;<span class="ident" id="1767216">d</span><span class="op" id="1767217">.</span><span class="ident" id="1767218">nd</span>&nbsp;<span class="op" id="1767221">-</span>&nbsp;<span class="num" id="1767223">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767227">for</span>&nbsp;<span class="op" id="1767231">;</span>&nbsp;<span class="ident" id="1767233">i</span>&nbsp;<span class="op" id="1767235">&gt;=</span>&nbsp;<span class="num" id="1767238">0</span><span class="op" id="1767239">;</span>&nbsp;<span class="ident" id="1767241">i</span><span class="op" id="1767242">--</span>&nbsp;<span class="op" id="1767245">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767250">if</span>&nbsp;<span class="ident" id="1767253">d</span><span class="op" id="1767254">.</span><span class="ident" id="1767255">d</span><span class="op" id="1767256">[</span><span class="ident" id="1767257">i</span><span class="op" id="1767258">]</span>&nbsp;<span class="op" id="1767260">==</span>&nbsp;<span class="string" id="1767263">&#39;9&#39;</span>&nbsp;<span class="op" id="1767267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767273">d</span><span class="op" id="1767274">.</span><span class="ident" id="1767275">nd</span><span class="op" id="1767277">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767283">}</span>&nbsp;<span class="keyword" id="1767285">else</span>&nbsp;<span class="op" id="1767290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767296">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767305">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767313">if</span>&nbsp;<span class="ident" id="1767316">i</span>&nbsp;<span class="op" id="1767318">&lt;</span>&nbsp;<span class="num" id="1767320">0</span>&nbsp;<span class="op" id="1767322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767327">d</span><span class="op" id="1767328">.</span><span class="ident" id="1767329">d</span><span class="op" id="1767330">[</span><span class="num" id="1767331">0</span><span class="op" id="1767332">]</span>&nbsp;<span class="op" id="1767334">=</span>&nbsp;<span class="string" id="1767336">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767343">d</span><span class="op" id="1767344">.</span><span class="ident" id="1767345">nd</span>&nbsp;<span class="op" id="1767348">=</span>&nbsp;<span class="num" id="1767350">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767355">d</span><span class="op" id="1767356">.</span><span class="ident" id="1767357">dp</span><span class="op" id="1767359">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767364">}</span>&nbsp;<span class="keyword" id="1767366">else</span>&nbsp;<span class="op" id="1767371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767376">d</span><span class="op" id="1767377">.</span><span class="ident" id="1767378">d</span><span class="op" id="1767379">[</span><span class="ident" id="1767380">i</span><span class="op" id="1767381">]</span><span class="op" id="1767382">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767391">return</span>&nbsp;<span class="builtintype" id="1767398">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767404">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767407">return</span>&nbsp;<span class="builtintype" id="1767414">false</span><br>
<span class="lineno"></span><span class="op" id="1767420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1767423">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="1767495">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="1767569">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="1767647">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="1767677">func</span>&nbsp;<span class="op" id="1767682">(</span><span class="ident" id="1767683">f</span>&nbsp;<span class="op" id="1767685">*</span><span class="ident" id="1767686">extFloat</span><span class="op" id="1767694">)</span>&nbsp;<span class="ident" id="1767696">ShortestDecimal</span><span class="op" id="1767711">(</span><span class="ident" id="1767712">d</span>&nbsp;<span class="op" id="1767714">*</span><span class="ident" id="1767715">decimalSlice</span><span class="op" id="1767727">,</span>&nbsp;<span class="ident" id="1767729">lower</span><span class="op" id="1767734">,</span>&nbsp;<span class="ident" id="1767736">upper</span>&nbsp;<span class="op" id="1767742">*</span><span class="ident" id="1767743">extFloat</span><span class="op" id="1767751">)</span>&nbsp;<span class="builtintype" id="1767753">bool</span>&nbsp;<span class="op" id="1767758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767761">if</span>&nbsp;<span class="ident" id="1767764">f</span><span class="op" id="1767765">.</span><span class="ident" id="1767766">mant</span>&nbsp;<span class="op" id="1767771">==</span>&nbsp;<span class="num" id="1767774">0</span>&nbsp;<span class="op" id="1767776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767780">d</span><span class="op" id="1767781">.</span><span class="ident" id="1767782">nd</span>&nbsp;<span class="op" id="1767785">=</span>&nbsp;<span class="num" id="1767787">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767791">d</span><span class="op" id="1767792">.</span><span class="ident" id="1767793">dp</span>&nbsp;<span class="op" id="1767796">=</span>&nbsp;<span class="num" id="1767798">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767802">d</span><span class="op" id="1767803">.</span><span class="ident" id="1767804">neg</span>&nbsp;<span class="op" id="1767808">=</span>&nbsp;<span class="ident" id="1767810">f</span><span class="op" id="1767811">.</span><span class="ident" id="1767812">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767818">return</span>&nbsp;<span class="builtintype" id="1767825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1767831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767834">if</span>&nbsp;<span class="ident" id="1767837">f</span><span class="op" id="1767838">.</span><span class="ident" id="1767839">exp</span>&nbsp;<span class="op" id="1767843">==</span>&nbsp;<span class="num" id="1767846">0</span>&nbsp;<span class="op" id="1767848">&amp;&amp;</span>&nbsp;<span class="op" id="1767851">*</span><span class="ident" id="1767852">lower</span>&nbsp;<span class="op" id="1767858">==</span>&nbsp;<span class="op" id="1767861">*</span><span class="ident" id="1767862">f</span>&nbsp;<span class="op" id="1767864">&amp;&amp;</span>&nbsp;<span class="op" id="1767867">*</span><span class="ident" id="1767868">lower</span>&nbsp;<span class="op" id="1767874">==</span>&nbsp;<span class="op" id="1767877">*</span><span class="ident" id="1767878">upper</span>&nbsp;<span class="op" id="1767884">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1767888">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767911">var</span>&nbsp;<span class="ident" id="1767915">buf</span>&nbsp;<span class="op" id="1767919">[</span><span class="num" id="1767920">24</span><span class="op" id="1767922">]</span><span class="builtintype" id="1767923">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767930">n</span>&nbsp;<span class="op" id="1767932">:=</span>&nbsp;<span class="builtinfunc" id="1767935">len</span><span class="op" id="1767938">(</span><span class="ident" id="1767939">buf</span><span class="op" id="1767942">)</span>&nbsp;<span class="op" id="1767944">-</span>&nbsp;<span class="num" id="1767946">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1767950">for</span>&nbsp;<span class="ident" id="1767954">v</span>&nbsp;<span class="op" id="1767956">:=</span>&nbsp;<span class="ident" id="1767959">f</span><span class="op" id="1767960">.</span><span class="ident" id="1767961">mant</span><span class="op" id="1767965">;</span>&nbsp;<span class="ident" id="1767967">v</span>&nbsp;<span class="op" id="1767969">&gt;</span>&nbsp;<span class="num" id="1767971">0</span><span class="op" id="1767972">;</span>&nbsp;<span class="op" id="1767974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767979">v1</span>&nbsp;<span class="op" id="1767982">:=</span>&nbsp;<span class="ident" id="1767985">v</span>&nbsp;<span class="op" id="1767987">/</span>&nbsp;<span class="num" id="1767989">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1767995">v</span>&nbsp;<span class="op" id="1767997">-=</span>&nbsp;<span class="num" id="1768000">10</span>&nbsp;<span class="op" id="1768003">*</span>&nbsp;<span class="ident" id="1768005">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768011">buf</span><span class="op" id="1768014">[</span><span class="ident" id="1768015">n</span><span class="op" id="1768016">]</span>&nbsp;<span class="op" id="1768018">=</span>&nbsp;<span class="builtintype" id="1768020">byte</span><span class="op" id="1768024">(</span><span class="ident" id="1768025">v</span>&nbsp;<span class="op" id="1768027">+</span>&nbsp;<span class="string" id="1768029">&#39;0&#39;</span><span class="op" id="1768032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768037">n</span><span class="op" id="1768038">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768044">v</span>&nbsp;<span class="op" id="1768046">=</span>&nbsp;<span class="ident" id="1768048">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768053">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768057">nd</span>&nbsp;<span class="op" id="1768060">:=</span>&nbsp;<span class="builtinfunc" id="1768063">len</span><span class="op" id="1768066">(</span><span class="ident" id="1768067">buf</span><span class="op" id="1768070">)</span>&nbsp;<span class="op" id="1768072">-</span>&nbsp;<span class="ident" id="1768074">n</span>&nbsp;<span class="op" id="1768076">-</span>&nbsp;<span class="num" id="1768078">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768082">for</span>&nbsp;<span class="ident" id="1768086">i</span>&nbsp;<span class="op" id="1768088">:=</span>&nbsp;<span class="num" id="1768091">0</span><span class="op" id="1768092">;</span>&nbsp;<span class="ident" id="1768094">i</span>&nbsp;<span class="op" id="1768096">&lt;</span>&nbsp;<span class="ident" id="1768098">nd</span><span class="op" id="1768100">;</span>&nbsp;<span class="ident" id="1768102">i</span><span class="op" id="1768103">++</span>&nbsp;<span class="op" id="1768106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768111">d</span><span class="op" id="1768112">.</span><span class="ident" id="1768113">d</span><span class="op" id="1768114">[</span><span class="ident" id="1768115">i</span><span class="op" id="1768116">]</span>&nbsp;<span class="op" id="1768118">=</span>&nbsp;<span class="ident" id="1768120">buf</span><span class="op" id="1768123">[</span><span class="ident" id="1768124">n</span><span class="op" id="1768125">+</span><span class="num" id="1768126">1</span><span class="op" id="1768127">+</span><span class="ident" id="1768128">i</span><span class="op" id="1768129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768137">d</span><span class="op" id="1768138">.</span><span class="ident" id="1768139">nd</span><span class="op" id="1768141">,</span>&nbsp;<span class="ident" id="1768143">d</span><span class="op" id="1768144">.</span><span class="ident" id="1768145">dp</span>&nbsp;<span class="op" id="1768148">=</span>&nbsp;<span class="ident" id="1768150">nd</span><span class="op" id="1768152">,</span>&nbsp;<span class="ident" id="1768154">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768159">for</span>&nbsp;<span class="ident" id="1768163">d</span><span class="op" id="1768164">.</span><span class="ident" id="1768165">nd</span>&nbsp;<span class="op" id="1768168">&gt;</span>&nbsp;<span class="num" id="1768170">0</span>&nbsp;<span class="op" id="1768172">&amp;&amp;</span>&nbsp;<span class="ident" id="1768175">d</span><span class="op" id="1768176">.</span><span class="ident" id="1768177">d</span><span class="op" id="1768178">[</span><span class="ident" id="1768179">d</span><span class="op" id="1768180">.</span><span class="ident" id="1768181">nd</span><span class="op" id="1768183">-</span><span class="num" id="1768184">1</span><span class="op" id="1768185">]</span>&nbsp;<span class="op" id="1768187">==</span>&nbsp;<span class="string" id="1768190">&#39;0&#39;</span>&nbsp;<span class="op" id="1768194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768199">d</span><span class="op" id="1768200">.</span><span class="ident" id="1768201">nd</span><span class="op" id="1768203">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768212">if</span>&nbsp;<span class="ident" id="1768215">d</span><span class="op" id="1768216">.</span><span class="ident" id="1768217">nd</span>&nbsp;<span class="op" id="1768220">==</span>&nbsp;<span class="num" id="1768223">0</span>&nbsp;<span class="op" id="1768225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768230">d</span><span class="op" id="1768231">.</span><span class="ident" id="1768232">dp</span>&nbsp;<span class="op" id="1768235">=</span>&nbsp;<span class="num" id="1768237">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768245">d</span><span class="op" id="1768246">.</span><span class="ident" id="1768247">neg</span>&nbsp;<span class="op" id="1768251">=</span>&nbsp;<span class="ident" id="1768253">f</span><span class="op" id="1768254">.</span><span class="ident" id="1768255">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768261">return</span>&nbsp;<span class="builtintype" id="1768268">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768277">upper</span><span class="op" id="1768282">.</span><span class="ident" id="1768283">Normalize</span><span class="op" id="1768292">(</span><span class="op" id="1768293">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768296">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768322">if</span>&nbsp;<span class="ident" id="1768325">f</span><span class="op" id="1768326">.</span><span class="ident" id="1768327">exp</span>&nbsp;<span class="op" id="1768331">&gt;</span>&nbsp;<span class="ident" id="1768333">upper</span><span class="op" id="1768338">.</span><span class="ident" id="1768339">exp</span>&nbsp;<span class="op" id="1768343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768347">f</span><span class="op" id="1768348">.</span><span class="ident" id="1768349">mant</span>&nbsp;<span class="op" id="1768354">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="1768358">uint</span><span class="op" id="1768362">(</span><span class="ident" id="1768363">f</span><span class="op" id="1768364">.</span><span class="ident" id="1768365">exp</span>&nbsp;<span class="op" id="1768369">-</span>&nbsp;<span class="ident" id="1768371">upper</span><span class="op" id="1768376">.</span><span class="ident" id="1768377">exp</span><span class="op" id="1768380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768384">f</span><span class="op" id="1768385">.</span><span class="ident" id="1768386">exp</span>&nbsp;<span class="op" id="1768390">=</span>&nbsp;<span class="ident" id="1768392">upper</span><span class="op" id="1768397">.</span><span class="ident" id="1768398">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768403">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1768406">if</span>&nbsp;<span class="ident" id="1768409">lower</span><span class="op" id="1768414">.</span><span class="ident" id="1768415">exp</span>&nbsp;<span class="op" id="1768419">&gt;</span>&nbsp;<span class="ident" id="1768421">upper</span><span class="op" id="1768426">.</span><span class="ident" id="1768427">exp</span>&nbsp;<span class="op" id="1768431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768435">lower</span><span class="op" id="1768440">.</span><span class="ident" id="1768441">mant</span>&nbsp;<span class="op" id="1768446">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="1768450">uint</span><span class="op" id="1768454">(</span><span class="ident" id="1768455">lower</span><span class="op" id="1768460">.</span><span class="ident" id="1768461">exp</span>&nbsp;<span class="op" id="1768465">-</span>&nbsp;<span class="ident" id="1768467">upper</span><span class="op" id="1768472">.</span><span class="ident" id="1768473">exp</span><span class="op" id="1768476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768480">lower</span><span class="op" id="1768485">.</span><span class="ident" id="1768486">exp</span>&nbsp;<span class="op" id="1768490">=</span>&nbsp;<span class="ident" id="1768492">upper</span><span class="op" id="1768497">.</span><span class="ident" id="1768498">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1768503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768507">exp10</span>&nbsp;<span class="op" id="1768513">:=</span>&nbsp;<span class="ident" id="1768516">frexp10Many</span><span class="op" id="1768527">(</span><span class="ident" id="1768528">lower</span><span class="op" id="1768533">,</span>&nbsp;<span class="ident" id="1768535">f</span><span class="op" id="1768536">,</span>&nbsp;<span class="ident" id="1768538">upper</span><span class="op" id="1768543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768546">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768626">upper</span><span class="op" id="1768631">.</span><span class="ident" id="1768632">mant</span><span class="op" id="1768636">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768640">lower</span><span class="op" id="1768645">.</span><span class="ident" id="1768646">mant</span><span class="op" id="1768650">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768655">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768726">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768772">shift</span>&nbsp;<span class="op" id="1768778">:=</span>&nbsp;<span class="builtintype" id="1768781">uint</span><span class="op" id="1768785">(</span><span class="op" id="1768786">-</span><span class="ident" id="1768787">upper</span><span class="op" id="1768792">.</span><span class="ident" id="1768793">exp</span><span class="op" id="1768796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768799">integer</span>&nbsp;<span class="op" id="1768807">:=</span>&nbsp;<span class="builtintype" id="1768810">uint32</span><span class="op" id="1768816">(</span><span class="ident" id="1768817">upper</span><span class="op" id="1768822">.</span><span class="ident" id="1768823">mant</span>&nbsp;<span class="op" id="1768828">&gt;&gt;</span>&nbsp;<span class="ident" id="1768831">shift</span><span class="op" id="1768836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768839">fraction</span>&nbsp;<span class="op" id="1768848">:=</span>&nbsp;<span class="ident" id="1768851">upper</span><span class="op" id="1768856">.</span><span class="ident" id="1768857">mant</span>&nbsp;<span class="op" id="1768862">-</span>&nbsp;<span class="op" id="1768864">(</span><span class="ident" id="1768865">uint64</span><span class="op" id="1768871">(</span><span class="ident" id="1768872">integer</span><span class="op" id="1768879">)</span>&nbsp;<span class="op" id="1768881">&lt;&lt;</span>&nbsp;<span class="ident" id="1768884">shift</span><span class="op" id="1768889">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768893">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1768958">allowance</span>&nbsp;<span class="op" id="1768968">:=</span>&nbsp;<span class="ident" id="1768971">upper</span><span class="op" id="1768976">.</span><span class="ident" id="1768977">mant</span>&nbsp;<span class="op" id="1768982">-</span>&nbsp;<span class="ident" id="1768984">lower</span><span class="op" id="1768989">.</span><span class="ident" id="1768990">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1768996">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769051">targetDiff</span>&nbsp;<span class="op" id="1769062">:=</span>&nbsp;<span class="ident" id="1769065">upper</span><span class="op" id="1769070">.</span><span class="ident" id="1769071">mant</span>&nbsp;<span class="op" id="1769076">-</span>&nbsp;<span class="ident" id="1769078">f</span><span class="op" id="1769079">.</span><span class="ident" id="1769080">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769087">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769136">var</span>&nbsp;<span class="ident" id="1769140">integerDigits</span>&nbsp;<span class="builtintype" id="1769154">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769159">for</span>&nbsp;<span class="ident" id="1769163">i</span><span class="op" id="1769164">,</span>&nbsp;<span class="ident" id="1769166">pow</span>&nbsp;<span class="op" id="1769170">:=</span>&nbsp;<span class="num" id="1769173">0</span><span class="op" id="1769174">,</span>&nbsp;<span class="ident" id="1769176">uint64</span><span class="op" id="1769182">(</span><span class="num" id="1769183">1</span><span class="op" id="1769184">)</span><span class="op" id="1769185">;</span>&nbsp;<span class="ident" id="1769187">i</span>&nbsp;<span class="op" id="1769189">&lt;</span>&nbsp;<span class="num" id="1769191">20</span><span class="op" id="1769193">;</span>&nbsp;<span class="ident" id="1769195">i</span><span class="op" id="1769196">++</span>&nbsp;<span class="op" id="1769199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769203">if</span>&nbsp;<span class="ident" id="1769206">pow</span>&nbsp;<span class="op" id="1769210">&gt;</span>&nbsp;<span class="ident" id="1769212">uint64</span><span class="op" id="1769218">(</span><span class="ident" id="1769219">integer</span><span class="op" id="1769226">)</span>&nbsp;<span class="op" id="1769228">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769233">integerDigits</span>&nbsp;<span class="op" id="1769247">=</span>&nbsp;<span class="ident" id="1769249">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769254">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1769262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769266">pow</span>&nbsp;<span class="op" id="1769270">*=</span>&nbsp;<span class="num" id="1769273">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1769277">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769280">for</span>&nbsp;<span class="ident" id="1769284">i</span>&nbsp;<span class="op" id="1769286">:=</span>&nbsp;<span class="num" id="1769289">0</span><span class="op" id="1769290">;</span>&nbsp;<span class="ident" id="1769292">i</span>&nbsp;<span class="op" id="1769294">&lt;</span>&nbsp;<span class="ident" id="1769296">integerDigits</span><span class="op" id="1769309">;</span>&nbsp;<span class="ident" id="1769311">i</span><span class="op" id="1769312">++</span>&nbsp;<span class="op" id="1769315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769319">pow</span>&nbsp;<span class="op" id="1769323">:=</span>&nbsp;<span class="ident" id="1769326">uint64pow10</span><span class="op" id="1769337">[</span><span class="ident" id="1769338">integerDigits</span><span class="op" id="1769351">-</span><span class="ident" id="1769352">i</span><span class="op" id="1769353">-</span><span class="num" id="1769354">1</span><span class="op" id="1769355">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769359">digit</span>&nbsp;<span class="op" id="1769365">:=</span>&nbsp;<span class="ident" id="1769368">integer</span>&nbsp;<span class="op" id="1769376">/</span>&nbsp;<span class="builtintype" id="1769378">uint32</span><span class="op" id="1769384">(</span><span class="ident" id="1769385">pow</span><span class="op" id="1769388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769392">d</span><span class="op" id="1769393">.</span><span class="ident" id="1769394">d</span><span class="op" id="1769395">[</span><span class="ident" id="1769396">i</span><span class="op" id="1769397">]</span>&nbsp;<span class="op" id="1769399">=</span>&nbsp;<span class="builtintype" id="1769401">byte</span><span class="op" id="1769405">(</span><span class="ident" id="1769406">digit</span>&nbsp;<span class="op" id="1769412">+</span>&nbsp;<span class="string" id="1769414">&#39;0&#39;</span><span class="op" id="1769417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769421">integer</span>&nbsp;<span class="op" id="1769429">-=</span>&nbsp;<span class="ident" id="1769432">digit</span>&nbsp;<span class="op" id="1769438">*</span>&nbsp;<span class="builtintype" id="1769440">uint32</span><span class="op" id="1769446">(</span><span class="ident" id="1769447">pow</span><span class="op" id="1769450">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769454">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769492">if</span>&nbsp;<span class="ident" id="1769495">currentDiff</span>&nbsp;<span class="op" id="1769507">:=</span>&nbsp;<span class="ident" id="1769510">uint64</span><span class="op" id="1769516">(</span><span class="ident" id="1769517">integer</span><span class="op" id="1769524">)</span><span class="op" id="1769525">&lt;&lt;</span><span class="ident" id="1769527">shift</span>&nbsp;<span class="op" id="1769533">+</span>&nbsp;<span class="ident" id="1769535">fraction</span><span class="op" id="1769543">;</span>&nbsp;<span class="ident" id="1769545">currentDiff</span>&nbsp;<span class="op" id="1769557">&lt;</span>&nbsp;<span class="ident" id="1769559">allowance</span>&nbsp;<span class="op" id="1769569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769574">d</span><span class="op" id="1769575">.</span><span class="ident" id="1769576">nd</span>&nbsp;<span class="op" id="1769579">=</span>&nbsp;<span class="ident" id="1769581">i</span>&nbsp;<span class="op" id="1769583">+</span>&nbsp;<span class="num" id="1769585">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769590">d</span><span class="op" id="1769591">.</span><span class="ident" id="1769592">dp</span>&nbsp;<span class="op" id="1769595">=</span>&nbsp;<span class="ident" id="1769597">integerDigits</span>&nbsp;<span class="op" id="1769611">+</span>&nbsp;<span class="ident" id="1769613">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769622">d</span><span class="op" id="1769623">.</span><span class="ident" id="1769624">neg</span>&nbsp;<span class="op" id="1769628">=</span>&nbsp;<span class="ident" id="1769630">f</span><span class="op" id="1769631">.</span><span class="ident" id="1769632">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769639">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769709">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1769747">return</span>&nbsp;<span class="ident" id="1769754">adjustLastDigit</span><span class="op" id="1769769">(</span><span class="ident" id="1769770">d</span><span class="op" id="1769771">,</span>&nbsp;<span class="ident" id="1769773">currentDiff</span><span class="op" id="1769784">,</span>&nbsp;<span class="ident" id="1769786">targetDiff</span><span class="op" id="1769796">,</span>&nbsp;<span class="ident" id="1769798">allowance</span><span class="op" id="1769807">,</span>&nbsp;<span class="ident" id="1769809">pow</span><span class="op" id="1769812">&lt;&lt;</span><span class="ident" id="1769814">shift</span><span class="op" id="1769819">,</span>&nbsp;<span class="num" id="1769821">2</span><span class="op" id="1769822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1769826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1769829">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769832">d</span><span class="op" id="1769833">.</span><span class="ident" id="1769834">nd</span>&nbsp;<span class="op" id="1769837">=</span>&nbsp;<span class="ident" id="1769839">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769854">d</span><span class="op" id="1769855">.</span><span class="ident" id="1769856">dp</span>&nbsp;<span class="op" id="1769859">=</span>&nbsp;<span class="ident" id="1769861">d</span><span class="op" id="1769862">.</span><span class="ident" id="1769863">nd</span>&nbsp;<span class="op" id="1769866">+</span>&nbsp;<span class="ident" id="1769868">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1769875">d</span><span class="op" id="1769876">.</span><span class="ident" id="1769877">neg</span>&nbsp;<span class="op" id="1769881">=</span>&nbsp;<span class="ident" id="1769883">f</span><span class="op" id="1769884">.</span><span class="ident" id="1769885">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769891">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1769965">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770041">var</span>&nbsp;<span class="ident" id="1770045">digit</span>&nbsp;<span class="builtintype" id="1770051">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770056">multiplier</span>&nbsp;<span class="op" id="1770067">:=</span>&nbsp;<span class="ident" id="1770070">uint64</span><span class="op" id="1770076">(</span><span class="num" id="1770077">1</span><span class="op" id="1770078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770081">for</span>&nbsp;<span class="op" id="1770085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770089">fraction</span>&nbsp;<span class="op" id="1770098">*=</span>&nbsp;<span class="num" id="1770101">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770106">multiplier</span>&nbsp;<span class="op" id="1770117">*=</span>&nbsp;<span class="num" id="1770120">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770125">digit</span>&nbsp;<span class="op" id="1770131">=</span>&nbsp;<span class="builtintype" id="1770133">int</span><span class="op" id="1770136">(</span><span class="ident" id="1770137">fraction</span>&nbsp;<span class="op" id="1770146">&gt;&gt;</span>&nbsp;<span class="ident" id="1770149">shift</span><span class="op" id="1770154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770158">d</span><span class="op" id="1770159">.</span><span class="ident" id="1770160">d</span><span class="op" id="1770161">[</span><span class="ident" id="1770162">d</span><span class="op" id="1770163">.</span><span class="ident" id="1770164">nd</span><span class="op" id="1770166">]</span>&nbsp;<span class="op" id="1770168">=</span>&nbsp;<span class="builtintype" id="1770170">byte</span><span class="op" id="1770174">(</span><span class="ident" id="1770175">digit</span>&nbsp;<span class="op" id="1770181">+</span>&nbsp;<span class="string" id="1770183">&#39;0&#39;</span><span class="op" id="1770186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770190">d</span><span class="op" id="1770191">.</span><span class="ident" id="1770192">nd</span><span class="op" id="1770194">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770199">fraction</span>&nbsp;<span class="op" id="1770208">-=</span>&nbsp;<span class="ident" id="1770211">uint64</span><span class="op" id="1770217">(</span><span class="ident" id="1770218">digit</span><span class="op" id="1770223">)</span>&nbsp;<span class="op" id="1770225">&lt;&lt;</span>&nbsp;<span class="ident" id="1770228">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770236">if</span>&nbsp;<span class="ident" id="1770239">fraction</span>&nbsp;<span class="op" id="1770248">&lt;</span>&nbsp;<span class="ident" id="1770250">allowance</span><span class="op" id="1770259">*</span><span class="ident" id="1770260">multiplier</span>&nbsp;<span class="op" id="1770271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770276">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770349">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1770426">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770475">return</span>&nbsp;<span class="ident" id="1770482">adjustLastDigit</span><span class="op" id="1770497">(</span><span class="ident" id="1770498">d</span><span class="op" id="1770499">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1770505">fraction</span><span class="op" id="1770513">,</span>&nbsp;<span class="ident" id="1770515">targetDiff</span><span class="op" id="1770525">*</span><span class="ident" id="1770526">multiplier</span><span class="op" id="1770536">,</span>&nbsp;<span class="ident" id="1770538">allowance</span><span class="op" id="1770547">*</span><span class="ident" id="1770548">multiplier</span><span class="op" id="1770558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1770564">1</span><span class="op" id="1770565">&lt;&lt;</span><span class="ident" id="1770567">shift</span><span class="op" id="1770572">,</span>&nbsp;<span class="ident" id="1770574">multiplier</span><span class="op" id="1770584">*</span><span class="num" id="1770585">2</span><span class="op" id="1770586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1770593">}</span><br>
<span class="lineno"></span><span class="op" id="1770595">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="1770598">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1770666">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="1770734">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1770802">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="1770862">func</span>&nbsp;<span class="ident" id="1770867">adjustLastDigit</span><span class="op" id="1770882">(</span><span class="ident" id="1770883">d</span>&nbsp;<span class="op" id="1770885">*</span><span class="ident" id="1770886">decimalSlice</span><span class="op" id="1770898">,</span>&nbsp;<span class="ident" id="1770900">currentDiff</span><span class="op" id="1770911">,</span>&nbsp;<span class="ident" id="1770913">targetDiff</span><span class="op" id="1770923">,</span>&nbsp;<span class="ident" id="1770925">maxDiff</span><span class="op" id="1770932">,</span>&nbsp;<span class="ident" id="1770934">ulpDecimal</span><span class="op" id="1770944">,</span>&nbsp;<span class="ident" id="1770946">ulpBinary</span>&nbsp;<span class="ident" id="1770956">uint64</span><span class="op" id="1770962">)</span>&nbsp;<span class="builtintype" id="1770964">bool</span>&nbsp;<span class="op" id="1770969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1770972">if</span>&nbsp;<span class="ident" id="1770975">ulpDecimal</span>&nbsp;<span class="op" id="1770986">&lt;</span>&nbsp;<span class="num" id="1770988">2</span><span class="op" id="1770989">*</span><span class="ident" id="1770990">ulpBinary</span>&nbsp;<span class="op" id="1771000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771004">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771036">return</span>&nbsp;<span class="builtintype" id="1771043">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771050">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771053">for</span>&nbsp;<span class="ident" id="1771057">currentDiff</span><span class="op" id="1771068">+</span><span class="ident" id="1771069">ulpDecimal</span><span class="op" id="1771079">/</span><span class="num" id="1771080">2</span><span class="op" id="1771081">+</span><span class="ident" id="1771082">ulpBinary</span>&nbsp;<span class="op" id="1771092">&lt;</span>&nbsp;<span class="ident" id="1771094">targetDiff</span>&nbsp;<span class="op" id="1771105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771109">d</span><span class="op" id="1771110">.</span><span class="ident" id="1771111">d</span><span class="op" id="1771112">[</span><span class="ident" id="1771113">d</span><span class="op" id="1771114">.</span><span class="ident" id="1771115">nd</span><span class="op" id="1771117">-</span><span class="num" id="1771118">1</span><span class="op" id="1771119">]</span><span class="op" id="1771120">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771125">currentDiff</span>&nbsp;<span class="op" id="1771137">+=</span>&nbsp;<span class="ident" id="1771140">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771155">if</span>&nbsp;<span class="ident" id="1771158">currentDiff</span><span class="op" id="1771169">+</span><span class="ident" id="1771170">ulpDecimal</span>&nbsp;<span class="op" id="1771181">&lt;=</span>&nbsp;<span class="ident" id="1771184">targetDiff</span><span class="op" id="1771194">+</span><span class="ident" id="1771195">ulpDecimal</span><span class="op" id="1771205">/</span><span class="num" id="1771206">2</span><span class="op" id="1771207">+</span><span class="ident" id="1771208">ulpBinary</span>&nbsp;<span class="op" id="1771218">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771222">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771275">return</span>&nbsp;<span class="builtintype" id="1771282">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771292">if</span>&nbsp;<span class="ident" id="1771295">currentDiff</span>&nbsp;<span class="op" id="1771307">&lt;</span>&nbsp;<span class="ident" id="1771309">ulpBinary</span>&nbsp;<span class="op" id="1771319">||</span>&nbsp;<span class="ident" id="1771322">currentDiff</span>&nbsp;<span class="op" id="1771334">&gt;</span>&nbsp;<span class="ident" id="1771336">maxDiff</span><span class="op" id="1771343">-</span><span class="ident" id="1771344">ulpBinary</span>&nbsp;<span class="op" id="1771354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771358">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771379">return</span>&nbsp;<span class="builtintype" id="1771386">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771396">if</span>&nbsp;<span class="ident" id="1771399">d</span><span class="op" id="1771400">.</span><span class="ident" id="1771401">nd</span>&nbsp;<span class="op" id="1771404">==</span>&nbsp;<span class="num" id="1771407">1</span>&nbsp;<span class="op" id="1771409">&amp;&amp;</span>&nbsp;<span class="ident" id="1771412">d</span><span class="op" id="1771413">.</span><span class="ident" id="1771414">d</span><span class="op" id="1771415">[</span><span class="num" id="1771416">0</span><span class="op" id="1771417">]</span>&nbsp;<span class="op" id="1771419">==</span>&nbsp;<span class="string" id="1771422">&#39;0&#39;</span>&nbsp;<span class="op" id="1771426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1771430">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771473">d</span><span class="op" id="1771474">.</span><span class="ident" id="1771475">nd</span>&nbsp;<span class="op" id="1771478">=</span>&nbsp;<span class="num" id="1771480">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1771484">d</span><span class="op" id="1771485">.</span><span class="ident" id="1771486">dp</span>&nbsp;<span class="op" id="1771489">=</span>&nbsp;<span class="num" id="1771491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1771494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1771497">return</span>&nbsp;<span class="builtintype" id="1771504">true</span><br>
<span class="lineno"></span><span class="op" id="1771509">}</span>
</div>
</body>
</html>
