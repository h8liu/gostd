<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base64</h2>
<ul>
<li><a href="/gostd/encoding/base64/base64.go.html">base64.go</a></li>
<li><a href="/gostd/encoding/base64/base64_test.go.html" class="current">base64_test.go</a></li>
<li><a href="/gostd/encoding/base64/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8310895">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8310950">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8311004">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8311055">package</span>&nbsp;<span class="ident" id="8311063">base64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311071">import</span>&nbsp;<span class="op" id="8311078">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311081">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311090">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311100">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311106">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311119">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311130">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311141">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311152">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8311159">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311162">type</span>&nbsp;<span class="ident" id="8311167">testpair</span>&nbsp;<span class="keyword" id="8311176">struct</span>&nbsp;<span class="op" id="8311183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8311186">decoded</span><span class="op" id="8311193">,</span>&nbsp;<span class="ident" id="8311195">encoded</span>&nbsp;<span class="builtintype" id="8311203">string</span><br>
<span class="lineno">20</span><span class="op" id="8311210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311213">var</span>&nbsp;<span class="ident" id="8311217">pairs</span>&nbsp;<span class="op" id="8311223">=</span>&nbsp;<span class="op" id="8311225">[</span><span class="op" id="8311226">]</span><span class="ident" id="8311227">testpair</span><span class="op" id="8311235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8311238">//&nbsp;RFC&nbsp;3548&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311260">{</span><span class="string" id="8311261">&#34;\x14\xfb\x9c\x03\xd9\x7e&#34;</span><span class="op" id="8311287">,</span>&nbsp;<span class="string" id="8311289">&#34;FPucA9l+&#34;</span><span class="op" id="8311299">}</span><span class="op" id="8311300">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311303">{</span><span class="string" id="8311304">&#34;\x14\xfb\x9c\x03\xd9&#34;</span><span class="op" id="8311326">,</span>&nbsp;<span class="string" id="8311328">&#34;FPucA9k=&#34;</span><span class="op" id="8311338">}</span><span class="op" id="8311339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311342">{</span><span class="string" id="8311343">&#34;\x14\xfb\x9c\x03&#34;</span><span class="op" id="8311361">,</span>&nbsp;<span class="string" id="8311363">&#34;FPucAw==&#34;</span><span class="op" id="8311373">}</span><span class="op" id="8311374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8311378">//&nbsp;RFC&nbsp;4648&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311400">{</span><span class="string" id="8311401">&#34;&#34;</span><span class="op" id="8311403">,</span>&nbsp;<span class="string" id="8311405">&#34;&#34;</span><span class="op" id="8311407">}</span><span class="op" id="8311408">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311411">{</span><span class="string" id="8311412">&#34;f&#34;</span><span class="op" id="8311415">,</span>&nbsp;<span class="string" id="8311417">&#34;Zg==&#34;</span><span class="op" id="8311423">}</span><span class="op" id="8311424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311427">{</span><span class="string" id="8311428">&#34;fo&#34;</span><span class="op" id="8311432">,</span>&nbsp;<span class="string" id="8311434">&#34;Zm8=&#34;</span><span class="op" id="8311440">}</span><span class="op" id="8311441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311444">{</span><span class="string" id="8311445">&#34;foo&#34;</span><span class="op" id="8311450">,</span>&nbsp;<span class="string" id="8311452">&#34;Zm9v&#34;</span><span class="op" id="8311458">}</span><span class="op" id="8311459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311462">{</span><span class="string" id="8311463">&#34;foob&#34;</span><span class="op" id="8311469">,</span>&nbsp;<span class="string" id="8311471">&#34;Zm9vYg==&#34;</span><span class="op" id="8311481">}</span><span class="op" id="8311482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311485">{</span><span class="string" id="8311486">&#34;fooba&#34;</span><span class="op" id="8311493">,</span>&nbsp;<span class="string" id="8311495">&#34;Zm9vYmE=&#34;</span><span class="op" id="8311505">}</span><span class="op" id="8311506">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311509">{</span><span class="string" id="8311510">&#34;foobar&#34;</span><span class="op" id="8311518">,</span>&nbsp;<span class="string" id="8311520">&#34;Zm9vYmFy&#34;</span><span class="op" id="8311530">}</span><span class="op" id="8311531">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8311535">//&nbsp;Wikipedia&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311558">{</span><span class="string" id="8311559">&#34;sure.&#34;</span><span class="op" id="8311566">,</span>&nbsp;<span class="string" id="8311568">&#34;c3VyZS4=&#34;</span><span class="op" id="8311578">}</span><span class="op" id="8311579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311582">{</span><span class="string" id="8311583">&#34;sure&#34;</span><span class="op" id="8311589">,</span>&nbsp;<span class="string" id="8311591">&#34;c3VyZQ==&#34;</span><span class="op" id="8311601">}</span><span class="op" id="8311602">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311605">{</span><span class="string" id="8311606">&#34;sur&#34;</span><span class="op" id="8311611">,</span>&nbsp;<span class="string" id="8311613">&#34;c3Vy&#34;</span><span class="op" id="8311619">}</span><span class="op" id="8311620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311623">{</span><span class="string" id="8311624">&#34;su&#34;</span><span class="op" id="8311628">,</span>&nbsp;<span class="string" id="8311630">&#34;c3U=&#34;</span><span class="op" id="8311636">}</span><span class="op" id="8311637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311640">{</span><span class="string" id="8311641">&#34;leasure.&#34;</span><span class="op" id="8311651">,</span>&nbsp;<span class="string" id="8311653">&#34;bGVhc3VyZS4=&#34;</span><span class="op" id="8311667">}</span><span class="op" id="8311668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311671">{</span><span class="string" id="8311672">&#34;easure.&#34;</span><span class="op" id="8311681">,</span>&nbsp;<span class="string" id="8311683">&#34;ZWFzdXJlLg==&#34;</span><span class="op" id="8311697">}</span><span class="op" id="8311698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311701">{</span><span class="string" id="8311702">&#34;asure.&#34;</span><span class="op" id="8311710">,</span>&nbsp;<span class="string" id="8311712">&#34;YXN1cmUu&#34;</span><span class="op" id="8311722">}</span><span class="op" id="8311723">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8311726">{</span><span class="string" id="8311727">&#34;sure.&#34;</span><span class="op" id="8311734">,</span>&nbsp;<span class="string" id="8311736">&#34;c3VyZS4=&#34;</span><span class="op" id="8311746">}</span><span class="op" id="8311747">,</span><br>
<span class="lineno"></span><span class="op" id="8311749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311752">var</span>&nbsp;<span class="ident" id="8311756">bigtest</span>&nbsp;<span class="op" id="8311764">=</span>&nbsp;<span class="ident" id="8311766">testpair</span><span class="op" id="8311774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311777">&#34;Twas&nbsp;brillig,&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves&#34;</span><span class="op" id="8311813">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8311816">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="8311866">,</span><br>
<span class="lineno"></span><span class="op" id="8311868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8311871">func</span>&nbsp;<span class="ident" id="8311876">testEqual</span><span class="op" id="8311885">(</span><span class="ident" id="8311886">t</span>&nbsp;<span class="op" id="8311888">*</span><span class="ident" id="8311889">testing</span><span class="op" id="8311896">.</span><span class="ident" id="8311897">T</span><span class="op" id="8311898">,</span>&nbsp;<span class="ident" id="8311900">msg</span>&nbsp;<span class="builtintype" id="8311904">string</span><span class="op" id="8311910">,</span>&nbsp;<span class="ident" id="8311912">args</span>&nbsp;<span class="op" id="8311917">...</span><span class="keyword" id="8311920">interface</span><span class="op" id="8311929">{</span><span class="op" id="8311930">}</span><span class="op" id="8311931">)</span>&nbsp;<span class="builtintype" id="8311933">bool</span>&nbsp;<span class="op" id="8311938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8311941">if</span>&nbsp;<span class="ident" id="8311944">args</span><span class="op" id="8311948">[</span><span class="builtinfunc" id="8311949">len</span><span class="op" id="8311952">(</span><span class="ident" id="8311953">args</span><span class="op" id="8311957">)</span><span class="op" id="8311958">-</span><span class="num" id="8311959">2</span><span class="op" id="8311960">]</span>&nbsp;<span class="op" id="8311962">!=</span>&nbsp;<span class="ident" id="8311965">args</span><span class="op" id="8311969">[</span><span class="builtinfunc" id="8311970">len</span><span class="op" id="8311973">(</span><span class="ident" id="8311974">args</span><span class="op" id="8311978">)</span><span class="op" id="8311979">-</span><span class="num" id="8311980">1</span><span class="op" id="8311981">]</span>&nbsp;<span class="op" id="8311983">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8311987">t</span><span class="op" id="8311988">.</span><span class="ident" id="8311989">Errorf</span><span class="op" id="8311995">(</span><span class="ident" id="8311996">msg</span><span class="op" id="8311999">,</span>&nbsp;<span class="ident" id="8312001">args</span><span class="op" id="8312005">...</span><span class="op" id="8312008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312012">return</span>&nbsp;<span class="builtintype" id="8312019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8312026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312029">return</span>&nbsp;<span class="builtintype" id="8312036">true</span><br>
<span class="lineno"></span><span class="op" id="8312041">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="8312044">func</span>&nbsp;<span class="ident" id="8312049">TestEncode</span><span class="op" id="8312059">(</span><span class="ident" id="8312060">t</span>&nbsp;<span class="op" id="8312062">*</span><span class="ident" id="8312063">testing</span><span class="op" id="8312070">.</span><span class="ident" id="8312071">T</span><span class="op" id="8312072">)</span>&nbsp;<span class="op" id="8312074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312077">for</span>&nbsp;<span class="ident" id="8312081">_</span><span class="op" id="8312082">,</span>&nbsp;<span class="ident" id="8312084">p</span>&nbsp;<span class="op" id="8312086">:=</span>&nbsp;<span class="keyword" id="8312089">range</span>&nbsp;<span class="ident" id="8312095">pairs</span>&nbsp;<span class="op" id="8312101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312105">got</span>&nbsp;<span class="op" id="8312109">:=</span>&nbsp;<span class="ident" id="8312112">StdEncoding</span><span class="op" id="8312123">.</span><span class="ident" id="8312124">EncodeToString</span><span class="op" id="8312138">(</span><span class="op" id="8312139">[</span><span class="op" id="8312140">]</span><span class="builtintype" id="8312141">byte</span><span class="op" id="8312145">(</span><span class="ident" id="8312146">p</span><span class="op" id="8312147">.</span><span class="ident" id="8312148">decoded</span><span class="op" id="8312155">)</span><span class="op" id="8312156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312160">testEqual</span><span class="op" id="8312169">(</span><span class="ident" id="8312170">t</span><span class="op" id="8312171">,</span>&nbsp;<span class="string" id="8312173">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8312199">,</span>&nbsp;<span class="ident" id="8312201">p</span><span class="op" id="8312202">.</span><span class="ident" id="8312203">decoded</span><span class="op" id="8312210">,</span>&nbsp;<span class="ident" id="8312212">got</span><span class="op" id="8312215">,</span>&nbsp;<span class="ident" id="8312217">p</span><span class="op" id="8312218">.</span><span class="ident" id="8312219">encoded</span><span class="op" id="8312226">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8312229">}</span><br>
<span class="lineno"></span><span class="op" id="8312231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8312234">func</span>&nbsp;<span class="ident" id="8312239">TestEncoder</span><span class="op" id="8312250">(</span><span class="ident" id="8312251">t</span>&nbsp;<span class="op" id="8312253">*</span><span class="ident" id="8312254">testing</span><span class="op" id="8312261">.</span><span class="ident" id="8312262">T</span><span class="op" id="8312263">)</span>&nbsp;<span class="op" id="8312265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312268">for</span>&nbsp;<span class="ident" id="8312272">_</span><span class="op" id="8312273">,</span>&nbsp;<span class="ident" id="8312275">p</span>&nbsp;<span class="op" id="8312277">:=</span>&nbsp;<span class="keyword" id="8312280">range</span>&nbsp;<span class="ident" id="8312286">pairs</span>&nbsp;<span class="op" id="8312292">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312296">bb</span>&nbsp;<span class="op" id="8312299">:=</span>&nbsp;<span class="op" id="8312302">&amp;</span><span class="ident" id="8312303">bytes</span><span class="op" id="8312308">.</span><span class="ident" id="8312309">Buffer</span><span class="op" id="8312315">{</span><span class="op" id="8312316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312320">encoder</span>&nbsp;<span class="op" id="8312328">:=</span>&nbsp;<span class="ident" id="8312331">NewEncoder</span><span class="op" id="8312341">(</span><span class="ident" id="8312342">StdEncoding</span><span class="op" id="8312353">,</span>&nbsp;<span class="ident" id="8312355">bb</span><span class="op" id="8312357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312361">encoder</span><span class="op" id="8312368">.</span><span class="ident" id="8312369">Write</span><span class="op" id="8312374">(</span><span class="op" id="8312375">[</span><span class="op" id="8312376">]</span><span class="builtintype" id="8312377">byte</span><span class="op" id="8312381">(</span><span class="ident" id="8312382">p</span><span class="op" id="8312383">.</span><span class="ident" id="8312384">decoded</span><span class="op" id="8312391">)</span><span class="op" id="8312392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312396">encoder</span><span class="op" id="8312403">.</span><span class="ident" id="8312404">Close</span><span class="op" id="8312409">(</span><span class="op" id="8312410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312414">testEqual</span><span class="op" id="8312423">(</span><span class="ident" id="8312424">t</span><span class="op" id="8312425">,</span>&nbsp;<span class="string" id="8312427">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8312453">,</span>&nbsp;<span class="ident" id="8312455">p</span><span class="op" id="8312456">.</span><span class="ident" id="8312457">decoded</span><span class="op" id="8312464">,</span>&nbsp;<span class="ident" id="8312466">bb</span><span class="op" id="8312468">.</span><span class="ident" id="8312469">String</span><span class="op" id="8312475">(</span><span class="op" id="8312476">)</span><span class="op" id="8312477">,</span>&nbsp;<span class="ident" id="8312479">p</span><span class="op" id="8312480">.</span><span class="ident" id="8312481">encoded</span><span class="op" id="8312488">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8312491">}</span><br>
<span class="lineno"></span><span class="op" id="8312493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8312496">func</span>&nbsp;<span class="ident" id="8312501">TestEncoderBuffering</span><span class="op" id="8312521">(</span><span class="ident" id="8312522">t</span>&nbsp;<span class="op" id="8312524">*</span><span class="ident" id="8312525">testing</span><span class="op" id="8312532">.</span><span class="ident" id="8312533">T</span><span class="op" id="8312534">)</span>&nbsp;<span class="op" id="8312536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312539">input</span>&nbsp;<span class="op" id="8312545">:=</span>&nbsp;<span class="op" id="8312548">[</span><span class="op" id="8312549">]</span><span class="builtintype" id="8312550">byte</span><span class="op" id="8312554">(</span><span class="ident" id="8312555">bigtest</span><span class="op" id="8312562">.</span><span class="ident" id="8312563">decoded</span><span class="op" id="8312570">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312573">for</span>&nbsp;<span class="ident" id="8312577">bs</span>&nbsp;<span class="op" id="8312580">:=</span>&nbsp;<span class="num" id="8312583">1</span><span class="op" id="8312584">;</span>&nbsp;<span class="ident" id="8312586">bs</span>&nbsp;<span class="op" id="8312589">&lt;=</span>&nbsp;<span class="num" id="8312592">12</span><span class="op" id="8312594">;</span>&nbsp;<span class="ident" id="8312596">bs</span><span class="op" id="8312598">++</span>&nbsp;<span class="op" id="8312601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312605">bb</span>&nbsp;<span class="op" id="8312608">:=</span>&nbsp;<span class="op" id="8312611">&amp;</span><span class="ident" id="8312612">bytes</span><span class="op" id="8312617">.</span><span class="ident" id="8312618">Buffer</span><span class="op" id="8312624">{</span><span class="op" id="8312625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312629">encoder</span>&nbsp;<span class="op" id="8312637">:=</span>&nbsp;<span class="ident" id="8312640">NewEncoder</span><span class="op" id="8312650">(</span><span class="ident" id="8312651">StdEncoding</span><span class="op" id="8312662">,</span>&nbsp;<span class="ident" id="8312664">bb</span><span class="op" id="8312666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312670">for</span>&nbsp;<span class="ident" id="8312674">pos</span>&nbsp;<span class="op" id="8312678">:=</span>&nbsp;<span class="num" id="8312681">0</span><span class="op" id="8312682">;</span>&nbsp;<span class="ident" id="8312684">pos</span>&nbsp;<span class="op" id="8312688">&lt;</span>&nbsp;<span class="builtinfunc" id="8312690">len</span><span class="op" id="8312693">(</span><span class="ident" id="8312694">input</span><span class="op" id="8312699">)</span><span class="op" id="8312700">;</span>&nbsp;<span class="ident" id="8312702">pos</span>&nbsp;<span class="op" id="8312706">+=</span>&nbsp;<span class="ident" id="8312709">bs</span>&nbsp;<span class="op" id="8312712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312717">end</span>&nbsp;<span class="op" id="8312721">:=</span>&nbsp;<span class="ident" id="8312724">pos</span>&nbsp;<span class="op" id="8312728">+</span>&nbsp;<span class="ident" id="8312730">bs</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8312736">if</span>&nbsp;<span class="ident" id="8312739">end</span>&nbsp;<span class="op" id="8312743">&gt;</span>&nbsp;<span class="builtinfunc" id="8312745">len</span><span class="op" id="8312748">(</span><span class="ident" id="8312749">input</span><span class="op" id="8312754">)</span>&nbsp;<span class="op" id="8312756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312762">end</span>&nbsp;<span class="op" id="8312766">=</span>&nbsp;<span class="builtinfunc" id="8312768">len</span><span class="op" id="8312771">(</span><span class="ident" id="8312772">input</span><span class="op" id="8312777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8312782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312787">n</span><span class="op" id="8312788">,</span>&nbsp;<span class="ident" id="8312790">err</span>&nbsp;<span class="op" id="8312794">:=</span>&nbsp;<span class="ident" id="8312797">encoder</span><span class="op" id="8312804">.</span><span class="ident" id="8312805">Write</span><span class="op" id="8312810">(</span><span class="ident" id="8312811">input</span><span class="op" id="8312816">[</span><span class="ident" id="8312817">pos</span><span class="op" id="8312820">:</span><span class="ident" id="8312821">end</span><span class="op" id="8312824">]</span><span class="op" id="8312825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312830">testEqual</span><span class="op" id="8312839">(</span><span class="ident" id="8312840">t</span><span class="op" id="8312841">,</span>&nbsp;<span class="string" id="8312843">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8312877">,</span>&nbsp;<span class="ident" id="8312879">input</span><span class="op" id="8312884">[</span><span class="ident" id="8312885">pos</span><span class="op" id="8312888">:</span><span class="ident" id="8312889">end</span><span class="op" id="8312892">]</span><span class="op" id="8312893">,</span>&nbsp;<span class="ident" id="8312895">err</span><span class="op" id="8312898">,</span>&nbsp;<span class="builtintype" id="8312900">error</span><span class="op" id="8312905">(</span><span class="builtintype" id="8312906">nil</span><span class="op" id="8312909">)</span><span class="op" id="8312910">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312915">testEqual</span><span class="op" id="8312924">(</span><span class="ident" id="8312925">t</span><span class="op" id="8312926">,</span>&nbsp;<span class="string" id="8312928">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8312963">,</span>&nbsp;<span class="ident" id="8312965">input</span><span class="op" id="8312970">[</span><span class="ident" id="8312971">pos</span><span class="op" id="8312974">:</span><span class="ident" id="8312975">end</span><span class="op" id="8312978">]</span><span class="op" id="8312979">,</span>&nbsp;<span class="ident" id="8312981">n</span><span class="op" id="8312982">,</span>&nbsp;<span class="ident" id="8312984">end</span><span class="op" id="8312987">-</span><span class="ident" id="8312988">pos</span><span class="op" id="8312991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8312995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8312999">err</span>&nbsp;<span class="op" id="8313003">:=</span>&nbsp;<span class="ident" id="8313006">encoder</span><span class="op" id="8313013">.</span><span class="ident" id="8313014">Close</span><span class="op" id="8313019">(</span><span class="op" id="8313020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313024">testEqual</span><span class="op" id="8313033">(</span><span class="ident" id="8313034">t</span><span class="op" id="8313035">,</span>&nbsp;<span class="string" id="8313037">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8313067">,</span>&nbsp;<span class="ident" id="8313069">err</span><span class="op" id="8313072">,</span>&nbsp;<span class="builtintype" id="8313074">error</span><span class="op" id="8313079">(</span><span class="builtintype" id="8313080">nil</span><span class="op" id="8313083">)</span><span class="op" id="8313084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313088">testEqual</span><span class="op" id="8313097">(</span><span class="ident" id="8313098">t</span><span class="op" id="8313099">,</span>&nbsp;<span class="string" id="8313101">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8313134">,</span>&nbsp;<span class="ident" id="8313136">bs</span><span class="op" id="8313138">,</span>&nbsp;<span class="ident" id="8313140">bigtest</span><span class="op" id="8313147">.</span><span class="ident" id="8313148">decoded</span><span class="op" id="8313155">,</span>&nbsp;<span class="ident" id="8313157">bb</span><span class="op" id="8313159">.</span><span class="ident" id="8313160">String</span><span class="op" id="8313166">(</span><span class="op" id="8313167">)</span><span class="op" id="8313168">,</span>&nbsp;<span class="ident" id="8313170">bigtest</span><span class="op" id="8313177">.</span><span class="ident" id="8313178">encoded</span><span class="op" id="8313185">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8313188">}</span><br>
<span class="lineno"></span><span class="op" id="8313190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8313193">func</span>&nbsp;<span class="ident" id="8313198">TestDecode</span><span class="op" id="8313208">(</span><span class="ident" id="8313209">t</span>&nbsp;<span class="op" id="8313211">*</span><span class="ident" id="8313212">testing</span><span class="op" id="8313219">.</span><span class="ident" id="8313220">T</span><span class="op" id="8313221">)</span>&nbsp;<span class="op" id="8313223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8313226">for</span>&nbsp;<span class="ident" id="8313230">_</span><span class="op" id="8313231">,</span>&nbsp;<span class="ident" id="8313233">p</span>&nbsp;<span class="op" id="8313235">:=</span>&nbsp;<span class="keyword" id="8313238">range</span>&nbsp;<span class="ident" id="8313244">pairs</span>&nbsp;<span class="op" id="8313250">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313254">dbuf</span>&nbsp;<span class="op" id="8313259">:=</span>&nbsp;<span class="builtinfunc" id="8313262">make</span><span class="op" id="8313266">(</span><span class="op" id="8313267">[</span><span class="op" id="8313268">]</span><span class="builtintype" id="8313269">byte</span><span class="op" id="8313273">,</span>&nbsp;<span class="ident" id="8313275">StdEncoding</span><span class="op" id="8313286">.</span><span class="ident" id="8313287">DecodedLen</span><span class="op" id="8313297">(</span><span class="builtinfunc" id="8313298">len</span><span class="op" id="8313301">(</span><span class="ident" id="8313302">p</span><span class="op" id="8313303">.</span><span class="ident" id="8313304">encoded</span><span class="op" id="8313311">)</span><span class="op" id="8313312">)</span><span class="op" id="8313313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313317">count</span><span class="op" id="8313322">,</span>&nbsp;<span class="ident" id="8313324">end</span><span class="op" id="8313327">,</span>&nbsp;<span class="ident" id="8313329">err</span>&nbsp;<span class="op" id="8313333">:=</span>&nbsp;<span class="ident" id="8313336">StdEncoding</span><span class="op" id="8313347">.</span><span class="ident" id="8313348">decode</span><span class="op" id="8313354">(</span><span class="ident" id="8313355">dbuf</span><span class="op" id="8313359">,</span>&nbsp;<span class="op" id="8313361">[</span><span class="op" id="8313362">]</span><span class="builtintype" id="8313363">byte</span><span class="op" id="8313367">(</span><span class="ident" id="8313368">p</span><span class="op" id="8313369">.</span><span class="ident" id="8313370">encoded</span><span class="op" id="8313377">)</span><span class="op" id="8313378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313382">testEqual</span><span class="op" id="8313391">(</span><span class="ident" id="8313392">t</span><span class="op" id="8313393">,</span>&nbsp;<span class="string" id="8313395">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8313427">,</span>&nbsp;<span class="ident" id="8313429">p</span><span class="op" id="8313430">.</span><span class="ident" id="8313431">encoded</span><span class="op" id="8313438">,</span>&nbsp;<span class="ident" id="8313440">err</span><span class="op" id="8313443">,</span>&nbsp;<span class="builtintype" id="8313445">error</span><span class="op" id="8313450">(</span><span class="builtintype" id="8313451">nil</span><span class="op" id="8313454">)</span><span class="op" id="8313455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313459">testEqual</span><span class="op" id="8313468">(</span><span class="ident" id="8313469">t</span><span class="op" id="8313470">,</span>&nbsp;<span class="string" id="8313472">&#34;Decode(%q)&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8313505">,</span>&nbsp;<span class="ident" id="8313507">p</span><span class="op" id="8313508">.</span><span class="ident" id="8313509">encoded</span><span class="op" id="8313516">,</span>&nbsp;<span class="ident" id="8313518">count</span><span class="op" id="8313523">,</span>&nbsp;<span class="builtinfunc" id="8313525">len</span><span class="op" id="8313528">(</span><span class="ident" id="8313529">p</span><span class="op" id="8313530">.</span><span class="ident" id="8313531">decoded</span><span class="op" id="8313538">)</span><span class="op" id="8313539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8313543">if</span>&nbsp;<span class="builtinfunc" id="8313546">len</span><span class="op" id="8313549">(</span><span class="ident" id="8313550">p</span><span class="op" id="8313551">.</span><span class="ident" id="8313552">encoded</span><span class="op" id="8313559">)</span>&nbsp;<span class="op" id="8313561">&gt;</span>&nbsp;<span class="num" id="8313563">0</span>&nbsp;<span class="op" id="8313565">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313570">testEqual</span><span class="op" id="8313579">(</span><span class="ident" id="8313580">t</span><span class="op" id="8313581">,</span>&nbsp;<span class="string" id="8313583">&#34;Decode(%q)&nbsp;=&nbsp;end&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8313613">,</span>&nbsp;<span class="ident" id="8313615">p</span><span class="op" id="8313616">.</span><span class="ident" id="8313617">encoded</span><span class="op" id="8313624">,</span>&nbsp;<span class="ident" id="8313626">end</span><span class="op" id="8313629">,</span>&nbsp;<span class="op" id="8313631">(</span><span class="ident" id="8313632">p</span><span class="op" id="8313633">.</span><span class="ident" id="8313634">encoded</span><span class="op" id="8313641">[</span><span class="builtinfunc" id="8313642">len</span><span class="op" id="8313645">(</span><span class="ident" id="8313646">p</span><span class="op" id="8313647">.</span><span class="ident" id="8313648">encoded</span><span class="op" id="8313655">)</span><span class="op" id="8313656">-</span><span class="num" id="8313657">1</span><span class="op" id="8313658">]</span>&nbsp;<span class="op" id="8313660">==</span>&nbsp;<span class="string" id="8313663">&#39;=&#39;</span><span class="op" id="8313666">)</span><span class="op" id="8313667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8313671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313675">testEqual</span><span class="op" id="8313684">(</span><span class="ident" id="8313685">t</span><span class="op" id="8313686">,</span>&nbsp;<span class="string" id="8313688">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8313714">,</span>&nbsp;<span class="ident" id="8313716">p</span><span class="op" id="8313717">.</span><span class="ident" id="8313718">encoded</span><span class="op" id="8313725">,</span>&nbsp;<span class="builtintype" id="8313727">string</span><span class="op" id="8313733">(</span><span class="ident" id="8313734">dbuf</span><span class="op" id="8313738">[</span><span class="num" id="8313739">0</span><span class="op" id="8313740">:</span><span class="ident" id="8313741">count</span><span class="op" id="8313746">]</span><span class="op" id="8313747">)</span><span class="op" id="8313748">,</span>&nbsp;<span class="ident" id="8313750">p</span><span class="op" id="8313751">.</span><span class="ident" id="8313752">decoded</span><span class="op" id="8313759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313764">dbuf</span><span class="op" id="8313768">,</span>&nbsp;<span class="ident" id="8313770">err</span>&nbsp;<span class="op" id="8313774">=</span>&nbsp;<span class="ident" id="8313776">StdEncoding</span><span class="op" id="8313787">.</span><span class="ident" id="8313788">DecodeString</span><span class="op" id="8313800">(</span><span class="ident" id="8313801">p</span><span class="op" id="8313802">.</span><span class="ident" id="8313803">encoded</span><span class="op" id="8313810">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313814">testEqual</span><span class="op" id="8313823">(</span><span class="ident" id="8313824">t</span><span class="op" id="8313825">,</span>&nbsp;<span class="string" id="8313827">&#34;DecodeString(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8313865">,</span>&nbsp;<span class="ident" id="8313867">p</span><span class="op" id="8313868">.</span><span class="ident" id="8313869">encoded</span><span class="op" id="8313876">,</span>&nbsp;<span class="ident" id="8313878">err</span><span class="op" id="8313881">,</span>&nbsp;<span class="builtintype" id="8313883">error</span><span class="op" id="8313888">(</span><span class="builtintype" id="8313889">nil</span><span class="op" id="8313892">)</span><span class="op" id="8313893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8313897">testEqual</span><span class="op" id="8313906">(</span><span class="ident" id="8313907">t</span><span class="op" id="8313908">,</span>&nbsp;<span class="string" id="8313910">&#34;DecodeString(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8313942">,</span>&nbsp;<span class="builtintype" id="8313944">string</span><span class="op" id="8313950">(</span><span class="ident" id="8313951">dbuf</span><span class="op" id="8313955">)</span><span class="op" id="8313956">,</span>&nbsp;<span class="ident" id="8313958">p</span><span class="op" id="8313959">.</span><span class="ident" id="8313960">decoded</span><span class="op" id="8313967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8313970">}</span><br>
<span class="lineno"></span><span class="op" id="8313972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="8313975">func</span>&nbsp;<span class="ident" id="8313980">TestDecoder</span><span class="op" id="8313991">(</span><span class="ident" id="8313992">t</span>&nbsp;<span class="op" id="8313994">*</span><span class="ident" id="8313995">testing</span><span class="op" id="8314002">.</span><span class="ident" id="8314003">T</span><span class="op" id="8314004">)</span>&nbsp;<span class="op" id="8314006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314009">for</span>&nbsp;<span class="ident" id="8314013">_</span><span class="op" id="8314014">,</span>&nbsp;<span class="ident" id="8314016">p</span>&nbsp;<span class="op" id="8314018">:=</span>&nbsp;<span class="keyword" id="8314021">range</span>&nbsp;<span class="ident" id="8314027">pairs</span>&nbsp;<span class="op" id="8314033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314037">decoder</span>&nbsp;<span class="op" id="8314045">:=</span>&nbsp;<span class="ident" id="8314048">NewDecoder</span><span class="op" id="8314058">(</span><span class="ident" id="8314059">StdEncoding</span><span class="op" id="8314070">,</span>&nbsp;<span class="ident" id="8314072">strings</span><span class="op" id="8314079">.</span><span class="ident" id="8314080">NewReader</span><span class="op" id="8314089">(</span><span class="ident" id="8314090">p</span><span class="op" id="8314091">.</span><span class="ident" id="8314092">encoded</span><span class="op" id="8314099">)</span><span class="op" id="8314100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314104">dbuf</span>&nbsp;<span class="op" id="8314109">:=</span>&nbsp;<span class="builtinfunc" id="8314112">make</span><span class="op" id="8314116">(</span><span class="op" id="8314117">[</span><span class="op" id="8314118">]</span><span class="builtintype" id="8314119">byte</span><span class="op" id="8314123">,</span>&nbsp;<span class="ident" id="8314125">StdEncoding</span><span class="op" id="8314136">.</span><span class="ident" id="8314137">DecodedLen</span><span class="op" id="8314147">(</span><span class="builtinfunc" id="8314148">len</span><span class="op" id="8314151">(</span><span class="ident" id="8314152">p</span><span class="op" id="8314153">.</span><span class="ident" id="8314154">encoded</span><span class="op" id="8314161">)</span><span class="op" id="8314162">)</span><span class="op" id="8314163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314167">count</span><span class="op" id="8314172">,</span>&nbsp;<span class="ident" id="8314174">err</span>&nbsp;<span class="op" id="8314178">:=</span>&nbsp;<span class="ident" id="8314181">decoder</span><span class="op" id="8314188">.</span><span class="ident" id="8314189">Read</span><span class="op" id="8314193">(</span><span class="ident" id="8314194">dbuf</span><span class="op" id="8314198">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314202">if</span>&nbsp;<span class="ident" id="8314205">err</span>&nbsp;<span class="op" id="8314209">!=</span>&nbsp;<span class="builtintype" id="8314212">nil</span>&nbsp;<span class="op" id="8314216">&amp;&amp;</span>&nbsp;<span class="ident" id="8314219">err</span>&nbsp;<span class="op" id="8314223">!=</span>&nbsp;<span class="ident" id="8314226">io</span><span class="op" id="8314228">.</span><span class="ident" id="8314229">EOF</span>&nbsp;<span class="op" id="8314233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314238">t</span><span class="op" id="8314239">.</span><span class="ident" id="8314240">Fatal</span><span class="op" id="8314245">(</span><span class="string" id="8314246">&#34;Read&nbsp;failed&#34;</span><span class="op" id="8314259">,</span>&nbsp;<span class="ident" id="8314261">err</span><span class="op" id="8314264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8314268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314272">testEqual</span><span class="op" id="8314281">(</span><span class="ident" id="8314282">t</span><span class="op" id="8314283">,</span>&nbsp;<span class="string" id="8314285">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8314320">,</span>&nbsp;<span class="ident" id="8314322">p</span><span class="op" id="8314323">.</span><span class="ident" id="8314324">encoded</span><span class="op" id="8314331">,</span>&nbsp;<span class="ident" id="8314333">count</span><span class="op" id="8314338">,</span>&nbsp;<span class="builtinfunc" id="8314340">len</span><span class="op" id="8314343">(</span><span class="ident" id="8314344">p</span><span class="op" id="8314345">.</span><span class="ident" id="8314346">decoded</span><span class="op" id="8314353">)</span><span class="op" id="8314354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314358">testEqual</span><span class="op" id="8314367">(</span><span class="ident" id="8314368">t</span><span class="op" id="8314369">,</span>&nbsp;<span class="string" id="8314371">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8314401">,</span>&nbsp;<span class="ident" id="8314403">p</span><span class="op" id="8314404">.</span><span class="ident" id="8314405">encoded</span><span class="op" id="8314412">,</span>&nbsp;<span class="builtintype" id="8314414">string</span><span class="op" id="8314420">(</span><span class="ident" id="8314421">dbuf</span><span class="op" id="8314425">[</span><span class="num" id="8314426">0</span><span class="op" id="8314427">:</span><span class="ident" id="8314428">count</span><span class="op" id="8314433">]</span><span class="op" id="8314434">)</span><span class="op" id="8314435">,</span>&nbsp;<span class="ident" id="8314437">p</span><span class="op" id="8314438">.</span><span class="ident" id="8314439">decoded</span><span class="op" id="8314446">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314450">if</span>&nbsp;<span class="ident" id="8314453">err</span>&nbsp;<span class="op" id="8314457">!=</span>&nbsp;<span class="ident" id="8314460">io</span><span class="op" id="8314462">.</span><span class="ident" id="8314463">EOF</span>&nbsp;<span class="op" id="8314467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314472">count</span><span class="op" id="8314477">,</span>&nbsp;<span class="ident" id="8314479">err</span>&nbsp;<span class="op" id="8314483">=</span>&nbsp;<span class="ident" id="8314485">decoder</span><span class="op" id="8314492">.</span><span class="ident" id="8314493">Read</span><span class="op" id="8314497">(</span><span class="ident" id="8314498">dbuf</span><span class="op" id="8314502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8314506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314510">testEqual</span><span class="op" id="8314519">(</span><span class="ident" id="8314520">t</span><span class="op" id="8314521">,</span>&nbsp;<span class="string" id="8314523">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8314551">,</span>&nbsp;<span class="ident" id="8314553">p</span><span class="op" id="8314554">.</span><span class="ident" id="8314555">encoded</span><span class="op" id="8314562">,</span>&nbsp;<span class="ident" id="8314564">err</span><span class="op" id="8314567">,</span>&nbsp;<span class="ident" id="8314569">io</span><span class="op" id="8314571">.</span><span class="ident" id="8314572">EOF</span><span class="op" id="8314575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8314578">}</span><br>
<span class="lineno">130</span><span class="op" id="8314580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8314583">func</span>&nbsp;<span class="ident" id="8314588">TestDecoderBuffering</span><span class="op" id="8314608">(</span><span class="ident" id="8314609">t</span>&nbsp;<span class="op" id="8314611">*</span><span class="ident" id="8314612">testing</span><span class="op" id="8314619">.</span><span class="ident" id="8314620">T</span><span class="op" id="8314621">)</span>&nbsp;<span class="op" id="8314623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314626">for</span>&nbsp;<span class="ident" id="8314630">bs</span>&nbsp;<span class="op" id="8314633">:=</span>&nbsp;<span class="num" id="8314636">1</span><span class="op" id="8314637">;</span>&nbsp;<span class="ident" id="8314639">bs</span>&nbsp;<span class="op" id="8314642">&lt;=</span>&nbsp;<span class="num" id="8314645">12</span><span class="op" id="8314647">;</span>&nbsp;<span class="ident" id="8314649">bs</span><span class="op" id="8314651">++</span>&nbsp;<span class="op" id="8314654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314658">decoder</span>&nbsp;<span class="op" id="8314666">:=</span>&nbsp;<span class="ident" id="8314669">NewDecoder</span><span class="op" id="8314679">(</span><span class="ident" id="8314680">StdEncoding</span><span class="op" id="8314691">,</span>&nbsp;<span class="ident" id="8314693">strings</span><span class="op" id="8314700">.</span><span class="ident" id="8314701">NewReader</span><span class="op" id="8314710">(</span><span class="ident" id="8314711">bigtest</span><span class="op" id="8314718">.</span><span class="ident" id="8314719">encoded</span><span class="op" id="8314726">)</span><span class="op" id="8314727">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314731">buf</span>&nbsp;<span class="op" id="8314735">:=</span>&nbsp;<span class="builtinfunc" id="8314738">make</span><span class="op" id="8314742">(</span><span class="op" id="8314743">[</span><span class="op" id="8314744">]</span><span class="builtintype" id="8314745">byte</span><span class="op" id="8314749">,</span>&nbsp;<span class="builtinfunc" id="8314751">len</span><span class="op" id="8314754">(</span><span class="ident" id="8314755">bigtest</span><span class="op" id="8314762">.</span><span class="ident" id="8314763">decoded</span><span class="op" id="8314770">)</span><span class="op" id="8314771">+</span><span class="num" id="8314772">12</span><span class="op" id="8314774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314778">var</span>&nbsp;<span class="ident" id="8314782">total</span>&nbsp;<span class="builtintype" id="8314788">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8314794">for</span>&nbsp;<span class="ident" id="8314798">total</span>&nbsp;<span class="op" id="8314804">=</span>&nbsp;<span class="num" id="8314806">0</span><span class="op" id="8314807">;</span>&nbsp;<span class="ident" id="8314809">total</span>&nbsp;<span class="op" id="8314815">&lt;</span>&nbsp;<span class="builtinfunc" id="8314817">len</span><span class="op" id="8314820">(</span><span class="ident" id="8314821">bigtest</span><span class="op" id="8314828">.</span><span class="ident" id="8314829">decoded</span><span class="op" id="8314836">)</span><span class="op" id="8314837">;</span>&nbsp;<span class="op" id="8314839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314844">n</span><span class="op" id="8314845">,</span>&nbsp;<span class="ident" id="8314847">err</span>&nbsp;<span class="op" id="8314851">:=</span>&nbsp;<span class="ident" id="8314854">decoder</span><span class="op" id="8314861">.</span><span class="ident" id="8314862">Read</span><span class="op" id="8314866">(</span><span class="ident" id="8314867">buf</span><span class="op" id="8314870">[</span><span class="ident" id="8314871">total</span>&nbsp;<span class="op" id="8314877">:</span>&nbsp;<span class="ident" id="8314879">total</span><span class="op" id="8314884">+</span><span class="ident" id="8314885">bs</span><span class="op" id="8314887">]</span><span class="op" id="8314888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8314893">testEqual</span><span class="op" id="8314902">(</span><span class="ident" id="8314903">t</span><span class="op" id="8314904">,</span>&nbsp;<span class="string" id="8314906">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="8314951">,</span>&nbsp;<span class="ident" id="8314953">bigtest</span><span class="op" id="8314960">.</span><span class="ident" id="8314961">encoded</span><span class="op" id="8314968">,</span>&nbsp;<span class="ident" id="8314970">total</span><span class="op" id="8314975">,</span>&nbsp;<span class="ident" id="8314977">n</span><span class="op" id="8314978">,</span>&nbsp;<span class="ident" id="8314980">err</span><span class="op" id="8314983">,</span>&nbsp;<span class="builtintype" id="8314985">error</span><span class="op" id="8314990">(</span><span class="builtintype" id="8314991">nil</span><span class="op" id="8314994">)</span><span class="op" id="8314995">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315000">total</span>&nbsp;<span class="op" id="8315006">+=</span>&nbsp;<span class="ident" id="8315009">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315017">testEqual</span><span class="op" id="8315026">(</span><span class="ident" id="8315027">t</span><span class="op" id="8315028">,</span>&nbsp;<span class="string" id="8315030">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8315063">,</span>&nbsp;<span class="ident" id="8315065">bs</span><span class="op" id="8315067">,</span>&nbsp;<span class="ident" id="8315069">bigtest</span><span class="op" id="8315076">.</span><span class="ident" id="8315077">encoded</span><span class="op" id="8315084">,</span>&nbsp;<span class="builtintype" id="8315086">string</span><span class="op" id="8315092">(</span><span class="ident" id="8315093">buf</span><span class="op" id="8315096">[</span><span class="num" id="8315097">0</span><span class="op" id="8315098">:</span><span class="ident" id="8315099">total</span><span class="op" id="8315104">]</span><span class="op" id="8315105">)</span><span class="op" id="8315106">,</span>&nbsp;<span class="ident" id="8315108">bigtest</span><span class="op" id="8315115">.</span><span class="ident" id="8315116">decoded</span><span class="op" id="8315123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315126">}</span><br>
<span class="lineno"></span><span class="op" id="8315128">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="8315131">func</span>&nbsp;<span class="ident" id="8315136">TestDecodeCorrupt</span><span class="op" id="8315153">(</span><span class="ident" id="8315154">t</span>&nbsp;<span class="op" id="8315156">*</span><span class="ident" id="8315157">testing</span><span class="op" id="8315164">.</span><span class="ident" id="8315165">T</span><span class="op" id="8315166">)</span>&nbsp;<span class="op" id="8315168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315171">testCases</span>&nbsp;<span class="op" id="8315181">:=</span>&nbsp;<span class="op" id="8315184">[</span><span class="op" id="8315185">]</span><span class="keyword" id="8315186">struct</span>&nbsp;<span class="op" id="8315193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315197">input</span>&nbsp;&nbsp;<span class="builtintype" id="8315204">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315213">offset</span>&nbsp;<span class="builtintype" id="8315220">int</span>&nbsp;<span class="comment" id="8315224">//&nbsp;-1&nbsp;means&nbsp;no&nbsp;corruption.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315252">}</span><span class="op" id="8315253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315257">{</span><span class="string" id="8315258">&#34;&#34;</span><span class="op" id="8315260">,</span>&nbsp;<span class="op" id="8315262">-</span><span class="num" id="8315263">1</span><span class="op" id="8315264">}</span><span class="op" id="8315265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315269">{</span><span class="string" id="8315270">&#34;!!!!&#34;</span><span class="op" id="8315276">,</span>&nbsp;<span class="num" id="8315278">0</span><span class="op" id="8315279">}</span><span class="op" id="8315280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315284">{</span><span class="string" id="8315285">&#34;====&#34;</span><span class="op" id="8315291">,</span>&nbsp;<span class="num" id="8315293">0</span><span class="op" id="8315294">}</span><span class="op" id="8315295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315299">{</span><span class="string" id="8315300">&#34;x===&#34;</span><span class="op" id="8315306">,</span>&nbsp;<span class="num" id="8315308">1</span><span class="op" id="8315309">}</span><span class="op" id="8315310">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315314">{</span><span class="string" id="8315315">&#34;=AAA&#34;</span><span class="op" id="8315321">,</span>&nbsp;<span class="num" id="8315323">0</span><span class="op" id="8315324">}</span><span class="op" id="8315325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315329">{</span><span class="string" id="8315330">&#34;A=AA&#34;</span><span class="op" id="8315336">,</span>&nbsp;<span class="num" id="8315338">1</span><span class="op" id="8315339">}</span><span class="op" id="8315340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315344">{</span><span class="string" id="8315345">&#34;AA=A&#34;</span><span class="op" id="8315351">,</span>&nbsp;<span class="num" id="8315353">2</span><span class="op" id="8315354">}</span><span class="op" id="8315355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315359">{</span><span class="string" id="8315360">&#34;AA==A&#34;</span><span class="op" id="8315367">,</span>&nbsp;<span class="num" id="8315369">4</span><span class="op" id="8315370">}</span><span class="op" id="8315371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315375">{</span><span class="string" id="8315376">&#34;AAA=AAAA&#34;</span><span class="op" id="8315386">,</span>&nbsp;<span class="num" id="8315388">4</span><span class="op" id="8315389">}</span><span class="op" id="8315390">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315394">{</span><span class="string" id="8315395">&#34;AAAAA&#34;</span><span class="op" id="8315402">,</span>&nbsp;<span class="num" id="8315404">4</span><span class="op" id="8315405">}</span><span class="op" id="8315406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315410">{</span><span class="string" id="8315411">&#34;AAAAAA&#34;</span><span class="op" id="8315419">,</span>&nbsp;<span class="num" id="8315421">4</span><span class="op" id="8315422">}</span><span class="op" id="8315423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315427">{</span><span class="string" id="8315428">&#34;A=&#34;</span><span class="op" id="8315432">,</span>&nbsp;<span class="num" id="8315434">1</span><span class="op" id="8315435">}</span><span class="op" id="8315436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315440">{</span><span class="string" id="8315441">&#34;A==&#34;</span><span class="op" id="8315446">,</span>&nbsp;<span class="num" id="8315448">1</span><span class="op" id="8315449">}</span><span class="op" id="8315450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315454">{</span><span class="string" id="8315455">&#34;AA=&#34;</span><span class="op" id="8315460">,</span>&nbsp;<span class="num" id="8315462">3</span><span class="op" id="8315463">}</span><span class="op" id="8315464">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315468">{</span><span class="string" id="8315469">&#34;AA==&#34;</span><span class="op" id="8315475">,</span>&nbsp;<span class="op" id="8315477">-</span><span class="num" id="8315478">1</span><span class="op" id="8315479">}</span><span class="op" id="8315480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315484">{</span><span class="string" id="8315485">&#34;AAA=&#34;</span><span class="op" id="8315491">,</span>&nbsp;<span class="op" id="8315493">-</span><span class="num" id="8315494">1</span><span class="op" id="8315495">}</span><span class="op" id="8315496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315500">{</span><span class="string" id="8315501">&#34;AAAA&#34;</span><span class="op" id="8315507">,</span>&nbsp;<span class="op" id="8315509">-</span><span class="num" id="8315510">1</span><span class="op" id="8315511">}</span><span class="op" id="8315512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315516">{</span><span class="string" id="8315517">&#34;AAAAAA=&#34;</span><span class="op" id="8315526">,</span>&nbsp;<span class="num" id="8315528">7</span><span class="op" id="8315529">}</span><span class="op" id="8315530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315534">{</span><span class="string" id="8315535">&#34;YWJjZA=====&#34;</span><span class="op" id="8315548">,</span>&nbsp;<span class="num" id="8315550">8</span><span class="op" id="8315551">}</span><span class="op" id="8315552">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315558">for</span>&nbsp;<span class="ident" id="8315562">_</span><span class="op" id="8315563">,</span>&nbsp;<span class="ident" id="8315565">tc</span>&nbsp;<span class="op" id="8315568">:=</span>&nbsp;<span class="keyword" id="8315571">range</span>&nbsp;<span class="ident" id="8315577">testCases</span>&nbsp;<span class="op" id="8315587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315591">dbuf</span>&nbsp;<span class="op" id="8315596">:=</span>&nbsp;<span class="builtinfunc" id="8315599">make</span><span class="op" id="8315603">(</span><span class="op" id="8315604">[</span><span class="op" id="8315605">]</span><span class="builtintype" id="8315606">byte</span><span class="op" id="8315610">,</span>&nbsp;<span class="ident" id="8315612">StdEncoding</span><span class="op" id="8315623">.</span><span class="ident" id="8315624">DecodedLen</span><span class="op" id="8315634">(</span><span class="builtinfunc" id="8315635">len</span><span class="op" id="8315638">(</span><span class="ident" id="8315639">tc</span><span class="op" id="8315641">.</span><span class="ident" id="8315642">input</span><span class="op" id="8315647">)</span><span class="op" id="8315648">)</span><span class="op" id="8315649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315653">_</span><span class="op" id="8315654">,</span>&nbsp;<span class="ident" id="8315656">err</span>&nbsp;<span class="op" id="8315660">:=</span>&nbsp;<span class="ident" id="8315663">StdEncoding</span><span class="op" id="8315674">.</span><span class="ident" id="8315675">Decode</span><span class="op" id="8315681">(</span><span class="ident" id="8315682">dbuf</span><span class="op" id="8315686">,</span>&nbsp;<span class="op" id="8315688">[</span><span class="op" id="8315689">]</span><span class="builtintype" id="8315690">byte</span><span class="op" id="8315694">(</span><span class="ident" id="8315695">tc</span><span class="op" id="8315697">.</span><span class="ident" id="8315698">input</span><span class="op" id="8315703">)</span><span class="op" id="8315704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315708">if</span>&nbsp;<span class="ident" id="8315711">tc</span><span class="op" id="8315713">.</span><span class="ident" id="8315714">offset</span>&nbsp;<span class="op" id="8315721">==</span>&nbsp;<span class="op" id="8315724">-</span><span class="num" id="8315725">1</span>&nbsp;<span class="op" id="8315727">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315732">if</span>&nbsp;<span class="ident" id="8315735">err</span>&nbsp;<span class="op" id="8315739">!=</span>&nbsp;<span class="builtintype" id="8315742">nil</span>&nbsp;<span class="op" id="8315746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315752">t</span><span class="op" id="8315753">.</span><span class="ident" id="8315754">Error</span><span class="op" id="8315759">(</span><span class="string" id="8315760">&#34;Decoder&nbsp;wrongly&nbsp;detected&nbsp;coruption&nbsp;in&#34;</span><span class="op" id="8315799">,</span>&nbsp;<span class="ident" id="8315801">tc</span><span class="op" id="8315803">.</span><span class="ident" id="8315804">input</span><span class="op" id="8315809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315819">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8315830">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315834">switch</span>&nbsp;<span class="ident" id="8315841">err</span>&nbsp;<span class="op" id="8315845">:=</span>&nbsp;<span class="ident" id="8315848">err</span><span class="op" id="8315851">.</span><span class="op" id="8315852">(</span><span class="keyword" id="8315853">type</span><span class="op" id="8315857">)</span>&nbsp;<span class="op" id="8315859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315863">case</span>&nbsp;<span class="ident" id="8315868">CorruptInputError</span><span class="op" id="8315885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315890">testEqual</span><span class="op" id="8315899">(</span><span class="ident" id="8315900">t</span><span class="op" id="8315901">,</span>&nbsp;<span class="string" id="8315903">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8315943">,</span>&nbsp;<span class="ident" id="8315945">tc</span><span class="op" id="8315947">.</span><span class="ident" id="8315948">input</span><span class="op" id="8315953">,</span>&nbsp;<span class="builtintype" id="8315955">int</span><span class="op" id="8315958">(</span><span class="ident" id="8315959">err</span><span class="op" id="8315962">)</span><span class="op" id="8315963">,</span>&nbsp;<span class="ident" id="8315965">tc</span><span class="op" id="8315967">.</span><span class="ident" id="8315968">offset</span><span class="op" id="8315974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8315978">default</span><span class="op" id="8315985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8315990">t</span><span class="op" id="8315991">.</span><span class="ident" id="8315992">Error</span><span class="op" id="8315997">(</span><span class="string" id="8315998">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="8316038">,</span>&nbsp;<span class="ident" id="8316040">tc</span><span class="op" id="8316042">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316049">}</span><br>
<span class="lineno"></span><span class="op" id="8316051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8316054">func</span>&nbsp;<span class="ident" id="8316059">TestBig</span><span class="op" id="8316066">(</span><span class="ident" id="8316067">t</span>&nbsp;<span class="op" id="8316069">*</span><span class="ident" id="8316070">testing</span><span class="op" id="8316077">.</span><span class="ident" id="8316078">T</span><span class="op" id="8316079">)</span>&nbsp;<span class="op" id="8316081">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316084">n</span>&nbsp;<span class="op" id="8316086">:=</span>&nbsp;<span class="num" id="8316089">3</span><span class="op" id="8316090">*</span><span class="num" id="8316091">1000</span>&nbsp;<span class="op" id="8316096">+</span>&nbsp;<span class="num" id="8316098">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316101">raw</span>&nbsp;<span class="op" id="8316105">:=</span>&nbsp;<span class="builtinfunc" id="8316108">make</span><span class="op" id="8316112">(</span><span class="op" id="8316113">[</span><span class="op" id="8316114">]</span><span class="builtintype" id="8316115">byte</span><span class="op" id="8316119">,</span>&nbsp;<span class="ident" id="8316121">n</span><span class="op" id="8316122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316125">const</span>&nbsp;<span class="ident" id="8316131">alpha</span>&nbsp;<span class="op" id="8316137">=</span>&nbsp;<span class="string" id="8316139">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316205">for</span>&nbsp;<span class="ident" id="8316209">i</span>&nbsp;<span class="op" id="8316211">:=</span>&nbsp;<span class="num" id="8316214">0</span><span class="op" id="8316215">;</span>&nbsp;<span class="ident" id="8316217">i</span>&nbsp;<span class="op" id="8316219">&lt;</span>&nbsp;<span class="ident" id="8316221">n</span><span class="op" id="8316222">;</span>&nbsp;<span class="ident" id="8316224">i</span><span class="op" id="8316225">++</span>&nbsp;<span class="op" id="8316228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316232">raw</span><span class="op" id="8316235">[</span><span class="ident" id="8316236">i</span><span class="op" id="8316237">]</span>&nbsp;<span class="op" id="8316239">=</span>&nbsp;<span class="ident" id="8316241">alpha</span><span class="op" id="8316246">[</span><span class="ident" id="8316247">i</span><span class="op" id="8316248">%</span><span class="builtinfunc" id="8316249">len</span><span class="op" id="8316252">(</span><span class="ident" id="8316253">alpha</span><span class="op" id="8316258">)</span><span class="op" id="8316259">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316265">encoded</span>&nbsp;<span class="op" id="8316273">:=</span>&nbsp;<span class="builtinfunc" id="8316276">new</span><span class="op" id="8316279">(</span><span class="ident" id="8316280">bytes</span><span class="op" id="8316285">.</span><span class="ident" id="8316286">Buffer</span><span class="op" id="8316292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316295">w</span>&nbsp;<span class="op" id="8316297">:=</span>&nbsp;<span class="ident" id="8316300">NewEncoder</span><span class="op" id="8316310">(</span><span class="ident" id="8316311">StdEncoding</span><span class="op" id="8316322">,</span>&nbsp;<span class="ident" id="8316324">encoded</span><span class="op" id="8316331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316334">nn</span><span class="op" id="8316336">,</span>&nbsp;<span class="ident" id="8316338">err</span>&nbsp;<span class="op" id="8316342">:=</span>&nbsp;<span class="ident" id="8316345">w</span><span class="op" id="8316346">.</span><span class="ident" id="8316347">Write</span><span class="op" id="8316352">(</span><span class="ident" id="8316353">raw</span><span class="op" id="8316356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316359">if</span>&nbsp;<span class="ident" id="8316362">nn</span>&nbsp;<span class="op" id="8316365">!=</span>&nbsp;<span class="ident" id="8316368">n</span>&nbsp;<span class="op" id="8316370">||</span>&nbsp;<span class="ident" id="8316373">err</span>&nbsp;<span class="op" id="8316377">!=</span>&nbsp;<span class="builtintype" id="8316380">nil</span>&nbsp;<span class="op" id="8316384">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316388">t</span><span class="op" id="8316389">.</span><span class="ident" id="8316390">Fatalf</span><span class="op" id="8316396">(</span><span class="string" id="8316397">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="8316439">,</span>&nbsp;<span class="ident" id="8316441">nn</span><span class="op" id="8316443">,</span>&nbsp;<span class="ident" id="8316445">err</span><span class="op" id="8316448">,</span>&nbsp;<span class="ident" id="8316450">n</span><span class="op" id="8316451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316457">err</span>&nbsp;<span class="op" id="8316461">=</span>&nbsp;<span class="ident" id="8316463">w</span><span class="op" id="8316464">.</span><span class="ident" id="8316465">Close</span><span class="op" id="8316470">(</span><span class="op" id="8316471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316474">if</span>&nbsp;<span class="ident" id="8316477">err</span>&nbsp;<span class="op" id="8316481">!=</span>&nbsp;<span class="builtintype" id="8316484">nil</span>&nbsp;<span class="op" id="8316488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316492">t</span><span class="op" id="8316493">.</span><span class="ident" id="8316494">Fatalf</span><span class="op" id="8316500">(</span><span class="string" id="8316501">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8316532">,</span>&nbsp;<span class="ident" id="8316534">err</span><span class="op" id="8316537">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316543">decoded</span><span class="op" id="8316550">,</span>&nbsp;<span class="ident" id="8316552">err</span>&nbsp;<span class="op" id="8316556">:=</span>&nbsp;<span class="ident" id="8316559">ioutil</span><span class="op" id="8316565">.</span><span class="ident" id="8316566">ReadAll</span><span class="op" id="8316573">(</span><span class="ident" id="8316574">NewDecoder</span><span class="op" id="8316584">(</span><span class="ident" id="8316585">StdEncoding</span><span class="op" id="8316596">,</span>&nbsp;<span class="ident" id="8316598">encoded</span><span class="op" id="8316605">)</span><span class="op" id="8316606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316609">if</span>&nbsp;<span class="ident" id="8316612">err</span>&nbsp;<span class="op" id="8316616">!=</span>&nbsp;<span class="builtintype" id="8316619">nil</span>&nbsp;<span class="op" id="8316623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316627">t</span><span class="op" id="8316628">.</span><span class="ident" id="8316629">Fatalf</span><span class="op" id="8316635">(</span><span class="string" id="8316636">&#34;ioutil.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="8316673">,</span>&nbsp;<span class="ident" id="8316675">err</span><span class="op" id="8316678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316681">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316685">if</span>&nbsp;<span class="op" id="8316688">!</span><span class="ident" id="8316689">bytes</span><span class="op" id="8316694">.</span><span class="ident" id="8316695">Equal</span><span class="op" id="8316700">(</span><span class="ident" id="8316701">raw</span><span class="op" id="8316704">,</span>&nbsp;<span class="ident" id="8316706">decoded</span><span class="op" id="8316713">)</span>&nbsp;<span class="op" id="8316715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316719">var</span>&nbsp;<span class="ident" id="8316723">i</span>&nbsp;<span class="builtintype" id="8316725">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316731">for</span>&nbsp;<span class="ident" id="8316735">i</span>&nbsp;<span class="op" id="8316737">=</span>&nbsp;<span class="num" id="8316739">0</span><span class="op" id="8316740">;</span>&nbsp;<span class="ident" id="8316742">i</span>&nbsp;<span class="op" id="8316744">&lt;</span>&nbsp;<span class="builtinfunc" id="8316746">len</span><span class="op" id="8316749">(</span><span class="ident" id="8316750">decoded</span><span class="op" id="8316757">)</span>&nbsp;<span class="op" id="8316759">&amp;&amp;</span>&nbsp;<span class="ident" id="8316762">i</span>&nbsp;<span class="op" id="8316764">&lt;</span>&nbsp;<span class="builtinfunc" id="8316766">len</span><span class="op" id="8316769">(</span><span class="ident" id="8316770">raw</span><span class="op" id="8316773">)</span><span class="op" id="8316774">;</span>&nbsp;<span class="ident" id="8316776">i</span><span class="op" id="8316777">++</span>&nbsp;<span class="op" id="8316780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316785">if</span>&nbsp;<span class="ident" id="8316788">decoded</span><span class="op" id="8316795">[</span><span class="ident" id="8316796">i</span><span class="op" id="8316797">]</span>&nbsp;<span class="op" id="8316799">!=</span>&nbsp;<span class="ident" id="8316802">raw</span><span class="op" id="8316805">[</span><span class="ident" id="8316806">i</span><span class="op" id="8316807">]</span>&nbsp;<span class="op" id="8316809">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8316815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8316832">t</span><span class="op" id="8316833">.</span><span class="ident" id="8316834">Errorf</span><span class="op" id="8316840">(</span><span class="string" id="8316841">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="8316893">,</span>&nbsp;<span class="ident" id="8316895">n</span><span class="op" id="8316896">,</span>&nbsp;<span class="ident" id="8316898">i</span><span class="op" id="8316899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8316902">}</span><br>
<span class="lineno">220</span><span class="op" id="8316904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8316907">func</span>&nbsp;<span class="ident" id="8316912">TestNewLineCharacters</span><span class="op" id="8316933">(</span><span class="ident" id="8316934">t</span>&nbsp;<span class="op" id="8316936">*</span><span class="ident" id="8316937">testing</span><span class="op" id="8316944">.</span><span class="ident" id="8316945">T</span><span class="op" id="8316946">)</span>&nbsp;<span class="op" id="8316948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8316951">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;should&nbsp;decode&nbsp;to&nbsp;the&nbsp;string&nbsp;&#34;sure&#34;,&nbsp;without&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317021">const</span>&nbsp;<span class="ident" id="8317027">expected</span>&nbsp;<span class="op" id="8317036">=</span>&nbsp;<span class="string" id="8317038">&#34;sure&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317046">examples</span>&nbsp;<span class="op" id="8317055">:=</span>&nbsp;<span class="op" id="8317058">[</span><span class="op" id="8317059">]</span><span class="builtintype" id="8317060">string</span><span class="op" id="8317066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317070">&#34;c3VyZQ==&#34;</span><span class="op" id="8317080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317084">&#34;c3VyZQ==\r&#34;</span><span class="op" id="8317096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317100">&#34;c3VyZQ==\n&#34;</span><span class="op" id="8317112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317116">&#34;c3VyZQ==\r\n&#34;</span><span class="op" id="8317130">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317134">&#34;c3VyZ\r\nQ==&#34;</span><span class="op" id="8317148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317152">&#34;c3V\ryZ\nQ==&#34;</span><span class="op" id="8317166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317170">&#34;c3V\nyZ\rQ==&#34;</span><span class="op" id="8317184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317188">&#34;c3VyZ\nQ==&#34;</span><span class="op" id="8317200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317204">&#34;c3VyZQ\n==&#34;</span><span class="op" id="8317216">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317220">&#34;c3VyZQ=\n=&#34;</span><span class="op" id="8317232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8317236">&#34;c3VyZQ=\r\n\r\n=&#34;</span><span class="op" id="8317254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8317257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317260">for</span>&nbsp;<span class="ident" id="8317264">_</span><span class="op" id="8317265">,</span>&nbsp;<span class="ident" id="8317267">e</span>&nbsp;<span class="op" id="8317269">:=</span>&nbsp;<span class="keyword" id="8317272">range</span>&nbsp;<span class="ident" id="8317278">examples</span>&nbsp;<span class="op" id="8317287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317291">buf</span><span class="op" id="8317294">,</span>&nbsp;<span class="ident" id="8317296">err</span>&nbsp;<span class="op" id="8317300">:=</span>&nbsp;<span class="ident" id="8317303">StdEncoding</span><span class="op" id="8317314">.</span><span class="ident" id="8317315">DecodeString</span><span class="op" id="8317327">(</span><span class="ident" id="8317328">e</span><span class="op" id="8317329">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317333">if</span>&nbsp;<span class="ident" id="8317336">err</span>&nbsp;<span class="op" id="8317340">!=</span>&nbsp;<span class="builtintype" id="8317343">nil</span>&nbsp;<span class="op" id="8317347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317352">t</span><span class="op" id="8317353">.</span><span class="ident" id="8317354">Errorf</span><span class="op" id="8317360">(</span><span class="string" id="8317361">&#34;Decode(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8317384">,</span>&nbsp;<span class="ident" id="8317386">e</span><span class="op" id="8317387">,</span>&nbsp;<span class="ident" id="8317389">err</span><span class="op" id="8317392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317397">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8317408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317412">if</span>&nbsp;<span class="ident" id="8317415">s</span>&nbsp;<span class="op" id="8317417">:=</span>&nbsp;<span class="builtintype" id="8317420">string</span><span class="op" id="8317426">(</span><span class="ident" id="8317427">buf</span><span class="op" id="8317430">)</span><span class="op" id="8317431">;</span>&nbsp;<span class="ident" id="8317433">s</span>&nbsp;<span class="op" id="8317435">!=</span>&nbsp;<span class="ident" id="8317438">expected</span>&nbsp;<span class="op" id="8317447">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317452">t</span><span class="op" id="8317453">.</span><span class="ident" id="8317454">Errorf</span><span class="op" id="8317460">(</span><span class="string" id="8317461">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8317487">,</span>&nbsp;<span class="ident" id="8317489">e</span><span class="op" id="8317490">,</span>&nbsp;<span class="ident" id="8317492">s</span><span class="op" id="8317493">,</span>&nbsp;<span class="ident" id="8317495">expected</span><span class="op" id="8317503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8317507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8317510">}</span><br>
<span class="lineno"></span><span class="op" id="8317512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="8317515">type</span>&nbsp;<span class="ident" id="8317520">nextRead</span>&nbsp;<span class="keyword" id="8317529">struct</span>&nbsp;<span class="op" id="8317536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317539">n</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8317543">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8317549">//&nbsp;bytes&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317569">err</span>&nbsp;<span class="builtintype" id="8317573">error</span>&nbsp;<span class="comment" id="8317579">//&nbsp;error&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="op" id="8317598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="8317601">//&nbsp;faultInjectReader&nbsp;returns&nbsp;data&nbsp;from&nbsp;source,&nbsp;rate-limited</span><br>
<span class="lineno"></span><span class="comment" id="8317661">//&nbsp;and&nbsp;with&nbsp;the&nbsp;errors&nbsp;as&nbsp;written&nbsp;to&nbsp;nextc.</span><br>
<span class="lineno"></span><span class="keyword" id="8317705">type</span>&nbsp;<span class="ident" id="8317710">faultInjectReader</span>&nbsp;<span class="keyword" id="8317728">struct</span>&nbsp;<span class="op" id="8317735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317738">source</span>&nbsp;<span class="builtintype" id="8317745">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317753">nextc</span>&nbsp;&nbsp;<span class="op" id="8317760">&lt;-</span><span class="keyword" id="8317762">chan</span>&nbsp;<span class="ident" id="8317767">nextRead</span><br>
<span class="lineno">260</span><span class="op" id="8317776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8317779">func</span>&nbsp;<span class="op" id="8317784">(</span><span class="ident" id="8317785">r</span>&nbsp;<span class="op" id="8317787">*</span><span class="ident" id="8317788">faultInjectReader</span><span class="op" id="8317805">)</span>&nbsp;<span class="ident" id="8317807">Read</span><span class="op" id="8317811">(</span><span class="ident" id="8317812">p</span>&nbsp;<span class="op" id="8317814">[</span><span class="op" id="8317815">]</span><span class="builtintype" id="8317816">byte</span><span class="op" id="8317820">)</span>&nbsp;<span class="op" id="8317822">(</span><span class="builtintype" id="8317823">int</span><span class="op" id="8317826">,</span>&nbsp;<span class="builtintype" id="8317828">error</span><span class="op" id="8317833">)</span>&nbsp;<span class="op" id="8317835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317838">nr</span>&nbsp;<span class="op" id="8317841">:=</span>&nbsp;<span class="op" id="8317844">&lt;-</span><span class="ident" id="8317846">r</span><span class="op" id="8317847">.</span><span class="ident" id="8317848">nextc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317855">if</span>&nbsp;<span class="builtinfunc" id="8317858">len</span><span class="op" id="8317861">(</span><span class="ident" id="8317862">p</span><span class="op" id="8317863">)</span>&nbsp;<span class="op" id="8317865">&gt;</span>&nbsp;<span class="ident" id="8317867">nr</span><span class="op" id="8317869">.</span><span class="ident" id="8317870">n</span>&nbsp;<span class="op" id="8317872">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317876">p</span>&nbsp;<span class="op" id="8317878">=</span>&nbsp;<span class="ident" id="8317880">p</span><span class="op" id="8317881">[</span><span class="op" id="8317882">:</span><span class="ident" id="8317883">nr</span><span class="op" id="8317885">.</span><span class="ident" id="8317886">n</span><span class="op" id="8317887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8317890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317893">n</span>&nbsp;<span class="op" id="8317895">:=</span>&nbsp;<span class="builtinfunc" id="8317898">copy</span><span class="op" id="8317902">(</span><span class="ident" id="8317903">p</span><span class="op" id="8317904">,</span>&nbsp;<span class="ident" id="8317906">r</span><span class="op" id="8317907">.</span><span class="ident" id="8317908">source</span><span class="op" id="8317914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8317917">r</span><span class="op" id="8317918">.</span><span class="ident" id="8317919">source</span>&nbsp;<span class="op" id="8317926">=</span>&nbsp;<span class="ident" id="8317928">r</span><span class="op" id="8317929">.</span><span class="ident" id="8317930">source</span><span class="op" id="8317936">[</span><span class="ident" id="8317937">n</span><span class="op" id="8317938">:</span><span class="op" id="8317939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8317942">return</span>&nbsp;<span class="ident" id="8317949">n</span><span class="op" id="8317950">,</span>&nbsp;<span class="ident" id="8317952">nr</span><span class="op" id="8317954">.</span><span class="ident" id="8317955">err</span><br>
<span class="lineno">270</span><span class="op" id="8317959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8317962">//&nbsp;tests&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;ignore&nbsp;errors&nbsp;from&nbsp;our&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span><span class="keyword" id="8318026">func</span>&nbsp;<span class="ident" id="8318031">TestDecoderIssue3577</span><span class="op" id="8318051">(</span><span class="ident" id="8318052">t</span>&nbsp;<span class="op" id="8318054">*</span><span class="ident" id="8318055">testing</span><span class="op" id="8318062">.</span><span class="ident" id="8318063">T</span><span class="op" id="8318064">)</span>&nbsp;<span class="op" id="8318066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318069">next</span>&nbsp;<span class="op" id="8318074">:=</span>&nbsp;<span class="builtinfunc" id="8318077">make</span><span class="op" id="8318081">(</span><span class="keyword" id="8318082">chan</span>&nbsp;<span class="ident" id="8318087">nextRead</span><span class="op" id="8318095">,</span>&nbsp;<span class="num" id="8318097">10</span><span class="op" id="8318099">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318102">wantErr</span>&nbsp;<span class="op" id="8318110">:=</span>&nbsp;<span class="ident" id="8318113">errors</span><span class="op" id="8318119">.</span><span class="ident" id="8318120">New</span><span class="op" id="8318123">(</span><span class="string" id="8318124">&#34;my&nbsp;error&#34;</span><span class="op" id="8318134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318137">next</span>&nbsp;<span class="op" id="8318142">&lt;-</span>&nbsp;<span class="ident" id="8318145">nextRead</span><span class="op" id="8318153">{</span><span class="num" id="8318154">5</span><span class="op" id="8318155">,</span>&nbsp;<span class="builtintype" id="8318157">nil</span><span class="op" id="8318160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318163">next</span>&nbsp;<span class="op" id="8318168">&lt;-</span>&nbsp;<span class="ident" id="8318171">nextRead</span><span class="op" id="8318179">{</span><span class="num" id="8318180">10</span><span class="op" id="8318182">,</span>&nbsp;<span class="ident" id="8318184">wantErr</span><span class="op" id="8318191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318194">next</span>&nbsp;<span class="op" id="8318199">&lt;-</span>&nbsp;<span class="ident" id="8318202">nextRead</span><span class="op" id="8318210">{</span><span class="num" id="8318211">0</span><span class="op" id="8318212">,</span>&nbsp;<span class="ident" id="8318214">wantErr</span><span class="op" id="8318221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318224">d</span>&nbsp;<span class="op" id="8318226">:=</span>&nbsp;<span class="ident" id="8318229">NewDecoder</span><span class="op" id="8318239">(</span><span class="ident" id="8318240">StdEncoding</span><span class="op" id="8318251">,</span>&nbsp;<span class="op" id="8318253">&amp;</span><span class="ident" id="8318254">faultInjectReader</span><span class="op" id="8318271">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318275">source</span><span class="op" id="8318281">:</span>&nbsp;<span class="string" id="8318283">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="8318333">,</span>&nbsp;<span class="comment" id="8318335">//&nbsp;twas&nbsp;brillig...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318356">nextc</span><span class="op" id="8318361">:</span>&nbsp;&nbsp;<span class="ident" id="8318364">next</span><span class="op" id="8318368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8318371">}</span><span class="op" id="8318372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318375">errc</span>&nbsp;<span class="op" id="8318380">:=</span>&nbsp;<span class="builtinfunc" id="8318383">make</span><span class="op" id="8318387">(</span><span class="keyword" id="8318388">chan</span>&nbsp;<span class="builtintype" id="8318393">error</span><span class="op" id="8318398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8318401">go</span>&nbsp;<span class="keyword" id="8318404">func</span><span class="op" id="8318408">(</span><span class="op" id="8318409">)</span>&nbsp;<span class="op" id="8318411">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318415">_</span><span class="op" id="8318416">,</span>&nbsp;<span class="ident" id="8318418">err</span>&nbsp;<span class="op" id="8318422">:=</span>&nbsp;<span class="ident" id="8318425">ioutil</span><span class="op" id="8318431">.</span><span class="ident" id="8318432">ReadAll</span><span class="op" id="8318439">(</span><span class="ident" id="8318440">d</span><span class="op" id="8318441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318445">errc</span>&nbsp;<span class="op" id="8318450">&lt;-</span>&nbsp;<span class="ident" id="8318453">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8318458">}</span><span class="op" id="8318459">(</span><span class="op" id="8318460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8318463">select</span>&nbsp;<span class="op" id="8318470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8318473">case</span>&nbsp;<span class="ident" id="8318478">err</span>&nbsp;<span class="op" id="8318482">:=</span>&nbsp;<span class="op" id="8318485">&lt;-</span><span class="ident" id="8318487">errc</span><span class="op" id="8318491">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8318495">if</span>&nbsp;<span class="ident" id="8318498">err</span>&nbsp;<span class="op" id="8318502">!=</span>&nbsp;<span class="ident" id="8318505">wantErr</span>&nbsp;<span class="op" id="8318513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318518">t</span><span class="op" id="8318519">.</span><span class="ident" id="8318520">Errorf</span><span class="op" id="8318526">(</span><span class="string" id="8318527">&#34;got&nbsp;error&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8318550">,</span>&nbsp;<span class="ident" id="8318552">err</span><span class="op" id="8318555">,</span>&nbsp;<span class="ident" id="8318557">wantErr</span><span class="op" id="8318564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8318568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8318571">case</span>&nbsp;<span class="op" id="8318576">&lt;-</span><span class="ident" id="8318578">time</span><span class="op" id="8318582">.</span><span class="ident" id="8318583">After</span><span class="op" id="8318588">(</span><span class="num" id="8318589">5</span>&nbsp;<span class="op" id="8318591">*</span>&nbsp;<span class="ident" id="8318593">time</span><span class="op" id="8318597">.</span><span class="ident" id="8318598">Second</span><span class="op" id="8318604">)</span><span class="op" id="8318605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318609">t</span><span class="op" id="8318610">.</span><span class="ident" id="8318611">Errorf</span><span class="op" id="8318617">(</span><span class="string" id="8318618">&#34;timeout;&nbsp;Decoder&nbsp;blocked&nbsp;without&nbsp;returning&nbsp;an&nbsp;error&#34;</span><span class="op" id="8318671">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8318674">}</span><br>
<span class="lineno"></span><span class="op" id="8318676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8318679">func</span>&nbsp;<span class="ident" id="8318684">TestDecoderIssue4779</span><span class="op" id="8318704">(</span><span class="ident" id="8318705">t</span>&nbsp;<span class="op" id="8318707">*</span><span class="ident" id="8318708">testing</span><span class="op" id="8318715">.</span><span class="ident" id="8318716">T</span><span class="op" id="8318717">)</span>&nbsp;<span class="op" id="8318719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8318722">encoded</span>&nbsp;<span class="op" id="8318730">:=</span>&nbsp;<span class="string" id="8318733">`CP/EAT8AAAEF<br>
<span class="lineno">300</span>AQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAAB<br>
<span class="lineno"></span>BAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHx<br>
<span class="lineno"></span>Y3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm<br>
<span class="lineno"></span>9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS<br>
<span class="lineno"></span>0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0<br>
<span class="lineno">305</span>pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A9VSSSSUpJJJJSkkkJ+Tj<br>
<span class="lineno"></span>1kiy1jCJJDnAcCTykpKkuQ6p/jN6FgmxlNduXawwAzaGH+V6jn/R/wCt71zdn+N/qL3kVYFNYB4N<br>
<span class="lineno"></span>ji6PDVjWpKp9TSXnvTf8bFNjg3qOEa2n6VlLpj/rT/pf567DpX1i6L1hs9Py67X8mqdtg/rUWbbf<br>
<span class="lineno"></span>+gkp0kkkklKSSSSUpJJJJT//0PVUkkklKVLq3WMDpGI7KzrNjADtYNXvI/Mqr/Pd/q9W3vaxjnvM<br>
<span class="lineno"></span>NaCXE9gNSvGPrf8AWS3qmba5jjsJhoB0DAf0NDf6sevf+/lf8Hj0JJATfWT6/dV6oXU1uOLQeKKn<br>
<span class="lineno">310</span>EQP+Hubtfe/+R7Mf/g7f5xcocp++Z11JMCJPgFBxOg7/AOuqDx8I/ikpkXkmSdU8mJIJA/O8EMAy<br>
<span class="lineno"></span>j+mSARB/17pKVXYWHXjsj7yIex0PadzXMO1zT5KHoNA3HT8ietoGhgjsfA+CSnvvqh/jJtqsrwOv<br>
<span class="lineno"></span>2b6NGNzXfTYexzJ+nU7/ALkf4P8Awv6P9KvTQQ4AgyDqCF85Pho3CTB7eHwXoH+LT65uZbX9X+o2<br>
<span class="lineno"></span>bqbPb06551Y4<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8319764">encodedShort</span>&nbsp;<span class="op" id="8319777">:=</span>&nbsp;<span class="ident" id="8319780">strings</span><span class="op" id="8319787">.</span><span class="ident" id="8319788">Replace</span><span class="op" id="8319795">(</span><span class="ident" id="8319796">encoded</span><span class="op" id="8319803">,</span>&nbsp;<span class="string" id="8319805">&#34;\n&#34;</span><span class="op" id="8319809">,</span>&nbsp;<span class="string" id="8319811">&#34;&#34;</span><span class="op" id="8319813">,</span>&nbsp;<span class="op" id="8319815">-</span><span class="num" id="8319816">1</span><span class="op" id="8319817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8319821">dec</span>&nbsp;<span class="op" id="8319825">:=</span>&nbsp;<span class="ident" id="8319828">NewDecoder</span><span class="op" id="8319838">(</span><span class="ident" id="8319839">StdEncoding</span><span class="op" id="8319850">,</span>&nbsp;<span class="ident" id="8319852">strings</span><span class="op" id="8319859">.</span><span class="ident" id="8319860">NewReader</span><span class="op" id="8319869">(</span><span class="ident" id="8319870">encoded</span><span class="op" id="8319877">)</span><span class="op" id="8319878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8319881">res1</span><span class="op" id="8319885">,</span>&nbsp;<span class="ident" id="8319887">err</span>&nbsp;<span class="op" id="8319891">:=</span>&nbsp;<span class="ident" id="8319894">ioutil</span><span class="op" id="8319900">.</span><span class="ident" id="8319901">ReadAll</span><span class="op" id="8319908">(</span><span class="ident" id="8319909">dec</span><span class="op" id="8319912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8319915">if</span>&nbsp;<span class="ident" id="8319918">err</span>&nbsp;<span class="op" id="8319922">!=</span>&nbsp;<span class="builtintype" id="8319925">nil</span>&nbsp;<span class="op" id="8319929">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8319933">t</span><span class="op" id="8319934">.</span><span class="ident" id="8319935">Errorf</span><span class="op" id="8319941">(</span><span class="string" id="8319942">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8319962">,</span>&nbsp;<span class="ident" id="8319964">err</span><span class="op" id="8319967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8319970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8319974">dec</span>&nbsp;<span class="op" id="8319978">=</span>&nbsp;<span class="ident" id="8319980">NewDecoder</span><span class="op" id="8319990">(</span><span class="ident" id="8319991">StdEncoding</span><span class="op" id="8320002">,</span>&nbsp;<span class="ident" id="8320004">strings</span><span class="op" id="8320011">.</span><span class="ident" id="8320012">NewReader</span><span class="op" id="8320021">(</span><span class="ident" id="8320022">encodedShort</span><span class="op" id="8320034">)</span><span class="op" id="8320035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320038">var</span>&nbsp;<span class="ident" id="8320042">res2</span>&nbsp;<span class="op" id="8320047">[</span><span class="op" id="8320048">]</span><span class="builtintype" id="8320049">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320055">res2</span><span class="op" id="8320059">,</span>&nbsp;<span class="ident" id="8320061">err</span>&nbsp;<span class="op" id="8320065">=</span>&nbsp;<span class="ident" id="8320067">ioutil</span><span class="op" id="8320073">.</span><span class="ident" id="8320074">ReadAll</span><span class="op" id="8320081">(</span><span class="ident" id="8320082">dec</span><span class="op" id="8320085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320088">if</span>&nbsp;<span class="ident" id="8320091">err</span>&nbsp;<span class="op" id="8320095">!=</span>&nbsp;<span class="builtintype" id="8320098">nil</span>&nbsp;<span class="op" id="8320102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320106">t</span><span class="op" id="8320107">.</span><span class="ident" id="8320108">Errorf</span><span class="op" id="8320114">(</span><span class="string" id="8320115">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8320135">,</span>&nbsp;<span class="ident" id="8320137">err</span><span class="op" id="8320140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320147">if</span>&nbsp;<span class="op" id="8320150">!</span><span class="ident" id="8320151">bytes</span><span class="op" id="8320156">.</span><span class="ident" id="8320157">Equal</span><span class="op" id="8320162">(</span><span class="ident" id="8320163">res1</span><span class="op" id="8320167">,</span>&nbsp;<span class="ident" id="8320169">res2</span><span class="op" id="8320173">)</span>&nbsp;<span class="op" id="8320175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320179">t</span><span class="op" id="8320180">.</span><span class="ident" id="8320181">Error</span><span class="op" id="8320186">(</span><span class="string" id="8320187">&#34;Decoded&nbsp;results&nbsp;not&nbsp;equal&#34;</span><span class="op" id="8320214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320217">}</span><br>
<span class="lineno"></span><span class="op" id="8320219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="8320222">func</span>&nbsp;<span class="ident" id="8320227">TestDecoderIssue7733</span><span class="op" id="8320247">(</span><span class="ident" id="8320248">t</span>&nbsp;<span class="op" id="8320250">*</span><span class="ident" id="8320251">testing</span><span class="op" id="8320258">.</span><span class="ident" id="8320259">T</span><span class="op" id="8320260">)</span>&nbsp;<span class="op" id="8320262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320265">s</span><span class="op" id="8320266">,</span>&nbsp;<span class="ident" id="8320268">err</span>&nbsp;<span class="op" id="8320272">:=</span>&nbsp;<span class="ident" id="8320275">StdEncoding</span><span class="op" id="8320286">.</span><span class="ident" id="8320287">DecodeString</span><span class="op" id="8320299">(</span><span class="string" id="8320300">&#34;YWJjZA=====&#34;</span><span class="op" id="8320313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320316">want</span>&nbsp;<span class="op" id="8320321">:=</span>&nbsp;<span class="ident" id="8320324">CorruptInputError</span><span class="op" id="8320341">(</span><span class="num" id="8320342">8</span><span class="op" id="8320343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320346">if</span>&nbsp;<span class="op" id="8320349">!</span><span class="ident" id="8320350">reflect</span><span class="op" id="8320357">.</span><span class="ident" id="8320358">DeepEqual</span><span class="op" id="8320367">(</span><span class="ident" id="8320368">want</span><span class="op" id="8320372">,</span>&nbsp;<span class="ident" id="8320374">err</span><span class="op" id="8320377">)</span>&nbsp;<span class="op" id="8320379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320383">t</span><span class="op" id="8320384">.</span><span class="ident" id="8320385">Errorf</span><span class="op" id="8320391">(</span><span class="string" id="8320392">&#34;Error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;CorruptInputError(8)&#34;</span><span class="op" id="8320431">,</span>&nbsp;<span class="ident" id="8320433">err</span><span class="op" id="8320436">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320442">if</span>&nbsp;<span class="builtintype" id="8320445">string</span><span class="op" id="8320451">(</span><span class="ident" id="8320452">s</span><span class="op" id="8320453">)</span>&nbsp;<span class="op" id="8320455">!=</span>&nbsp;<span class="string" id="8320458">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8320465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320469">t</span><span class="op" id="8320470">.</span><span class="ident" id="8320471">Errorf</span><span class="op" id="8320477">(</span><span class="string" id="8320478">&#34;DecodeString&nbsp;=&nbsp;%q;&nbsp;want&nbsp;abcd&#34;</span><span class="op" id="8320508">,</span>&nbsp;<span class="ident" id="8320510">s</span><span class="op" id="8320511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320514">}</span><br>
<span class="lineno"></span><span class="op" id="8320516">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="8320519">func</span>&nbsp;<span class="ident" id="8320524">BenchmarkEncodeToString</span><span class="op" id="8320547">(</span><span class="ident" id="8320548">b</span>&nbsp;<span class="op" id="8320550">*</span><span class="ident" id="8320551">testing</span><span class="op" id="8320558">.</span><span class="ident" id="8320559">B</span><span class="op" id="8320560">)</span>&nbsp;<span class="op" id="8320562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320565">data</span>&nbsp;<span class="op" id="8320570">:=</span>&nbsp;<span class="builtinfunc" id="8320573">make</span><span class="op" id="8320577">(</span><span class="op" id="8320578">[</span><span class="op" id="8320579">]</span><span class="builtintype" id="8320580">byte</span><span class="op" id="8320584">,</span>&nbsp;<span class="num" id="8320586">8192</span><span class="op" id="8320590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320593">b</span><span class="op" id="8320594">.</span><span class="ident" id="8320595">SetBytes</span><span class="op" id="8320603">(</span><span class="ident" id="8320604">int64</span><span class="op" id="8320609">(</span><span class="builtinfunc" id="8320610">len</span><span class="op" id="8320613">(</span><span class="ident" id="8320614">data</span><span class="op" id="8320618">)</span><span class="op" id="8320619">)</span><span class="op" id="8320620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320623">for</span>&nbsp;<span class="ident" id="8320627">i</span>&nbsp;<span class="op" id="8320629">:=</span>&nbsp;<span class="num" id="8320632">0</span><span class="op" id="8320633">;</span>&nbsp;<span class="ident" id="8320635">i</span>&nbsp;<span class="op" id="8320637">&lt;</span>&nbsp;<span class="ident" id="8320639">b</span><span class="op" id="8320640">.</span><span class="ident" id="8320641">N</span><span class="op" id="8320642">;</span>&nbsp;<span class="ident" id="8320644">i</span><span class="op" id="8320645">++</span>&nbsp;<span class="op" id="8320648">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320652">StdEncoding</span><span class="op" id="8320663">.</span><span class="ident" id="8320664">EncodeToString</span><span class="op" id="8320678">(</span><span class="ident" id="8320679">data</span><span class="op" id="8320683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320686">}</span><br>
<span class="lineno"></span><span class="op" id="8320688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8320691">func</span>&nbsp;<span class="ident" id="8320696">BenchmarkDecodeString</span><span class="op" id="8320717">(</span><span class="ident" id="8320718">b</span>&nbsp;<span class="op" id="8320720">*</span><span class="ident" id="8320721">testing</span><span class="op" id="8320728">.</span><span class="ident" id="8320729">B</span><span class="op" id="8320730">)</span>&nbsp;<span class="op" id="8320732">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320735">data</span>&nbsp;<span class="op" id="8320740">:=</span>&nbsp;<span class="ident" id="8320743">StdEncoding</span><span class="op" id="8320754">.</span><span class="ident" id="8320755">EncodeToString</span><span class="op" id="8320769">(</span><span class="builtinfunc" id="8320770">make</span><span class="op" id="8320774">(</span><span class="op" id="8320775">[</span><span class="op" id="8320776">]</span><span class="builtintype" id="8320777">byte</span><span class="op" id="8320781">,</span>&nbsp;<span class="num" id="8320783">8192</span><span class="op" id="8320787">)</span><span class="op" id="8320788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320791">b</span><span class="op" id="8320792">.</span><span class="ident" id="8320793">SetBytes</span><span class="op" id="8320801">(</span><span class="ident" id="8320802">int64</span><span class="op" id="8320807">(</span><span class="builtinfunc" id="8320808">len</span><span class="op" id="8320811">(</span><span class="ident" id="8320812">data</span><span class="op" id="8320816">)</span><span class="op" id="8320817">)</span><span class="op" id="8320818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8320821">for</span>&nbsp;<span class="ident" id="8320825">i</span>&nbsp;<span class="op" id="8320827">:=</span>&nbsp;<span class="num" id="8320830">0</span><span class="op" id="8320831">;</span>&nbsp;<span class="ident" id="8320833">i</span>&nbsp;<span class="op" id="8320835">&lt;</span>&nbsp;<span class="ident" id="8320837">b</span><span class="op" id="8320838">.</span><span class="ident" id="8320839">N</span><span class="op" id="8320840">;</span>&nbsp;<span class="ident" id="8320842">i</span><span class="op" id="8320843">++</span>&nbsp;<span class="op" id="8320846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8320850">StdEncoding</span><span class="op" id="8320861">.</span><span class="ident" id="8320862">DecodeString</span><span class="op" id="8320874">(</span><span class="ident" id="8320875">data</span><span class="op" id="8320879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8320882">}</span><br>
<span class="lineno">360</span><span class="op" id="8320884">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
