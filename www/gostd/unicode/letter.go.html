<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2683036">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2683091">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2683145">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2683196">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2683270">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="2683294">package</span>&nbsp;<span class="ident" id="2683302">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2683311">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="2683378">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683444">const</span>&nbsp;<span class="op" id="2683450">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683453">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683469">=</span>&nbsp;<span class="string" id="2683471">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="2683484">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683522">ReplacementChar</span>&nbsp;<span class="op" id="2683538">=</span>&nbsp;<span class="string" id="2683540">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683553">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683589">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683605">=</span>&nbsp;<span class="string" id="2683607">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683620">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683645">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683661">=</span>&nbsp;<span class="string" id="2683663">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683676">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="2683702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2683705">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="2683781">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="2683848">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="2683921">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="2683984">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="2684044">type</span>&nbsp;<span class="ident" id="2684049">RangeTable</span>&nbsp;<span class="keyword" id="2684060">struct</span>&nbsp;<span class="op" id="2684067">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684070">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684082">[</span><span class="op" id="2684083">]</span><span class="ident" id="2684084">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684093">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684105">[</span><span class="op" id="2684106">]</span><span class="ident" id="2684107">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684116">LatinOffset</span>&nbsp;<span class="builtintype" id="2684128">int</span>&nbsp;<span class="comment" id="2684132">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="2684181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2684184">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="2684278">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="2684321">type</span>&nbsp;<span class="ident" id="2684326">Range16</span>&nbsp;<span class="keyword" id="2684334">struct</span>&nbsp;<span class="op" id="2684341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684344">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684351">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684359">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684366">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684374">Stride</span>&nbsp;<span class="builtintype" id="2684381">uint16</span><br>
<span class="lineno"></span><span class="op" id="2684388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684391">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2684471">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="2684548">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="2684626">type</span>&nbsp;<span class="ident" id="2684631">Range32</span>&nbsp;<span class="keyword" id="2684639">struct</span>&nbsp;<span class="op" id="2684646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684649">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684656">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684664">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684671">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684679">Stride</span>&nbsp;<span class="builtintype" id="2684686">uint32</span><br>
<span class="lineno">45</span><span class="op" id="2684693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684696">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="2684767">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2684817">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="2684894">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2684967">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2685041">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2685113">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="2685189">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="2685233">//&nbsp;&nbsp;&nbsp;&nbsp{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="2685273">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2685341">type</span>&nbsp;<span class="ident" id="2685346">CaseRange</span>&nbsp;<span class="keyword" id="2685356">struct</span>&nbsp;<span class="op" id="2685363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685366">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685372">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685380">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685386">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685394">Delta</span>&nbsp;<span class="ident" id="2685400">d</span><br>
<span class="lineno"></span><span class="op" id="2685402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685405">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="2685480">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="2685555">type</span>&nbsp;<span class="ident" id="2685560">SpecialCase</span>&nbsp;<span class="op" id="2685572">[</span><span class="op" id="2685573">]</span><span class="ident" id="2685574">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685585">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2685654">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="2685721">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2685790">const</span>&nbsp;<span class="op" id="2685796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685799">UpperCase</span>&nbsp;<span class="op" id="2685809">=</span>&nbsp;<span class="ident" id="2685811">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685817">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685828">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685839">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="2685847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2685850">type</span>&nbsp;<span class="ident" id="2685855">d</span>&nbsp;<span class="op" id="2685857">[</span><span class="ident" id="2685858">MaxCase</span><span class="op" id="2685865">]</span><span class="builtintype" id="2685866">rune</span>&nbsp;<span class="comment" id="2685871">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2685911">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="2685972">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="2686030">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="2686058">const</span>&nbsp;<span class="op" id="2686064">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686067">UpperLower</span>&nbsp;<span class="op" id="2686078">=</span>&nbsp;<span class="ident" id="2686080">MaxRune</span>&nbsp;<span class="op" id="2686088">+</span>&nbsp;<span class="num" id="2686090">1</span>&nbsp;<span class="comment" id="2686092">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="2686122">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686125">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="2686203">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="2686247">const</span>&nbsp;<span class="ident" id="2686253">linearMax</span>&nbsp;<span class="op" id="2686263">=</span>&nbsp;<span class="num" id="2686265">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="2686269">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="2686336">func</span>&nbsp;<span class="ident" id="2686341">is16</span><span class="op" id="2686345">(</span><span class="ident" id="2686346">ranges</span>&nbsp;<span class="op" id="2686353">[</span><span class="op" id="2686354">]</span><span class="ident" id="2686355">Range16</span><span class="op" id="2686362">,</span>&nbsp;<span class="ident" id="2686364">r</span>&nbsp;<span class="builtintype" id="2686366">uint16</span><span class="op" id="2686372">)</span>&nbsp;<span class="builtintype" id="2686374">bool</span>&nbsp;<span class="op" id="2686379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686382">if</span>&nbsp;<span class="builtinfunc" id="2686385">len</span><span class="op" id="2686388">(</span><span class="ident" id="2686389">ranges</span><span class="op" id="2686395">)</span>&nbsp;<span class="op" id="2686397">&lt;=</span>&nbsp;<span class="ident" id="2686400">linearMax</span>&nbsp;<span class="op" id="2686410">||</span>&nbsp;<span class="ident" id="2686413">r</span>&nbsp;<span class="op" id="2686415">&lt;=</span>&nbsp;<span class="ident" id="2686418">MaxLatin1</span>&nbsp;<span class="op" id="2686428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686432">for</span>&nbsp;<span class="ident" id="2686436">i</span>&nbsp;<span class="op" id="2686438">:=</span>&nbsp;<span class="keyword" id="2686441">range</span>&nbsp;<span class="ident" id="2686447">ranges</span>&nbsp;<span class="op" id="2686454">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686459">range_</span>&nbsp;<span class="op" id="2686466">:=</span>&nbsp;<span class="op" id="2686469">&amp;</span><span class="ident" id="2686470">ranges</span><span class="op" id="2686476">[</span><span class="ident" id="2686477">i</span><span class="op" id="2686478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686483">if</span>&nbsp;<span class="ident" id="2686486">r</span>&nbsp;<span class="op" id="2686488">&lt;</span>&nbsp;<span class="ident" id="2686490">range_</span><span class="op" id="2686496">.</span><span class="ident" id="2686497">Lo</span>&nbsp;<span class="op" id="2686500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686506">return</span>&nbsp;<span class="builtintype" id="2686513">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686527">if</span>&nbsp;<span class="ident" id="2686530">r</span>&nbsp;<span class="op" id="2686532">&lt;=</span>&nbsp;<span class="ident" id="2686535">range_</span><span class="op" id="2686541">.</span><span class="ident" id="2686542">Hi</span>&nbsp;<span class="op" id="2686545">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686551">return</span>&nbsp;<span class="op" id="2686558">(</span><span class="ident" id="2686559">r</span><span class="op" id="2686560">-</span><span class="ident" id="2686561">range_</span><span class="op" id="2686567">.</span><span class="ident" id="2686568">Lo</span><span class="op" id="2686570">)</span><span class="op" id="2686571">%</span><span class="ident" id="2686572">range_</span><span class="op" id="2686578">.</span><span class="ident" id="2686579">Stride</span>&nbsp;<span class="op" id="2686586">==</span>&nbsp;<span class="num" id="2686589">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686602">return</span>&nbsp;<span class="builtintype" id="2686609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686616">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686620">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686650">lo</span>&nbsp;<span class="op" id="2686653">:=</span>&nbsp;<span class="num" id="2686656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686659">hi</span>&nbsp;<span class="op" id="2686662">:=</span>&nbsp;<span class="builtinfunc" id="2686665">len</span><span class="op" id="2686668">(</span><span class="ident" id="2686669">ranges</span><span class="op" id="2686675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686678">for</span>&nbsp;<span class="ident" id="2686682">lo</span>&nbsp;<span class="op" id="2686685">&lt;</span>&nbsp;<span class="ident" id="2686687">hi</span>&nbsp;<span class="op" id="2686690">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686694">m</span>&nbsp;<span class="op" id="2686696">:=</span>&nbsp;<span class="ident" id="2686699">lo</span>&nbsp;<span class="op" id="2686702">+</span>&nbsp;<span class="op" id="2686704">(</span><span class="ident" id="2686705">hi</span><span class="op" id="2686707">-</span><span class="ident" id="2686708">lo</span><span class="op" id="2686710">)</span><span class="op" id="2686711">/</span><span class="num" id="2686712">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686716">range_</span>&nbsp;<span class="op" id="2686723">:=</span>&nbsp;<span class="op" id="2686726">&amp;</span><span class="ident" id="2686727">ranges</span><span class="op" id="2686733">[</span><span class="ident" id="2686734">m</span><span class="op" id="2686735">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686739">if</span>&nbsp;<span class="ident" id="2686742">range_</span><span class="op" id="2686748">.</span><span class="ident" id="2686749">Lo</span>&nbsp;<span class="op" id="2686752">&lt;=</span>&nbsp;<span class="ident" id="2686755">r</span>&nbsp;<span class="op" id="2686757">&amp;&amp;</span>&nbsp;<span class="ident" id="2686760">r</span>&nbsp;<span class="op" id="2686762">&lt;=</span>&nbsp;<span class="ident" id="2686765">range_</span><span class="op" id="2686771">.</span><span class="ident" id="2686772">Hi</span>&nbsp;<span class="op" id="2686775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686780">return</span>&nbsp;<span class="op" id="2686787">(</span><span class="ident" id="2686788">r</span><span class="op" id="2686789">-</span><span class="ident" id="2686790">range_</span><span class="op" id="2686796">.</span><span class="ident" id="2686797">Lo</span><span class="op" id="2686799">)</span><span class="op" id="2686800">%</span><span class="ident" id="2686801">range_</span><span class="op" id="2686807">.</span><span class="ident" id="2686808">Stride</span>&nbsp;<span class="op" id="2686815">==</span>&nbsp;<span class="num" id="2686818">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686822">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686826">if</span>&nbsp;<span class="ident" id="2686829">r</span>&nbsp;<span class="op" id="2686831">&lt;</span>&nbsp;<span class="ident" id="2686833">range_</span><span class="op" id="2686839">.</span><span class="ident" id="2686840">Lo</span>&nbsp;<span class="op" id="2686843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686848">hi</span>&nbsp;<span class="op" id="2686851">=</span>&nbsp;<span class="ident" id="2686853">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686857">}</span>&nbsp;<span class="keyword" id="2686859">else</span>&nbsp;<span class="op" id="2686864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686869">lo</span>&nbsp;<span class="op" id="2686872">=</span>&nbsp;<span class="ident" id="2686874">m</span>&nbsp;<span class="op" id="2686876">+</span>&nbsp;<span class="num" id="2686878">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686882">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686888">return</span>&nbsp;<span class="builtintype" id="2686895">false</span><br>
<span class="lineno"></span><span class="op" id="2686901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686904">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="2686971">func</span>&nbsp;<span class="ident" id="2686976">is32</span><span class="op" id="2686980">(</span><span class="ident" id="2686981">ranges</span>&nbsp;<span class="op" id="2686988">[</span><span class="op" id="2686989">]</span><span class="ident" id="2686990">Range32</span><span class="op" id="2686997">,</span>&nbsp;<span class="ident" id="2686999">r</span>&nbsp;<span class="builtintype" id="2687001">uint32</span><span class="op" id="2687007">)</span>&nbsp;<span class="builtintype" id="2687009">bool</span>&nbsp;<span class="op" id="2687014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687017">if</span>&nbsp;<span class="builtinfunc" id="2687020">len</span><span class="op" id="2687023">(</span><span class="ident" id="2687024">ranges</span><span class="op" id="2687030">)</span>&nbsp;<span class="op" id="2687032">&lt;=</span>&nbsp;<span class="ident" id="2687035">linearMax</span>&nbsp;<span class="op" id="2687045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687049">for</span>&nbsp;<span class="ident" id="2687053">i</span>&nbsp;<span class="op" id="2687055">:=</span>&nbsp;<span class="keyword" id="2687058">range</span>&nbsp;<span class="ident" id="2687064">ranges</span>&nbsp;<span class="op" id="2687071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687076">range_</span>&nbsp;<span class="op" id="2687083">:=</span>&nbsp;<span class="op" id="2687086">&amp;</span><span class="ident" id="2687087">ranges</span><span class="op" id="2687093">[</span><span class="ident" id="2687094">i</span><span class="op" id="2687095">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687100">if</span>&nbsp;<span class="ident" id="2687103">r</span>&nbsp;<span class="op" id="2687105">&lt;</span>&nbsp;<span class="ident" id="2687107">range_</span><span class="op" id="2687113">.</span><span class="ident" id="2687114">Lo</span>&nbsp;<span class="op" id="2687117">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687123">return</span>&nbsp;<span class="builtintype" id="2687130">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687144">if</span>&nbsp;<span class="ident" id="2687147">r</span>&nbsp;<span class="op" id="2687149">&lt;=</span>&nbsp;<span class="ident" id="2687152">range_</span><span class="op" id="2687158">.</span><span class="ident" id="2687159">Hi</span>&nbsp;<span class="op" id="2687162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687168">return</span>&nbsp;<span class="op" id="2687175">(</span><span class="ident" id="2687176">r</span><span class="op" id="2687177">-</span><span class="ident" id="2687178">range_</span><span class="op" id="2687184">.</span><span class="ident" id="2687185">Lo</span><span class="op" id="2687187">)</span><span class="op" id="2687188">%</span><span class="ident" id="2687189">range_</span><span class="op" id="2687195">.</span><span class="ident" id="2687196">Stride</span>&nbsp;<span class="op" id="2687203">==</span>&nbsp;<span class="num" id="2687206">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687211">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687219">return</span>&nbsp;<span class="builtintype" id="2687226">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687237">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687267">lo</span>&nbsp;<span class="op" id="2687270">:=</span>&nbsp;<span class="num" id="2687273">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687276">hi</span>&nbsp;<span class="op" id="2687279">:=</span>&nbsp;<span class="builtinfunc" id="2687282">len</span><span class="op" id="2687285">(</span><span class="ident" id="2687286">ranges</span><span class="op" id="2687292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687295">for</span>&nbsp;<span class="ident" id="2687299">lo</span>&nbsp;<span class="op" id="2687302">&lt;</span>&nbsp;<span class="ident" id="2687304">hi</span>&nbsp;<span class="op" id="2687307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687311">m</span>&nbsp;<span class="op" id="2687313">:=</span>&nbsp;<span class="ident" id="2687316">lo</span>&nbsp;<span class="op" id="2687319">+</span>&nbsp;<span class="op" id="2687321">(</span><span class="ident" id="2687322">hi</span><span class="op" id="2687324">-</span><span class="ident" id="2687325">lo</span><span class="op" id="2687327">)</span><span class="op" id="2687328">/</span><span class="num" id="2687329">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687333">range_</span>&nbsp;<span class="op" id="2687340">:=</span>&nbsp;<span class="ident" id="2687343">ranges</span><span class="op" id="2687349">[</span><span class="ident" id="2687350">m</span><span class="op" id="2687351">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687355">if</span>&nbsp;<span class="ident" id="2687358">range_</span><span class="op" id="2687364">.</span><span class="ident" id="2687365">Lo</span>&nbsp;<span class="op" id="2687368">&lt;=</span>&nbsp;<span class="ident" id="2687371">r</span>&nbsp;<span class="op" id="2687373">&amp;&amp;</span>&nbsp;<span class="ident" id="2687376">r</span>&nbsp;<span class="op" id="2687378">&lt;=</span>&nbsp;<span class="ident" id="2687381">range_</span><span class="op" id="2687387">.</span><span class="ident" id="2687388">Hi</span>&nbsp;<span class="op" id="2687391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687396">return</span>&nbsp;<span class="op" id="2687403">(</span><span class="ident" id="2687404">r</span><span class="op" id="2687405">-</span><span class="ident" id="2687406">range_</span><span class="op" id="2687412">.</span><span class="ident" id="2687413">Lo</span><span class="op" id="2687415">)</span><span class="op" id="2687416">%</span><span class="ident" id="2687417">range_</span><span class="op" id="2687423">.</span><span class="ident" id="2687424">Stride</span>&nbsp;<span class="op" id="2687431">==</span>&nbsp;<span class="num" id="2687434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687442">if</span>&nbsp;<span class="ident" id="2687445">r</span>&nbsp;<span class="op" id="2687447">&lt;</span>&nbsp;<span class="ident" id="2687449">range_</span><span class="op" id="2687455">.</span><span class="ident" id="2687456">Lo</span>&nbsp;<span class="op" id="2687459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687464">hi</span>&nbsp;<span class="op" id="2687467">=</span>&nbsp;<span class="ident" id="2687469">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687473">}</span>&nbsp;<span class="keyword" id="2687475">else</span>&nbsp;<span class="op" id="2687480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687485">lo</span>&nbsp;<span class="op" id="2687488">=</span>&nbsp;<span class="ident" id="2687490">m</span>&nbsp;<span class="op" id="2687492">+</span>&nbsp;<span class="num" id="2687494">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687504">return</span>&nbsp;<span class="builtintype" id="2687511">false</span><br>
<span class="lineno">155</span><span class="op" id="2687517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2687520">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="2687588">func</span>&nbsp;<span class="ident" id="2687593">Is</span><span class="op" id="2687595">(</span><span class="ident" id="2687596">rangeTab</span>&nbsp;<span class="op" id="2687605">*</span><span class="ident" id="2687606">RangeTable</span><span class="op" id="2687616">,</span>&nbsp;<span class="ident" id="2687618">r</span>&nbsp;<span class="builtintype" id="2687620">rune</span><span class="op" id="2687624">)</span>&nbsp;<span class="builtintype" id="2687626">bool</span>&nbsp;<span class="op" id="2687631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687634">r16</span>&nbsp;<span class="op" id="2687638">:=</span>&nbsp;<span class="ident" id="2687641">rangeTab</span><span class="op" id="2687649">.</span><span class="ident" id="2687650">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687655">if</span>&nbsp;<span class="builtinfunc" id="2687658">len</span><span class="op" id="2687661">(</span><span class="ident" id="2687662">r16</span><span class="op" id="2687665">)</span>&nbsp;<span class="op" id="2687667">&gt;</span>&nbsp;<span class="num" id="2687669">0</span>&nbsp;<span class="op" id="2687671">&amp;&amp;</span>&nbsp;<span class="ident" id="2687674">r</span>&nbsp;<span class="op" id="2687676">&lt;=</span>&nbsp;<span class="builtintype" id="2687679">rune</span><span class="op" id="2687683">(</span><span class="ident" id="2687684">r16</span><span class="op" id="2687687">[</span><span class="builtinfunc" id="2687688">len</span><span class="op" id="2687691">(</span><span class="ident" id="2687692">r16</span><span class="op" id="2687695">)</span><span class="op" id="2687696">-</span><span class="num" id="2687697">1</span><span class="op" id="2687698">]</span><span class="op" id="2687699">.</span><span class="ident" id="2687700">Hi</span><span class="op" id="2687702">)</span>&nbsp;<span class="op" id="2687704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687708">return</span>&nbsp;<span class="ident" id="2687715">is16</span><span class="op" id="2687719">(</span><span class="ident" id="2687720">r16</span><span class="op" id="2687723">,</span>&nbsp;<span class="builtintype" id="2687725">uint16</span><span class="op" id="2687731">(</span><span class="ident" id="2687732">r</span><span class="op" id="2687733">)</span><span class="op" id="2687734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687740">r32</span>&nbsp;<span class="op" id="2687744">:=</span>&nbsp;<span class="ident" id="2687747">rangeTab</span><span class="op" id="2687755">.</span><span class="ident" id="2687756">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687761">if</span>&nbsp;<span class="builtinfunc" id="2687764">len</span><span class="op" id="2687767">(</span><span class="ident" id="2687768">r32</span><span class="op" id="2687771">)</span>&nbsp;<span class="op" id="2687773">&gt;</span>&nbsp;<span class="num" id="2687775">0</span>&nbsp;<span class="op" id="2687777">&amp;&amp;</span>&nbsp;<span class="ident" id="2687780">r</span>&nbsp;<span class="op" id="2687782">&gt;=</span>&nbsp;<span class="builtintype" id="2687785">rune</span><span class="op" id="2687789">(</span><span class="ident" id="2687790">r32</span><span class="op" id="2687793">[</span><span class="num" id="2687794">0</span><span class="op" id="2687795">]</span><span class="op" id="2687796">.</span><span class="ident" id="2687797">Lo</span><span class="op" id="2687799">)</span>&nbsp;<span class="op" id="2687801">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687805">return</span>&nbsp;<span class="ident" id="2687812">is32</span><span class="op" id="2687816">(</span><span class="ident" id="2687817">r32</span><span class="op" id="2687820">,</span>&nbsp;<span class="builtintype" id="2687822">uint32</span><span class="op" id="2687828">(</span><span class="ident" id="2687829">r</span><span class="op" id="2687830">)</span><span class="op" id="2687831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687837">return</span>&nbsp;<span class="builtintype" id="2687844">false</span><br>
<span class="lineno"></span><span class="op" id="2687850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="2687853">func</span>&nbsp;<span class="ident" id="2687858">isExcludingLatin</span><span class="op" id="2687874">(</span><span class="ident" id="2687875">rangeTab</span>&nbsp;<span class="op" id="2687884">*</span><span class="ident" id="2687885">RangeTable</span><span class="op" id="2687895">,</span>&nbsp;<span class="ident" id="2687897">r</span>&nbsp;<span class="builtintype" id="2687899">rune</span><span class="op" id="2687903">)</span>&nbsp;<span class="builtintype" id="2687905">bool</span>&nbsp;<span class="op" id="2687910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687913">r16</span>&nbsp;<span class="op" id="2687917">:=</span>&nbsp;<span class="ident" id="2687920">rangeTab</span><span class="op" id="2687928">.</span><span class="ident" id="2687929">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687934">if</span>&nbsp;<span class="ident" id="2687937">off</span>&nbsp;<span class="op" id="2687941">:=</span>&nbsp;<span class="ident" id="2687944">rangeTab</span><span class="op" id="2687952">.</span><span class="ident" id="2687953">LatinOffset</span><span class="op" id="2687964">;</span>&nbsp;<span class="builtinfunc" id="2687966">len</span><span class="op" id="2687969">(</span><span class="ident" id="2687970">r16</span><span class="op" id="2687973">)</span>&nbsp;<span class="op" id="2687975">&gt;</span>&nbsp;<span class="ident" id="2687977">off</span>&nbsp;<span class="op" id="2687981">&amp;&amp;</span>&nbsp;<span class="ident" id="2687984">r</span>&nbsp;<span class="op" id="2687986">&lt;=</span>&nbsp;<span class="builtintype" id="2687989">rune</span><span class="op" id="2687993">(</span><span class="ident" id="2687994">r16</span><span class="op" id="2687997">[</span><span class="builtinfunc" id="2687998">len</span><span class="op" id="2688001">(</span><span class="ident" id="2688002">r16</span><span class="op" id="2688005">)</span><span class="op" id="2688006">-</span><span class="num" id="2688007">1</span><span class="op" id="2688008">]</span><span class="op" id="2688009">.</span><span class="ident" id="2688010">Hi</span><span class="op" id="2688012">)</span>&nbsp;<span class="op" id="2688014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688018">return</span>&nbsp;<span class="ident" id="2688025">is16</span><span class="op" id="2688029">(</span><span class="ident" id="2688030">r16</span><span class="op" id="2688033">[</span><span class="ident" id="2688034">off</span><span class="op" id="2688037">:</span><span class="op" id="2688038">]</span><span class="op" id="2688039">,</span>&nbsp;<span class="builtintype" id="2688041">uint16</span><span class="op" id="2688047">(</span><span class="ident" id="2688048">r</span><span class="op" id="2688049">)</span><span class="op" id="2688050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688053">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688056">r32</span>&nbsp;<span class="op" id="2688060">:=</span>&nbsp;<span class="ident" id="2688063">rangeTab</span><span class="op" id="2688071">.</span><span class="ident" id="2688072">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688077">if</span>&nbsp;<span class="builtinfunc" id="2688080">len</span><span class="op" id="2688083">(</span><span class="ident" id="2688084">r32</span><span class="op" id="2688087">)</span>&nbsp;<span class="op" id="2688089">&gt;</span>&nbsp;<span class="num" id="2688091">0</span>&nbsp;<span class="op" id="2688093">&amp;&amp;</span>&nbsp;<span class="ident" id="2688096">r</span>&nbsp;<span class="op" id="2688098">&gt;=</span>&nbsp;<span class="builtintype" id="2688101">rune</span><span class="op" id="2688105">(</span><span class="ident" id="2688106">r32</span><span class="op" id="2688109">[</span><span class="num" id="2688110">0</span><span class="op" id="2688111">]</span><span class="op" id="2688112">.</span><span class="ident" id="2688113">Lo</span><span class="op" id="2688115">)</span>&nbsp;<span class="op" id="2688117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688121">return</span>&nbsp;<span class="ident" id="2688128">is32</span><span class="op" id="2688132">(</span><span class="ident" id="2688133">r32</span><span class="op" id="2688136">,</span>&nbsp;<span class="builtintype" id="2688138">uint32</span><span class="op" id="2688144">(</span><span class="ident" id="2688145">r</span><span class="op" id="2688146">)</span><span class="op" id="2688147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688153">return</span>&nbsp;<span class="builtintype" id="2688160">false</span><br>
<span class="lineno">180</span><span class="op" id="2688166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688169">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2688230">func</span>&nbsp;<span class="ident" id="2688235">IsUpper</span><span class="op" id="2688242">(</span><span class="ident" id="2688243">r</span>&nbsp;<span class="builtintype" id="2688245">rune</span><span class="op" id="2688249">)</span>&nbsp;<span class="builtintype" id="2688251">bool</span>&nbsp;<span class="op" id="2688256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688259">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688289">if</span>&nbsp;<span class="builtintype" id="2688292">uint32</span><span class="op" id="2688298">(</span><span class="ident" id="2688299">r</span><span class="op" id="2688300">)</span>&nbsp;<span class="op" id="2688302">&lt;=</span>&nbsp;<span class="ident" id="2688305">MaxLatin1</span>&nbsp;<span class="op" id="2688315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688319">return</span>&nbsp;<span class="ident" id="2688326">properties</span><span class="op" id="2688336">[</span><span class="builtintype" id="2688337">uint8</span><span class="op" id="2688342">(</span><span class="ident" id="2688343">r</span><span class="op" id="2688344">)</span><span class="op" id="2688345">]</span><span class="op" id="2688346">&amp;</span><span class="ident" id="2688347">pLmask</span>&nbsp;<span class="op" id="2688354">==</span>&nbsp;<span class="ident" id="2688357">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688365">return</span>&nbsp;<span class="ident" id="2688372">isExcludingLatin</span><span class="op" id="2688388">(</span><span class="ident" id="2688389">Upper</span><span class="op" id="2688394">,</span>&nbsp;<span class="ident" id="2688396">r</span><span class="op" id="2688397">)</span><br>
<span class="lineno"></span><span class="op" id="2688399">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="2688402">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2688462">func</span>&nbsp;<span class="ident" id="2688467">IsLower</span><span class="op" id="2688474">(</span><span class="ident" id="2688475">r</span>&nbsp;<span class="builtintype" id="2688477">rune</span><span class="op" id="2688481">)</span>&nbsp;<span class="builtintype" id="2688483">bool</span>&nbsp;<span class="op" id="2688488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688491">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688521">if</span>&nbsp;<span class="builtintype" id="2688524">uint32</span><span class="op" id="2688530">(</span><span class="ident" id="2688531">r</span><span class="op" id="2688532">)</span>&nbsp;<span class="op" id="2688534">&lt;=</span>&nbsp;<span class="ident" id="2688537">MaxLatin1</span>&nbsp;<span class="op" id="2688547">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688551">return</span>&nbsp;<span class="ident" id="2688558">properties</span><span class="op" id="2688568">[</span><span class="builtintype" id="2688569">uint8</span><span class="op" id="2688574">(</span><span class="ident" id="2688575">r</span><span class="op" id="2688576">)</span><span class="op" id="2688577">]</span><span class="op" id="2688578">&amp;</span><span class="ident" id="2688579">pLmask</span>&nbsp;<span class="op" id="2688586">==</span>&nbsp;<span class="ident" id="2688589">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688597">return</span>&nbsp;<span class="ident" id="2688604">isExcludingLatin</span><span class="op" id="2688620">(</span><span class="ident" id="2688621">Lower</span><span class="op" id="2688626">,</span>&nbsp;<span class="ident" id="2688628">r</span><span class="op" id="2688629">)</span><br>
<span class="lineno"></span><span class="op" id="2688631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="2688634">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="2688694">func</span>&nbsp;<span class="ident" id="2688699">IsTitle</span><span class="op" id="2688706">(</span><span class="ident" id="2688707">r</span>&nbsp;<span class="builtintype" id="2688709">rune</span><span class="op" id="2688713">)</span>&nbsp;<span class="builtintype" id="2688715">bool</span>&nbsp;<span class="op" id="2688720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688723">if</span>&nbsp;<span class="ident" id="2688726">r</span>&nbsp;<span class="op" id="2688728">&lt;=</span>&nbsp;<span class="ident" id="2688731">MaxLatin1</span>&nbsp;<span class="op" id="2688741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688745">return</span>&nbsp;<span class="builtintype" id="2688752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688759">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688762">return</span>&nbsp;<span class="ident" id="2688769">isExcludingLatin</span><span class="op" id="2688785">(</span><span class="ident" id="2688786">Title</span><span class="op" id="2688791">,</span>&nbsp;<span class="ident" id="2688793">r</span><span class="op" id="2688794">)</span><br>
<span class="lineno"></span><span class="op" id="2688796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688799">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2688853">func</span>&nbsp;<span class="ident" id="2688858">to</span><span class="op" id="2688860">(</span><span class="ident" id="2688861">_case</span>&nbsp;<span class="builtintype" id="2688867">int</span><span class="op" id="2688870">,</span>&nbsp;<span class="ident" id="2688872">r</span>&nbsp;<span class="builtintype" id="2688874">rune</span><span class="op" id="2688878">,</span>&nbsp;<span class="ident" id="2688880">caseRange</span>&nbsp;<span class="op" id="2688890">[</span><span class="op" id="2688891">]</span><span class="ident" id="2688892">CaseRange</span><span class="op" id="2688901">)</span>&nbsp;<span class="builtintype" id="2688903">rune</span>&nbsp;<span class="op" id="2688908">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688911">if</span>&nbsp;<span class="ident" id="2688914">_case</span>&nbsp;<span class="op" id="2688920">&lt;</span>&nbsp;<span class="num" id="2688922">0</span>&nbsp;<span class="op" id="2688924">||</span>&nbsp;<span class="ident" id="2688927">MaxCase</span>&nbsp;<span class="op" id="2688935">&lt;=</span>&nbsp;<span class="ident" id="2688938">_case</span>&nbsp;<span class="op" id="2688944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688948">return</span>&nbsp;<span class="ident" id="2688955">ReplacementChar</span>&nbsp;<span class="comment" id="2688971">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689008">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689038">lo</span>&nbsp;<span class="op" id="2689041">:=</span>&nbsp;<span class="num" id="2689044">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689047">hi</span>&nbsp;<span class="op" id="2689050">:=</span>&nbsp;<span class="builtinfunc" id="2689053">len</span><span class="op" id="2689056">(</span><span class="ident" id="2689057">caseRange</span><span class="op" id="2689066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689069">for</span>&nbsp;<span class="ident" id="2689073">lo</span>&nbsp;<span class="op" id="2689076">&lt;</span>&nbsp;<span class="ident" id="2689078">hi</span>&nbsp;<span class="op" id="2689081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689085">m</span>&nbsp;<span class="op" id="2689087">:=</span>&nbsp;<span class="ident" id="2689090">lo</span>&nbsp;<span class="op" id="2689093">+</span>&nbsp;<span class="op" id="2689095">(</span><span class="ident" id="2689096">hi</span><span class="op" id="2689098">-</span><span class="ident" id="2689099">lo</span><span class="op" id="2689101">)</span><span class="op" id="2689102">/</span><span class="num" id="2689103">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689107">cr</span>&nbsp;<span class="op" id="2689110">:=</span>&nbsp;<span class="ident" id="2689113">caseRange</span><span class="op" id="2689122">[</span><span class="ident" id="2689123">m</span><span class="op" id="2689124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689128">if</span>&nbsp;<span class="builtintype" id="2689131">rune</span><span class="op" id="2689135">(</span><span class="ident" id="2689136">cr</span><span class="op" id="2689138">.</span><span class="ident" id="2689139">Lo</span><span class="op" id="2689141">)</span>&nbsp;<span class="op" id="2689143">&lt;=</span>&nbsp;<span class="ident" id="2689146">r</span>&nbsp;<span class="op" id="2689148">&amp;&amp;</span>&nbsp;<span class="ident" id="2689151">r</span>&nbsp;<span class="op" id="2689153">&lt;=</span>&nbsp;<span class="builtintype" id="2689156">rune</span><span class="op" id="2689160">(</span><span class="ident" id="2689161">cr</span><span class="op" id="2689163">.</span><span class="ident" id="2689164">Hi</span><span class="op" id="2689166">)</span>&nbsp;<span class="op" id="2689168">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689173">delta</span>&nbsp;<span class="op" id="2689179">:=</span>&nbsp;<span class="builtintype" id="2689182">rune</span><span class="op" id="2689186">(</span><span class="ident" id="2689187">cr</span><span class="op" id="2689189">.</span><span class="ident" id="2689190">Delta</span><span class="op" id="2689195">[</span><span class="ident" id="2689196">_case</span><span class="op" id="2689201">]</span><span class="op" id="2689202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689207">if</span>&nbsp;<span class="ident" id="2689210">delta</span>&nbsp;<span class="op" id="2689216">&gt;</span>&nbsp;<span class="ident" id="2689218">MaxRune</span>&nbsp;<span class="op" id="2689226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689232">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689292">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689354">//&nbsp;&nbsp;&nbsp;&nbsp{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689400">//&nbsp;&nbsp;&nbsp;&nbsp{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689458">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689522">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689589">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689659">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689694">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689764">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689813">return</span>&nbsp;<span class="builtintype" id="2689820">rune</span><span class="op" id="2689824">(</span><span class="ident" id="2689825">cr</span><span class="op" id="2689827">.</span><span class="ident" id="2689828">Lo</span><span class="op" id="2689830">)</span>&nbsp;<span class="op" id="2689832">+</span>&nbsp;<span class="op" id="2689834">(</span><span class="op" id="2689835">(</span><span class="ident" id="2689836">r</span><span class="op" id="2689837">-</span><span class="builtintype" id="2689838">rune</span><span class="op" id="2689842">(</span><span class="ident" id="2689843">cr</span><span class="op" id="2689845">.</span><span class="ident" id="2689846">Lo</span><span class="op" id="2689848">)</span><span class="op" id="2689849">)</span><span class="op" id="2689850">&amp;^</span><span class="num" id="2689852">1</span>&nbsp;<span class="op" id="2689854">|</span>&nbsp;<span class="builtintype" id="2689856">rune</span><span class="op" id="2689860">(</span><span class="ident" id="2689861">_case</span><span class="op" id="2689866">&amp;</span><span class="num" id="2689867">1</span><span class="op" id="2689868">)</span><span class="op" id="2689869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689879">return</span>&nbsp;<span class="ident" id="2689886">r</span>&nbsp;<span class="op" id="2689888">+</span>&nbsp;<span class="ident" id="2689890">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689902">if</span>&nbsp;<span class="ident" id="2689905">r</span>&nbsp;<span class="op" id="2689907">&lt;</span>&nbsp;<span class="builtintype" id="2689909">rune</span><span class="op" id="2689913">(</span><span class="ident" id="2689914">cr</span><span class="op" id="2689916">.</span><span class="ident" id="2689917">Lo</span><span class="op" id="2689919">)</span>&nbsp;<span class="op" id="2689921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689926">hi</span>&nbsp;<span class="op" id="2689929">=</span>&nbsp;<span class="ident" id="2689931">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689935">}</span>&nbsp;<span class="keyword" id="2689937">else</span>&nbsp;<span class="op" id="2689942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689947">lo</span>&nbsp;<span class="op" id="2689950">=</span>&nbsp;<span class="ident" id="2689952">m</span>&nbsp;<span class="op" id="2689954">+</span>&nbsp;<span class="num" id="2689956">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2689963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2689966">return</span>&nbsp;<span class="ident" id="2689973">r</span><br>
<span class="lineno"></span><span class="op" id="2689975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2689978">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="2690057">func</span>&nbsp;<span class="ident" id="2690062">To</span><span class="op" id="2690064">(</span><span class="ident" id="2690065">_case</span>&nbsp;<span class="builtintype" id="2690071">int</span><span class="op" id="2690074">,</span>&nbsp;<span class="ident" id="2690076">r</span>&nbsp;<span class="builtintype" id="2690078">rune</span><span class="op" id="2690082">)</span>&nbsp;<span class="builtintype" id="2690084">rune</span>&nbsp;<span class="op" id="2690089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690092">return</span>&nbsp;<span class="ident" id="2690099">to</span><span class="op" id="2690101">(</span><span class="ident" id="2690102">_case</span><span class="op" id="2690107">,</span>&nbsp;<span class="ident" id="2690109">r</span><span class="op" id="2690110">,</span>&nbsp;<span class="ident" id="2690112">CaseRanges</span><span class="op" id="2690122">)</span><br>
<span class="lineno"></span><span class="op" id="2690124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="2690127">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2690167">func</span>&nbsp;<span class="ident" id="2690172">ToUpper</span><span class="op" id="2690179">(</span><span class="ident" id="2690180">r</span>&nbsp;<span class="builtintype" id="2690182">rune</span><span class="op" id="2690186">)</span>&nbsp;<span class="builtintype" id="2690188">rune</span>&nbsp;<span class="op" id="2690193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690196">if</span>&nbsp;<span class="ident" id="2690199">r</span>&nbsp;<span class="op" id="2690201">&lt;=</span>&nbsp;<span class="ident" id="2690204">MaxASCII</span>&nbsp;<span class="op" id="2690213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690217">if</span>&nbsp;<span class="string" id="2690220">&#39;a&#39;</span>&nbsp;<span class="op" id="2690224">&lt;=</span>&nbsp;<span class="ident" id="2690227">r</span>&nbsp;<span class="op" id="2690229">&amp;&amp;</span>&nbsp;<span class="ident" id="2690232">r</span>&nbsp;<span class="op" id="2690234">&lt;=</span>&nbsp;<span class="string" id="2690237">&#39;z&#39;</span>&nbsp;<span class="op" id="2690241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690246">r</span>&nbsp;<span class="op" id="2690248">-=</span>&nbsp;<span class="string" id="2690251">&#39;a&#39;</span>&nbsp;<span class="op" id="2690255">-</span>&nbsp;<span class="string" id="2690257">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690267">return</span>&nbsp;<span class="ident" id="2690274">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690280">return</span>&nbsp;<span class="ident" id="2690287">To</span><span class="op" id="2690289">(</span><span class="ident" id="2690290">UpperCase</span><span class="op" id="2690299">,</span>&nbsp;<span class="ident" id="2690301">r</span><span class="op" id="2690302">)</span><br>
<span class="lineno"></span><span class="op" id="2690304">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="2690307">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2690347">func</span>&nbsp;<span class="ident" id="2690352">ToLower</span><span class="op" id="2690359">(</span><span class="ident" id="2690360">r</span>&nbsp;<span class="builtintype" id="2690362">rune</span><span class="op" id="2690366">)</span>&nbsp;<span class="builtintype" id="2690368">rune</span>&nbsp;<span class="op" id="2690373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690376">if</span>&nbsp;<span class="ident" id="2690379">r</span>&nbsp;<span class="op" id="2690381">&lt;=</span>&nbsp;<span class="ident" id="2690384">MaxASCII</span>&nbsp;<span class="op" id="2690393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690397">if</span>&nbsp;<span class="string" id="2690400">&#39;A&#39;</span>&nbsp;<span class="op" id="2690404">&lt;=</span>&nbsp;<span class="ident" id="2690407">r</span>&nbsp;<span class="op" id="2690409">&amp;&amp;</span>&nbsp;<span class="ident" id="2690412">r</span>&nbsp;<span class="op" id="2690414">&lt;=</span>&nbsp;<span class="string" id="2690417">&#39;Z&#39;</span>&nbsp;<span class="op" id="2690421">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690426">r</span>&nbsp;<span class="op" id="2690428">+=</span>&nbsp;<span class="string" id="2690431">&#39;a&#39;</span>&nbsp;<span class="op" id="2690435">-</span>&nbsp;<span class="string" id="2690437">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690447">return</span>&nbsp;<span class="ident" id="2690454">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690460">return</span>&nbsp;<span class="ident" id="2690467">To</span><span class="op" id="2690469">(</span><span class="ident" id="2690470">LowerCase</span><span class="op" id="2690479">,</span>&nbsp;<span class="ident" id="2690481">r</span><span class="op" id="2690482">)</span><br>
<span class="lineno">270</span><span class="op" id="2690484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690487">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="2690527">func</span>&nbsp;<span class="ident" id="2690532">ToTitle</span><span class="op" id="2690539">(</span><span class="ident" id="2690540">r</span>&nbsp;<span class="builtintype" id="2690542">rune</span><span class="op" id="2690546">)</span>&nbsp;<span class="builtintype" id="2690548">rune</span>&nbsp;<span class="op" id="2690553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690556">if</span>&nbsp;<span class="ident" id="2690559">r</span>&nbsp;<span class="op" id="2690561">&lt;=</span>&nbsp;<span class="ident" id="2690564">MaxASCII</span>&nbsp;<span class="op" id="2690573">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690577">if</span>&nbsp;<span class="string" id="2690580">&#39;a&#39;</span>&nbsp;<span class="op" id="2690584">&lt;=</span>&nbsp;<span class="ident" id="2690587">r</span>&nbsp;<span class="op" id="2690589">&amp;&amp;</span>&nbsp;<span class="ident" id="2690592">r</span>&nbsp;<span class="op" id="2690594">&lt;=</span>&nbsp;<span class="string" id="2690597">&#39;z&#39;</span>&nbsp;<span class="op" id="2690601">{</span>&nbsp;<span class="comment" id="2690603">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690644">r</span>&nbsp;<span class="op" id="2690646">-=</span>&nbsp;<span class="string" id="2690649">&#39;a&#39;</span>&nbsp;<span class="op" id="2690653">-</span>&nbsp;<span class="string" id="2690655">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690665">return</span>&nbsp;<span class="ident" id="2690672">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690675">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690678">return</span>&nbsp;<span class="ident" id="2690685">To</span><span class="op" id="2690687">(</span><span class="ident" id="2690688">TitleCase</span><span class="op" id="2690697">,</span>&nbsp;<span class="ident" id="2690699">r</span><span class="op" id="2690700">)</span><br>
<span class="lineno"></span><span class="op" id="2690702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690705">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2690784">func</span>&nbsp;<span class="op" id="2690789">(</span><span class="ident" id="2690790">special</span>&nbsp;<span class="ident" id="2690798">SpecialCase</span><span class="op" id="2690809">)</span>&nbsp;<span class="ident" id="2690811">ToUpper</span><span class="op" id="2690818">(</span><span class="ident" id="2690819">r</span>&nbsp;<span class="builtintype" id="2690821">rune</span><span class="op" id="2690825">)</span>&nbsp;<span class="builtintype" id="2690827">rune</span>&nbsp;<span class="op" id="2690832">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690835">r1</span>&nbsp;<span class="op" id="2690838">:=</span>&nbsp;<span class="ident" id="2690841">to</span><span class="op" id="2690843">(</span><span class="ident" id="2690844">UpperCase</span><span class="op" id="2690853">,</span>&nbsp;<span class="ident" id="2690855">r</span><span class="op" id="2690856">,</span>&nbsp;<span class="op" id="2690858">[</span><span class="op" id="2690859">]</span><span class="ident" id="2690860">CaseRange</span><span class="op" id="2690869">(</span><span class="ident" id="2690870">special</span><span class="op" id="2690877">)</span><span class="op" id="2690878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690881">if</span>&nbsp;<span class="ident" id="2690884">r1</span>&nbsp;<span class="op" id="2690887">==</span>&nbsp;<span class="ident" id="2690890">r</span>&nbsp;<span class="op" id="2690892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690896">r1</span>&nbsp;<span class="op" id="2690899">=</span>&nbsp;<span class="ident" id="2690901">ToUpper</span><span class="op" id="2690908">(</span><span class="ident" id="2690909">r</span><span class="op" id="2690910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2690913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690916">return</span>&nbsp;<span class="ident" id="2690923">r1</span><br>
<span class="lineno">290</span><span class="op" id="2690926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2690929">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2691008">func</span>&nbsp;<span class="op" id="2691013">(</span><span class="ident" id="2691014">special</span>&nbsp;<span class="ident" id="2691022">SpecialCase</span><span class="op" id="2691033">)</span>&nbsp;<span class="ident" id="2691035">ToTitle</span><span class="op" id="2691042">(</span><span class="ident" id="2691043">r</span>&nbsp;<span class="builtintype" id="2691045">rune</span><span class="op" id="2691049">)</span>&nbsp;<span class="builtintype" id="2691051">rune</span>&nbsp;<span class="op" id="2691056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691059">r1</span>&nbsp;<span class="op" id="2691062">:=</span>&nbsp;<span class="ident" id="2691065">to</span><span class="op" id="2691067">(</span><span class="ident" id="2691068">TitleCase</span><span class="op" id="2691077">,</span>&nbsp;<span class="ident" id="2691079">r</span><span class="op" id="2691080">,</span>&nbsp;<span class="op" id="2691082">[</span><span class="op" id="2691083">]</span><span class="ident" id="2691084">CaseRange</span><span class="op" id="2691093">(</span><span class="ident" id="2691094">special</span><span class="op" id="2691101">)</span><span class="op" id="2691102">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691105">if</span>&nbsp;<span class="ident" id="2691108">r1</span>&nbsp;<span class="op" id="2691111">==</span>&nbsp;<span class="ident" id="2691114">r</span>&nbsp;<span class="op" id="2691116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691120">r1</span>&nbsp;<span class="op" id="2691123">=</span>&nbsp;<span class="ident" id="2691125">ToTitle</span><span class="op" id="2691132">(</span><span class="ident" id="2691133">r</span><span class="op" id="2691134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691140">return</span>&nbsp;<span class="ident" id="2691147">r1</span><br>
<span class="lineno"></span><span class="op" id="2691150">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2691153">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="2691232">func</span>&nbsp;<span class="op" id="2691237">(</span><span class="ident" id="2691238">special</span>&nbsp;<span class="ident" id="2691246">SpecialCase</span><span class="op" id="2691257">)</span>&nbsp;<span class="ident" id="2691259">ToLower</span><span class="op" id="2691266">(</span><span class="ident" id="2691267">r</span>&nbsp;<span class="builtintype" id="2691269">rune</span><span class="op" id="2691273">)</span>&nbsp;<span class="builtintype" id="2691275">rune</span>&nbsp;<span class="op" id="2691280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691283">r1</span>&nbsp;<span class="op" id="2691286">:=</span>&nbsp;<span class="ident" id="2691289">to</span><span class="op" id="2691291">(</span><span class="ident" id="2691292">LowerCase</span><span class="op" id="2691301">,</span>&nbsp;<span class="ident" id="2691303">r</span><span class="op" id="2691304">,</span>&nbsp;<span class="op" id="2691306">[</span><span class="op" id="2691307">]</span><span class="ident" id="2691308">CaseRange</span><span class="op" id="2691317">(</span><span class="ident" id="2691318">special</span><span class="op" id="2691325">)</span><span class="op" id="2691326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691329">if</span>&nbsp;<span class="ident" id="2691332">r1</span>&nbsp;<span class="op" id="2691335">==</span>&nbsp;<span class="ident" id="2691338">r</span>&nbsp;<span class="op" id="2691340">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691344">r1</span>&nbsp;<span class="op" id="2691347">=</span>&nbsp;<span class="ident" id="2691349">ToLower</span><span class="op" id="2691356">(</span><span class="ident" id="2691357">r</span><span class="op" id="2691358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691364">return</span>&nbsp;<span class="ident" id="2691371">r1</span><br>
<span class="lineno"></span><span class="op" id="2691374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2691377">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2691448">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="2691519">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="2691596">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="2691640">type</span>&nbsp;<span class="ident" id="2691645">foldPair</span>&nbsp;<span class="keyword" id="2691654">struct</span>&nbsp;<span class="op" id="2691661">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691664">From</span>&nbsp;<span class="builtintype" id="2691669">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691677">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2691682">uint16</span><br>
<span class="lineno"></span><span class="op" id="2691689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2691692">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="2691757">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2691824">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2691894">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="2691962">//</span><br>
<span class="lineno"></span><span class="comment" id="2691965">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="2691981">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2692006">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2692031">//</span><br>
<span class="lineno"></span><span class="comment" id="2692034">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2692059">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;)</span><br>
<span class="lineno">330</span><span class="comment" id="2692110">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2692140">//</span><br>
<span class="lineno"></span><span class="comment" id="2692143">//&nbsp;&nbsp;&nbsp;&nbspSimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2692168">//</span><br>
<span class="lineno"></span><span class="keyword" id="2692171">func</span>&nbsp;<span class="ident" id="2692176">SimpleFold</span><span class="op" id="2692186">(</span><span class="ident" id="2692187">r</span>&nbsp;<span class="builtintype" id="2692189">rune</span><span class="op" id="2692193">)</span>&nbsp;<span class="builtintype" id="2692195">rune</span>&nbsp;<span class="op" id="2692200">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692203">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692250">lo</span>&nbsp;<span class="op" id="2692253">:=</span>&nbsp;<span class="num" id="2692256">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692259">hi</span>&nbsp;<span class="op" id="2692262">:=</span>&nbsp;<span class="builtinfunc" id="2692265">len</span><span class="op" id="2692268">(</span><span class="ident" id="2692269">caseOrbit</span><span class="op" id="2692278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692281">for</span>&nbsp;<span class="ident" id="2692285">lo</span>&nbsp;<span class="op" id="2692288">&lt;</span>&nbsp;<span class="ident" id="2692290">hi</span>&nbsp;<span class="op" id="2692293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692297">m</span>&nbsp;<span class="op" id="2692299">:=</span>&nbsp;<span class="ident" id="2692302">lo</span>&nbsp;<span class="op" id="2692305">+</span>&nbsp;<span class="op" id="2692307">(</span><span class="ident" id="2692308">hi</span><span class="op" id="2692310">-</span><span class="ident" id="2692311">lo</span><span class="op" id="2692313">)</span><span class="op" id="2692314">/</span><span class="num" id="2692315">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692319">if</span>&nbsp;<span class="builtintype" id="2692322">rune</span><span class="op" id="2692326">(</span><span class="ident" id="2692327">caseOrbit</span><span class="op" id="2692336">[</span><span class="ident" id="2692337">m</span><span class="op" id="2692338">]</span><span class="op" id="2692339">.</span><span class="ident" id="2692340">From</span><span class="op" id="2692344">)</span>&nbsp;<span class="op" id="2692346">&lt;</span>&nbsp;<span class="ident" id="2692348">r</span>&nbsp;<span class="op" id="2692350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692355">lo</span>&nbsp;<span class="op" id="2692358">=</span>&nbsp;<span class="ident" id="2692360">m</span>&nbsp;<span class="op" id="2692362">+</span>&nbsp;<span class="num" id="2692364">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692368">}</span>&nbsp;<span class="keyword" id="2692370">else</span>&nbsp;<span class="op" id="2692375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692380">hi</span>&nbsp;<span class="op" id="2692383">=</span>&nbsp;<span class="ident" id="2692385">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692389">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692395">if</span>&nbsp;<span class="ident" id="2692398">lo</span>&nbsp;<span class="op" id="2692401">&lt;</span>&nbsp;<span class="builtinfunc" id="2692403">len</span><span class="op" id="2692406">(</span><span class="ident" id="2692407">caseOrbit</span><span class="op" id="2692416">)</span>&nbsp;<span class="op" id="2692418">&amp;&amp;</span>&nbsp;<span class="builtintype" id="2692421">rune</span><span class="op" id="2692425">(</span><span class="ident" id="2692426">caseOrbit</span><span class="op" id="2692435">[</span><span class="ident" id="2692436">lo</span><span class="op" id="2692438">]</span><span class="op" id="2692439">.</span><span class="ident" id="2692440">From</span><span class="op" id="2692444">)</span>&nbsp;<span class="op" id="2692446">==</span>&nbsp;<span class="ident" id="2692449">r</span>&nbsp;<span class="op" id="2692451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692455">return</span>&nbsp;<span class="builtintype" id="2692462">rune</span><span class="op" id="2692466">(</span><span class="ident" id="2692467">caseOrbit</span><span class="op" id="2692476">[</span><span class="ident" id="2692477">lo</span><span class="op" id="2692479">]</span><span class="op" id="2692480">.</span><span class="ident" id="2692481">To</span><span class="op" id="2692483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692490">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692547">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692603">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692658">if</span>&nbsp;<span class="ident" id="2692661">l</span>&nbsp;<span class="op" id="2692663">:=</span>&nbsp;<span class="ident" id="2692666">ToLower</span><span class="op" id="2692673">(</span><span class="ident" id="2692674">r</span><span class="op" id="2692675">)</span><span class="op" id="2692676">;</span>&nbsp;<span class="ident" id="2692678">l</span>&nbsp;<span class="op" id="2692680">!=</span>&nbsp;<span class="ident" id="2692683">r</span>&nbsp;<span class="op" id="2692685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692689">return</span>&nbsp;<span class="ident" id="2692696">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692702">return</span>&nbsp;<span class="ident" id="2692709">ToUpper</span><span class="op" id="2692716">(</span><span class="ident" id="2692717">r</span><span class="op" id="2692718">)</span><br>
<span class="lineno"></span><span class="op" id="2692720">}</span>
</div>
</body>
</html>
