<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2357662">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2357717">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2357771">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2357822">package</span>&nbsp;<span class="ident" id="2357830">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2357834">import</span>&nbsp;<span class="op" id="2357841">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2357844">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2357850">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2357860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2357863">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2357907">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2357961">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2357990">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2358035">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2358073">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2358130">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2358150">func</span>&nbsp;<span class="ident" id="2358155">MkdirAll</span><span class="op" id="2358163">(</span><span class="ident" id="2358164">path</span>&nbsp;<span class="builtintype" id="2358169">string</span><span class="op" id="2358175">,</span>&nbsp;<span class="ident" id="2358177">perm</span>&nbsp;<span class="ident" id="2358182">FileMode</span><span class="op" id="2358190">)</span>&nbsp;<span class="builtintype" id="2358192">error</span>&nbsp;<span class="op" id="2358198">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358201">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358296">dir</span><span class="op" id="2358299">,</span>&nbsp;<span class="ident" id="2358301">err</span>&nbsp;<span class="op" id="2358305">:=</span>&nbsp;<span class="ident" id="2358308">Stat</span><span class="op" id="2358312">(</span><span class="ident" id="2358313">path</span><span class="op" id="2358317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358320">if</span>&nbsp;<span class="ident" id="2358323">err</span>&nbsp;<span class="op" id="2358327">==</span>&nbsp;<span class="builtintype" id="2358330">nil</span>&nbsp;<span class="op" id="2358334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358338">if</span>&nbsp;<span class="ident" id="2358341">dir</span><span class="op" id="2358344">.</span><span class="ident" id="2358345">IsDir</span><span class="op" id="2358350">(</span><span class="op" id="2358351">)</span>&nbsp;<span class="op" id="2358353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358358">return</span>&nbsp;<span class="builtintype" id="2358365">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358375">return</span>&nbsp;<span class="op" id="2358382">&amp;</span><span class="ident" id="2358383">PathError</span><span class="op" id="2358392">{</span><span class="string" id="2358393">&#34;mkdir&#34;</span><span class="op" id="2358400">,</span>&nbsp;<span class="ident" id="2358402">path</span><span class="op" id="2358406">,</span>&nbsp;<span class="ident" id="2358408">syscall</span><span class="op" id="2358415">.</span><span class="ident" id="2358416">ENOTDIR</span><span class="op" id="2358423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358430">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358499">i</span>&nbsp;<span class="op" id="2358501">:=</span>&nbsp;<span class="builtinfunc" id="2358504">len</span><span class="op" id="2358507">(</span><span class="ident" id="2358508">path</span><span class="op" id="2358512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358515">for</span>&nbsp;<span class="ident" id="2358519">i</span>&nbsp;<span class="op" id="2358521">&gt;</span>&nbsp;<span class="num" id="2358523">0</span>&nbsp;<span class="op" id="2358525">&amp;&amp;</span>&nbsp;<span class="ident" id="2358528">IsPathSeparator</span><span class="op" id="2358543">(</span><span class="ident" id="2358544">path</span><span class="op" id="2358548">[</span><span class="ident" id="2358549">i</span><span class="op" id="2358550">-</span><span class="num" id="2358551">1</span><span class="op" id="2358552">]</span><span class="op" id="2358553">)</span>&nbsp;<span class="op" id="2358555">{</span>&nbsp;<span class="comment" id="2358557">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358592">i</span><span class="op" id="2358593">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358601">j</span>&nbsp;<span class="op" id="2358603">:=</span>&nbsp;<span class="ident" id="2358606">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358609">for</span>&nbsp;<span class="ident" id="2358613">j</span>&nbsp;<span class="op" id="2358615">&gt;</span>&nbsp;<span class="num" id="2358617">0</span>&nbsp;<span class="op" id="2358619">&amp;&amp;</span>&nbsp;<span class="op" id="2358622">!</span><span class="ident" id="2358623">IsPathSeparator</span><span class="op" id="2358638">(</span><span class="ident" id="2358639">path</span><span class="op" id="2358643">[</span><span class="ident" id="2358644">j</span><span class="op" id="2358645">-</span><span class="num" id="2358646">1</span><span class="op" id="2358647">]</span><span class="op" id="2358648">)</span>&nbsp;<span class="op" id="2358650">{</span>&nbsp;<span class="comment" id="2358652">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358685">j</span><span class="op" id="2358686">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358694">if</span>&nbsp;<span class="ident" id="2358697">j</span>&nbsp;<span class="op" id="2358699">&gt;</span>&nbsp;<span class="num" id="2358701">1</span>&nbsp;<span class="op" id="2358703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358707">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358726">err</span>&nbsp;<span class="op" id="2358730">=</span>&nbsp;<span class="ident" id="2358732">MkdirAll</span><span class="op" id="2358740">(</span><span class="ident" id="2358741">path</span><span class="op" id="2358745">[</span><span class="num" id="2358746">0</span><span class="op" id="2358747">:</span><span class="ident" id="2358748">j</span><span class="op" id="2358749">-</span><span class="num" id="2358750">1</span><span class="op" id="2358751">]</span><span class="op" id="2358752">,</span>&nbsp;<span class="ident" id="2358754">perm</span><span class="op" id="2358758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358762">if</span>&nbsp;<span class="ident" id="2358765">err</span>&nbsp;<span class="op" id="2358769">!=</span>&nbsp;<span class="builtintype" id="2358772">nil</span>&nbsp;<span class="op" id="2358776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358781">return</span>&nbsp;<span class="ident" id="2358788">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2358797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358801">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358857">err</span>&nbsp;<span class="op" id="2358861">=</span>&nbsp;<span class="ident" id="2358863">Mkdir</span><span class="op" id="2358868">(</span><span class="ident" id="2358869">path</span><span class="op" id="2358873">,</span>&nbsp;<span class="ident" id="2358875">perm</span><span class="op" id="2358879">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2358882">if</span>&nbsp;<span class="ident" id="2358885">err</span>&nbsp;<span class="op" id="2358889">!=</span>&nbsp;<span class="builtintype" id="2358892">nil</span>&nbsp;<span class="op" id="2358896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358900">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2358938">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2358989">dir</span><span class="op" id="2358992">,</span>&nbsp;<span class="ident" id="2358994">err1</span>&nbsp;<span class="op" id="2358999">:=</span>&nbsp;<span class="ident" id="2359002">Lstat</span><span class="op" id="2359007">(</span><span class="ident" id="2359008">path</span><span class="op" id="2359012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359016">if</span>&nbsp;<span class="ident" id="2359019">err1</span>&nbsp;<span class="op" id="2359024">==</span>&nbsp;<span class="builtintype" id="2359027">nil</span>&nbsp;<span class="op" id="2359031">&amp;&amp;</span>&nbsp;<span class="ident" id="2359034">dir</span><span class="op" id="2359037">.</span><span class="ident" id="2359038">IsDir</span><span class="op" id="2359043">(</span><span class="op" id="2359044">)</span>&nbsp;<span class="op" id="2359046">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359051">return</span>&nbsp;<span class="builtintype" id="2359058">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359068">return</span>&nbsp;<span class="ident" id="2359075">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359083">return</span>&nbsp;<span class="builtintype" id="2359090">nil</span><br>
<span class="lineno">60</span><span class="op" id="2359094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2359097">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2359153">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2359213">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2359270">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2359297">func</span>&nbsp;<span class="ident" id="2359302">RemoveAll</span><span class="op" id="2359311">(</span><span class="ident" id="2359312">path</span>&nbsp;<span class="builtintype" id="2359317">string</span><span class="op" id="2359323">)</span>&nbsp;<span class="builtintype" id="2359325">error</span>&nbsp;<span class="op" id="2359331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359334">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2359380">err</span>&nbsp;<span class="op" id="2359384">:=</span>&nbsp;<span class="ident" id="2359387">Remove</span><span class="op" id="2359393">(</span><span class="ident" id="2359394">path</span><span class="op" id="2359398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359401">if</span>&nbsp;<span class="ident" id="2359404">err</span>&nbsp;<span class="op" id="2359408">==</span>&nbsp;<span class="builtintype" id="2359411">nil</span>&nbsp;<span class="op" id="2359415">||</span>&nbsp;<span class="ident" id="2359418">IsNotExist</span><span class="op" id="2359428">(</span><span class="ident" id="2359429">err</span><span class="op" id="2359432">)</span>&nbsp;<span class="op" id="2359434">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359438">return</span>&nbsp;<span class="builtintype" id="2359445">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359454">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2359514">dir</span><span class="op" id="2359517">,</span>&nbsp;<span class="ident" id="2359519">serr</span>&nbsp;<span class="op" id="2359524">:=</span>&nbsp;<span class="ident" id="2359527">Lstat</span><span class="op" id="2359532">(</span><span class="ident" id="2359533">path</span><span class="op" id="2359537">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359540">if</span>&nbsp;<span class="ident" id="2359543">serr</span>&nbsp;<span class="op" id="2359548">!=</span>&nbsp;<span class="builtintype" id="2359551">nil</span>&nbsp;<span class="op" id="2359555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359559">if</span>&nbsp;<span class="ident" id="2359562">serr</span><span class="op" id="2359566">,</span>&nbsp;<span class="ident" id="2359568">ok</span>&nbsp;<span class="op" id="2359571">:=</span>&nbsp;<span class="ident" id="2359574">serr</span><span class="op" id="2359578">.</span><span class="op" id="2359579">(</span><span class="op" id="2359580">*</span><span class="ident" id="2359581">PathError</span><span class="op" id="2359590">)</span><span class="op" id="2359591">;</span>&nbsp;<span class="ident" id="2359593">ok</span>&nbsp;<span class="op" id="2359596">&amp;&amp;</span>&nbsp;<span class="op" id="2359599">(</span><span class="ident" id="2359600">IsNotExist</span><span class="op" id="2359610">(</span><span class="ident" id="2359611">serr</span><span class="op" id="2359615">.</span><span class="ident" id="2359616">Err</span><span class="op" id="2359619">)</span>&nbsp;<span class="op" id="2359621">||</span>&nbsp;<span class="ident" id="2359624">serr</span><span class="op" id="2359628">.</span><span class="ident" id="2359629">Err</span>&nbsp;<span class="op" id="2359633">==</span>&nbsp;<span class="ident" id="2359636">syscall</span><span class="op" id="2359643">.</span><span class="ident" id="2359644">ENOTDIR</span><span class="op" id="2359651">)</span>&nbsp;<span class="op" id="2359653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359658">return</span>&nbsp;<span class="builtintype" id="2359665">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359675">return</span>&nbsp;<span class="ident" id="2359682">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359691">if</span>&nbsp;<span class="op" id="2359694">!</span><span class="ident" id="2359695">dir</span><span class="op" id="2359698">.</span><span class="ident" id="2359699">IsDir</span><span class="op" id="2359704">(</span><span class="op" id="2359705">)</span>&nbsp;<span class="op" id="2359707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359711">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359763">return</span>&nbsp;<span class="ident" id="2359770">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359775">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359779">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2359794">fd</span><span class="op" id="2359796">,</span>&nbsp;<span class="ident" id="2359798">err</span>&nbsp;<span class="op" id="2359802">:=</span>&nbsp;<span class="ident" id="2359805">Open</span><span class="op" id="2359809">(</span><span class="ident" id="2359810">path</span><span class="op" id="2359814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359817">if</span>&nbsp;<span class="ident" id="2359820">err</span>&nbsp;<span class="op" id="2359824">!=</span>&nbsp;<span class="builtintype" id="2359827">nil</span>&nbsp;<span class="op" id="2359831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359835">if</span>&nbsp;<span class="ident" id="2359838">IsNotExist</span><span class="op" id="2359848">(</span><span class="ident" id="2359849">err</span><span class="op" id="2359852">)</span>&nbsp;<span class="op" id="2359854">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359859">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359914">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359953">return</span>&nbsp;<span class="builtintype" id="2359960">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2359970">return</span>&nbsp;<span class="ident" id="2359977">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2359982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2359986">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360028">err</span>&nbsp;<span class="op" id="2360032">=</span>&nbsp;<span class="builtintype" id="2360034">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360039">for</span>&nbsp;<span class="op" id="2360043">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360047">names</span><span class="op" id="2360052">,</span>&nbsp;<span class="ident" id="2360054">err1</span>&nbsp;<span class="op" id="2360059">:=</span>&nbsp;<span class="ident" id="2360062">fd</span><span class="op" id="2360064">.</span><span class="ident" id="2360065">Readdirnames</span><span class="op" id="2360077">(</span><span class="num" id="2360078">100</span><span class="op" id="2360081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360085">for</span>&nbsp;<span class="ident" id="2360089">_</span><span class="op" id="2360090">,</span>&nbsp;<span class="ident" id="2360092">name</span>&nbsp;<span class="op" id="2360097">:=</span>&nbsp;<span class="keyword" id="2360100">range</span>&nbsp;<span class="ident" id="2360106">names</span>&nbsp;<span class="op" id="2360112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360117">err1</span>&nbsp;<span class="op" id="2360122">:=</span>&nbsp;<span class="ident" id="2360125">RemoveAll</span><span class="op" id="2360134">(</span><span class="ident" id="2360135">path</span>&nbsp;<span class="op" id="2360140">+</span>&nbsp;<span class="builtintype" id="2360142">string</span><span class="op" id="2360148">(</span><span class="ident" id="2360149">PathSeparator</span><span class="op" id="2360162">)</span>&nbsp;<span class="op" id="2360164">+</span>&nbsp;<span class="ident" id="2360166">name</span><span class="op" id="2360170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360175">if</span>&nbsp;<span class="ident" id="2360178">err</span>&nbsp;<span class="op" id="2360182">==</span>&nbsp;<span class="builtintype" id="2360185">nil</span>&nbsp;<span class="op" id="2360189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360195">err</span>&nbsp;<span class="op" id="2360199">=</span>&nbsp;<span class="ident" id="2360201">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360217">if</span>&nbsp;<span class="ident" id="2360220">err1</span>&nbsp;<span class="op" id="2360225">==</span>&nbsp;<span class="ident" id="2360228">io</span><span class="op" id="2360230">.</span><span class="ident" id="2360231">EOF</span>&nbsp;<span class="op" id="2360235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360240">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360248">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2360252">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360300">if</span>&nbsp;<span class="ident" id="2360303">err</span>&nbsp;<span class="op" id="2360307">==</span>&nbsp;<span class="builtintype" id="2360310">nil</span>&nbsp;<span class="op" id="2360314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360319">err</span>&nbsp;<span class="op" id="2360323">=</span>&nbsp;<span class="ident" id="2360325">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360336">if</span>&nbsp;<span class="builtinfunc" id="2360339">len</span><span class="op" id="2360342">(</span><span class="ident" id="2360343">names</span><span class="op" id="2360348">)</span>&nbsp;<span class="op" id="2360350">==</span>&nbsp;<span class="num" id="2360353">0</span>&nbsp;<span class="op" id="2360355">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360360">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2360375">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360443">fd</span><span class="op" id="2360445">.</span><span class="ident" id="2360446">Close</span><span class="op" id="2360451">(</span><span class="op" id="2360452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2360456">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360478">err1</span>&nbsp;<span class="op" id="2360483">:=</span>&nbsp;<span class="ident" id="2360486">Remove</span><span class="op" id="2360492">(</span><span class="ident" id="2360493">path</span><span class="op" id="2360497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360500">if</span>&nbsp;<span class="ident" id="2360503">err1</span>&nbsp;<span class="op" id="2360508">==</span>&nbsp;<span class="builtintype" id="2360511">nil</span>&nbsp;<span class="op" id="2360515">||</span>&nbsp;<span class="ident" id="2360518">IsNotExist</span><span class="op" id="2360528">(</span><span class="ident" id="2360529">err1</span><span class="op" id="2360533">)</span>&nbsp;<span class="op" id="2360535">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360539">return</span>&nbsp;<span class="builtintype" id="2360546">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360554">if</span>&nbsp;<span class="ident" id="2360557">err</span>&nbsp;<span class="op" id="2360561">==</span>&nbsp;<span class="builtintype" id="2360564">nil</span>&nbsp;<span class="op" id="2360568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2360572">err</span>&nbsp;<span class="op" id="2360576">=</span>&nbsp;<span class="ident" id="2360578">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2360584">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2360587">return</span>&nbsp;<span class="ident" id="2360594">err</span><br>
<span class="lineno"></span><span class="op" id="2360598">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
