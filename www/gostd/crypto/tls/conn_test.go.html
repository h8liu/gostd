<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html" class="current">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7769888">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7769943">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7769997">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7770048">package</span>&nbsp;<span class="ident" id="7770056">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7770061">import</span>&nbsp;<span class="op" id="7770068">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7770071">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7770081">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7770084">func</span>&nbsp;<span class="ident" id="7770089">TestRoundUp</span><span class="op" id="7770100">(</span><span class="ident" id="7770101">t</span>&nbsp;<span class="op" id="7770103">*</span><span class="ident" id="7770104">testing</span><span class="op" id="7770111">.</span><span class="ident" id="7770112">T</span><span class="op" id="7770113">)</span>&nbsp;<span class="op" id="7770115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7770118">if</span>&nbsp;<span class="ident" id="7770121">roundUp</span><span class="op" id="7770128">(</span><span class="num" id="7770129">0</span><span class="op" id="7770130">,</span>&nbsp;<span class="num" id="7770132">16</span><span class="op" id="7770134">)</span>&nbsp;<span class="op" id="7770136">!=</span>&nbsp;<span class="num" id="7770139">0</span>&nbsp;<span class="op" id="7770141">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770146">roundUp</span><span class="op" id="7770153">(</span><span class="num" id="7770154">1</span><span class="op" id="7770155">,</span>&nbsp;<span class="num" id="7770157">16</span><span class="op" id="7770159">)</span>&nbsp;<span class="op" id="7770161">!=</span>&nbsp;<span class="num" id="7770164">16</span>&nbsp;<span class="op" id="7770167">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770172">roundUp</span><span class="op" id="7770179">(</span><span class="num" id="7770180">15</span><span class="op" id="7770182">,</span>&nbsp;<span class="num" id="7770184">16</span><span class="op" id="7770186">)</span>&nbsp;<span class="op" id="7770188">!=</span>&nbsp;<span class="num" id="7770191">16</span>&nbsp;<span class="op" id="7770194">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770199">roundUp</span><span class="op" id="7770206">(</span><span class="num" id="7770207">16</span><span class="op" id="7770209">,</span>&nbsp;<span class="num" id="7770211">16</span><span class="op" id="7770213">)</span>&nbsp;<span class="op" id="7770215">!=</span>&nbsp;<span class="num" id="7770218">16</span>&nbsp;<span class="op" id="7770221">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770226">roundUp</span><span class="op" id="7770233">(</span><span class="num" id="7770234">17</span><span class="op" id="7770236">,</span>&nbsp;<span class="num" id="7770238">16</span><span class="op" id="7770240">)</span>&nbsp;<span class="op" id="7770242">!=</span>&nbsp;<span class="num" id="7770245">32</span>&nbsp;<span class="op" id="7770248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770252">t</span><span class="op" id="7770253">.</span><span class="ident" id="7770254">Error</span><span class="op" id="7770259">(</span><span class="string" id="7770260">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7770276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770279">}</span><br>
<span class="lineno"></span><span class="op" id="7770281">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7770284">var</span>&nbsp;<span class="ident" id="7770288">paddingTests</span>&nbsp;<span class="op" id="7770301">=</span>&nbsp;<span class="op" id="7770303">[</span><span class="op" id="7770304">]</span><span class="keyword" id="7770305">struct</span>&nbsp;<span class="op" id="7770312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770315">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770327">[</span><span class="op" id="7770328">]</span><span class="builtintype" id="7770329">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770335">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7770347">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770353">expectedLen</span>&nbsp;<span class="builtintype" id="7770365">int</span><br>
<span class="lineno">25</span><span class="op" id="7770369">}</span><span class="op" id="7770370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770373">{</span><span class="op" id="7770374">[</span><span class="op" id="7770375">]</span><span class="builtintype" id="7770376">byte</span><span class="op" id="7770380">{</span><span class="num" id="7770381">1</span><span class="op" id="7770382">,</span>&nbsp;<span class="num" id="7770384">2</span><span class="op" id="7770385">,</span>&nbsp;<span class="num" id="7770387">3</span><span class="op" id="7770388">,</span>&nbsp;<span class="num" id="7770390">4</span><span class="op" id="7770391">,</span>&nbsp;<span class="num" id="7770393">0</span><span class="op" id="7770394">}</span><span class="op" id="7770395">,</span>&nbsp;<span class="builtintype" id="7770397">true</span><span class="op" id="7770401">,</span>&nbsp;<span class="num" id="7770403">4</span><span class="op" id="7770404">}</span><span class="op" id="7770405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770408">{</span><span class="op" id="7770409">[</span><span class="op" id="7770410">]</span><span class="builtintype" id="7770411">byte</span><span class="op" id="7770415">{</span><span class="num" id="7770416">1</span><span class="op" id="7770417">,</span>&nbsp;<span class="num" id="7770419">2</span><span class="op" id="7770420">,</span>&nbsp;<span class="num" id="7770422">3</span><span class="op" id="7770423">,</span>&nbsp;<span class="num" id="7770425">4</span><span class="op" id="7770426">,</span>&nbsp;<span class="num" id="7770428">0</span><span class="op" id="7770429">,</span>&nbsp;<span class="num" id="7770431">1</span><span class="op" id="7770432">}</span><span class="op" id="7770433">,</span>&nbsp;<span class="builtintype" id="7770435">false</span><span class="op" id="7770440">,</span>&nbsp;<span class="num" id="7770442">0</span><span class="op" id="7770443">}</span><span class="op" id="7770444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770447">{</span><span class="op" id="7770448">[</span><span class="op" id="7770449">]</span><span class="builtintype" id="7770450">byte</span><span class="op" id="7770454">{</span><span class="num" id="7770455">1</span><span class="op" id="7770456">,</span>&nbsp;<span class="num" id="7770458">2</span><span class="op" id="7770459">,</span>&nbsp;<span class="num" id="7770461">3</span><span class="op" id="7770462">,</span>&nbsp;<span class="num" id="7770464">4</span><span class="op" id="7770465">,</span>&nbsp;<span class="num" id="7770467">99</span><span class="op" id="7770469">,</span>&nbsp;<span class="num" id="7770471">99</span><span class="op" id="7770473">}</span><span class="op" id="7770474">,</span>&nbsp;<span class="builtintype" id="7770476">false</span><span class="op" id="7770481">,</span>&nbsp;<span class="num" id="7770483">0</span><span class="op" id="7770484">}</span><span class="op" id="7770485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770488">{</span><span class="op" id="7770489">[</span><span class="op" id="7770490">]</span><span class="builtintype" id="7770491">byte</span><span class="op" id="7770495">{</span><span class="num" id="7770496">1</span><span class="op" id="7770497">,</span>&nbsp;<span class="num" id="7770499">2</span><span class="op" id="7770500">,</span>&nbsp;<span class="num" id="7770502">3</span><span class="op" id="7770503">,</span>&nbsp;<span class="num" id="7770505">4</span><span class="op" id="7770506">,</span>&nbsp;<span class="num" id="7770508">1</span><span class="op" id="7770509">,</span>&nbsp;<span class="num" id="7770511">1</span><span class="op" id="7770512">}</span><span class="op" id="7770513">,</span>&nbsp;<span class="builtintype" id="7770515">true</span><span class="op" id="7770519">,</span>&nbsp;<span class="num" id="7770521">4</span><span class="op" id="7770522">}</span><span class="op" id="7770523">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770526">{</span><span class="op" id="7770527">[</span><span class="op" id="7770528">]</span><span class="builtintype" id="7770529">byte</span><span class="op" id="7770533">{</span><span class="num" id="7770534">1</span><span class="op" id="7770535">,</span>&nbsp;<span class="num" id="7770537">2</span><span class="op" id="7770538">,</span>&nbsp;<span class="num" id="7770540">3</span><span class="op" id="7770541">,</span>&nbsp;<span class="num" id="7770543">2</span><span class="op" id="7770544">,</span>&nbsp;<span class="num" id="7770546">2</span><span class="op" id="7770547">,</span>&nbsp;<span class="num" id="7770549">2</span><span class="op" id="7770550">}</span><span class="op" id="7770551">,</span>&nbsp;<span class="builtintype" id="7770553">true</span><span class="op" id="7770557">,</span>&nbsp;<span class="num" id="7770559">3</span><span class="op" id="7770560">}</span><span class="op" id="7770561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770564">{</span><span class="op" id="7770565">[</span><span class="op" id="7770566">]</span><span class="builtintype" id="7770567">byte</span><span class="op" id="7770571">{</span><span class="num" id="7770572">1</span><span class="op" id="7770573">,</span>&nbsp;<span class="num" id="7770575">2</span><span class="op" id="7770576">,</span>&nbsp;<span class="num" id="7770578">3</span><span class="op" id="7770579">,</span>&nbsp;<span class="num" id="7770581">3</span><span class="op" id="7770582">,</span>&nbsp;<span class="num" id="7770584">3</span><span class="op" id="7770585">,</span>&nbsp;<span class="num" id="7770587">3</span><span class="op" id="7770588">}</span><span class="op" id="7770589">,</span>&nbsp;<span class="builtintype" id="7770591">true</span><span class="op" id="7770595">,</span>&nbsp;<span class="num" id="7770597">2</span><span class="op" id="7770598">}</span><span class="op" id="7770599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770602">{</span><span class="op" id="7770603">[</span><span class="op" id="7770604">]</span><span class="builtintype" id="7770605">byte</span><span class="op" id="7770609">{</span><span class="num" id="7770610">1</span><span class="op" id="7770611">,</span>&nbsp;<span class="num" id="7770613">2</span><span class="op" id="7770614">,</span>&nbsp;<span class="num" id="7770616">3</span><span class="op" id="7770617">,</span>&nbsp;<span class="num" id="7770619">4</span><span class="op" id="7770620">,</span>&nbsp;<span class="num" id="7770622">3</span><span class="op" id="7770623">,</span>&nbsp;<span class="num" id="7770625">3</span><span class="op" id="7770626">}</span><span class="op" id="7770627">,</span>&nbsp;<span class="builtintype" id="7770629">false</span><span class="op" id="7770634">,</span>&nbsp;<span class="num" id="7770636">0</span><span class="op" id="7770637">}</span><span class="op" id="7770638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770641">{</span><span class="op" id="7770642">[</span><span class="op" id="7770643">]</span><span class="builtintype" id="7770644">byte</span><span class="op" id="7770648">{</span><span class="num" id="7770649">1</span><span class="op" id="7770650">,</span>&nbsp;<span class="num" id="7770652">4</span><span class="op" id="7770653">,</span>&nbsp;<span class="num" id="7770655">4</span><span class="op" id="7770656">,</span>&nbsp;<span class="num" id="7770658">4</span><span class="op" id="7770659">,</span>&nbsp;<span class="num" id="7770661">4</span><span class="op" id="7770662">,</span>&nbsp;<span class="num" id="7770664">4</span><span class="op" id="7770665">}</span><span class="op" id="7770666">,</span>&nbsp;<span class="builtintype" id="7770668">true</span><span class="op" id="7770672">,</span>&nbsp;<span class="num" id="7770674">1</span><span class="op" id="7770675">}</span><span class="op" id="7770676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770679">{</span><span class="op" id="7770680">[</span><span class="op" id="7770681">]</span><span class="builtintype" id="7770682">byte</span><span class="op" id="7770686">{</span><span class="num" id="7770687">5</span><span class="op" id="7770688">,</span>&nbsp;<span class="num" id="7770690">5</span><span class="op" id="7770691">,</span>&nbsp;<span class="num" id="7770693">5</span><span class="op" id="7770694">,</span>&nbsp;<span class="num" id="7770696">5</span><span class="op" id="7770697">,</span>&nbsp;<span class="num" id="7770699">5</span><span class="op" id="7770700">,</span>&nbsp;<span class="num" id="7770702">5</span><span class="op" id="7770703">}</span><span class="op" id="7770704">,</span>&nbsp;<span class="builtintype" id="7770706">true</span><span class="op" id="7770710">,</span>&nbsp;<span class="num" id="7770712">0</span><span class="op" id="7770713">}</span><span class="op" id="7770714">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770717">{</span><span class="op" id="7770718">[</span><span class="op" id="7770719">]</span><span class="builtintype" id="7770720">byte</span><span class="op" id="7770724">{</span><span class="num" id="7770725">6</span><span class="op" id="7770726">,</span>&nbsp;<span class="num" id="7770728">6</span><span class="op" id="7770729">,</span>&nbsp;<span class="num" id="7770731">6</span><span class="op" id="7770732">,</span>&nbsp;<span class="num" id="7770734">6</span><span class="op" id="7770735">,</span>&nbsp;<span class="num" id="7770737">6</span><span class="op" id="7770738">,</span>&nbsp;<span class="num" id="7770740">6</span><span class="op" id="7770741">}</span><span class="op" id="7770742">,</span>&nbsp;<span class="builtintype" id="7770744">false</span><span class="op" id="7770749">,</span>&nbsp;<span class="num" id="7770751">0</span><span class="op" id="7770752">}</span><span class="op" id="7770753">,</span><br>
<span class="lineno"></span><span class="op" id="7770755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7770758">func</span>&nbsp;<span class="ident" id="7770763">TestRemovePadding</span><span class="op" id="7770780">(</span><span class="ident" id="7770781">t</span>&nbsp;<span class="op" id="7770783">*</span><span class="ident" id="7770784">testing</span><span class="op" id="7770791">.</span><span class="ident" id="7770792">T</span><span class="op" id="7770793">)</span>&nbsp;<span class="op" id="7770795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7770798">for</span>&nbsp;<span class="ident" id="7770802">i</span><span class="op" id="7770803">,</span>&nbsp;<span class="ident" id="7770805">test</span>&nbsp;<span class="op" id="7770810">:=</span>&nbsp;<span class="keyword" id="7770813">range</span>&nbsp;<span class="ident" id="7770819">paddingTests</span>&nbsp;<span class="op" id="7770832">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770836">payload</span><span class="op" id="7770843">,</span>&nbsp;<span class="ident" id="7770845">good</span>&nbsp;<span class="op" id="7770850">:=</span>&nbsp;<span class="ident" id="7770853">removePadding</span><span class="op" id="7770866">(</span><span class="ident" id="7770867">test</span><span class="op" id="7770871">.</span><span class="ident" id="7770872">in</span><span class="op" id="7770874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770878">expectedGood</span>&nbsp;<span class="op" id="7770891">:=</span>&nbsp;<span class="builtintype" id="7770894">byte</span><span class="op" id="7770898">(</span><span class="num" id="7770899">255</span><span class="op" id="7770902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7770906">if</span>&nbsp;<span class="op" id="7770909">!</span><span class="ident" id="7770910">test</span><span class="op" id="7770914">.</span><span class="ident" id="7770915">good</span>&nbsp;<span class="op" id="7770920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770925">expectedGood</span>&nbsp;<span class="op" id="7770938">=</span>&nbsp;<span class="num" id="7770940">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7770944">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7770948">if</span>&nbsp;<span class="ident" id="7770951">good</span>&nbsp;<span class="op" id="7770956">!=</span>&nbsp;<span class="ident" id="7770959">expectedGood</span>&nbsp;<span class="op" id="7770972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7770977">t</span><span class="op" id="7770978">.</span><span class="ident" id="7770979">Errorf</span><span class="op" id="7770985">(</span><span class="string" id="7770986">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7771023">,</span>&nbsp;<span class="ident" id="7771025">i</span><span class="op" id="7771026">,</span>&nbsp;<span class="ident" id="7771028">expectedGood</span><span class="op" id="7771040">,</span>&nbsp;<span class="ident" id="7771042">good</span><span class="op" id="7771046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7771050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7771054">if</span>&nbsp;<span class="ident" id="7771057">good</span>&nbsp;<span class="op" id="7771062">==</span>&nbsp;<span class="num" id="7771065">255</span>&nbsp;<span class="op" id="7771069">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7771072">len</span><span class="op" id="7771075">(</span><span class="ident" id="7771076">payload</span><span class="op" id="7771083">)</span>&nbsp;<span class="op" id="7771085">!=</span>&nbsp;<span class="ident" id="7771088">test</span><span class="op" id="7771092">.</span><span class="ident" id="7771093">expectedLen</span>&nbsp;<span class="op" id="7771105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7771110">t</span><span class="op" id="7771111">.</span><span class="ident" id="7771112">Errorf</span><span class="op" id="7771118">(</span><span class="string" id="7771119">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7771141">,</span>&nbsp;<span class="ident" id="7771143">i</span><span class="op" id="7771144">,</span>&nbsp;<span class="builtinfunc" id="7771146">len</span><span class="op" id="7771149">(</span><span class="ident" id="7771150">payload</span><span class="op" id="7771157">)</span><span class="op" id="7771158">,</span>&nbsp;<span class="ident" id="7771160">test</span><span class="op" id="7771164">.</span><span class="ident" id="7771165">expectedLen</span><span class="op" id="7771176">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7771180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7771183">}</span><br>
<span class="lineno"></span><span class="op" id="7771185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7771188">var</span>&nbsp;<span class="ident" id="7771192">certExampleCom</span>&nbsp;<span class="op" id="7771207">=</span>&nbsp;<span class="string" id="7771209">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7771861">var</span>&nbsp;<span class="ident" id="7771865">certWildcardExampleCom</span>&nbsp;<span class="op" id="7771888">=</span>&nbsp;<span class="string" id="7771890">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7772546">var</span>&nbsp;<span class="ident" id="7772550">certFooExampleCom</span>&nbsp;<span class="op" id="7772568">=</span>&nbsp;<span class="string" id="7772570">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7773230">var</span>&nbsp;<span class="ident" id="7773234">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7773263">=</span>&nbsp;<span class="string" id="7773265">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7773925">func</span>&nbsp;<span class="ident" id="7773930">TestCertificateSelection</span><span class="op" id="7773954">(</span><span class="ident" id="7773955">t</span>&nbsp;<span class="op" id="7773957">*</span><span class="ident" id="7773958">testing</span><span class="op" id="7773965">.</span><span class="ident" id="7773966">T</span><span class="op" id="7773967">)</span>&nbsp;<span class="op" id="7773969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773972">config</span>&nbsp;<span class="op" id="7773979">:=</span>&nbsp;<span class="ident" id="7773982">Config</span><span class="op" id="7773988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773992">Certificates</span><span class="op" id="7774004">:</span>&nbsp;<span class="op" id="7774006">[</span><span class="op" id="7774007">]</span><span class="ident" id="7774008">Certificate</span><span class="op" id="7774019">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774030">Certificate</span><span class="op" id="7774041">:</span>&nbsp;<span class="op" id="7774043">[</span><span class="op" id="7774044">]</span><span class="op" id="7774045">[</span><span class="op" id="7774046">]</span><span class="builtintype" id="7774047">byte</span><span class="op" id="7774051">{</span><span class="ident" id="7774052">fromHex</span><span class="op" id="7774059">(</span><span class="ident" id="7774060">certExampleCom</span><span class="op" id="7774074">)</span><span class="op" id="7774075">}</span><span class="op" id="7774076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774081">}</span><span class="op" id="7774082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774093">Certificate</span><span class="op" id="7774104">:</span>&nbsp;<span class="op" id="7774106">[</span><span class="op" id="7774107">]</span><span class="op" id="7774108">[</span><span class="op" id="7774109">]</span><span class="builtintype" id="7774110">byte</span><span class="op" id="7774114">{</span><span class="ident" id="7774115">fromHex</span><span class="op" id="7774122">(</span><span class="ident" id="7774123">certWildcardExampleCom</span><span class="op" id="7774145">)</span><span class="op" id="7774146">}</span><span class="op" id="7774147">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774152">}</span><span class="op" id="7774153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774164">Certificate</span><span class="op" id="7774175">:</span>&nbsp;<span class="op" id="7774177">[</span><span class="op" id="7774178">]</span><span class="op" id="7774179">[</span><span class="op" id="7774180">]</span><span class="builtintype" id="7774181">byte</span><span class="op" id="7774185">{</span><span class="ident" id="7774186">fromHex</span><span class="op" id="7774193">(</span><span class="ident" id="7774194">certFooExampleCom</span><span class="op" id="7774211">)</span><span class="op" id="7774212">}</span><span class="op" id="7774213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774218">}</span><span class="op" id="7774219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774224">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774230">Certificate</span><span class="op" id="7774241">:</span>&nbsp;<span class="op" id="7774243">[</span><span class="op" id="7774244">]</span><span class="op" id="7774245">[</span><span class="op" id="7774246">]</span><span class="builtintype" id="7774247">byte</span><span class="op" id="7774251">{</span><span class="ident" id="7774252">fromHex</span><span class="op" id="7774259">(</span><span class="ident" id="7774260">certDoubleWildcardExampleCom</span><span class="op" id="7774288">)</span><span class="op" id="7774289">}</span><span class="op" id="7774290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774295">}</span><span class="op" id="7774296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774300">}</span><span class="op" id="7774301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774308">config</span><span class="op" id="7774314">.</span><span class="ident" id="7774315">BuildNameToCertificate</span><span class="op" id="7774337">(</span><span class="op" id="7774338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774342">pointerToIndex</span>&nbsp;<span class="op" id="7774357">:=</span>&nbsp;<span class="keyword" id="7774360">func</span><span class="op" id="7774364">(</span><span class="ident" id="7774365">c</span>&nbsp;<span class="op" id="7774367">*</span><span class="ident" id="7774368">Certificate</span><span class="op" id="7774379">)</span>&nbsp;<span class="builtintype" id="7774381">int</span>&nbsp;<span class="op" id="7774385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774389">for</span>&nbsp;<span class="ident" id="7774393">i</span>&nbsp;<span class="op" id="7774395">:=</span>&nbsp;<span class="keyword" id="7774398">range</span>&nbsp;<span class="ident" id="7774404">config</span><span class="op" id="7774410">.</span><span class="ident" id="7774411">Certificates</span>&nbsp;<span class="op" id="7774424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774429">if</span>&nbsp;<span class="ident" id="7774432">c</span>&nbsp;<span class="op" id="7774434">==</span>&nbsp;<span class="op" id="7774437">&amp;</span><span class="ident" id="7774438">config</span><span class="op" id="7774444">.</span><span class="ident" id="7774445">Certificates</span><span class="op" id="7774457">[</span><span class="ident" id="7774458">i</span><span class="op" id="7774459">]</span>&nbsp;<span class="op" id="7774461">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774467">return</span>&nbsp;<span class="ident" id="7774474">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774487">return</span>&nbsp;<span class="op" id="7774494">-</span><span class="num" id="7774495">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774498">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774502">certificateForName</span>&nbsp;<span class="op" id="7774521">:=</span>&nbsp;<span class="keyword" id="7774524">func</span><span class="op" id="7774528">(</span><span class="ident" id="7774529">name</span>&nbsp;<span class="builtintype" id="7774534">string</span><span class="op" id="7774540">)</span>&nbsp;<span class="op" id="7774542">*</span><span class="ident" id="7774543">Certificate</span>&nbsp;<span class="op" id="7774555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774559">clientHello</span>&nbsp;<span class="op" id="7774571">:=</span>&nbsp;<span class="op" id="7774574">&amp;</span><span class="ident" id="7774575">ClientHelloInfo</span><span class="op" id="7774590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774595">ServerName</span><span class="op" id="7774605">:</span>&nbsp;<span class="ident" id="7774607">name</span><span class="op" id="7774611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774615">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774619">if</span>&nbsp;<span class="ident" id="7774622">cert</span><span class="op" id="7774626">,</span>&nbsp;<span class="ident" id="7774628">err</span>&nbsp;<span class="op" id="7774632">:=</span>&nbsp;<span class="ident" id="7774635">config</span><span class="op" id="7774641">.</span><span class="ident" id="7774642">getCertificate</span><span class="op" id="7774656">(</span><span class="ident" id="7774657">clientHello</span><span class="op" id="7774668">)</span><span class="op" id="7774669">;</span>&nbsp;<span class="ident" id="7774671">err</span>&nbsp;<span class="op" id="7774675">!=</span>&nbsp;<span class="builtintype" id="7774678">nil</span>&nbsp;<span class="op" id="7774682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774687">t</span><span class="op" id="7774688">.</span><span class="ident" id="7774689">Errorf</span><span class="op" id="7774695">(</span><span class="string" id="7774696">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7774741">,</span>&nbsp;<span class="ident" id="7774743">name</span><span class="op" id="7774747">,</span>&nbsp;<span class="ident" id="7774749">err</span><span class="op" id="7774752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774757">return</span>&nbsp;<span class="builtintype" id="7774764">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774770">}</span>&nbsp;<span class="keyword" id="7774772">else</span>&nbsp;<span class="op" id="7774777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774782">return</span>&nbsp;<span class="ident" id="7774789">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774803">if</span>&nbsp;<span class="ident" id="7774806">n</span>&nbsp;<span class="op" id="7774808">:=</span>&nbsp;<span class="ident" id="7774811">pointerToIndex</span><span class="op" id="7774825">(</span><span class="ident" id="7774826">certificateForName</span><span class="op" id="7774844">(</span><span class="string" id="7774845">&#34;example.com&#34;</span><span class="op" id="7774858">)</span><span class="op" id="7774859">)</span><span class="op" id="7774860">;</span>&nbsp;<span class="ident" id="7774862">n</span>&nbsp;<span class="op" id="7774864">!=</span>&nbsp;<span class="num" id="7774867">0</span>&nbsp;<span class="op" id="7774869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774873">t</span><span class="op" id="7774874">.</span><span class="ident" id="7774875">Errorf</span><span class="op" id="7774881">(</span><span class="string" id="7774882">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7774926">,</span>&nbsp;<span class="ident" id="7774928">n</span><span class="op" id="7774929">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774935">if</span>&nbsp;<span class="ident" id="7774938">n</span>&nbsp;<span class="op" id="7774940">:=</span>&nbsp;<span class="ident" id="7774943">pointerToIndex</span><span class="op" id="7774957">(</span><span class="ident" id="7774958">certificateForName</span><span class="op" id="7774976">(</span><span class="string" id="7774977">&#34;bar.example.com&#34;</span><span class="op" id="7774994">)</span><span class="op" id="7774995">)</span><span class="op" id="7774996">;</span>&nbsp;<span class="ident" id="7774998">n</span>&nbsp;<span class="op" id="7775000">!=</span>&nbsp;<span class="num" id="7775003">1</span>&nbsp;<span class="op" id="7775005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775009">t</span><span class="op" id="7775010">.</span><span class="ident" id="7775011">Errorf</span><span class="op" id="7775017">(</span><span class="string" id="7775018">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7775066">,</span>&nbsp;<span class="ident" id="7775068">n</span><span class="op" id="7775069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775075">if</span>&nbsp;<span class="ident" id="7775078">n</span>&nbsp;<span class="op" id="7775080">:=</span>&nbsp;<span class="ident" id="7775083">pointerToIndex</span><span class="op" id="7775097">(</span><span class="ident" id="7775098">certificateForName</span><span class="op" id="7775116">(</span><span class="string" id="7775117">&#34;foo.example.com&#34;</span><span class="op" id="7775134">)</span><span class="op" id="7775135">)</span><span class="op" id="7775136">;</span>&nbsp;<span class="ident" id="7775138">n</span>&nbsp;<span class="op" id="7775140">!=</span>&nbsp;<span class="num" id="7775143">2</span>&nbsp;<span class="op" id="7775145">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775149">t</span><span class="op" id="7775150">.</span><span class="ident" id="7775151">Errorf</span><span class="op" id="7775157">(</span><span class="string" id="7775158">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7775206">,</span>&nbsp;<span class="ident" id="7775208">n</span><span class="op" id="7775209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775215">if</span>&nbsp;<span class="ident" id="7775218">n</span>&nbsp;<span class="op" id="7775220">:=</span>&nbsp;<span class="ident" id="7775223">pointerToIndex</span><span class="op" id="7775237">(</span><span class="ident" id="7775238">certificateForName</span><span class="op" id="7775256">(</span><span class="string" id="7775257">&#34;foo.bar.example.com&#34;</span><span class="op" id="7775278">)</span><span class="op" id="7775279">)</span><span class="op" id="7775280">;</span>&nbsp;<span class="ident" id="7775282">n</span>&nbsp;<span class="op" id="7775284">!=</span>&nbsp;<span class="num" id="7775287">3</span>&nbsp;<span class="op" id="7775289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775293">t</span><span class="op" id="7775294">.</span><span class="ident" id="7775295">Errorf</span><span class="op" id="7775301">(</span><span class="string" id="7775302">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7775354">,</span>&nbsp;<span class="ident" id="7775356">n</span><span class="op" id="7775357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775360">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7775363">if</span>&nbsp;<span class="ident" id="7775366">n</span>&nbsp;<span class="op" id="7775368">:=</span>&nbsp;<span class="ident" id="7775371">pointerToIndex</span><span class="op" id="7775385">(</span><span class="ident" id="7775386">certificateForName</span><span class="op" id="7775404">(</span><span class="string" id="7775405">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7775430">)</span><span class="op" id="7775431">)</span><span class="op" id="7775432">;</span>&nbsp;<span class="ident" id="7775434">n</span>&nbsp;<span class="op" id="7775436">!=</span>&nbsp;<span class="num" id="7775439">0</span>&nbsp;<span class="op" id="7775441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775445">t</span><span class="op" id="7775446">.</span><span class="ident" id="7775447">Errorf</span><span class="op" id="7775453">(</span><span class="string" id="7775454">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7775510">,</span>&nbsp;<span class="ident" id="7775512">n</span><span class="op" id="7775513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7775516">}</span><br>
<span class="lineno"></span><span class="op" id="7775518">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
