<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3249936">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3249991">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3250045">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3250096">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3250161">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3250210">package</span>&nbsp;<span class="ident" id="3250218">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3250223">type</span>&nbsp;<span class="ident" id="3250228">dnsConfig</span>&nbsp;<span class="keyword" id="3250238">struct</span>&nbsp;<span class="op" id="3250245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250248">servers</span>&nbsp;&nbsp;<span class="op" id="3250257">[</span><span class="op" id="3250258">]</span><span class="builtintype" id="3250259">string</span>&nbsp;<span class="comment" id="3250266">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250285">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3250294">[</span><span class="op" id="3250295">]</span><span class="builtintype" id="3250296">string</span>&nbsp;<span class="comment" id="3250303">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250340">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3250349">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3250358">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250412">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="3250421">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3250430">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250469">attempts</span>&nbsp;<span class="builtintype" id="3250478">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3250487">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250531">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3250540">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3250549">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="3250578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3250581">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3250623">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3250685">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="3250739">func</span>&nbsp;<span class="ident" id="3250744">dnsReadConfig</span><span class="op" id="3250757">(</span><span class="ident" id="3250758">filename</span>&nbsp;<span class="builtintype" id="3250767">string</span><span class="op" id="3250773">)</span>&nbsp;<span class="op" id="3250775">(</span><span class="op" id="3250776">*</span><span class="ident" id="3250777">dnsConfig</span><span class="op" id="3250786">,</span>&nbsp;<span class="builtintype" id="3250788">error</span><span class="op" id="3250793">)</span>&nbsp;<span class="op" id="3250795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250798">file</span><span class="op" id="3250802">,</span>&nbsp;<span class="ident" id="3250804">err</span>&nbsp;<span class="op" id="3250808">:=</span>&nbsp;<span class="ident" id="3250811">open</span><span class="op" id="3250815">(</span><span class="ident" id="3250816">filename</span><span class="op" id="3250824">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250827">if</span>&nbsp;<span class="ident" id="3250830">err</span>&nbsp;<span class="op" id="3250834">!=</span>&nbsp;<span class="ident" id="3250837">nil</span>&nbsp;<span class="op" id="3250841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250845">return</span>&nbsp;<span class="ident" id="3250852">nil</span><span class="op" id="3250855">,</span>&nbsp;<span class="op" id="3250857">&amp;</span><span class="ident" id="3250858">DNSConfigError</span><span class="op" id="3250872">{</span><span class="ident" id="3250873">err</span><span class="op" id="3250876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250882">defer</span>&nbsp;<span class="ident" id="3250888">file</span><span class="op" id="3250892">.</span><span class="builtinfunc" id="3250893">close</span><span class="op" id="3250898">(</span><span class="op" id="3250899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250902">conf</span>&nbsp;<span class="op" id="3250907">:=</span>&nbsp;<span class="op" id="3250910">&amp;</span><span class="ident" id="3250911">dnsConfig</span><span class="op" id="3250920">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250924">ndots</span><span class="op" id="3250929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3250934">1</span><span class="op" id="3250935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250939">timeout</span><span class="op" id="3250946">:</span>&nbsp;&nbsp;<span class="num" id="3250949">5</span><span class="op" id="3250950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3250954">attempts</span><span class="op" id="3250962">:</span>&nbsp;<span class="num" id="3250964">2</span><span class="op" id="3250965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3250968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3250971">for</span>&nbsp;<span class="ident" id="3250975">line</span><span class="op" id="3250979">,</span>&nbsp;<span class="ident" id="3250981">ok</span>&nbsp;<span class="op" id="3250984">:=</span>&nbsp;<span class="ident" id="3250987">file</span><span class="op" id="3250991">.</span><span class="ident" id="3250992">readLine</span><span class="op" id="3251000">(</span><span class="op" id="3251001">)</span><span class="op" id="3251002">;</span>&nbsp;<span class="ident" id="3251004">ok</span><span class="op" id="3251006">;</span>&nbsp;<span class="ident" id="3251008">line</span><span class="op" id="3251012">,</span>&nbsp;<span class="ident" id="3251014">ok</span>&nbsp;<span class="op" id="3251017">=</span>&nbsp;<span class="ident" id="3251019">file</span><span class="op" id="3251023">.</span><span class="ident" id="3251024">readLine</span><span class="op" id="3251032">(</span><span class="op" id="3251033">)</span>&nbsp;<span class="op" id="3251035">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251039">f</span>&nbsp;<span class="op" id="3251041">:=</span>&nbsp;<span class="ident" id="3251044">getFields</span><span class="op" id="3251053">(</span><span class="ident" id="3251054">line</span><span class="op" id="3251058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251062">if</span>&nbsp;<span class="builtinfunc" id="3251065">len</span><span class="op" id="3251068">(</span><span class="ident" id="3251069">f</span><span class="op" id="3251070">)</span>&nbsp;<span class="op" id="3251072">&lt;</span>&nbsp;<span class="num" id="3251074">1</span>&nbsp;<span class="op" id="3251076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251081">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251096">switch</span>&nbsp;<span class="ident" id="3251103">f</span><span class="op" id="3251104">[</span><span class="num" id="3251105">0</span><span class="op" id="3251106">]</span>&nbsp;<span class="op" id="3251108">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251112">case</span>&nbsp;<span class="string" id="3251117">&#34;nameserver&#34;</span><span class="op" id="3251129">:</span>&nbsp;<span class="comment" id="3251131">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251157">if</span>&nbsp;<span class="builtinfunc" id="3251160">len</span><span class="op" id="3251163">(</span><span class="ident" id="3251164">f</span><span class="op" id="3251165">)</span>&nbsp;<span class="op" id="3251167">&gt;</span>&nbsp;<span class="num" id="3251169">1</span>&nbsp;<span class="op" id="3251171">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3251174">len</span><span class="op" id="3251177">(</span><span class="ident" id="3251178">conf</span><span class="op" id="3251182">.</span><span class="ident" id="3251183">servers</span><span class="op" id="3251190">)</span>&nbsp;<span class="op" id="3251192">&lt;</span>&nbsp;<span class="num" id="3251194">3</span>&nbsp;<span class="op" id="3251196">{</span>&nbsp;<span class="comment" id="3251198">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251235">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251283">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3251333">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251355">if</span>&nbsp;<span class="ident" id="3251358">parseIPv4</span><span class="op" id="3251367">(</span><span class="ident" id="3251368">f</span><span class="op" id="3251369">[</span><span class="num" id="3251370">1</span><span class="op" id="3251371">]</span><span class="op" id="3251372">)</span>&nbsp;<span class="op" id="3251374">!=</span>&nbsp;<span class="ident" id="3251377">nil</span>&nbsp;<span class="op" id="3251381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251388">conf</span><span class="op" id="3251392">.</span><span class="ident" id="3251393">servers</span>&nbsp;<span class="op" id="3251401">=</span>&nbsp;<span class="builtinfunc" id="3251403">append</span><span class="op" id="3251409">(</span><span class="ident" id="3251410">conf</span><span class="op" id="3251414">.</span><span class="ident" id="3251415">servers</span><span class="op" id="3251422">,</span>&nbsp;<span class="ident" id="3251424">f</span><span class="op" id="3251425">[</span><span class="num" id="3251426">1</span><span class="op" id="3251427">]</span><span class="op" id="3251428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251434">}</span>&nbsp;<span class="keyword" id="3251436">else</span>&nbsp;<span class="keyword" id="3251441">if</span>&nbsp;<span class="ident" id="3251444">ip</span><span class="op" id="3251446">,</span>&nbsp;<span class="ident" id="3251448">_</span>&nbsp;<span class="op" id="3251450">:=</span>&nbsp;<span class="ident" id="3251453">parseIPv6</span><span class="op" id="3251462">(</span><span class="ident" id="3251463">f</span><span class="op" id="3251464">[</span><span class="num" id="3251465">1</span><span class="op" id="3251466">]</span><span class="op" id="3251467">,</span>&nbsp;<span class="builtintype" id="3251469">true</span><span class="op" id="3251473">)</span><span class="op" id="3251474">;</span>&nbsp;<span class="ident" id="3251476">ip</span>&nbsp;<span class="op" id="3251479">!=</span>&nbsp;<span class="ident" id="3251482">nil</span>&nbsp;<span class="op" id="3251486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251493">conf</span><span class="op" id="3251497">.</span><span class="ident" id="3251498">servers</span>&nbsp;<span class="op" id="3251506">=</span>&nbsp;<span class="builtinfunc" id="3251508">append</span><span class="op" id="3251514">(</span><span class="ident" id="3251515">conf</span><span class="op" id="3251519">.</span><span class="ident" id="3251520">servers</span><span class="op" id="3251527">,</span>&nbsp;<span class="ident" id="3251529">f</span><span class="op" id="3251530">[</span><span class="num" id="3251531">1</span><span class="op" id="3251532">]</span><span class="op" id="3251533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251539">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251549">case</span>&nbsp;<span class="string" id="3251554">&#34;domain&#34;</span><span class="op" id="3251562">:</span>&nbsp;<span class="comment" id="3251564">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251606">if</span>&nbsp;<span class="builtinfunc" id="3251609">len</span><span class="op" id="3251612">(</span><span class="ident" id="3251613">f</span><span class="op" id="3251614">)</span>&nbsp;<span class="op" id="3251616">&gt;</span>&nbsp;<span class="num" id="3251618">1</span>&nbsp;<span class="op" id="3251620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251626">conf</span><span class="op" id="3251630">.</span><span class="ident" id="3251631">search</span>&nbsp;<span class="op" id="3251638">=</span>&nbsp;<span class="op" id="3251640">[</span><span class="op" id="3251641">]</span><span class="builtintype" id="3251642">string</span><span class="op" id="3251648">{</span><span class="ident" id="3251649">f</span><span class="op" id="3251650">[</span><span class="num" id="3251651">1</span><span class="op" id="3251652">]</span><span class="op" id="3251653">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251663">case</span>&nbsp;<span class="string" id="3251668">&#34;search&#34;</span><span class="op" id="3251676">:</span>&nbsp;<span class="comment" id="3251678">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251717">conf</span><span class="op" id="3251721">.</span><span class="ident" id="3251722">search</span>&nbsp;<span class="op" id="3251729">=</span>&nbsp;<span class="builtinfunc" id="3251731">make</span><span class="op" id="3251735">(</span><span class="op" id="3251736">[</span><span class="op" id="3251737">]</span><span class="builtintype" id="3251738">string</span><span class="op" id="3251744">,</span>&nbsp;<span class="builtinfunc" id="3251746">len</span><span class="op" id="3251749">(</span><span class="ident" id="3251750">f</span><span class="op" id="3251751">)</span><span class="op" id="3251752">-</span><span class="num" id="3251753">1</span><span class="op" id="3251754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251759">for</span>&nbsp;<span class="ident" id="3251763">i</span>&nbsp;<span class="op" id="3251765">:=</span>&nbsp;<span class="num" id="3251768">0</span><span class="op" id="3251769">;</span>&nbsp;<span class="ident" id="3251771">i</span>&nbsp;<span class="op" id="3251773">&lt;</span>&nbsp;<span class="builtinfunc" id="3251775">len</span><span class="op" id="3251778">(</span><span class="ident" id="3251779">conf</span><span class="op" id="3251783">.</span><span class="ident" id="3251784">search</span><span class="op" id="3251790">)</span><span class="op" id="3251791">;</span>&nbsp;<span class="ident" id="3251793">i</span><span class="op" id="3251794">++</span>&nbsp;<span class="op" id="3251797">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251803">conf</span><span class="op" id="3251807">.</span><span class="ident" id="3251808">search</span><span class="op" id="3251814">[</span><span class="ident" id="3251815">i</span><span class="op" id="3251816">]</span>&nbsp;<span class="op" id="3251818">=</span>&nbsp;<span class="ident" id="3251820">f</span><span class="op" id="3251821">[</span><span class="ident" id="3251822">i</span><span class="op" id="3251823">+</span><span class="num" id="3251824">1</span><span class="op" id="3251825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3251830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251835">case</span>&nbsp;<span class="string" id="3251840">&#34;options&#34;</span><span class="op" id="3251849">:</span>&nbsp;<span class="comment" id="3251851">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251871">for</span>&nbsp;<span class="ident" id="3251875">i</span>&nbsp;<span class="op" id="3251877">:=</span>&nbsp;<span class="num" id="3251880">1</span><span class="op" id="3251881">;</span>&nbsp;<span class="ident" id="3251883">i</span>&nbsp;<span class="op" id="3251885">&lt;</span>&nbsp;<span class="builtinfunc" id="3251887">len</span><span class="op" id="3251890">(</span><span class="ident" id="3251891">f</span><span class="op" id="3251892">)</span><span class="op" id="3251893">;</span>&nbsp;<span class="ident" id="3251895">i</span><span class="op" id="3251896">++</span>&nbsp;<span class="op" id="3251899">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251905">s</span>&nbsp;<span class="op" id="3251907">:=</span>&nbsp;<span class="ident" id="3251910">f</span><span class="op" id="3251911">[</span><span class="ident" id="3251912">i</span><span class="op" id="3251913">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251919">switch</span>&nbsp;<span class="op" id="3251926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251932">case</span>&nbsp;<span class="ident" id="3251937">hasPrefix</span><span class="op" id="3251946">(</span><span class="ident" id="3251947">s</span><span class="op" id="3251948">,</span>&nbsp;<span class="string" id="3251950">&#34;ndots:&#34;</span><span class="op" id="3251958">)</span><span class="op" id="3251959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3251966">n</span><span class="op" id="3251967">,</span>&nbsp;<span class="ident" id="3251969">_</span><span class="op" id="3251970">,</span>&nbsp;<span class="ident" id="3251972">_</span>&nbsp;<span class="op" id="3251974">:=</span>&nbsp;<span class="ident" id="3251977">dtoi</span><span class="op" id="3251981">(</span><span class="ident" id="3251982">s</span><span class="op" id="3251983">,</span>&nbsp;<span class="num" id="3251985">6</span><span class="op" id="3251986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3251993">if</span>&nbsp;<span class="ident" id="3251996">n</span>&nbsp;<span class="op" id="3251998">&lt;</span>&nbsp;<span class="num" id="3252000">1</span>&nbsp;<span class="op" id="3252002">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252010">n</span>&nbsp;<span class="op" id="3252012">=</span>&nbsp;<span class="num" id="3252014">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252028">conf</span><span class="op" id="3252032">.</span><span class="ident" id="3252033">ndots</span>&nbsp;<span class="op" id="3252039">=</span>&nbsp;<span class="ident" id="3252041">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252047">case</span>&nbsp;<span class="ident" id="3252052">hasPrefix</span><span class="op" id="3252061">(</span><span class="ident" id="3252062">s</span><span class="op" id="3252063">,</span>&nbsp;<span class="string" id="3252065">&#34;timeout:&#34;</span><span class="op" id="3252075">)</span><span class="op" id="3252076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252083">n</span><span class="op" id="3252084">,</span>&nbsp;<span class="ident" id="3252086">_</span><span class="op" id="3252087">,</span>&nbsp;<span class="ident" id="3252089">_</span>&nbsp;<span class="op" id="3252091">:=</span>&nbsp;<span class="ident" id="3252094">dtoi</span><span class="op" id="3252098">(</span><span class="ident" id="3252099">s</span><span class="op" id="3252100">,</span>&nbsp;<span class="num" id="3252102">8</span><span class="op" id="3252103">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252110">if</span>&nbsp;<span class="ident" id="3252113">n</span>&nbsp;<span class="op" id="3252115">&lt;</span>&nbsp;<span class="num" id="3252117">1</span>&nbsp;<span class="op" id="3252119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252127">n</span>&nbsp;<span class="op" id="3252129">=</span>&nbsp;<span class="num" id="3252131">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252145">conf</span><span class="op" id="3252149">.</span><span class="ident" id="3252150">timeout</span>&nbsp;<span class="op" id="3252158">=</span>&nbsp;<span class="ident" id="3252160">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252166">case</span>&nbsp;<span class="ident" id="3252171">hasPrefix</span><span class="op" id="3252180">(</span><span class="ident" id="3252181">s</span><span class="op" id="3252182">,</span>&nbsp;<span class="string" id="3252184">&#34;attempts:&#34;</span><span class="op" id="3252195">)</span><span class="op" id="3252196">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252203">n</span><span class="op" id="3252204">,</span>&nbsp;<span class="ident" id="3252206">_</span><span class="op" id="3252207">,</span>&nbsp;<span class="ident" id="3252209">_</span>&nbsp;<span class="op" id="3252211">:=</span>&nbsp;<span class="ident" id="3252214">dtoi</span><span class="op" id="3252218">(</span><span class="ident" id="3252219">s</span><span class="op" id="3252220">,</span>&nbsp;<span class="num" id="3252222">9</span><span class="op" id="3252223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252230">if</span>&nbsp;<span class="ident" id="3252233">n</span>&nbsp;<span class="op" id="3252235">&lt;</span>&nbsp;<span class="num" id="3252237">1</span>&nbsp;<span class="op" id="3252239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252247">n</span>&nbsp;<span class="op" id="3252249">=</span>&nbsp;<span class="num" id="3252251">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252265">conf</span><span class="op" id="3252269">.</span><span class="ident" id="3252270">attempts</span>&nbsp;<span class="op" id="3252279">=</span>&nbsp;<span class="ident" id="3252281">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252287">case</span>&nbsp;<span class="ident" id="3252292">s</span>&nbsp;<span class="op" id="3252294">==</span>&nbsp;<span class="string" id="3252297">&#34;rotate&#34;</span><span class="op" id="3252305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3252312">conf</span><span class="op" id="3252316">.</span><span class="ident" id="3252317">rotate</span>&nbsp;<span class="op" id="3252324">=</span>&nbsp;<span class="builtintype" id="3252326">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252344">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3252347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252350">return</span>&nbsp;<span class="ident" id="3252357">conf</span><span class="op" id="3252361">,</span>&nbsp;<span class="ident" id="3252363">nil</span><br>
<span class="lineno"></span><span class="op" id="3252367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3252370">func</span>&nbsp;<span class="ident" id="3252375">hasPrefix</span><span class="op" id="3252384">(</span><span class="ident" id="3252385">s</span><span class="op" id="3252386">,</span>&nbsp;<span class="ident" id="3252388">prefix</span>&nbsp;<span class="builtintype" id="3252395">string</span><span class="op" id="3252401">)</span>&nbsp;<span class="builtintype" id="3252403">bool</span>&nbsp;<span class="op" id="3252408">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3252411">return</span>&nbsp;<span class="builtinfunc" id="3252418">len</span><span class="op" id="3252421">(</span><span class="ident" id="3252422">s</span><span class="op" id="3252423">)</span>&nbsp;<span class="op" id="3252425">&gt;=</span>&nbsp;<span class="builtinfunc" id="3252428">len</span><span class="op" id="3252431">(</span><span class="ident" id="3252432">prefix</span><span class="op" id="3252438">)</span>&nbsp;<span class="op" id="3252440">&amp;&amp;</span>&nbsp;<span class="ident" id="3252443">s</span><span class="op" id="3252444">[</span><span class="op" id="3252445">:</span><span class="builtinfunc" id="3252446">len</span><span class="op" id="3252449">(</span><span class="ident" id="3252450">prefix</span><span class="op" id="3252456">)</span><span class="op" id="3252457">]</span>&nbsp;<span class="op" id="3252459">==</span>&nbsp;<span class="ident" id="3252462">prefix</span><br>
<span class="lineno"></span><span class="op" id="3252469">}</span>
</div>
</body>
</html>
