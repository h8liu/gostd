<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2201477">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2201532">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2201586">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2201637">package</span>&nbsp;<span class="ident" id="2201645">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201651">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2201691">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2201751">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2201815">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2201873">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2201931">//</span><br>
<span class="lineno"></span><span class="comment" id="2201934">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2201948">//</span><br>
<span class="lineno"></span><span class="comment" id="2201951">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2201973">//</span><br>
<span class="lineno">20</span><span class="comment" id="2201976">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2201989">//</span><br>
<span class="lineno"></span><span class="comment" id="2201992">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2202015">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2202032">//</span><br>
<span class="lineno">25</span><span class="comment" id="2202035">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2202051">//</span><br>
<span class="lineno"></span><span class="comment" id="2202054">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2202131">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2202201">//</span><br>
<span class="lineno">30</span><span class="comment" id="2202204">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2202260">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2202310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2202338">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2202392">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2202420">//</span><br>
<span class="lineno"></span><span class="comment" id="2202423">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2202436">//</span><br>
<span class="lineno"></span><span class="comment" id="2202439">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2202479">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2202538">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2202599">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2202660">//</span><br>
<span class="lineno"></span><span class="comment" id="2202663">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2202741">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2202817">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2202859">//</span><br>
<span class="lineno"></span><span class="comment" id="2202862">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2202876">//</span><br>
<span class="lineno"></span><span class="comment" id="2202879">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2202903">//</span><br>
<span class="lineno"></span><span class="comment" id="2202906">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2202919">//</span><br>
<span class="lineno"></span><span class="comment" id="2202922">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2202945">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2202962">//</span><br>
<span class="lineno"></span><span class="comment" id="2202965">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2202981">//</span><br>
<span class="lineno"></span><span class="comment" id="2202984">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2203061">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2203131">//</span><br>
<span class="lineno"></span><span class="comment" id="2203134">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2203190">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2203242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2203270">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2203322">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2203350">//</span><br>
<span class="lineno"></span><span class="comment" id="2203353">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2203366">//</span><br>
<span class="lineno"></span><span class="comment" id="2203369">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2203409">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2203468">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2203529">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2203590">//</span><br>
<span class="lineno"></span><span class="comment" id="2203593">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2203641">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2203705">//</span><br>
<span class="lineno"></span><span class="comment" id="2203708">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2203769">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2203839">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2203914">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2203981">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2204054">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2204126">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2204140">//</span><br>
<span class="lineno">85</span><span class="comment" id="2204143">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2204209">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2204275">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2204288">//</span><br>
<span class="lineno"></span><span class="comment" id="2204291">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2204315">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2204345">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2204365">var</span>&nbsp;<span class="ident" id="2204369">_sin</span>&nbsp;<span class="op" id="2204374">=</span>&nbsp;<span class="op" id="2204376">[</span><span class="op" id="2204377">...</span><span class="op" id="2204380">]</span><span class="builtintype" id="2204381">float64</span><span class="op" id="2204388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2204391">1.58962301576546568060E-10</span><span class="op" id="2204417">,</span>&nbsp;<span class="comment" id="2204419">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204442">-</span><span class="num" id="2204443">2.50507477628578072866E-8</span><span class="op" id="2204468">,</span>&nbsp;<span class="comment" id="2204470">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2204493">2.75573136213857245213E-6</span><span class="op" id="2204518">,</span>&nbsp;&nbsp;<span class="comment" id="2204521">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204544">-</span><span class="num" id="2204545">1.98412698295895385996E-4</span><span class="op" id="2204570">,</span>&nbsp;<span class="comment" id="2204572">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2204595">8.33333333332211858878E-3</span><span class="op" id="2204620">,</span>&nbsp;&nbsp;<span class="comment" id="2204623">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204646">-</span><span class="num" id="2204647">1.66666666666666307295E-1</span><span class="op" id="2204672">,</span>&nbsp;<span class="comment" id="2204674">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2204696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2204699">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2204719">var</span>&nbsp;<span class="ident" id="2204723">_cos</span>&nbsp;<span class="op" id="2204728">=</span>&nbsp;<span class="op" id="2204730">[</span><span class="op" id="2204731">...</span><span class="op" id="2204734">]</span><span class="builtintype" id="2204735">float64</span><span class="op" id="2204742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204745">-</span><span class="num" id="2204746">1.13585365213876817300E-11</span><span class="op" id="2204772">,</span>&nbsp;<span class="comment" id="2204774">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2204797">2.08757008419747316778E-9</span><span class="op" id="2204822">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204826">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204849">-</span><span class="num" id="2204850">2.75573141792967388112E-7</span><span class="op" id="2204875">,</span>&nbsp;&nbsp;<span class="comment" id="2204878">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2204901">2.48015872888517045348E-5</span><span class="op" id="2204926">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2204930">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2204953">-</span><span class="num" id="2204954">1.38888888888730564116E-3</span><span class="op" id="2204979">,</span>&nbsp;&nbsp;<span class="comment" id="2204982">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2205005">4.16666666666665929218E-2</span><span class="op" id="2205030">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2205034">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2205056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2205059">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2205111">//</span><br>
<span class="lineno"></span><span class="comment" id="2205114">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2205136">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2205156">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2205174">func</span>&nbsp;<span class="ident" id="2205179">Cos</span><span class="op" id="2205182">(</span><span class="ident" id="2205183">x</span>&nbsp;<span class="builtintype" id="2205185">float64</span><span class="op" id="2205192">)</span>&nbsp;<span class="builtintype" id="2205194">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2205203">func</span>&nbsp;<span class="ident" id="2205208">cos</span><span class="op" id="2205211">(</span><span class="ident" id="2205212">x</span>&nbsp;<span class="builtintype" id="2205214">float64</span><span class="op" id="2205221">)</span>&nbsp;<span class="builtintype" id="2205223">float64</span>&nbsp;<span class="op" id="2205231">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205234">const</span>&nbsp;<span class="op" id="2205240">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205244">PI4A</span>&nbsp;<span class="op" id="2205249">=</span>&nbsp;<span class="num" id="2205251">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2205305">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205358">PI4B</span>&nbsp;<span class="op" id="2205363">=</span>&nbsp;<span class="num" id="2205365">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2205419">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205444">PI4C</span>&nbsp;<span class="op" id="2205449">=</span>&nbsp;<span class="num" id="2205451">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2205505">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205530">M4PI</span>&nbsp;<span class="op" id="2205535">=</span>&nbsp;<span class="num" id="2205537">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2205591">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2205603">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205621">switch</span>&nbsp;<span class="op" id="2205628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205631">case</span>&nbsp;<span class="ident" id="2205636">IsNaN</span><span class="op" id="2205641">(</span><span class="ident" id="2205642">x</span><span class="op" id="2205643">)</span>&nbsp;<span class="op" id="2205645">||</span>&nbsp;<span class="ident" id="2205648">IsInf</span><span class="op" id="2205653">(</span><span class="ident" id="2205654">x</span><span class="op" id="2205655">,</span>&nbsp;<span class="num" id="2205657">0</span><span class="op" id="2205658">)</span><span class="op" id="2205659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205663">return</span>&nbsp;<span class="ident" id="2205670">NaN</span><span class="op" id="2205673">(</span><span class="op" id="2205674">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2205681">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205708">sign</span>&nbsp;<span class="op" id="2205713">:=</span>&nbsp;<span class="builtintype" id="2205716">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205723">if</span>&nbsp;<span class="ident" id="2205726">x</span>&nbsp;<span class="op" id="2205728">&lt;</span>&nbsp;<span class="num" id="2205730">0</span>&nbsp;<span class="op" id="2205732">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205736">x</span>&nbsp;<span class="op" id="2205738">=</span>&nbsp;<span class="op" id="2205740">-</span><span class="ident" id="2205741">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205748">j</span>&nbsp;<span class="op" id="2205750">:=</span>&nbsp;<span class="ident" id="2205753">int64</span><span class="op" id="2205758">(</span><span class="ident" id="2205759">x</span>&nbsp;<span class="op" id="2205761">*</span>&nbsp;<span class="ident" id="2205763">M4PI</span><span class="op" id="2205767">)</span>&nbsp;<span class="comment" id="2205769">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205839">y</span>&nbsp;<span class="op" id="2205841">:=</span>&nbsp;<span class="builtintype" id="2205844">float64</span><span class="op" id="2205851">(</span><span class="ident" id="2205852">j</span><span class="op" id="2205853">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2205860">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2205900">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2205924">if</span>&nbsp;<span class="ident" id="2205927">j</span><span class="op" id="2205928">&amp;</span><span class="num" id="2205929">1</span>&nbsp;<span class="op" id="2205931">==</span>&nbsp;<span class="num" id="2205934">1</span>&nbsp;<span class="op" id="2205936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205940">j</span>&nbsp;<span class="op" id="2205942">+=</span>&nbsp;<span class="num" id="2205945">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205949">y</span>&nbsp;<span class="op" id="2205951">+=</span>&nbsp;<span class="num" id="2205954">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2205957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2205960">j</span>&nbsp;<span class="op" id="2205962">&amp;=</span>&nbsp;<span class="num" id="2205965">7</span>&nbsp;<span class="comment" id="2205967">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206011">if</span>&nbsp;<span class="ident" id="2206014">j</span>&nbsp;<span class="op" id="2206016">&gt;</span>&nbsp;<span class="num" id="2206018">3</span>&nbsp;<span class="op" id="2206020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206024">j</span>&nbsp;<span class="op" id="2206026">-=</span>&nbsp;<span class="num" id="2206029">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206033">sign</span>&nbsp;<span class="op" id="2206038">=</span>&nbsp;<span class="op" id="2206040">!</span><span class="ident" id="2206041">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206050">if</span>&nbsp;<span class="ident" id="2206053">j</span>&nbsp;<span class="op" id="2206055">&gt;</span>&nbsp;<span class="num" id="2206057">1</span>&nbsp;<span class="op" id="2206059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206063">sign</span>&nbsp;<span class="op" id="2206068">=</span>&nbsp;<span class="op" id="2206070">!</span><span class="ident" id="2206071">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206081">z</span>&nbsp;<span class="op" id="2206083">:=</span>&nbsp;<span class="op" id="2206086">(</span><span class="op" id="2206087">(</span><span class="ident" id="2206088">x</span>&nbsp;<span class="op" id="2206090">-</span>&nbsp;<span class="ident" id="2206092">y</span><span class="op" id="2206093">*</span><span class="ident" id="2206094">PI4A</span><span class="op" id="2206098">)</span>&nbsp;<span class="op" id="2206100">-</span>&nbsp;<span class="ident" id="2206102">y</span><span class="op" id="2206103">*</span><span class="ident" id="2206104">PI4B</span><span class="op" id="2206108">)</span>&nbsp;<span class="op" id="2206110">-</span>&nbsp;<span class="ident" id="2206112">y</span><span class="op" id="2206113">*</span><span class="ident" id="2206114">PI4C</span>&nbsp;<span class="comment" id="2206119">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206161">zz</span>&nbsp;<span class="op" id="2206164">:=</span>&nbsp;<span class="ident" id="2206167">z</span>&nbsp;<span class="op" id="2206169">*</span>&nbsp;<span class="ident" id="2206171">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206174">if</span>&nbsp;<span class="ident" id="2206177">j</span>&nbsp;<span class="op" id="2206179">==</span>&nbsp;<span class="num" id="2206182">1</span>&nbsp;<span class="op" id="2206184">||</span>&nbsp;<span class="ident" id="2206187">j</span>&nbsp;<span class="op" id="2206189">==</span>&nbsp;<span class="num" id="2206192">2</span>&nbsp;<span class="op" id="2206194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206198">y</span>&nbsp;<span class="op" id="2206200">=</span>&nbsp;<span class="ident" id="2206202">z</span>&nbsp;<span class="op" id="2206204">+</span>&nbsp;<span class="ident" id="2206206">z</span><span class="op" id="2206207">*</span><span class="ident" id="2206208">zz</span><span class="op" id="2206210">*</span><span class="op" id="2206211">(</span><span class="op" id="2206212">(</span><span class="op" id="2206213">(</span><span class="op" id="2206214">(</span><span class="op" id="2206215">(</span><span class="op" id="2206216">(</span><span class="ident" id="2206217">_sin</span><span class="op" id="2206221">[</span><span class="num" id="2206222">0</span><span class="op" id="2206223">]</span><span class="op" id="2206224">*</span><span class="ident" id="2206225">zz</span><span class="op" id="2206227">)</span><span class="op" id="2206228">+</span><span class="ident" id="2206229">_sin</span><span class="op" id="2206233">[</span><span class="num" id="2206234">1</span><span class="op" id="2206235">]</span><span class="op" id="2206236">)</span><span class="op" id="2206237">*</span><span class="ident" id="2206238">zz</span><span class="op" id="2206240">+</span><span class="ident" id="2206241">_sin</span><span class="op" id="2206245">[</span><span class="num" id="2206246">2</span><span class="op" id="2206247">]</span><span class="op" id="2206248">)</span><span class="op" id="2206249">*</span><span class="ident" id="2206250">zz</span><span class="op" id="2206252">+</span><span class="ident" id="2206253">_sin</span><span class="op" id="2206257">[</span><span class="num" id="2206258">3</span><span class="op" id="2206259">]</span><span class="op" id="2206260">)</span><span class="op" id="2206261">*</span><span class="ident" id="2206262">zz</span><span class="op" id="2206264">+</span><span class="ident" id="2206265">_sin</span><span class="op" id="2206269">[</span><span class="num" id="2206270">4</span><span class="op" id="2206271">]</span><span class="op" id="2206272">)</span><span class="op" id="2206273">*</span><span class="ident" id="2206274">zz</span><span class="op" id="2206276">+</span><span class="ident" id="2206277">_sin</span><span class="op" id="2206281">[</span><span class="num" id="2206282">5</span><span class="op" id="2206283">]</span><span class="op" id="2206284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206287">}</span>&nbsp;<span class="keyword" id="2206289">else</span>&nbsp;<span class="op" id="2206294">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206298">y</span>&nbsp;<span class="op" id="2206300">=</span>&nbsp;<span class="num" id="2206302">1.0</span>&nbsp;<span class="op" id="2206306">-</span>&nbsp;<span class="num" id="2206308">0.5</span><span class="op" id="2206311">*</span><span class="ident" id="2206312">zz</span>&nbsp;<span class="op" id="2206315">+</span>&nbsp;<span class="ident" id="2206317">zz</span><span class="op" id="2206319">*</span><span class="ident" id="2206320">zz</span><span class="op" id="2206322">*</span><span class="op" id="2206323">(</span><span class="op" id="2206324">(</span><span class="op" id="2206325">(</span><span class="op" id="2206326">(</span><span class="op" id="2206327">(</span><span class="op" id="2206328">(</span><span class="ident" id="2206329">_cos</span><span class="op" id="2206333">[</span><span class="num" id="2206334">0</span><span class="op" id="2206335">]</span><span class="op" id="2206336">*</span><span class="ident" id="2206337">zz</span><span class="op" id="2206339">)</span><span class="op" id="2206340">+</span><span class="ident" id="2206341">_cos</span><span class="op" id="2206345">[</span><span class="num" id="2206346">1</span><span class="op" id="2206347">]</span><span class="op" id="2206348">)</span><span class="op" id="2206349">*</span><span class="ident" id="2206350">zz</span><span class="op" id="2206352">+</span><span class="ident" id="2206353">_cos</span><span class="op" id="2206357">[</span><span class="num" id="2206358">2</span><span class="op" id="2206359">]</span><span class="op" id="2206360">)</span><span class="op" id="2206361">*</span><span class="ident" id="2206362">zz</span><span class="op" id="2206364">+</span><span class="ident" id="2206365">_cos</span><span class="op" id="2206369">[</span><span class="num" id="2206370">3</span><span class="op" id="2206371">]</span><span class="op" id="2206372">)</span><span class="op" id="2206373">*</span><span class="ident" id="2206374">zz</span><span class="op" id="2206376">+</span><span class="ident" id="2206377">_cos</span><span class="op" id="2206381">[</span><span class="num" id="2206382">4</span><span class="op" id="2206383">]</span><span class="op" id="2206384">)</span><span class="op" id="2206385">*</span><span class="ident" id="2206386">zz</span><span class="op" id="2206388">+</span><span class="ident" id="2206389">_cos</span><span class="op" id="2206393">[</span><span class="num" id="2206394">5</span><span class="op" id="2206395">]</span><span class="op" id="2206396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206402">if</span>&nbsp;<span class="ident" id="2206405">sign</span>&nbsp;<span class="op" id="2206410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206414">y</span>&nbsp;<span class="op" id="2206416">=</span>&nbsp;<span class="op" id="2206418">-</span><span class="ident" id="2206419">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206422">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206425">return</span>&nbsp;<span class="ident" id="2206432">y</span><br>
<span class="lineno"></span><span class="op" id="2206434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2206437">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2206487">//</span><br>
<span class="lineno">170</span><span class="comment" id="2206490">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2206512">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2206530">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2206550">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2206568">func</span>&nbsp;<span class="ident" id="2206573">Sin</span><span class="op" id="2206576">(</span><span class="ident" id="2206577">x</span>&nbsp;<span class="builtintype" id="2206579">float64</span><span class="op" id="2206586">)</span>&nbsp;<span class="builtintype" id="2206588">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2206597">func</span>&nbsp;<span class="ident" id="2206602">sin</span><span class="op" id="2206605">(</span><span class="ident" id="2206606">x</span>&nbsp;<span class="builtintype" id="2206608">float64</span><span class="op" id="2206615">)</span>&nbsp;<span class="builtintype" id="2206617">float64</span>&nbsp;<span class="op" id="2206625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2206628">const</span>&nbsp;<span class="op" id="2206634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206638">PI4A</span>&nbsp;<span class="op" id="2206643">=</span>&nbsp;<span class="num" id="2206645">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2206699">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206752">PI4B</span>&nbsp;<span class="op" id="2206757">=</span>&nbsp;<span class="num" id="2206759">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2206813">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206838">PI4C</span>&nbsp;<span class="op" id="2206843">=</span>&nbsp;<span class="num" id="2206845">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2206899">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2206924">M4PI</span>&nbsp;<span class="op" id="2206929">=</span>&nbsp;<span class="num" id="2206931">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2206985">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2206994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2206997">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207015">switch</span>&nbsp;<span class="op" id="2207022">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207025">case</span>&nbsp;<span class="ident" id="2207030">x</span>&nbsp;<span class="op" id="2207032">==</span>&nbsp;<span class="num" id="2207035">0</span>&nbsp;<span class="op" id="2207037">||</span>&nbsp;<span class="ident" id="2207040">IsNaN</span><span class="op" id="2207045">(</span><span class="ident" id="2207046">x</span><span class="op" id="2207047">)</span><span class="op" id="2207048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207052">return</span>&nbsp;<span class="ident" id="2207059">x</span>&nbsp;<span class="comment" id="2207061">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207085">case</span>&nbsp;<span class="ident" id="2207090">IsInf</span><span class="op" id="2207095">(</span><span class="ident" id="2207096">x</span><span class="op" id="2207097">,</span>&nbsp;<span class="num" id="2207099">0</span><span class="op" id="2207100">)</span><span class="op" id="2207101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207105">return</span>&nbsp;<span class="ident" id="2207112">NaN</span><span class="op" id="2207115">(</span><span class="op" id="2207116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207119">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207123">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207168">sign</span>&nbsp;<span class="op" id="2207173">:=</span>&nbsp;<span class="builtintype" id="2207176">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207183">if</span>&nbsp;<span class="ident" id="2207186">x</span>&nbsp;<span class="op" id="2207188">&lt;</span>&nbsp;<span class="num" id="2207190">0</span>&nbsp;<span class="op" id="2207192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207196">x</span>&nbsp;<span class="op" id="2207198">=</span>&nbsp;<span class="op" id="2207200">-</span><span class="ident" id="2207201">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207205">sign</span>&nbsp;<span class="op" id="2207210">=</span>&nbsp;<span class="builtintype" id="2207212">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207222">j</span>&nbsp;<span class="op" id="2207224">:=</span>&nbsp;<span class="ident" id="2207227">int64</span><span class="op" id="2207232">(</span><span class="ident" id="2207233">x</span>&nbsp;<span class="op" id="2207235">*</span>&nbsp;<span class="ident" id="2207237">M4PI</span><span class="op" id="2207241">)</span>&nbsp;<span class="comment" id="2207243">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207313">y</span>&nbsp;<span class="op" id="2207315">:=</span>&nbsp;<span class="builtintype" id="2207318">float64</span><span class="op" id="2207325">(</span><span class="ident" id="2207326">j</span><span class="op" id="2207327">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2207334">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207374">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207398">if</span>&nbsp;<span class="ident" id="2207401">j</span><span class="op" id="2207402">&amp;</span><span class="num" id="2207403">1</span>&nbsp;<span class="op" id="2207405">==</span>&nbsp;<span class="num" id="2207408">1</span>&nbsp;<span class="op" id="2207410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207414">j</span>&nbsp;<span class="op" id="2207416">+=</span>&nbsp;<span class="num" id="2207419">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207423">y</span>&nbsp;<span class="op" id="2207425">+=</span>&nbsp;<span class="num" id="2207428">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207434">j</span>&nbsp;<span class="op" id="2207436">&amp;=</span>&nbsp;<span class="num" id="2207439">7</span>&nbsp;<span class="comment" id="2207441">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2207485">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207507">if</span>&nbsp;<span class="ident" id="2207510">j</span>&nbsp;<span class="op" id="2207512">&gt;</span>&nbsp;<span class="num" id="2207514">3</span>&nbsp;<span class="op" id="2207516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207520">sign</span>&nbsp;<span class="op" id="2207525">=</span>&nbsp;<span class="op" id="2207527">!</span><span class="ident" id="2207528">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207535">j</span>&nbsp;<span class="op" id="2207537">-=</span>&nbsp;<span class="num" id="2207540">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207547">z</span>&nbsp;<span class="op" id="2207549">:=</span>&nbsp;<span class="op" id="2207552">(</span><span class="op" id="2207553">(</span><span class="ident" id="2207554">x</span>&nbsp;<span class="op" id="2207556">-</span>&nbsp;<span class="ident" id="2207558">y</span><span class="op" id="2207559">*</span><span class="ident" id="2207560">PI4A</span><span class="op" id="2207564">)</span>&nbsp;<span class="op" id="2207566">-</span>&nbsp;<span class="ident" id="2207568">y</span><span class="op" id="2207569">*</span><span class="ident" id="2207570">PI4B</span><span class="op" id="2207574">)</span>&nbsp;<span class="op" id="2207576">-</span>&nbsp;<span class="ident" id="2207578">y</span><span class="op" id="2207579">*</span><span class="ident" id="2207580">PI4C</span>&nbsp;<span class="comment" id="2207585">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207627">zz</span>&nbsp;<span class="op" id="2207630">:=</span>&nbsp;<span class="ident" id="2207633">z</span>&nbsp;<span class="op" id="2207635">*</span>&nbsp;<span class="ident" id="2207637">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207640">if</span>&nbsp;<span class="ident" id="2207643">j</span>&nbsp;<span class="op" id="2207645">==</span>&nbsp;<span class="num" id="2207648">1</span>&nbsp;<span class="op" id="2207650">||</span>&nbsp;<span class="ident" id="2207653">j</span>&nbsp;<span class="op" id="2207655">==</span>&nbsp;<span class="num" id="2207658">2</span>&nbsp;<span class="op" id="2207660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207664">y</span>&nbsp;<span class="op" id="2207666">=</span>&nbsp;<span class="num" id="2207668">1.0</span>&nbsp;<span class="op" id="2207672">-</span>&nbsp;<span class="num" id="2207674">0.5</span><span class="op" id="2207677">*</span><span class="ident" id="2207678">zz</span>&nbsp;<span class="op" id="2207681">+</span>&nbsp;<span class="ident" id="2207683">zz</span><span class="op" id="2207685">*</span><span class="ident" id="2207686">zz</span><span class="op" id="2207688">*</span><span class="op" id="2207689">(</span><span class="op" id="2207690">(</span><span class="op" id="2207691">(</span><span class="op" id="2207692">(</span><span class="op" id="2207693">(</span><span class="op" id="2207694">(</span><span class="ident" id="2207695">_cos</span><span class="op" id="2207699">[</span><span class="num" id="2207700">0</span><span class="op" id="2207701">]</span><span class="op" id="2207702">*</span><span class="ident" id="2207703">zz</span><span class="op" id="2207705">)</span><span class="op" id="2207706">+</span><span class="ident" id="2207707">_cos</span><span class="op" id="2207711">[</span><span class="num" id="2207712">1</span><span class="op" id="2207713">]</span><span class="op" id="2207714">)</span><span class="op" id="2207715">*</span><span class="ident" id="2207716">zz</span><span class="op" id="2207718">+</span><span class="ident" id="2207719">_cos</span><span class="op" id="2207723">[</span><span class="num" id="2207724">2</span><span class="op" id="2207725">]</span><span class="op" id="2207726">)</span><span class="op" id="2207727">*</span><span class="ident" id="2207728">zz</span><span class="op" id="2207730">+</span><span class="ident" id="2207731">_cos</span><span class="op" id="2207735">[</span><span class="num" id="2207736">3</span><span class="op" id="2207737">]</span><span class="op" id="2207738">)</span><span class="op" id="2207739">*</span><span class="ident" id="2207740">zz</span><span class="op" id="2207742">+</span><span class="ident" id="2207743">_cos</span><span class="op" id="2207747">[</span><span class="num" id="2207748">4</span><span class="op" id="2207749">]</span><span class="op" id="2207750">)</span><span class="op" id="2207751">*</span><span class="ident" id="2207752">zz</span><span class="op" id="2207754">+</span><span class="ident" id="2207755">_cos</span><span class="op" id="2207759">[</span><span class="num" id="2207760">5</span><span class="op" id="2207761">]</span><span class="op" id="2207762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207765">}</span>&nbsp;<span class="keyword" id="2207767">else</span>&nbsp;<span class="op" id="2207772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207776">y</span>&nbsp;<span class="op" id="2207778">=</span>&nbsp;<span class="ident" id="2207780">z</span>&nbsp;<span class="op" id="2207782">+</span>&nbsp;<span class="ident" id="2207784">z</span><span class="op" id="2207785">*</span><span class="ident" id="2207786">zz</span><span class="op" id="2207788">*</span><span class="op" id="2207789">(</span><span class="op" id="2207790">(</span><span class="op" id="2207791">(</span><span class="op" id="2207792">(</span><span class="op" id="2207793">(</span><span class="op" id="2207794">(</span><span class="ident" id="2207795">_sin</span><span class="op" id="2207799">[</span><span class="num" id="2207800">0</span><span class="op" id="2207801">]</span><span class="op" id="2207802">*</span><span class="ident" id="2207803">zz</span><span class="op" id="2207805">)</span><span class="op" id="2207806">+</span><span class="ident" id="2207807">_sin</span><span class="op" id="2207811">[</span><span class="num" id="2207812">1</span><span class="op" id="2207813">]</span><span class="op" id="2207814">)</span><span class="op" id="2207815">*</span><span class="ident" id="2207816">zz</span><span class="op" id="2207818">+</span><span class="ident" id="2207819">_sin</span><span class="op" id="2207823">[</span><span class="num" id="2207824">2</span><span class="op" id="2207825">]</span><span class="op" id="2207826">)</span><span class="op" id="2207827">*</span><span class="ident" id="2207828">zz</span><span class="op" id="2207830">+</span><span class="ident" id="2207831">_sin</span><span class="op" id="2207835">[</span><span class="num" id="2207836">3</span><span class="op" id="2207837">]</span><span class="op" id="2207838">)</span><span class="op" id="2207839">*</span><span class="ident" id="2207840">zz</span><span class="op" id="2207842">+</span><span class="ident" id="2207843">_sin</span><span class="op" id="2207847">[</span><span class="num" id="2207848">4</span><span class="op" id="2207849">]</span><span class="op" id="2207850">)</span><span class="op" id="2207851">*</span><span class="ident" id="2207852">zz</span><span class="op" id="2207854">+</span><span class="ident" id="2207855">_sin</span><span class="op" id="2207859">[</span><span class="num" id="2207860">5</span><span class="op" id="2207861">]</span><span class="op" id="2207862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207865">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207868">if</span>&nbsp;<span class="ident" id="2207871">sign</span>&nbsp;<span class="op" id="2207876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2207880">y</span>&nbsp;<span class="op" id="2207882">=</span>&nbsp;<span class="op" id="2207884">-</span><span class="ident" id="2207885">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2207888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2207891">return</span>&nbsp;<span class="ident" id="2207898">y</span><br>
<span class="lineno"></span><span class="op" id="2207900">}</span>
</div>
</body>
</html>
