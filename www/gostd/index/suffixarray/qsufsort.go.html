<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html" class="current">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6089897">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6089952">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6090006">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6090057">//&nbsp;This&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;on&nbsp;&#34;Faster&nbsp;Suffix&nbsp;Sorting&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6090111">//&nbsp;&nbsp;&nbsp;by&nbsp;N.&nbsp;Jesper&nbsp;Larsson&nbsp;and&nbsp;Kunihiko&nbsp;Sadakane</span><br>
<span class="lineno"></span><span class="comment" id="6090159">//&nbsp;paper:&nbsp;http://www.larsson.dogma.net/ssrev-tr.pdf</span><br>
<span class="lineno"></span><span class="comment" id="6090211">//&nbsp;code:&nbsp;&nbsp;http://www.larsson.dogma.net/qsufsort.c</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="6090262">//&nbsp;This&nbsp;algorithm&nbsp;computes&nbsp;the&nbsp;suffix&nbsp;array&nbsp;sa&nbsp;by&nbsp;computing&nbsp;its&nbsp;inverse.</span><br>
<span class="lineno"></span><span class="comment" id="6090335">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;in&nbsp;sa&nbsp;are&nbsp;labeled&nbsp;as&nbsp;sorted&nbsp;groups&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6090407">//&nbsp;unsorted&nbsp;groups.&nbsp;For&nbsp;a&nbsp;given&nbsp;pass&nbsp;of&nbsp;the&nbsp;sorter,&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;ordered</span><br>
<span class="lineno"></span><span class="comment" id="6090484">//&nbsp;up&nbsp;to&nbsp;their&nbsp;first&nbsp;h&nbsp;characters,&nbsp;and&nbsp;sa&nbsp;is&nbsp;h-ordered.&nbsp;Suffixes&nbsp;in&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="6090558">//&nbsp;final&nbsp;positions&nbsp;and&nbsp;unambiguously&nbsp;sorted&nbsp;in&nbsp;h-order&nbsp;are&nbsp;in&nbsp;a&nbsp;sorted&nbsp;group.</span><br>
<span class="lineno">15</span><span class="comment" id="6090636">//&nbsp;Consecutive&nbsp;groups&nbsp;of&nbsp;suffixes&nbsp;with&nbsp;identical&nbsp;first&nbsp;h&nbsp;characters&nbsp;are&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6090711">//&nbsp;unsorted&nbsp;group.&nbsp;In&nbsp;each&nbsp;pass&nbsp;of&nbsp;the&nbsp;algorithm,&nbsp;unsorted&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span><span class="comment" id="6090788">//&nbsp;according&nbsp;to&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;their&nbsp;following&nbsp;suffix.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6090849">//&nbsp;In&nbsp;the&nbsp;implementation,&nbsp;if&nbsp;sa[i]&nbsp;is&nbsp;negative,&nbsp;it&nbsp;indicates&nbsp;that&nbsp;i&nbsp;is</span><br>
<span class="lineno">20</span><span class="comment" id="6090920">//&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;a&nbsp;sorted&nbsp;group&nbsp;of&nbsp;length&nbsp;-sa[i],&nbsp;and&nbsp;can&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="comment" id="6090997">//&nbsp;An&nbsp;unsorted&nbsp;group&nbsp;sa[i:k]&nbsp;is&nbsp;given&nbsp;the&nbsp;group&nbsp;number&nbsp;of&nbsp;the&nbsp;index&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6091072">//&nbsp;last&nbsp;element,&nbsp;k-1.&nbsp;The&nbsp;group&nbsp;numbers&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;inverse&nbsp;slice&nbsp;(inv),</span><br>
<span class="lineno"></span><span class="comment" id="6091151">//&nbsp;and&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted,&nbsp;this&nbsp;slice&nbsp;is&nbsp;the&nbsp;inverse&nbsp;suffix&nbsp;array.</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6091227">package</span>&nbsp;<span class="ident" id="6091235">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6091248">import</span>&nbsp;<span class="string" id="6091255">&#34;sort&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6091263">func</span>&nbsp;<span class="ident" id="6091268">qsufsort</span><span class="op" id="6091276">(</span><span class="ident" id="6091277">data</span>&nbsp;<span class="op" id="6091282">[</span><span class="op" id="6091283">]</span><span class="builtintype" id="6091284">byte</span><span class="op" id="6091288">)</span>&nbsp;<span class="op" id="6091290">[</span><span class="op" id="6091291">]</span><span class="builtintype" id="6091292">int</span>&nbsp;<span class="op" id="6091296">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6091299">//&nbsp;initial&nbsp;sorting&nbsp;by&nbsp;first&nbsp;byte&nbsp;of&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091343">sa</span>&nbsp;<span class="op" id="6091346">:=</span>&nbsp;<span class="ident" id="6091349"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092608">sortedByFirstByte</a></span><span class="op" id="6091366">(</span><span class="ident" id="6091367"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091277">data</a></span><span class="op" id="6091371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6091374">if</span>&nbsp;<span class="builtinfunc" id="6091377">len</span><span class="op" id="6091380">(</span><span class="ident" id="6091381"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091383">)</span>&nbsp;<span class="op" id="6091385">&lt;</span>&nbsp;<span class="num" id="6091387">2</span>&nbsp;<span class="op" id="6091389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6091393">return</span>&nbsp;<span class="ident" id="6091400"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6091404">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6091407">//&nbsp;initialize&nbsp;the&nbsp;group&nbsp;lookup&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6091445">//&nbsp;this&nbsp;becomes&nbsp;the&nbsp;inverse&nbsp;of&nbsp;the&nbsp;suffix&nbsp;array&nbsp;when&nbsp;all&nbsp;groups&nbsp;are&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091521">inv</span>&nbsp;<span class="op" id="6091525">:=</span>&nbsp;<span class="ident" id="6091528"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093054">initGroups</a></span><span class="op" id="6091538">(</span><span class="ident" id="6091539"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091541">,</span>&nbsp;<span class="ident" id="6091543"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091277">data</a></span><span class="op" id="6091547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6091551">//&nbsp;the&nbsp;index&nbsp;starts&nbsp;1-ordered</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091582">sufSortable</span>&nbsp;<span class="op" id="6091594">:=</span>&nbsp;<span class="op" id="6091597">&amp;</span><span class="ident" id="6091598"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093962">suffixSortable</a></span><span class="op" id="6091612">{</span><span class="ident" id="6091613"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6091615">:</span>&nbsp;<span class="ident" id="6091617"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091619">,</span>&nbsp;<span class="ident" id="6091621"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6091624">:</span>&nbsp;<span class="ident" id="6091626"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091521">inv</a></span><span class="op" id="6091629">,</span>&nbsp;<span class="ident" id="6091631"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span><span class="op" id="6091632">:</span>&nbsp;<span class="num" id="6091634">1</span><span class="op" id="6091635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6091639">for</span>&nbsp;<span class="ident" id="6091643"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091645">[</span><span class="num" id="6091646">0</span><span class="op" id="6091647">]</span>&nbsp;<span class="op" id="6091649">&gt;</span>&nbsp;<span class="op" id="6091651">-</span><span class="builtinfunc" id="6091652">len</span><span class="op" id="6091655">(</span><span class="ident" id="6091656"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091658">)</span>&nbsp;<span class="op" id="6091660">{</span>&nbsp;<span class="comment" id="6091662">//&nbsp;until&nbsp;all&nbsp;suffixes&nbsp;are&nbsp;one&nbsp;big&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6091711">//&nbsp;The&nbsp;suffixes&nbsp;are&nbsp;h-ordered,&nbsp;make&nbsp;them&nbsp;2*h-ordered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091766">pi</span>&nbsp;<span class="op" id="6091769">:=</span>&nbsp;<span class="num" id="6091772">0</span>&nbsp;<span class="comment" id="6091774">//&nbsp;pi&nbsp;is&nbsp;first&nbsp;position&nbsp;of&nbsp;first&nbsp;group</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091815">sl</span>&nbsp;<span class="op" id="6091818">:=</span>&nbsp;<span class="num" id="6091821">0</span>&nbsp;<span class="comment" id="6091823">//&nbsp;sl&nbsp;is&nbsp;negated&nbsp;length&nbsp;of&nbsp;sorted&nbsp;groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6091866">for</span>&nbsp;<span class="ident" id="6091870"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span>&nbsp;<span class="op" id="6091873">&lt;</span>&nbsp;<span class="builtinfunc" id="6091875">len</span><span class="op" id="6091878">(</span><span class="ident" id="6091879"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091881">)</span>&nbsp;<span class="op" id="6091883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6091888">if</span>&nbsp;<span class="ident" id="6091891">s</span>&nbsp;<span class="op" id="6091893">:=</span>&nbsp;<span class="ident" id="6091896"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6091898">[</span><span class="ident" id="6091899"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span><span class="op" id="6091901">]</span><span class="op" id="6091902">;</span>&nbsp;<span class="ident" id="6091904"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091891">s</a></span>&nbsp;<span class="op" id="6091906">&lt;</span>&nbsp;<span class="num" id="6091908">0</span>&nbsp;<span class="op" id="6091910">{</span>&nbsp;<span class="comment" id="6091912">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091945"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span>&nbsp;<span class="op" id="6091948">-=</span>&nbsp;<span class="ident" id="6091951"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091891">s</a></span>&nbsp;<span class="comment" id="6091953">//&nbsp;skip&nbsp;over&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6091983"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="op" id="6091986">+=</span>&nbsp;<span class="ident" id="6091989"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091891">s</a></span>&nbsp;<span class="comment" id="6091991">//&nbsp;add&nbsp;negated&nbsp;length&nbsp;to&nbsp;sl</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092022">}</span>&nbsp;<span class="keyword" id="6092024">else</span>&nbsp;<span class="op" id="6092029">{</span>&nbsp;<span class="comment" id="6092031">//&nbsp;if&nbsp;pi&nbsp;starts&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092066">if</span>&nbsp;<span class="ident" id="6092069"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="op" id="6092072">!=</span>&nbsp;<span class="num" id="6092075">0</span>&nbsp;<span class="op" id="6092077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092084"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6092086">[</span><span class="ident" id="6092087"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span><span class="op" id="6092089">+</span><span class="ident" id="6092090"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span><span class="op" id="6092092">]</span>&nbsp;<span class="op" id="6092094">=</span>&nbsp;<span class="ident" id="6092096"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="comment" id="6092099">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;before&nbsp;pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092139"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="op" id="6092142">=</span>&nbsp;<span class="num" id="6092144">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092150">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092156">pk</span>&nbsp;<span class="op" id="6092159">:=</span>&nbsp;<span class="ident" id="6092162"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091521">inv</a></span><span class="op" id="6092165">[</span><span class="ident" id="6092166"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091891">s</a></span><span class="op" id="6092167">]</span>&nbsp;<span class="op" id="6092169">+</span>&nbsp;<span class="num" id="6092171">1</span>&nbsp;<span class="comment" id="6092173">//&nbsp;pk-1&nbsp;is&nbsp;last&nbsp;position&nbsp;of&nbsp;unsorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092220"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091582">sufSortable</a></span><span class="op" id="6092231">.</span><span class="ident" id="6092232"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span>&nbsp;<span class="op" id="6092235">=</span>&nbsp;<span class="ident" id="6092237"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6092239">[</span><span class="ident" id="6092240"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span><span class="op" id="6092242">:</span><span class="ident" id="6092243"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092156">pk</a></span><span class="op" id="6092245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092251"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091255">sort</a></span><span class="op" id="6092255">.</span><span class="ident" id="6092256"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="6092260">(</span><span class="ident" id="6092261"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091582">sufSortable</a></span><span class="op" id="6092272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092278"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091582">sufSortable</a></span><span class="op" id="6092289">.</span><span class="ident" id="6092290"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094328">updateGroups</a></span><span class="op" id="6092302">(</span><span class="ident" id="6092303"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span><span class="op" id="6092305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092311"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span>&nbsp;<span class="op" id="6092314">=</span>&nbsp;<span class="ident" id="6092316"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092156">pk</a></span>&nbsp;<span class="comment" id="6092319">//&nbsp;next&nbsp;group</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092344">if</span>&nbsp;<span class="ident" id="6092347"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="op" id="6092350">!=</span>&nbsp;<span class="num" id="6092353">0</span>&nbsp;<span class="op" id="6092355">{</span>&nbsp;<span class="comment" id="6092357">//&nbsp;if&nbsp;the&nbsp;array&nbsp;ends&nbsp;with&nbsp;a&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092401"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6092403">[</span><span class="ident" id="6092404"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091766">pi</a></span><span class="op" id="6092406">+</span><span class="ident" id="6092407"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span><span class="op" id="6092409">]</span>&nbsp;<span class="op" id="6092411">=</span>&nbsp;<span class="ident" id="6092413"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091815">sl</a></span>&nbsp;<span class="comment" id="6092416">//&nbsp;combine&nbsp;sorted&nbsp;groups&nbsp;at&nbsp;end&nbsp;of&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092456">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092461"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091582">sufSortable</a></span><span class="op" id="6092472">.</span><span class="ident" id="6092473"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span>&nbsp;<span class="op" id="6092475">*=</span>&nbsp;<span class="num" id="6092478">2</span>&nbsp;<span class="comment" id="6092480">//&nbsp;double&nbsp;sorted&nbsp;depth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092508">for</span>&nbsp;<span class="ident" id="6092512">i</span>&nbsp;<span class="op" id="6092514">:=</span>&nbsp;<span class="keyword" id="6092517">range</span>&nbsp;<span class="ident" id="6092523"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span>&nbsp;<span class="op" id="6092526">{</span>&nbsp;<span class="comment" id="6092528">//&nbsp;reconstruct&nbsp;suffix&nbsp;array&nbsp;from&nbsp;inverse</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092571"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><span class="op" id="6092573">[</span><span class="ident" id="6092574"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091521">inv</a></span><span class="op" id="6092577">[</span><span class="ident" id="6092578"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092512">i</a></span><span class="op" id="6092579">]</span><span class="op" id="6092580">]</span>&nbsp;<span class="op" id="6092582">=</span>&nbsp;<span class="ident" id="6092584"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092512">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092590">return</span>&nbsp;<span class="ident" id="6092597"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091343">sa</a></span><br>
<span class="lineno"></span><span class="op" id="6092600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6092603">func</span>&nbsp;<span class="ident" id="6092608">sortedByFirstByte</span><span class="op" id="6092625">(</span><span class="ident" id="6092626">data</span>&nbsp;<span class="op" id="6092631">[</span><span class="op" id="6092632">]</span><span class="builtintype" id="6092633">byte</span><span class="op" id="6092637">)</span>&nbsp;<span class="op" id="6092639">[</span><span class="op" id="6092640">]</span><span class="builtintype" id="6092641">int</span>&nbsp;<span class="op" id="6092645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6092648">//&nbsp;total&nbsp;byte&nbsp;counts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092670">var</span>&nbsp;<span class="ident" id="6092674">count</span>&nbsp;<span class="op" id="6092680">[</span><span class="num" id="6092681">256</span><span class="op" id="6092684">]</span><span class="builtintype" id="6092685">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092690">for</span>&nbsp;<span class="ident" id="6092694">_</span><span class="op" id="6092695">,</span>&nbsp;<span class="ident" id="6092697">b</span>&nbsp;<span class="op" id="6092699">:=</span>&nbsp;<span class="keyword" id="6092702">range</span>&nbsp;<span class="ident" id="6092708"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092626">data</a></span>&nbsp;<span class="op" id="6092713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092717"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span><span class="op" id="6092722">[</span><span class="ident" id="6092723"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092697">b</a></span><span class="op" id="6092724">]</span><span class="op" id="6092725">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6092732">//&nbsp;make&nbsp;count[b]&nbsp;equal&nbsp;index&nbsp;of&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;b&nbsp;in&nbsp;sorted&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092803">sum</span>&nbsp;<span class="op" id="6092807">:=</span>&nbsp;<span class="num" id="6092810">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092813">for</span>&nbsp;<span class="ident" id="6092817">b</span>&nbsp;<span class="op" id="6092819">:=</span>&nbsp;<span class="keyword" id="6092822">range</span>&nbsp;<span class="ident" id="6092828"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span>&nbsp;<span class="op" id="6092834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092838"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span><span class="op" id="6092843">[</span><span class="ident" id="6092844"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092817">b</a></span><span class="op" id="6092845">]</span><span class="op" id="6092846">,</span>&nbsp;<span class="ident" id="6092848"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092803">sum</a></span>&nbsp;<span class="op" id="6092852">=</span>&nbsp;<span class="ident" id="6092854"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092803">sum</a></span><span class="op" id="6092857">,</span>&nbsp;<span class="ident" id="6092859"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span><span class="op" id="6092864">[</span><span class="ident" id="6092865"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092817">b</a></span><span class="op" id="6092866">]</span><span class="op" id="6092867">+</span><span class="ident" id="6092868"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092803">sum</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6092873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6092876">//&nbsp;iterate&nbsp;through&nbsp;bytes,&nbsp;placing&nbsp;index&nbsp;into&nbsp;the&nbsp;correct&nbsp;spot&nbsp;in&nbsp;sa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6092945">sa</span>&nbsp;<span class="op" id="6092948">:=</span>&nbsp;<span class="builtinfunc" id="6092951">make</span><span class="op" id="6092955">(</span><span class="op" id="6092956">[</span><span class="op" id="6092957">]</span><span class="builtintype" id="6092958">int</span><span class="op" id="6092961">,</span>&nbsp;<span class="builtinfunc" id="6092963">len</span><span class="op" id="6092966">(</span><span class="ident" id="6092967"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092626">data</a></span><span class="op" id="6092971">)</span><span class="op" id="6092972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6092975">for</span>&nbsp;<span class="ident" id="6092979">i</span><span class="op" id="6092980">,</span>&nbsp;<span class="ident" id="6092982">b</span>&nbsp;<span class="op" id="6092984">:=</span>&nbsp;<span class="keyword" id="6092987">range</span>&nbsp;<span class="ident" id="6092993"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092626">data</a></span>&nbsp;<span class="op" id="6092998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093002"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092945">sa</a></span><span class="op" id="6093004">[</span><span class="ident" id="6093005"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span><span class="op" id="6093010">[</span><span class="ident" id="6093011"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092982">b</a></span><span class="op" id="6093012">]</span><span class="op" id="6093013">]</span>&nbsp;<span class="op" id="6093015">=</span>&nbsp;<span class="ident" id="6093017"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092979">i</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093021"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092674">count</a></span><span class="op" id="6093026">[</span><span class="ident" id="6093027"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092982">b</a></span><span class="op" id="6093028">]</span><span class="op" id="6093029">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093036">return</span>&nbsp;<span class="ident" id="6093043"><a href="/gostd/index/suffixarray/qsufsort.go.html#6092945">sa</a></span><br>
<span class="lineno"></span><span class="op" id="6093046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6093049">func</span>&nbsp;<span class="ident" id="6093054">initGroups</span><span class="op" id="6093064">(</span><span class="ident" id="6093065">sa</span>&nbsp;<span class="op" id="6093068">[</span><span class="op" id="6093069">]</span><span class="builtintype" id="6093070">int</span><span class="op" id="6093073">,</span>&nbsp;<span class="ident" id="6093075">data</span>&nbsp;<span class="op" id="6093080">[</span><span class="op" id="6093081">]</span><span class="builtintype" id="6093082">byte</span><span class="op" id="6093086">)</span>&nbsp;<span class="op" id="6093088">[</span><span class="op" id="6093089">]</span><span class="builtintype" id="6093090">int</span>&nbsp;<span class="op" id="6093094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6093097">//&nbsp;label&nbsp;contiguous&nbsp;same-letter&nbsp;groups&nbsp;with&nbsp;the&nbsp;same&nbsp;group&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093164">inv</span>&nbsp;<span class="op" id="6093168">:=</span>&nbsp;<span class="builtinfunc" id="6093171">make</span><span class="op" id="6093175">(</span><span class="op" id="6093176">[</span><span class="op" id="6093177">]</span><span class="builtintype" id="6093178">int</span><span class="op" id="6093181">,</span>&nbsp;<span class="builtinfunc" id="6093183">len</span><span class="op" id="6093186">(</span><span class="ident" id="6093187"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093191">)</span><span class="op" id="6093192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093195">prevGroup</span>&nbsp;<span class="op" id="6093205">:=</span>&nbsp;<span class="builtinfunc" id="6093208">len</span><span class="op" id="6093211">(</span><span class="ident" id="6093212"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093214">)</span>&nbsp;<span class="op" id="6093216">-</span>&nbsp;<span class="num" id="6093218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093221">groupByte</span>&nbsp;<span class="op" id="6093231">:=</span>&nbsp;<span class="ident" id="6093234"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093238">[</span><span class="ident" id="6093239"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093241">[</span><span class="ident" id="6093242"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093195">prevGroup</a></span><span class="op" id="6093251">]</span><span class="op" id="6093252">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093255">for</span>&nbsp;<span class="ident" id="6093259">i</span>&nbsp;<span class="op" id="6093261">:=</span>&nbsp;<span class="builtinfunc" id="6093264">len</span><span class="op" id="6093267">(</span><span class="ident" id="6093268"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093270">)</span>&nbsp;<span class="op" id="6093272">-</span>&nbsp;<span class="num" id="6093274">1</span><span class="op" id="6093275">;</span>&nbsp;<span class="ident" id="6093277"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span>&nbsp;<span class="op" id="6093279">&gt;=</span>&nbsp;<span class="num" id="6093282">0</span><span class="op" id="6093283">;</span>&nbsp;<span class="ident" id="6093285"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><span class="op" id="6093286">--</span>&nbsp;<span class="op" id="6093289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093293">if</span>&nbsp;<span class="ident" id="6093296">b</span>&nbsp;<span class="op" id="6093298">:=</span>&nbsp;<span class="ident" id="6093301"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093305">[</span><span class="ident" id="6093306"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093308">[</span><span class="ident" id="6093309"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><span class="op" id="6093310">]</span><span class="op" id="6093311">]</span><span class="op" id="6093312">;</span>&nbsp;<span class="ident" id="6093314"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093296">b</a></span>&nbsp;<span class="op" id="6093316">&lt;</span>&nbsp;<span class="ident" id="6093318"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093221">groupByte</a></span>&nbsp;<span class="op" id="6093328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093333">if</span>&nbsp;<span class="ident" id="6093336"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093195">prevGroup</a></span>&nbsp;<span class="op" id="6093346">==</span>&nbsp;<span class="ident" id="6093349"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><span class="op" id="6093350">+</span><span class="num" id="6093351">1</span>&nbsp;<span class="op" id="6093353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093359"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093361">[</span><span class="ident" id="6093362"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><span class="op" id="6093363">+</span><span class="num" id="6093364">1</span><span class="op" id="6093365">]</span>&nbsp;<span class="op" id="6093367">=</span>&nbsp;<span class="op" id="6093369">-</span><span class="num" id="6093370">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093375">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093380"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093221">groupByte</a></span>&nbsp;<span class="op" id="6093390">=</span>&nbsp;<span class="ident" id="6093392"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093296">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093397"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093195">prevGroup</a></span>&nbsp;<span class="op" id="6093407">=</span>&nbsp;<span class="ident" id="6093409"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093417"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093164">inv</a></span><span class="op" id="6093420">[</span><span class="ident" id="6093421"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093423">[</span><span class="ident" id="6093424"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093259">i</a></span><span class="op" id="6093425">]</span><span class="op" id="6093426">]</span>&nbsp;<span class="op" id="6093428">=</span>&nbsp;<span class="ident" id="6093430"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093195">prevGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093442">if</span>&nbsp;<span class="ident" id="6093445"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093195">prevGroup</a></span>&nbsp;<span class="op" id="6093455">==</span>&nbsp;<span class="num" id="6093458">0</span>&nbsp;<span class="op" id="6093460">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093465"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093467">[</span><span class="num" id="6093468">0</span><span class="op" id="6093469">]</span>&nbsp;<span class="op" id="6093471">=</span>&nbsp;<span class="op" id="6093473">-</span><span class="num" id="6093474">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6093484">//&nbsp;Separate&nbsp;out&nbsp;the&nbsp;final&nbsp;suffix&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;its&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6093545">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;to&nbsp;ensure&nbsp;the&nbsp;suffix&nbsp;&#34;a&#34;&nbsp;is&nbsp;before&nbsp;&#34;aba&#34;</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6093608">//&nbsp;when&nbsp;using&nbsp;a&nbsp;potentially&nbsp;unstable&nbsp;sort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093652">lastByte</span>&nbsp;<span class="op" id="6093661">:=</span>&nbsp;<span class="ident" id="6093664"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093668">[</span><span class="builtinfunc" id="6093669">len</span><span class="op" id="6093672">(</span><span class="ident" id="6093673"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093677">)</span><span class="op" id="6093678">-</span><span class="num" id="6093679">1</span><span class="op" id="6093680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093683">s</span>&nbsp;<span class="op" id="6093685">:=</span>&nbsp;<span class="op" id="6093688">-</span><span class="num" id="6093689">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093692">for</span>&nbsp;<span class="ident" id="6093696">i</span>&nbsp;<span class="op" id="6093698">:=</span>&nbsp;<span class="keyword" id="6093701">range</span>&nbsp;<span class="ident" id="6093707"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span>&nbsp;<span class="op" id="6093710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093714">if</span>&nbsp;<span class="ident" id="6093717"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093719">[</span><span class="ident" id="6093720"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><span class="op" id="6093721">]</span>&nbsp;<span class="op" id="6093723">&gt;=</span>&nbsp;<span class="num" id="6093726">0</span>&nbsp;<span class="op" id="6093728">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093733">if</span>&nbsp;<span class="ident" id="6093736"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093075">data</a></span><span class="op" id="6093740">[</span><span class="ident" id="6093741"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093743">[</span><span class="ident" id="6093744"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><span class="op" id="6093745">]</span><span class="op" id="6093746">]</span>&nbsp;<span class="op" id="6093748">==</span>&nbsp;<span class="ident" id="6093751"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093652">lastByte</a></span>&nbsp;<span class="op" id="6093760">&amp;&amp;</span>&nbsp;<span class="ident" id="6093763"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span>&nbsp;<span class="op" id="6093765">==</span>&nbsp;<span class="op" id="6093768">-</span><span class="num" id="6093769">1</span>&nbsp;<span class="op" id="6093771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093777"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span>&nbsp;<span class="op" id="6093779">=</span>&nbsp;<span class="ident" id="6093781"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093791">if</span>&nbsp;<span class="ident" id="6093794"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093796">[</span><span class="ident" id="6093797"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><span class="op" id="6093798">]</span>&nbsp;<span class="op" id="6093800">==</span>&nbsp;<span class="builtinfunc" id="6093803">len</span><span class="op" id="6093806">(</span><span class="ident" id="6093807"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093809">)</span><span class="op" id="6093810">-</span><span class="num" id="6093811">1</span>&nbsp;<span class="op" id="6093813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093819"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093821">[</span><span class="ident" id="6093822"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><span class="op" id="6093823">]</span><span class="op" id="6093824">,</span>&nbsp;<span class="ident" id="6093826"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093828">[</span><span class="ident" id="6093829"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span><span class="op" id="6093830">]</span>&nbsp;<span class="op" id="6093832">=</span>&nbsp;<span class="ident" id="6093834"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093836">[</span><span class="ident" id="6093837"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span><span class="op" id="6093838">]</span><span class="op" id="6093839">,</span>&nbsp;<span class="ident" id="6093841"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093843">[</span><span class="ident" id="6093844"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093696">i</a></span><span class="op" id="6093845">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093851"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093164">inv</a></span><span class="op" id="6093854">[</span><span class="ident" id="6093855"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093857">[</span><span class="ident" id="6093858"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span><span class="op" id="6093859">]</span><span class="op" id="6093860">]</span>&nbsp;<span class="op" id="6093862">=</span>&nbsp;<span class="ident" id="6093864"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093870"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093065">sa</a></span><span class="op" id="6093872">[</span><span class="ident" id="6093873"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093683">s</a></span><span class="op" id="6093874">]</span>&nbsp;<span class="op" id="6093876">=</span>&nbsp;<span class="op" id="6093878">-</span><span class="num" id="6093879">1</span>&nbsp;<span class="comment" id="6093881">//&nbsp;mark&nbsp;it&nbsp;as&nbsp;an&nbsp;isolated&nbsp;sorted&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093924">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093937">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6093940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6093943">return</span>&nbsp;<span class="ident" id="6093950"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093164">inv</a></span><br>
<span class="lineno"></span><span class="op" id="6093954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6093957">type</span>&nbsp;<span class="ident" id="6093962">suffixSortable</span>&nbsp;<span class="keyword" id="6093977">struct</span>&nbsp;<span class="op" id="6093984">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093987">sa</span>&nbsp;&nbsp;<span class="op" id="6093991">[</span><span class="op" id="6093992">]</span><span class="builtintype" id="6093993">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6093998">inv</span>&nbsp;<span class="op" id="6094002">[</span><span class="op" id="6094003">]</span><span class="builtintype" id="6094004">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094009">h</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6094013">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094018">buf</span>&nbsp;<span class="op" id="6094022">[</span><span class="op" id="6094023">]</span><span class="builtintype" id="6094024">int</span>&nbsp;<span class="comment" id="6094028">//&nbsp;common&nbsp;scratch&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="6094052">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6094055">func</span>&nbsp;<span class="op" id="6094060">(</span><span class="ident" id="6094061">x</span>&nbsp;<span class="op" id="6094063">*</span><span class="ident" id="6094064"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093962">suffixSortable</a></span><span class="op" id="6094078">)</span>&nbsp;<span class="ident" id="6094080">Len</span><span class="op" id="6094083">(</span><span class="op" id="6094084">)</span>&nbsp;<span class="builtintype" id="6094086">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094100">{</span>&nbsp;<span class="keyword" id="6094102">return</span>&nbsp;<span class="builtinfunc" id="6094109">len</span><span class="op" id="6094112">(</span><span class="ident" id="6094113"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094061">x</a></span><span class="op" id="6094114">.</span><span class="ident" id="6094115"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094117">)</span>&nbsp;<span class="op" id="6094119">}</span><br>
<span class="lineno"></span><span class="keyword" id="6094121">func</span>&nbsp;<span class="op" id="6094126">(</span><span class="ident" id="6094127">x</span>&nbsp;<span class="op" id="6094129">*</span><span class="ident" id="6094130"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093962">suffixSortable</a></span><span class="op" id="6094144">)</span>&nbsp;<span class="ident" id="6094146">Less</span><span class="op" id="6094150">(</span><span class="ident" id="6094151">i</span><span class="op" id="6094152">,</span>&nbsp;<span class="ident" id="6094154">j</span>&nbsp;<span class="builtintype" id="6094156">int</span><span class="op" id="6094159">)</span>&nbsp;<span class="builtintype" id="6094161">bool</span>&nbsp;<span class="op" id="6094166">{</span>&nbsp;<span class="keyword" id="6094168">return</span>&nbsp;<span class="ident" id="6094175"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094176">.</span><span class="ident" id="6094177"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6094180">[</span><span class="ident" id="6094181"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094182">.</span><span class="ident" id="6094183"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094185">[</span><span class="ident" id="6094186"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094151">i</a></span><span class="op" id="6094187">]</span><span class="op" id="6094188">+</span><span class="ident" id="6094189"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094190">.</span><span class="ident" id="6094191"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span><span class="op" id="6094192">]</span>&nbsp;<span class="op" id="6094194">&lt;</span>&nbsp;<span class="ident" id="6094196"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094197">.</span><span class="ident" id="6094198"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6094201">[</span><span class="ident" id="6094202"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094203">.</span><span class="ident" id="6094204"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094206">[</span><span class="ident" id="6094207"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094154">j</a></span><span class="op" id="6094208">]</span><span class="op" id="6094209">+</span><span class="ident" id="6094210"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094127">x</a></span><span class="op" id="6094211">.</span><span class="ident" id="6094212"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span><span class="op" id="6094213">]</span>&nbsp;<span class="op" id="6094215">}</span><br>
<span class="lineno"></span><span class="keyword" id="6094217">func</span>&nbsp;<span class="op" id="6094222">(</span><span class="ident" id="6094223">x</span>&nbsp;<span class="op" id="6094225">*</span><span class="ident" id="6094226"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093962">suffixSortable</a></span><span class="op" id="6094240">)</span>&nbsp;<span class="ident" id="6094242">Swap</span><span class="op" id="6094246">(</span><span class="ident" id="6094247">i</span><span class="op" id="6094248">,</span>&nbsp;<span class="ident" id="6094250">j</span>&nbsp;<span class="builtintype" id="6094252">int</span><span class="op" id="6094255">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094262">{</span>&nbsp;<span class="ident" id="6094264"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094223">x</a></span><span class="op" id="6094265">.</span><span class="ident" id="6094266"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094268">[</span><span class="ident" id="6094269"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094247">i</a></span><span class="op" id="6094270">]</span><span class="op" id="6094271">,</span>&nbsp;<span class="ident" id="6094273"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094223">x</a></span><span class="op" id="6094274">.</span><span class="ident" id="6094275"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094277">[</span><span class="ident" id="6094278"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094250">j</a></span><span class="op" id="6094279">]</span>&nbsp;<span class="op" id="6094281">=</span>&nbsp;<span class="ident" id="6094283"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094223">x</a></span><span class="op" id="6094284">.</span><span class="ident" id="6094285"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094287">[</span><span class="ident" id="6094288"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094250">j</a></span><span class="op" id="6094289">]</span><span class="op" id="6094290">,</span>&nbsp;<span class="ident" id="6094292"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094223">x</a></span><span class="op" id="6094293">.</span><span class="ident" id="6094294"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094296">[</span><span class="ident" id="6094297"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094247">i</a></span><span class="op" id="6094298">]</span>&nbsp;<span class="op" id="6094300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="6094303">func</span>&nbsp;<span class="op" id="6094308">(</span><span class="ident" id="6094309">x</span>&nbsp;<span class="op" id="6094311">*</span><span class="ident" id="6094312"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093962">suffixSortable</a></span><span class="op" id="6094326">)</span>&nbsp;<span class="ident" id="6094328">updateGroups</span><span class="op" id="6094340">(</span><span class="ident" id="6094341">offset</span>&nbsp;<span class="builtintype" id="6094348">int</span><span class="op" id="6094351">)</span>&nbsp;<span class="op" id="6094353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094356">bounds</span>&nbsp;<span class="op" id="6094363">:=</span>&nbsp;<span class="ident" id="6094366"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094367">.</span><span class="ident" id="6094368"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094018">buf</a></span><span class="op" id="6094371">[</span><span class="num" id="6094372">0</span><span class="op" id="6094373">:</span><span class="num" id="6094374">0</span><span class="op" id="6094375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094378">group</span>&nbsp;<span class="op" id="6094384">:=</span>&nbsp;<span class="ident" id="6094387"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094388">.</span><span class="ident" id="6094389"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6094392">[</span><span class="ident" id="6094393"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094394">.</span><span class="ident" id="6094395"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094397">[</span><span class="num" id="6094398">0</span><span class="op" id="6094399">]</span><span class="op" id="6094400">+</span><span class="ident" id="6094401"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094402">.</span><span class="ident" id="6094403"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span><span class="op" id="6094404">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6094407">for</span>&nbsp;<span class="ident" id="6094411">i</span>&nbsp;<span class="op" id="6094413">:=</span>&nbsp;<span class="num" id="6094416">1</span><span class="op" id="6094417">;</span>&nbsp;<span class="ident" id="6094419"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094411">i</a></span>&nbsp;<span class="op" id="6094421">&lt;</span>&nbsp;<span class="builtinfunc" id="6094423">len</span><span class="op" id="6094426">(</span><span class="ident" id="6094427"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094428">.</span><span class="ident" id="6094429"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094431">)</span><span class="op" id="6094432">;</span>&nbsp;<span class="ident" id="6094434"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094411">i</a></span><span class="op" id="6094435">++</span>&nbsp;<span class="op" id="6094438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6094442">if</span>&nbsp;<span class="ident" id="6094445">g</span>&nbsp;<span class="op" id="6094447">:=</span>&nbsp;<span class="ident" id="6094450"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094451">.</span><span class="ident" id="6094452"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6094455">[</span><span class="ident" id="6094456"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094457">.</span><span class="ident" id="6094458"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094460">[</span><span class="ident" id="6094461"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094411">i</a></span><span class="op" id="6094462">]</span><span class="op" id="6094463">+</span><span class="ident" id="6094464"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094465">.</span><span class="ident" id="6094466"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094009">h</a></span><span class="op" id="6094467">]</span><span class="op" id="6094468">;</span>&nbsp;<span class="ident" id="6094470"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094445">g</a></span>&nbsp;<span class="op" id="6094472">&gt;</span>&nbsp;<span class="ident" id="6094474"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094378">group</a></span>&nbsp;<span class="op" id="6094480">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094485"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span>&nbsp;<span class="op" id="6094492">=</span>&nbsp;<span class="builtinfunc" id="6094494">append</span><span class="op" id="6094500">(</span><span class="ident" id="6094501"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span><span class="op" id="6094507">,</span>&nbsp;<span class="ident" id="6094509"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094411">i</a></span><span class="op" id="6094510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094515"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094378">group</a></span>&nbsp;<span class="op" id="6094521">=</span>&nbsp;<span class="ident" id="6094523"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094445">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094533"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span>&nbsp;<span class="op" id="6094540">=</span>&nbsp;<span class="builtinfunc" id="6094542">append</span><span class="op" id="6094548">(</span><span class="ident" id="6094549"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span><span class="op" id="6094555">,</span>&nbsp;<span class="builtinfunc" id="6094557">len</span><span class="op" id="6094560">(</span><span class="ident" id="6094561"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094562">.</span><span class="ident" id="6094563"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094565">)</span><span class="op" id="6094566">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094569"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094570">.</span><span class="ident" id="6094571"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094018">buf</a></span>&nbsp;<span class="op" id="6094575">=</span>&nbsp;<span class="ident" id="6094577"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6094586">//&nbsp;update&nbsp;the&nbsp;group&nbsp;numberings&nbsp;after&nbsp;all&nbsp;new&nbsp;groups&nbsp;are&nbsp;determined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094654">prev</span>&nbsp;<span class="op" id="6094659">:=</span>&nbsp;<span class="num" id="6094662">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6094665">for</span>&nbsp;<span class="ident" id="6094669">_</span><span class="op" id="6094670">,</span>&nbsp;<span class="ident" id="6094672">b</span>&nbsp;<span class="op" id="6094674">:=</span>&nbsp;<span class="keyword" id="6094677">range</span>&nbsp;<span class="ident" id="6094683"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094356">bounds</a></span>&nbsp;<span class="op" id="6094690">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6094694">for</span>&nbsp;<span class="ident" id="6094698">i</span>&nbsp;<span class="op" id="6094700">:=</span>&nbsp;<span class="ident" id="6094703"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094654">prev</a></span><span class="op" id="6094707">;</span>&nbsp;<span class="ident" id="6094709"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094698">i</a></span>&nbsp;<span class="op" id="6094711">&lt;</span>&nbsp;<span class="ident" id="6094713"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094672">b</a></span><span class="op" id="6094714">;</span>&nbsp;<span class="ident" id="6094716"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094698">i</a></span><span class="op" id="6094717">++</span>&nbsp;<span class="op" id="6094720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094725"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094726">.</span><span class="ident" id="6094727"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093998">inv</a></span><span class="op" id="6094730">[</span><span class="ident" id="6094731"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094732">.</span><span class="ident" id="6094733"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094735">[</span><span class="ident" id="6094736"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094698">i</a></span><span class="op" id="6094737">]</span><span class="op" id="6094738">]</span>&nbsp;<span class="op" id="6094740">=</span>&nbsp;<span class="ident" id="6094742"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094341">offset</a></span>&nbsp;<span class="op" id="6094749">+</span>&nbsp;<span class="ident" id="6094751"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094672">b</a></span>&nbsp;<span class="op" id="6094753">-</span>&nbsp;<span class="num" id="6094755">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6094763">if</span>&nbsp;<span class="ident" id="6094766"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094672">b</a></span><span class="op" id="6094767">-</span><span class="ident" id="6094768"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094654">prev</a></span>&nbsp;<span class="op" id="6094773">==</span>&nbsp;<span class="num" id="6094776">1</span>&nbsp;<span class="op" id="6094778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094783"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094309">x</a></span><span class="op" id="6094784">.</span><span class="ident" id="6094785"><a href="/gostd/index/suffixarray/qsufsort.go.html#6093987">sa</a></span><span class="op" id="6094787">[</span><span class="ident" id="6094788"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094654">prev</a></span><span class="op" id="6094792">]</span>&nbsp;<span class="op" id="6094794">=</span>&nbsp;<span class="op" id="6094796">-</span><span class="num" id="6094797">1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6094805"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094654">prev</a></span>&nbsp;<span class="op" id="6094810">=</span>&nbsp;<span class="ident" id="6094812"><a href="/gostd/index/suffixarray/qsufsort.go.html#6094672">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6094815">}</span><br>
<span class="lineno"></span><span class="op" id="6094817">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
