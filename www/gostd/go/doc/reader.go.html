<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5839597">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5839652">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5839706">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5839757">package</span>&nbsp;<span class="ident" id="5839765">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5839770">import</span>&nbsp;<span class="op" id="5839777">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839780">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839790">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839802">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839812">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839820">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5839830">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5839833">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5839913">//&nbsp;function/method&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="5839937">//</span><br>
<span class="lineno"></span><span class="comment" id="5839940">//&nbsp;Internally,&nbsp;we&nbsp;treat&nbsp;functions&nbsp;like&nbsp;methods&nbsp;and&nbsp;collect&nbsp;them&nbsp;in&nbsp;method&nbsp;sets.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5840021">//&nbsp;A&nbsp;methodSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;methods.&nbsp;Entries&nbsp;where&nbsp;Decl&nbsp;==&nbsp;nil&nbsp;are&nbsp;conflict</span><br>
<span class="lineno"></span><span class="comment" id="5840103">//&nbsp;entries&nbsp;(more&nbsp;then&nbsp;one&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;embedding&nbsp;level).</span><br>
<span class="lineno"></span><span class="comment" id="5840185">//</span><br>
<span class="lineno"></span><span class="keyword" id="5840188">type</span>&nbsp;<span class="ident" id="5840193">methodSet</span>&nbsp;<span class="keyword" id="5840203">map</span><span class="op" id="5840206">[</span><span class="builtintype" id="5840207">string</span><span class="op" id="5840213">]</span><span class="op" id="5840214">*</span><span class="ident" id="5840215">Func</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5840221">//&nbsp;recvString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;recv&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5840282">//&nbsp;form&nbsp;&#34;T&#34;,&nbsp;&#34;*T&#34;,&nbsp;or&nbsp;&#34;BADRECV&#34;&nbsp;(if&nbsp;not&nbsp;a&nbsp;proper&nbsp;receiver&nbsp;type).</span><br>
<span class="lineno"></span><span class="comment" id="5840347">//</span><br>
<span class="lineno"></span><span class="keyword" id="5840350">func</span>&nbsp;<span class="ident" id="5840355">recvString</span><span class="op" id="5840365">(</span><span class="ident" id="5840366">recv</span>&nbsp;<span class="ident" id="5840371">ast</span><span class="op" id="5840374">.</span><span class="ident" id="5840375">Expr</span><span class="op" id="5840379">)</span>&nbsp;<span class="builtintype" id="5840381">string</span>&nbsp;<span class="op" id="5840388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840391">switch</span>&nbsp;<span class="ident" id="5840398">t</span>&nbsp;<span class="op" id="5840400">:=</span>&nbsp;<span class="ident" id="5840403">recv</span><span class="op" id="5840407">.</span><span class="op" id="5840408">(</span><span class="keyword" id="5840409">type</span><span class="op" id="5840413">)</span>&nbsp;<span class="op" id="5840415">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840418">case</span>&nbsp;<span class="op" id="5840423">*</span><span class="ident" id="5840424">ast</span><span class="op" id="5840427">.</span><span class="ident" id="5840428">Ident</span><span class="op" id="5840433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840437">return</span>&nbsp;<span class="ident" id="5840444">t</span><span class="op" id="5840445">.</span><span class="ident" id="5840446">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840452">case</span>&nbsp;<span class="op" id="5840457">*</span><span class="ident" id="5840458">ast</span><span class="op" id="5840461">.</span><span class="ident" id="5840462">StarExpr</span><span class="op" id="5840470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840474">return</span>&nbsp;<span class="string" id="5840481">&#34;*&#34;</span>&nbsp;<span class="op" id="5840485">+</span>&nbsp;<span class="ident" id="5840487">recvString</span><span class="op" id="5840497">(</span><span class="ident" id="5840498">t</span><span class="op" id="5840499">.</span><span class="ident" id="5840500">X</span><span class="op" id="5840501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5840504">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840507">return</span>&nbsp;<span class="string" id="5840514">&#34;BADRECV&#34;</span><br>
<span class="lineno"></span><span class="op" id="5840524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5840527">//&nbsp;set&nbsp;creates&nbsp;the&nbsp;corresponding&nbsp;Func&nbsp;for&nbsp;f&nbsp;and&nbsp;adds&nbsp;it&nbsp;to&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5840592">//&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;f&#39;s&nbsp;with&nbsp;the&nbsp;same&nbsp;name,&nbsp;set&nbsp;keeps&nbsp;the&nbsp;first</span><br>
<span class="lineno">40</span><span class="comment" id="5840661">//&nbsp;one&nbsp;with&nbsp;documentation;&nbsp;conflicts&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5840711">//</span><br>
<span class="lineno"></span><span class="keyword" id="5840714">func</span>&nbsp;<span class="op" id="5840719">(</span><span class="ident" id="5840720">mset</span>&nbsp;<span class="ident" id="5840725">methodSet</span><span class="op" id="5840734">)</span>&nbsp;<span class="ident" id="5840736">set</span><span class="op" id="5840739">(</span><span class="ident" id="5840740">f</span>&nbsp;<span class="op" id="5840742">*</span><span class="ident" id="5840743">ast</span><span class="op" id="5840746">.</span><span class="ident" id="5840747">FuncDecl</span><span class="op" id="5840755">)</span>&nbsp;<span class="op" id="5840757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840760">name</span>&nbsp;<span class="op" id="5840765">:=</span>&nbsp;<span class="ident" id="5840768">f</span><span class="op" id="5840769">.</span><span class="ident" id="5840770">Name</span><span class="op" id="5840774">.</span><span class="ident" id="5840775">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840781">if</span>&nbsp;<span class="ident" id="5840784">g</span>&nbsp;<span class="op" id="5840786">:=</span>&nbsp;<span class="ident" id="5840789">mset</span><span class="op" id="5840793">[</span><span class="ident" id="5840794">name</span><span class="op" id="5840798">]</span><span class="op" id="5840799">;</span>&nbsp;<span class="ident" id="5840801">g</span>&nbsp;<span class="op" id="5840803">!=</span>&nbsp;<span class="ident" id="5840806">nil</span>&nbsp;<span class="op" id="5840810">&amp;&amp;</span>&nbsp;<span class="ident" id="5840813">g</span><span class="op" id="5840814">.</span><span class="ident" id="5840815">Doc</span>&nbsp;<span class="op" id="5840819">!=</span>&nbsp;<span class="string" id="5840822">&#34;&#34;</span>&nbsp;<span class="op" id="5840825">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840829">//&nbsp;A&nbsp;function&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;has&nbsp;already&nbsp;been&nbsp;registered;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840893">//&nbsp;since&nbsp;it&nbsp;has&nbsp;documentation,&nbsp;assume&nbsp;f&nbsp;is&nbsp;simply&nbsp;another</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840953">//&nbsp;implementation&nbsp;and&nbsp;ignore&nbsp;it.&nbsp;This&nbsp;does&nbsp;not&nbsp;happen&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841016">//&nbsp;caller&nbsp;is&nbsp;using&nbsp;go/build.ScanDir&nbsp;to&nbsp;determine&nbsp;the&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841079">//&nbsp;files&nbsp;implementing&nbsp;a&nbsp;package.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841114">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841125">//&nbsp;function&nbsp;doesn&#39;t&nbsp;exist&nbsp;or&nbsp;has&nbsp;no&nbsp;documentation;&nbsp;use&nbsp;f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841183">recv</span>&nbsp;<span class="op" id="5841188">:=</span>&nbsp;<span class="string" id="5841191">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841195">if</span>&nbsp;<span class="ident" id="5841198">f</span><span class="op" id="5841199">.</span><span class="ident" id="5841200">Recv</span>&nbsp;<span class="op" id="5841205">!=</span>&nbsp;<span class="ident" id="5841208">nil</span>&nbsp;<span class="op" id="5841212">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841216">var</span>&nbsp;<span class="ident" id="5841220">typ</span>&nbsp;<span class="ident" id="5841224">ast</span><span class="op" id="5841227">.</span><span class="ident" id="5841228">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841235">//&nbsp;be&nbsp;careful&nbsp;in&nbsp;case&nbsp;of&nbsp;incorrect&nbsp;ASTs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841277">if</span>&nbsp;<span class="ident" id="5841280">list</span>&nbsp;<span class="op" id="5841285">:=</span>&nbsp;<span class="ident" id="5841288">f</span><span class="op" id="5841289">.</span><span class="ident" id="5841290">Recv</span><span class="op" id="5841294">.</span><span class="ident" id="5841295">List</span><span class="op" id="5841299">;</span>&nbsp;<span class="builtinfunc" id="5841301">len</span><span class="op" id="5841304">(</span><span class="ident" id="5841305">list</span><span class="op" id="5841309">)</span>&nbsp;<span class="op" id="5841311">==</span>&nbsp;<span class="num" id="5841314">1</span>&nbsp;<span class="op" id="5841316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841321">typ</span>&nbsp;<span class="op" id="5841325">=</span>&nbsp;<span class="ident" id="5841327">list</span><span class="op" id="5841331">[</span><span class="num" id="5841332">0</span><span class="op" id="5841333">]</span><span class="op" id="5841334">.</span><span class="ident" id="5841335">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841342">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841346">recv</span>&nbsp;<span class="op" id="5841351">=</span>&nbsp;<span class="ident" id="5841353">recvString</span><span class="op" id="5841363">(</span><span class="ident" id="5841364">typ</span><span class="op" id="5841367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841373">mset</span><span class="op" id="5841377">[</span><span class="ident" id="5841378">name</span><span class="op" id="5841382">]</span>&nbsp;<span class="op" id="5841384">=</span>&nbsp;<span class="op" id="5841386">&amp;</span><span class="ident" id="5841387">Func</span><span class="op" id="5841391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841395">Doc</span><span class="op" id="5841398">:</span>&nbsp;&nbsp;<span class="ident" id="5841401">f</span><span class="op" id="5841402">.</span><span class="ident" id="5841403">Doc</span><span class="op" id="5841406">.</span><span class="ident" id="5841407">Text</span><span class="op" id="5841411">(</span><span class="op" id="5841412">)</span><span class="op" id="5841413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841417">Name</span><span class="op" id="5841421">:</span>&nbsp;<span class="ident" id="5841423">name</span><span class="op" id="5841427">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841431">Decl</span><span class="op" id="5841435">:</span>&nbsp;<span class="ident" id="5841437">f</span><span class="op" id="5841438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841442">Recv</span><span class="op" id="5841446">:</span>&nbsp;<span class="ident" id="5841448">recv</span><span class="op" id="5841452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841456">Orig</span><span class="op" id="5841460">:</span>&nbsp;<span class="ident" id="5841462">recv</span><span class="op" id="5841466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841472">f</span><span class="op" id="5841473">.</span><span class="ident" id="5841474">Doc</span>&nbsp;<span class="op" id="5841478">=</span>&nbsp;<span class="ident" id="5841480">nil</span>&nbsp;<span class="comment" id="5841484">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno">70</span><span class="op" id="5841518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5841521">//&nbsp;add&nbsp;adds&nbsp;method&nbsp;m&nbsp;to&nbsp;the&nbsp;method&nbsp;set;&nbsp;m&nbsp;is&nbsp;ignored&nbsp;if&nbsp;the&nbsp;method&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="5841592">//&nbsp;already&nbsp;contains&nbsp;a&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;or&nbsp;a&nbsp;higher</span><br>
<span class="lineno"></span><span class="comment" id="5841664">//&nbsp;level&nbsp;then&nbsp;m.</span><br>
<span class="lineno">75</span><span class="comment" id="5841681">//</span><br>
<span class="lineno"></span><span class="keyword" id="5841684">func</span>&nbsp;<span class="op" id="5841689">(</span><span class="ident" id="5841690">mset</span>&nbsp;<span class="ident" id="5841695">methodSet</span><span class="op" id="5841704">)</span>&nbsp;<span class="ident" id="5841706">add</span><span class="op" id="5841709">(</span><span class="ident" id="5841710">m</span>&nbsp;<span class="op" id="5841712">*</span><span class="ident" id="5841713">Func</span><span class="op" id="5841717">)</span>&nbsp;<span class="op" id="5841719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841722">old</span>&nbsp;<span class="op" id="5841726">:=</span>&nbsp;<span class="ident" id="5841729">mset</span><span class="op" id="5841733">[</span><span class="ident" id="5841734">m</span><span class="op" id="5841735">.</span><span class="ident" id="5841736">Name</span><span class="op" id="5841740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841743">if</span>&nbsp;<span class="ident" id="5841746">old</span>&nbsp;<span class="op" id="5841750">==</span>&nbsp;<span class="ident" id="5841753">nil</span>&nbsp;<span class="op" id="5841757">||</span>&nbsp;<span class="ident" id="5841760">m</span><span class="op" id="5841761">.</span><span class="ident" id="5841762">Level</span>&nbsp;<span class="op" id="5841768">&lt;</span>&nbsp;<span class="ident" id="5841770">old</span><span class="op" id="5841773">.</span><span class="ident" id="5841774">Level</span>&nbsp;<span class="op" id="5841780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841784">mset</span><span class="op" id="5841788">[</span><span class="ident" id="5841789">m</span><span class="op" id="5841790">.</span><span class="ident" id="5841791">Name</span><span class="op" id="5841795">]</span>&nbsp;<span class="op" id="5841797">=</span>&nbsp;<span class="ident" id="5841799">m</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841803">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841814">if</span>&nbsp;<span class="ident" id="5841817">old</span>&nbsp;<span class="op" id="5841821">!=</span>&nbsp;<span class="ident" id="5841824">nil</span>&nbsp;<span class="op" id="5841828">&amp;&amp;</span>&nbsp;<span class="ident" id="5841831">m</span><span class="op" id="5841832">.</span><span class="ident" id="5841833">Level</span>&nbsp;<span class="op" id="5841839">==</span>&nbsp;<span class="ident" id="5841842">old</span><span class="op" id="5841845">.</span><span class="ident" id="5841846">Level</span>&nbsp;<span class="op" id="5841852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841856">//&nbsp;conflict&nbsp;-&nbsp;mark&nbsp;it&nbsp;using&nbsp;a&nbsp;method&nbsp;with&nbsp;nil&nbsp;Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841909">mset</span><span class="op" id="5841913">[</span><span class="ident" id="5841914">m</span><span class="op" id="5841915">.</span><span class="ident" id="5841916">Name</span><span class="op" id="5841920">]</span>&nbsp;<span class="op" id="5841922">=</span>&nbsp;<span class="op" id="5841924">&amp;</span><span class="ident" id="5841925">Func</span><span class="op" id="5841929">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841934">Name</span><span class="op" id="5841938">:</span>&nbsp;&nbsp;<span class="ident" id="5841941">m</span><span class="op" id="5841942">.</span><span class="ident" id="5841943">Name</span><span class="op" id="5841947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841952">Level</span><span class="op" id="5841957">:</span>&nbsp;<span class="ident" id="5841959">m</span><span class="op" id="5841960">.</span><span class="ident" id="5841961">Level</span><span class="op" id="5841966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841973">}</span><br>
<span class="lineno"></span><span class="op" id="5841975">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5841978">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5842058">//&nbsp;Named&nbsp;types</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842074">//&nbsp;baseTypeName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;base&nbsp;type&nbsp;of&nbsp;x&nbsp;(or&nbsp;&#34;&#34;)</span><br>
<span class="lineno">95</span><span class="comment" id="5842137">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;type&nbsp;is&nbsp;imported&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span><span class="comment" id="5842181">//</span><br>
<span class="lineno"></span><span class="keyword" id="5842184">func</span>&nbsp;<span class="ident" id="5842189">baseTypeName</span><span class="op" id="5842201">(</span><span class="ident" id="5842202">x</span>&nbsp;<span class="ident" id="5842204">ast</span><span class="op" id="5842207">.</span><span class="ident" id="5842208">Expr</span><span class="op" id="5842212">)</span>&nbsp;<span class="op" id="5842214">(</span><span class="ident" id="5842215">name</span>&nbsp;<span class="builtintype" id="5842220">string</span><span class="op" id="5842226">,</span>&nbsp;<span class="ident" id="5842228">imported</span>&nbsp;<span class="builtintype" id="5842237">bool</span><span class="op" id="5842241">)</span>&nbsp;<span class="op" id="5842243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842246">switch</span>&nbsp;<span class="ident" id="5842253">t</span>&nbsp;<span class="op" id="5842255">:=</span>&nbsp;<span class="ident" id="5842258">x</span><span class="op" id="5842259">.</span><span class="op" id="5842260">(</span><span class="keyword" id="5842261">type</span><span class="op" id="5842265">)</span>&nbsp;<span class="op" id="5842267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842270">case</span>&nbsp;<span class="op" id="5842275">*</span><span class="ident" id="5842276">ast</span><span class="op" id="5842279">.</span><span class="ident" id="5842280">Ident</span><span class="op" id="5842285">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842289">return</span>&nbsp;<span class="ident" id="5842296">t</span><span class="op" id="5842297">.</span><span class="ident" id="5842298">Name</span><span class="op" id="5842302">,</span>&nbsp;<span class="builtintype" id="5842304">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842311">case</span>&nbsp;<span class="op" id="5842316">*</span><span class="ident" id="5842317">ast</span><span class="op" id="5842320">.</span><span class="ident" id="5842321">SelectorExpr</span><span class="op" id="5842333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842337">if</span>&nbsp;<span class="ident" id="5842340">_</span><span class="op" id="5842341">,</span>&nbsp;<span class="ident" id="5842343">ok</span>&nbsp;<span class="op" id="5842346">:=</span>&nbsp;<span class="ident" id="5842349">t</span><span class="op" id="5842350">.</span><span class="ident" id="5842351">X</span><span class="op" id="5842352">.</span><span class="op" id="5842353">(</span><span class="op" id="5842354">*</span><span class="ident" id="5842355">ast</span><span class="op" id="5842358">.</span><span class="ident" id="5842359">Ident</span><span class="op" id="5842364">)</span><span class="op" id="5842365">;</span>&nbsp;<span class="ident" id="5842367">ok</span>&nbsp;<span class="op" id="5842370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5842375">//&nbsp;only&nbsp;possible&nbsp;for&nbsp;qualified&nbsp;type&nbsp;names;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5842421">//&nbsp;assume&nbsp;type&nbsp;is&nbsp;imported</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842451">return</span>&nbsp;<span class="ident" id="5842458">t</span><span class="op" id="5842459">.</span><span class="ident" id="5842460">Sel</span><span class="op" id="5842463">.</span><span class="ident" id="5842464">Name</span><span class="op" id="5842468">,</span>&nbsp;<span class="builtintype" id="5842470">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5842477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842480">case</span>&nbsp;<span class="op" id="5842485">*</span><span class="ident" id="5842486">ast</span><span class="op" id="5842489">.</span><span class="ident" id="5842490">StarExpr</span><span class="op" id="5842498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842502">return</span>&nbsp;<span class="ident" id="5842509">baseTypeName</span><span class="op" id="5842521">(</span><span class="ident" id="5842522">t</span><span class="op" id="5842523">.</span><span class="ident" id="5842524">X</span><span class="op" id="5842525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5842528">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842531">return</span><br>
<span class="lineno"></span><span class="op" id="5842538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842541">//&nbsp;An&nbsp;embeddedSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;embedded&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5842594">type</span>&nbsp;<span class="ident" id="5842599">embeddedSet</span>&nbsp;<span class="keyword" id="5842611">map</span><span class="op" id="5842614">[</span><span class="op" id="5842615">*</span><span class="ident" id="5842616">namedType</span><span class="op" id="5842625">]</span><span class="builtintype" id="5842626">bool</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5842632">//&nbsp;A&nbsp;namedType&nbsp;represents&nbsp;a&nbsp;named&nbsp;unqualified&nbsp;(package&nbsp;local,&nbsp;or&nbsp;possibly</span><br>
<span class="lineno"></span><span class="comment" id="5842706">//&nbsp;predeclared)&nbsp;type.&nbsp;The&nbsp;namedType&nbsp;for&nbsp;a&nbsp;type&nbsp;name&nbsp;is&nbsp;always&nbsp;found&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="5842778">//&nbsp;reader.lookupType.</span><br>
<span class="lineno"></span><span class="comment" id="5842800">//</span><br>
<span class="lineno">120</span><span class="keyword" id="5842803">type</span>&nbsp;<span class="ident" id="5842808">namedType</span>&nbsp;<span class="keyword" id="5842818">struct</span>&nbsp;<span class="op" id="5842825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842828">doc</span>&nbsp;&nbsp;<span class="builtintype" id="5842833">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5842846">//&nbsp;doc&nbsp;comment&nbsp;for&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842871">name</span>&nbsp;<span class="builtintype" id="5842876">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5842889">//&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842903">decl</span>&nbsp;<span class="op" id="5842908">*</span><span class="ident" id="5842909">ast</span><span class="op" id="5842912">.</span><span class="ident" id="5842913">GenDecl</span>&nbsp;<span class="comment" id="5842921">//&nbsp;nil&nbsp;if&nbsp;declaration&nbsp;hasn&#39;t&nbsp;been&nbsp;seen&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842966">isEmbedded</span>&nbsp;<span class="builtintype" id="5842977">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5842989">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843023">isStruct</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5843034">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5843046">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843080">embedded</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5843091">embeddedSet</span>&nbsp;<span class="comment" id="5843103">//&nbsp;true&nbsp;if&nbsp;the&nbsp;embedded&nbsp;type&nbsp;is&nbsp;a&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843147">//&nbsp;associated&nbsp;declarations</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843175">values</span>&nbsp;&nbsp;<span class="op" id="5843183">[</span><span class="op" id="5843184">]</span><span class="op" id="5843185">*</span><span class="ident" id="5843186">Value</span>&nbsp;<span class="comment" id="5843192">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843212">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5843220">methodSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843231">methods</span>&nbsp;<span class="ident" id="5843239">methodSet</span><br>
<span class="lineno"></span><span class="op" id="5843249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5843252">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5843332">//&nbsp;AST&nbsp;reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5843347">//&nbsp;reader&nbsp;accumulates&nbsp;documentation&nbsp;for&nbsp;a&nbsp;single&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="5843405">//&nbsp;It&nbsp;modifies&nbsp;the&nbsp;AST:&nbsp;Comments&nbsp;(declaration&nbsp;documentation)</span><br>
<span class="lineno">140</span><span class="comment" id="5843466">//&nbsp;that&nbsp;have&nbsp;been&nbsp;collected&nbsp;by&nbsp;the&nbsp;reader&nbsp;are&nbsp;set&nbsp;to&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="5843523">//&nbsp;in&nbsp;the&nbsp;respective&nbsp;AST&nbsp;nodes&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;printed</span><br>
<span class="lineno"></span><span class="comment" id="5843583">//&nbsp;twice&nbsp;(once&nbsp;when&nbsp;printing&nbsp;the&nbsp;documentation&nbsp;and&nbsp;once&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5843644">//&nbsp;printing&nbsp;the&nbsp;corresponding&nbsp;AST&nbsp;node).</span><br>
<span class="lineno"></span><span class="comment" id="5843685">//</span><br>
<span class="lineno">145</span><span class="keyword" id="5843688">type</span>&nbsp;<span class="ident" id="5843693">reader</span>&nbsp;<span class="keyword" id="5843700">struct</span>&nbsp;<span class="op" id="5843707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843710">mode</span>&nbsp;<span class="ident" id="5843715">Mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843722">//&nbsp;package&nbsp;properties</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843745">doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5843755">string</span>&nbsp;<span class="comment" id="5843762">//&nbsp;package&nbsp;documentation,&nbsp;if&nbsp;any</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843796">filenames</span>&nbsp;<span class="op" id="5843806">[</span><span class="op" id="5843807">]</span><span class="builtintype" id="5843808">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843816">notes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843826">map</span><span class="op" id="5843829">[</span><span class="builtintype" id="5843830">string</span><span class="op" id="5843836">]</span><span class="op" id="5843837">[</span><span class="op" id="5843838">]</span><span class="op" id="5843839">*</span><span class="ident" id="5843840">Note</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843847">//&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843864">imports</span>&nbsp;<span class="keyword" id="5843872">map</span><span class="op" id="5843875">[</span><span class="builtintype" id="5843876">string</span><span class="op" id="5843882">]</span><span class="builtintype" id="5843883">int</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843888">values</span>&nbsp;&nbsp;<span class="op" id="5843896">[</span><span class="op" id="5843897">]</span><span class="op" id="5843898">*</span><span class="ident" id="5843899">Value</span>&nbsp;<span class="comment" id="5843905">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843925">types</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5843933">map</span><span class="op" id="5843936">[</span><span class="builtintype" id="5843937">string</span><span class="op" id="5843943">]</span><span class="op" id="5843944">*</span><span class="ident" id="5843945">namedType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843956">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5843964">methodSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5843976">//&nbsp;support&nbsp;for&nbsp;package-local&nbsp;error&nbsp;type&nbsp;declarations</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844030">errorDecl</span>&nbsp;<span class="builtintype" id="5844040">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5844061">//&nbsp;if&nbsp;set,&nbsp;type&nbsp;&#34;error&#34;&nbsp;was&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844107">fixlist</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5844117">[</span><span class="op" id="5844118">]</span><span class="op" id="5844119">*</span><span class="ident" id="5844120">ast</span><span class="op" id="5844123">.</span><span class="ident" id="5844124">InterfaceType</span>&nbsp;<span class="comment" id="5844138">//&nbsp;list&nbsp;of&nbsp;interfaces&nbsp;containing&nbsp;anonymous&nbsp;field&nbsp;&#34;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="5844195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5844198">func</span>&nbsp;<span class="op" id="5844203">(</span><span class="ident" id="5844204">r</span>&nbsp;<span class="op" id="5844206">*</span><span class="ident" id="5844207">reader</span><span class="op" id="5844213">)</span>&nbsp;<span class="ident" id="5844215">isVisible</span><span class="op" id="5844224">(</span><span class="ident" id="5844225">name</span>&nbsp;<span class="builtintype" id="5844230">string</span><span class="op" id="5844236">)</span>&nbsp;<span class="builtintype" id="5844238">bool</span>&nbsp;<span class="op" id="5844243">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844246">return</span>&nbsp;<span class="ident" id="5844253">r</span><span class="op" id="5844254">.</span><span class="ident" id="5844255">mode</span><span class="op" id="5844259">&amp;</span><span class="ident" id="5844260">AllDecls</span>&nbsp;<span class="op" id="5844269">!=</span>&nbsp;<span class="num" id="5844272">0</span>&nbsp;<span class="op" id="5844274">||</span>&nbsp;<span class="ident" id="5844277">ast</span><span class="op" id="5844280">.</span><span class="ident" id="5844281">IsExported</span><span class="op" id="5844291">(</span><span class="ident" id="5844292">name</span><span class="op" id="5844296">)</span><br>
<span class="lineno"></span><span class="op" id="5844298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5844301">//&nbsp;lookupType&nbsp;returns&nbsp;the&nbsp;base&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="5844358">//&nbsp;If&nbsp;the&nbsp;base&nbsp;type&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;yet,&nbsp;a&nbsp;new</span><br>
<span class="lineno">170</span><span class="comment" id="5844414">//&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;but&nbsp;no&nbsp;associated&nbsp;declaration</span><br>
<span class="lineno"></span><span class="comment" id="5844472">//&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;type&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5844501">//</span><br>
<span class="lineno"></span><span class="keyword" id="5844504">func</span>&nbsp;<span class="op" id="5844509">(</span><span class="ident" id="5844510">r</span>&nbsp;<span class="op" id="5844512">*</span><span class="ident" id="5844513">reader</span><span class="op" id="5844519">)</span>&nbsp;<span class="ident" id="5844521">lookupType</span><span class="op" id="5844531">(</span><span class="ident" id="5844532">name</span>&nbsp;<span class="builtintype" id="5844537">string</span><span class="op" id="5844543">)</span>&nbsp;<span class="op" id="5844545">*</span><span class="ident" id="5844546">namedType</span>&nbsp;<span class="op" id="5844556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844559">if</span>&nbsp;<span class="ident" id="5844562">name</span>&nbsp;<span class="op" id="5844567">==</span>&nbsp;<span class="string" id="5844570">&#34;&#34;</span>&nbsp;<span class="op" id="5844573">||</span>&nbsp;<span class="ident" id="5844576">name</span>&nbsp;<span class="op" id="5844581">==</span>&nbsp;<span class="string" id="5844584">&#34;_&#34;</span>&nbsp;<span class="op" id="5844588">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844592">return</span>&nbsp;<span class="ident" id="5844599">nil</span>&nbsp;<span class="comment" id="5844603">//&nbsp;no&nbsp;type&nbsp;docs&nbsp;for&nbsp;anonymous&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5844640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844643">if</span>&nbsp;<span class="ident" id="5844646">typ</span><span class="op" id="5844649">,</span>&nbsp;<span class="ident" id="5844651">found</span>&nbsp;<span class="op" id="5844657">:=</span>&nbsp;<span class="ident" id="5844660">r</span><span class="op" id="5844661">.</span><span class="ident" id="5844662">types</span><span class="op" id="5844667">[</span><span class="ident" id="5844668">name</span><span class="op" id="5844672">]</span><span class="op" id="5844673">;</span>&nbsp;<span class="ident" id="5844675">found</span>&nbsp;<span class="op" id="5844681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844685">return</span>&nbsp;<span class="ident" id="5844692">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5844697">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5844700">//&nbsp;type&nbsp;not&nbsp;found&nbsp;-&nbsp;add&nbsp;one&nbsp;without&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844749">typ</span>&nbsp;<span class="op" id="5844753">:=</span>&nbsp;<span class="op" id="5844756">&amp;</span><span class="ident" id="5844757">namedType</span><span class="op" id="5844766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844770">name</span><span class="op" id="5844774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5844780">name</span><span class="op" id="5844784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844788">embedded</span><span class="op" id="5844796">:</span>&nbsp;<span class="builtinfunc" id="5844798">make</span><span class="op" id="5844802">(</span><span class="ident" id="5844803">embeddedSet</span><span class="op" id="5844814">)</span><span class="op" id="5844815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844819">funcs</span><span class="op" id="5844824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5844829">make</span><span class="op" id="5844833">(</span><span class="ident" id="5844834">methodSet</span><span class="op" id="5844843">)</span><span class="op" id="5844844">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844848">methods</span><span class="op" id="5844855">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="5844858">make</span><span class="op" id="5844862">(</span><span class="ident" id="5844863">methodSet</span><span class="op" id="5844872">)</span><span class="op" id="5844873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5844876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5844879">r</span><span class="op" id="5844880">.</span><span class="ident" id="5844881">types</span><span class="op" id="5844886">[</span><span class="ident" id="5844887">name</span><span class="op" id="5844891">]</span>&nbsp;<span class="op" id="5844893">=</span>&nbsp;<span class="ident" id="5844895">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844900">return</span>&nbsp;<span class="ident" id="5844907">typ</span><br>
<span class="lineno"></span><span class="op" id="5844911">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5844914">//&nbsp;recordAnonymousField&nbsp;registers&nbsp;fieldType&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5844976">//&nbsp;anonymous&nbsp;field&nbsp;in&nbsp;the&nbsp;parent&nbsp;type.&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5845040">//&nbsp;(qualified&nbsp;name)&nbsp;or&nbsp;the&nbsp;parent&nbsp;is&nbsp;nil,&nbsp;the&nbsp;field&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5845104">//&nbsp;The&nbsp;function&nbsp;returns&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">195</span><span class="comment" id="5845144">//</span><br>
<span class="lineno"></span><span class="keyword" id="5845147">func</span>&nbsp;<span class="op" id="5845152">(</span><span class="ident" id="5845153">r</span>&nbsp;<span class="op" id="5845155">*</span><span class="ident" id="5845156">reader</span><span class="op" id="5845162">)</span>&nbsp;<span class="ident" id="5845164">recordAnonymousField</span><span class="op" id="5845184">(</span><span class="ident" id="5845185">parent</span>&nbsp;<span class="op" id="5845192">*</span><span class="ident" id="5845193">namedType</span><span class="op" id="5845202">,</span>&nbsp;<span class="ident" id="5845204">fieldType</span>&nbsp;<span class="ident" id="5845214">ast</span><span class="op" id="5845217">.</span><span class="ident" id="5845218">Expr</span><span class="op" id="5845222">)</span>&nbsp;<span class="op" id="5845224">(</span><span class="ident" id="5845225">fname</span>&nbsp;<span class="builtintype" id="5845231">string</span><span class="op" id="5845237">)</span>&nbsp;<span class="op" id="5845239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845242">fname</span><span class="op" id="5845247">,</span>&nbsp;<span class="ident" id="5845249">imp</span>&nbsp;<span class="op" id="5845253">:=</span>&nbsp;<span class="ident" id="5845256">baseTypeName</span><span class="op" id="5845268">(</span><span class="ident" id="5845269">fieldType</span><span class="op" id="5845278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845281">if</span>&nbsp;<span class="ident" id="5845284">parent</span>&nbsp;<span class="op" id="5845291">==</span>&nbsp;<span class="ident" id="5845294">nil</span>&nbsp;<span class="op" id="5845298">||</span>&nbsp;<span class="ident" id="5845301">imp</span>&nbsp;<span class="op" id="5845305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845309">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5845317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845320">if</span>&nbsp;<span class="ident" id="5845323">ftype</span>&nbsp;<span class="op" id="5845329">:=</span>&nbsp;<span class="ident" id="5845332">r</span><span class="op" id="5845333">.</span><span class="ident" id="5845334">lookupType</span><span class="op" id="5845344">(</span><span class="ident" id="5845345">fname</span><span class="op" id="5845350">)</span><span class="op" id="5845351">;</span>&nbsp;<span class="ident" id="5845353">ftype</span>&nbsp;<span class="op" id="5845359">!=</span>&nbsp;<span class="ident" id="5845362">nil</span>&nbsp;<span class="op" id="5845366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845370">ftype</span><span class="op" id="5845375">.</span><span class="ident" id="5845376">isEmbedded</span>&nbsp;<span class="op" id="5845387">=</span>&nbsp;<span class="builtintype" id="5845389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845396">_</span><span class="op" id="5845397">,</span>&nbsp;<span class="ident" id="5845399">ptr</span>&nbsp;<span class="op" id="5845403">:=</span>&nbsp;<span class="ident" id="5845406">fieldType</span><span class="op" id="5845415">.</span><span class="op" id="5845416">(</span><span class="op" id="5845417">*</span><span class="ident" id="5845418">ast</span><span class="op" id="5845421">.</span><span class="ident" id="5845422">StarExpr</span><span class="op" id="5845430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845434">parent</span><span class="op" id="5845440">.</span><span class="ident" id="5845441">embedded</span><span class="op" id="5845449">[</span><span class="ident" id="5845450">ftype</span><span class="op" id="5845455">]</span>&nbsp;<span class="op" id="5845457">=</span>&nbsp;<span class="ident" id="5845459">ptr</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5845464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845467">return</span><br>
<span class="lineno"></span><span class="op" id="5845474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845477">func</span>&nbsp;<span class="op" id="5845482">(</span><span class="ident" id="5845483">r</span>&nbsp;<span class="op" id="5845485">*</span><span class="ident" id="5845486">reader</span><span class="op" id="5845492">)</span>&nbsp;<span class="ident" id="5845494">readDoc</span><span class="op" id="5845501">(</span><span class="ident" id="5845502">comment</span>&nbsp;<span class="op" id="5845510">*</span><span class="ident" id="5845511">ast</span><span class="op" id="5845514">.</span><span class="ident" id="5845515">CommentGroup</span><span class="op" id="5845527">)</span>&nbsp;<span class="op" id="5845529">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845532">//&nbsp;By&nbsp;convention&nbsp;there&nbsp;should&nbsp;be&nbsp;only&nbsp;one&nbsp;package&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845591">//&nbsp;but&nbsp;collect&nbsp;all&nbsp;of&nbsp;them&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;then&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845647">text</span>&nbsp;<span class="op" id="5845652">:=</span>&nbsp;<span class="ident" id="5845655">comment</span><span class="op" id="5845662">.</span><span class="ident" id="5845663">Text</span><span class="op" id="5845667">(</span><span class="op" id="5845668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845671">if</span>&nbsp;<span class="ident" id="5845674">r</span><span class="op" id="5845675">.</span><span class="ident" id="5845676">doc</span>&nbsp;<span class="op" id="5845680">==</span>&nbsp;<span class="string" id="5845683">&#34;&#34;</span>&nbsp;<span class="op" id="5845686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845690">r</span><span class="op" id="5845691">.</span><span class="ident" id="5845692">doc</span>&nbsp;<span class="op" id="5845696">=</span>&nbsp;<span class="ident" id="5845698">text</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845705">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5845713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845716">r</span><span class="op" id="5845717">.</span><span class="ident" id="5845718">doc</span>&nbsp;<span class="op" id="5845722">+=</span>&nbsp;<span class="string" id="5845725">&#34;\n&#34;</span>&nbsp;<span class="op" id="5845730">+</span>&nbsp;<span class="ident" id="5845732">text</span><br>
<span class="lineno"></span><span class="op" id="5845737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="5845740">func</span>&nbsp;<span class="op" id="5845745">(</span><span class="ident" id="5845746">r</span>&nbsp;<span class="op" id="5845748">*</span><span class="ident" id="5845749">reader</span><span class="op" id="5845755">)</span>&nbsp;<span class="ident" id="5845757">remember</span><span class="op" id="5845765">(</span><span class="ident" id="5845766">typ</span>&nbsp;<span class="op" id="5845770">*</span><span class="ident" id="5845771">ast</span><span class="op" id="5845774">.</span><span class="ident" id="5845775">InterfaceType</span><span class="op" id="5845788">)</span>&nbsp;<span class="op" id="5845790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845793">r</span><span class="op" id="5845794">.</span><span class="ident" id="5845795">fixlist</span>&nbsp;<span class="op" id="5845803">=</span>&nbsp;<span class="builtinfunc" id="5845805">append</span><span class="op" id="5845811">(</span><span class="ident" id="5845812">r</span><span class="op" id="5845813">.</span><span class="ident" id="5845814">fixlist</span><span class="op" id="5845821">,</span>&nbsp;<span class="ident" id="5845823">typ</span><span class="op" id="5845826">)</span><br>
<span class="lineno"></span><span class="op" id="5845828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5845831">func</span>&nbsp;<span class="ident" id="5845836">specNames</span><span class="op" id="5845845">(</span><span class="ident" id="5845846">specs</span>&nbsp;<span class="op" id="5845852">[</span><span class="op" id="5845853">]</span><span class="ident" id="5845854">ast</span><span class="op" id="5845857">.</span><span class="ident" id="5845858">Spec</span><span class="op" id="5845862">)</span>&nbsp;<span class="op" id="5845864">[</span><span class="op" id="5845865">]</span><span class="builtintype" id="5845866">string</span>&nbsp;<span class="op" id="5845873">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5845876">names</span>&nbsp;<span class="op" id="5845882">:=</span>&nbsp;<span class="builtinfunc" id="5845885">make</span><span class="op" id="5845889">(</span><span class="op" id="5845890">[</span><span class="op" id="5845891">]</span><span class="builtintype" id="5845892">string</span><span class="op" id="5845898">,</span>&nbsp;<span class="num" id="5845900">0</span><span class="op" id="5845901">,</span>&nbsp;<span class="builtinfunc" id="5845903">len</span><span class="op" id="5845906">(</span><span class="ident" id="5845907">specs</span><span class="op" id="5845912">)</span><span class="op" id="5845913">)</span>&nbsp;<span class="comment" id="5845915">//&nbsp;reasonable&nbsp;estimate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845939">for</span>&nbsp;<span class="ident" id="5845943">_</span><span class="op" id="5845944">,</span>&nbsp;<span class="ident" id="5845946">s</span>&nbsp;<span class="op" id="5845948">:=</span>&nbsp;<span class="keyword" id="5845951">range</span>&nbsp;<span class="ident" id="5845957">specs</span>&nbsp;<span class="op" id="5845963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5845967">//&nbsp;s&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;an&nbsp;*ast.ValueSpec&nbsp;by&nbsp;readValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846022">for</span>&nbsp;<span class="ident" id="5846026">_</span><span class="op" id="5846027">,</span>&nbsp;<span class="ident" id="5846029">ident</span>&nbsp;<span class="op" id="5846035">:=</span>&nbsp;<span class="keyword" id="5846038">range</span>&nbsp;<span class="ident" id="5846044">s</span><span class="op" id="5846045">.</span><span class="op" id="5846046">(</span><span class="op" id="5846047">*</span><span class="ident" id="5846048">ast</span><span class="op" id="5846051">.</span><span class="ident" id="5846052">ValueSpec</span><span class="op" id="5846061">)</span><span class="op" id="5846062">.</span><span class="ident" id="5846063">Names</span>&nbsp;<span class="op" id="5846069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846074">names</span>&nbsp;<span class="op" id="5846080">=</span>&nbsp;<span class="builtinfunc" id="5846082">append</span><span class="op" id="5846088">(</span><span class="ident" id="5846089">names</span><span class="op" id="5846094">,</span>&nbsp;<span class="ident" id="5846096">ident</span><span class="op" id="5846101">.</span><span class="ident" id="5846102">Name</span><span class="op" id="5846106">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5846110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5846113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846116">return</span>&nbsp;<span class="ident" id="5846123">names</span><br>
<span class="lineno"></span><span class="op" id="5846129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="5846132">//&nbsp;readValue&nbsp;processes&nbsp;a&nbsp;const&nbsp;or&nbsp;var&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5846183">//</span><br>
<span class="lineno"></span><span class="keyword" id="5846186">func</span>&nbsp;<span class="op" id="5846191">(</span><span class="ident" id="5846192">r</span>&nbsp;<span class="op" id="5846194">*</span><span class="ident" id="5846195">reader</span><span class="op" id="5846201">)</span>&nbsp;<span class="ident" id="5846203">readValue</span><span class="op" id="5846212">(</span><span class="ident" id="5846213">decl</span>&nbsp;<span class="op" id="5846218">*</span><span class="ident" id="5846219">ast</span><span class="op" id="5846222">.</span><span class="ident" id="5846223">GenDecl</span><span class="op" id="5846230">)</span>&nbsp;<span class="op" id="5846232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846235">//&nbsp;determine&nbsp;if&nbsp;decl&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846290">//&nbsp;Heuristic:&nbsp;For&nbsp;each&nbsp;typed&nbsp;entry,&nbsp;determine&nbsp;the&nbsp;type&nbsp;name,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;type&nbsp;name&nbsp;that&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequent,&nbsp;associate&nbsp;the&nbsp;decl&nbsp;with&nbsp;the&nbsp;respective&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846500">domName</span>&nbsp;<span class="op" id="5846508">:=</span>&nbsp;<span class="string" id="5846511">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846515">domFreq</span>&nbsp;<span class="op" id="5846523">:=</span>&nbsp;<span class="num" id="5846526">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846529">prev</span>&nbsp;<span class="op" id="5846534">:=</span>&nbsp;<span class="string" id="5846537">&#34;&#34;</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846541">n</span>&nbsp;<span class="op" id="5846543">:=</span>&nbsp;<span class="num" id="5846546">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846549">for</span>&nbsp;<span class="ident" id="5846553">_</span><span class="op" id="5846554">,</span>&nbsp;<span class="ident" id="5846556">spec</span>&nbsp;<span class="op" id="5846561">:=</span>&nbsp;<span class="keyword" id="5846564">range</span>&nbsp;<span class="ident" id="5846570">decl</span><span class="op" id="5846574">.</span><span class="ident" id="5846575">Specs</span>&nbsp;<span class="op" id="5846581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846585">s</span><span class="op" id="5846586">,</span>&nbsp;<span class="ident" id="5846588">ok</span>&nbsp;<span class="op" id="5846591">:=</span>&nbsp;<span class="ident" id="5846594">spec</span><span class="op" id="5846598">.</span><span class="op" id="5846599">(</span><span class="op" id="5846600">*</span><span class="ident" id="5846601">ast</span><span class="op" id="5846604">.</span><span class="ident" id="5846605">ValueSpec</span><span class="op" id="5846614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846618">if</span>&nbsp;<span class="op" id="5846621">!</span><span class="ident" id="5846622">ok</span>&nbsp;<span class="op" id="5846625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846630">continue</span>&nbsp;<span class="comment" id="5846639">//&nbsp;should&nbsp;not&nbsp;happen,&nbsp;but&nbsp;be&nbsp;conservative</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5846683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846687">name</span>&nbsp;<span class="op" id="5846692">:=</span>&nbsp;<span class="string" id="5846695">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846700">switch</span>&nbsp;<span class="op" id="5846707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846711">case</span>&nbsp;<span class="ident" id="5846716">s</span><span class="op" id="5846717">.</span><span class="ident" id="5846718">Type</span>&nbsp;<span class="op" id="5846723">!=</span>&nbsp;<span class="ident" id="5846726">nil</span><span class="op" id="5846729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846734">//&nbsp;a&nbsp;type&nbsp;is&nbsp;present;&nbsp;determine&nbsp;its&nbsp;name</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846778">if</span>&nbsp;<span class="ident" id="5846781">n</span><span class="op" id="5846782">,</span>&nbsp;<span class="ident" id="5846784">imp</span>&nbsp;<span class="op" id="5846788">:=</span>&nbsp;<span class="ident" id="5846791">baseTypeName</span><span class="op" id="5846803">(</span><span class="ident" id="5846804">s</span><span class="op" id="5846805">.</span><span class="ident" id="5846806">Type</span><span class="op" id="5846810">)</span><span class="op" id="5846811">;</span>&nbsp;<span class="op" id="5846813">!</span><span class="ident" id="5846814">imp</span>&nbsp;<span class="op" id="5846818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5846824">name</span>&nbsp;<span class="op" id="5846829">=</span>&nbsp;<span class="ident" id="5846831">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5846836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5846840">case</span>&nbsp;<span class="ident" id="5846845">decl</span><span class="op" id="5846849">.</span><span class="ident" id="5846850">Tok</span>&nbsp;<span class="op" id="5846854">==</span>&nbsp;<span class="ident" id="5846857">token</span><span class="op" id="5846862">.</span><span class="ident" id="5846863">CONST</span><span class="op" id="5846868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846873">//&nbsp;no&nbsp;type&nbsp;is&nbsp;present&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;constant&nbsp;declaration;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846934">//&nbsp;use&nbsp;the&nbsp;previous&nbsp;type&nbsp;name&nbsp;(w/o&nbsp;more&nbsp;type&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5846994">//&nbsp;we&nbsp;cannot&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;unnamed&nbsp;variables&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847052">//&nbsp;initializer&nbsp;expressions&nbsp;except&nbsp;for&nbsp;some&nbsp;trivial&nbsp;cases)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847113">name</span>&nbsp;<span class="op" id="5847118">=</span>&nbsp;<span class="ident" id="5847120">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847127">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847131">if</span>&nbsp;<span class="ident" id="5847134">name</span>&nbsp;<span class="op" id="5847139">!=</span>&nbsp;<span class="string" id="5847142">&#34;&#34;</span>&nbsp;<span class="op" id="5847145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847150">//&nbsp;entry&nbsp;has&nbsp;a&nbsp;named&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847179">if</span>&nbsp;<span class="ident" id="5847182">domName</span>&nbsp;<span class="op" id="5847190">!=</span>&nbsp;<span class="string" id="5847193">&#34;&#34;</span>&nbsp;<span class="op" id="5847196">&amp;&amp;</span>&nbsp;<span class="ident" id="5847199">domName</span>&nbsp;<span class="op" id="5847207">!=</span>&nbsp;<span class="ident" id="5847210">name</span>&nbsp;<span class="op" id="5847215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847221">//&nbsp;more&nbsp;than&nbsp;one&nbsp;type&nbsp;name&nbsp;-&nbsp;do&nbsp;not&nbsp;associate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847271">//&nbsp;with&nbsp;any&nbsp;type</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847292">domName</span>&nbsp;<span class="op" id="5847300">=</span>&nbsp;<span class="string" id="5847302">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847309">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847323">domName</span>&nbsp;<span class="op" id="5847331">=</span>&nbsp;<span class="ident" id="5847333">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847341">domFreq</span><span class="op" id="5847348">++</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847357">prev</span>&nbsp;<span class="op" id="5847362">=</span>&nbsp;<span class="ident" id="5847364">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847371">n</span><span class="op" id="5847372">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847380">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;w/o&nbsp;a&nbsp;legal&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847422">if</span>&nbsp;<span class="ident" id="5847425">n</span>&nbsp;<span class="op" id="5847427">==</span>&nbsp;<span class="num" id="5847430">0</span>&nbsp;<span class="op" id="5847432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847436">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847448">//&nbsp;determine&nbsp;values&nbsp;list&nbsp;with&nbsp;which&nbsp;to&nbsp;associate&nbsp;the&nbsp;Value&nbsp;for&nbsp;this&nbsp;decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847522">values</span>&nbsp;<span class="op" id="5847529">:=</span>&nbsp;<span class="op" id="5847532">&amp;</span><span class="ident" id="5847533">r</span><span class="op" id="5847534">.</span><span class="ident" id="5847535">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847543">const</span>&nbsp;<span class="ident" id="5847549">threshold</span>&nbsp;<span class="op" id="5847559">=</span>&nbsp;<span class="num" id="5847561">0.75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847567">if</span>&nbsp;<span class="ident" id="5847570">domName</span>&nbsp;<span class="op" id="5847578">!=</span>&nbsp;<span class="string" id="5847581">&#34;&#34;</span>&nbsp;<span class="op" id="5847584">&amp;&amp;</span>&nbsp;<span class="ident" id="5847587">r</span><span class="op" id="5847588">.</span><span class="ident" id="5847589">isVisible</span><span class="op" id="5847598">(</span><span class="ident" id="5847599">domName</span><span class="op" id="5847606">)</span>&nbsp;<span class="op" id="5847608">&amp;&amp;</span>&nbsp;<span class="ident" id="5847611">domFreq</span>&nbsp;<span class="op" id="5847619">&gt;=</span>&nbsp;<span class="builtintype" id="5847622">int</span><span class="op" id="5847625">(</span><span class="builtintype" id="5847626">float64</span><span class="op" id="5847633">(</span><span class="builtinfunc" id="5847634">len</span><span class="op" id="5847637">(</span><span class="ident" id="5847638">decl</span><span class="op" id="5847642">.</span><span class="ident" id="5847643">Specs</span><span class="op" id="5847648">)</span><span class="op" id="5847649">)</span><span class="op" id="5847650">*</span><span class="ident" id="5847651">threshold</span><span class="op" id="5847660">)</span>&nbsp;<span class="op" id="5847662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5847666">//&nbsp;typed&nbsp;entries&nbsp;are&nbsp;sufficiently&nbsp;frequent</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5847711">if</span>&nbsp;<span class="ident" id="5847714">typ</span>&nbsp;<span class="op" id="5847718">:=</span>&nbsp;<span class="ident" id="5847721">r</span><span class="op" id="5847722">.</span><span class="ident" id="5847723">lookupType</span><span class="op" id="5847733">(</span><span class="ident" id="5847734">domName</span><span class="op" id="5847741">)</span><span class="op" id="5847742">;</span>&nbsp;<span class="ident" id="5847744">typ</span>&nbsp;<span class="op" id="5847748">!=</span>&nbsp;<span class="ident" id="5847751">nil</span>&nbsp;<span class="op" id="5847755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847760">values</span>&nbsp;<span class="op" id="5847767">=</span>&nbsp;<span class="op" id="5847769">&amp;</span><span class="ident" id="5847770">typ</span><span class="op" id="5847773">.</span><span class="ident" id="5847774">values</span>&nbsp;<span class="comment" id="5847781">//&nbsp;associate&nbsp;with&nbsp;that&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847818">*</span><span class="ident" id="5847819">values</span>&nbsp;<span class="op" id="5847826">=</span>&nbsp;<span class="builtinfunc" id="5847828">append</span><span class="op" id="5847834">(</span><span class="op" id="5847835">*</span><span class="ident" id="5847836">values</span><span class="op" id="5847842">,</span>&nbsp;<span class="op" id="5847844">&amp;</span><span class="ident" id="5847845">Value</span><span class="op" id="5847850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847854">Doc</span><span class="op" id="5847857">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5847861">decl</span><span class="op" id="5847865">.</span><span class="ident" id="5847866">Doc</span><span class="op" id="5847869">.</span><span class="ident" id="5847870">Text</span><span class="op" id="5847874">(</span><span class="op" id="5847875">)</span><span class="op" id="5847876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847880">Names</span><span class="op" id="5847885">:</span>&nbsp;<span class="ident" id="5847887">specNames</span><span class="op" id="5847896">(</span><span class="ident" id="5847897">decl</span><span class="op" id="5847901">.</span><span class="ident" id="5847902">Specs</span><span class="op" id="5847907">)</span><span class="op" id="5847908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847912">Decl</span><span class="op" id="5847916">:</span>&nbsp;&nbsp;<span class="ident" id="5847919">decl</span><span class="op" id="5847923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847927">order</span><span class="op" id="5847932">:</span>&nbsp;<span class="builtinfunc" id="5847934">len</span><span class="op" id="5847937">(</span><span class="op" id="5847938">*</span><span class="ident" id="5847939">values</span><span class="op" id="5847945">)</span><span class="op" id="5847946">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5847949">}</span><span class="op" id="5847950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5847953">decl</span><span class="op" id="5847957">.</span><span class="ident" id="5847958">Doc</span>&nbsp;<span class="op" id="5847962">=</span>&nbsp;<span class="ident" id="5847964">nil</span>&nbsp;<span class="comment" id="5847968">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5848002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848005">//&nbsp;fields&nbsp;returns&nbsp;a&nbsp;struct&#39;s&nbsp;fields&nbsp;or&nbsp;an&nbsp;interface&#39;s&nbsp;methods.</span><br>
<span class="lineno">305</span><span class="comment" id="5848068">//</span><br>
<span class="lineno"></span><span class="keyword" id="5848071">func</span>&nbsp;<span class="ident" id="5848076">fields</span><span class="op" id="5848082">(</span><span class="ident" id="5848083">typ</span>&nbsp;<span class="ident" id="5848087">ast</span><span class="op" id="5848090">.</span><span class="ident" id="5848091">Expr</span><span class="op" id="5848095">)</span>&nbsp;<span class="op" id="5848097">(</span><span class="ident" id="5848098">list</span>&nbsp;<span class="op" id="5848103">[</span><span class="op" id="5848104">]</span><span class="op" id="5848105">*</span><span class="ident" id="5848106">ast</span><span class="op" id="5848109">.</span><span class="ident" id="5848110">Field</span><span class="op" id="5848115">,</span>&nbsp;<span class="ident" id="5848117">isStruct</span>&nbsp;<span class="builtintype" id="5848126">bool</span><span class="op" id="5848130">)</span>&nbsp;<span class="op" id="5848132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848135">var</span>&nbsp;<span class="ident" id="5848139">fields</span>&nbsp;<span class="op" id="5848146">*</span><span class="ident" id="5848147">ast</span><span class="op" id="5848150">.</span><span class="ident" id="5848151">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848162">switch</span>&nbsp;<span class="ident" id="5848169">t</span>&nbsp;<span class="op" id="5848171">:=</span>&nbsp;<span class="ident" id="5848174">typ</span><span class="op" id="5848177">.</span><span class="op" id="5848178">(</span><span class="keyword" id="5848179">type</span><span class="op" id="5848183">)</span>&nbsp;<span class="op" id="5848185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848188">case</span>&nbsp;<span class="op" id="5848193">*</span><span class="ident" id="5848194">ast</span><span class="op" id="5848197">.</span><span class="ident" id="5848198">StructType</span><span class="op" id="5848208">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848212">fields</span>&nbsp;<span class="op" id="5848219">=</span>&nbsp;<span class="ident" id="5848221">t</span><span class="op" id="5848222">.</span><span class="ident" id="5848223">Fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848232">isStruct</span>&nbsp;<span class="op" id="5848241">=</span>&nbsp;<span class="builtintype" id="5848243">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848249">case</span>&nbsp;<span class="op" id="5848254">*</span><span class="ident" id="5848255">ast</span><span class="op" id="5848258">.</span><span class="ident" id="5848259">InterfaceType</span><span class="op" id="5848272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848276">fields</span>&nbsp;<span class="op" id="5848283">=</span>&nbsp;<span class="ident" id="5848285">t</span><span class="op" id="5848286">.</span><span class="ident" id="5848287">Methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848296">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848299">if</span>&nbsp;<span class="ident" id="5848302">fields</span>&nbsp;<span class="op" id="5848309">!=</span>&nbsp;<span class="ident" id="5848312">nil</span>&nbsp;<span class="op" id="5848316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848320">list</span>&nbsp;<span class="op" id="5848325">=</span>&nbsp;<span class="ident" id="5848327">fields</span><span class="op" id="5848333">.</span><span class="ident" id="5848334">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848343">return</span><br>
<span class="lineno"></span><span class="op" id="5848350">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5848353">//&nbsp;readType&nbsp;processes&nbsp;a&nbsp;type&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5848395">//</span><br>
<span class="lineno"></span><span class="keyword" id="5848398">func</span>&nbsp;<span class="op" id="5848403">(</span><span class="ident" id="5848404">r</span>&nbsp;<span class="op" id="5848406">*</span><span class="ident" id="5848407">reader</span><span class="op" id="5848413">)</span>&nbsp;<span class="ident" id="5848415">readType</span><span class="op" id="5848423">(</span><span class="ident" id="5848424">decl</span>&nbsp;<span class="op" id="5848429">*</span><span class="ident" id="5848430">ast</span><span class="op" id="5848433">.</span><span class="ident" id="5848434">GenDecl</span><span class="op" id="5848441">,</span>&nbsp;<span class="ident" id="5848443">spec</span>&nbsp;<span class="op" id="5848448">*</span><span class="ident" id="5848449">ast</span><span class="op" id="5848452">.</span><span class="ident" id="5848453">TypeSpec</span><span class="op" id="5848461">)</span>&nbsp;<span class="op" id="5848463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848466">typ</span>&nbsp;<span class="op" id="5848470">:=</span>&nbsp;<span class="ident" id="5848473">r</span><span class="op" id="5848474">.</span><span class="ident" id="5848475">lookupType</span><span class="op" id="5848485">(</span><span class="ident" id="5848486">spec</span><span class="op" id="5848490">.</span><span class="ident" id="5848491">Name</span><span class="op" id="5848495">.</span><span class="ident" id="5848496">Name</span><span class="op" id="5848500">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848503">if</span>&nbsp;<span class="ident" id="5848506">typ</span>&nbsp;<span class="op" id="5848510">==</span>&nbsp;<span class="ident" id="5848513">nil</span>&nbsp;<span class="op" id="5848517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848521">return</span>&nbsp;<span class="comment" id="5848528">//&nbsp;no&nbsp;name&nbsp;or&nbsp;blank&nbsp;name&nbsp;-&nbsp;ignore&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848576">//&nbsp;A&nbsp;type&nbsp;should&nbsp;be&nbsp;added&nbsp;at&nbsp;most&nbsp;once,&nbsp;so&nbsp;typ.decl</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848629">//&nbsp;should&nbsp;be&nbsp;nil&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;not,&nbsp;simply&nbsp;overwrite&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848684">typ</span><span class="op" id="5848687">.</span><span class="ident" id="5848688">decl</span>&nbsp;<span class="op" id="5848693">=</span>&nbsp;<span class="ident" id="5848695">decl</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848702">//&nbsp;compute&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848728">doc</span>&nbsp;<span class="op" id="5848732">:=</span>&nbsp;<span class="ident" id="5848735">spec</span><span class="op" id="5848739">.</span><span class="ident" id="5848740">Doc</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848745">spec</span><span class="op" id="5848749">.</span><span class="ident" id="5848750">Doc</span>&nbsp;<span class="op" id="5848754">=</span>&nbsp;<span class="ident" id="5848756">nil</span>&nbsp;<span class="comment" id="5848760">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848795">if</span>&nbsp;<span class="ident" id="5848798">doc</span>&nbsp;<span class="op" id="5848802">==</span>&nbsp;<span class="ident" id="5848805">nil</span>&nbsp;<span class="op" id="5848809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848813">//&nbsp;no&nbsp;doc&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec,&nbsp;use&nbsp;the&nbsp;declaration&nbsp;doc,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848883">doc</span>&nbsp;<span class="op" id="5848887">=</span>&nbsp;<span class="ident" id="5848889">decl</span><span class="op" id="5848893">.</span><span class="ident" id="5848894">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848899">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848902">decl</span><span class="op" id="5848906">.</span><span class="ident" id="5848907">Doc</span>&nbsp;<span class="op" id="5848911">=</span>&nbsp;<span class="ident" id="5848913">nil</span>&nbsp;<span class="comment" id="5848917">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848952">typ</span><span class="op" id="5848955">.</span><span class="ident" id="5848956">doc</span>&nbsp;<span class="op" id="5848960">=</span>&nbsp;<span class="ident" id="5848962">doc</span><span class="op" id="5848965">.</span><span class="ident" id="5848966">Text</span><span class="op" id="5848970">(</span><span class="op" id="5848971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5848975">//&nbsp;record&nbsp;anonymous&nbsp;fields&nbsp;(they&nbsp;may&nbsp;contribute&nbsp;methods)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849033">//&nbsp;(some&nbsp;fields&nbsp;may&nbsp;have&nbsp;been&nbsp;recorded&nbsp;already&nbsp;when&nbsp;filtering</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849096">//&nbsp;exports,&nbsp;but&nbsp;that&#39;s&nbsp;ok)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849124">var</span>&nbsp;<span class="ident" id="5849128">list</span>&nbsp;<span class="op" id="5849133">[</span><span class="op" id="5849134">]</span><span class="op" id="5849135">*</span><span class="ident" id="5849136">ast</span><span class="op" id="5849139">.</span><span class="ident" id="5849140">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849147">list</span><span class="op" id="5849151">,</span>&nbsp;<span class="ident" id="5849153">typ</span><span class="op" id="5849156">.</span><span class="ident" id="5849157">isStruct</span>&nbsp;<span class="op" id="5849166">=</span>&nbsp;<span class="ident" id="5849168">fields</span><span class="op" id="5849174">(</span><span class="ident" id="5849175">spec</span><span class="op" id="5849179">.</span><span class="ident" id="5849180">Type</span><span class="op" id="5849184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849187">for</span>&nbsp;<span class="ident" id="5849191">_</span><span class="op" id="5849192">,</span>&nbsp;<span class="ident" id="5849194">field</span>&nbsp;<span class="op" id="5849200">:=</span>&nbsp;<span class="keyword" id="5849203">range</span>&nbsp;<span class="ident" id="5849209">list</span>&nbsp;<span class="op" id="5849214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849218">if</span>&nbsp;<span class="builtinfunc" id="5849221">len</span><span class="op" id="5849224">(</span><span class="ident" id="5849225">field</span><span class="op" id="5849230">.</span><span class="ident" id="5849231">Names</span><span class="op" id="5849236">)</span>&nbsp;<span class="op" id="5849238">==</span>&nbsp;<span class="num" id="5849241">0</span>&nbsp;<span class="op" id="5849243">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849248">r</span><span class="op" id="5849249">.</span><span class="ident" id="5849250">recordAnonymousField</span><span class="op" id="5849270">(</span><span class="ident" id="5849271">typ</span><span class="op" id="5849274">,</span>&nbsp;<span class="ident" id="5849276">field</span><span class="op" id="5849281">.</span><span class="ident" id="5849282">Type</span><span class="op" id="5849286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849293">}</span><br>
<span class="lineno"></span><span class="op" id="5849295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="5849298">//&nbsp;readFunc&nbsp;processes&nbsp;a&nbsp;func&nbsp;or&nbsp;method&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5849350">//</span><br>
<span class="lineno"></span><span class="keyword" id="5849353">func</span>&nbsp;<span class="op" id="5849358">(</span><span class="ident" id="5849359">r</span>&nbsp;<span class="op" id="5849361">*</span><span class="ident" id="5849362">reader</span><span class="op" id="5849368">)</span>&nbsp;<span class="ident" id="5849370">readFunc</span><span class="op" id="5849378">(</span><span class="ident" id="5849379">fun</span>&nbsp;<span class="op" id="5849383">*</span><span class="ident" id="5849384">ast</span><span class="op" id="5849387">.</span><span class="ident" id="5849388">FuncDecl</span><span class="op" id="5849396">)</span>&nbsp;<span class="op" id="5849398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849401">//&nbsp;strip&nbsp;function&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849425">fun</span><span class="op" id="5849428">.</span><span class="ident" id="5849429">Body</span>&nbsp;<span class="op" id="5849434">=</span>&nbsp;<span class="ident" id="5849436">nil</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849442">//&nbsp;associate&nbsp;methods&nbsp;with&nbsp;the&nbsp;receiver&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849495">if</span>&nbsp;<span class="ident" id="5849498">fun</span><span class="op" id="5849501">.</span><span class="ident" id="5849502">Recv</span>&nbsp;<span class="op" id="5849507">!=</span>&nbsp;<span class="ident" id="5849510">nil</span>&nbsp;<span class="op" id="5849514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849518">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849530">recvTypeName</span><span class="op" id="5849542">,</span>&nbsp;<span class="ident" id="5849544">imp</span>&nbsp;<span class="op" id="5849548">:=</span>&nbsp;<span class="ident" id="5849551">baseTypeName</span><span class="op" id="5849563">(</span><span class="ident" id="5849564">fun</span><span class="op" id="5849567">.</span><span class="ident" id="5849568">Recv</span><span class="op" id="5849572">.</span><span class="ident" id="5849573">List</span><span class="op" id="5849577">[</span><span class="num" id="5849578">0</span><span class="op" id="5849579">]</span><span class="op" id="5849580">.</span><span class="ident" id="5849581">Type</span><span class="op" id="5849585">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849589">if</span>&nbsp;<span class="ident" id="5849592">imp</span>&nbsp;<span class="op" id="5849596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849601">//&nbsp;should&nbsp;not&nbsp;happen&nbsp;(incorrect&nbsp;AST);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849642">//&nbsp;don&#39;t&nbsp;show&nbsp;this&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849671">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849680">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849684">if</span>&nbsp;<span class="ident" id="5849687">typ</span>&nbsp;<span class="op" id="5849691">:=</span>&nbsp;<span class="ident" id="5849694">r</span><span class="op" id="5849695">.</span><span class="ident" id="5849696">lookupType</span><span class="op" id="5849706">(</span><span class="ident" id="5849707">recvTypeName</span><span class="op" id="5849719">)</span><span class="op" id="5849720">;</span>&nbsp;<span class="ident" id="5849722">typ</span>&nbsp;<span class="op" id="5849726">!=</span>&nbsp;<span class="ident" id="5849729">nil</span>&nbsp;<span class="op" id="5849733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849738">typ</span><span class="op" id="5849741">.</span><span class="ident" id="5849742">methods</span><span class="op" id="5849749">.</span><span class="ident" id="5849750">set</span><span class="op" id="5849753">(</span><span class="ident" id="5849754">fun</span><span class="op" id="5849757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849765">//&nbsp;otherwise&nbsp;ignore&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849798">//&nbsp;TODO(gri):&nbsp;There&nbsp;may&nbsp;be&nbsp;exported&nbsp;methods&nbsp;of&nbsp;non-exported&nbsp;types</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849866">//&nbsp;that&nbsp;can&nbsp;be&nbsp;called&nbsp;because&nbsp;of&nbsp;exported&nbsp;values&nbsp;(consts,&nbsp;vars,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5849935">//&nbsp;function&nbsp;results)&nbsp;of&nbsp;that&nbsp;type.&nbsp;Could&nbsp;determine&nbsp;if&nbsp;that&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850003">//&nbsp;case&nbsp;and&nbsp;then&nbsp;show&nbsp;those&nbsp;methods&nbsp;in&nbsp;an&nbsp;appropriate&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850076">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850080">//&nbsp;associate&nbsp;factory&nbsp;functions&nbsp;with&nbsp;the&nbsp;first&nbsp;visible&nbsp;result&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850155">if</span>&nbsp;<span class="ident" id="5850158">fun</span><span class="op" id="5850161">.</span><span class="ident" id="5850162">Type</span><span class="op" id="5850166">.</span><span class="ident" id="5850167">Results</span><span class="op" id="5850174">.</span><span class="ident" id="5850175">NumFields</span><span class="op" id="5850184">(</span><span class="op" id="5850185">)</span>&nbsp;<span class="op" id="5850187">&gt;=</span>&nbsp;<span class="num" id="5850190">1</span>&nbsp;<span class="op" id="5850192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850196">res</span>&nbsp;<span class="op" id="5850200">:=</span>&nbsp;<span class="ident" id="5850203">fun</span><span class="op" id="5850206">.</span><span class="ident" id="5850207">Type</span><span class="op" id="5850211">.</span><span class="ident" id="5850212">Results</span><span class="op" id="5850219">.</span><span class="ident" id="5850220">List</span><span class="op" id="5850224">[</span><span class="num" id="5850225">0</span><span class="op" id="5850226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850230">if</span>&nbsp;<span class="builtinfunc" id="5850233">len</span><span class="op" id="5850236">(</span><span class="ident" id="5850237">res</span><span class="op" id="5850240">.</span><span class="ident" id="5850241">Names</span><span class="op" id="5850246">)</span>&nbsp;<span class="op" id="5850248">&lt;=</span>&nbsp;<span class="num" id="5850251">1</span>&nbsp;<span class="op" id="5850253">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850258">//&nbsp;exactly&nbsp;one&nbsp;(named&nbsp;or&nbsp;anonymous)&nbsp;result&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850315">//&nbsp;with&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;result&nbsp;signature&nbsp;(there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850372">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;result)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850403">if</span>&nbsp;<span class="ident" id="5850406">n</span><span class="op" id="5850407">,</span>&nbsp;<span class="ident" id="5850409">imp</span>&nbsp;<span class="op" id="5850413">:=</span>&nbsp;<span class="ident" id="5850416">baseTypeName</span><span class="op" id="5850428">(</span><span class="ident" id="5850429">res</span><span class="op" id="5850432">.</span><span class="ident" id="5850433">Type</span><span class="op" id="5850437">)</span><span class="op" id="5850438">;</span>&nbsp;<span class="op" id="5850440">!</span><span class="ident" id="5850441">imp</span>&nbsp;<span class="op" id="5850445">&amp;&amp;</span>&nbsp;<span class="ident" id="5850448">r</span><span class="op" id="5850449">.</span><span class="ident" id="5850450">isVisible</span><span class="op" id="5850459">(</span><span class="ident" id="5850460">n</span><span class="op" id="5850461">)</span>&nbsp;<span class="op" id="5850463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850469">if</span>&nbsp;<span class="ident" id="5850472">typ</span>&nbsp;<span class="op" id="5850476">:=</span>&nbsp;<span class="ident" id="5850479">r</span><span class="op" id="5850480">.</span><span class="ident" id="5850481">lookupType</span><span class="op" id="5850491">(</span><span class="ident" id="5850492">n</span><span class="op" id="5850493">)</span><span class="op" id="5850494">;</span>&nbsp;<span class="ident" id="5850496">typ</span>&nbsp;<span class="op" id="5850500">!=</span>&nbsp;<span class="ident" id="5850503">nil</span>&nbsp;<span class="op" id="5850507">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850514">//&nbsp;associate&nbsp;function&nbsp;with&nbsp;typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850550">typ</span><span class="op" id="5850553">.</span><span class="ident" id="5850554">funcs</span><span class="op" id="5850559">.</span><span class="ident" id="5850560">set</span><span class="op" id="5850563">(</span><span class="ident" id="5850564">fun</span><span class="op" id="5850567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850590">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5850597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5850601">//&nbsp;just&nbsp;an&nbsp;ordinary&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850631">r</span><span class="op" id="5850632">.</span><span class="ident" id="5850633">funcs</span><span class="op" id="5850638">.</span><span class="ident" id="5850639">set</span><span class="op" id="5850642">(</span><span class="ident" id="5850643">fun</span><span class="op" id="5850646">)</span><br>
<span class="lineno">400</span><span class="op" id="5850648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5850651">var</span>&nbsp;<span class="op" id="5850655">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850658">noteMarker</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5850672">=</span>&nbsp;<span class="string" id="5850674">`([A-Z][A-Z]+)\(([^)]+)\):?`</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850722">//&nbsp;MARKER(uid),&nbsp;MARKER&nbsp;at&nbsp;least&nbsp;2&nbsp;chars,&nbsp;uid&nbsp;at&nbsp;least&nbsp;1&nbsp;char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850784">noteMarkerRx</span>&nbsp;&nbsp;<span class="op" id="5850798">=</span>&nbsp;<span class="ident" id="5850800">regexp</span><span class="op" id="5850806">.</span><span class="ident" id="5850807">MustCompile</span><span class="op" id="5850818">(</span><span class="string" id="5850819">`^[&nbsp;\t]*`</span>&nbsp;<span class="op" id="5850829">+</span>&nbsp;<span class="ident" id="5850831">noteMarker</span><span class="op" id="5850841">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5850848">//&nbsp;MARKER(uid)&nbsp;at&nbsp;text&nbsp;start</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5850878">noteCommentRx</span>&nbsp;<span class="op" id="5850892">=</span>&nbsp;<span class="ident" id="5850894">regexp</span><span class="op" id="5850900">.</span><span class="ident" id="5850901">MustCompile</span><span class="op" id="5850912">(</span><span class="string" id="5850913">`^/[/*][&nbsp;\t]*`</span>&nbsp;<span class="op" id="5850928">+</span>&nbsp;<span class="ident" id="5850930">noteMarker</span><span class="op" id="5850940">)</span>&nbsp;<span class="comment" id="5850942">//&nbsp;MARKER(uid)&nbsp;at&nbsp;comment&nbsp;start</span><br>
<span class="lineno"></span><span class="op" id="5850974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5850977">//&nbsp;readNote&nbsp;collects&nbsp;a&nbsp;single&nbsp;note&nbsp;from&nbsp;a&nbsp;sequence&nbsp;of&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5851041">//</span><br>
<span class="lineno">410</span><span class="keyword" id="5851044">func</span>&nbsp;<span class="op" id="5851049">(</span><span class="ident" id="5851050">r</span>&nbsp;<span class="op" id="5851052">*</span><span class="ident" id="5851053">reader</span><span class="op" id="5851059">)</span>&nbsp;<span class="ident" id="5851061">readNote</span><span class="op" id="5851069">(</span><span class="ident" id="5851070">list</span>&nbsp;<span class="op" id="5851075">[</span><span class="op" id="5851076">]</span><span class="op" id="5851077">*</span><span class="ident" id="5851078">ast</span><span class="op" id="5851081">.</span><span class="ident" id="5851082">Comment</span><span class="op" id="5851089">)</span>&nbsp;<span class="op" id="5851091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851094">text</span>&nbsp;<span class="op" id="5851099">:=</span>&nbsp;<span class="op" id="5851102">(</span><span class="op" id="5851103">&amp;</span><span class="ident" id="5851104">ast</span><span class="op" id="5851107">.</span><span class="ident" id="5851108">CommentGroup</span><span class="op" id="5851120">{</span><span class="ident" id="5851121">List</span><span class="op" id="5851125">:</span>&nbsp;<span class="ident" id="5851127">list</span><span class="op" id="5851131">}</span><span class="op" id="5851132">)</span><span class="op" id="5851133">.</span><span class="ident" id="5851134">Text</span><span class="op" id="5851138">(</span><span class="op" id="5851139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851142">if</span>&nbsp;<span class="ident" id="5851145">m</span>&nbsp;<span class="op" id="5851147">:=</span>&nbsp;<span class="ident" id="5851150">noteMarkerRx</span><span class="op" id="5851162">.</span><span class="ident" id="5851163">FindStringSubmatchIndex</span><span class="op" id="5851186">(</span><span class="ident" id="5851187">text</span><span class="op" id="5851191">)</span><span class="op" id="5851192">;</span>&nbsp;<span class="ident" id="5851194">m</span>&nbsp;<span class="op" id="5851196">!=</span>&nbsp;<span class="ident" id="5851199">nil</span>&nbsp;<span class="op" id="5851203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851207">//&nbsp;The&nbsp;note&nbsp;body&nbsp;starts&nbsp;after&nbsp;the&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851251">//&nbsp;We&nbsp;remove&nbsp;any&nbsp;formatting&nbsp;so&nbsp;that&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851298">//&nbsp;get&nbsp;spurious&nbsp;line&nbsp;breaks/indentation&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5851345">//&nbsp;showing&nbsp;the&nbsp;TODO&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851373">body</span>&nbsp;<span class="op" id="5851378">:=</span>&nbsp;<span class="ident" id="5851381">clean</span><span class="op" id="5851386">(</span><span class="ident" id="5851387">text</span><span class="op" id="5851391">[</span><span class="ident" id="5851392">m</span><span class="op" id="5851393">[</span><span class="num" id="5851394">1</span><span class="op" id="5851395">]</span><span class="op" id="5851396">:</span><span class="op" id="5851397">]</span><span class="op" id="5851398">,</span>&nbsp;<span class="ident" id="5851400">keepNL</span><span class="op" id="5851406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5851410">if</span>&nbsp;<span class="ident" id="5851413">body</span>&nbsp;<span class="op" id="5851418">!=</span>&nbsp;<span class="string" id="5851421">&#34;&#34;</span>&nbsp;<span class="op" id="5851424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851429">marker</span>&nbsp;<span class="op" id="5851436">:=</span>&nbsp;<span class="ident" id="5851439">text</span><span class="op" id="5851443">[</span><span class="ident" id="5851444">m</span><span class="op" id="5851445">[</span><span class="num" id="5851446">2</span><span class="op" id="5851447">]</span><span class="op" id="5851448">:</span><span class="ident" id="5851449">m</span><span class="op" id="5851450">[</span><span class="num" id="5851451">3</span><span class="op" id="5851452">]</span><span class="op" id="5851453">]</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851458">r</span><span class="op" id="5851459">.</span><span class="ident" id="5851460">notes</span><span class="op" id="5851465">[</span><span class="ident" id="5851466">marker</span><span class="op" id="5851472">]</span>&nbsp;<span class="op" id="5851474">=</span>&nbsp;<span class="builtinfunc" id="5851476">append</span><span class="op" id="5851482">(</span><span class="ident" id="5851483">r</span><span class="op" id="5851484">.</span><span class="ident" id="5851485">notes</span><span class="op" id="5851490">[</span><span class="ident" id="5851491">marker</span><span class="op" id="5851497">]</span><span class="op" id="5851498">,</span>&nbsp;<span class="op" id="5851500">&amp;</span><span class="ident" id="5851501">Note</span><span class="op" id="5851505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851511">Pos</span><span class="op" id="5851514">:</span>&nbsp;&nbsp;<span class="ident" id="5851517">list</span><span class="op" id="5851521">[</span><span class="num" id="5851522">0</span><span class="op" id="5851523">]</span><span class="op" id="5851524">.</span><span class="ident" id="5851525">Pos</span><span class="op" id="5851528">(</span><span class="op" id="5851529">)</span><span class="op" id="5851530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851536">End</span><span class="op" id="5851539">:</span>&nbsp;&nbsp;<span class="ident" id="5851542">list</span><span class="op" id="5851546">[</span><span class="builtinfunc" id="5851547">len</span><span class="op" id="5851550">(</span><span class="ident" id="5851551">list</span><span class="op" id="5851555">)</span><span class="op" id="5851556">-</span><span class="num" id="5851557">1</span><span class="op" id="5851558">]</span><span class="op" id="5851559">.</span><span class="ident" id="5851560">End</span><span class="op" id="5851563">(</span><span class="op" id="5851564">)</span><span class="op" id="5851565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851571">UID</span><span class="op" id="5851574">:</span>&nbsp;&nbsp;<span class="ident" id="5851577">text</span><span class="op" id="5851581">[</span><span class="ident" id="5851582">m</span><span class="op" id="5851583">[</span><span class="num" id="5851584">4</span><span class="op" id="5851585">]</span><span class="op" id="5851586">:</span><span class="ident" id="5851587">m</span><span class="op" id="5851588">[</span><span class="num" id="5851589">5</span><span class="op" id="5851590">]</span><span class="op" id="5851591">]</span><span class="op" id="5851592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5851598">Body</span><span class="op" id="5851602">:</span>&nbsp;<span class="ident" id="5851604">body</span><span class="op" id="5851608">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851613">}</span><span class="op" id="5851614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5851621">}</span><br>
<span class="lineno"></span><span class="op" id="5851623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5851626">//&nbsp;readNotes&nbsp;extracts&nbsp;notes&nbsp;from&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5851669">//&nbsp;A&nbsp;note&nbsp;must&nbsp;start&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;comment&nbsp;with&nbsp;&#34;MARKER(uid):&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5851740">//&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;the&nbsp;note&nbsp;body&nbsp;(e.g.,&nbsp;&#34;//&nbsp;BUG(gri):&nbsp;fix&nbsp;this&#34;).</span><br>
<span class="lineno"></span><span class="comment" id="5851809">//&nbsp;The&nbsp;note&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;comment&nbsp;group&nbsp;or&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5851877">//&nbsp;another&nbsp;note&nbsp;in&nbsp;the&nbsp;same&nbsp;comment&nbsp;group,&nbsp;whichever&nbsp;comes&nbsp;first.</span><br>
<span class="lineno">435</span><span class="comment" id="5851943">//</span><br>
<span class="lineno"></span><span class="keyword" id="5851946">func</span>&nbsp;<span class="op" id="5851951">(</span><span class="ident" id="5851952">r</span>&nbsp;<span class="op" id="5851954">*</span><span class="ident" id="5851955">reader</span><span class="op" id="5851961">)</span>&nbsp;<span class="ident" id="5851963">readNotes</span><span class="op" id="5851972">(</span><span class="ident" id="5851973">comments</span>&nbsp;<span class="op" id="5851982">[</span><span class="op" id="5851983">]</span><span class="op" id="5851984">*</span><span class="ident" id="5851985">ast</span><span class="op" id="5851988">.</span><span class="ident" id="5851989">CommentGroup</span><span class="op" id="5852001">)</span>&nbsp;<span class="op" id="5852003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852006">for</span>&nbsp;<span class="ident" id="5852010">_</span><span class="op" id="5852011">,</span>&nbsp;<span class="ident" id="5852013">group</span>&nbsp;<span class="op" id="5852019">:=</span>&nbsp;<span class="keyword" id="5852022">range</span>&nbsp;<span class="ident" id="5852028">comments</span>&nbsp;<span class="op" id="5852037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852041">i</span>&nbsp;<span class="op" id="5852043">:=</span>&nbsp;<span class="op" id="5852046">-</span><span class="num" id="5852047">1</span>&nbsp;<span class="comment" id="5852049">//&nbsp;comment&nbsp;index&nbsp;of&nbsp;most&nbsp;recent&nbsp;note&nbsp;start,&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852109">list</span>&nbsp;<span class="op" id="5852114">:=</span>&nbsp;<span class="ident" id="5852117">group</span><span class="op" id="5852122">.</span><span class="ident" id="5852123">List</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852130">for</span>&nbsp;<span class="ident" id="5852134">j</span><span class="op" id="5852135">,</span>&nbsp;<span class="ident" id="5852137">c</span>&nbsp;<span class="op" id="5852139">:=</span>&nbsp;<span class="keyword" id="5852142">range</span>&nbsp;<span class="ident" id="5852148">list</span>&nbsp;<span class="op" id="5852153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852158">if</span>&nbsp;<span class="ident" id="5852161">noteCommentRx</span><span class="op" id="5852174">.</span><span class="ident" id="5852175">MatchString</span><span class="op" id="5852186">(</span><span class="ident" id="5852187">c</span><span class="op" id="5852188">.</span><span class="ident" id="5852189">Text</span><span class="op" id="5852193">)</span>&nbsp;<span class="op" id="5852195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852201">if</span>&nbsp;<span class="ident" id="5852204">i</span>&nbsp;<span class="op" id="5852206">&gt;=</span>&nbsp;<span class="num" id="5852209">0</span>&nbsp;<span class="op" id="5852211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852218">r</span><span class="op" id="5852219">.</span><span class="ident" id="5852220">readNote</span><span class="op" id="5852228">(</span><span class="ident" id="5852229">list</span><span class="op" id="5852233">[</span><span class="ident" id="5852234">i</span><span class="op" id="5852235">:</span><span class="ident" id="5852236">j</span><span class="op" id="5852237">]</span><span class="op" id="5852238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852244">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852250">i</span>&nbsp;<span class="op" id="5852252">=</span>&nbsp;<span class="ident" id="5852254">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852267">if</span>&nbsp;<span class="ident" id="5852270">i</span>&nbsp;<span class="op" id="5852272">&gt;=</span>&nbsp;<span class="num" id="5852275">0</span>&nbsp;<span class="op" id="5852277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852282">r</span><span class="op" id="5852283">.</span><span class="ident" id="5852284">readNote</span><span class="op" id="5852292">(</span><span class="ident" id="5852293">list</span><span class="op" id="5852297">[</span><span class="ident" id="5852298">i</span><span class="op" id="5852299">:</span><span class="op" id="5852300">]</span><span class="op" id="5852301">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852308">}</span><br>
<span class="lineno"></span><span class="op" id="5852310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5852313">//&nbsp;readFile&nbsp;adds&nbsp;the&nbsp;AST&nbsp;for&nbsp;a&nbsp;source&nbsp;file&nbsp;to&nbsp;the&nbsp;reader.</span><br>
<span class="lineno">455</span><span class="comment" id="5852371">//</span><br>
<span class="lineno"></span><span class="keyword" id="5852374">func</span>&nbsp;<span class="op" id="5852379">(</span><span class="ident" id="5852380">r</span>&nbsp;<span class="op" id="5852382">*</span><span class="ident" id="5852383">reader</span><span class="op" id="5852389">)</span>&nbsp;<span class="ident" id="5852391">readFile</span><span class="op" id="5852399">(</span><span class="ident" id="5852400">src</span>&nbsp;<span class="op" id="5852404">*</span><span class="ident" id="5852405">ast</span><span class="op" id="5852408">.</span><span class="ident" id="5852409">File</span><span class="op" id="5852413">)</span>&nbsp;<span class="op" id="5852415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5852418">//&nbsp;add&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852448">if</span>&nbsp;<span class="ident" id="5852451">src</span><span class="op" id="5852454">.</span><span class="ident" id="5852455">Doc</span>&nbsp;<span class="op" id="5852459">!=</span>&nbsp;<span class="ident" id="5852462">nil</span>&nbsp;<span class="op" id="5852466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852470">r</span><span class="op" id="5852471">.</span><span class="ident" id="5852472">readDoc</span><span class="op" id="5852479">(</span><span class="ident" id="5852480">src</span><span class="op" id="5852483">.</span><span class="ident" id="5852484">Doc</span><span class="op" id="5852487">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852491">src</span><span class="op" id="5852494">.</span><span class="ident" id="5852495">Doc</span>&nbsp;<span class="op" id="5852499">=</span>&nbsp;<span class="ident" id="5852501">nil</span>&nbsp;<span class="comment" id="5852505">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5852544">//&nbsp;add&nbsp;all&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852569">for</span>&nbsp;<span class="ident" id="5852573">_</span><span class="op" id="5852574">,</span>&nbsp;<span class="ident" id="5852576">decl</span>&nbsp;<span class="op" id="5852581">:=</span>&nbsp;<span class="keyword" id="5852584">range</span>&nbsp;<span class="ident" id="5852590">src</span><span class="op" id="5852593">.</span><span class="ident" id="5852594">Decls</span>&nbsp;<span class="op" id="5852600">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852604">switch</span>&nbsp;<span class="ident" id="5852611">d</span>&nbsp;<span class="op" id="5852613">:=</span>&nbsp;<span class="ident" id="5852616">decl</span><span class="op" id="5852620">.</span><span class="op" id="5852621">(</span><span class="keyword" id="5852622">type</span><span class="op" id="5852626">)</span>&nbsp;<span class="op" id="5852628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852632">case</span>&nbsp;<span class="op" id="5852637">*</span><span class="ident" id="5852638">ast</span><span class="op" id="5852641">.</span><span class="ident" id="5852642">GenDecl</span><span class="op" id="5852649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852654">switch</span>&nbsp;<span class="ident" id="5852661">d</span><span class="op" id="5852662">.</span><span class="ident" id="5852663">Tok</span>&nbsp;<span class="op" id="5852667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852672">case</span>&nbsp;<span class="ident" id="5852677">token</span><span class="op" id="5852682">.</span><span class="ident" id="5852683">IMPORT</span><span class="op" id="5852689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5852695">//&nbsp;imports&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852735">for</span>&nbsp;<span class="ident" id="5852739">_</span><span class="op" id="5852740">,</span>&nbsp;<span class="ident" id="5852742">spec</span>&nbsp;<span class="op" id="5852747">:=</span>&nbsp;<span class="keyword" id="5852750">range</span>&nbsp;<span class="ident" id="5852756">d</span><span class="op" id="5852757">.</span><span class="ident" id="5852758">Specs</span>&nbsp;<span class="op" id="5852764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852771">if</span>&nbsp;<span class="ident" id="5852774">s</span><span class="op" id="5852775">,</span>&nbsp;<span class="ident" id="5852777">ok</span>&nbsp;<span class="op" id="5852780">:=</span>&nbsp;<span class="ident" id="5852783">spec</span><span class="op" id="5852787">.</span><span class="op" id="5852788">(</span><span class="op" id="5852789">*</span><span class="ident" id="5852790">ast</span><span class="op" id="5852793">.</span><span class="ident" id="5852794">ImportSpec</span><span class="op" id="5852804">)</span><span class="op" id="5852805">;</span>&nbsp;<span class="ident" id="5852807">ok</span>&nbsp;<span class="op" id="5852810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852818">if</span>&nbsp;<span class="ident" id="5852821">import_</span><span class="op" id="5852828">,</span>&nbsp;<span class="ident" id="5852830">err</span>&nbsp;<span class="op" id="5852834">:=</span>&nbsp;<span class="ident" id="5852837">strconv</span><span class="op" id="5852844">.</span><span class="ident" id="5852845">Unquote</span><span class="op" id="5852852">(</span><span class="ident" id="5852853">s</span><span class="op" id="5852854">.</span><span class="ident" id="5852855">Path</span><span class="op" id="5852859">.</span><span class="ident" id="5852860">Value</span><span class="op" id="5852865">)</span><span class="op" id="5852866">;</span>&nbsp;<span class="ident" id="5852868">err</span>&nbsp;<span class="op" id="5852872">==</span>&nbsp;<span class="ident" id="5852875">nil</span>&nbsp;<span class="op" id="5852879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5852888">r</span><span class="op" id="5852889">.</span><span class="ident" id="5852890">imports</span><span class="op" id="5852897">[</span><span class="ident" id="5852898">import_</span><span class="op" id="5852905">]</span>&nbsp;<span class="op" id="5852907">=</span>&nbsp;<span class="num" id="5852909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852917">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5852930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5852935">case</span>&nbsp;<span class="ident" id="5852940">token</span><span class="op" id="5852945">.</span><span class="ident" id="5852946">CONST</span><span class="op" id="5852951">,</span>&nbsp;<span class="ident" id="5852953">token</span><span class="op" id="5852958">.</span><span class="ident" id="5852959">VAR</span><span class="op" id="5852962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5852968">//&nbsp;constants&nbsp;and&nbsp;variables&nbsp;are&nbsp;always&nbsp;handled&nbsp;as&nbsp;a&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853029">r</span><span class="op" id="5853030">.</span><span class="ident" id="5853031">readValue</span><span class="op" id="5853040">(</span><span class="ident" id="5853041">d</span><span class="op" id="5853042">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853047">case</span>&nbsp;<span class="ident" id="5853052">token</span><span class="op" id="5853057">.</span><span class="ident" id="5853058">TYPE</span><span class="op" id="5853062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853068">//&nbsp;types&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853106">if</span>&nbsp;<span class="builtinfunc" id="5853109">len</span><span class="op" id="5853112">(</span><span class="ident" id="5853113">d</span><span class="op" id="5853114">.</span><span class="ident" id="5853115">Specs</span><span class="op" id="5853120">)</span>&nbsp;<span class="op" id="5853122">==</span>&nbsp;<span class="num" id="5853125">1</span>&nbsp;<span class="op" id="5853127">&amp;&amp;</span>&nbsp;<span class="op" id="5853130">!</span><span class="ident" id="5853131">d</span><span class="op" id="5853132">.</span><span class="ident" id="5853133">Lparen</span><span class="op" id="5853139">.</span><span class="ident" id="5853140">IsValid</span><span class="op" id="5853147">(</span><span class="op" id="5853148">)</span>&nbsp;<span class="op" id="5853150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853157">//&nbsp;common&nbsp;case:&nbsp;single&nbsp;declaration&nbsp;w/o&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853213">//&nbsp;(if&nbsp;a&nbsp;single&nbsp;declaration&nbsp;is&nbsp;parenthesized,</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853264">//&nbsp;create&nbsp;a&nbsp;new&nbsp;fake&nbsp;declaration&nbsp;below,&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853317">//&nbsp;go/doc&nbsp;type&nbsp;declarations&nbsp;always&nbsp;appear&nbsp;w/o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853368">//&nbsp;parentheses)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853389">if</span>&nbsp;<span class="ident" id="5853392">s</span><span class="op" id="5853393">,</span>&nbsp;<span class="ident" id="5853395">ok</span>&nbsp;<span class="op" id="5853398">:=</span>&nbsp;<span class="ident" id="5853401">d</span><span class="op" id="5853402">.</span><span class="ident" id="5853403">Specs</span><span class="op" id="5853408">[</span><span class="num" id="5853409">0</span><span class="op" id="5853410">]</span><span class="op" id="5853411">.</span><span class="op" id="5853412">(</span><span class="op" id="5853413">*</span><span class="ident" id="5853414">ast</span><span class="op" id="5853417">.</span><span class="ident" id="5853418">TypeSpec</span><span class="op" id="5853426">)</span><span class="op" id="5853427">;</span>&nbsp;<span class="ident" id="5853429">ok</span>&nbsp;<span class="op" id="5853432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853440">r</span><span class="op" id="5853441">.</span><span class="ident" id="5853442">readType</span><span class="op" id="5853450">(</span><span class="ident" id="5853451">d</span><span class="op" id="5853452">,</span>&nbsp;<span class="ident" id="5853454">s</span><span class="op" id="5853455">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5853462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853469">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5853479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853485">for</span>&nbsp;<span class="ident" id="5853489">_</span><span class="op" id="5853490">,</span>&nbsp;<span class="ident" id="5853492">spec</span>&nbsp;<span class="op" id="5853497">:=</span>&nbsp;<span class="keyword" id="5853500">range</span>&nbsp;<span class="ident" id="5853506">d</span><span class="op" id="5853507">.</span><span class="ident" id="5853508">Specs</span>&nbsp;<span class="op" id="5853514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5853521">if</span>&nbsp;<span class="ident" id="5853524">s</span><span class="op" id="5853525">,</span>&nbsp;<span class="ident" id="5853527">ok</span>&nbsp;<span class="op" id="5853530">:=</span>&nbsp;<span class="ident" id="5853533">spec</span><span class="op" id="5853537">.</span><span class="op" id="5853538">(</span><span class="op" id="5853539">*</span><span class="ident" id="5853540">ast</span><span class="op" id="5853543">.</span><span class="ident" id="5853544">TypeSpec</span><span class="op" id="5853552">)</span><span class="op" id="5853553">;</span>&nbsp;<span class="ident" id="5853555">ok</span>&nbsp;<span class="op" id="5853558">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853566">//&nbsp;use&nbsp;an&nbsp;individual&nbsp;(possibly&nbsp;fake)&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853621">//&nbsp;for&nbsp;each&nbsp;type;&nbsp;this&nbsp;also&nbsp;ensures&nbsp;that&nbsp;each&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853678">//&nbsp;gets&nbsp;to&nbsp;(re-)use&nbsp;the&nbsp;declaration&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853734">//&nbsp;if&nbsp;there&#39;s&nbsp;none&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853791">fake</span>&nbsp;<span class="op" id="5853796">:=</span>&nbsp;<span class="op" id="5853799">&amp;</span><span class="ident" id="5853800">ast</span><span class="op" id="5853803">.</span><span class="ident" id="5853804">GenDecl</span><span class="op" id="5853811">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5853820">Doc</span><span class="op" id="5853823">:</span>&nbsp;<span class="ident" id="5853825">d</span><span class="op" id="5853826">.</span><span class="ident" id="5853827">Doc</span><span class="op" id="5853830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853839">//&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;existing&nbsp;TokPos&nbsp;because&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853890">//&nbsp;will&nbsp;lead&nbsp;to&nbsp;the&nbsp;wrong&nbsp;selection&nbsp;range&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853943">//&nbsp;the&nbsp;fake&nbsp;declaration&nbsp;if&nbsp;there&nbsp;are&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5853992">//&nbsp;than&nbsp;one&nbsp;type&nbsp;in&nbsp;the&nbsp;group&nbsp;(this&nbsp;affects</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854043">//&nbsp;src/cmd/godoc/godoc.go&#39;s&nbsp;posLink_urlFunc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854095">TokPos</span><span class="op" id="5854101">:</span>&nbsp;<span class="ident" id="5854103">s</span><span class="op" id="5854104">.</span><span class="ident" id="5854105">Pos</span><span class="op" id="5854108">(</span><span class="op" id="5854109">)</span><span class="op" id="5854110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854119">Tok</span><span class="op" id="5854122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5854127">token</span><span class="op" id="5854132">.</span><span class="ident" id="5854133">TYPE</span><span class="op" id="5854137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854146">Specs</span><span class="op" id="5854151">:</span>&nbsp;&nbsp;<span class="op" id="5854154">[</span><span class="op" id="5854155">]</span><span class="ident" id="5854156">ast</span><span class="op" id="5854159">.</span><span class="ident" id="5854160">Spec</span><span class="op" id="5854164">{</span><span class="ident" id="5854165">s</span><span class="op" id="5854166">}</span><span class="op" id="5854167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854175">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854183">r</span><span class="op" id="5854184">.</span><span class="ident" id="5854185">readType</span><span class="op" id="5854193">(</span><span class="ident" id="5854194">fake</span><span class="op" id="5854198">,</span>&nbsp;<span class="ident" id="5854200">s</span><span class="op" id="5854201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854223">case</span>&nbsp;<span class="op" id="5854228">*</span><span class="ident" id="5854229">ast</span><span class="op" id="5854232">.</span><span class="ident" id="5854233">FuncDecl</span><span class="op" id="5854241">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854246">r</span><span class="op" id="5854247">.</span><span class="ident" id="5854248">readFunc</span><span class="op" id="5854256">(</span><span class="ident" id="5854257">d</span><span class="op" id="5854258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854269">//&nbsp;collect&nbsp;MARKER(...):&nbsp;annotations</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854306">r</span><span class="op" id="5854307">.</span><span class="ident" id="5854308">readNotes</span><span class="op" id="5854317">(</span><span class="ident" id="5854318">src</span><span class="op" id="5854321">.</span><span class="ident" id="5854322">Comments</span><span class="op" id="5854330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854333">src</span><span class="op" id="5854336">.</span><span class="ident" id="5854337">Comments</span>&nbsp;<span class="op" id="5854346">=</span>&nbsp;<span class="ident" id="5854348">nil</span>&nbsp;<span class="comment" id="5854352">//&nbsp;consumed&nbsp;unassociated&nbsp;comments&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5854404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5854407">func</span>&nbsp;<span class="op" id="5854412">(</span><span class="ident" id="5854413">r</span>&nbsp;<span class="op" id="5854415">*</span><span class="ident" id="5854416">reader</span><span class="op" id="5854422">)</span>&nbsp;<span class="ident" id="5854424">readPackage</span><span class="op" id="5854435">(</span><span class="ident" id="5854436">pkg</span>&nbsp;<span class="op" id="5854440">*</span><span class="ident" id="5854441">ast</span><span class="op" id="5854444">.</span><span class="ident" id="5854445">Package</span><span class="op" id="5854452">,</span>&nbsp;<span class="ident" id="5854454">mode</span>&nbsp;<span class="ident" id="5854459">Mode</span><span class="op" id="5854463">)</span>&nbsp;<span class="op" id="5854465">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854468">//&nbsp;initialize&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854490">r</span><span class="op" id="5854491">.</span><span class="ident" id="5854492">filenames</span>&nbsp;<span class="op" id="5854502">=</span>&nbsp;<span class="builtinfunc" id="5854504">make</span><span class="op" id="5854508">(</span><span class="op" id="5854509">[</span><span class="op" id="5854510">]</span><span class="builtintype" id="5854511">string</span><span class="op" id="5854517">,</span>&nbsp;<span class="builtinfunc" id="5854519">len</span><span class="op" id="5854522">(</span><span class="ident" id="5854523">pkg</span><span class="op" id="5854526">.</span><span class="ident" id="5854527">Files</span><span class="op" id="5854532">)</span><span class="op" id="5854533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854536">r</span><span class="op" id="5854537">.</span><span class="ident" id="5854538">imports</span>&nbsp;<span class="op" id="5854546">=</span>&nbsp;<span class="builtinfunc" id="5854548">make</span><span class="op" id="5854552">(</span><span class="keyword" id="5854553">map</span><span class="op" id="5854556">[</span><span class="builtintype" id="5854557">string</span><span class="op" id="5854563">]</span><span class="builtintype" id="5854564">int</span><span class="op" id="5854567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854570">r</span><span class="op" id="5854571">.</span><span class="ident" id="5854572">mode</span>&nbsp;<span class="op" id="5854577">=</span>&nbsp;<span class="ident" id="5854579">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854585">r</span><span class="op" id="5854586">.</span><span class="ident" id="5854587">types</span>&nbsp;<span class="op" id="5854593">=</span>&nbsp;<span class="builtinfunc" id="5854595">make</span><span class="op" id="5854599">(</span><span class="keyword" id="5854600">map</span><span class="op" id="5854603">[</span><span class="builtintype" id="5854604">string</span><span class="op" id="5854610">]</span><span class="op" id="5854611">*</span><span class="ident" id="5854612">namedType</span><span class="op" id="5854621">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854624">r</span><span class="op" id="5854625">.</span><span class="ident" id="5854626">funcs</span>&nbsp;<span class="op" id="5854632">=</span>&nbsp;<span class="builtinfunc" id="5854634">make</span><span class="op" id="5854638">(</span><span class="ident" id="5854639">methodSet</span><span class="op" id="5854648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854651">r</span><span class="op" id="5854652">.</span><span class="ident" id="5854653">notes</span>&nbsp;<span class="op" id="5854659">=</span>&nbsp;<span class="builtinfunc" id="5854661">make</span><span class="op" id="5854665">(</span><span class="keyword" id="5854666">map</span><span class="op" id="5854669">[</span><span class="builtintype" id="5854670">string</span><span class="op" id="5854676">]</span><span class="op" id="5854677">[</span><span class="op" id="5854678">]</span><span class="op" id="5854679">*</span><span class="ident" id="5854680">Note</span><span class="op" id="5854684">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854688">//&nbsp;sort&nbsp;package&nbsp;files&nbsp;before&nbsp;reading&nbsp;them&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854743">//&nbsp;result&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;map&nbsp;iteration&nbsp;order</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854793">i</span>&nbsp;<span class="op" id="5854795">:=</span>&nbsp;<span class="num" id="5854798">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854801">for</span>&nbsp;<span class="ident" id="5854805">filename</span>&nbsp;<span class="op" id="5854814">:=</span>&nbsp;<span class="keyword" id="5854817">range</span>&nbsp;<span class="ident" id="5854823">pkg</span><span class="op" id="5854826">.</span><span class="ident" id="5854827">Files</span>&nbsp;<span class="op" id="5854833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854837">r</span><span class="op" id="5854838">.</span><span class="ident" id="5854839">filenames</span><span class="op" id="5854848">[</span><span class="ident" id="5854849">i</span><span class="op" id="5854850">]</span>&nbsp;<span class="op" id="5854852">=</span>&nbsp;<span class="ident" id="5854854">filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854865">i</span><span class="op" id="5854866">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5854870">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854873">sort</span><span class="op" id="5854877">.</span><span class="ident" id="5854878">Strings</span><span class="op" id="5854885">(</span><span class="ident" id="5854886">r</span><span class="op" id="5854887">.</span><span class="ident" id="5854888">filenames</span><span class="op" id="5854897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5854901">//&nbsp;process&nbsp;files&nbsp;in&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5854935">for</span>&nbsp;<span class="ident" id="5854939">_</span><span class="op" id="5854940">,</span>&nbsp;<span class="ident" id="5854942">filename</span>&nbsp;<span class="op" id="5854951">:=</span>&nbsp;<span class="keyword" id="5854954">range</span>&nbsp;<span class="ident" id="5854960">r</span><span class="op" id="5854961">.</span><span class="ident" id="5854962">filenames</span>&nbsp;<span class="op" id="5854972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5854976">f</span>&nbsp;<span class="op" id="5854978">:=</span>&nbsp;<span class="ident" id="5854981">pkg</span><span class="op" id="5854984">.</span><span class="ident" id="5854985">Files</span><span class="op" id="5854990">[</span><span class="ident" id="5854991">filename</span><span class="op" id="5854999">]</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855003">if</span>&nbsp;<span class="ident" id="5855006">mode</span><span class="op" id="5855010">&amp;</span><span class="ident" id="5855011">AllDecls</span>&nbsp;<span class="op" id="5855020">==</span>&nbsp;<span class="num" id="5855023">0</span>&nbsp;<span class="op" id="5855025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855030">r</span><span class="op" id="5855031">.</span><span class="ident" id="5855032">fileExports</span><span class="op" id="5855043">(</span><span class="ident" id="5855044">f</span><span class="op" id="5855045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5855049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855053">r</span><span class="op" id="5855054">.</span><span class="ident" id="5855055">readFile</span><span class="op" id="5855063">(</span><span class="ident" id="5855064">f</span><span class="op" id="5855065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5855068">}</span><br>
<span class="lineno">550</span><span class="op" id="5855070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5855073">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5855153">//&nbsp;Types</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="5855163">func</span>&nbsp;<span class="ident" id="5855168">customizeRecv</span><span class="op" id="5855181">(</span><span class="ident" id="5855182">f</span>&nbsp;<span class="op" id="5855184">*</span><span class="ident" id="5855185">Func</span><span class="op" id="5855189">,</span>&nbsp;<span class="ident" id="5855191">recvTypeName</span>&nbsp;<span class="builtintype" id="5855204">string</span><span class="op" id="5855210">,</span>&nbsp;<span class="ident" id="5855212">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5855226">bool</span><span class="op" id="5855230">,</span>&nbsp;<span class="ident" id="5855232">level</span>&nbsp;<span class="builtintype" id="5855238">int</span><span class="op" id="5855241">)</span>&nbsp;<span class="op" id="5855243">*</span><span class="ident" id="5855244">Func</span>&nbsp;<span class="op" id="5855249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855252">if</span>&nbsp;<span class="ident" id="5855255">f</span>&nbsp;<span class="op" id="5855257">==</span>&nbsp;<span class="ident" id="5855260">nil</span>&nbsp;<span class="op" id="5855264">||</span>&nbsp;<span class="ident" id="5855267">f</span><span class="op" id="5855268">.</span><span class="ident" id="5855269">Decl</span>&nbsp;<span class="op" id="5855274">==</span>&nbsp;<span class="ident" id="5855277">nil</span>&nbsp;<span class="op" id="5855281">||</span>&nbsp;<span class="ident" id="5855284">f</span><span class="op" id="5855285">.</span><span class="ident" id="5855286">Decl</span><span class="op" id="5855290">.</span><span class="ident" id="5855291">Recv</span>&nbsp;<span class="op" id="5855296">==</span>&nbsp;<span class="ident" id="5855299">nil</span>&nbsp;<span class="op" id="5855303">||</span>&nbsp;<span class="builtinfunc" id="5855306">len</span><span class="op" id="5855309">(</span><span class="ident" id="5855310">f</span><span class="op" id="5855311">.</span><span class="ident" id="5855312">Decl</span><span class="op" id="5855316">.</span><span class="ident" id="5855317">Recv</span><span class="op" id="5855321">.</span><span class="ident" id="5855322">List</span><span class="op" id="5855326">)</span>&nbsp;<span class="op" id="5855328">!=</span>&nbsp;<span class="num" id="5855331">1</span>&nbsp;<span class="op" id="5855333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855337">return</span>&nbsp;<span class="ident" id="5855344">f</span>&nbsp;<span class="comment" id="5855346">//&nbsp;shouldn&#39;t&nbsp;happen,&nbsp;but&nbsp;be&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5855380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5855384">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;and&nbsp;set&nbsp;new&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855434">newField</span>&nbsp;<span class="op" id="5855443">:=</span>&nbsp;<span class="op" id="5855446">*</span><span class="ident" id="5855447">f</span><span class="op" id="5855448">.</span><span class="ident" id="5855449">Decl</span><span class="op" id="5855453">.</span><span class="ident" id="5855454">Recv</span><span class="op" id="5855458">.</span><span class="ident" id="5855459">List</span><span class="op" id="5855463">[</span><span class="num" id="5855464">0</span><span class="op" id="5855465">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855468">origPos</span>&nbsp;<span class="op" id="5855476">:=</span>&nbsp;<span class="ident" id="5855479">newField</span><span class="op" id="5855487">.</span><span class="ident" id="5855488">Type</span><span class="op" id="5855492">.</span><span class="ident" id="5855493">Pos</span><span class="op" id="5855496">(</span><span class="op" id="5855497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855500">_</span><span class="op" id="5855501">,</span>&nbsp;<span class="ident" id="5855503">origRecvIsPtr</span>&nbsp;<span class="op" id="5855517">:=</span>&nbsp;<span class="ident" id="5855520">newField</span><span class="op" id="5855528">.</span><span class="ident" id="5855529">Type</span><span class="op" id="5855533">.</span><span class="op" id="5855534">(</span><span class="op" id="5855535">*</span><span class="ident" id="5855536">ast</span><span class="op" id="5855539">.</span><span class="ident" id="5855540">StarExpr</span><span class="op" id="5855548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855551">newIdent</span>&nbsp;<span class="op" id="5855560">:=</span>&nbsp;<span class="op" id="5855563">&amp;</span><span class="ident" id="5855564">ast</span><span class="op" id="5855567">.</span><span class="ident" id="5855568">Ident</span><span class="op" id="5855573">{</span><span class="ident" id="5855574">NamePos</span><span class="op" id="5855581">:</span>&nbsp;<span class="ident" id="5855583">origPos</span><span class="op" id="5855590">,</span>&nbsp;<span class="ident" id="5855592">Name</span><span class="op" id="5855596">:</span>&nbsp;<span class="ident" id="5855598">recvTypeName</span><span class="op" id="5855610">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855613">var</span>&nbsp;<span class="ident" id="5855617">typ</span>&nbsp;<span class="ident" id="5855621">ast</span><span class="op" id="5855624">.</span><span class="ident" id="5855625">Expr</span>&nbsp;<span class="op" id="5855630">=</span>&nbsp;<span class="ident" id="5855632">newIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5855642">if</span>&nbsp;<span class="op" id="5855645">!</span><span class="ident" id="5855646">embeddedIsPtr</span>&nbsp;<span class="op" id="5855660">&amp;&amp;</span>&nbsp;<span class="ident" id="5855663">origRecvIsPtr</span>&nbsp;<span class="op" id="5855677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855681">newIdent</span><span class="op" id="5855689">.</span><span class="ident" id="5855690">NamePos</span><span class="op" id="5855697">++</span>&nbsp;<span class="comment" id="5855700">//&nbsp;&#39;*&#39;&nbsp;is&nbsp;one&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855726">typ</span>&nbsp;<span class="op" id="5855730">=</span>&nbsp;<span class="op" id="5855732">&amp;</span><span class="ident" id="5855733">ast</span><span class="op" id="5855736">.</span><span class="ident" id="5855737">StarExpr</span><span class="op" id="5855745">{</span><span class="ident" id="5855746">Star</span><span class="op" id="5855750">:</span>&nbsp;<span class="ident" id="5855752">origPos</span><span class="op" id="5855759">,</span>&nbsp;<span class="ident" id="5855761">X</span><span class="op" id="5855762">:</span>&nbsp;<span class="ident" id="5855764">newIdent</span><span class="op" id="5855772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5855775">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855778">newField</span><span class="op" id="5855786">.</span><span class="ident" id="5855787">Type</span>&nbsp;<span class="op" id="5855792">=</span>&nbsp;<span class="ident" id="5855794">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5855800">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;list&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855865">newFieldList</span>&nbsp;<span class="op" id="5855878">:=</span>&nbsp;<span class="op" id="5855881">*</span><span class="ident" id="5855882">f</span><span class="op" id="5855883">.</span><span class="ident" id="5855884">Decl</span><span class="op" id="5855888">.</span><span class="ident" id="5855889">Recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5855895">newFieldList</span><span class="op" id="5855907">.</span><span class="ident" id="5855908">List</span>&nbsp;<span class="op" id="5855913">=</span>&nbsp;<span class="op" id="5855915">[</span><span class="op" id="5855916">]</span><span class="op" id="5855917">*</span><span class="ident" id="5855918">ast</span><span class="op" id="5855921">.</span><span class="ident" id="5855922">Field</span><span class="op" id="5855927">{</span><span class="op" id="5855928">&amp;</span><span class="ident" id="5855929">newField</span><span class="op" id="5855937">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5855941">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;declaration&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856012">newFuncDecl</span>&nbsp;<span class="op" id="5856024">:=</span>&nbsp;<span class="op" id="5856027">*</span><span class="ident" id="5856028">f</span><span class="op" id="5856029">.</span><span class="ident" id="5856030">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856036">newFuncDecl</span><span class="op" id="5856047">.</span><span class="ident" id="5856048">Recv</span>&nbsp;<span class="op" id="5856053">=</span>&nbsp;<span class="op" id="5856055">&amp;</span><span class="ident" id="5856056">newFieldList</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856071">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;documentation&nbsp;and&nbsp;set&nbsp;new&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856136">newF</span>&nbsp;<span class="op" id="5856141">:=</span>&nbsp;<span class="op" id="5856144">*</span><span class="ident" id="5856145">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856148">newF</span><span class="op" id="5856152">.</span><span class="ident" id="5856153">Decl</span>&nbsp;<span class="op" id="5856158">=</span>&nbsp;<span class="op" id="5856160">&amp;</span><span class="ident" id="5856161">newFuncDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856174">newF</span><span class="op" id="5856178">.</span><span class="ident" id="5856179">Recv</span>&nbsp;<span class="op" id="5856184">=</span>&nbsp;<span class="ident" id="5856186">recvString</span><span class="op" id="5856196">(</span><span class="ident" id="5856197">typ</span><span class="op" id="5856200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856203">//&nbsp;the&nbsp;Orig&nbsp;field&nbsp;never&nbsp;changes</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856236">newF</span><span class="op" id="5856240">.</span><span class="ident" id="5856241">Level</span>&nbsp;<span class="op" id="5856247">=</span>&nbsp;<span class="ident" id="5856249">level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5856257">return</span>&nbsp;<span class="op" id="5856264">&amp;</span><span class="ident" id="5856265">newF</span><br>
<span class="lineno"></span><span class="op" id="5856270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="5856273">//&nbsp;collectEmbeddedMethods&nbsp;collects&nbsp;the&nbsp;embedded&nbsp;methods&nbsp;of&nbsp;typ&nbsp;in&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5856345">//</span><br>
<span class="lineno"></span><span class="keyword" id="5856348">func</span>&nbsp;<span class="op" id="5856353">(</span><span class="ident" id="5856354">r</span>&nbsp;<span class="op" id="5856356">*</span><span class="ident" id="5856357">reader</span><span class="op" id="5856363">)</span>&nbsp;<span class="ident" id="5856365">collectEmbeddedMethods</span><span class="op" id="5856387">(</span><span class="ident" id="5856388">mset</span>&nbsp;<span class="ident" id="5856393">methodSet</span><span class="op" id="5856402">,</span>&nbsp;<span class="ident" id="5856404">typ</span>&nbsp;<span class="op" id="5856408">*</span><span class="ident" id="5856409">namedType</span><span class="op" id="5856418">,</span>&nbsp;<span class="ident" id="5856420">recvTypeName</span>&nbsp;<span class="builtintype" id="5856433">string</span><span class="op" id="5856439">,</span>&nbsp;<span class="ident" id="5856441">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5856455">bool</span><span class="op" id="5856459">,</span>&nbsp;<span class="ident" id="5856461">level</span>&nbsp;<span class="builtintype" id="5856467">int</span><span class="op" id="5856470">,</span>&nbsp;<span class="ident" id="5856472">visited</span>&nbsp;<span class="ident" id="5856480">embeddedSet</span><span class="op" id="5856491">)</span>&nbsp;<span class="op" id="5856493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856496">visited</span><span class="op" id="5856503">[</span><span class="ident" id="5856504">typ</span><span class="op" id="5856507">]</span>&nbsp;<span class="op" id="5856509">=</span>&nbsp;<span class="builtintype" id="5856511">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5856517">for</span>&nbsp;<span class="ident" id="5856521">embedded</span><span class="op" id="5856529">,</span>&nbsp;<span class="ident" id="5856531">isPtr</span>&nbsp;<span class="op" id="5856537">:=</span>&nbsp;<span class="keyword" id="5856540">range</span>&nbsp;<span class="ident" id="5856546">typ</span><span class="op" id="5856549">.</span><span class="ident" id="5856550">embedded</span>&nbsp;<span class="op" id="5856559">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856563">//&nbsp;Once&nbsp;an&nbsp;embedded&nbsp;type&nbsp;is&nbsp;embedded&nbsp;as&nbsp;a&nbsp;pointer&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856620">//&nbsp;all&nbsp;embedded&nbsp;types&nbsp;in&nbsp;those&nbsp;types&nbsp;are&nbsp;treated&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856676">//&nbsp;pointer&nbsp;types&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;receiver&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856732">//&nbsp;computation;&nbsp;i.e.,&nbsp;embeddedIsPtr&nbsp;is&nbsp;sticky&nbsp;for&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856789">//&nbsp;embedding&nbsp;hierarchy.</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856815">thisEmbeddedIsPtr</span>&nbsp;<span class="op" id="5856833">:=</span>&nbsp;<span class="ident" id="5856836">embeddedIsPtr</span>&nbsp;<span class="op" id="5856850">||</span>&nbsp;<span class="ident" id="5856853">isPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5856861">for</span>&nbsp;<span class="ident" id="5856865">_</span><span class="op" id="5856866">,</span>&nbsp;<span class="ident" id="5856868">m</span>&nbsp;<span class="op" id="5856870">:=</span>&nbsp;<span class="keyword" id="5856873">range</span>&nbsp;<span class="ident" id="5856879">embedded</span><span class="op" id="5856887">.</span><span class="ident" id="5856888">methods</span>&nbsp;<span class="op" id="5856896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5856901">//&nbsp;only&nbsp;top-level&nbsp;methods&nbsp;are&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5856943">if</span>&nbsp;<span class="ident" id="5856946">m</span><span class="op" id="5856947">.</span><span class="ident" id="5856948">Level</span>&nbsp;<span class="op" id="5856954">==</span>&nbsp;<span class="num" id="5856957">0</span>&nbsp;<span class="op" id="5856959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5856965">mset</span><span class="op" id="5856969">.</span><span class="ident" id="5856970">add</span><span class="op" id="5856973">(</span><span class="ident" id="5856974">customizeRecv</span><span class="op" id="5856987">(</span><span class="ident" id="5856988">m</span><span class="op" id="5856989">,</span>&nbsp;<span class="ident" id="5856991">recvTypeName</span><span class="op" id="5857003">,</span>&nbsp;<span class="ident" id="5857005">thisEmbeddedIsPtr</span><span class="op" id="5857022">,</span>&nbsp;<span class="ident" id="5857024">level</span><span class="op" id="5857029">)</span><span class="op" id="5857030">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5857043">if</span>&nbsp;<span class="op" id="5857046">!</span><span class="ident" id="5857047">visited</span><span class="op" id="5857054">[</span><span class="ident" id="5857055">embedded</span><span class="op" id="5857063">]</span>&nbsp;<span class="op" id="5857065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5857070">r</span><span class="op" id="5857071">.</span><span class="ident" id="5857072">collectEmbeddedMethods</span><span class="op" id="5857094">(</span><span class="ident" id="5857095">mset</span><span class="op" id="5857099">,</span>&nbsp;<span class="ident" id="5857101">embedded</span><span class="op" id="5857109">,</span>&nbsp;<span class="ident" id="5857111">recvTypeName</span><span class="op" id="5857123">,</span>&nbsp;<span class="ident" id="5857125">thisEmbeddedIsPtr</span><span class="op" id="5857142">,</span>&nbsp;<span class="ident" id="5857144">level</span><span class="op" id="5857149">+</span><span class="num" id="5857150">1</span><span class="op" id="5857151">,</span>&nbsp;<span class="ident" id="5857153">visited</span><span class="op" id="5857160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857164">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5857170">delete</span><span class="op" id="5857176">(</span><span class="ident" id="5857177">visited</span><span class="op" id="5857184">,</span>&nbsp;<span class="ident" id="5857186">typ</span><span class="op" id="5857189">)</span><br>
<span class="lineno"></span><span class="op" id="5857191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5857194">//&nbsp;computeMethodSets&nbsp;determines&nbsp;the&nbsp;actual&nbsp;method&nbsp;sets&nbsp;for&nbsp;each&nbsp;type&nbsp;encountered.</span><br>
<span class="lineno">615</span><span class="comment" id="5857276">//</span><br>
<span class="lineno"></span><span class="keyword" id="5857279">func</span>&nbsp;<span class="op" id="5857284">(</span><span class="ident" id="5857285">r</span>&nbsp;<span class="op" id="5857287">*</span><span class="ident" id="5857288">reader</span><span class="op" id="5857294">)</span>&nbsp;<span class="ident" id="5857296">computeMethodSets</span><span class="op" id="5857313">(</span><span class="op" id="5857314">)</span>&nbsp;<span class="op" id="5857316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5857319">for</span>&nbsp;<span class="ident" id="5857323">_</span><span class="op" id="5857324">,</span>&nbsp;<span class="ident" id="5857326">t</span>&nbsp;<span class="op" id="5857328">:=</span>&nbsp;<span class="keyword" id="5857331">range</span>&nbsp;<span class="ident" id="5857337">r</span><span class="op" id="5857338">.</span><span class="ident" id="5857339">types</span>&nbsp;<span class="op" id="5857345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5857349">//&nbsp;collect&nbsp;embedded&nbsp;methods&nbsp;for&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5857385">if</span>&nbsp;<span class="ident" id="5857388">t</span><span class="op" id="5857389">.</span><span class="ident" id="5857390">isStruct</span>&nbsp;<span class="op" id="5857399">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5857404">//&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5857417">r</span><span class="op" id="5857418">.</span><span class="ident" id="5857419">collectEmbeddedMethods</span><span class="op" id="5857441">(</span><span class="ident" id="5857442">t</span><span class="op" id="5857443">.</span><span class="ident" id="5857444">methods</span><span class="op" id="5857451">,</span>&nbsp;<span class="ident" id="5857453">t</span><span class="op" id="5857454">,</span>&nbsp;<span class="ident" id="5857456">t</span><span class="op" id="5857457">.</span><span class="ident" id="5857458">name</span><span class="op" id="5857462">,</span>&nbsp;<span class="builtintype" id="5857464">false</span><span class="op" id="5857469">,</span>&nbsp;<span class="num" id="5857471">1</span><span class="op" id="5857472">,</span>&nbsp;<span class="builtinfunc" id="5857474">make</span><span class="op" id="5857478">(</span><span class="ident" id="5857479">embeddedSet</span><span class="op" id="5857490">)</span><span class="op" id="5857491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857495">}</span>&nbsp;<span class="keyword" id="5857497">else</span>&nbsp;<span class="op" id="5857502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5857507">//&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5857523">//&nbsp;TODO(gri)&nbsp;fix&nbsp;this</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5857554">//&nbsp;if&nbsp;error&nbsp;was&nbsp;declared&nbsp;locally,&nbsp;don&#39;t&nbsp;treat&nbsp;it&nbsp;as&nbsp;exported&nbsp;field&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5857630">if</span>&nbsp;<span class="ident" id="5857633">r</span><span class="op" id="5857634">.</span><span class="ident" id="5857635">errorDecl</span>&nbsp;<span class="op" id="5857645">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5857649">for</span>&nbsp;<span class="ident" id="5857653">_</span><span class="op" id="5857654">,</span>&nbsp;<span class="ident" id="5857656">ityp</span>&nbsp;<span class="op" id="5857661">:=</span>&nbsp;<span class="keyword" id="5857664">range</span>&nbsp;<span class="ident" id="5857670">r</span><span class="op" id="5857671">.</span><span class="ident" id="5857672">fixlist</span>&nbsp;<span class="op" id="5857680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5857685">removeErrorField</span><span class="op" id="5857701">(</span><span class="ident" id="5857702">ityp</span><span class="op" id="5857706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5857713">}</span><br>
<span class="lineno"></span><span class="op" id="5857715">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="5857718">//&nbsp;cleanupTypes&nbsp;removes&nbsp;the&nbsp;association&nbsp;of&nbsp;functions&nbsp;and&nbsp;methods&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5857788">//&nbsp;types&nbsp;that&nbsp;have&nbsp;no&nbsp;declaration.&nbsp;Instead,&nbsp;these&nbsp;functions&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="5857860">//&nbsp;are&nbsp;shown&nbsp;at&nbsp;the&nbsp;package&nbsp;level.&nbsp;It&nbsp;also&nbsp;removes&nbsp;types&nbsp;with&nbsp;missing</span><br>
<span class="lineno"></span><span class="comment" id="5857930">//&nbsp;declarations&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible.</span><br>
<span class="lineno">640</span><span class="comment" id="5857972">//</span><br>
<span class="lineno"></span><span class="keyword" id="5857975">func</span>&nbsp;<span class="op" id="5857980">(</span><span class="ident" id="5857981">r</span>&nbsp;<span class="op" id="5857983">*</span><span class="ident" id="5857984">reader</span><span class="op" id="5857990">)</span>&nbsp;<span class="ident" id="5857992">cleanupTypes</span><span class="op" id="5858004">(</span><span class="op" id="5858005">)</span>&nbsp;<span class="op" id="5858007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858010">for</span>&nbsp;<span class="ident" id="5858014">_</span><span class="op" id="5858015">,</span>&nbsp;<span class="ident" id="5858017">t</span>&nbsp;<span class="op" id="5858019">:=</span>&nbsp;<span class="keyword" id="5858022">range</span>&nbsp;<span class="ident" id="5858028">r</span><span class="op" id="5858029">.</span><span class="ident" id="5858030">types</span>&nbsp;<span class="op" id="5858036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5858040">visible</span>&nbsp;<span class="op" id="5858048">:=</span>&nbsp;<span class="ident" id="5858051">r</span><span class="op" id="5858052">.</span><span class="ident" id="5858053">isVisible</span><span class="op" id="5858062">(</span><span class="ident" id="5858063">t</span><span class="op" id="5858064">.</span><span class="ident" id="5858065">name</span><span class="op" id="5858069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858073">if</span>&nbsp;<span class="ident" id="5858076">t</span><span class="op" id="5858077">.</span><span class="ident" id="5858078">decl</span>&nbsp;<span class="op" id="5858083">==</span>&nbsp;<span class="ident" id="5858086">nil</span>&nbsp;<span class="op" id="5858090">&amp;&amp;</span>&nbsp;<span class="op" id="5858093">(</span><span class="ident" id="5858094">predeclaredTypes</span><span class="op" id="5858110">[</span><span class="ident" id="5858111">t</span><span class="op" id="5858112">.</span><span class="ident" id="5858113">name</span><span class="op" id="5858117">]</span>&nbsp;<span class="op" id="5858119">||</span>&nbsp;<span class="ident" id="5858122">t</span><span class="op" id="5858123">.</span><span class="ident" id="5858124">isEmbedded</span>&nbsp;<span class="op" id="5858135">&amp;&amp;</span>&nbsp;<span class="ident" id="5858138">visible</span><span class="op" id="5858145">)</span>&nbsp;<span class="op" id="5858147">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858152">//&nbsp;t.name&nbsp;is&nbsp;a&nbsp;predeclared&nbsp;type&nbsp;(and&nbsp;was&nbsp;not&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;package),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858229">//&nbsp;or&nbsp;it&nbsp;was&nbsp;embedded&nbsp;somewhere&nbsp;but&nbsp;its&nbsp;declaration&nbsp;is&nbsp;missing&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858304">//&nbsp;the&nbsp;AST&nbsp;is&nbsp;incomplete):&nbsp;move&nbsp;any&nbsp;associated&nbsp;values,&nbsp;funcs,&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858381">//&nbsp;back&nbsp;to&nbsp;the&nbsp;top-level&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;lost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858436">//&nbsp;1)&nbsp;move&nbsp;values</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5858457">r</span><span class="op" id="5858458">.</span><span class="ident" id="5858459">values</span>&nbsp;<span class="op" id="5858466">=</span>&nbsp;<span class="builtinfunc" id="5858468">append</span><span class="op" id="5858474">(</span><span class="ident" id="5858475">r</span><span class="op" id="5858476">.</span><span class="ident" id="5858477">values</span><span class="op" id="5858483">,</span>&nbsp;<span class="ident" id="5858485">t</span><span class="op" id="5858486">.</span><span class="ident" id="5858487">values</span><span class="op" id="5858493">...</span><span class="op" id="5858496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858501">//&nbsp;2)&nbsp;move&nbsp;factory&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858533">for</span>&nbsp;<span class="ident" id="5858537">name</span><span class="op" id="5858541">,</span>&nbsp;<span class="ident" id="5858543">f</span>&nbsp;<span class="op" id="5858545">:=</span>&nbsp;<span class="keyword" id="5858548">range</span>&nbsp;<span class="ident" id="5858554">t</span><span class="op" id="5858555">.</span><span class="ident" id="5858556">funcs</span>&nbsp;<span class="op" id="5858562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858568">//&nbsp;in&nbsp;a&nbsp;correct&nbsp;AST,&nbsp;package-level&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858622">//&nbsp;are&nbsp;all&nbsp;different&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;conflicts</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5858680">r</span><span class="op" id="5858681">.</span><span class="ident" id="5858682">funcs</span><span class="op" id="5858687">[</span><span class="ident" id="5858688">name</span><span class="op" id="5858692">]</span>&nbsp;<span class="op" id="5858694">=</span>&nbsp;<span class="ident" id="5858696">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5858701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858706">//&nbsp;3)&nbsp;move&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858728">for</span>&nbsp;<span class="ident" id="5858732">name</span><span class="op" id="5858736">,</span>&nbsp;<span class="ident" id="5858738">m</span>&nbsp;<span class="op" id="5858740">:=</span>&nbsp;<span class="keyword" id="5858743">range</span>&nbsp;<span class="ident" id="5858749">t</span><span class="op" id="5858750">.</span><span class="ident" id="5858751">methods</span>&nbsp;<span class="op" id="5858759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858765">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;functions&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;-&nbsp;drop&nbsp;them</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858829">if</span>&nbsp;<span class="ident" id="5858832">_</span><span class="op" id="5858833">,</span>&nbsp;<span class="ident" id="5858835">found</span>&nbsp;<span class="op" id="5858841">:=</span>&nbsp;<span class="ident" id="5858844">r</span><span class="op" id="5858845">.</span><span class="ident" id="5858846">funcs</span><span class="op" id="5858851">[</span><span class="ident" id="5858852">name</span><span class="op" id="5858856">]</span><span class="op" id="5858857">;</span>&nbsp;<span class="op" id="5858859">!</span><span class="ident" id="5858860">found</span>&nbsp;<span class="op" id="5858866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5858873">r</span><span class="op" id="5858874">.</span><span class="ident" id="5858875">funcs</span><span class="op" id="5858880">[</span><span class="ident" id="5858881">name</span><span class="op" id="5858885">]</span>&nbsp;<span class="op" id="5858887">=</span>&nbsp;<span class="ident" id="5858889">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5858895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5858900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5858904">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5858908">//&nbsp;remove&nbsp;types&nbsp;w/o&nbsp;declaration&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5858967">if</span>&nbsp;<span class="ident" id="5858970">t</span><span class="op" id="5858971">.</span><span class="ident" id="5858972">decl</span>&nbsp;<span class="op" id="5858977">==</span>&nbsp;<span class="ident" id="5858980">nil</span>&nbsp;<span class="op" id="5858984">||</span>&nbsp;<span class="op" id="5858987">!</span><span class="ident" id="5858988">visible</span>&nbsp;<span class="op" id="5858996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5859001">delete</span><span class="op" id="5859007">(</span><span class="ident" id="5859008">r</span><span class="op" id="5859009">.</span><span class="ident" id="5859010">types</span><span class="op" id="5859015">,</span>&nbsp;<span class="ident" id="5859017">t</span><span class="op" id="5859018">.</span><span class="ident" id="5859019">name</span><span class="op" id="5859023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5859027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5859030">}</span><br>
<span class="lineno">670</span><span class="op" id="5859032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5859035">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5859115">//&nbsp;Sorting</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5859127">type</span>&nbsp;<span class="ident" id="5859132">data</span>&nbsp;<span class="keyword" id="5859137">struct</span>&nbsp;<span class="op" id="5859144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859147">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5859152">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859157">swap</span>&nbsp;<span class="keyword" id="5859162">func</span><span class="op" id="5859166">(</span><span class="ident" id="5859167">i</span><span class="op" id="5859168">,</span>&nbsp;<span class="ident" id="5859170">j</span>&nbsp;<span class="builtintype" id="5859172">int</span><span class="op" id="5859175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859178">less</span>&nbsp;<span class="keyword" id="5859183">func</span><span class="op" id="5859187">(</span><span class="ident" id="5859188">i</span><span class="op" id="5859189">,</span>&nbsp;<span class="ident" id="5859191">j</span>&nbsp;<span class="builtintype" id="5859193">int</span><span class="op" id="5859196">)</span>&nbsp;<span class="builtintype" id="5859198">bool</span><br>
<span class="lineno"></span><span class="op" id="5859203">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="5859206">func</span>&nbsp;<span class="op" id="5859211">(</span><span class="ident" id="5859212">d</span>&nbsp;<span class="op" id="5859214">*</span><span class="ident" id="5859215">data</span><span class="op" id="5859219">)</span>&nbsp;<span class="ident" id="5859221">Len</span><span class="op" id="5859224">(</span><span class="op" id="5859225">)</span>&nbsp;<span class="builtintype" id="5859227">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5859241">{</span>&nbsp;<span class="keyword" id="5859243">return</span>&nbsp;<span class="ident" id="5859250">d</span><span class="op" id="5859251">.</span><span class="ident" id="5859252">n</span>&nbsp;<span class="op" id="5859254">}</span><br>
<span class="lineno"></span><span class="keyword" id="5859256">func</span>&nbsp;<span class="op" id="5859261">(</span><span class="ident" id="5859262">d</span>&nbsp;<span class="op" id="5859264">*</span><span class="ident" id="5859265">data</span><span class="op" id="5859269">)</span>&nbsp;<span class="ident" id="5859271">Swap</span><span class="op" id="5859275">(</span><span class="ident" id="5859276">i</span><span class="op" id="5859277">,</span>&nbsp;<span class="ident" id="5859279">j</span>&nbsp;<span class="builtintype" id="5859281">int</span><span class="op" id="5859284">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5859291">{</span>&nbsp;<span class="ident" id="5859293">d</span><span class="op" id="5859294">.</span><span class="ident" id="5859295">swap</span><span class="op" id="5859299">(</span><span class="ident" id="5859300">i</span><span class="op" id="5859301">,</span>&nbsp;<span class="ident" id="5859303">j</span><span class="op" id="5859304">)</span>&nbsp;<span class="op" id="5859306">}</span><br>
<span class="lineno"></span><span class="keyword" id="5859308">func</span>&nbsp;<span class="op" id="5859313">(</span><span class="ident" id="5859314">d</span>&nbsp;<span class="op" id="5859316">*</span><span class="ident" id="5859317">data</span><span class="op" id="5859321">)</span>&nbsp;<span class="ident" id="5859323">Less</span><span class="op" id="5859327">(</span><span class="ident" id="5859328">i</span><span class="op" id="5859329">,</span>&nbsp;<span class="ident" id="5859331">j</span>&nbsp;<span class="builtintype" id="5859333">int</span><span class="op" id="5859336">)</span>&nbsp;<span class="builtintype" id="5859338">bool</span>&nbsp;<span class="op" id="5859343">{</span>&nbsp;<span class="keyword" id="5859345">return</span>&nbsp;<span class="ident" id="5859352">d</span><span class="op" id="5859353">.</span><span class="ident" id="5859354">less</span><span class="op" id="5859358">(</span><span class="ident" id="5859359">i</span><span class="op" id="5859360">,</span>&nbsp;<span class="ident" id="5859362">j</span><span class="op" id="5859363">)</span>&nbsp;<span class="op" id="5859365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="comment" id="5859368">//&nbsp;sortBy&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;sorting</span><br>
<span class="lineno"></span><span class="keyword" id="5859411">func</span>&nbsp;<span class="ident" id="5859416">sortBy</span><span class="op" id="5859422">(</span><span class="ident" id="5859423">less</span>&nbsp;<span class="keyword" id="5859428">func</span><span class="op" id="5859432">(</span><span class="ident" id="5859433">i</span><span class="op" id="5859434">,</span>&nbsp;<span class="ident" id="5859436">j</span>&nbsp;<span class="builtintype" id="5859438">int</span><span class="op" id="5859441">)</span>&nbsp;<span class="builtintype" id="5859443">bool</span><span class="op" id="5859447">,</span>&nbsp;<span class="ident" id="5859449">swap</span>&nbsp;<span class="keyword" id="5859454">func</span><span class="op" id="5859458">(</span><span class="ident" id="5859459">i</span><span class="op" id="5859460">,</span>&nbsp;<span class="ident" id="5859462">j</span>&nbsp;<span class="builtintype" id="5859464">int</span><span class="op" id="5859467">)</span><span class="op" id="5859468">,</span>&nbsp;<span class="ident" id="5859470">n</span>&nbsp;<span class="builtintype" id="5859472">int</span><span class="op" id="5859475">)</span>&nbsp;<span class="op" id="5859477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859480">sort</span><span class="op" id="5859484">.</span><span class="ident" id="5859485">Sort</span><span class="op" id="5859489">(</span><span class="op" id="5859490">&amp;</span><span class="ident" id="5859491">data</span><span class="op" id="5859495">{</span><span class="ident" id="5859496">n</span><span class="op" id="5859497">,</span>&nbsp;<span class="ident" id="5859499">swap</span><span class="op" id="5859503">,</span>&nbsp;<span class="ident" id="5859505">less</span><span class="op" id="5859509">}</span><span class="op" id="5859510">)</span><br>
<span class="lineno"></span><span class="op" id="5859512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="5859515">func</span>&nbsp;<span class="ident" id="5859520">sortedKeys</span><span class="op" id="5859530">(</span><span class="ident" id="5859531">m</span>&nbsp;<span class="keyword" id="5859533">map</span><span class="op" id="5859536">[</span><span class="builtintype" id="5859537">string</span><span class="op" id="5859543">]</span><span class="builtintype" id="5859544">int</span><span class="op" id="5859547">)</span>&nbsp;<span class="op" id="5859549">[</span><span class="op" id="5859550">]</span><span class="builtintype" id="5859551">string</span>&nbsp;<span class="op" id="5859558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859561">list</span>&nbsp;<span class="op" id="5859566">:=</span>&nbsp;<span class="builtinfunc" id="5859569">make</span><span class="op" id="5859573">(</span><span class="op" id="5859574">[</span><span class="op" id="5859575">]</span><span class="builtintype" id="5859576">string</span><span class="op" id="5859582">,</span>&nbsp;<span class="builtinfunc" id="5859584">len</span><span class="op" id="5859587">(</span><span class="ident" id="5859588">m</span><span class="op" id="5859589">)</span><span class="op" id="5859590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859593">i</span>&nbsp;<span class="op" id="5859595">:=</span>&nbsp;<span class="num" id="5859598">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859601">for</span>&nbsp;<span class="ident" id="5859605">key</span>&nbsp;<span class="op" id="5859609">:=</span>&nbsp;<span class="keyword" id="5859612">range</span>&nbsp;<span class="ident" id="5859618">m</span>&nbsp;<span class="op" id="5859620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859624">list</span><span class="op" id="5859628">[</span><span class="ident" id="5859629">i</span><span class="op" id="5859630">]</span>&nbsp;<span class="op" id="5859632">=</span>&nbsp;<span class="ident" id="5859634">key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859640">i</span><span class="op" id="5859641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5859645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859648">sort</span><span class="op" id="5859652">.</span><span class="ident" id="5859653">Strings</span><span class="op" id="5859660">(</span><span class="ident" id="5859661">list</span><span class="op" id="5859665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859668">return</span>&nbsp;<span class="ident" id="5859675">list</span><br>
<span class="lineno"></span><span class="op" id="5859680">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="comment" id="5859683">//&nbsp;sortingName&nbsp;returns&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;when&nbsp;sorting&nbsp;d&nbsp;into&nbsp;place.</span><br>
<span class="lineno"></span><span class="comment" id="5859749">//</span><br>
<span class="lineno"></span><span class="keyword" id="5859752">func</span>&nbsp;<span class="ident" id="5859757">sortingName</span><span class="op" id="5859768">(</span><span class="ident" id="5859769">d</span>&nbsp;<span class="op" id="5859771">*</span><span class="ident" id="5859772">ast</span><span class="op" id="5859775">.</span><span class="ident" id="5859776">GenDecl</span><span class="op" id="5859783">)</span>&nbsp;<span class="builtintype" id="5859785">string</span>&nbsp;<span class="op" id="5859792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859795">if</span>&nbsp;<span class="builtinfunc" id="5859798">len</span><span class="op" id="5859801">(</span><span class="ident" id="5859802">d</span><span class="op" id="5859803">.</span><span class="ident" id="5859804">Specs</span><span class="op" id="5859809">)</span>&nbsp;<span class="op" id="5859811">==</span>&nbsp;<span class="num" id="5859814">1</span>&nbsp;<span class="op" id="5859816">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859820">if</span>&nbsp;<span class="ident" id="5859823">s</span><span class="op" id="5859824">,</span>&nbsp;<span class="ident" id="5859826">ok</span>&nbsp;<span class="op" id="5859829">:=</span>&nbsp;<span class="ident" id="5859832">d</span><span class="op" id="5859833">.</span><span class="ident" id="5859834">Specs</span><span class="op" id="5859839">[</span><span class="num" id="5859840">0</span><span class="op" id="5859841">]</span><span class="op" id="5859842">.</span><span class="op" id="5859843">(</span><span class="op" id="5859844">*</span><span class="ident" id="5859845">ast</span><span class="op" id="5859848">.</span><span class="ident" id="5859849">ValueSpec</span><span class="op" id="5859858">)</span><span class="op" id="5859859">;</span>&nbsp;<span class="ident" id="5859861">ok</span>&nbsp;<span class="op" id="5859864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859869">return</span>&nbsp;<span class="ident" id="5859876">s</span><span class="op" id="5859877">.</span><span class="ident" id="5859878">Names</span><span class="op" id="5859883">[</span><span class="num" id="5859884">0</span><span class="op" id="5859885">]</span><span class="op" id="5859886">.</span><span class="ident" id="5859887">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5859894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5859897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5859900">return</span>&nbsp;<span class="string" id="5859907">&#34;&#34;</span><br>
<span class="lineno">710</span><span class="op" id="5859910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5859913">func</span>&nbsp;<span class="ident" id="5859918">sortedValues</span><span class="op" id="5859930">(</span><span class="ident" id="5859931">m</span>&nbsp;<span class="op" id="5859933">[</span><span class="op" id="5859934">]</span><span class="op" id="5859935">*</span><span class="ident" id="5859936">Value</span><span class="op" id="5859941">,</span>&nbsp;<span class="ident" id="5859943">tok</span>&nbsp;<span class="ident" id="5859947">token</span><span class="op" id="5859952">.</span><span class="ident" id="5859953">Token</span><span class="op" id="5859958">)</span>&nbsp;<span class="op" id="5859960">[</span><span class="op" id="5859961">]</span><span class="op" id="5859962">*</span><span class="ident" id="5859963">Value</span>&nbsp;<span class="op" id="5859969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5859972">list</span>&nbsp;<span class="op" id="5859977">:=</span>&nbsp;<span class="builtinfunc" id="5859980">make</span><span class="op" id="5859984">(</span><span class="op" id="5859985">[</span><span class="op" id="5859986">]</span><span class="op" id="5859987">*</span><span class="ident" id="5859988">Value</span><span class="op" id="5859993">,</span>&nbsp;<span class="builtinfunc" id="5859995">len</span><span class="op" id="5859998">(</span><span class="ident" id="5859999">m</span><span class="op" id="5860000">)</span><span class="op" id="5860001">)</span>&nbsp;<span class="comment" id="5860003">//&nbsp;big&nbsp;enough&nbsp;in&nbsp;any&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860030">i</span>&nbsp;<span class="op" id="5860032">:=</span>&nbsp;<span class="num" id="5860035">0</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860038">for</span>&nbsp;<span class="ident" id="5860042">_</span><span class="op" id="5860043">,</span>&nbsp;<span class="ident" id="5860045">val</span>&nbsp;<span class="op" id="5860049">:=</span>&nbsp;<span class="keyword" id="5860052">range</span>&nbsp;<span class="ident" id="5860058">m</span>&nbsp;<span class="op" id="5860060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860064">if</span>&nbsp;<span class="ident" id="5860067">val</span><span class="op" id="5860070">.</span><span class="ident" id="5860071">Decl</span><span class="op" id="5860075">.</span><span class="ident" id="5860076">Tok</span>&nbsp;<span class="op" id="5860080">==</span>&nbsp;<span class="ident" id="5860083">tok</span>&nbsp;<span class="op" id="5860087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860092">list</span><span class="op" id="5860096">[</span><span class="ident" id="5860097">i</span><span class="op" id="5860098">]</span>&nbsp;<span class="op" id="5860100">=</span>&nbsp;<span class="ident" id="5860102">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860109">i</span><span class="op" id="5860110">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860115">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860121">list</span>&nbsp;<span class="op" id="5860126">=</span>&nbsp;<span class="ident" id="5860128">list</span><span class="op" id="5860132">[</span><span class="num" id="5860133">0</span><span class="op" id="5860134">:</span><span class="ident" id="5860135">i</span><span class="op" id="5860136">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860140">sortBy</span><span class="op" id="5860146">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860150">func</span><span class="op" id="5860154">(</span><span class="ident" id="5860155">i</span><span class="op" id="5860156">,</span>&nbsp;<span class="ident" id="5860158">j</span>&nbsp;<span class="builtintype" id="5860160">int</span><span class="op" id="5860163">)</span>&nbsp;<span class="builtintype" id="5860165">bool</span>&nbsp;<span class="op" id="5860170">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860175">if</span>&nbsp;<span class="ident" id="5860178">ni</span><span class="op" id="5860180">,</span>&nbsp;<span class="ident" id="5860182">nj</span>&nbsp;<span class="op" id="5860185">:=</span>&nbsp;<span class="ident" id="5860188">sortingName</span><span class="op" id="5860199">(</span><span class="ident" id="5860200">list</span><span class="op" id="5860204">[</span><span class="ident" id="5860205">i</span><span class="op" id="5860206">]</span><span class="op" id="5860207">.</span><span class="ident" id="5860208">Decl</span><span class="op" id="5860212">)</span><span class="op" id="5860213">,</span>&nbsp;<span class="ident" id="5860215">sortingName</span><span class="op" id="5860226">(</span><span class="ident" id="5860227">list</span><span class="op" id="5860231">[</span><span class="ident" id="5860232">j</span><span class="op" id="5860233">]</span><span class="op" id="5860234">.</span><span class="ident" id="5860235">Decl</span><span class="op" id="5860239">)</span><span class="op" id="5860240">;</span>&nbsp;<span class="ident" id="5860242">ni</span>&nbsp;<span class="op" id="5860245">!=</span>&nbsp;<span class="ident" id="5860248">nj</span>&nbsp;<span class="op" id="5860251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860257">return</span>&nbsp;<span class="ident" id="5860264">ni</span>&nbsp;<span class="op" id="5860267">&lt;</span>&nbsp;<span class="ident" id="5860269">nj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860280">return</span>&nbsp;<span class="ident" id="5860287">list</span><span class="op" id="5860291">[</span><span class="ident" id="5860292">i</span><span class="op" id="5860293">]</span><span class="op" id="5860294">.</span><span class="ident" id="5860295">order</span>&nbsp;<span class="op" id="5860301">&lt;</span>&nbsp;<span class="ident" id="5860303">list</span><span class="op" id="5860307">[</span><span class="ident" id="5860308">j</span><span class="op" id="5860309">]</span><span class="op" id="5860310">.</span><span class="ident" id="5860311">order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860319">}</span><span class="op" id="5860320">,</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860324">func</span><span class="op" id="5860328">(</span><span class="ident" id="5860329">i</span><span class="op" id="5860330">,</span>&nbsp;<span class="ident" id="5860332">j</span>&nbsp;<span class="builtintype" id="5860334">int</span><span class="op" id="5860337">)</span>&nbsp;<span class="op" id="5860339">{</span>&nbsp;<span class="ident" id="5860341">list</span><span class="op" id="5860345">[</span><span class="ident" id="5860346">i</span><span class="op" id="5860347">]</span><span class="op" id="5860348">,</span>&nbsp;<span class="ident" id="5860350">list</span><span class="op" id="5860354">[</span><span class="ident" id="5860355">j</span><span class="op" id="5860356">]</span>&nbsp;<span class="op" id="5860358">=</span>&nbsp;<span class="ident" id="5860360">list</span><span class="op" id="5860364">[</span><span class="ident" id="5860365">j</span><span class="op" id="5860366">]</span><span class="op" id="5860367">,</span>&nbsp;<span class="ident" id="5860369">list</span><span class="op" id="5860373">[</span><span class="ident" id="5860374">i</span><span class="op" id="5860375">]</span>&nbsp;<span class="op" id="5860377">}</span><span class="op" id="5860378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5860382">len</span><span class="op" id="5860385">(</span><span class="ident" id="5860386">list</span><span class="op" id="5860390">)</span><span class="op" id="5860391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860398">return</span>&nbsp;<span class="ident" id="5860405">list</span><br>
<span class="lineno">735</span><span class="op" id="5860410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5860413">func</span>&nbsp;<span class="ident" id="5860418">sortedTypes</span><span class="op" id="5860429">(</span><span class="ident" id="5860430">m</span>&nbsp;<span class="keyword" id="5860432">map</span><span class="op" id="5860435">[</span><span class="builtintype" id="5860436">string</span><span class="op" id="5860442">]</span><span class="op" id="5860443">*</span><span class="ident" id="5860444">namedType</span><span class="op" id="5860453">,</span>&nbsp;<span class="ident" id="5860455">allMethods</span>&nbsp;<span class="builtintype" id="5860466">bool</span><span class="op" id="5860470">)</span>&nbsp;<span class="op" id="5860472">[</span><span class="op" id="5860473">]</span><span class="op" id="5860474">*</span><span class="ident" id="5860475">Type</span>&nbsp;<span class="op" id="5860480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860483">list</span>&nbsp;<span class="op" id="5860488">:=</span>&nbsp;<span class="builtinfunc" id="5860491">make</span><span class="op" id="5860495">(</span><span class="op" id="5860496">[</span><span class="op" id="5860497">]</span><span class="op" id="5860498">*</span><span class="ident" id="5860499">Type</span><span class="op" id="5860503">,</span>&nbsp;<span class="builtinfunc" id="5860505">len</span><span class="op" id="5860508">(</span><span class="ident" id="5860509">m</span><span class="op" id="5860510">)</span><span class="op" id="5860511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860514">i</span>&nbsp;<span class="op" id="5860516">:=</span>&nbsp;<span class="num" id="5860519">0</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860522">for</span>&nbsp;<span class="ident" id="5860526">_</span><span class="op" id="5860527">,</span>&nbsp;<span class="ident" id="5860529">t</span>&nbsp;<span class="op" id="5860531">:=</span>&nbsp;<span class="keyword" id="5860534">range</span>&nbsp;<span class="ident" id="5860540">m</span>&nbsp;<span class="op" id="5860542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860546">list</span><span class="op" id="5860550">[</span><span class="ident" id="5860551">i</span><span class="op" id="5860552">]</span>&nbsp;<span class="op" id="5860554">=</span>&nbsp;<span class="op" id="5860556">&amp;</span><span class="ident" id="5860557">Type</span><span class="op" id="5860561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860566">Doc</span><span class="op" id="5860569">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860575">t</span><span class="op" id="5860576">.</span><span class="ident" id="5860577">doc</span><span class="op" id="5860580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860585">Name</span><span class="op" id="5860589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860594">t</span><span class="op" id="5860595">.</span><span class="ident" id="5860596">name</span><span class="op" id="5860600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860605">Decl</span><span class="op" id="5860609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860614">t</span><span class="op" id="5860615">.</span><span class="ident" id="5860616">decl</span><span class="op" id="5860620">,</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860625">Consts</span><span class="op" id="5860631">:</span>&nbsp;&nbsp;<span class="ident" id="5860634">sortedValues</span><span class="op" id="5860646">(</span><span class="ident" id="5860647">t</span><span class="op" id="5860648">.</span><span class="ident" id="5860649">values</span><span class="op" id="5860655">,</span>&nbsp;<span class="ident" id="5860657">token</span><span class="op" id="5860662">.</span><span class="ident" id="5860663">CONST</span><span class="op" id="5860668">)</span><span class="op" id="5860669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860674">Vars</span><span class="op" id="5860678">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5860683">sortedValues</span><span class="op" id="5860695">(</span><span class="ident" id="5860696">t</span><span class="op" id="5860697">.</span><span class="ident" id="5860698">values</span><span class="op" id="5860704">,</span>&nbsp;<span class="ident" id="5860706">token</span><span class="op" id="5860711">.</span><span class="ident" id="5860712">VAR</span><span class="op" id="5860715">)</span><span class="op" id="5860716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860721">Funcs</span><span class="op" id="5860726">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5860730">sortedFuncs</span><span class="op" id="5860741">(</span><span class="ident" id="5860742">t</span><span class="op" id="5860743">.</span><span class="ident" id="5860744">funcs</span><span class="op" id="5860749">,</span>&nbsp;<span class="builtintype" id="5860751">true</span><span class="op" id="5860755">)</span><span class="op" id="5860756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860761">Methods</span><span class="op" id="5860768">:</span>&nbsp;<span class="ident" id="5860770">sortedFuncs</span><span class="op" id="5860781">(</span><span class="ident" id="5860782">t</span><span class="op" id="5860783">.</span><span class="ident" id="5860784">methods</span><span class="op" id="5860791">,</span>&nbsp;<span class="ident" id="5860793">allMethods</span><span class="op" id="5860803">)</span><span class="op" id="5860804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860808">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860812">i</span><span class="op" id="5860813">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5860821">sortBy</span><span class="op" id="5860827">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860831">func</span><span class="op" id="5860835">(</span><span class="ident" id="5860836">i</span><span class="op" id="5860837">,</span>&nbsp;<span class="ident" id="5860839">j</span>&nbsp;<span class="builtintype" id="5860841">int</span><span class="op" id="5860844">)</span>&nbsp;<span class="builtintype" id="5860846">bool</span>&nbsp;<span class="op" id="5860851">{</span>&nbsp;<span class="keyword" id="5860853">return</span>&nbsp;<span class="ident" id="5860860">list</span><span class="op" id="5860864">[</span><span class="ident" id="5860865">i</span><span class="op" id="5860866">]</span><span class="op" id="5860867">.</span><span class="ident" id="5860868">Name</span>&nbsp;<span class="op" id="5860873">&lt;</span>&nbsp;<span class="ident" id="5860875">list</span><span class="op" id="5860879">[</span><span class="ident" id="5860880">j</span><span class="op" id="5860881">]</span><span class="op" id="5860882">.</span><span class="ident" id="5860883">Name</span>&nbsp;<span class="op" id="5860888">}</span><span class="op" id="5860889">,</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860893">func</span><span class="op" id="5860897">(</span><span class="ident" id="5860898">i</span><span class="op" id="5860899">,</span>&nbsp;<span class="ident" id="5860901">j</span>&nbsp;<span class="builtintype" id="5860903">int</span><span class="op" id="5860906">)</span>&nbsp;<span class="op" id="5860908">{</span>&nbsp;<span class="ident" id="5860910">list</span><span class="op" id="5860914">[</span><span class="ident" id="5860915">i</span><span class="op" id="5860916">]</span><span class="op" id="5860917">,</span>&nbsp;<span class="ident" id="5860919">list</span><span class="op" id="5860923">[</span><span class="ident" id="5860924">j</span><span class="op" id="5860925">]</span>&nbsp;<span class="op" id="5860927">=</span>&nbsp;<span class="ident" id="5860929">list</span><span class="op" id="5860933">[</span><span class="ident" id="5860934">j</span><span class="op" id="5860935">]</span><span class="op" id="5860936">,</span>&nbsp;<span class="ident" id="5860938">list</span><span class="op" id="5860942">[</span><span class="ident" id="5860943">i</span><span class="op" id="5860944">]</span>&nbsp;<span class="op" id="5860946">}</span><span class="op" id="5860947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5860951">len</span><span class="op" id="5860954">(</span><span class="ident" id="5860955">list</span><span class="op" id="5860959">)</span><span class="op" id="5860960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5860963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5860967">return</span>&nbsp;<span class="ident" id="5860974">list</span><br>
<span class="lineno">760</span><span class="op" id="5860979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5860982">func</span>&nbsp;<span class="ident" id="5860987">removeStar</span><span class="op" id="5860997">(</span><span class="ident" id="5860998">s</span>&nbsp;<span class="builtintype" id="5861000">string</span><span class="op" id="5861006">)</span>&nbsp;<span class="builtintype" id="5861008">string</span>&nbsp;<span class="op" id="5861015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861018">if</span>&nbsp;<span class="builtinfunc" id="5861021">len</span><span class="op" id="5861024">(</span><span class="ident" id="5861025">s</span><span class="op" id="5861026">)</span>&nbsp;<span class="op" id="5861028">&gt;</span>&nbsp;<span class="num" id="5861030">0</span>&nbsp;<span class="op" id="5861032">&amp;&amp;</span>&nbsp;<span class="ident" id="5861035">s</span><span class="op" id="5861036">[</span><span class="num" id="5861037">0</span><span class="op" id="5861038">]</span>&nbsp;<span class="op" id="5861040">==</span>&nbsp;<span class="string" id="5861043">&#39;*&#39;</span>&nbsp;<span class="op" id="5861047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861051">return</span>&nbsp;<span class="ident" id="5861058">s</span><span class="op" id="5861059">[</span><span class="num" id="5861060">1</span><span class="op" id="5861061">:</span><span class="op" id="5861062">]</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5861065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861068">return</span>&nbsp;<span class="ident" id="5861075">s</span><br>
<span class="lineno"></span><span class="op" id="5861077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5861080">func</span>&nbsp;<span class="ident" id="5861085">sortedFuncs</span><span class="op" id="5861096">(</span><span class="ident" id="5861097">m</span>&nbsp;<span class="ident" id="5861099">methodSet</span><span class="op" id="5861108">,</span>&nbsp;<span class="ident" id="5861110">allMethods</span>&nbsp;<span class="builtintype" id="5861121">bool</span><span class="op" id="5861125">)</span>&nbsp;<span class="op" id="5861127">[</span><span class="op" id="5861128">]</span><span class="op" id="5861129">*</span><span class="ident" id="5861130">Func</span>&nbsp;<span class="op" id="5861135">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861138">list</span>&nbsp;<span class="op" id="5861143">:=</span>&nbsp;<span class="builtinfunc" id="5861146">make</span><span class="op" id="5861150">(</span><span class="op" id="5861151">[</span><span class="op" id="5861152">]</span><span class="op" id="5861153">*</span><span class="ident" id="5861154">Func</span><span class="op" id="5861158">,</span>&nbsp;<span class="builtinfunc" id="5861160">len</span><span class="op" id="5861163">(</span><span class="ident" id="5861164">m</span><span class="op" id="5861165">)</span><span class="op" id="5861166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861169">i</span>&nbsp;<span class="op" id="5861171">:=</span>&nbsp;<span class="num" id="5861174">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861177">for</span>&nbsp;<span class="ident" id="5861181">_</span><span class="op" id="5861182">,</span>&nbsp;<span class="ident" id="5861184">m</span>&nbsp;<span class="op" id="5861186">:=</span>&nbsp;<span class="keyword" id="5861189">range</span>&nbsp;<span class="ident" id="5861195">m</span>&nbsp;<span class="op" id="5861197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5861201">//&nbsp;determine&nbsp;which&nbsp;methods&nbsp;to&nbsp;include</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861241">switch</span>&nbsp;<span class="op" id="5861248">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861252">case</span>&nbsp;<span class="ident" id="5861257">m</span><span class="op" id="5861258">.</span><span class="ident" id="5861259">Decl</span>&nbsp;<span class="op" id="5861264">==</span>&nbsp;<span class="ident" id="5861267">nil</span><span class="op" id="5861270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5861275">//&nbsp;exclude&nbsp;conflict&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861303">case</span>&nbsp;<span class="ident" id="5861308">allMethods</span><span class="op" id="5861318">,</span>&nbsp;<span class="ident" id="5861320">m</span><span class="op" id="5861321">.</span><span class="ident" id="5861322">Level</span>&nbsp;<span class="op" id="5861328">==</span>&nbsp;<span class="num" id="5861331">0</span><span class="op" id="5861332">,</span>&nbsp;<span class="op" id="5861334">!</span><span class="ident" id="5861335">ast</span><span class="op" id="5861338">.</span><span class="ident" id="5861339">IsExported</span><span class="op" id="5861349">(</span><span class="ident" id="5861350">removeStar</span><span class="op" id="5861360">(</span><span class="ident" id="5861361">m</span><span class="op" id="5861362">.</span><span class="ident" id="5861363">Orig</span><span class="op" id="5861367">)</span><span class="op" id="5861368">)</span><span class="op" id="5861369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5861374">//&nbsp;forced&nbsp;inclusion,&nbsp;method&nbsp;not&nbsp;embedded,&nbsp;or&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5861429">//&nbsp;embedded&nbsp;but&nbsp;original&nbsp;receiver&nbsp;type&nbsp;not&nbsp;exported</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861484">list</span><span class="op" id="5861488">[</span><span class="ident" id="5861489">i</span><span class="op" id="5861490">]</span>&nbsp;<span class="op" id="5861492">=</span>&nbsp;<span class="ident" id="5861494">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861499">i</span><span class="op" id="5861500">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5861505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5861508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861511">list</span>&nbsp;<span class="op" id="5861516">=</span>&nbsp;<span class="ident" id="5861518">list</span><span class="op" id="5861522">[</span><span class="num" id="5861523">0</span><span class="op" id="5861524">:</span><span class="ident" id="5861525">i</span><span class="op" id="5861526">]</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861529">sortBy</span><span class="op" id="5861535">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861539">func</span><span class="op" id="5861543">(</span><span class="ident" id="5861544">i</span><span class="op" id="5861545">,</span>&nbsp;<span class="ident" id="5861547">j</span>&nbsp;<span class="builtintype" id="5861549">int</span><span class="op" id="5861552">)</span>&nbsp;<span class="builtintype" id="5861554">bool</span>&nbsp;<span class="op" id="5861559">{</span>&nbsp;<span class="keyword" id="5861561">return</span>&nbsp;<span class="ident" id="5861568">list</span><span class="op" id="5861572">[</span><span class="ident" id="5861573">i</span><span class="op" id="5861574">]</span><span class="op" id="5861575">.</span><span class="ident" id="5861576">Name</span>&nbsp;<span class="op" id="5861581">&lt;</span>&nbsp;<span class="ident" id="5861583">list</span><span class="op" id="5861587">[</span><span class="ident" id="5861588">j</span><span class="op" id="5861589">]</span><span class="op" id="5861590">.</span><span class="ident" id="5861591">Name</span>&nbsp;<span class="op" id="5861596">}</span><span class="op" id="5861597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861601">func</span><span class="op" id="5861605">(</span><span class="ident" id="5861606">i</span><span class="op" id="5861607">,</span>&nbsp;<span class="ident" id="5861609">j</span>&nbsp;<span class="builtintype" id="5861611">int</span><span class="op" id="5861614">)</span>&nbsp;<span class="op" id="5861616">{</span>&nbsp;<span class="ident" id="5861618">list</span><span class="op" id="5861622">[</span><span class="ident" id="5861623">i</span><span class="op" id="5861624">]</span><span class="op" id="5861625">,</span>&nbsp;<span class="ident" id="5861627">list</span><span class="op" id="5861631">[</span><span class="ident" id="5861632">j</span><span class="op" id="5861633">]</span>&nbsp;<span class="op" id="5861635">=</span>&nbsp;<span class="ident" id="5861637">list</span><span class="op" id="5861641">[</span><span class="ident" id="5861642">j</span><span class="op" id="5861643">]</span><span class="op" id="5861644">,</span>&nbsp;<span class="ident" id="5861646">list</span><span class="op" id="5861650">[</span><span class="ident" id="5861651">i</span><span class="op" id="5861652">]</span>&nbsp;<span class="op" id="5861654">}</span><span class="op" id="5861655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5861659">len</span><span class="op" id="5861662">(</span><span class="ident" id="5861663">list</span><span class="op" id="5861667">)</span><span class="op" id="5861668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5861671">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861674">return</span>&nbsp;<span class="ident" id="5861681">list</span><br>
<span class="lineno"></span><span class="op" id="5861686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861689">//&nbsp;noteBodies&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;note&nbsp;body&nbsp;strings&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;notes.</span><br>
<span class="lineno"></span><span class="comment" id="5861762">//&nbsp;This&nbsp;is&nbsp;only&nbsp;used&nbsp;to&nbsp;populate&nbsp;the&nbsp;deprecated&nbsp;Package.Bugs&nbsp;field.</span><br>
<span class="lineno">795</span><span class="comment" id="5861830">//</span><br>
<span class="lineno"></span><span class="keyword" id="5861833">func</span>&nbsp;<span class="ident" id="5861838">noteBodies</span><span class="op" id="5861848">(</span><span class="ident" id="5861849">notes</span>&nbsp;<span class="op" id="5861855">[</span><span class="op" id="5861856">]</span><span class="op" id="5861857">*</span><span class="ident" id="5861858">Note</span><span class="op" id="5861862">)</span>&nbsp;<span class="op" id="5861864">[</span><span class="op" id="5861865">]</span><span class="builtintype" id="5861866">string</span>&nbsp;<span class="op" id="5861873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861876">var</span>&nbsp;<span class="ident" id="5861880">list</span>&nbsp;<span class="op" id="5861885">[</span><span class="op" id="5861886">]</span><span class="builtintype" id="5861887">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861895">for</span>&nbsp;<span class="ident" id="5861899">_</span><span class="op" id="5861900">,</span>&nbsp;<span class="ident" id="5861902">n</span>&nbsp;<span class="op" id="5861904">:=</span>&nbsp;<span class="keyword" id="5861907">range</span>&nbsp;<span class="ident" id="5861913">notes</span>&nbsp;<span class="op" id="5861919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861923">list</span>&nbsp;<span class="op" id="5861928">=</span>&nbsp;<span class="builtinfunc" id="5861930">append</span><span class="op" id="5861936">(</span><span class="ident" id="5861937">list</span><span class="op" id="5861941">,</span>&nbsp;<span class="ident" id="5861943">n</span><span class="op" id="5861944">.</span><span class="ident" id="5861945">Body</span><span class="op" id="5861949">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5861952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5861955">return</span>&nbsp;<span class="ident" id="5861962">list</span><br>
<span class="lineno"></span><span class="op" id="5861967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861970">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">805</span><span class="comment" id="5862050">//&nbsp;Predeclared&nbsp;identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5862078">var</span>&nbsp;<span class="ident" id="5862082">predeclaredTypes</span>&nbsp;<span class="op" id="5862099">=</span>&nbsp;<span class="keyword" id="5862101">map</span><span class="op" id="5862104">[</span><span class="builtintype" id="5862105">string</span><span class="op" id="5862111">]</span><span class="builtintype" id="5862112">bool</span><span class="op" id="5862116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862119">&#34;bool&#34;</span><span class="op" id="5862125">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862133">true</span><span class="op" id="5862137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862140">&#34;byte&#34;</span><span class="op" id="5862146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862154">true</span><span class="op" id="5862158">,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862161">&#34;complex64&#34;</span><span class="op" id="5862172">:</span>&nbsp;&nbsp;<span class="builtintype" id="5862175">true</span><span class="op" id="5862179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862182">&#34;complex128&#34;</span><span class="op" id="5862194">:</span>&nbsp;<span class="builtintype" id="5862196">true</span><span class="op" id="5862200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862203">&#34;error&#34;</span><span class="op" id="5862210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862217">true</span><span class="op" id="5862221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862224">&#34;float32&#34;</span><span class="op" id="5862233">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862238">true</span><span class="op" id="5862242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862245">&#34;float64&#34;</span><span class="op" id="5862254">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862259">true</span><span class="op" id="5862263">,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862266">&#34;int&#34;</span><span class="op" id="5862271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862280">true</span><span class="op" id="5862284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862287">&#34;int8&#34;</span><span class="op" id="5862293">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862301">true</span><span class="op" id="5862305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862308">&#34;int16&#34;</span><span class="op" id="5862315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862322">true</span><span class="op" id="5862326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862329">&#34;int32&#34;</span><span class="op" id="5862336">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862343">true</span><span class="op" id="5862347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862350">&#34;int64&#34;</span><span class="op" id="5862357">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862364">true</span><span class="op" id="5862368">,</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862371">&#34;rune&#34;</span><span class="op" id="5862377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862385">true</span><span class="op" id="5862389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862392">&#34;string&#34;</span><span class="op" id="5862400">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862406">true</span><span class="op" id="5862410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862413">&#34;uint&#34;</span><span class="op" id="5862419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862427">true</span><span class="op" id="5862431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862434">&#34;uint8&#34;</span><span class="op" id="5862441">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862448">true</span><span class="op" id="5862452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862455">&#34;uint16&#34;</span><span class="op" id="5862463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862469">true</span><span class="op" id="5862473">,</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862476">&#34;uint32&#34;</span><span class="op" id="5862484">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862490">true</span><span class="op" id="5862494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862497">&#34;uint64&#34;</span><span class="op" id="5862505">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862511">true</span><span class="op" id="5862515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862518">&#34;uintptr&#34;</span><span class="op" id="5862527">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862532">true</span><span class="op" id="5862536">,</span><br>
<span class="lineno"></span><span class="op" id="5862538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="keyword" id="5862541">var</span>&nbsp;<span class="ident" id="5862545">predeclaredFuncs</span>&nbsp;<span class="op" id="5862562">=</span>&nbsp;<span class="keyword" id="5862564">map</span><span class="op" id="5862567">[</span><span class="builtintype" id="5862568">string</span><span class="op" id="5862574">]</span><span class="builtintype" id="5862575">bool</span><span class="op" id="5862579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862582">&#34;append&#34;</span><span class="op" id="5862590">:</span>&nbsp;&nbsp;<span class="builtintype" id="5862593">true</span><span class="op" id="5862597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862600">&#34;cap&#34;</span><span class="op" id="5862605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862611">true</span><span class="op" id="5862615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862618">&#34;close&#34;</span><span class="op" id="5862625">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862629">true</span><span class="op" id="5862633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862636">&#34;complex&#34;</span><span class="op" id="5862645">:</span>&nbsp;<span class="builtintype" id="5862647">true</span><span class="op" id="5862651">,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862654">&#34;copy&#34;</span><span class="op" id="5862660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862665">true</span><span class="op" id="5862669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862672">&#34;delete&#34;</span><span class="op" id="5862680">:</span>&nbsp;&nbsp;<span class="builtintype" id="5862683">true</span><span class="op" id="5862687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862690">&#34;imag&#34;</span><span class="op" id="5862696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862701">true</span><span class="op" id="5862705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862708">&#34;len&#34;</span><span class="op" id="5862713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862719">true</span><span class="op" id="5862723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862726">&#34;make&#34;</span><span class="op" id="5862732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862737">true</span><span class="op" id="5862741">,</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862744">&#34;new&#34;</span><span class="op" id="5862749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862755">true</span><span class="op" id="5862759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862762">&#34;panic&#34;</span><span class="op" id="5862769">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862773">true</span><span class="op" id="5862777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862780">&#34;print&#34;</span><span class="op" id="5862787">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862791">true</span><span class="op" id="5862795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862798">&#34;println&#34;</span><span class="op" id="5862807">:</span>&nbsp;<span class="builtintype" id="5862809">true</span><span class="op" id="5862813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862816">&#34;real&#34;</span><span class="op" id="5862822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862827">true</span><span class="op" id="5862831">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862834">&#34;recover&#34;</span><span class="op" id="5862843">:</span>&nbsp;<span class="builtintype" id="5862845">true</span><span class="op" id="5862849">,</span><br>
<span class="lineno"></span><span class="op" id="5862851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5862854">var</span>&nbsp;<span class="ident" id="5862858">predeclaredConstants</span>&nbsp;<span class="op" id="5862879">=</span>&nbsp;<span class="keyword" id="5862881">map</span><span class="op" id="5862884">[</span><span class="builtintype" id="5862885">string</span><span class="op" id="5862891">]</span><span class="builtintype" id="5862892">bool</span><span class="op" id="5862896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862899">&#34;false&#34;</span><span class="op" id="5862906">:</span>&nbsp;<span class="builtintype" id="5862908">true</span><span class="op" id="5862912">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862915">&#34;iota&#34;</span><span class="op" id="5862921">:</span>&nbsp;&nbsp;<span class="builtintype" id="5862924">true</span><span class="op" id="5862928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862931">&#34;nil&#34;</span><span class="op" id="5862936">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862940">true</span><span class="op" id="5862944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5862947">&#34;true&#34;</span><span class="op" id="5862953">:</span>&nbsp;&nbsp;<span class="builtintype" id="5862956">true</span><span class="op" id="5862960">,</span><br>
<span class="lineno"></span><span class="op" id="5862962">}</span>
</div>
</body>
</html>
