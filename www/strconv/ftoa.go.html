<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1601415">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1601470">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1601524">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1601575">//&nbsp;Binary&nbsp;to&nbsp;decimal&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1601623">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="1601637">//&nbsp;&nbsp;&nbsp;1)&nbsp;store&nbsp;mantissa&nbsp;in&nbsp;multiprecision&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="1601686">//&nbsp;&nbsp;&nbsp;2)&nbsp;shift&nbsp;decimal&nbsp;by&nbsp;exponent</span><br>
<span class="lineno"></span><span class="comment" id="1601720">//&nbsp;&nbsp;&nbsp;3)&nbsp;read&nbsp;digits&nbsp;out&nbsp;&amp;&nbsp;format</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1601754">package</span>&nbsp;<span class="ident" id="1601762">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1601771">import</span>&nbsp;<span class="string" id="1601778">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="1601786">//&nbsp;TODO:&nbsp;move&nbsp;elsewhere?</span><br>
<span class="lineno"></span><span class="keyword" id="1601811">type</span>&nbsp;<span class="ident" id="1601816">floatInfo</span>&nbsp;<span class="keyword" id="1601826">struct</span>&nbsp;<span class="op" id="1601833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601836">mantbits</span>&nbsp;<span class="builtintype" id="1601845">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601851">expbits</span>&nbsp;&nbsp;<span class="builtintype" id="1601860">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1601866">bias</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1601875">int</span><br>
<span class="lineno">20</span><span class="op" id="1601879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1601882">var</span>&nbsp;<span class="ident" id="1601886">float32info</span>&nbsp;<span class="op" id="1601898">=</span>&nbsp;<span class="ident" id="1601900"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><span class="op" id="1601909">{</span><span class="num" id="1601910">23</span><span class="op" id="1601912">,</span>&nbsp;<span class="num" id="1601914">8</span><span class="op" id="1601915">,</span>&nbsp;<span class="op" id="1601917">-</span><span class="num" id="1601918">127</span><span class="op" id="1601921">}</span><br>
<span class="lineno"></span><span class="keyword" id="1601923">var</span>&nbsp;<span class="ident" id="1601927">float64info</span>&nbsp;<span class="op" id="1601939">=</span>&nbsp;<span class="ident" id="1601941"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><span class="op" id="1601950">{</span><span class="num" id="1601951">52</span><span class="op" id="1601953">,</span>&nbsp;<span class="num" id="1601955">11</span><span class="op" id="1601957">,</span>&nbsp;<span class="op" id="1601959">-</span><span class="num" id="1601960">1023</span><span class="op" id="1601964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1601967">//&nbsp;FormatFloat&nbsp;converts&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;f&nbsp;to&nbsp;a&nbsp;string,</span><br>
<span class="lineno"></span><span class="comment" id="1602032">//&nbsp;according&nbsp;to&nbsp;the&nbsp;format&nbsp;fmt&nbsp;and&nbsp;precision&nbsp;prec.&nbsp;&nbsp;It&nbsp;rounds&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1602098">//&nbsp;result&nbsp;assuming&nbsp;that&nbsp;the&nbsp;original&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno"></span><span class="comment" id="1602170">//&nbsp;value&nbsp;of&nbsp;bitSize&nbsp;bits&nbsp;(32&nbsp;for&nbsp;float32,&nbsp;64&nbsp;for&nbsp;float64).</span><br>
<span class="lineno"></span><span class="comment" id="1602229">//</span><br>
<span class="lineno">30</span><span class="comment" id="1602232">//&nbsp;The&nbsp;format&nbsp;fmt&nbsp;is&nbsp;one&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1602260">//&nbsp;&#39;b&#39;&nbsp;(-ddddp±ddd,&nbsp;a&nbsp;binary&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="1602301">//&nbsp;&#39;e&#39;&nbsp;(-d.dddde±dd,&nbsp;a&nbsp;decimal&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="1602344">//&nbsp;&#39;E&#39;&nbsp;(-d.ddddE±dd,&nbsp;a&nbsp;decimal&nbsp;exponent),</span><br>
<span class="lineno"></span><span class="comment" id="1602387">//&nbsp;&#39;f&#39;&nbsp;(-ddd.dddd,&nbsp;no&nbsp;exponent),</span><br>
<span class="lineno">35</span><span class="comment" id="1602420">//&nbsp;&#39;g&#39;&nbsp;(&#39;e&#39;&nbsp;for&nbsp;large&nbsp;exponents,&nbsp;&#39;f&#39;&nbsp;otherwise),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1602472">//&nbsp;&#39;G&#39;&nbsp;(&#39;E&#39;&nbsp;for&nbsp;large&nbsp;exponents,&nbsp;&#39;f&#39;&nbsp;otherwise).</span><br>
<span class="lineno"></span><span class="comment" id="1602521">//</span><br>
<span class="lineno"></span><span class="comment" id="1602524">//&nbsp;The&nbsp;precision&nbsp;prec&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1602576">//&nbsp;(excluding&nbsp;the&nbsp;exponent)&nbsp;printed&nbsp;by&nbsp;the&nbsp;&#39;e&#39;,&nbsp;&#39;E&#39;,&nbsp;&#39;f&#39;,&nbsp;&#39;g&#39;,&nbsp;and&nbsp;&#39;G&#39;&nbsp;formats.</span><br>
<span class="lineno">40</span><span class="comment" id="1602656">//&nbsp;For&nbsp;&#39;e&#39;,&nbsp;&#39;E&#39;,&nbsp;and&nbsp;&#39;f&#39;&nbsp;it&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;digits&nbsp;after&nbsp;the&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span><span class="comment" id="1602733">//&nbsp;For&nbsp;&#39;g&#39;&nbsp;and&nbsp;&#39;G&#39;&nbsp;it&nbsp;is&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="1602786">//&nbsp;The&nbsp;special&nbsp;precision&nbsp;-1&nbsp;uses&nbsp;the&nbsp;smallest&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1602849">//&nbsp;necessary&nbsp;such&nbsp;that&nbsp;ParseFloat&nbsp;will&nbsp;return&nbsp;f&nbsp;exactly.</span><br>
<span class="lineno"></span><span class="keyword" id="1602906">func</span>&nbsp;<span class="ident" id="1602911">FormatFloat</span><span class="op" id="1602922">(</span><span class="ident" id="1602923">f</span>&nbsp;<span class="builtintype" id="1602925">float64</span><span class="op" id="1602932">,</span>&nbsp;<span class="ident" id="1602934">fmt</span>&nbsp;<span class="builtintype" id="1602938">byte</span><span class="op" id="1602942">,</span>&nbsp;<span class="ident" id="1602944">prec</span><span class="op" id="1602948">,</span>&nbsp;<span class="ident" id="1602950">bitSize</span>&nbsp;<span class="builtintype" id="1602958">int</span><span class="op" id="1602961">)</span>&nbsp;<span class="builtintype" id="1602963">string</span>&nbsp;<span class="op" id="1602970">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1602973">return</span>&nbsp;<span class="builtintype" id="1602980">string</span><span class="op" id="1602986">(</span><span class="ident" id="1602987"><a href="/strconv/ftoa.go.html#1603341">genericFtoa</a></span><span class="op" id="1602998">(</span><span class="builtinfunc" id="1602999">make</span><span class="op" id="1603003">(</span><span class="op" id="1603004">[</span><span class="op" id="1603005">]</span><span class="builtintype" id="1603006">byte</span><span class="op" id="1603010">,</span>&nbsp;<span class="num" id="1603012">0</span><span class="op" id="1603013">,</span>&nbsp;<span class="ident" id="1603015"><a href="/strconv/ftoa.go.html#1612717">max</a></span><span class="op" id="1603018">(</span><span class="ident" id="1603019"><a href="/strconv/ftoa.go.html#1602944">prec</a></span><span class="op" id="1603023">+</span><span class="num" id="1603024">4</span><span class="op" id="1603025">,</span>&nbsp;<span class="num" id="1603027">24</span><span class="op" id="1603029">)</span><span class="op" id="1603030">)</span><span class="op" id="1603031">,</span>&nbsp;<span class="ident" id="1603033"><a href="/strconv/ftoa.go.html#1602923">f</a></span><span class="op" id="1603034">,</span>&nbsp;<span class="ident" id="1603036"><a href="/strconv/ftoa.go.html#1602934">fmt</a></span><span class="op" id="1603039">,</span>&nbsp;<span class="ident" id="1603041"><a href="/strconv/ftoa.go.html#1602944">prec</a></span><span class="op" id="1603045">,</span>&nbsp;<span class="ident" id="1603047"><a href="/strconv/ftoa.go.html#1602950">bitSize</a></span><span class="op" id="1603054">)</span><span class="op" id="1603055">)</span><br>
<span class="lineno"></span><span class="op" id="1603057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1603060">//&nbsp;AppendFloat&nbsp;appends&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;f,</span><br>
<span class="lineno"></span><span class="comment" id="1603131">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;FormatFloat,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">50</span><span class="keyword" id="1603203">func</span>&nbsp;<span class="ident" id="1603208">AppendFloat</span><span class="op" id="1603219">(</span><span class="ident" id="1603220">dst</span>&nbsp;<span class="op" id="1603224">[</span><span class="op" id="1603225">]</span><span class="builtintype" id="1603226">byte</span><span class="op" id="1603230">,</span>&nbsp;<span class="ident" id="1603232">f</span>&nbsp;<span class="builtintype" id="1603234">float64</span><span class="op" id="1603241">,</span>&nbsp;<span class="ident" id="1603243">fmt</span>&nbsp;<span class="builtintype" id="1603247">byte</span><span class="op" id="1603251">,</span>&nbsp;<span class="ident" id="1603253">prec</span>&nbsp;<span class="builtintype" id="1603258">int</span><span class="op" id="1603261">,</span>&nbsp;<span class="ident" id="1603263">bitSize</span>&nbsp;<span class="builtintype" id="1603271">int</span><span class="op" id="1603274">)</span>&nbsp;<span class="op" id="1603276">[</span><span class="op" id="1603277">]</span><span class="builtintype" id="1603278">byte</span>&nbsp;<span class="op" id="1603283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603286">return</span>&nbsp;<span class="ident" id="1603293"><a href="/strconv/ftoa.go.html#1603341">genericFtoa</a></span><span class="op" id="1603304">(</span><span class="ident" id="1603305"><a href="/strconv/ftoa.go.html#1603220">dst</a></span><span class="op" id="1603308">,</span>&nbsp;<span class="ident" id="1603310"><a href="/strconv/ftoa.go.html#1603232">f</a></span><span class="op" id="1603311">,</span>&nbsp;<span class="ident" id="1603313"><a href="/strconv/ftoa.go.html#1603243">fmt</a></span><span class="op" id="1603316">,</span>&nbsp;<span class="ident" id="1603318"><a href="/strconv/ftoa.go.html#1603253">prec</a></span><span class="op" id="1603322">,</span>&nbsp;<span class="ident" id="1603324"><a href="/strconv/ftoa.go.html#1603263">bitSize</a></span><span class="op" id="1603331">)</span><br>
<span class="lineno"></span><span class="op" id="1603333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1603336">func</span>&nbsp;<span class="ident" id="1603341">genericFtoa</span><span class="op" id="1603352">(</span><span class="ident" id="1603353">dst</span>&nbsp;<span class="op" id="1603357">[</span><span class="op" id="1603358">]</span><span class="builtintype" id="1603359">byte</span><span class="op" id="1603363">,</span>&nbsp;<span class="ident" id="1603365">val</span>&nbsp;<span class="builtintype" id="1603369">float64</span><span class="op" id="1603376">,</span>&nbsp;<span class="ident" id="1603378">fmt</span>&nbsp;<span class="builtintype" id="1603382">byte</span><span class="op" id="1603386">,</span>&nbsp;<span class="ident" id="1603388">prec</span><span class="op" id="1603392">,</span>&nbsp;<span class="ident" id="1603394">bitSize</span>&nbsp;<span class="builtintype" id="1603402">int</span><span class="op" id="1603405">)</span>&nbsp;<span class="op" id="1603407">[</span><span class="op" id="1603408">]</span><span class="builtintype" id="1603409">byte</span>&nbsp;<span class="op" id="1603414">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603417">var</span>&nbsp;<span class="ident" id="1603421">bits</span>&nbsp;<span class="ident" id="1603426">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603434">var</span>&nbsp;<span class="ident" id="1603438">flt</span>&nbsp;<span class="op" id="1603442">*</span><span class="ident" id="1603443"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603454">switch</span>&nbsp;<span class="ident" id="1603461"><a href="/strconv/ftoa.go.html#1603394">bitSize</a></span>&nbsp;<span class="op" id="1603469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603472">case</span>&nbsp;<span class="num" id="1603477">32</span><span class="op" id="1603479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603483"><a href="/strconv/ftoa.go.html#1603421">bits</a></span>&nbsp;<span class="op" id="1603488">=</span>&nbsp;<span class="ident" id="1603490">uint64</span><span class="op" id="1603496">(</span><span class="ident" id="1603497"><a href="/strconv/ftoa.go.html#1601778">math</a></span><span class="op" id="1603501">.</span><span class="ident" id="1603502">Float32bits</span><span class="op" id="1603513">(</span><span class="builtintype" id="1603514">float32</span><span class="op" id="1603521">(</span><span class="ident" id="1603522"><a href="/strconv/ftoa.go.html#1603365">val</a></span><span class="op" id="1603525">)</span><span class="op" id="1603526">)</span><span class="op" id="1603527">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603531"><a href="/strconv/ftoa.go.html#1603438">flt</a></span>&nbsp;<span class="op" id="1603535">=</span>&nbsp;<span class="op" id="1603537">&amp;</span><span class="ident" id="1603538"><a href="/strconv/ftoa.go.html#1601886">float32info</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603551">case</span>&nbsp;<span class="num" id="1603556">64</span><span class="op" id="1603558">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603562"><a href="/strconv/ftoa.go.html#1603421">bits</a></span>&nbsp;<span class="op" id="1603567">=</span>&nbsp;<span class="ident" id="1603569"><a href="/strconv/ftoa.go.html#1601778">math</a></span><span class="op" id="1603573">.</span><span class="ident" id="1603574">Float64bits</span><span class="op" id="1603585">(</span><span class="ident" id="1603586"><a href="/strconv/ftoa.go.html#1603365">val</a></span><span class="op" id="1603589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603593"><a href="/strconv/ftoa.go.html#1603438">flt</a></span>&nbsp;<span class="op" id="1603597">=</span>&nbsp;<span class="op" id="1603599">&amp;</span><span class="ident" id="1603600"><a href="/strconv/ftoa.go.html#1601927">float64info</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603613">default</span><span class="op" id="1603620">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1603624">panic</span><span class="op" id="1603629">(</span><span class="string" id="1603630">&#34;strconv:&nbsp;illegal&nbsp;AppendFloat/FormatFloat&nbsp;bitSize&#34;</span><span class="op" id="1603680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603687">neg</span>&nbsp;<span class="op" id="1603691">:=</span>&nbsp;<span class="ident" id="1603694"><a href="/strconv/ftoa.go.html#1603421">bits</a></span><span class="op" id="1603698">&gt;&gt;</span><span class="op" id="1603700">(</span><span class="ident" id="1603701"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603704">.</span><span class="ident" id="1603705">expbits</span><span class="op" id="1603712">+</span><span class="ident" id="1603713"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603716">.</span><span class="ident" id="1603717">mantbits</span><span class="op" id="1603725">)</span>&nbsp;<span class="op" id="1603727">!=</span>&nbsp;<span class="num" id="1603730">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603733">exp</span>&nbsp;<span class="op" id="1603737">:=</span>&nbsp;<span class="builtintype" id="1603740">int</span><span class="op" id="1603743">(</span><span class="ident" id="1603744"><a href="/strconv/ftoa.go.html#1603421">bits</a></span><span class="op" id="1603748">&gt;&gt;</span><span class="ident" id="1603750"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603753">.</span><span class="ident" id="1603754">mantbits</span><span class="op" id="1603762">)</span>&nbsp;<span class="op" id="1603764">&amp;</span>&nbsp;<span class="op" id="1603766">(</span><span class="num" id="1603767">1</span><span class="op" id="1603768">&lt;&lt;</span><span class="ident" id="1603770"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603773">.</span><span class="ident" id="1603774">expbits</span>&nbsp;<span class="op" id="1603782">-</span>&nbsp;<span class="num" id="1603784">1</span><span class="op" id="1603785">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603788">mant</span>&nbsp;<span class="op" id="1603793">:=</span>&nbsp;<span class="ident" id="1603796"><a href="/strconv/ftoa.go.html#1603421">bits</a></span>&nbsp;<span class="op" id="1603801">&amp;</span>&nbsp;<span class="op" id="1603803">(</span><span class="ident" id="1603804">uint64</span><span class="op" id="1603810">(</span><span class="num" id="1603811">1</span><span class="op" id="1603812">)</span><span class="op" id="1603813">&lt;&lt;</span><span class="ident" id="1603815"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603818">.</span><span class="ident" id="1603819">mantbits</span>&nbsp;<span class="op" id="1603828">-</span>&nbsp;<span class="num" id="1603830">1</span><span class="op" id="1603831">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603835">switch</span>&nbsp;<span class="ident" id="1603842"><a href="/strconv/ftoa.go.html#1603733">exp</a></span>&nbsp;<span class="op" id="1603846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603849">case</span>&nbsp;<span class="num" id="1603854">1</span><span class="op" id="1603855">&lt;&lt;</span><span class="ident" id="1603857"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1603860">.</span><span class="ident" id="1603861">expbits</span>&nbsp;<span class="op" id="1603869">-</span>&nbsp;<span class="num" id="1603871">1</span><span class="op" id="1603872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1603876">//&nbsp;Inf,&nbsp;NaN</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603890">var</span>&nbsp;<span class="ident" id="1603894">s</span>&nbsp;<span class="builtintype" id="1603896">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603905">switch</span>&nbsp;<span class="op" id="1603912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603916">case</span>&nbsp;<span class="ident" id="1603921"><a href="/strconv/ftoa.go.html#1603788">mant</a></span>&nbsp;<span class="op" id="1603926">!=</span>&nbsp;<span class="num" id="1603929">0</span><span class="op" id="1603930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603935"><a href="/strconv/ftoa.go.html#1603894">s</a></span>&nbsp;<span class="op" id="1603937">=</span>&nbsp;<span class="string" id="1603939">&#34;NaN&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603947">case</span>&nbsp;<span class="ident" id="1603952"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1603955">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603960"><a href="/strconv/ftoa.go.html#1603894">s</a></span>&nbsp;<span class="op" id="1603962">=</span>&nbsp;<span class="string" id="1603964">&#34;-Inf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1603973">default</span><span class="op" id="1603980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1603985"><a href="/strconv/ftoa.go.html#1603894">s</a></span>&nbsp;<span class="op" id="1603987">=</span>&nbsp;<span class="string" id="1603989">&#34;+Inf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1603998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604002">return</span>&nbsp;<span class="builtinfunc" id="1604009">append</span><span class="op" id="1604015">(</span><span class="ident" id="1604016"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1604019">,</span>&nbsp;<span class="ident" id="1604021"><a href="/strconv/ftoa.go.html#1603894">s</a></span><span class="op" id="1604022">...</span><span class="op" id="1604025">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604029">case</span>&nbsp;<span class="num" id="1604034">0</span><span class="op" id="1604035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604039">//&nbsp;denormalized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604057"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1604060">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604065">default</span><span class="op" id="1604072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604076">//&nbsp;add&nbsp;implicit&nbsp;top&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604102"><a href="/strconv/ftoa.go.html#1603788">mant</a></span>&nbsp;<span class="op" id="1604107">|=</span>&nbsp;<span class="ident" id="1604110">uint64</span><span class="op" id="1604116">(</span><span class="num" id="1604117">1</span><span class="op" id="1604118">)</span>&nbsp;<span class="op" id="1604120">&lt;&lt;</span>&nbsp;<span class="ident" id="1604123"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604126">.</span><span class="ident" id="1604127">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604140"><a href="/strconv/ftoa.go.html#1603733">exp</a></span>&nbsp;<span class="op" id="1604144">+=</span>&nbsp;<span class="ident" id="1604147"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604150">.</span><span class="ident" id="1604151">bias</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604158">//&nbsp;Pick&nbsp;off&nbsp;easy&nbsp;binary&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604191">if</span>&nbsp;<span class="ident" id="1604194"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span>&nbsp;<span class="op" id="1604198">==</span>&nbsp;<span class="string" id="1604201">&#39;b&#39;</span>&nbsp;<span class="op" id="1604205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604209">return</span>&nbsp;<span class="ident" id="1604216"><a href="/strconv/ftoa.go.html#1612226">fmtB</a></span><span class="op" id="1604220">(</span><span class="ident" id="1604221"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1604224">,</span>&nbsp;<span class="ident" id="1604226"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1604229">,</span>&nbsp;<span class="ident" id="1604231"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1604235">,</span>&nbsp;<span class="ident" id="1604237"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1604240">,</span>&nbsp;<span class="ident" id="1604242"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604248">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604252">if</span>&nbsp;<span class="op" id="1604255">!</span><span class="ident" id="1604256"><a href="/strconv/atof.go.html#1557819">optimize</a></span>&nbsp;<span class="op" id="1604265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604269">return</span>&nbsp;<span class="ident" id="1604276"><a href="/strconv/ftoa.go.html#1605524">bigFtoa</a></span><span class="op" id="1604283">(</span><span class="ident" id="1604284"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1604287">,</span>&nbsp;<span class="ident" id="1604289"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><span class="op" id="1604293">,</span>&nbsp;<span class="ident" id="1604295"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span><span class="op" id="1604298">,</span>&nbsp;<span class="ident" id="1604300"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1604303">,</span>&nbsp;<span class="ident" id="1604305"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1604309">,</span>&nbsp;<span class="ident" id="1604311"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1604314">,</span>&nbsp;<span class="ident" id="1604316"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604326">var</span>&nbsp;<span class="ident" id="1604330">digs</span>&nbsp;<span class="ident" id="1604335"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604349">ok</span>&nbsp;<span class="op" id="1604352">:=</span>&nbsp;<span class="ident" id="1604355">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604362">//&nbsp;Negative&nbsp;precision&nbsp;means&nbsp;&#34;only&nbsp;as&nbsp;much&nbsp;as&nbsp;needed&nbsp;to&nbsp;be&nbsp;exact.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604429">shortest</span>&nbsp;<span class="op" id="1604438">:=</span>&nbsp;<span class="ident" id="1604441"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1604446">&lt;</span>&nbsp;<span class="num" id="1604448">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604451">if</span>&nbsp;<span class="ident" id="1604454"><a href="/strconv/ftoa.go.html#1604429">shortest</a></span>&nbsp;<span class="op" id="1604463">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604467">//&nbsp;Try&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604494">f</span>&nbsp;<span class="op" id="1604496">:=</span>&nbsp;<span class="builtinfunc" id="1604499">new</span><span class="op" id="1604502">(</span><span class="ident" id="1604503"><a href="/strconv/extfloat.go.html#1581573">extFloat</a></span><span class="op" id="1604511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604515">lower</span><span class="op" id="1604520">,</span>&nbsp;<span class="ident" id="1604522">upper</span>&nbsp;<span class="op" id="1604528">:=</span>&nbsp;<span class="ident" id="1604531"><a href="/strconv/ftoa.go.html#1604494">f</a></span><span class="op" id="1604532">.</span><span class="ident" id="1604533">AssignComputeBounds</span><span class="op" id="1604552">(</span><span class="ident" id="1604553"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1604557">,</span>&nbsp;<span class="ident" id="1604559"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1604562">,</span>&nbsp;<span class="ident" id="1604564"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1604567">,</span>&nbsp;<span class="ident" id="1604569"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604576">var</span>&nbsp;<span class="ident" id="1604580">buf</span>&nbsp;<span class="op" id="1604584">[</span><span class="num" id="1604585">32</span><span class="op" id="1604587">]</span><span class="builtintype" id="1604588">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604595"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604599">.</span><span class="ident" id="1604600">d</span>&nbsp;<span class="op" id="1604602">=</span>&nbsp;<span class="ident" id="1604604"><a href="/strconv/ftoa.go.html#1604580">buf</a></span><span class="op" id="1604607">[</span><span class="op" id="1604608">:</span><span class="op" id="1604609">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604613"><a href="/strconv/ftoa.go.html#1604349">ok</a></span>&nbsp;<span class="op" id="1604616">=</span>&nbsp;<span class="ident" id="1604618"><a href="/strconv/ftoa.go.html#1604494">f</a></span><span class="op" id="1604619">.</span><span class="ident" id="1604620">ShortestDecimal</span><span class="op" id="1604635">(</span><span class="op" id="1604636">&amp;</span><span class="ident" id="1604637"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604641">,</span>&nbsp;<span class="op" id="1604643">&amp;</span><span class="ident" id="1604644"><a href="/strconv/ftoa.go.html#1604515">lower</a></span><span class="op" id="1604649">,</span>&nbsp;<span class="op" id="1604651">&amp;</span><span class="ident" id="1604652"><a href="/strconv/ftoa.go.html#1604522">upper</a></span><span class="op" id="1604657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604661">if</span>&nbsp;<span class="op" id="1604664">!</span><span class="ident" id="1604665"><a href="/strconv/ftoa.go.html#1604349">ok</a></span>&nbsp;<span class="op" id="1604668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604673">return</span>&nbsp;<span class="ident" id="1604680"><a href="/strconv/ftoa.go.html#1605524">bigFtoa</a></span><span class="op" id="1604687">(</span><span class="ident" id="1604688"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1604691">,</span>&nbsp;<span class="ident" id="1604693"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><span class="op" id="1604697">,</span>&nbsp;<span class="ident" id="1604699"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span><span class="op" id="1604702">,</span>&nbsp;<span class="ident" id="1604704"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1604707">,</span>&nbsp;<span class="ident" id="1604709"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1604713">,</span>&nbsp;<span class="ident" id="1604715"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1604718">,</span>&nbsp;<span class="ident" id="1604720"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1604723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604731">//&nbsp;Precision&nbsp;for&nbsp;shortest&nbsp;representation&nbsp;mode.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604780">switch</span>&nbsp;<span class="ident" id="1604787"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span>&nbsp;<span class="op" id="1604791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604795">case</span>&nbsp;<span class="string" id="1604800">&#39;e&#39;</span><span class="op" id="1604803">,</span>&nbsp;<span class="string" id="1604805">&#39;E&#39;</span><span class="op" id="1604808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604813"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1604818">=</span>&nbsp;<span class="ident" id="1604820"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604824">.</span><span class="ident" id="1604825">nd</span>&nbsp;<span class="op" id="1604828">-</span>&nbsp;<span class="num" id="1604830">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604834">case</span>&nbsp;<span class="string" id="1604839">&#39;f&#39;</span><span class="op" id="1604842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604847"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1604852">=</span>&nbsp;<span class="ident" id="1604854"><a href="/strconv/ftoa.go.html#1612717">max</a></span><span class="op" id="1604857">(</span><span class="ident" id="1604858"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604862">.</span><span class="ident" id="1604863">nd</span><span class="op" id="1604865">-</span><span class="ident" id="1604866"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604870">.</span><span class="ident" id="1604871">dp</span><span class="op" id="1604873">,</span>&nbsp;<span class="num" id="1604875">0</span><span class="op" id="1604876">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604880">case</span>&nbsp;<span class="string" id="1604885">&#39;g&#39;</span><span class="op" id="1604888">,</span>&nbsp;<span class="string" id="1604890">&#39;G&#39;</span><span class="op" id="1604893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604898"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1604903">=</span>&nbsp;<span class="ident" id="1604905"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1604909">.</span><span class="ident" id="1604910">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1604918">}</span>&nbsp;<span class="keyword" id="1604920">else</span>&nbsp;<span class="keyword" id="1604925">if</span>&nbsp;<span class="ident" id="1604928"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span>&nbsp;<span class="op" id="1604932">!=</span>&nbsp;<span class="string" id="1604935">&#39;f&#39;</span>&nbsp;<span class="op" id="1604939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1604943">//&nbsp;Fixed&nbsp;number&nbsp;of&nbsp;digits.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1604972">digits</span>&nbsp;<span class="op" id="1604979">:=</span>&nbsp;<span class="ident" id="1604982"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1604989">switch</span>&nbsp;<span class="ident" id="1604996"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span>&nbsp;<span class="op" id="1605000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605004">case</span>&nbsp;<span class="string" id="1605009">&#39;e&#39;</span><span class="op" id="1605012">,</span>&nbsp;<span class="string" id="1605014">&#39;E&#39;</span><span class="op" id="1605017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605022"><a href="/strconv/ftoa.go.html#1604972">digits</a></span><span class="op" id="1605028">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605033">case</span>&nbsp;<span class="string" id="1605038">&#39;g&#39;</span><span class="op" id="1605041">,</span>&nbsp;<span class="string" id="1605043">&#39;G&#39;</span><span class="op" id="1605046">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605051">if</span>&nbsp;<span class="ident" id="1605054"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1605059">==</span>&nbsp;<span class="num" id="1605062">0</span>&nbsp;<span class="op" id="1605064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605070"><a href="/strconv/ftoa.go.html#1603388">prec</a></span>&nbsp;<span class="op" id="1605075">=</span>&nbsp;<span class="num" id="1605077">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1605082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605087"><a href="/strconv/ftoa.go.html#1604972">digits</a></span>&nbsp;<span class="op" id="1605094">=</span>&nbsp;<span class="ident" id="1605096"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1605103">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605107">if</span>&nbsp;<span class="ident" id="1605110"><a href="/strconv/ftoa.go.html#1604972">digits</a></span>&nbsp;<span class="op" id="1605117">&lt;=</span>&nbsp;<span class="num" id="1605120">15</span>&nbsp;<span class="op" id="1605123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1605128">//&nbsp;try&nbsp;fast&nbsp;algorithm&nbsp;when&nbsp;the&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;reasonable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605194">var</span>&nbsp;<span class="ident" id="1605198">buf</span>&nbsp;<span class="op" id="1605202">[</span><span class="num" id="1605203">24</span><span class="op" id="1605205">]</span><span class="builtintype" id="1605206">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605214"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1605218">.</span><span class="ident" id="1605219">d</span>&nbsp;<span class="op" id="1605221">=</span>&nbsp;<span class="ident" id="1605223"><a href="/strconv/ftoa.go.html#1605198">buf</a></span><span class="op" id="1605226">[</span><span class="op" id="1605227">:</span><span class="op" id="1605228">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605233">f</span>&nbsp;<span class="op" id="1605235">:=</span>&nbsp;<span class="ident" id="1605238"><a href="/strconv/extfloat.go.html#1581573">extFloat</a></span><span class="op" id="1605246">{</span><span class="ident" id="1605247"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1605251">,</span>&nbsp;<span class="ident" id="1605253"><a href="/strconv/ftoa.go.html#1603733">exp</a></span>&nbsp;<span class="op" id="1605257">-</span>&nbsp;<span class="builtintype" id="1605259">int</span><span class="op" id="1605262">(</span><span class="ident" id="1605263"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1605266">.</span><span class="ident" id="1605267">mantbits</span><span class="op" id="1605275">)</span><span class="op" id="1605276">,</span>&nbsp;<span class="ident" id="1605278"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1605281">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605286"><a href="/strconv/ftoa.go.html#1604349">ok</a></span>&nbsp;<span class="op" id="1605289">=</span>&nbsp;<span class="ident" id="1605291"><a href="/strconv/ftoa.go.html#1605233">f</a></span><span class="op" id="1605292">.</span><span class="ident" id="1605293">FixedDecimal</span><span class="op" id="1605305">(</span><span class="op" id="1605306">&amp;</span><span class="ident" id="1605307"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1605311">,</span>&nbsp;<span class="ident" id="1605313"><a href="/strconv/ftoa.go.html#1604972">digits</a></span><span class="op" id="1605319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1605323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1605326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605329">if</span>&nbsp;<span class="op" id="1605332">!</span><span class="ident" id="1605333"><a href="/strconv/ftoa.go.html#1604349">ok</a></span>&nbsp;<span class="op" id="1605336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605340">return</span>&nbsp;<span class="ident" id="1605347"><a href="/strconv/ftoa.go.html#1605524">bigFtoa</a></span><span class="op" id="1605354">(</span><span class="ident" id="1605355"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1605358">,</span>&nbsp;<span class="ident" id="1605360"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><span class="op" id="1605364">,</span>&nbsp;<span class="ident" id="1605366"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span><span class="op" id="1605369">,</span>&nbsp;<span class="ident" id="1605371"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1605374">,</span>&nbsp;<span class="ident" id="1605376"><a href="/strconv/ftoa.go.html#1603788">mant</a></span><span class="op" id="1605380">,</span>&nbsp;<span class="ident" id="1605382"><a href="/strconv/ftoa.go.html#1603733">exp</a></span><span class="op" id="1605385">,</span>&nbsp;<span class="ident" id="1605387"><a href="/strconv/ftoa.go.html#1603438">flt</a></span><span class="op" id="1605390">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1605393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605396">return</span>&nbsp;<span class="ident" id="1605403"><a href="/strconv/ftoa.go.html#1606347">formatDigits</a></span><span class="op" id="1605415">(</span><span class="ident" id="1605416"><a href="/strconv/ftoa.go.html#1603353">dst</a></span><span class="op" id="1605419">,</span>&nbsp;<span class="ident" id="1605421"><a href="/strconv/ftoa.go.html#1604429">shortest</a></span><span class="op" id="1605429">,</span>&nbsp;<span class="ident" id="1605431"><a href="/strconv/ftoa.go.html#1603687">neg</a></span><span class="op" id="1605434">,</span>&nbsp;<span class="ident" id="1605436"><a href="/strconv/ftoa.go.html#1604330">digs</a></span><span class="op" id="1605440">,</span>&nbsp;<span class="ident" id="1605442"><a href="/strconv/ftoa.go.html#1603388">prec</a></span><span class="op" id="1605446">,</span>&nbsp;<span class="ident" id="1605448"><a href="/strconv/ftoa.go.html#1603378">fmt</a></span><span class="op" id="1605451">)</span><br>
<span class="lineno"></span><span class="op" id="1605453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1605456">//&nbsp;bigFtoa&nbsp;uses&nbsp;multiprecision&nbsp;computations&nbsp;to&nbsp;format&nbsp;a&nbsp;float.</span><br>
<span class="lineno">155</span><span class="keyword" id="1605519">func</span>&nbsp;<span class="ident" id="1605524">bigFtoa</span><span class="op" id="1605531">(</span><span class="ident" id="1605532">dst</span>&nbsp;<span class="op" id="1605536">[</span><span class="op" id="1605537">]</span><span class="builtintype" id="1605538">byte</span><span class="op" id="1605542">,</span>&nbsp;<span class="ident" id="1605544">prec</span>&nbsp;<span class="builtintype" id="1605549">int</span><span class="op" id="1605552">,</span>&nbsp;<span class="ident" id="1605554">fmt</span>&nbsp;<span class="builtintype" id="1605558">byte</span><span class="op" id="1605562">,</span>&nbsp;<span class="ident" id="1605564">neg</span>&nbsp;<span class="builtintype" id="1605568">bool</span><span class="op" id="1605572">,</span>&nbsp;<span class="ident" id="1605574">mant</span>&nbsp;<span class="ident" id="1605579">uint64</span><span class="op" id="1605585">,</span>&nbsp;<span class="ident" id="1605587">exp</span>&nbsp;<span class="builtintype" id="1605591">int</span><span class="op" id="1605594">,</span>&nbsp;<span class="ident" id="1605596">flt</span>&nbsp;<span class="op" id="1605600">*</span><span class="ident" id="1605601"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><span class="op" id="1605610">)</span>&nbsp;<span class="op" id="1605612">[</span><span class="op" id="1605613">]</span><span class="builtintype" id="1605614">byte</span>&nbsp;<span class="op" id="1605619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605622">d</span>&nbsp;<span class="op" id="1605624">:=</span>&nbsp;<span class="builtinfunc" id="1605627">new</span><span class="op" id="1605630">(</span><span class="ident" id="1605631"><a href="/strconv/decimal.go.html#1573600">decimal</a></span><span class="op" id="1605638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605641"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605642">.</span><span class="ident" id="1605643">Assign</span><span class="op" id="1605649">(</span><span class="ident" id="1605650"><a href="/strconv/ftoa.go.html#1605574">mant</a></span><span class="op" id="1605654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605657"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605658">.</span><span class="ident" id="1605659">Shift</span><span class="op" id="1605664">(</span><span class="ident" id="1605665"><a href="/strconv/ftoa.go.html#1605587">exp</a></span>&nbsp;<span class="op" id="1605669">-</span>&nbsp;<span class="builtintype" id="1605671">int</span><span class="op" id="1605674">(</span><span class="ident" id="1605675"><a href="/strconv/ftoa.go.html#1605596">flt</a></span><span class="op" id="1605678">.</span><span class="ident" id="1605679">mantbits</span><span class="op" id="1605687">)</span><span class="op" id="1605688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605691">var</span>&nbsp;<span class="ident" id="1605695">digs</span>&nbsp;<span class="ident" id="1605700"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605714">shortest</span>&nbsp;<span class="op" id="1605723">:=</span>&nbsp;<span class="ident" id="1605726"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1605731">&lt;</span>&nbsp;<span class="num" id="1605733">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605736">if</span>&nbsp;<span class="ident" id="1605739"><a href="/strconv/ftoa.go.html#1605714">shortest</a></span>&nbsp;<span class="op" id="1605748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605752"><a href="/strconv/ftoa.go.html#1607458">roundShortest</a></span><span class="op" id="1605765">(</span><span class="ident" id="1605766"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605767">,</span>&nbsp;<span class="ident" id="1605769"><a href="/strconv/ftoa.go.html#1605574">mant</a></span><span class="op" id="1605773">,</span>&nbsp;<span class="ident" id="1605775"><a href="/strconv/ftoa.go.html#1605587">exp</a></span><span class="op" id="1605778">,</span>&nbsp;<span class="ident" id="1605780"><a href="/strconv/ftoa.go.html#1605596">flt</a></span><span class="op" id="1605783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605787"><a href="/strconv/ftoa.go.html#1605695">digs</a></span>&nbsp;<span class="op" id="1605792">=</span>&nbsp;<span class="ident" id="1605794"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><span class="op" id="1605806">{</span><span class="ident" id="1605807">d</span><span class="op" id="1605808">:</span>&nbsp;<span class="ident" id="1605810"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605811">.</span><span class="ident" id="1605812">d</span><span class="op" id="1605813">[</span><span class="op" id="1605814">:</span><span class="op" id="1605815">]</span><span class="op" id="1605816">,</span>&nbsp;<span class="ident" id="1605818">nd</span><span class="op" id="1605820">:</span>&nbsp;<span class="ident" id="1605822"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605823">.</span><span class="ident" id="1605824">nd</span><span class="op" id="1605826">,</span>&nbsp;<span class="ident" id="1605828">dp</span><span class="op" id="1605830">:</span>&nbsp;<span class="ident" id="1605832"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1605833">.</span><span class="ident" id="1605834">dp</span><span class="op" id="1605836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1605840">//&nbsp;Precision&nbsp;for&nbsp;shortest&nbsp;representation&nbsp;mode.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605889">switch</span>&nbsp;<span class="ident" id="1605896"><a href="/strconv/ftoa.go.html#1605554">fmt</a></span>&nbsp;<span class="op" id="1605900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605904">case</span>&nbsp;<span class="string" id="1605909">&#39;e&#39;</span><span class="op" id="1605912">,</span>&nbsp;<span class="string" id="1605914">&#39;E&#39;</span><span class="op" id="1605917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605922"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1605927">=</span>&nbsp;<span class="ident" id="1605929"><a href="/strconv/ftoa.go.html#1605695">digs</a></span><span class="op" id="1605933">.</span><span class="ident" id="1605934">nd</span>&nbsp;<span class="op" id="1605937">-</span>&nbsp;<span class="num" id="1605939">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605943">case</span>&nbsp;<span class="string" id="1605948">&#39;f&#39;</span><span class="op" id="1605951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1605956"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1605961">=</span>&nbsp;<span class="ident" id="1605963"><a href="/strconv/ftoa.go.html#1612717">max</a></span><span class="op" id="1605966">(</span><span class="ident" id="1605967"><a href="/strconv/ftoa.go.html#1605695">digs</a></span><span class="op" id="1605971">.</span><span class="ident" id="1605972">nd</span><span class="op" id="1605974">-</span><span class="ident" id="1605975"><a href="/strconv/ftoa.go.html#1605695">digs</a></span><span class="op" id="1605979">.</span><span class="ident" id="1605980">dp</span><span class="op" id="1605982">,</span>&nbsp;<span class="num" id="1605984">0</span><span class="op" id="1605985">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1605989">case</span>&nbsp;<span class="string" id="1605994">&#39;g&#39;</span><span class="op" id="1605997">,</span>&nbsp;<span class="string" id="1605999">&#39;G&#39;</span><span class="op" id="1606002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606007"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1606012">=</span>&nbsp;<span class="ident" id="1606014"><a href="/strconv/ftoa.go.html#1605695">digs</a></span><span class="op" id="1606018">.</span><span class="ident" id="1606019">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606027">}</span>&nbsp;<span class="keyword" id="1606029">else</span>&nbsp;<span class="op" id="1606034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606038">//&nbsp;Round&nbsp;appropriately.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606064">switch</span>&nbsp;<span class="ident" id="1606071"><a href="/strconv/ftoa.go.html#1605554">fmt</a></span>&nbsp;<span class="op" id="1606075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606079">case</span>&nbsp;<span class="string" id="1606084">&#39;e&#39;</span><span class="op" id="1606087">,</span>&nbsp;<span class="string" id="1606089">&#39;E&#39;</span><span class="op" id="1606092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606097"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606098">.</span><span class="ident" id="1606099">Round</span><span class="op" id="1606104">(</span><span class="ident" id="1606105"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1606110">+</span>&nbsp;<span class="num" id="1606112">1</span><span class="op" id="1606113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606117">case</span>&nbsp;<span class="string" id="1606122">&#39;f&#39;</span><span class="op" id="1606125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606130"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606131">.</span><span class="ident" id="1606132">Round</span><span class="op" id="1606137">(</span><span class="ident" id="1606138"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606139">.</span><span class="ident" id="1606140">dp</span>&nbsp;<span class="op" id="1606143">+</span>&nbsp;<span class="ident" id="1606145"><a href="/strconv/ftoa.go.html#1605544">prec</a></span><span class="op" id="1606149">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606153">case</span>&nbsp;<span class="string" id="1606158">&#39;g&#39;</span><span class="op" id="1606161">,</span>&nbsp;<span class="string" id="1606163">&#39;G&#39;</span><span class="op" id="1606166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606171">if</span>&nbsp;<span class="ident" id="1606174"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1606179">==</span>&nbsp;<span class="num" id="1606182">0</span>&nbsp;<span class="op" id="1606184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606190"><a href="/strconv/ftoa.go.html#1605544">prec</a></span>&nbsp;<span class="op" id="1606195">=</span>&nbsp;<span class="num" id="1606197">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606207"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606208">.</span><span class="ident" id="1606209">Round</span><span class="op" id="1606214">(</span><span class="ident" id="1606215"><a href="/strconv/ftoa.go.html#1605544">prec</a></span><span class="op" id="1606219">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606227"><a href="/strconv/ftoa.go.html#1605695">digs</a></span>&nbsp;<span class="op" id="1606232">=</span>&nbsp;<span class="ident" id="1606234"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><span class="op" id="1606246">{</span><span class="ident" id="1606247">d</span><span class="op" id="1606248">:</span>&nbsp;<span class="ident" id="1606250"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606251">.</span><span class="ident" id="1606252">d</span><span class="op" id="1606253">[</span><span class="op" id="1606254">:</span><span class="op" id="1606255">]</span><span class="op" id="1606256">,</span>&nbsp;<span class="ident" id="1606258">nd</span><span class="op" id="1606260">:</span>&nbsp;<span class="ident" id="1606262"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606263">.</span><span class="ident" id="1606264">nd</span><span class="op" id="1606266">,</span>&nbsp;<span class="ident" id="1606268">dp</span><span class="op" id="1606270">:</span>&nbsp;<span class="ident" id="1606272"><a href="/strconv/ftoa.go.html#1605622">d</a></span><span class="op" id="1606273">.</span><span class="ident" id="1606274">dp</span><span class="op" id="1606276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606282">return</span>&nbsp;<span class="ident" id="1606289"><a href="/strconv/ftoa.go.html#1606347">formatDigits</a></span><span class="op" id="1606301">(</span><span class="ident" id="1606302"><a href="/strconv/ftoa.go.html#1605532">dst</a></span><span class="op" id="1606305">,</span>&nbsp;<span class="ident" id="1606307"><a href="/strconv/ftoa.go.html#1605714">shortest</a></span><span class="op" id="1606315">,</span>&nbsp;<span class="ident" id="1606317"><a href="/strconv/ftoa.go.html#1605564">neg</a></span><span class="op" id="1606320">,</span>&nbsp;<span class="ident" id="1606322"><a href="/strconv/ftoa.go.html#1605695">digs</a></span><span class="op" id="1606326">,</span>&nbsp;<span class="ident" id="1606328"><a href="/strconv/ftoa.go.html#1605544">prec</a></span><span class="op" id="1606332">,</span>&nbsp;<span class="ident" id="1606334"><a href="/strconv/ftoa.go.html#1605554">fmt</a></span><span class="op" id="1606337">)</span><br>
<span class="lineno"></span><span class="op" id="1606339">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="1606342">func</span>&nbsp;<span class="ident" id="1606347">formatDigits</span><span class="op" id="1606359">(</span><span class="ident" id="1606360">dst</span>&nbsp;<span class="op" id="1606364">[</span><span class="op" id="1606365">]</span><span class="builtintype" id="1606366">byte</span><span class="op" id="1606370">,</span>&nbsp;<span class="ident" id="1606372">shortest</span>&nbsp;<span class="builtintype" id="1606381">bool</span><span class="op" id="1606385">,</span>&nbsp;<span class="ident" id="1606387">neg</span>&nbsp;<span class="builtintype" id="1606391">bool</span><span class="op" id="1606395">,</span>&nbsp;<span class="ident" id="1606397">digs</span>&nbsp;<span class="ident" id="1606402"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><span class="op" id="1606414">,</span>&nbsp;<span class="ident" id="1606416">prec</span>&nbsp;<span class="builtintype" id="1606421">int</span><span class="op" id="1606424">,</span>&nbsp;<span class="ident" id="1606426">fmt</span>&nbsp;<span class="builtintype" id="1606430">byte</span><span class="op" id="1606434">)</span>&nbsp;<span class="op" id="1606436">[</span><span class="op" id="1606437">]</span><span class="builtintype" id="1606438">byte</span>&nbsp;<span class="op" id="1606443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606446">switch</span>&nbsp;<span class="ident" id="1606453"><a href="/strconv/ftoa.go.html#1606426">fmt</a></span>&nbsp;<span class="op" id="1606457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606460">case</span>&nbsp;<span class="string" id="1606465">&#39;e&#39;</span><span class="op" id="1606468">,</span>&nbsp;<span class="string" id="1606470">&#39;E&#39;</span><span class="op" id="1606473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606477">return</span>&nbsp;<span class="ident" id="1606484"><a href="/strconv/ftoa.go.html#1610640">fmtE</a></span><span class="op" id="1606488">(</span><span class="ident" id="1606489"><a href="/strconv/ftoa.go.html#1606360">dst</a></span><span class="op" id="1606492">,</span>&nbsp;<span class="ident" id="1606494"><a href="/strconv/ftoa.go.html#1606387">neg</a></span><span class="op" id="1606497">,</span>&nbsp;<span class="ident" id="1606499"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606503">,</span>&nbsp;<span class="ident" id="1606505"><a href="/strconv/ftoa.go.html#1606416">prec</a></span><span class="op" id="1606509">,</span>&nbsp;<span class="ident" id="1606511"><a href="/strconv/ftoa.go.html#1606426">fmt</a></span><span class="op" id="1606514">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606517">case</span>&nbsp;<span class="string" id="1606522">&#39;f&#39;</span><span class="op" id="1606525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606529">return</span>&nbsp;<span class="ident" id="1606536"><a href="/strconv/ftoa.go.html#1611640">fmtF</a></span><span class="op" id="1606540">(</span><span class="ident" id="1606541"><a href="/strconv/ftoa.go.html#1606360">dst</a></span><span class="op" id="1606544">,</span>&nbsp;<span class="ident" id="1606546"><a href="/strconv/ftoa.go.html#1606387">neg</a></span><span class="op" id="1606549">,</span>&nbsp;<span class="ident" id="1606551"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606555">,</span>&nbsp;<span class="ident" id="1606557"><a href="/strconv/ftoa.go.html#1606416">prec</a></span><span class="op" id="1606561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606564">case</span>&nbsp;<span class="string" id="1606569">&#39;g&#39;</span><span class="op" id="1606572">,</span>&nbsp;<span class="string" id="1606574">&#39;G&#39;</span><span class="op" id="1606577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606581">//&nbsp;trailing&nbsp;fractional&nbsp;zeros&nbsp;in&nbsp;&#39;e&#39;&nbsp;form&nbsp;will&nbsp;be&nbsp;trimmed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606641">eprec</span>&nbsp;<span class="op" id="1606647">:=</span>&nbsp;<span class="ident" id="1606650"><a href="/strconv/ftoa.go.html#1606416">prec</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606657">if</span>&nbsp;<span class="ident" id="1606660"><a href="/strconv/ftoa.go.html#1606641">eprec</a></span>&nbsp;<span class="op" id="1606666">&gt;</span>&nbsp;<span class="ident" id="1606668"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606672">.</span><span class="ident" id="1606673">nd</span>&nbsp;<span class="op" id="1606676">&amp;&amp;</span>&nbsp;<span class="ident" id="1606679"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606683">.</span><span class="ident" id="1606684">nd</span>&nbsp;<span class="op" id="1606687">&gt;=</span>&nbsp;<span class="ident" id="1606690"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606694">.</span><span class="ident" id="1606695">dp</span>&nbsp;<span class="op" id="1606698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606703"><a href="/strconv/ftoa.go.html#1606641">eprec</a></span>&nbsp;<span class="op" id="1606709">=</span>&nbsp;<span class="ident" id="1606711"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606715">.</span><span class="ident" id="1606716">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606725">//&nbsp;%e&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;exponent&nbsp;from&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606777">//&nbsp;is&nbsp;less&nbsp;than&nbsp;-4&nbsp;or&nbsp;greater&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;the&nbsp;precision.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1606841">//&nbsp;if&nbsp;precision&nbsp;was&nbsp;the&nbsp;shortest&nbsp;possible,&nbsp;use&nbsp;precision&nbsp;6&nbsp;for&nbsp;this&nbsp;decision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606921">if</span>&nbsp;<span class="ident" id="1606924"><a href="/strconv/ftoa.go.html#1606372">shortest</a></span>&nbsp;<span class="op" id="1606933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606938"><a href="/strconv/ftoa.go.html#1606641">eprec</a></span>&nbsp;<span class="op" id="1606944">=</span>&nbsp;<span class="num" id="1606946">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1606950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1606954">exp</span>&nbsp;<span class="op" id="1606958">:=</span>&nbsp;<span class="ident" id="1606961"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1606965">.</span><span class="ident" id="1606966">dp</span>&nbsp;<span class="op" id="1606969">-</span>&nbsp;<span class="num" id="1606971">1</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1606975">if</span>&nbsp;<span class="ident" id="1606978"><a href="/strconv/ftoa.go.html#1606954">exp</a></span>&nbsp;<span class="op" id="1606982">&lt;</span>&nbsp;<span class="op" id="1606984">-</span><span class="num" id="1606985">4</span>&nbsp;<span class="op" id="1606987">||</span>&nbsp;<span class="ident" id="1606990"><a href="/strconv/ftoa.go.html#1606954">exp</a></span>&nbsp;<span class="op" id="1606994">&gt;=</span>&nbsp;<span class="ident" id="1606997"><a href="/strconv/ftoa.go.html#1606641">eprec</a></span>&nbsp;<span class="op" id="1607003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607008">if</span>&nbsp;<span class="ident" id="1607011"><a href="/strconv/ftoa.go.html#1606416">prec</a></span>&nbsp;<span class="op" id="1607016">&gt;</span>&nbsp;<span class="ident" id="1607018"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607022">.</span><span class="ident" id="1607023">nd</span>&nbsp;<span class="op" id="1607026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607032"><a href="/strconv/ftoa.go.html#1606416">prec</a></span>&nbsp;<span class="op" id="1607037">=</span>&nbsp;<span class="ident" id="1607039"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607043">.</span><span class="ident" id="1607044">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607055">return</span>&nbsp;<span class="ident" id="1607062"><a href="/strconv/ftoa.go.html#1610640">fmtE</a></span><span class="op" id="1607066">(</span><span class="ident" id="1607067"><a href="/strconv/ftoa.go.html#1606360">dst</a></span><span class="op" id="1607070">,</span>&nbsp;<span class="ident" id="1607072"><a href="/strconv/ftoa.go.html#1606387">neg</a></span><span class="op" id="1607075">,</span>&nbsp;<span class="ident" id="1607077"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607081">,</span>&nbsp;<span class="ident" id="1607083"><a href="/strconv/ftoa.go.html#1606416">prec</a></span><span class="op" id="1607087">-</span><span class="num" id="1607088">1</span><span class="op" id="1607089">,</span>&nbsp;<span class="ident" id="1607091"><a href="/strconv/ftoa.go.html#1606426">fmt</a></span><span class="op" id="1607094">+</span><span class="string" id="1607095">&#39;e&#39;</span><span class="op" id="1607098">-</span><span class="string" id="1607099">&#39;g&#39;</span><span class="op" id="1607102">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607110">if</span>&nbsp;<span class="ident" id="1607113"><a href="/strconv/ftoa.go.html#1606416">prec</a></span>&nbsp;<span class="op" id="1607118">&gt;</span>&nbsp;<span class="ident" id="1607120"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607124">.</span><span class="ident" id="1607125">dp</span>&nbsp;<span class="op" id="1607128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607133"><a href="/strconv/ftoa.go.html#1606416">prec</a></span>&nbsp;<span class="op" id="1607138">=</span>&nbsp;<span class="ident" id="1607140"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607144">.</span><span class="ident" id="1607145">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607154">return</span>&nbsp;<span class="ident" id="1607161"><a href="/strconv/ftoa.go.html#1611640">fmtF</a></span><span class="op" id="1607165">(</span><span class="ident" id="1607166"><a href="/strconv/ftoa.go.html#1606360">dst</a></span><span class="op" id="1607169">,</span>&nbsp;<span class="ident" id="1607171"><a href="/strconv/ftoa.go.html#1606387">neg</a></span><span class="op" id="1607174">,</span>&nbsp;<span class="ident" id="1607176"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607180">,</span>&nbsp;<span class="ident" id="1607182"><a href="/strconv/ftoa.go.html#1612717">max</a></span><span class="op" id="1607185">(</span><span class="ident" id="1607186"><a href="/strconv/ftoa.go.html#1606416">prec</a></span><span class="op" id="1607190">-</span><span class="ident" id="1607191"><a href="/strconv/ftoa.go.html#1606397">digs</a></span><span class="op" id="1607195">.</span><span class="ident" id="1607196">dp</span><span class="op" id="1607198">,</span>&nbsp;<span class="num" id="1607200">0</span><span class="op" id="1607201">)</span><span class="op" id="1607202">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607209">//&nbsp;unknown&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607228">return</span>&nbsp;<span class="builtinfunc" id="1607235">append</span><span class="op" id="1607241">(</span><span class="ident" id="1607242"><a href="/strconv/ftoa.go.html#1606360">dst</a></span><span class="op" id="1607245">,</span>&nbsp;<span class="string" id="1607247">&#39;%&#39;</span><span class="op" id="1607250">,</span>&nbsp;<span class="ident" id="1607252"><a href="/strconv/ftoa.go.html#1606426">fmt</a></span><span class="op" id="1607255">)</span><br>
<span class="lineno"></span><span class="op" id="1607257">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1607260">//&nbsp;Round&nbsp;d&nbsp;(=&nbsp;mant&nbsp;*&nbsp;2^exp)&nbsp;to&nbsp;the&nbsp;shortest&nbsp;number&nbsp;of&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1607321">//&nbsp;that&nbsp;will&nbsp;let&nbsp;the&nbsp;original&nbsp;floating&nbsp;point&nbsp;value&nbsp;be&nbsp;precisely</span><br>
<span class="lineno"></span><span class="comment" id="1607385">//&nbsp;reconstructed.&nbsp;&nbsp;Size&nbsp;is&nbsp;original&nbsp;floating&nbsp;point&nbsp;size&nbsp;(64&nbsp;or&nbsp;32).</span><br>
<span class="lineno"></span><span class="keyword" id="1607453">func</span>&nbsp;<span class="ident" id="1607458">roundShortest</span><span class="op" id="1607471">(</span><span class="ident" id="1607472">d</span>&nbsp;<span class="op" id="1607474">*</span><span class="ident" id="1607475"><a href="/strconv/decimal.go.html#1573600">decimal</a></span><span class="op" id="1607482">,</span>&nbsp;<span class="ident" id="1607484">mant</span>&nbsp;<span class="ident" id="1607489">uint64</span><span class="op" id="1607495">,</span>&nbsp;<span class="ident" id="1607497">exp</span>&nbsp;<span class="builtintype" id="1607501">int</span><span class="op" id="1607504">,</span>&nbsp;<span class="ident" id="1607506">flt</span>&nbsp;<span class="op" id="1607510">*</span><span class="ident" id="1607511"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><span class="op" id="1607520">)</span>&nbsp;<span class="op" id="1607522">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607525">//&nbsp;If&nbsp;mantissa&nbsp;is&nbsp;zero,&nbsp;the&nbsp;number&nbsp;is&nbsp;zero;&nbsp;stop&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607580">if</span>&nbsp;<span class="ident" id="1607583"><a href="/strconv/ftoa.go.html#1607484">mant</a></span>&nbsp;<span class="op" id="1607588">==</span>&nbsp;<span class="num" id="1607591">0</span>&nbsp;<span class="op" id="1607593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1607597"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1607598">.</span><span class="ident" id="1607599">nd</span>&nbsp;<span class="op" id="1607602">=</span>&nbsp;<span class="num" id="1607604">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1607608">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1607616">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607620">//&nbsp;Compute&nbsp;upper&nbsp;and&nbsp;lower&nbsp;such&nbsp;that&nbsp;any&nbsp;decimal&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607677">//&nbsp;between&nbsp;upper&nbsp;and&nbsp;lower&nbsp;(possibly&nbsp;inclusive)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607726">//&nbsp;will&nbsp;round&nbsp;to&nbsp;the&nbsp;original&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607781">//&nbsp;We&nbsp;may&nbsp;see&nbsp;at&nbsp;once&nbsp;that&nbsp;the&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607841">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607845">//&nbsp;Suppose&nbsp;d&nbsp;is&nbsp;not&nbsp;denormal,&nbsp;so&nbsp;that&nbsp;2^exp&nbsp;&lt;=&nbsp;d&nbsp;&lt;&nbsp;10^dp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607904">//&nbsp;The&nbsp;closest&nbsp;shorter&nbsp;number&nbsp;is&nbsp;at&nbsp;least&nbsp;10^(dp-nd)&nbsp;away.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1607964">//&nbsp;The&nbsp;lower/upper&nbsp;bounds&nbsp;computed&nbsp;below&nbsp;are&nbsp;at&nbsp;distance</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608022">//&nbsp;at&nbsp;most&nbsp;2^(exp-mantbits).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608052">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608056">//&nbsp;So&nbsp;the&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest&nbsp;if&nbsp;10^(dp-nd)&nbsp;&gt;&nbsp;2^(exp-mantbits),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608128">//&nbsp;or&nbsp;equivalently&nbsp;log2(10)*(dp-nd)&nbsp;&gt;&nbsp;exp-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608181">//&nbsp;It&nbsp;is&nbsp;true&nbsp;if&nbsp;332/100*(dp-nd)&nbsp;&gt;=&nbsp;exp-mantbits&nbsp;(log2(10)&nbsp;&gt;&nbsp;3.32).</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608250">minexp</span>&nbsp;<span class="op" id="1608257">:=</span>&nbsp;<span class="ident" id="1608260"><a href="/strconv/ftoa.go.html#1607506">flt</a></span><span class="op" id="1608263">.</span><span class="ident" id="1608264">bias</span>&nbsp;<span class="op" id="1608269">+</span>&nbsp;<span class="num" id="1608271">1</span>&nbsp;<span class="comment" id="1608273">//&nbsp;minimum&nbsp;possible&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1608303">if</span>&nbsp;<span class="ident" id="1608306"><a href="/strconv/ftoa.go.html#1607497">exp</a></span>&nbsp;<span class="op" id="1608310">&gt;</span>&nbsp;<span class="ident" id="1608312"><a href="/strconv/ftoa.go.html#1608250">minexp</a></span>&nbsp;<span class="op" id="1608319">&amp;&amp;</span>&nbsp;<span class="num" id="1608322">332</span><span class="op" id="1608325">*</span><span class="op" id="1608326">(</span><span class="ident" id="1608327"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1608328">.</span><span class="ident" id="1608329">dp</span><span class="op" id="1608331">-</span><span class="ident" id="1608332"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1608333">.</span><span class="ident" id="1608334">nd</span><span class="op" id="1608336">)</span>&nbsp;<span class="op" id="1608338">&gt;=</span>&nbsp;<span class="num" id="1608341">100</span><span class="op" id="1608344">*</span><span class="op" id="1608345">(</span><span class="ident" id="1608346"><a href="/strconv/ftoa.go.html#1607497">exp</a></span><span class="op" id="1608349">-</span><span class="builtintype" id="1608350">int</span><span class="op" id="1608353">(</span><span class="ident" id="1608354"><a href="/strconv/ftoa.go.html#1607506">flt</a></span><span class="op" id="1608357">.</span><span class="ident" id="1608358">mantbits</span><span class="op" id="1608366">)</span><span class="op" id="1608367">)</span>&nbsp;<span class="op" id="1608369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608373">//&nbsp;The&nbsp;number&nbsp;is&nbsp;already&nbsp;shortest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1608410">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1608418">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608422">//&nbsp;d&nbsp;=&nbsp;mant&nbsp;&lt;&lt;&nbsp;(exp&nbsp;-&nbsp;mantbits)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608455">//&nbsp;Next&nbsp;highest&nbsp;floating&nbsp;point&nbsp;number&nbsp;is&nbsp;mant+1&nbsp;&lt;&lt;&nbsp;exp-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608521">//&nbsp;Our&nbsp;upper&nbsp;bound&nbsp;is&nbsp;halfway&nbsp;between,&nbsp;mant*2+1&nbsp;&lt;&lt;&nbsp;exp-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608589">upper</span>&nbsp;<span class="op" id="1608595">:=</span>&nbsp;<span class="builtinfunc" id="1608598">new</span><span class="op" id="1608601">(</span><span class="ident" id="1608602"><a href="/strconv/decimal.go.html#1573600">decimal</a></span><span class="op" id="1608609">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608612"><a href="/strconv/ftoa.go.html#1608589">upper</a></span><span class="op" id="1608617">.</span><span class="ident" id="1608618">Assign</span><span class="op" id="1608624">(</span><span class="ident" id="1608625"><a href="/strconv/ftoa.go.html#1607484">mant</a></span><span class="op" id="1608629">*</span><span class="num" id="1608630">2</span>&nbsp;<span class="op" id="1608632">+</span>&nbsp;<span class="num" id="1608634">1</span><span class="op" id="1608635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1608638"><a href="/strconv/ftoa.go.html#1608589">upper</a></span><span class="op" id="1608643">.</span><span class="ident" id="1608644">Shift</span><span class="op" id="1608649">(</span><span class="ident" id="1608650"><a href="/strconv/ftoa.go.html#1607497">exp</a></span>&nbsp;<span class="op" id="1608654">-</span>&nbsp;<span class="builtintype" id="1608656">int</span><span class="op" id="1608659">(</span><span class="ident" id="1608660"><a href="/strconv/ftoa.go.html#1607506">flt</a></span><span class="op" id="1608663">.</span><span class="ident" id="1608664">mantbits</span><span class="op" id="1608672">)</span>&nbsp;<span class="op" id="1608674">-</span>&nbsp;<span class="num" id="1608676">1</span><span class="op" id="1608677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608681">//&nbsp;d&nbsp;=&nbsp;mant&nbsp;&lt;&lt;&nbsp;(exp&nbsp;-&nbsp;mantbits)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608714">//&nbsp;Next&nbsp;lowest&nbsp;floating&nbsp;point&nbsp;number&nbsp;is&nbsp;mant-1&nbsp;&lt;&lt;&nbsp;exp-mantbits,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608779">//&nbsp;unless&nbsp;mant-1&nbsp;drops&nbsp;the&nbsp;significant&nbsp;bit&nbsp;and&nbsp;exp&nbsp;is&nbsp;not&nbsp;the&nbsp;minimum&nbsp;exp,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608855">//&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;next&nbsp;lowest&nbsp;is&nbsp;mant*2-1&nbsp;&lt;&lt;&nbsp;exp-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608920">//&nbsp;Either&nbsp;way,&nbsp;call&nbsp;it&nbsp;mantlo&nbsp;&lt;&lt;&nbsp;explo-mantbits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1608970">//&nbsp;Our&nbsp;lower&nbsp;bound&nbsp;is&nbsp;halfway&nbsp;between,&nbsp;mantlo*2+1&nbsp;&lt;&lt;&nbsp;explo-mantbits-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609042">var</span>&nbsp;<span class="ident" id="1609046">mantlo</span>&nbsp;<span class="ident" id="1609053">uint64</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609061">var</span>&nbsp;<span class="ident" id="1609065">explo</span>&nbsp;<span class="builtintype" id="1609071">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609076">if</span>&nbsp;<span class="ident" id="1609079"><a href="/strconv/ftoa.go.html#1607484">mant</a></span>&nbsp;<span class="op" id="1609084">&gt;</span>&nbsp;<span class="num" id="1609086">1</span><span class="op" id="1609087">&lt;&lt;</span><span class="ident" id="1609089"><a href="/strconv/ftoa.go.html#1607506">flt</a></span><span class="op" id="1609092">.</span><span class="ident" id="1609093">mantbits</span>&nbsp;<span class="op" id="1609102">||</span>&nbsp;<span class="ident" id="1609105"><a href="/strconv/ftoa.go.html#1607497">exp</a></span>&nbsp;<span class="op" id="1609109">==</span>&nbsp;<span class="ident" id="1609112"><a href="/strconv/ftoa.go.html#1608250">minexp</a></span>&nbsp;<span class="op" id="1609119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609123"><a href="/strconv/ftoa.go.html#1609046">mantlo</a></span>&nbsp;<span class="op" id="1609130">=</span>&nbsp;<span class="ident" id="1609132"><a href="/strconv/ftoa.go.html#1607484">mant</a></span>&nbsp;<span class="op" id="1609137">-</span>&nbsp;<span class="num" id="1609139">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609143"><a href="/strconv/ftoa.go.html#1609065">explo</a></span>&nbsp;<span class="op" id="1609149">=</span>&nbsp;<span class="ident" id="1609151"><a href="/strconv/ftoa.go.html#1607497">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609156">}</span>&nbsp;<span class="keyword" id="1609158">else</span>&nbsp;<span class="op" id="1609163">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609167"><a href="/strconv/ftoa.go.html#1609046">mantlo</a></span>&nbsp;<span class="op" id="1609174">=</span>&nbsp;<span class="ident" id="1609176"><a href="/strconv/ftoa.go.html#1607484">mant</a></span><span class="op" id="1609180">*</span><span class="num" id="1609181">2</span>&nbsp;<span class="op" id="1609183">-</span>&nbsp;<span class="num" id="1609185">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609189"><a href="/strconv/ftoa.go.html#1609065">explo</a></span>&nbsp;<span class="op" id="1609195">=</span>&nbsp;<span class="ident" id="1609197"><a href="/strconv/ftoa.go.html#1607497">exp</a></span>&nbsp;<span class="op" id="1609201">-</span>&nbsp;<span class="num" id="1609203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609209">lower</span>&nbsp;<span class="op" id="1609215">:=</span>&nbsp;<span class="builtinfunc" id="1609218">new</span><span class="op" id="1609221">(</span><span class="ident" id="1609222"><a href="/strconv/decimal.go.html#1573600">decimal</a></span><span class="op" id="1609229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609232"><a href="/strconv/ftoa.go.html#1609209">lower</a></span><span class="op" id="1609237">.</span><span class="ident" id="1609238">Assign</span><span class="op" id="1609244">(</span><span class="ident" id="1609245"><a href="/strconv/ftoa.go.html#1609046">mantlo</a></span><span class="op" id="1609251">*</span><span class="num" id="1609252">2</span>&nbsp;<span class="op" id="1609254">+</span>&nbsp;<span class="num" id="1609256">1</span><span class="op" id="1609257">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609260"><a href="/strconv/ftoa.go.html#1609209">lower</a></span><span class="op" id="1609265">.</span><span class="ident" id="1609266">Shift</span><span class="op" id="1609271">(</span><span class="ident" id="1609272"><a href="/strconv/ftoa.go.html#1609065">explo</a></span>&nbsp;<span class="op" id="1609278">-</span>&nbsp;<span class="builtintype" id="1609280">int</span><span class="op" id="1609283">(</span><span class="ident" id="1609284"><a href="/strconv/ftoa.go.html#1607506">flt</a></span><span class="op" id="1609287">.</span><span class="ident" id="1609288">mantbits</span><span class="op" id="1609296">)</span>&nbsp;<span class="op" id="1609298">-</span>&nbsp;<span class="num" id="1609300">1</span><span class="op" id="1609301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609305">//&nbsp;The&nbsp;upper&nbsp;and&nbsp;lower&nbsp;bounds&nbsp;are&nbsp;possible&nbsp;outputs&nbsp;only&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609365">//&nbsp;the&nbsp;original&nbsp;mantissa&nbsp;is&nbsp;even,&nbsp;so&nbsp;that&nbsp;IEEE&nbsp;round-to-even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609427">//&nbsp;would&nbsp;round&nbsp;to&nbsp;the&nbsp;original&nbsp;mantissa&nbsp;and&nbsp;not&nbsp;the&nbsp;neighbors.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609491">inclusive</span>&nbsp;<span class="op" id="1609501">:=</span>&nbsp;<span class="ident" id="1609504"><a href="/strconv/ftoa.go.html#1607484">mant</a></span><span class="op" id="1609508">%</span><span class="num" id="1609509">2</span>&nbsp;<span class="op" id="1609511">==</span>&nbsp;<span class="num" id="1609514">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609518">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;figure&nbsp;out&nbsp;the&nbsp;minimum&nbsp;number&nbsp;of&nbsp;digits&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609583">//&nbsp;Walk&nbsp;along&nbsp;until&nbsp;d&nbsp;has&nbsp;distinguished&nbsp;itself&nbsp;from&nbsp;upper&nbsp;and&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609653">for</span>&nbsp;<span class="ident" id="1609657">i</span>&nbsp;<span class="op" id="1609659">:=</span>&nbsp;<span class="num" id="1609662">0</span><span class="op" id="1609663">;</span>&nbsp;<span class="ident" id="1609665"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1609667">&lt;</span>&nbsp;<span class="ident" id="1609669"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1609670">.</span><span class="ident" id="1609671">nd</span><span class="op" id="1609673">;</span>&nbsp;<span class="ident" id="1609675"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1609676">++</span>&nbsp;<span class="op" id="1609679">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609683">var</span>&nbsp;<span class="ident" id="1609687">l</span><span class="op" id="1609688">,</span>&nbsp;<span class="ident" id="1609690">m</span><span class="op" id="1609691">,</span>&nbsp;<span class="ident" id="1609693">u</span>&nbsp;<span class="builtintype" id="1609695">byte</span>&nbsp;<span class="comment" id="1609700">//&nbsp;lower,&nbsp;middle,&nbsp;upper&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609733">if</span>&nbsp;<span class="ident" id="1609736"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1609738">&lt;</span>&nbsp;<span class="ident" id="1609740"><a href="/strconv/ftoa.go.html#1609209">lower</a></span><span class="op" id="1609745">.</span><span class="ident" id="1609746">nd</span>&nbsp;<span class="op" id="1609749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609754"><a href="/strconv/ftoa.go.html#1609687">l</a></span>&nbsp;<span class="op" id="1609756">=</span>&nbsp;<span class="ident" id="1609758"><a href="/strconv/ftoa.go.html#1609209">lower</a></span><span class="op" id="1609763">.</span><span class="ident" id="1609764">d</span><span class="op" id="1609765">[</span><span class="ident" id="1609766"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1609767">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609771">}</span>&nbsp;<span class="keyword" id="1609773">else</span>&nbsp;<span class="op" id="1609778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609783"><a href="/strconv/ftoa.go.html#1609687">l</a></span>&nbsp;<span class="op" id="1609785">=</span>&nbsp;<span class="string" id="1609787">&#39;0&#39;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609797"><a href="/strconv/ftoa.go.html#1609690">m</a></span>&nbsp;<span class="op" id="1609799">=</span>&nbsp;<span class="ident" id="1609801"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1609802">.</span><span class="ident" id="1609803">d</span><span class="op" id="1609804">[</span><span class="ident" id="1609805"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1609806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1609810">if</span>&nbsp;<span class="ident" id="1609813"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1609815">&lt;</span>&nbsp;<span class="ident" id="1609817"><a href="/strconv/ftoa.go.html#1608589">upper</a></span><span class="op" id="1609822">.</span><span class="ident" id="1609823">nd</span>&nbsp;<span class="op" id="1609826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609831"><a href="/strconv/ftoa.go.html#1609693">u</a></span>&nbsp;<span class="op" id="1609833">=</span>&nbsp;<span class="ident" id="1609835"><a href="/strconv/ftoa.go.html#1608589">upper</a></span><span class="op" id="1609840">.</span><span class="ident" id="1609841">d</span><span class="op" id="1609842">[</span><span class="ident" id="1609843"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1609844">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609848">}</span>&nbsp;<span class="keyword" id="1609850">else</span>&nbsp;<span class="op" id="1609855">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1609860"><a href="/strconv/ftoa.go.html#1609693">u</a></span>&nbsp;<span class="op" id="1609862">=</span>&nbsp;<span class="string" id="1609864">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1609870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609875">//&nbsp;Okay&nbsp;to&nbsp;round&nbsp;down&nbsp;(truncate)&nbsp;if&nbsp;lower&nbsp;has&nbsp;a&nbsp;different&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1609941">//&nbsp;or&nbsp;if&nbsp;lower&nbsp;is&nbsp;inclusive&nbsp;and&nbsp;is&nbsp;exactly&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;down.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610015">okdown</span>&nbsp;<span class="op" id="1610022">:=</span>&nbsp;<span class="ident" id="1610025"><a href="/strconv/ftoa.go.html#1609687">l</a></span>&nbsp;<span class="op" id="1610027">!=</span>&nbsp;<span class="ident" id="1610030"><a href="/strconv/ftoa.go.html#1609690">m</a></span>&nbsp;<span class="op" id="1610032">||</span>&nbsp;<span class="op" id="1610035">(</span><span class="ident" id="1610036"><a href="/strconv/ftoa.go.html#1609491">inclusive</a></span>&nbsp;<span class="op" id="1610046">&amp;&amp;</span>&nbsp;<span class="ident" id="1610049"><a href="/strconv/ftoa.go.html#1609687">l</a></span>&nbsp;<span class="op" id="1610051">==</span>&nbsp;<span class="ident" id="1610054"><a href="/strconv/ftoa.go.html#1609690">m</a></span>&nbsp;<span class="op" id="1610056">&amp;&amp;</span>&nbsp;<span class="ident" id="1610059"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1610060">+</span><span class="num" id="1610061">1</span>&nbsp;<span class="op" id="1610063">==</span>&nbsp;<span class="ident" id="1610066"><a href="/strconv/ftoa.go.html#1609209">lower</a></span><span class="op" id="1610071">.</span><span class="ident" id="1610072">nd</span><span class="op" id="1610074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610079">//&nbsp;Okay&nbsp;to&nbsp;round&nbsp;up&nbsp;if&nbsp;upper&nbsp;has&nbsp;a&nbsp;different&nbsp;digit&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610136">//&nbsp;either&nbsp;upper&nbsp;is&nbsp;inclusive&nbsp;or&nbsp;upper&nbsp;is&nbsp;bigger&nbsp;than&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610218">okup</span>&nbsp;<span class="op" id="1610223">:=</span>&nbsp;<span class="ident" id="1610226"><a href="/strconv/ftoa.go.html#1609690">m</a></span>&nbsp;<span class="op" id="1610228">!=</span>&nbsp;<span class="ident" id="1610231"><a href="/strconv/ftoa.go.html#1609693">u</a></span>&nbsp;<span class="op" id="1610233">&amp;&amp;</span>&nbsp;<span class="op" id="1610236">(</span><span class="ident" id="1610237"><a href="/strconv/ftoa.go.html#1609491">inclusive</a></span>&nbsp;<span class="op" id="1610247">||</span>&nbsp;<span class="ident" id="1610250"><a href="/strconv/ftoa.go.html#1609690">m</a></span><span class="op" id="1610251">+</span><span class="num" id="1610252">1</span>&nbsp;<span class="op" id="1610254">&lt;</span>&nbsp;<span class="ident" id="1610256"><a href="/strconv/ftoa.go.html#1609693">u</a></span>&nbsp;<span class="op" id="1610258">||</span>&nbsp;<span class="ident" id="1610261"><a href="/strconv/ftoa.go.html#1609657">i</a></span><span class="op" id="1610262">+</span><span class="num" id="1610263">1</span>&nbsp;<span class="op" id="1610265">&lt;</span>&nbsp;<span class="ident" id="1610267"><a href="/strconv/ftoa.go.html#1608589">upper</a></span><span class="op" id="1610272">.</span><span class="ident" id="1610273">nd</span><span class="op" id="1610275">)</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610280">//&nbsp;If&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;do&nbsp;either,&nbsp;then&nbsp;round&nbsp;to&nbsp;the&nbsp;nearest&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610343">//&nbsp;If&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;do&nbsp;only&nbsp;one,&nbsp;do&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610384">switch</span>&nbsp;<span class="op" id="1610391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610395">case</span>&nbsp;<span class="ident" id="1610400"><a href="/strconv/ftoa.go.html#1610015">okdown</a></span>&nbsp;<span class="op" id="1610407">&amp;&amp;</span>&nbsp;<span class="ident" id="1610410"><a href="/strconv/ftoa.go.html#1610218">okup</a></span><span class="op" id="1610414">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610419"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1610420">.</span><span class="ident" id="1610421">Round</span><span class="op" id="1610426">(</span><span class="ident" id="1610427"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1610429">+</span>&nbsp;<span class="num" id="1610431">1</span><span class="op" id="1610432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610437">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610446">case</span>&nbsp;<span class="ident" id="1610451"><a href="/strconv/ftoa.go.html#1610015">okdown</a></span><span class="op" id="1610457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610462"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1610463">.</span><span class="ident" id="1610464">RoundDown</span><span class="op" id="1610473">(</span><span class="ident" id="1610474"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1610476">+</span>&nbsp;<span class="num" id="1610478">1</span><span class="op" id="1610479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610484">return</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610493">case</span>&nbsp;<span class="ident" id="1610498"><a href="/strconv/ftoa.go.html#1610218">okup</a></span><span class="op" id="1610502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610507"><a href="/strconv/ftoa.go.html#1607472">d</a></span><span class="op" id="1610508">.</span><span class="ident" id="1610509">RoundUp</span><span class="op" id="1610516">(</span><span class="ident" id="1610517"><a href="/strconv/ftoa.go.html#1609657">i</a></span>&nbsp;<span class="op" id="1610519">+</span>&nbsp;<span class="num" id="1610521">1</span><span class="op" id="1610522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610539">}</span><br>
<span class="lineno">325</span><span class="op" id="1610541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1610544">type</span>&nbsp;<span class="ident" id="1610549">decimalSlice</span>&nbsp;<span class="keyword" id="1610562">struct</span>&nbsp;<span class="op" id="1610569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610572">d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1610579">[</span><span class="op" id="1610580">]</span><span class="builtintype" id="1610581">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610587">nd</span><span class="op" id="1610589">,</span>&nbsp;<span class="ident" id="1610591">dp</span>&nbsp;<span class="builtintype" id="1610594">int</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610599">neg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1610606">bool</span><br>
<span class="lineno"></span><span class="op" id="1610611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1610614">//&nbsp;%e:&nbsp;-d.ddddde±dd</span><br>
<span class="lineno"></span><span class="keyword" id="1610635">func</span>&nbsp;<span class="ident" id="1610640">fmtE</span><span class="op" id="1610644">(</span><span class="ident" id="1610645">dst</span>&nbsp;<span class="op" id="1610649">[</span><span class="op" id="1610650">]</span><span class="builtintype" id="1610651">byte</span><span class="op" id="1610655">,</span>&nbsp;<span class="ident" id="1610657">neg</span>&nbsp;<span class="builtintype" id="1610661">bool</span><span class="op" id="1610665">,</span>&nbsp;<span class="ident" id="1610667">d</span>&nbsp;<span class="ident" id="1610669"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><span class="op" id="1610681">,</span>&nbsp;<span class="ident" id="1610683">prec</span>&nbsp;<span class="builtintype" id="1610688">int</span><span class="op" id="1610691">,</span>&nbsp;<span class="ident" id="1610693">fmt</span>&nbsp;<span class="builtintype" id="1610697">byte</span><span class="op" id="1610701">)</span>&nbsp;<span class="op" id="1610703">[</span><span class="op" id="1610704">]</span><span class="builtintype" id="1610705">byte</span>&nbsp;<span class="op" id="1610710">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610713">//&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610722">if</span>&nbsp;<span class="ident" id="1610725"><a href="/strconv/ftoa.go.html#1610657">neg</a></span>&nbsp;<span class="op" id="1610729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610733"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1610737">=</span>&nbsp;<span class="builtinfunc" id="1610739">append</span><span class="op" id="1610745">(</span><span class="ident" id="1610746"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1610749">,</span>&nbsp;<span class="string" id="1610751">&#39;-&#39;</span><span class="op" id="1610754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610761">//&nbsp;first&nbsp;digit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610777">ch</span>&nbsp;<span class="op" id="1610780">:=</span>&nbsp;<span class="builtintype" id="1610783">byte</span><span class="op" id="1610787">(</span><span class="string" id="1610788">&#39;0&#39;</span><span class="op" id="1610791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610794">if</span>&nbsp;<span class="ident" id="1610797"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1610798">.</span><span class="ident" id="1610799">nd</span>&nbsp;<span class="op" id="1610802">!=</span>&nbsp;<span class="num" id="1610805">0</span>&nbsp;<span class="op" id="1610807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610811"><a href="/strconv/ftoa.go.html#1610777">ch</a></span>&nbsp;<span class="op" id="1610814">=</span>&nbsp;<span class="ident" id="1610816"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1610817">.</span><span class="ident" id="1610818">d</span><span class="op" id="1610819">[</span><span class="num" id="1610820">0</span><span class="op" id="1610821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610824">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610827"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1610831">=</span>&nbsp;<span class="builtinfunc" id="1610833">append</span><span class="op" id="1610839">(</span><span class="ident" id="1610840"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1610843">,</span>&nbsp;<span class="ident" id="1610845"><a href="/strconv/ftoa.go.html#1610777">ch</a></span><span class="op" id="1610847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1610851">//&nbsp;.moredigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610867">if</span>&nbsp;<span class="ident" id="1610870"><a href="/strconv/ftoa.go.html#1610683">prec</a></span>&nbsp;<span class="op" id="1610875">&gt;</span>&nbsp;<span class="num" id="1610877">0</span>&nbsp;<span class="op" id="1610879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610883"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1610887">=</span>&nbsp;<span class="builtinfunc" id="1610889">append</span><span class="op" id="1610895">(</span><span class="ident" id="1610896"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1610899">,</span>&nbsp;<span class="string" id="1610901">&#39;.&#39;</span><span class="op" id="1610904">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610908">i</span>&nbsp;<span class="op" id="1610910">:=</span>&nbsp;<span class="num" id="1610913">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610917">m</span>&nbsp;<span class="op" id="1610919">:=</span>&nbsp;<span class="ident" id="1610922"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1610923">.</span><span class="ident" id="1610924">nd</span>&nbsp;<span class="op" id="1610927">+</span>&nbsp;<span class="ident" id="1610929"><a href="/strconv/ftoa.go.html#1610683">prec</a></span>&nbsp;<span class="op" id="1610934">+</span>&nbsp;<span class="num" id="1610936">1</span>&nbsp;<span class="op" id="1610938">-</span>&nbsp;<span class="ident" id="1610940"><a href="/strconv/ftoa.go.html#1612717">max</a></span><span class="op" id="1610943">(</span><span class="ident" id="1610944"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1610945">.</span><span class="ident" id="1610946">nd</span><span class="op" id="1610948">,</span>&nbsp;<span class="ident" id="1610950"><a href="/strconv/ftoa.go.html#1610683">prec</a></span><span class="op" id="1610954">+</span><span class="num" id="1610955">1</span><span class="op" id="1610956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1610960">for</span>&nbsp;<span class="ident" id="1610964"><a href="/strconv/ftoa.go.html#1610908">i</a></span>&nbsp;<span class="op" id="1610966">&lt;</span>&nbsp;<span class="ident" id="1610968"><a href="/strconv/ftoa.go.html#1610917">m</a></span>&nbsp;<span class="op" id="1610970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1610975"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1610979">=</span>&nbsp;<span class="builtinfunc" id="1610981">append</span><span class="op" id="1610987">(</span><span class="ident" id="1610988"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1610991">,</span>&nbsp;<span class="ident" id="1610993"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1610994">.</span><span class="ident" id="1610995">d</span><span class="op" id="1610996">[</span><span class="ident" id="1610997"><a href="/strconv/ftoa.go.html#1610908">i</a></span><span class="op" id="1610998">]</span><span class="op" id="1610999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611004"><a href="/strconv/ftoa.go.html#1610908">i</a></span><span class="op" id="1611005">++</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611014">for</span>&nbsp;<span class="ident" id="1611018"><a href="/strconv/ftoa.go.html#1610908">i</a></span>&nbsp;<span class="op" id="1611020">&lt;=</span>&nbsp;<span class="ident" id="1611023"><a href="/strconv/ftoa.go.html#1610683">prec</a></span>&nbsp;<span class="op" id="1611028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611033"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611037">=</span>&nbsp;<span class="builtinfunc" id="1611039">append</span><span class="op" id="1611045">(</span><span class="ident" id="1611046"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611049">,</span>&nbsp;<span class="string" id="1611051">&#39;0&#39;</span><span class="op" id="1611054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611059"><a href="/strconv/ftoa.go.html#1610908">i</a></span><span class="op" id="1611060">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611065">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611072">//&nbsp;e±</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611080"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611084">=</span>&nbsp;<span class="builtinfunc" id="1611086">append</span><span class="op" id="1611092">(</span><span class="ident" id="1611093"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611096">,</span>&nbsp;<span class="ident" id="1611098"><a href="/strconv/ftoa.go.html#1610693">fmt</a></span><span class="op" id="1611101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611104">exp</span>&nbsp;<span class="op" id="1611108">:=</span>&nbsp;<span class="ident" id="1611111"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1611112">.</span><span class="ident" id="1611113">dp</span>&nbsp;<span class="op" id="1611116">-</span>&nbsp;<span class="num" id="1611118">1</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611121">if</span>&nbsp;<span class="ident" id="1611124"><a href="/strconv/ftoa.go.html#1610667">d</a></span><span class="op" id="1611125">.</span><span class="ident" id="1611126">nd</span>&nbsp;<span class="op" id="1611129">==</span>&nbsp;<span class="num" id="1611132">0</span>&nbsp;<span class="op" id="1611134">{</span>&nbsp;<span class="comment" id="1611136">//&nbsp;special&nbsp;case:&nbsp;0&nbsp;has&nbsp;exponent&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611172"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611176">=</span>&nbsp;<span class="num" id="1611178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611184">if</span>&nbsp;<span class="ident" id="1611187"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611191">&lt;</span>&nbsp;<span class="num" id="1611193">0</span>&nbsp;<span class="op" id="1611195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611199"><a href="/strconv/ftoa.go.html#1610777">ch</a></span>&nbsp;<span class="op" id="1611202">=</span>&nbsp;<span class="string" id="1611204">&#39;-&#39;</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611210"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611214">=</span>&nbsp;<span class="op" id="1611216">-</span><span class="ident" id="1611217"><a href="/strconv/ftoa.go.html#1611104">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611222">}</span>&nbsp;<span class="keyword" id="1611224">else</span>&nbsp;<span class="op" id="1611229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611233"><a href="/strconv/ftoa.go.html#1610777">ch</a></span>&nbsp;<span class="op" id="1611236">=</span>&nbsp;<span class="string" id="1611238">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611246"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611250">=</span>&nbsp;<span class="builtinfunc" id="1611252">append</span><span class="op" id="1611258">(</span><span class="ident" id="1611259"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611262">,</span>&nbsp;<span class="ident" id="1611264"><a href="/strconv/ftoa.go.html#1610777">ch</a></span><span class="op" id="1611266">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611270">//&nbsp;dddd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611279">var</span>&nbsp;<span class="ident" id="1611283">buf</span>&nbsp;<span class="op" id="1611287">[</span><span class="num" id="1611288">3</span><span class="op" id="1611289">]</span><span class="builtintype" id="1611290">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611296">i</span>&nbsp;<span class="op" id="1611298">:=</span>&nbsp;<span class="builtinfunc" id="1611301">len</span><span class="op" id="1611304">(</span><span class="ident" id="1611305"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611311">for</span>&nbsp;<span class="ident" id="1611315"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611319">&gt;=</span>&nbsp;<span class="num" id="1611322">10</span>&nbsp;<span class="op" id="1611325">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611329"><a href="/strconv/ftoa.go.html#1611296">i</a></span><span class="op" id="1611330">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611335"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611338">[</span><span class="ident" id="1611339"><a href="/strconv/ftoa.go.html#1611296">i</a></span><span class="op" id="1611340">]</span>&nbsp;<span class="op" id="1611342">=</span>&nbsp;<span class="builtintype" id="1611344">byte</span><span class="op" id="1611348">(</span><span class="ident" id="1611349"><a href="/strconv/ftoa.go.html#1611104">exp</a></span><span class="op" id="1611352">%</span><span class="num" id="1611353">10</span>&nbsp;<span class="op" id="1611356">+</span>&nbsp;<span class="string" id="1611358">&#39;0&#39;</span><span class="op" id="1611361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611365"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611369">/=</span>&nbsp;<span class="num" id="1611372">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611379">//&nbsp;exp&nbsp;&lt;&nbsp;10</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611392"><a href="/strconv/ftoa.go.html#1611296">i</a></span><span class="op" id="1611393">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611397"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611400">[</span><span class="ident" id="1611401"><a href="/strconv/ftoa.go.html#1611296">i</a></span><span class="op" id="1611402">]</span>&nbsp;<span class="op" id="1611404">=</span>&nbsp;<span class="builtintype" id="1611406">byte</span><span class="op" id="1611410">(</span><span class="ident" id="1611411"><a href="/strconv/ftoa.go.html#1611104">exp</a></span>&nbsp;<span class="op" id="1611415">+</span>&nbsp;<span class="string" id="1611417">&#39;0&#39;</span><span class="op" id="1611420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611424">switch</span>&nbsp;<span class="ident" id="1611431"><a href="/strconv/ftoa.go.html#1611296">i</a></span>&nbsp;<span class="op" id="1611433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611436">case</span>&nbsp;<span class="num" id="1611441">0</span><span class="op" id="1611442">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611446"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611450">=</span>&nbsp;<span class="builtinfunc" id="1611452">append</span><span class="op" id="1611458">(</span><span class="ident" id="1611459"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611462">,</span>&nbsp;<span class="ident" id="1611464"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611467">[</span><span class="num" id="1611468">0</span><span class="op" id="1611469">]</span><span class="op" id="1611470">,</span>&nbsp;<span class="ident" id="1611472"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611475">[</span><span class="num" id="1611476">1</span><span class="op" id="1611477">]</span><span class="op" id="1611478">,</span>&nbsp;<span class="ident" id="1611480"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611483">[</span><span class="num" id="1611484">2</span><span class="op" id="1611485">]</span><span class="op" id="1611486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611489">case</span>&nbsp;<span class="num" id="1611494">1</span><span class="op" id="1611495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611499"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611503">=</span>&nbsp;<span class="builtinfunc" id="1611505">append</span><span class="op" id="1611511">(</span><span class="ident" id="1611512"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611515">,</span>&nbsp;<span class="ident" id="1611517"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611520">[</span><span class="num" id="1611521">1</span><span class="op" id="1611522">]</span><span class="op" id="1611523">,</span>&nbsp;<span class="ident" id="1611525"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611528">[</span><span class="num" id="1611529">2</span><span class="op" id="1611530">]</span><span class="op" id="1611531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611534">case</span>&nbsp;<span class="num" id="1611539">2</span><span class="op" id="1611540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611544">//&nbsp;leading&nbsp;zeroes</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611564"><a href="/strconv/ftoa.go.html#1610645">dst</a></span>&nbsp;<span class="op" id="1611568">=</span>&nbsp;<span class="builtinfunc" id="1611570">append</span><span class="op" id="1611576">(</span><span class="ident" id="1611577"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><span class="op" id="1611580">,</span>&nbsp;<span class="string" id="1611582">&#39;0&#39;</span><span class="op" id="1611585">,</span>&nbsp;<span class="ident" id="1611587"><a href="/strconv/ftoa.go.html#1611283">buf</a></span><span class="op" id="1611590">[</span><span class="num" id="1611591">2</span><span class="op" id="1611592">]</span><span class="op" id="1611593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611599">return</span>&nbsp;<span class="ident" id="1611606"><a href="/strconv/ftoa.go.html#1610645">dst</a></span><br>
<span class="lineno"></span><span class="op" id="1611610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="1611613">//&nbsp;%f:&nbsp;-ddddddd.ddddd</span><br>
<span class="lineno"></span><span class="keyword" id="1611635">func</span>&nbsp;<span class="ident" id="1611640">fmtF</span><span class="op" id="1611644">(</span><span class="ident" id="1611645">dst</span>&nbsp;<span class="op" id="1611649">[</span><span class="op" id="1611650">]</span><span class="builtintype" id="1611651">byte</span><span class="op" id="1611655">,</span>&nbsp;<span class="ident" id="1611657">neg</span>&nbsp;<span class="builtintype" id="1611661">bool</span><span class="op" id="1611665">,</span>&nbsp;<span class="ident" id="1611667">d</span>&nbsp;<span class="ident" id="1611669"><a href="/strconv/ftoa.go.html#1610549">decimalSlice</a></span><span class="op" id="1611681">,</span>&nbsp;<span class="ident" id="1611683">prec</span>&nbsp;<span class="builtintype" id="1611688">int</span><span class="op" id="1611691">)</span>&nbsp;<span class="op" id="1611693">[</span><span class="op" id="1611694">]</span><span class="builtintype" id="1611695">byte</span>&nbsp;<span class="op" id="1611700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611703">//&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611712">if</span>&nbsp;<span class="ident" id="1611715"><a href="/strconv/ftoa.go.html#1611657">neg</a></span>&nbsp;<span class="op" id="1611719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611723"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1611727">=</span>&nbsp;<span class="builtinfunc" id="1611729">append</span><span class="op" id="1611735">(</span><span class="ident" id="1611736"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1611739">,</span>&nbsp;<span class="string" id="1611741">&#39;-&#39;</span><span class="op" id="1611744">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611751">//&nbsp;integer,&nbsp;padded&nbsp;with&nbsp;zeros&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611793">if</span>&nbsp;<span class="ident" id="1611796"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1611797">.</span><span class="ident" id="1611798">dp</span>&nbsp;<span class="op" id="1611801">&gt;</span>&nbsp;<span class="num" id="1611803">0</span>&nbsp;<span class="op" id="1611805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611809">var</span>&nbsp;<span class="ident" id="1611813">i</span>&nbsp;<span class="builtintype" id="1611815">int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611821">for</span>&nbsp;<span class="ident" id="1611825"><a href="/strconv/ftoa.go.html#1611813">i</a></span>&nbsp;<span class="op" id="1611827">=</span>&nbsp;<span class="num" id="1611829">0</span><span class="op" id="1611830">;</span>&nbsp;<span class="ident" id="1611832"><a href="/strconv/ftoa.go.html#1611813">i</a></span>&nbsp;<span class="op" id="1611834">&lt;</span>&nbsp;<span class="ident" id="1611836"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1611837">.</span><span class="ident" id="1611838">dp</span>&nbsp;<span class="op" id="1611841">&amp;&amp;</span>&nbsp;<span class="ident" id="1611844"><a href="/strconv/ftoa.go.html#1611813">i</a></span>&nbsp;<span class="op" id="1611846">&lt;</span>&nbsp;<span class="ident" id="1611848"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1611849">.</span><span class="ident" id="1611850">nd</span><span class="op" id="1611852">;</span>&nbsp;<span class="ident" id="1611854"><a href="/strconv/ftoa.go.html#1611813">i</a></span><span class="op" id="1611855">++</span>&nbsp;<span class="op" id="1611858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611863"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1611867">=</span>&nbsp;<span class="builtinfunc" id="1611869">append</span><span class="op" id="1611875">(</span><span class="ident" id="1611876"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1611879">,</span>&nbsp;<span class="ident" id="1611881"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1611882">.</span><span class="ident" id="1611883">d</span><span class="op" id="1611884">[</span><span class="ident" id="1611885"><a href="/strconv/ftoa.go.html#1611813">i</a></span><span class="op" id="1611886">]</span><span class="op" id="1611887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1611895">for</span>&nbsp;<span class="op" id="1611899">;</span>&nbsp;<span class="ident" id="1611901"><a href="/strconv/ftoa.go.html#1611813">i</a></span>&nbsp;<span class="op" id="1611903">&lt;</span>&nbsp;<span class="ident" id="1611905"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1611906">.</span><span class="ident" id="1611907">dp</span><span class="op" id="1611909">;</span>&nbsp;<span class="ident" id="1611911"><a href="/strconv/ftoa.go.html#1611813">i</a></span><span class="op" id="1611912">++</span>&nbsp;<span class="op" id="1611915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611920"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1611924">=</span>&nbsp;<span class="builtinfunc" id="1611926">append</span><span class="op" id="1611932">(</span><span class="ident" id="1611933"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1611936">,</span>&nbsp;<span class="string" id="1611938">&#39;0&#39;</span><span class="op" id="1611941">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611948">}</span>&nbsp;<span class="keyword" id="1611950">else</span>&nbsp;<span class="op" id="1611955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1611959"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1611963">=</span>&nbsp;<span class="builtinfunc" id="1611965">append</span><span class="op" id="1611971">(</span><span class="ident" id="1611972"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1611975">,</span>&nbsp;<span class="string" id="1611977">&#39;0&#39;</span><span class="op" id="1611980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1611987">//&nbsp;fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612000">if</span>&nbsp;<span class="ident" id="1612003"><a href="/strconv/ftoa.go.html#1611683">prec</a></span>&nbsp;<span class="op" id="1612008">&gt;</span>&nbsp;<span class="num" id="1612010">0</span>&nbsp;<span class="op" id="1612012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612016"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1612020">=</span>&nbsp;<span class="builtinfunc" id="1612022">append</span><span class="op" id="1612028">(</span><span class="ident" id="1612029"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1612032">,</span>&nbsp;<span class="string" id="1612034">&#39;.&#39;</span><span class="op" id="1612037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612041">for</span>&nbsp;<span class="ident" id="1612045">i</span>&nbsp;<span class="op" id="1612047">:=</span>&nbsp;<span class="num" id="1612050">0</span><span class="op" id="1612051">;</span>&nbsp;<span class="ident" id="1612053"><a href="/strconv/ftoa.go.html#1612045">i</a></span>&nbsp;<span class="op" id="1612055">&lt;</span>&nbsp;<span class="ident" id="1612057"><a href="/strconv/ftoa.go.html#1611683">prec</a></span><span class="op" id="1612061">;</span>&nbsp;<span class="ident" id="1612063"><a href="/strconv/ftoa.go.html#1612045">i</a></span><span class="op" id="1612064">++</span>&nbsp;<span class="op" id="1612067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612072">ch</span>&nbsp;<span class="op" id="1612075">:=</span>&nbsp;<span class="builtintype" id="1612078">byte</span><span class="op" id="1612082">(</span><span class="string" id="1612083">&#39;0&#39;</span><span class="op" id="1612086">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612091">if</span>&nbsp;<span class="ident" id="1612094">j</span>&nbsp;<span class="op" id="1612096">:=</span>&nbsp;<span class="ident" id="1612099"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1612100">.</span><span class="ident" id="1612101">dp</span>&nbsp;<span class="op" id="1612104">+</span>&nbsp;<span class="ident" id="1612106"><a href="/strconv/ftoa.go.html#1612045">i</a></span><span class="op" id="1612107">;</span>&nbsp;<span class="num" id="1612109">0</span>&nbsp;<span class="op" id="1612111">&lt;=</span>&nbsp;<span class="ident" id="1612114"><a href="/strconv/ftoa.go.html#1612094">j</a></span>&nbsp;<span class="op" id="1612116">&amp;&amp;</span>&nbsp;<span class="ident" id="1612119"><a href="/strconv/ftoa.go.html#1612094">j</a></span>&nbsp;<span class="op" id="1612121">&lt;</span>&nbsp;<span class="ident" id="1612123"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1612124">.</span><span class="ident" id="1612125">nd</span>&nbsp;<span class="op" id="1612128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612134"><a href="/strconv/ftoa.go.html#1612072">ch</a></span>&nbsp;<span class="op" id="1612137">=</span>&nbsp;<span class="ident" id="1612139"><a href="/strconv/ftoa.go.html#1611667">d</a></span><span class="op" id="1612140">.</span><span class="ident" id="1612141">d</span><span class="op" id="1612142">[</span><span class="ident" id="1612143"><a href="/strconv/ftoa.go.html#1612094">j</a></span><span class="op" id="1612144">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612154"><a href="/strconv/ftoa.go.html#1611645">dst</a></span>&nbsp;<span class="op" id="1612158">=</span>&nbsp;<span class="builtinfunc" id="1612160">append</span><span class="op" id="1612166">(</span><span class="ident" id="1612167"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><span class="op" id="1612170">,</span>&nbsp;<span class="ident" id="1612172"><a href="/strconv/ftoa.go.html#1612072">ch</a></span><span class="op" id="1612174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612178">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612185">return</span>&nbsp;<span class="ident" id="1612192"><a href="/strconv/ftoa.go.html#1611645">dst</a></span><br>
<span class="lineno"></span><span class="op" id="1612196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="comment" id="1612199">//&nbsp;%b:&nbsp;-ddddddddp+ddd</span><br>
<span class="lineno"></span><span class="keyword" id="1612221">func</span>&nbsp;<span class="ident" id="1612226">fmtB</span><span class="op" id="1612230">(</span><span class="ident" id="1612231">dst</span>&nbsp;<span class="op" id="1612235">[</span><span class="op" id="1612236">]</span><span class="builtintype" id="1612237">byte</span><span class="op" id="1612241">,</span>&nbsp;<span class="ident" id="1612243">neg</span>&nbsp;<span class="builtintype" id="1612247">bool</span><span class="op" id="1612251">,</span>&nbsp;<span class="ident" id="1612253">mant</span>&nbsp;<span class="ident" id="1612258">uint64</span><span class="op" id="1612264">,</span>&nbsp;<span class="ident" id="1612266">exp</span>&nbsp;<span class="builtintype" id="1612270">int</span><span class="op" id="1612273">,</span>&nbsp;<span class="ident" id="1612275">flt</span>&nbsp;<span class="op" id="1612279">*</span><span class="ident" id="1612280"><a href="/strconv/ftoa.go.html#1601816">floatInfo</a></span><span class="op" id="1612289">)</span>&nbsp;<span class="op" id="1612291">[</span><span class="op" id="1612292">]</span><span class="builtintype" id="1612293">byte</span>&nbsp;<span class="op" id="1612298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612301">var</span>&nbsp;<span class="ident" id="1612305">buf</span>&nbsp;<span class="op" id="1612309">[</span><span class="num" id="1612310">50</span><span class="op" id="1612312">]</span><span class="builtintype" id="1612313">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612319">w</span>&nbsp;<span class="op" id="1612321">:=</span>&nbsp;<span class="builtinfunc" id="1612324">len</span><span class="op" id="1612327">(</span><span class="ident" id="1612328"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612334"><a href="/strconv/ftoa.go.html#1612266">exp</a></span>&nbsp;<span class="op" id="1612338">-=</span>&nbsp;<span class="builtintype" id="1612341">int</span><span class="op" id="1612344">(</span><span class="ident" id="1612345"><a href="/strconv/ftoa.go.html#1612275">flt</a></span><span class="op" id="1612348">.</span><span class="ident" id="1612349">mantbits</span><span class="op" id="1612357">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612360">esign</span>&nbsp;<span class="op" id="1612366">:=</span>&nbsp;<span class="builtintype" id="1612369">byte</span><span class="op" id="1612373">(</span><span class="string" id="1612374">&#39;+&#39;</span><span class="op" id="1612377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612380">if</span>&nbsp;<span class="ident" id="1612383"><a href="/strconv/ftoa.go.html#1612266">exp</a></span>&nbsp;<span class="op" id="1612387">&lt;</span>&nbsp;<span class="num" id="1612389">0</span>&nbsp;<span class="op" id="1612391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612395"><a href="/strconv/ftoa.go.html#1612360">esign</a></span>&nbsp;<span class="op" id="1612401">=</span>&nbsp;<span class="string" id="1612403">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612409"><a href="/strconv/ftoa.go.html#1612266">exp</a></span>&nbsp;<span class="op" id="1612413">=</span>&nbsp;<span class="op" id="1612415">-</span><span class="ident" id="1612416"><a href="/strconv/ftoa.go.html#1612266">exp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612421">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612424">n</span>&nbsp;<span class="op" id="1612426">:=</span>&nbsp;<span class="num" id="1612429">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612432">for</span>&nbsp;<span class="ident" id="1612436"><a href="/strconv/ftoa.go.html#1612266">exp</a></span>&nbsp;<span class="op" id="1612440">&gt;</span>&nbsp;<span class="num" id="1612442">0</span>&nbsp;<span class="op" id="1612444">||</span>&nbsp;<span class="ident" id="1612447"><a href="/strconv/ftoa.go.html#1612424">n</a></span>&nbsp;<span class="op" id="1612449">&lt;</span>&nbsp;<span class="num" id="1612451">1</span>&nbsp;<span class="op" id="1612453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612457"><a href="/strconv/ftoa.go.html#1612424">n</a></span><span class="op" id="1612458">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612463"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612464">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612469"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612472">[</span><span class="ident" id="1612473"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612474">]</span>&nbsp;<span class="op" id="1612476">=</span>&nbsp;<span class="builtintype" id="1612478">byte</span><span class="op" id="1612482">(</span><span class="ident" id="1612483"><a href="/strconv/ftoa.go.html#1612266">exp</a></span><span class="op" id="1612486">%</span><span class="num" id="1612487">10</span>&nbsp;<span class="op" id="1612490">+</span>&nbsp;<span class="string" id="1612492">&#39;0&#39;</span><span class="op" id="1612495">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612499"><a href="/strconv/ftoa.go.html#1612266">exp</a></span>&nbsp;<span class="op" id="1612503">/=</span>&nbsp;<span class="num" id="1612506">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612513"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612514">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612518"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612521">[</span><span class="ident" id="1612522"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612523">]</span>&nbsp;<span class="op" id="1612525">=</span>&nbsp;<span class="ident" id="1612527"><a href="/strconv/ftoa.go.html#1612360">esign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612534"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612535">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612539"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612542">[</span><span class="ident" id="1612543"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612544">]</span>&nbsp;<span class="op" id="1612546">=</span>&nbsp;<span class="string" id="1612548">&#39;p&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612553"><a href="/strconv/ftoa.go.html#1612424">n</a></span>&nbsp;<span class="op" id="1612555">=</span>&nbsp;<span class="num" id="1612557">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612560">for</span>&nbsp;<span class="ident" id="1612564"><a href="/strconv/ftoa.go.html#1612253">mant</a></span>&nbsp;<span class="op" id="1612569">&gt;</span>&nbsp;<span class="num" id="1612571">0</span>&nbsp;<span class="op" id="1612573">||</span>&nbsp;<span class="ident" id="1612576"><a href="/strconv/ftoa.go.html#1612424">n</a></span>&nbsp;<span class="op" id="1612578">&lt;</span>&nbsp;<span class="num" id="1612580">1</span>&nbsp;<span class="op" id="1612582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612586"><a href="/strconv/ftoa.go.html#1612424">n</a></span><span class="op" id="1612587">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612592"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612593">--</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612598"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612601">[</span><span class="ident" id="1612602"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612603">]</span>&nbsp;<span class="op" id="1612605">=</span>&nbsp;<span class="builtintype" id="1612607">byte</span><span class="op" id="1612611">(</span><span class="ident" id="1612612"><a href="/strconv/ftoa.go.html#1612253">mant</a></span><span class="op" id="1612616">%</span><span class="num" id="1612617">10</span>&nbsp;<span class="op" id="1612620">+</span>&nbsp;<span class="string" id="1612622">&#39;0&#39;</span><span class="op" id="1612625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612629"><a href="/strconv/ftoa.go.html#1612253">mant</a></span>&nbsp;<span class="op" id="1612634">/=</span>&nbsp;<span class="num" id="1612637">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612644">if</span>&nbsp;<span class="ident" id="1612647"><a href="/strconv/ftoa.go.html#1612243">neg</a></span>&nbsp;<span class="op" id="1612651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612655"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612656">--</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612661"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612664">[</span><span class="ident" id="1612665"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612666">]</span>&nbsp;<span class="op" id="1612668">=</span>&nbsp;<span class="string" id="1612670">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612678">return</span>&nbsp;<span class="builtinfunc" id="1612685">append</span><span class="op" id="1612691">(</span><span class="ident" id="1612692"><a href="/strconv/ftoa.go.html#1612231">dst</a></span><span class="op" id="1612695">,</span>&nbsp;<span class="ident" id="1612697"><a href="/strconv/ftoa.go.html#1612305">buf</a></span><span class="op" id="1612700">[</span><span class="ident" id="1612701"><a href="/strconv/ftoa.go.html#1612319">w</a></span><span class="op" id="1612702">:</span><span class="op" id="1612703">]</span><span class="op" id="1612704">...</span><span class="op" id="1612707">)</span><br>
<span class="lineno"></span><span class="op" id="1612709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span><span class="keyword" id="1612712">func</span>&nbsp;<span class="ident" id="1612717">max</span><span class="op" id="1612720">(</span><span class="ident" id="1612721">a</span><span class="op" id="1612722">,</span>&nbsp;<span class="ident" id="1612724">b</span>&nbsp;<span class="builtintype" id="1612726">int</span><span class="op" id="1612729">)</span>&nbsp;<span class="builtintype" id="1612731">int</span>&nbsp;<span class="op" id="1612735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612738">if</span>&nbsp;<span class="ident" id="1612741"><a href="/strconv/ftoa.go.html#1612721">a</a></span>&nbsp;<span class="op" id="1612743">&gt;</span>&nbsp;<span class="ident" id="1612745"><a href="/strconv/ftoa.go.html#1612724">b</a></span>&nbsp;<span class="op" id="1612747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612751">return</span>&nbsp;<span class="ident" id="1612758"><a href="/strconv/ftoa.go.html#1612721">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612764">return</span>&nbsp;<span class="ident" id="1612771"><a href="/strconv/ftoa.go.html#1612724">b</a></span><br>
<span class="lineno">475</span><span class="op" id="1612773">}</span>
</div>
</body>
</html>
