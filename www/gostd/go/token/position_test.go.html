<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/token</h2>
<ul>
<li><a href="/gostd/go/token/position.go.html">position.go</a></li>
<li><a href="/gostd/go/token/position_test.go.html" class="current">position_test.go</a></li>
<li><a href="/gostd/go/token/serialize.go.html">serialize.go</a></li>
<li><a href="/gostd/go/token/serialize_test.go.html">serialize_test.go</a></li>
<li><a href="/gostd/go/token/token.go.html">token.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8434363">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8434418">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8434472">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8434523">package</span>&nbsp;<span class="ident" id="8434531">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8434538">import</span>&nbsp;<span class="op" id="8434545">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8434548">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8434555">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8434568">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8434576">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8434586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8434589">func</span>&nbsp;<span class="ident" id="8434594">checkPos</span><span class="op" id="8434602">(</span><span class="ident" id="8434603">t</span>&nbsp;<span class="op" id="8434605">*</span><span class="ident" id="8434606">testing</span><span class="op" id="8434613">.</span><span class="ident" id="8434614">T</span><span class="op" id="8434615">,</span>&nbsp;<span class="ident" id="8434617">msg</span>&nbsp;<span class="builtintype" id="8434621">string</span><span class="op" id="8434627">,</span>&nbsp;<span class="ident" id="8434629">got</span><span class="op" id="8434632">,</span>&nbsp;<span class="ident" id="8434634">want</span>&nbsp;<span class="ident" id="8434639">Position</span><span class="op" id="8434647">)</span>&nbsp;<span class="op" id="8434649">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8434652">if</span>&nbsp;<span class="ident" id="8434655">got</span><span class="op" id="8434658">.</span><span class="ident" id="8434659">Filename</span>&nbsp;<span class="op" id="8434668">!=</span>&nbsp;<span class="ident" id="8434671">want</span><span class="op" id="8434675">.</span><span class="ident" id="8434676">Filename</span>&nbsp;<span class="op" id="8434685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8434689">t</span><span class="op" id="8434690">.</span><span class="ident" id="8434691">Errorf</span><span class="op" id="8434697">(</span><span class="string" id="8434698">&#34;%s:&nbsp;got&nbsp;filename&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8434730">,</span>&nbsp;<span class="ident" id="8434732">msg</span><span class="op" id="8434735">,</span>&nbsp;<span class="ident" id="8434737">got</span><span class="op" id="8434740">.</span><span class="ident" id="8434741">Filename</span><span class="op" id="8434749">,</span>&nbsp;<span class="ident" id="8434751">want</span><span class="op" id="8434755">.</span><span class="ident" id="8434756">Filename</span><span class="op" id="8434764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8434767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8434770">if</span>&nbsp;<span class="ident" id="8434773">got</span><span class="op" id="8434776">.</span><span class="ident" id="8434777">Offset</span>&nbsp;<span class="op" id="8434784">!=</span>&nbsp;<span class="ident" id="8434787">want</span><span class="op" id="8434791">.</span><span class="ident" id="8434792">Offset</span>&nbsp;<span class="op" id="8434799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8434803">t</span><span class="op" id="8434804">.</span><span class="ident" id="8434805">Errorf</span><span class="op" id="8434811">(</span><span class="string" id="8434812">&#34;%s:&nbsp;got&nbsp;offset&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8434842">,</span>&nbsp;<span class="ident" id="8434844">msg</span><span class="op" id="8434847">,</span>&nbsp;<span class="ident" id="8434849">got</span><span class="op" id="8434852">.</span><span class="ident" id="8434853">Offset</span><span class="op" id="8434859">,</span>&nbsp;<span class="ident" id="8434861">want</span><span class="op" id="8434865">.</span><span class="ident" id="8434866">Offset</span><span class="op" id="8434872">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8434875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8434878">if</span>&nbsp;<span class="ident" id="8434881">got</span><span class="op" id="8434884">.</span><span class="ident" id="8434885">Line</span>&nbsp;<span class="op" id="8434890">!=</span>&nbsp;<span class="ident" id="8434893">want</span><span class="op" id="8434897">.</span><span class="ident" id="8434898">Line</span>&nbsp;<span class="op" id="8434903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8434907">t</span><span class="op" id="8434908">.</span><span class="ident" id="8434909">Errorf</span><span class="op" id="8434915">(</span><span class="string" id="8434916">&#34;%s:&nbsp;got&nbsp;line&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8434944">,</span>&nbsp;<span class="ident" id="8434946">msg</span><span class="op" id="8434949">,</span>&nbsp;<span class="ident" id="8434951">got</span><span class="op" id="8434954">.</span><span class="ident" id="8434955">Line</span><span class="op" id="8434959">,</span>&nbsp;<span class="ident" id="8434961">want</span><span class="op" id="8434965">.</span><span class="ident" id="8434966">Line</span><span class="op" id="8434970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8434973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8434976">if</span>&nbsp;<span class="ident" id="8434979">got</span><span class="op" id="8434982">.</span><span class="ident" id="8434983">Column</span>&nbsp;<span class="op" id="8434990">!=</span>&nbsp;<span class="ident" id="8434993">want</span><span class="op" id="8434997">.</span><span class="ident" id="8434998">Column</span>&nbsp;<span class="op" id="8435005">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435009">t</span><span class="op" id="8435010">.</span><span class="ident" id="8435011">Errorf</span><span class="op" id="8435017">(</span><span class="string" id="8435018">&#34;%s:&nbsp;got&nbsp;column&nbsp;=&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8435048">,</span>&nbsp;<span class="ident" id="8435050">msg</span><span class="op" id="8435053">,</span>&nbsp;<span class="ident" id="8435055">got</span><span class="op" id="8435058">.</span><span class="ident" id="8435059">Column</span><span class="op" id="8435065">,</span>&nbsp;<span class="ident" id="8435067">want</span><span class="op" id="8435071">.</span><span class="ident" id="8435072">Column</span><span class="op" id="8435078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435081">}</span><br>
<span class="lineno"></span><span class="op" id="8435083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8435086">func</span>&nbsp;<span class="ident" id="8435091">TestNoPos</span><span class="op" id="8435100">(</span><span class="ident" id="8435101">t</span>&nbsp;<span class="op" id="8435103">*</span><span class="ident" id="8435104">testing</span><span class="op" id="8435111">.</span><span class="ident" id="8435112">T</span><span class="op" id="8435113">)</span>&nbsp;<span class="op" id="8435115">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8435118">if</span>&nbsp;<span class="ident" id="8435121">NoPos</span><span class="op" id="8435126">.</span><span class="ident" id="8435127">IsValid</span><span class="op" id="8435134">(</span><span class="op" id="8435135">)</span>&nbsp;<span class="op" id="8435137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435141">t</span><span class="op" id="8435142">.</span><span class="ident" id="8435143">Errorf</span><span class="op" id="8435149">(</span><span class="string" id="8435150">&#34;NoPos&nbsp;should&nbsp;not&nbsp;be&nbsp;valid&#34;</span><span class="op" id="8435177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8435183">var</span>&nbsp;<span class="ident" id="8435187">fset</span>&nbsp;<span class="op" id="8435192">*</span><span class="ident" id="8435193">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435202">checkPos</span><span class="op" id="8435210">(</span><span class="ident" id="8435211">t</span><span class="op" id="8435212">,</span>&nbsp;<span class="string" id="8435214">&#34;nil&nbsp;NoPos&#34;</span><span class="op" id="8435225">,</span>&nbsp;<span class="ident" id="8435227">fset</span><span class="op" id="8435231">.</span><span class="ident" id="8435232">Position</span><span class="op" id="8435240">(</span><span class="ident" id="8435241">NoPos</span><span class="op" id="8435246">)</span><span class="op" id="8435247">,</span>&nbsp;<span class="ident" id="8435249">Position</span><span class="op" id="8435257">{</span><span class="op" id="8435258">}</span><span class="op" id="8435259">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435262">fset</span>&nbsp;<span class="op" id="8435267">=</span>&nbsp;<span class="ident" id="8435269">NewFileSet</span><span class="op" id="8435279">(</span><span class="op" id="8435280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435283">checkPos</span><span class="op" id="8435291">(</span><span class="ident" id="8435292">t</span><span class="op" id="8435293">,</span>&nbsp;<span class="string" id="8435295">&#34;fset&nbsp;NoPos&#34;</span><span class="op" id="8435307">,</span>&nbsp;<span class="ident" id="8435309">fset</span><span class="op" id="8435313">.</span><span class="ident" id="8435314">Position</span><span class="op" id="8435322">(</span><span class="ident" id="8435323">NoPos</span><span class="op" id="8435328">)</span><span class="op" id="8435329">,</span>&nbsp;<span class="ident" id="8435331">Position</span><span class="op" id="8435339">{</span><span class="op" id="8435340">}</span><span class="op" id="8435341">)</span><br>
<span class="lineno"></span><span class="op" id="8435343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8435346">var</span>&nbsp;<span class="ident" id="8435350">tests</span>&nbsp;<span class="op" id="8435356">=</span>&nbsp;<span class="op" id="8435358">[</span><span class="op" id="8435359">]</span><span class="keyword" id="8435360">struct</span>&nbsp;<span class="op" id="8435367">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435370">filename</span>&nbsp;<span class="builtintype" id="8435379">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435387">source</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8435396">[</span><span class="op" id="8435397">]</span><span class="builtintype" id="8435398">byte</span>&nbsp;<span class="comment" id="8435403">//&nbsp;may&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435418">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8435427">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8435432">lines</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435441">[</span><span class="op" id="8435442">]</span><span class="builtintype" id="8435443">int</span><br>
<span class="lineno"></span><span class="op" id="8435447">}</span><span class="op" id="8435448">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435451">{</span><span class="string" id="8435452">&#34;a&#34;</span><span class="op" id="8435455">,</span>&nbsp;<span class="op" id="8435457">[</span><span class="op" id="8435458">]</span><span class="builtintype" id="8435459">byte</span><span class="op" id="8435463">{</span><span class="op" id="8435464">}</span><span class="op" id="8435465">,</span>&nbsp;<span class="num" id="8435467">0</span><span class="op" id="8435468">,</span>&nbsp;<span class="op" id="8435470">[</span><span class="op" id="8435471">]</span><span class="builtintype" id="8435472">int</span><span class="op" id="8435475">{</span><span class="op" id="8435476">}</span><span class="op" id="8435477">}</span><span class="op" id="8435478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435481">{</span><span class="string" id="8435482">&#34;b&#34;</span><span class="op" id="8435485">,</span>&nbsp;<span class="op" id="8435487">[</span><span class="op" id="8435488">]</span><span class="builtintype" id="8435489">byte</span><span class="op" id="8435493">(</span><span class="string" id="8435494">&#34;01234&#34;</span><span class="op" id="8435501">)</span><span class="op" id="8435502">,</span>&nbsp;<span class="num" id="8435504">5</span><span class="op" id="8435505">,</span>&nbsp;<span class="op" id="8435507">[</span><span class="op" id="8435508">]</span><span class="builtintype" id="8435509">int</span><span class="op" id="8435512">{</span><span class="num" id="8435513">0</span><span class="op" id="8435514">}</span><span class="op" id="8435515">}</span><span class="op" id="8435516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435519">{</span><span class="string" id="8435520">&#34;c&#34;</span><span class="op" id="8435523">,</span>&nbsp;<span class="op" id="8435525">[</span><span class="op" id="8435526">]</span><span class="builtintype" id="8435527">byte</span><span class="op" id="8435531">(</span><span class="string" id="8435532">&#34;\n\n\n\n\n\n\n\n\n&#34;</span><span class="op" id="8435552">)</span><span class="op" id="8435553">,</span>&nbsp;<span class="num" id="8435555">9</span><span class="op" id="8435556">,</span>&nbsp;<span class="op" id="8435558">[</span><span class="op" id="8435559">]</span><span class="builtintype" id="8435560">int</span><span class="op" id="8435563">{</span><span class="num" id="8435564">0</span><span class="op" id="8435565">,</span>&nbsp;<span class="num" id="8435567">1</span><span class="op" id="8435568">,</span>&nbsp;<span class="num" id="8435570">2</span><span class="op" id="8435571">,</span>&nbsp;<span class="num" id="8435573">3</span><span class="op" id="8435574">,</span>&nbsp;<span class="num" id="8435576">4</span><span class="op" id="8435577">,</span>&nbsp;<span class="num" id="8435579">5</span><span class="op" id="8435580">,</span>&nbsp;<span class="num" id="8435582">6</span><span class="op" id="8435583">,</span>&nbsp;<span class="num" id="8435585">7</span><span class="op" id="8435586">,</span>&nbsp;<span class="num" id="8435588">8</span><span class="op" id="8435589">}</span><span class="op" id="8435590">}</span><span class="op" id="8435591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435594">{</span><span class="string" id="8435595">&#34;d&#34;</span><span class="op" id="8435598">,</span>&nbsp;<span class="builtintype" id="8435600">nil</span><span class="op" id="8435603">,</span>&nbsp;<span class="num" id="8435605">100</span><span class="op" id="8435608">,</span>&nbsp;<span class="op" id="8435610">[</span><span class="op" id="8435611">]</span><span class="builtintype" id="8435612">int</span><span class="op" id="8435615">{</span><span class="num" id="8435616">0</span><span class="op" id="8435617">,</span>&nbsp;<span class="num" id="8435619">5</span><span class="op" id="8435620">,</span>&nbsp;<span class="num" id="8435622">10</span><span class="op" id="8435624">,</span>&nbsp;<span class="num" id="8435626">20</span><span class="op" id="8435628">,</span>&nbsp;<span class="num" id="8435630">30</span><span class="op" id="8435632">,</span>&nbsp;<span class="num" id="8435634">70</span><span class="op" id="8435636">,</span>&nbsp;<span class="num" id="8435638">71</span><span class="op" id="8435640">,</span>&nbsp;<span class="num" id="8435642">72</span><span class="op" id="8435644">,</span>&nbsp;<span class="num" id="8435646">80</span><span class="op" id="8435648">,</span>&nbsp;<span class="num" id="8435650">85</span><span class="op" id="8435652">,</span>&nbsp;<span class="num" id="8435654">90</span><span class="op" id="8435656">,</span>&nbsp;<span class="num" id="8435658">99</span><span class="op" id="8435660">}</span><span class="op" id="8435661">}</span><span class="op" id="8435662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435665">{</span><span class="string" id="8435666">&#34;e&#34;</span><span class="op" id="8435669">,</span>&nbsp;<span class="builtintype" id="8435671">nil</span><span class="op" id="8435674">,</span>&nbsp;<span class="num" id="8435676">777</span><span class="op" id="8435679">,</span>&nbsp;<span class="op" id="8435681">[</span><span class="op" id="8435682">]</span><span class="builtintype" id="8435683">int</span><span class="op" id="8435686">{</span><span class="num" id="8435687">0</span><span class="op" id="8435688">,</span>&nbsp;<span class="num" id="8435690">80</span><span class="op" id="8435692">,</span>&nbsp;<span class="num" id="8435694">100</span><span class="op" id="8435697">,</span>&nbsp;<span class="num" id="8435699">120</span><span class="op" id="8435702">,</span>&nbsp;<span class="num" id="8435704">130</span><span class="op" id="8435707">,</span>&nbsp;<span class="num" id="8435709">180</span><span class="op" id="8435712">,</span>&nbsp;<span class="num" id="8435714">267</span><span class="op" id="8435717">,</span>&nbsp;<span class="num" id="8435719">455</span><span class="op" id="8435722">,</span>&nbsp;<span class="num" id="8435724">500</span><span class="op" id="8435727">,</span>&nbsp;<span class="num" id="8435729">567</span><span class="op" id="8435732">,</span>&nbsp;<span class="num" id="8435734">620</span><span class="op" id="8435737">}</span><span class="op" id="8435738">}</span><span class="op" id="8435739">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435742">{</span><span class="string" id="8435743">&#34;f&#34;</span><span class="op" id="8435746">,</span>&nbsp;<span class="op" id="8435748">[</span><span class="op" id="8435749">]</span><span class="builtintype" id="8435750">byte</span><span class="op" id="8435754">(</span><span class="string" id="8435755">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;&#34;</span><span class="op" id="8435784">)</span><span class="op" id="8435785">,</span>&nbsp;<span class="num" id="8435787">23</span><span class="op" id="8435789">,</span>&nbsp;<span class="op" id="8435791">[</span><span class="op" id="8435792">]</span><span class="builtintype" id="8435793">int</span><span class="op" id="8435796">{</span><span class="num" id="8435797">0</span><span class="op" id="8435798">,</span>&nbsp;<span class="num" id="8435800">10</span><span class="op" id="8435802">,</span>&nbsp;<span class="num" id="8435804">11</span><span class="op" id="8435806">}</span><span class="op" id="8435807">}</span><span class="op" id="8435808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435811">{</span><span class="string" id="8435812">&#34;g&#34;</span><span class="op" id="8435815">,</span>&nbsp;<span class="op" id="8435817">[</span><span class="op" id="8435818">]</span><span class="builtintype" id="8435819">byte</span><span class="op" id="8435823">(</span><span class="string" id="8435824">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&#34;</span><span class="op" id="8435855">)</span><span class="op" id="8435856">,</span>&nbsp;<span class="num" id="8435858">24</span><span class="op" id="8435860">,</span>&nbsp;<span class="op" id="8435862">[</span><span class="op" id="8435863">]</span><span class="builtintype" id="8435864">int</span><span class="op" id="8435867">{</span><span class="num" id="8435868">0</span><span class="op" id="8435869">,</span>&nbsp;<span class="num" id="8435871">10</span><span class="op" id="8435873">,</span>&nbsp;<span class="num" id="8435875">11</span><span class="op" id="8435877">}</span><span class="op" id="8435878">}</span><span class="op" id="8435879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8435882">{</span><span class="string" id="8435883">&#34;h&#34;</span><span class="op" id="8435886">,</span>&nbsp;<span class="op" id="8435888">[</span><span class="op" id="8435889">]</span><span class="builtintype" id="8435890">byte</span><span class="op" id="8435894">(</span><span class="string" id="8435895">&#34;package&nbsp;p\n\nimport&nbsp;\&#34;fmt\&#34;\n&nbsp;&#34;</span><span class="op" id="8435927">)</span><span class="op" id="8435928">,</span>&nbsp;<span class="num" id="8435930">25</span><span class="op" id="8435932">,</span>&nbsp;<span class="op" id="8435934">[</span><span class="op" id="8435935">]</span><span class="builtintype" id="8435936">int</span><span class="op" id="8435939">{</span><span class="num" id="8435940">0</span><span class="op" id="8435941">,</span>&nbsp;<span class="num" id="8435943">10</span><span class="op" id="8435945">,</span>&nbsp;<span class="num" id="8435947">11</span><span class="op" id="8435949">,</span>&nbsp;<span class="num" id="8435951">24</span><span class="op" id="8435953">}</span><span class="op" id="8435954">}</span><span class="op" id="8435955">,</span><br>
<span class="lineno"></span><span class="op" id="8435957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="8435960">func</span>&nbsp;<span class="ident" id="8435965">linecol</span><span class="op" id="8435972">(</span><span class="ident" id="8435973">lines</span>&nbsp;<span class="op" id="8435979">[</span><span class="op" id="8435980">]</span><span class="builtintype" id="8435981">int</span><span class="op" id="8435984">,</span>&nbsp;<span class="ident" id="8435986">offs</span>&nbsp;<span class="builtintype" id="8435991">int</span><span class="op" id="8435994">)</span>&nbsp;<span class="op" id="8435996">(</span><span class="builtintype" id="8435997">int</span><span class="op" id="8436000">,</span>&nbsp;<span class="builtintype" id="8436002">int</span><span class="op" id="8436005">)</span>&nbsp;<span class="op" id="8436007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436010">prevLineOffs</span>&nbsp;<span class="op" id="8436023">:=</span>&nbsp;<span class="num" id="8436026">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436029">for</span>&nbsp;<span class="ident" id="8436033">line</span><span class="op" id="8436037">,</span>&nbsp;<span class="ident" id="8436039">lineOffs</span>&nbsp;<span class="op" id="8436048">:=</span>&nbsp;<span class="keyword" id="8436051">range</span>&nbsp;<span class="ident" id="8436057">lines</span>&nbsp;<span class="op" id="8436063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436067">if</span>&nbsp;<span class="ident" id="8436070">offs</span>&nbsp;<span class="op" id="8436075">&lt;</span>&nbsp;<span class="ident" id="8436077">lineOffs</span>&nbsp;<span class="op" id="8436086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436091">return</span>&nbsp;<span class="ident" id="8436098">line</span><span class="op" id="8436102">,</span>&nbsp;<span class="ident" id="8436104">offs</span>&nbsp;<span class="op" id="8436109">-</span>&nbsp;<span class="ident" id="8436111">prevLineOffs</span>&nbsp;<span class="op" id="8436124">+</span>&nbsp;<span class="num" id="8436126">1</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436134">prevLineOffs</span>&nbsp;<span class="op" id="8436147">=</span>&nbsp;<span class="ident" id="8436149">lineOffs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436162">return</span>&nbsp;<span class="builtinfunc" id="8436169">len</span><span class="op" id="8436172">(</span><span class="ident" id="8436173">lines</span><span class="op" id="8436178">)</span><span class="op" id="8436179">,</span>&nbsp;<span class="ident" id="8436181">offs</span>&nbsp;<span class="op" id="8436186">-</span>&nbsp;<span class="ident" id="8436188">prevLineOffs</span>&nbsp;<span class="op" id="8436201">+</span>&nbsp;<span class="num" id="8436203">1</span><br>
<span class="lineno"></span><span class="op" id="8436205">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8436208">func</span>&nbsp;<span class="ident" id="8436213">verifyPositions</span><span class="op" id="8436228">(</span><span class="ident" id="8436229">t</span>&nbsp;<span class="op" id="8436231">*</span><span class="ident" id="8436232">testing</span><span class="op" id="8436239">.</span><span class="ident" id="8436240">T</span><span class="op" id="8436241">,</span>&nbsp;<span class="ident" id="8436243">fset</span>&nbsp;<span class="op" id="8436248">*</span><span class="ident" id="8436249">FileSet</span><span class="op" id="8436256">,</span>&nbsp;<span class="ident" id="8436258">f</span>&nbsp;<span class="op" id="8436260">*</span><span class="ident" id="8436261">File</span><span class="op" id="8436265">,</span>&nbsp;<span class="ident" id="8436267">lines</span>&nbsp;<span class="op" id="8436273">[</span><span class="op" id="8436274">]</span><span class="builtintype" id="8436275">int</span><span class="op" id="8436278">)</span>&nbsp;<span class="op" id="8436280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436283">for</span>&nbsp;<span class="ident" id="8436287">offs</span>&nbsp;<span class="op" id="8436292">:=</span>&nbsp;<span class="num" id="8436295">0</span><span class="op" id="8436296">;</span>&nbsp;<span class="ident" id="8436298">offs</span>&nbsp;<span class="op" id="8436303">&lt;</span>&nbsp;<span class="ident" id="8436305">f</span><span class="op" id="8436306">.</span><span class="ident" id="8436307">Size</span><span class="op" id="8436311">(</span><span class="op" id="8436312">)</span><span class="op" id="8436313">;</span>&nbsp;<span class="ident" id="8436315">offs</span><span class="op" id="8436319">++</span>&nbsp;<span class="op" id="8436322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436326">p</span>&nbsp;<span class="op" id="8436328">:=</span>&nbsp;<span class="ident" id="8436331">f</span><span class="op" id="8436332">.</span><span class="ident" id="8436333">Pos</span><span class="op" id="8436336">(</span><span class="ident" id="8436337">offs</span><span class="op" id="8436341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436345">offs2</span>&nbsp;<span class="op" id="8436351">:=</span>&nbsp;<span class="ident" id="8436354">f</span><span class="op" id="8436355">.</span><span class="ident" id="8436356">Offset</span><span class="op" id="8436362">(</span><span class="ident" id="8436363">p</span><span class="op" id="8436364">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436368">if</span>&nbsp;<span class="ident" id="8436371">offs2</span>&nbsp;<span class="op" id="8436377">!=</span>&nbsp;<span class="ident" id="8436380">offs</span>&nbsp;<span class="op" id="8436385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436390">t</span><span class="op" id="8436391">.</span><span class="ident" id="8436392">Errorf</span><span class="op" id="8436398">(</span><span class="string" id="8436399">&#34;%s,&nbsp;Offset:&nbsp;got&nbsp;offset&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8436435">,</span>&nbsp;<span class="ident" id="8436437">f</span><span class="op" id="8436438">.</span><span class="ident" id="8436439">Name</span><span class="op" id="8436443">(</span><span class="op" id="8436444">)</span><span class="op" id="8436445">,</span>&nbsp;<span class="ident" id="8436447">offs2</span><span class="op" id="8436452">,</span>&nbsp;<span class="ident" id="8436454">offs</span><span class="op" id="8436458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436466">line</span><span class="op" id="8436470">,</span>&nbsp;<span class="ident" id="8436472">col</span>&nbsp;<span class="op" id="8436476">:=</span>&nbsp;<span class="ident" id="8436479">linecol</span><span class="op" id="8436486">(</span><span class="ident" id="8436487">lines</span><span class="op" id="8436492">,</span>&nbsp;<span class="ident" id="8436494">offs</span><span class="op" id="8436498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436502">msg</span>&nbsp;<span class="op" id="8436506">:=</span>&nbsp;<span class="ident" id="8436509">fmt</span><span class="op" id="8436512">.</span><span class="ident" id="8436513">Sprintf</span><span class="op" id="8436520">(</span><span class="string" id="8436521">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="8436545">,</span>&nbsp;<span class="ident" id="8436547">f</span><span class="op" id="8436548">.</span><span class="ident" id="8436549">Name</span><span class="op" id="8436553">(</span><span class="op" id="8436554">)</span><span class="op" id="8436555">,</span>&nbsp;<span class="ident" id="8436557">offs</span><span class="op" id="8436561">,</span>&nbsp;<span class="ident" id="8436563">p</span><span class="op" id="8436564">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436568">checkPos</span><span class="op" id="8436576">(</span><span class="ident" id="8436577">t</span><span class="op" id="8436578">,</span>&nbsp;<span class="ident" id="8436580">msg</span><span class="op" id="8436583">,</span>&nbsp;<span class="ident" id="8436585">f</span><span class="op" id="8436586">.</span><span class="ident" id="8436587">Position</span><span class="op" id="8436595">(</span><span class="ident" id="8436596">f</span><span class="op" id="8436597">.</span><span class="ident" id="8436598">Pos</span><span class="op" id="8436601">(</span><span class="ident" id="8436602">offs</span><span class="op" id="8436606">)</span><span class="op" id="8436607">)</span><span class="op" id="8436608">,</span>&nbsp;<span class="ident" id="8436610">Position</span><span class="op" id="8436618">{</span><span class="ident" id="8436619">f</span><span class="op" id="8436620">.</span><span class="ident" id="8436621">Name</span><span class="op" id="8436625">(</span><span class="op" id="8436626">)</span><span class="op" id="8436627">,</span>&nbsp;<span class="ident" id="8436629">offs</span><span class="op" id="8436633">,</span>&nbsp;<span class="ident" id="8436635">line</span><span class="op" id="8436639">,</span>&nbsp;<span class="ident" id="8436641">col</span><span class="op" id="8436644">}</span><span class="op" id="8436645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436649">checkPos</span><span class="op" id="8436657">(</span><span class="ident" id="8436658">t</span><span class="op" id="8436659">,</span>&nbsp;<span class="ident" id="8436661">msg</span><span class="op" id="8436664">,</span>&nbsp;<span class="ident" id="8436666">fset</span><span class="op" id="8436670">.</span><span class="ident" id="8436671">Position</span><span class="op" id="8436679">(</span><span class="ident" id="8436680">p</span><span class="op" id="8436681">)</span><span class="op" id="8436682">,</span>&nbsp;<span class="ident" id="8436684">Position</span><span class="op" id="8436692">{</span><span class="ident" id="8436693">f</span><span class="op" id="8436694">.</span><span class="ident" id="8436695">Name</span><span class="op" id="8436699">(</span><span class="op" id="8436700">)</span><span class="op" id="8436701">,</span>&nbsp;<span class="ident" id="8436703">offs</span><span class="op" id="8436707">,</span>&nbsp;<span class="ident" id="8436709">line</span><span class="op" id="8436713">,</span>&nbsp;<span class="ident" id="8436715">col</span><span class="op" id="8436718">}</span><span class="op" id="8436719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436722">}</span><br>
<span class="lineno"></span><span class="op" id="8436724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8436727">func</span>&nbsp;<span class="ident" id="8436732">makeTestSource</span><span class="op" id="8436746">(</span><span class="ident" id="8436747">size</span>&nbsp;<span class="builtintype" id="8436752">int</span><span class="op" id="8436755">,</span>&nbsp;<span class="ident" id="8436757">lines</span>&nbsp;<span class="op" id="8436763">[</span><span class="op" id="8436764">]</span><span class="builtintype" id="8436765">int</span><span class="op" id="8436768">)</span>&nbsp;<span class="op" id="8436770">[</span><span class="op" id="8436771">]</span><span class="builtintype" id="8436772">byte</span>&nbsp;<span class="op" id="8436777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436780">src</span>&nbsp;<span class="op" id="8436784">:=</span>&nbsp;<span class="builtinfunc" id="8436787">make</span><span class="op" id="8436791">(</span><span class="op" id="8436792">[</span><span class="op" id="8436793">]</span><span class="builtintype" id="8436794">byte</span><span class="op" id="8436798">,</span>&nbsp;<span class="ident" id="8436800">size</span><span class="op" id="8436804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436807">for</span>&nbsp;<span class="ident" id="8436811">_</span><span class="op" id="8436812">,</span>&nbsp;<span class="ident" id="8436814">offs</span>&nbsp;<span class="op" id="8436819">:=</span>&nbsp;<span class="keyword" id="8436822">range</span>&nbsp;<span class="ident" id="8436828">lines</span>&nbsp;<span class="op" id="8436834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436838">if</span>&nbsp;<span class="ident" id="8436841">offs</span>&nbsp;<span class="op" id="8436846">&gt;</span>&nbsp;<span class="num" id="8436848">0</span>&nbsp;<span class="op" id="8436850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436855">src</span><span class="op" id="8436858">[</span><span class="ident" id="8436859">offs</span><span class="op" id="8436863">-</span><span class="num" id="8436864">1</span><span class="op" id="8436865">]</span>&nbsp;<span class="op" id="8436867">=</span>&nbsp;<span class="string" id="8436869">&#39;\n&#39;</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8436879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436882">return</span>&nbsp;<span class="ident" id="8436889">src</span><br>
<span class="lineno"></span><span class="op" id="8436893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8436896">func</span>&nbsp;<span class="ident" id="8436901">TestPositions</span><span class="op" id="8436914">(</span><span class="ident" id="8436915">t</span>&nbsp;<span class="op" id="8436917">*</span><span class="ident" id="8436918">testing</span><span class="op" id="8436925">.</span><span class="ident" id="8436926">T</span><span class="op" id="8436927">)</span>&nbsp;<span class="op" id="8436929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8436932">const</span>&nbsp;<span class="ident" id="8436938">delta</span>&nbsp;<span class="op" id="8436944">=</span>&nbsp;<span class="num" id="8436946">7</span>&nbsp;<span class="comment" id="8436948">//&nbsp;a&nbsp;non-zero&nbsp;base&nbsp;offset&nbsp;increment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8436985">fset</span>&nbsp;<span class="op" id="8436990">:=</span>&nbsp;<span class="ident" id="8436993">NewFileSet</span><span class="op" id="8437003">(</span><span class="op" id="8437004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437007">for</span>&nbsp;<span class="ident" id="8437011">_</span><span class="op" id="8437012">,</span>&nbsp;<span class="ident" id="8437014">test</span>&nbsp;<span class="op" id="8437019">:=</span>&nbsp;<span class="keyword" id="8437022">range</span>&nbsp;<span class="ident" id="8437028">tests</span>&nbsp;<span class="op" id="8437034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437038">//&nbsp;verify&nbsp;consistency&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437075">if</span>&nbsp;<span class="ident" id="8437078">test</span><span class="op" id="8437082">.</span><span class="ident" id="8437083">source</span>&nbsp;<span class="op" id="8437090">!=</span>&nbsp;<span class="builtintype" id="8437093">nil</span>&nbsp;<span class="op" id="8437097">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8437100">len</span><span class="op" id="8437103">(</span><span class="ident" id="8437104">test</span><span class="op" id="8437108">.</span><span class="ident" id="8437109">source</span><span class="op" id="8437115">)</span>&nbsp;<span class="op" id="8437117">!=</span>&nbsp;<span class="ident" id="8437120">test</span><span class="op" id="8437124">.</span><span class="ident" id="8437125">size</span>&nbsp;<span class="op" id="8437130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437135">t</span><span class="op" id="8437136">.</span><span class="ident" id="8437137">Errorf</span><span class="op" id="8437143">(</span><span class="string" id="8437144">&#34;%s:&nbsp;inconsistent&nbsp;test&nbsp;case:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8437199">,</span>&nbsp;<span class="ident" id="8437201">test</span><span class="op" id="8437205">.</span><span class="ident" id="8437206">filename</span><span class="op" id="8437214">,</span>&nbsp;<span class="builtinfunc" id="8437216">len</span><span class="op" id="8437219">(</span><span class="ident" id="8437220">test</span><span class="op" id="8437224">.</span><span class="ident" id="8437225">source</span><span class="op" id="8437231">)</span><span class="op" id="8437232">,</span>&nbsp;<span class="ident" id="8437234">test</span><span class="op" id="8437238">.</span><span class="ident" id="8437239">size</span><span class="op" id="8437243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8437247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437252">//&nbsp;add&nbsp;file&nbsp;and&nbsp;verify&nbsp;name&nbsp;and&nbsp;size</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437291">f</span>&nbsp;<span class="op" id="8437293">:=</span>&nbsp;<span class="ident" id="8437296">fset</span><span class="op" id="8437300">.</span><span class="ident" id="8437301">AddFile</span><span class="op" id="8437308">(</span><span class="ident" id="8437309">test</span><span class="op" id="8437313">.</span><span class="ident" id="8437314">filename</span><span class="op" id="8437322">,</span>&nbsp;<span class="ident" id="8437324">fset</span><span class="op" id="8437328">.</span><span class="ident" id="8437329">Base</span><span class="op" id="8437333">(</span><span class="op" id="8437334">)</span><span class="op" id="8437335">+</span><span class="ident" id="8437336">delta</span><span class="op" id="8437341">,</span>&nbsp;<span class="ident" id="8437343">test</span><span class="op" id="8437347">.</span><span class="ident" id="8437348">size</span><span class="op" id="8437352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437356">if</span>&nbsp;<span class="ident" id="8437359">f</span><span class="op" id="8437360">.</span><span class="ident" id="8437361">Name</span><span class="op" id="8437365">(</span><span class="op" id="8437366">)</span>&nbsp;<span class="op" id="8437368">!=</span>&nbsp;<span class="ident" id="8437371">test</span><span class="op" id="8437375">.</span><span class="ident" id="8437376">filename</span>&nbsp;<span class="op" id="8437385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437390">t</span><span class="op" id="8437391">.</span><span class="ident" id="8437392">Errorf</span><span class="op" id="8437398">(</span><span class="string" id="8437399">&#34;got&nbsp;filename&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8437425">,</span>&nbsp;<span class="ident" id="8437427">f</span><span class="op" id="8437428">.</span><span class="ident" id="8437429">Name</span><span class="op" id="8437433">(</span><span class="op" id="8437434">)</span><span class="op" id="8437435">,</span>&nbsp;<span class="ident" id="8437437">test</span><span class="op" id="8437441">.</span><span class="ident" id="8437442">filename</span><span class="op" id="8437450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8437454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437458">if</span>&nbsp;<span class="ident" id="8437461">f</span><span class="op" id="8437462">.</span><span class="ident" id="8437463">Size</span><span class="op" id="8437467">(</span><span class="op" id="8437468">)</span>&nbsp;<span class="op" id="8437470">!=</span>&nbsp;<span class="ident" id="8437473">test</span><span class="op" id="8437477">.</span><span class="ident" id="8437478">size</span>&nbsp;<span class="op" id="8437483">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437488">t</span><span class="op" id="8437489">.</span><span class="ident" id="8437490">Errorf</span><span class="op" id="8437496">(</span><span class="string" id="8437497">&#34;%s:&nbsp;got&nbsp;file&nbsp;size&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8437528">,</span>&nbsp;<span class="ident" id="8437530">f</span><span class="op" id="8437531">.</span><span class="ident" id="8437532">Name</span><span class="op" id="8437536">(</span><span class="op" id="8437537">)</span><span class="op" id="8437538">,</span>&nbsp;<span class="ident" id="8437540">f</span><span class="op" id="8437541">.</span><span class="ident" id="8437542">Size</span><span class="op" id="8437546">(</span><span class="op" id="8437547">)</span><span class="op" id="8437548">,</span>&nbsp;<span class="ident" id="8437550">test</span><span class="op" id="8437554">.</span><span class="ident" id="8437555">size</span><span class="op" id="8437559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8437563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437567">if</span>&nbsp;<span class="ident" id="8437570">fset</span><span class="op" id="8437574">.</span><span class="ident" id="8437575">File</span><span class="op" id="8437579">(</span><span class="ident" id="8437580">f</span><span class="op" id="8437581">.</span><span class="ident" id="8437582">Pos</span><span class="op" id="8437585">(</span><span class="num" id="8437586">0</span><span class="op" id="8437587">)</span><span class="op" id="8437588">)</span>&nbsp;<span class="op" id="8437590">!=</span>&nbsp;<span class="ident" id="8437593">f</span>&nbsp;<span class="op" id="8437595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437600">t</span><span class="op" id="8437601">.</span><span class="ident" id="8437602">Errorf</span><span class="op" id="8437608">(</span><span class="string" id="8437609">&#34;%s:&nbsp;f.Pos(0)&nbsp;was&nbsp;not&nbsp;found&nbsp;in&nbsp;f&#34;</span><span class="op" id="8437642">,</span>&nbsp;<span class="ident" id="8437644">f</span><span class="op" id="8437645">.</span><span class="ident" id="8437646">Name</span><span class="op" id="8437650">(</span><span class="op" id="8437651">)</span><span class="op" id="8437652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8437656">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437661">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437714">for</span>&nbsp;<span class="ident" id="8437718">i</span><span class="op" id="8437719">,</span>&nbsp;<span class="ident" id="8437721">offset</span>&nbsp;<span class="op" id="8437728">:=</span>&nbsp;<span class="keyword" id="8437731">range</span>&nbsp;<span class="ident" id="8437737">test</span><span class="op" id="8437741">.</span><span class="ident" id="8437742">lines</span>&nbsp;<span class="op" id="8437748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437753">f</span><span class="op" id="8437754">.</span><span class="ident" id="8437755">AddLine</span><span class="op" id="8437762">(</span><span class="ident" id="8437763">offset</span><span class="op" id="8437769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437774">if</span>&nbsp;<span class="ident" id="8437777">f</span><span class="op" id="8437778">.</span><span class="ident" id="8437779">LineCount</span><span class="op" id="8437788">(</span><span class="op" id="8437789">)</span>&nbsp;<span class="op" id="8437791">!=</span>&nbsp;<span class="ident" id="8437794">i</span><span class="op" id="8437795">+</span><span class="num" id="8437796">1</span>&nbsp;<span class="op" id="8437798">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437804">t</span><span class="op" id="8437805">.</span><span class="ident" id="8437806">Errorf</span><span class="op" id="8437812">(</span><span class="string" id="8437813">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8437854">,</span>&nbsp;<span class="ident" id="8437856">f</span><span class="op" id="8437857">.</span><span class="ident" id="8437858">Name</span><span class="op" id="8437862">(</span><span class="op" id="8437863">)</span><span class="op" id="8437864">,</span>&nbsp;<span class="ident" id="8437866">f</span><span class="op" id="8437867">.</span><span class="ident" id="8437868">LineCount</span><span class="op" id="8437877">(</span><span class="op" id="8437878">)</span><span class="op" id="8437879">,</span>&nbsp;<span class="ident" id="8437881">i</span><span class="op" id="8437882">+</span><span class="num" id="8437883">1</span><span class="op" id="8437884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8437889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8437894">//&nbsp;adding&nbsp;the&nbsp;same&nbsp;offset&nbsp;again&nbsp;should&nbsp;be&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437947">f</span><span class="op" id="8437948">.</span><span class="ident" id="8437949">AddLine</span><span class="op" id="8437956">(</span><span class="ident" id="8437957">offset</span><span class="op" id="8437963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8437968">if</span>&nbsp;<span class="ident" id="8437971">f</span><span class="op" id="8437972">.</span><span class="ident" id="8437973">LineCount</span><span class="op" id="8437982">(</span><span class="op" id="8437983">)</span>&nbsp;<span class="op" id="8437985">!=</span>&nbsp;<span class="ident" id="8437988">i</span><span class="op" id="8437989">+</span><span class="num" id="8437990">1</span>&nbsp;<span class="op" id="8437992">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8437998">t</span><span class="op" id="8437999">.</span><span class="ident" id="8438000">Errorf</span><span class="op" id="8438006">(</span><span class="string" id="8438007">&#34;%s,&nbsp;AddLine:&nbsp;got&nbsp;unchanged&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8438058">,</span>&nbsp;<span class="ident" id="8438060">f</span><span class="op" id="8438061">.</span><span class="ident" id="8438062">Name</span><span class="op" id="8438066">(</span><span class="op" id="8438067">)</span><span class="op" id="8438068">,</span>&nbsp;<span class="ident" id="8438070">f</span><span class="op" id="8438071">.</span><span class="ident" id="8438072">LineCount</span><span class="op" id="8438081">(</span><span class="op" id="8438082">)</span><span class="op" id="8438083">,</span>&nbsp;<span class="ident" id="8438085">i</span><span class="op" id="8438086">+</span><span class="num" id="8438087">1</span><span class="op" id="8438088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438098">verifyPositions</span><span class="op" id="8438113">(</span><span class="ident" id="8438114">t</span><span class="op" id="8438115">,</span>&nbsp;<span class="ident" id="8438117">fset</span><span class="op" id="8438121">,</span>&nbsp;<span class="ident" id="8438123">f</span><span class="op" id="8438124">,</span>&nbsp;<span class="ident" id="8438126">test</span><span class="op" id="8438130">.</span><span class="ident" id="8438131">lines</span><span class="op" id="8438136">[</span><span class="num" id="8438137">0</span><span class="op" id="8438138">:</span><span class="ident" id="8438139">i</span><span class="op" id="8438140">+</span><span class="num" id="8438141">1</span><span class="op" id="8438142">]</span><span class="op" id="8438143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8438152">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLines&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8438206">if</span>&nbsp;<span class="ident" id="8438209">ok</span>&nbsp;<span class="op" id="8438212">:=</span>&nbsp;<span class="ident" id="8438215">f</span><span class="op" id="8438216">.</span><span class="ident" id="8438217">SetLines</span><span class="op" id="8438225">(</span><span class="ident" id="8438226">test</span><span class="op" id="8438230">.</span><span class="ident" id="8438231">lines</span><span class="op" id="8438236">)</span><span class="op" id="8438237">;</span>&nbsp;<span class="op" id="8438239">!</span><span class="ident" id="8438240">ok</span>&nbsp;<span class="op" id="8438243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438248">t</span><span class="op" id="8438249">.</span><span class="ident" id="8438250">Errorf</span><span class="op" id="8438256">(</span><span class="string" id="8438257">&#34;%s:&nbsp;SetLines&nbsp;failed&#34;</span><span class="op" id="8438278">,</span>&nbsp;<span class="ident" id="8438280">f</span><span class="op" id="8438281">.</span><span class="ident" id="8438282">Name</span><span class="op" id="8438286">(</span><span class="op" id="8438287">)</span><span class="op" id="8438288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8438296">if</span>&nbsp;<span class="ident" id="8438299">f</span><span class="op" id="8438300">.</span><span class="ident" id="8438301">LineCount</span><span class="op" id="8438310">(</span><span class="op" id="8438311">)</span>&nbsp;<span class="op" id="8438313">!=</span>&nbsp;<span class="builtinfunc" id="8438316">len</span><span class="op" id="8438319">(</span><span class="ident" id="8438320">test</span><span class="op" id="8438324">.</span><span class="ident" id="8438325">lines</span><span class="op" id="8438330">)</span>&nbsp;<span class="op" id="8438332">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438337">t</span><span class="op" id="8438338">.</span><span class="ident" id="8438339">Errorf</span><span class="op" id="8438345">(</span><span class="string" id="8438346">&#34;%s,&nbsp;SetLines:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8438388">,</span>&nbsp;<span class="ident" id="8438390">f</span><span class="op" id="8438391">.</span><span class="ident" id="8438392">Name</span><span class="op" id="8438396">(</span><span class="op" id="8438397">)</span><span class="op" id="8438398">,</span>&nbsp;<span class="ident" id="8438400">f</span><span class="op" id="8438401">.</span><span class="ident" id="8438402">LineCount</span><span class="op" id="8438411">(</span><span class="op" id="8438412">)</span><span class="op" id="8438413">,</span>&nbsp;<span class="builtinfunc" id="8438415">len</span><span class="op" id="8438418">(</span><span class="ident" id="8438419">test</span><span class="op" id="8438423">.</span><span class="ident" id="8438424">lines</span><span class="op" id="8438429">)</span><span class="op" id="8438430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438438">verifyPositions</span><span class="op" id="8438453">(</span><span class="ident" id="8438454">t</span><span class="op" id="8438455">,</span>&nbsp;<span class="ident" id="8438457">fset</span><span class="op" id="8438461">,</span>&nbsp;<span class="ident" id="8438463">f</span><span class="op" id="8438464">,</span>&nbsp;<span class="ident" id="8438466">test</span><span class="op" id="8438470">.</span><span class="ident" id="8438471">lines</span><span class="op" id="8438476">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8438481">//&nbsp;add&nbsp;lines&nbsp;with&nbsp;SetLinesForContent&nbsp;and&nbsp;verify&nbsp;all&nbsp;positions</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438545">src</span>&nbsp;<span class="op" id="8438549">:=</span>&nbsp;<span class="ident" id="8438552">test</span><span class="op" id="8438556">.</span><span class="ident" id="8438557">source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8438566">if</span>&nbsp;<span class="ident" id="8438569">src</span>&nbsp;<span class="op" id="8438573">==</span>&nbsp;<span class="builtintype" id="8438576">nil</span>&nbsp;<span class="op" id="8438580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8438585">//&nbsp;no&nbsp;test&nbsp;source&nbsp;available&nbsp;-&nbsp;create&nbsp;one&nbsp;from&nbsp;scratch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438642">src</span>&nbsp;<span class="op" id="8438646">=</span>&nbsp;<span class="ident" id="8438648">makeTestSource</span><span class="op" id="8438662">(</span><span class="ident" id="8438663">test</span><span class="op" id="8438667">.</span><span class="ident" id="8438668">size</span><span class="op" id="8438672">,</span>&nbsp;<span class="ident" id="8438674">test</span><span class="op" id="8438678">.</span><span class="ident" id="8438679">lines</span><span class="op" id="8438684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438688">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438692">f</span><span class="op" id="8438693">.</span><span class="ident" id="8438694">SetLinesForContent</span><span class="op" id="8438712">(</span><span class="ident" id="8438713">src</span><span class="op" id="8438716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8438720">if</span>&nbsp;<span class="ident" id="8438723">f</span><span class="op" id="8438724">.</span><span class="ident" id="8438725">LineCount</span><span class="op" id="8438734">(</span><span class="op" id="8438735">)</span>&nbsp;<span class="op" id="8438737">!=</span>&nbsp;<span class="builtinfunc" id="8438740">len</span><span class="op" id="8438743">(</span><span class="ident" id="8438744">test</span><span class="op" id="8438748">.</span><span class="ident" id="8438749">lines</span><span class="op" id="8438754">)</span>&nbsp;<span class="op" id="8438756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438761">t</span><span class="op" id="8438762">.</span><span class="ident" id="8438763">Errorf</span><span class="op" id="8438769">(</span><span class="string" id="8438770">&#34;%s,&nbsp;SetLinesForContent:&nbsp;got&nbsp;line&nbsp;count&nbsp;%d;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8438822">,</span>&nbsp;<span class="ident" id="8438824">f</span><span class="op" id="8438825">.</span><span class="ident" id="8438826">Name</span><span class="op" id="8438830">(</span><span class="op" id="8438831">)</span><span class="op" id="8438832">,</span>&nbsp;<span class="ident" id="8438834">f</span><span class="op" id="8438835">.</span><span class="ident" id="8438836">LineCount</span><span class="op" id="8438845">(</span><span class="op" id="8438846">)</span><span class="op" id="8438847">,</span>&nbsp;<span class="builtinfunc" id="8438849">len</span><span class="op" id="8438852">(</span><span class="ident" id="8438853">test</span><span class="op" id="8438857">.</span><span class="ident" id="8438858">lines</span><span class="op" id="8438863">)</span><span class="op" id="8438864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438872">verifyPositions</span><span class="op" id="8438887">(</span><span class="ident" id="8438888">t</span><span class="op" id="8438889">,</span>&nbsp;<span class="ident" id="8438891">fset</span><span class="op" id="8438895">,</span>&nbsp;<span class="ident" id="8438897">f</span><span class="op" id="8438898">,</span>&nbsp;<span class="ident" id="8438900">test</span><span class="op" id="8438904">.</span><span class="ident" id="8438905">lines</span><span class="op" id="8438910">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8438913">}</span><br>
<span class="lineno"></span><span class="op" id="8438915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8438918">func</span>&nbsp;<span class="ident" id="8438923">TestLineInfo</span><span class="op" id="8438935">(</span><span class="ident" id="8438936">t</span>&nbsp;<span class="op" id="8438938">*</span><span class="ident" id="8438939">testing</span><span class="op" id="8438946">.</span><span class="ident" id="8438947">T</span><span class="op" id="8438948">)</span>&nbsp;<span class="op" id="8438950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438953">fset</span>&nbsp;<span class="op" id="8438958">:=</span>&nbsp;<span class="ident" id="8438961">NewFileSet</span><span class="op" id="8438971">(</span><span class="op" id="8438972">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8438975">f</span>&nbsp;<span class="op" id="8438977">:=</span>&nbsp;<span class="ident" id="8438980">fset</span><span class="op" id="8438984">.</span><span class="ident" id="8438985">AddFile</span><span class="op" id="8438992">(</span><span class="string" id="8438993">&#34;foo&#34;</span><span class="op" id="8438998">,</span>&nbsp;<span class="ident" id="8439000">fset</span><span class="op" id="8439004">.</span><span class="ident" id="8439005">Base</span><span class="op" id="8439009">(</span><span class="op" id="8439010">)</span><span class="op" id="8439011">,</span>&nbsp;<span class="num" id="8439013">500</span><span class="op" id="8439016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439019">lines</span>&nbsp;<span class="op" id="8439025">:=</span>&nbsp;<span class="op" id="8439028">[</span><span class="op" id="8439029">]</span><span class="builtintype" id="8439030">int</span><span class="op" id="8439033">{</span><span class="num" id="8439034">0</span><span class="op" id="8439035">,</span>&nbsp;<span class="num" id="8439037">42</span><span class="op" id="8439039">,</span>&nbsp;<span class="num" id="8439041">77</span><span class="op" id="8439043">,</span>&nbsp;<span class="num" id="8439045">100</span><span class="op" id="8439048">,</span>&nbsp;<span class="num" id="8439050">210</span><span class="op" id="8439053">,</span>&nbsp;<span class="num" id="8439055">220</span><span class="op" id="8439058">,</span>&nbsp;<span class="num" id="8439060">277</span><span class="op" id="8439063">,</span>&nbsp;<span class="num" id="8439065">300</span><span class="op" id="8439068">,</span>&nbsp;<span class="num" id="8439070">333</span><span class="op" id="8439073">,</span>&nbsp;<span class="num" id="8439075">401</span><span class="op" id="8439078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8439081">//&nbsp;add&nbsp;lines&nbsp;individually&nbsp;and&nbsp;provide&nbsp;alternative&nbsp;line&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8439149">for</span>&nbsp;<span class="ident" id="8439153">_</span><span class="op" id="8439154">,</span>&nbsp;<span class="ident" id="8439156">offs</span>&nbsp;<span class="op" id="8439161">:=</span>&nbsp;<span class="keyword" id="8439164">range</span>&nbsp;<span class="ident" id="8439170">lines</span>&nbsp;<span class="op" id="8439176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439180">f</span><span class="op" id="8439181">.</span><span class="ident" id="8439182">AddLine</span><span class="op" id="8439189">(</span><span class="ident" id="8439190">offs</span><span class="op" id="8439194">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439198">f</span><span class="op" id="8439199">.</span><span class="ident" id="8439200">AddLineInfo</span><span class="op" id="8439211">(</span><span class="ident" id="8439212">offs</span><span class="op" id="8439216">,</span>&nbsp;<span class="string" id="8439218">&#34;bar&#34;</span><span class="op" id="8439223">,</span>&nbsp;<span class="num" id="8439225">42</span><span class="op" id="8439227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8439230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8439233">//&nbsp;verify&nbsp;positions&nbsp;for&nbsp;all&nbsp;offsets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8439270">for</span>&nbsp;<span class="ident" id="8439274">offs</span>&nbsp;<span class="op" id="8439279">:=</span>&nbsp;<span class="num" id="8439282">0</span><span class="op" id="8439283">;</span>&nbsp;<span class="ident" id="8439285">offs</span>&nbsp;<span class="op" id="8439290">&lt;=</span>&nbsp;<span class="ident" id="8439293">f</span><span class="op" id="8439294">.</span><span class="ident" id="8439295">Size</span><span class="op" id="8439299">(</span><span class="op" id="8439300">)</span><span class="op" id="8439301">;</span>&nbsp;<span class="ident" id="8439303">offs</span><span class="op" id="8439307">++</span>&nbsp;<span class="op" id="8439310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439314">p</span>&nbsp;<span class="op" id="8439316">:=</span>&nbsp;<span class="ident" id="8439319">f</span><span class="op" id="8439320">.</span><span class="ident" id="8439321">Pos</span><span class="op" id="8439324">(</span><span class="ident" id="8439325">offs</span><span class="op" id="8439329">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439333">_</span><span class="op" id="8439334">,</span>&nbsp;<span class="ident" id="8439336">col</span>&nbsp;<span class="op" id="8439340">:=</span>&nbsp;<span class="ident" id="8439343">linecol</span><span class="op" id="8439350">(</span><span class="ident" id="8439351">lines</span><span class="op" id="8439356">,</span>&nbsp;<span class="ident" id="8439358">offs</span><span class="op" id="8439362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439366">msg</span>&nbsp;<span class="op" id="8439370">:=</span>&nbsp;<span class="ident" id="8439373">fmt</span><span class="op" id="8439376">.</span><span class="ident" id="8439377">Sprintf</span><span class="op" id="8439384">(</span><span class="string" id="8439385">&#34;%s&nbsp;(offs&nbsp;=&nbsp;%d,&nbsp;p&nbsp;=&nbsp;%d)&#34;</span><span class="op" id="8439409">,</span>&nbsp;<span class="ident" id="8439411">f</span><span class="op" id="8439412">.</span><span class="ident" id="8439413">Name</span><span class="op" id="8439417">(</span><span class="op" id="8439418">)</span><span class="op" id="8439419">,</span>&nbsp;<span class="ident" id="8439421">offs</span><span class="op" id="8439425">,</span>&nbsp;<span class="ident" id="8439427">p</span><span class="op" id="8439428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439432">checkPos</span><span class="op" id="8439440">(</span><span class="ident" id="8439441">t</span><span class="op" id="8439442">,</span>&nbsp;<span class="ident" id="8439444">msg</span><span class="op" id="8439447">,</span>&nbsp;<span class="ident" id="8439449">f</span><span class="op" id="8439450">.</span><span class="ident" id="8439451">Position</span><span class="op" id="8439459">(</span><span class="ident" id="8439460">f</span><span class="op" id="8439461">.</span><span class="ident" id="8439462">Pos</span><span class="op" id="8439465">(</span><span class="ident" id="8439466">offs</span><span class="op" id="8439470">)</span><span class="op" id="8439471">)</span><span class="op" id="8439472">,</span>&nbsp;<span class="ident" id="8439474">Position</span><span class="op" id="8439482">{</span><span class="string" id="8439483">&#34;bar&#34;</span><span class="op" id="8439488">,</span>&nbsp;<span class="ident" id="8439490">offs</span><span class="op" id="8439494">,</span>&nbsp;<span class="num" id="8439496">42</span><span class="op" id="8439498">,</span>&nbsp;<span class="ident" id="8439500">col</span><span class="op" id="8439503">}</span><span class="op" id="8439504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439508">checkPos</span><span class="op" id="8439516">(</span><span class="ident" id="8439517">t</span><span class="op" id="8439518">,</span>&nbsp;<span class="ident" id="8439520">msg</span><span class="op" id="8439523">,</span>&nbsp;<span class="ident" id="8439525">fset</span><span class="op" id="8439529">.</span><span class="ident" id="8439530">Position</span><span class="op" id="8439538">(</span><span class="ident" id="8439539">p</span><span class="op" id="8439540">)</span><span class="op" id="8439541">,</span>&nbsp;<span class="ident" id="8439543">Position</span><span class="op" id="8439551">{</span><span class="string" id="8439552">&#34;bar&#34;</span><span class="op" id="8439557">,</span>&nbsp;<span class="ident" id="8439559">offs</span><span class="op" id="8439563">,</span>&nbsp;<span class="num" id="8439565">42</span><span class="op" id="8439567">,</span>&nbsp;<span class="ident" id="8439569">col</span><span class="op" id="8439572">}</span><span class="op" id="8439573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8439576">}</span><br>
<span class="lineno">165</span><span class="op" id="8439578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8439581">func</span>&nbsp;<span class="ident" id="8439586">TestFiles</span><span class="op" id="8439595">(</span><span class="ident" id="8439596">t</span>&nbsp;<span class="op" id="8439598">*</span><span class="ident" id="8439599">testing</span><span class="op" id="8439606">.</span><span class="ident" id="8439607">T</span><span class="op" id="8439608">)</span>&nbsp;<span class="op" id="8439610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439613">fset</span>&nbsp;<span class="op" id="8439618">:=</span>&nbsp;<span class="ident" id="8439621">NewFileSet</span><span class="op" id="8439631">(</span><span class="op" id="8439632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8439635">for</span>&nbsp;<span class="ident" id="8439639">i</span><span class="op" id="8439640">,</span>&nbsp;<span class="ident" id="8439642">test</span>&nbsp;<span class="op" id="8439647">:=</span>&nbsp;<span class="keyword" id="8439650">range</span>&nbsp;<span class="ident" id="8439656">tests</span>&nbsp;<span class="op" id="8439662">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439666">base</span>&nbsp;<span class="op" id="8439671">:=</span>&nbsp;<span class="ident" id="8439674">fset</span><span class="op" id="8439678">.</span><span class="ident" id="8439679">Base</span><span class="op" id="8439683">(</span><span class="op" id="8439684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8439688">if</span>&nbsp;<span class="ident" id="8439691">i</span><span class="op" id="8439692">%</span><span class="num" id="8439693">2</span>&nbsp;<span class="op" id="8439695">==</span>&nbsp;<span class="num" id="8439698">1</span>&nbsp;<span class="op" id="8439700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8439705">//&nbsp;Setting&nbsp;a&nbsp;negative&nbsp;base&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8439752">//&nbsp;fset.Base(),&nbsp;so&nbsp;test&nbsp;some&nbsp;of&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439793">base</span>&nbsp;<span class="op" id="8439798">=</span>&nbsp;<span class="op" id="8439800">-</span><span class="num" id="8439801">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8439805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439809">fset</span><span class="op" id="8439813">.</span><span class="ident" id="8439814">AddFile</span><span class="op" id="8439821">(</span><span class="ident" id="8439822">test</span><span class="op" id="8439826">.</span><span class="ident" id="8439827">filename</span><span class="op" id="8439835">,</span>&nbsp;<span class="ident" id="8439837">base</span><span class="op" id="8439841">,</span>&nbsp;<span class="ident" id="8439843">test</span><span class="op" id="8439847">.</span><span class="ident" id="8439848">size</span><span class="op" id="8439852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439856">j</span>&nbsp;<span class="op" id="8439858">:=</span>&nbsp;<span class="num" id="8439861">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439865">fset</span><span class="op" id="8439869">.</span><span class="ident" id="8439870">Iterate</span><span class="op" id="8439877">(</span><span class="keyword" id="8439878">func</span><span class="op" id="8439882">(</span><span class="ident" id="8439883">f</span>&nbsp;<span class="op" id="8439885">*</span><span class="ident" id="8439886">File</span><span class="op" id="8439890">)</span>&nbsp;<span class="builtintype" id="8439892">bool</span>&nbsp;<span class="op" id="8439897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8439902">if</span>&nbsp;<span class="ident" id="8439905">f</span><span class="op" id="8439906">.</span><span class="ident" id="8439907">Name</span><span class="op" id="8439911">(</span><span class="op" id="8439912">)</span>&nbsp;<span class="op" id="8439914">!=</span>&nbsp;<span class="ident" id="8439917">tests</span><span class="op" id="8439922">[</span><span class="ident" id="8439923">j</span><span class="op" id="8439924">]</span><span class="op" id="8439925">.</span><span class="ident" id="8439926">filename</span>&nbsp;<span class="op" id="8439935">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8439941">t</span><span class="op" id="8439942">.</span><span class="ident" id="8439943">Errorf</span><span class="op" id="8439949">(</span><span class="string" id="8439950">&#34;got&nbsp;filename&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8439978">,</span>&nbsp;<span class="ident" id="8439980">f</span><span class="op" id="8439981">.</span><span class="ident" id="8439982">Name</span><span class="op" id="8439986">(</span><span class="op" id="8439987">)</span><span class="op" id="8439988">,</span>&nbsp;<span class="ident" id="8439990">tests</span><span class="op" id="8439995">[</span><span class="ident" id="8439996">j</span><span class="op" id="8439997">]</span><span class="op" id="8439998">.</span><span class="ident" id="8439999">filename</span><span class="op" id="8440007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440017">j</span><span class="op" id="8440018">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440024">return</span>&nbsp;<span class="builtintype" id="8440031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440038">}</span><span class="op" id="8440039">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440043">if</span>&nbsp;<span class="ident" id="8440046">j</span>&nbsp;<span class="op" id="8440048">!=</span>&nbsp;<span class="ident" id="8440051">i</span><span class="op" id="8440052">+</span><span class="num" id="8440053">1</span>&nbsp;<span class="op" id="8440055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440060">t</span><span class="op" id="8440061">.</span><span class="ident" id="8440062">Errorf</span><span class="op" id="8440068">(</span><span class="string" id="8440069">&#34;got&nbsp;%d&nbsp;files;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8440092">,</span>&nbsp;<span class="ident" id="8440094">j</span><span class="op" id="8440095">,</span>&nbsp;<span class="ident" id="8440097">i</span><span class="op" id="8440098">+</span><span class="num" id="8440099">1</span><span class="op" id="8440100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440107">}</span><br>
<span class="lineno"></span><span class="op" id="8440109">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="8440112">//&nbsp;FileSet.File&nbsp;should&nbsp;return&nbsp;nil&nbsp;if&nbsp;Pos&nbsp;is&nbsp;past&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;FileSet.</span><br>
<span class="lineno"></span><span class="keyword" id="8440185">func</span>&nbsp;<span class="ident" id="8440190">TestFileSetPastEnd</span><span class="op" id="8440208">(</span><span class="ident" id="8440209">t</span>&nbsp;<span class="op" id="8440211">*</span><span class="ident" id="8440212">testing</span><span class="op" id="8440219">.</span><span class="ident" id="8440220">T</span><span class="op" id="8440221">)</span>&nbsp;<span class="op" id="8440223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440226">fset</span>&nbsp;<span class="op" id="8440231">:=</span>&nbsp;<span class="ident" id="8440234">NewFileSet</span><span class="op" id="8440244">(</span><span class="op" id="8440245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440248">for</span>&nbsp;<span class="ident" id="8440252">_</span><span class="op" id="8440253">,</span>&nbsp;<span class="ident" id="8440255">test</span>&nbsp;<span class="op" id="8440260">:=</span>&nbsp;<span class="keyword" id="8440263">range</span>&nbsp;<span class="ident" id="8440269">tests</span>&nbsp;<span class="op" id="8440275">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440279">fset</span><span class="op" id="8440283">.</span><span class="ident" id="8440284">AddFile</span><span class="op" id="8440291">(</span><span class="ident" id="8440292">test</span><span class="op" id="8440296">.</span><span class="ident" id="8440297">filename</span><span class="op" id="8440305">,</span>&nbsp;<span class="ident" id="8440307">fset</span><span class="op" id="8440311">.</span><span class="ident" id="8440312">Base</span><span class="op" id="8440316">(</span><span class="op" id="8440317">)</span><span class="op" id="8440318">,</span>&nbsp;<span class="ident" id="8440320">test</span><span class="op" id="8440324">.</span><span class="ident" id="8440325">size</span><span class="op" id="8440329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440335">if</span>&nbsp;<span class="ident" id="8440338">f</span>&nbsp;<span class="op" id="8440340">:=</span>&nbsp;<span class="ident" id="8440343">fset</span><span class="op" id="8440347">.</span><span class="ident" id="8440348">File</span><span class="op" id="8440352">(</span><span class="ident" id="8440353">Pos</span><span class="op" id="8440356">(</span><span class="ident" id="8440357">fset</span><span class="op" id="8440361">.</span><span class="ident" id="8440362">Base</span><span class="op" id="8440366">(</span><span class="op" id="8440367">)</span><span class="op" id="8440368">)</span><span class="op" id="8440369">)</span><span class="op" id="8440370">;</span>&nbsp;<span class="ident" id="8440372">f</span>&nbsp;<span class="op" id="8440374">!=</span>&nbsp;<span class="builtintype" id="8440377">nil</span>&nbsp;<span class="op" id="8440381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440385">t</span><span class="op" id="8440386">.</span><span class="ident" id="8440387">Errorf</span><span class="op" id="8440393">(</span><span class="string" id="8440394">&#34;got&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8440412">,</span>&nbsp;<span class="ident" id="8440414">f</span><span class="op" id="8440415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440418">}</span><br>
<span class="lineno">200</span><span class="op" id="8440420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8440423">func</span>&nbsp;<span class="ident" id="8440428">TestFileSetCacheUnlikely</span><span class="op" id="8440452">(</span><span class="ident" id="8440453">t</span>&nbsp;<span class="op" id="8440455">*</span><span class="ident" id="8440456">testing</span><span class="op" id="8440463">.</span><span class="ident" id="8440464">T</span><span class="op" id="8440465">)</span>&nbsp;<span class="op" id="8440467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440470">fset</span>&nbsp;<span class="op" id="8440475">:=</span>&nbsp;<span class="ident" id="8440478">NewFileSet</span><span class="op" id="8440488">(</span><span class="op" id="8440489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440492">offsets</span>&nbsp;<span class="op" id="8440500">:=</span>&nbsp;<span class="builtinfunc" id="8440503">make</span><span class="op" id="8440507">(</span><span class="keyword" id="8440508">map</span><span class="op" id="8440511">[</span><span class="builtintype" id="8440512">string</span><span class="op" id="8440518">]</span><span class="builtintype" id="8440519">int</span><span class="op" id="8440522">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440525">for</span>&nbsp;<span class="ident" id="8440529">_</span><span class="op" id="8440530">,</span>&nbsp;<span class="ident" id="8440532">test</span>&nbsp;<span class="op" id="8440537">:=</span>&nbsp;<span class="keyword" id="8440540">range</span>&nbsp;<span class="ident" id="8440546">tests</span>&nbsp;<span class="op" id="8440552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440556">offsets</span><span class="op" id="8440563">[</span><span class="ident" id="8440564">test</span><span class="op" id="8440568">.</span><span class="ident" id="8440569">filename</span><span class="op" id="8440577">]</span>&nbsp;<span class="op" id="8440579">=</span>&nbsp;<span class="ident" id="8440581">fset</span><span class="op" id="8440585">.</span><span class="ident" id="8440586">Base</span><span class="op" id="8440590">(</span><span class="op" id="8440591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440595">fset</span><span class="op" id="8440599">.</span><span class="ident" id="8440600">AddFile</span><span class="op" id="8440607">(</span><span class="ident" id="8440608">test</span><span class="op" id="8440612">.</span><span class="ident" id="8440613">filename</span><span class="op" id="8440621">,</span>&nbsp;<span class="ident" id="8440623">fset</span><span class="op" id="8440627">.</span><span class="ident" id="8440628">Base</span><span class="op" id="8440632">(</span><span class="op" id="8440633">)</span><span class="op" id="8440634">,</span>&nbsp;<span class="ident" id="8440636">test</span><span class="op" id="8440640">.</span><span class="ident" id="8440641">size</span><span class="op" id="8440645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440651">for</span>&nbsp;<span class="ident" id="8440655">file</span><span class="op" id="8440659">,</span>&nbsp;<span class="ident" id="8440661">pos</span>&nbsp;<span class="op" id="8440665">:=</span>&nbsp;<span class="keyword" id="8440668">range</span>&nbsp;<span class="ident" id="8440674">offsets</span>&nbsp;<span class="op" id="8440682">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440686">f</span>&nbsp;<span class="op" id="8440688">:=</span>&nbsp;<span class="ident" id="8440691">fset</span><span class="op" id="8440695">.</span><span class="ident" id="8440696">File</span><span class="op" id="8440700">(</span><span class="ident" id="8440701">Pos</span><span class="op" id="8440704">(</span><span class="ident" id="8440705">pos</span><span class="op" id="8440708">)</span><span class="op" id="8440709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440713">if</span>&nbsp;<span class="ident" id="8440716">f</span><span class="op" id="8440717">.</span><span class="ident" id="8440718">Name</span><span class="op" id="8440722">(</span><span class="op" id="8440723">)</span>&nbsp;<span class="op" id="8440725">!=</span>&nbsp;<span class="ident" id="8440728">file</span>&nbsp;<span class="op" id="8440733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440738">t</span><span class="op" id="8440739">.</span><span class="ident" id="8440740">Errorf</span><span class="op" id="8440746">(</span><span class="string" id="8440747">&#34;got&nbsp;%q&nbsp;at&nbsp;position&nbsp;%d,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8440779">,</span>&nbsp;<span class="ident" id="8440781">f</span><span class="op" id="8440782">.</span><span class="ident" id="8440783">Name</span><span class="op" id="8440787">(</span><span class="op" id="8440788">)</span><span class="op" id="8440789">,</span>&nbsp;<span class="ident" id="8440791">pos</span><span class="op" id="8440794">,</span>&nbsp;<span class="ident" id="8440796">file</span><span class="op" id="8440800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8440807">}</span><br>
<span class="lineno">215</span><span class="op" id="8440809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8440812">//&nbsp;issue&nbsp;4345.&nbsp;Test&nbsp;concurrent&nbsp;use&nbsp;of&nbsp;FileSet.Pos&nbsp;does&nbsp;not&nbsp;trigger&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8440881">//&nbsp;race&nbsp;in&nbsp;the&nbsp;FileSet&nbsp;position&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="8440920">func</span>&nbsp;<span class="ident" id="8440925">TestFileSetRace</span><span class="op" id="8440940">(</span><span class="ident" id="8440941">t</span>&nbsp;<span class="op" id="8440943">*</span><span class="ident" id="8440944">testing</span><span class="op" id="8440951">.</span><span class="ident" id="8440952">T</span><span class="op" id="8440953">)</span>&nbsp;<span class="op" id="8440955">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8440958">fset</span>&nbsp;<span class="op" id="8440963">:=</span>&nbsp;<span class="ident" id="8440966">NewFileSet</span><span class="op" id="8440976">(</span><span class="op" id="8440977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8440980">for</span>&nbsp;<span class="ident" id="8440984">i</span>&nbsp;<span class="op" id="8440986">:=</span>&nbsp;<span class="num" id="8440989">0</span><span class="op" id="8440990">;</span>&nbsp;<span class="ident" id="8440992">i</span>&nbsp;<span class="op" id="8440994">&lt;</span>&nbsp;<span class="num" id="8440996">100</span><span class="op" id="8440999">;</span>&nbsp;<span class="ident" id="8441001">i</span><span class="op" id="8441002">++</span>&nbsp;<span class="op" id="8441005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441009">fset</span><span class="op" id="8441013">.</span><span class="ident" id="8441014">AddFile</span><span class="op" id="8441021">(</span><span class="ident" id="8441022">fmt</span><span class="op" id="8441025">.</span><span class="ident" id="8441026">Sprintf</span><span class="op" id="8441033">(</span><span class="string" id="8441034">&#34;file-%d&#34;</span><span class="op" id="8441043">,</span>&nbsp;<span class="ident" id="8441045">i</span><span class="op" id="8441046">)</span><span class="op" id="8441047">,</span>&nbsp;<span class="ident" id="8441049">fset</span><span class="op" id="8441053">.</span><span class="ident" id="8441054">Base</span><span class="op" id="8441058">(</span><span class="op" id="8441059">)</span><span class="op" id="8441060">,</span>&nbsp;<span class="num" id="8441062">1031</span><span class="op" id="8441066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8441069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441072">max</span>&nbsp;<span class="op" id="8441076">:=</span>&nbsp;<span class="builtintype" id="8441079">int32</span><span class="op" id="8441084">(</span><span class="ident" id="8441085">fset</span><span class="op" id="8441089">.</span><span class="ident" id="8441090">Base</span><span class="op" id="8441094">(</span><span class="op" id="8441095">)</span><span class="op" id="8441096">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441099">var</span>&nbsp;<span class="ident" id="8441103">stop</span>&nbsp;<span class="ident" id="8441108">sync</span><span class="op" id="8441112">.</span><span class="ident" id="8441113">WaitGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441124">r</span>&nbsp;<span class="op" id="8441126">:=</span>&nbsp;<span class="ident" id="8441129">rand</span><span class="op" id="8441133">.</span><span class="ident" id="8441134">New</span><span class="op" id="8441137">(</span><span class="ident" id="8441138">rand</span><span class="op" id="8441142">.</span><span class="ident" id="8441143">NewSource</span><span class="op" id="8441152">(</span><span class="num" id="8441153">7</span><span class="op" id="8441154">)</span><span class="op" id="8441155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441158">for</span>&nbsp;<span class="ident" id="8441162">i</span>&nbsp;<span class="op" id="8441164">:=</span>&nbsp;<span class="num" id="8441167">0</span><span class="op" id="8441168">;</span>&nbsp;<span class="ident" id="8441170">i</span>&nbsp;<span class="op" id="8441172">&lt;</span>&nbsp;<span class="num" id="8441174">2</span><span class="op" id="8441175">;</span>&nbsp;<span class="ident" id="8441177">i</span><span class="op" id="8441178">++</span>&nbsp;<span class="op" id="8441181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441185">r</span>&nbsp;<span class="op" id="8441187">:=</span>&nbsp;<span class="ident" id="8441190">rand</span><span class="op" id="8441194">.</span><span class="ident" id="8441195">New</span><span class="op" id="8441198">(</span><span class="ident" id="8441199">rand</span><span class="op" id="8441203">.</span><span class="ident" id="8441204">NewSource</span><span class="op" id="8441213">(</span><span class="ident" id="8441214">r</span><span class="op" id="8441215">.</span><span class="ident" id="8441216">Int63</span><span class="op" id="8441221">(</span><span class="op" id="8441222">)</span><span class="op" id="8441223">)</span><span class="op" id="8441224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441228">stop</span><span class="op" id="8441232">.</span><span class="ident" id="8441233">Add</span><span class="op" id="8441236">(</span><span class="num" id="8441237">1</span><span class="op" id="8441238">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441242">go</span>&nbsp;<span class="keyword" id="8441245">func</span><span class="op" id="8441249">(</span><span class="op" id="8441250">)</span>&nbsp;<span class="op" id="8441252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441257">for</span>&nbsp;<span class="ident" id="8441261">i</span>&nbsp;<span class="op" id="8441263">:=</span>&nbsp;<span class="num" id="8441266">0</span><span class="op" id="8441267">;</span>&nbsp;<span class="ident" id="8441269">i</span>&nbsp;<span class="op" id="8441271">&lt;</span>&nbsp;<span class="num" id="8441273">1000</span><span class="op" id="8441277">;</span>&nbsp;<span class="ident" id="8441279">i</span><span class="op" id="8441280">++</span>&nbsp;<span class="op" id="8441283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441289">fset</span><span class="op" id="8441293">.</span><span class="ident" id="8441294">Position</span><span class="op" id="8441302">(</span><span class="ident" id="8441303">Pos</span><span class="op" id="8441306">(</span><span class="ident" id="8441307">r</span><span class="op" id="8441308">.</span><span class="ident" id="8441309">Int31n</span><span class="op" id="8441315">(</span><span class="ident" id="8441316">max</span><span class="op" id="8441319">)</span><span class="op" id="8441320">)</span><span class="op" id="8441321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8441326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441331">stop</span><span class="op" id="8441335">.</span><span class="ident" id="8441336">Done</span><span class="op" id="8441340">(</span><span class="op" id="8441341">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8441345">}</span><span class="op" id="8441346">(</span><span class="op" id="8441347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8441350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441353">stop</span><span class="op" id="8441357">.</span><span class="ident" id="8441358">Wait</span><span class="op" id="8441362">(</span><span class="op" id="8441363">)</span><br>
<span class="lineno"></span><span class="op" id="8441365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8441368">func</span>&nbsp;<span class="ident" id="8441373">TestPositionFor</span><span class="op" id="8441388">(</span><span class="ident" id="8441389">t</span>&nbsp;<span class="op" id="8441391">*</span><span class="ident" id="8441392">testing</span><span class="op" id="8441399">.</span><span class="ident" id="8441400">T</span><span class="op" id="8441401">)</span>&nbsp;<span class="op" id="8441403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441406">src</span>&nbsp;<span class="op" id="8441410">:=</span>&nbsp;<span class="op" id="8441413">[</span><span class="op" id="8441414">]</span><span class="builtintype" id="8441415">byte</span><span class="op" id="8441419">(</span><span class="string" id="8441420">`<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>b<br>
<span class="lineno"></span>ar<br>
<span class="lineno">245</span>//line&nbsp;:100<br>
<span class="lineno"></span>foobar<br>
<span class="lineno"></span>//line&nbsp;bar:3<br>
<span class="lineno"></span>done<br>
<span class="lineno"></span>`</span><span class="op" id="8441469">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441473">const</span>&nbsp;<span class="ident" id="8441479">filename</span>&nbsp;<span class="op" id="8441488">=</span>&nbsp;<span class="string" id="8441490">&#34;foo&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441497">fset</span>&nbsp;<span class="op" id="8441502">:=</span>&nbsp;<span class="ident" id="8441505">NewFileSet</span><span class="op" id="8441515">(</span><span class="op" id="8441516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441519">f</span>&nbsp;<span class="op" id="8441521">:=</span>&nbsp;<span class="ident" id="8441524">fset</span><span class="op" id="8441528">.</span><span class="ident" id="8441529">AddFile</span><span class="op" id="8441536">(</span><span class="ident" id="8441537">filename</span><span class="op" id="8441545">,</span>&nbsp;<span class="ident" id="8441547">fset</span><span class="op" id="8441551">.</span><span class="ident" id="8441552">Base</span><span class="op" id="8441556">(</span><span class="op" id="8441557">)</span><span class="op" id="8441558">,</span>&nbsp;<span class="builtinfunc" id="8441560">len</span><span class="op" id="8441563">(</span><span class="ident" id="8441564">src</span><span class="op" id="8441567">)</span><span class="op" id="8441568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441571">f</span><span class="op" id="8441572">.</span><span class="ident" id="8441573">SetLinesForContent</span><span class="op" id="8441591">(</span><span class="ident" id="8441592">src</span><span class="op" id="8441595">)</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8441599">//&nbsp;verify&nbsp;position&nbsp;info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8441624">for</span>&nbsp;<span class="ident" id="8441628">i</span><span class="op" id="8441629">,</span>&nbsp;<span class="ident" id="8441631">offs</span>&nbsp;<span class="op" id="8441636">:=</span>&nbsp;<span class="keyword" id="8441639">range</span>&nbsp;<span class="ident" id="8441645">f</span><span class="op" id="8441646">.</span><span class="ident" id="8441647">lines</span>&nbsp;<span class="op" id="8441653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441657">got1</span>&nbsp;<span class="op" id="8441662">:=</span>&nbsp;<span class="ident" id="8441665">f</span><span class="op" id="8441666">.</span><span class="ident" id="8441667">PositionFor</span><span class="op" id="8441678">(</span><span class="ident" id="8441679">f</span><span class="op" id="8441680">.</span><span class="ident" id="8441681">Pos</span><span class="op" id="8441684">(</span><span class="ident" id="8441685">offs</span><span class="op" id="8441689">)</span><span class="op" id="8441690">,</span>&nbsp;<span class="builtintype" id="8441692">false</span><span class="op" id="8441697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441701">got2</span>&nbsp;<span class="op" id="8441706">:=</span>&nbsp;<span class="ident" id="8441709">f</span><span class="op" id="8441710">.</span><span class="ident" id="8441711">PositionFor</span><span class="op" id="8441722">(</span><span class="ident" id="8441723">f</span><span class="op" id="8441724">.</span><span class="ident" id="8441725">Pos</span><span class="op" id="8441728">(</span><span class="ident" id="8441729">offs</span><span class="op" id="8441733">)</span><span class="op" id="8441734">,</span>&nbsp;<span class="builtintype" id="8441736">true</span><span class="op" id="8441740">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441744">got3</span>&nbsp;<span class="op" id="8441749">:=</span>&nbsp;<span class="ident" id="8441752">f</span><span class="op" id="8441753">.</span><span class="ident" id="8441754">Position</span><span class="op" id="8441762">(</span><span class="ident" id="8441763">f</span><span class="op" id="8441764">.</span><span class="ident" id="8441765">Pos</span><span class="op" id="8441768">(</span><span class="ident" id="8441769">offs</span><span class="op" id="8441773">)</span><span class="op" id="8441774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441778">want</span>&nbsp;<span class="op" id="8441783">:=</span>&nbsp;<span class="ident" id="8441786">Position</span><span class="op" id="8441794">{</span><span class="ident" id="8441795">filename</span><span class="op" id="8441803">,</span>&nbsp;<span class="ident" id="8441805">offs</span><span class="op" id="8441809">,</span>&nbsp;<span class="ident" id="8441811">i</span>&nbsp;<span class="op" id="8441813">+</span>&nbsp;<span class="num" id="8441815">1</span><span class="op" id="8441816">,</span>&nbsp;<span class="num" id="8441818">1</span><span class="op" id="8441819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441823">checkPos</span><span class="op" id="8441831">(</span><span class="ident" id="8441832">t</span><span class="op" id="8441833">,</span>&nbsp;<span class="string" id="8441835">&#34;1.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="8441862">,</span>&nbsp;<span class="ident" id="8441864">got1</span><span class="op" id="8441868">,</span>&nbsp;<span class="ident" id="8441870">want</span><span class="op" id="8441874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441878">checkPos</span><span class="op" id="8441886">(</span><span class="ident" id="8441887">t</span><span class="op" id="8441888">,</span>&nbsp;<span class="string" id="8441890">&#34;1.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="8441915">,</span>&nbsp;<span class="ident" id="8441917">got2</span><span class="op" id="8441921">,</span>&nbsp;<span class="ident" id="8441923">want</span><span class="op" id="8441927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8441931">checkPos</span><span class="op" id="8441939">(</span><span class="ident" id="8441940">t</span><span class="op" id="8441941">,</span>&nbsp;<span class="string" id="8441943">&#34;1.&nbsp;Position&#34;</span><span class="op" id="8441956">,</span>&nbsp;<span class="ident" id="8441958">got3</span><span class="op" id="8441962">,</span>&nbsp;<span class="ident" id="8441964">want</span><span class="op" id="8441968">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8441971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8441975">//&nbsp;manually&nbsp;add&nbsp;//line&nbsp;info&nbsp;on&nbsp;lines&nbsp;l1,&nbsp;l2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8442020">const</span>&nbsp;<span class="ident" id="8442026">l1</span><span class="op" id="8442028">,</span>&nbsp;<span class="ident" id="8442030">l2</span>&nbsp;<span class="op" id="8442033">=</span>&nbsp;<span class="num" id="8442035">5</span><span class="op" id="8442036">,</span>&nbsp;<span class="num" id="8442038">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442041">f</span><span class="op" id="8442042">.</span><span class="ident" id="8442043">AddLineInfo</span><span class="op" id="8442054">(</span><span class="ident" id="8442055">f</span><span class="op" id="8442056">.</span><span class="ident" id="8442057">lines</span><span class="op" id="8442062">[</span><span class="ident" id="8442063">l1</span><span class="op" id="8442065">-</span><span class="num" id="8442066">1</span><span class="op" id="8442067">]</span><span class="op" id="8442068">,</span>&nbsp;<span class="string" id="8442070">&#34;&#34;</span><span class="op" id="8442072">,</span>&nbsp;<span class="num" id="8442074">100</span><span class="op" id="8442077">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442080">f</span><span class="op" id="8442081">.</span><span class="ident" id="8442082">AddLineInfo</span><span class="op" id="8442093">(</span><span class="ident" id="8442094">f</span><span class="op" id="8442095">.</span><span class="ident" id="8442096">lines</span><span class="op" id="8442101">[</span><span class="ident" id="8442102">l2</span><span class="op" id="8442104">-</span><span class="num" id="8442105">1</span><span class="op" id="8442106">]</span><span class="op" id="8442107">,</span>&nbsp;<span class="string" id="8442109">&#34;bar&#34;</span><span class="op" id="8442114">,</span>&nbsp;<span class="num" id="8442116">3</span><span class="op" id="8442117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8442121">//&nbsp;unadjusted&nbsp;position&nbsp;info&nbsp;must&nbsp;remain&nbsp;unchanged</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8442172">for</span>&nbsp;<span class="ident" id="8442176">i</span><span class="op" id="8442177">,</span>&nbsp;<span class="ident" id="8442179">offs</span>&nbsp;<span class="op" id="8442184">:=</span>&nbsp;<span class="keyword" id="8442187">range</span>&nbsp;<span class="ident" id="8442193">f</span><span class="op" id="8442194">.</span><span class="ident" id="8442195">lines</span>&nbsp;<span class="op" id="8442201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442205">got1</span>&nbsp;<span class="op" id="8442210">:=</span>&nbsp;<span class="ident" id="8442213">f</span><span class="op" id="8442214">.</span><span class="ident" id="8442215">PositionFor</span><span class="op" id="8442226">(</span><span class="ident" id="8442227">f</span><span class="op" id="8442228">.</span><span class="ident" id="8442229">Pos</span><span class="op" id="8442232">(</span><span class="ident" id="8442233">offs</span><span class="op" id="8442237">)</span><span class="op" id="8442238">,</span>&nbsp;<span class="builtintype" id="8442240">false</span><span class="op" id="8442245">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442249">want</span>&nbsp;<span class="op" id="8442254">:=</span>&nbsp;<span class="ident" id="8442257">Position</span><span class="op" id="8442265">{</span><span class="ident" id="8442266">filename</span><span class="op" id="8442274">,</span>&nbsp;<span class="ident" id="8442276">offs</span><span class="op" id="8442280">,</span>&nbsp;<span class="ident" id="8442282">i</span>&nbsp;<span class="op" id="8442284">+</span>&nbsp;<span class="num" id="8442286">1</span><span class="op" id="8442287">,</span>&nbsp;<span class="num" id="8442289">1</span><span class="op" id="8442290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442294">checkPos</span><span class="op" id="8442302">(</span><span class="ident" id="8442303">t</span><span class="op" id="8442304">,</span>&nbsp;<span class="string" id="8442306">&#34;2.&nbsp;PositionFor&nbsp;unadjusted&#34;</span><span class="op" id="8442333">,</span>&nbsp;<span class="ident" id="8442335">got1</span><span class="op" id="8442339">,</span>&nbsp;<span class="ident" id="8442341">want</span><span class="op" id="8442345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8442348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8442352">//&nbsp;adjusted&nbsp;position&nbsp;info&nbsp;should&nbsp;have&nbsp;changed</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8442399">for</span>&nbsp;<span class="ident" id="8442403">i</span><span class="op" id="8442404">,</span>&nbsp;<span class="ident" id="8442406">offs</span>&nbsp;<span class="op" id="8442411">:=</span>&nbsp;<span class="keyword" id="8442414">range</span>&nbsp;<span class="ident" id="8442420">f</span><span class="op" id="8442421">.</span><span class="ident" id="8442422">lines</span>&nbsp;<span class="op" id="8442428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442432">got2</span>&nbsp;<span class="op" id="8442437">:=</span>&nbsp;<span class="ident" id="8442440">f</span><span class="op" id="8442441">.</span><span class="ident" id="8442442">PositionFor</span><span class="op" id="8442453">(</span><span class="ident" id="8442454">f</span><span class="op" id="8442455">.</span><span class="ident" id="8442456">Pos</span><span class="op" id="8442459">(</span><span class="ident" id="8442460">offs</span><span class="op" id="8442464">)</span><span class="op" id="8442465">,</span>&nbsp;<span class="builtintype" id="8442467">true</span><span class="op" id="8442471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442475">got3</span>&nbsp;<span class="op" id="8442480">:=</span>&nbsp;<span class="ident" id="8442483">f</span><span class="op" id="8442484">.</span><span class="ident" id="8442485">Position</span><span class="op" id="8442493">(</span><span class="ident" id="8442494">f</span><span class="op" id="8442495">.</span><span class="ident" id="8442496">Pos</span><span class="op" id="8442499">(</span><span class="ident" id="8442500">offs</span><span class="op" id="8442504">)</span><span class="op" id="8442505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442509">want</span>&nbsp;<span class="op" id="8442514">:=</span>&nbsp;<span class="ident" id="8442517">Position</span><span class="op" id="8442525">{</span><span class="ident" id="8442526">filename</span><span class="op" id="8442534">,</span>&nbsp;<span class="ident" id="8442536">offs</span><span class="op" id="8442540">,</span>&nbsp;<span class="ident" id="8442542">i</span>&nbsp;<span class="op" id="8442544">+</span>&nbsp;<span class="num" id="8442546">1</span><span class="op" id="8442547">,</span>&nbsp;<span class="num" id="8442549">1</span><span class="op" id="8442550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8442554">//&nbsp;manually&nbsp;compute&nbsp;wanted&nbsp;filename&nbsp;and&nbsp;line</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442601">line</span>&nbsp;<span class="op" id="8442606">:=</span>&nbsp;<span class="ident" id="8442609">want</span><span class="op" id="8442613">.</span><span class="ident" id="8442614">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8442621">if</span>&nbsp;<span class="ident" id="8442624">i</span><span class="op" id="8442625">+</span><span class="num" id="8442626">1</span>&nbsp;<span class="op" id="8442628">&gt;=</span>&nbsp;<span class="ident" id="8442631">l1</span>&nbsp;<span class="op" id="8442634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442639">want</span><span class="op" id="8442643">.</span><span class="ident" id="8442644">Filename</span>&nbsp;<span class="op" id="8442653">=</span>&nbsp;<span class="string" id="8442655">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442661">want</span><span class="op" id="8442665">.</span><span class="ident" id="8442666">Line</span>&nbsp;<span class="op" id="8442671">=</span>&nbsp;<span class="ident" id="8442673">line</span>&nbsp;<span class="op" id="8442678">-</span>&nbsp;<span class="ident" id="8442680">l1</span>&nbsp;<span class="op" id="8442683">+</span>&nbsp;<span class="num" id="8442685">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8442691">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8442695">if</span>&nbsp;<span class="ident" id="8442698">i</span><span class="op" id="8442699">+</span><span class="num" id="8442700">1</span>&nbsp;<span class="op" id="8442702">&gt;=</span>&nbsp;<span class="ident" id="8442705">l2</span>&nbsp;<span class="op" id="8442708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442713">want</span><span class="op" id="8442717">.</span><span class="ident" id="8442718">Filename</span>&nbsp;<span class="op" id="8442727">=</span>&nbsp;<span class="string" id="8442729">&#34;bar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442738">want</span><span class="op" id="8442742">.</span><span class="ident" id="8442743">Line</span>&nbsp;<span class="op" id="8442748">=</span>&nbsp;<span class="ident" id="8442750">line</span>&nbsp;<span class="op" id="8442755">-</span>&nbsp;<span class="ident" id="8442757">l2</span>&nbsp;<span class="op" id="8442760">+</span>&nbsp;<span class="num" id="8442762">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8442766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442770">checkPos</span><span class="op" id="8442778">(</span><span class="ident" id="8442779">t</span><span class="op" id="8442780">,</span>&nbsp;<span class="string" id="8442782">&#34;3.&nbsp;PositionFor&nbsp;adjusted&#34;</span><span class="op" id="8442807">,</span>&nbsp;<span class="ident" id="8442809">got2</span><span class="op" id="8442813">,</span>&nbsp;<span class="ident" id="8442815">want</span><span class="op" id="8442819">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8442823">checkPos</span><span class="op" id="8442831">(</span><span class="ident" id="8442832">t</span><span class="op" id="8442833">,</span>&nbsp;<span class="string" id="8442835">&#34;3.&nbsp;Position&#34;</span><span class="op" id="8442848">,</span>&nbsp;<span class="ident" id="8442850">got3</span><span class="op" id="8442854">,</span>&nbsp;<span class="ident" id="8442856">want</span><span class="op" id="8442860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8442863">}</span><br>
<span class="lineno"></span><span class="op" id="8442865">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
