<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html" class="current">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5697501">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5697557">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5697611">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5697662">package</span>&nbsp;<span class="ident" id="5697670">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5697677">import</span>&nbsp;<span class="op" id="5697684">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697687">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697696">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697706">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697713">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697723">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697733">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697746">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697758">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697764">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697777">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697784">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697790">pathpkg</span>&nbsp;<span class="string" id="5697798">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697806">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697823">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697834">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697842">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697853">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697864">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5697875">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5697890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5697893">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="5697952">type</span>&nbsp;<span class="ident" id="5697957">Context</span>&nbsp;<span class="keyword" id="5697965">struct</span>&nbsp;<span class="op" id="5697972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697975">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5697987">string</span>&nbsp;<span class="comment" id="5697994">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698018">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5698030">string</span>&nbsp;<span class="comment" id="5698037">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698065">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5698077">string</span>&nbsp;<span class="comment" id="5698084">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698096">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5698108">string</span>&nbsp;<span class="comment" id="5698115">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698127">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="5698139">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5698146">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698174">UseAllFiles</span>&nbsp;<span class="builtintype" id="5698186">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5698193">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698246">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5698258">string</span>&nbsp;<span class="comment" id="5698265">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698317">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698374">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698444">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698510">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698586">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698672">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698740">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698802">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5698814">[</span><span class="op" id="5698815">]</span><span class="builtintype" id="5698816">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698824">ReleaseTags</span>&nbsp;<span class="op" id="5698836">[</span><span class="op" id="5698837">]</span><span class="builtintype" id="5698838">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698847">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5698928">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699003">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699080">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699156">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699230">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699285">InstallSuffix</span>&nbsp;<span class="builtintype" id="5699299">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699308">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699377">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699441">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699509">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699580">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699636">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699706">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699757">JoinPath</span>&nbsp;<span class="keyword" id="5699766">func</span><span class="op" id="5699770">(</span><span class="ident" id="5699771">elem</span>&nbsp;<span class="op" id="5699776">...</span><span class="builtintype" id="5699779">string</span><span class="op" id="5699785">)</span>&nbsp;<span class="builtintype" id="5699787">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699796">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699869">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699930">SplitPathList</span>&nbsp;<span class="keyword" id="5699944">func</span><span class="op" id="5699948">(</span><span class="ident" id="5699949">list</span>&nbsp;<span class="builtintype" id="5699954">string</span><span class="op" id="5699960">)</span>&nbsp;<span class="op" id="5699962">[</span><span class="op" id="5699963">]</span><span class="builtintype" id="5699964">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5699973">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700029">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700082">IsAbsPath</span>&nbsp;<span class="keyword" id="5700092">func</span><span class="op" id="5700096">(</span><span class="ident" id="5700097">path</span>&nbsp;<span class="builtintype" id="5700102">string</span><span class="op" id="5700108">)</span>&nbsp;<span class="builtintype" id="5700110">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700117">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700171">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700249">IsDir</span>&nbsp;<span class="keyword" id="5700255">func</span><span class="op" id="5700259">(</span><span class="ident" id="5700260">path</span>&nbsp;<span class="builtintype" id="5700265">string</span><span class="op" id="5700271">)</span>&nbsp;<span class="builtintype" id="5700273">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700280">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700335">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700377">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700438">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700501">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700565">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700592">HasSubdir</span>&nbsp;<span class="keyword" id="5700602">func</span><span class="op" id="5700606">(</span><span class="ident" id="5700607">root</span><span class="op" id="5700611">,</span>&nbsp;<span class="ident" id="5700613">dir</span>&nbsp;<span class="builtintype" id="5700617">string</span><span class="op" id="5700623">)</span>&nbsp;<span class="op" id="5700625">(</span><span class="ident" id="5700626">rel</span>&nbsp;<span class="builtintype" id="5700630">string</span><span class="op" id="5700636">,</span>&nbsp;<span class="ident" id="5700638">ok</span>&nbsp;<span class="builtintype" id="5700641">bool</span><span class="op" id="5700645">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700649">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700709">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700760">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700811">ReadDir</span>&nbsp;<span class="keyword" id="5700819">func</span><span class="op" id="5700823">(</span><span class="ident" id="5700824">dir</span>&nbsp;<span class="builtintype" id="5700828">string</span><span class="op" id="5700834">)</span>&nbsp;<span class="op" id="5700836">(</span><span class="ident" id="5700837">fi</span>&nbsp;<span class="op" id="5700840">[</span><span class="op" id="5700841">]</span><span class="ident" id="5700842">os</span><span class="op" id="5700844">.</span><span class="ident" id="5700845">FileInfo</span><span class="op" id="5700853">,</span>&nbsp;<span class="ident" id="5700855">err</span>&nbsp;<span class="builtintype" id="5700859">error</span><span class="op" id="5700864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700868">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5700925">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700970">OpenFile</span>&nbsp;<span class="keyword" id="5700979">func</span><span class="op" id="5700983">(</span><span class="ident" id="5700984">path</span>&nbsp;<span class="builtintype" id="5700989">string</span><span class="op" id="5700995">)</span>&nbsp;<span class="op" id="5700997">(</span><span class="ident" id="5700998">r</span>&nbsp;<span class="ident" id="5701000">io</span><span class="op" id="5701002">.</span><span class="ident" id="5701003">ReadCloser</span><span class="op" id="5701013">,</span>&nbsp;<span class="ident" id="5701015">err</span>&nbsp;<span class="builtintype" id="5701019">error</span><span class="op" id="5701024">)</span><br>
<span class="lineno">95</span><span class="op" id="5701026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5701029">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="5701097">func</span>&nbsp;<span class="op" id="5701102">(</span><span class="ident" id="5701103">ctxt</span>&nbsp;<span class="op" id="5701108">*</span><span class="ident" id="5701109">Context</span><span class="op" id="5701116">)</span>&nbsp;<span class="ident" id="5701118">joinPath</span><span class="op" id="5701126">(</span><span class="ident" id="5701127">elem</span>&nbsp;<span class="op" id="5701132">...</span><span class="builtintype" id="5701135">string</span><span class="op" id="5701141">)</span>&nbsp;<span class="builtintype" id="5701143">string</span>&nbsp;<span class="op" id="5701150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701153">if</span>&nbsp;<span class="ident" id="5701156">f</span>&nbsp;<span class="op" id="5701158">:=</span>&nbsp;<span class="ident" id="5701161">ctxt</span><span class="op" id="5701165">.</span><span class="ident" id="5701166">JoinPath</span><span class="op" id="5701174">;</span>&nbsp;<span class="ident" id="5701176">f</span>&nbsp;<span class="op" id="5701178">!=</span>&nbsp;<span class="builtintype" id="5701181">nil</span>&nbsp;<span class="op" id="5701185">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701189">return</span>&nbsp;<span class="ident" id="5701196">f</span><span class="op" id="5701197">(</span><span class="ident" id="5701198">elem</span><span class="op" id="5701202">...</span><span class="op" id="5701205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701211">return</span>&nbsp;<span class="ident" id="5701218">filepath</span><span class="op" id="5701226">.</span><span class="ident" id="5701227">Join</span><span class="op" id="5701231">(</span><span class="ident" id="5701232">elem</span><span class="op" id="5701236">...</span><span class="op" id="5701239">)</span><br>
<span class="lineno"></span><span class="op" id="5701241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5701244">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="5701327">func</span>&nbsp;<span class="op" id="5701332">(</span><span class="ident" id="5701333">ctxt</span>&nbsp;<span class="op" id="5701338">*</span><span class="ident" id="5701339">Context</span><span class="op" id="5701346">)</span>&nbsp;<span class="ident" id="5701348">splitPathList</span><span class="op" id="5701361">(</span><span class="ident" id="5701362">s</span>&nbsp;<span class="builtintype" id="5701364">string</span><span class="op" id="5701370">)</span>&nbsp;<span class="op" id="5701372">[</span><span class="op" id="5701373">]</span><span class="builtintype" id="5701374">string</span>&nbsp;<span class="op" id="5701381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701384">if</span>&nbsp;<span class="ident" id="5701387">f</span>&nbsp;<span class="op" id="5701389">:=</span>&nbsp;<span class="ident" id="5701392">ctxt</span><span class="op" id="5701396">.</span><span class="ident" id="5701397">SplitPathList</span><span class="op" id="5701410">;</span>&nbsp;<span class="ident" id="5701412">f</span>&nbsp;<span class="op" id="5701414">!=</span>&nbsp;<span class="builtintype" id="5701417">nil</span>&nbsp;<span class="op" id="5701421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701425">return</span>&nbsp;<span class="ident" id="5701432">f</span><span class="op" id="5701433">(</span><span class="ident" id="5701434">s</span><span class="op" id="5701435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701438">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701441">return</span>&nbsp;<span class="ident" id="5701448">filepath</span><span class="op" id="5701456">.</span><span class="ident" id="5701457">SplitList</span><span class="op" id="5701466">(</span><span class="ident" id="5701467">s</span><span class="op" id="5701468">)</span><br>
<span class="lineno"></span><span class="op" id="5701470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5701473">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="5701545">func</span>&nbsp;<span class="op" id="5701550">(</span><span class="ident" id="5701551">ctxt</span>&nbsp;<span class="op" id="5701556">*</span><span class="ident" id="5701557">Context</span><span class="op" id="5701564">)</span>&nbsp;<span class="ident" id="5701566">isAbsPath</span><span class="op" id="5701575">(</span><span class="ident" id="5701576">path</span>&nbsp;<span class="builtintype" id="5701581">string</span><span class="op" id="5701587">)</span>&nbsp;<span class="builtintype" id="5701589">bool</span>&nbsp;<span class="op" id="5701594">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701597">if</span>&nbsp;<span class="ident" id="5701600">f</span>&nbsp;<span class="op" id="5701602">:=</span>&nbsp;<span class="ident" id="5701605">ctxt</span><span class="op" id="5701609">.</span><span class="ident" id="5701610">IsAbsPath</span><span class="op" id="5701619">;</span>&nbsp;<span class="ident" id="5701621">f</span>&nbsp;<span class="op" id="5701623">!=</span>&nbsp;<span class="builtintype" id="5701626">nil</span>&nbsp;<span class="op" id="5701630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701634">return</span>&nbsp;<span class="ident" id="5701641">f</span><span class="op" id="5701642">(</span><span class="ident" id="5701643">path</span><span class="op" id="5701647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701653">return</span>&nbsp;<span class="ident" id="5701660">filepath</span><span class="op" id="5701668">.</span><span class="ident" id="5701669">IsAbs</span><span class="op" id="5701674">(</span><span class="ident" id="5701675">path</span><span class="op" id="5701679">)</span><br>
<span class="lineno"></span><span class="op" id="5701681">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="5701684">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="5701745">func</span>&nbsp;<span class="op" id="5701750">(</span><span class="ident" id="5701751">ctxt</span>&nbsp;<span class="op" id="5701756">*</span><span class="ident" id="5701757">Context</span><span class="op" id="5701764">)</span>&nbsp;<span class="ident" id="5701766">isDir</span><span class="op" id="5701771">(</span><span class="ident" id="5701772">path</span>&nbsp;<span class="builtintype" id="5701777">string</span><span class="op" id="5701783">)</span>&nbsp;<span class="builtintype" id="5701785">bool</span>&nbsp;<span class="op" id="5701790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701793">if</span>&nbsp;<span class="ident" id="5701796">f</span>&nbsp;<span class="op" id="5701798">:=</span>&nbsp;<span class="ident" id="5701801">ctxt</span><span class="op" id="5701805">.</span><span class="ident" id="5701806">IsDir</span><span class="op" id="5701811">;</span>&nbsp;<span class="ident" id="5701813">f</span>&nbsp;<span class="op" id="5701815">!=</span>&nbsp;<span class="builtintype" id="5701818">nil</span>&nbsp;<span class="op" id="5701822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701826">return</span>&nbsp;<span class="ident" id="5701833">f</span><span class="op" id="5701834">(</span><span class="ident" id="5701835">path</span><span class="op" id="5701839">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701845">fi</span><span class="op" id="5701847">,</span>&nbsp;<span class="ident" id="5701849">err</span>&nbsp;<span class="op" id="5701853">:=</span>&nbsp;<span class="ident" id="5701856">os</span><span class="op" id="5701858">.</span><span class="ident" id="5701859">Stat</span><span class="op" id="5701863">(</span><span class="ident" id="5701864">path</span><span class="op" id="5701868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701871">return</span>&nbsp;<span class="ident" id="5701878">err</span>&nbsp;<span class="op" id="5701882">==</span>&nbsp;<span class="builtintype" id="5701885">nil</span>&nbsp;<span class="op" id="5701889">&amp;&amp;</span>&nbsp;<span class="ident" id="5701892">fi</span><span class="op" id="5701894">.</span><span class="ident" id="5701895">IsDir</span><span class="op" id="5701900">(</span><span class="op" id="5701901">)</span><br>
<span class="lineno"></span><span class="op" id="5701903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5701906">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5701966">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="5702015">func</span>&nbsp;<span class="op" id="5702020">(</span><span class="ident" id="5702021">ctxt</span>&nbsp;<span class="op" id="5702026">*</span><span class="ident" id="5702027">Context</span><span class="op" id="5702034">)</span>&nbsp;<span class="ident" id="5702036">hasSubdir</span><span class="op" id="5702045">(</span><span class="ident" id="5702046">root</span><span class="op" id="5702050">,</span>&nbsp;<span class="ident" id="5702052">dir</span>&nbsp;<span class="builtintype" id="5702056">string</span><span class="op" id="5702062">)</span>&nbsp;<span class="op" id="5702064">(</span><span class="ident" id="5702065">rel</span>&nbsp;<span class="builtintype" id="5702069">string</span><span class="op" id="5702075">,</span>&nbsp;<span class="ident" id="5702077">ok</span>&nbsp;<span class="builtintype" id="5702080">bool</span><span class="op" id="5702084">)</span>&nbsp;<span class="op" id="5702086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702089">if</span>&nbsp;<span class="ident" id="5702092">f</span>&nbsp;<span class="op" id="5702094">:=</span>&nbsp;<span class="ident" id="5702097">ctxt</span><span class="op" id="5702101">.</span><span class="ident" id="5702102">HasSubdir</span><span class="op" id="5702111">;</span>&nbsp;<span class="ident" id="5702113">f</span>&nbsp;<span class="op" id="5702115">!=</span>&nbsp;<span class="builtintype" id="5702118">nil</span>&nbsp;<span class="op" id="5702122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702126">return</span>&nbsp;<span class="ident" id="5702133">f</span><span class="op" id="5702134">(</span><span class="ident" id="5702135">root</span><span class="op" id="5702139">,</span>&nbsp;<span class="ident" id="5702141">dir</span><span class="op" id="5702144">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702151">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702184">if</span>&nbsp;<span class="ident" id="5702187">rel</span><span class="op" id="5702190">,</span>&nbsp;<span class="ident" id="5702192">ok</span>&nbsp;<span class="op" id="5702195">=</span>&nbsp;<span class="ident" id="5702197">hasSubdir</span><span class="op" id="5702206">(</span><span class="ident" id="5702207">root</span><span class="op" id="5702211">,</span>&nbsp;<span class="ident" id="5702213">dir</span><span class="op" id="5702216">)</span><span class="op" id="5702217">;</span>&nbsp;<span class="ident" id="5702219">ok</span>&nbsp;<span class="op" id="5702222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702226">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702238">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702279">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702315">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702346">rootSym</span><span class="op" id="5702353">,</span>&nbsp;<span class="ident" id="5702355">_</span>&nbsp;<span class="op" id="5702357">:=</span>&nbsp;<span class="ident" id="5702360">filepath</span><span class="op" id="5702368">.</span><span class="ident" id="5702369">EvalSymlinks</span><span class="op" id="5702381">(</span><span class="ident" id="5702382">root</span><span class="op" id="5702386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702389">dirSym</span><span class="op" id="5702395">,</span>&nbsp;<span class="ident" id="5702397">_</span>&nbsp;<span class="op" id="5702399">:=</span>&nbsp;<span class="ident" id="5702402">filepath</span><span class="op" id="5702410">.</span><span class="ident" id="5702411">EvalSymlinks</span><span class="op" id="5702423">(</span><span class="ident" id="5702424">dir</span><span class="op" id="5702427">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702431">if</span>&nbsp;<span class="ident" id="5702434">rel</span><span class="op" id="5702437">,</span>&nbsp;<span class="ident" id="5702439">ok</span>&nbsp;<span class="op" id="5702442">=</span>&nbsp;<span class="ident" id="5702444">hasSubdir</span><span class="op" id="5702453">(</span><span class="ident" id="5702454">rootSym</span><span class="op" id="5702461">,</span>&nbsp;<span class="ident" id="5702463">dir</span><span class="op" id="5702466">)</span><span class="op" id="5702467">;</span>&nbsp;<span class="ident" id="5702469">ok</span>&nbsp;<span class="op" id="5702472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702476">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702487">if</span>&nbsp;<span class="ident" id="5702490">rel</span><span class="op" id="5702493">,</span>&nbsp;<span class="ident" id="5702495">ok</span>&nbsp;<span class="op" id="5702498">=</span>&nbsp;<span class="ident" id="5702500">hasSubdir</span><span class="op" id="5702509">(</span><span class="ident" id="5702510">root</span><span class="op" id="5702514">,</span>&nbsp;<span class="ident" id="5702516">dirSym</span><span class="op" id="5702522">)</span><span class="op" id="5702523">;</span>&nbsp;<span class="ident" id="5702525">ok</span>&nbsp;<span class="op" id="5702528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702543">return</span>&nbsp;<span class="ident" id="5702550">hasSubdir</span><span class="op" id="5702559">(</span><span class="ident" id="5702560">rootSym</span><span class="op" id="5702567">,</span>&nbsp;<span class="ident" id="5702569">dirSym</span><span class="op" id="5702575">)</span><br>
<span class="lineno">155</span><span class="op" id="5702577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5702580">func</span>&nbsp;<span class="ident" id="5702585">hasSubdir</span><span class="op" id="5702594">(</span><span class="ident" id="5702595">root</span><span class="op" id="5702599">,</span>&nbsp;<span class="ident" id="5702601">dir</span>&nbsp;<span class="builtintype" id="5702605">string</span><span class="op" id="5702611">)</span>&nbsp;<span class="op" id="5702613">(</span><span class="ident" id="5702614">rel</span>&nbsp;<span class="builtintype" id="5702618">string</span><span class="op" id="5702624">,</span>&nbsp;<span class="ident" id="5702626">ok</span>&nbsp;<span class="builtintype" id="5702629">bool</span><span class="op" id="5702633">)</span>&nbsp;<span class="op" id="5702635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702638">const</span>&nbsp;<span class="ident" id="5702644">sep</span>&nbsp;<span class="op" id="5702648">=</span>&nbsp;<span class="builtintype" id="5702650">string</span><span class="op" id="5702656">(</span><span class="ident" id="5702657">filepath</span><span class="op" id="5702665">.</span><span class="ident" id="5702666">Separator</span><span class="op" id="5702675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702678">root</span>&nbsp;<span class="op" id="5702683">=</span>&nbsp;<span class="ident" id="5702685">filepath</span><span class="op" id="5702693">.</span><span class="ident" id="5702694">Clean</span><span class="op" id="5702699">(</span><span class="ident" id="5702700">root</span><span class="op" id="5702704">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702707">if</span>&nbsp;<span class="op" id="5702710">!</span><span class="ident" id="5702711">strings</span><span class="op" id="5702718">.</span><span class="ident" id="5702719">HasSuffix</span><span class="op" id="5702728">(</span><span class="ident" id="5702729">root</span><span class="op" id="5702733">,</span>&nbsp;<span class="ident" id="5702735">sep</span><span class="op" id="5702738">)</span>&nbsp;<span class="op" id="5702740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702744">root</span>&nbsp;<span class="op" id="5702749">+=</span>&nbsp;<span class="ident" id="5702752">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702760">dir</span>&nbsp;<span class="op" id="5702764">=</span>&nbsp;<span class="ident" id="5702766">filepath</span><span class="op" id="5702774">.</span><span class="ident" id="5702775">Clean</span><span class="op" id="5702780">(</span><span class="ident" id="5702781">dir</span><span class="op" id="5702784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702787">if</span>&nbsp;<span class="op" id="5702790">!</span><span class="ident" id="5702791">strings</span><span class="op" id="5702798">.</span><span class="ident" id="5702799">HasPrefix</span><span class="op" id="5702808">(</span><span class="ident" id="5702809">dir</span><span class="op" id="5702812">,</span>&nbsp;<span class="ident" id="5702814">root</span><span class="op" id="5702818">)</span>&nbsp;<span class="op" id="5702820">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702824">return</span>&nbsp;<span class="string" id="5702831">&#34;&#34;</span><span class="op" id="5702833">,</span>&nbsp;<span class="builtintype" id="5702835">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702845">return</span>&nbsp;<span class="ident" id="5702852">filepath</span><span class="op" id="5702860">.</span><span class="ident" id="5702861">ToSlash</span><span class="op" id="5702868">(</span><span class="ident" id="5702869">dir</span><span class="op" id="5702872">[</span><span class="builtinfunc" id="5702873">len</span><span class="op" id="5702876">(</span><span class="ident" id="5702877">root</span><span class="op" id="5702881">)</span><span class="op" id="5702882">:</span><span class="op" id="5702883">]</span><span class="op" id="5702884">)</span><span class="op" id="5702885">,</span>&nbsp;<span class="builtintype" id="5702887">true</span><br>
<span class="lineno"></span><span class="op" id="5702892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="5702895">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5702962">func</span>&nbsp;<span class="op" id="5702967">(</span><span class="ident" id="5702968">ctxt</span>&nbsp;<span class="op" id="5702973">*</span><span class="ident" id="5702974">Context</span><span class="op" id="5702981">)</span>&nbsp;<span class="ident" id="5702983">readDir</span><span class="op" id="5702990">(</span><span class="ident" id="5702991">path</span>&nbsp;<span class="builtintype" id="5702996">string</span><span class="op" id="5703002">)</span>&nbsp;<span class="op" id="5703004">(</span><span class="op" id="5703005">[</span><span class="op" id="5703006">]</span><span class="ident" id="5703007">os</span><span class="op" id="5703009">.</span><span class="ident" id="5703010">FileInfo</span><span class="op" id="5703018">,</span>&nbsp;<span class="builtintype" id="5703020">error</span><span class="op" id="5703025">)</span>&nbsp;<span class="op" id="5703027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703030">if</span>&nbsp;<span class="ident" id="5703033">f</span>&nbsp;<span class="op" id="5703035">:=</span>&nbsp;<span class="ident" id="5703038">ctxt</span><span class="op" id="5703042">.</span><span class="ident" id="5703043">ReadDir</span><span class="op" id="5703050">;</span>&nbsp;<span class="ident" id="5703052">f</span>&nbsp;<span class="op" id="5703054">!=</span>&nbsp;<span class="builtintype" id="5703057">nil</span>&nbsp;<span class="op" id="5703061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703065">return</span>&nbsp;<span class="ident" id="5703072">f</span><span class="op" id="5703073">(</span><span class="ident" id="5703074">path</span><span class="op" id="5703078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703081">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703084">return</span>&nbsp;<span class="ident" id="5703091">ioutil</span><span class="op" id="5703097">.</span><span class="ident" id="5703098">ReadDir</span><span class="op" id="5703105">(</span><span class="ident" id="5703106">path</span><span class="op" id="5703110">)</span><br>
<span class="lineno"></span><span class="op" id="5703112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5703115">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="5703177">func</span>&nbsp;<span class="op" id="5703182">(</span><span class="ident" id="5703183">ctxt</span>&nbsp;<span class="op" id="5703188">*</span><span class="ident" id="5703189">Context</span><span class="op" id="5703196">)</span>&nbsp;<span class="ident" id="5703198">openFile</span><span class="op" id="5703206">(</span><span class="ident" id="5703207">path</span>&nbsp;<span class="builtintype" id="5703212">string</span><span class="op" id="5703218">)</span>&nbsp;<span class="op" id="5703220">(</span><span class="ident" id="5703221">io</span><span class="op" id="5703223">.</span><span class="ident" id="5703224">ReadCloser</span><span class="op" id="5703234">,</span>&nbsp;<span class="builtintype" id="5703236">error</span><span class="op" id="5703241">)</span>&nbsp;<span class="op" id="5703243">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703246">if</span>&nbsp;<span class="ident" id="5703249">fn</span>&nbsp;<span class="op" id="5703252">:=</span>&nbsp;<span class="ident" id="5703255">ctxt</span><span class="op" id="5703259">.</span><span class="ident" id="5703260">OpenFile</span><span class="op" id="5703268">;</span>&nbsp;<span class="ident" id="5703270">fn</span>&nbsp;<span class="op" id="5703273">!=</span>&nbsp;<span class="builtintype" id="5703276">nil</span>&nbsp;<span class="op" id="5703280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703284">return</span>&nbsp;<span class="ident" id="5703291">fn</span><span class="op" id="5703293">(</span><span class="ident" id="5703294">path</span><span class="op" id="5703298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703305">f</span><span class="op" id="5703306">,</span>&nbsp;<span class="ident" id="5703308">err</span>&nbsp;<span class="op" id="5703312">:=</span>&nbsp;<span class="ident" id="5703315">os</span><span class="op" id="5703317">.</span><span class="ident" id="5703318">Open</span><span class="op" id="5703322">(</span><span class="ident" id="5703323">path</span><span class="op" id="5703327">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703330">if</span>&nbsp;<span class="ident" id="5703333">err</span>&nbsp;<span class="op" id="5703337">!=</span>&nbsp;<span class="builtintype" id="5703340">nil</span>&nbsp;<span class="op" id="5703344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703348">return</span>&nbsp;<span class="builtintype" id="5703355">nil</span><span class="op" id="5703358">,</span>&nbsp;<span class="ident" id="5703360">err</span>&nbsp;<span class="comment" id="5703364">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703385">return</span>&nbsp;<span class="ident" id="5703392">f</span><span class="op" id="5703393">,</span>&nbsp;<span class="builtintype" id="5703395">nil</span><br>
<span class="lineno"></span><span class="op" id="5703399">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5703402">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5703468">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5703532">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="5703552">func</span>&nbsp;<span class="op" id="5703557">(</span><span class="ident" id="5703558">ctxt</span>&nbsp;<span class="op" id="5703563">*</span><span class="ident" id="5703564">Context</span><span class="op" id="5703571">)</span>&nbsp;<span class="ident" id="5703573">isFile</span><span class="op" id="5703579">(</span><span class="ident" id="5703580">path</span>&nbsp;<span class="builtintype" id="5703585">string</span><span class="op" id="5703591">)</span>&nbsp;<span class="builtintype" id="5703593">bool</span>&nbsp;<span class="op" id="5703598">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703601">f</span><span class="op" id="5703602">,</span>&nbsp;<span class="ident" id="5703604">err</span>&nbsp;<span class="op" id="5703608">:=</span>&nbsp;<span class="ident" id="5703611">ctxt</span><span class="op" id="5703615">.</span><span class="ident" id="5703616">openFile</span><span class="op" id="5703624">(</span><span class="ident" id="5703625">path</span><span class="op" id="5703629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703632">if</span>&nbsp;<span class="ident" id="5703635">err</span>&nbsp;<span class="op" id="5703639">!=</span>&nbsp;<span class="builtintype" id="5703642">nil</span>&nbsp;<span class="op" id="5703646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703650">return</span>&nbsp;<span class="builtintype" id="5703657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703667">f</span><span class="op" id="5703668">.</span><span class="ident" id="5703669">Close</span><span class="op" id="5703674">(</span><span class="op" id="5703675">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703678">return</span>&nbsp;<span class="builtintype" id="5703685">true</span><br>
<span class="lineno"></span><span class="op" id="5703690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5703693">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="5703744">func</span>&nbsp;<span class="op" id="5703749">(</span><span class="ident" id="5703750">ctxt</span>&nbsp;<span class="op" id="5703755">*</span><span class="ident" id="5703756">Context</span><span class="op" id="5703763">)</span>&nbsp;<span class="ident" id="5703765">gopath</span><span class="op" id="5703771">(</span><span class="op" id="5703772">)</span>&nbsp;<span class="op" id="5703774">[</span><span class="op" id="5703775">]</span><span class="builtintype" id="5703776">string</span>&nbsp;<span class="op" id="5703783">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703786">var</span>&nbsp;<span class="ident" id="5703790">all</span>&nbsp;<span class="op" id="5703794">[</span><span class="op" id="5703795">]</span><span class="builtintype" id="5703796">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703804">for</span>&nbsp;<span class="ident" id="5703808">_</span><span class="op" id="5703809">,</span>&nbsp;<span class="ident" id="5703811">p</span>&nbsp;<span class="op" id="5703813">:=</span>&nbsp;<span class="keyword" id="5703816">range</span>&nbsp;<span class="ident" id="5703822">ctxt</span><span class="op" id="5703826">.</span><span class="ident" id="5703827">splitPathList</span><span class="op" id="5703840">(</span><span class="ident" id="5703841">ctxt</span><span class="op" id="5703845">.</span><span class="ident" id="5703846">GOPATH</span><span class="op" id="5703852">)</span>&nbsp;<span class="op" id="5703854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703858">if</span>&nbsp;<span class="ident" id="5703861">p</span>&nbsp;<span class="op" id="5703863">==</span>&nbsp;<span class="string" id="5703866">&#34;&#34;</span>&nbsp;<span class="op" id="5703869">||</span>&nbsp;<span class="ident" id="5703872">p</span>&nbsp;<span class="op" id="5703874">==</span>&nbsp;<span class="ident" id="5703877">ctxt</span><span class="op" id="5703881">.</span><span class="ident" id="5703882">GOROOT</span>&nbsp;<span class="op" id="5703889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703894">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703931">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703975">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704018">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704068">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5704079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704083">if</span>&nbsp;<span class="ident" id="5704086">strings</span><span class="op" id="5704093">.</span><span class="ident" id="5704094">HasPrefix</span><span class="op" id="5704103">(</span><span class="ident" id="5704104">p</span><span class="op" id="5704105">,</span>&nbsp;<span class="string" id="5704107">&#34;~&#34;</span><span class="op" id="5704110">)</span>&nbsp;<span class="op" id="5704112">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704117">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704179">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704243">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704288">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704348">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704406">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704473">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704536">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704602">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704661">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704681">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704745">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704773">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5704784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5704788">all</span>&nbsp;<span class="op" id="5704792">=</span>&nbsp;<span class="builtinfunc" id="5704794">append</span><span class="op" id="5704800">(</span><span class="ident" id="5704801">all</span><span class="op" id="5704804">,</span>&nbsp;<span class="ident" id="5704806">p</span><span class="op" id="5704807">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5704810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704813">return</span>&nbsp;<span class="ident" id="5704820">all</span><br>
<span class="lineno"></span><span class="op" id="5704824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5704827">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="5704889">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="5704960">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="5704982">func</span>&nbsp;<span class="op" id="5704987">(</span><span class="ident" id="5704988">ctxt</span>&nbsp;<span class="op" id="5704993">*</span><span class="ident" id="5704994">Context</span><span class="op" id="5705001">)</span>&nbsp;<span class="ident" id="5705003">SrcDirs</span><span class="op" id="5705010">(</span><span class="op" id="5705011">)</span>&nbsp;<span class="op" id="5705013">[</span><span class="op" id="5705014">]</span><span class="builtintype" id="5705015">string</span>&nbsp;<span class="op" id="5705022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705025">var</span>&nbsp;<span class="ident" id="5705029">all</span>&nbsp;<span class="op" id="5705033">[</span><span class="op" id="5705034">]</span><span class="builtintype" id="5705035">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705043">if</span>&nbsp;<span class="ident" id="5705046">ctxt</span><span class="op" id="5705050">.</span><span class="ident" id="5705051">GOROOT</span>&nbsp;<span class="op" id="5705058">!=</span>&nbsp;<span class="string" id="5705061">&#34;&#34;</span>&nbsp;<span class="op" id="5705064">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5705068">dir</span>&nbsp;<span class="op" id="5705072">:=</span>&nbsp;<span class="ident" id="5705075">ctxt</span><span class="op" id="5705079">.</span><span class="ident" id="5705080">joinPath</span><span class="op" id="5705088">(</span><span class="ident" id="5705089">ctxt</span><span class="op" id="5705093">.</span><span class="ident" id="5705094">GOROOT</span><span class="op" id="5705100">,</span>&nbsp;<span class="string" id="5705102">&#34;src&#34;</span><span class="op" id="5705107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705111">if</span>&nbsp;<span class="ident" id="5705114">ctxt</span><span class="op" id="5705118">.</span><span class="ident" id="5705119">isDir</span><span class="op" id="5705124">(</span><span class="ident" id="5705125">dir</span><span class="op" id="5705128">)</span>&nbsp;<span class="op" id="5705130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5705135">all</span>&nbsp;<span class="op" id="5705139">=</span>&nbsp;<span class="builtinfunc" id="5705141">append</span><span class="op" id="5705147">(</span><span class="ident" id="5705148">all</span><span class="op" id="5705151">,</span>&nbsp;<span class="ident" id="5705153">dir</span><span class="op" id="5705156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705163">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705166">for</span>&nbsp;<span class="ident" id="5705170">_</span><span class="op" id="5705171">,</span>&nbsp;<span class="ident" id="5705173">p</span>&nbsp;<span class="op" id="5705175">:=</span>&nbsp;<span class="keyword" id="5705178">range</span>&nbsp;<span class="ident" id="5705184">ctxt</span><span class="op" id="5705188">.</span><span class="ident" id="5705189">gopath</span><span class="op" id="5705195">(</span><span class="op" id="5705196">)</span>&nbsp;<span class="op" id="5705198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5705202">dir</span>&nbsp;<span class="op" id="5705206">:=</span>&nbsp;<span class="ident" id="5705209">ctxt</span><span class="op" id="5705213">.</span><span class="ident" id="5705214">joinPath</span><span class="op" id="5705222">(</span><span class="ident" id="5705223">p</span><span class="op" id="5705224">,</span>&nbsp;<span class="string" id="5705226">&#34;src&#34;</span><span class="op" id="5705231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705235">if</span>&nbsp;<span class="ident" id="5705238">ctxt</span><span class="op" id="5705242">.</span><span class="ident" id="5705243">isDir</span><span class="op" id="5705248">(</span><span class="ident" id="5705249">dir</span><span class="op" id="5705252">)</span>&nbsp;<span class="op" id="5705254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5705259">all</span>&nbsp;<span class="op" id="5705263">=</span>&nbsp;<span class="builtinfunc" id="5705265">append</span><span class="op" id="5705271">(</span><span class="ident" id="5705272">all</span><span class="op" id="5705275">,</span>&nbsp;<span class="ident" id="5705277">dir</span><span class="op" id="5705280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705284">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5705287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5705290">return</span>&nbsp;<span class="ident" id="5705297">all</span><br>
<span class="lineno"></span><span class="op" id="5705301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5705304">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="5705350">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="5705420">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="5705485">var</span>&nbsp;<span class="ident" id="5705489">Default</span>&nbsp;<span class="ident" id="5705497">Context</span>&nbsp;<span class="op" id="5705505">=</span>&nbsp;<span class="ident" id="5705507">defaultContext</span><span class="op" id="5705521">(</span><span class="op" id="5705522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5705525">var</span>&nbsp;<span class="ident" id="5705529">cgoEnabled</span>&nbsp;<span class="op" id="5705540">=</span>&nbsp;<span class="keyword" id="5705542">map</span><span class="op" id="5705545">[</span><span class="builtintype" id="5705546">string</span><span class="op" id="5705552">]</span><span class="builtintype" id="5705553">bool</span><span class="op" id="5705557">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705560">&#34;darwin/386&#34;</span><span class="op" id="5705572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705579">true</span><span class="op" id="5705583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705586">&#34;darwin/amd64&#34;</span><span class="op" id="5705600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705605">true</span><span class="op" id="5705609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705612">&#34;dragonfly/386&#34;</span><span class="op" id="5705627">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705631">true</span><span class="op" id="5705635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705638">&#34;dragonfly/amd64&#34;</span><span class="op" id="5705655">:</span>&nbsp;<span class="builtintype" id="5705657">true</span><span class="op" id="5705661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705664">&#34;freebsd/386&#34;</span><span class="op" id="5705677">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705683">true</span><span class="op" id="5705687">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705690">&#34;freebsd/amd64&#34;</span><span class="op" id="5705705">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705709">true</span><span class="op" id="5705713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705716">&#34;freebsd/arm&#34;</span><span class="op" id="5705729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705735">true</span><span class="op" id="5705739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705742">&#34;linux/386&#34;</span><span class="op" id="5705753">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705761">true</span><span class="op" id="5705765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705768">&#34;linux/amd64&#34;</span><span class="op" id="5705781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705787">true</span><span class="op" id="5705791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705794">&#34;linux/arm&#34;</span><span class="op" id="5705805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705813">true</span><span class="op" id="5705817">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705820">&#34;android/386&#34;</span><span class="op" id="5705833">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705839">true</span><span class="op" id="5705843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705846">&#34;android/amd64&#34;</span><span class="op" id="5705861">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705865">true</span><span class="op" id="5705869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705872">&#34;android/arm&#34;</span><span class="op" id="5705885">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705891">true</span><span class="op" id="5705895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705898">&#34;netbsd/386&#34;</span><span class="op" id="5705910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705917">true</span><span class="op" id="5705921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705924">&#34;netbsd/amd64&#34;</span><span class="op" id="5705938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705943">true</span><span class="op" id="5705947">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705950">&#34;netbsd/arm&#34;</span><span class="op" id="5705962">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705969">true</span><span class="op" id="5705973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5705976">&#34;openbsd/386&#34;</span><span class="op" id="5705989">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5705995">true</span><span class="op" id="5705999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5706002">&#34;openbsd/amd64&#34;</span><span class="op" id="5706017">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5706021">true</span><span class="op" id="5706025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5706028">&#34;windows/386&#34;</span><span class="op" id="5706041">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5706047">true</span><span class="op" id="5706051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5706054">&#34;windows/amd64&#34;</span><span class="op" id="5706069">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5706073">true</span><span class="op" id="5706077">,</span><br>
<span class="lineno">280</span><span class="op" id="5706079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5706082">func</span>&nbsp;<span class="ident" id="5706087">defaultContext</span><span class="op" id="5706101">(</span><span class="op" id="5706102">)</span>&nbsp;<span class="ident" id="5706104">Context</span>&nbsp;<span class="op" id="5706112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5706115">var</span>&nbsp;<span class="ident" id="5706119">c</span>&nbsp;<span class="ident" id="5706121">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706131">c</span><span class="op" id="5706132">.</span><span class="ident" id="5706133">GOARCH</span>&nbsp;<span class="op" id="5706140">=</span>&nbsp;<span class="ident" id="5706142">envOr</span><span class="op" id="5706147">(</span><span class="string" id="5706148">&#34;GOARCH&#34;</span><span class="op" id="5706156">,</span>&nbsp;<span class="ident" id="5706158">runtime</span><span class="op" id="5706165">.</span><span class="ident" id="5706166">GOARCH</span><span class="op" id="5706172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706175">c</span><span class="op" id="5706176">.</span><span class="ident" id="5706177">GOOS</span>&nbsp;<span class="op" id="5706182">=</span>&nbsp;<span class="ident" id="5706184">envOr</span><span class="op" id="5706189">(</span><span class="string" id="5706190">&#34;GOOS&#34;</span><span class="op" id="5706196">,</span>&nbsp;<span class="ident" id="5706198">runtime</span><span class="op" id="5706205">.</span><span class="ident" id="5706206">GOOS</span><span class="op" id="5706210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706213">c</span><span class="op" id="5706214">.</span><span class="ident" id="5706215">GOROOT</span>&nbsp;<span class="op" id="5706222">=</span>&nbsp;<span class="ident" id="5706224">runtime</span><span class="op" id="5706231">.</span><span class="ident" id="5706232">GOROOT</span><span class="op" id="5706238">(</span><span class="op" id="5706239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706242">c</span><span class="op" id="5706243">.</span><span class="ident" id="5706244">GOPATH</span>&nbsp;<span class="op" id="5706251">=</span>&nbsp;<span class="ident" id="5706253">envOr</span><span class="op" id="5706258">(</span><span class="string" id="5706259">&#34;GOPATH&#34;</span><span class="op" id="5706267">,</span>&nbsp;<span class="string" id="5706269">&#34;&#34;</span><span class="op" id="5706271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706274">c</span><span class="op" id="5706275">.</span><span class="ident" id="5706276">Compiler</span>&nbsp;<span class="op" id="5706285">=</span>&nbsp;<span class="ident" id="5706287">runtime</span><span class="op" id="5706294">.</span><span class="ident" id="5706295">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706306">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706376">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706446">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706519">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706592">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706669">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706673">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706717">//&nbsp;&nbsp;&nbsp;&nbsp;c.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706791">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706806">c</span><span class="op" id="5706807">.</span><span class="ident" id="5706808">ReleaseTags</span>&nbsp;<span class="op" id="5706820">=</span>&nbsp;<span class="op" id="5706822">[</span><span class="op" id="5706823">]</span><span class="builtintype" id="5706824">string</span><span class="op" id="5706830">{</span><span class="string" id="5706831">&#34;go1.1&#34;</span><span class="op" id="5706838">,</span>&nbsp;<span class="string" id="5706840">&#34;go1.2&#34;</span><span class="op" id="5706847">,</span>&nbsp;<span class="string" id="5706849">&#34;go1.3&#34;</span><span class="op" id="5706856">,</span>&nbsp;<span class="string" id="5706858">&#34;go1.4&#34;</span><span class="op" id="5706865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5706869">switch</span>&nbsp;<span class="ident" id="5706876">os</span><span class="op" id="5706878">.</span><span class="ident" id="5706879">Getenv</span><span class="op" id="5706885">(</span><span class="string" id="5706886">&#34;CGO_ENABLED&#34;</span><span class="op" id="5706899">)</span>&nbsp;<span class="op" id="5706901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5706904">case</span>&nbsp;<span class="string" id="5706909">&#34;1&#34;</span><span class="op" id="5706912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706916">c</span><span class="op" id="5706917">.</span><span class="ident" id="5706918">CgoEnabled</span>&nbsp;<span class="op" id="5706929">=</span>&nbsp;<span class="builtintype" id="5706931">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5706937">case</span>&nbsp;<span class="string" id="5706942">&#34;0&#34;</span><span class="op" id="5706945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5706949">c</span><span class="op" id="5706950">.</span><span class="ident" id="5706951">CgoEnabled</span>&nbsp;<span class="op" id="5706962">=</span>&nbsp;<span class="builtintype" id="5706964">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5706971">default</span><span class="op" id="5706978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5706982">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707047">if</span>&nbsp;<span class="ident" id="5707050">runtime</span><span class="op" id="5707057">.</span><span class="ident" id="5707058">GOARCH</span>&nbsp;<span class="op" id="5707065">==</span>&nbsp;<span class="ident" id="5707068">c</span><span class="op" id="5707069">.</span><span class="ident" id="5707070">GOARCH</span>&nbsp;<span class="op" id="5707077">&amp;&amp;</span>&nbsp;<span class="ident" id="5707080">runtime</span><span class="op" id="5707087">.</span><span class="ident" id="5707088">GOOS</span>&nbsp;<span class="op" id="5707093">==</span>&nbsp;<span class="ident" id="5707096">c</span><span class="op" id="5707097">.</span><span class="ident" id="5707098">GOOS</span>&nbsp;<span class="op" id="5707103">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707108">c</span><span class="op" id="5707109">.</span><span class="ident" id="5707110">CgoEnabled</span>&nbsp;<span class="op" id="5707121">=</span>&nbsp;<span class="ident" id="5707123">cgoEnabled</span><span class="op" id="5707133">[</span><span class="ident" id="5707134">c</span><span class="op" id="5707135">.</span><span class="ident" id="5707136">GOOS</span><span class="op" id="5707140">+</span><span class="string" id="5707141">&#34;/&#34;</span><span class="op" id="5707144">+</span><span class="ident" id="5707145">c</span><span class="op" id="5707146">.</span><span class="ident" id="5707147">GOARCH</span><span class="op" id="5707153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707158">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5707166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707170">c</span><span class="op" id="5707171">.</span><span class="ident" id="5707172">CgoEnabled</span>&nbsp;<span class="op" id="5707183">=</span>&nbsp;<span class="builtintype" id="5707185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5707192">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707196">return</span>&nbsp;<span class="ident" id="5707203">c</span><br>
<span class="lineno"></span><span class="op" id="5707205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5707208">func</span>&nbsp;<span class="ident" id="5707213">envOr</span><span class="op" id="5707218">(</span><span class="ident" id="5707219">name</span><span class="op" id="5707223">,</span>&nbsp;<span class="ident" id="5707225">def</span>&nbsp;<span class="builtintype" id="5707229">string</span><span class="op" id="5707235">)</span>&nbsp;<span class="builtintype" id="5707237">string</span>&nbsp;<span class="op" id="5707244">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707247">s</span>&nbsp;<span class="op" id="5707249">:=</span>&nbsp;<span class="ident" id="5707252">os</span><span class="op" id="5707254">.</span><span class="ident" id="5707255">Getenv</span><span class="op" id="5707261">(</span><span class="ident" id="5707262">name</span><span class="op" id="5707266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707269">if</span>&nbsp;<span class="ident" id="5707272">s</span>&nbsp;<span class="op" id="5707274">==</span>&nbsp;<span class="string" id="5707277">&#34;&#34;</span>&nbsp;<span class="op" id="5707280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707284">return</span>&nbsp;<span class="ident" id="5707291">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5707296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5707299">return</span>&nbsp;<span class="ident" id="5707306">s</span><br>
<span class="lineno">325</span><span class="op" id="5707308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5707311">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="5707372">type</span>&nbsp;<span class="ident" id="5707377">ImportMode</span>&nbsp;<span class="builtintype" id="5707388">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="5707394">const</span>&nbsp;<span class="op" id="5707400">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707403">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707469">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707533">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707570">FindOnly</span>&nbsp;<span class="ident" id="5707579">ImportMode</span>&nbsp;<span class="op" id="5707590">=</span>&nbsp;<span class="num" id="5707592">1</span>&nbsp;<span class="op" id="5707594">&lt;&lt;</span>&nbsp;<span class="ident" id="5707597">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707604">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707669">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707719">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707733">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707807">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707878">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5707938">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5707998">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="5708012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5708015">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="5708075">type</span>&nbsp;<span class="ident" id="5708080">Package</span>&nbsp;<span class="keyword" id="5708088">struct</span>&nbsp;<span class="op" id="5708095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708098">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708112">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708121">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708162">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708176">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708185">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708202">ImportComment</span>&nbsp;<span class="builtintype" id="5708216">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708225">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708273">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708287">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708296">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708323">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708337">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708346">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708389">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708403">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708412">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708457">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708471">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708480">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708530">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708544">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708553">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708604">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708618">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708627">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708673">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708687">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708696">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708725">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708739">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708748">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708770">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5708784">[</span><span class="op" id="5708785">]</span><span class="builtintype" id="5708786">string</span>&nbsp;<span class="comment" id="5708793">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708854">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5708868">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5708877">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5708920">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5708937">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5708952">[</span><span class="op" id="5708953">]</span><span class="builtintype" id="5708954">string</span>&nbsp;<span class="comment" id="5708961">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709030">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709045">[</span><span class="op" id="5709046">]</span><span class="builtintype" id="5709047">string</span>&nbsp;<span class="comment" id="5709054">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709091">IgnoredGoFiles</span>&nbsp;<span class="op" id="5709106">[</span><span class="op" id="5709107">]</span><span class="builtintype" id="5709108">string</span>&nbsp;<span class="comment" id="5709115">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709159">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709174">[</span><span class="op" id="5709175">]</span><span class="builtintype" id="5709176">string</span>&nbsp;<span class="comment" id="5709183">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709203">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709218">[</span><span class="op" id="5709219">]</span><span class="builtintype" id="5709220">string</span>&nbsp;<span class="comment" id="5709227">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709263">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709278">[</span><span class="op" id="5709279">]</span><span class="builtintype" id="5709280">string</span>&nbsp;<span class="comment" id="5709287">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709321">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709336">[</span><span class="op" id="5709337">]</span><span class="builtintype" id="5709338">string</span>&nbsp;<span class="comment" id="5709345">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709385">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709400">[</span><span class="op" id="5709401">]</span><span class="builtintype" id="5709402">string</span>&nbsp;<span class="comment" id="5709409">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709429">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709444">[</span><span class="op" id="5709445">]</span><span class="builtintype" id="5709446">string</span>&nbsp;<span class="comment" id="5709453">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709469">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709484">[</span><span class="op" id="5709485">]</span><span class="builtintype" id="5709486">string</span>&nbsp;<span class="comment" id="5709493">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709512">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709527">[</span><span class="op" id="5709528">]</span><span class="builtintype" id="5709529">string</span>&nbsp;<span class="comment" id="5709536">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709585">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709604">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5709617">[</span><span class="op" id="5709618">]</span><span class="builtintype" id="5709619">string</span>&nbsp;<span class="comment" id="5709626">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709652">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="5709665">[</span><span class="op" id="5709666">]</span><span class="builtintype" id="5709667">string</span>&nbsp;<span class="comment" id="5709674">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709702">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="5709715">[</span><span class="op" id="5709716">]</span><span class="builtintype" id="5709717">string</span>&nbsp;<span class="comment" id="5709724">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709752">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709765">[</span><span class="op" id="5709766">]</span><span class="builtintype" id="5709767">string</span>&nbsp;<span class="comment" id="5709774">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709801">CgoPkgConfig</span>&nbsp;<span class="op" id="5709814">[</span><span class="op" id="5709815">]</span><span class="builtintype" id="5709816">string</span>&nbsp;<span class="comment" id="5709823">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709854">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709881">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5709891">[</span><span class="op" id="5709892">]</span><span class="builtintype" id="5709893">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5709919">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5709954">ImportPos</span>&nbsp;<span class="keyword" id="5709964">map</span><span class="op" id="5709967">[</span><span class="builtintype" id="5709968">string</span><span class="op" id="5709974">]</span><span class="op" id="5709975">[</span><span class="op" id="5709976">]</span><span class="ident" id="5709977">token</span><span class="op" id="5709982">.</span><span class="ident" id="5709983">Position</span>&nbsp;<span class="comment" id="5709992">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710026">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710047">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5710062">[</span><span class="op" id="5710063">]</span><span class="builtintype" id="5710064">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710090">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710120">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5710135">[</span><span class="op" id="5710136">]</span><span class="builtintype" id="5710137">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710163">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710192">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="5710207">map</span><span class="op" id="5710210">[</span><span class="builtintype" id="5710211">string</span><span class="op" id="5710217">]</span><span class="op" id="5710218">[</span><span class="op" id="5710219">]</span><span class="ident" id="5710220">token</span><span class="op" id="5710225">.</span><span class="ident" id="5710226">Position</span>&nbsp;<span class="comment" id="5710235">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710272">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5710287">[</span><span class="op" id="5710288">]</span><span class="builtintype" id="5710289">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710315">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710350">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5710365">[</span><span class="op" id="5710366">]</span><span class="builtintype" id="5710367">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5710393">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5710423">XTestImportPos</span>&nbsp;<span class="keyword" id="5710438">map</span><span class="op" id="5710441">[</span><span class="builtintype" id="5710442">string</span><span class="op" id="5710448">]</span><span class="op" id="5710449">[</span><span class="op" id="5710450">]</span><span class="ident" id="5710451">token</span><span class="op" id="5710456">.</span><span class="ident" id="5710457">Position</span>&nbsp;<span class="comment" id="5710466">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="5710503">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5710506">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5710563">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="5710612">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5710662">func</span>&nbsp;<span class="op" id="5710667">(</span><span class="ident" id="5710668">p</span>&nbsp;<span class="op" id="5710670">*</span><span class="ident" id="5710671">Package</span><span class="op" id="5710678">)</span>&nbsp;<span class="ident" id="5710680">IsCommand</span><span class="op" id="5710689">(</span><span class="op" id="5710690">)</span>&nbsp;<span class="builtintype" id="5710692">bool</span>&nbsp;<span class="op" id="5710697">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5710700">return</span>&nbsp;<span class="ident" id="5710707">p</span><span class="op" id="5710708">.</span><span class="ident" id="5710709">Name</span>&nbsp;<span class="op" id="5710714">==</span>&nbsp;<span class="string" id="5710717">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="5710724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5710727">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5710793">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="5710817">func</span>&nbsp;<span class="op" id="5710822">(</span><span class="ident" id="5710823">ctxt</span>&nbsp;<span class="op" id="5710828">*</span><span class="ident" id="5710829">Context</span><span class="op" id="5710836">)</span>&nbsp;<span class="ident" id="5710838">ImportDir</span><span class="op" id="5710847">(</span><span class="ident" id="5710848">dir</span>&nbsp;<span class="builtintype" id="5710852">string</span><span class="op" id="5710858">,</span>&nbsp;<span class="ident" id="5710860">mode</span>&nbsp;<span class="ident" id="5710865">ImportMode</span><span class="op" id="5710875">)</span>&nbsp;<span class="op" id="5710877">(</span><span class="op" id="5710878">*</span><span class="ident" id="5710879">Package</span><span class="op" id="5710886">,</span>&nbsp;<span class="builtintype" id="5710888">error</span><span class="op" id="5710893">)</span>&nbsp;<span class="op" id="5710895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5710898">return</span>&nbsp;<span class="ident" id="5710905">ctxt</span><span class="op" id="5710909">.</span><span class="ident" id="5710910">Import</span><span class="op" id="5710916">(</span><span class="string" id="5710917">&#34;.&#34;</span><span class="op" id="5710920">,</span>&nbsp;<span class="ident" id="5710922">dir</span><span class="op" id="5710925">,</span>&nbsp;<span class="ident" id="5710927">mode</span><span class="op" id="5710931">)</span><br>
<span class="lineno"></span><span class="op" id="5710933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5710936">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="5711001">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="5711067">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="5711122">type</span>&nbsp;<span class="ident" id="5711127">NoGoError</span>&nbsp;<span class="keyword" id="5711137">struct</span>&nbsp;<span class="op" id="5711144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711147">Dir</span>&nbsp;<span class="builtintype" id="5711151">string</span><br>
<span class="lineno"></span><span class="op" id="5711158">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="5711161">func</span>&nbsp;<span class="op" id="5711166">(</span><span class="ident" id="5711167">e</span>&nbsp;<span class="op" id="5711169">*</span><span class="ident" id="5711170">NoGoError</span><span class="op" id="5711179">)</span>&nbsp;<span class="ident" id="5711181">Error</span><span class="op" id="5711186">(</span><span class="op" id="5711187">)</span>&nbsp;<span class="builtintype" id="5711189">string</span>&nbsp;<span class="op" id="5711196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5711199">return</span>&nbsp;<span class="string" id="5711206">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="5711241">+</span>&nbsp;<span class="ident" id="5711243">e</span><span class="op" id="5711244">.</span><span class="ident" id="5711245">Dir</span><br>
<span class="lineno"></span><span class="op" id="5711249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="5711252">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="5711309">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="5711370">type</span>&nbsp;<span class="ident" id="5711375">MultiplePackageError</span>&nbsp;<span class="keyword" id="5711396">struct</span>&nbsp;<span class="op" id="5711403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711406">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5711415">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5711424">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711455">Packages</span>&nbsp;<span class="op" id="5711464">[</span><span class="op" id="5711465">]</span><span class="builtintype" id="5711466">string</span>&nbsp;<span class="comment" id="5711473">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711497">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5711506">[</span><span class="op" id="5711507">]</span><span class="builtintype" id="5711508">string</span>&nbsp;<span class="comment" id="5711515">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="5711577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5711580">func</span>&nbsp;<span class="op" id="5711585">(</span><span class="ident" id="5711586">e</span>&nbsp;<span class="op" id="5711588">*</span><span class="ident" id="5711589">MultiplePackageError</span><span class="op" id="5711609">)</span>&nbsp;<span class="ident" id="5711611">Error</span><span class="op" id="5711616">(</span><span class="op" id="5711617">)</span>&nbsp;<span class="builtintype" id="5711619">string</span>&nbsp;<span class="op" id="5711626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5711629">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5711688">return</span>&nbsp;<span class="ident" id="5711695">fmt</span><span class="op" id="5711698">.</span><span class="ident" id="5711699">Sprintf</span><span class="op" id="5711706">(</span><span class="string" id="5711707">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5711749">,</span>&nbsp;<span class="ident" id="5711751">e</span><span class="op" id="5711752">.</span><span class="ident" id="5711753">Packages</span><span class="op" id="5711761">[</span><span class="num" id="5711762">0</span><span class="op" id="5711763">]</span><span class="op" id="5711764">,</span>&nbsp;<span class="ident" id="5711766">e</span><span class="op" id="5711767">.</span><span class="ident" id="5711768">Files</span><span class="op" id="5711773">[</span><span class="num" id="5711774">0</span><span class="op" id="5711775">]</span><span class="op" id="5711776">,</span>&nbsp;<span class="ident" id="5711778">e</span><span class="op" id="5711779">.</span><span class="ident" id="5711780">Packages</span><span class="op" id="5711788">[</span><span class="num" id="5711789">1</span><span class="op" id="5711790">]</span><span class="op" id="5711791">,</span>&nbsp;<span class="ident" id="5711793">e</span><span class="op" id="5711794">.</span><span class="ident" id="5711795">Files</span><span class="op" id="5711800">[</span><span class="num" id="5711801">1</span><span class="op" id="5711802">]</span><span class="op" id="5711803">,</span>&nbsp;<span class="ident" id="5711805">e</span><span class="op" id="5711806">.</span><span class="ident" id="5711807">Dir</span><span class="op" id="5711810">)</span><br>
<span class="lineno"></span><span class="op" id="5711812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5711815">func</span>&nbsp;<span class="ident" id="5711820">nameExt</span><span class="op" id="5711827">(</span><span class="ident" id="5711828">name</span>&nbsp;<span class="builtintype" id="5711833">string</span><span class="op" id="5711839">)</span>&nbsp;<span class="builtintype" id="5711841">string</span>&nbsp;<span class="op" id="5711848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5711851">i</span>&nbsp;<span class="op" id="5711853">:=</span>&nbsp;<span class="ident" id="5711856">strings</span><span class="op" id="5711863">.</span><span class="ident" id="5711864">LastIndex</span><span class="op" id="5711873">(</span><span class="ident" id="5711874">name</span><span class="op" id="5711878">,</span>&nbsp;<span class="string" id="5711880">&#34;.&#34;</span><span class="op" id="5711883">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5711886">if</span>&nbsp;<span class="ident" id="5711889">i</span>&nbsp;<span class="op" id="5711891">&lt;</span>&nbsp;<span class="num" id="5711893">0</span>&nbsp;<span class="op" id="5711895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5711899">return</span>&nbsp;<span class="string" id="5711906">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5711910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5711913">return</span>&nbsp;<span class="ident" id="5711920">name</span><span class="op" id="5711924">[</span><span class="ident" id="5711925">i</span><span class="op" id="5711926">:</span><span class="op" id="5711927">]</span><br>
<span class="lineno"></span><span class="op" id="5711929">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="5711932">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="5712005">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5712074">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5712150">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="5712226">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="5712243">//</span><br>
<span class="lineno"></span><span class="comment" id="5712246">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5712320">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="5712366">//</span><br>
<span class="lineno">450</span><span class="comment" id="5712369">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="5712409">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="5712473">//&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="5712536">//</span><br>
<span class="lineno"></span><span class="comment" id="5712539">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="5712607">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="5712651">//</span><br>
<span class="lineno"></span><span class="keyword" id="5712654">func</span>&nbsp;<span class="op" id="5712659">(</span><span class="ident" id="5712660">ctxt</span>&nbsp;<span class="op" id="5712665">*</span><span class="ident" id="5712666">Context</span><span class="op" id="5712673">)</span>&nbsp;<span class="ident" id="5712675">Import</span><span class="op" id="5712681">(</span><span class="ident" id="5712682">path</span>&nbsp;<span class="builtintype" id="5712687">string</span><span class="op" id="5712693">,</span>&nbsp;<span class="ident" id="5712695">srcDir</span>&nbsp;<span class="builtintype" id="5712702">string</span><span class="op" id="5712708">,</span>&nbsp;<span class="ident" id="5712710">mode</span>&nbsp;<span class="ident" id="5712715">ImportMode</span><span class="op" id="5712725">)</span>&nbsp;<span class="op" id="5712727">(</span><span class="op" id="5712728">*</span><span class="ident" id="5712729">Package</span><span class="op" id="5712736">,</span>&nbsp;<span class="builtintype" id="5712738">error</span><span class="op" id="5712743">)</span>&nbsp;<span class="op" id="5712745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712748">p</span>&nbsp;<span class="op" id="5712750">:=</span>&nbsp;<span class="op" id="5712753">&amp;</span><span class="ident" id="5712754">Package</span><span class="op" id="5712761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712765">ImportPath</span><span class="op" id="5712775">:</span>&nbsp;<span class="ident" id="5712777">path</span><span class="op" id="5712781">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5712784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712787">if</span>&nbsp;<span class="ident" id="5712790">path</span>&nbsp;<span class="op" id="5712795">==</span>&nbsp;<span class="string" id="5712798">&#34;&#34;</span>&nbsp;<span class="op" id="5712801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712805">return</span>&nbsp;<span class="ident" id="5712812">p</span><span class="op" id="5712813">,</span>&nbsp;<span class="ident" id="5712815">fmt</span><span class="op" id="5712818">.</span><span class="ident" id="5712819">Errorf</span><span class="op" id="5712825">(</span><span class="string" id="5712826">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="5712858">,</span>&nbsp;<span class="ident" id="5712860">path</span><span class="op" id="5712864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5712867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712871">var</span>&nbsp;<span class="ident" id="5712875">pkga</span>&nbsp;<span class="builtintype" id="5712880">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712888">var</span>&nbsp;<span class="ident" id="5712892">pkgerr</span>&nbsp;<span class="builtintype" id="5712899">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712906">switch</span>&nbsp;<span class="ident" id="5712913">ctxt</span><span class="op" id="5712917">.</span><span class="ident" id="5712918">Compiler</span>&nbsp;<span class="op" id="5712927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5712930">case</span>&nbsp;<span class="string" id="5712935">&#34;gccgo&#34;</span><span class="op" id="5712942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712946">dir</span><span class="op" id="5712949">,</span>&nbsp;<span class="ident" id="5712951">elem</span>&nbsp;<span class="op" id="5712956">:=</span>&nbsp;<span class="ident" id="5712959">pathpkg</span><span class="op" id="5712966">.</span><span class="ident" id="5712967">Split</span><span class="op" id="5712972">(</span><span class="ident" id="5712973">p</span><span class="op" id="5712974">.</span><span class="ident" id="5712975">ImportPath</span><span class="op" id="5712985">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5712989">pkga</span>&nbsp;<span class="op" id="5712994">=</span>&nbsp;<span class="string" id="5712996">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="5713009">+</span>&nbsp;<span class="ident" id="5713011">ctxt</span><span class="op" id="5713015">.</span><span class="ident" id="5713016">GOOS</span>&nbsp;<span class="op" id="5713021">+</span>&nbsp;<span class="string" id="5713023">&#34;_&#34;</span>&nbsp;<span class="op" id="5713027">+</span>&nbsp;<span class="ident" id="5713029">ctxt</span><span class="op" id="5713033">.</span><span class="ident" id="5713034">GOARCH</span>&nbsp;<span class="op" id="5713041">+</span>&nbsp;<span class="string" id="5713043">&#34;/&#34;</span>&nbsp;<span class="op" id="5713047">+</span>&nbsp;<span class="ident" id="5713049">dir</span>&nbsp;<span class="op" id="5713053">+</span>&nbsp;<span class="string" id="5713055">&#34;lib&#34;</span>&nbsp;<span class="op" id="5713061">+</span>&nbsp;<span class="ident" id="5713063">elem</span>&nbsp;<span class="op" id="5713068">+</span>&nbsp;<span class="string" id="5713070">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713076">case</span>&nbsp;<span class="string" id="5713081">&#34;gc&#34;</span><span class="op" id="5713085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713089">suffix</span>&nbsp;<span class="op" id="5713096">:=</span>&nbsp;<span class="string" id="5713099">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713104">if</span>&nbsp;<span class="ident" id="5713107">ctxt</span><span class="op" id="5713111">.</span><span class="ident" id="5713112">InstallSuffix</span>&nbsp;<span class="op" id="5713126">!=</span>&nbsp;<span class="string" id="5713129">&#34;&#34;</span>&nbsp;<span class="op" id="5713132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713137">suffix</span>&nbsp;<span class="op" id="5713144">=</span>&nbsp;<span class="string" id="5713146">&#34;_&#34;</span>&nbsp;<span class="op" id="5713150">+</span>&nbsp;<span class="ident" id="5713152">ctxt</span><span class="op" id="5713156">.</span><span class="ident" id="5713157">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713177">pkga</span>&nbsp;<span class="op" id="5713182">=</span>&nbsp;<span class="string" id="5713184">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="5713191">+</span>&nbsp;<span class="ident" id="5713193">ctxt</span><span class="op" id="5713197">.</span><span class="ident" id="5713198">GOOS</span>&nbsp;<span class="op" id="5713203">+</span>&nbsp;<span class="string" id="5713205">&#34;_&#34;</span>&nbsp;<span class="op" id="5713209">+</span>&nbsp;<span class="ident" id="5713211">ctxt</span><span class="op" id="5713215">.</span><span class="ident" id="5713216">GOARCH</span>&nbsp;<span class="op" id="5713223">+</span>&nbsp;<span class="ident" id="5713225">suffix</span>&nbsp;<span class="op" id="5713232">+</span>&nbsp;<span class="string" id="5713234">&#34;/&#34;</span>&nbsp;<span class="op" id="5713238">+</span>&nbsp;<span class="ident" id="5713240">p</span><span class="op" id="5713241">.</span><span class="ident" id="5713242">ImportPath</span>&nbsp;<span class="op" id="5713253">+</span>&nbsp;<span class="string" id="5713255">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713261">default</span><span class="op" id="5713268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5713272">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713309">pkgerr</span>&nbsp;<span class="op" id="5713316">=</span>&nbsp;<span class="ident" id="5713318">fmt</span><span class="op" id="5713321">.</span><span class="ident" id="5713322">Errorf</span><span class="op" id="5713328">(</span><span class="string" id="5713329">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="5713361">,</span>&nbsp;<span class="ident" id="5713363">path</span><span class="op" id="5713367">,</span>&nbsp;<span class="ident" id="5713369">ctxt</span><span class="op" id="5713373">.</span><span class="ident" id="5713374">Compiler</span><span class="op" id="5713382">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713389">binaryOnly</span>&nbsp;<span class="op" id="5713400">:=</span>&nbsp;<span class="builtintype" id="5713403">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713410">if</span>&nbsp;<span class="ident" id="5713413">IsLocalImport</span><span class="op" id="5713426">(</span><span class="ident" id="5713427">path</span><span class="op" id="5713431">)</span>&nbsp;<span class="op" id="5713433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713437">pkga</span>&nbsp;<span class="op" id="5713442">=</span>&nbsp;<span class="string" id="5713444">&#34;&#34;</span>&nbsp;<span class="comment" id="5713447">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713489">if</span>&nbsp;<span class="ident" id="5713492">srcDir</span>&nbsp;<span class="op" id="5713499">==</span>&nbsp;<span class="string" id="5713502">&#34;&#34;</span>&nbsp;<span class="op" id="5713505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713510">return</span>&nbsp;<span class="ident" id="5713517">p</span><span class="op" id="5713518">,</span>&nbsp;<span class="ident" id="5713520">fmt</span><span class="op" id="5713523">.</span><span class="ident" id="5713524">Errorf</span><span class="op" id="5713530">(</span><span class="string" id="5713531">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="5713580">,</span>&nbsp;<span class="ident" id="5713582">path</span><span class="op" id="5713586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713594">if</span>&nbsp;<span class="op" id="5713597">!</span><span class="ident" id="5713598">ctxt</span><span class="op" id="5713602">.</span><span class="ident" id="5713603">isAbsPath</span><span class="op" id="5713612">(</span><span class="ident" id="5713613">path</span><span class="op" id="5713617">)</span>&nbsp;<span class="op" id="5713619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713624">p</span><span class="op" id="5713625">.</span><span class="ident" id="5713626">Dir</span>&nbsp;<span class="op" id="5713630">=</span>&nbsp;<span class="ident" id="5713632">ctxt</span><span class="op" id="5713636">.</span><span class="ident" id="5713637">joinPath</span><span class="op" id="5713645">(</span><span class="ident" id="5713646">srcDir</span><span class="op" id="5713652">,</span>&nbsp;<span class="ident" id="5713654">path</span><span class="op" id="5713658">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5713666">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713712">if</span>&nbsp;<span class="ident" id="5713715">ctxt</span><span class="op" id="5713719">.</span><span class="ident" id="5713720">GOROOT</span>&nbsp;<span class="op" id="5713727">!=</span>&nbsp;<span class="string" id="5713730">&#34;&#34;</span>&nbsp;<span class="op" id="5713733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713738">root</span>&nbsp;<span class="op" id="5713743">:=</span>&nbsp;<span class="ident" id="5713746">ctxt</span><span class="op" id="5713750">.</span><span class="ident" id="5713751">joinPath</span><span class="op" id="5713759">(</span><span class="ident" id="5713760">ctxt</span><span class="op" id="5713764">.</span><span class="ident" id="5713765">GOROOT</span><span class="op" id="5713771">,</span>&nbsp;<span class="string" id="5713773">&#34;src&#34;</span><span class="op" id="5713778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713783">if</span>&nbsp;<span class="ident" id="5713786">sub</span><span class="op" id="5713789">,</span>&nbsp;<span class="ident" id="5713791">ok</span>&nbsp;<span class="op" id="5713794">:=</span>&nbsp;<span class="ident" id="5713797">ctxt</span><span class="op" id="5713801">.</span><span class="ident" id="5713802">hasSubdir</span><span class="op" id="5713811">(</span><span class="ident" id="5713812">root</span><span class="op" id="5713816">,</span>&nbsp;<span class="ident" id="5713818">p</span><span class="op" id="5713819">.</span><span class="ident" id="5713820">Dir</span><span class="op" id="5713823">)</span><span class="op" id="5713824">;</span>&nbsp;<span class="ident" id="5713826">ok</span>&nbsp;<span class="op" id="5713829">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713835">p</span><span class="op" id="5713836">.</span><span class="ident" id="5713837">Goroot</span>&nbsp;<span class="op" id="5713844">=</span>&nbsp;<span class="builtintype" id="5713846">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713855">p</span><span class="op" id="5713856">.</span><span class="ident" id="5713857">ImportPath</span>&nbsp;<span class="op" id="5713868">=</span>&nbsp;<span class="ident" id="5713870">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713878">p</span><span class="op" id="5713879">.</span><span class="ident" id="5713880">Root</span>&nbsp;<span class="op" id="5713885">=</span>&nbsp;<span class="ident" id="5713887">ctxt</span><span class="op" id="5713891">.</span><span class="ident" id="5713892">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713903">goto</span>&nbsp;<span class="ident" id="5713908">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713917">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5713921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713925">all</span>&nbsp;<span class="op" id="5713929">:=</span>&nbsp;<span class="ident" id="5713932">ctxt</span><span class="op" id="5713936">.</span><span class="ident" id="5713937">gopath</span><span class="op" id="5713943">(</span><span class="op" id="5713944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5713948">for</span>&nbsp;<span class="ident" id="5713952">i</span><span class="op" id="5713953">,</span>&nbsp;<span class="ident" id="5713955">root</span>&nbsp;<span class="op" id="5713960">:=</span>&nbsp;<span class="keyword" id="5713963">range</span>&nbsp;<span class="ident" id="5713969">all</span>&nbsp;<span class="op" id="5713973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5713978">rootsrc</span>&nbsp;<span class="op" id="5713986">:=</span>&nbsp;<span class="ident" id="5713989">ctxt</span><span class="op" id="5713993">.</span><span class="ident" id="5713994">joinPath</span><span class="op" id="5714002">(</span><span class="ident" id="5714003">root</span><span class="op" id="5714007">,</span>&nbsp;<span class="string" id="5714009">&#34;src&#34;</span><span class="op" id="5714014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714019">if</span>&nbsp;<span class="ident" id="5714022">sub</span><span class="op" id="5714025">,</span>&nbsp;<span class="ident" id="5714027">ok</span>&nbsp;<span class="op" id="5714030">:=</span>&nbsp;<span class="ident" id="5714033">ctxt</span><span class="op" id="5714037">.</span><span class="ident" id="5714038">hasSubdir</span><span class="op" id="5714047">(</span><span class="ident" id="5714048">rootsrc</span><span class="op" id="5714055">,</span>&nbsp;<span class="ident" id="5714057">p</span><span class="op" id="5714058">.</span><span class="ident" id="5714059">Dir</span><span class="op" id="5714062">)</span><span class="op" id="5714063">;</span>&nbsp;<span class="ident" id="5714065">ok</span>&nbsp;<span class="op" id="5714068">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714074">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714123">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714178">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714197">if</span>&nbsp;<span class="ident" id="5714200">ctxt</span><span class="op" id="5714204">.</span><span class="ident" id="5714205">GOROOT</span>&nbsp;<span class="op" id="5714212">!=</span>&nbsp;<span class="string" id="5714215">&#34;&#34;</span>&nbsp;<span class="op" id="5714218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714225">if</span>&nbsp;<span class="ident" id="5714228">dir</span>&nbsp;<span class="op" id="5714232">:=</span>&nbsp;<span class="ident" id="5714235">ctxt</span><span class="op" id="5714239">.</span><span class="ident" id="5714240">joinPath</span><span class="op" id="5714248">(</span><span class="ident" id="5714249">ctxt</span><span class="op" id="5714253">.</span><span class="ident" id="5714254">GOROOT</span><span class="op" id="5714260">,</span>&nbsp;<span class="string" id="5714262">&#34;src&#34;</span><span class="op" id="5714267">,</span>&nbsp;<span class="ident" id="5714269">sub</span><span class="op" id="5714272">)</span><span class="op" id="5714273">;</span>&nbsp;<span class="ident" id="5714275">ctxt</span><span class="op" id="5714279">.</span><span class="ident" id="5714280">isDir</span><span class="op" id="5714285">(</span><span class="ident" id="5714286">dir</span><span class="op" id="5714289">)</span>&nbsp;<span class="op" id="5714291">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714299">p</span><span class="op" id="5714300">.</span><span class="ident" id="5714301">ConflictDir</span>&nbsp;<span class="op" id="5714313">=</span>&nbsp;<span class="ident" id="5714315">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714325">goto</span>&nbsp;<span class="ident" id="5714330">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714353">for</span>&nbsp;<span class="ident" id="5714357">_</span><span class="op" id="5714358">,</span>&nbsp;<span class="ident" id="5714360">earlyRoot</span>&nbsp;<span class="op" id="5714370">:=</span>&nbsp;<span class="keyword" id="5714373">range</span>&nbsp;<span class="ident" id="5714379">all</span><span class="op" id="5714382">[</span><span class="op" id="5714383">:</span><span class="ident" id="5714384">i</span><span class="op" id="5714385">]</span>&nbsp;<span class="op" id="5714387">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714394">if</span>&nbsp;<span class="ident" id="5714397">dir</span>&nbsp;<span class="op" id="5714401">:=</span>&nbsp;<span class="ident" id="5714404">ctxt</span><span class="op" id="5714408">.</span><span class="ident" id="5714409">joinPath</span><span class="op" id="5714417">(</span><span class="ident" id="5714418">earlyRoot</span><span class="op" id="5714427">,</span>&nbsp;<span class="string" id="5714429">&#34;src&#34;</span><span class="op" id="5714434">,</span>&nbsp;<span class="ident" id="5714436">sub</span><span class="op" id="5714439">)</span><span class="op" id="5714440">;</span>&nbsp;<span class="ident" id="5714442">ctxt</span><span class="op" id="5714446">.</span><span class="ident" id="5714447">isDir</span><span class="op" id="5714452">(</span><span class="ident" id="5714453">dir</span><span class="op" id="5714456">)</span>&nbsp;<span class="op" id="5714458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714466">p</span><span class="op" id="5714467">.</span><span class="ident" id="5714468">ConflictDir</span>&nbsp;<span class="op" id="5714480">=</span>&nbsp;<span class="ident" id="5714482">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714492">goto</span>&nbsp;<span class="ident" id="5714497">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714514">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714521">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714589">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714607">p</span><span class="op" id="5714608">.</span><span class="ident" id="5714609">ImportPath</span>&nbsp;<span class="op" id="5714620">=</span>&nbsp;<span class="ident" id="5714622">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714630">p</span><span class="op" id="5714631">.</span><span class="ident" id="5714632">Root</span>&nbsp;<span class="op" id="5714637">=</span>&nbsp;<span class="ident" id="5714639">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714648">goto</span>&nbsp;<span class="ident" id="5714653">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714670">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714728">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714773">}</span>&nbsp;<span class="keyword" id="5714775">else</span>&nbsp;<span class="op" id="5714780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714784">if</span>&nbsp;<span class="ident" id="5714787">strings</span><span class="op" id="5714794">.</span><span class="ident" id="5714795">HasPrefix</span><span class="op" id="5714804">(</span><span class="ident" id="5714805">path</span><span class="op" id="5714809">,</span>&nbsp;<span class="string" id="5714811">&#34;/&#34;</span><span class="op" id="5714814">)</span>&nbsp;<span class="op" id="5714816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714821">return</span>&nbsp;<span class="ident" id="5714828">p</span><span class="op" id="5714829">,</span>&nbsp;<span class="ident" id="5714831">fmt</span><span class="op" id="5714834">.</span><span class="ident" id="5714835">Errorf</span><span class="op" id="5714841">(</span><span class="string" id="5714842">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="5714882">,</span>&nbsp;<span class="ident" id="5714884">path</span><span class="op" id="5714888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5714892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5714897">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5714961">var</span>&nbsp;<span class="ident" id="5714965">tried</span>&nbsp;<span class="keyword" id="5714971">struct</span>&nbsp;<span class="op" id="5714978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714983">goroot</span>&nbsp;<span class="builtintype" id="5714990">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715000">gopath</span>&nbsp;<span class="op" id="5715007">[</span><span class="op" id="5715008">]</span><span class="builtintype" id="5715009">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715018">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715023">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715066">if</span>&nbsp;<span class="ident" id="5715069">ctxt</span><span class="op" id="5715073">.</span><span class="ident" id="5715074">GOROOT</span>&nbsp;<span class="op" id="5715081">!=</span>&nbsp;<span class="string" id="5715084">&#34;&#34;</span>&nbsp;<span class="op" id="5715087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715092">dir</span>&nbsp;<span class="op" id="5715096">:=</span>&nbsp;<span class="ident" id="5715099">ctxt</span><span class="op" id="5715103">.</span><span class="ident" id="5715104">joinPath</span><span class="op" id="5715112">(</span><span class="ident" id="5715113">ctxt</span><span class="op" id="5715117">.</span><span class="ident" id="5715118">GOROOT</span><span class="op" id="5715124">,</span>&nbsp;<span class="string" id="5715126">&#34;src&#34;</span><span class="op" id="5715131">,</span>&nbsp;<span class="ident" id="5715133">path</span><span class="op" id="5715137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715142">isDir</span>&nbsp;<span class="op" id="5715148">:=</span>&nbsp;<span class="ident" id="5715151">ctxt</span><span class="op" id="5715155">.</span><span class="ident" id="5715156">isDir</span><span class="op" id="5715161">(</span><span class="ident" id="5715162">dir</span><span class="op" id="5715165">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715170">binaryOnly</span>&nbsp;<span class="op" id="5715181">=</span>&nbsp;<span class="op" id="5715183">!</span><span class="ident" id="5715184">isDir</span>&nbsp;<span class="op" id="5715190">&amp;&amp;</span>&nbsp;<span class="ident" id="5715193">mode</span><span class="op" id="5715197">&amp;</span><span class="ident" id="5715198">AllowBinary</span>&nbsp;<span class="op" id="5715210">!=</span>&nbsp;<span class="num" id="5715213">0</span>&nbsp;<span class="op" id="5715215">&amp;&amp;</span>&nbsp;<span class="ident" id="5715218">pkga</span>&nbsp;<span class="op" id="5715223">!=</span>&nbsp;<span class="string" id="5715226">&#34;&#34;</span>&nbsp;<span class="op" id="5715229">&amp;&amp;</span>&nbsp;<span class="ident" id="5715232">ctxt</span><span class="op" id="5715236">.</span><span class="ident" id="5715237">isFile</span><span class="op" id="5715243">(</span><span class="ident" id="5715244">ctxt</span><span class="op" id="5715248">.</span><span class="ident" id="5715249">joinPath</span><span class="op" id="5715257">(</span><span class="ident" id="5715258">ctxt</span><span class="op" id="5715262">.</span><span class="ident" id="5715263">GOROOT</span><span class="op" id="5715269">,</span>&nbsp;<span class="ident" id="5715271">pkga</span><span class="op" id="5715275">)</span><span class="op" id="5715276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715281">if</span>&nbsp;<span class="ident" id="5715284">isDir</span>&nbsp;<span class="op" id="5715290">||</span>&nbsp;<span class="ident" id="5715293">binaryOnly</span>&nbsp;<span class="op" id="5715304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715310">p</span><span class="op" id="5715311">.</span><span class="ident" id="5715312">Dir</span>&nbsp;<span class="op" id="5715316">=</span>&nbsp;<span class="ident" id="5715318">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715326">p</span><span class="op" id="5715327">.</span><span class="ident" id="5715328">Goroot</span>&nbsp;<span class="op" id="5715335">=</span>&nbsp;<span class="builtintype" id="5715337">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715346">p</span><span class="op" id="5715347">.</span><span class="ident" id="5715348">Root</span>&nbsp;<span class="op" id="5715353">=</span>&nbsp;<span class="ident" id="5715355">ctxt</span><span class="op" id="5715359">.</span><span class="ident" id="5715360">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715371">goto</span>&nbsp;<span class="ident" id="5715376">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715390">tried</span><span class="op" id="5715395">.</span><span class="ident" id="5715396">goroot</span>&nbsp;<span class="op" id="5715403">=</span>&nbsp;<span class="ident" id="5715405">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715415">for</span>&nbsp;<span class="ident" id="5715419">_</span><span class="op" id="5715420">,</span>&nbsp;<span class="ident" id="5715422">root</span>&nbsp;<span class="op" id="5715427">:=</span>&nbsp;<span class="keyword" id="5715430">range</span>&nbsp;<span class="ident" id="5715436">ctxt</span><span class="op" id="5715440">.</span><span class="ident" id="5715441">gopath</span><span class="op" id="5715447">(</span><span class="op" id="5715448">)</span>&nbsp;<span class="op" id="5715450">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715455">dir</span>&nbsp;<span class="op" id="5715459">:=</span>&nbsp;<span class="ident" id="5715462">ctxt</span><span class="op" id="5715466">.</span><span class="ident" id="5715467">joinPath</span><span class="op" id="5715475">(</span><span class="ident" id="5715476">root</span><span class="op" id="5715480">,</span>&nbsp;<span class="string" id="5715482">&#34;src&#34;</span><span class="op" id="5715487">,</span>&nbsp;<span class="ident" id="5715489">path</span><span class="op" id="5715493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715498">isDir</span>&nbsp;<span class="op" id="5715504">:=</span>&nbsp;<span class="ident" id="5715507">ctxt</span><span class="op" id="5715511">.</span><span class="ident" id="5715512">isDir</span><span class="op" id="5715517">(</span><span class="ident" id="5715518">dir</span><span class="op" id="5715521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715526">binaryOnly</span>&nbsp;<span class="op" id="5715537">=</span>&nbsp;<span class="op" id="5715539">!</span><span class="ident" id="5715540">isDir</span>&nbsp;<span class="op" id="5715546">&amp;&amp;</span>&nbsp;<span class="ident" id="5715549">mode</span><span class="op" id="5715553">&amp;</span><span class="ident" id="5715554">AllowBinary</span>&nbsp;<span class="op" id="5715566">!=</span>&nbsp;<span class="num" id="5715569">0</span>&nbsp;<span class="op" id="5715571">&amp;&amp;</span>&nbsp;<span class="ident" id="5715574">pkga</span>&nbsp;<span class="op" id="5715579">!=</span>&nbsp;<span class="string" id="5715582">&#34;&#34;</span>&nbsp;<span class="op" id="5715585">&amp;&amp;</span>&nbsp;<span class="ident" id="5715588">ctxt</span><span class="op" id="5715592">.</span><span class="ident" id="5715593">isFile</span><span class="op" id="5715599">(</span><span class="ident" id="5715600">ctxt</span><span class="op" id="5715604">.</span><span class="ident" id="5715605">joinPath</span><span class="op" id="5715613">(</span><span class="ident" id="5715614">root</span><span class="op" id="5715618">,</span>&nbsp;<span class="ident" id="5715620">pkga</span><span class="op" id="5715624">)</span><span class="op" id="5715625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715630">if</span>&nbsp;<span class="ident" id="5715633">isDir</span>&nbsp;<span class="op" id="5715639">||</span>&nbsp;<span class="ident" id="5715642">binaryOnly</span>&nbsp;<span class="op" id="5715653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715659">p</span><span class="op" id="5715660">.</span><span class="ident" id="5715661">Dir</span>&nbsp;<span class="op" id="5715665">=</span>&nbsp;<span class="ident" id="5715667">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715675">p</span><span class="op" id="5715676">.</span><span class="ident" id="5715677">Root</span>&nbsp;<span class="op" id="5715682">=</span>&nbsp;<span class="ident" id="5715684">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715693">goto</span>&nbsp;<span class="ident" id="5715698">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715712">tried</span><span class="op" id="5715717">.</span><span class="ident" id="5715718">gopath</span>&nbsp;<span class="op" id="5715725">=</span>&nbsp;<span class="builtinfunc" id="5715727">append</span><span class="op" id="5715733">(</span><span class="ident" id="5715734">tried</span><span class="op" id="5715739">.</span><span class="ident" id="5715740">gopath</span><span class="op" id="5715746">,</span>&nbsp;<span class="ident" id="5715748">dir</span><span class="op" id="5715751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715755">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5715760">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715787">var</span>&nbsp;<span class="ident" id="5715791">paths</span>&nbsp;<span class="op" id="5715797">[</span><span class="op" id="5715798">]</span><span class="builtintype" id="5715799">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715808">if</span>&nbsp;<span class="ident" id="5715811">tried</span><span class="op" id="5715816">.</span><span class="ident" id="5715817">goroot</span>&nbsp;<span class="op" id="5715824">!=</span>&nbsp;<span class="string" id="5715827">&#34;&#34;</span>&nbsp;<span class="op" id="5715830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715835">paths</span>&nbsp;<span class="op" id="5715841">=</span>&nbsp;<span class="builtinfunc" id="5715843">append</span><span class="op" id="5715849">(</span><span class="ident" id="5715850">paths</span><span class="op" id="5715855">,</span>&nbsp;<span class="ident" id="5715857">fmt</span><span class="op" id="5715860">.</span><span class="ident" id="5715861">Sprintf</span><span class="op" id="5715868">(</span><span class="string" id="5715869">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="5715890">,</span>&nbsp;<span class="ident" id="5715892">tried</span><span class="op" id="5715897">.</span><span class="ident" id="5715898">goroot</span><span class="op" id="5715904">)</span><span class="op" id="5715905">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715909">}</span>&nbsp;<span class="keyword" id="5715911">else</span>&nbsp;<span class="op" id="5715916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5715921">paths</span>&nbsp;<span class="op" id="5715927">=</span>&nbsp;<span class="builtinfunc" id="5715929">append</span><span class="op" id="5715935">(</span><span class="ident" id="5715936">paths</span><span class="op" id="5715941">,</span>&nbsp;<span class="string" id="5715943">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5715964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715972">var</span>&nbsp;<span class="ident" id="5715976">i</span>&nbsp;<span class="builtintype" id="5715978">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5715984">var</span>&nbsp;<span class="ident" id="5715988">format</span>&nbsp;<span class="op" id="5715995">=</span>&nbsp;<span class="string" id="5715997">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716021">for</span>&nbsp;<span class="op" id="5716025">;</span>&nbsp;<span class="ident" id="5716027">i</span>&nbsp;<span class="op" id="5716029">&lt;</span>&nbsp;<span class="builtinfunc" id="5716031">len</span><span class="op" id="5716034">(</span><span class="ident" id="5716035">tried</span><span class="op" id="5716040">.</span><span class="ident" id="5716041">gopath</span><span class="op" id="5716047">)</span><span class="op" id="5716048">;</span>&nbsp;<span class="ident" id="5716050">i</span><span class="op" id="5716051">++</span>&nbsp;<span class="op" id="5716054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716059">if</span>&nbsp;<span class="ident" id="5716062">i</span>&nbsp;<span class="op" id="5716064">&gt;</span>&nbsp;<span class="num" id="5716066">0</span>&nbsp;<span class="op" id="5716068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716074">format</span>&nbsp;<span class="op" id="5716081">=</span>&nbsp;<span class="string" id="5716083">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716098">paths</span>&nbsp;<span class="op" id="5716104">=</span>&nbsp;<span class="builtinfunc" id="5716106">append</span><span class="op" id="5716112">(</span><span class="ident" id="5716113">paths</span><span class="op" id="5716118">,</span>&nbsp;<span class="ident" id="5716120">fmt</span><span class="op" id="5716123">.</span><span class="ident" id="5716124">Sprintf</span><span class="op" id="5716131">(</span><span class="ident" id="5716132">format</span><span class="op" id="5716138">,</span>&nbsp;<span class="ident" id="5716140">tried</span><span class="op" id="5716145">.</span><span class="ident" id="5716146">gopath</span><span class="op" id="5716152">[</span><span class="ident" id="5716153">i</span><span class="op" id="5716154">]</span><span class="op" id="5716155">)</span><span class="op" id="5716156">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716164">if</span>&nbsp;<span class="ident" id="5716167">i</span>&nbsp;<span class="op" id="5716169">==</span>&nbsp;<span class="num" id="5716172">0</span>&nbsp;<span class="op" id="5716174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716179">paths</span>&nbsp;<span class="op" id="5716185">=</span>&nbsp;<span class="builtinfunc" id="5716187">append</span><span class="op" id="5716193">(</span><span class="ident" id="5716194">paths</span><span class="op" id="5716199">,</span>&nbsp;<span class="string" id="5716201">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="5716222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716230">return</span>&nbsp;<span class="ident" id="5716237">p</span><span class="op" id="5716238">,</span>&nbsp;<span class="ident" id="5716240">fmt</span><span class="op" id="5716243">.</span><span class="ident" id="5716244">Errorf</span><span class="op" id="5716250">(</span><span class="string" id="5716251">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="5716290">,</span>&nbsp;<span class="ident" id="5716292">path</span><span class="op" id="5716296">,</span>&nbsp;<span class="ident" id="5716298">strings</span><span class="op" id="5716305">.</span><span class="ident" id="5716306">Join</span><span class="op" id="5716310">(</span><span class="ident" id="5716311">paths</span><span class="op" id="5716316">,</span>&nbsp;<span class="string" id="5716318">&#34;\n&#34;</span><span class="op" id="5716322">)</span><span class="op" id="5716323">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5716329">Found</span><span class="op" id="5716334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716337">if</span>&nbsp;<span class="ident" id="5716340">p</span><span class="op" id="5716341">.</span><span class="ident" id="5716342">Root</span>&nbsp;<span class="op" id="5716347">!=</span>&nbsp;<span class="string" id="5716350">&#34;&#34;</span>&nbsp;<span class="op" id="5716353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716357">p</span><span class="op" id="5716358">.</span><span class="ident" id="5716359">SrcRoot</span>&nbsp;<span class="op" id="5716367">=</span>&nbsp;<span class="ident" id="5716369">ctxt</span><span class="op" id="5716373">.</span><span class="ident" id="5716374">joinPath</span><span class="op" id="5716382">(</span><span class="ident" id="5716383">p</span><span class="op" id="5716384">.</span><span class="ident" id="5716385">Root</span><span class="op" id="5716389">,</span>&nbsp;<span class="string" id="5716391">&#34;src&#34;</span><span class="op" id="5716396">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716400">p</span><span class="op" id="5716401">.</span><span class="ident" id="5716402">PkgRoot</span>&nbsp;<span class="op" id="5716410">=</span>&nbsp;<span class="ident" id="5716412">ctxt</span><span class="op" id="5716416">.</span><span class="ident" id="5716417">joinPath</span><span class="op" id="5716425">(</span><span class="ident" id="5716426">p</span><span class="op" id="5716427">.</span><span class="ident" id="5716428">Root</span><span class="op" id="5716432">,</span>&nbsp;<span class="string" id="5716434">&#34;pkg&#34;</span><span class="op" id="5716439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716443">p</span><span class="op" id="5716444">.</span><span class="ident" id="5716445">BinDir</span>&nbsp;<span class="op" id="5716452">=</span>&nbsp;<span class="ident" id="5716454">ctxt</span><span class="op" id="5716458">.</span><span class="ident" id="5716459">joinPath</span><span class="op" id="5716467">(</span><span class="ident" id="5716468">p</span><span class="op" id="5716469">.</span><span class="ident" id="5716470">Root</span><span class="op" id="5716474">,</span>&nbsp;<span class="string" id="5716476">&#34;bin&#34;</span><span class="op" id="5716481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716485">if</span>&nbsp;<span class="ident" id="5716488">pkga</span>&nbsp;<span class="op" id="5716493">!=</span>&nbsp;<span class="string" id="5716496">&#34;&#34;</span>&nbsp;<span class="op" id="5716499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716504">p</span><span class="op" id="5716505">.</span><span class="ident" id="5716506">PkgObj</span>&nbsp;<span class="op" id="5716513">=</span>&nbsp;<span class="ident" id="5716515">ctxt</span><span class="op" id="5716519">.</span><span class="ident" id="5716520">joinPath</span><span class="op" id="5716528">(</span><span class="ident" id="5716529">p</span><span class="op" id="5716530">.</span><span class="ident" id="5716531">Root</span><span class="op" id="5716535">,</span>&nbsp;<span class="ident" id="5716537">pkga</span><span class="op" id="5716541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716545">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716552">if</span>&nbsp;<span class="ident" id="5716555">mode</span><span class="op" id="5716559">&amp;</span><span class="ident" id="5716560">FindOnly</span>&nbsp;<span class="op" id="5716569">!=</span>&nbsp;<span class="num" id="5716572">0</span>&nbsp;<span class="op" id="5716574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716578">return</span>&nbsp;<span class="ident" id="5716585">p</span><span class="op" id="5716586">,</span>&nbsp;<span class="ident" id="5716588">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716596">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716599">if</span>&nbsp;<span class="ident" id="5716602">binaryOnly</span>&nbsp;<span class="op" id="5716613">&amp;&amp;</span>&nbsp;<span class="op" id="5716616">(</span><span class="ident" id="5716617">mode</span><span class="op" id="5716621">&amp;</span><span class="ident" id="5716622">AllowBinary</span><span class="op" id="5716633">)</span>&nbsp;<span class="op" id="5716635">!=</span>&nbsp;<span class="num" id="5716638">0</span>&nbsp;<span class="op" id="5716640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716644">return</span>&nbsp;<span class="ident" id="5716651">p</span><span class="op" id="5716652">,</span>&nbsp;<span class="ident" id="5716654">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716666">dirs</span><span class="op" id="5716670">,</span>&nbsp;<span class="ident" id="5716672">err</span>&nbsp;<span class="op" id="5716676">:=</span>&nbsp;<span class="ident" id="5716679">ctxt</span><span class="op" id="5716683">.</span><span class="ident" id="5716684">readDir</span><span class="op" id="5716691">(</span><span class="ident" id="5716692">p</span><span class="op" id="5716693">.</span><span class="ident" id="5716694">Dir</span><span class="op" id="5716697">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716700">if</span>&nbsp;<span class="ident" id="5716703">err</span>&nbsp;<span class="op" id="5716707">!=</span>&nbsp;<span class="builtintype" id="5716710">nil</span>&nbsp;<span class="op" id="5716714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716718">return</span>&nbsp;<span class="ident" id="5716725">p</span><span class="op" id="5716726">,</span>&nbsp;<span class="ident" id="5716728">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716737">var</span>&nbsp;<span class="ident" id="5716741">Sfiles</span>&nbsp;<span class="op" id="5716748">[</span><span class="op" id="5716749">]</span><span class="builtintype" id="5716750">string</span>&nbsp;<span class="comment" id="5716757">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5716789">var</span>&nbsp;<span class="ident" id="5716793">firstFile</span><span class="op" id="5716802">,</span>&nbsp;<span class="ident" id="5716804">firstCommentFile</span>&nbsp;<span class="builtintype" id="5716821">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716829">imported</span>&nbsp;<span class="op" id="5716838">:=</span>&nbsp;<span class="builtinfunc" id="5716841">make</span><span class="op" id="5716845">(</span><span class="keyword" id="5716846">map</span><span class="op" id="5716849">[</span><span class="builtintype" id="5716850">string</span><span class="op" id="5716856">]</span><span class="op" id="5716857">[</span><span class="op" id="5716858">]</span><span class="ident" id="5716859">token</span><span class="op" id="5716864">.</span><span class="ident" id="5716865">Position</span><span class="op" id="5716873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716876">testImported</span>&nbsp;<span class="op" id="5716889">:=</span>&nbsp;<span class="builtinfunc" id="5716892">make</span><span class="op" id="5716896">(</span><span class="keyword" id="5716897">map</span><span class="op" id="5716900">[</span><span class="builtintype" id="5716901">string</span><span class="op" id="5716907">]</span><span class="op" id="5716908">[</span><span class="op" id="5716909">]</span><span class="ident" id="5716910">token</span><span class="op" id="5716915">.</span><span class="ident" id="5716916">Position</span><span class="op" id="5716924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716927">xTestImported</span>&nbsp;<span class="op" id="5716941">:=</span>&nbsp;<span class="builtinfunc" id="5716944">make</span><span class="op" id="5716948">(</span><span class="keyword" id="5716949">map</span><span class="op" id="5716952">[</span><span class="builtintype" id="5716953">string</span><span class="op" id="5716959">]</span><span class="op" id="5716960">[</span><span class="op" id="5716961">]</span><span class="ident" id="5716962">token</span><span class="op" id="5716967">.</span><span class="ident" id="5716968">Position</span><span class="op" id="5716976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5716979">allTags</span>&nbsp;<span class="op" id="5716987">:=</span>&nbsp;<span class="builtinfunc" id="5716990">make</span><span class="op" id="5716994">(</span><span class="keyword" id="5716995">map</span><span class="op" id="5716998">[</span><span class="builtintype" id="5716999">string</span><span class="op" id="5717005">]</span><span class="builtintype" id="5717006">bool</span><span class="op" id="5717010">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717013">fset</span>&nbsp;<span class="op" id="5717018">:=</span>&nbsp;<span class="ident" id="5717021">token</span><span class="op" id="5717026">.</span><span class="ident" id="5717027">NewFileSet</span><span class="op" id="5717037">(</span><span class="op" id="5717038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717041">for</span>&nbsp;<span class="ident" id="5717045">_</span><span class="op" id="5717046">,</span>&nbsp;<span class="ident" id="5717048">d</span>&nbsp;<span class="op" id="5717050">:=</span>&nbsp;<span class="keyword" id="5717053">range</span>&nbsp;<span class="ident" id="5717059">dirs</span>&nbsp;<span class="op" id="5717064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717068">if</span>&nbsp;<span class="ident" id="5717071">d</span><span class="op" id="5717072">.</span><span class="ident" id="5717073">IsDir</span><span class="op" id="5717078">(</span><span class="op" id="5717079">)</span>&nbsp;<span class="op" id="5717081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717086">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717097">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717102">name</span>&nbsp;<span class="op" id="5717107">:=</span>&nbsp;<span class="ident" id="5717110">d</span><span class="op" id="5717111">.</span><span class="ident" id="5717112">Name</span><span class="op" id="5717116">(</span><span class="op" id="5717117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717121">ext</span>&nbsp;<span class="op" id="5717125">:=</span>&nbsp;<span class="ident" id="5717128">nameExt</span><span class="op" id="5717135">(</span><span class="ident" id="5717136">name</span><span class="op" id="5717140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717145">match</span><span class="op" id="5717150">,</span>&nbsp;<span class="ident" id="5717152">data</span><span class="op" id="5717156">,</span>&nbsp;<span class="ident" id="5717158">filename</span><span class="op" id="5717166">,</span>&nbsp;<span class="ident" id="5717168">err</span>&nbsp;<span class="op" id="5717172">:=</span>&nbsp;<span class="ident" id="5717175">ctxt</span><span class="op" id="5717179">.</span><span class="ident" id="5717180">matchFile</span><span class="op" id="5717189">(</span><span class="ident" id="5717190">p</span><span class="op" id="5717191">.</span><span class="ident" id="5717192">Dir</span><span class="op" id="5717195">,</span>&nbsp;<span class="ident" id="5717197">name</span><span class="op" id="5717201">,</span>&nbsp;<span class="builtintype" id="5717203">true</span><span class="op" id="5717207">,</span>&nbsp;<span class="ident" id="5717209">allTags</span><span class="op" id="5717216">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717220">if</span>&nbsp;<span class="ident" id="5717223">err</span>&nbsp;<span class="op" id="5717227">!=</span>&nbsp;<span class="builtintype" id="5717230">nil</span>&nbsp;<span class="op" id="5717234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717239">return</span>&nbsp;<span class="ident" id="5717246">p</span><span class="op" id="5717247">,</span>&nbsp;<span class="ident" id="5717249">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717259">if</span>&nbsp;<span class="op" id="5717262">!</span><span class="ident" id="5717263">match</span>&nbsp;<span class="op" id="5717269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717274">if</span>&nbsp;<span class="ident" id="5717277">ext</span>&nbsp;<span class="op" id="5717281">==</span>&nbsp;<span class="string" id="5717284">&#34;.go&#34;</span>&nbsp;<span class="op" id="5717290">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717296">p</span><span class="op" id="5717297">.</span><span class="ident" id="5717298">IgnoredGoFiles</span>&nbsp;<span class="op" id="5717313">=</span>&nbsp;<span class="builtinfunc" id="5717315">append</span><span class="op" id="5717321">(</span><span class="ident" id="5717322">p</span><span class="op" id="5717323">.</span><span class="ident" id="5717324">IgnoredGoFiles</span><span class="op" id="5717338">,</span>&nbsp;<span class="ident" id="5717340">name</span><span class="op" id="5717344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717354">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5717365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5717370">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717433">switch</span>&nbsp;<span class="ident" id="5717440">ext</span>&nbsp;<span class="op" id="5717444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717448">case</span>&nbsp;<span class="string" id="5717453">&#34;.c&#34;</span><span class="op" id="5717457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717462">p</span><span class="op" id="5717463">.</span><span class="ident" id="5717464">CFiles</span>&nbsp;<span class="op" id="5717471">=</span>&nbsp;<span class="builtinfunc" id="5717473">append</span><span class="op" id="5717479">(</span><span class="ident" id="5717480">p</span><span class="op" id="5717481">.</span><span class="ident" id="5717482">CFiles</span><span class="op" id="5717488">,</span>&nbsp;<span class="ident" id="5717490">name</span><span class="op" id="5717494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717499">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717510">case</span>&nbsp;<span class="string" id="5717515">&#34;.cc&#34;</span><span class="op" id="5717520">,</span>&nbsp;<span class="string" id="5717522">&#34;.cpp&#34;</span><span class="op" id="5717528">,</span>&nbsp;<span class="string" id="5717530">&#34;.cxx&#34;</span><span class="op" id="5717536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717541">p</span><span class="op" id="5717542">.</span><span class="ident" id="5717543">CXXFiles</span>&nbsp;<span class="op" id="5717552">=</span>&nbsp;<span class="builtinfunc" id="5717554">append</span><span class="op" id="5717560">(</span><span class="ident" id="5717561">p</span><span class="op" id="5717562">.</span><span class="ident" id="5717563">CXXFiles</span><span class="op" id="5717571">,</span>&nbsp;<span class="ident" id="5717573">name</span><span class="op" id="5717577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717582">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717593">case</span>&nbsp;<span class="string" id="5717598">&#34;.m&#34;</span><span class="op" id="5717602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717607">p</span><span class="op" id="5717608">.</span><span class="ident" id="5717609">MFiles</span>&nbsp;<span class="op" id="5717616">=</span>&nbsp;<span class="builtinfunc" id="5717618">append</span><span class="op" id="5717624">(</span><span class="ident" id="5717625">p</span><span class="op" id="5717626">.</span><span class="ident" id="5717627">MFiles</span><span class="op" id="5717633">,</span>&nbsp;<span class="ident" id="5717635">name</span><span class="op" id="5717639">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717644">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717655">case</span>&nbsp;<span class="string" id="5717660">&#34;.h&#34;</span><span class="op" id="5717664">,</span>&nbsp;<span class="string" id="5717666">&#34;.hh&#34;</span><span class="op" id="5717671">,</span>&nbsp;<span class="string" id="5717673">&#34;.hpp&#34;</span><span class="op" id="5717679">,</span>&nbsp;<span class="string" id="5717681">&#34;.hxx&#34;</span><span class="op" id="5717687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717692">p</span><span class="op" id="5717693">.</span><span class="ident" id="5717694">HFiles</span>&nbsp;<span class="op" id="5717701">=</span>&nbsp;<span class="builtinfunc" id="5717703">append</span><span class="op" id="5717709">(</span><span class="ident" id="5717710">p</span><span class="op" id="5717711">.</span><span class="ident" id="5717712">HFiles</span><span class="op" id="5717718">,</span>&nbsp;<span class="ident" id="5717720">name</span><span class="op" id="5717724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717729">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717740">case</span>&nbsp;<span class="string" id="5717745">&#34;.s&#34;</span><span class="op" id="5717749">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717754">p</span><span class="op" id="5717755">.</span><span class="ident" id="5717756">SFiles</span>&nbsp;<span class="op" id="5717763">=</span>&nbsp;<span class="builtinfunc" id="5717765">append</span><span class="op" id="5717771">(</span><span class="ident" id="5717772">p</span><span class="op" id="5717773">.</span><span class="ident" id="5717774">SFiles</span><span class="op" id="5717780">,</span>&nbsp;<span class="ident" id="5717782">name</span><span class="op" id="5717786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717791">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717802">case</span>&nbsp;<span class="string" id="5717807">&#34;.S&#34;</span><span class="op" id="5717811">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717816">Sfiles</span>&nbsp;<span class="op" id="5717823">=</span>&nbsp;<span class="builtinfunc" id="5717825">append</span><span class="op" id="5717831">(</span><span class="ident" id="5717832">Sfiles</span><span class="op" id="5717838">,</span>&nbsp;<span class="ident" id="5717840">name</span><span class="op" id="5717844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717849">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717860">case</span>&nbsp;<span class="string" id="5717865">&#34;.swig&#34;</span><span class="op" id="5717872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717877">p</span><span class="op" id="5717878">.</span><span class="ident" id="5717879">SwigFiles</span>&nbsp;<span class="op" id="5717889">=</span>&nbsp;<span class="builtinfunc" id="5717891">append</span><span class="op" id="5717897">(</span><span class="ident" id="5717898">p</span><span class="op" id="5717899">.</span><span class="ident" id="5717900">SwigFiles</span><span class="op" id="5717909">,</span>&nbsp;<span class="ident" id="5717911">name</span><span class="op" id="5717915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717920">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5717931">case</span>&nbsp;<span class="string" id="5717936">&#34;.swigcxx&#34;</span><span class="op" id="5717946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5717951">p</span><span class="op" id="5717952">.</span><span class="ident" id="5717953">SwigCXXFiles</span>&nbsp;<span class="op" id="5717966">=</span>&nbsp;<span class="builtinfunc" id="5717968">append</span><span class="op" id="5717974">(</span><span class="ident" id="5717975">p</span><span class="op" id="5717976">.</span><span class="ident" id="5717977">SwigCXXFiles</span><span class="op" id="5717989">,</span>&nbsp;<span class="ident" id="5717991">name</span><span class="op" id="5717995">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718000">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718011">case</span>&nbsp;<span class="string" id="5718016">&#34;.syso&#34;</span><span class="op" id="5718023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718028">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718075">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5718122">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718175">p</span><span class="op" id="5718176">.</span><span class="ident" id="5718177">SysoFiles</span>&nbsp;<span class="op" id="5718187">=</span>&nbsp;<span class="builtinfunc" id="5718189">append</span><span class="op" id="5718195">(</span><span class="ident" id="5718196">p</span><span class="op" id="5718197">.</span><span class="ident" id="5718198">SysoFiles</span><span class="op" id="5718207">,</span>&nbsp;<span class="ident" id="5718209">name</span><span class="op" id="5718213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718218">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718234">pf</span><span class="op" id="5718236">,</span>&nbsp;<span class="ident" id="5718238">err</span>&nbsp;<span class="op" id="5718242">:=</span>&nbsp;<span class="ident" id="5718245">parser</span><span class="op" id="5718251">.</span><span class="ident" id="5718252">ParseFile</span><span class="op" id="5718261">(</span><span class="ident" id="5718262">fset</span><span class="op" id="5718266">,</span>&nbsp;<span class="ident" id="5718268">filename</span><span class="op" id="5718276">,</span>&nbsp;<span class="ident" id="5718278">data</span><span class="op" id="5718282">,</span>&nbsp;<span class="ident" id="5718284">parser</span><span class="op" id="5718290">.</span><span class="ident" id="5718291">ImportsOnly</span><span class="op" id="5718302">|</span><span class="ident" id="5718303">parser</span><span class="op" id="5718309">.</span><span class="ident" id="5718310">ParseComments</span><span class="op" id="5718323">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718327">if</span>&nbsp;<span class="ident" id="5718330">err</span>&nbsp;<span class="op" id="5718334">!=</span>&nbsp;<span class="builtintype" id="5718337">nil</span>&nbsp;<span class="op" id="5718341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718346">return</span>&nbsp;<span class="ident" id="5718353">p</span><span class="op" id="5718354">,</span>&nbsp;<span class="ident" id="5718356">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718367">pkg</span>&nbsp;<span class="op" id="5718371">:=</span>&nbsp;<span class="ident" id="5718374">pf</span><span class="op" id="5718376">.</span><span class="ident" id="5718377">Name</span><span class="op" id="5718381">.</span><span class="ident" id="5718382">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718389">if</span>&nbsp;<span class="ident" id="5718392">pkg</span>&nbsp;<span class="op" id="5718396">==</span>&nbsp;<span class="string" id="5718399">&#34;documentation&#34;</span>&nbsp;<span class="op" id="5718415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718420">p</span><span class="op" id="5718421">.</span><span class="ident" id="5718422">IgnoredGoFiles</span>&nbsp;<span class="op" id="5718437">=</span>&nbsp;<span class="builtinfunc" id="5718439">append</span><span class="op" id="5718445">(</span><span class="ident" id="5718446">p</span><span class="op" id="5718447">.</span><span class="ident" id="5718448">IgnoredGoFiles</span><span class="op" id="5718462">,</span>&nbsp;<span class="ident" id="5718464">name</span><span class="op" id="5718468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718473">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718489">isTest</span>&nbsp;<span class="op" id="5718496">:=</span>&nbsp;<span class="ident" id="5718499">strings</span><span class="op" id="5718506">.</span><span class="ident" id="5718507">HasSuffix</span><span class="op" id="5718516">(</span><span class="ident" id="5718517">name</span><span class="op" id="5718521">,</span>&nbsp;<span class="string" id="5718523">&#34;_test.go&#34;</span><span class="op" id="5718533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718537">isXTest</span>&nbsp;<span class="op" id="5718545">:=</span>&nbsp;<span class="builtintype" id="5718548">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718556">if</span>&nbsp;<span class="ident" id="5718559">isTest</span>&nbsp;<span class="op" id="5718566">&amp;&amp;</span>&nbsp;<span class="ident" id="5718569">strings</span><span class="op" id="5718576">.</span><span class="ident" id="5718577">HasSuffix</span><span class="op" id="5718586">(</span><span class="ident" id="5718587">pkg</span><span class="op" id="5718590">,</span>&nbsp;<span class="string" id="5718592">&#34;_test&#34;</span><span class="op" id="5718599">)</span>&nbsp;<span class="op" id="5718601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718606">isXTest</span>&nbsp;<span class="op" id="5718614">=</span>&nbsp;<span class="builtintype" id="5718616">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718624">pkg</span>&nbsp;<span class="op" id="5718628">=</span>&nbsp;<span class="ident" id="5718630">pkg</span><span class="op" id="5718633">[</span><span class="op" id="5718634">:</span><span class="builtinfunc" id="5718635">len</span><span class="op" id="5718638">(</span><span class="ident" id="5718639">pkg</span><span class="op" id="5718642">)</span><span class="op" id="5718643">-</span><span class="builtinfunc" id="5718644">len</span><span class="op" id="5718647">(</span><span class="string" id="5718648">&#34;_test&#34;</span><span class="op" id="5718655">)</span><span class="op" id="5718656">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718665">if</span>&nbsp;<span class="ident" id="5718668">p</span><span class="op" id="5718669">.</span><span class="ident" id="5718670">Name</span>&nbsp;<span class="op" id="5718675">==</span>&nbsp;<span class="string" id="5718678">&#34;&#34;</span>&nbsp;<span class="op" id="5718681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718686">p</span><span class="op" id="5718687">.</span><span class="ident" id="5718688">Name</span>&nbsp;<span class="op" id="5718693">=</span>&nbsp;<span class="ident" id="5718695">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718702">firstFile</span>&nbsp;<span class="op" id="5718712">=</span>&nbsp;<span class="ident" id="5718714">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718721">}</span>&nbsp;<span class="keyword" id="5718723">else</span>&nbsp;<span class="keyword" id="5718728">if</span>&nbsp;<span class="ident" id="5718731">pkg</span>&nbsp;<span class="op" id="5718735">!=</span>&nbsp;<span class="ident" id="5718738">p</span><span class="op" id="5718739">.</span><span class="ident" id="5718740">Name</span>&nbsp;<span class="op" id="5718745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718750">return</span>&nbsp;<span class="ident" id="5718757">p</span><span class="op" id="5718758">,</span>&nbsp;<span class="op" id="5718760">&amp;</span><span class="ident" id="5718761">MultiplePackageError</span><span class="op" id="5718781">{</span><span class="ident" id="5718782">p</span><span class="op" id="5718783">.</span><span class="ident" id="5718784">Dir</span><span class="op" id="5718787">,</span>&nbsp;<span class="op" id="5718789">[</span><span class="op" id="5718790">]</span><span class="builtintype" id="5718791">string</span><span class="op" id="5718797">{</span><span class="ident" id="5718798">firstFile</span><span class="op" id="5718807">,</span>&nbsp;<span class="ident" id="5718809">name</span><span class="op" id="5718813">}</span><span class="op" id="5718814">,</span>&nbsp;<span class="op" id="5718816">[</span><span class="op" id="5718817">]</span><span class="builtintype" id="5718818">string</span><span class="op" id="5718824">{</span><span class="ident" id="5718825">p</span><span class="op" id="5718826">.</span><span class="ident" id="5718827">Name</span><span class="op" id="5718831">,</span>&nbsp;<span class="ident" id="5718833">pkg</span><span class="op" id="5718836">}</span><span class="op" id="5718837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718845">if</span>&nbsp;<span class="ident" id="5718848">pf</span><span class="op" id="5718850">.</span><span class="ident" id="5718851">Doc</span>&nbsp;<span class="op" id="5718855">!=</span>&nbsp;<span class="builtintype" id="5718858">nil</span>&nbsp;<span class="op" id="5718862">&amp;&amp;</span>&nbsp;<span class="ident" id="5718865">p</span><span class="op" id="5718866">.</span><span class="ident" id="5718867">Doc</span>&nbsp;<span class="op" id="5718871">==</span>&nbsp;<span class="string" id="5718874">&#34;&#34;</span>&nbsp;<span class="op" id="5718877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718882">p</span><span class="op" id="5718883">.</span><span class="ident" id="5718884">Doc</span>&nbsp;<span class="op" id="5718888">=</span>&nbsp;<span class="ident" id="5718890">doc</span><span class="op" id="5718893">.</span><span class="ident" id="5718894">Synopsis</span><span class="op" id="5718902">(</span><span class="ident" id="5718903">pf</span><span class="op" id="5718905">.</span><span class="ident" id="5718906">Doc</span><span class="op" id="5718909">.</span><span class="ident" id="5718910">Text</span><span class="op" id="5718914">(</span><span class="op" id="5718915">)</span><span class="op" id="5718916">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5718920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718925">if</span>&nbsp;<span class="ident" id="5718928">mode</span><span class="op" id="5718932">&amp;</span><span class="ident" id="5718933">ImportComment</span>&nbsp;<span class="op" id="5718947">!=</span>&nbsp;<span class="num" id="5718950">0</span>&nbsp;<span class="op" id="5718952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5718957">qcom</span><span class="op" id="5718961">,</span>&nbsp;<span class="ident" id="5718963">line</span>&nbsp;<span class="op" id="5718968">:=</span>&nbsp;<span class="ident" id="5718971">findImportComment</span><span class="op" id="5718988">(</span><span class="ident" id="5718989">data</span><span class="op" id="5718993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5718998">if</span>&nbsp;<span class="ident" id="5719001">line</span>&nbsp;<span class="op" id="5719006">!=</span>&nbsp;<span class="num" id="5719009">0</span>&nbsp;<span class="op" id="5719011">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719017">com</span><span class="op" id="5719020">,</span>&nbsp;<span class="ident" id="5719022">err</span>&nbsp;<span class="op" id="5719026">:=</span>&nbsp;<span class="ident" id="5719029">strconv</span><span class="op" id="5719036">.</span><span class="ident" id="5719037">Unquote</span><span class="op" id="5719044">(</span><span class="ident" id="5719045">qcom</span><span class="op" id="5719049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719055">if</span>&nbsp;<span class="ident" id="5719058">err</span>&nbsp;<span class="op" id="5719062">!=</span>&nbsp;<span class="builtintype" id="5719065">nil</span>&nbsp;<span class="op" id="5719069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719076">return</span>&nbsp;<span class="ident" id="5719083">p</span><span class="op" id="5719084">,</span>&nbsp;<span class="ident" id="5719086">fmt</span><span class="op" id="5719089">.</span><span class="ident" id="5719090">Errorf</span><span class="op" id="5719096">(</span><span class="string" id="5719097">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="5719133">,</span>&nbsp;<span class="ident" id="5719135">filename</span><span class="op" id="5719143">,</span>&nbsp;<span class="ident" id="5719145">line</span><span class="op" id="5719149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719161">if</span>&nbsp;<span class="ident" id="5719164">p</span><span class="op" id="5719165">.</span><span class="ident" id="5719166">ImportComment</span>&nbsp;<span class="op" id="5719180">==</span>&nbsp;<span class="string" id="5719183">&#34;&#34;</span>&nbsp;<span class="op" id="5719186">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719193">p</span><span class="op" id="5719194">.</span><span class="ident" id="5719195">ImportComment</span>&nbsp;<span class="op" id="5719209">=</span>&nbsp;<span class="ident" id="5719211">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719220">firstCommentFile</span>&nbsp;<span class="op" id="5719237">=</span>&nbsp;<span class="ident" id="5719239">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719248">}</span>&nbsp;<span class="keyword" id="5719250">else</span>&nbsp;<span class="keyword" id="5719255">if</span>&nbsp;<span class="ident" id="5719258">p</span><span class="op" id="5719259">.</span><span class="ident" id="5719260">ImportComment</span>&nbsp;<span class="op" id="5719274">!=</span>&nbsp;<span class="ident" id="5719277">com</span>&nbsp;<span class="op" id="5719281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719288">return</span>&nbsp;<span class="ident" id="5719295">p</span><span class="op" id="5719296">,</span>&nbsp;<span class="ident" id="5719298">fmt</span><span class="op" id="5719301">.</span><span class="ident" id="5719302">Errorf</span><span class="op" id="5719308">(</span><span class="string" id="5719309">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="5719358">,</span>&nbsp;<span class="ident" id="5719360">p</span><span class="op" id="5719361">.</span><span class="ident" id="5719362">ImportComment</span><span class="op" id="5719375">,</span>&nbsp;<span class="ident" id="5719377">firstCommentFile</span><span class="op" id="5719393">,</span>&nbsp;<span class="ident" id="5719395">com</span><span class="op" id="5719398">,</span>&nbsp;<span class="ident" id="5719400">name</span><span class="op" id="5719404">,</span>&nbsp;<span class="ident" id="5719406">p</span><span class="op" id="5719407">.</span><span class="ident" id="5719408">Dir</span><span class="op" id="5719411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719417">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5719431">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719478">isCgo</span>&nbsp;<span class="op" id="5719484">:=</span>&nbsp;<span class="builtintype" id="5719487">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719495">for</span>&nbsp;<span class="ident" id="5719499">_</span><span class="op" id="5719500">,</span>&nbsp;<span class="ident" id="5719502">decl</span>&nbsp;<span class="op" id="5719507">:=</span>&nbsp;<span class="keyword" id="5719510">range</span>&nbsp;<span class="ident" id="5719516">pf</span><span class="op" id="5719518">.</span><span class="ident" id="5719519">Decls</span>&nbsp;<span class="op" id="5719525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719530">d</span><span class="op" id="5719531">,</span>&nbsp;<span class="ident" id="5719533">ok</span>&nbsp;<span class="op" id="5719536">:=</span>&nbsp;<span class="ident" id="5719539">decl</span><span class="op" id="5719543">.</span><span class="op" id="5719544">(</span><span class="op" id="5719545">*</span><span class="ident" id="5719546">ast</span><span class="op" id="5719549">.</span><span class="ident" id="5719550">GenDecl</span><span class="op" id="5719557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719562">if</span>&nbsp;<span class="op" id="5719565">!</span><span class="ident" id="5719566">ok</span>&nbsp;<span class="op" id="5719569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719575">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719587">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719592">for</span>&nbsp;<span class="ident" id="5719596">_</span><span class="op" id="5719597">,</span>&nbsp;<span class="ident" id="5719599">dspec</span>&nbsp;<span class="op" id="5719605">:=</span>&nbsp;<span class="keyword" id="5719608">range</span>&nbsp;<span class="ident" id="5719614">d</span><span class="op" id="5719615">.</span><span class="ident" id="5719616">Specs</span>&nbsp;<span class="op" id="5719622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719628">spec</span><span class="op" id="5719632">,</span>&nbsp;<span class="ident" id="5719634">ok</span>&nbsp;<span class="op" id="5719637">:=</span>&nbsp;<span class="ident" id="5719640">dspec</span><span class="op" id="5719645">.</span><span class="op" id="5719646">(</span><span class="op" id="5719647">*</span><span class="ident" id="5719648">ast</span><span class="op" id="5719651">.</span><span class="ident" id="5719652">ImportSpec</span><span class="op" id="5719662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719668">if</span>&nbsp;<span class="op" id="5719671">!</span><span class="ident" id="5719672">ok</span>&nbsp;<span class="op" id="5719675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719682">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719695">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719701">quoted</span>&nbsp;<span class="op" id="5719708">:=</span>&nbsp;<span class="ident" id="5719711">spec</span><span class="op" id="5719715">.</span><span class="ident" id="5719716">Path</span><span class="op" id="5719720">.</span><span class="ident" id="5719721">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719731">path</span><span class="op" id="5719735">,</span>&nbsp;<span class="ident" id="5719737">err</span>&nbsp;<span class="op" id="5719741">:=</span>&nbsp;<span class="ident" id="5719744">strconv</span><span class="op" id="5719751">.</span><span class="ident" id="5719752">Unquote</span><span class="op" id="5719759">(</span><span class="ident" id="5719760">quoted</span><span class="op" id="5719766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719772">if</span>&nbsp;<span class="ident" id="5719775">err</span>&nbsp;<span class="op" id="5719779">!=</span>&nbsp;<span class="builtintype" id="5719782">nil</span>&nbsp;<span class="op" id="5719786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719793">log</span><span class="op" id="5719796">.</span><span class="ident" id="5719797">Panicf</span><span class="op" id="5719803">(</span><span class="string" id="5719804">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="5719853">,</span>&nbsp;<span class="ident" id="5719855">filename</span><span class="op" id="5719863">,</span>&nbsp;<span class="ident" id="5719865">quoted</span><span class="op" id="5719871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719877">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5719883">if</span>&nbsp;<span class="ident" id="5719886">isXTest</span>&nbsp;<span class="op" id="5719894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5719901">xTestImported</span><span class="op" id="5719914">[</span><span class="ident" id="5719915">path</span><span class="op" id="5719919">]</span>&nbsp;<span class="op" id="5719921">=</span>&nbsp;<span class="builtinfunc" id="5719923">append</span><span class="op" id="5719929">(</span><span class="ident" id="5719930">xTestImported</span><span class="op" id="5719943">[</span><span class="ident" id="5719944">path</span><span class="op" id="5719948">]</span><span class="op" id="5719949">,</span>&nbsp;<span class="ident" id="5719951">fset</span><span class="op" id="5719955">.</span><span class="ident" id="5719956">Position</span><span class="op" id="5719964">(</span><span class="ident" id="5719965">spec</span><span class="op" id="5719969">.</span><span class="ident" id="5719970">Pos</span><span class="op" id="5719973">(</span><span class="op" id="5719974">)</span><span class="op" id="5719975">)</span><span class="op" id="5719976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5719982">}</span>&nbsp;<span class="keyword" id="5719984">else</span>&nbsp;<span class="keyword" id="5719989">if</span>&nbsp;<span class="ident" id="5719992">isTest</span>&nbsp;<span class="op" id="5719999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720006">testImported</span><span class="op" id="5720018">[</span><span class="ident" id="5720019">path</span><span class="op" id="5720023">]</span>&nbsp;<span class="op" id="5720025">=</span>&nbsp;<span class="builtinfunc" id="5720027">append</span><span class="op" id="5720033">(</span><span class="ident" id="5720034">testImported</span><span class="op" id="5720046">[</span><span class="ident" id="5720047">path</span><span class="op" id="5720051">]</span><span class="op" id="5720052">,</span>&nbsp;<span class="ident" id="5720054">fset</span><span class="op" id="5720058">.</span><span class="ident" id="5720059">Position</span><span class="op" id="5720067">(</span><span class="ident" id="5720068">spec</span><span class="op" id="5720072">.</span><span class="ident" id="5720073">Pos</span><span class="op" id="5720076">(</span><span class="op" id="5720077">)</span><span class="op" id="5720078">)</span><span class="op" id="5720079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720085">}</span>&nbsp;<span class="keyword" id="5720087">else</span>&nbsp;<span class="op" id="5720092">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720099">imported</span><span class="op" id="5720107">[</span><span class="ident" id="5720108">path</span><span class="op" id="5720112">]</span>&nbsp;<span class="op" id="5720114">=</span>&nbsp;<span class="builtinfunc" id="5720116">append</span><span class="op" id="5720122">(</span><span class="ident" id="5720123">imported</span><span class="op" id="5720131">[</span><span class="ident" id="5720132">path</span><span class="op" id="5720136">]</span><span class="op" id="5720137">,</span>&nbsp;<span class="ident" id="5720139">fset</span><span class="op" id="5720143">.</span><span class="ident" id="5720144">Position</span><span class="op" id="5720152">(</span><span class="ident" id="5720153">spec</span><span class="op" id="5720157">.</span><span class="ident" id="5720158">Pos</span><span class="op" id="5720161">(</span><span class="op" id="5720162">)</span><span class="op" id="5720163">)</span><span class="op" id="5720164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720176">if</span>&nbsp;<span class="ident" id="5720179">path</span>&nbsp;<span class="op" id="5720184">==</span>&nbsp;<span class="string" id="5720187">&#34;C&#34;</span>&nbsp;<span class="op" id="5720191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720198">if</span>&nbsp;<span class="ident" id="5720201">isTest</span>&nbsp;<span class="op" id="5720208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720216">return</span>&nbsp;<span class="ident" id="5720223">p</span><span class="op" id="5720224">,</span>&nbsp;<span class="ident" id="5720226">fmt</span><span class="op" id="5720229">.</span><span class="ident" id="5720230">Errorf</span><span class="op" id="5720236">(</span><span class="string" id="5720237">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="5720274">,</span>&nbsp;<span class="ident" id="5720276">filename</span><span class="op" id="5720284">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720298">cg</span>&nbsp;<span class="op" id="5720301">:=</span>&nbsp;<span class="ident" id="5720304">spec</span><span class="op" id="5720308">.</span><span class="ident" id="5720309">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720318">if</span>&nbsp;<span class="ident" id="5720321">cg</span>&nbsp;<span class="op" id="5720324">==</span>&nbsp;<span class="builtintype" id="5720327">nil</span>&nbsp;<span class="op" id="5720331">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5720334">len</span><span class="op" id="5720337">(</span><span class="ident" id="5720338">d</span><span class="op" id="5720339">.</span><span class="ident" id="5720340">Specs</span><span class="op" id="5720345">)</span>&nbsp;<span class="op" id="5720347">==</span>&nbsp;<span class="num" id="5720350">1</span>&nbsp;<span class="op" id="5720352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720360">cg</span>&nbsp;<span class="op" id="5720363">=</span>&nbsp;<span class="ident" id="5720365">d</span><span class="op" id="5720366">.</span><span class="ident" id="5720367">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720376">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720383">if</span>&nbsp;<span class="ident" id="5720386">cg</span>&nbsp;<span class="op" id="5720389">!=</span>&nbsp;<span class="builtintype" id="5720392">nil</span>&nbsp;<span class="op" id="5720396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720404">if</span>&nbsp;<span class="ident" id="5720407">err</span>&nbsp;<span class="op" id="5720411">:=</span>&nbsp;<span class="ident" id="5720414">ctxt</span><span class="op" id="5720418">.</span><span class="ident" id="5720419">saveCgo</span><span class="op" id="5720426">(</span><span class="ident" id="5720427">filename</span><span class="op" id="5720435">,</span>&nbsp;<span class="ident" id="5720437">p</span><span class="op" id="5720438">,</span>&nbsp;<span class="ident" id="5720440">cg</span><span class="op" id="5720442">)</span><span class="op" id="5720443">;</span>&nbsp;<span class="ident" id="5720445">err</span>&nbsp;<span class="op" id="5720449">!=</span>&nbsp;<span class="builtintype" id="5720452">nil</span>&nbsp;<span class="op" id="5720456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720465">return</span>&nbsp;<span class="ident" id="5720472">p</span><span class="op" id="5720473">,</span>&nbsp;<span class="ident" id="5720475">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720492">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720499">isCgo</span>&nbsp;<span class="op" id="5720505">=</span>&nbsp;<span class="builtintype" id="5720507">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720529">if</span>&nbsp;<span class="ident" id="5720532">isCgo</span>&nbsp;<span class="op" id="5720538">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720543">allTags</span><span class="op" id="5720550">[</span><span class="string" id="5720551">&#34;cgo&#34;</span><span class="op" id="5720556">]</span>&nbsp;<span class="op" id="5720558">=</span>&nbsp;<span class="builtintype" id="5720560">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720568">if</span>&nbsp;<span class="ident" id="5720571">ctxt</span><span class="op" id="5720575">.</span><span class="ident" id="5720576">CgoEnabled</span>&nbsp;<span class="op" id="5720587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720593">p</span><span class="op" id="5720594">.</span><span class="ident" id="5720595">CgoFiles</span>&nbsp;<span class="op" id="5720604">=</span>&nbsp;<span class="builtinfunc" id="5720606">append</span><span class="op" id="5720612">(</span><span class="ident" id="5720613">p</span><span class="op" id="5720614">.</span><span class="ident" id="5720615">CgoFiles</span><span class="op" id="5720623">,</span>&nbsp;<span class="ident" id="5720625">name</span><span class="op" id="5720629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720634">}</span>&nbsp;<span class="keyword" id="5720636">else</span>&nbsp;<span class="op" id="5720641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720647">p</span><span class="op" id="5720648">.</span><span class="ident" id="5720649">IgnoredGoFiles</span>&nbsp;<span class="op" id="5720664">=</span>&nbsp;<span class="builtinfunc" id="5720666">append</span><span class="op" id="5720672">(</span><span class="ident" id="5720673">p</span><span class="op" id="5720674">.</span><span class="ident" id="5720675">IgnoredGoFiles</span><span class="op" id="5720689">,</span>&nbsp;<span class="ident" id="5720691">name</span><span class="op" id="5720695">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720704">}</span>&nbsp;<span class="keyword" id="5720706">else</span>&nbsp;<span class="keyword" id="5720711">if</span>&nbsp;<span class="ident" id="5720714">isXTest</span>&nbsp;<span class="op" id="5720722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720727">p</span><span class="op" id="5720728">.</span><span class="ident" id="5720729">XTestGoFiles</span>&nbsp;<span class="op" id="5720742">=</span>&nbsp;<span class="builtinfunc" id="5720744">append</span><span class="op" id="5720750">(</span><span class="ident" id="5720751">p</span><span class="op" id="5720752">.</span><span class="ident" id="5720753">XTestGoFiles</span><span class="op" id="5720765">,</span>&nbsp;<span class="ident" id="5720767">name</span><span class="op" id="5720771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720775">}</span>&nbsp;<span class="keyword" id="5720777">else</span>&nbsp;<span class="keyword" id="5720782">if</span>&nbsp;<span class="ident" id="5720785">isTest</span>&nbsp;<span class="op" id="5720792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720797">p</span><span class="op" id="5720798">.</span><span class="ident" id="5720799">TestGoFiles</span>&nbsp;<span class="op" id="5720811">=</span>&nbsp;<span class="builtinfunc" id="5720813">append</span><span class="op" id="5720819">(</span><span class="ident" id="5720820">p</span><span class="op" id="5720821">.</span><span class="ident" id="5720822">TestGoFiles</span><span class="op" id="5720833">,</span>&nbsp;<span class="ident" id="5720835">name</span><span class="op" id="5720839">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720843">}</span>&nbsp;<span class="keyword" id="5720845">else</span>&nbsp;<span class="op" id="5720850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720855">p</span><span class="op" id="5720856">.</span><span class="ident" id="5720857">GoFiles</span>&nbsp;<span class="op" id="5720865">=</span>&nbsp;<span class="builtinfunc" id="5720867">append</span><span class="op" id="5720873">(</span><span class="ident" id="5720874">p</span><span class="op" id="5720875">.</span><span class="ident" id="5720876">GoFiles</span><span class="op" id="5720883">,</span>&nbsp;<span class="ident" id="5720885">name</span><span class="op" id="5720889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5720896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720899">if</span>&nbsp;<span class="builtinfunc" id="5720902">len</span><span class="op" id="5720905">(</span><span class="ident" id="5720906">p</span><span class="op" id="5720907">.</span><span class="ident" id="5720908">GoFiles</span><span class="op" id="5720915">)</span><span class="op" id="5720916">+</span><span class="builtinfunc" id="5720917">len</span><span class="op" id="5720920">(</span><span class="ident" id="5720921">p</span><span class="op" id="5720922">.</span><span class="ident" id="5720923">CgoFiles</span><span class="op" id="5720931">)</span><span class="op" id="5720932">+</span><span class="builtinfunc" id="5720933">len</span><span class="op" id="5720936">(</span><span class="ident" id="5720937">p</span><span class="op" id="5720938">.</span><span class="ident" id="5720939">TestGoFiles</span><span class="op" id="5720950">)</span><span class="op" id="5720951">+</span><span class="builtinfunc" id="5720952">len</span><span class="op" id="5720955">(</span><span class="ident" id="5720956">p</span><span class="op" id="5720957">.</span><span class="ident" id="5720958">XTestGoFiles</span><span class="op" id="5720970">)</span>&nbsp;<span class="op" id="5720972">==</span>&nbsp;<span class="num" id="5720975">0</span>&nbsp;<span class="op" id="5720977">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5720981">return</span>&nbsp;<span class="ident" id="5720988">p</span><span class="op" id="5720989">,</span>&nbsp;<span class="op" id="5720991">&amp;</span><span class="ident" id="5720992">NoGoError</span><span class="op" id="5721001">{</span><span class="ident" id="5721002">p</span><span class="op" id="5721003">.</span><span class="ident" id="5721004">Dir</span><span class="op" id="5721007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721014">for</span>&nbsp;<span class="ident" id="5721018">tag</span>&nbsp;<span class="op" id="5721022">:=</span>&nbsp;<span class="keyword" id="5721025">range</span>&nbsp;<span class="ident" id="5721031">allTags</span>&nbsp;<span class="op" id="5721039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721043">p</span><span class="op" id="5721044">.</span><span class="ident" id="5721045">AllTags</span>&nbsp;<span class="op" id="5721053">=</span>&nbsp;<span class="builtinfunc" id="5721055">append</span><span class="op" id="5721061">(</span><span class="ident" id="5721062">p</span><span class="op" id="5721063">.</span><span class="ident" id="5721064">AllTags</span><span class="op" id="5721071">,</span>&nbsp;<span class="ident" id="5721073">tag</span><span class="op" id="5721076">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721082">sort</span><span class="op" id="5721086">.</span><span class="ident" id="5721087">Strings</span><span class="op" id="5721094">(</span><span class="ident" id="5721095">p</span><span class="op" id="5721096">.</span><span class="ident" id="5721097">AllTags</span><span class="op" id="5721104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721108">p</span><span class="op" id="5721109">.</span><span class="ident" id="5721110">Imports</span><span class="op" id="5721117">,</span>&nbsp;<span class="ident" id="5721119">p</span><span class="op" id="5721120">.</span><span class="ident" id="5721121">ImportPos</span>&nbsp;<span class="op" id="5721131">=</span>&nbsp;<span class="ident" id="5721133">cleanImports</span><span class="op" id="5721145">(</span><span class="ident" id="5721146">imported</span><span class="op" id="5721154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721157">p</span><span class="op" id="5721158">.</span><span class="ident" id="5721159">TestImports</span><span class="op" id="5721170">,</span>&nbsp;<span class="ident" id="5721172">p</span><span class="op" id="5721173">.</span><span class="ident" id="5721174">TestImportPos</span>&nbsp;<span class="op" id="5721188">=</span>&nbsp;<span class="ident" id="5721190">cleanImports</span><span class="op" id="5721202">(</span><span class="ident" id="5721203">testImported</span><span class="op" id="5721215">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721218">p</span><span class="op" id="5721219">.</span><span class="ident" id="5721220">XTestImports</span><span class="op" id="5721232">,</span>&nbsp;<span class="ident" id="5721234">p</span><span class="op" id="5721235">.</span><span class="ident" id="5721236">XTestImportPos</span>&nbsp;<span class="op" id="5721251">=</span>&nbsp;<span class="ident" id="5721253">cleanImports</span><span class="op" id="5721265">(</span><span class="ident" id="5721266">xTestImported</span><span class="op" id="5721279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721283">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721329">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721370">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721415">if</span>&nbsp;<span class="builtinfunc" id="5721418">len</span><span class="op" id="5721421">(</span><span class="ident" id="5721422">p</span><span class="op" id="5721423">.</span><span class="ident" id="5721424">CgoFiles</span><span class="op" id="5721432">)</span>&nbsp;<span class="op" id="5721434">&gt;</span>&nbsp;<span class="num" id="5721436">0</span>&nbsp;<span class="op" id="5721438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721442">p</span><span class="op" id="5721443">.</span><span class="ident" id="5721444">SFiles</span>&nbsp;<span class="op" id="5721451">=</span>&nbsp;<span class="builtinfunc" id="5721453">append</span><span class="op" id="5721459">(</span><span class="ident" id="5721460">p</span><span class="op" id="5721461">.</span><span class="ident" id="5721462">SFiles</span><span class="op" id="5721468">,</span>&nbsp;<span class="ident" id="5721470">Sfiles</span><span class="op" id="5721476">...</span><span class="op" id="5721479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721483">sort</span><span class="op" id="5721487">.</span><span class="ident" id="5721488">Strings</span><span class="op" id="5721495">(</span><span class="ident" id="5721496">p</span><span class="op" id="5721497">.</span><span class="ident" id="5721498">SFiles</span><span class="op" id="5721504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721511">return</span>&nbsp;<span class="ident" id="5721518">p</span><span class="op" id="5721519">,</span>&nbsp;<span class="ident" id="5721521">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="5721528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721531">func</span>&nbsp;<span class="ident" id="5721536">findImportComment</span><span class="op" id="5721553">(</span><span class="ident" id="5721554">data</span>&nbsp;<span class="op" id="5721559">[</span><span class="op" id="5721560">]</span><span class="builtintype" id="5721561">byte</span><span class="op" id="5721565">)</span>&nbsp;<span class="op" id="5721567">(</span><span class="ident" id="5721568">s</span>&nbsp;<span class="builtintype" id="5721570">string</span><span class="op" id="5721576">,</span>&nbsp;<span class="ident" id="5721578">line</span>&nbsp;<span class="builtintype" id="5721583">int</span><span class="op" id="5721586">)</span>&nbsp;<span class="op" id="5721588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721591">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721618">word</span><span class="op" id="5721622">,</span>&nbsp;<span class="ident" id="5721624">data</span>&nbsp;<span class="op" id="5721629">:=</span>&nbsp;<span class="ident" id="5721632">parseWord</span><span class="op" id="5721641">(</span><span class="ident" id="5721642">data</span><span class="op" id="5721646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721649">if</span>&nbsp;<span class="builtintype" id="5721652">string</span><span class="op" id="5721658">(</span><span class="ident" id="5721659">word</span><span class="op" id="5721663">)</span>&nbsp;<span class="op" id="5721665">!=</span>&nbsp;<span class="string" id="5721668">&#34;package&#34;</span>&nbsp;<span class="op" id="5721678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721682">return</span>&nbsp;<span class="string" id="5721689">&#34;&#34;</span><span class="op" id="5721691">,</span>&nbsp;<span class="num" id="5721693">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721700">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721724">_</span><span class="op" id="5721725">,</span>&nbsp;<span class="ident" id="5721727">data</span>&nbsp;<span class="op" id="5721732">=</span>&nbsp;<span class="ident" id="5721734">parseWord</span><span class="op" id="5721743">(</span><span class="ident" id="5721744">data</span><span class="op" id="5721748">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721752">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5721808">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721854">for</span>&nbsp;<span class="builtinfunc" id="5721858">len</span><span class="op" id="5721861">(</span><span class="ident" id="5721862">data</span><span class="op" id="5721866">)</span>&nbsp;<span class="op" id="5721868">&gt;</span>&nbsp;<span class="num" id="5721870">0</span>&nbsp;<span class="op" id="5721872">&amp;&amp;</span>&nbsp;<span class="op" id="5721875">(</span><span class="ident" id="5721876">data</span><span class="op" id="5721880">[</span><span class="num" id="5721881">0</span><span class="op" id="5721882">]</span>&nbsp;<span class="op" id="5721884">==</span>&nbsp;<span class="string" id="5721887">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5721891">||</span>&nbsp;<span class="ident" id="5721894">data</span><span class="op" id="5721898">[</span><span class="num" id="5721899">0</span><span class="op" id="5721900">]</span>&nbsp;<span class="op" id="5721902">==</span>&nbsp;<span class="string" id="5721905">&#39;\t&#39;</span>&nbsp;<span class="op" id="5721910">||</span>&nbsp;<span class="ident" id="5721913">data</span><span class="op" id="5721917">[</span><span class="num" id="5721918">0</span><span class="op" id="5721919">]</span>&nbsp;<span class="op" id="5721921">==</span>&nbsp;<span class="string" id="5721924">&#39;\r&#39;</span><span class="op" id="5721928">)</span>&nbsp;<span class="op" id="5721930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5721934">data</span>&nbsp;<span class="op" id="5721939">=</span>&nbsp;<span class="ident" id="5721941">data</span><span class="op" id="5721945">[</span><span class="num" id="5721946">1</span><span class="op" id="5721947">:</span><span class="op" id="5721948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721955">var</span>&nbsp;<span class="ident" id="5721959">comment</span>&nbsp;<span class="op" id="5721967">[</span><span class="op" id="5721968">]</span><span class="builtintype" id="5721969">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721975">switch</span>&nbsp;<span class="op" id="5721982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5721985">case</span>&nbsp;<span class="ident" id="5721990">bytes</span><span class="op" id="5721995">.</span><span class="ident" id="5721996">HasPrefix</span><span class="op" id="5722005">(</span><span class="ident" id="5722006">data</span><span class="op" id="5722010">,</span>&nbsp;<span class="ident" id="5722012">slashSlash</span><span class="op" id="5722022">)</span><span class="op" id="5722023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722027">i</span>&nbsp;<span class="op" id="5722029">:=</span>&nbsp;<span class="ident" id="5722032">bytes</span><span class="op" id="5722037">.</span><span class="ident" id="5722038">Index</span><span class="op" id="5722043">(</span><span class="ident" id="5722044">data</span><span class="op" id="5722048">,</span>&nbsp;<span class="ident" id="5722050">newline</span><span class="op" id="5722057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722061">if</span>&nbsp;<span class="ident" id="5722064">i</span>&nbsp;<span class="op" id="5722066">&lt;</span>&nbsp;<span class="num" id="5722068">0</span>&nbsp;<span class="op" id="5722070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722075">i</span>&nbsp;<span class="op" id="5722077">=</span>&nbsp;<span class="builtinfunc" id="5722079">len</span><span class="op" id="5722082">(</span><span class="ident" id="5722083">data</span><span class="op" id="5722087">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722095">comment</span>&nbsp;<span class="op" id="5722103">=</span>&nbsp;<span class="ident" id="5722105">data</span><span class="op" id="5722109">[</span><span class="num" id="5722110">2</span><span class="op" id="5722111">:</span><span class="ident" id="5722112">i</span><span class="op" id="5722113">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722116">case</span>&nbsp;<span class="ident" id="5722121">bytes</span><span class="op" id="5722126">.</span><span class="ident" id="5722127">HasPrefix</span><span class="op" id="5722136">(</span><span class="ident" id="5722137">data</span><span class="op" id="5722141">,</span>&nbsp;<span class="ident" id="5722143">slashStar</span><span class="op" id="5722152">)</span><span class="op" id="5722153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722157">data</span>&nbsp;<span class="op" id="5722162">=</span>&nbsp;<span class="ident" id="5722164">data</span><span class="op" id="5722168">[</span><span class="num" id="5722169">2</span><span class="op" id="5722170">:</span><span class="op" id="5722171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722175">i</span>&nbsp;<span class="op" id="5722177">:=</span>&nbsp;<span class="ident" id="5722180">bytes</span><span class="op" id="5722185">.</span><span class="ident" id="5722186">Index</span><span class="op" id="5722191">(</span><span class="ident" id="5722192">data</span><span class="op" id="5722196">,</span>&nbsp;<span class="ident" id="5722198">starSlash</span><span class="op" id="5722207">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722211">if</span>&nbsp;<span class="ident" id="5722214">i</span>&nbsp;<span class="op" id="5722216">&lt;</span>&nbsp;<span class="num" id="5722218">0</span>&nbsp;<span class="op" id="5722220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5722225">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722249">return</span>&nbsp;<span class="string" id="5722256">&#34;&#34;</span><span class="op" id="5722258">,</span>&nbsp;<span class="num" id="5722260">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722268">comment</span>&nbsp;<span class="op" id="5722276">=</span>&nbsp;<span class="ident" id="5722278">data</span><span class="op" id="5722282">[</span><span class="op" id="5722283">:</span><span class="ident" id="5722284">i</span><span class="op" id="5722285">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722289">if</span>&nbsp;<span class="ident" id="5722292">bytes</span><span class="op" id="5722297">.</span><span class="ident" id="5722298">Contains</span><span class="op" id="5722306">(</span><span class="ident" id="5722307">comment</span><span class="op" id="5722314">,</span>&nbsp;<span class="ident" id="5722316">newline</span><span class="op" id="5722323">)</span>&nbsp;<span class="op" id="5722325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722330">return</span>&nbsp;<span class="string" id="5722337">&#34;&#34;</span><span class="op" id="5722339">,</span>&nbsp;<span class="num" id="5722341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722351">comment</span>&nbsp;<span class="op" id="5722359">=</span>&nbsp;<span class="ident" id="5722361">bytes</span><span class="op" id="5722366">.</span><span class="ident" id="5722367">TrimSpace</span><span class="op" id="5722376">(</span><span class="ident" id="5722377">comment</span><span class="op" id="5722384">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5722388">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722429">word</span><span class="op" id="5722433">,</span>&nbsp;<span class="ident" id="5722435">arg</span>&nbsp;<span class="op" id="5722439">:=</span>&nbsp;<span class="ident" id="5722442">parseWord</span><span class="op" id="5722451">(</span><span class="ident" id="5722452">comment</span><span class="op" id="5722459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722462">if</span>&nbsp;<span class="builtintype" id="5722465">string</span><span class="op" id="5722471">(</span><span class="ident" id="5722472">word</span><span class="op" id="5722476">)</span>&nbsp;<span class="op" id="5722478">!=</span>&nbsp;<span class="string" id="5722481">&#34;import&#34;</span>&nbsp;<span class="op" id="5722490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722494">return</span>&nbsp;<span class="string" id="5722501">&#34;&#34;</span><span class="op" id="5722503">,</span>&nbsp;<span class="num" id="5722505">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722512">line</span>&nbsp;<span class="op" id="5722517">=</span>&nbsp;<span class="num" id="5722519">1</span>&nbsp;<span class="op" id="5722521">+</span>&nbsp;<span class="ident" id="5722523">bytes</span><span class="op" id="5722528">.</span><span class="ident" id="5722529">Count</span><span class="op" id="5722534">(</span><span class="ident" id="5722535">data</span><span class="op" id="5722539">[</span><span class="op" id="5722540">:</span><span class="builtinfunc" id="5722541">cap</span><span class="op" id="5722544">(</span><span class="ident" id="5722545">data</span><span class="op" id="5722549">)</span><span class="op" id="5722550">-</span><span class="builtinfunc" id="5722551">cap</span><span class="op" id="5722554">(</span><span class="ident" id="5722555">arg</span><span class="op" id="5722558">)</span><span class="op" id="5722559">]</span><span class="op" id="5722560">,</span>&nbsp;<span class="ident" id="5722562">newline</span><span class="op" id="5722569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722572">return</span>&nbsp;<span class="ident" id="5722579">strings</span><span class="op" id="5722586">.</span><span class="ident" id="5722587">TrimSpace</span><span class="op" id="5722596">(</span><span class="builtintype" id="5722597">string</span><span class="op" id="5722603">(</span><span class="ident" id="5722604">arg</span><span class="op" id="5722607">)</span><span class="op" id="5722608">)</span><span class="op" id="5722609">,</span>&nbsp;<span class="ident" id="5722611">line</span><br>
<span class="lineno"></span><span class="op" id="5722616">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="5722619">var</span>&nbsp;<span class="op" id="5722623">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722626">slashSlash</span>&nbsp;<span class="op" id="5722637">=</span>&nbsp;<span class="op" id="5722639">[</span><span class="op" id="5722640">]</span><span class="builtintype" id="5722641">byte</span><span class="op" id="5722645">(</span><span class="string" id="5722646">&#34;//&#34;</span><span class="op" id="5722650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722653">slashStar</span>&nbsp;&nbsp;<span class="op" id="5722664">=</span>&nbsp;<span class="op" id="5722666">[</span><span class="op" id="5722667">]</span><span class="builtintype" id="5722668">byte</span><span class="op" id="5722672">(</span><span class="string" id="5722673">&#34;/*&#34;</span><span class="op" id="5722677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722680">starSlash</span>&nbsp;&nbsp;<span class="op" id="5722691">=</span>&nbsp;<span class="op" id="5722693">[</span><span class="op" id="5722694">]</span><span class="builtintype" id="5722695">byte</span><span class="op" id="5722699">(</span><span class="string" id="5722700">&#34;*/&#34;</span><span class="op" id="5722704">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722707">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5722718">=</span>&nbsp;<span class="op" id="5722720">[</span><span class="op" id="5722721">]</span><span class="builtintype" id="5722722">byte</span><span class="op" id="5722726">(</span><span class="string" id="5722727">&#34;\n&#34;</span><span class="op" id="5722731">)</span><br>
<span class="lineno"></span><span class="op" id="5722733">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5722736">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="5722816">func</span>&nbsp;<span class="ident" id="5722821">skipSpaceOrComment</span><span class="op" id="5722839">(</span><span class="ident" id="5722840">data</span>&nbsp;<span class="op" id="5722845">[</span><span class="op" id="5722846">]</span><span class="builtintype" id="5722847">byte</span><span class="op" id="5722851">)</span>&nbsp;<span class="op" id="5722853">[</span><span class="op" id="5722854">]</span><span class="builtintype" id="5722855">byte</span>&nbsp;<span class="op" id="5722860">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722863">for</span>&nbsp;<span class="builtinfunc" id="5722867">len</span><span class="op" id="5722870">(</span><span class="ident" id="5722871">data</span><span class="op" id="5722875">)</span>&nbsp;<span class="op" id="5722877">&gt;</span>&nbsp;<span class="num" id="5722879">0</span>&nbsp;<span class="op" id="5722881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722885">switch</span>&nbsp;<span class="ident" id="5722892">data</span><span class="op" id="5722896">[</span><span class="num" id="5722897">0</span><span class="op" id="5722898">]</span>&nbsp;<span class="op" id="5722900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722904">case</span>&nbsp;<span class="string" id="5722909">&#39;&nbsp;&#39;</span><span class="op" id="5722912">,</span>&nbsp;<span class="string" id="5722914">&#39;\t&#39;</span><span class="op" id="5722918">,</span>&nbsp;<span class="string" id="5722920">&#39;\r&#39;</span><span class="op" id="5722924">,</span>&nbsp;<span class="string" id="5722926">&#39;\n&#39;</span><span class="op" id="5722930">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5722935">data</span>&nbsp;<span class="op" id="5722940">=</span>&nbsp;<span class="ident" id="5722942">data</span><span class="op" id="5722946">[</span><span class="num" id="5722947">1</span><span class="op" id="5722948">:</span><span class="op" id="5722949">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722954">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722965">case</span>&nbsp;<span class="string" id="5722970">&#39;/&#39;</span><span class="op" id="5722973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5722978">if</span>&nbsp;<span class="ident" id="5722981">bytes</span><span class="op" id="5722986">.</span><span class="ident" id="5722987">HasPrefix</span><span class="op" id="5722996">(</span><span class="ident" id="5722997">data</span><span class="op" id="5723001">,</span>&nbsp;<span class="ident" id="5723003">slashSlash</span><span class="op" id="5723013">)</span>&nbsp;<span class="op" id="5723015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723021">i</span>&nbsp;<span class="op" id="5723023">:=</span>&nbsp;<span class="ident" id="5723026">bytes</span><span class="op" id="5723031">.</span><span class="ident" id="5723032">Index</span><span class="op" id="5723037">(</span><span class="ident" id="5723038">data</span><span class="op" id="5723042">,</span>&nbsp;<span class="ident" id="5723044">newline</span><span class="op" id="5723051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723057">if</span>&nbsp;<span class="ident" id="5723060">i</span>&nbsp;<span class="op" id="5723062">&lt;</span>&nbsp;<span class="num" id="5723064">0</span>&nbsp;<span class="op" id="5723066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723073">return</span>&nbsp;<span class="builtintype" id="5723080">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723094">data</span>&nbsp;<span class="op" id="5723099">=</span>&nbsp;<span class="ident" id="5723101">data</span><span class="op" id="5723105">[</span><span class="ident" id="5723106">i</span><span class="op" id="5723107">+</span><span class="num" id="5723108">1</span><span class="op" id="5723109">:</span><span class="op" id="5723110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723116">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723133">if</span>&nbsp;<span class="ident" id="5723136">bytes</span><span class="op" id="5723141">.</span><span class="ident" id="5723142">HasPrefix</span><span class="op" id="5723151">(</span><span class="ident" id="5723152">data</span><span class="op" id="5723156">,</span>&nbsp;<span class="ident" id="5723158">slashStar</span><span class="op" id="5723167">)</span>&nbsp;<span class="op" id="5723169">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723175">data</span>&nbsp;<span class="op" id="5723180">=</span>&nbsp;<span class="ident" id="5723182">data</span><span class="op" id="5723186">[</span><span class="num" id="5723187">2</span><span class="op" id="5723188">:</span><span class="op" id="5723189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723195">i</span>&nbsp;<span class="op" id="5723197">:=</span>&nbsp;<span class="ident" id="5723200">bytes</span><span class="op" id="5723205">.</span><span class="ident" id="5723206">Index</span><span class="op" id="5723211">(</span><span class="ident" id="5723212">data</span><span class="op" id="5723216">,</span>&nbsp;<span class="ident" id="5723218">starSlash</span><span class="op" id="5723227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723233">if</span>&nbsp;<span class="ident" id="5723236">i</span>&nbsp;<span class="op" id="5723238">&lt;</span>&nbsp;<span class="num" id="5723240">0</span>&nbsp;<span class="op" id="5723242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723249">return</span>&nbsp;<span class="builtintype" id="5723256">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723264">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723270">data</span>&nbsp;<span class="op" id="5723275">=</span>&nbsp;<span class="ident" id="5723277">data</span><span class="op" id="5723281">[</span><span class="ident" id="5723282">i</span><span class="op" id="5723283">+</span><span class="num" id="5723284">2</span><span class="op" id="5723285">:</span><span class="op" id="5723286">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723292">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723312">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723322">return</span>&nbsp;<span class="ident" id="5723329">data</span><br>
<span class="lineno"></span><span class="op" id="5723334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723337">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="5723395">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="5723465">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="5723521">func</span>&nbsp;<span class="ident" id="5723526">parseWord</span><span class="op" id="5723535">(</span><span class="ident" id="5723536">data</span>&nbsp;<span class="op" id="5723541">[</span><span class="op" id="5723542">]</span><span class="builtintype" id="5723543">byte</span><span class="op" id="5723547">)</span>&nbsp;<span class="op" id="5723549">(</span><span class="ident" id="5723550">word</span><span class="op" id="5723554">,</span>&nbsp;<span class="ident" id="5723556">rest</span>&nbsp;<span class="op" id="5723561">[</span><span class="op" id="5723562">]</span><span class="builtintype" id="5723563">byte</span><span class="op" id="5723567">)</span>&nbsp;<span class="op" id="5723569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723572">data</span>&nbsp;<span class="op" id="5723577">=</span>&nbsp;<span class="ident" id="5723579">skipSpaceOrComment</span><span class="op" id="5723597">(</span><span class="ident" id="5723598">data</span><span class="op" id="5723602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5723606">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723646">rest</span>&nbsp;<span class="op" id="5723651">=</span>&nbsp;<span class="ident" id="5723653">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723659">for</span>&nbsp;<span class="op" id="5723663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723667">r</span><span class="op" id="5723668">,</span>&nbsp;<span class="ident" id="5723670">size</span>&nbsp;<span class="op" id="5723675">:=</span>&nbsp;<span class="ident" id="5723678">utf8</span><span class="op" id="5723682">.</span><span class="ident" id="5723683">DecodeRune</span><span class="op" id="5723693">(</span><span class="ident" id="5723694">rest</span><span class="op" id="5723698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723702">if</span>&nbsp;<span class="ident" id="5723705">unicode</span><span class="op" id="5723712">.</span><span class="ident" id="5723713">IsLetter</span><span class="op" id="5723721">(</span><span class="ident" id="5723722">r</span><span class="op" id="5723723">)</span>&nbsp;<span class="op" id="5723725">||</span>&nbsp;<span class="string" id="5723728">&#39;0&#39;</span>&nbsp;<span class="op" id="5723732">&lt;=</span>&nbsp;<span class="ident" id="5723735">r</span>&nbsp;<span class="op" id="5723737">&amp;&amp;</span>&nbsp;<span class="ident" id="5723740">r</span>&nbsp;<span class="op" id="5723742">&lt;=</span>&nbsp;<span class="string" id="5723745">&#39;9&#39;</span>&nbsp;<span class="op" id="5723749">||</span>&nbsp;<span class="ident" id="5723752">r</span>&nbsp;<span class="op" id="5723754">==</span>&nbsp;<span class="string" id="5723757">&#39;_&#39;</span>&nbsp;<span class="op" id="5723761">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723766">rest</span>&nbsp;<span class="op" id="5723771">=</span>&nbsp;<span class="ident" id="5723773">rest</span><span class="op" id="5723777">[</span><span class="ident" id="5723778">size</span><span class="op" id="5723782">:</span><span class="op" id="5723783">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723788">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723803">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723810">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5723814">word</span>&nbsp;<span class="op" id="5723819">=</span>&nbsp;<span class="ident" id="5723821">data</span><span class="op" id="5723825">[</span><span class="op" id="5723826">:</span><span class="builtinfunc" id="5723827">len</span><span class="op" id="5723830">(</span><span class="ident" id="5723831">data</span><span class="op" id="5723835">)</span><span class="op" id="5723836">-</span><span class="builtinfunc" id="5723837">len</span><span class="op" id="5723840">(</span><span class="ident" id="5723841">rest</span><span class="op" id="5723845">)</span><span class="op" id="5723846">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723849">if</span>&nbsp;<span class="builtinfunc" id="5723852">len</span><span class="op" id="5723855">(</span><span class="ident" id="5723856">word</span><span class="op" id="5723860">)</span>&nbsp;<span class="op" id="5723862">==</span>&nbsp;<span class="num" id="5723865">0</span>&nbsp;<span class="op" id="5723867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723871">return</span>&nbsp;<span class="builtintype" id="5723878">nil</span><span class="op" id="5723881">,</span>&nbsp;<span class="builtintype" id="5723883">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5723888">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5723892">return</span>&nbsp;<span class="ident" id="5723899">word</span><span class="op" id="5723903">,</span>&nbsp;<span class="ident" id="5723905">rest</span><br>
<span class="lineno"></span><span class="op" id="5723910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723913">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="5723994">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="5724073">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="5724095">//</span><br>
<span class="lineno"></span><span class="comment" id="5724098">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5724171">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="5724214">func</span>&nbsp;<span class="op" id="5724219">(</span><span class="ident" id="5724220">ctxt</span>&nbsp;<span class="op" id="5724225">*</span><span class="ident" id="5724226">Context</span><span class="op" id="5724233">)</span>&nbsp;<span class="ident" id="5724235">MatchFile</span><span class="op" id="5724244">(</span><span class="ident" id="5724245">dir</span><span class="op" id="5724248">,</span>&nbsp;<span class="ident" id="5724250">name</span>&nbsp;<span class="builtintype" id="5724255">string</span><span class="op" id="5724261">)</span>&nbsp;<span class="op" id="5724263">(</span><span class="ident" id="5724264">match</span>&nbsp;<span class="builtintype" id="5724270">bool</span><span class="op" id="5724274">,</span>&nbsp;<span class="ident" id="5724276">err</span>&nbsp;<span class="builtintype" id="5724280">error</span><span class="op" id="5724285">)</span>&nbsp;<span class="op" id="5724287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724290">match</span><span class="op" id="5724295">,</span>&nbsp;<span class="ident" id="5724297">_</span><span class="op" id="5724298">,</span>&nbsp;<span class="ident" id="5724300">_</span><span class="op" id="5724301">,</span>&nbsp;<span class="ident" id="5724303">err</span>&nbsp;<span class="op" id="5724307">=</span>&nbsp;<span class="ident" id="5724309">ctxt</span><span class="op" id="5724313">.</span><span class="ident" id="5724314">matchFile</span><span class="op" id="5724323">(</span><span class="ident" id="5724324">dir</span><span class="op" id="5724327">,</span>&nbsp;<span class="ident" id="5724329">name</span><span class="op" id="5724333">,</span>&nbsp;<span class="builtintype" id="5724335">false</span><span class="op" id="5724340">,</span>&nbsp;<span class="builtintype" id="5724342">nil</span><span class="op" id="5724345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724348">return</span><br>
<span class="lineno"></span><span class="op" id="5724355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="5724358">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="5724442">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="5724498">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5724541">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="5724616">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="5724692">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="5724739">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="5724809">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="5724844">func</span>&nbsp;<span class="op" id="5724849">(</span><span class="ident" id="5724850">ctxt</span>&nbsp;<span class="op" id="5724855">*</span><span class="ident" id="5724856">Context</span><span class="op" id="5724863">)</span>&nbsp;<span class="ident" id="5724865">matchFile</span><span class="op" id="5724874">(</span><span class="ident" id="5724875">dir</span><span class="op" id="5724878">,</span>&nbsp;<span class="ident" id="5724880">name</span>&nbsp;<span class="builtintype" id="5724885">string</span><span class="op" id="5724891">,</span>&nbsp;<span class="ident" id="5724893">returnImports</span>&nbsp;<span class="builtintype" id="5724907">bool</span><span class="op" id="5724911">,</span>&nbsp;<span class="ident" id="5724913">allTags</span>&nbsp;<span class="keyword" id="5724921">map</span><span class="op" id="5724924">[</span><span class="builtintype" id="5724925">string</span><span class="op" id="5724931">]</span><span class="builtintype" id="5724932">bool</span><span class="op" id="5724936">)</span>&nbsp;<span class="op" id="5724938">(</span><span class="ident" id="5724939">match</span>&nbsp;<span class="builtintype" id="5724945">bool</span><span class="op" id="5724949">,</span>&nbsp;<span class="ident" id="5724951">data</span>&nbsp;<span class="op" id="5724956">[</span><span class="op" id="5724957">]</span><span class="builtintype" id="5724958">byte</span><span class="op" id="5724962">,</span>&nbsp;<span class="ident" id="5724964">filename</span>&nbsp;<span class="builtintype" id="5724973">string</span><span class="op" id="5724979">,</span>&nbsp;<span class="ident" id="5724981">err</span>&nbsp;<span class="builtintype" id="5724985">error</span><span class="op" id="5724990">)</span>&nbsp;<span class="op" id="5724992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5724995">if</span>&nbsp;<span class="ident" id="5724998">strings</span><span class="op" id="5725005">.</span><span class="ident" id="5725006">HasPrefix</span><span class="op" id="5725015">(</span><span class="ident" id="5725016">name</span><span class="op" id="5725020">,</span>&nbsp;<span class="string" id="5725022">&#34;_&#34;</span><span class="op" id="5725025">)</span>&nbsp;<span class="op" id="5725027">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725032">strings</span><span class="op" id="5725039">.</span><span class="ident" id="5725040">HasPrefix</span><span class="op" id="5725049">(</span><span class="ident" id="5725050">name</span><span class="op" id="5725054">,</span>&nbsp;<span class="string" id="5725056">&#34;.&#34;</span><span class="op" id="5725059">)</span>&nbsp;<span class="op" id="5725061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725065">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725077">i</span>&nbsp;<span class="op" id="5725079">:=</span>&nbsp;<span class="ident" id="5725082">strings</span><span class="op" id="5725089">.</span><span class="ident" id="5725090">LastIndex</span><span class="op" id="5725099">(</span><span class="ident" id="5725100">name</span><span class="op" id="5725104">,</span>&nbsp;<span class="string" id="5725106">&#34;.&#34;</span><span class="op" id="5725109">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725112">if</span>&nbsp;<span class="ident" id="5725115">i</span>&nbsp;<span class="op" id="5725117">&lt;</span>&nbsp;<span class="num" id="5725119">0</span>&nbsp;<span class="op" id="5725121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725125">i</span>&nbsp;<span class="op" id="5725127">=</span>&nbsp;<span class="builtinfunc" id="5725129">len</span><span class="op" id="5725132">(</span><span class="ident" id="5725133">name</span><span class="op" id="5725137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725143">ext</span>&nbsp;<span class="op" id="5725147">:=</span>&nbsp;<span class="ident" id="5725150">name</span><span class="op" id="5725154">[</span><span class="ident" id="5725155">i</span><span class="op" id="5725156">:</span><span class="op" id="5725157">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725161">if</span>&nbsp;<span class="op" id="5725164">!</span><span class="ident" id="5725165">ctxt</span><span class="op" id="5725169">.</span><span class="ident" id="5725170">goodOSArchFile</span><span class="op" id="5725184">(</span><span class="ident" id="5725185">name</span><span class="op" id="5725189">,</span>&nbsp;<span class="ident" id="5725191">allTags</span><span class="op" id="5725198">)</span>&nbsp;<span class="op" id="5725200">&amp;&amp;</span>&nbsp;<span class="op" id="5725203">!</span><span class="ident" id="5725204">ctxt</span><span class="op" id="5725208">.</span><span class="ident" id="5725209">UseAllFiles</span>&nbsp;<span class="op" id="5725221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725225">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725237">switch</span>&nbsp;<span class="ident" id="5725244">ext</span>&nbsp;<span class="op" id="5725248">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725251">case</span>&nbsp;<span class="string" id="5725256">&#34;.go&#34;</span><span class="op" id="5725261">,</span>&nbsp;<span class="string" id="5725263">&#34;.c&#34;</span><span class="op" id="5725267">,</span>&nbsp;<span class="string" id="5725269">&#34;.cc&#34;</span><span class="op" id="5725274">,</span>&nbsp;<span class="string" id="5725276">&#34;.cxx&#34;</span><span class="op" id="5725282">,</span>&nbsp;<span class="string" id="5725284">&#34;.cpp&#34;</span><span class="op" id="5725290">,</span>&nbsp;<span class="string" id="5725292">&#34;.m&#34;</span><span class="op" id="5725296">,</span>&nbsp;<span class="string" id="5725298">&#34;.s&#34;</span><span class="op" id="5725302">,</span>&nbsp;<span class="string" id="5725304">&#34;.h&#34;</span><span class="op" id="5725308">,</span>&nbsp;<span class="string" id="5725310">&#34;.hh&#34;</span><span class="op" id="5725315">,</span>&nbsp;<span class="string" id="5725317">&#34;.hpp&#34;</span><span class="op" id="5725323">,</span>&nbsp;<span class="string" id="5725325">&#34;.hxx&#34;</span><span class="op" id="5725331">,</span>&nbsp;<span class="string" id="5725333">&#34;.S&#34;</span><span class="op" id="5725337">,</span>&nbsp;<span class="string" id="5725339">&#34;.swig&#34;</span><span class="op" id="5725346">,</span>&nbsp;<span class="string" id="5725348">&#34;.swigcxx&#34;</span><span class="op" id="5725358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5725362">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725403">case</span>&nbsp;<span class="string" id="5725408">&#34;.syso&#34;</span><span class="op" id="5725415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5725419">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725443">match</span>&nbsp;<span class="op" id="5725449">=</span>&nbsp;<span class="builtintype" id="5725451">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725458">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725466">default</span><span class="op" id="5725473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5725477">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725487">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725495">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725499">filename</span>&nbsp;<span class="op" id="5725508">=</span>&nbsp;<span class="ident" id="5725510">ctxt</span><span class="op" id="5725514">.</span><span class="ident" id="5725515">joinPath</span><span class="op" id="5725523">(</span><span class="ident" id="5725524">dir</span><span class="op" id="5725527">,</span>&nbsp;<span class="ident" id="5725529">name</span><span class="op" id="5725533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725536">f</span><span class="op" id="5725537">,</span>&nbsp;<span class="ident" id="5725539">err</span>&nbsp;<span class="op" id="5725543">:=</span>&nbsp;<span class="ident" id="5725546">ctxt</span><span class="op" id="5725550">.</span><span class="ident" id="5725551">openFile</span><span class="op" id="5725559">(</span><span class="ident" id="5725560">filename</span><span class="op" id="5725568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725571">if</span>&nbsp;<span class="ident" id="5725574">err</span>&nbsp;<span class="op" id="5725578">!=</span>&nbsp;<span class="builtintype" id="5725581">nil</span>&nbsp;<span class="op" id="5725585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725589">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725601">if</span>&nbsp;<span class="ident" id="5725604">strings</span><span class="op" id="5725611">.</span><span class="ident" id="5725612">HasSuffix</span><span class="op" id="5725621">(</span><span class="ident" id="5725622">filename</span><span class="op" id="5725630">,</span>&nbsp;<span class="string" id="5725632">&#34;.go&#34;</span><span class="op" id="5725637">)</span>&nbsp;<span class="op" id="5725639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725643">data</span><span class="op" id="5725647">,</span>&nbsp;<span class="ident" id="5725649">err</span>&nbsp;<span class="op" id="5725653">=</span>&nbsp;<span class="ident" id="5725655">readImports</span><span class="op" id="5725666">(</span><span class="ident" id="5725667">f</span><span class="op" id="5725668">,</span>&nbsp;<span class="builtintype" id="5725670">false</span><span class="op" id="5725675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725678">}</span>&nbsp;<span class="keyword" id="5725680">else</span>&nbsp;<span class="op" id="5725685">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725689">data</span><span class="op" id="5725693">,</span>&nbsp;<span class="ident" id="5725695">err</span>&nbsp;<span class="op" id="5725699">=</span>&nbsp;<span class="ident" id="5725701">readComments</span><span class="op" id="5725713">(</span><span class="ident" id="5725714">f</span><span class="op" id="5725715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725721">f</span><span class="op" id="5725722">.</span><span class="ident" id="5725723">Close</span><span class="op" id="5725728">(</span><span class="op" id="5725729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725732">if</span>&nbsp;<span class="ident" id="5725735">err</span>&nbsp;<span class="op" id="5725739">!=</span>&nbsp;<span class="builtintype" id="5725742">nil</span>&nbsp;<span class="op" id="5725746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725750">err</span>&nbsp;<span class="op" id="5725754">=</span>&nbsp;<span class="ident" id="5725756">fmt</span><span class="op" id="5725759">.</span><span class="ident" id="5725760">Errorf</span><span class="op" id="5725766">(</span><span class="string" id="5725767">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="5725780">,</span>&nbsp;<span class="ident" id="5725782">filename</span><span class="op" id="5725790">,</span>&nbsp;<span class="ident" id="5725792">err</span><span class="op" id="5725795">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725799">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5725811">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725870">if</span>&nbsp;<span class="op" id="5725873">!</span><span class="ident" id="5725874">ctxt</span><span class="op" id="5725878">.</span><span class="ident" id="5725879">shouldBuild</span><span class="op" id="5725890">(</span><span class="ident" id="5725891">data</span><span class="op" id="5725895">,</span>&nbsp;<span class="ident" id="5725897">allTags</span><span class="op" id="5725904">)</span>&nbsp;<span class="op" id="5725906">&amp;&amp;</span>&nbsp;<span class="op" id="5725909">!</span><span class="ident" id="5725910">ctxt</span><span class="op" id="5725914">.</span><span class="ident" id="5725915">UseAllFiles</span>&nbsp;<span class="op" id="5725927">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5725939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5725943">match</span>&nbsp;<span class="op" id="5725949">=</span>&nbsp;<span class="builtintype" id="5725951">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5725957">return</span><br>
<span class="lineno">975</span><span class="op" id="5725964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5725967">func</span>&nbsp;<span class="ident" id="5725972">cleanImports</span><span class="op" id="5725984">(</span><span class="ident" id="5725985">m</span>&nbsp;<span class="keyword" id="5725987">map</span><span class="op" id="5725990">[</span><span class="builtintype" id="5725991">string</span><span class="op" id="5725997">]</span><span class="op" id="5725998">[</span><span class="op" id="5725999">]</span><span class="ident" id="5726000">token</span><span class="op" id="5726005">.</span><span class="ident" id="5726006">Position</span><span class="op" id="5726014">)</span>&nbsp;<span class="op" id="5726016">(</span><span class="op" id="5726017">[</span><span class="op" id="5726018">]</span><span class="builtintype" id="5726019">string</span><span class="op" id="5726025">,</span>&nbsp;<span class="keyword" id="5726027">map</span><span class="op" id="5726030">[</span><span class="builtintype" id="5726031">string</span><span class="op" id="5726037">]</span><span class="op" id="5726038">[</span><span class="op" id="5726039">]</span><span class="ident" id="5726040">token</span><span class="op" id="5726045">.</span><span class="ident" id="5726046">Position</span><span class="op" id="5726054">)</span>&nbsp;<span class="op" id="5726056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5726059">all</span>&nbsp;<span class="op" id="5726063">:=</span>&nbsp;<span class="builtinfunc" id="5726066">make</span><span class="op" id="5726070">(</span><span class="op" id="5726071">[</span><span class="op" id="5726072">]</span><span class="builtintype" id="5726073">string</span><span class="op" id="5726079">,</span>&nbsp;<span class="num" id="5726081">0</span><span class="op" id="5726082">,</span>&nbsp;<span class="builtinfunc" id="5726084">len</span><span class="op" id="5726087">(</span><span class="ident" id="5726088">m</span><span class="op" id="5726089">)</span><span class="op" id="5726090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5726093">for</span>&nbsp;<span class="ident" id="5726097">path</span>&nbsp;<span class="op" id="5726102">:=</span>&nbsp;<span class="keyword" id="5726105">range</span>&nbsp;<span class="ident" id="5726111">m</span>&nbsp;<span class="op" id="5726113">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5726117">all</span>&nbsp;<span class="op" id="5726121">=</span>&nbsp;<span class="builtinfunc" id="5726123">append</span><span class="op" id="5726129">(</span><span class="ident" id="5726130">all</span><span class="op" id="5726133">,</span>&nbsp;<span class="ident" id="5726135">path</span><span class="op" id="5726139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5726145">sort</span><span class="op" id="5726149">.</span><span class="ident" id="5726150">Strings</span><span class="op" id="5726157">(</span><span class="ident" id="5726158">all</span><span class="op" id="5726161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5726164">return</span>&nbsp;<span class="ident" id="5726171">all</span><span class="op" id="5726174">,</span>&nbsp;<span class="ident" id="5726176">m</span><br>
<span class="lineno"></span><span class="op" id="5726178">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="5726181">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="5726224">func</span>&nbsp;<span class="ident" id="5726229">Import</span><span class="op" id="5726235">(</span><span class="ident" id="5726236">path</span><span class="op" id="5726240">,</span>&nbsp;<span class="ident" id="5726242">srcDir</span>&nbsp;<span class="builtintype" id="5726249">string</span><span class="op" id="5726255">,</span>&nbsp;<span class="ident" id="5726257">mode</span>&nbsp;<span class="ident" id="5726262">ImportMode</span><span class="op" id="5726272">)</span>&nbsp;<span class="op" id="5726274">(</span><span class="op" id="5726275">*</span><span class="ident" id="5726276">Package</span><span class="op" id="5726283">,</span>&nbsp;<span class="builtintype" id="5726285">error</span><span class="op" id="5726290">)</span>&nbsp;<span class="op" id="5726292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5726295">return</span>&nbsp;<span class="ident" id="5726302">Default</span><span class="op" id="5726309">.</span><span class="ident" id="5726310">Import</span><span class="op" id="5726316">(</span><span class="ident" id="5726317">path</span><span class="op" id="5726321">,</span>&nbsp;<span class="ident" id="5726323">srcDir</span><span class="op" id="5726329">,</span>&nbsp;<span class="ident" id="5726331">mode</span><span class="op" id="5726335">)</span><br>
<span class="lineno"></span><span class="op" id="5726337">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="5726340">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="5726389">func</span>&nbsp;<span class="ident" id="5726394">ImportDir</span><span class="op" id="5726403">(</span><span class="ident" id="5726404">dir</span>&nbsp;<span class="builtintype" id="5726408">string</span><span class="op" id="5726414">,</span>&nbsp;<span class="ident" id="5726416">mode</span>&nbsp;<span class="ident" id="5726421">ImportMode</span><span class="op" id="5726431">)</span>&nbsp;<span class="op" id="5726433">(</span><span class="op" id="5726434">*</span><span class="ident" id="5726435">Package</span><span class="op" id="5726442">,</span>&nbsp;<span class="builtintype" id="5726444">error</span><span class="op" id="5726449">)</span>&nbsp;<span class="op" id="5726451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5726454">return</span>&nbsp;<span class="ident" id="5726461">Default</span><span class="op" id="5726468">.</span><span class="ident" id="5726469">ImportDir</span><span class="op" id="5726478">(</span><span class="ident" id="5726479">dir</span><span class="op" id="5726482">,</span>&nbsp;<span class="ident" id="5726484">mode</span><span class="op" id="5726488">)</span><br>
<span class="lineno"></span><span class="op" id="5726490">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="5726493">var</span>&nbsp;<span class="ident" id="5726497">slashslash</span>&nbsp;<span class="op" id="5726508">=</span>&nbsp;<span class="op" id="5726510">[</span><span class="op" id="5726511">]</span><span class="builtintype" id="5726512">byte</span><span class="op" id="5726516">(</span><span class="string" id="5726517">&#34;//&#34;</span><span class="op" id="5726521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5726524">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="5726584">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="5726645">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="5726704">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="5726761">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="5726828">//</span><br>
<span class="lineno"></span><span class="comment" id="5726831">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="5726894">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5726930">//</span><br>
<span class="lineno"></span><span class="comment" id="5726933">//&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="5726960">//</span><br>
<span class="lineno"></span><span class="comment" id="5726963">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="5727022">//</span><br>
<span class="lineno"></span><span class="keyword" id="5727025">func</span>&nbsp;<span class="op" id="5727030">(</span><span class="ident" id="5727031">ctxt</span>&nbsp;<span class="op" id="5727036">*</span><span class="ident" id="5727037">Context</span><span class="op" id="5727044">)</span>&nbsp;<span class="ident" id="5727046">shouldBuild</span><span class="op" id="5727057">(</span><span class="ident" id="5727058">content</span>&nbsp;<span class="op" id="5727066">[</span><span class="op" id="5727067">]</span><span class="builtintype" id="5727068">byte</span><span class="op" id="5727072">,</span>&nbsp;<span class="ident" id="5727074">allTags</span>&nbsp;<span class="keyword" id="5727082">map</span><span class="op" id="5727085">[</span><span class="builtintype" id="5727086">string</span><span class="op" id="5727092">]</span><span class="builtintype" id="5727093">bool</span><span class="op" id="5727097">)</span>&nbsp;<span class="builtintype" id="5727099">bool</span>&nbsp;<span class="op" id="5727104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5727107">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5727172">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727216">end</span>&nbsp;<span class="op" id="5727220">:=</span>&nbsp;<span class="num" id="5727223">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727226">p</span>&nbsp;<span class="op" id="5727228">:=</span>&nbsp;<span class="ident" id="5727231">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727240">for</span>&nbsp;<span class="builtinfunc" id="5727244">len</span><span class="op" id="5727247">(</span><span class="ident" id="5727248">p</span><span class="op" id="5727249">)</span>&nbsp;<span class="op" id="5727251">&gt;</span>&nbsp;<span class="num" id="5727253">0</span>&nbsp;<span class="op" id="5727255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727259">line</span>&nbsp;<span class="op" id="5727264">:=</span>&nbsp;<span class="ident" id="5727267">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727271">if</span>&nbsp;<span class="ident" id="5727274">i</span>&nbsp;<span class="op" id="5727276">:=</span>&nbsp;<span class="ident" id="5727279">bytes</span><span class="op" id="5727284">.</span><span class="ident" id="5727285">IndexByte</span><span class="op" id="5727294">(</span><span class="ident" id="5727295">line</span><span class="op" id="5727299">,</span>&nbsp;<span class="string" id="5727301">&#39;\n&#39;</span><span class="op" id="5727305">)</span><span class="op" id="5727306">;</span>&nbsp;<span class="ident" id="5727308">i</span>&nbsp;<span class="op" id="5727310">&gt;=</span>&nbsp;<span class="num" id="5727313">0</span>&nbsp;<span class="op" id="5727315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727320">line</span><span class="op" id="5727324">,</span>&nbsp;<span class="ident" id="5727326">p</span>&nbsp;<span class="op" id="5727328">=</span>&nbsp;<span class="ident" id="5727330">line</span><span class="op" id="5727334">[</span><span class="op" id="5727335">:</span><span class="ident" id="5727336">i</span><span class="op" id="5727337">]</span><span class="op" id="5727338">,</span>&nbsp;<span class="ident" id="5727340">p</span><span class="op" id="5727341">[</span><span class="ident" id="5727342">i</span><span class="op" id="5727343">+</span><span class="num" id="5727344">1</span><span class="op" id="5727345">:</span><span class="op" id="5727346">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727350">}</span>&nbsp;<span class="keyword" id="5727352">else</span>&nbsp;<span class="op" id="5727357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727362">p</span>&nbsp;<span class="op" id="5727364">=</span>&nbsp;<span class="ident" id="5727366">p</span><span class="op" id="5727367">[</span><span class="builtinfunc" id="5727368">len</span><span class="op" id="5727371">(</span><span class="ident" id="5727372">p</span><span class="op" id="5727373">)</span><span class="op" id="5727374">:</span><span class="op" id="5727375">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727383">line</span>&nbsp;<span class="op" id="5727388">=</span>&nbsp;<span class="ident" id="5727390">bytes</span><span class="op" id="5727395">.</span><span class="ident" id="5727396">TrimSpace</span><span class="op" id="5727405">(</span><span class="ident" id="5727406">line</span><span class="op" id="5727410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727414">if</span>&nbsp;<span class="builtinfunc" id="5727417">len</span><span class="op" id="5727420">(</span><span class="ident" id="5727421">line</span><span class="op" id="5727425">)</span>&nbsp;<span class="op" id="5727427">==</span>&nbsp;<span class="num" id="5727430">0</span>&nbsp;<span class="op" id="5727432">{</span>&nbsp;<span class="comment" id="5727434">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727451">end</span>&nbsp;<span class="op" id="5727455">=</span>&nbsp;<span class="builtinfunc" id="5727457">len</span><span class="op" id="5727460">(</span><span class="ident" id="5727461">content</span><span class="op" id="5727468">)</span>&nbsp;<span class="op" id="5727470">-</span>&nbsp;<span class="builtinfunc" id="5727472">len</span><span class="op" id="5727475">(</span><span class="ident" id="5727476">p</span><span class="op" id="5727477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727482">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727497">if</span>&nbsp;<span class="op" id="5727500">!</span><span class="ident" id="5727501">bytes</span><span class="op" id="5727506">.</span><span class="ident" id="5727507">HasPrefix</span><span class="op" id="5727516">(</span><span class="ident" id="5727517">line</span><span class="op" id="5727521">,</span>&nbsp;<span class="ident" id="5727523">slashslash</span><span class="op" id="5727533">)</span>&nbsp;<span class="op" id="5727535">{</span>&nbsp;<span class="comment" id="5727537">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727560">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727574">content</span>&nbsp;<span class="op" id="5727582">=</span>&nbsp;<span class="ident" id="5727584">content</span><span class="op" id="5727591">[</span><span class="op" id="5727592">:</span><span class="ident" id="5727593">end</span><span class="op" id="5727596">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5727600">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727643">p</span>&nbsp;<span class="op" id="5727645">=</span>&nbsp;<span class="ident" id="5727647">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727656">allok</span>&nbsp;<span class="op" id="5727662">:=</span>&nbsp;<span class="builtintype" id="5727665">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727671">for</span>&nbsp;<span class="builtinfunc" id="5727675">len</span><span class="op" id="5727678">(</span><span class="ident" id="5727679">p</span><span class="op" id="5727680">)</span>&nbsp;<span class="op" id="5727682">&gt;</span>&nbsp;<span class="num" id="5727684">0</span>&nbsp;<span class="op" id="5727686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727690">line</span>&nbsp;<span class="op" id="5727695">:=</span>&nbsp;<span class="ident" id="5727698">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727702">if</span>&nbsp;<span class="ident" id="5727705">i</span>&nbsp;<span class="op" id="5727707">:=</span>&nbsp;<span class="ident" id="5727710">bytes</span><span class="op" id="5727715">.</span><span class="ident" id="5727716">IndexByte</span><span class="op" id="5727725">(</span><span class="ident" id="5727726">line</span><span class="op" id="5727730">,</span>&nbsp;<span class="string" id="5727732">&#39;\n&#39;</span><span class="op" id="5727736">)</span><span class="op" id="5727737">;</span>&nbsp;<span class="ident" id="5727739">i</span>&nbsp;<span class="op" id="5727741">&gt;=</span>&nbsp;<span class="num" id="5727744">0</span>&nbsp;<span class="op" id="5727746">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727751">line</span><span class="op" id="5727755">,</span>&nbsp;<span class="ident" id="5727757">p</span>&nbsp;<span class="op" id="5727759">=</span>&nbsp;<span class="ident" id="5727761">line</span><span class="op" id="5727765">[</span><span class="op" id="5727766">:</span><span class="ident" id="5727767">i</span><span class="op" id="5727768">]</span><span class="op" id="5727769">,</span>&nbsp;<span class="ident" id="5727771">p</span><span class="op" id="5727772">[</span><span class="ident" id="5727773">i</span><span class="op" id="5727774">+</span><span class="num" id="5727775">1</span><span class="op" id="5727776">:</span><span class="op" id="5727777">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727781">}</span>&nbsp;<span class="keyword" id="5727783">else</span>&nbsp;<span class="op" id="5727788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727793">p</span>&nbsp;<span class="op" id="5727795">=</span>&nbsp;<span class="ident" id="5727797">p</span><span class="op" id="5727798">[</span><span class="builtinfunc" id="5727799">len</span><span class="op" id="5727802">(</span><span class="ident" id="5727803">p</span><span class="op" id="5727804">)</span><span class="op" id="5727805">:</span><span class="op" id="5727806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5727810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727814">line</span>&nbsp;<span class="op" id="5727819">=</span>&nbsp;<span class="ident" id="5727821">bytes</span><span class="op" id="5727826">.</span><span class="ident" id="5727827">TrimSpace</span><span class="op" id="5727836">(</span><span class="ident" id="5727837">line</span><span class="op" id="5727841">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727845">if</span>&nbsp;<span class="ident" id="5727848">bytes</span><span class="op" id="5727853">.</span><span class="ident" id="5727854">HasPrefix</span><span class="op" id="5727863">(</span><span class="ident" id="5727864">line</span><span class="op" id="5727868">,</span>&nbsp;<span class="ident" id="5727870">slashslash</span><span class="op" id="5727880">)</span>&nbsp;<span class="op" id="5727882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5727887">line</span>&nbsp;<span class="op" id="5727892">=</span>&nbsp;<span class="ident" id="5727894">bytes</span><span class="op" id="5727899">.</span><span class="ident" id="5727900">TrimSpace</span><span class="op" id="5727909">(</span><span class="ident" id="5727910">line</span><span class="op" id="5727914">[</span><span class="builtinfunc" id="5727915">len</span><span class="op" id="5727918">(</span><span class="ident" id="5727919">slashslash</span><span class="op" id="5727929">)</span><span class="op" id="5727930">:</span><span class="op" id="5727931">]</span><span class="op" id="5727932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5727937">if</span>&nbsp;<span class="builtinfunc" id="5727940">len</span><span class="op" id="5727943">(</span><span class="ident" id="5727944">line</span><span class="op" id="5727948">)</span>&nbsp;<span class="op" id="5727950">&gt;</span>&nbsp;<span class="num" id="5727952">0</span>&nbsp;<span class="op" id="5727954">&amp;&amp;</span>&nbsp;<span class="ident" id="5727957">line</span><span class="op" id="5727961">[</span><span class="num" id="5727962">0</span><span class="op" id="5727963">]</span>&nbsp;<span class="op" id="5727965">==</span>&nbsp;<span class="string" id="5727968">&#39;+&#39;</span>&nbsp;<span class="op" id="5727972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5727978">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728013">f</span>&nbsp;<span class="op" id="5728015">:=</span>&nbsp;<span class="ident" id="5728018">strings</span><span class="op" id="5728025">.</span><span class="ident" id="5728026">Fields</span><span class="op" id="5728032">(</span><span class="builtintype" id="5728033">string</span><span class="op" id="5728039">(</span><span class="ident" id="5728040">line</span><span class="op" id="5728044">)</span><span class="op" id="5728045">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728051">if</span>&nbsp;<span class="ident" id="5728054">f</span><span class="op" id="5728055">[</span><span class="num" id="5728056">0</span><span class="op" id="5728057">]</span>&nbsp;<span class="op" id="5728059">==</span>&nbsp;<span class="string" id="5728062">&#34;+build&#34;</span>&nbsp;<span class="op" id="5728071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728078">ok</span>&nbsp;<span class="op" id="5728081">:=</span>&nbsp;<span class="builtintype" id="5728084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728095">for</span>&nbsp;<span class="ident" id="5728099">_</span><span class="op" id="5728100">,</span>&nbsp;<span class="ident" id="5728102">tok</span>&nbsp;<span class="op" id="5728106">:=</span>&nbsp;<span class="keyword" id="5728109">range</span>&nbsp;<span class="ident" id="5728115">f</span><span class="op" id="5728116">[</span><span class="num" id="5728117">1</span><span class="op" id="5728118">:</span><span class="op" id="5728119">]</span>&nbsp;<span class="op" id="5728121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728129">if</span>&nbsp;<span class="ident" id="5728132">ctxt</span><span class="op" id="5728136">.</span><span class="ident" id="5728137">match</span><span class="op" id="5728142">(</span><span class="ident" id="5728143">tok</span><span class="op" id="5728146">,</span>&nbsp;<span class="ident" id="5728148">allTags</span><span class="op" id="5728155">)</span>&nbsp;<span class="op" id="5728157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728166">ok</span>&nbsp;<span class="op" id="5728169">=</span>&nbsp;<span class="builtintype" id="5728171">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728196">if</span>&nbsp;<span class="op" id="5728199">!</span><span class="ident" id="5728200">ok</span>&nbsp;<span class="op" id="5728203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728211">allok</span>&nbsp;<span class="op" id="5728217">=</span>&nbsp;<span class="builtintype" id="5728219">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728230">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728252">return</span>&nbsp;<span class="ident" id="5728259">allok</span><br>
<span class="lineno"></span><span class="op" id="5728265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5728268">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="5728348">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="5728432">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="5728478">//</span><br>
<span class="lineno"></span><span class="comment" id="5728481">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="5728524">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="5728577">func</span>&nbsp;<span class="op" id="5728582">(</span><span class="ident" id="5728583">ctxt</span>&nbsp;<span class="op" id="5728588">*</span><span class="ident" id="5728589">Context</span><span class="op" id="5728596">)</span>&nbsp;<span class="ident" id="5728598">saveCgo</span><span class="op" id="5728605">(</span><span class="ident" id="5728606">filename</span>&nbsp;<span class="builtintype" id="5728615">string</span><span class="op" id="5728621">,</span>&nbsp;<span class="ident" id="5728623">di</span>&nbsp;<span class="op" id="5728626">*</span><span class="ident" id="5728627">Package</span><span class="op" id="5728634">,</span>&nbsp;<span class="ident" id="5728636">cg</span>&nbsp;<span class="op" id="5728639">*</span><span class="ident" id="5728640">ast</span><span class="op" id="5728643">.</span><span class="ident" id="5728644">CommentGroup</span><span class="op" id="5728656">)</span>&nbsp;<span class="builtintype" id="5728658">error</span>&nbsp;<span class="op" id="5728664">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728667">text</span>&nbsp;<span class="op" id="5728672">:=</span>&nbsp;<span class="ident" id="5728675">cg</span><span class="op" id="5728677">.</span><span class="ident" id="5728678">Text</span><span class="op" id="5728682">(</span><span class="op" id="5728683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728686">for</span>&nbsp;<span class="ident" id="5728690">_</span><span class="op" id="5728691">,</span>&nbsp;<span class="ident" id="5728693">line</span>&nbsp;<span class="op" id="5728698">:=</span>&nbsp;<span class="keyword" id="5728701">range</span>&nbsp;<span class="ident" id="5728707">strings</span><span class="op" id="5728714">.</span><span class="ident" id="5728715">Split</span><span class="op" id="5728720">(</span><span class="ident" id="5728721">text</span><span class="op" id="5728725">,</span>&nbsp;<span class="string" id="5728727">&#34;\n&#34;</span><span class="op" id="5728731">)</span>&nbsp;<span class="op" id="5728733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728737">orig</span>&nbsp;<span class="op" id="5728742">:=</span>&nbsp;<span class="ident" id="5728745">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5728753">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5728766">//&nbsp;&nbsp;&nbsp;&nbsp;#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5728808">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728813">line</span>&nbsp;<span class="op" id="5728818">=</span>&nbsp;<span class="ident" id="5728820">strings</span><span class="op" id="5728827">.</span><span class="ident" id="5728828">TrimSpace</span><span class="op" id="5728837">(</span><span class="ident" id="5728838">line</span><span class="op" id="5728842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728846">if</span>&nbsp;<span class="builtinfunc" id="5728849">len</span><span class="op" id="5728852">(</span><span class="ident" id="5728853">line</span><span class="op" id="5728857">)</span>&nbsp;<span class="op" id="5728859">&lt;</span>&nbsp;<span class="num" id="5728861">5</span>&nbsp;<span class="op" id="5728863">||</span>&nbsp;<span class="ident" id="5728866">line</span><span class="op" id="5728870">[</span><span class="op" id="5728871">:</span><span class="num" id="5728872">4</span><span class="op" id="5728873">]</span>&nbsp;<span class="op" id="5728875">!=</span>&nbsp;<span class="string" id="5728878">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="5728885">||</span>&nbsp;<span class="op" id="5728888">(</span><span class="ident" id="5728889">line</span><span class="op" id="5728893">[</span><span class="num" id="5728894">4</span><span class="op" id="5728895">]</span>&nbsp;<span class="op" id="5728897">!=</span>&nbsp;<span class="string" id="5728900">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5728904">&amp;&amp;</span>&nbsp;<span class="ident" id="5728907">line</span><span class="op" id="5728911">[</span><span class="num" id="5728912">4</span><span class="op" id="5728913">]</span>&nbsp;<span class="op" id="5728915">!=</span>&nbsp;<span class="string" id="5728918">&#39;\t&#39;</span><span class="op" id="5728922">)</span>&nbsp;<span class="op" id="5728924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5728929">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5728940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5728945">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5728966">line</span>&nbsp;<span class="op" id="5728971">=</span>&nbsp;<span class="ident" id="5728973">strings</span><span class="op" id="5728980">.</span><span class="ident" id="5728981">TrimSpace</span><span class="op" id="5728990">(</span><span class="ident" id="5728991">line</span><span class="op" id="5728995">[</span><span class="num" id="5728996">4</span><span class="op" id="5728997">:</span><span class="op" id="5728998">]</span><span class="op" id="5728999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729003">i</span>&nbsp;<span class="op" id="5729005">:=</span>&nbsp;<span class="ident" id="5729008">strings</span><span class="op" id="5729015">.</span><span class="ident" id="5729016">Index</span><span class="op" id="5729021">(</span><span class="ident" id="5729022">line</span><span class="op" id="5729026">,</span>&nbsp;<span class="string" id="5729028">&#34;:&#34;</span><span class="op" id="5729031">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729035">if</span>&nbsp;<span class="ident" id="5729038">i</span>&nbsp;<span class="op" id="5729040">&lt;</span>&nbsp;<span class="num" id="5729042">0</span>&nbsp;<span class="op" id="5729044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729049">return</span>&nbsp;<span class="ident" id="5729056">fmt</span><span class="op" id="5729059">.</span><span class="ident" id="5729060">Errorf</span><span class="op" id="5729066">(</span><span class="string" id="5729067">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5729094">,</span>&nbsp;<span class="ident" id="5729096">filename</span><span class="op" id="5729104">,</span>&nbsp;<span class="ident" id="5729106">orig</span><span class="op" id="5729110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729118">line</span><span class="op" id="5729122">,</span>&nbsp;<span class="ident" id="5729124">argstr</span>&nbsp;<span class="op" id="5729131">:=</span>&nbsp;<span class="ident" id="5729134">line</span><span class="op" id="5729138">[</span><span class="op" id="5729139">:</span><span class="ident" id="5729140">i</span><span class="op" id="5729141">]</span><span class="op" id="5729142">,</span>&nbsp;<span class="ident" id="5729144">line</span><span class="op" id="5729148">[</span><span class="ident" id="5729149">i</span><span class="op" id="5729150">+</span><span class="num" id="5729151">1</span><span class="op" id="5729152">:</span><span class="op" id="5729153">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5729158">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729188">f</span>&nbsp;<span class="op" id="5729190">:=</span>&nbsp;<span class="ident" id="5729193">strings</span><span class="op" id="5729200">.</span><span class="ident" id="5729201">Fields</span><span class="op" id="5729207">(</span><span class="ident" id="5729208">line</span><span class="op" id="5729212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729216">if</span>&nbsp;<span class="builtinfunc" id="5729219">len</span><span class="op" id="5729222">(</span><span class="ident" id="5729223">f</span><span class="op" id="5729224">)</span>&nbsp;<span class="op" id="5729226">&lt;</span>&nbsp;<span class="num" id="5729228">1</span>&nbsp;<span class="op" id="5729230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729235">return</span>&nbsp;<span class="ident" id="5729242">fmt</span><span class="op" id="5729245">.</span><span class="ident" id="5729246">Errorf</span><span class="op" id="5729252">(</span><span class="string" id="5729253">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5729280">,</span>&nbsp;<span class="ident" id="5729282">filename</span><span class="op" id="5729290">,</span>&nbsp;<span class="ident" id="5729292">orig</span><span class="op" id="5729296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729300">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729305">cond</span><span class="op" id="5729309">,</span>&nbsp;<span class="ident" id="5729311">verb</span>&nbsp;<span class="op" id="5729316">:=</span>&nbsp;<span class="ident" id="5729319">f</span><span class="op" id="5729320">[</span><span class="op" id="5729321">:</span><span class="builtinfunc" id="5729322">len</span><span class="op" id="5729325">(</span><span class="ident" id="5729326">f</span><span class="op" id="5729327">)</span><span class="op" id="5729328">-</span><span class="num" id="5729329">1</span><span class="op" id="5729330">]</span><span class="op" id="5729331">,</span>&nbsp;<span class="ident" id="5729333">f</span><span class="op" id="5729334">[</span><span class="builtinfunc" id="5729335">len</span><span class="op" id="5729338">(</span><span class="ident" id="5729339">f</span><span class="op" id="5729340">)</span><span class="op" id="5729341">-</span><span class="num" id="5729342">1</span><span class="op" id="5729343">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729347">if</span>&nbsp;<span class="builtinfunc" id="5729350">len</span><span class="op" id="5729353">(</span><span class="ident" id="5729354">cond</span><span class="op" id="5729358">)</span>&nbsp;<span class="op" id="5729360">&gt;</span>&nbsp;<span class="num" id="5729362">0</span>&nbsp;<span class="op" id="5729364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729369">ok</span>&nbsp;<span class="op" id="5729372">:=</span>&nbsp;<span class="builtintype" id="5729375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729384">for</span>&nbsp;<span class="ident" id="5729388">_</span><span class="op" id="5729389">,</span>&nbsp;<span class="ident" id="5729391">c</span>&nbsp;<span class="op" id="5729393">:=</span>&nbsp;<span class="keyword" id="5729396">range</span>&nbsp;<span class="ident" id="5729402">cond</span>&nbsp;<span class="op" id="5729407">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729413">if</span>&nbsp;<span class="ident" id="5729416">ctxt</span><span class="op" id="5729420">.</span><span class="ident" id="5729421">match</span><span class="op" id="5729426">(</span><span class="ident" id="5729427">c</span><span class="op" id="5729428">,</span>&nbsp;<span class="builtintype" id="5729430">nil</span><span class="op" id="5729433">)</span>&nbsp;<span class="op" id="5729435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729442">ok</span>&nbsp;<span class="op" id="5729445">=</span>&nbsp;<span class="builtintype" id="5729447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729457">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729472">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729477">if</span>&nbsp;<span class="op" id="5729480">!</span><span class="ident" id="5729481">ok</span>&nbsp;<span class="op" id="5729484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729490">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729511">args</span><span class="op" id="5729515">,</span>&nbsp;<span class="ident" id="5729517">err</span>&nbsp;<span class="op" id="5729521">:=</span>&nbsp;<span class="ident" id="5729524">splitQuoted</span><span class="op" id="5729535">(</span><span class="ident" id="5729536">argstr</span><span class="op" id="5729542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729546">if</span>&nbsp;<span class="ident" id="5729549">err</span>&nbsp;<span class="op" id="5729553">!=</span>&nbsp;<span class="builtintype" id="5729556">nil</span>&nbsp;<span class="op" id="5729560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729565">return</span>&nbsp;<span class="ident" id="5729572">fmt</span><span class="op" id="5729575">.</span><span class="ident" id="5729576">Errorf</span><span class="op" id="5729582">(</span><span class="string" id="5729583">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5729610">,</span>&nbsp;<span class="ident" id="5729612">filename</span><span class="op" id="5729620">,</span>&nbsp;<span class="ident" id="5729622">orig</span><span class="op" id="5729626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729634">for</span>&nbsp;<span class="ident" id="5729638">_</span><span class="op" id="5729639">,</span>&nbsp;<span class="ident" id="5729641">arg</span>&nbsp;<span class="op" id="5729645">:=</span>&nbsp;<span class="keyword" id="5729648">range</span>&nbsp;<span class="ident" id="5729654">args</span>&nbsp;<span class="op" id="5729659">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729664">if</span>&nbsp;<span class="op" id="5729667">!</span><span class="ident" id="5729668">safeCgoName</span><span class="op" id="5729679">(</span><span class="ident" id="5729680">arg</span><span class="op" id="5729683">)</span>&nbsp;<span class="op" id="5729685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729691">return</span>&nbsp;<span class="ident" id="5729698">fmt</span><span class="op" id="5729701">.</span><span class="ident" id="5729702">Errorf</span><span class="op" id="5729708">(</span><span class="string" id="5729709">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="5729742">,</span>&nbsp;<span class="ident" id="5729744">filename</span><span class="op" id="5729752">,</span>&nbsp;<span class="ident" id="5729754">arg</span><span class="op" id="5729757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5729766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729771">switch</span>&nbsp;<span class="ident" id="5729778">verb</span>&nbsp;<span class="op" id="5729783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729787">case</span>&nbsp;<span class="string" id="5729792">&#34;CFLAGS&#34;</span><span class="op" id="5729800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729805">di</span><span class="op" id="5729807">.</span><span class="ident" id="5729808">CgoCFLAGS</span>&nbsp;<span class="op" id="5729818">=</span>&nbsp;<span class="builtinfunc" id="5729820">append</span><span class="op" id="5729826">(</span><span class="ident" id="5729827">di</span><span class="op" id="5729829">.</span><span class="ident" id="5729830">CgoCFLAGS</span><span class="op" id="5729839">,</span>&nbsp;<span class="ident" id="5729841">args</span><span class="op" id="5729845">...</span><span class="op" id="5729848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729852">case</span>&nbsp;<span class="string" id="5729857">&#34;CPPFLAGS&#34;</span><span class="op" id="5729867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729872">di</span><span class="op" id="5729874">.</span><span class="ident" id="5729875">CgoCPPFLAGS</span>&nbsp;<span class="op" id="5729887">=</span>&nbsp;<span class="builtinfunc" id="5729889">append</span><span class="op" id="5729895">(</span><span class="ident" id="5729896">di</span><span class="op" id="5729898">.</span><span class="ident" id="5729899">CgoCPPFLAGS</span><span class="op" id="5729910">,</span>&nbsp;<span class="ident" id="5729912">args</span><span class="op" id="5729916">...</span><span class="op" id="5729919">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729923">case</span>&nbsp;<span class="string" id="5729928">&#34;CXXFLAGS&#34;</span><span class="op" id="5729938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729943">di</span><span class="op" id="5729945">.</span><span class="ident" id="5729946">CgoCXXFLAGS</span>&nbsp;<span class="op" id="5729958">=</span>&nbsp;<span class="builtinfunc" id="5729960">append</span><span class="op" id="5729966">(</span><span class="ident" id="5729967">di</span><span class="op" id="5729969">.</span><span class="ident" id="5729970">CgoCXXFLAGS</span><span class="op" id="5729981">,</span>&nbsp;<span class="ident" id="5729983">args</span><span class="op" id="5729987">...</span><span class="op" id="5729990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5729994">case</span>&nbsp;<span class="string" id="5729999">&#34;LDFLAGS&#34;</span><span class="op" id="5730008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730013">di</span><span class="op" id="5730015">.</span><span class="ident" id="5730016">CgoLDFLAGS</span>&nbsp;<span class="op" id="5730027">=</span>&nbsp;<span class="builtinfunc" id="5730029">append</span><span class="op" id="5730035">(</span><span class="ident" id="5730036">di</span><span class="op" id="5730038">.</span><span class="ident" id="5730039">CgoLDFLAGS</span><span class="op" id="5730049">,</span>&nbsp;<span class="ident" id="5730051">args</span><span class="op" id="5730055">...</span><span class="op" id="5730058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730062">case</span>&nbsp;<span class="string" id="5730067">&#34;pkg-config&#34;</span><span class="op" id="5730079">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730084">di</span><span class="op" id="5730086">.</span><span class="ident" id="5730087">CgoPkgConfig</span>&nbsp;<span class="op" id="5730100">=</span>&nbsp;<span class="builtinfunc" id="5730102">append</span><span class="op" id="5730108">(</span><span class="ident" id="5730109">di</span><span class="op" id="5730111">.</span><span class="ident" id="5730112">CgoPkgConfig</span><span class="op" id="5730124">,</span>&nbsp;<span class="ident" id="5730126">args</span><span class="op" id="5730130">...</span><span class="op" id="5730133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730137">default</span><span class="op" id="5730144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730149">return</span>&nbsp;<span class="ident" id="5730156">fmt</span><span class="op" id="5730159">.</span><span class="ident" id="5730160">Errorf</span><span class="op" id="5730166">(</span><span class="string" id="5730167">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="5730194">,</span>&nbsp;<span class="ident" id="5730196">filename</span><span class="op" id="5730204">,</span>&nbsp;<span class="ident" id="5730206">orig</span><span class="op" id="5730210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730217">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730220">return</span>&nbsp;<span class="builtintype" id="5730227">nil</span><br>
<span class="lineno"></span><span class="op" id="5730231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5730234">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="5730339">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="5730449">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="5730479">var</span>&nbsp;<span class="ident" id="5730483">safeBytes</span>&nbsp;<span class="op" id="5730493">=</span>&nbsp;<span class="op" id="5730495">[</span><span class="op" id="5730496">]</span><span class="builtintype" id="5730497">byte</span><span class="op" id="5730501">(</span><span class="string" id="5730502">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="5730575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5730578">func</span>&nbsp;<span class="ident" id="5730583">safeCgoName</span><span class="op" id="5730594">(</span><span class="ident" id="5730595">s</span>&nbsp;<span class="builtintype" id="5730597">string</span><span class="op" id="5730603">)</span>&nbsp;<span class="builtintype" id="5730605">bool</span>&nbsp;<span class="op" id="5730610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730613">if</span>&nbsp;<span class="ident" id="5730616">s</span>&nbsp;<span class="op" id="5730618">==</span>&nbsp;<span class="string" id="5730621">&#34;&#34;</span>&nbsp;<span class="op" id="5730624">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730628">return</span>&nbsp;<span class="builtintype" id="5730635">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730645">for</span>&nbsp;<span class="ident" id="5730649">i</span>&nbsp;<span class="op" id="5730651">:=</span>&nbsp;<span class="num" id="5730654">0</span><span class="op" id="5730655">;</span>&nbsp;<span class="ident" id="5730657">i</span>&nbsp;<span class="op" id="5730659">&lt;</span>&nbsp;<span class="builtinfunc" id="5730661">len</span><span class="op" id="5730664">(</span><span class="ident" id="5730665">s</span><span class="op" id="5730666">)</span><span class="op" id="5730667">;</span>&nbsp;<span class="ident" id="5730669">i</span><span class="op" id="5730670">++</span>&nbsp;<span class="op" id="5730673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730677">if</span>&nbsp;<span class="ident" id="5730680">c</span>&nbsp;<span class="op" id="5730682">:=</span>&nbsp;<span class="ident" id="5730685">s</span><span class="op" id="5730686">[</span><span class="ident" id="5730687">i</span><span class="op" id="5730688">]</span><span class="op" id="5730689">;</span>&nbsp;<span class="ident" id="5730691">c</span>&nbsp;<span class="op" id="5730693">&lt;</span>&nbsp;<span class="num" id="5730695">0x80</span>&nbsp;<span class="op" id="5730700">&amp;&amp;</span>&nbsp;<span class="ident" id="5730703">bytes</span><span class="op" id="5730708">.</span><span class="ident" id="5730709">IndexByte</span><span class="op" id="5730718">(</span><span class="ident" id="5730719">safeBytes</span><span class="op" id="5730728">,</span>&nbsp;<span class="ident" id="5730730">c</span><span class="op" id="5730731">)</span>&nbsp;<span class="op" id="5730733">&lt;</span>&nbsp;<span class="num" id="5730735">0</span>&nbsp;<span class="op" id="5730737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730742">return</span>&nbsp;<span class="builtintype" id="5730749">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730763">return</span>&nbsp;<span class="builtintype" id="5730770">true</span><br>
<span class="lineno"></span><span class="op" id="5730775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="5730778">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="5730861">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5730938">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="5731026">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5731108">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="5731189">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5731266">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="5731320">//</span><br>
<span class="lineno"></span><span class="comment" id="5731323">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="5731361">//</span><br>
<span class="lineno">1170</span><span class="comment" id="5731364">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5731395">//</span><br>
<span class="lineno"></span><span class="comment" id="5731398">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="5731421">//</span><br>
<span class="lineno"></span><span class="comment" id="5731424">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="5731466">//</span><br>
<span class="lineno"></span><span class="keyword" id="5731469">func</span>&nbsp;<span class="ident" id="5731474">splitQuoted</span><span class="op" id="5731485">(</span><span class="ident" id="5731486">s</span>&nbsp;<span class="builtintype" id="5731488">string</span><span class="op" id="5731494">)</span>&nbsp;<span class="op" id="5731496">(</span><span class="ident" id="5731497">r</span>&nbsp;<span class="op" id="5731499">[</span><span class="op" id="5731500">]</span><span class="builtintype" id="5731501">string</span><span class="op" id="5731507">,</span>&nbsp;<span class="ident" id="5731509">err</span>&nbsp;<span class="builtintype" id="5731513">error</span><span class="op" id="5731518">)</span>&nbsp;<span class="op" id="5731520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731523">var</span>&nbsp;<span class="ident" id="5731527">args</span>&nbsp;<span class="op" id="5731532">[</span><span class="op" id="5731533">]</span><span class="builtintype" id="5731534">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731542">arg</span>&nbsp;<span class="op" id="5731546">:=</span>&nbsp;<span class="builtinfunc" id="5731549">make</span><span class="op" id="5731553">(</span><span class="op" id="5731554">[</span><span class="op" id="5731555">]</span><span class="builtintype" id="5731556">rune</span><span class="op" id="5731560">,</span>&nbsp;<span class="builtinfunc" id="5731562">len</span><span class="op" id="5731565">(</span><span class="ident" id="5731566">s</span><span class="op" id="5731567">)</span><span class="op" id="5731568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731571">escaped</span>&nbsp;<span class="op" id="5731579">:=</span>&nbsp;<span class="builtintype" id="5731582">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731589">quoted</span>&nbsp;<span class="op" id="5731596">:=</span>&nbsp;<span class="builtintype" id="5731599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731606">quote</span>&nbsp;<span class="op" id="5731612">:=</span>&nbsp;<span class="string" id="5731615">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731623">i</span>&nbsp;<span class="op" id="5731625">:=</span>&nbsp;<span class="num" id="5731628">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731631">for</span>&nbsp;<span class="ident" id="5731635">_</span><span class="op" id="5731636">,</span>&nbsp;<span class="builtintype" id="5731638">rune</span>&nbsp;<span class="op" id="5731643">:=</span>&nbsp;<span class="keyword" id="5731646">range</span>&nbsp;<span class="ident" id="5731652">s</span>&nbsp;<span class="op" id="5731654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731658">switch</span>&nbsp;<span class="op" id="5731665">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731669">case</span>&nbsp;<span class="ident" id="5731674">escaped</span><span class="op" id="5731681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731686">escaped</span>&nbsp;<span class="op" id="5731694">=</span>&nbsp;<span class="builtintype" id="5731696">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731704">case</span>&nbsp;<span class="builtintype" id="5731709">rune</span>&nbsp;<span class="op" id="5731714">==</span>&nbsp;<span class="string" id="5731717">&#39;\\&#39;</span><span class="op" id="5731721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731726">escaped</span>&nbsp;<span class="op" id="5731734">=</span>&nbsp;<span class="builtintype" id="5731736">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731744">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731755">case</span>&nbsp;<span class="ident" id="5731760">quote</span>&nbsp;<span class="op" id="5731766">!=</span>&nbsp;<span class="string" id="5731769">&#39;\x00&#39;</span><span class="op" id="5731775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731780">if</span>&nbsp;<span class="builtintype" id="5731783">rune</span>&nbsp;<span class="op" id="5731788">==</span>&nbsp;<span class="ident" id="5731791">quote</span>&nbsp;<span class="op" id="5731797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731803">quote</span>&nbsp;<span class="op" id="5731809">=</span>&nbsp;<span class="string" id="5731811">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731822">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5731834">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731838">case</span>&nbsp;<span class="builtintype" id="5731843">rune</span>&nbsp;<span class="op" id="5731848">==</span>&nbsp;<span class="string" id="5731851">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="5731855">||</span>&nbsp;<span class="builtintype" id="5731858">rune</span>&nbsp;<span class="op" id="5731863">==</span>&nbsp;<span class="string" id="5731866">&#39;\&#39;&#39;</span><span class="op" id="5731870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731875">quoted</span>&nbsp;<span class="op" id="5731882">=</span>&nbsp;<span class="builtintype" id="5731884">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731892">quote</span>&nbsp;<span class="op" id="5731898">=</span>&nbsp;<span class="builtintype" id="5731900">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731908">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731919">case</span>&nbsp;<span class="ident" id="5731924">unicode</span><span class="op" id="5731931">.</span><span class="ident" id="5731932">IsSpace</span><span class="op" id="5731939">(</span><span class="builtintype" id="5731940">rune</span><span class="op" id="5731944">)</span><span class="op" id="5731945">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731950">if</span>&nbsp;<span class="ident" id="5731953">quoted</span>&nbsp;<span class="op" id="5731960">||</span>&nbsp;<span class="ident" id="5731963">i</span>&nbsp;<span class="op" id="5731965">&gt;</span>&nbsp;<span class="num" id="5731967">0</span>&nbsp;<span class="op" id="5731969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731975">quoted</span>&nbsp;<span class="op" id="5731982">=</span>&nbsp;<span class="builtintype" id="5731984">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731994">args</span>&nbsp;<span class="op" id="5731999">=</span>&nbsp;<span class="builtinfunc" id="5732001">append</span><span class="op" id="5732007">(</span><span class="ident" id="5732008">args</span><span class="op" id="5732012">,</span>&nbsp;<span class="builtintype" id="5732014">string</span><span class="op" id="5732020">(</span><span class="ident" id="5732021">arg</span><span class="op" id="5732024">[</span><span class="op" id="5732025">:</span><span class="ident" id="5732026">i</span><span class="op" id="5732027">]</span><span class="op" id="5732028">)</span><span class="op" id="5732029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732035">i</span>&nbsp;<span class="op" id="5732037">=</span>&nbsp;<span class="num" id="5732039">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732044">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732049">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732064">arg</span><span class="op" id="5732067">[</span><span class="ident" id="5732068">i</span><span class="op" id="5732069">]</span>&nbsp;<span class="op" id="5732071">=</span>&nbsp;<span class="builtintype" id="5732073">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732080">i</span><span class="op" id="5732081">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732085">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732088">if</span>&nbsp;<span class="ident" id="5732091">quoted</span>&nbsp;<span class="op" id="5732098">||</span>&nbsp;<span class="ident" id="5732101">i</span>&nbsp;<span class="op" id="5732103">&gt;</span>&nbsp;<span class="num" id="5732105">0</span>&nbsp;<span class="op" id="5732107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732111">args</span>&nbsp;<span class="op" id="5732116">=</span>&nbsp;<span class="builtinfunc" id="5732118">append</span><span class="op" id="5732124">(</span><span class="ident" id="5732125">args</span><span class="op" id="5732129">,</span>&nbsp;<span class="builtintype" id="5732131">string</span><span class="op" id="5732137">(</span><span class="ident" id="5732138">arg</span><span class="op" id="5732141">[</span><span class="op" id="5732142">:</span><span class="ident" id="5732143">i</span><span class="op" id="5732144">]</span><span class="op" id="5732145">)</span><span class="op" id="5732146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732152">if</span>&nbsp;<span class="ident" id="5732155">quote</span>&nbsp;<span class="op" id="5732161">!=</span>&nbsp;<span class="num" id="5732164">0</span>&nbsp;<span class="op" id="5732166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732170">err</span>&nbsp;<span class="op" id="5732174">=</span>&nbsp;<span class="ident" id="5732176">errors</span><span class="op" id="5732182">.</span><span class="ident" id="5732183">New</span><span class="op" id="5732186">(</span><span class="string" id="5732187">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="5732203">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732206">}</span>&nbsp;<span class="keyword" id="5732208">else</span>&nbsp;<span class="keyword" id="5732213">if</span>&nbsp;<span class="ident" id="5732216">escaped</span>&nbsp;<span class="op" id="5732224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732228">err</span>&nbsp;<span class="op" id="5732232">=</span>&nbsp;<span class="ident" id="5732234">errors</span><span class="op" id="5732240">.</span><span class="ident" id="5732241">New</span><span class="op" id="5732244">(</span><span class="string" id="5732245">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="5732266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732272">return</span>&nbsp;<span class="ident" id="5732279">args</span><span class="op" id="5732283">,</span>&nbsp;<span class="ident" id="5732285">err</span><br>
<span class="lineno"></span><span class="op" id="5732289">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="5732292">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="5732337">//</span><br>
<span class="lineno"></span><span class="comment" id="5732340">//&nbsp;&nbsp;&nbsp;&nbsp;$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="5732349">//&nbsp;&nbsp;&nbsp;&nbsp;$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="5732360">//&nbsp;&nbsp;&nbsp;&nbsp;cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="5732387">//&nbsp;&nbsp;&nbsp;&nbsp;!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="5732416">//&nbsp;&nbsp;&nbsp;&nbsp;ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5732433">//&nbsp;&nbsp;&nbsp;&nbsp;!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="5732451">//&nbsp;&nbsp;&nbsp;&nbsp;tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="5732515">//&nbsp;&nbsp;&nbsp;&nbsp;!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="5732584">//&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5732626">//</span><br>
<span class="lineno"></span><span class="keyword" id="5732629">func</span>&nbsp;<span class="op" id="5732634">(</span><span class="ident" id="5732635">ctxt</span>&nbsp;<span class="op" id="5732640">*</span><span class="ident" id="5732641">Context</span><span class="op" id="5732648">)</span>&nbsp;<span class="ident" id="5732650">match</span><span class="op" id="5732655">(</span><span class="ident" id="5732656">name</span>&nbsp;<span class="builtintype" id="5732661">string</span><span class="op" id="5732667">,</span>&nbsp;<span class="ident" id="5732669">allTags</span>&nbsp;<span class="keyword" id="5732677">map</span><span class="op" id="5732680">[</span><span class="builtintype" id="5732681">string</span><span class="op" id="5732687">]</span><span class="builtintype" id="5732688">bool</span><span class="op" id="5732692">)</span>&nbsp;<span class="builtintype" id="5732694">bool</span>&nbsp;<span class="op" id="5732699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732702">if</span>&nbsp;<span class="ident" id="5732705">name</span>&nbsp;<span class="op" id="5732710">==</span>&nbsp;<span class="string" id="5732713">&#34;&#34;</span>&nbsp;<span class="op" id="5732716">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732720">if</span>&nbsp;<span class="ident" id="5732723">allTags</span>&nbsp;<span class="op" id="5732731">!=</span>&nbsp;<span class="builtintype" id="5732734">nil</span>&nbsp;<span class="op" id="5732738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732743">allTags</span><span class="op" id="5732750">[</span><span class="ident" id="5732751">name</span><span class="op" id="5732755">]</span>&nbsp;<span class="op" id="5732757">=</span>&nbsp;<span class="builtintype" id="5732759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732770">return</span>&nbsp;<span class="builtintype" id="5732777">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732784">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732787">if</span>&nbsp;<span class="ident" id="5732790">i</span>&nbsp;<span class="op" id="5732792">:=</span>&nbsp;<span class="ident" id="5732795">strings</span><span class="op" id="5732802">.</span><span class="ident" id="5732803">Index</span><span class="op" id="5732808">(</span><span class="ident" id="5732809">name</span><span class="op" id="5732813">,</span>&nbsp;<span class="string" id="5732815">&#34;,&#34;</span><span class="op" id="5732818">)</span><span class="op" id="5732819">;</span>&nbsp;<span class="ident" id="5732821">i</span>&nbsp;<span class="op" id="5732823">&gt;=</span>&nbsp;<span class="num" id="5732826">0</span>&nbsp;<span class="op" id="5732828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5732832">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732858">ok1</span>&nbsp;<span class="op" id="5732862">:=</span>&nbsp;<span class="ident" id="5732865">ctxt</span><span class="op" id="5732869">.</span><span class="ident" id="5732870">match</span><span class="op" id="5732875">(</span><span class="ident" id="5732876">name</span><span class="op" id="5732880">[</span><span class="op" id="5732881">:</span><span class="ident" id="5732882">i</span><span class="op" id="5732883">]</span><span class="op" id="5732884">,</span>&nbsp;<span class="ident" id="5732886">allTags</span><span class="op" id="5732893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732897">ok2</span>&nbsp;<span class="op" id="5732901">:=</span>&nbsp;<span class="ident" id="5732904">ctxt</span><span class="op" id="5732908">.</span><span class="ident" id="5732909">match</span><span class="op" id="5732914">(</span><span class="ident" id="5732915">name</span><span class="op" id="5732919">[</span><span class="ident" id="5732920">i</span><span class="op" id="5732921">+</span><span class="num" id="5732922">1</span><span class="op" id="5732923">:</span><span class="op" id="5732924">]</span><span class="op" id="5732925">,</span>&nbsp;<span class="ident" id="5732927">allTags</span><span class="op" id="5732934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732938">return</span>&nbsp;<span class="ident" id="5732945">ok1</span>&nbsp;<span class="op" id="5732949">&amp;&amp;</span>&nbsp;<span class="ident" id="5732952">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732960">if</span>&nbsp;<span class="ident" id="5732963">strings</span><span class="op" id="5732970">.</span><span class="ident" id="5732971">HasPrefix</span><span class="op" id="5732980">(</span><span class="ident" id="5732981">name</span><span class="op" id="5732985">,</span>&nbsp;<span class="string" id="5732987">&#34;!!&#34;</span><span class="op" id="5732991">)</span>&nbsp;<span class="op" id="5732993">{</span>&nbsp;<span class="comment" id="5732995">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733026">return</span>&nbsp;<span class="builtintype" id="5733033">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733043">if</span>&nbsp;<span class="ident" id="5733046">strings</span><span class="op" id="5733053">.</span><span class="ident" id="5733054">HasPrefix</span><span class="op" id="5733063">(</span><span class="ident" id="5733064">name</span><span class="op" id="5733068">,</span>&nbsp;<span class="string" id="5733070">&#34;!&#34;</span><span class="op" id="5733073">)</span>&nbsp;<span class="op" id="5733075">{</span>&nbsp;<span class="comment" id="5733077">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733091">return</span>&nbsp;<span class="builtinfunc" id="5733098">len</span><span class="op" id="5733101">(</span><span class="ident" id="5733102">name</span><span class="op" id="5733106">)</span>&nbsp;<span class="op" id="5733108">&gt;</span>&nbsp;<span class="num" id="5733110">1</span>&nbsp;<span class="op" id="5733112">&amp;&amp;</span>&nbsp;<span class="op" id="5733115">!</span><span class="ident" id="5733116">ctxt</span><span class="op" id="5733120">.</span><span class="ident" id="5733121">match</span><span class="op" id="5733126">(</span><span class="ident" id="5733127">name</span><span class="op" id="5733131">[</span><span class="num" id="5733132">1</span><span class="op" id="5733133">:</span><span class="op" id="5733134">]</span><span class="op" id="5733135">,</span>&nbsp;<span class="ident" id="5733137">allTags</span><span class="op" id="5733144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733151">if</span>&nbsp;<span class="ident" id="5733154">allTags</span>&nbsp;<span class="op" id="5733162">!=</span>&nbsp;<span class="builtintype" id="5733165">nil</span>&nbsp;<span class="op" id="5733169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733173">allTags</span><span class="op" id="5733180">[</span><span class="ident" id="5733181">name</span><span class="op" id="5733185">]</span>&nbsp;<span class="op" id="5733187">=</span>&nbsp;<span class="builtintype" id="5733189">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5733199">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5733254">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733319">for</span>&nbsp;<span class="ident" id="5733323">_</span><span class="op" id="5733324">,</span>&nbsp;<span class="ident" id="5733326">c</span>&nbsp;<span class="op" id="5733328">:=</span>&nbsp;<span class="keyword" id="5733331">range</span>&nbsp;<span class="ident" id="5733337">name</span>&nbsp;<span class="op" id="5733342">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733346">if</span>&nbsp;<span class="op" id="5733349">!</span><span class="ident" id="5733350">unicode</span><span class="op" id="5733357">.</span><span class="ident" id="5733358">IsLetter</span><span class="op" id="5733366">(</span><span class="ident" id="5733367">c</span><span class="op" id="5733368">)</span>&nbsp;<span class="op" id="5733370">&amp;&amp;</span>&nbsp;<span class="op" id="5733373">!</span><span class="ident" id="5733374">unicode</span><span class="op" id="5733381">.</span><span class="ident" id="5733382">IsDigit</span><span class="op" id="5733389">(</span><span class="ident" id="5733390">c</span><span class="op" id="5733391">)</span>&nbsp;<span class="op" id="5733393">&amp;&amp;</span>&nbsp;<span class="ident" id="5733396">c</span>&nbsp;<span class="op" id="5733398">!=</span>&nbsp;<span class="string" id="5733401">&#39;_&#39;</span>&nbsp;<span class="op" id="5733405">&amp;&amp;</span>&nbsp;<span class="ident" id="5733408">c</span>&nbsp;<span class="op" id="5733410">!=</span>&nbsp;<span class="string" id="5733413">&#39;.&#39;</span>&nbsp;<span class="op" id="5733417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733422">return</span>&nbsp;<span class="builtintype" id="5733429">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5733444">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733461">if</span>&nbsp;<span class="ident" id="5733464">ctxt</span><span class="op" id="5733468">.</span><span class="ident" id="5733469">CgoEnabled</span>&nbsp;<span class="op" id="5733480">&amp;&amp;</span>&nbsp;<span class="ident" id="5733483">name</span>&nbsp;<span class="op" id="5733488">==</span>&nbsp;<span class="string" id="5733491">&#34;cgo&#34;</span>&nbsp;<span class="op" id="5733497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733501">return</span>&nbsp;<span class="builtintype" id="5733508">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733517">if</span>&nbsp;<span class="ident" id="5733520">name</span>&nbsp;<span class="op" id="5733525">==</span>&nbsp;<span class="ident" id="5733528">ctxt</span><span class="op" id="5733532">.</span><span class="ident" id="5733533">GOOS</span>&nbsp;<span class="op" id="5733538">||</span>&nbsp;<span class="ident" id="5733541">name</span>&nbsp;<span class="op" id="5733546">==</span>&nbsp;<span class="ident" id="5733549">ctxt</span><span class="op" id="5733553">.</span><span class="ident" id="5733554">GOARCH</span>&nbsp;<span class="op" id="5733561">||</span>&nbsp;<span class="ident" id="5733564">name</span>&nbsp;<span class="op" id="5733569">==</span>&nbsp;<span class="ident" id="5733572">ctxt</span><span class="op" id="5733576">.</span><span class="ident" id="5733577">Compiler</span>&nbsp;<span class="op" id="5733586">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733590">return</span>&nbsp;<span class="builtintype" id="5733597">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733606">if</span>&nbsp;<span class="ident" id="5733609">ctxt</span><span class="op" id="5733613">.</span><span class="ident" id="5733614">GOOS</span>&nbsp;<span class="op" id="5733619">==</span>&nbsp;<span class="string" id="5733622">&#34;android&#34;</span>&nbsp;<span class="op" id="5733632">&amp;&amp;</span>&nbsp;<span class="ident" id="5733635">name</span>&nbsp;<span class="op" id="5733640">==</span>&nbsp;<span class="string" id="5733643">&#34;linux&#34;</span>&nbsp;<span class="op" id="5733651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733655">return</span>&nbsp;<span class="builtintype" id="5733662">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733668">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5733672">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733687">for</span>&nbsp;<span class="ident" id="5733691">_</span><span class="op" id="5733692">,</span>&nbsp;<span class="ident" id="5733694">tag</span>&nbsp;<span class="op" id="5733698">:=</span>&nbsp;<span class="keyword" id="5733701">range</span>&nbsp;<span class="ident" id="5733707">ctxt</span><span class="op" id="5733711">.</span><span class="ident" id="5733712">BuildTags</span>&nbsp;<span class="op" id="5733722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733726">if</span>&nbsp;<span class="ident" id="5733729">tag</span>&nbsp;<span class="op" id="5733733">==</span>&nbsp;<span class="ident" id="5733736">name</span>&nbsp;<span class="op" id="5733741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733746">return</span>&nbsp;<span class="builtintype" id="5733753">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733766">for</span>&nbsp;<span class="ident" id="5733770">_</span><span class="op" id="5733771">,</span>&nbsp;<span class="ident" id="5733773">tag</span>&nbsp;<span class="op" id="5733777">:=</span>&nbsp;<span class="keyword" id="5733780">range</span>&nbsp;<span class="ident" id="5733786">ctxt</span><span class="op" id="5733790">.</span><span class="ident" id="5733791">ReleaseTags</span>&nbsp;<span class="op" id="5733803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733807">if</span>&nbsp;<span class="ident" id="5733810">tag</span>&nbsp;<span class="op" id="5733814">==</span>&nbsp;<span class="ident" id="5733817">name</span>&nbsp;<span class="op" id="5733822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733827">return</span>&nbsp;<span class="builtintype" id="5733834">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733848">return</span>&nbsp;<span class="builtintype" id="5733855">false</span><br>
<span class="lineno"></span><span class="op" id="5733861">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="5733864">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="5733936">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="5733987">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="5734023">//</span><br>
<span class="lineno">1295</span><span class="comment" id="5734026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="5734048">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5734072">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="5734104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5734131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="5734160">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="5734197">//</span><br>
<span class="lineno"></span><span class="comment" id="5734200">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="5734279">func</span>&nbsp;<span class="op" id="5734284">(</span><span class="ident" id="5734285">ctxt</span>&nbsp;<span class="op" id="5734290">*</span><span class="ident" id="5734291">Context</span><span class="op" id="5734298">)</span>&nbsp;<span class="ident" id="5734300">goodOSArchFile</span><span class="op" id="5734314">(</span><span class="ident" id="5734315">name</span>&nbsp;<span class="builtintype" id="5734320">string</span><span class="op" id="5734326">,</span>&nbsp;<span class="ident" id="5734328">allTags</span>&nbsp;<span class="keyword" id="5734336">map</span><span class="op" id="5734339">[</span><span class="builtintype" id="5734340">string</span><span class="op" id="5734346">]</span><span class="builtintype" id="5734347">bool</span><span class="op" id="5734351">)</span>&nbsp;<span class="builtintype" id="5734353">bool</span>&nbsp;<span class="op" id="5734358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734361">if</span>&nbsp;<span class="ident" id="5734364">dot</span>&nbsp;<span class="op" id="5734368">:=</span>&nbsp;<span class="ident" id="5734371">strings</span><span class="op" id="5734378">.</span><span class="ident" id="5734379">Index</span><span class="op" id="5734384">(</span><span class="ident" id="5734385">name</span><span class="op" id="5734389">,</span>&nbsp;<span class="string" id="5734391">&#34;.&#34;</span><span class="op" id="5734394">)</span><span class="op" id="5734395">;</span>&nbsp;<span class="ident" id="5734397">dot</span>&nbsp;<span class="op" id="5734401">!=</span>&nbsp;<span class="op" id="5734404">-</span><span class="num" id="5734405">1</span>&nbsp;<span class="op" id="5734407">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734411">name</span>&nbsp;<span class="op" id="5734416">=</span>&nbsp;<span class="ident" id="5734418">name</span><span class="op" id="5734422">[</span><span class="op" id="5734423">:</span><span class="ident" id="5734424">dot</span><span class="op" id="5734427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734434">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734510">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734585">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734653">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734731">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734806">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734881">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734919">i</span>&nbsp;<span class="op" id="5734921">:=</span>&nbsp;<span class="ident" id="5734924">strings</span><span class="op" id="5734931">.</span><span class="ident" id="5734932">Index</span><span class="op" id="5734937">(</span><span class="ident" id="5734938">name</span><span class="op" id="5734942">,</span>&nbsp;<span class="string" id="5734944">&#34;_&#34;</span><span class="op" id="5734947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734950">if</span>&nbsp;<span class="ident" id="5734953">i</span>&nbsp;<span class="op" id="5734955">&lt;</span>&nbsp;<span class="num" id="5734957">0</span>&nbsp;<span class="op" id="5734959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734963">return</span>&nbsp;<span class="builtintype" id="5734970">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734979">name</span>&nbsp;<span class="op" id="5734984">=</span>&nbsp;<span class="ident" id="5734986">name</span><span class="op" id="5734990">[</span><span class="ident" id="5734991">i</span><span class="op" id="5734992">:</span><span class="op" id="5734993">]</span>&nbsp;<span class="comment" id="5734995">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735033">l</span>&nbsp;<span class="op" id="5735035">:=</span>&nbsp;<span class="ident" id="5735038">strings</span><span class="op" id="5735045">.</span><span class="ident" id="5735046">Split</span><span class="op" id="5735051">(</span><span class="ident" id="5735052">name</span><span class="op" id="5735056">,</span>&nbsp;<span class="string" id="5735058">&#34;_&#34;</span><span class="op" id="5735061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735064">if</span>&nbsp;<span class="ident" id="5735067">n</span>&nbsp;<span class="op" id="5735069">:=</span>&nbsp;<span class="builtinfunc" id="5735072">len</span><span class="op" id="5735075">(</span><span class="ident" id="5735076">l</span><span class="op" id="5735077">)</span><span class="op" id="5735078">;</span>&nbsp;<span class="ident" id="5735080">n</span>&nbsp;<span class="op" id="5735082">&gt;</span>&nbsp;<span class="num" id="5735084">0</span>&nbsp;<span class="op" id="5735086">&amp;&amp;</span>&nbsp;<span class="ident" id="5735089">l</span><span class="op" id="5735090">[</span><span class="ident" id="5735091">n</span><span class="op" id="5735092">-</span><span class="num" id="5735093">1</span><span class="op" id="5735094">]</span>&nbsp;<span class="op" id="5735096">==</span>&nbsp;<span class="string" id="5735099">&#34;test&#34;</span>&nbsp;<span class="op" id="5735106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735110">l</span>&nbsp;<span class="op" id="5735112">=</span>&nbsp;<span class="ident" id="5735114">l</span><span class="op" id="5735115">[</span><span class="op" id="5735116">:</span><span class="ident" id="5735117">n</span><span class="op" id="5735118">-</span><span class="num" id="5735119">1</span><span class="op" id="5735120">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735123">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735126">n</span>&nbsp;<span class="op" id="5735128">:=</span>&nbsp;<span class="builtinfunc" id="5735131">len</span><span class="op" id="5735134">(</span><span class="ident" id="5735135">l</span><span class="op" id="5735136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735139">if</span>&nbsp;<span class="ident" id="5735142">n</span>&nbsp;<span class="op" id="5735144">&gt;=</span>&nbsp;<span class="num" id="5735147">2</span>&nbsp;<span class="op" id="5735149">&amp;&amp;</span>&nbsp;<span class="ident" id="5735152">knownOS</span><span class="op" id="5735159">[</span><span class="ident" id="5735160">l</span><span class="op" id="5735161">[</span><span class="ident" id="5735162">n</span><span class="op" id="5735163">-</span><span class="num" id="5735164">2</span><span class="op" id="5735165">]</span><span class="op" id="5735166">]</span>&nbsp;<span class="op" id="5735168">&amp;&amp;</span>&nbsp;<span class="ident" id="5735171">knownArch</span><span class="op" id="5735180">[</span><span class="ident" id="5735181">l</span><span class="op" id="5735182">[</span><span class="ident" id="5735183">n</span><span class="op" id="5735184">-</span><span class="num" id="5735185">1</span><span class="op" id="5735186">]</span><span class="op" id="5735187">]</span>&nbsp;<span class="op" id="5735189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735193">if</span>&nbsp;<span class="ident" id="5735196">allTags</span>&nbsp;<span class="op" id="5735204">!=</span>&nbsp;<span class="builtintype" id="5735207">nil</span>&nbsp;<span class="op" id="5735211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735216">allTags</span><span class="op" id="5735223">[</span><span class="ident" id="5735224">l</span><span class="op" id="5735225">[</span><span class="ident" id="5735226">n</span><span class="op" id="5735227">-</span><span class="num" id="5735228">2</span><span class="op" id="5735229">]</span><span class="op" id="5735230">]</span>&nbsp;<span class="op" id="5735232">=</span>&nbsp;<span class="builtintype" id="5735234">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735242">allTags</span><span class="op" id="5735249">[</span><span class="ident" id="5735250">l</span><span class="op" id="5735251">[</span><span class="ident" id="5735252">n</span><span class="op" id="5735253">-</span><span class="num" id="5735254">1</span><span class="op" id="5735255">]</span><span class="op" id="5735256">]</span>&nbsp;<span class="op" id="5735258">=</span>&nbsp;<span class="builtintype" id="5735260">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735271">if</span>&nbsp;<span class="ident" id="5735274">l</span><span class="op" id="5735275">[</span><span class="ident" id="5735276">n</span><span class="op" id="5735277">-</span><span class="num" id="5735278">1</span><span class="op" id="5735279">]</span>&nbsp;<span class="op" id="5735281">!=</span>&nbsp;<span class="ident" id="5735284">ctxt</span><span class="op" id="5735288">.</span><span class="ident" id="5735289">GOARCH</span>&nbsp;<span class="op" id="5735296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735301">return</span>&nbsp;<span class="builtintype" id="5735308">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735320">if</span>&nbsp;<span class="ident" id="5735323">ctxt</span><span class="op" id="5735327">.</span><span class="ident" id="5735328">GOOS</span>&nbsp;<span class="op" id="5735333">==</span>&nbsp;<span class="string" id="5735336">&#34;android&#34;</span>&nbsp;<span class="op" id="5735346">&amp;&amp;</span>&nbsp;<span class="ident" id="5735349">l</span><span class="op" id="5735350">[</span><span class="ident" id="5735351">n</span><span class="op" id="5735352">-</span><span class="num" id="5735353">2</span><span class="op" id="5735354">]</span>&nbsp;<span class="op" id="5735356">==</span>&nbsp;<span class="string" id="5735359">&#34;linux&#34;</span>&nbsp;<span class="op" id="5735367">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735372">return</span>&nbsp;<span class="builtintype" id="5735379">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735390">return</span>&nbsp;<span class="ident" id="5735397">l</span><span class="op" id="5735398">[</span><span class="ident" id="5735399">n</span><span class="op" id="5735400">-</span><span class="num" id="5735401">2</span><span class="op" id="5735402">]</span>&nbsp;<span class="op" id="5735404">==</span>&nbsp;<span class="ident" id="5735407">ctxt</span><span class="op" id="5735411">.</span><span class="ident" id="5735412">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735421">if</span>&nbsp;<span class="ident" id="5735424">n</span>&nbsp;<span class="op" id="5735426">&gt;=</span>&nbsp;<span class="num" id="5735429">1</span>&nbsp;<span class="op" id="5735431">&amp;&amp;</span>&nbsp;<span class="ident" id="5735434">knownOS</span><span class="op" id="5735441">[</span><span class="ident" id="5735442">l</span><span class="op" id="5735443">[</span><span class="ident" id="5735444">n</span><span class="op" id="5735445">-</span><span class="num" id="5735446">1</span><span class="op" id="5735447">]</span><span class="op" id="5735448">]</span>&nbsp;<span class="op" id="5735450">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735454">if</span>&nbsp;<span class="ident" id="5735457">allTags</span>&nbsp;<span class="op" id="5735465">!=</span>&nbsp;<span class="builtintype" id="5735468">nil</span>&nbsp;<span class="op" id="5735472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735477">allTags</span><span class="op" id="5735484">[</span><span class="ident" id="5735485">l</span><span class="op" id="5735486">[</span><span class="ident" id="5735487">n</span><span class="op" id="5735488">-</span><span class="num" id="5735489">1</span><span class="op" id="5735490">]</span><span class="op" id="5735491">]</span>&nbsp;<span class="op" id="5735493">=</span>&nbsp;<span class="builtintype" id="5735495">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735506">if</span>&nbsp;<span class="ident" id="5735509">ctxt</span><span class="op" id="5735513">.</span><span class="ident" id="5735514">GOOS</span>&nbsp;<span class="op" id="5735519">==</span>&nbsp;<span class="string" id="5735522">&#34;android&#34;</span>&nbsp;<span class="op" id="5735532">&amp;&amp;</span>&nbsp;<span class="ident" id="5735535">l</span><span class="op" id="5735536">[</span><span class="ident" id="5735537">n</span><span class="op" id="5735538">-</span><span class="num" id="5735539">1</span><span class="op" id="5735540">]</span>&nbsp;<span class="op" id="5735542">==</span>&nbsp;<span class="string" id="5735545">&#34;linux&#34;</span>&nbsp;<span class="op" id="5735553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735558">return</span>&nbsp;<span class="builtintype" id="5735565">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735576">return</span>&nbsp;<span class="ident" id="5735583">l</span><span class="op" id="5735584">[</span><span class="ident" id="5735585">n</span><span class="op" id="5735586">-</span><span class="num" id="5735587">1</span><span class="op" id="5735588">]</span>&nbsp;<span class="op" id="5735590">==</span>&nbsp;<span class="ident" id="5735593">ctxt</span><span class="op" id="5735597">.</span><span class="ident" id="5735598">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735607">if</span>&nbsp;<span class="ident" id="5735610">n</span>&nbsp;<span class="op" id="5735612">&gt;=</span>&nbsp;<span class="num" id="5735615">1</span>&nbsp;<span class="op" id="5735617">&amp;&amp;</span>&nbsp;<span class="ident" id="5735620">knownArch</span><span class="op" id="5735629">[</span><span class="ident" id="5735630">l</span><span class="op" id="5735631">[</span><span class="ident" id="5735632">n</span><span class="op" id="5735633">-</span><span class="num" id="5735634">1</span><span class="op" id="5735635">]</span><span class="op" id="5735636">]</span>&nbsp;<span class="op" id="5735638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735642">if</span>&nbsp;<span class="ident" id="5735645">allTags</span>&nbsp;<span class="op" id="5735653">!=</span>&nbsp;<span class="builtintype" id="5735656">nil</span>&nbsp;<span class="op" id="5735660">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735665">allTags</span><span class="op" id="5735672">[</span><span class="ident" id="5735673">l</span><span class="op" id="5735674">[</span><span class="ident" id="5735675">n</span><span class="op" id="5735676">-</span><span class="num" id="5735677">1</span><span class="op" id="5735678">]</span><span class="op" id="5735679">]</span>&nbsp;<span class="op" id="5735681">=</span>&nbsp;<span class="builtintype" id="5735683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735694">return</span>&nbsp;<span class="ident" id="5735701">l</span><span class="op" id="5735702">[</span><span class="ident" id="5735703">n</span><span class="op" id="5735704">-</span><span class="num" id="5735705">1</span><span class="op" id="5735706">]</span>&nbsp;<span class="op" id="5735708">==</span>&nbsp;<span class="ident" id="5735711">ctxt</span><span class="op" id="5735715">.</span><span class="ident" id="5735716">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735727">return</span>&nbsp;<span class="builtintype" id="5735734">true</span><br>
<span class="lineno">1355</span><span class="op" id="5735739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5735742">var</span>&nbsp;<span class="ident" id="5735746">knownOS</span>&nbsp;<span class="op" id="5735754">=</span>&nbsp;<span class="builtinfunc" id="5735756">make</span><span class="op" id="5735760">(</span><span class="keyword" id="5735761">map</span><span class="op" id="5735764">[</span><span class="builtintype" id="5735765">string</span><span class="op" id="5735771">]</span><span class="builtintype" id="5735772">bool</span><span class="op" id="5735776">)</span><br>
<span class="lineno"></span><span class="keyword" id="5735778">var</span>&nbsp;<span class="ident" id="5735782">knownArch</span>&nbsp;<span class="op" id="5735792">=</span>&nbsp;<span class="builtinfunc" id="5735794">make</span><span class="op" id="5735798">(</span><span class="keyword" id="5735799">map</span><span class="op" id="5735802">[</span><span class="builtintype" id="5735803">string</span><span class="op" id="5735809">]</span><span class="builtintype" id="5735810">bool</span><span class="op" id="5735814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="5735817">func</span>&nbsp;<span class="ident" id="5735822">init</span><span class="op" id="5735826">(</span><span class="op" id="5735827">)</span>&nbsp;<span class="op" id="5735829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735832">for</span>&nbsp;<span class="ident" id="5735836">_</span><span class="op" id="5735837">,</span>&nbsp;<span class="ident" id="5735839">v</span>&nbsp;<span class="op" id="5735841">:=</span>&nbsp;<span class="keyword" id="5735844">range</span>&nbsp;<span class="ident" id="5735850">strings</span><span class="op" id="5735857">.</span><span class="ident" id="5735858">Fields</span><span class="op" id="5735864">(</span><span class="ident" id="5735865">goosList</span><span class="op" id="5735873">)</span>&nbsp;<span class="op" id="5735875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735879">knownOS</span><span class="op" id="5735886">[</span><span class="ident" id="5735887">v</span><span class="op" id="5735888">]</span>&nbsp;<span class="op" id="5735890">=</span>&nbsp;<span class="builtintype" id="5735892">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735901">for</span>&nbsp;<span class="ident" id="5735905">_</span><span class="op" id="5735906">,</span>&nbsp;<span class="ident" id="5735908">v</span>&nbsp;<span class="op" id="5735910">:=</span>&nbsp;<span class="keyword" id="5735913">range</span>&nbsp;<span class="ident" id="5735919">strings</span><span class="op" id="5735926">.</span><span class="ident" id="5735927">Fields</span><span class="op" id="5735933">(</span><span class="ident" id="5735934">goarchList</span><span class="op" id="5735944">)</span>&nbsp;<span class="op" id="5735946">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735950">knownArch</span><span class="op" id="5735959">[</span><span class="ident" id="5735960">v</span><span class="op" id="5735961">]</span>&nbsp;<span class="op" id="5735963">=</span>&nbsp;<span class="builtintype" id="5735965">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735971">}</span><br>
<span class="lineno"></span><span class="op" id="5735973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5735976">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="5736028">var</span>&nbsp;<span class="ident" id="5736032">ToolDir</span>&nbsp;<span class="op" id="5736040">=</span>&nbsp;<span class="ident" id="5736042">filepath</span><span class="op" id="5736050">.</span><span class="ident" id="5736051">Join</span><span class="op" id="5736055">(</span><span class="ident" id="5736056">runtime</span><span class="op" id="5736063">.</span><span class="ident" id="5736064">GOROOT</span><span class="op" id="5736070">(</span><span class="op" id="5736071">)</span><span class="op" id="5736072">,</span>&nbsp;<span class="string" id="5736074">&#34;pkg/tool/&#34;</span><span class="op" id="5736085">+</span><span class="ident" id="5736086">runtime</span><span class="op" id="5736093">.</span><span class="ident" id="5736094">GOOS</span><span class="op" id="5736098">+</span><span class="string" id="5736099">&#34;_&#34;</span><span class="op" id="5736102">+</span><span class="ident" id="5736103">runtime</span><span class="op" id="5736110">.</span><span class="ident" id="5736111">GOARCH</span><span class="op" id="5736117">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5736120">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5736172">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5736234">func</span>&nbsp;<span class="ident" id="5736239">IsLocalImport</span><span class="op" id="5736252">(</span><span class="ident" id="5736253">path</span>&nbsp;<span class="builtintype" id="5736258">string</span><span class="op" id="5736264">)</span>&nbsp;<span class="builtintype" id="5736266">bool</span>&nbsp;<span class="op" id="5736271">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736274">return</span>&nbsp;<span class="ident" id="5736281">path</span>&nbsp;<span class="op" id="5736286">==</span>&nbsp;<span class="string" id="5736289">&#34;.&#34;</span>&nbsp;<span class="op" id="5736293">||</span>&nbsp;<span class="ident" id="5736296">path</span>&nbsp;<span class="op" id="5736301">==</span>&nbsp;<span class="string" id="5736304">&#34;..&#34;</span>&nbsp;<span class="op" id="5736309">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736314">strings</span><span class="op" id="5736321">.</span><span class="ident" id="5736322">HasPrefix</span><span class="op" id="5736331">(</span><span class="ident" id="5736332">path</span><span class="op" id="5736336">,</span>&nbsp;<span class="string" id="5736338">&#34;./&#34;</span><span class="op" id="5736342">)</span>&nbsp;<span class="op" id="5736344">||</span>&nbsp;<span class="ident" id="5736347">strings</span><span class="op" id="5736354">.</span><span class="ident" id="5736355">HasPrefix</span><span class="op" id="5736364">(</span><span class="ident" id="5736365">path</span><span class="op" id="5736369">,</span>&nbsp;<span class="string" id="5736371">&#34;../&#34;</span><span class="op" id="5736376">)</span><br>
<span class="lineno"></span><span class="op" id="5736378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5736381">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="5736450">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5736497">func</span>&nbsp;<span class="ident" id="5736502">ArchChar</span><span class="op" id="5736510">(</span><span class="ident" id="5736511">goarch</span>&nbsp;<span class="builtintype" id="5736518">string</span><span class="op" id="5736524">)</span>&nbsp;<span class="op" id="5736526">(</span><span class="builtintype" id="5736527">string</span><span class="op" id="5736533">,</span>&nbsp;<span class="builtintype" id="5736535">error</span><span class="op" id="5736540">)</span>&nbsp;<span class="op" id="5736542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736545">switch</span>&nbsp;<span class="ident" id="5736552">goarch</span>&nbsp;<span class="op" id="5736559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736562">case</span>&nbsp;<span class="string" id="5736567">&#34;386&#34;</span><span class="op" id="5736572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736576">return</span>&nbsp;<span class="string" id="5736583">&#34;8&#34;</span><span class="op" id="5736586">,</span>&nbsp;<span class="builtintype" id="5736588">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736593">case</span>&nbsp;<span class="string" id="5736598">&#34;amd64&#34;</span><span class="op" id="5736605">,</span>&nbsp;<span class="string" id="5736607">&#34;amd64p32&#34;</span><span class="op" id="5736617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736621">return</span>&nbsp;<span class="string" id="5736628">&#34;6&#34;</span><span class="op" id="5736631">,</span>&nbsp;<span class="builtintype" id="5736633">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736638">case</span>&nbsp;<span class="string" id="5736643">&#34;arm&#34;</span><span class="op" id="5736648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736652">return</span>&nbsp;<span class="string" id="5736659">&#34;5&#34;</span><span class="op" id="5736662">,</span>&nbsp;<span class="builtintype" id="5736664">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736669">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736672">return</span>&nbsp;<span class="string" id="5736679">&#34;&#34;</span><span class="op" id="5736681">,</span>&nbsp;<span class="ident" id="5736683">errors</span><span class="op" id="5736689">.</span><span class="ident" id="5736690">New</span><span class="op" id="5736693">(</span><span class="string" id="5736694">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="5736716">+</span>&nbsp;<span class="ident" id="5736718">goarch</span><span class="op" id="5736724">)</span><br>
<span class="lineno"></span><span class="op" id="5736726">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
