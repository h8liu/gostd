<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8331777">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8331832">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8331886">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8331937">package</span>&nbsp;<span class="ident" id="8331945">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8331952">import</span>&nbsp;<span class="op" id="8331959">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8331962">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8331971">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8331989">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332008">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332023">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332038">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332055">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332072">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332088">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332096">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332102">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332114">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332120">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8332131">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8332141">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8332144">func</span>&nbsp;<span class="ident" id="8332149">testKeyGeneration</span><span class="op" id="8332166">(</span><span class="ident" id="8332167">t</span>&nbsp;<span class="op" id="8332169">*</span><span class="ident" id="8332170"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8332177">.</span><span class="ident" id="8332178">T</span><span class="op" id="8332179">,</span>&nbsp;<span class="ident" id="8332181">c</span>&nbsp;<span class="ident" id="8332183"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332191">.</span><span class="ident" id="8332192">Curve</span><span class="op" id="8332197">,</span>&nbsp;<span class="ident" id="8332199">tag</span>&nbsp;<span class="builtintype" id="8332203">string</span><span class="op" id="8332209">)</span>&nbsp;<span class="op" id="8332211">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332214">priv</span><span class="op" id="8332218">,</span>&nbsp;<span class="ident" id="8332220">err</span>&nbsp;<span class="op" id="8332224">:=</span>&nbsp;<span class="ident" id="8332227"><a href="/crypto/ecdsa/ecdsa.go.html#4194355">GenerateKey</a></span><span class="op" id="8332238">(</span><span class="ident" id="8332239"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332181">c</a></span><span class="op" id="8332240">,</span>&nbsp;<span class="ident" id="8332242"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332008">rand</a></span><span class="op" id="8332246">.</span><span class="ident" id="8332247">Reader</span><span class="op" id="8332253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332256">if</span>&nbsp;<span class="ident" id="8332259"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332220">err</a></span>&nbsp;<span class="op" id="8332263">!=</span>&nbsp;<span class="ident" id="8332266">nil</span>&nbsp;<span class="op" id="8332270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332274"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332167">t</a></span><span class="op" id="8332275">.</span><span class="ident" id="8332276">Errorf</span><span class="op" id="8332282">(</span><span class="string" id="8332283">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8332298">,</span>&nbsp;<span class="ident" id="8332300"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332199">tag</a></span><span class="op" id="8332303">,</span>&nbsp;<span class="ident" id="8332305"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332220">err</a></span><span class="op" id="8332308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332312">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332320">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332323">if</span>&nbsp;<span class="op" id="8332326">!</span><span class="ident" id="8332327"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332181">c</a></span><span class="op" id="8332328">.</span><span class="ident" id="8332329">IsOnCurve</span><span class="op" id="8332338">(</span><span class="ident" id="8332339"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332214">priv</a></span><span class="op" id="8332343">.</span><span class="ident" id="8332344">PublicKey</span><span class="op" id="8332353">.</span><span class="ident" id="8332354">X</span><span class="op" id="8332355">,</span>&nbsp;<span class="ident" id="8332357"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332214">priv</a></span><span class="op" id="8332361">.</span><span class="ident" id="8332362">PublicKey</span><span class="op" id="8332371">.</span><span class="ident" id="8332372">Y</span><span class="op" id="8332373">)</span>&nbsp;<span class="op" id="8332375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332379"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332167">t</a></span><span class="op" id="8332380">.</span><span class="ident" id="8332381">Errorf</span><span class="op" id="8332387">(</span><span class="string" id="8332388">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="8332416">,</span>&nbsp;<span class="ident" id="8332418"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332199">tag</a></span><span class="op" id="8332421">,</span>&nbsp;<span class="ident" id="8332423"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332220">err</a></span><span class="op" id="8332426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332429">}</span><br>
<span class="lineno"></span><span class="op" id="8332431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8332434">func</span>&nbsp;<span class="ident" id="8332439">TestKeyGeneration</span><span class="op" id="8332456">(</span><span class="ident" id="8332457">t</span>&nbsp;<span class="op" id="8332459">*</span><span class="ident" id="8332460"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8332467">.</span><span class="ident" id="8332468">T</span><span class="op" id="8332469">)</span>&nbsp;<span class="op" id="8332471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332474"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332149">testKeyGeneration</a></span><span class="op" id="8332491">(</span><span class="ident" id="8332492"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332457">t</a></span><span class="op" id="8332493">,</span>&nbsp;<span class="ident" id="8332495"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332503">.</span><span class="ident" id="8332504">P224</span><span class="op" id="8332508">(</span><span class="op" id="8332509">)</span><span class="op" id="8332510">,</span>&nbsp;<span class="string" id="8332512">&#34;p224&#34;</span><span class="op" id="8332518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332521">if</span>&nbsp;<span class="ident" id="8332524"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8332531">.</span><span class="ident" id="8332532">Short</span><span class="op" id="8332537">(</span><span class="op" id="8332538">)</span>&nbsp;<span class="op" id="8332540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332552">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332555"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332149">testKeyGeneration</a></span><span class="op" id="8332572">(</span><span class="ident" id="8332573"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332457">t</a></span><span class="op" id="8332574">,</span>&nbsp;<span class="ident" id="8332576"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332584">.</span><span class="ident" id="8332585">P256</span><span class="op" id="8332589">(</span><span class="op" id="8332590">)</span><span class="op" id="8332591">,</span>&nbsp;<span class="string" id="8332593">&#34;p256&#34;</span><span class="op" id="8332599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332602"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332149">testKeyGeneration</a></span><span class="op" id="8332619">(</span><span class="ident" id="8332620"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332457">t</a></span><span class="op" id="8332621">,</span>&nbsp;<span class="ident" id="8332623"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332631">.</span><span class="ident" id="8332632">P384</span><span class="op" id="8332636">(</span><span class="op" id="8332637">)</span><span class="op" id="8332638">,</span>&nbsp;<span class="string" id="8332640">&#34;p384&#34;</span><span class="op" id="8332646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332649"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332149">testKeyGeneration</a></span><span class="op" id="8332666">(</span><span class="ident" id="8332667"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332457">t</a></span><span class="op" id="8332668">,</span>&nbsp;<span class="ident" id="8332670"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332678">.</span><span class="ident" id="8332679">P521</span><span class="op" id="8332683">(</span><span class="op" id="8332684">)</span><span class="op" id="8332685">,</span>&nbsp;<span class="string" id="8332687">&#34;p521&#34;</span><span class="op" id="8332693">)</span><br>
<span class="lineno"></span><span class="op" id="8332695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="8332698">func</span>&nbsp;<span class="ident" id="8332703">testSignAndVerify</span><span class="op" id="8332720">(</span><span class="ident" id="8332721">t</span>&nbsp;<span class="op" id="8332723">*</span><span class="ident" id="8332724"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8332731">.</span><span class="ident" id="8332732">T</span><span class="op" id="8332733">,</span>&nbsp;<span class="ident" id="8332735">c</span>&nbsp;<span class="ident" id="8332737"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8332745">.</span><span class="ident" id="8332746">Curve</span><span class="op" id="8332751">,</span>&nbsp;<span class="ident" id="8332753">tag</span>&nbsp;<span class="builtintype" id="8332757">string</span><span class="op" id="8332763">)</span>&nbsp;<span class="op" id="8332765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332768">priv</span><span class="op" id="8332772">,</span>&nbsp;<span class="ident" id="8332774">_</span>&nbsp;<span class="op" id="8332776">:=</span>&nbsp;<span class="ident" id="8332779"><a href="/crypto/ecdsa/ecdsa.go.html#4194355">GenerateKey</a></span><span class="op" id="8332790">(</span><span class="ident" id="8332791"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332735">c</a></span><span class="op" id="8332792">,</span>&nbsp;<span class="ident" id="8332794"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332008">rand</a></span><span class="op" id="8332798">.</span><span class="ident" id="8332799">Reader</span><span class="op" id="8332805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332809">hashed</span>&nbsp;<span class="op" id="8332816">:=</span>&nbsp;<span class="op" id="8332819">[</span><span class="op" id="8332820">]</span><span class="builtintype" id="8332821">byte</span><span class="op" id="8332825">(</span><span class="string" id="8332826">&#34;testing&#34;</span><span class="op" id="8332835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332838">r</span><span class="op" id="8332839">,</span>&nbsp;<span class="ident" id="8332841">s</span><span class="op" id="8332842">,</span>&nbsp;<span class="ident" id="8332844">err</span>&nbsp;<span class="op" id="8332848">:=</span>&nbsp;<span class="ident" id="8332851"><a href="/crypto/ecdsa/ecdsa.go.html#4196033">Sign</a></span><span class="op" id="8332855">(</span><span class="ident" id="8332856"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332008">rand</a></span><span class="op" id="8332860">.</span><span class="ident" id="8332861">Reader</span><span class="op" id="8332867">,</span>&nbsp;<span class="ident" id="8332869"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332768">priv</a></span><span class="op" id="8332873">,</span>&nbsp;<span class="ident" id="8332875"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332809">hashed</a></span><span class="op" id="8332881">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332884">if</span>&nbsp;<span class="ident" id="8332887"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332844">err</a></span>&nbsp;<span class="op" id="8332891">!=</span>&nbsp;<span class="ident" id="8332894">nil</span>&nbsp;<span class="op" id="8332898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8332902"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332721">t</a></span><span class="op" id="8332903">.</span><span class="ident" id="8332904">Errorf</span><span class="op" id="8332910">(</span><span class="string" id="8332911">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8332934">,</span>&nbsp;<span class="ident" id="8332936"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332753">tag</a></span><span class="op" id="8332939">,</span>&nbsp;<span class="ident" id="8332941"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332844">err</a></span><span class="op" id="8332944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332948">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8332956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8332960">if</span>&nbsp;<span class="op" id="8332963">!</span><span class="ident" id="8332964"><a href="/crypto/ecdsa/ecdsa.go.html#4196733">Verify</a></span><span class="op" id="8332970">(</span><span class="op" id="8332971">&amp;</span><span class="ident" id="8332972"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332768">priv</a></span><span class="op" id="8332976">.</span><span class="ident" id="8332977">PublicKey</span><span class="op" id="8332986">,</span>&nbsp;<span class="ident" id="8332988"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332809">hashed</a></span><span class="op" id="8332994">,</span>&nbsp;<span class="ident" id="8332996"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332838">r</a></span><span class="op" id="8332997">,</span>&nbsp;<span class="ident" id="8332999"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332841">s</a></span><span class="op" id="8333000">)</span>&nbsp;<span class="op" id="8333002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333006"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332721">t</a></span><span class="op" id="8333007">.</span><span class="ident" id="8333008">Errorf</span><span class="op" id="8333014">(</span><span class="string" id="8333015">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="8333034">,</span>&nbsp;<span class="ident" id="8333036"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332753">tag</a></span><span class="op" id="8333039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333046"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332809">hashed</a></span><span class="op" id="8333052">[</span><span class="num" id="8333053">0</span><span class="op" id="8333054">]</span>&nbsp;<span class="op" id="8333056">^=</span>&nbsp;<span class="num" id="8333059">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333065">if</span>&nbsp;<span class="ident" id="8333068"><a href="/crypto/ecdsa/ecdsa.go.html#4196733">Verify</a></span><span class="op" id="8333074">(</span><span class="op" id="8333075">&amp;</span><span class="ident" id="8333076"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332768">priv</a></span><span class="op" id="8333080">.</span><span class="ident" id="8333081">PublicKey</span><span class="op" id="8333090">,</span>&nbsp;<span class="ident" id="8333092"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332809">hashed</a></span><span class="op" id="8333098">,</span>&nbsp;<span class="ident" id="8333100"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332838">r</a></span><span class="op" id="8333101">,</span>&nbsp;<span class="ident" id="8333103"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332841">s</a></span><span class="op" id="8333104">)</span>&nbsp;<span class="op" id="8333106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333110"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332721">t</a></span><span class="op" id="8333111">.</span><span class="ident" id="8333112">Errorf</span><span class="op" id="8333118">(</span><span class="string" id="8333119">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="8333145">,</span>&nbsp;<span class="ident" id="8333147"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332753">tag</a></span><span class="op" id="8333150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333153">}</span><br>
<span class="lineno"></span><span class="op" id="8333155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8333158">func</span>&nbsp;<span class="ident" id="8333163">TestSignAndVerify</span><span class="op" id="8333180">(</span><span class="ident" id="8333181">t</span>&nbsp;<span class="op" id="8333183">*</span><span class="ident" id="8333184"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8333191">.</span><span class="ident" id="8333192">T</span><span class="op" id="8333193">)</span>&nbsp;<span class="op" id="8333195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333198"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332703">testSignAndVerify</a></span><span class="op" id="8333215">(</span><span class="ident" id="8333216"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333181">t</a></span><span class="op" id="8333217">,</span>&nbsp;<span class="ident" id="8333219"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8333227">.</span><span class="ident" id="8333228">P224</span><span class="op" id="8333232">(</span><span class="op" id="8333233">)</span><span class="op" id="8333234">,</span>&nbsp;<span class="string" id="8333236">&#34;p224&#34;</span><span class="op" id="8333242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333245">if</span>&nbsp;<span class="ident" id="8333248"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8333255">.</span><span class="ident" id="8333256">Short</span><span class="op" id="8333261">(</span><span class="op" id="8333262">)</span>&nbsp;<span class="op" id="8333264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333268">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333276">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333279"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332703">testSignAndVerify</a></span><span class="op" id="8333296">(</span><span class="ident" id="8333297"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333181">t</a></span><span class="op" id="8333298">,</span>&nbsp;<span class="ident" id="8333300"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8333308">.</span><span class="ident" id="8333309">P256</span><span class="op" id="8333313">(</span><span class="op" id="8333314">)</span><span class="op" id="8333315">,</span>&nbsp;<span class="string" id="8333317">&#34;p256&#34;</span><span class="op" id="8333323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333326"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332703">testSignAndVerify</a></span><span class="op" id="8333343">(</span><span class="ident" id="8333344"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333181">t</a></span><span class="op" id="8333345">,</span>&nbsp;<span class="ident" id="8333347"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8333355">.</span><span class="ident" id="8333356">P384</span><span class="op" id="8333360">(</span><span class="op" id="8333361">)</span><span class="op" id="8333362">,</span>&nbsp;<span class="string" id="8333364">&#34;p384&#34;</span><span class="op" id="8333370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333373"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332703">testSignAndVerify</a></span><span class="op" id="8333390">(</span><span class="ident" id="8333391"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333181">t</a></span><span class="op" id="8333392">,</span>&nbsp;<span class="ident" id="8333394"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8333402">.</span><span class="ident" id="8333403">P521</span><span class="op" id="8333407">(</span><span class="op" id="8333408">)</span><span class="op" id="8333409">,</span>&nbsp;<span class="string" id="8333411">&#34;p521&#34;</span><span class="op" id="8333417">)</span><br>
<span class="lineno"></span><span class="op" id="8333419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="8333422">func</span>&nbsp;<span class="ident" id="8333427">fromHex</span><span class="op" id="8333434">(</span><span class="ident" id="8333435">s</span>&nbsp;<span class="builtintype" id="8333437">string</span><span class="op" id="8333443">)</span>&nbsp;<span class="op" id="8333445">*</span><span class="ident" id="8333446"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332102">big</a></span><span class="op" id="8333449">.</span><span class="ident" id="8333450">Int</span>&nbsp;<span class="op" id="8333454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333457">r</span><span class="op" id="8333458">,</span>&nbsp;<span class="ident" id="8333460">ok</span>&nbsp;<span class="op" id="8333463">:=</span>&nbsp;<span class="builtinfunc" id="8333466">new</span><span class="op" id="8333469">(</span><span class="ident" id="8333470"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332102">big</a></span><span class="op" id="8333473">.</span><span class="ident" id="8333474">Int</span><span class="op" id="8333477">)</span><span class="op" id="8333478">.</span><span class="ident" id="8333479">SetString</span><span class="op" id="8333488">(</span><span class="ident" id="8333489"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333435">s</a></span><span class="op" id="8333490">,</span>&nbsp;<span class="num" id="8333492">16</span><span class="op" id="8333494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333497">if</span>&nbsp;<span class="op" id="8333500">!</span><span class="ident" id="8333501"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333460">ok</a></span>&nbsp;<span class="op" id="8333504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8333508">panic</span><span class="op" id="8333513">(</span><span class="string" id="8333514">&#34;bad&nbsp;hex&#34;</span><span class="op" id="8333523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333526">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333529">return</span>&nbsp;<span class="ident" id="8333536"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333457">r</a></span><br>
<span class="lineno"></span><span class="op" id="8333538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8333541">func</span>&nbsp;<span class="ident" id="8333546">TestVectors</span><span class="op" id="8333557">(</span><span class="ident" id="8333558">t</span>&nbsp;<span class="op" id="8333560">*</span><span class="ident" id="8333561"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8333568">.</span><span class="ident" id="8333569">T</span><span class="op" id="8333570">)</span>&nbsp;<span class="op" id="8333572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333575">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333633">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333714">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333718">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8333785">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333838">if</span>&nbsp;<span class="ident" id="8333841"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332131">testing</a></span><span class="op" id="8333848">.</span><span class="ident" id="8333849">Short</span><span class="op" id="8333854">(</span><span class="op" id="8333855">)</span>&nbsp;<span class="op" id="8333857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333861">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333873">f</span><span class="op" id="8333874">,</span>&nbsp;<span class="ident" id="8333876">err</span>&nbsp;<span class="op" id="8333880">:=</span>&nbsp;<span class="ident" id="8333883"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332114">os</a></span><span class="op" id="8333885">.</span><span class="ident" id="8333886">Open</span><span class="op" id="8333890">(</span><span class="string" id="8333891">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="8333916">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8333919">if</span>&nbsp;<span class="ident" id="8333922"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333876">err</a></span>&nbsp;<span class="op" id="8333926">!=</span>&nbsp;<span class="ident" id="8333929">nil</span>&nbsp;<span class="op" id="8333933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333937"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8333938">.</span><span class="ident" id="8333939">Fatal</span><span class="op" id="8333944">(</span><span class="ident" id="8333945"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333876">err</a></span><span class="op" id="8333948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8333951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8333955">buf</span>&nbsp;<span class="op" id="8333959">:=</span>&nbsp;<span class="ident" id="8333962"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331962">bufio</a></span><span class="op" id="8333967">.</span><span class="ident" id="8333968">NewReader</span><span class="op" id="8333977">(</span><span class="ident" id="8333978"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331971">bzip2</a></span><span class="op" id="8333983">.</span><span class="ident" id="8333984">NewReader</span><span class="op" id="8333993">(</span><span class="ident" id="8333994"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333873">f</a></span><span class="op" id="8333995">)</span><span class="op" id="8333996">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334000">lineNo</span>&nbsp;<span class="op" id="8334007">:=</span>&nbsp;<span class="num" id="8334010">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334013">var</span>&nbsp;<span class="ident" id="8334017">h</span>&nbsp;<span class="ident" id="8334019"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332088">hash</a></span><span class="op" id="8334023">.</span><span class="ident" id="8334024">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334030">var</span>&nbsp;<span class="ident" id="8334034">msg</span>&nbsp;<span class="op" id="8334038">[</span><span class="op" id="8334039">]</span><span class="builtintype" id="8334040">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334046">var</span>&nbsp;<span class="ident" id="8334050">hashed</span>&nbsp;<span class="op" id="8334057">[</span><span class="op" id="8334058">]</span><span class="builtintype" id="8334059">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334065">var</span>&nbsp;<span class="ident" id="8334069">r</span><span class="op" id="8334070">,</span>&nbsp;<span class="ident" id="8334072">s</span>&nbsp;<span class="op" id="8334074">*</span><span class="ident" id="8334075"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332102">big</a></span><span class="op" id="8334078">.</span><span class="ident" id="8334079">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334084">pub</span>&nbsp;<span class="op" id="8334088">:=</span>&nbsp;<span class="builtinfunc" id="8334091">new</span><span class="op" id="8334094">(</span><span class="ident" id="8334095"><a href="/crypto/ecdsa/ecdsa.go.html#4193023">PublicKey</a></span><span class="op" id="8334104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334108">for</span>&nbsp;<span class="op" id="8334112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334116">line</span><span class="op" id="8334120">,</span>&nbsp;<span class="ident" id="8334122">err</span>&nbsp;<span class="op" id="8334126">:=</span>&nbsp;<span class="ident" id="8334129"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333955">buf</a></span><span class="op" id="8334132">.</span><span class="ident" id="8334133">ReadString</span><span class="op" id="8334143">(</span><span class="string" id="8334144">&#39;\n&#39;</span><span class="op" id="8334148">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334152">if</span>&nbsp;<span class="builtinfunc" id="8334155">len</span><span class="op" id="8334158">(</span><span class="ident" id="8334159"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334163">)</span>&nbsp;<span class="op" id="8334165">==</span>&nbsp;<span class="num" id="8334168">0</span>&nbsp;<span class="op" id="8334170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334175">if</span>&nbsp;<span class="ident" id="8334178"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334122">err</a></span>&nbsp;<span class="op" id="8334182">==</span>&nbsp;<span class="ident" id="8334185"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332096">io</a></span><span class="op" id="8334187">.</span><span class="ident" id="8334188">EOF</span>&nbsp;<span class="op" id="8334192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334198">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334212"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8334213">.</span><span class="ident" id="8334214">Fatalf</span><span class="op" id="8334220">(</span><span class="string" id="8334221">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="8334251">,</span>&nbsp;<span class="ident" id="8334253"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334122">err</a></span><span class="op" id="8334256">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334264"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334000">lineNo</a></span><span class="op" id="8334270">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8334275">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334326">if</span>&nbsp;<span class="op" id="8334329">!</span><span class="ident" id="8334330"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8334337">.</span><span class="ident" id="8334338">HasSuffix</span><span class="op" id="8334347">(</span><span class="ident" id="8334348"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334352">,</span>&nbsp;<span class="string" id="8334354">&#34;\r\n&#34;</span><span class="op" id="8334360">)</span>&nbsp;<span class="op" id="8334362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334367"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8334368">.</span><span class="ident" id="8334369">Fatalf</span><span class="op" id="8334375">(</span><span class="string" id="8334376">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8334422">,</span>&nbsp;<span class="ident" id="8334424"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334000">lineNo</a></span><span class="op" id="8334430">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334438"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span>&nbsp;<span class="op" id="8334443">=</span>&nbsp;<span class="ident" id="8334445"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334449">[</span><span class="op" id="8334450">:</span><span class="builtinfunc" id="8334451">len</span><span class="op" id="8334454">(</span><span class="ident" id="8334455"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334459">)</span><span class="op" id="8334460">-</span><span class="num" id="8334461">2</span><span class="op" id="8334462">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334467">if</span>&nbsp;<span class="builtinfunc" id="8334470">len</span><span class="op" id="8334473">(</span><span class="ident" id="8334474"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334478">)</span>&nbsp;<span class="op" id="8334480">==</span>&nbsp;<span class="num" id="8334483">0</span>&nbsp;<span class="op" id="8334485">||</span>&nbsp;<span class="ident" id="8334488"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334492">[</span><span class="num" id="8334493">0</span><span class="op" id="8334494">]</span>&nbsp;<span class="op" id="8334496">==</span>&nbsp;<span class="string" id="8334499">&#39;#&#39;</span>&nbsp;<span class="op" id="8334503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334508">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334524">if</span>&nbsp;<span class="ident" id="8334527"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334531">[</span><span class="num" id="8334532">0</span><span class="op" id="8334533">]</span>&nbsp;<span class="op" id="8334535">==</span>&nbsp;<span class="string" id="8334538">&#39;[&#39;</span>&nbsp;<span class="op" id="8334542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334547"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span>&nbsp;<span class="op" id="8334552">=</span>&nbsp;<span class="ident" id="8334554"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334558">[</span><span class="num" id="8334559">1</span>&nbsp;<span class="op" id="8334561">:</span>&nbsp;<span class="builtinfunc" id="8334563">len</span><span class="op" id="8334566">(</span><span class="ident" id="8334567"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334571">)</span><span class="op" id="8334572">-</span><span class="num" id="8334573">1</span><span class="op" id="8334574">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334579">parts</span>&nbsp;<span class="op" id="8334585">:=</span>&nbsp;<span class="ident" id="8334588"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8334595">.</span><span class="ident" id="8334596">SplitN</span><span class="op" id="8334602">(</span><span class="ident" id="8334603"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8334607">,</span>&nbsp;<span class="string" id="8334609">&#34;,&#34;</span><span class="op" id="8334612">,</span>&nbsp;<span class="num" id="8334614">2</span><span class="op" id="8334615">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334621">switch</span>&nbsp;<span class="ident" id="8334628"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334579">parts</a></span><span class="op" id="8334633">[</span><span class="num" id="8334634">0</span><span class="op" id="8334635">]</span>&nbsp;<span class="op" id="8334637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334642">case</span>&nbsp;<span class="string" id="8334647">&#34;P-224&#34;</span><span class="op" id="8334654">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334660"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8334663">.</span><span class="ident" id="8334664">Curve</span>&nbsp;<span class="op" id="8334670">=</span>&nbsp;<span class="ident" id="8334672"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8334680">.</span><span class="ident" id="8334681">P224</span><span class="op" id="8334685">(</span><span class="op" id="8334686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334691">case</span>&nbsp;<span class="string" id="8334696">&#34;P-256&#34;</span><span class="op" id="8334703">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334709"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8334712">.</span><span class="ident" id="8334713">Curve</span>&nbsp;<span class="op" id="8334719">=</span>&nbsp;<span class="ident" id="8334721"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8334729">.</span><span class="ident" id="8334730">P256</span><span class="op" id="8334734">(</span><span class="op" id="8334735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334740">case</span>&nbsp;<span class="string" id="8334745">&#34;P-384&#34;</span><span class="op" id="8334752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334758"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8334761">.</span><span class="ident" id="8334762">Curve</span>&nbsp;<span class="op" id="8334768">=</span>&nbsp;<span class="ident" id="8334770"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8334778">.</span><span class="ident" id="8334779">P384</span><span class="op" id="8334783">(</span><span class="op" id="8334784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334789">case</span>&nbsp;<span class="string" id="8334794">&#34;P-521&#34;</span><span class="op" id="8334801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334807"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8334810">.</span><span class="ident" id="8334811">Curve</span>&nbsp;<span class="op" id="8334817">=</span>&nbsp;<span class="ident" id="8334819"><a href="/crypto/ecdsa/ecdsa_test.go.html#8331989">elliptic</a></span><span class="op" id="8334827">.</span><span class="ident" id="8334828">P521</span><span class="op" id="8334832">(</span><span class="op" id="8334833">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334838">default</span><span class="op" id="8334845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334851"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8334854">.</span><span class="ident" id="8334855">Curve</span>&nbsp;<span class="op" id="8334861">=</span>&nbsp;<span class="ident" id="8334863">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8334870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334876">switch</span>&nbsp;<span class="ident" id="8334883"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334579">parts</a></span><span class="op" id="8334888">[</span><span class="num" id="8334889">1</span><span class="op" id="8334890">]</span>&nbsp;<span class="op" id="8334892">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334897">case</span>&nbsp;<span class="string" id="8334902">&#34;SHA-1&#34;</span><span class="op" id="8334909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334915"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8334917">=</span>&nbsp;<span class="ident" id="8334919"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332023">sha1</a></span><span class="op" id="8334923">.</span><span class="ident" id="8334924">New</span><span class="op" id="8334927">(</span><span class="op" id="8334928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334933">case</span>&nbsp;<span class="string" id="8334938">&#34;SHA-224&#34;</span><span class="op" id="8334947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334953"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8334955">=</span>&nbsp;<span class="ident" id="8334957"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332038">sha256</a></span><span class="op" id="8334963">.</span><span class="ident" id="8334964">New224</span><span class="op" id="8334970">(</span><span class="op" id="8334971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8334976">case</span>&nbsp;<span class="string" id="8334981">&#34;SHA-256&#34;</span><span class="op" id="8334990">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8334996"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8334998">=</span>&nbsp;<span class="ident" id="8335000"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332038">sha256</a></span><span class="op" id="8335006">.</span><span class="ident" id="8335007">New</span><span class="op" id="8335010">(</span><span class="op" id="8335011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335016">case</span>&nbsp;<span class="string" id="8335021">&#34;SHA-384&#34;</span><span class="op" id="8335030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335036"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8335038">=</span>&nbsp;<span class="ident" id="8335040"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332055">sha512</a></span><span class="op" id="8335046">.</span><span class="ident" id="8335047">New384</span><span class="op" id="8335053">(</span><span class="op" id="8335054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335059">case</span>&nbsp;<span class="string" id="8335064">&#34;SHA-512&#34;</span><span class="op" id="8335073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335079"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8335081">=</span>&nbsp;<span class="ident" id="8335083"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332055">sha512</a></span><span class="op" id="8335089">.</span><span class="ident" id="8335090">New</span><span class="op" id="8335093">(</span><span class="op" id="8335094">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335099">default</span><span class="op" id="8335106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335112"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8335114">=</span>&nbsp;<span class="ident" id="8335116">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335129">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335145">if</span>&nbsp;<span class="ident" id="8335148"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span>&nbsp;<span class="op" id="8335150">==</span>&nbsp;<span class="ident" id="8335153">nil</span>&nbsp;<span class="op" id="8335157">||</span>&nbsp;<span class="ident" id="8335160"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8335163">.</span><span class="ident" id="8335164">Curve</span>&nbsp;<span class="op" id="8335170">==</span>&nbsp;<span class="ident" id="8335173">nil</span>&nbsp;<span class="op" id="8335177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335182">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335193">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335198">switch</span>&nbsp;<span class="op" id="8335205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335209">case</span>&nbsp;<span class="ident" id="8335214"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335221">.</span><span class="ident" id="8335222">HasPrefix</span><span class="op" id="8335231">(</span><span class="ident" id="8335232"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335236">,</span>&nbsp;<span class="string" id="8335238">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="8335246">)</span><span class="op" id="8335247">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335252">if</span>&nbsp;<span class="ident" id="8335255"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334034">msg</a></span><span class="op" id="8335258">,</span>&nbsp;<span class="ident" id="8335260"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334122">err</a></span>&nbsp;<span class="op" id="8335264">=</span>&nbsp;<span class="ident" id="8335266"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332072">hex</a></span><span class="op" id="8335269">.</span><span class="ident" id="8335270">DecodeString</span><span class="op" id="8335282">(</span><span class="ident" id="8335283"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335287">[</span><span class="num" id="8335288">6</span><span class="op" id="8335289">:</span><span class="op" id="8335290">]</span><span class="op" id="8335291">)</span><span class="op" id="8335292">;</span>&nbsp;<span class="ident" id="8335294"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334122">err</a></span>&nbsp;<span class="op" id="8335298">!=</span>&nbsp;<span class="ident" id="8335301">nil</span>&nbsp;<span class="op" id="8335305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335311"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8335312">.</span><span class="ident" id="8335313">Fatalf</span><span class="op" id="8335319">(</span><span class="string" id="8335320">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8335361">,</span>&nbsp;<span class="ident" id="8335363"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334000">lineNo</a></span><span class="op" id="8335369">,</span>&nbsp;<span class="ident" id="8335371"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334122">err</a></span><span class="op" id="8335374">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335383">case</span>&nbsp;<span class="ident" id="8335388"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335395">.</span><span class="ident" id="8335396">HasPrefix</span><span class="op" id="8335405">(</span><span class="ident" id="8335406"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335410">,</span>&nbsp;<span class="string" id="8335412">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="8335419">)</span><span class="op" id="8335420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335425"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8335428">.</span><span class="ident" id="8335429">X</span>&nbsp;<span class="op" id="8335431">=</span>&nbsp;<span class="ident" id="8335433"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333427">fromHex</a></span><span class="op" id="8335440">(</span><span class="ident" id="8335441"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335445">[</span><span class="num" id="8335446">5</span><span class="op" id="8335447">:</span><span class="op" id="8335448">]</span><span class="op" id="8335449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335453">case</span>&nbsp;<span class="ident" id="8335458"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335465">.</span><span class="ident" id="8335466">HasPrefix</span><span class="op" id="8335475">(</span><span class="ident" id="8335476"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335480">,</span>&nbsp;<span class="string" id="8335482">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="8335489">)</span><span class="op" id="8335490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335495"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8335498">.</span><span class="ident" id="8335499">Y</span>&nbsp;<span class="op" id="8335501">=</span>&nbsp;<span class="ident" id="8335503"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333427">fromHex</a></span><span class="op" id="8335510">(</span><span class="ident" id="8335511"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335515">[</span><span class="num" id="8335516">5</span><span class="op" id="8335517">:</span><span class="op" id="8335518">]</span><span class="op" id="8335519">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335523">case</span>&nbsp;<span class="ident" id="8335528"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335535">.</span><span class="ident" id="8335536">HasPrefix</span><span class="op" id="8335545">(</span><span class="ident" id="8335546"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335550">,</span>&nbsp;<span class="string" id="8335552">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="8335558">)</span><span class="op" id="8335559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335564"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334069">r</a></span>&nbsp;<span class="op" id="8335566">=</span>&nbsp;<span class="ident" id="8335568"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333427">fromHex</a></span><span class="op" id="8335575">(</span><span class="ident" id="8335576"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335580">[</span><span class="num" id="8335581">4</span><span class="op" id="8335582">:</span><span class="op" id="8335583">]</span><span class="op" id="8335584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335588">case</span>&nbsp;<span class="ident" id="8335593"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335600">.</span><span class="ident" id="8335601">HasPrefix</span><span class="op" id="8335610">(</span><span class="ident" id="8335611"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335615">,</span>&nbsp;<span class="string" id="8335617">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="8335623">)</span><span class="op" id="8335624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335629"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334072">s</a></span>&nbsp;<span class="op" id="8335631">=</span>&nbsp;<span class="ident" id="8335633"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333427">fromHex</a></span><span class="op" id="8335640">(</span><span class="ident" id="8335641"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335645">[</span><span class="num" id="8335646">4</span><span class="op" id="8335647">:</span><span class="op" id="8335648">]</span><span class="op" id="8335649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335653">case</span>&nbsp;<span class="ident" id="8335658"><a href="/crypto/ecdsa/ecdsa_test.go.html#8332120">strings</a></span><span class="op" id="8335665">.</span><span class="ident" id="8335666">HasPrefix</span><span class="op" id="8335675">(</span><span class="ident" id="8335676"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335680">,</span>&nbsp;<span class="string" id="8335682">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="8335693">)</span><span class="op" id="8335694">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335699">expected</span>&nbsp;<span class="op" id="8335708">:=</span>&nbsp;<span class="ident" id="8335711"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335715">[</span><span class="num" id="8335716">9</span><span class="op" id="8335717">]</span>&nbsp;<span class="op" id="8335719">==</span>&nbsp;<span class="string" id="8335722">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335729"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span><span class="op" id="8335730">.</span><span class="ident" id="8335731">Reset</span><span class="op" id="8335736">(</span><span class="op" id="8335737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335742"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span><span class="op" id="8335743">.</span><span class="ident" id="8335744">Write</span><span class="op" id="8335749">(</span><span class="ident" id="8335750"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334034">msg</a></span><span class="op" id="8335753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335758">hashed</span>&nbsp;<span class="op" id="8335765">:=</span>&nbsp;<span class="ident" id="8335768"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334017">h</a></span><span class="op" id="8335769">.</span><span class="ident" id="8335770">Sum</span><span class="op" id="8335773">(</span><span class="ident" id="8335774"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334050">hashed</a></span><span class="op" id="8335780">[</span><span class="op" id="8335781">:</span><span class="num" id="8335782">0</span><span class="op" id="8335783">]</span><span class="op" id="8335784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335789">if</span>&nbsp;<span class="ident" id="8335792"><a href="/crypto/ecdsa/ecdsa.go.html#4196733">Verify</a></span><span class="op" id="8335798">(</span><span class="ident" id="8335799"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334084">pub</a></span><span class="op" id="8335802">,</span>&nbsp;<span class="ident" id="8335804"><a href="/crypto/ecdsa/ecdsa_test.go.html#8335758">hashed</a></span><span class="op" id="8335810">,</span>&nbsp;<span class="ident" id="8335812"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334069">r</a></span><span class="op" id="8335813">,</span>&nbsp;<span class="ident" id="8335815"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334072">s</a></span><span class="op" id="8335816">)</span>&nbsp;<span class="op" id="8335818">!=</span>&nbsp;<span class="ident" id="8335821"><a href="/crypto/ecdsa/ecdsa_test.go.html#8335699">expected</a></span>&nbsp;<span class="op" id="8335830">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335836"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8335837">.</span><span class="ident" id="8335838">Fatalf</span><span class="op" id="8335844">(</span><span class="string" id="8335845">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="8335874">,</span>&nbsp;<span class="ident" id="8335876"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334000">lineNo</a></span><span class="op" id="8335882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8335891">default</span><span class="op" id="8335898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8335903"><a href="/crypto/ecdsa/ecdsa_test.go.html#8333558">t</a></span><span class="op" id="8335904">.</span><span class="ident" id="8335905">Fatalf</span><span class="op" id="8335911">(</span><span class="string" id="8335912">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="8335945">,</span>&nbsp;<span class="ident" id="8335947"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334000">lineNo</a></span><span class="op" id="8335953">,</span>&nbsp;<span class="ident" id="8335955"><a href="/crypto/ecdsa/ecdsa_test.go.html#8334116">line</a></span><span class="op" id="8335959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335963">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8335966">}</span><br>
<span class="lineno"></span><span class="op" id="8335968">}</span>
</div>
</body>
</html>
