<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html" class="current">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7513185">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7513240">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7513294">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7513345">package</span>&nbsp;<span class="ident" id="7513353">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7513359">import</span>&nbsp;<span class="op" id="7513366">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513369">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513380">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7513386">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7513396">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7513399">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="7513415">//&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7513434">var</span>&nbsp;<span class="ident" id="7513438">UseProxyTests</span>&nbsp;<span class="op" id="7513452">=</span>&nbsp;<span class="op" id="7513454">[</span><span class="op" id="7513455">]</span><span class="keyword" id="7513456">struct</span>&nbsp;<span class="op" id="7513463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513466">host</span>&nbsp;&nbsp;<span class="builtintype" id="7513472">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7513480">match</span>&nbsp;<span class="builtintype" id="7513486">bool</span><br>
<span class="lineno"></span><span class="op" id="7513491">}</span><span class="op" id="7513492">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7513495">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513522">{</span><span class="string" id="7513523">&#34;localhost:80&#34;</span><span class="op" id="7513537">,</span>&nbsp;<span class="builtintype" id="7513539">false</span><span class="op" id="7513544">}</span><span class="op" id="7513545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513548">{</span><span class="string" id="7513549">&#34;127.0.0.1&#34;</span><span class="op" id="7513560">,</span>&nbsp;<span class="builtintype" id="7513562">false</span><span class="op" id="7513567">}</span><span class="op" id="7513568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513571">{</span><span class="string" id="7513572">&#34;127.0.0.2&#34;</span><span class="op" id="7513583">,</span>&nbsp;<span class="builtintype" id="7513585">false</span><span class="op" id="7513590">}</span><span class="op" id="7513591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513594">{</span><span class="string" id="7513595">&#34;[::1]&#34;</span><span class="op" id="7513602">,</span>&nbsp;<span class="builtintype" id="7513604">false</span><span class="op" id="7513609">}</span><span class="op" id="7513610">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513613">{</span><span class="string" id="7513614">&#34;[::2]&#34;</span><span class="op" id="7513621">,</span>&nbsp;<span class="builtintype" id="7513623">true</span><span class="op" id="7513627">}</span><span class="op" id="7513628">,</span>&nbsp;<span class="comment" id="7513630">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513658">{</span><span class="string" id="7513659">&#34;barbaz.net&#34;</span><span class="op" id="7513671">,</span>&nbsp;<span class="builtintype" id="7513673">false</span><span class="op" id="7513678">}</span><span class="op" id="7513679">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7513685">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513710">{</span><span class="string" id="7513711">&#34;foobar.com&#34;</span><span class="op" id="7513723">,</span>&nbsp;<span class="builtintype" id="7513725">false</span><span class="op" id="7513730">}</span><span class="op" id="7513731">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7513737">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513763">{</span><span class="string" id="7513764">&#34;foofoobar.com&#34;</span><span class="op" id="7513779">,</span>&nbsp;<span class="builtintype" id="7513781">true</span><span class="op" id="7513785">}</span><span class="op" id="7513786">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7513790">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513828">{</span><span class="string" id="7513829">&#34;baz.com&#34;</span><span class="op" id="7513838">,</span>&nbsp;<span class="builtintype" id="7513840">true</span><span class="op" id="7513844">}</span><span class="op" id="7513845">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7513855">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513893">{</span><span class="string" id="7513894">&#34;localhost.net&#34;</span><span class="op" id="7513909">,</span>&nbsp;<span class="builtintype" id="7513911">true</span><span class="op" id="7513915">}</span><span class="op" id="7513916">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7513920">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7513955">{</span><span class="string" id="7513956">&#34;local.localhost&#34;</span><span class="op" id="7513973">,</span>&nbsp;<span class="builtintype" id="7513975">true</span><span class="op" id="7513979">}</span><span class="op" id="7513980">,</span>&nbsp;<span class="comment" id="7513982">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514017">{</span><span class="string" id="7514018">&#34;barbarbaz.net&#34;</span><span class="op" id="7514033">,</span>&nbsp;<span class="builtintype" id="7514035">true</span><span class="op" id="7514039">}</span><span class="op" id="7514040">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7514044">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514086">{</span><span class="string" id="7514087">&#34;www.foobar.com&#34;</span><span class="op" id="7514103">,</span>&nbsp;<span class="builtintype" id="7514105">false</span><span class="op" id="7514110">}</span><span class="op" id="7514111">,</span>&nbsp;<span class="comment" id="7514113">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="7514161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7514164">func</span>&nbsp;<span class="ident" id="7514169">TestUseProxy</span><span class="op" id="7514181">(</span><span class="ident" id="7514182">t</span>&nbsp;<span class="op" id="7514184">*</span><span class="ident" id="7514185"><a href="/gostd/net/http/proxy_test.go.html#7513386">testing</a></span><span class="op" id="7514192">.</span><span class="ident" id="7514193"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7514194">)</span>&nbsp;<span class="op" id="7514196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514199"><a href="/gostd/net/http/proxy_test.go.html#7515173">ResetProxyEnv</a></span><span class="op" id="7514212">(</span><span class="op" id="7514213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514216"><a href="/gostd/net/http/proxy_test.go.html#7513380">os</a></span><span class="op" id="7514218">.</span><span class="ident" id="7514219"><a href="/gostd/os/env.go.html#2429893">Setenv</a></span><span class="op" id="7514225">(</span><span class="string" id="7514226">&#34;NO_PROXY&#34;</span><span class="op" id="7514236">,</span>&nbsp;<span class="string" id="7514238">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="7514263">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514266">for</span>&nbsp;<span class="ident" id="7514270">_</span><span class="op" id="7514271">,</span>&nbsp;<span class="ident" id="7514273">test</span>&nbsp;<span class="op" id="7514278">:=</span>&nbsp;<span class="keyword" id="7514281">range</span>&nbsp;<span class="ident" id="7514287"><a href="/gostd/net/http/proxy_test.go.html#7513438">UseProxyTests</a></span>&nbsp;<span class="op" id="7514301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514305">if</span>&nbsp;<span class="ident" id="7514308"><a href="/gostd/net/http/transport.go.html#4277528">useProxy</a></span><span class="op" id="7514316">(</span><span class="ident" id="7514317"><a href="/gostd/net/http/proxy_test.go.html#7514273">test</a></span><span class="op" id="7514321">.</span><span class="ident" id="7514322"><a href="/gostd/net/http/proxy_test.go.html#7513466">host</a></span><span class="op" id="7514326">+</span><span class="string" id="7514327">&#34;:80&#34;</span><span class="op" id="7514332">)</span>&nbsp;<span class="op" id="7514334">!=</span>&nbsp;<span class="ident" id="7514337"><a href="/gostd/net/http/proxy_test.go.html#7514273">test</a></span><span class="op" id="7514341">.</span><span class="ident" id="7514342"><a href="/gostd/net/http/proxy_test.go.html#7513480">match</a></span>&nbsp;<span class="op" id="7514348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514353"><a href="/gostd/net/http/proxy_test.go.html#7514182">t</a></span><span class="op" id="7514354">.</span><span class="ident" id="7514355"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7514361">(</span><span class="string" id="7514362">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7514390">,</span>&nbsp;<span class="ident" id="7514392"><a href="/gostd/net/http/proxy_test.go.html#7514273">test</a></span><span class="op" id="7514396">.</span><span class="ident" id="7514397"><a href="/gostd/net/http/proxy_test.go.html#7513466">host</a></span><span class="op" id="7514401">,</span>&nbsp;<span class="op" id="7514403">!</span><span class="ident" id="7514404"><a href="/gostd/net/http/proxy_test.go.html#7514273">test</a></span><span class="op" id="7514408">.</span><span class="ident" id="7514409"><a href="/gostd/net/http/proxy_test.go.html#7513480">match</a></span><span class="op" id="7514414">,</span>&nbsp;<span class="ident" id="7514416"><a href="/gostd/net/http/proxy_test.go.html#7514273">test</a></span><span class="op" id="7514420">.</span><span class="ident" id="7514421"><a href="/gostd/net/http/proxy_test.go.html#7513480">match</a></span><span class="op" id="7514426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514433">}</span><br>
<span class="lineno">45</span><span class="op" id="7514435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7514438">var</span>&nbsp;<span class="ident" id="7514442">cacheKeysTests</span>&nbsp;<span class="op" id="7514457">=</span>&nbsp;<span class="op" id="7514459">[</span><span class="op" id="7514460">]</span><span class="keyword" id="7514461">struct</span>&nbsp;<span class="op" id="7514468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514471">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="7514478">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514486">scheme</span>&nbsp;<span class="builtintype" id="7514493">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514501">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7514508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514516">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7514523">string</span><br>
<span class="lineno"></span><span class="op" id="7514530">}</span><span class="op" id="7514531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514534">{</span><span class="string" id="7514535">&#34;&#34;</span><span class="op" id="7514537">,</span>&nbsp;<span class="string" id="7514539">&#34;http&#34;</span><span class="op" id="7514545">,</span>&nbsp;<span class="string" id="7514547">&#34;foo.com&#34;</span><span class="op" id="7514556">,</span>&nbsp;<span class="string" id="7514558">&#34;|http|foo.com&#34;</span><span class="op" id="7514573">}</span><span class="op" id="7514574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514577">{</span><span class="string" id="7514578">&#34;&#34;</span><span class="op" id="7514580">,</span>&nbsp;<span class="string" id="7514582">&#34;https&#34;</span><span class="op" id="7514589">,</span>&nbsp;<span class="string" id="7514591">&#34;foo.com&#34;</span><span class="op" id="7514600">,</span>&nbsp;<span class="string" id="7514602">&#34;|https|foo.com&#34;</span><span class="op" id="7514618">}</span><span class="op" id="7514619">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514622">{</span><span class="string" id="7514623">&#34;http://foo.com&#34;</span><span class="op" id="7514639">,</span>&nbsp;<span class="string" id="7514641">&#34;http&#34;</span><span class="op" id="7514647">,</span>&nbsp;<span class="string" id="7514649">&#34;foo.com&#34;</span><span class="op" id="7514658">,</span>&nbsp;<span class="string" id="7514660">&#34;http://foo.com|http|&#34;</span><span class="op" id="7514682">}</span><span class="op" id="7514683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514686">{</span><span class="string" id="7514687">&#34;http://foo.com&#34;</span><span class="op" id="7514703">,</span>&nbsp;<span class="string" id="7514705">&#34;https&#34;</span><span class="op" id="7514712">,</span>&nbsp;<span class="string" id="7514714">&#34;foo.com&#34;</span><span class="op" id="7514723">,</span>&nbsp;<span class="string" id="7514725">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="7514755">}</span><span class="op" id="7514756">,</span><br>
<span class="lineno"></span><span class="op" id="7514758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7514761">func</span>&nbsp;<span class="ident" id="7514766">TestCacheKeys</span><span class="op" id="7514779">(</span><span class="ident" id="7514780">t</span>&nbsp;<span class="op" id="7514782">*</span><span class="ident" id="7514783"><a href="/gostd/net/http/proxy_test.go.html#7513386">testing</a></span><span class="op" id="7514790">.</span><span class="ident" id="7514791"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7514792">)</span>&nbsp;<span class="op" id="7514794">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514797">for</span>&nbsp;<span class="ident" id="7514801">_</span><span class="op" id="7514802">,</span>&nbsp;<span class="ident" id="7514804">tt</span>&nbsp;<span class="op" id="7514807">:=</span>&nbsp;<span class="keyword" id="7514810">range</span>&nbsp;<span class="ident" id="7514816"><a href="/gostd/net/http/proxy_test.go.html#7514442">cacheKeysTests</a></span>&nbsp;<span class="op" id="7514831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514835">var</span>&nbsp;<span class="ident" id="7514839">proxy</span>&nbsp;<span class="op" id="7514845">*</span><span class="ident" id="7514846"><a href="/gostd/net/http/proxy_test.go.html#7513369">url</a></span><span class="op" id="7514849">.</span><span class="ident" id="7514850"><a href="/gostd/net/url/url.go.html#3751194">URL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514856">if</span>&nbsp;<span class="ident" id="7514859"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7514861">.</span><span class="ident" id="7514862"><a href="/gostd/net/http/proxy_test.go.html#7514471">proxy</a></span>&nbsp;<span class="op" id="7514868">!=</span>&nbsp;<span class="string" id="7514871">&#34;&#34;</span>&nbsp;<span class="op" id="7514874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514879">u</span><span class="op" id="7514880">,</span>&nbsp;<span class="ident" id="7514882">err</span>&nbsp;<span class="op" id="7514886">:=</span>&nbsp;<span class="ident" id="7514889"><a href="/gostd/net/http/proxy_test.go.html#7513369">url</a></span><span class="op" id="7514892">.</span><span class="ident" id="7514893"><a href="/gostd/net/url/url.go.html#3754169">Parse</a></span><span class="op" id="7514898">(</span><span class="ident" id="7514899"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7514901">.</span><span class="ident" id="7514902"><a href="/gostd/net/http/proxy_test.go.html#7514471">proxy</a></span><span class="op" id="7514907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7514912">if</span>&nbsp;<span class="ident" id="7514915"><a href="/gostd/net/http/proxy_test.go.html#7514882">err</a></span>&nbsp;<span class="op" id="7514919">!=</span>&nbsp;<span class="builtintype" id="7514922">nil</span>&nbsp;<span class="op" id="7514926">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514932"><a href="/gostd/net/http/proxy_test.go.html#7514780">t</a></span><span class="op" id="7514933">.</span><span class="ident" id="7514934"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7514939">(</span><span class="ident" id="7514940"><a href="/gostd/net/http/proxy_test.go.html#7514882">err</a></span><span class="op" id="7514943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514953"><a href="/gostd/net/http/proxy_test.go.html#7514839">proxy</a></span>&nbsp;<span class="op" id="7514959">=</span>&nbsp;<span class="ident" id="7514961"><a href="/gostd/net/http/proxy_test.go.html#7514879">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7514965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7514969">cm</span>&nbsp;<span class="op" id="7514972">:=</span>&nbsp;<span class="ident" id="7514975"><a href="/gostd/net/http/transport.go.html#4279173">connectMethod</a></span><span class="op" id="7514988">{</span><span class="ident" id="7514989"><a href="/gostd/net/http/proxy_test.go.html#7514839">proxy</a></span><span class="op" id="7514994">,</span>&nbsp;<span class="ident" id="7514996"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7514998">.</span><span class="ident" id="7514999"><a href="/gostd/net/http/proxy_test.go.html#7514486">scheme</a></span><span class="op" id="7515005">,</span>&nbsp;<span class="ident" id="7515007"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515009">.</span><span class="ident" id="7515010"><a href="/gostd/net/http/proxy_test.go.html#7514501">addr</a></span><span class="op" id="7515014">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515018">if</span>&nbsp;<span class="ident" id="7515021">got</span>&nbsp;<span class="op" id="7515025">:=</span>&nbsp;<span class="ident" id="7515028"><a href="/gostd/net/http/proxy_test.go.html#7514969">cm</a></span><span class="op" id="7515030">.</span><span class="ident" id="7515031"><a href="/gostd/net/http/transport.go.html#4279419">key</a></span><span class="op" id="7515034">(</span><span class="op" id="7515035">)</span><span class="op" id="7515036">.</span><span class="ident" id="7515037"><a href="/gostd/net/http/transport.go.html#4280364">String</a></span><span class="op" id="7515043">(</span><span class="op" id="7515044">)</span><span class="op" id="7515045">;</span>&nbsp;<span class="ident" id="7515047"><a href="/gostd/net/http/proxy_test.go.html#7515021">got</a></span>&nbsp;<span class="op" id="7515051">!=</span>&nbsp;<span class="ident" id="7515054"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515056">.</span><span class="ident" id="7515057"><a href="/gostd/net/http/proxy_test.go.html#7514516">key</a></span>&nbsp;<span class="op" id="7515061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515066"><a href="/gostd/net/http/proxy_test.go.html#7514780">t</a></span><span class="op" id="7515067">.</span><span class="ident" id="7515068"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7515074">(</span><span class="string" id="7515075">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7515113">,</span>&nbsp;<span class="ident" id="7515115"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515117">.</span><span class="ident" id="7515118"><a href="/gostd/net/http/proxy_test.go.html#7514471">proxy</a></span><span class="op" id="7515123">,</span>&nbsp;<span class="ident" id="7515125"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515127">.</span><span class="ident" id="7515128"><a href="/gostd/net/http/proxy_test.go.html#7514486">scheme</a></span><span class="op" id="7515134">,</span>&nbsp;<span class="ident" id="7515136"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515138">.</span><span class="ident" id="7515139"><a href="/gostd/net/http/proxy_test.go.html#7514501">addr</a></span><span class="op" id="7515143">,</span>&nbsp;<span class="ident" id="7515145"><a href="/gostd/net/http/proxy_test.go.html#7515021">got</a></span><span class="op" id="7515148">,</span>&nbsp;<span class="ident" id="7515150"><a href="/gostd/net/http/proxy_test.go.html#7514804">tt</a></span><span class="op" id="7515152">.</span><span class="ident" id="7515153"><a href="/gostd/net/http/proxy_test.go.html#7514516">key</a></span><span class="op" id="7515156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515163">}</span><br>
<span class="lineno"></span><span class="op" id="7515165">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7515168">func</span>&nbsp;<span class="ident" id="7515173">ResetProxyEnv</span><span class="op" id="7515186">(</span><span class="op" id="7515187">)</span>&nbsp;<span class="op" id="7515189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7515192">for</span>&nbsp;<span class="ident" id="7515196">_</span><span class="op" id="7515197">,</span>&nbsp;<span class="ident" id="7515199">v</span>&nbsp;<span class="op" id="7515201">:=</span>&nbsp;<span class="keyword" id="7515204">range</span>&nbsp;<span class="op" id="7515210">[</span><span class="op" id="7515211">]</span><span class="builtintype" id="7515212">string</span><span class="op" id="7515218">{</span><span class="string" id="7515219">&#34;HTTP_PROXY&#34;</span><span class="op" id="7515231">,</span>&nbsp;<span class="string" id="7515233">&#34;http_proxy&#34;</span><span class="op" id="7515245">,</span>&nbsp;<span class="string" id="7515247">&#34;NO_PROXY&#34;</span><span class="op" id="7515257">,</span>&nbsp;<span class="string" id="7515259">&#34;no_proxy&#34;</span><span class="op" id="7515269">}</span>&nbsp;<span class="op" id="7515271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515275"><a href="/gostd/net/http/proxy_test.go.html#7513380">os</a></span><span class="op" id="7515277">.</span><span class="ident" id="7515278"><a href="/gostd/os/env.go.html#2429893">Setenv</a></span><span class="op" id="7515284">(</span><span class="ident" id="7515285"><a href="/gostd/net/http/proxy_test.go.html#7515199">v</a></span><span class="op" id="7515286">,</span>&nbsp;<span class="string" id="7515288">&#34;&#34;</span><span class="op" id="7515290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7515293">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7515296"><a href="/gostd/net/http/export_test.go.html#7505471">ResetCachedEnvironment</a></span><span class="op" id="7515318">(</span><span class="op" id="7515319">)</span><br>
<span class="lineno"></span><span class="op" id="7515321">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
