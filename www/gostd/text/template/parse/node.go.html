<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5527499">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5527554">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5527608">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5527659">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5527676">package</span>&nbsp;<span class="ident" id="5527684">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5527691">import</span>&nbsp;<span class="op" id="5527698">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5527701">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5527710">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5527717">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5527728">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5527738">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5527741">var</span>&nbsp;<span class="ident" id="5527745">textFormat</span>&nbsp;<span class="op" id="5527756">=</span>&nbsp;<span class="string" id="5527758">&#34;%s&#34;</span>&nbsp;<span class="comment" id="5527763">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5527819">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="5527888">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="5527948">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="5527995">type</span>&nbsp;<span class="ident" id="5528000">Node</span>&nbsp;<span class="keyword" id="5528005">interface</span>&nbsp;<span class="op" id="5528015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528018">Type</span><span class="op" id="5528022">(</span><span class="op" id="5528023">)</span>&nbsp;<span class="ident" id="5528025">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528035">String</span><span class="op" id="5528041">(</span><span class="op" id="5528042">)</span>&nbsp;<span class="builtintype" id="5528044">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5528052">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5528114">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5528180">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528222">Copy</span><span class="op" id="5528226">(</span><span class="op" id="5528227">)</span>&nbsp;<span class="ident" id="5528229">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528235">Position</span><span class="op" id="5528243">(</span><span class="op" id="5528244">)</span>&nbsp;<span class="ident" id="5528246">Pos</span>&nbsp;<span class="comment" id="5528250">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5528315">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5528354">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528427">tree</span><span class="op" id="5528431">(</span><span class="op" id="5528432">)</span>&nbsp;<span class="op" id="5528434">*</span><span class="ident" id="5528435">Tree</span><br>
<span class="lineno"></span><span class="op" id="5528440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5528443">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="5528497">type</span>&nbsp;<span class="ident" id="5528502">NodeType</span>&nbsp;<span class="builtintype" id="5528511">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5528516">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="5528588">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="5528617">type</span>&nbsp;<span class="ident" id="5528622">Pos</span>&nbsp;<span class="builtintype" id="5528626">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5528631">func</span>&nbsp;<span class="op" id="5528636">(</span><span class="ident" id="5528637">p</span>&nbsp;<span class="ident" id="5528639">Pos</span><span class="op" id="5528642">)</span>&nbsp;<span class="ident" id="5528644">Position</span><span class="op" id="5528652">(</span><span class="op" id="5528653">)</span>&nbsp;<span class="ident" id="5528655">Pos</span>&nbsp;<span class="op" id="5528659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528662">return</span>&nbsp;<span class="ident" id="5528669">p</span><br>
<span class="lineno"></span><span class="op" id="5528671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5528674">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="5528741">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5528804">func</span>&nbsp;<span class="op" id="5528809">(</span><span class="ident" id="5528810">t</span>&nbsp;<span class="ident" id="5528812">NodeType</span><span class="op" id="5528820">)</span>&nbsp;<span class="ident" id="5528822">Type</span><span class="op" id="5528826">(</span><span class="op" id="5528827">)</span>&nbsp;<span class="ident" id="5528829">NodeType</span>&nbsp;<span class="op" id="5528838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5528841">return</span>&nbsp;<span class="ident" id="5528848">t</span><br>
<span class="lineno"></span><span class="op" id="5528850">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5528853">const</span>&nbsp;<span class="op" id="5528859">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528862">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5528877">NodeType</span>&nbsp;<span class="op" id="5528886">=</span>&nbsp;<span class="ident" id="5528888">iota</span>&nbsp;<span class="comment" id="5528893">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528909">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5528940">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5528993">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529024">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529048">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529079">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529113">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529144">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529174">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529205">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529226">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529257">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529296">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529327">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529365">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529396">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529424">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529455">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529498">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529529">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529547">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529578">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529599">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529630">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529659">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529690">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529716">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529747">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529775">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529806">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529826">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529857">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529880">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529911">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529945">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5529976">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5529994">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5530025">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="5530043">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530046">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5530057">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5530096">type</span>&nbsp;<span class="ident" id="5530101">ListNode</span>&nbsp;<span class="keyword" id="5530110">struct</span>&nbsp;<span class="op" id="5530117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530120">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530130">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530135">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5530141">*</span><span class="ident" id="5530142">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530148">Nodes</span>&nbsp;<span class="op" id="5530154">[</span><span class="op" id="5530155">]</span><span class="ident" id="5530156">Node</span>&nbsp;<span class="comment" id="5530161">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5530200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5530203">func</span>&nbsp;<span class="op" id="5530208">(</span><span class="ident" id="5530209">t</span>&nbsp;<span class="op" id="5530211">*</span><span class="ident" id="5530212">Tree</span><span class="op" id="5530216">)</span>&nbsp;<span class="ident" id="5530218">newList</span><span class="op" id="5530225">(</span><span class="ident" id="5530226">pos</span>&nbsp;<span class="ident" id="5530230">Pos</span><span class="op" id="5530233">)</span>&nbsp;<span class="op" id="5530235">*</span><span class="ident" id="5530236">ListNode</span>&nbsp;<span class="op" id="5530245">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530248">return</span>&nbsp;<span class="op" id="5530255">&amp;</span><span class="ident" id="5530256">ListNode</span><span class="op" id="5530264">{</span><span class="ident" id="5530265">tr</span><span class="op" id="5530267">:</span>&nbsp;<span class="ident" id="5530269">t</span><span class="op" id="5530270">,</span>&nbsp;<span class="ident" id="5530272">NodeType</span><span class="op" id="5530280">:</span>&nbsp;<span class="ident" id="5530282">NodeList</span><span class="op" id="5530290">,</span>&nbsp;<span class="ident" id="5530292">Pos</span><span class="op" id="5530295">:</span>&nbsp;<span class="ident" id="5530297">pos</span><span class="op" id="5530300">}</span><br>
<span class="lineno"></span><span class="op" id="5530302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5530305">func</span>&nbsp;<span class="op" id="5530310">(</span><span class="ident" id="5530311">l</span>&nbsp;<span class="op" id="5530313">*</span><span class="ident" id="5530314">ListNode</span><span class="op" id="5530322">)</span>&nbsp;<span class="builtinfunc" id="5530324">append</span><span class="op" id="5530330">(</span><span class="ident" id="5530331">n</span>&nbsp;<span class="ident" id="5530333">Node</span><span class="op" id="5530337">)</span>&nbsp;<span class="op" id="5530339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530342">l</span><span class="op" id="5530343">.</span><span class="ident" id="5530344">Nodes</span>&nbsp;<span class="op" id="5530350">=</span>&nbsp;<span class="builtinfunc" id="5530352">append</span><span class="op" id="5530358">(</span><span class="ident" id="5530359">l</span><span class="op" id="5530360">.</span><span class="ident" id="5530361">Nodes</span><span class="op" id="5530366">,</span>&nbsp;<span class="ident" id="5530368">n</span><span class="op" id="5530369">)</span><br>
<span class="lineno">90</span><span class="op" id="5530371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5530374">func</span>&nbsp;<span class="op" id="5530379">(</span><span class="ident" id="5530380">l</span>&nbsp;<span class="op" id="5530382">*</span><span class="ident" id="5530383">ListNode</span><span class="op" id="5530391">)</span>&nbsp;<span class="ident" id="5530393">tree</span><span class="op" id="5530397">(</span><span class="op" id="5530398">)</span>&nbsp;<span class="op" id="5530400">*</span><span class="ident" id="5530401">Tree</span>&nbsp;<span class="op" id="5530406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530409">return</span>&nbsp;<span class="ident" id="5530416">l</span><span class="op" id="5530417">.</span><span class="ident" id="5530418">tr</span><br>
<span class="lineno"></span><span class="op" id="5530421">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="5530424">func</span>&nbsp;<span class="op" id="5530429">(</span><span class="ident" id="5530430">l</span>&nbsp;<span class="op" id="5530432">*</span><span class="ident" id="5530433">ListNode</span><span class="op" id="5530441">)</span>&nbsp;<span class="ident" id="5530443">String</span><span class="op" id="5530449">(</span><span class="op" id="5530450">)</span>&nbsp;<span class="builtintype" id="5530452">string</span>&nbsp;<span class="op" id="5530459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530462">b</span>&nbsp;<span class="op" id="5530464">:=</span>&nbsp;<span class="builtinfunc" id="5530467">new</span><span class="op" id="5530470">(</span><span class="ident" id="5530471">bytes</span><span class="op" id="5530476">.</span><span class="ident" id="5530477">Buffer</span><span class="op" id="5530483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530486">for</span>&nbsp;<span class="ident" id="5530490">_</span><span class="op" id="5530491">,</span>&nbsp;<span class="ident" id="5530493">n</span>&nbsp;<span class="op" id="5530495">:=</span>&nbsp;<span class="keyword" id="5530498">range</span>&nbsp;<span class="ident" id="5530504">l</span><span class="op" id="5530505">.</span><span class="ident" id="5530506">Nodes</span>&nbsp;<span class="op" id="5530512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530516">fmt</span><span class="op" id="5530519">.</span><span class="ident" id="5530520">Fprint</span><span class="op" id="5530526">(</span><span class="ident" id="5530527">b</span><span class="op" id="5530528">,</span>&nbsp;<span class="ident" id="5530530">n</span><span class="op" id="5530531">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530537">return</span>&nbsp;<span class="ident" id="5530544">b</span><span class="op" id="5530545">.</span><span class="ident" id="5530546">String</span><span class="op" id="5530552">(</span><span class="op" id="5530553">)</span><br>
<span class="lineno"></span><span class="op" id="5530555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5530558">func</span>&nbsp;<span class="op" id="5530563">(</span><span class="ident" id="5530564">l</span>&nbsp;<span class="op" id="5530566">*</span><span class="ident" id="5530567">ListNode</span><span class="op" id="5530575">)</span>&nbsp;<span class="ident" id="5530577">CopyList</span><span class="op" id="5530585">(</span><span class="op" id="5530586">)</span>&nbsp;<span class="op" id="5530588">*</span><span class="ident" id="5530589">ListNode</span>&nbsp;<span class="op" id="5530598">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530601">if</span>&nbsp;<span class="ident" id="5530604">l</span>&nbsp;<span class="op" id="5530606">==</span>&nbsp;<span class="ident" id="5530609">nil</span>&nbsp;<span class="op" id="5530613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530617">return</span>&nbsp;<span class="ident" id="5530624">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530630">n</span>&nbsp;<span class="op" id="5530632">:=</span>&nbsp;<span class="ident" id="5530635">l</span><span class="op" id="5530636">.</span><span class="ident" id="5530637">tr</span><span class="op" id="5530639">.</span><span class="ident" id="5530640">newList</span><span class="op" id="5530647">(</span><span class="ident" id="5530648">l</span><span class="op" id="5530649">.</span><span class="ident" id="5530650">Pos</span><span class="op" id="5530653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530656">for</span>&nbsp;<span class="ident" id="5530660">_</span><span class="op" id="5530661">,</span>&nbsp;<span class="ident" id="5530663">elem</span>&nbsp;<span class="op" id="5530668">:=</span>&nbsp;<span class="keyword" id="5530671">range</span>&nbsp;<span class="ident" id="5530677">l</span><span class="op" id="5530678">.</span><span class="ident" id="5530679">Nodes</span>&nbsp;<span class="op" id="5530685">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530689">n</span><span class="op" id="5530690">.</span><span class="builtinfunc" id="5530691">append</span><span class="op" id="5530697">(</span><span class="ident" id="5530698">elem</span><span class="op" id="5530702">.</span><span class="ident" id="5530703">Copy</span><span class="op" id="5530707">(</span><span class="op" id="5530708">)</span><span class="op" id="5530709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5530712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530715">return</span>&nbsp;<span class="ident" id="5530722">n</span><br>
<span class="lineno"></span><span class="op" id="5530724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="5530727">func</span>&nbsp;<span class="op" id="5530732">(</span><span class="ident" id="5530733">l</span>&nbsp;<span class="op" id="5530735">*</span><span class="ident" id="5530736">ListNode</span><span class="op" id="5530744">)</span>&nbsp;<span class="ident" id="5530746">Copy</span><span class="op" id="5530750">(</span><span class="op" id="5530751">)</span>&nbsp;<span class="ident" id="5530753">Node</span>&nbsp;<span class="op" id="5530758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530761">return</span>&nbsp;<span class="ident" id="5530768">l</span><span class="op" id="5530769">.</span><span class="ident" id="5530770">CopyList</span><span class="op" id="5530778">(</span><span class="op" id="5530779">)</span><br>
<span class="lineno"></span><span class="op" id="5530781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5530784">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="5530814">type</span>&nbsp;<span class="ident" id="5530819">TextNode</span>&nbsp;<span class="keyword" id="5530828">struct</span>&nbsp;<span class="op" id="5530835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530838">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530848">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530853">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5530858">*</span><span class="ident" id="5530859">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5530865">Text</span>&nbsp;<span class="op" id="5530870">[</span><span class="op" id="5530871">]</span><span class="builtintype" id="5530872">byte</span>&nbsp;<span class="comment" id="5530877">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="5530909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5530912">func</span>&nbsp;<span class="op" id="5530917">(</span><span class="ident" id="5530918">t</span>&nbsp;<span class="op" id="5530920">*</span><span class="ident" id="5530921">Tree</span><span class="op" id="5530925">)</span>&nbsp;<span class="ident" id="5530927">newText</span><span class="op" id="5530934">(</span><span class="ident" id="5530935">pos</span>&nbsp;<span class="ident" id="5530939">Pos</span><span class="op" id="5530942">,</span>&nbsp;<span class="ident" id="5530944">text</span>&nbsp;<span class="builtintype" id="5530949">string</span><span class="op" id="5530955">)</span>&nbsp;<span class="op" id="5530957">*</span><span class="ident" id="5530958">TextNode</span>&nbsp;<span class="op" id="5530967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5530970">return</span>&nbsp;<span class="op" id="5530977">&amp;</span><span class="ident" id="5530978">TextNode</span><span class="op" id="5530986">{</span><span class="ident" id="5530987">tr</span><span class="op" id="5530989">:</span>&nbsp;<span class="ident" id="5530991">t</span><span class="op" id="5530992">,</span>&nbsp;<span class="ident" id="5530994">NodeType</span><span class="op" id="5531002">:</span>&nbsp;<span class="ident" id="5531004">NodeText</span><span class="op" id="5531012">,</span>&nbsp;<span class="ident" id="5531014">Pos</span><span class="op" id="5531017">:</span>&nbsp;<span class="ident" id="5531019">pos</span><span class="op" id="5531022">,</span>&nbsp;<span class="ident" id="5531024">Text</span><span class="op" id="5531028">:</span>&nbsp;<span class="op" id="5531030">[</span><span class="op" id="5531031">]</span><span class="builtintype" id="5531032">byte</span><span class="op" id="5531036">(</span><span class="ident" id="5531037">text</span><span class="op" id="5531041">)</span><span class="op" id="5531042">}</span><br>
<span class="lineno"></span><span class="op" id="5531044">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="5531047">func</span>&nbsp;<span class="op" id="5531052">(</span><span class="ident" id="5531053">t</span>&nbsp;<span class="op" id="5531055">*</span><span class="ident" id="5531056">TextNode</span><span class="op" id="5531064">)</span>&nbsp;<span class="ident" id="5531066">String</span><span class="op" id="5531072">(</span><span class="op" id="5531073">)</span>&nbsp;<span class="builtintype" id="5531075">string</span>&nbsp;<span class="op" id="5531082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531085">return</span>&nbsp;<span class="ident" id="5531092">fmt</span><span class="op" id="5531095">.</span><span class="ident" id="5531096">Sprintf</span><span class="op" id="5531103">(</span><span class="ident" id="5531104">textFormat</span><span class="op" id="5531114">,</span>&nbsp;<span class="ident" id="5531116">t</span><span class="op" id="5531117">.</span><span class="ident" id="5531118">Text</span><span class="op" id="5531122">)</span><br>
<span class="lineno"></span><span class="op" id="5531124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5531127">func</span>&nbsp;<span class="op" id="5531132">(</span><span class="ident" id="5531133">t</span>&nbsp;<span class="op" id="5531135">*</span><span class="ident" id="5531136">TextNode</span><span class="op" id="5531144">)</span>&nbsp;<span class="ident" id="5531146">tree</span><span class="op" id="5531150">(</span><span class="op" id="5531151">)</span>&nbsp;<span class="op" id="5531153">*</span><span class="ident" id="5531154">Tree</span>&nbsp;<span class="op" id="5531159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531162">return</span>&nbsp;<span class="ident" id="5531169">t</span><span class="op" id="5531170">.</span><span class="ident" id="5531171">tr</span><br>
<span class="lineno"></span><span class="op" id="5531174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5531177">func</span>&nbsp;<span class="op" id="5531182">(</span><span class="ident" id="5531183">t</span>&nbsp;<span class="op" id="5531185">*</span><span class="ident" id="5531186">TextNode</span><span class="op" id="5531194">)</span>&nbsp;<span class="ident" id="5531196">Copy</span><span class="op" id="5531200">(</span><span class="op" id="5531201">)</span>&nbsp;<span class="ident" id="5531203">Node</span>&nbsp;<span class="op" id="5531208">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531211">return</span>&nbsp;<span class="op" id="5531218">&amp;</span><span class="ident" id="5531219">TextNode</span><span class="op" id="5531227">{</span><span class="ident" id="5531228">tr</span><span class="op" id="5531230">:</span>&nbsp;<span class="ident" id="5531232">t</span><span class="op" id="5531233">.</span><span class="ident" id="5531234">tr</span><span class="op" id="5531236">,</span>&nbsp;<span class="ident" id="5531238">NodeType</span><span class="op" id="5531246">:</span>&nbsp;<span class="ident" id="5531248">NodeText</span><span class="op" id="5531256">,</span>&nbsp;<span class="ident" id="5531258">Pos</span><span class="op" id="5531261">:</span>&nbsp;<span class="ident" id="5531263">t</span><span class="op" id="5531264">.</span><span class="ident" id="5531265">Pos</span><span class="op" id="5531268">,</span>&nbsp;<span class="ident" id="5531270">Text</span><span class="op" id="5531274">:</span>&nbsp;<span class="builtinfunc" id="5531276">append</span><span class="op" id="5531282">(</span><span class="op" id="5531283">[</span><span class="op" id="5531284">]</span><span class="builtintype" id="5531285">byte</span><span class="op" id="5531289">{</span><span class="op" id="5531290">}</span><span class="op" id="5531291">,</span>&nbsp;<span class="ident" id="5531293">t</span><span class="op" id="5531294">.</span><span class="ident" id="5531295">Text</span><span class="op" id="5531299">...</span><span class="op" id="5531302">)</span><span class="op" id="5531303">}</span><br>
<span class="lineno"></span><span class="op" id="5531305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5531308">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="5531363">type</span>&nbsp;<span class="ident" id="5531368">PipeNode</span>&nbsp;<span class="keyword" id="5531377">struct</span>&nbsp;<span class="op" id="5531384">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531387">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531397">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531402">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5531407">*</span><span class="ident" id="5531408">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531414">Line</span>&nbsp;<span class="builtintype" id="5531419">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5531435">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531505">Decl</span>&nbsp;<span class="op" id="5531510">[</span><span class="op" id="5531511">]</span><span class="op" id="5531512">*</span><span class="ident" id="5531513">VariableNode</span>&nbsp;<span class="comment" id="5531526">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531570">Cmds</span>&nbsp;<span class="op" id="5531575">[</span><span class="op" id="5531576">]</span><span class="op" id="5531577">*</span><span class="ident" id="5531578">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="5531591">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5531625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5531628">func</span>&nbsp;<span class="op" id="5531633">(</span><span class="ident" id="5531634">t</span>&nbsp;<span class="op" id="5531636">*</span><span class="ident" id="5531637">Tree</span><span class="op" id="5531641">)</span>&nbsp;<span class="ident" id="5531643">newPipeline</span><span class="op" id="5531654">(</span><span class="ident" id="5531655">pos</span>&nbsp;<span class="ident" id="5531659">Pos</span><span class="op" id="5531662">,</span>&nbsp;<span class="ident" id="5531664">line</span>&nbsp;<span class="builtintype" id="5531669">int</span><span class="op" id="5531672">,</span>&nbsp;<span class="ident" id="5531674">decl</span>&nbsp;<span class="op" id="5531679">[</span><span class="op" id="5531680">]</span><span class="op" id="5531681">*</span><span class="ident" id="5531682">VariableNode</span><span class="op" id="5531694">)</span>&nbsp;<span class="op" id="5531696">*</span><span class="ident" id="5531697">PipeNode</span>&nbsp;<span class="op" id="5531706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531709">return</span>&nbsp;<span class="op" id="5531716">&amp;</span><span class="ident" id="5531717">PipeNode</span><span class="op" id="5531725">{</span><span class="ident" id="5531726">tr</span><span class="op" id="5531728">:</span>&nbsp;<span class="ident" id="5531730">t</span><span class="op" id="5531731">,</span>&nbsp;<span class="ident" id="5531733">NodeType</span><span class="op" id="5531741">:</span>&nbsp;<span class="ident" id="5531743">NodePipe</span><span class="op" id="5531751">,</span>&nbsp;<span class="ident" id="5531753">Pos</span><span class="op" id="5531756">:</span>&nbsp;<span class="ident" id="5531758">pos</span><span class="op" id="5531761">,</span>&nbsp;<span class="ident" id="5531763">Line</span><span class="op" id="5531767">:</span>&nbsp;<span class="ident" id="5531769">line</span><span class="op" id="5531773">,</span>&nbsp;<span class="ident" id="5531775">Decl</span><span class="op" id="5531779">:</span>&nbsp;<span class="ident" id="5531781">decl</span><span class="op" id="5531785">}</span><br>
<span class="lineno">155</span><span class="op" id="5531787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5531790">func</span>&nbsp;<span class="op" id="5531795">(</span><span class="ident" id="5531796">p</span>&nbsp;<span class="op" id="5531798">*</span><span class="ident" id="5531799">PipeNode</span><span class="op" id="5531807">)</span>&nbsp;<span class="builtinfunc" id="5531809">append</span><span class="op" id="5531815">(</span><span class="ident" id="5531816">command</span>&nbsp;<span class="op" id="5531824">*</span><span class="ident" id="5531825">CommandNode</span><span class="op" id="5531836">)</span>&nbsp;<span class="op" id="5531838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531841">p</span><span class="op" id="5531842">.</span><span class="ident" id="5531843">Cmds</span>&nbsp;<span class="op" id="5531848">=</span>&nbsp;<span class="builtinfunc" id="5531850">append</span><span class="op" id="5531856">(</span><span class="ident" id="5531857">p</span><span class="op" id="5531858">.</span><span class="ident" id="5531859">Cmds</span><span class="op" id="5531863">,</span>&nbsp;<span class="ident" id="5531865">command</span><span class="op" id="5531872">)</span><br>
<span class="lineno"></span><span class="op" id="5531874">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="5531877">func</span>&nbsp;<span class="op" id="5531882">(</span><span class="ident" id="5531883">p</span>&nbsp;<span class="op" id="5531885">*</span><span class="ident" id="5531886">PipeNode</span><span class="op" id="5531894">)</span>&nbsp;<span class="ident" id="5531896">String</span><span class="op" id="5531902">(</span><span class="op" id="5531903">)</span>&nbsp;<span class="builtintype" id="5531905">string</span>&nbsp;<span class="op" id="5531912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531915">s</span>&nbsp;<span class="op" id="5531917">:=</span>&nbsp;<span class="string" id="5531920">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531924">if</span>&nbsp;<span class="builtinfunc" id="5531927">len</span><span class="op" id="5531930">(</span><span class="ident" id="5531931">p</span><span class="op" id="5531932">.</span><span class="ident" id="5531933">Decl</span><span class="op" id="5531937">)</span>&nbsp;<span class="op" id="5531939">&gt;</span>&nbsp;<span class="num" id="5531941">0</span>&nbsp;<span class="op" id="5531943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531947">for</span>&nbsp;<span class="ident" id="5531951">i</span><span class="op" id="5531952">,</span>&nbsp;<span class="ident" id="5531954">v</span>&nbsp;<span class="op" id="5531956">:=</span>&nbsp;<span class="keyword" id="5531959">range</span>&nbsp;<span class="ident" id="5531965">p</span><span class="op" id="5531966">.</span><span class="ident" id="5531967">Decl</span>&nbsp;<span class="op" id="5531972">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5531977">if</span>&nbsp;<span class="ident" id="5531980">i</span>&nbsp;<span class="op" id="5531982">&gt;</span>&nbsp;<span class="num" id="5531984">0</span>&nbsp;<span class="op" id="5531986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5531992">s</span>&nbsp;<span class="op" id="5531994">+=</span>&nbsp;<span class="string" id="5531997">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532010">s</span>&nbsp;<span class="op" id="5532012">+=</span>&nbsp;<span class="ident" id="5532015">v</span><span class="op" id="5532016">.</span><span class="ident" id="5532017">String</span><span class="op" id="5532023">(</span><span class="op" id="5532024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532028">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532032">s</span>&nbsp;<span class="op" id="5532034">+=</span>&nbsp;<span class="string" id="5532037">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532048">for</span>&nbsp;<span class="ident" id="5532052">i</span><span class="op" id="5532053">,</span>&nbsp;<span class="ident" id="5532055">c</span>&nbsp;<span class="op" id="5532057">:=</span>&nbsp;<span class="keyword" id="5532060">range</span>&nbsp;<span class="ident" id="5532066">p</span><span class="op" id="5532067">.</span><span class="ident" id="5532068">Cmds</span>&nbsp;<span class="op" id="5532073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532077">if</span>&nbsp;<span class="ident" id="5532080">i</span>&nbsp;<span class="op" id="5532082">&gt;</span>&nbsp;<span class="num" id="5532084">0</span>&nbsp;<span class="op" id="5532086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532091">s</span>&nbsp;<span class="op" id="5532093">+=</span>&nbsp;<span class="string" id="5532096">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532108">s</span>&nbsp;<span class="op" id="5532110">+=</span>&nbsp;<span class="ident" id="5532113">c</span><span class="op" id="5532114">.</span><span class="ident" id="5532115">String</span><span class="op" id="5532121">(</span><span class="op" id="5532122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532128">return</span>&nbsp;<span class="ident" id="5532135">s</span><br>
<span class="lineno"></span><span class="op" id="5532137">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="5532140">func</span>&nbsp;<span class="op" id="5532145">(</span><span class="ident" id="5532146">p</span>&nbsp;<span class="op" id="5532148">*</span><span class="ident" id="5532149">PipeNode</span><span class="op" id="5532157">)</span>&nbsp;<span class="ident" id="5532159">tree</span><span class="op" id="5532163">(</span><span class="op" id="5532164">)</span>&nbsp;<span class="op" id="5532166">*</span><span class="ident" id="5532167">Tree</span>&nbsp;<span class="op" id="5532172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532175">return</span>&nbsp;<span class="ident" id="5532182">p</span><span class="op" id="5532183">.</span><span class="ident" id="5532184">tr</span><br>
<span class="lineno"></span><span class="op" id="5532187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5532190">func</span>&nbsp;<span class="op" id="5532195">(</span><span class="ident" id="5532196">p</span>&nbsp;<span class="op" id="5532198">*</span><span class="ident" id="5532199">PipeNode</span><span class="op" id="5532207">)</span>&nbsp;<span class="ident" id="5532209">CopyPipe</span><span class="op" id="5532217">(</span><span class="op" id="5532218">)</span>&nbsp;<span class="op" id="5532220">*</span><span class="ident" id="5532221">PipeNode</span>&nbsp;<span class="op" id="5532230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532233">if</span>&nbsp;<span class="ident" id="5532236">p</span>&nbsp;<span class="op" id="5532238">==</span>&nbsp;<span class="ident" id="5532241">nil</span>&nbsp;<span class="op" id="5532245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532249">return</span>&nbsp;<span class="ident" id="5532256">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532262">var</span>&nbsp;<span class="ident" id="5532266">decl</span>&nbsp;<span class="op" id="5532271">[</span><span class="op" id="5532272">]</span><span class="op" id="5532273">*</span><span class="ident" id="5532274">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532288">for</span>&nbsp;<span class="ident" id="5532292">_</span><span class="op" id="5532293">,</span>&nbsp;<span class="ident" id="5532295">d</span>&nbsp;<span class="op" id="5532297">:=</span>&nbsp;<span class="keyword" id="5532300">range</span>&nbsp;<span class="ident" id="5532306">p</span><span class="op" id="5532307">.</span><span class="ident" id="5532308">Decl</span>&nbsp;<span class="op" id="5532313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532317">decl</span>&nbsp;<span class="op" id="5532322">=</span>&nbsp;<span class="builtinfunc" id="5532324">append</span><span class="op" id="5532330">(</span><span class="ident" id="5532331">decl</span><span class="op" id="5532335">,</span>&nbsp;<span class="ident" id="5532337">d</span><span class="op" id="5532338">.</span><span class="ident" id="5532339">Copy</span><span class="op" id="5532343">(</span><span class="op" id="5532344">)</span><span class="op" id="5532345">.</span><span class="op" id="5532346">(</span><span class="op" id="5532347">*</span><span class="ident" id="5532348">VariableNode</span><span class="op" id="5532360">)</span><span class="op" id="5532361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532367">n</span>&nbsp;<span class="op" id="5532369">:=</span>&nbsp;<span class="ident" id="5532372">p</span><span class="op" id="5532373">.</span><span class="ident" id="5532374">tr</span><span class="op" id="5532376">.</span><span class="ident" id="5532377">newPipeline</span><span class="op" id="5532388">(</span><span class="ident" id="5532389">p</span><span class="op" id="5532390">.</span><span class="ident" id="5532391">Pos</span><span class="op" id="5532394">,</span>&nbsp;<span class="ident" id="5532396">p</span><span class="op" id="5532397">.</span><span class="ident" id="5532398">Line</span><span class="op" id="5532402">,</span>&nbsp;<span class="ident" id="5532404">decl</span><span class="op" id="5532408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532411">for</span>&nbsp;<span class="ident" id="5532415">_</span><span class="op" id="5532416">,</span>&nbsp;<span class="ident" id="5532418">c</span>&nbsp;<span class="op" id="5532420">:=</span>&nbsp;<span class="keyword" id="5532423">range</span>&nbsp;<span class="ident" id="5532429">p</span><span class="op" id="5532430">.</span><span class="ident" id="5532431">Cmds</span>&nbsp;<span class="op" id="5532436">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532440">n</span><span class="op" id="5532441">.</span><span class="builtinfunc" id="5532442">append</span><span class="op" id="5532448">(</span><span class="ident" id="5532449">c</span><span class="op" id="5532450">.</span><span class="ident" id="5532451">Copy</span><span class="op" id="5532455">(</span><span class="op" id="5532456">)</span><span class="op" id="5532457">.</span><span class="op" id="5532458">(</span><span class="op" id="5532459">*</span><span class="ident" id="5532460">CommandNode</span><span class="op" id="5532471">)</span><span class="op" id="5532472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5532475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532478">return</span>&nbsp;<span class="ident" id="5532485">n</span><br>
<span class="lineno"></span><span class="op" id="5532487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="5532490">func</span>&nbsp;<span class="op" id="5532495">(</span><span class="ident" id="5532496">p</span>&nbsp;<span class="op" id="5532498">*</span><span class="ident" id="5532499">PipeNode</span><span class="op" id="5532507">)</span>&nbsp;<span class="ident" id="5532509">Copy</span><span class="op" id="5532513">(</span><span class="op" id="5532514">)</span>&nbsp;<span class="ident" id="5532516">Node</span>&nbsp;<span class="op" id="5532521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5532524">return</span>&nbsp;<span class="ident" id="5532531">p</span><span class="op" id="5532532">.</span><span class="ident" id="5532533">CopyPipe</span><span class="op" id="5532541">(</span><span class="op" id="5532542">)</span><br>
<span class="lineno"></span><span class="op" id="5532544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5532547">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="5532612">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="5532682">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="5532745">type</span>&nbsp;<span class="ident" id="5532750">ActionNode</span>&nbsp;<span class="keyword" id="5532761">struct</span>&nbsp;<span class="op" id="5532768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532771">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532781">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532786">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5532791">*</span><span class="ident" id="5532792">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532798">Line</span>&nbsp;<span class="builtintype" id="5532803">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5532813">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5532883">Pipe</span>&nbsp;<span class="op" id="5532888">*</span><span class="ident" id="5532889">PipeNode</span>&nbsp;<span class="comment" id="5532898">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="5532929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="5532932">func</span>&nbsp;<span class="op" id="5532937">(</span><span class="ident" id="5532938">t</span>&nbsp;<span class="op" id="5532940">*</span><span class="ident" id="5532941">Tree</span><span class="op" id="5532945">)</span>&nbsp;<span class="ident" id="5532947">newAction</span><span class="op" id="5532956">(</span><span class="ident" id="5532957">pos</span>&nbsp;<span class="ident" id="5532961">Pos</span><span class="op" id="5532964">,</span>&nbsp;<span class="ident" id="5532966">line</span>&nbsp;<span class="builtintype" id="5532971">int</span><span class="op" id="5532974">,</span>&nbsp;<span class="ident" id="5532976">pipe</span>&nbsp;<span class="op" id="5532981">*</span><span class="ident" id="5532982">PipeNode</span><span class="op" id="5532990">)</span>&nbsp;<span class="op" id="5532992">*</span><span class="ident" id="5532993">ActionNode</span>&nbsp;<span class="op" id="5533004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533007">return</span>&nbsp;<span class="op" id="5533014">&amp;</span><span class="ident" id="5533015">ActionNode</span><span class="op" id="5533025">{</span><span class="ident" id="5533026">tr</span><span class="op" id="5533028">:</span>&nbsp;<span class="ident" id="5533030">t</span><span class="op" id="5533031">,</span>&nbsp;<span class="ident" id="5533033">NodeType</span><span class="op" id="5533041">:</span>&nbsp;<span class="ident" id="5533043">NodeAction</span><span class="op" id="5533053">,</span>&nbsp;<span class="ident" id="5533055">Pos</span><span class="op" id="5533058">:</span>&nbsp;<span class="ident" id="5533060">pos</span><span class="op" id="5533063">,</span>&nbsp;<span class="ident" id="5533065">Line</span><span class="op" id="5533069">:</span>&nbsp;<span class="ident" id="5533071">line</span><span class="op" id="5533075">,</span>&nbsp;<span class="ident" id="5533077">Pipe</span><span class="op" id="5533081">:</span>&nbsp;<span class="ident" id="5533083">pipe</span><span class="op" id="5533087">}</span><br>
<span class="lineno"></span><span class="op" id="5533089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533092">func</span>&nbsp;<span class="op" id="5533097">(</span><span class="ident" id="5533098">a</span>&nbsp;<span class="op" id="5533100">*</span><span class="ident" id="5533101">ActionNode</span><span class="op" id="5533111">)</span>&nbsp;<span class="ident" id="5533113">String</span><span class="op" id="5533119">(</span><span class="op" id="5533120">)</span>&nbsp;<span class="builtintype" id="5533122">string</span>&nbsp;<span class="op" id="5533129">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533132">return</span>&nbsp;<span class="ident" id="5533139">fmt</span><span class="op" id="5533142">.</span><span class="ident" id="5533143">Sprintf</span><span class="op" id="5533150">(</span><span class="string" id="5533151">&#34;{{%s}}&#34;</span><span class="op" id="5533159">,</span>&nbsp;<span class="ident" id="5533161">a</span><span class="op" id="5533162">.</span><span class="ident" id="5533163">Pipe</span><span class="op" id="5533167">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="5533170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533173">func</span>&nbsp;<span class="op" id="5533178">(</span><span class="ident" id="5533179">a</span>&nbsp;<span class="op" id="5533181">*</span><span class="ident" id="5533182">ActionNode</span><span class="op" id="5533192">)</span>&nbsp;<span class="ident" id="5533194">tree</span><span class="op" id="5533198">(</span><span class="op" id="5533199">)</span>&nbsp;<span class="op" id="5533201">*</span><span class="ident" id="5533202">Tree</span>&nbsp;<span class="op" id="5533207">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533210">return</span>&nbsp;<span class="ident" id="5533217">a</span><span class="op" id="5533218">.</span><span class="ident" id="5533219">tr</span><br>
<span class="lineno"></span><span class="op" id="5533222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533225">func</span>&nbsp;<span class="op" id="5533230">(</span><span class="ident" id="5533231">a</span>&nbsp;<span class="op" id="5533233">*</span><span class="ident" id="5533234">ActionNode</span><span class="op" id="5533244">)</span>&nbsp;<span class="ident" id="5533246">Copy</span><span class="op" id="5533250">(</span><span class="op" id="5533251">)</span>&nbsp;<span class="ident" id="5533253">Node</span>&nbsp;<span class="op" id="5533258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533261">return</span>&nbsp;<span class="ident" id="5533268">a</span><span class="op" id="5533269">.</span><span class="ident" id="5533270">tr</span><span class="op" id="5533272">.</span><span class="ident" id="5533273">newAction</span><span class="op" id="5533282">(</span><span class="ident" id="5533283">a</span><span class="op" id="5533284">.</span><span class="ident" id="5533285">Pos</span><span class="op" id="5533288">,</span>&nbsp;<span class="ident" id="5533290">a</span><span class="op" id="5533291">.</span><span class="ident" id="5533292">Line</span><span class="op" id="5533296">,</span>&nbsp;<span class="ident" id="5533298">a</span><span class="op" id="5533299">.</span><span class="ident" id="5533300">Pipe</span><span class="op" id="5533304">.</span><span class="ident" id="5533305">CopyPipe</span><span class="op" id="5533313">(</span><span class="op" id="5533314">)</span><span class="op" id="5533315">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="5533318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5533321">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="5533394">type</span>&nbsp;<span class="ident" id="5533399">CommandNode</span>&nbsp;<span class="keyword" id="5533411">struct</span>&nbsp;<span class="op" id="5533418">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533421">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533431">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533436">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5533441">*</span><span class="ident" id="5533442">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533448">Args</span>&nbsp;<span class="op" id="5533453">[</span><span class="op" id="5533454">]</span><span class="ident" id="5533455">Node</span>&nbsp;<span class="comment" id="5533460">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="5533523">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="5533526">func</span>&nbsp;<span class="op" id="5533531">(</span><span class="ident" id="5533532">t</span>&nbsp;<span class="op" id="5533534">*</span><span class="ident" id="5533535">Tree</span><span class="op" id="5533539">)</span>&nbsp;<span class="ident" id="5533541">newCommand</span><span class="op" id="5533551">(</span><span class="ident" id="5533552">pos</span>&nbsp;<span class="ident" id="5533556">Pos</span><span class="op" id="5533559">)</span>&nbsp;<span class="op" id="5533561">*</span><span class="ident" id="5533562">CommandNode</span>&nbsp;<span class="op" id="5533574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533577">return</span>&nbsp;<span class="op" id="5533584">&amp;</span><span class="ident" id="5533585">CommandNode</span><span class="op" id="5533596">{</span><span class="ident" id="5533597">tr</span><span class="op" id="5533599">:</span>&nbsp;<span class="ident" id="5533601">t</span><span class="op" id="5533602">,</span>&nbsp;<span class="ident" id="5533604">NodeType</span><span class="op" id="5533612">:</span>&nbsp;<span class="ident" id="5533614">NodeCommand</span><span class="op" id="5533625">,</span>&nbsp;<span class="ident" id="5533627">Pos</span><span class="op" id="5533630">:</span>&nbsp;<span class="ident" id="5533632">pos</span><span class="op" id="5533635">}</span><br>
<span class="lineno"></span><span class="op" id="5533637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="5533640">func</span>&nbsp;<span class="op" id="5533645">(</span><span class="ident" id="5533646">c</span>&nbsp;<span class="op" id="5533648">*</span><span class="ident" id="5533649">CommandNode</span><span class="op" id="5533660">)</span>&nbsp;<span class="builtinfunc" id="5533662">append</span><span class="op" id="5533668">(</span><span class="ident" id="5533669">arg</span>&nbsp;<span class="ident" id="5533673">Node</span><span class="op" id="5533677">)</span>&nbsp;<span class="op" id="5533679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533682">c</span><span class="op" id="5533683">.</span><span class="ident" id="5533684">Args</span>&nbsp;<span class="op" id="5533689">=</span>&nbsp;<span class="builtinfunc" id="5533691">append</span><span class="op" id="5533697">(</span><span class="ident" id="5533698">c</span><span class="op" id="5533699">.</span><span class="ident" id="5533700">Args</span><span class="op" id="5533704">,</span>&nbsp;<span class="ident" id="5533706">arg</span><span class="op" id="5533709">)</span><br>
<span class="lineno"></span><span class="op" id="5533711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533714">func</span>&nbsp;<span class="op" id="5533719">(</span><span class="ident" id="5533720">c</span>&nbsp;<span class="op" id="5533722">*</span><span class="ident" id="5533723">CommandNode</span><span class="op" id="5533734">)</span>&nbsp;<span class="ident" id="5533736">String</span><span class="op" id="5533742">(</span><span class="op" id="5533743">)</span>&nbsp;<span class="builtintype" id="5533745">string</span>&nbsp;<span class="op" id="5533752">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533755">s</span>&nbsp;<span class="op" id="5533757">:=</span>&nbsp;<span class="string" id="5533760">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533764">for</span>&nbsp;<span class="ident" id="5533768">i</span><span class="op" id="5533769">,</span>&nbsp;<span class="ident" id="5533771">arg</span>&nbsp;<span class="op" id="5533775">:=</span>&nbsp;<span class="keyword" id="5533778">range</span>&nbsp;<span class="ident" id="5533784">c</span><span class="op" id="5533785">.</span><span class="ident" id="5533786">Args</span>&nbsp;<span class="op" id="5533791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533795">if</span>&nbsp;<span class="ident" id="5533798">i</span>&nbsp;<span class="op" id="5533800">&gt;</span>&nbsp;<span class="num" id="5533802">0</span>&nbsp;<span class="op" id="5533804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533809">s</span>&nbsp;<span class="op" id="5533811">+=</span>&nbsp;<span class="string" id="5533814">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533820">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533824">if</span>&nbsp;<span class="ident" id="5533827">arg</span><span class="op" id="5533830">,</span>&nbsp;<span class="ident" id="5533832">ok</span>&nbsp;<span class="op" id="5533835">:=</span>&nbsp;<span class="ident" id="5533838">arg</span><span class="op" id="5533841">.</span><span class="op" id="5533842">(</span><span class="op" id="5533843">*</span><span class="ident" id="5533844">PipeNode</span><span class="op" id="5533852">)</span><span class="op" id="5533853">;</span>&nbsp;<span class="ident" id="5533855">ok</span>&nbsp;<span class="op" id="5533858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533863">s</span>&nbsp;<span class="op" id="5533865">+=</span>&nbsp;<span class="string" id="5533868">&#34;(&#34;</span>&nbsp;<span class="op" id="5533872">+</span>&nbsp;<span class="ident" id="5533874">arg</span><span class="op" id="5533877">.</span><span class="ident" id="5533878">String</span><span class="op" id="5533884">(</span><span class="op" id="5533885">)</span>&nbsp;<span class="op" id="5533887">+</span>&nbsp;<span class="string" id="5533889">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533896">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5533911">s</span>&nbsp;<span class="op" id="5533913">+=</span>&nbsp;<span class="ident" id="5533916">arg</span><span class="op" id="5533919">.</span><span class="ident" id="5533920">String</span><span class="op" id="5533926">(</span><span class="op" id="5533927">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5533930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533933">return</span>&nbsp;<span class="ident" id="5533940">s</span><br>
<span class="lineno"></span><span class="op" id="5533942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533945">func</span>&nbsp;<span class="op" id="5533950">(</span><span class="ident" id="5533951">c</span>&nbsp;<span class="op" id="5533953">*</span><span class="ident" id="5533954">CommandNode</span><span class="op" id="5533965">)</span>&nbsp;<span class="ident" id="5533967">tree</span><span class="op" id="5533971">(</span><span class="op" id="5533972">)</span>&nbsp;<span class="op" id="5533974">*</span><span class="ident" id="5533975">Tree</span>&nbsp;<span class="op" id="5533980">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5533983">return</span>&nbsp;<span class="ident" id="5533990">c</span><span class="op" id="5533991">.</span><span class="ident" id="5533992">tr</span><br>
<span class="lineno"></span><span class="op" id="5533995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5533998">func</span>&nbsp;<span class="op" id="5534003">(</span><span class="ident" id="5534004">c</span>&nbsp;<span class="op" id="5534006">*</span><span class="ident" id="5534007">CommandNode</span><span class="op" id="5534018">)</span>&nbsp;<span class="ident" id="5534020">Copy</span><span class="op" id="5534024">(</span><span class="op" id="5534025">)</span>&nbsp;<span class="ident" id="5534027">Node</span>&nbsp;<span class="op" id="5534032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534035">if</span>&nbsp;<span class="ident" id="5534038">c</span>&nbsp;<span class="op" id="5534040">==</span>&nbsp;<span class="ident" id="5534043">nil</span>&nbsp;<span class="op" id="5534047">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534051">return</span>&nbsp;<span class="ident" id="5534058">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534064">n</span>&nbsp;<span class="op" id="5534066">:=</span>&nbsp;<span class="ident" id="5534069">c</span><span class="op" id="5534070">.</span><span class="ident" id="5534071">tr</span><span class="op" id="5534073">.</span><span class="ident" id="5534074">newCommand</span><span class="op" id="5534084">(</span><span class="ident" id="5534085">c</span><span class="op" id="5534086">.</span><span class="ident" id="5534087">Pos</span><span class="op" id="5534090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534093">for</span>&nbsp;<span class="ident" id="5534097">_</span><span class="op" id="5534098">,</span>&nbsp;<span class="ident" id="5534100">c</span>&nbsp;<span class="op" id="5534102">:=</span>&nbsp;<span class="keyword" id="5534105">range</span>&nbsp;<span class="ident" id="5534111">c</span><span class="op" id="5534112">.</span><span class="ident" id="5534113">Args</span>&nbsp;<span class="op" id="5534118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534122">n</span><span class="op" id="5534123">.</span><span class="builtinfunc" id="5534124">append</span><span class="op" id="5534130">(</span><span class="ident" id="5534131">c</span><span class="op" id="5534132">.</span><span class="ident" id="5534133">Copy</span><span class="op" id="5534137">(</span><span class="op" id="5534138">)</span><span class="op" id="5534139">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5534142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534145">return</span>&nbsp;<span class="ident" id="5534152">n</span><br>
<span class="lineno"></span><span class="op" id="5534154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5534157">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="5534196">type</span>&nbsp;<span class="ident" id="5534201">IdentifierNode</span>&nbsp;<span class="keyword" id="5534216">struct</span>&nbsp;<span class="op" id="5534223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534226">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534236">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534241">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5534247">*</span><span class="ident" id="5534248">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534254">Ident</span>&nbsp;<span class="builtintype" id="5534260">string</span>&nbsp;<span class="comment" id="5534267">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="5534293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5534296">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5534374">func</span>&nbsp;<span class="ident" id="5534379">NewIdentifier</span><span class="op" id="5534392">(</span><span class="ident" id="5534393">ident</span>&nbsp;<span class="builtintype" id="5534399">string</span><span class="op" id="5534405">)</span>&nbsp;<span class="op" id="5534407">*</span><span class="ident" id="5534408">IdentifierNode</span>&nbsp;<span class="op" id="5534423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534426">return</span>&nbsp;<span class="op" id="5534433">&amp;</span><span class="ident" id="5534434">IdentifierNode</span><span class="op" id="5534448">{</span><span class="ident" id="5534449">NodeType</span><span class="op" id="5534457">:</span>&nbsp;<span class="ident" id="5534459">NodeIdentifier</span><span class="op" id="5534473">,</span>&nbsp;<span class="ident" id="5534475">Ident</span><span class="op" id="5534480">:</span>&nbsp;<span class="ident" id="5534482">ident</span><span class="op" id="5534487">}</span><br>
<span class="lineno">290</span><span class="op" id="5534489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5534492">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="5534588">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="5534616">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="5534638">func</span>&nbsp;<span class="op" id="5534643">(</span><span class="ident" id="5534644">i</span>&nbsp;<span class="op" id="5534646">*</span><span class="ident" id="5534647">IdentifierNode</span><span class="op" id="5534661">)</span>&nbsp;<span class="ident" id="5534663">SetPos</span><span class="op" id="5534669">(</span><span class="ident" id="5534670">pos</span>&nbsp;<span class="ident" id="5534674">Pos</span><span class="op" id="5534677">)</span>&nbsp;<span class="op" id="5534679">*</span><span class="ident" id="5534680">IdentifierNode</span>&nbsp;<span class="op" id="5534695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534698">i</span><span class="op" id="5534699">.</span><span class="ident" id="5534700">Pos</span>&nbsp;<span class="op" id="5534704">=</span>&nbsp;<span class="ident" id="5534706">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534711">return</span>&nbsp;<span class="ident" id="5534718">i</span><br>
<span class="lineno"></span><span class="op" id="5534720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="5534723">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="5534836">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="5534864">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="5534886">func</span>&nbsp;<span class="op" id="5534891">(</span><span class="ident" id="5534892">i</span>&nbsp;<span class="op" id="5534894">*</span><span class="ident" id="5534895">IdentifierNode</span><span class="op" id="5534909">)</span>&nbsp;<span class="ident" id="5534911">SetTree</span><span class="op" id="5534918">(</span><span class="ident" id="5534919">t</span>&nbsp;<span class="op" id="5534921">*</span><span class="ident" id="5534922">Tree</span><span class="op" id="5534926">)</span>&nbsp;<span class="op" id="5534928">*</span><span class="ident" id="5534929">IdentifierNode</span>&nbsp;<span class="op" id="5534944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5534947">i</span><span class="op" id="5534948">.</span><span class="ident" id="5534949">tr</span>&nbsp;<span class="op" id="5534952">=</span>&nbsp;<span class="ident" id="5534954">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5534957">return</span>&nbsp;<span class="ident" id="5534964">i</span><br>
<span class="lineno"></span><span class="op" id="5534966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5534969">func</span>&nbsp;<span class="op" id="5534974">(</span><span class="ident" id="5534975">i</span>&nbsp;<span class="op" id="5534977">*</span><span class="ident" id="5534978">IdentifierNode</span><span class="op" id="5534992">)</span>&nbsp;<span class="ident" id="5534994">String</span><span class="op" id="5535000">(</span><span class="op" id="5535001">)</span>&nbsp;<span class="builtintype" id="5535003">string</span>&nbsp;<span class="op" id="5535010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535013">return</span>&nbsp;<span class="ident" id="5535020">i</span><span class="op" id="5535021">.</span><span class="ident" id="5535022">Ident</span><br>
<span class="lineno">310</span><span class="op" id="5535028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535031">func</span>&nbsp;<span class="op" id="5535036">(</span><span class="ident" id="5535037">i</span>&nbsp;<span class="op" id="5535039">*</span><span class="ident" id="5535040">IdentifierNode</span><span class="op" id="5535054">)</span>&nbsp;<span class="ident" id="5535056">tree</span><span class="op" id="5535060">(</span><span class="op" id="5535061">)</span>&nbsp;<span class="op" id="5535063">*</span><span class="ident" id="5535064">Tree</span>&nbsp;<span class="op" id="5535069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535072">return</span>&nbsp;<span class="ident" id="5535079">i</span><span class="op" id="5535080">.</span><span class="ident" id="5535081">tr</span><br>
<span class="lineno"></span><span class="op" id="5535084">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5535087">func</span>&nbsp;<span class="op" id="5535092">(</span><span class="ident" id="5535093">i</span>&nbsp;<span class="op" id="5535095">*</span><span class="ident" id="5535096">IdentifierNode</span><span class="op" id="5535110">)</span>&nbsp;<span class="ident" id="5535112">Copy</span><span class="op" id="5535116">(</span><span class="op" id="5535117">)</span>&nbsp;<span class="ident" id="5535119">Node</span>&nbsp;<span class="op" id="5535124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535127">return</span>&nbsp;<span class="ident" id="5535134">NewIdentifier</span><span class="op" id="5535147">(</span><span class="ident" id="5535148">i</span><span class="op" id="5535149">.</span><span class="ident" id="5535150">Ident</span><span class="op" id="5535155">)</span><span class="op" id="5535156">.</span><span class="ident" id="5535157">SetTree</span><span class="op" id="5535164">(</span><span class="ident" id="5535165">i</span><span class="op" id="5535166">.</span><span class="ident" id="5535167">tr</span><span class="op" id="5535169">)</span><span class="op" id="5535170">.</span><span class="ident" id="5535171">SetPos</span><span class="op" id="5535177">(</span><span class="ident" id="5535178">i</span><span class="op" id="5535179">.</span><span class="ident" id="5535180">Pos</span><span class="op" id="5535183">)</span><br>
<span class="lineno"></span><span class="op" id="5535185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5535188">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="5535264">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5535322">type</span>&nbsp;<span class="ident" id="5535327">VariableNode</span>&nbsp;<span class="keyword" id="5535340">struct</span>&nbsp;<span class="op" id="5535347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535350">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535360">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535365">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5535371">*</span><span class="ident" id="5535372">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535378">Ident</span>&nbsp;<span class="op" id="5535384">[</span><span class="op" id="5535385">]</span><span class="builtintype" id="5535386">string</span>&nbsp;<span class="comment" id="5535393">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5535439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535442">func</span>&nbsp;<span class="op" id="5535447">(</span><span class="ident" id="5535448">t</span>&nbsp;<span class="op" id="5535450">*</span><span class="ident" id="5535451">Tree</span><span class="op" id="5535455">)</span>&nbsp;<span class="ident" id="5535457">newVariable</span><span class="op" id="5535468">(</span><span class="ident" id="5535469">pos</span>&nbsp;<span class="ident" id="5535473">Pos</span><span class="op" id="5535476">,</span>&nbsp;<span class="ident" id="5535478">ident</span>&nbsp;<span class="builtintype" id="5535484">string</span><span class="op" id="5535490">)</span>&nbsp;<span class="op" id="5535492">*</span><span class="ident" id="5535493">VariableNode</span>&nbsp;<span class="op" id="5535506">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535509">return</span>&nbsp;<span class="op" id="5535516">&amp;</span><span class="ident" id="5535517">VariableNode</span><span class="op" id="5535529">{</span><span class="ident" id="5535530">tr</span><span class="op" id="5535532">:</span>&nbsp;<span class="ident" id="5535534">t</span><span class="op" id="5535535">,</span>&nbsp;<span class="ident" id="5535537">NodeType</span><span class="op" id="5535545">:</span>&nbsp;<span class="ident" id="5535547">NodeVariable</span><span class="op" id="5535559">,</span>&nbsp;<span class="ident" id="5535561">Pos</span><span class="op" id="5535564">:</span>&nbsp;<span class="ident" id="5535566">pos</span><span class="op" id="5535569">,</span>&nbsp;<span class="ident" id="5535571">Ident</span><span class="op" id="5535576">:</span>&nbsp;<span class="ident" id="5535578">strings</span><span class="op" id="5535585">.</span><span class="ident" id="5535586">Split</span><span class="op" id="5535591">(</span><span class="ident" id="5535592">ident</span><span class="op" id="5535597">,</span>&nbsp;<span class="string" id="5535599">&#34;.&#34;</span><span class="op" id="5535602">)</span><span class="op" id="5535603">}</span><br>
<span class="lineno"></span><span class="op" id="5535605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535608">func</span>&nbsp;<span class="op" id="5535613">(</span><span class="ident" id="5535614">v</span>&nbsp;<span class="op" id="5535616">*</span><span class="ident" id="5535617">VariableNode</span><span class="op" id="5535629">)</span>&nbsp;<span class="ident" id="5535631">String</span><span class="op" id="5535637">(</span><span class="op" id="5535638">)</span>&nbsp;<span class="builtintype" id="5535640">string</span>&nbsp;<span class="op" id="5535647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535650">s</span>&nbsp;<span class="op" id="5535652">:=</span>&nbsp;<span class="string" id="5535655">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535659">for</span>&nbsp;<span class="ident" id="5535663">i</span><span class="op" id="5535664">,</span>&nbsp;<span class="ident" id="5535666">id</span>&nbsp;<span class="op" id="5535669">:=</span>&nbsp;<span class="keyword" id="5535672">range</span>&nbsp;<span class="ident" id="5535678">v</span><span class="op" id="5535679">.</span><span class="ident" id="5535680">Ident</span>&nbsp;<span class="op" id="5535686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535690">if</span>&nbsp;<span class="ident" id="5535693">i</span>&nbsp;<span class="op" id="5535695">&gt;</span>&nbsp;<span class="num" id="5535697">0</span>&nbsp;<span class="op" id="5535699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535704">s</span>&nbsp;<span class="op" id="5535706">+=</span>&nbsp;<span class="string" id="5535709">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5535715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5535719">s</span>&nbsp;<span class="op" id="5535721">+=</span>&nbsp;<span class="ident" id="5535724">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5535728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535731">return</span>&nbsp;<span class="ident" id="5535738">s</span><br>
<span class="lineno"></span><span class="op" id="5535740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535743">func</span>&nbsp;<span class="op" id="5535748">(</span><span class="ident" id="5535749">v</span>&nbsp;<span class="op" id="5535751">*</span><span class="ident" id="5535752">VariableNode</span><span class="op" id="5535764">)</span>&nbsp;<span class="ident" id="5535766">tree</span><span class="op" id="5535770">(</span><span class="op" id="5535771">)</span>&nbsp;<span class="op" id="5535773">*</span><span class="ident" id="5535774">Tree</span>&nbsp;<span class="op" id="5535779">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535782">return</span>&nbsp;<span class="ident" id="5535789">v</span><span class="op" id="5535790">.</span><span class="ident" id="5535791">tr</span><br>
<span class="lineno"></span><span class="op" id="5535794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535797">func</span>&nbsp;<span class="op" id="5535802">(</span><span class="ident" id="5535803">v</span>&nbsp;<span class="op" id="5535805">*</span><span class="ident" id="5535806">VariableNode</span><span class="op" id="5535818">)</span>&nbsp;<span class="ident" id="5535820">Copy</span><span class="op" id="5535824">(</span><span class="op" id="5535825">)</span>&nbsp;<span class="ident" id="5535827">Node</span>&nbsp;<span class="op" id="5535832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5535835">return</span>&nbsp;<span class="op" id="5535842">&amp;</span><span class="ident" id="5535843">VariableNode</span><span class="op" id="5535855">{</span><span class="ident" id="5535856">tr</span><span class="op" id="5535858">:</span>&nbsp;<span class="ident" id="5535860">v</span><span class="op" id="5535861">.</span><span class="ident" id="5535862">tr</span><span class="op" id="5535864">,</span>&nbsp;<span class="ident" id="5535866">NodeType</span><span class="op" id="5535874">:</span>&nbsp;<span class="ident" id="5535876">NodeVariable</span><span class="op" id="5535888">,</span>&nbsp;<span class="ident" id="5535890">Pos</span><span class="op" id="5535893">:</span>&nbsp;<span class="ident" id="5535895">v</span><span class="op" id="5535896">.</span><span class="ident" id="5535897">Pos</span><span class="op" id="5535900">,</span>&nbsp;<span class="ident" id="5535902">Ident</span><span class="op" id="5535907">:</span>&nbsp;<span class="builtinfunc" id="5535909">append</span><span class="op" id="5535915">(</span><span class="op" id="5535916">[</span><span class="op" id="5535917">]</span><span class="builtintype" id="5535918">string</span><span class="op" id="5535924">{</span><span class="op" id="5535925">}</span><span class="op" id="5535926">,</span>&nbsp;<span class="ident" id="5535928">v</span><span class="op" id="5535929">.</span><span class="ident" id="5535930">Ident</span><span class="op" id="5535935">...</span><span class="op" id="5535938">)</span><span class="op" id="5535939">}</span><br>
<span class="lineno">350</span><span class="op" id="5535941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5535944">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="5535989">type</span>&nbsp;<span class="ident" id="5535994">DotNode</span>&nbsp;<span class="keyword" id="5536002">struct</span>&nbsp;<span class="op" id="5536009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536012">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536022">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536027">tr</span>&nbsp;<span class="op" id="5536030">*</span><span class="ident" id="5536031">Tree</span><br>
<span class="lineno"></span><span class="op" id="5536036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536039">func</span>&nbsp;<span class="op" id="5536044">(</span><span class="ident" id="5536045">t</span>&nbsp;<span class="op" id="5536047">*</span><span class="ident" id="5536048">Tree</span><span class="op" id="5536052">)</span>&nbsp;<span class="ident" id="5536054">newDot</span><span class="op" id="5536060">(</span><span class="ident" id="5536061">pos</span>&nbsp;<span class="ident" id="5536065">Pos</span><span class="op" id="5536068">)</span>&nbsp;<span class="op" id="5536070">*</span><span class="ident" id="5536071">DotNode</span>&nbsp;<span class="op" id="5536079">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536082">return</span>&nbsp;<span class="op" id="5536089">&amp;</span><span class="ident" id="5536090">DotNode</span><span class="op" id="5536097">{</span><span class="ident" id="5536098">tr</span><span class="op" id="5536100">:</span>&nbsp;<span class="ident" id="5536102">t</span><span class="op" id="5536103">,</span>&nbsp;<span class="ident" id="5536105">NodeType</span><span class="op" id="5536113">:</span>&nbsp;<span class="ident" id="5536115">NodeDot</span><span class="op" id="5536122">,</span>&nbsp;<span class="ident" id="5536124">Pos</span><span class="op" id="5536127">:</span>&nbsp;<span class="ident" id="5536129">pos</span><span class="op" id="5536132">}</span><br>
<span class="lineno"></span><span class="op" id="5536134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536137">func</span>&nbsp;<span class="op" id="5536142">(</span><span class="ident" id="5536143">d</span>&nbsp;<span class="op" id="5536145">*</span><span class="ident" id="5536146">DotNode</span><span class="op" id="5536153">)</span>&nbsp;<span class="ident" id="5536155">Type</span><span class="op" id="5536159">(</span><span class="op" id="5536160">)</span>&nbsp;<span class="ident" id="5536162">NodeType</span>&nbsp;<span class="op" id="5536171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536174">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536238">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536306">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536330">return</span>&nbsp;<span class="ident" id="5536337">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="5536345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="5536348">func</span>&nbsp;<span class="op" id="5536353">(</span><span class="ident" id="5536354">d</span>&nbsp;<span class="op" id="5536356">*</span><span class="ident" id="5536357">DotNode</span><span class="op" id="5536364">)</span>&nbsp;<span class="ident" id="5536366">String</span><span class="op" id="5536372">(</span><span class="op" id="5536373">)</span>&nbsp;<span class="builtintype" id="5536375">string</span>&nbsp;<span class="op" id="5536382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536385">return</span>&nbsp;<span class="string" id="5536392">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="5536396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536399">func</span>&nbsp;<span class="op" id="5536404">(</span><span class="ident" id="5536405">d</span>&nbsp;<span class="op" id="5536407">*</span><span class="ident" id="5536408">DotNode</span><span class="op" id="5536415">)</span>&nbsp;<span class="ident" id="5536417">tree</span><span class="op" id="5536421">(</span><span class="op" id="5536422">)</span>&nbsp;<span class="op" id="5536424">*</span><span class="ident" id="5536425">Tree</span>&nbsp;<span class="op" id="5536430">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536433">return</span>&nbsp;<span class="ident" id="5536440">d</span><span class="op" id="5536441">.</span><span class="ident" id="5536442">tr</span><br>
<span class="lineno"></span><span class="op" id="5536445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536448">func</span>&nbsp;<span class="op" id="5536453">(</span><span class="ident" id="5536454">d</span>&nbsp;<span class="op" id="5536456">*</span><span class="ident" id="5536457">DotNode</span><span class="op" id="5536464">)</span>&nbsp;<span class="ident" id="5536466">Copy</span><span class="op" id="5536470">(</span><span class="op" id="5536471">)</span>&nbsp;<span class="ident" id="5536473">Node</span>&nbsp;<span class="op" id="5536478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536481">return</span>&nbsp;<span class="ident" id="5536488">d</span><span class="op" id="5536489">.</span><span class="ident" id="5536490">tr</span><span class="op" id="5536492">.</span><span class="ident" id="5536493">newDot</span><span class="op" id="5536499">(</span><span class="ident" id="5536500">d</span><span class="op" id="5536501">.</span><span class="ident" id="5536502">Pos</span><span class="op" id="5536505">)</span><br>
<span class="lineno">380</span><span class="op" id="5536507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5536510">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="5536594">type</span>&nbsp;<span class="ident" id="5536599">NilNode</span>&nbsp;<span class="keyword" id="5536607">struct</span>&nbsp;<span class="op" id="5536614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536617">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536627">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5536632">tr</span>&nbsp;<span class="op" id="5536635">*</span><span class="ident" id="5536636">Tree</span><br>
<span class="lineno"></span><span class="op" id="5536641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536644">func</span>&nbsp;<span class="op" id="5536649">(</span><span class="ident" id="5536650">t</span>&nbsp;<span class="op" id="5536652">*</span><span class="ident" id="5536653">Tree</span><span class="op" id="5536657">)</span>&nbsp;<span class="ident" id="5536659">newNil</span><span class="op" id="5536665">(</span><span class="ident" id="5536666">pos</span>&nbsp;<span class="ident" id="5536670">Pos</span><span class="op" id="5536673">)</span>&nbsp;<span class="op" id="5536675">*</span><span class="ident" id="5536676">NilNode</span>&nbsp;<span class="op" id="5536684">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536687">return</span>&nbsp;<span class="op" id="5536694">&amp;</span><span class="ident" id="5536695">NilNode</span><span class="op" id="5536702">{</span><span class="ident" id="5536703">tr</span><span class="op" id="5536705">:</span>&nbsp;<span class="ident" id="5536707">t</span><span class="op" id="5536708">,</span>&nbsp;<span class="ident" id="5536710">NodeType</span><span class="op" id="5536718">:</span>&nbsp;<span class="ident" id="5536720">NodeNil</span><span class="op" id="5536727">,</span>&nbsp;<span class="ident" id="5536729">Pos</span><span class="op" id="5536732">:</span>&nbsp;<span class="ident" id="5536734">pos</span><span class="op" id="5536737">}</span><br>
<span class="lineno"></span><span class="op" id="5536739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5536742">func</span>&nbsp;<span class="op" id="5536747">(</span><span class="ident" id="5536748">n</span>&nbsp;<span class="op" id="5536750">*</span><span class="ident" id="5536751">NilNode</span><span class="op" id="5536758">)</span>&nbsp;<span class="ident" id="5536760">Type</span><span class="op" id="5536764">(</span><span class="op" id="5536765">)</span>&nbsp;<span class="ident" id="5536767">NodeType</span>&nbsp;<span class="op" id="5536776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536779">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536843">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5536911">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536935">return</span>&nbsp;<span class="ident" id="5536942">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="5536950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="5536953">func</span>&nbsp;<span class="op" id="5536958">(</span><span class="ident" id="5536959">n</span>&nbsp;<span class="op" id="5536961">*</span><span class="ident" id="5536962">NilNode</span><span class="op" id="5536969">)</span>&nbsp;<span class="ident" id="5536971">String</span><span class="op" id="5536977">(</span><span class="op" id="5536978">)</span>&nbsp;<span class="builtintype" id="5536980">string</span>&nbsp;<span class="op" id="5536987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5536990">return</span>&nbsp;<span class="string" id="5536997">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="5537003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537006">func</span>&nbsp;<span class="op" id="5537011">(</span><span class="ident" id="5537012">n</span>&nbsp;<span class="op" id="5537014">*</span><span class="ident" id="5537015">NilNode</span><span class="op" id="5537022">)</span>&nbsp;<span class="ident" id="5537024">tree</span><span class="op" id="5537028">(</span><span class="op" id="5537029">)</span>&nbsp;<span class="op" id="5537031">*</span><span class="ident" id="5537032">Tree</span>&nbsp;<span class="op" id="5537037">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537040">return</span>&nbsp;<span class="ident" id="5537047">n</span><span class="op" id="5537048">.</span><span class="ident" id="5537049">tr</span><br>
<span class="lineno"></span><span class="op" id="5537052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537055">func</span>&nbsp;<span class="op" id="5537060">(</span><span class="ident" id="5537061">n</span>&nbsp;<span class="op" id="5537063">*</span><span class="ident" id="5537064">NilNode</span><span class="op" id="5537071">)</span>&nbsp;<span class="ident" id="5537073">Copy</span><span class="op" id="5537077">(</span><span class="op" id="5537078">)</span>&nbsp;<span class="ident" id="5537080">Node</span>&nbsp;<span class="op" id="5537085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537088">return</span>&nbsp;<span class="ident" id="5537095">n</span><span class="op" id="5537096">.</span><span class="ident" id="5537097">tr</span><span class="op" id="5537099">.</span><span class="ident" id="5537100">newNil</span><span class="op" id="5537106">(</span><span class="ident" id="5537107">n</span><span class="op" id="5537108">.</span><span class="ident" id="5537109">Pos</span><span class="op" id="5537112">)</span><br>
<span class="lineno">410</span><span class="op" id="5537114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5537117">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5537176">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5537214">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="5537256">type</span>&nbsp;<span class="ident" id="5537261">FieldNode</span>&nbsp;<span class="keyword" id="5537271">struct</span>&nbsp;<span class="op" id="5537278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537281">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537291">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537296">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5537302">*</span><span class="ident" id="5537303">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537309">Ident</span>&nbsp;<span class="op" id="5537315">[</span><span class="op" id="5537316">]</span><span class="builtintype" id="5537317">string</span>&nbsp;<span class="comment" id="5537324">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="5537361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537364">func</span>&nbsp;<span class="op" id="5537369">(</span><span class="ident" id="5537370">t</span>&nbsp;<span class="op" id="5537372">*</span><span class="ident" id="5537373">Tree</span><span class="op" id="5537377">)</span>&nbsp;<span class="ident" id="5537379">newField</span><span class="op" id="5537387">(</span><span class="ident" id="5537388">pos</span>&nbsp;<span class="ident" id="5537392">Pos</span><span class="op" id="5537395">,</span>&nbsp;<span class="ident" id="5537397">ident</span>&nbsp;<span class="builtintype" id="5537403">string</span><span class="op" id="5537409">)</span>&nbsp;<span class="op" id="5537411">*</span><span class="ident" id="5537412">FieldNode</span>&nbsp;<span class="op" id="5537422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537425">return</span>&nbsp;<span class="op" id="5537432">&amp;</span><span class="ident" id="5537433">FieldNode</span><span class="op" id="5537442">{</span><span class="ident" id="5537443">tr</span><span class="op" id="5537445">:</span>&nbsp;<span class="ident" id="5537447">t</span><span class="op" id="5537448">,</span>&nbsp;<span class="ident" id="5537450">NodeType</span><span class="op" id="5537458">:</span>&nbsp;<span class="ident" id="5537460">NodeField</span><span class="op" id="5537469">,</span>&nbsp;<span class="ident" id="5537471">Pos</span><span class="op" id="5537474">:</span>&nbsp;<span class="ident" id="5537476">pos</span><span class="op" id="5537479">,</span>&nbsp;<span class="ident" id="5537481">Ident</span><span class="op" id="5537486">:</span>&nbsp;<span class="ident" id="5537488">strings</span><span class="op" id="5537495">.</span><span class="ident" id="5537496">Split</span><span class="op" id="5537501">(</span><span class="ident" id="5537502">ident</span><span class="op" id="5537507">[</span><span class="num" id="5537508">1</span><span class="op" id="5537509">:</span><span class="op" id="5537510">]</span><span class="op" id="5537511">,</span>&nbsp;<span class="string" id="5537513">&#34;.&#34;</span><span class="op" id="5537516">)</span><span class="op" id="5537517">}</span>&nbsp;<span class="comment" id="5537519">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="5537550">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="5537553">func</span>&nbsp;<span class="op" id="5537558">(</span><span class="ident" id="5537559">f</span>&nbsp;<span class="op" id="5537561">*</span><span class="ident" id="5537562">FieldNode</span><span class="op" id="5537571">)</span>&nbsp;<span class="ident" id="5537573">String</span><span class="op" id="5537579">(</span><span class="op" id="5537580">)</span>&nbsp;<span class="builtintype" id="5537582">string</span>&nbsp;<span class="op" id="5537589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537592">s</span>&nbsp;<span class="op" id="5537594">:=</span>&nbsp;<span class="string" id="5537597">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537601">for</span>&nbsp;<span class="ident" id="5537605">_</span><span class="op" id="5537606">,</span>&nbsp;<span class="ident" id="5537608">id</span>&nbsp;<span class="op" id="5537611">:=</span>&nbsp;<span class="keyword" id="5537614">range</span>&nbsp;<span class="ident" id="5537620">f</span><span class="op" id="5537621">.</span><span class="ident" id="5537622">Ident</span>&nbsp;<span class="op" id="5537628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537632">s</span>&nbsp;<span class="op" id="5537634">+=</span>&nbsp;<span class="string" id="5537637">&#34;.&#34;</span>&nbsp;<span class="op" id="5537641">+</span>&nbsp;<span class="ident" id="5537643">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537650">return</span>&nbsp;<span class="ident" id="5537657">s</span><br>
<span class="lineno"></span><span class="op" id="5537659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537662">func</span>&nbsp;<span class="op" id="5537667">(</span><span class="ident" id="5537668">f</span>&nbsp;<span class="op" id="5537670">*</span><span class="ident" id="5537671">FieldNode</span><span class="op" id="5537680">)</span>&nbsp;<span class="ident" id="5537682">tree</span><span class="op" id="5537686">(</span><span class="op" id="5537687">)</span>&nbsp;<span class="op" id="5537689">*</span><span class="ident" id="5537690">Tree</span>&nbsp;<span class="op" id="5537695">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537698">return</span>&nbsp;<span class="ident" id="5537705">f</span><span class="op" id="5537706">.</span><span class="ident" id="5537707">tr</span><br>
<span class="lineno"></span><span class="op" id="5537710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537713">func</span>&nbsp;<span class="op" id="5537718">(</span><span class="ident" id="5537719">f</span>&nbsp;<span class="op" id="5537721">*</span><span class="ident" id="5537722">FieldNode</span><span class="op" id="5537731">)</span>&nbsp;<span class="ident" id="5537733">Copy</span><span class="op" id="5537737">(</span><span class="op" id="5537738">)</span>&nbsp;<span class="ident" id="5537740">Node</span>&nbsp;<span class="op" id="5537745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537748">return</span>&nbsp;<span class="op" id="5537755">&amp;</span><span class="ident" id="5537756">FieldNode</span><span class="op" id="5537765">{</span><span class="ident" id="5537766">tr</span><span class="op" id="5537768">:</span>&nbsp;<span class="ident" id="5537770">f</span><span class="op" id="5537771">.</span><span class="ident" id="5537772">tr</span><span class="op" id="5537774">,</span>&nbsp;<span class="ident" id="5537776">NodeType</span><span class="op" id="5537784">:</span>&nbsp;<span class="ident" id="5537786">NodeField</span><span class="op" id="5537795">,</span>&nbsp;<span class="ident" id="5537797">Pos</span><span class="op" id="5537800">:</span>&nbsp;<span class="ident" id="5537802">f</span><span class="op" id="5537803">.</span><span class="ident" id="5537804">Pos</span><span class="op" id="5537807">,</span>&nbsp;<span class="ident" id="5537809">Ident</span><span class="op" id="5537814">:</span>&nbsp;<span class="builtinfunc" id="5537816">append</span><span class="op" id="5537822">(</span><span class="op" id="5537823">[</span><span class="op" id="5537824">]</span><span class="builtintype" id="5537825">string</span><span class="op" id="5537831">{</span><span class="op" id="5537832">}</span><span class="op" id="5537833">,</span>&nbsp;<span class="ident" id="5537835">f</span><span class="op" id="5537836">.</span><span class="ident" id="5537837">Ident</span><span class="op" id="5537842">...</span><span class="op" id="5537845">)</span><span class="op" id="5537846">}</span><br>
<span class="lineno">440</span><span class="op" id="5537848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5537851">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5537947">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="5537985">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="5538029">type</span>&nbsp;<span class="ident" id="5538034">ChainNode</span>&nbsp;<span class="keyword" id="5538044">struct</span>&nbsp;<span class="op" id="5538051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538054">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538064">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538069">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538075">*</span><span class="ident" id="5538076">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538082">Node</span>&nbsp;&nbsp;<span class="ident" id="5538088">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538094">Field</span>&nbsp;<span class="op" id="5538100">[</span><span class="op" id="5538101">]</span><span class="builtintype" id="5538102">string</span>&nbsp;<span class="comment" id="5538109">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="5538146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5538149">func</span>&nbsp;<span class="op" id="5538154">(</span><span class="ident" id="5538155">t</span>&nbsp;<span class="op" id="5538157">*</span><span class="ident" id="5538158">Tree</span><span class="op" id="5538162">)</span>&nbsp;<span class="ident" id="5538164">newChain</span><span class="op" id="5538172">(</span><span class="ident" id="5538173">pos</span>&nbsp;<span class="ident" id="5538177">Pos</span><span class="op" id="5538180">,</span>&nbsp;<span class="ident" id="5538182">node</span>&nbsp;<span class="ident" id="5538187">Node</span><span class="op" id="5538191">)</span>&nbsp;<span class="op" id="5538193">*</span><span class="ident" id="5538194">ChainNode</span>&nbsp;<span class="op" id="5538204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538207">return</span>&nbsp;<span class="op" id="5538214">&amp;</span><span class="ident" id="5538215">ChainNode</span><span class="op" id="5538224">{</span><span class="ident" id="5538225">tr</span><span class="op" id="5538227">:</span>&nbsp;<span class="ident" id="5538229">t</span><span class="op" id="5538230">,</span>&nbsp;<span class="ident" id="5538232">NodeType</span><span class="op" id="5538240">:</span>&nbsp;<span class="ident" id="5538242">NodeChain</span><span class="op" id="5538251">,</span>&nbsp;<span class="ident" id="5538253">Pos</span><span class="op" id="5538256">:</span>&nbsp;<span class="ident" id="5538258">pos</span><span class="op" id="5538261">,</span>&nbsp;<span class="ident" id="5538263">Node</span><span class="op" id="5538267">:</span>&nbsp;<span class="ident" id="5538269">node</span><span class="op" id="5538273">}</span><br>
<span class="lineno">455</span><span class="op" id="5538275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5538278">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="5538366">func</span>&nbsp;<span class="op" id="5538371">(</span><span class="ident" id="5538372">c</span>&nbsp;<span class="op" id="5538374">*</span><span class="ident" id="5538375">ChainNode</span><span class="op" id="5538384">)</span>&nbsp;<span class="ident" id="5538386">Add</span><span class="op" id="5538389">(</span><span class="ident" id="5538390">field</span>&nbsp;<span class="builtintype" id="5538396">string</span><span class="op" id="5538402">)</span>&nbsp;<span class="op" id="5538404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538407">if</span>&nbsp;<span class="builtinfunc" id="5538410">len</span><span class="op" id="5538413">(</span><span class="ident" id="5538414">field</span><span class="op" id="5538419">)</span>&nbsp;<span class="op" id="5538421">==</span>&nbsp;<span class="num" id="5538424">0</span>&nbsp;<span class="op" id="5538426">||</span>&nbsp;<span class="ident" id="5538429">field</span><span class="op" id="5538434">[</span><span class="num" id="5538435">0</span><span class="op" id="5538436">]</span>&nbsp;<span class="op" id="5538438">!=</span>&nbsp;<span class="string" id="5538441">&#39;.&#39;</span>&nbsp;<span class="op" id="5538445">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5538449">panic</span><span class="op" id="5538454">(</span><span class="string" id="5538455">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="5538472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5538475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538478">field</span>&nbsp;<span class="op" id="5538484">=</span>&nbsp;<span class="ident" id="5538486">field</span><span class="op" id="5538491">[</span><span class="num" id="5538492">1</span><span class="op" id="5538493">:</span><span class="op" id="5538494">]</span>&nbsp;<span class="comment" id="5538496">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538520">if</span>&nbsp;<span class="ident" id="5538523">field</span>&nbsp;<span class="op" id="5538529">==</span>&nbsp;<span class="string" id="5538532">&#34;&#34;</span>&nbsp;<span class="op" id="5538535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5538539">panic</span><span class="op" id="5538544">(</span><span class="string" id="5538545">&#34;empty&nbsp;field&#34;</span><span class="op" id="5538558">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5538561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538564">c</span><span class="op" id="5538565">.</span><span class="ident" id="5538566">Field</span>&nbsp;<span class="op" id="5538572">=</span>&nbsp;<span class="builtinfunc" id="5538574">append</span><span class="op" id="5538580">(</span><span class="ident" id="5538581">c</span><span class="op" id="5538582">.</span><span class="ident" id="5538583">Field</span><span class="op" id="5538588">,</span>&nbsp;<span class="ident" id="5538590">field</span><span class="op" id="5538595">)</span><br>
<span class="lineno"></span><span class="op" id="5538597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5538600">func</span>&nbsp;<span class="op" id="5538605">(</span><span class="ident" id="5538606">c</span>&nbsp;<span class="op" id="5538608">*</span><span class="ident" id="5538609">ChainNode</span><span class="op" id="5538618">)</span>&nbsp;<span class="ident" id="5538620">String</span><span class="op" id="5538626">(</span><span class="op" id="5538627">)</span>&nbsp;<span class="builtintype" id="5538629">string</span>&nbsp;<span class="op" id="5538636">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538639">s</span>&nbsp;<span class="op" id="5538641">:=</span>&nbsp;<span class="ident" id="5538644">c</span><span class="op" id="5538645">.</span><span class="ident" id="5538646">Node</span><span class="op" id="5538650">.</span><span class="ident" id="5538651">String</span><span class="op" id="5538657">(</span><span class="op" id="5538658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538661">if</span>&nbsp;<span class="ident" id="5538664">_</span><span class="op" id="5538665">,</span>&nbsp;<span class="ident" id="5538667">ok</span>&nbsp;<span class="op" id="5538670">:=</span>&nbsp;<span class="ident" id="5538673">c</span><span class="op" id="5538674">.</span><span class="ident" id="5538675">Node</span><span class="op" id="5538679">.</span><span class="op" id="5538680">(</span><span class="op" id="5538681">*</span><span class="ident" id="5538682">PipeNode</span><span class="op" id="5538690">)</span><span class="op" id="5538691">;</span>&nbsp;<span class="ident" id="5538693">ok</span>&nbsp;<span class="op" id="5538696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538700">s</span>&nbsp;<span class="op" id="5538702">=</span>&nbsp;<span class="string" id="5538704">&#34;(&#34;</span>&nbsp;<span class="op" id="5538708">+</span>&nbsp;<span class="ident" id="5538710">s</span>&nbsp;<span class="op" id="5538712">+</span>&nbsp;<span class="string" id="5538714">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5538719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538722">for</span>&nbsp;<span class="ident" id="5538726">_</span><span class="op" id="5538727">,</span>&nbsp;<span class="ident" id="5538729">field</span>&nbsp;<span class="op" id="5538735">:=</span>&nbsp;<span class="keyword" id="5538738">range</span>&nbsp;<span class="ident" id="5538744">c</span><span class="op" id="5538745">.</span><span class="ident" id="5538746">Field</span>&nbsp;<span class="op" id="5538752">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538756">s</span>&nbsp;<span class="op" id="5538758">+=</span>&nbsp;<span class="string" id="5538761">&#34;.&#34;</span>&nbsp;<span class="op" id="5538765">+</span>&nbsp;<span class="ident" id="5538767">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5538774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538777">return</span>&nbsp;<span class="ident" id="5538784">s</span><br>
<span class="lineno"></span><span class="op" id="5538786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="5538789">func</span>&nbsp;<span class="op" id="5538794">(</span><span class="ident" id="5538795">c</span>&nbsp;<span class="op" id="5538797">*</span><span class="ident" id="5538798">ChainNode</span><span class="op" id="5538807">)</span>&nbsp;<span class="ident" id="5538809">tree</span><span class="op" id="5538813">(</span><span class="op" id="5538814">)</span>&nbsp;<span class="op" id="5538816">*</span><span class="ident" id="5538817">Tree</span>&nbsp;<span class="op" id="5538822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538825">return</span>&nbsp;<span class="ident" id="5538832">c</span><span class="op" id="5538833">.</span><span class="ident" id="5538834">tr</span><br>
<span class="lineno"></span><span class="op" id="5538837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5538840">func</span>&nbsp;<span class="op" id="5538845">(</span><span class="ident" id="5538846">c</span>&nbsp;<span class="op" id="5538848">*</span><span class="ident" id="5538849">ChainNode</span><span class="op" id="5538858">)</span>&nbsp;<span class="ident" id="5538860">Copy</span><span class="op" id="5538864">(</span><span class="op" id="5538865">)</span>&nbsp;<span class="ident" id="5538867">Node</span>&nbsp;<span class="op" id="5538872">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538875">return</span>&nbsp;<span class="op" id="5538882">&amp;</span><span class="ident" id="5538883">ChainNode</span><span class="op" id="5538892">{</span><span class="ident" id="5538893">tr</span><span class="op" id="5538895">:</span>&nbsp;<span class="ident" id="5538897">c</span><span class="op" id="5538898">.</span><span class="ident" id="5538899">tr</span><span class="op" id="5538901">,</span>&nbsp;<span class="ident" id="5538903">NodeType</span><span class="op" id="5538911">:</span>&nbsp;<span class="ident" id="5538913">NodeChain</span><span class="op" id="5538922">,</span>&nbsp;<span class="ident" id="5538924">Pos</span><span class="op" id="5538927">:</span>&nbsp;<span class="ident" id="5538929">c</span><span class="op" id="5538930">.</span><span class="ident" id="5538931">Pos</span><span class="op" id="5538934">,</span>&nbsp;<span class="ident" id="5538936">Node</span><span class="op" id="5538940">:</span>&nbsp;<span class="ident" id="5538942">c</span><span class="op" id="5538943">.</span><span class="ident" id="5538944">Node</span><span class="op" id="5538948">,</span>&nbsp;<span class="ident" id="5538950">Field</span><span class="op" id="5538955">:</span>&nbsp;<span class="builtinfunc" id="5538957">append</span><span class="op" id="5538963">(</span><span class="op" id="5538964">[</span><span class="op" id="5538965">]</span><span class="builtintype" id="5538966">string</span><span class="op" id="5538972">{</span><span class="op" id="5538973">}</span><span class="op" id="5538974">,</span>&nbsp;<span class="ident" id="5538976">c</span><span class="op" id="5538977">.</span><span class="ident" id="5538978">Field</span><span class="op" id="5538983">...</span><span class="op" id="5538986">)</span><span class="op" id="5538987">}</span><br>
<span class="lineno"></span><span class="op" id="5538989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5538992">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="5539030">type</span>&nbsp;<span class="ident" id="5539035">BoolNode</span>&nbsp;<span class="keyword" id="5539044">struct</span>&nbsp;<span class="op" id="5539051">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539054">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539064">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539069">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5539074">*</span><span class="ident" id="5539075">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539081">True</span>&nbsp;<span class="builtintype" id="5539086">bool</span>&nbsp;<span class="comment" id="5539091">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="5539129">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="5539132">func</span>&nbsp;<span class="op" id="5539137">(</span><span class="ident" id="5539138">t</span>&nbsp;<span class="op" id="5539140">*</span><span class="ident" id="5539141">Tree</span><span class="op" id="5539145">)</span>&nbsp;<span class="ident" id="5539147">newBool</span><span class="op" id="5539154">(</span><span class="ident" id="5539155">pos</span>&nbsp;<span class="ident" id="5539159">Pos</span><span class="op" id="5539162">,</span>&nbsp;<span class="builtintype" id="5539164">true</span>&nbsp;<span class="builtintype" id="5539169">bool</span><span class="op" id="5539173">)</span>&nbsp;<span class="op" id="5539175">*</span><span class="ident" id="5539176">BoolNode</span>&nbsp;<span class="op" id="5539185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539188">return</span>&nbsp;<span class="op" id="5539195">&amp;</span><span class="ident" id="5539196">BoolNode</span><span class="op" id="5539204">{</span><span class="ident" id="5539205">tr</span><span class="op" id="5539207">:</span>&nbsp;<span class="ident" id="5539209">t</span><span class="op" id="5539210">,</span>&nbsp;<span class="ident" id="5539212">NodeType</span><span class="op" id="5539220">:</span>&nbsp;<span class="ident" id="5539222">NodeBool</span><span class="op" id="5539230">,</span>&nbsp;<span class="ident" id="5539232">Pos</span><span class="op" id="5539235">:</span>&nbsp;<span class="ident" id="5539237">pos</span><span class="op" id="5539240">,</span>&nbsp;<span class="ident" id="5539242">True</span><span class="op" id="5539246">:</span>&nbsp;<span class="builtintype" id="5539248">true</span><span class="op" id="5539252">}</span><br>
<span class="lineno"></span><span class="op" id="5539254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5539257">func</span>&nbsp;<span class="op" id="5539262">(</span><span class="ident" id="5539263">b</span>&nbsp;<span class="op" id="5539265">*</span><span class="ident" id="5539266">BoolNode</span><span class="op" id="5539274">)</span>&nbsp;<span class="ident" id="5539276">String</span><span class="op" id="5539282">(</span><span class="op" id="5539283">)</span>&nbsp;<span class="builtintype" id="5539285">string</span>&nbsp;<span class="op" id="5539292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539295">if</span>&nbsp;<span class="ident" id="5539298">b</span><span class="op" id="5539299">.</span><span class="ident" id="5539300">True</span>&nbsp;<span class="op" id="5539305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539309">return</span>&nbsp;<span class="string" id="5539316">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5539324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539327">return</span>&nbsp;<span class="string" id="5539334">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="5539342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5539345">func</span>&nbsp;<span class="op" id="5539350">(</span><span class="ident" id="5539351">b</span>&nbsp;<span class="op" id="5539353">*</span><span class="ident" id="5539354">BoolNode</span><span class="op" id="5539362">)</span>&nbsp;<span class="ident" id="5539364">tree</span><span class="op" id="5539368">(</span><span class="op" id="5539369">)</span>&nbsp;<span class="op" id="5539371">*</span><span class="ident" id="5539372">Tree</span>&nbsp;<span class="op" id="5539377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539380">return</span>&nbsp;<span class="ident" id="5539387">b</span><span class="op" id="5539388">.</span><span class="ident" id="5539389">tr</span><br>
<span class="lineno"></span><span class="op" id="5539392">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5539395">func</span>&nbsp;<span class="op" id="5539400">(</span><span class="ident" id="5539401">b</span>&nbsp;<span class="op" id="5539403">*</span><span class="ident" id="5539404">BoolNode</span><span class="op" id="5539412">)</span>&nbsp;<span class="ident" id="5539414">Copy</span><span class="op" id="5539418">(</span><span class="op" id="5539419">)</span>&nbsp;<span class="ident" id="5539421">Node</span>&nbsp;<span class="op" id="5539426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5539429">return</span>&nbsp;<span class="ident" id="5539436">b</span><span class="op" id="5539437">.</span><span class="ident" id="5539438">tr</span><span class="op" id="5539440">.</span><span class="ident" id="5539441">newBool</span><span class="op" id="5539448">(</span><span class="ident" id="5539449">b</span><span class="op" id="5539450">.</span><span class="ident" id="5539451">Pos</span><span class="op" id="5539454">,</span>&nbsp;<span class="ident" id="5539456">b</span><span class="op" id="5539457">.</span><span class="ident" id="5539458">True</span><span class="op" id="5539462">)</span><br>
<span class="lineno"></span><span class="op" id="5539464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="5539467">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="5539544">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5539628">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="5539710">type</span>&nbsp;<span class="ident" id="5539715">NumberNode</span>&nbsp;<span class="keyword" id="5539726">struct</span>&nbsp;<span class="op" id="5539733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539736">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539746">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539751">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5539762">*</span><span class="ident" id="5539763">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539769">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539780">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539791">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539825">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539836">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539847">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539890">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5539901">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539912">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539951">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="5539962">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5539973">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5539996">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540007">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5540018">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540048">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5540059">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5540070">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540102">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5540113">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5540124">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540154">Complex128</span>&nbsp;<span class="builtintype" id="5540165">complex128</span>&nbsp;<span class="comment" id="5540176">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540199">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5540210">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5540221">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="5540276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5540279">func</span>&nbsp;<span class="op" id="5540284">(</span><span class="ident" id="5540285">t</span>&nbsp;<span class="op" id="5540287">*</span><span class="ident" id="5540288">Tree</span><span class="op" id="5540292">)</span>&nbsp;<span class="ident" id="5540294">newNumber</span><span class="op" id="5540303">(</span><span class="ident" id="5540304">pos</span>&nbsp;<span class="ident" id="5540308">Pos</span><span class="op" id="5540311">,</span>&nbsp;<span class="ident" id="5540313">text</span>&nbsp;<span class="builtintype" id="5540318">string</span><span class="op" id="5540324">,</span>&nbsp;<span class="ident" id="5540326">typ</span>&nbsp;<span class="ident" id="5540330">itemType</span><span class="op" id="5540338">)</span>&nbsp;<span class="op" id="5540340">(</span><span class="op" id="5540341">*</span><span class="ident" id="5540342">NumberNode</span><span class="op" id="5540352">,</span>&nbsp;<span class="builtintype" id="5540354">error</span><span class="op" id="5540359">)</span>&nbsp;<span class="op" id="5540361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540364">n</span>&nbsp;<span class="op" id="5540366">:=</span>&nbsp;<span class="op" id="5540369">&amp;</span><span class="ident" id="5540370">NumberNode</span><span class="op" id="5540380">{</span><span class="ident" id="5540381">tr</span><span class="op" id="5540383">:</span>&nbsp;<span class="ident" id="5540385">t</span><span class="op" id="5540386">,</span>&nbsp;<span class="ident" id="5540388">NodeType</span><span class="op" id="5540396">:</span>&nbsp;<span class="ident" id="5540398">NodeNumber</span><span class="op" id="5540408">,</span>&nbsp;<span class="ident" id="5540410">Pos</span><span class="op" id="5540413">:</span>&nbsp;<span class="ident" id="5540415">pos</span><span class="op" id="5540418">,</span>&nbsp;<span class="ident" id="5540420">Text</span><span class="op" id="5540424">:</span>&nbsp;<span class="ident" id="5540426">text</span><span class="op" id="5540430">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540433">switch</span>&nbsp;<span class="ident" id="5540440">typ</span>&nbsp;<span class="op" id="5540444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540447">case</span>&nbsp;<span class="ident" id="5540452">itemCharConstant</span><span class="op" id="5540468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5540472">rune</span><span class="op" id="5540476">,</span>&nbsp;<span class="ident" id="5540478">_</span><span class="op" id="5540479">,</span>&nbsp;<span class="ident" id="5540481">tail</span><span class="op" id="5540485">,</span>&nbsp;<span class="ident" id="5540487">err</span>&nbsp;<span class="op" id="5540491">:=</span>&nbsp;<span class="ident" id="5540494">strconv</span><span class="op" id="5540501">.</span><span class="ident" id="5540502">UnquoteChar</span><span class="op" id="5540513">(</span><span class="ident" id="5540514">text</span><span class="op" id="5540518">[</span><span class="num" id="5540519">1</span><span class="op" id="5540520">:</span><span class="op" id="5540521">]</span><span class="op" id="5540522">,</span>&nbsp;<span class="ident" id="5540524">text</span><span class="op" id="5540528">[</span><span class="num" id="5540529">0</span><span class="op" id="5540530">]</span><span class="op" id="5540531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540535">if</span>&nbsp;<span class="ident" id="5540538">err</span>&nbsp;<span class="op" id="5540542">!=</span>&nbsp;<span class="ident" id="5540545">nil</span>&nbsp;<span class="op" id="5540549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540554">return</span>&nbsp;<span class="ident" id="5540561">nil</span><span class="op" id="5540564">,</span>&nbsp;<span class="ident" id="5540566">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540576">if</span>&nbsp;<span class="ident" id="5540579">tail</span>&nbsp;<span class="op" id="5540584">!=</span>&nbsp;<span class="string" id="5540587">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="5540591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540596">return</span>&nbsp;<span class="ident" id="5540603">nil</span><span class="op" id="5540606">,</span>&nbsp;<span class="ident" id="5540608">fmt</span><span class="op" id="5540611">.</span><span class="ident" id="5540612">Errorf</span><span class="op" id="5540618">(</span><span class="string" id="5540619">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="5540653">,</span>&nbsp;<span class="ident" id="5540655">text</span><span class="op" id="5540659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5540663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540667">n</span><span class="op" id="5540668">.</span><span class="ident" id="5540669">Int64</span>&nbsp;<span class="op" id="5540675">=</span>&nbsp;<span class="ident" id="5540677">int64</span><span class="op" id="5540682">(</span><span class="builtintype" id="5540683">rune</span><span class="op" id="5540687">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540691">n</span><span class="op" id="5540692">.</span><span class="ident" id="5540693">IsInt</span>&nbsp;<span class="op" id="5540699">=</span>&nbsp;<span class="builtintype" id="5540701">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540708">n</span><span class="op" id="5540709">.</span><span class="ident" id="5540710">Uint64</span>&nbsp;<span class="op" id="5540717">=</span>&nbsp;<span class="ident" id="5540719">uint64</span><span class="op" id="5540725">(</span><span class="builtintype" id="5540726">rune</span><span class="op" id="5540730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540734">n</span><span class="op" id="5540735">.</span><span class="ident" id="5540736">IsUint</span>&nbsp;<span class="op" id="5540743">=</span>&nbsp;<span class="builtintype" id="5540745">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540752">n</span><span class="op" id="5540753">.</span><span class="ident" id="5540754">Float64</span>&nbsp;<span class="op" id="5540762">=</span>&nbsp;<span class="builtintype" id="5540764">float64</span><span class="op" id="5540771">(</span><span class="builtintype" id="5540772">rune</span><span class="op" id="5540776">)</span>&nbsp;<span class="comment" id="5540778">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5540812">n</span><span class="op" id="5540813">.</span><span class="ident" id="5540814">IsFloat</span>&nbsp;<span class="op" id="5540822">=</span>&nbsp;<span class="builtintype" id="5540824">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540831">return</span>&nbsp;<span class="ident" id="5540838">n</span><span class="op" id="5540839">,</span>&nbsp;<span class="ident" id="5540841">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540846">case</span>&nbsp;<span class="ident" id="5540851">itemComplex</span><span class="op" id="5540862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5540866">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540924">if</span>&nbsp;<span class="ident" id="5540927">_</span><span class="op" id="5540928">,</span>&nbsp;<span class="ident" id="5540930">err</span>&nbsp;<span class="op" id="5540934">:=</span>&nbsp;<span class="ident" id="5540937">fmt</span><span class="op" id="5540940">.</span><span class="ident" id="5540941">Sscan</span><span class="op" id="5540946">(</span><span class="ident" id="5540947">text</span><span class="op" id="5540951">,</span>&nbsp;<span class="op" id="5540953">&amp;</span><span class="ident" id="5540954">n</span><span class="op" id="5540955">.</span><span class="ident" id="5540956">Complex128</span><span class="op" id="5540966">)</span><span class="op" id="5540967">;</span>&nbsp;<span class="ident" id="5540969">err</span>&nbsp;<span class="op" id="5540973">!=</span>&nbsp;<span class="ident" id="5540976">nil</span>&nbsp;<span class="op" id="5540980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5540985">return</span>&nbsp;<span class="ident" id="5540992">nil</span><span class="op" id="5540995">,</span>&nbsp;<span class="ident" id="5540997">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541007">n</span><span class="op" id="5541008">.</span><span class="ident" id="5541009">IsComplex</span>&nbsp;<span class="op" id="5541019">=</span>&nbsp;<span class="builtintype" id="5541021">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541028">n</span><span class="op" id="5541029">.</span><span class="ident" id="5541030">simplifyComplex</span><span class="op" id="5541045">(</span><span class="op" id="5541046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541050">return</span>&nbsp;<span class="ident" id="5541057">n</span><span class="op" id="5541058">,</span>&nbsp;<span class="ident" id="5541060">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541065">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5541068">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541134">if</span>&nbsp;<span class="builtinfunc" id="5541137">len</span><span class="op" id="5541140">(</span><span class="ident" id="5541141">text</span><span class="op" id="5541145">)</span>&nbsp;<span class="op" id="5541147">&gt;</span>&nbsp;<span class="num" id="5541149">0</span>&nbsp;<span class="op" id="5541151">&amp;&amp;</span>&nbsp;<span class="ident" id="5541154">text</span><span class="op" id="5541158">[</span><span class="builtinfunc" id="5541159">len</span><span class="op" id="5541162">(</span><span class="ident" id="5541163">text</span><span class="op" id="5541167">)</span><span class="op" id="5541168">-</span><span class="num" id="5541169">1</span><span class="op" id="5541170">]</span>&nbsp;<span class="op" id="5541172">==</span>&nbsp;<span class="string" id="5541175">&#39;i&#39;</span>&nbsp;<span class="op" id="5541179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541183">f</span><span class="op" id="5541184">,</span>&nbsp;<span class="ident" id="5541186">err</span>&nbsp;<span class="op" id="5541190">:=</span>&nbsp;<span class="ident" id="5541193">strconv</span><span class="op" id="5541200">.</span><span class="ident" id="5541201">ParseFloat</span><span class="op" id="5541211">(</span><span class="ident" id="5541212">text</span><span class="op" id="5541216">[</span><span class="op" id="5541217">:</span><span class="builtinfunc" id="5541218">len</span><span class="op" id="5541221">(</span><span class="ident" id="5541222">text</span><span class="op" id="5541226">)</span><span class="op" id="5541227">-</span><span class="num" id="5541228">1</span><span class="op" id="5541229">]</span><span class="op" id="5541230">,</span>&nbsp;<span class="num" id="5541232">64</span><span class="op" id="5541234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541238">if</span>&nbsp;<span class="ident" id="5541241">err</span>&nbsp;<span class="op" id="5541245">==</span>&nbsp;<span class="ident" id="5541248">nil</span>&nbsp;<span class="op" id="5541252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541257">n</span><span class="op" id="5541258">.</span><span class="ident" id="5541259">IsComplex</span>&nbsp;<span class="op" id="5541269">=</span>&nbsp;<span class="builtintype" id="5541271">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541279">n</span><span class="op" id="5541280">.</span><span class="ident" id="5541281">Complex128</span>&nbsp;<span class="op" id="5541292">=</span>&nbsp;<span class="builtinfunc" id="5541294">complex</span><span class="op" id="5541301">(</span><span class="num" id="5541302">0</span><span class="op" id="5541303">,</span>&nbsp;<span class="ident" id="5541305">f</span><span class="op" id="5541306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541311">n</span><span class="op" id="5541312">.</span><span class="ident" id="5541313">simplifyComplex</span><span class="op" id="5541328">(</span><span class="op" id="5541329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541334">return</span>&nbsp;<span class="ident" id="5541341">n</span><span class="op" id="5541342">,</span>&nbsp;<span class="ident" id="5541344">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541353">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5541356">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541403">u</span><span class="op" id="5541404">,</span>&nbsp;<span class="ident" id="5541406">err</span>&nbsp;<span class="op" id="5541410">:=</span>&nbsp;<span class="ident" id="5541413">strconv</span><span class="op" id="5541420">.</span><span class="ident" id="5541421">ParseUint</span><span class="op" id="5541430">(</span><span class="ident" id="5541431">text</span><span class="op" id="5541435">,</span>&nbsp;<span class="num" id="5541437">0</span><span class="op" id="5541438">,</span>&nbsp;<span class="num" id="5541440">64</span><span class="op" id="5541442">)</span>&nbsp;<span class="comment" id="5541444">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541479">if</span>&nbsp;<span class="ident" id="5541482">err</span>&nbsp;<span class="op" id="5541486">==</span>&nbsp;<span class="ident" id="5541489">nil</span>&nbsp;<span class="op" id="5541493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541497">n</span><span class="op" id="5541498">.</span><span class="ident" id="5541499">IsUint</span>&nbsp;<span class="op" id="5541506">=</span>&nbsp;<span class="builtintype" id="5541508">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541515">n</span><span class="op" id="5541516">.</span><span class="ident" id="5541517">Uint64</span>&nbsp;<span class="op" id="5541524">=</span>&nbsp;<span class="ident" id="5541526">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541532">i</span><span class="op" id="5541533">,</span>&nbsp;<span class="ident" id="5541535">err</span>&nbsp;<span class="op" id="5541539">:=</span>&nbsp;<span class="ident" id="5541542">strconv</span><span class="op" id="5541549">.</span><span class="ident" id="5541550">ParseInt</span><span class="op" id="5541558">(</span><span class="ident" id="5541559">text</span><span class="op" id="5541563">,</span>&nbsp;<span class="num" id="5541565">0</span><span class="op" id="5541566">,</span>&nbsp;<span class="num" id="5541568">64</span><span class="op" id="5541570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541573">if</span>&nbsp;<span class="ident" id="5541576">err</span>&nbsp;<span class="op" id="5541580">==</span>&nbsp;<span class="ident" id="5541583">nil</span>&nbsp;<span class="op" id="5541587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541591">n</span><span class="op" id="5541592">.</span><span class="ident" id="5541593">IsInt</span>&nbsp;<span class="op" id="5541599">=</span>&nbsp;<span class="builtintype" id="5541601">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541608">n</span><span class="op" id="5541609">.</span><span class="ident" id="5541610">Int64</span>&nbsp;<span class="op" id="5541616">=</span>&nbsp;<span class="ident" id="5541618">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541622">if</span>&nbsp;<span class="ident" id="5541625">i</span>&nbsp;<span class="op" id="5541627">==</span>&nbsp;<span class="num" id="5541630">0</span>&nbsp;<span class="op" id="5541632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541637">n</span><span class="op" id="5541638">.</span><span class="ident" id="5541639">IsUint</span>&nbsp;<span class="op" id="5541646">=</span>&nbsp;<span class="builtintype" id="5541648">true</span>&nbsp;<span class="comment" id="5541653">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541674">n</span><span class="op" id="5541675">.</span><span class="ident" id="5541676">Uint64</span>&nbsp;<span class="op" id="5541683">=</span>&nbsp;<span class="ident" id="5541685">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541692">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5541695">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541754">if</span>&nbsp;<span class="ident" id="5541757">n</span><span class="op" id="5541758">.</span><span class="ident" id="5541759">IsInt</span>&nbsp;<span class="op" id="5541765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541769">n</span><span class="op" id="5541770">.</span><span class="ident" id="5541771">IsFloat</span>&nbsp;<span class="op" id="5541779">=</span>&nbsp;<span class="builtintype" id="5541781">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541788">n</span><span class="op" id="5541789">.</span><span class="ident" id="5541790">Float64</span>&nbsp;<span class="op" id="5541798">=</span>&nbsp;<span class="builtintype" id="5541800">float64</span><span class="op" id="5541807">(</span><span class="ident" id="5541808">n</span><span class="op" id="5541809">.</span><span class="ident" id="5541810">Int64</span><span class="op" id="5541815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541818">}</span>&nbsp;<span class="keyword" id="5541820">else</span>&nbsp;<span class="keyword" id="5541825">if</span>&nbsp;<span class="ident" id="5541828">n</span><span class="op" id="5541829">.</span><span class="ident" id="5541830">IsUint</span>&nbsp;<span class="op" id="5541837">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541841">n</span><span class="op" id="5541842">.</span><span class="ident" id="5541843">IsFloat</span>&nbsp;<span class="op" id="5541851">=</span>&nbsp;<span class="builtintype" id="5541853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541860">n</span><span class="op" id="5541861">.</span><span class="ident" id="5541862">Float64</span>&nbsp;<span class="op" id="5541870">=</span>&nbsp;<span class="builtintype" id="5541872">float64</span><span class="op" id="5541879">(</span><span class="ident" id="5541880">n</span><span class="op" id="5541881">.</span><span class="ident" id="5541882">Uint64</span><span class="op" id="5541888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5541891">}</span>&nbsp;<span class="keyword" id="5541893">else</span>&nbsp;<span class="op" id="5541898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541902">f</span><span class="op" id="5541903">,</span>&nbsp;<span class="ident" id="5541905">err</span>&nbsp;<span class="op" id="5541909">:=</span>&nbsp;<span class="ident" id="5541912">strconv</span><span class="op" id="5541919">.</span><span class="ident" id="5541920">ParseFloat</span><span class="op" id="5541930">(</span><span class="ident" id="5541931">text</span><span class="op" id="5541935">,</span>&nbsp;<span class="num" id="5541937">64</span><span class="op" id="5541939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5541943">if</span>&nbsp;<span class="ident" id="5541946">err</span>&nbsp;<span class="op" id="5541950">==</span>&nbsp;<span class="ident" id="5541953">nil</span>&nbsp;<span class="op" id="5541957">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541962">n</span><span class="op" id="5541963">.</span><span class="ident" id="5541964">IsFloat</span>&nbsp;<span class="op" id="5541972">=</span>&nbsp;<span class="builtintype" id="5541974">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5541982">n</span><span class="op" id="5541983">.</span><span class="ident" id="5541984">Float64</span>&nbsp;<span class="op" id="5541992">=</span>&nbsp;<span class="ident" id="5541994">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5541999">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542074">if</span>&nbsp;<span class="op" id="5542077">!</span><span class="ident" id="5542078">n</span><span class="op" id="5542079">.</span><span class="ident" id="5542080">IsInt</span>&nbsp;<span class="op" id="5542086">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5542089">float64</span><span class="op" id="5542096">(</span><span class="ident" id="5542097">int64</span><span class="op" id="5542102">(</span><span class="ident" id="5542103">f</span><span class="op" id="5542104">)</span><span class="op" id="5542105">)</span>&nbsp;<span class="op" id="5542107">==</span>&nbsp;<span class="ident" id="5542110">f</span>&nbsp;<span class="op" id="5542112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542118">n</span><span class="op" id="5542119">.</span><span class="ident" id="5542120">IsInt</span>&nbsp;<span class="op" id="5542126">=</span>&nbsp;<span class="builtintype" id="5542128">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542137">n</span><span class="op" id="5542138">.</span><span class="ident" id="5542139">Int64</span>&nbsp;<span class="op" id="5542145">=</span>&nbsp;<span class="ident" id="5542147">int64</span><span class="op" id="5542152">(</span><span class="ident" id="5542153">f</span><span class="op" id="5542154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542164">if</span>&nbsp;<span class="op" id="5542167">!</span><span class="ident" id="5542168">n</span><span class="op" id="5542169">.</span><span class="ident" id="5542170">IsUint</span>&nbsp;<span class="op" id="5542177">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5542180">float64</span><span class="op" id="5542187">(</span><span class="ident" id="5542188">uint64</span><span class="op" id="5542194">(</span><span class="ident" id="5542195">f</span><span class="op" id="5542196">)</span><span class="op" id="5542197">)</span>&nbsp;<span class="op" id="5542199">==</span>&nbsp;<span class="ident" id="5542202">f</span>&nbsp;<span class="op" id="5542204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542210">n</span><span class="op" id="5542211">.</span><span class="ident" id="5542212">IsUint</span>&nbsp;<span class="op" id="5542219">=</span>&nbsp;<span class="builtintype" id="5542221">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542230">n</span><span class="op" id="5542231">.</span><span class="ident" id="5542232">Uint64</span>&nbsp;<span class="op" id="5542239">=</span>&nbsp;<span class="ident" id="5542241">uint64</span><span class="op" id="5542247">(</span><span class="ident" id="5542248">f</span><span class="op" id="5542249">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542264">if</span>&nbsp;<span class="op" id="5542267">!</span><span class="ident" id="5542268">n</span><span class="op" id="5542269">.</span><span class="ident" id="5542270">IsInt</span>&nbsp;<span class="op" id="5542276">&amp;&amp;</span>&nbsp;<span class="op" id="5542279">!</span><span class="ident" id="5542280">n</span><span class="op" id="5542281">.</span><span class="ident" id="5542282">IsUint</span>&nbsp;<span class="op" id="5542289">&amp;&amp;</span>&nbsp;<span class="op" id="5542292">!</span><span class="ident" id="5542293">n</span><span class="op" id="5542294">.</span><span class="ident" id="5542295">IsFloat</span>&nbsp;<span class="op" id="5542303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542307">return</span>&nbsp;<span class="ident" id="5542314">nil</span><span class="op" id="5542317">,</span>&nbsp;<span class="ident" id="5542319">fmt</span><span class="op" id="5542322">.</span><span class="ident" id="5542323">Errorf</span><span class="op" id="5542329">(</span><span class="string" id="5542330">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="5542357">,</span>&nbsp;<span class="ident" id="5542359">text</span><span class="op" id="5542363">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542369">return</span>&nbsp;<span class="ident" id="5542376">n</span><span class="op" id="5542377">,</span>&nbsp;<span class="ident" id="5542379">nil</span><br>
<span class="lineno"></span><span class="op" id="5542383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5542386">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="5542475">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="5542529">func</span>&nbsp;<span class="op" id="5542534">(</span><span class="ident" id="5542535">n</span>&nbsp;<span class="op" id="5542537">*</span><span class="ident" id="5542538">NumberNode</span><span class="op" id="5542548">)</span>&nbsp;<span class="ident" id="5542550">simplifyComplex</span><span class="op" id="5542565">(</span><span class="op" id="5542566">)</span>&nbsp;<span class="op" id="5542568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542571">n</span><span class="op" id="5542572">.</span><span class="ident" id="5542573">IsFloat</span>&nbsp;<span class="op" id="5542581">=</span>&nbsp;<span class="builtinfunc" id="5542583">imag</span><span class="op" id="5542587">(</span><span class="ident" id="5542588">n</span><span class="op" id="5542589">.</span><span class="ident" id="5542590">Complex128</span><span class="op" id="5542600">)</span>&nbsp;<span class="op" id="5542602">==</span>&nbsp;<span class="num" id="5542605">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542608">if</span>&nbsp;<span class="ident" id="5542611">n</span><span class="op" id="5542612">.</span><span class="ident" id="5542613">IsFloat</span>&nbsp;<span class="op" id="5542621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542625">n</span><span class="op" id="5542626">.</span><span class="ident" id="5542627">Float64</span>&nbsp;<span class="op" id="5542635">=</span>&nbsp;<span class="builtinfunc" id="5542637">real</span><span class="op" id="5542641">(</span><span class="ident" id="5542642">n</span><span class="op" id="5542643">.</span><span class="ident" id="5542644">Complex128</span><span class="op" id="5542654">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542658">n</span><span class="op" id="5542659">.</span><span class="ident" id="5542660">IsInt</span>&nbsp;<span class="op" id="5542666">=</span>&nbsp;<span class="builtintype" id="5542668">float64</span><span class="op" id="5542675">(</span><span class="ident" id="5542676">int64</span><span class="op" id="5542681">(</span><span class="ident" id="5542682">n</span><span class="op" id="5542683">.</span><span class="ident" id="5542684">Float64</span><span class="op" id="5542691">)</span><span class="op" id="5542692">)</span>&nbsp;<span class="op" id="5542694">==</span>&nbsp;<span class="ident" id="5542697">n</span><span class="op" id="5542698">.</span><span class="ident" id="5542699">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542709">if</span>&nbsp;<span class="ident" id="5542712">n</span><span class="op" id="5542713">.</span><span class="ident" id="5542714">IsInt</span>&nbsp;<span class="op" id="5542720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542725">n</span><span class="op" id="5542726">.</span><span class="ident" id="5542727">Int64</span>&nbsp;<span class="op" id="5542733">=</span>&nbsp;<span class="ident" id="5542735">int64</span><span class="op" id="5542740">(</span><span class="ident" id="5542741">n</span><span class="op" id="5542742">.</span><span class="ident" id="5542743">Float64</span><span class="op" id="5542750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542758">n</span><span class="op" id="5542759">.</span><span class="ident" id="5542760">IsUint</span>&nbsp;<span class="op" id="5542767">=</span>&nbsp;<span class="builtintype" id="5542769">float64</span><span class="op" id="5542776">(</span><span class="ident" id="5542777">uint64</span><span class="op" id="5542783">(</span><span class="ident" id="5542784">n</span><span class="op" id="5542785">.</span><span class="ident" id="5542786">Float64</span><span class="op" id="5542793">)</span><span class="op" id="5542794">)</span>&nbsp;<span class="op" id="5542796">==</span>&nbsp;<span class="ident" id="5542799">n</span><span class="op" id="5542800">.</span><span class="ident" id="5542801">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542811">if</span>&nbsp;<span class="ident" id="5542814">n</span><span class="op" id="5542815">.</span><span class="ident" id="5542816">IsUint</span>&nbsp;<span class="op" id="5542823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5542828">n</span><span class="op" id="5542829">.</span><span class="ident" id="5542830">Uint64</span>&nbsp;<span class="op" id="5542837">=</span>&nbsp;<span class="ident" id="5542839">uint64</span><span class="op" id="5542845">(</span><span class="ident" id="5542846">n</span><span class="op" id="5542847">.</span><span class="ident" id="5542848">Float64</span><span class="op" id="5542855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5542862">}</span><br>
<span class="lineno"></span><span class="op" id="5542864">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="5542867">func</span>&nbsp;<span class="op" id="5542872">(</span><span class="ident" id="5542873">n</span>&nbsp;<span class="op" id="5542875">*</span><span class="ident" id="5542876">NumberNode</span><span class="op" id="5542886">)</span>&nbsp;<span class="ident" id="5542888">String</span><span class="op" id="5542894">(</span><span class="op" id="5542895">)</span>&nbsp;<span class="builtintype" id="5542897">string</span>&nbsp;<span class="op" id="5542904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542907">return</span>&nbsp;<span class="ident" id="5542914">n</span><span class="op" id="5542915">.</span><span class="ident" id="5542916">Text</span><br>
<span class="lineno"></span><span class="op" id="5542921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="5542924">func</span>&nbsp;<span class="op" id="5542929">(</span><span class="ident" id="5542930">n</span>&nbsp;<span class="op" id="5542932">*</span><span class="ident" id="5542933">NumberNode</span><span class="op" id="5542943">)</span>&nbsp;<span class="ident" id="5542945">tree</span><span class="op" id="5542949">(</span><span class="op" id="5542950">)</span>&nbsp;<span class="op" id="5542952">*</span><span class="ident" id="5542953">Tree</span>&nbsp;<span class="op" id="5542958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5542961">return</span>&nbsp;<span class="ident" id="5542968">n</span><span class="op" id="5542969">.</span><span class="ident" id="5542970">tr</span><br>
<span class="lineno"></span><span class="op" id="5542973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5542976">func</span>&nbsp;<span class="op" id="5542981">(</span><span class="ident" id="5542982">n</span>&nbsp;<span class="op" id="5542984">*</span><span class="ident" id="5542985">NumberNode</span><span class="op" id="5542995">)</span>&nbsp;<span class="ident" id="5542997">Copy</span><span class="op" id="5543001">(</span><span class="op" id="5543002">)</span>&nbsp;<span class="ident" id="5543004">Node</span>&nbsp;<span class="op" id="5543009">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543012">nn</span>&nbsp;<span class="op" id="5543015">:=</span>&nbsp;<span class="builtinfunc" id="5543018">new</span><span class="op" id="5543021">(</span><span class="ident" id="5543022">NumberNode</span><span class="op" id="5543032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5543035">*</span><span class="ident" id="5543036">nn</span>&nbsp;<span class="op" id="5543039">=</span>&nbsp;<span class="op" id="5543041">*</span><span class="ident" id="5543042">n</span>&nbsp;<span class="comment" id="5543044">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543069">return</span>&nbsp;<span class="ident" id="5543076">nn</span><br>
<span class="lineno"></span><span class="op" id="5543079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="5543082">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5543152">type</span>&nbsp;<span class="ident" id="5543157">StringNode</span>&nbsp;<span class="keyword" id="5543168">struct</span>&nbsp;<span class="op" id="5543175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543178">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543188">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543193">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5543200">*</span><span class="ident" id="5543201">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543207">Quoted</span>&nbsp;<span class="builtintype" id="5543214">string</span>&nbsp;<span class="comment" id="5543221">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543271">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5543278">string</span>&nbsp;<span class="comment" id="5543285">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="5543324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5543327">func</span>&nbsp;<span class="op" id="5543332">(</span><span class="ident" id="5543333">t</span>&nbsp;<span class="op" id="5543335">*</span><span class="ident" id="5543336">Tree</span><span class="op" id="5543340">)</span>&nbsp;<span class="ident" id="5543342">newString</span><span class="op" id="5543351">(</span><span class="ident" id="5543352">pos</span>&nbsp;<span class="ident" id="5543356">Pos</span><span class="op" id="5543359">,</span>&nbsp;<span class="ident" id="5543361">orig</span><span class="op" id="5543365">,</span>&nbsp;<span class="ident" id="5543367">text</span>&nbsp;<span class="builtintype" id="5543372">string</span><span class="op" id="5543378">)</span>&nbsp;<span class="op" id="5543380">*</span><span class="ident" id="5543381">StringNode</span>&nbsp;<span class="op" id="5543392">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543395">return</span>&nbsp;<span class="op" id="5543402">&amp;</span><span class="ident" id="5543403">StringNode</span><span class="op" id="5543413">{</span><span class="ident" id="5543414">tr</span><span class="op" id="5543416">:</span>&nbsp;<span class="ident" id="5543418">t</span><span class="op" id="5543419">,</span>&nbsp;<span class="ident" id="5543421">NodeType</span><span class="op" id="5543429">:</span>&nbsp;<span class="ident" id="5543431">NodeString</span><span class="op" id="5543441">,</span>&nbsp;<span class="ident" id="5543443">Pos</span><span class="op" id="5543446">:</span>&nbsp;<span class="ident" id="5543448">pos</span><span class="op" id="5543451">,</span>&nbsp;<span class="ident" id="5543453">Quoted</span><span class="op" id="5543459">:</span>&nbsp;<span class="ident" id="5543461">orig</span><span class="op" id="5543465">,</span>&nbsp;<span class="ident" id="5543467">Text</span><span class="op" id="5543471">:</span>&nbsp;<span class="ident" id="5543473">text</span><span class="op" id="5543477">}</span><br>
<span class="lineno"></span><span class="op" id="5543479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5543482">func</span>&nbsp;<span class="op" id="5543487">(</span><span class="ident" id="5543488">s</span>&nbsp;<span class="op" id="5543490">*</span><span class="ident" id="5543491">StringNode</span><span class="op" id="5543501">)</span>&nbsp;<span class="ident" id="5543503">String</span><span class="op" id="5543509">(</span><span class="op" id="5543510">)</span>&nbsp;<span class="builtintype" id="5543512">string</span>&nbsp;<span class="op" id="5543519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543522">return</span>&nbsp;<span class="ident" id="5543529">s</span><span class="op" id="5543530">.</span><span class="ident" id="5543531">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="5543538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5543541">func</span>&nbsp;<span class="op" id="5543546">(</span><span class="ident" id="5543547">s</span>&nbsp;<span class="op" id="5543549">*</span><span class="ident" id="5543550">StringNode</span><span class="op" id="5543560">)</span>&nbsp;<span class="ident" id="5543562">tree</span><span class="op" id="5543566">(</span><span class="op" id="5543567">)</span>&nbsp;<span class="op" id="5543569">*</span><span class="ident" id="5543570">Tree</span>&nbsp;<span class="op" id="5543575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543578">return</span>&nbsp;<span class="ident" id="5543585">s</span><span class="op" id="5543586">.</span><span class="ident" id="5543587">tr</span><br>
<span class="lineno"></span><span class="op" id="5543590">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="5543593">func</span>&nbsp;<span class="op" id="5543598">(</span><span class="ident" id="5543599">s</span>&nbsp;<span class="op" id="5543601">*</span><span class="ident" id="5543602">StringNode</span><span class="op" id="5543612">)</span>&nbsp;<span class="ident" id="5543614">Copy</span><span class="op" id="5543618">(</span><span class="op" id="5543619">)</span>&nbsp;<span class="ident" id="5543621">Node</span>&nbsp;<span class="op" id="5543626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543629">return</span>&nbsp;<span class="ident" id="5543636">s</span><span class="op" id="5543637">.</span><span class="ident" id="5543638">tr</span><span class="op" id="5543640">.</span><span class="ident" id="5543641">newString</span><span class="op" id="5543650">(</span><span class="ident" id="5543651">s</span><span class="op" id="5543652">.</span><span class="ident" id="5543653">Pos</span><span class="op" id="5543656">,</span>&nbsp;<span class="ident" id="5543658">s</span><span class="op" id="5543659">.</span><span class="ident" id="5543660">Quoted</span><span class="op" id="5543666">,</span>&nbsp;<span class="ident" id="5543668">s</span><span class="op" id="5543669">.</span><span class="ident" id="5543670">Text</span><span class="op" id="5543674">)</span><br>
<span class="lineno"></span><span class="op" id="5543676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5543679">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="5543720">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="5543767">type</span>&nbsp;<span class="ident" id="5543772">endNode</span>&nbsp;<span class="keyword" id="5543780">struct</span>&nbsp;<span class="op" id="5543787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543790">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543800">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5543805">tr</span>&nbsp;<span class="op" id="5543808">*</span><span class="ident" id="5543809">Tree</span><br>
<span class="lineno"></span><span class="op" id="5543814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5543817">func</span>&nbsp;<span class="op" id="5543822">(</span><span class="ident" id="5543823">t</span>&nbsp;<span class="op" id="5543825">*</span><span class="ident" id="5543826">Tree</span><span class="op" id="5543830">)</span>&nbsp;<span class="ident" id="5543832">newEnd</span><span class="op" id="5543838">(</span><span class="ident" id="5543839">pos</span>&nbsp;<span class="ident" id="5543843">Pos</span><span class="op" id="5543846">)</span>&nbsp;<span class="op" id="5543848">*</span><span class="ident" id="5543849">endNode</span>&nbsp;<span class="op" id="5543857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543860">return</span>&nbsp;<span class="op" id="5543867">&amp;</span><span class="ident" id="5543868">endNode</span><span class="op" id="5543875">{</span><span class="ident" id="5543876">tr</span><span class="op" id="5543878">:</span>&nbsp;<span class="ident" id="5543880">t</span><span class="op" id="5543881">,</span>&nbsp;<span class="ident" id="5543883">NodeType</span><span class="op" id="5543891">:</span>&nbsp;<span class="ident" id="5543893">nodeEnd</span><span class="op" id="5543900">,</span>&nbsp;<span class="ident" id="5543902">Pos</span><span class="op" id="5543905">:</span>&nbsp;<span class="ident" id="5543907">pos</span><span class="op" id="5543910">}</span><br>
<span class="lineno">680</span><span class="op" id="5543912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5543915">func</span>&nbsp;<span class="op" id="5543920">(</span><span class="ident" id="5543921">e</span>&nbsp;<span class="op" id="5543923">*</span><span class="ident" id="5543924">endNode</span><span class="op" id="5543931">)</span>&nbsp;<span class="ident" id="5543933">String</span><span class="op" id="5543939">(</span><span class="op" id="5543940">)</span>&nbsp;<span class="builtintype" id="5543942">string</span>&nbsp;<span class="op" id="5543949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5543952">return</span>&nbsp;<span class="string" id="5543959">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="5543969">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="5543972">func</span>&nbsp;<span class="op" id="5543977">(</span><span class="ident" id="5543978">e</span>&nbsp;<span class="op" id="5543980">*</span><span class="ident" id="5543981">endNode</span><span class="op" id="5543988">)</span>&nbsp;<span class="ident" id="5543990">tree</span><span class="op" id="5543994">(</span><span class="op" id="5543995">)</span>&nbsp;<span class="op" id="5543997">*</span><span class="ident" id="5543998">Tree</span>&nbsp;<span class="op" id="5544003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544006">return</span>&nbsp;<span class="ident" id="5544013">e</span><span class="op" id="5544014">.</span><span class="ident" id="5544015">tr</span><br>
<span class="lineno"></span><span class="op" id="5544018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="5544021">func</span>&nbsp;<span class="op" id="5544026">(</span><span class="ident" id="5544027">e</span>&nbsp;<span class="op" id="5544029">*</span><span class="ident" id="5544030">endNode</span><span class="op" id="5544037">)</span>&nbsp;<span class="ident" id="5544039">Copy</span><span class="op" id="5544043">(</span><span class="op" id="5544044">)</span>&nbsp;<span class="ident" id="5544046">Node</span>&nbsp;<span class="op" id="5544051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544054">return</span>&nbsp;<span class="ident" id="5544061">e</span><span class="op" id="5544062">.</span><span class="ident" id="5544063">tr</span><span class="op" id="5544065">.</span><span class="ident" id="5544066">newEnd</span><span class="op" id="5544072">(</span><span class="ident" id="5544073">e</span><span class="op" id="5544074">.</span><span class="ident" id="5544075">Pos</span><span class="op" id="5544078">)</span><br>
<span class="lineno"></span><span class="op" id="5544080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5544083">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="5544161">type</span>&nbsp;<span class="ident" id="5544166">elseNode</span>&nbsp;<span class="keyword" id="5544175">struct</span>&nbsp;<span class="op" id="5544182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544185">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544195">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544200">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5544205">*</span><span class="ident" id="5544206">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544212">Line</span>&nbsp;<span class="builtintype" id="5544217">int</span>&nbsp;<span class="comment" id="5544221">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="5544290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5544293">func</span>&nbsp;<span class="op" id="5544298">(</span><span class="ident" id="5544299">t</span>&nbsp;<span class="op" id="5544301">*</span><span class="ident" id="5544302">Tree</span><span class="op" id="5544306">)</span>&nbsp;<span class="ident" id="5544308">newElse</span><span class="op" id="5544315">(</span><span class="ident" id="5544316">pos</span>&nbsp;<span class="ident" id="5544320">Pos</span><span class="op" id="5544323">,</span>&nbsp;<span class="ident" id="5544325">line</span>&nbsp;<span class="builtintype" id="5544330">int</span><span class="op" id="5544333">)</span>&nbsp;<span class="op" id="5544335">*</span><span class="ident" id="5544336">elseNode</span>&nbsp;<span class="op" id="5544345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544348">return</span>&nbsp;<span class="op" id="5544355">&amp;</span><span class="ident" id="5544356">elseNode</span><span class="op" id="5544364">{</span><span class="ident" id="5544365">tr</span><span class="op" id="5544367">:</span>&nbsp;<span class="ident" id="5544369">t</span><span class="op" id="5544370">,</span>&nbsp;<span class="ident" id="5544372">NodeType</span><span class="op" id="5544380">:</span>&nbsp;<span class="ident" id="5544382">nodeElse</span><span class="op" id="5544390">,</span>&nbsp;<span class="ident" id="5544392">Pos</span><span class="op" id="5544395">:</span>&nbsp;<span class="ident" id="5544397">pos</span><span class="op" id="5544400">,</span>&nbsp;<span class="ident" id="5544402">Line</span><span class="op" id="5544406">:</span>&nbsp;<span class="ident" id="5544408">line</span><span class="op" id="5544412">}</span><br>
<span class="lineno"></span><span class="op" id="5544414">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="5544417">func</span>&nbsp;<span class="op" id="5544422">(</span><span class="ident" id="5544423">e</span>&nbsp;<span class="op" id="5544425">*</span><span class="ident" id="5544426">elseNode</span><span class="op" id="5544434">)</span>&nbsp;<span class="ident" id="5544436">Type</span><span class="op" id="5544440">(</span><span class="op" id="5544441">)</span>&nbsp;<span class="ident" id="5544443">NodeType</span>&nbsp;<span class="op" id="5544452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544455">return</span>&nbsp;<span class="ident" id="5544462">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="5544471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="5544474">func</span>&nbsp;<span class="op" id="5544479">(</span><span class="ident" id="5544480">e</span>&nbsp;<span class="op" id="5544482">*</span><span class="ident" id="5544483">elseNode</span><span class="op" id="5544491">)</span>&nbsp;<span class="ident" id="5544493">String</span><span class="op" id="5544499">(</span><span class="op" id="5544500">)</span>&nbsp;<span class="builtintype" id="5544502">string</span>&nbsp;<span class="op" id="5544509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544512">return</span>&nbsp;<span class="string" id="5544519">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="5544530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5544533">func</span>&nbsp;<span class="op" id="5544538">(</span><span class="ident" id="5544539">e</span>&nbsp;<span class="op" id="5544541">*</span><span class="ident" id="5544542">elseNode</span><span class="op" id="5544550">)</span>&nbsp;<span class="ident" id="5544552">tree</span><span class="op" id="5544556">(</span><span class="op" id="5544557">)</span>&nbsp;<span class="op" id="5544559">*</span><span class="ident" id="5544560">Tree</span>&nbsp;<span class="op" id="5544565">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544568">return</span>&nbsp;<span class="ident" id="5544575">e</span><span class="op" id="5544576">.</span><span class="ident" id="5544577">tr</span><br>
<span class="lineno"></span><span class="op" id="5544580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5544583">func</span>&nbsp;<span class="op" id="5544588">(</span><span class="ident" id="5544589">e</span>&nbsp;<span class="op" id="5544591">*</span><span class="ident" id="5544592">elseNode</span><span class="op" id="5544600">)</span>&nbsp;<span class="ident" id="5544602">Copy</span><span class="op" id="5544606">(</span><span class="op" id="5544607">)</span>&nbsp;<span class="ident" id="5544609">Node</span>&nbsp;<span class="op" id="5544614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5544617">return</span>&nbsp;<span class="ident" id="5544624">e</span><span class="op" id="5544625">.</span><span class="ident" id="5544626">tr</span><span class="op" id="5544628">.</span><span class="ident" id="5544629">newElse</span><span class="op" id="5544636">(</span><span class="ident" id="5544637">e</span><span class="op" id="5544638">.</span><span class="ident" id="5544639">Pos</span><span class="op" id="5544642">,</span>&nbsp;<span class="ident" id="5544644">e</span><span class="op" id="5544645">.</span><span class="ident" id="5544646">Line</span><span class="op" id="5544650">)</span><br>
<span class="lineno">720</span><span class="op" id="5544652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5544655">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="5544722">type</span>&nbsp;<span class="ident" id="5544727">BranchNode</span>&nbsp;<span class="keyword" id="5544738">struct</span>&nbsp;<span class="op" id="5544745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544748">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544758">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544763">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544772">*</span><span class="ident" id="5544773">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544779">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5544788">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5544798">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544868">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544877">*</span><span class="ident" id="5544878">PipeNode</span>&nbsp;<span class="comment" id="5544887">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544921">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5544930">*</span><span class="ident" id="5544931">ListNode</span>&nbsp;<span class="comment" id="5544940">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5544987">ElseList</span>&nbsp;<span class="op" id="5544996">*</span><span class="ident" id="5544997">ListNode</span>&nbsp;<span class="comment" id="5545006">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="5545064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5545067">func</span>&nbsp;<span class="op" id="5545072">(</span><span class="ident" id="5545073">b</span>&nbsp;<span class="op" id="5545075">*</span><span class="ident" id="5545076">BranchNode</span><span class="op" id="5545086">)</span>&nbsp;<span class="ident" id="5545088">String</span><span class="op" id="5545094">(</span><span class="op" id="5545095">)</span>&nbsp;<span class="builtintype" id="5545097">string</span>&nbsp;<span class="op" id="5545104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545107">name</span>&nbsp;<span class="op" id="5545112">:=</span>&nbsp;<span class="string" id="5545115">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545119">switch</span>&nbsp;<span class="ident" id="5545126">b</span><span class="op" id="5545127">.</span><span class="ident" id="5545128">NodeType</span>&nbsp;<span class="op" id="5545137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545140">case</span>&nbsp;<span class="ident" id="5545145">NodeIf</span><span class="op" id="5545151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545155">name</span>&nbsp;<span class="op" id="5545160">=</span>&nbsp;<span class="string" id="5545162">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545168">case</span>&nbsp;<span class="ident" id="5545173">NodeRange</span><span class="op" id="5545182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545186">name</span>&nbsp;<span class="op" id="5545191">=</span>&nbsp;<span class="string" id="5545193">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545202">case</span>&nbsp;<span class="ident" id="5545207">NodeWith</span><span class="op" id="5545215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545219">name</span>&nbsp;<span class="op" id="5545224">=</span>&nbsp;<span class="string" id="5545226">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545234">default</span><span class="op" id="5545241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5545245">panic</span><span class="op" id="5545250">(</span><span class="string" id="5545251">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="5545272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545275">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545278">if</span>&nbsp;<span class="ident" id="5545281">b</span><span class="op" id="5545282">.</span><span class="ident" id="5545283">ElseList</span>&nbsp;<span class="op" id="5545292">!=</span>&nbsp;<span class="ident" id="5545295">nil</span>&nbsp;<span class="op" id="5545299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545303">return</span>&nbsp;<span class="ident" id="5545310">fmt</span><span class="op" id="5545313">.</span><span class="ident" id="5545314">Sprintf</span><span class="op" id="5545321">(</span><span class="string" id="5545322">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="5545352">,</span>&nbsp;<span class="ident" id="5545354">name</span><span class="op" id="5545358">,</span>&nbsp;<span class="ident" id="5545360">b</span><span class="op" id="5545361">.</span><span class="ident" id="5545362">Pipe</span><span class="op" id="5545366">,</span>&nbsp;<span class="ident" id="5545368">b</span><span class="op" id="5545369">.</span><span class="ident" id="5545370">List</span><span class="op" id="5545374">,</span>&nbsp;<span class="ident" id="5545376">b</span><span class="op" id="5545377">.</span><span class="ident" id="5545378">ElseList</span><span class="op" id="5545386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545392">return</span>&nbsp;<span class="ident" id="5545399">fmt</span><span class="op" id="5545402">.</span><span class="ident" id="5545403">Sprintf</span><span class="op" id="5545410">(</span><span class="string" id="5545411">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="5545431">,</span>&nbsp;<span class="ident" id="5545433">name</span><span class="op" id="5545437">,</span>&nbsp;<span class="ident" id="5545439">b</span><span class="op" id="5545440">.</span><span class="ident" id="5545441">Pipe</span><span class="op" id="5545445">,</span>&nbsp;<span class="ident" id="5545447">b</span><span class="op" id="5545448">.</span><span class="ident" id="5545449">List</span><span class="op" id="5545453">)</span><br>
<span class="lineno"></span><span class="op" id="5545455">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="5545458">func</span>&nbsp;<span class="op" id="5545463">(</span><span class="ident" id="5545464">b</span>&nbsp;<span class="op" id="5545466">*</span><span class="ident" id="5545467">BranchNode</span><span class="op" id="5545477">)</span>&nbsp;<span class="ident" id="5545479">tree</span><span class="op" id="5545483">(</span><span class="op" id="5545484">)</span>&nbsp;<span class="op" id="5545486">*</span><span class="ident" id="5545487">Tree</span>&nbsp;<span class="op" id="5545492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545495">return</span>&nbsp;<span class="ident" id="5545502">b</span><span class="op" id="5545503">.</span><span class="ident" id="5545504">tr</span><br>
<span class="lineno"></span><span class="op" id="5545507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="5545510">func</span>&nbsp;<span class="op" id="5545515">(</span><span class="ident" id="5545516">b</span>&nbsp;<span class="op" id="5545518">*</span><span class="ident" id="5545519">BranchNode</span><span class="op" id="5545529">)</span>&nbsp;<span class="ident" id="5545531">Copy</span><span class="op" id="5545535">(</span><span class="op" id="5545536">)</span>&nbsp;<span class="ident" id="5545538">Node</span>&nbsp;<span class="op" id="5545543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545546">switch</span>&nbsp;<span class="ident" id="5545553">b</span><span class="op" id="5545554">.</span><span class="ident" id="5545555">NodeType</span>&nbsp;<span class="op" id="5545564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545567">case</span>&nbsp;<span class="ident" id="5545572">NodeIf</span><span class="op" id="5545578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545582">return</span>&nbsp;<span class="ident" id="5545589">b</span><span class="op" id="5545590">.</span><span class="ident" id="5545591">tr</span><span class="op" id="5545593">.</span><span class="ident" id="5545594">newIf</span><span class="op" id="5545599">(</span><span class="ident" id="5545600">b</span><span class="op" id="5545601">.</span><span class="ident" id="5545602">Pos</span><span class="op" id="5545605">,</span>&nbsp;<span class="ident" id="5545607">b</span><span class="op" id="5545608">.</span><span class="ident" id="5545609">Line</span><span class="op" id="5545613">,</span>&nbsp;<span class="ident" id="5545615">b</span><span class="op" id="5545616">.</span><span class="ident" id="5545617">Pipe</span><span class="op" id="5545621">,</span>&nbsp;<span class="ident" id="5545623">b</span><span class="op" id="5545624">.</span><span class="ident" id="5545625">List</span><span class="op" id="5545629">,</span>&nbsp;<span class="ident" id="5545631">b</span><span class="op" id="5545632">.</span><span class="ident" id="5545633">ElseList</span><span class="op" id="5545641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545644">case</span>&nbsp;<span class="ident" id="5545649">NodeRange</span><span class="op" id="5545658">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545662">return</span>&nbsp;<span class="ident" id="5545669">b</span><span class="op" id="5545670">.</span><span class="ident" id="5545671">tr</span><span class="op" id="5545673">.</span><span class="ident" id="5545674">newRange</span><span class="op" id="5545682">(</span><span class="ident" id="5545683">b</span><span class="op" id="5545684">.</span><span class="ident" id="5545685">Pos</span><span class="op" id="5545688">,</span>&nbsp;<span class="ident" id="5545690">b</span><span class="op" id="5545691">.</span><span class="ident" id="5545692">Line</span><span class="op" id="5545696">,</span>&nbsp;<span class="ident" id="5545698">b</span><span class="op" id="5545699">.</span><span class="ident" id="5545700">Pipe</span><span class="op" id="5545704">,</span>&nbsp;<span class="ident" id="5545706">b</span><span class="op" id="5545707">.</span><span class="ident" id="5545708">List</span><span class="op" id="5545712">,</span>&nbsp;<span class="ident" id="5545714">b</span><span class="op" id="5545715">.</span><span class="ident" id="5545716">ElseList</span><span class="op" id="5545724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545727">case</span>&nbsp;<span class="ident" id="5545732">NodeWith</span><span class="op" id="5545740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545744">return</span>&nbsp;<span class="ident" id="5545751">b</span><span class="op" id="5545752">.</span><span class="ident" id="5545753">tr</span><span class="op" id="5545755">.</span><span class="ident" id="5545756">newWith</span><span class="op" id="5545763">(</span><span class="ident" id="5545764">b</span><span class="op" id="5545765">.</span><span class="ident" id="5545766">Pos</span><span class="op" id="5545769">,</span>&nbsp;<span class="ident" id="5545771">b</span><span class="op" id="5545772">.</span><span class="ident" id="5545773">Line</span><span class="op" id="5545777">,</span>&nbsp;<span class="ident" id="5545779">b</span><span class="op" id="5545780">.</span><span class="ident" id="5545781">Pipe</span><span class="op" id="5545785">,</span>&nbsp;<span class="ident" id="5545787">b</span><span class="op" id="5545788">.</span><span class="ident" id="5545789">List</span><span class="op" id="5545793">,</span>&nbsp;<span class="ident" id="5545795">b</span><span class="op" id="5545796">.</span><span class="ident" id="5545797">ElseList</span><span class="op" id="5545805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5545808">default</span><span class="op" id="5545815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5545819">panic</span><span class="op" id="5545824">(</span><span class="string" id="5545825">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="5545846">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5545849">}</span><br>
<span class="lineno"></span><span class="op" id="5545851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5545854">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5545910">type</span>&nbsp;<span class="ident" id="5545915">IfNode</span>&nbsp;<span class="keyword" id="5545922">struct</span>&nbsp;<span class="op" id="5545929">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5545932">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5545943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5545946">func</span>&nbsp;<span class="op" id="5545951">(</span><span class="ident" id="5545952">t</span>&nbsp;<span class="op" id="5545954">*</span><span class="ident" id="5545955">Tree</span><span class="op" id="5545959">)</span>&nbsp;<span class="ident" id="5545961">newIf</span><span class="op" id="5545966">(</span><span class="ident" id="5545967">pos</span>&nbsp;<span class="ident" id="5545971">Pos</span><span class="op" id="5545974">,</span>&nbsp;<span class="ident" id="5545976">line</span>&nbsp;<span class="builtintype" id="5545981">int</span><span class="op" id="5545984">,</span>&nbsp;<span class="ident" id="5545986">pipe</span>&nbsp;<span class="op" id="5545991">*</span><span class="ident" id="5545992">PipeNode</span><span class="op" id="5546000">,</span>&nbsp;<span class="ident" id="5546002">list</span><span class="op" id="5546006">,</span>&nbsp;<span class="ident" id="5546008">elseList</span>&nbsp;<span class="op" id="5546017">*</span><span class="ident" id="5546018">ListNode</span><span class="op" id="5546026">)</span>&nbsp;<span class="op" id="5546028">*</span><span class="ident" id="5546029">IfNode</span>&nbsp;<span class="op" id="5546036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546039">return</span>&nbsp;<span class="op" id="5546046">&amp;</span><span class="ident" id="5546047">IfNode</span><span class="op" id="5546053">{</span><span class="ident" id="5546054">BranchNode</span><span class="op" id="5546064">{</span><span class="ident" id="5546065">tr</span><span class="op" id="5546067">:</span>&nbsp;<span class="ident" id="5546069">t</span><span class="op" id="5546070">,</span>&nbsp;<span class="ident" id="5546072">NodeType</span><span class="op" id="5546080">:</span>&nbsp;<span class="ident" id="5546082">NodeIf</span><span class="op" id="5546088">,</span>&nbsp;<span class="ident" id="5546090">Pos</span><span class="op" id="5546093">:</span>&nbsp;<span class="ident" id="5546095">pos</span><span class="op" id="5546098">,</span>&nbsp;<span class="ident" id="5546100">Line</span><span class="op" id="5546104">:</span>&nbsp;<span class="ident" id="5546106">line</span><span class="op" id="5546110">,</span>&nbsp;<span class="ident" id="5546112">Pipe</span><span class="op" id="5546116">:</span>&nbsp;<span class="ident" id="5546118">pipe</span><span class="op" id="5546122">,</span>&nbsp;<span class="ident" id="5546124">List</span><span class="op" id="5546128">:</span>&nbsp;<span class="ident" id="5546130">list</span><span class="op" id="5546134">,</span>&nbsp;<span class="ident" id="5546136">ElseList</span><span class="op" id="5546144">:</span>&nbsp;<span class="ident" id="5546146">elseList</span><span class="op" id="5546154">}</span><span class="op" id="5546155">}</span><br>
<span class="lineno">775</span><span class="op" id="5546157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5546160">func</span>&nbsp;<span class="op" id="5546165">(</span><span class="ident" id="5546166">i</span>&nbsp;<span class="op" id="5546168">*</span><span class="ident" id="5546169">IfNode</span><span class="op" id="5546175">)</span>&nbsp;<span class="ident" id="5546177">Copy</span><span class="op" id="5546181">(</span><span class="op" id="5546182">)</span>&nbsp;<span class="ident" id="5546184">Node</span>&nbsp;<span class="op" id="5546189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546192">return</span>&nbsp;<span class="ident" id="5546199">i</span><span class="op" id="5546200">.</span><span class="ident" id="5546201">tr</span><span class="op" id="5546203">.</span><span class="ident" id="5546204">newIf</span><span class="op" id="5546209">(</span><span class="ident" id="5546210">i</span><span class="op" id="5546211">.</span><span class="ident" id="5546212">Pos</span><span class="op" id="5546215">,</span>&nbsp;<span class="ident" id="5546217">i</span><span class="op" id="5546218">.</span><span class="ident" id="5546219">Line</span><span class="op" id="5546223">,</span>&nbsp;<span class="ident" id="5546225">i</span><span class="op" id="5546226">.</span><span class="ident" id="5546227">Pipe</span><span class="op" id="5546231">.</span><span class="ident" id="5546232">CopyPipe</span><span class="op" id="5546240">(</span><span class="op" id="5546241">)</span><span class="op" id="5546242">,</span>&nbsp;<span class="ident" id="5546244">i</span><span class="op" id="5546245">.</span><span class="ident" id="5546246">List</span><span class="op" id="5546250">.</span><span class="ident" id="5546251">CopyList</span><span class="op" id="5546259">(</span><span class="op" id="5546260">)</span><span class="op" id="5546261">,</span>&nbsp;<span class="ident" id="5546263">i</span><span class="op" id="5546264">.</span><span class="ident" id="5546265">ElseList</span><span class="op" id="5546273">.</span><span class="ident" id="5546274">CopyList</span><span class="op" id="5546282">(</span><span class="op" id="5546283">)</span><span class="op" id="5546284">)</span><br>
<span class="lineno"></span><span class="op" id="5546286">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="5546289">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="5546350">type</span>&nbsp;<span class="ident" id="5546355">RangeNode</span>&nbsp;<span class="keyword" id="5546365">struct</span>&nbsp;<span class="op" id="5546372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546375">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5546386">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="5546389">func</span>&nbsp;<span class="op" id="5546394">(</span><span class="ident" id="5546395">t</span>&nbsp;<span class="op" id="5546397">*</span><span class="ident" id="5546398">Tree</span><span class="op" id="5546402">)</span>&nbsp;<span class="ident" id="5546404">newRange</span><span class="op" id="5546412">(</span><span class="ident" id="5546413">pos</span>&nbsp;<span class="ident" id="5546417">Pos</span><span class="op" id="5546420">,</span>&nbsp;<span class="ident" id="5546422">line</span>&nbsp;<span class="builtintype" id="5546427">int</span><span class="op" id="5546430">,</span>&nbsp;<span class="ident" id="5546432">pipe</span>&nbsp;<span class="op" id="5546437">*</span><span class="ident" id="5546438">PipeNode</span><span class="op" id="5546446">,</span>&nbsp;<span class="ident" id="5546448">list</span><span class="op" id="5546452">,</span>&nbsp;<span class="ident" id="5546454">elseList</span>&nbsp;<span class="op" id="5546463">*</span><span class="ident" id="5546464">ListNode</span><span class="op" id="5546472">)</span>&nbsp;<span class="op" id="5546474">*</span><span class="ident" id="5546475">RangeNode</span>&nbsp;<span class="op" id="5546485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546488">return</span>&nbsp;<span class="op" id="5546495">&amp;</span><span class="ident" id="5546496">RangeNode</span><span class="op" id="5546505">{</span><span class="ident" id="5546506">BranchNode</span><span class="op" id="5546516">{</span><span class="ident" id="5546517">tr</span><span class="op" id="5546519">:</span>&nbsp;<span class="ident" id="5546521">t</span><span class="op" id="5546522">,</span>&nbsp;<span class="ident" id="5546524">NodeType</span><span class="op" id="5546532">:</span>&nbsp;<span class="ident" id="5546534">NodeRange</span><span class="op" id="5546543">,</span>&nbsp;<span class="ident" id="5546545">Pos</span><span class="op" id="5546548">:</span>&nbsp;<span class="ident" id="5546550">pos</span><span class="op" id="5546553">,</span>&nbsp;<span class="ident" id="5546555">Line</span><span class="op" id="5546559">:</span>&nbsp;<span class="ident" id="5546561">line</span><span class="op" id="5546565">,</span>&nbsp;<span class="ident" id="5546567">Pipe</span><span class="op" id="5546571">:</span>&nbsp;<span class="ident" id="5546573">pipe</span><span class="op" id="5546577">,</span>&nbsp;<span class="ident" id="5546579">List</span><span class="op" id="5546583">:</span>&nbsp;<span class="ident" id="5546585">list</span><span class="op" id="5546589">,</span>&nbsp;<span class="ident" id="5546591">ElseList</span><span class="op" id="5546599">:</span>&nbsp;<span class="ident" id="5546601">elseList</span><span class="op" id="5546609">}</span><span class="op" id="5546610">}</span><br>
<span class="lineno"></span><span class="op" id="5546612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="5546615">func</span>&nbsp;<span class="op" id="5546620">(</span><span class="ident" id="5546621">r</span>&nbsp;<span class="op" id="5546623">*</span><span class="ident" id="5546624">RangeNode</span><span class="op" id="5546633">)</span>&nbsp;<span class="ident" id="5546635">Copy</span><span class="op" id="5546639">(</span><span class="op" id="5546640">)</span>&nbsp;<span class="ident" id="5546642">Node</span>&nbsp;<span class="op" id="5546647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546650">return</span>&nbsp;<span class="ident" id="5546657">r</span><span class="op" id="5546658">.</span><span class="ident" id="5546659">tr</span><span class="op" id="5546661">.</span><span class="ident" id="5546662">newRange</span><span class="op" id="5546670">(</span><span class="ident" id="5546671">r</span><span class="op" id="5546672">.</span><span class="ident" id="5546673">Pos</span><span class="op" id="5546676">,</span>&nbsp;<span class="ident" id="5546678">r</span><span class="op" id="5546679">.</span><span class="ident" id="5546680">Line</span><span class="op" id="5546684">,</span>&nbsp;<span class="ident" id="5546686">r</span><span class="op" id="5546687">.</span><span class="ident" id="5546688">Pipe</span><span class="op" id="5546692">.</span><span class="ident" id="5546693">CopyPipe</span><span class="op" id="5546701">(</span><span class="op" id="5546702">)</span><span class="op" id="5546703">,</span>&nbsp;<span class="ident" id="5546705">r</span><span class="op" id="5546706">.</span><span class="ident" id="5546707">List</span><span class="op" id="5546711">.</span><span class="ident" id="5546712">CopyList</span><span class="op" id="5546720">(</span><span class="op" id="5546721">)</span><span class="op" id="5546722">,</span>&nbsp;<span class="ident" id="5546724">r</span><span class="op" id="5546725">.</span><span class="ident" id="5546726">ElseList</span><span class="op" id="5546734">.</span><span class="ident" id="5546735">CopyList</span><span class="op" id="5546743">(</span><span class="op" id="5546744">)</span><span class="op" id="5546745">)</span><br>
<span class="lineno"></span><span class="op" id="5546747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5546750">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="5546809">type</span>&nbsp;<span class="ident" id="5546814">WithNode</span>&nbsp;<span class="keyword" id="5546823">struct</span>&nbsp;<span class="op" id="5546830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5546833">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="5546844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5546847">func</span>&nbsp;<span class="op" id="5546852">(</span><span class="ident" id="5546853">t</span>&nbsp;<span class="op" id="5546855">*</span><span class="ident" id="5546856">Tree</span><span class="op" id="5546860">)</span>&nbsp;<span class="ident" id="5546862">newWith</span><span class="op" id="5546869">(</span><span class="ident" id="5546870">pos</span>&nbsp;<span class="ident" id="5546874">Pos</span><span class="op" id="5546877">,</span>&nbsp;<span class="ident" id="5546879">line</span>&nbsp;<span class="builtintype" id="5546884">int</span><span class="op" id="5546887">,</span>&nbsp;<span class="ident" id="5546889">pipe</span>&nbsp;<span class="op" id="5546894">*</span><span class="ident" id="5546895">PipeNode</span><span class="op" id="5546903">,</span>&nbsp;<span class="ident" id="5546905">list</span><span class="op" id="5546909">,</span>&nbsp;<span class="ident" id="5546911">elseList</span>&nbsp;<span class="op" id="5546920">*</span><span class="ident" id="5546921">ListNode</span><span class="op" id="5546929">)</span>&nbsp;<span class="op" id="5546931">*</span><span class="ident" id="5546932">WithNode</span>&nbsp;<span class="op" id="5546941">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5546944">return</span>&nbsp;<span class="op" id="5546951">&amp;</span><span class="ident" id="5546952">WithNode</span><span class="op" id="5546960">{</span><span class="ident" id="5546961">BranchNode</span><span class="op" id="5546971">{</span><span class="ident" id="5546972">tr</span><span class="op" id="5546974">:</span>&nbsp;<span class="ident" id="5546976">t</span><span class="op" id="5546977">,</span>&nbsp;<span class="ident" id="5546979">NodeType</span><span class="op" id="5546987">:</span>&nbsp;<span class="ident" id="5546989">NodeWith</span><span class="op" id="5546997">,</span>&nbsp;<span class="ident" id="5546999">Pos</span><span class="op" id="5547002">:</span>&nbsp;<span class="ident" id="5547004">pos</span><span class="op" id="5547007">,</span>&nbsp;<span class="ident" id="5547009">Line</span><span class="op" id="5547013">:</span>&nbsp;<span class="ident" id="5547015">line</span><span class="op" id="5547019">,</span>&nbsp;<span class="ident" id="5547021">Pipe</span><span class="op" id="5547025">:</span>&nbsp;<span class="ident" id="5547027">pipe</span><span class="op" id="5547031">,</span>&nbsp;<span class="ident" id="5547033">List</span><span class="op" id="5547037">:</span>&nbsp;<span class="ident" id="5547039">list</span><span class="op" id="5547043">,</span>&nbsp;<span class="ident" id="5547045">ElseList</span><span class="op" id="5547053">:</span>&nbsp;<span class="ident" id="5547055">elseList</span><span class="op" id="5547063">}</span><span class="op" id="5547064">}</span><br>
<span class="lineno"></span><span class="op" id="5547066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547069">func</span>&nbsp;<span class="op" id="5547074">(</span><span class="ident" id="5547075">w</span>&nbsp;<span class="op" id="5547077">*</span><span class="ident" id="5547078">WithNode</span><span class="op" id="5547086">)</span>&nbsp;<span class="ident" id="5547088">Copy</span><span class="op" id="5547092">(</span><span class="op" id="5547093">)</span>&nbsp;<span class="ident" id="5547095">Node</span>&nbsp;<span class="op" id="5547100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547103">return</span>&nbsp;<span class="ident" id="5547110">w</span><span class="op" id="5547111">.</span><span class="ident" id="5547112">tr</span><span class="op" id="5547114">.</span><span class="ident" id="5547115">newWith</span><span class="op" id="5547122">(</span><span class="ident" id="5547123">w</span><span class="op" id="5547124">.</span><span class="ident" id="5547125">Pos</span><span class="op" id="5547128">,</span>&nbsp;<span class="ident" id="5547130">w</span><span class="op" id="5547131">.</span><span class="ident" id="5547132">Line</span><span class="op" id="5547136">,</span>&nbsp;<span class="ident" id="5547138">w</span><span class="op" id="5547139">.</span><span class="ident" id="5547140">Pipe</span><span class="op" id="5547144">.</span><span class="ident" id="5547145">CopyPipe</span><span class="op" id="5547153">(</span><span class="op" id="5547154">)</span><span class="op" id="5547155">,</span>&nbsp;<span class="ident" id="5547157">w</span><span class="op" id="5547158">.</span><span class="ident" id="5547159">List</span><span class="op" id="5547163">.</span><span class="ident" id="5547164">CopyList</span><span class="op" id="5547172">(</span><span class="op" id="5547173">)</span><span class="op" id="5547174">,</span>&nbsp;<span class="ident" id="5547176">w</span><span class="op" id="5547177">.</span><span class="ident" id="5547178">ElseList</span><span class="op" id="5547186">.</span><span class="ident" id="5547187">CopyList</span><span class="op" id="5547195">(</span><span class="op" id="5547196">)</span><span class="op" id="5547197">)</span><br>
<span class="lineno">805</span><span class="op" id="5547199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5547202">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5547252">type</span>&nbsp;<span class="ident" id="5547257">TemplateNode</span>&nbsp;<span class="keyword" id="5547270">struct</span>&nbsp;<span class="op" id="5547277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547280">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547290">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547295">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5547300">*</span><span class="ident" id="5547301">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547307">Line</span>&nbsp;<span class="builtintype" id="5547312">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5547322">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547392">Name</span>&nbsp;<span class="builtintype" id="5547397">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5547407">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5547448">Pipe</span>&nbsp;<span class="op" id="5547453">*</span><span class="ident" id="5547454">PipeNode</span>&nbsp;<span class="comment" id="5547463">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="5547515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547518">func</span>&nbsp;<span class="op" id="5547523">(</span><span class="ident" id="5547524">t</span>&nbsp;<span class="op" id="5547526">*</span><span class="ident" id="5547527">Tree</span><span class="op" id="5547531">)</span>&nbsp;<span class="ident" id="5547533">newTemplate</span><span class="op" id="5547544">(</span><span class="ident" id="5547545">pos</span>&nbsp;<span class="ident" id="5547549">Pos</span><span class="op" id="5547552">,</span>&nbsp;<span class="ident" id="5547554">line</span>&nbsp;<span class="builtintype" id="5547559">int</span><span class="op" id="5547562">,</span>&nbsp;<span class="ident" id="5547564">name</span>&nbsp;<span class="builtintype" id="5547569">string</span><span class="op" id="5547575">,</span>&nbsp;<span class="ident" id="5547577">pipe</span>&nbsp;<span class="op" id="5547582">*</span><span class="ident" id="5547583">PipeNode</span><span class="op" id="5547591">)</span>&nbsp;<span class="op" id="5547593">*</span><span class="ident" id="5547594">TemplateNode</span>&nbsp;<span class="op" id="5547607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547610">return</span>&nbsp;<span class="op" id="5547617">&amp;</span><span class="ident" id="5547618">TemplateNode</span><span class="op" id="5547630">{</span><span class="ident" id="5547631">tr</span><span class="op" id="5547633">:</span>&nbsp;<span class="ident" id="5547635">t</span><span class="op" id="5547636">,</span>&nbsp;<span class="ident" id="5547638">NodeType</span><span class="op" id="5547646">:</span>&nbsp;<span class="ident" id="5547648">NodeTemplate</span><span class="op" id="5547660">,</span>&nbsp;<span class="ident" id="5547662">Pos</span><span class="op" id="5547665">:</span>&nbsp;<span class="ident" id="5547667">pos</span><span class="op" id="5547670">,</span>&nbsp;<span class="ident" id="5547672">Line</span><span class="op" id="5547676">:</span>&nbsp;<span class="ident" id="5547678">line</span><span class="op" id="5547682">,</span>&nbsp;<span class="ident" id="5547684">Name</span><span class="op" id="5547688">:</span>&nbsp;<span class="ident" id="5547690">name</span><span class="op" id="5547694">,</span>&nbsp;<span class="ident" id="5547696">Pipe</span><span class="op" id="5547700">:</span>&nbsp;<span class="ident" id="5547702">pipe</span><span class="op" id="5547706">}</span><br>
<span class="lineno"></span><span class="op" id="5547708">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="5547711">func</span>&nbsp;<span class="op" id="5547716">(</span><span class="ident" id="5547717">t</span>&nbsp;<span class="op" id="5547719">*</span><span class="ident" id="5547720">TemplateNode</span><span class="op" id="5547732">)</span>&nbsp;<span class="ident" id="5547734">String</span><span class="op" id="5547740">(</span><span class="op" id="5547741">)</span>&nbsp;<span class="builtintype" id="5547743">string</span>&nbsp;<span class="op" id="5547750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547753">if</span>&nbsp;<span class="ident" id="5547756">t</span><span class="op" id="5547757">.</span><span class="ident" id="5547758">Pipe</span>&nbsp;<span class="op" id="5547763">==</span>&nbsp;<span class="ident" id="5547766">nil</span>&nbsp;<span class="op" id="5547770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547774">return</span>&nbsp;<span class="ident" id="5547781">fmt</span><span class="op" id="5547784">.</span><span class="ident" id="5547785">Sprintf</span><span class="op" id="5547792">(</span><span class="string" id="5547793">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="5547810">,</span>&nbsp;<span class="ident" id="5547812">t</span><span class="op" id="5547813">.</span><span class="ident" id="5547814">Name</span><span class="op" id="5547818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5547821">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547824">return</span>&nbsp;<span class="ident" id="5547831">fmt</span><span class="op" id="5547834">.</span><span class="ident" id="5547835">Sprintf</span><span class="op" id="5547842">(</span><span class="string" id="5547843">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="5547863">,</span>&nbsp;<span class="ident" id="5547865">t</span><span class="op" id="5547866">.</span><span class="ident" id="5547867">Name</span><span class="op" id="5547871">,</span>&nbsp;<span class="ident" id="5547873">t</span><span class="op" id="5547874">.</span><span class="ident" id="5547875">Pipe</span><span class="op" id="5547879">)</span><br>
<span class="lineno"></span><span class="op" id="5547881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547884">func</span>&nbsp;<span class="op" id="5547889">(</span><span class="ident" id="5547890">t</span>&nbsp;<span class="op" id="5547892">*</span><span class="ident" id="5547893">TemplateNode</span><span class="op" id="5547905">)</span>&nbsp;<span class="ident" id="5547907">tree</span><span class="op" id="5547911">(</span><span class="op" id="5547912">)</span>&nbsp;<span class="op" id="5547914">*</span><span class="ident" id="5547915">Tree</span>&nbsp;<span class="op" id="5547920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547923">return</span>&nbsp;<span class="ident" id="5547930">t</span><span class="op" id="5547931">.</span><span class="ident" id="5547932">tr</span><br>
<span class="lineno">830</span><span class="op" id="5547935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5547938">func</span>&nbsp;<span class="op" id="5547943">(</span><span class="ident" id="5547944">t</span>&nbsp;<span class="op" id="5547946">*</span><span class="ident" id="5547947">TemplateNode</span><span class="op" id="5547959">)</span>&nbsp;<span class="ident" id="5547961">Copy</span><span class="op" id="5547965">(</span><span class="op" id="5547966">)</span>&nbsp;<span class="ident" id="5547968">Node</span>&nbsp;<span class="op" id="5547973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5547976">return</span>&nbsp;<span class="ident" id="5547983">t</span><span class="op" id="5547984">.</span><span class="ident" id="5547985">tr</span><span class="op" id="5547987">.</span><span class="ident" id="5547988">newTemplate</span><span class="op" id="5547999">(</span><span class="ident" id="5548000">t</span><span class="op" id="5548001">.</span><span class="ident" id="5548002">Pos</span><span class="op" id="5548005">,</span>&nbsp;<span class="ident" id="5548007">t</span><span class="op" id="5548008">.</span><span class="ident" id="5548009">Line</span><span class="op" id="5548013">,</span>&nbsp;<span class="ident" id="5548015">t</span><span class="op" id="5548016">.</span><span class="ident" id="5548017">Name</span><span class="op" id="5548021">,</span>&nbsp;<span class="ident" id="5548023">t</span><span class="op" id="5548024">.</span><span class="ident" id="5548025">Pipe</span><span class="op" id="5548029">.</span><span class="ident" id="5548030">CopyPipe</span><span class="op" id="5548038">(</span><span class="op" id="5548039">)</span><span class="op" id="5548040">)</span><br>
<span class="lineno"></span><span class="op" id="5548042">}</span>
</div>
</body>
</html>
