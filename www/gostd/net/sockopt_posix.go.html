<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3112139">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3112195">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3112249">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3112300">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3112373">package</span>&nbsp;<span class="ident" id="3112381">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3112386">import</span>&nbsp;<span class="op" id="3112393">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3112396">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3112402">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3112412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3112415">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="3112434">func</span>&nbsp;<span class="ident" id="3112439">boolint</span><span class="op" id="3112446">(</span><span class="ident" id="3112447">b</span>&nbsp;<span class="builtintype" id="3112449">bool</span><span class="op" id="3112453">)</span>&nbsp;<span class="builtintype" id="3112455">int</span>&nbsp;<span class="op" id="3112459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112462">if</span>&nbsp;<span class="ident" id="3112465">b</span>&nbsp;<span class="op" id="3112467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112471">return</span>&nbsp;<span class="num" id="3112478">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112484">return</span>&nbsp;<span class="num" id="3112491">0</span><br>
<span class="lineno">20</span><span class="op" id="3112493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3112496">func</span>&nbsp;<span class="ident" id="3112501">ipv4AddrToInterface</span><span class="op" id="3112520">(</span><span class="ident" id="3112521">ip</span>&nbsp;<span class="ident" id="3112524">IP</span><span class="op" id="3112526">)</span>&nbsp;<span class="op" id="3112528">(</span><span class="op" id="3112529">*</span><span class="ident" id="3112530">Interface</span><span class="op" id="3112539">,</span>&nbsp;<span class="builtintype" id="3112541">error</span><span class="op" id="3112546">)</span>&nbsp;<span class="op" id="3112548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112551">ift</span><span class="op" id="3112554">,</span>&nbsp;<span class="ident" id="3112556">err</span>&nbsp;<span class="op" id="3112560">:=</span>&nbsp;<span class="ident" id="3112563">Interfaces</span><span class="op" id="3112573">(</span><span class="op" id="3112574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112577">if</span>&nbsp;<span class="ident" id="3112580">err</span>&nbsp;<span class="op" id="3112584">!=</span>&nbsp;<span class="ident" id="3112587">nil</span>&nbsp;<span class="op" id="3112591">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112595">return</span>&nbsp;<span class="ident" id="3112602">nil</span><span class="op" id="3112605">,</span>&nbsp;<span class="ident" id="3112607">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112615">for</span>&nbsp;<span class="ident" id="3112619">_</span><span class="op" id="3112620">,</span>&nbsp;<span class="ident" id="3112622">ifi</span>&nbsp;<span class="op" id="3112626">:=</span>&nbsp;<span class="keyword" id="3112629">range</span>&nbsp;<span class="ident" id="3112635">ift</span>&nbsp;<span class="op" id="3112639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3112643">ifat</span><span class="op" id="3112647">,</span>&nbsp;<span class="ident" id="3112649">err</span>&nbsp;<span class="op" id="3112653">:=</span>&nbsp;<span class="ident" id="3112656">ifi</span><span class="op" id="3112659">.</span><span class="ident" id="3112660">Addrs</span><span class="op" id="3112665">(</span><span class="op" id="3112666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112670">if</span>&nbsp;<span class="ident" id="3112673">err</span>&nbsp;<span class="op" id="3112677">!=</span>&nbsp;<span class="ident" id="3112680">nil</span>&nbsp;<span class="op" id="3112684">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112689">return</span>&nbsp;<span class="ident" id="3112696">nil</span><span class="op" id="3112699">,</span>&nbsp;<span class="ident" id="3112701">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112711">for</span>&nbsp;<span class="ident" id="3112715">_</span><span class="op" id="3112716">,</span>&nbsp;<span class="ident" id="3112718">ifa</span>&nbsp;<span class="op" id="3112722">:=</span>&nbsp;<span class="keyword" id="3112725">range</span>&nbsp;<span class="ident" id="3112731">ifat</span>&nbsp;<span class="op" id="3112736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112741">switch</span>&nbsp;<span class="ident" id="3112748">v</span>&nbsp;<span class="op" id="3112750">:=</span>&nbsp;<span class="ident" id="3112753">ifa</span><span class="op" id="3112756">.</span><span class="op" id="3112757">(</span><span class="keyword" id="3112758">type</span><span class="op" id="3112762">)</span>&nbsp;<span class="op" id="3112764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112769">case</span>&nbsp;<span class="op" id="3112774">*</span><span class="ident" id="3112775">IPAddr</span><span class="op" id="3112781">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112787">if</span>&nbsp;<span class="ident" id="3112790">ip</span><span class="op" id="3112792">.</span><span class="ident" id="3112793">Equal</span><span class="op" id="3112798">(</span><span class="ident" id="3112799">v</span><span class="op" id="3112800">.</span><span class="ident" id="3112801">IP</span><span class="op" id="3112803">)</span>&nbsp;<span class="op" id="3112805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112812">return</span>&nbsp;<span class="op" id="3112819">&amp;</span><span class="ident" id="3112820">ifi</span><span class="op" id="3112823">,</span>&nbsp;<span class="ident" id="3112825">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112838">case</span>&nbsp;<span class="op" id="3112843">*</span><span class="ident" id="3112844">IPNet</span><span class="op" id="3112849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112855">if</span>&nbsp;<span class="ident" id="3112858">ip</span><span class="op" id="3112860">.</span><span class="ident" id="3112861">Equal</span><span class="op" id="3112866">(</span><span class="ident" id="3112867">v</span><span class="op" id="3112868">.</span><span class="ident" id="3112869">IP</span><span class="op" id="3112871">)</span>&nbsp;<span class="op" id="3112873">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112880">return</span>&nbsp;<span class="op" id="3112887">&amp;</span><span class="ident" id="3112888">ifi</span><span class="op" id="3112891">,</span>&nbsp;<span class="ident" id="3112893">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112913">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112916">if</span>&nbsp;<span class="ident" id="3112919">ip</span><span class="op" id="3112921">.</span><span class="ident" id="3112922">Equal</span><span class="op" id="3112927">(</span><span class="ident" id="3112928">IPv4zero</span><span class="op" id="3112936">)</span>&nbsp;<span class="op" id="3112938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112942">return</span>&nbsp;<span class="ident" id="3112949">nil</span><span class="op" id="3112952">,</span>&nbsp;<span class="ident" id="3112954">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3112959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3112962">return</span>&nbsp;<span class="ident" id="3112969">nil</span><span class="op" id="3112972">,</span>&nbsp;<span class="ident" id="3112974">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3112993">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3112996">func</span>&nbsp;<span class="ident" id="3113001">interfaceToIPv4Addr</span><span class="op" id="3113020">(</span><span class="ident" id="3113021">ifi</span>&nbsp;<span class="op" id="3113025">*</span><span class="ident" id="3113026">Interface</span><span class="op" id="3113035">)</span>&nbsp;<span class="op" id="3113037">(</span><span class="ident" id="3113038">IP</span><span class="op" id="3113040">,</span>&nbsp;<span class="builtintype" id="3113042">error</span><span class="op" id="3113047">)</span>&nbsp;<span class="op" id="3113049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113052">if</span>&nbsp;<span class="ident" id="3113055">ifi</span>&nbsp;<span class="op" id="3113059">==</span>&nbsp;<span class="ident" id="3113062">nil</span>&nbsp;<span class="op" id="3113066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113070">return</span>&nbsp;<span class="ident" id="3113077">IPv4zero</span><span class="op" id="3113085">,</span>&nbsp;<span class="ident" id="3113087">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113092">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113095">ifat</span><span class="op" id="3113099">,</span>&nbsp;<span class="ident" id="3113101">err</span>&nbsp;<span class="op" id="3113105">:=</span>&nbsp;<span class="ident" id="3113108">ifi</span><span class="op" id="3113111">.</span><span class="ident" id="3113112">Addrs</span><span class="op" id="3113117">(</span><span class="op" id="3113118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113121">if</span>&nbsp;<span class="ident" id="3113124">err</span>&nbsp;<span class="op" id="3113128">!=</span>&nbsp;<span class="ident" id="3113131">nil</span>&nbsp;<span class="op" id="3113135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113139">return</span>&nbsp;<span class="ident" id="3113146">nil</span><span class="op" id="3113149">,</span>&nbsp;<span class="ident" id="3113151">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113159">for</span>&nbsp;<span class="ident" id="3113163">_</span><span class="op" id="3113164">,</span>&nbsp;<span class="ident" id="3113166">ifa</span>&nbsp;<span class="op" id="3113170">:=</span>&nbsp;<span class="keyword" id="3113173">range</span>&nbsp;<span class="ident" id="3113179">ifat</span>&nbsp;<span class="op" id="3113184">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113188">switch</span>&nbsp;<span class="ident" id="3113195">v</span>&nbsp;<span class="op" id="3113197">:=</span>&nbsp;<span class="ident" id="3113200">ifa</span><span class="op" id="3113203">.</span><span class="op" id="3113204">(</span><span class="keyword" id="3113205">type</span><span class="op" id="3113209">)</span>&nbsp;<span class="op" id="3113211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113215">case</span>&nbsp;<span class="op" id="3113220">*</span><span class="ident" id="3113221">IPAddr</span><span class="op" id="3113227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113232">if</span>&nbsp;<span class="ident" id="3113235">v</span><span class="op" id="3113236">.</span><span class="ident" id="3113237">IP</span><span class="op" id="3113239">.</span><span class="ident" id="3113240">To4</span><span class="op" id="3113243">(</span><span class="op" id="3113244">)</span>&nbsp;<span class="op" id="3113246">!=</span>&nbsp;<span class="ident" id="3113249">nil</span>&nbsp;<span class="op" id="3113253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113259">return</span>&nbsp;<span class="ident" id="3113266">v</span><span class="op" id="3113267">.</span><span class="ident" id="3113268">IP</span><span class="op" id="3113270">,</span>&nbsp;<span class="ident" id="3113272">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113279">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113283">case</span>&nbsp;<span class="op" id="3113288">*</span><span class="ident" id="3113289">IPNet</span><span class="op" id="3113294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113299">if</span>&nbsp;<span class="ident" id="3113302">v</span><span class="op" id="3113303">.</span><span class="ident" id="3113304">IP</span><span class="op" id="3113306">.</span><span class="ident" id="3113307">To4</span><span class="op" id="3113310">(</span><span class="op" id="3113311">)</span>&nbsp;<span class="op" id="3113313">!=</span>&nbsp;<span class="ident" id="3113316">nil</span>&nbsp;<span class="op" id="3113320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113326">return</span>&nbsp;<span class="ident" id="3113333">v</span><span class="op" id="3113334">.</span><span class="ident" id="3113335">IP</span><span class="op" id="3113337">,</span>&nbsp;<span class="ident" id="3113339">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113350">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113356">return</span>&nbsp;<span class="ident" id="3113363">nil</span><span class="op" id="3113366">,</span>&nbsp;<span class="ident" id="3113368">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3113387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3113390">func</span>&nbsp;<span class="ident" id="3113395">setIPv4MreqToInterface</span><span class="op" id="3113417">(</span><span class="ident" id="3113418">mreq</span>&nbsp;<span class="op" id="3113423">*</span><span class="ident" id="3113424">syscall</span><span class="op" id="3113431">.</span><span class="ident" id="3113432">IPMreq</span><span class="op" id="3113438">,</span>&nbsp;<span class="ident" id="3113440">ifi</span>&nbsp;<span class="op" id="3113444">*</span><span class="ident" id="3113445">Interface</span><span class="op" id="3113454">)</span>&nbsp;<span class="builtintype" id="3113456">error</span>&nbsp;<span class="op" id="3113462">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113465">if</span>&nbsp;<span class="ident" id="3113468">ifi</span>&nbsp;<span class="op" id="3113472">==</span>&nbsp;<span class="ident" id="3113475">nil</span>&nbsp;<span class="op" id="3113479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113483">return</span>&nbsp;<span class="ident" id="3113490">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3113498">ifat</span><span class="op" id="3113502">,</span>&nbsp;<span class="ident" id="3113504">err</span>&nbsp;<span class="op" id="3113508">:=</span>&nbsp;<span class="ident" id="3113511">ifi</span><span class="op" id="3113514">.</span><span class="ident" id="3113515">Addrs</span><span class="op" id="3113520">(</span><span class="op" id="3113521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113524">if</span>&nbsp;<span class="ident" id="3113527">err</span>&nbsp;<span class="op" id="3113531">!=</span>&nbsp;<span class="ident" id="3113534">nil</span>&nbsp;<span class="op" id="3113538">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113542">return</span>&nbsp;<span class="ident" id="3113549">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113557">for</span>&nbsp;<span class="ident" id="3113561">_</span><span class="op" id="3113562">,</span>&nbsp;<span class="ident" id="3113564">ifa</span>&nbsp;<span class="op" id="3113568">:=</span>&nbsp;<span class="keyword" id="3113571">range</span>&nbsp;<span class="ident" id="3113577">ifat</span>&nbsp;<span class="op" id="3113582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113586">switch</span>&nbsp;<span class="ident" id="3113593">v</span>&nbsp;<span class="op" id="3113595">:=</span>&nbsp;<span class="ident" id="3113598">ifa</span><span class="op" id="3113601">.</span><span class="op" id="3113602">(</span><span class="keyword" id="3113603">type</span><span class="op" id="3113607">)</span>&nbsp;<span class="op" id="3113609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113613">case</span>&nbsp;<span class="op" id="3113618">*</span><span class="ident" id="3113619">IPAddr</span><span class="op" id="3113625">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113630">if</span>&nbsp;<span class="ident" id="3113633">a</span>&nbsp;<span class="op" id="3113635">:=</span>&nbsp;<span class="ident" id="3113638">v</span><span class="op" id="3113639">.</span><span class="ident" id="3113640">IP</span><span class="op" id="3113642">.</span><span class="ident" id="3113643">To4</span><span class="op" id="3113646">(</span><span class="op" id="3113647">)</span><span class="op" id="3113648">;</span>&nbsp;<span class="ident" id="3113650">a</span>&nbsp;<span class="op" id="3113652">!=</span>&nbsp;<span class="ident" id="3113655">nil</span>&nbsp;<span class="op" id="3113659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3113665">copy</span><span class="op" id="3113669">(</span><span class="ident" id="3113670">mreq</span><span class="op" id="3113674">.</span><span class="ident" id="3113675">Interface</span><span class="op" id="3113684">[</span><span class="op" id="3113685">:</span><span class="op" id="3113686">]</span><span class="op" id="3113687">,</span>&nbsp;<span class="ident" id="3113689">a</span><span class="op" id="3113690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113696">goto</span>&nbsp;<span class="ident" id="3113701">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113713">case</span>&nbsp;<span class="op" id="3113718">*</span><span class="ident" id="3113719">IPNet</span><span class="op" id="3113724">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113729">if</span>&nbsp;<span class="ident" id="3113732">a</span>&nbsp;<span class="op" id="3113734">:=</span>&nbsp;<span class="ident" id="3113737">v</span><span class="op" id="3113738">.</span><span class="ident" id="3113739">IP</span><span class="op" id="3113741">.</span><span class="ident" id="3113742">To4</span><span class="op" id="3113745">(</span><span class="op" id="3113746">)</span><span class="op" id="3113747">;</span>&nbsp;<span class="ident" id="3113749">a</span>&nbsp;<span class="op" id="3113751">!=</span>&nbsp;<span class="ident" id="3113754">nil</span>&nbsp;<span class="op" id="3113758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3113764">copy</span><span class="op" id="3113768">(</span><span class="ident" id="3113769">mreq</span><span class="op" id="3113773">.</span><span class="ident" id="3113774">Interface</span><span class="op" id="3113783">[</span><span class="op" id="3113784">:</span><span class="op" id="3113785">]</span><span class="op" id="3113786">,</span>&nbsp;<span class="ident" id="3113788">a</span><span class="op" id="3113789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113795">goto</span>&nbsp;<span class="ident" id="3113800">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113812">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113815">}</span><br>
<span class="lineno"></span><span class="ident" id="3113817">done</span><span class="op" id="3113821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113824">if</span>&nbsp;<span class="ident" id="3113827">bytesEqual</span><span class="op" id="3113837">(</span><span class="ident" id="3113838">mreq</span><span class="op" id="3113842">.</span><span class="ident" id="3113843">Multiaddr</span><span class="op" id="3113852">[</span><span class="op" id="3113853">:</span><span class="op" id="3113854">]</span><span class="op" id="3113855">,</span>&nbsp;<span class="ident" id="3113857">IPv4zero</span><span class="op" id="3113865">.</span><span class="ident" id="3113866">To4</span><span class="op" id="3113869">(</span><span class="op" id="3113870">)</span><span class="op" id="3113871">)</span>&nbsp;<span class="op" id="3113873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113877">return</span>&nbsp;<span class="ident" id="3113884">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3113913">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113916">return</span>&nbsp;<span class="ident" id="3113923">nil</span><br>
<span class="lineno"></span><span class="op" id="3113927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3113930">func</span>&nbsp;<span class="ident" id="3113935">setReadBuffer</span><span class="op" id="3113948">(</span><span class="ident" id="3113949">fd</span>&nbsp;<span class="op" id="3113952">*</span><span class="ident" id="3113953">netFD</span><span class="op" id="3113958">,</span>&nbsp;<span class="ident" id="3113960">bytes</span>&nbsp;<span class="builtintype" id="3113966">int</span><span class="op" id="3113969">)</span>&nbsp;<span class="builtintype" id="3113971">error</span>&nbsp;<span class="op" id="3113977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3113980">if</span>&nbsp;<span class="ident" id="3113983">err</span>&nbsp;<span class="op" id="3113987">:=</span>&nbsp;<span class="ident" id="3113990">fd</span><span class="op" id="3113992">.</span><span class="ident" id="3113993">incref</span><span class="op" id="3113999">(</span><span class="op" id="3114000">)</span><span class="op" id="3114001">;</span>&nbsp;<span class="ident" id="3114003">err</span>&nbsp;<span class="op" id="3114007">!=</span>&nbsp;<span class="ident" id="3114010">nil</span>&nbsp;<span class="op" id="3114014">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114018">return</span>&nbsp;<span class="ident" id="3114025">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114033">defer</span>&nbsp;<span class="ident" id="3114039">fd</span><span class="op" id="3114041">.</span><span class="ident" id="3114042">decref</span><span class="op" id="3114048">(</span><span class="op" id="3114049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114052">return</span>&nbsp;<span class="ident" id="3114059">os</span><span class="op" id="3114061">.</span><span class="ident" id="3114062">NewSyscallError</span><span class="op" id="3114077">(</span><span class="string" id="3114078">&#34;setsockopt&#34;</span><span class="op" id="3114090">,</span>&nbsp;<span class="ident" id="3114092">syscall</span><span class="op" id="3114099">.</span><span class="ident" id="3114100">SetsockoptInt</span><span class="op" id="3114113">(</span><span class="ident" id="3114114">fd</span><span class="op" id="3114116">.</span><span class="ident" id="3114117">sysfd</span><span class="op" id="3114122">,</span>&nbsp;<span class="ident" id="3114124">syscall</span><span class="op" id="3114131">.</span><span class="ident" id="3114132">SOL_SOCKET</span><span class="op" id="3114142">,</span>&nbsp;<span class="ident" id="3114144">syscall</span><span class="op" id="3114151">.</span><span class="ident" id="3114152">SO_RCVBUF</span><span class="op" id="3114161">,</span>&nbsp;<span class="ident" id="3114163">bytes</span><span class="op" id="3114168">)</span><span class="op" id="3114169">)</span><br>
<span class="lineno"></span><span class="op" id="3114171">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="3114174">func</span>&nbsp;<span class="ident" id="3114179">setWriteBuffer</span><span class="op" id="3114193">(</span><span class="ident" id="3114194">fd</span>&nbsp;<span class="op" id="3114197">*</span><span class="ident" id="3114198">netFD</span><span class="op" id="3114203">,</span>&nbsp;<span class="ident" id="3114205">bytes</span>&nbsp;<span class="builtintype" id="3114211">int</span><span class="op" id="3114214">)</span>&nbsp;<span class="builtintype" id="3114216">error</span>&nbsp;<span class="op" id="3114222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114225">if</span>&nbsp;<span class="ident" id="3114228">err</span>&nbsp;<span class="op" id="3114232">:=</span>&nbsp;<span class="ident" id="3114235">fd</span><span class="op" id="3114237">.</span><span class="ident" id="3114238">incref</span><span class="op" id="3114244">(</span><span class="op" id="3114245">)</span><span class="op" id="3114246">;</span>&nbsp;<span class="ident" id="3114248">err</span>&nbsp;<span class="op" id="3114252">!=</span>&nbsp;<span class="ident" id="3114255">nil</span>&nbsp;<span class="op" id="3114259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114263">return</span>&nbsp;<span class="ident" id="3114270">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114275">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114278">defer</span>&nbsp;<span class="ident" id="3114284">fd</span><span class="op" id="3114286">.</span><span class="ident" id="3114287">decref</span><span class="op" id="3114293">(</span><span class="op" id="3114294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114297">return</span>&nbsp;<span class="ident" id="3114304">os</span><span class="op" id="3114306">.</span><span class="ident" id="3114307">NewSyscallError</span><span class="op" id="3114322">(</span><span class="string" id="3114323">&#34;setsockopt&#34;</span><span class="op" id="3114335">,</span>&nbsp;<span class="ident" id="3114337">syscall</span><span class="op" id="3114344">.</span><span class="ident" id="3114345">SetsockoptInt</span><span class="op" id="3114358">(</span><span class="ident" id="3114359">fd</span><span class="op" id="3114361">.</span><span class="ident" id="3114362">sysfd</span><span class="op" id="3114367">,</span>&nbsp;<span class="ident" id="3114369">syscall</span><span class="op" id="3114376">.</span><span class="ident" id="3114377">SOL_SOCKET</span><span class="op" id="3114387">,</span>&nbsp;<span class="ident" id="3114389">syscall</span><span class="op" id="3114396">.</span><span class="ident" id="3114397">SO_SNDBUF</span><span class="op" id="3114406">,</span>&nbsp;<span class="ident" id="3114408">bytes</span><span class="op" id="3114413">)</span><span class="op" id="3114414">)</span><br>
<span class="lineno"></span><span class="op" id="3114416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3114419">func</span>&nbsp;<span class="ident" id="3114424">setKeepAlive</span><span class="op" id="3114436">(</span><span class="ident" id="3114437">fd</span>&nbsp;<span class="op" id="3114440">*</span><span class="ident" id="3114441">netFD</span><span class="op" id="3114446">,</span>&nbsp;<span class="ident" id="3114448">keepalive</span>&nbsp;<span class="builtintype" id="3114458">bool</span><span class="op" id="3114462">)</span>&nbsp;<span class="builtintype" id="3114464">error</span>&nbsp;<span class="op" id="3114470">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114473">if</span>&nbsp;<span class="ident" id="3114476">err</span>&nbsp;<span class="op" id="3114480">:=</span>&nbsp;<span class="ident" id="3114483">fd</span><span class="op" id="3114485">.</span><span class="ident" id="3114486">incref</span><span class="op" id="3114492">(</span><span class="op" id="3114493">)</span><span class="op" id="3114494">;</span>&nbsp;<span class="ident" id="3114496">err</span>&nbsp;<span class="op" id="3114500">!=</span>&nbsp;<span class="ident" id="3114503">nil</span>&nbsp;<span class="op" id="3114507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114511">return</span>&nbsp;<span class="ident" id="3114518">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114526">defer</span>&nbsp;<span class="ident" id="3114532">fd</span><span class="op" id="3114534">.</span><span class="ident" id="3114535">decref</span><span class="op" id="3114541">(</span><span class="op" id="3114542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114545">return</span>&nbsp;<span class="ident" id="3114552">os</span><span class="op" id="3114554">.</span><span class="ident" id="3114555">NewSyscallError</span><span class="op" id="3114570">(</span><span class="string" id="3114571">&#34;setsockopt&#34;</span><span class="op" id="3114583">,</span>&nbsp;<span class="ident" id="3114585">syscall</span><span class="op" id="3114592">.</span><span class="ident" id="3114593">SetsockoptInt</span><span class="op" id="3114606">(</span><span class="ident" id="3114607">fd</span><span class="op" id="3114609">.</span><span class="ident" id="3114610">sysfd</span><span class="op" id="3114615">,</span>&nbsp;<span class="ident" id="3114617">syscall</span><span class="op" id="3114624">.</span><span class="ident" id="3114625">SOL_SOCKET</span><span class="op" id="3114635">,</span>&nbsp;<span class="ident" id="3114637">syscall</span><span class="op" id="3114644">.</span><span class="ident" id="3114645">SO_KEEPALIVE</span><span class="op" id="3114657">,</span>&nbsp;<span class="ident" id="3114659">boolint</span><span class="op" id="3114666">(</span><span class="ident" id="3114667">keepalive</span><span class="op" id="3114676">)</span><span class="op" id="3114677">)</span><span class="op" id="3114678">)</span><br>
<span class="lineno">125</span><span class="op" id="3114680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3114683">func</span>&nbsp;<span class="ident" id="3114688">setLinger</span><span class="op" id="3114697">(</span><span class="ident" id="3114698">fd</span>&nbsp;<span class="op" id="3114701">*</span><span class="ident" id="3114702">netFD</span><span class="op" id="3114707">,</span>&nbsp;<span class="ident" id="3114709">sec</span>&nbsp;<span class="builtintype" id="3114713">int</span><span class="op" id="3114716">)</span>&nbsp;<span class="builtintype" id="3114718">error</span>&nbsp;<span class="op" id="3114724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114727">var</span>&nbsp;<span class="ident" id="3114731">l</span>&nbsp;<span class="ident" id="3114733">syscall</span><span class="op" id="3114740">.</span><span class="ident" id="3114741">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114749">if</span>&nbsp;<span class="ident" id="3114752">sec</span>&nbsp;<span class="op" id="3114756">&gt;=</span>&nbsp;<span class="num" id="3114759">0</span>&nbsp;<span class="op" id="3114761">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114765">l</span><span class="op" id="3114766">.</span><span class="ident" id="3114767">Onoff</span>&nbsp;<span class="op" id="3114773">=</span>&nbsp;<span class="num" id="3114775">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114779">l</span><span class="op" id="3114780">.</span><span class="ident" id="3114781">Linger</span>&nbsp;<span class="op" id="3114788">=</span>&nbsp;<span class="builtintype" id="3114790">int32</span><span class="op" id="3114795">(</span><span class="ident" id="3114796">sec</span><span class="op" id="3114799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114802">}</span>&nbsp;<span class="keyword" id="3114804">else</span>&nbsp;<span class="op" id="3114809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114813">l</span><span class="op" id="3114814">.</span><span class="ident" id="3114815">Onoff</span>&nbsp;<span class="op" id="3114821">=</span>&nbsp;<span class="num" id="3114823">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3114827">l</span><span class="op" id="3114828">.</span><span class="ident" id="3114829">Linger</span>&nbsp;<span class="op" id="3114836">=</span>&nbsp;<span class="num" id="3114838">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114844">if</span>&nbsp;<span class="ident" id="3114847">err</span>&nbsp;<span class="op" id="3114851">:=</span>&nbsp;<span class="ident" id="3114854">fd</span><span class="op" id="3114856">.</span><span class="ident" id="3114857">incref</span><span class="op" id="3114863">(</span><span class="op" id="3114864">)</span><span class="op" id="3114865">;</span>&nbsp;<span class="ident" id="3114867">err</span>&nbsp;<span class="op" id="3114871">!=</span>&nbsp;<span class="ident" id="3114874">nil</span>&nbsp;<span class="op" id="3114878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114882">return</span>&nbsp;<span class="ident" id="3114889">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3114894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114897">defer</span>&nbsp;<span class="ident" id="3114903">fd</span><span class="op" id="3114905">.</span><span class="ident" id="3114906">decref</span><span class="op" id="3114912">(</span><span class="op" id="3114913">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3114916">return</span>&nbsp;<span class="ident" id="3114923">os</span><span class="op" id="3114925">.</span><span class="ident" id="3114926">NewSyscallError</span><span class="op" id="3114941">(</span><span class="string" id="3114942">&#34;setsockopt&#34;</span><span class="op" id="3114954">,</span>&nbsp;<span class="ident" id="3114956">syscall</span><span class="op" id="3114963">.</span><span class="ident" id="3114964">SetsockoptLinger</span><span class="op" id="3114980">(</span><span class="ident" id="3114981">fd</span><span class="op" id="3114983">.</span><span class="ident" id="3114984">sysfd</span><span class="op" id="3114989">,</span>&nbsp;<span class="ident" id="3114991">syscall</span><span class="op" id="3114998">.</span><span class="ident" id="3114999">SOL_SOCKET</span><span class="op" id="3115009">,</span>&nbsp;<span class="ident" id="3115011">syscall</span><span class="op" id="3115018">.</span><span class="ident" id="3115019">SO_LINGER</span><span class="op" id="3115028">,</span>&nbsp;<span class="op" id="3115030">&amp;</span><span class="ident" id="3115031">l</span><span class="op" id="3115032">)</span><span class="op" id="3115033">)</span><br>
<span class="lineno"></span><span class="op" id="3115035">}</span>
</div>
</body>
</html>
