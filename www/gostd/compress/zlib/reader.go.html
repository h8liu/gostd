<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4587232">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4587287">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4587341">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4587392">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbspw.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbspr,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspio.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspr.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4587835">package</span>&nbsp;<span class="ident" id="4587843">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="4587849">import</span>&nbsp;<span class="op" id="4587856">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587859">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587868">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587886">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587896">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587904">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4587920">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4587925">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="4587928">const</span>&nbsp;<span class="ident" id="4587934">zlibDeflate</span>&nbsp;<span class="op" id="4587946">=</span>&nbsp;<span class="num" id="4587948">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587951">var</span>&nbsp;<span class="op" id="4587955">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4587958">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588039">ErrChecksum</span>&nbsp;<span class="op" id="4588051">=</span>&nbsp;<span class="ident" id="4588053">errors</span><span class="op" id="4588059">.</span><span class="ident" id="4588060">New</span><span class="op" id="4588063">(</span><span class="string" id="4588064">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="4588088">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588091">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588176">ErrDictionary</span>&nbsp;<span class="op" id="4588190">=</span>&nbsp;<span class="ident" id="4588192">errors</span><span class="op" id="4588198">.</span><span class="ident" id="4588199">New</span><span class="op" id="4588202">(</span><span class="string" id="4588203">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="4588229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588232">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588309">ErrHeader</span>&nbsp;<span class="op" id="4588319">=</span>&nbsp;<span class="ident" id="4588321">errors</span><span class="op" id="4588327">.</span><span class="ident" id="4588328">New</span><span class="op" id="4588331">(</span><span class="string" id="4588332">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="4588354">)</span><br>
<span class="lineno"></span><span class="op" id="4588356">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="4588359">type</span>&nbsp;<span class="ident" id="4588364">reader</span>&nbsp;<span class="keyword" id="4588371">struct</span>&nbsp;<span class="op" id="4588378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588381">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588394">flate</span><span class="op" id="4588399">.</span><span class="ident" id="4588400">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588408">decompressor</span>&nbsp;<span class="ident" id="4588421">io</span><span class="op" id="4588423">.</span><span class="ident" id="4588424">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588436">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4588449">hash</span><span class="op" id="4588453">.</span><span class="ident" id="4588454">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588462">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4588475">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588482">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588495">[</span><span class="num" id="4588496">4</span><span class="op" id="4588497">]</span><span class="builtintype" id="4588498">byte</span><br>
<span class="lineno"></span><span class="op" id="4588503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4588506">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="4588580">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="4588655">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="4588691">type</span>&nbsp;<span class="ident" id="4588696">Resetter</span>&nbsp;<span class="keyword" id="4588705">interface</span>&nbsp;<span class="op" id="4588715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588718">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588792">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588837">Reset</span><span class="op" id="4588842">(</span><span class="ident" id="4588843">r</span>&nbsp;<span class="ident" id="4588845">io</span><span class="op" id="4588847">.</span><span class="ident" id="4588848">Reader</span><span class="op" id="4588854">,</span>&nbsp;<span class="ident" id="4588856">dict</span>&nbsp;<span class="op" id="4588861">[</span><span class="op" id="4588862">]</span><span class="builtintype" id="4588863">byte</span><span class="op" id="4588867">)</span>&nbsp;<span class="builtintype" id="4588869">error</span><br>
<span class="lineno"></span><span class="op" id="4588875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4588878">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="4588917">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="4588988">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4589070">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="4589150">//</span><br>
<span class="lineno"></span><span class="comment" id="4589153">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4589219">func</span>&nbsp;<span class="ident" id="4589224">NewReader</span><span class="op" id="4589233">(</span><span class="ident" id="4589234">r</span>&nbsp;<span class="ident" id="4589236">io</span><span class="op" id="4589238">.</span><span class="ident" id="4589239">Reader</span><span class="op" id="4589245">)</span>&nbsp;<span class="op" id="4589247">(</span><span class="ident" id="4589248">io</span><span class="op" id="4589250">.</span><span class="ident" id="4589251">ReadCloser</span><span class="op" id="4589261">,</span>&nbsp;<span class="builtintype" id="4589263">error</span><span class="op" id="4589268">)</span>&nbsp;<span class="op" id="4589270">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589273">return</span>&nbsp;<span class="ident" id="4589280">NewReaderDict</span><span class="op" id="4589293">(</span><span class="ident" id="4589294">r</span><span class="op" id="4589295">,</span>&nbsp;<span class="ident" id="4589297">nil</span><span class="op" id="4589300">)</span><br>
<span class="lineno"></span><span class="op" id="4589302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4589305">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4589370">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="4589455">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4589552">//</span><br>
<span class="lineno"></span><span class="comment" id="4589555">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4589625">func</span>&nbsp;<span class="ident" id="4589630">NewReaderDict</span><span class="op" id="4589643">(</span><span class="ident" id="4589644">r</span>&nbsp;<span class="ident" id="4589646">io</span><span class="op" id="4589648">.</span><span class="ident" id="4589649">Reader</span><span class="op" id="4589655">,</span>&nbsp;<span class="ident" id="4589657">dict</span>&nbsp;<span class="op" id="4589662">[</span><span class="op" id="4589663">]</span><span class="builtintype" id="4589664">byte</span><span class="op" id="4589668">)</span>&nbsp;<span class="op" id="4589670">(</span><span class="ident" id="4589671">io</span><span class="op" id="4589673">.</span><span class="ident" id="4589674">ReadCloser</span><span class="op" id="4589684">,</span>&nbsp;<span class="builtintype" id="4589686">error</span><span class="op" id="4589691">)</span>&nbsp;<span class="op" id="4589693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589696">z</span>&nbsp;<span class="op" id="4589698">:=</span>&nbsp;<span class="builtinfunc" id="4589701">new</span><span class="op" id="4589704">(</span><span class="ident" id="4589705">reader</span><span class="op" id="4589711">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589714">err</span>&nbsp;<span class="op" id="4589718">:=</span>&nbsp;<span class="ident" id="4589721">z</span><span class="op" id="4589722">.</span><span class="ident" id="4589723">Reset</span><span class="op" id="4589728">(</span><span class="ident" id="4589729">r</span><span class="op" id="4589730">,</span>&nbsp;<span class="ident" id="4589732">dict</span><span class="op" id="4589736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589739">if</span>&nbsp;<span class="ident" id="4589742">err</span>&nbsp;<span class="op" id="4589746">!=</span>&nbsp;<span class="ident" id="4589749">nil</span>&nbsp;<span class="op" id="4589753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589757">return</span>&nbsp;<span class="ident" id="4589764">nil</span><span class="op" id="4589767">,</span>&nbsp;<span class="ident" id="4589769">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589777">return</span>&nbsp;<span class="ident" id="4589784">z</span><span class="op" id="4589785">,</span>&nbsp;<span class="ident" id="4589787">nil</span><br>
<span class="lineno">85</span><span class="op" id="4589791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4589794">func</span>&nbsp;<span class="op" id="4589799">(</span><span class="ident" id="4589800">z</span>&nbsp;<span class="op" id="4589802">*</span><span class="ident" id="4589803">reader</span><span class="op" id="4589809">)</span>&nbsp;<span class="ident" id="4589811">Read</span><span class="op" id="4589815">(</span><span class="ident" id="4589816">p</span>&nbsp;<span class="op" id="4589818">[</span><span class="op" id="4589819">]</span><span class="builtintype" id="4589820">byte</span><span class="op" id="4589824">)</span>&nbsp;<span class="op" id="4589826">(</span><span class="ident" id="4589827">n</span>&nbsp;<span class="builtintype" id="4589829">int</span><span class="op" id="4589832">,</span>&nbsp;<span class="ident" id="4589834">err</span>&nbsp;<span class="builtintype" id="4589838">error</span><span class="op" id="4589843">)</span>&nbsp;<span class="op" id="4589845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589848">if</span>&nbsp;<span class="ident" id="4589851">z</span><span class="op" id="4589852">.</span><span class="ident" id="4589853">err</span>&nbsp;<span class="op" id="4589857">!=</span>&nbsp;<span class="ident" id="4589860">nil</span>&nbsp;<span class="op" id="4589864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589868">return</span>&nbsp;<span class="num" id="4589875">0</span><span class="op" id="4589876">,</span>&nbsp;<span class="ident" id="4589878">z</span><span class="op" id="4589879">.</span><span class="ident" id="4589880">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589888">if</span>&nbsp;<span class="builtinfunc" id="4589891">len</span><span class="op" id="4589894">(</span><span class="ident" id="4589895">p</span><span class="op" id="4589896">)</span>&nbsp;<span class="op" id="4589898">==</span>&nbsp;<span class="num" id="4589901">0</span>&nbsp;<span class="op" id="4589903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589907">return</span>&nbsp;<span class="num" id="4589914">0</span><span class="op" id="4589915">,</span>&nbsp;<span class="ident" id="4589917">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589926">n</span><span class="op" id="4589927">,</span>&nbsp;<span class="ident" id="4589929">err</span>&nbsp;<span class="op" id="4589933">=</span>&nbsp;<span class="ident" id="4589935">z</span><span class="op" id="4589936">.</span><span class="ident" id="4589937">decompressor</span><span class="op" id="4589949">.</span><span class="ident" id="4589950">Read</span><span class="op" id="4589954">(</span><span class="ident" id="4589955">p</span><span class="op" id="4589956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589959">z</span><span class="op" id="4589960">.</span><span class="ident" id="4589961">digest</span><span class="op" id="4589967">.</span><span class="ident" id="4589968">Write</span><span class="op" id="4589973">(</span><span class="ident" id="4589974">p</span><span class="op" id="4589975">[</span><span class="num" id="4589976">0</span><span class="op" id="4589977">:</span><span class="ident" id="4589978">n</span><span class="op" id="4589979">]</span><span class="op" id="4589980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589983">if</span>&nbsp;<span class="ident" id="4589986">n</span>&nbsp;<span class="op" id="4589988">!=</span>&nbsp;<span class="num" id="4589991">0</span>&nbsp;<span class="op" id="4589993">||</span>&nbsp;<span class="ident" id="4589996">err</span>&nbsp;<span class="op" id="4590000">!=</span>&nbsp;<span class="ident" id="4590003">io</span><span class="op" id="4590005">.</span><span class="ident" id="4590006">EOF</span>&nbsp;<span class="op" id="4590010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590014">z</span><span class="op" id="4590015">.</span><span class="ident" id="4590016">err</span>&nbsp;<span class="op" id="4590020">=</span>&nbsp;<span class="ident" id="4590022">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590028">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590040">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590075">if</span>&nbsp;<span class="ident" id="4590078">_</span><span class="op" id="4590079">,</span>&nbsp;<span class="ident" id="4590081">err</span>&nbsp;<span class="op" id="4590085">:=</span>&nbsp;<span class="ident" id="4590088">io</span><span class="op" id="4590090">.</span><span class="ident" id="4590091">ReadFull</span><span class="op" id="4590099">(</span><span class="ident" id="4590100">z</span><span class="op" id="4590101">.</span><span class="ident" id="4590102">r</span><span class="op" id="4590103">,</span>&nbsp;<span class="ident" id="4590105">z</span><span class="op" id="4590106">.</span><span class="ident" id="4590107">scratch</span><span class="op" id="4590114">[</span><span class="num" id="4590115">0</span><span class="op" id="4590116">:</span><span class="num" id="4590117">4</span><span class="op" id="4590118">]</span><span class="op" id="4590119">)</span><span class="op" id="4590120">;</span>&nbsp;<span class="ident" id="4590122">err</span>&nbsp;<span class="op" id="4590126">!=</span>&nbsp;<span class="ident" id="4590129">nil</span>&nbsp;<span class="op" id="4590133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590137">z</span><span class="op" id="4590138">.</span><span class="ident" id="4590139">err</span>&nbsp;<span class="op" id="4590143">=</span>&nbsp;<span class="ident" id="4590145">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590151">return</span>&nbsp;<span class="num" id="4590158">0</span><span class="op" id="4590159">,</span>&nbsp;<span class="ident" id="4590161">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590169">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590228">checksum</span>&nbsp;<span class="op" id="4590237">:=</span>&nbsp;<span class="builtintype" id="4590240">uint32</span><span class="op" id="4590246">(</span><span class="ident" id="4590247">z</span><span class="op" id="4590248">.</span><span class="ident" id="4590249">scratch</span><span class="op" id="4590256">[</span><span class="num" id="4590257">0</span><span class="op" id="4590258">]</span><span class="op" id="4590259">)</span><span class="op" id="4590260">&lt;&lt;</span><span class="num" id="4590262">24</span>&nbsp;<span class="op" id="4590265">|</span>&nbsp;<span class="builtintype" id="4590267">uint32</span><span class="op" id="4590273">(</span><span class="ident" id="4590274">z</span><span class="op" id="4590275">.</span><span class="ident" id="4590276">scratch</span><span class="op" id="4590283">[</span><span class="num" id="4590284">1</span><span class="op" id="4590285">]</span><span class="op" id="4590286">)</span><span class="op" id="4590287">&lt;&lt;</span><span class="num" id="4590289">16</span>&nbsp;<span class="op" id="4590292">|</span>&nbsp;<span class="builtintype" id="4590294">uint32</span><span class="op" id="4590300">(</span><span class="ident" id="4590301">z</span><span class="op" id="4590302">.</span><span class="ident" id="4590303">scratch</span><span class="op" id="4590310">[</span><span class="num" id="4590311">2</span><span class="op" id="4590312">]</span><span class="op" id="4590313">)</span><span class="op" id="4590314">&lt;&lt;</span><span class="num" id="4590316">8</span>&nbsp;<span class="op" id="4590318">|</span>&nbsp;<span class="builtintype" id="4590320">uint32</span><span class="op" id="4590326">(</span><span class="ident" id="4590327">z</span><span class="op" id="4590328">.</span><span class="ident" id="4590329">scratch</span><span class="op" id="4590336">[</span><span class="num" id="4590337">3</span><span class="op" id="4590338">]</span><span class="op" id="4590339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590342">if</span>&nbsp;<span class="ident" id="4590345">checksum</span>&nbsp;<span class="op" id="4590354">!=</span>&nbsp;<span class="ident" id="4590357">z</span><span class="op" id="4590358">.</span><span class="ident" id="4590359">digest</span><span class="op" id="4590365">.</span><span class="ident" id="4590366">Sum32</span><span class="op" id="4590371">(</span><span class="op" id="4590372">)</span>&nbsp;<span class="op" id="4590374">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590378">z</span><span class="op" id="4590379">.</span><span class="ident" id="4590380">err</span>&nbsp;<span class="op" id="4590384">=</span>&nbsp;<span class="ident" id="4590386">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590400">return</span>&nbsp;<span class="num" id="4590407">0</span><span class="op" id="4590408">,</span>&nbsp;<span class="ident" id="4590410">z</span><span class="op" id="4590411">.</span><span class="ident" id="4590412">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590420">return</span><br>
<span class="lineno"></span><span class="op" id="4590427">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4590430">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="4590516">func</span>&nbsp;<span class="op" id="4590521">(</span><span class="ident" id="4590522">z</span>&nbsp;<span class="op" id="4590524">*</span><span class="ident" id="4590525">reader</span><span class="op" id="4590531">)</span>&nbsp;<span class="ident" id="4590533">Close</span><span class="op" id="4590538">(</span><span class="op" id="4590539">)</span>&nbsp;<span class="builtintype" id="4590541">error</span>&nbsp;<span class="op" id="4590547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590550">if</span>&nbsp;<span class="ident" id="4590553">z</span><span class="op" id="4590554">.</span><span class="ident" id="4590555">err</span>&nbsp;<span class="op" id="4590559">!=</span>&nbsp;<span class="ident" id="4590562">nil</span>&nbsp;<span class="op" id="4590566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590570">return</span>&nbsp;<span class="ident" id="4590577">z</span><span class="op" id="4590578">.</span><span class="ident" id="4590579">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590587">z</span><span class="op" id="4590588">.</span><span class="ident" id="4590589">err</span>&nbsp;<span class="op" id="4590593">=</span>&nbsp;<span class="ident" id="4590595">z</span><span class="op" id="4590596">.</span><span class="ident" id="4590597">decompressor</span><span class="op" id="4590609">.</span><span class="ident" id="4590610">Close</span><span class="op" id="4590615">(</span><span class="op" id="4590616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590619">return</span>&nbsp;<span class="ident" id="4590626">z</span><span class="op" id="4590627">.</span><span class="ident" id="4590628">err</span><br>
<span class="lineno"></span><span class="op" id="4590632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4590635">func</span>&nbsp;<span class="op" id="4590640">(</span><span class="ident" id="4590641">z</span>&nbsp;<span class="op" id="4590643">*</span><span class="ident" id="4590644">reader</span><span class="op" id="4590650">)</span>&nbsp;<span class="ident" id="4590652">Reset</span><span class="op" id="4590657">(</span><span class="ident" id="4590658">r</span>&nbsp;<span class="ident" id="4590660">io</span><span class="op" id="4590662">.</span><span class="ident" id="4590663">Reader</span><span class="op" id="4590669">,</span>&nbsp;<span class="ident" id="4590671">dict</span>&nbsp;<span class="op" id="4590676">[</span><span class="op" id="4590677">]</span><span class="builtintype" id="4590678">byte</span><span class="op" id="4590682">)</span>&nbsp;<span class="builtintype" id="4590684">error</span>&nbsp;<span class="op" id="4590690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590693">if</span>&nbsp;<span class="ident" id="4590696">fr</span><span class="op" id="4590698">,</span>&nbsp;<span class="ident" id="4590700">ok</span>&nbsp;<span class="op" id="4590703">:=</span>&nbsp;<span class="ident" id="4590706">r</span><span class="op" id="4590707">.</span><span class="op" id="4590708">(</span><span class="ident" id="4590709">flate</span><span class="op" id="4590714">.</span><span class="ident" id="4590715">Reader</span><span class="op" id="4590721">)</span><span class="op" id="4590722">;</span>&nbsp;<span class="ident" id="4590724">ok</span>&nbsp;<span class="op" id="4590727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590731">z</span><span class="op" id="4590732">.</span><span class="ident" id="4590733">r</span>&nbsp;<span class="op" id="4590735">=</span>&nbsp;<span class="ident" id="4590737">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590741">}</span>&nbsp;<span class="keyword" id="4590743">else</span>&nbsp;<span class="op" id="4590748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590752">z</span><span class="op" id="4590753">.</span><span class="ident" id="4590754">r</span>&nbsp;<span class="op" id="4590756">=</span>&nbsp;<span class="ident" id="4590758">bufio</span><span class="op" id="4590763">.</span><span class="ident" id="4590764">NewReader</span><span class="op" id="4590773">(</span><span class="ident" id="4590774">r</span><span class="op" id="4590775">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590781">_</span><span class="op" id="4590782">,</span>&nbsp;<span class="ident" id="4590784">err</span>&nbsp;<span class="op" id="4590788">:=</span>&nbsp;<span class="ident" id="4590791">io</span><span class="op" id="4590793">.</span><span class="ident" id="4590794">ReadFull</span><span class="op" id="4590802">(</span><span class="ident" id="4590803">z</span><span class="op" id="4590804">.</span><span class="ident" id="4590805">r</span><span class="op" id="4590806">,</span>&nbsp;<span class="ident" id="4590808">z</span><span class="op" id="4590809">.</span><span class="ident" id="4590810">scratch</span><span class="op" id="4590817">[</span><span class="num" id="4590818">0</span><span class="op" id="4590819">:</span><span class="num" id="4590820">2</span><span class="op" id="4590821">]</span><span class="op" id="4590822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590825">if</span>&nbsp;<span class="ident" id="4590828">err</span>&nbsp;<span class="op" id="4590832">!=</span>&nbsp;<span class="ident" id="4590835">nil</span>&nbsp;<span class="op" id="4590839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590843">return</span>&nbsp;<span class="ident" id="4590850">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590855">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590858">h</span>&nbsp;<span class="op" id="4590860">:=</span>&nbsp;<span class="builtintype" id="4590863">uint</span><span class="op" id="4590867">(</span><span class="ident" id="4590868">z</span><span class="op" id="4590869">.</span><span class="ident" id="4590870">scratch</span><span class="op" id="4590877">[</span><span class="num" id="4590878">0</span><span class="op" id="4590879">]</span><span class="op" id="4590880">)</span><span class="op" id="4590881">&lt;&lt;</span><span class="num" id="4590883">8</span>&nbsp;<span class="op" id="4590885">|</span>&nbsp;<span class="builtintype" id="4590887">uint</span><span class="op" id="4590891">(</span><span class="ident" id="4590892">z</span><span class="op" id="4590893">.</span><span class="ident" id="4590894">scratch</span><span class="op" id="4590901">[</span><span class="num" id="4590902">1</span><span class="op" id="4590903">]</span><span class="op" id="4590904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590907">if</span>&nbsp;<span class="op" id="4590910">(</span><span class="ident" id="4590911">z</span><span class="op" id="4590912">.</span><span class="ident" id="4590913">scratch</span><span class="op" id="4590920">[</span><span class="num" id="4590921">0</span><span class="op" id="4590922">]</span><span class="op" id="4590923">&amp;</span><span class="num" id="4590924">0x0f</span>&nbsp;<span class="op" id="4590929">!=</span>&nbsp;<span class="ident" id="4590932">zlibDeflate</span><span class="op" id="4590943">)</span>&nbsp;<span class="op" id="4590945">||</span>&nbsp;<span class="op" id="4590948">(</span><span class="ident" id="4590949">h</span><span class="op" id="4590950">%</span><span class="num" id="4590951">31</span>&nbsp;<span class="op" id="4590954">!=</span>&nbsp;<span class="num" id="4590957">0</span><span class="op" id="4590958">)</span>&nbsp;<span class="op" id="4590960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590964">return</span>&nbsp;<span class="ident" id="4590971">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590985">haveDict</span>&nbsp;<span class="op" id="4590994">:=</span>&nbsp;<span class="ident" id="4590997">z</span><span class="op" id="4590998">.</span><span class="ident" id="4590999">scratch</span><span class="op" id="4591006">[</span><span class="num" id="4591007">1</span><span class="op" id="4591008">]</span><span class="op" id="4591009">&amp;</span><span class="num" id="4591010">0x20</span>&nbsp;<span class="op" id="4591015">!=</span>&nbsp;<span class="num" id="4591018">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591021">if</span>&nbsp;<span class="ident" id="4591024">haveDict</span>&nbsp;<span class="op" id="4591033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591037">_</span><span class="op" id="4591038">,</span>&nbsp;<span class="ident" id="4591040">err</span>&nbsp;<span class="op" id="4591044">=</span>&nbsp;<span class="ident" id="4591046">io</span><span class="op" id="4591048">.</span><span class="ident" id="4591049">ReadFull</span><span class="op" id="4591057">(</span><span class="ident" id="4591058">z</span><span class="op" id="4591059">.</span><span class="ident" id="4591060">r</span><span class="op" id="4591061">,</span>&nbsp;<span class="ident" id="4591063">z</span><span class="op" id="4591064">.</span><span class="ident" id="4591065">scratch</span><span class="op" id="4591072">[</span><span class="num" id="4591073">0</span><span class="op" id="4591074">:</span><span class="num" id="4591075">4</span><span class="op" id="4591076">]</span><span class="op" id="4591077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591081">if</span>&nbsp;<span class="ident" id="4591084">err</span>&nbsp;<span class="op" id="4591088">!=</span>&nbsp;<span class="ident" id="4591091">nil</span>&nbsp;<span class="op" id="4591095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591100">return</span>&nbsp;<span class="ident" id="4591107">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591113">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591117">checksum</span>&nbsp;<span class="op" id="4591126">:=</span>&nbsp;<span class="builtintype" id="4591129">uint32</span><span class="op" id="4591135">(</span><span class="ident" id="4591136">z</span><span class="op" id="4591137">.</span><span class="ident" id="4591138">scratch</span><span class="op" id="4591145">[</span><span class="num" id="4591146">0</span><span class="op" id="4591147">]</span><span class="op" id="4591148">)</span><span class="op" id="4591149">&lt;&lt;</span><span class="num" id="4591151">24</span>&nbsp;<span class="op" id="4591154">|</span>&nbsp;<span class="builtintype" id="4591156">uint32</span><span class="op" id="4591162">(</span><span class="ident" id="4591163">z</span><span class="op" id="4591164">.</span><span class="ident" id="4591165">scratch</span><span class="op" id="4591172">[</span><span class="num" id="4591173">1</span><span class="op" id="4591174">]</span><span class="op" id="4591175">)</span><span class="op" id="4591176">&lt;&lt;</span><span class="num" id="4591178">16</span>&nbsp;<span class="op" id="4591181">|</span>&nbsp;<span class="builtintype" id="4591183">uint32</span><span class="op" id="4591189">(</span><span class="ident" id="4591190">z</span><span class="op" id="4591191">.</span><span class="ident" id="4591192">scratch</span><span class="op" id="4591199">[</span><span class="num" id="4591200">2</span><span class="op" id="4591201">]</span><span class="op" id="4591202">)</span><span class="op" id="4591203">&lt;&lt;</span><span class="num" id="4591205">8</span>&nbsp;<span class="op" id="4591207">|</span>&nbsp;<span class="builtintype" id="4591209">uint32</span><span class="op" id="4591215">(</span><span class="ident" id="4591216">z</span><span class="op" id="4591217">.</span><span class="ident" id="4591218">scratch</span><span class="op" id="4591225">[</span><span class="num" id="4591226">3</span><span class="op" id="4591227">]</span><span class="op" id="4591228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591232">if</span>&nbsp;<span class="ident" id="4591235">checksum</span>&nbsp;<span class="op" id="4591244">!=</span>&nbsp;<span class="ident" id="4591247">adler32</span><span class="op" id="4591254">.</span><span class="ident" id="4591255">Checksum</span><span class="op" id="4591263">(</span><span class="ident" id="4591264">dict</span><span class="op" id="4591268">)</span>&nbsp;<span class="op" id="4591270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591275">return</span>&nbsp;<span class="ident" id="4591282">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591301">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591304">if</span>&nbsp;<span class="ident" id="4591307">z</span><span class="op" id="4591308">.</span><span class="ident" id="4591309">decompressor</span>&nbsp;<span class="op" id="4591322">==</span>&nbsp;<span class="ident" id="4591325">nil</span>&nbsp;<span class="op" id="4591329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591333">if</span>&nbsp;<span class="ident" id="4591336">haveDict</span>&nbsp;<span class="op" id="4591345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591350">z</span><span class="op" id="4591351">.</span><span class="ident" id="4591352">decompressor</span>&nbsp;<span class="op" id="4591365">=</span>&nbsp;<span class="ident" id="4591367">flate</span><span class="op" id="4591372">.</span><span class="ident" id="4591373">NewReaderDict</span><span class="op" id="4591386">(</span><span class="ident" id="4591387">z</span><span class="op" id="4591388">.</span><span class="ident" id="4591389">r</span><span class="op" id="4591390">,</span>&nbsp;<span class="ident" id="4591392">dict</span><span class="op" id="4591396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591400">}</span>&nbsp;<span class="keyword" id="4591402">else</span>&nbsp;<span class="op" id="4591407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591412">z</span><span class="op" id="4591413">.</span><span class="ident" id="4591414">decompressor</span>&nbsp;<span class="op" id="4591427">=</span>&nbsp;<span class="ident" id="4591429">flate</span><span class="op" id="4591434">.</span><span class="ident" id="4591435">NewReader</span><span class="op" id="4591444">(</span><span class="ident" id="4591445">z</span><span class="op" id="4591446">.</span><span class="ident" id="4591447">r</span><span class="op" id="4591448">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591455">}</span>&nbsp;<span class="keyword" id="4591457">else</span>&nbsp;<span class="op" id="4591462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591466">z</span><span class="op" id="4591467">.</span><span class="ident" id="4591468">decompressor</span><span class="op" id="4591480">.</span><span class="op" id="4591481">(</span><span class="ident" id="4591482">flate</span><span class="op" id="4591487">.</span><span class="ident" id="4591488">Resetter</span><span class="op" id="4591496">)</span><span class="op" id="4591497">.</span><span class="ident" id="4591498">Reset</span><span class="op" id="4591503">(</span><span class="ident" id="4591504">z</span><span class="op" id="4591505">.</span><span class="ident" id="4591506">r</span><span class="op" id="4591507">,</span>&nbsp;<span class="ident" id="4591509">dict</span><span class="op" id="4591513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591519">z</span><span class="op" id="4591520">.</span><span class="ident" id="4591521">digest</span>&nbsp;<span class="op" id="4591528">=</span>&nbsp;<span class="ident" id="4591530">adler32</span><span class="op" id="4591537">.</span><span class="ident" id="4591538">New</span><span class="op" id="4591541">(</span><span class="op" id="4591542">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591545">return</span>&nbsp;<span class="ident" id="4591552">nil</span><br>
<span class="lineno"></span><span class="op" id="4591556">}</span>
</div>
</body>
</html>
