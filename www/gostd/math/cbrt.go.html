<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1531341">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1531396">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1531450">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1531501">package</span>&nbsp;<span class="ident" id="1531509">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1531515">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspThe&nbsp;algorithm&nbsp;is&nbsp;based&nbsp;in&nbsp;part&nbsp;on&nbsp;&#34;Optimal&nbsp;Partitioning&nbsp;of<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspNewton&#39;s&nbsp;Method&nbsp;for&nbsp;Calculating&nbsp;Roots&#34;,&nbsp;by&nbsp;Gunter&nbsp;Meinardus<br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbspand&nbsp;G.&nbsp;D.&nbsp;Taylor,&nbsp;Mathematics&nbsp;of&nbsp;Computation&nbsp;©&nbsp;1980&nbsp;American<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspMathematical&nbsp;Society.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp(http://www.jstor.org/stable/2006387?seq=9,&nbsp;accessed&nbsp;11-Feb-2010)<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="1531796">//&nbsp;Cbrt&nbsp;returns&nbsp;the&nbsp;cube&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1531832">//</span><br>
<span class="lineno"></span><span class="comment" id="1531835">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1531857">//&nbsp;&nbsp;&nbsp;&nbspCbrt(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1531876">//&nbsp;&nbsp;&nbsp;&nbspCbrt(±Inf)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno">20</span><span class="comment" id="1531899">//&nbsp;&nbsp;&nbsp;&nbspCbrt(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1531918">func</span>&nbsp;<span class="ident" id="1531923">Cbrt</span><span class="op" id="1531927">(</span><span class="ident" id="1531928">x</span>&nbsp;<span class="builtintype" id="1531930">float64</span><span class="op" id="1531937">)</span>&nbsp;<span class="builtintype" id="1531939">float64</span>&nbsp;<span class="op" id="1531947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531950">const</span>&nbsp;<span class="op" id="1531956">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1531960">A1</span>&nbsp;<span class="op" id="1531963">=</span>&nbsp;<span class="num" id="1531965">1.662848358e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1531983">A2</span>&nbsp;<span class="op" id="1531986">=</span>&nbsp;<span class="num" id="1531988">1.096040958e+00</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532006">A3</span>&nbsp;<span class="op" id="1532009">=</span>&nbsp;<span class="num" id="1532011">4.105032829e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532029">A4</span>&nbsp;<span class="op" id="1532032">=</span>&nbsp;<span class="num" id="1532034">5.649335816e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532052">B1</span>&nbsp;<span class="op" id="1532055">=</span>&nbsp;<span class="num" id="1532057">2.639607233e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532075">B2</span>&nbsp;<span class="op" id="1532078">=</span>&nbsp;<span class="num" id="1532080">8.699282849e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532098">B3</span>&nbsp;<span class="op" id="1532101">=</span>&nbsp;<span class="num" id="1532103">1.629083358e-01</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532121">B4</span>&nbsp;<span class="op" id="1532124">=</span>&nbsp;<span class="num" id="1532126">2.824667908e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532144">C1</span>&nbsp;<span class="op" id="1532147">=</span>&nbsp;<span class="num" id="1532149">4.190115298e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532167">C2</span>&nbsp;<span class="op" id="1532170">=</span>&nbsp;<span class="num" id="1532172">6.904625373e-01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532190">C3</span>&nbsp;<span class="op" id="1532193">=</span>&nbsp;<span class="num" id="1532195">6.46502159e-02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532212">C4</span>&nbsp;<span class="op" id="1532215">=</span>&nbsp;<span class="num" id="1532217">1.412333954e-01</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1532237">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532255">switch</span>&nbsp;<span class="op" id="1532262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532265">case</span>&nbsp;<span class="ident" id="1532270">x</span>&nbsp;<span class="op" id="1532272">==</span>&nbsp;<span class="num" id="1532275">0</span>&nbsp;<span class="op" id="1532277">||</span>&nbsp;<span class="ident" id="1532280">IsNaN</span><span class="op" id="1532285">(</span><span class="ident" id="1532286">x</span><span class="op" id="1532287">)</span>&nbsp;<span class="op" id="1532289">||</span>&nbsp;<span class="ident" id="1532292">IsInf</span><span class="op" id="1532297">(</span><span class="ident" id="1532298">x</span><span class="op" id="1532299">,</span>&nbsp;<span class="num" id="1532301">0</span><span class="op" id="1532302">)</span><span class="op" id="1532303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532307">return</span>&nbsp;<span class="ident" id="1532314">x</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532320">sign</span>&nbsp;<span class="op" id="1532325">:=</span>&nbsp;<span class="builtintype" id="1532328">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532335">if</span>&nbsp;<span class="ident" id="1532338">x</span>&nbsp;<span class="op" id="1532340">&lt;</span>&nbsp;<span class="num" id="1532342">0</span>&nbsp;<span class="op" id="1532344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532348">x</span>&nbsp;<span class="op" id="1532350">=</span>&nbsp;<span class="op" id="1532352">-</span><span class="ident" id="1532353">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532357">sign</span>&nbsp;<span class="op" id="1532362">=</span>&nbsp;<span class="builtintype" id="1532364">true</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1532373">//&nbsp;Reduce&nbsp;argument&nbsp;and&nbsp;estimate&nbsp;cube&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532416">f</span><span class="op" id="1532417">,</span>&nbsp;<span class="ident" id="1532419">e</span>&nbsp;<span class="op" id="1532421">:=</span>&nbsp;<span class="ident" id="1532424">Frexp</span><span class="op" id="1532429">(</span><span class="ident" id="1532430">x</span><span class="op" id="1532431">)</span>&nbsp;<span class="comment" id="1532433">//&nbsp;0.5&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532452">m</span>&nbsp;<span class="op" id="1532454">:=</span>&nbsp;<span class="ident" id="1532457">e</span>&nbsp;<span class="op" id="1532459">%</span>&nbsp;<span class="num" id="1532461">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532464">if</span>&nbsp;<span class="ident" id="1532467">m</span>&nbsp;<span class="op" id="1532469">&gt;</span>&nbsp;<span class="num" id="1532471">0</span>&nbsp;<span class="op" id="1532473">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532477">m</span>&nbsp;<span class="op" id="1532479">-=</span>&nbsp;<span class="num" id="1532482">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532486">e</span>&nbsp;<span class="op" id="1532488">-=</span>&nbsp;<span class="ident" id="1532491">m</span>&nbsp;<span class="comment" id="1532493">//&nbsp;e&nbsp;is&nbsp;multiple&nbsp;of&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532519">switch</span>&nbsp;<span class="ident" id="1532526">m</span>&nbsp;<span class="op" id="1532528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532531">case</span>&nbsp;<span class="num" id="1532536">0</span><span class="op" id="1532537">:</span>&nbsp;<span class="comment" id="1532539">//&nbsp;0.5&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;1.0</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532559">f</span>&nbsp;<span class="op" id="1532561">=</span>&nbsp;<span class="ident" id="1532563">A1</span><span class="op" id="1532565">*</span><span class="ident" id="1532566">f</span>&nbsp;<span class="op" id="1532568">+</span>&nbsp;<span class="ident" id="1532570">A2</span>&nbsp;<span class="op" id="1532573">-</span>&nbsp;<span class="ident" id="1532575">A3</span><span class="op" id="1532577">/</span><span class="op" id="1532578">(</span><span class="ident" id="1532579">A4</span><span class="op" id="1532581">+</span><span class="ident" id="1532582">f</span><span class="op" id="1532583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532586">case</span>&nbsp;<span class="op" id="1532591">-</span><span class="num" id="1532592">1</span><span class="op" id="1532593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532597">f</span>&nbsp;<span class="op" id="1532599">*=</span>&nbsp;<span class="num" id="1532602">0.5</span>&nbsp;<span class="comment" id="1532606">//&nbsp;0.25&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532627">f</span>&nbsp;<span class="op" id="1532629">=</span>&nbsp;<span class="ident" id="1532631">B1</span><span class="op" id="1532633">*</span><span class="ident" id="1532634">f</span>&nbsp;<span class="op" id="1532636">+</span>&nbsp;<span class="ident" id="1532638">B2</span>&nbsp;<span class="op" id="1532641">-</span>&nbsp;<span class="ident" id="1532643">B3</span><span class="op" id="1532645">/</span><span class="op" id="1532646">(</span><span class="ident" id="1532647">B4</span><span class="op" id="1532649">+</span><span class="ident" id="1532650">f</span><span class="op" id="1532651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532654">default</span><span class="op" id="1532661">:</span>&nbsp;<span class="comment" id="1532663">//&nbsp;m&nbsp;==&nbsp;-2</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532676">f</span>&nbsp;<span class="op" id="1532678">*=</span>&nbsp;<span class="num" id="1532681">0.25</span>&nbsp;<span class="comment" id="1532686">//&nbsp;0.125&nbsp;&lt;=&nbsp;f&nbsp;&lt;&nbsp;0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532709">f</span>&nbsp;<span class="op" id="1532711">=</span>&nbsp;<span class="ident" id="1532713">C1</span><span class="op" id="1532715">*</span><span class="ident" id="1532716">f</span>&nbsp;<span class="op" id="1532718">+</span>&nbsp;<span class="ident" id="1532720">C2</span>&nbsp;<span class="op" id="1532723">-</span>&nbsp;<span class="ident" id="1532725">C3</span><span class="op" id="1532727">/</span><span class="op" id="1532728">(</span><span class="ident" id="1532729">C4</span><span class="op" id="1532731">+</span><span class="ident" id="1532732">f</span><span class="op" id="1532733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532739">y</span>&nbsp;<span class="op" id="1532741">:=</span>&nbsp;<span class="ident" id="1532744">Ldexp</span><span class="op" id="1532749">(</span><span class="ident" id="1532750">f</span><span class="op" id="1532751">,</span>&nbsp;<span class="ident" id="1532753">e</span><span class="op" id="1532754">/</span><span class="num" id="1532755">3</span><span class="op" id="1532756">)</span>&nbsp;<span class="comment" id="1532758">//&nbsp;e/3&nbsp;=&nbsp;exponent&nbsp;of&nbsp;cube&nbsp;root</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1532791">//&nbsp;Iterate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532803">s</span>&nbsp;<span class="op" id="1532805">:=</span>&nbsp;<span class="ident" id="1532808">y</span>&nbsp;<span class="op" id="1532810">*</span>&nbsp;<span class="ident" id="1532812">y</span>&nbsp;<span class="op" id="1532814">*</span>&nbsp;<span class="ident" id="1532816">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532819">t</span>&nbsp;<span class="op" id="1532821">:=</span>&nbsp;<span class="ident" id="1532824">s</span>&nbsp;<span class="op" id="1532826">+</span>&nbsp;<span class="ident" id="1532828">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532831">y</span>&nbsp;<span class="op" id="1532833">*=</span>&nbsp;<span class="op" id="1532836">(</span><span class="ident" id="1532837">t</span>&nbsp;<span class="op" id="1532839">+</span>&nbsp;<span class="ident" id="1532841">x</span><span class="op" id="1532842">)</span>&nbsp;<span class="op" id="1532844">/</span>&nbsp;<span class="op" id="1532846">(</span><span class="ident" id="1532847">s</span>&nbsp;<span class="op" id="1532849">+</span>&nbsp;<span class="ident" id="1532851">t</span><span class="op" id="1532852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1532855">//&nbsp;Reiterate</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532869">s</span>&nbsp;<span class="op" id="1532871">=</span>&nbsp;<span class="op" id="1532873">(</span><span class="ident" id="1532874">y</span><span class="op" id="1532875">*</span><span class="ident" id="1532876">y</span><span class="op" id="1532877">*</span><span class="ident" id="1532878">y</span>&nbsp;<span class="op" id="1532880">-</span>&nbsp;<span class="ident" id="1532882">x</span><span class="op" id="1532883">)</span>&nbsp;<span class="op" id="1532885">/</span>&nbsp;<span class="ident" id="1532887">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532890">y</span>&nbsp;<span class="op" id="1532892">-=</span>&nbsp;<span class="ident" id="1532895">y</span>&nbsp;<span class="op" id="1532897">*</span>&nbsp;<span class="op" id="1532899">(</span><span class="op" id="1532900">(</span><span class="op" id="1532901">(</span><span class="num" id="1532902">14.0</span><span class="op" id="1532906">/</span><span class="num" id="1532907">81.0</span><span class="op" id="1532911">)</span><span class="op" id="1532912">*</span><span class="ident" id="1532913">s</span><span class="op" id="1532914">-</span><span class="op" id="1532915">(</span><span class="num" id="1532916">2.0</span><span class="op" id="1532919">/</span><span class="num" id="1532920">9.0</span><span class="op" id="1532923">)</span><span class="op" id="1532924">)</span><span class="op" id="1532925">*</span><span class="ident" id="1532926">s</span>&nbsp;<span class="op" id="1532928">+</span>&nbsp;<span class="op" id="1532930">(</span><span class="num" id="1532931">1.0</span>&nbsp;<span class="op" id="1532935">/</span>&nbsp;<span class="num" id="1532937">3.0</span><span class="op" id="1532940">)</span><span class="op" id="1532941">)</span>&nbsp;<span class="op" id="1532943">*</span>&nbsp;<span class="ident" id="1532945">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532948">if</span>&nbsp;<span class="ident" id="1532951">sign</span>&nbsp;<span class="op" id="1532956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532960">y</span>&nbsp;<span class="op" id="1532962">=</span>&nbsp;<span class="op" id="1532964">-</span><span class="ident" id="1532965">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532968">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532971">return</span>&nbsp;<span class="ident" id="1532978">y</span><br>
<span class="lineno"></span><span class="op" id="1532980">}</span>
</div>
</body>
</html>
