<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2175517">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2175572">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2175626">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2175677">package</span>&nbsp;<span class="ident" id="2175685">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2175691">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2175741">//</span><br>
<span class="lineno"></span><span class="comment" id="2175744">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2175766">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2175786">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2175804">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2175848">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2175885">func</span>&nbsp;<span class="ident" id="2175890">Exp</span><span class="op" id="2175893">(</span><span class="ident" id="2175894">x</span>&nbsp;<span class="builtintype" id="2175896">float64</span><span class="op" id="2175903">)</span>&nbsp;<span class="builtintype" id="2175905">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2175914">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2175974">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2176032">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2176091">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2176121">//</span><br>
<span class="lineno"></span><span class="comment" id="2176124">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2176180">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2176249">//</span><br>
<span class="lineno"></span><span class="comment" id="2176252">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2176308">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2176365">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2176382">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2176438">//</span><br>
<span class="lineno"></span><span class="comment" id="2176441">//</span><br>
<span class="lineno">30</span><span class="comment" id="2176444">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2176454">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2176487">//</span><br>
<span class="lineno"></span><span class="comment" id="2176490">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2176500">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2176528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2176587">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2176635">//</span><br>
<span class="lineno"></span><span class="comment" id="2176638">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2176687">//</span><br>
<span class="lineno">40</span><span class="comment" id="2176690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2176749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2176767">//</span><br>
<span class="lineno"></span><span class="comment" id="2176770">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2176836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2176870">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2176884">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2176959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2177027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2177096">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2177162">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2177183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2177253">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2177320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2177332">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2177384">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2177433">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2177477">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2177524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2177559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2177596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2177632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2177675">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2177742">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2177786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2177800">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2177858">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2177919">//</span><br>
<span class="lineno"></span><span class="comment" id="2177922">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2177959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2177988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2178022">//</span><br>
<span class="lineno"></span><span class="comment" id="2178025">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2178043">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2178085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2178113">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2178166">//</span><br>
<span class="lineno"></span><span class="comment" id="2178169">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2178182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2178252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2178292">//</span><br>
<span class="lineno"></span><span class="comment" id="2178295">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2178310">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2178334">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2178402">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2178471">//</span><br>
<span class="lineno"></span><span class="comment" id="2178474">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2178488">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2178554">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2178618">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2178684">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2178729">func</span>&nbsp;<span class="ident" id="2178734">exp</span><span class="op" id="2178737">(</span><span class="ident" id="2178738">x</span>&nbsp;<span class="builtintype" id="2178740">float64</span><span class="op" id="2178747">)</span>&nbsp;<span class="builtintype" id="2178749">float64</span>&nbsp;<span class="op" id="2178757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178760">const</span>&nbsp;<span class="op" id="2178766">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178770">Ln2Hi</span>&nbsp;<span class="op" id="2178776">=</span>&nbsp;<span class="num" id="2178778">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178807">Ln2Lo</span>&nbsp;<span class="op" id="2178813">=</span>&nbsp;<span class="num" id="2178815">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178844">Log2e</span>&nbsp;<span class="op" id="2178850">=</span>&nbsp;<span class="num" id="2178852">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178882">Overflow</span>&nbsp;&nbsp;<span class="op" id="2178892">=</span>&nbsp;<span class="num" id="2178894">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178923">Underflow</span>&nbsp;<span class="op" id="2178933">=</span>&nbsp;<span class="op" id="2178935">-</span><span class="num" id="2178936">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178965">NearZero</span>&nbsp;&nbsp;<span class="op" id="2178975">=</span>&nbsp;<span class="num" id="2178977">1.0</span>&nbsp;<span class="op" id="2178981">/</span>&nbsp;<span class="op" id="2178983">(</span><span class="num" id="2178984">1</span>&nbsp;<span class="op" id="2178986">&lt;&lt;</span>&nbsp;<span class="num" id="2178989">28</span><span class="op" id="2178991">)</span>&nbsp;<span class="comment" id="2178993">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179004">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179008">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179026">switch</span>&nbsp;<span class="op" id="2179033">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179036">case</span>&nbsp;<span class="ident" id="2179041">IsNaN</span><span class="op" id="2179046">(</span><span class="ident" id="2179047">x</span><span class="op" id="2179048">)</span>&nbsp;<span class="op" id="2179050">||</span>&nbsp;<span class="ident" id="2179053">IsInf</span><span class="op" id="2179058">(</span><span class="ident" id="2179059">x</span><span class="op" id="2179060">,</span>&nbsp;<span class="num" id="2179062">1</span><span class="op" id="2179063">)</span><span class="op" id="2179064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179068">return</span>&nbsp;<span class="ident" id="2179075">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179078">case</span>&nbsp;<span class="ident" id="2179083">IsInf</span><span class="op" id="2179088">(</span><span class="ident" id="2179089">x</span><span class="op" id="2179090">,</span>&nbsp;<span class="op" id="2179092">-</span><span class="num" id="2179093">1</span><span class="op" id="2179094">)</span><span class="op" id="2179095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179099">return</span>&nbsp;<span class="num" id="2179106">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179109">case</span>&nbsp;<span class="ident" id="2179114">x</span>&nbsp;<span class="op" id="2179116">&gt;</span>&nbsp;<span class="ident" id="2179118">Overflow</span><span class="op" id="2179126">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179130">return</span>&nbsp;<span class="ident" id="2179137">Inf</span><span class="op" id="2179140">(</span><span class="num" id="2179141">1</span><span class="op" id="2179142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179145">case</span>&nbsp;<span class="ident" id="2179150">x</span>&nbsp;<span class="op" id="2179152">&lt;</span>&nbsp;<span class="ident" id="2179154">Underflow</span><span class="op" id="2179163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179167">return</span>&nbsp;<span class="num" id="2179174">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179177">case</span>&nbsp;<span class="op" id="2179182">-</span><span class="ident" id="2179183">NearZero</span>&nbsp;<span class="op" id="2179192">&lt;</span>&nbsp;<span class="ident" id="2179194">x</span>&nbsp;<span class="op" id="2179196">&amp;&amp;</span>&nbsp;<span class="ident" id="2179199">x</span>&nbsp;<span class="op" id="2179201">&lt;</span>&nbsp;<span class="ident" id="2179203">NearZero</span><span class="op" id="2179211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179215">return</span>&nbsp;<span class="num" id="2179222">1</span>&nbsp;<span class="op" id="2179224">+</span>&nbsp;<span class="ident" id="2179226">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179233">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179290">var</span>&nbsp;<span class="ident" id="2179294">k</span>&nbsp;<span class="builtintype" id="2179296">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179301">switch</span>&nbsp;<span class="op" id="2179308">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179311">case</span>&nbsp;<span class="ident" id="2179316">x</span>&nbsp;<span class="op" id="2179318">&lt;</span>&nbsp;<span class="num" id="2179320">0</span><span class="op" id="2179321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179325">k</span>&nbsp;<span class="op" id="2179327">=</span>&nbsp;<span class="builtintype" id="2179329">int</span><span class="op" id="2179332">(</span><span class="ident" id="2179333">Log2e</span><span class="op" id="2179338">*</span><span class="ident" id="2179339">x</span>&nbsp;<span class="op" id="2179341">-</span>&nbsp;<span class="num" id="2179343">0.5</span><span class="op" id="2179346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179349">case</span>&nbsp;<span class="ident" id="2179354">x</span>&nbsp;<span class="op" id="2179356">&gt;</span>&nbsp;<span class="num" id="2179358">0</span><span class="op" id="2179359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179363">k</span>&nbsp;<span class="op" id="2179365">=</span>&nbsp;<span class="builtintype" id="2179367">int</span><span class="op" id="2179370">(</span><span class="ident" id="2179371">Log2e</span><span class="op" id="2179376">*</span><span class="ident" id="2179377">x</span>&nbsp;<span class="op" id="2179379">+</span>&nbsp;<span class="num" id="2179381">0.5</span><span class="op" id="2179384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179387">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179390">hi</span>&nbsp;<span class="op" id="2179393">:=</span>&nbsp;<span class="ident" id="2179396">x</span>&nbsp;<span class="op" id="2179398">-</span>&nbsp;<span class="builtintype" id="2179400">float64</span><span class="op" id="2179407">(</span><span class="ident" id="2179408">k</span><span class="op" id="2179409">)</span><span class="op" id="2179410">*</span><span class="ident" id="2179411">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179418">lo</span>&nbsp;<span class="op" id="2179421">:=</span>&nbsp;<span class="builtintype" id="2179424">float64</span><span class="op" id="2179431">(</span><span class="ident" id="2179432">k</span><span class="op" id="2179433">)</span>&nbsp;<span class="op" id="2179435">*</span>&nbsp;<span class="ident" id="2179437">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179445">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179457">return</span>&nbsp;<span class="ident" id="2179464">expmulti</span><span class="op" id="2179472">(</span><span class="ident" id="2179473">hi</span><span class="op" id="2179475">,</span>&nbsp;<span class="ident" id="2179477">lo</span><span class="op" id="2179479">,</span>&nbsp;<span class="ident" id="2179481">k</span><span class="op" id="2179482">)</span><br>
<span class="lineno">130</span><span class="op" id="2179484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2179487">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2179538">//</span><br>
<span class="lineno"></span><span class="comment" id="2179541">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2179579">func</span>&nbsp;<span class="ident" id="2179584">Exp2</span><span class="op" id="2179588">(</span><span class="ident" id="2179589">x</span>&nbsp;<span class="builtintype" id="2179591">float64</span><span class="op" id="2179598">)</span>&nbsp;<span class="builtintype" id="2179600">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2179609">func</span>&nbsp;<span class="ident" id="2179614">exp2</span><span class="op" id="2179618">(</span><span class="ident" id="2179619">x</span>&nbsp;<span class="builtintype" id="2179621">float64</span><span class="op" id="2179628">)</span>&nbsp;<span class="builtintype" id="2179630">float64</span>&nbsp;<span class="op" id="2179638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179641">const</span>&nbsp;<span class="op" id="2179647">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179651">Ln2Hi</span>&nbsp;<span class="op" id="2179657">=</span>&nbsp;<span class="num" id="2179659">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179688">Ln2Lo</span>&nbsp;<span class="op" id="2179694">=</span>&nbsp;<span class="num" id="2179696">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179726">Overflow</span>&nbsp;&nbsp;<span class="op" id="2179736">=</span>&nbsp;<span class="num" id="2179738">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179763">Underflow</span>&nbsp;<span class="op" id="2179773">=</span>&nbsp;<span class="op" id="2179775">-</span><span class="num" id="2179776">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179788">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179792">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179810">switch</span>&nbsp;<span class="op" id="2179817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179820">case</span>&nbsp;<span class="ident" id="2179825">IsNaN</span><span class="op" id="2179830">(</span><span class="ident" id="2179831">x</span><span class="op" id="2179832">)</span>&nbsp;<span class="op" id="2179834">||</span>&nbsp;<span class="ident" id="2179837">IsInf</span><span class="op" id="2179842">(</span><span class="ident" id="2179843">x</span><span class="op" id="2179844">,</span>&nbsp;<span class="num" id="2179846">1</span><span class="op" id="2179847">)</span><span class="op" id="2179848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179852">return</span>&nbsp;<span class="ident" id="2179859">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179862">case</span>&nbsp;<span class="ident" id="2179867">IsInf</span><span class="op" id="2179872">(</span><span class="ident" id="2179873">x</span><span class="op" id="2179874">,</span>&nbsp;<span class="op" id="2179876">-</span><span class="num" id="2179877">1</span><span class="op" id="2179878">)</span><span class="op" id="2179879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179883">return</span>&nbsp;<span class="num" id="2179890">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179893">case</span>&nbsp;<span class="ident" id="2179898">x</span>&nbsp;<span class="op" id="2179900">&gt;</span>&nbsp;<span class="ident" id="2179902">Overflow</span><span class="op" id="2179910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179914">return</span>&nbsp;<span class="ident" id="2179921">Inf</span><span class="op" id="2179924">(</span><span class="num" id="2179925">1</span><span class="op" id="2179926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179929">case</span>&nbsp;<span class="ident" id="2179934">x</span>&nbsp;<span class="op" id="2179936">&lt;</span>&nbsp;<span class="ident" id="2179938">Underflow</span><span class="op" id="2179947">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179951">return</span>&nbsp;<span class="num" id="2179958">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179965">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2180028">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180077">var</span>&nbsp;<span class="ident" id="2180081">k</span>&nbsp;<span class="builtintype" id="2180083">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180088">switch</span>&nbsp;<span class="op" id="2180095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180098">case</span>&nbsp;<span class="ident" id="2180103">x</span>&nbsp;<span class="op" id="2180105">&gt;</span>&nbsp;<span class="num" id="2180107">0</span><span class="op" id="2180108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180112">k</span>&nbsp;<span class="op" id="2180114">=</span>&nbsp;<span class="builtintype" id="2180116">int</span><span class="op" id="2180119">(</span><span class="ident" id="2180120">x</span>&nbsp;<span class="op" id="2180122">+</span>&nbsp;<span class="num" id="2180124">0.5</span><span class="op" id="2180127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180130">case</span>&nbsp;<span class="ident" id="2180135">x</span>&nbsp;<span class="op" id="2180137">&lt;</span>&nbsp;<span class="num" id="2180139">0</span><span class="op" id="2180140">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180144">k</span>&nbsp;<span class="op" id="2180146">=</span>&nbsp;<span class="builtintype" id="2180148">int</span><span class="op" id="2180151">(</span><span class="ident" id="2180152">x</span>&nbsp;<span class="op" id="2180154">-</span>&nbsp;<span class="num" id="2180156">0.5</span><span class="op" id="2180159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2180162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180165">t</span>&nbsp;<span class="op" id="2180167">:=</span>&nbsp;<span class="ident" id="2180170">x</span>&nbsp;<span class="op" id="2180172">-</span>&nbsp;<span class="builtintype" id="2180174">float64</span><span class="op" id="2180181">(</span><span class="ident" id="2180182">k</span><span class="op" id="2180183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180186">hi</span>&nbsp;<span class="op" id="2180189">:=</span>&nbsp;<span class="ident" id="2180192">t</span>&nbsp;<span class="op" id="2180194">*</span>&nbsp;<span class="ident" id="2180196">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180203">lo</span>&nbsp;<span class="op" id="2180206">:=</span>&nbsp;<span class="op" id="2180209">-</span><span class="ident" id="2180210">t</span>&nbsp;<span class="op" id="2180212">*</span>&nbsp;<span class="ident" id="2180214">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2180222">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180234">return</span>&nbsp;<span class="ident" id="2180241">expmulti</span><span class="op" id="2180249">(</span><span class="ident" id="2180250">hi</span><span class="op" id="2180252">,</span>&nbsp;<span class="ident" id="2180254">lo</span><span class="op" id="2180256">,</span>&nbsp;<span class="ident" id="2180258">k</span><span class="op" id="2180259">)</span><br>
<span class="lineno"></span><span class="op" id="2180261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2180264">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2180332">func</span>&nbsp;<span class="ident" id="2180337">expmulti</span><span class="op" id="2180345">(</span><span class="ident" id="2180346">hi</span><span class="op" id="2180348">,</span>&nbsp;<span class="ident" id="2180350">lo</span>&nbsp;<span class="builtintype" id="2180353">float64</span><span class="op" id="2180360">,</span>&nbsp;<span class="ident" id="2180362">k</span>&nbsp;<span class="builtintype" id="2180364">int</span><span class="op" id="2180367">)</span>&nbsp;<span class="builtintype" id="2180369">float64</span>&nbsp;<span class="op" id="2180377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180380">const</span>&nbsp;<span class="op" id="2180386">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180390">P1</span>&nbsp;<span class="op" id="2180393">=</span>&nbsp;<span class="num" id="2180395">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2180423">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180454">P2</span>&nbsp;<span class="op" id="2180457">=</span>&nbsp;<span class="op" id="2180459">-</span><span class="num" id="2180460">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2180487">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180518">P3</span>&nbsp;<span class="op" id="2180521">=</span>&nbsp;<span class="num" id="2180523">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2180551">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180582">P4</span>&nbsp;<span class="op" id="2180585">=</span>&nbsp;<span class="op" id="2180587">-</span><span class="num" id="2180588">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2180615">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180646">P5</span>&nbsp;<span class="op" id="2180649">=</span>&nbsp;<span class="num" id="2180651">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2180679">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2180709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180713">r</span>&nbsp;<span class="op" id="2180715">:=</span>&nbsp;<span class="ident" id="2180718">hi</span>&nbsp;<span class="op" id="2180721">-</span>&nbsp;<span class="ident" id="2180723">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180727">t</span>&nbsp;<span class="op" id="2180729">:=</span>&nbsp;<span class="ident" id="2180732">r</span>&nbsp;<span class="op" id="2180734">*</span>&nbsp;<span class="ident" id="2180736">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180739">c</span>&nbsp;<span class="op" id="2180741">:=</span>&nbsp;<span class="ident" id="2180744">r</span>&nbsp;<span class="op" id="2180746">-</span>&nbsp;<span class="ident" id="2180748">t</span><span class="op" id="2180749">*</span><span class="op" id="2180750">(</span><span class="ident" id="2180751">P1</span><span class="op" id="2180753">+</span><span class="ident" id="2180754">t</span><span class="op" id="2180755">*</span><span class="op" id="2180756">(</span><span class="ident" id="2180757">P2</span><span class="op" id="2180759">+</span><span class="ident" id="2180760">t</span><span class="op" id="2180761">*</span><span class="op" id="2180762">(</span><span class="ident" id="2180763">P3</span><span class="op" id="2180765">+</span><span class="ident" id="2180766">t</span><span class="op" id="2180767">*</span><span class="op" id="2180768">(</span><span class="ident" id="2180769">P4</span><span class="op" id="2180771">+</span><span class="ident" id="2180772">t</span><span class="op" id="2180773">*</span><span class="ident" id="2180774">P5</span><span class="op" id="2180776">)</span><span class="op" id="2180777">)</span><span class="op" id="2180778">)</span><span class="op" id="2180779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2180782">y</span>&nbsp;<span class="op" id="2180784">:=</span>&nbsp;<span class="num" id="2180787">1</span>&nbsp;<span class="op" id="2180789">-</span>&nbsp;<span class="op" id="2180791">(</span><span class="op" id="2180792">(</span><span class="ident" id="2180793">lo</span>&nbsp;<span class="op" id="2180796">-</span>&nbsp;<span class="op" id="2180798">(</span><span class="ident" id="2180799">r</span><span class="op" id="2180800">*</span><span class="ident" id="2180801">c</span><span class="op" id="2180802">)</span><span class="op" id="2180803">/</span><span class="op" id="2180804">(</span><span class="num" id="2180805">2</span><span class="op" id="2180806">-</span><span class="ident" id="2180807">c</span><span class="op" id="2180808">)</span><span class="op" id="2180809">)</span>&nbsp;<span class="op" id="2180811">-</span>&nbsp;<span class="ident" id="2180813">hi</span><span class="op" id="2180815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2180818">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2180871">return</span>&nbsp;<span class="ident" id="2180878">Ldexp</span><span class="op" id="2180883">(</span><span class="ident" id="2180884">y</span><span class="op" id="2180885">,</span>&nbsp;<span class="ident" id="2180887">k</span><span class="op" id="2180888">)</span><br>
<span class="lineno"></span><span class="op" id="2180890">}</span>
</div>
</body>
</html>
