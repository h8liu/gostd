<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2603389">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2603444">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2603498">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2603549">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="2603577">//</span><br>
<span class="lineno"></span><span class="comment" id="2603580">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="2603640">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2603698">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="2603748">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="2603809">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2603840">package</span>&nbsp;<span class="ident" id="2603848">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2603853">import</span>&nbsp;<span class="string" id="2603860">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2603870">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="2603901">const</span>&nbsp;<span class="op" id="2603907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603910">IPv4len</span>&nbsp;<span class="op" id="2603918">=</span>&nbsp;<span class="num" id="2603920">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2603923">IPv6len</span>&nbsp;<span class="op" id="2603931">=</span>&nbsp;<span class="num" id="2603933">16</span><br>
<span class="lineno"></span><span class="op" id="2603936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2603939">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="2603990">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="2604047">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2604085">//</span><br>
<span class="lineno"></span><span class="comment" id="2604088">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2604140">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="2604192">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="2604247">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="2604302">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2604325">type</span>&nbsp;<span class="ident" id="2604330">IP</span>&nbsp;<span class="op" id="2604333">[</span><span class="op" id="2604334">]</span><span class="builtintype" id="2604335">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604341">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="2604373">type</span>&nbsp;<span class="ident" id="2604378">IPMask</span>&nbsp;<span class="op" id="2604385">[</span><span class="op" id="2604386">]</span><span class="builtintype" id="2604387">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604393">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="2604431">type</span>&nbsp;<span class="ident" id="2604436">IPNet</span>&nbsp;<span class="keyword" id="2604442">struct</span>&nbsp;<span class="op" id="2604449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604452">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2604457"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2604464">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604483">Mask</span>&nbsp;<span class="ident" id="2604488"><a href="/net/ip.go.html#2604378">IPMask</a></span>&nbsp;<span class="comment" id="2604495">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="2604511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604514">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2604570">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="2604595">func</span>&nbsp;<span class="ident" id="2604600">IPv4</span><span class="op" id="2604604">(</span><span class="ident" id="2604605">a</span><span class="op" id="2604606">,</span>&nbsp;<span class="ident" id="2604608">b</span><span class="op" id="2604609">,</span>&nbsp;<span class="ident" id="2604611">c</span><span class="op" id="2604612">,</span>&nbsp;<span class="ident" id="2604614">d</span>&nbsp;<span class="builtintype" id="2604616">byte</span><span class="op" id="2604620">)</span>&nbsp;<span class="ident" id="2604622"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2604625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604628">p</span>&nbsp;<span class="op" id="2604630">:=</span>&nbsp;<span class="builtinfunc" id="2604633">make</span><span class="op" id="2604637">(</span><span class="ident" id="2604638"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2604640">,</span>&nbsp;<span class="ident" id="2604642"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2604649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2604652">copy</span><span class="op" id="2604656">(</span><span class="ident" id="2604657"><a href="/net/ip.go.html#2604628">p</a></span><span class="op" id="2604658">,</span>&nbsp;<span class="ident" id="2604660"><a href="/net/ip.go.html#2604735">v4InV6Prefix</a></span><span class="op" id="2604672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604675"><a href="/net/ip.go.html#2604628">p</a></span><span class="op" id="2604676">[</span><span class="num" id="2604677">12</span><span class="op" id="2604679">]</span>&nbsp;<span class="op" id="2604681">=</span>&nbsp;<span class="ident" id="2604683"><a href="/net/ip.go.html#2604605">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604686"><a href="/net/ip.go.html#2604628">p</a></span><span class="op" id="2604687">[</span><span class="num" id="2604688">13</span><span class="op" id="2604690">]</span>&nbsp;<span class="op" id="2604692">=</span>&nbsp;<span class="ident" id="2604694"><a href="/net/ip.go.html#2604608">b</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604697"><a href="/net/ip.go.html#2604628">p</a></span><span class="op" id="2604698">[</span><span class="num" id="2604699">14</span><span class="op" id="2604701">]</span>&nbsp;<span class="op" id="2604703">=</span>&nbsp;<span class="ident" id="2604705"><a href="/net/ip.go.html#2604611">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604708"><a href="/net/ip.go.html#2604628">p</a></span><span class="op" id="2604709">[</span><span class="num" id="2604710">15</span><span class="op" id="2604712">]</span>&nbsp;<span class="op" id="2604714">=</span>&nbsp;<span class="ident" id="2604716"><a href="/net/ip.go.html#2604614">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604719">return</span>&nbsp;<span class="ident" id="2604726"><a href="/net/ip.go.html#2604628">p</a></span><br>
<span class="lineno"></span><span class="op" id="2604728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="2604731">var</span>&nbsp;<span class="ident" id="2604735">v4InV6Prefix</span>&nbsp;<span class="op" id="2604748">=</span>&nbsp;<span class="op" id="2604750">[</span><span class="op" id="2604751">]</span><span class="builtintype" id="2604752">byte</span><span class="op" id="2604756">{</span><span class="num" id="2604757">0</span><span class="op" id="2604758">,</span>&nbsp;<span class="num" id="2604760">0</span><span class="op" id="2604761">,</span>&nbsp;<span class="num" id="2604763">0</span><span class="op" id="2604764">,</span>&nbsp;<span class="num" id="2604766">0</span><span class="op" id="2604767">,</span>&nbsp;<span class="num" id="2604769">0</span><span class="op" id="2604770">,</span>&nbsp;<span class="num" id="2604772">0</span><span class="op" id="2604773">,</span>&nbsp;<span class="num" id="2604775">0</span><span class="op" id="2604776">,</span>&nbsp;<span class="num" id="2604778">0</span><span class="op" id="2604779">,</span>&nbsp;<span class="num" id="2604781">0</span><span class="op" id="2604782">,</span>&nbsp;<span class="num" id="2604784">0</span><span class="op" id="2604785">,</span>&nbsp;<span class="num" id="2604787">0xff</span><span class="op" id="2604791">,</span>&nbsp;<span class="num" id="2604793">0xff</span><span class="op" id="2604797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604800">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2604856">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="2604878">func</span>&nbsp;<span class="ident" id="2604883">IPv4Mask</span><span class="op" id="2604891">(</span><span class="ident" id="2604892">a</span><span class="op" id="2604893">,</span>&nbsp;<span class="ident" id="2604895">b</span><span class="op" id="2604896">,</span>&nbsp;<span class="ident" id="2604898">c</span><span class="op" id="2604899">,</span>&nbsp;<span class="ident" id="2604901">d</span>&nbsp;<span class="builtintype" id="2604903">byte</span><span class="op" id="2604907">)</span>&nbsp;<span class="ident" id="2604909"><a href="/net/ip.go.html#2604378">IPMask</a></span>&nbsp;<span class="op" id="2604916">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604919">p</span>&nbsp;<span class="op" id="2604921">:=</span>&nbsp;<span class="builtinfunc" id="2604924">make</span><span class="op" id="2604928">(</span><span class="ident" id="2604929"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2604935">,</span>&nbsp;<span class="ident" id="2604937"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2604944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604947"><a href="/net/ip.go.html#2604919">p</a></span><span class="op" id="2604948">[</span><span class="num" id="2604949">0</span><span class="op" id="2604950">]</span>&nbsp;<span class="op" id="2604952">=</span>&nbsp;<span class="ident" id="2604954"><a href="/net/ip.go.html#2604892">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604957"><a href="/net/ip.go.html#2604919">p</a></span><span class="op" id="2604958">[</span><span class="num" id="2604959">1</span><span class="op" id="2604960">]</span>&nbsp;<span class="op" id="2604962">=</span>&nbsp;<span class="ident" id="2604964"><a href="/net/ip.go.html#2604895">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604967"><a href="/net/ip.go.html#2604919">p</a></span><span class="op" id="2604968">[</span><span class="num" id="2604969">2</span><span class="op" id="2604970">]</span>&nbsp;<span class="op" id="2604972">=</span>&nbsp;<span class="ident" id="2604974"><a href="/net/ip.go.html#2604898">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2604977"><a href="/net/ip.go.html#2604919">p</a></span><span class="op" id="2604978">[</span><span class="num" id="2604979">3</span><span class="op" id="2604980">]</span>&nbsp;<span class="op" id="2604982">=</span>&nbsp;<span class="ident" id="2604984"><a href="/net/ip.go.html#2604901">d</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2604987">return</span>&nbsp;<span class="ident" id="2604994"><a href="/net/ip.go.html#2604919">p</a></span><br>
<span class="lineno"></span><span class="op" id="2604996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2604999">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="2605057">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="2605112">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="2605180">func</span>&nbsp;<span class="ident" id="2605185">CIDRMask</span><span class="op" id="2605193">(</span><span class="ident" id="2605194">ones</span><span class="op" id="2605198">,</span>&nbsp;<span class="ident" id="2605200">bits</span>&nbsp;<span class="builtintype" id="2605205">int</span><span class="op" id="2605208">)</span>&nbsp;<span class="ident" id="2605210"><a href="/net/ip.go.html#2604378">IPMask</a></span>&nbsp;<span class="op" id="2605217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605220">if</span>&nbsp;<span class="ident" id="2605223"><a href="/net/ip.go.html#2605200">bits</a></span>&nbsp;<span class="op" id="2605228">!=</span>&nbsp;<span class="num" id="2605231">8</span><span class="op" id="2605232">*</span><span class="ident" id="2605233"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2605241">&amp;&amp;</span>&nbsp;<span class="ident" id="2605244"><a href="/net/ip.go.html#2605200">bits</a></span>&nbsp;<span class="op" id="2605249">!=</span>&nbsp;<span class="num" id="2605252">8</span><span class="op" id="2605253">*</span><span class="ident" id="2605254"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2605262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605266">return</span>&nbsp;<span class="ident" id="2605273">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605278">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605281">if</span>&nbsp;<span class="ident" id="2605284"><a href="/net/ip.go.html#2605194">ones</a></span>&nbsp;<span class="op" id="2605289">&lt;</span>&nbsp;<span class="num" id="2605291">0</span>&nbsp;<span class="op" id="2605293">||</span>&nbsp;<span class="ident" id="2605296"><a href="/net/ip.go.html#2605194">ones</a></span>&nbsp;<span class="op" id="2605301">&gt;</span>&nbsp;<span class="ident" id="2605303"><a href="/net/ip.go.html#2605200">bits</a></span>&nbsp;<span class="op" id="2605308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605312">return</span>&nbsp;<span class="ident" id="2605319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605327">l</span>&nbsp;<span class="op" id="2605329">:=</span>&nbsp;<span class="ident" id="2605332"><a href="/net/ip.go.html#2605200">bits</a></span>&nbsp;<span class="op" id="2605337">/</span>&nbsp;<span class="num" id="2605339">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605342">m</span>&nbsp;<span class="op" id="2605344">:=</span>&nbsp;<span class="builtinfunc" id="2605347">make</span><span class="op" id="2605351">(</span><span class="ident" id="2605352"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2605358">,</span>&nbsp;<span class="ident" id="2605360"><a href="/net/ip.go.html#2605327">l</a></span><span class="op" id="2605361">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605364">n</span>&nbsp;<span class="op" id="2605366">:=</span>&nbsp;<span class="builtintype" id="2605369">uint</span><span class="op" id="2605373">(</span><span class="ident" id="2605374"><a href="/net/ip.go.html#2605194">ones</a></span><span class="op" id="2605378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605381">for</span>&nbsp;<span class="ident" id="2605385">i</span>&nbsp;<span class="op" id="2605387">:=</span>&nbsp;<span class="num" id="2605390">0</span><span class="op" id="2605391">;</span>&nbsp;<span class="ident" id="2605393"><a href="/net/ip.go.html#2605385">i</a></span>&nbsp;<span class="op" id="2605395">&lt;</span>&nbsp;<span class="ident" id="2605397"><a href="/net/ip.go.html#2605327">l</a></span><span class="op" id="2605398">;</span>&nbsp;<span class="ident" id="2605400"><a href="/net/ip.go.html#2605385">i</a></span><span class="op" id="2605401">++</span>&nbsp;<span class="op" id="2605404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605408">if</span>&nbsp;<span class="ident" id="2605411"><a href="/net/ip.go.html#2605364">n</a></span>&nbsp;<span class="op" id="2605413">&gt;=</span>&nbsp;<span class="num" id="2605416">8</span>&nbsp;<span class="op" id="2605418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605423"><a href="/net/ip.go.html#2605342">m</a></span><span class="op" id="2605424">[</span><span class="ident" id="2605425"><a href="/net/ip.go.html#2605385">i</a></span><span class="op" id="2605426">]</span>&nbsp;<span class="op" id="2605428">=</span>&nbsp;<span class="num" id="2605430">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605438"><a href="/net/ip.go.html#2605364">n</a></span>&nbsp;<span class="op" id="2605440">-=</span>&nbsp;<span class="num" id="2605443">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605448">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605463"><a href="/net/ip.go.html#2605342">m</a></span><span class="op" id="2605464">[</span><span class="ident" id="2605465"><a href="/net/ip.go.html#2605385">i</a></span><span class="op" id="2605466">]</span>&nbsp;<span class="op" id="2605468">=</span>&nbsp;<span class="op" id="2605470">^</span><span class="builtintype" id="2605471">byte</span><span class="op" id="2605475">(</span><span class="num" id="2605476">0xff</span>&nbsp;<span class="op" id="2605481">&gt;&gt;</span>&nbsp;<span class="ident" id="2605484"><a href="/net/ip.go.html#2605364">n</a></span><span class="op" id="2605485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605489"><a href="/net/ip.go.html#2605364">n</a></span>&nbsp;<span class="op" id="2605491">=</span>&nbsp;<span class="num" id="2605493">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2605496">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2605499">return</span>&nbsp;<span class="ident" id="2605506"><a href="/net/ip.go.html#2605342">m</a></span><br>
<span class="lineno"></span><span class="op" id="2605508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2605511">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="2605540">var</span>&nbsp;<span class="op" id="2605544">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605547">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605561">=</span>&nbsp;<span class="ident" id="2605563"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2605567">(</span><span class="num" id="2605568">255</span><span class="op" id="2605571">,</span>&nbsp;<span class="num" id="2605573">255</span><span class="op" id="2605576">,</span>&nbsp;<span class="num" id="2605578">255</span><span class="op" id="2605581">,</span>&nbsp;<span class="num" id="2605583">255</span><span class="op" id="2605586">)</span>&nbsp;<span class="comment" id="2605588">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605602">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605616">=</span>&nbsp;<span class="ident" id="2605618"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2605622">(</span><span class="num" id="2605623">224</span><span class="op" id="2605626">,</span>&nbsp;<span class="num" id="2605628">0</span><span class="op" id="2605629">,</span>&nbsp;<span class="num" id="2605631">0</span><span class="op" id="2605632">,</span>&nbsp;<span class="num" id="2605634">1</span><span class="op" id="2605635">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2605643">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605659">IPv4allrouter</span>&nbsp;<span class="op" id="2605673">=</span>&nbsp;<span class="ident" id="2605675"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2605679">(</span><span class="num" id="2605680">224</span><span class="op" id="2605683">,</span>&nbsp;<span class="num" id="2605685">0</span><span class="op" id="2605686">,</span>&nbsp;<span class="num" id="2605688">0</span><span class="op" id="2605689">,</span>&nbsp;<span class="num" id="2605691">2</span><span class="op" id="2605692">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2605700">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605716">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605730">=</span>&nbsp;<span class="ident" id="2605732"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2605736">(</span><span class="num" id="2605737">0</span><span class="op" id="2605738">,</span>&nbsp;<span class="num" id="2605740">0</span><span class="op" id="2605741">,</span>&nbsp;<span class="num" id="2605743">0</span><span class="op" id="2605744">,</span>&nbsp;<span class="num" id="2605746">0</span><span class="op" id="2605747">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2605757">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="2605770">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2605773">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="2605802">var</span>&nbsp;<span class="op" id="2605806">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605809">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605836">=</span>&nbsp;<span class="ident" id="2605838"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2605840">{</span><span class="num" id="2605841">0</span><span class="op" id="2605842">,</span>&nbsp;<span class="num" id="2605844">0</span><span class="op" id="2605845">,</span>&nbsp;<span class="num" id="2605847">0</span><span class="op" id="2605848">,</span>&nbsp;<span class="num" id="2605850">0</span><span class="op" id="2605851">,</span>&nbsp;<span class="num" id="2605853">0</span><span class="op" id="2605854">,</span>&nbsp;<span class="num" id="2605856">0</span><span class="op" id="2605857">,</span>&nbsp;<span class="num" id="2605859">0</span><span class="op" id="2605860">,</span>&nbsp;<span class="num" id="2605862">0</span><span class="op" id="2605863">,</span>&nbsp;<span class="num" id="2605865">0</span><span class="op" id="2605866">,</span>&nbsp;<span class="num" id="2605868">0</span><span class="op" id="2605869">,</span>&nbsp;<span class="num" id="2605871">0</span><span class="op" id="2605872">,</span>&nbsp;<span class="num" id="2605874">0</span><span class="op" id="2605875">,</span>&nbsp;<span class="num" id="2605877">0</span><span class="op" id="2605878">,</span>&nbsp;<span class="num" id="2605880">0</span><span class="op" id="2605881">,</span>&nbsp;<span class="num" id="2605883">0</span><span class="op" id="2605884">,</span>&nbsp;<span class="num" id="2605886">0</span><span class="op" id="2605887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605890">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605917">=</span>&nbsp;<span class="ident" id="2605919"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2605921">{</span><span class="num" id="2605922">0</span><span class="op" id="2605923">,</span>&nbsp;<span class="num" id="2605925">0</span><span class="op" id="2605926">,</span>&nbsp;<span class="num" id="2605928">0</span><span class="op" id="2605929">,</span>&nbsp;<span class="num" id="2605931">0</span><span class="op" id="2605932">,</span>&nbsp;<span class="num" id="2605934">0</span><span class="op" id="2605935">,</span>&nbsp;<span class="num" id="2605937">0</span><span class="op" id="2605938">,</span>&nbsp;<span class="num" id="2605940">0</span><span class="op" id="2605941">,</span>&nbsp;<span class="num" id="2605943">0</span><span class="op" id="2605944">,</span>&nbsp;<span class="num" id="2605946">0</span><span class="op" id="2605947">,</span>&nbsp;<span class="num" id="2605949">0</span><span class="op" id="2605950">,</span>&nbsp;<span class="num" id="2605952">0</span><span class="op" id="2605953">,</span>&nbsp;<span class="num" id="2605955">0</span><span class="op" id="2605956">,</span>&nbsp;<span class="num" id="2605958">0</span><span class="op" id="2605959">,</span>&nbsp;<span class="num" id="2605961">0</span><span class="op" id="2605962">,</span>&nbsp;<span class="num" id="2605964">0</span><span class="op" id="2605965">,</span>&nbsp;<span class="num" id="2605967">0</span><span class="op" id="2605968">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2605971">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2605998">=</span>&nbsp;<span class="ident" id="2606000"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606002">{</span><span class="num" id="2606003">0</span><span class="op" id="2606004">,</span>&nbsp;<span class="num" id="2606006">0</span><span class="op" id="2606007">,</span>&nbsp;<span class="num" id="2606009">0</span><span class="op" id="2606010">,</span>&nbsp;<span class="num" id="2606012">0</span><span class="op" id="2606013">,</span>&nbsp;<span class="num" id="2606015">0</span><span class="op" id="2606016">,</span>&nbsp;<span class="num" id="2606018">0</span><span class="op" id="2606019">,</span>&nbsp;<span class="num" id="2606021">0</span><span class="op" id="2606022">,</span>&nbsp;<span class="num" id="2606024">0</span><span class="op" id="2606025">,</span>&nbsp;<span class="num" id="2606027">0</span><span class="op" id="2606028">,</span>&nbsp;<span class="num" id="2606030">0</span><span class="op" id="2606031">,</span>&nbsp;<span class="num" id="2606033">0</span><span class="op" id="2606034">,</span>&nbsp;<span class="num" id="2606036">0</span><span class="op" id="2606037">,</span>&nbsp;<span class="num" id="2606039">0</span><span class="op" id="2606040">,</span>&nbsp;<span class="num" id="2606042">0</span><span class="op" id="2606043">,</span>&nbsp;<span class="num" id="2606045">0</span><span class="op" id="2606046">,</span>&nbsp;<span class="num" id="2606048">1</span><span class="op" id="2606049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606052">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="2606079">=</span>&nbsp;<span class="ident" id="2606081"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606083">{</span><span class="num" id="2606084">0xff</span><span class="op" id="2606088">,</span>&nbsp;<span class="num" id="2606090">0x01</span><span class="op" id="2606094">,</span>&nbsp;<span class="num" id="2606096">0</span><span class="op" id="2606097">,</span>&nbsp;<span class="num" id="2606099">0</span><span class="op" id="2606100">,</span>&nbsp;<span class="num" id="2606102">0</span><span class="op" id="2606103">,</span>&nbsp;<span class="num" id="2606105">0</span><span class="op" id="2606106">,</span>&nbsp;<span class="num" id="2606108">0</span><span class="op" id="2606109">,</span>&nbsp;<span class="num" id="2606111">0</span><span class="op" id="2606112">,</span>&nbsp;<span class="num" id="2606114">0</span><span class="op" id="2606115">,</span>&nbsp;<span class="num" id="2606117">0</span><span class="op" id="2606118">,</span>&nbsp;<span class="num" id="2606120">0</span><span class="op" id="2606121">,</span>&nbsp;<span class="num" id="2606123">0</span><span class="op" id="2606124">,</span>&nbsp;<span class="num" id="2606126">0</span><span class="op" id="2606127">,</span>&nbsp;<span class="num" id="2606129">0</span><span class="op" id="2606130">,</span>&nbsp;<span class="num" id="2606132">0</span><span class="op" id="2606133">,</span>&nbsp;<span class="num" id="2606135">0x01</span><span class="op" id="2606139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606142">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2606169">=</span>&nbsp;<span class="ident" id="2606171"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606173">{</span><span class="num" id="2606174">0xff</span><span class="op" id="2606178">,</span>&nbsp;<span class="num" id="2606180">0x02</span><span class="op" id="2606184">,</span>&nbsp;<span class="num" id="2606186">0</span><span class="op" id="2606187">,</span>&nbsp;<span class="num" id="2606189">0</span><span class="op" id="2606190">,</span>&nbsp;<span class="num" id="2606192">0</span><span class="op" id="2606193">,</span>&nbsp;<span class="num" id="2606195">0</span><span class="op" id="2606196">,</span>&nbsp;<span class="num" id="2606198">0</span><span class="op" id="2606199">,</span>&nbsp;<span class="num" id="2606201">0</span><span class="op" id="2606202">,</span>&nbsp;<span class="num" id="2606204">0</span><span class="op" id="2606205">,</span>&nbsp;<span class="num" id="2606207">0</span><span class="op" id="2606208">,</span>&nbsp;<span class="num" id="2606210">0</span><span class="op" id="2606211">,</span>&nbsp;<span class="num" id="2606213">0</span><span class="op" id="2606214">,</span>&nbsp;<span class="num" id="2606216">0</span><span class="op" id="2606217">,</span>&nbsp;<span class="num" id="2606219">0</span><span class="op" id="2606220">,</span>&nbsp;<span class="num" id="2606222">0</span><span class="op" id="2606223">,</span>&nbsp;<span class="num" id="2606225">0x01</span><span class="op" id="2606229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2606232">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2606259">=</span>&nbsp;<span class="ident" id="2606261"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606263">{</span><span class="num" id="2606264">0xff</span><span class="op" id="2606268">,</span>&nbsp;<span class="num" id="2606270">0x02</span><span class="op" id="2606274">,</span>&nbsp;<span class="num" id="2606276">0</span><span class="op" id="2606277">,</span>&nbsp;<span class="num" id="2606279">0</span><span class="op" id="2606280">,</span>&nbsp;<span class="num" id="2606282">0</span><span class="op" id="2606283">,</span>&nbsp;<span class="num" id="2606285">0</span><span class="op" id="2606286">,</span>&nbsp;<span class="num" id="2606288">0</span><span class="op" id="2606289">,</span>&nbsp;<span class="num" id="2606291">0</span><span class="op" id="2606292">,</span>&nbsp;<span class="num" id="2606294">0</span><span class="op" id="2606295">,</span>&nbsp;<span class="num" id="2606297">0</span><span class="op" id="2606298">,</span>&nbsp;<span class="num" id="2606300">0</span><span class="op" id="2606301">,</span>&nbsp;<span class="num" id="2606303">0</span><span class="op" id="2606304">,</span>&nbsp;<span class="num" id="2606306">0</span><span class="op" id="2606307">,</span>&nbsp;<span class="num" id="2606309">0</span><span class="op" id="2606310">,</span>&nbsp;<span class="num" id="2606312">0</span><span class="op" id="2606313">,</span>&nbsp;<span class="num" id="2606315">0x02</span><span class="op" id="2606319">}</span><br>
<span class="lineno"></span><span class="op" id="2606321">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2606324">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2606387">func</span>&nbsp;<span class="op" id="2606392">(</span><span class="ident" id="2606393">ip</span>&nbsp;<span class="ident" id="2606396"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606398">)</span>&nbsp;<span class="ident" id="2606400">IsUnspecified</span><span class="op" id="2606413">(</span><span class="op" id="2606414">)</span>&nbsp;<span class="builtintype" id="2606416">bool</span>&nbsp;<span class="op" id="2606421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606424">if</span>&nbsp;<span class="ident" id="2606427"><a href="/net/ip.go.html#2606393">ip</a></span><span class="op" id="2606429">.</span><span class="ident" id="2606430">Equal</span><span class="op" id="2606435">(</span><span class="ident" id="2606436"><a href="/net/ip.go.html#2605716">IPv4zero</a></span><span class="op" id="2606444">)</span>&nbsp;<span class="op" id="2606446">||</span>&nbsp;<span class="ident" id="2606449"><a href="/net/ip.go.html#2606393">ip</a></span><span class="op" id="2606451">.</span><span class="ident" id="2606452">Equal</span><span class="op" id="2606457">(</span><span class="ident" id="2606458"><a href="/net/ip.go.html#2605890">IPv6unspecified</a></span><span class="op" id="2606473">)</span>&nbsp;<span class="op" id="2606475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606479">return</span>&nbsp;<span class="ident" id="2606486">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606495">return</span>&nbsp;<span class="ident" id="2606502">false</span><br>
<span class="lineno"></span><span class="op" id="2606508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2606511">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="2606567">func</span>&nbsp;<span class="op" id="2606572">(</span><span class="ident" id="2606573">ip</span>&nbsp;<span class="ident" id="2606576"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606578">)</span>&nbsp;<span class="ident" id="2606580">IsLoopback</span><span class="op" id="2606590">(</span><span class="op" id="2606591">)</span>&nbsp;<span class="builtintype" id="2606593">bool</span>&nbsp;<span class="op" id="2606598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606601">if</span>&nbsp;<span class="ident" id="2606604">ip4</span>&nbsp;<span class="op" id="2606608">:=</span>&nbsp;<span class="ident" id="2606611"><a href="/net/ip.go.html#2606573">ip</a></span><span class="op" id="2606613">.</span><span class="ident" id="2606614">To4</span><span class="op" id="2606617">(</span><span class="op" id="2606618">)</span><span class="op" id="2606619">;</span>&nbsp;<span class="ident" id="2606621"><a href="/net/ip.go.html#2606604">ip4</a></span>&nbsp;<span class="op" id="2606625">!=</span>&nbsp;<span class="ident" id="2606628">nil</span>&nbsp;<span class="op" id="2606632">&amp;&amp;</span>&nbsp;<span class="ident" id="2606635"><a href="/net/ip.go.html#2606604">ip4</a></span><span class="op" id="2606638">[</span><span class="num" id="2606639">0</span><span class="op" id="2606640">]</span>&nbsp;<span class="op" id="2606642">==</span>&nbsp;<span class="num" id="2606645">127</span>&nbsp;<span class="op" id="2606649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606653">return</span>&nbsp;<span class="ident" id="2606660">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606669">return</span>&nbsp;<span class="ident" id="2606676"><a href="/net/ip.go.html#2606573">ip</a></span><span class="op" id="2606678">.</span><span class="ident" id="2606679">Equal</span><span class="op" id="2606684">(</span><span class="ident" id="2606685"><a href="/net/ip.go.html#2605971">IPv6loopback</a></span><span class="op" id="2606697">)</span><br>
<span class="lineno">125</span><span class="op" id="2606699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2606702">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2606760">func</span>&nbsp;<span class="op" id="2606765">(</span><span class="ident" id="2606766">ip</span>&nbsp;<span class="ident" id="2606769"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2606771">)</span>&nbsp;<span class="ident" id="2606773">IsMulticast</span><span class="op" id="2606784">(</span><span class="op" id="2606785">)</span>&nbsp;<span class="builtintype" id="2606787">bool</span>&nbsp;<span class="op" id="2606792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606795">if</span>&nbsp;<span class="ident" id="2606798">ip4</span>&nbsp;<span class="op" id="2606802">:=</span>&nbsp;<span class="ident" id="2606805"><a href="/net/ip.go.html#2606766">ip</a></span><span class="op" id="2606807">.</span><span class="ident" id="2606808">To4</span><span class="op" id="2606811">(</span><span class="op" id="2606812">)</span><span class="op" id="2606813">;</span>&nbsp;<span class="ident" id="2606815"><a href="/net/ip.go.html#2606798">ip4</a></span>&nbsp;<span class="op" id="2606819">!=</span>&nbsp;<span class="ident" id="2606822">nil</span>&nbsp;<span class="op" id="2606826">&amp;&amp;</span>&nbsp;<span class="ident" id="2606829"><a href="/net/ip.go.html#2606798">ip4</a></span><span class="op" id="2606832">[</span><span class="num" id="2606833">0</span><span class="op" id="2606834">]</span><span class="op" id="2606835">&amp;</span><span class="num" id="2606836">0xf0</span>&nbsp;<span class="op" id="2606841">==</span>&nbsp;<span class="num" id="2606844">0xe0</span>&nbsp;<span class="op" id="2606849">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606853">return</span>&nbsp;<span class="ident" id="2606860">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2606866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2606869">return</span>&nbsp;<span class="ident" id="2606876"><a href="/net/ip.go.html#2606766">ip</a></span><span class="op" id="2606878">[</span><span class="num" id="2606879">0</span><span class="op" id="2606880">]</span>&nbsp;<span class="op" id="2606882">==</span>&nbsp;<span class="num" id="2606885">0xff</span><br>
<span class="lineno"></span><span class="op" id="2606890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2606893">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2606948">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2606989">func</span>&nbsp;<span class="op" id="2606994">(</span><span class="ident" id="2606995">ip</span>&nbsp;<span class="ident" id="2606998"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2607000">)</span>&nbsp;<span class="ident" id="2607002">IsInterfaceLocalMulticast</span><span class="op" id="2607027">(</span><span class="op" id="2607028">)</span>&nbsp;<span class="builtintype" id="2607030">bool</span>&nbsp;<span class="op" id="2607035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607038">return</span>&nbsp;<span class="builtinfunc" id="2607045">len</span><span class="op" id="2607048">(</span><span class="ident" id="2607049"><a href="/net/ip.go.html#2606995">ip</a></span><span class="op" id="2607051">)</span>&nbsp;<span class="op" id="2607053">==</span>&nbsp;<span class="ident" id="2607056"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2607064">&amp;&amp;</span>&nbsp;<span class="ident" id="2607067"><a href="/net/ip.go.html#2606995">ip</a></span><span class="op" id="2607069">[</span><span class="num" id="2607070">0</span><span class="op" id="2607071">]</span>&nbsp;<span class="op" id="2607073">==</span>&nbsp;<span class="num" id="2607076">0xff</span>&nbsp;<span class="op" id="2607081">&amp;&amp;</span>&nbsp;<span class="ident" id="2607084"><a href="/net/ip.go.html#2606995">ip</a></span><span class="op" id="2607086">[</span><span class="num" id="2607087">1</span><span class="op" id="2607088">]</span><span class="op" id="2607089">&amp;</span><span class="num" id="2607090">0x0f</span>&nbsp;<span class="op" id="2607095">==</span>&nbsp;<span class="num" id="2607098">0x01</span><br>
<span class="lineno"></span><span class="op" id="2607103">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="2607106">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="2607165">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2607187">func</span>&nbsp;<span class="op" id="2607192">(</span><span class="ident" id="2607193">ip</span>&nbsp;<span class="ident" id="2607196"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2607198">)</span>&nbsp;<span class="ident" id="2607200">IsLinkLocalMulticast</span><span class="op" id="2607220">(</span><span class="op" id="2607221">)</span>&nbsp;<span class="builtintype" id="2607223">bool</span>&nbsp;<span class="op" id="2607228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607231">if</span>&nbsp;<span class="ident" id="2607234">ip4</span>&nbsp;<span class="op" id="2607238">:=</span>&nbsp;<span class="ident" id="2607241"><a href="/net/ip.go.html#2607193">ip</a></span><span class="op" id="2607243">.</span><span class="ident" id="2607244">To4</span><span class="op" id="2607247">(</span><span class="op" id="2607248">)</span><span class="op" id="2607249">;</span>&nbsp;<span class="ident" id="2607251"><a href="/net/ip.go.html#2607234">ip4</a></span>&nbsp;<span class="op" id="2607255">!=</span>&nbsp;<span class="ident" id="2607258">nil</span>&nbsp;<span class="op" id="2607262">&amp;&amp;</span>&nbsp;<span class="ident" id="2607265"><a href="/net/ip.go.html#2607234">ip4</a></span><span class="op" id="2607268">[</span><span class="num" id="2607269">0</span><span class="op" id="2607270">]</span>&nbsp;<span class="op" id="2607272">==</span>&nbsp;<span class="num" id="2607275">224</span>&nbsp;<span class="op" id="2607279">&amp;&amp;</span>&nbsp;<span class="ident" id="2607282"><a href="/net/ip.go.html#2607234">ip4</a></span><span class="op" id="2607285">[</span><span class="num" id="2607286">1</span><span class="op" id="2607287">]</span>&nbsp;<span class="op" id="2607289">==</span>&nbsp;<span class="num" id="2607292">0</span>&nbsp;<span class="op" id="2607294">&amp;&amp;</span>&nbsp;<span class="ident" id="2607297"><a href="/net/ip.go.html#2607234">ip4</a></span><span class="op" id="2607300">[</span><span class="num" id="2607301">2</span><span class="op" id="2607302">]</span>&nbsp;<span class="op" id="2607304">==</span>&nbsp;<span class="num" id="2607307">0</span>&nbsp;<span class="op" id="2607309">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607313">return</span>&nbsp;<span class="ident" id="2607320">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607329">return</span>&nbsp;<span class="ident" id="2607336"><a href="/net/ip.go.html#2607193">ip</a></span><span class="op" id="2607338">[</span><span class="num" id="2607339">0</span><span class="op" id="2607340">]</span>&nbsp;<span class="op" id="2607342">==</span>&nbsp;<span class="num" id="2607345">0xff</span>&nbsp;<span class="op" id="2607350">&amp;&amp;</span>&nbsp;<span class="ident" id="2607353"><a href="/net/ip.go.html#2607193">ip</a></span><span class="op" id="2607355">[</span><span class="num" id="2607356">1</span><span class="op" id="2607357">]</span><span class="op" id="2607358">&amp;</span><span class="num" id="2607359">0x0f</span>&nbsp;<span class="op" id="2607364">==</span>&nbsp;<span class="num" id="2607367">0x02</span><br>
<span class="lineno"></span><span class="op" id="2607372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2607375">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="2607432">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2607452">func</span>&nbsp;<span class="op" id="2607457">(</span><span class="ident" id="2607458">ip</span>&nbsp;<span class="ident" id="2607461"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2607463">)</span>&nbsp;<span class="ident" id="2607465">IsLinkLocalUnicast</span><span class="op" id="2607483">(</span><span class="op" id="2607484">)</span>&nbsp;<span class="builtintype" id="2607486">bool</span>&nbsp;<span class="op" id="2607491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607494">if</span>&nbsp;<span class="ident" id="2607497">ip4</span>&nbsp;<span class="op" id="2607501">:=</span>&nbsp;<span class="ident" id="2607504"><a href="/net/ip.go.html#2607458">ip</a></span><span class="op" id="2607506">.</span><span class="ident" id="2607507">To4</span><span class="op" id="2607510">(</span><span class="op" id="2607511">)</span><span class="op" id="2607512">;</span>&nbsp;<span class="ident" id="2607514"><a href="/net/ip.go.html#2607497">ip4</a></span>&nbsp;<span class="op" id="2607518">!=</span>&nbsp;<span class="ident" id="2607521">nil</span>&nbsp;<span class="op" id="2607525">&amp;&amp;</span>&nbsp;<span class="ident" id="2607528"><a href="/net/ip.go.html#2607497">ip4</a></span><span class="op" id="2607531">[</span><span class="num" id="2607532">0</span><span class="op" id="2607533">]</span>&nbsp;<span class="op" id="2607535">==</span>&nbsp;<span class="num" id="2607538">169</span>&nbsp;<span class="op" id="2607542">&amp;&amp;</span>&nbsp;<span class="ident" id="2607545"><a href="/net/ip.go.html#2607497">ip4</a></span><span class="op" id="2607548">[</span><span class="num" id="2607549">1</span><span class="op" id="2607550">]</span>&nbsp;<span class="op" id="2607552">==</span>&nbsp;<span class="num" id="2607555">254</span>&nbsp;<span class="op" id="2607559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607563">return</span>&nbsp;<span class="ident" id="2607570">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607579">return</span>&nbsp;<span class="ident" id="2607586"><a href="/net/ip.go.html#2607458">ip</a></span><span class="op" id="2607588">[</span><span class="num" id="2607589">0</span><span class="op" id="2607590">]</span>&nbsp;<span class="op" id="2607592">==</span>&nbsp;<span class="num" id="2607595">0xfe</span>&nbsp;<span class="op" id="2607600">&amp;&amp;</span>&nbsp;<span class="ident" id="2607603"><a href="/net/ip.go.html#2607458">ip</a></span><span class="op" id="2607605">[</span><span class="num" id="2607606">1</span><span class="op" id="2607607">]</span><span class="op" id="2607608">&amp;</span><span class="num" id="2607609">0xc0</span>&nbsp;<span class="op" id="2607614">==</span>&nbsp;<span class="num" id="2607617">0x80</span><br>
<span class="lineno"></span><span class="op" id="2607622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607625">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="2607683">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="2607695">func</span>&nbsp;<span class="op" id="2607700">(</span><span class="ident" id="2607701">ip</span>&nbsp;<span class="ident" id="2607704"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2607706">)</span>&nbsp;<span class="ident" id="2607708">IsGlobalUnicast</span><span class="op" id="2607723">(</span><span class="op" id="2607724">)</span>&nbsp;<span class="builtintype" id="2607726">bool</span>&nbsp;<span class="op" id="2607731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607734">return</span>&nbsp;<span class="op" id="2607741">!</span><span class="ident" id="2607742"><a href="/net/ip.go.html#2607701">ip</a></span><span class="op" id="2607744">.</span><span class="ident" id="2607745">IsUnspecified</span><span class="op" id="2607758">(</span><span class="op" id="2607759">)</span>&nbsp;<span class="op" id="2607761">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607766">!</span><span class="ident" id="2607767"><a href="/net/ip.go.html#2607701">ip</a></span><span class="op" id="2607769">.</span><span class="ident" id="2607770">IsLoopback</span><span class="op" id="2607780">(</span><span class="op" id="2607781">)</span>&nbsp;<span class="op" id="2607783">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607788">!</span><span class="ident" id="2607789"><a href="/net/ip.go.html#2607701">ip</a></span><span class="op" id="2607791">.</span><span class="ident" id="2607792">IsMulticast</span><span class="op" id="2607803">(</span><span class="op" id="2607804">)</span>&nbsp;<span class="op" id="2607806">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607811">!</span><span class="ident" id="2607812"><a href="/net/ip.go.html#2607701">ip</a></span><span class="op" id="2607814">.</span><span class="ident" id="2607815">IsLinkLocalUnicast</span><span class="op" id="2607833">(</span><span class="op" id="2607834">)</span><br>
<span class="lineno"></span><span class="op" id="2607836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607839">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="2607858">func</span>&nbsp;<span class="ident" id="2607863">isZeros</span><span class="op" id="2607870">(</span><span class="ident" id="2607871">p</span>&nbsp;<span class="ident" id="2607873"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2607875">)</span>&nbsp;<span class="builtintype" id="2607877">bool</span>&nbsp;<span class="op" id="2607882">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607885">for</span>&nbsp;<span class="ident" id="2607889">i</span>&nbsp;<span class="op" id="2607891">:=</span>&nbsp;<span class="num" id="2607894">0</span><span class="op" id="2607895">;</span>&nbsp;<span class="ident" id="2607897"><a href="/net/ip.go.html#2607889">i</a></span>&nbsp;<span class="op" id="2607899">&lt;</span>&nbsp;<span class="builtinfunc" id="2607901">len</span><span class="op" id="2607904">(</span><span class="ident" id="2607905"><a href="/net/ip.go.html#2607871">p</a></span><span class="op" id="2607906">)</span><span class="op" id="2607907">;</span>&nbsp;<span class="ident" id="2607909"><a href="/net/ip.go.html#2607889">i</a></span><span class="op" id="2607910">++</span>&nbsp;<span class="op" id="2607913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607917">if</span>&nbsp;<span class="ident" id="2607920"><a href="/net/ip.go.html#2607871">p</a></span><span class="op" id="2607921">[</span><span class="ident" id="2607922"><a href="/net/ip.go.html#2607889">i</a></span><span class="op" id="2607923">]</span>&nbsp;<span class="op" id="2607925">!=</span>&nbsp;<span class="num" id="2607928">0</span>&nbsp;<span class="op" id="2607930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607935">return</span>&nbsp;<span class="ident" id="2607942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2607953">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2607956">return</span>&nbsp;<span class="ident" id="2607963">true</span><br>
<span class="lineno"></span><span class="op" id="2607968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2607971">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2608035">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="2608085">func</span>&nbsp;<span class="op" id="2608090">(</span><span class="ident" id="2608091">ip</span>&nbsp;<span class="ident" id="2608094"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2608096">)</span>&nbsp;<span class="ident" id="2608098">To4</span><span class="op" id="2608101">(</span><span class="op" id="2608102">)</span>&nbsp;<span class="ident" id="2608104"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2608107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608110">if</span>&nbsp;<span class="builtinfunc" id="2608113">len</span><span class="op" id="2608116">(</span><span class="ident" id="2608117"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608119">)</span>&nbsp;<span class="op" id="2608121">==</span>&nbsp;<span class="ident" id="2608124"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2608132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608136">return</span>&nbsp;<span class="ident" id="2608143"><a href="/net/ip.go.html#2608091">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2608147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608150">if</span>&nbsp;<span class="builtinfunc" id="2608153">len</span><span class="op" id="2608156">(</span><span class="ident" id="2608157"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608159">)</span>&nbsp;<span class="op" id="2608161">==</span>&nbsp;<span class="ident" id="2608164"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2608172">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608177"><a href="/net/ip.go.html#2607863">isZeros</a></span><span class="op" id="2608184">(</span><span class="ident" id="2608185"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608187">[</span><span class="num" id="2608188">0</span><span class="op" id="2608189">:</span><span class="num" id="2608190">10</span><span class="op" id="2608192">]</span><span class="op" id="2608193">)</span>&nbsp;<span class="op" id="2608195">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608200"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608202">[</span><span class="num" id="2608203">10</span><span class="op" id="2608205">]</span>&nbsp;<span class="op" id="2608207">==</span>&nbsp;<span class="num" id="2608210">0xff</span>&nbsp;<span class="op" id="2608215">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608220"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608222">[</span><span class="num" id="2608223">11</span><span class="op" id="2608225">]</span>&nbsp;<span class="op" id="2608227">==</span>&nbsp;<span class="num" id="2608230">0xff</span>&nbsp;<span class="op" id="2608235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608239">return</span>&nbsp;<span class="ident" id="2608246"><a href="/net/ip.go.html#2608091">ip</a></span><span class="op" id="2608248">[</span><span class="num" id="2608249">12</span><span class="op" id="2608251">:</span><span class="num" id="2608252">16</span><span class="op" id="2608254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2608257">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608260">return</span>&nbsp;<span class="ident" id="2608267">nil</span><br>
<span class="lineno"></span><span class="op" id="2608271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2608274">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2608338">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="2608412">func</span>&nbsp;<span class="op" id="2608417">(</span><span class="ident" id="2608418">ip</span>&nbsp;<span class="ident" id="2608421"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2608423">)</span>&nbsp;<span class="ident" id="2608425">To16</span><span class="op" id="2608429">(</span><span class="op" id="2608430">)</span>&nbsp;<span class="ident" id="2608432"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2608435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608438">if</span>&nbsp;<span class="builtinfunc" id="2608441">len</span><span class="op" id="2608444">(</span><span class="ident" id="2608445"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608447">)</span>&nbsp;<span class="op" id="2608449">==</span>&nbsp;<span class="ident" id="2608452"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2608460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608464">return</span>&nbsp;<span class="ident" id="2608471"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2608475">(</span><span class="ident" id="2608476"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608478">[</span><span class="num" id="2608479">0</span><span class="op" id="2608480">]</span><span class="op" id="2608481">,</span>&nbsp;<span class="ident" id="2608483"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608485">[</span><span class="num" id="2608486">1</span><span class="op" id="2608487">]</span><span class="op" id="2608488">,</span>&nbsp;<span class="ident" id="2608490"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608492">[</span><span class="num" id="2608493">2</span><span class="op" id="2608494">]</span><span class="op" id="2608495">,</span>&nbsp;<span class="ident" id="2608497"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608499">[</span><span class="num" id="2608500">3</span><span class="op" id="2608501">]</span><span class="op" id="2608502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2608505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608508">if</span>&nbsp;<span class="builtinfunc" id="2608511">len</span><span class="op" id="2608514">(</span><span class="ident" id="2608515"><a href="/net/ip.go.html#2608418">ip</a></span><span class="op" id="2608517">)</span>&nbsp;<span class="op" id="2608519">==</span>&nbsp;<span class="ident" id="2608522"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2608530">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608534">return</span>&nbsp;<span class="ident" id="2608541"><a href="/net/ip.go.html#2608418">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2608545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608548">return</span>&nbsp;<span class="ident" id="2608555">nil</span><br>
<span class="lineno"></span><span class="op" id="2608559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="2608562">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="2608595">var</span>&nbsp;<span class="op" id="2608599">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608602">classAMask</span>&nbsp;<span class="op" id="2608613">=</span>&nbsp;<span class="ident" id="2608615"><a href="/net/ip.go.html#2604883">IPv4Mask</a></span><span class="op" id="2608623">(</span><span class="num" id="2608624">0xff</span><span class="op" id="2608628">,</span>&nbsp;<span class="num" id="2608630">0</span><span class="op" id="2608631">,</span>&nbsp;<span class="num" id="2608633">0</span><span class="op" id="2608634">,</span>&nbsp;<span class="num" id="2608636">0</span><span class="op" id="2608637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608640">classBMask</span>&nbsp;<span class="op" id="2608651">=</span>&nbsp;<span class="ident" id="2608653"><a href="/net/ip.go.html#2604883">IPv4Mask</a></span><span class="op" id="2608661">(</span><span class="num" id="2608662">0xff</span><span class="op" id="2608666">,</span>&nbsp;<span class="num" id="2608668">0xff</span><span class="op" id="2608672">,</span>&nbsp;<span class="num" id="2608674">0</span><span class="op" id="2608675">,</span>&nbsp;<span class="num" id="2608677">0</span><span class="op" id="2608678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2608681">classCMask</span>&nbsp;<span class="op" id="2608692">=</span>&nbsp;<span class="ident" id="2608694"><a href="/net/ip.go.html#2604883">IPv4Mask</a></span><span class="op" id="2608702">(</span><span class="num" id="2608703">0xff</span><span class="op" id="2608707">,</span>&nbsp;<span class="num" id="2608709">0xff</span><span class="op" id="2608713">,</span>&nbsp;<span class="num" id="2608715">0xff</span><span class="op" id="2608719">,</span>&nbsp;<span class="num" id="2608721">0</span><span class="op" id="2608722">)</span><br>
<span class="lineno">210</span><span class="op" id="2608724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2608727">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="2608793">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2608856">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="2608898">func</span>&nbsp;<span class="op" id="2608903">(</span><span class="ident" id="2608904">ip</span>&nbsp;<span class="ident" id="2608907"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2608909">)</span>&nbsp;<span class="ident" id="2608911">DefaultMask</span><span class="op" id="2608922">(</span><span class="op" id="2608923">)</span>&nbsp;<span class="ident" id="2608925"><a href="/net/ip.go.html#2604378">IPMask</a></span>&nbsp;<span class="op" id="2608932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608935">if</span>&nbsp;<span class="ident" id="2608938"><a href="/net/ip.go.html#2608904">ip</a></span>&nbsp;<span class="op" id="2608941">=</span>&nbsp;<span class="ident" id="2608943"><a href="/net/ip.go.html#2608904">ip</a></span><span class="op" id="2608945">.</span><span class="ident" id="2608946">To4</span><span class="op" id="2608949">(</span><span class="op" id="2608950">)</span><span class="op" id="2608951">;</span>&nbsp;<span class="ident" id="2608953"><a href="/net/ip.go.html#2608904">ip</a></span>&nbsp;<span class="op" id="2608956">==</span>&nbsp;<span class="ident" id="2608959">nil</span>&nbsp;<span class="op" id="2608963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608967">return</span>&nbsp;<span class="ident" id="2608974">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2608979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608982">switch</span>&nbsp;<span class="ident" id="2608989">true</span>&nbsp;<span class="op" id="2608994">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2608997">case</span>&nbsp;<span class="ident" id="2609002"><a href="/net/ip.go.html#2608904">ip</a></span><span class="op" id="2609004">[</span><span class="num" id="2609005">0</span><span class="op" id="2609006">]</span>&nbsp;<span class="op" id="2609008">&lt;</span>&nbsp;<span class="num" id="2609010">0x80</span><span class="op" id="2609014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609018">return</span>&nbsp;<span class="ident" id="2609025"><a href="/net/ip.go.html#2608602">classAMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609037">case</span>&nbsp;<span class="ident" id="2609042"><a href="/net/ip.go.html#2608904">ip</a></span><span class="op" id="2609044">[</span><span class="num" id="2609045">0</span><span class="op" id="2609046">]</span>&nbsp;<span class="op" id="2609048">&lt;</span>&nbsp;<span class="num" id="2609050">0xC0</span><span class="op" id="2609054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609058">return</span>&nbsp;<span class="ident" id="2609065"><a href="/net/ip.go.html#2608640">classBMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609077">default</span><span class="op" id="2609084">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609088">return</span>&nbsp;<span class="ident" id="2609095"><a href="/net/ip.go.html#2608681">classCMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609107">}</span><br>
<span class="lineno"></span><span class="op" id="2609109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2609112">func</span>&nbsp;<span class="ident" id="2609117">allFF</span><span class="op" id="2609122">(</span><span class="ident" id="2609123">b</span>&nbsp;<span class="op" id="2609125">[</span><span class="op" id="2609126">]</span><span class="builtintype" id="2609127">byte</span><span class="op" id="2609131">)</span>&nbsp;<span class="builtintype" id="2609133">bool</span>&nbsp;<span class="op" id="2609138">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609141">for</span>&nbsp;<span class="ident" id="2609145">_</span><span class="op" id="2609146">,</span>&nbsp;<span class="ident" id="2609148">c</span>&nbsp;<span class="op" id="2609150">:=</span>&nbsp;<span class="keyword" id="2609153">range</span>&nbsp;<span class="ident" id="2609159"><a href="/net/ip.go.html#2609123">b</a></span>&nbsp;<span class="op" id="2609161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609165">if</span>&nbsp;<span class="ident" id="2609168"><a href="/net/ip.go.html#2609148">c</a></span>&nbsp;<span class="op" id="2609170">!=</span>&nbsp;<span class="num" id="2609173">0xff</span>&nbsp;<span class="op" id="2609178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609183">return</span>&nbsp;<span class="ident" id="2609190">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609201">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609204">return</span>&nbsp;<span class="ident" id="2609211">true</span><br>
<span class="lineno"></span><span class="op" id="2609216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2609219">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="2609286">func</span>&nbsp;<span class="op" id="2609291">(</span><span class="ident" id="2609292">ip</span>&nbsp;<span class="ident" id="2609295"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2609297">)</span>&nbsp;<span class="ident" id="2609299">Mask</span><span class="op" id="2609303">(</span><span class="ident" id="2609304">mask</span>&nbsp;<span class="ident" id="2609309"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2609315">)</span>&nbsp;<span class="ident" id="2609317"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2609320">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609323">if</span>&nbsp;<span class="builtinfunc" id="2609326">len</span><span class="op" id="2609329">(</span><span class="ident" id="2609330"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609334">)</span>&nbsp;<span class="op" id="2609336">==</span>&nbsp;<span class="ident" id="2609339"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2609347">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2609350">len</span><span class="op" id="2609353">(</span><span class="ident" id="2609354"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609356">)</span>&nbsp;<span class="op" id="2609358">==</span>&nbsp;<span class="ident" id="2609361"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2609369">&amp;&amp;</span>&nbsp;<span class="ident" id="2609372"><a href="/net/ip.go.html#2609117">allFF</a></span><span class="op" id="2609377">(</span><span class="ident" id="2609378"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609382">[</span><span class="op" id="2609383">:</span><span class="num" id="2609384">12</span><span class="op" id="2609386">]</span><span class="op" id="2609387">)</span>&nbsp;<span class="op" id="2609389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609393"><a href="/net/ip.go.html#2609304">mask</a></span>&nbsp;<span class="op" id="2609398">=</span>&nbsp;<span class="ident" id="2609400"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609404">[</span><span class="num" id="2609405">12</span><span class="op" id="2609407">:</span><span class="op" id="2609408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609414">if</span>&nbsp;<span class="builtinfunc" id="2609417">len</span><span class="op" id="2609420">(</span><span class="ident" id="2609421"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609425">)</span>&nbsp;<span class="op" id="2609427">==</span>&nbsp;<span class="ident" id="2609430"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2609438">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2609441">len</span><span class="op" id="2609444">(</span><span class="ident" id="2609445"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609447">)</span>&nbsp;<span class="op" id="2609449">==</span>&nbsp;<span class="ident" id="2609452"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2609460">&amp;&amp;</span>&nbsp;<span class="ident" id="2609463"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2609473">(</span><span class="ident" id="2609474"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609476">[</span><span class="op" id="2609477">:</span><span class="num" id="2609478">12</span><span class="op" id="2609480">]</span><span class="op" id="2609481">,</span>&nbsp;<span class="ident" id="2609483"><a href="/net/ip.go.html#2604735">v4InV6Prefix</a></span><span class="op" id="2609495">)</span>&nbsp;<span class="op" id="2609497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609501"><a href="/net/ip.go.html#2609292">ip</a></span>&nbsp;<span class="op" id="2609504">=</span>&nbsp;<span class="ident" id="2609506"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609508">[</span><span class="num" id="2609509">12</span><span class="op" id="2609511">:</span><span class="op" id="2609512">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609518">n</span>&nbsp;<span class="op" id="2609520">:=</span>&nbsp;<span class="builtinfunc" id="2609523">len</span><span class="op" id="2609526">(</span><span class="ident" id="2609527"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609532">if</span>&nbsp;<span class="ident" id="2609535"><a href="/net/ip.go.html#2609518">n</a></span>&nbsp;<span class="op" id="2609537">!=</span>&nbsp;<span class="builtinfunc" id="2609540">len</span><span class="op" id="2609543">(</span><span class="ident" id="2609544"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609548">)</span>&nbsp;<span class="op" id="2609550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609554">return</span>&nbsp;<span class="ident" id="2609561">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609566">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609569">out</span>&nbsp;<span class="op" id="2609573">:=</span>&nbsp;<span class="builtinfunc" id="2609576">make</span><span class="op" id="2609580">(</span><span class="ident" id="2609581"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2609583">,</span>&nbsp;<span class="ident" id="2609585"><a href="/net/ip.go.html#2609518">n</a></span><span class="op" id="2609586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609589">for</span>&nbsp;<span class="ident" id="2609593">i</span>&nbsp;<span class="op" id="2609595">:=</span>&nbsp;<span class="num" id="2609598">0</span><span class="op" id="2609599">;</span>&nbsp;<span class="ident" id="2609601"><a href="/net/ip.go.html#2609593">i</a></span>&nbsp;<span class="op" id="2609603">&lt;</span>&nbsp;<span class="ident" id="2609605"><a href="/net/ip.go.html#2609518">n</a></span><span class="op" id="2609606">;</span>&nbsp;<span class="ident" id="2609608"><a href="/net/ip.go.html#2609593">i</a></span><span class="op" id="2609609">++</span>&nbsp;<span class="op" id="2609612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609616"><a href="/net/ip.go.html#2609569">out</a></span><span class="op" id="2609619">[</span><span class="ident" id="2609620"><a href="/net/ip.go.html#2609593">i</a></span><span class="op" id="2609621">]</span>&nbsp;<span class="op" id="2609623">=</span>&nbsp;<span class="ident" id="2609625"><a href="/net/ip.go.html#2609292">ip</a></span><span class="op" id="2609627">[</span><span class="ident" id="2609628"><a href="/net/ip.go.html#2609593">i</a></span><span class="op" id="2609629">]</span>&nbsp;<span class="op" id="2609631">&amp;</span>&nbsp;<span class="ident" id="2609633"><a href="/net/ip.go.html#2609304">mask</a></span><span class="op" id="2609637">[</span><span class="ident" id="2609638"><a href="/net/ip.go.html#2609593">i</a></span><span class="op" id="2609639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609645">return</span>&nbsp;<span class="ident" id="2609652"><a href="/net/ip.go.html#2609569">out</a></span><br>
<span class="lineno">255</span><span class="op" id="2609656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2609659">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="2609715">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2609779">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="2609848">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="2609885">func</span>&nbsp;<span class="op" id="2609890">(</span><span class="ident" id="2609891">ip</span>&nbsp;<span class="ident" id="2609894"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2609896">)</span>&nbsp;<span class="ident" id="2609898">String</span><span class="op" id="2609904">(</span><span class="op" id="2609905">)</span>&nbsp;<span class="builtintype" id="2609907">string</span>&nbsp;<span class="op" id="2609914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2609917">p</span>&nbsp;<span class="op" id="2609919">:=</span>&nbsp;<span class="ident" id="2609922"><a href="/net/ip.go.html#2609891">ip</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609927">if</span>&nbsp;<span class="builtinfunc" id="2609930">len</span><span class="op" id="2609933">(</span><span class="ident" id="2609934"><a href="/net/ip.go.html#2609891">ip</a></span><span class="op" id="2609936">)</span>&nbsp;<span class="op" id="2609938">==</span>&nbsp;<span class="num" id="2609941">0</span>&nbsp;<span class="op" id="2609943">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2609947">return</span>&nbsp;<span class="string" id="2609954">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2609963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2609967">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610001">if</span>&nbsp;<span class="ident" id="2610004">p4</span>&nbsp;<span class="op" id="2610007">:=</span>&nbsp;<span class="ident" id="2610010"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610011">.</span><span class="ident" id="2610012">To4</span><span class="op" id="2610015">(</span><span class="op" id="2610016">)</span><span class="op" id="2610017">;</span>&nbsp;<span class="builtinfunc" id="2610019">len</span><span class="op" id="2610022">(</span><span class="ident" id="2610023"><a href="/net/ip.go.html#2610004">p4</a></span><span class="op" id="2610025">)</span>&nbsp;<span class="op" id="2610027">==</span>&nbsp;<span class="ident" id="2610030"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2610038">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610042">return</span>&nbsp;<span class="ident" id="2610049"><a href="/net/parse.go.html#2666508">itod</a></span><span class="op" id="2610053">(</span><span class="builtintype" id="2610054">uint</span><span class="op" id="2610058">(</span><span class="ident" id="2610059"><a href="/net/ip.go.html#2610004">p4</a></span><span class="op" id="2610061">[</span><span class="num" id="2610062">0</span><span class="op" id="2610063">]</span><span class="op" id="2610064">)</span><span class="op" id="2610065">)</span>&nbsp;<span class="op" id="2610067">+</span>&nbsp;<span class="string" id="2610069">&#34;.&#34;</span>&nbsp;<span class="op" id="2610073">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610078"><a href="/net/parse.go.html#2666508">itod</a></span><span class="op" id="2610082">(</span><span class="builtintype" id="2610083">uint</span><span class="op" id="2610087">(</span><span class="ident" id="2610088"><a href="/net/ip.go.html#2610004">p4</a></span><span class="op" id="2610090">[</span><span class="num" id="2610091">1</span><span class="op" id="2610092">]</span><span class="op" id="2610093">)</span><span class="op" id="2610094">)</span>&nbsp;<span class="op" id="2610096">+</span>&nbsp;<span class="string" id="2610098">&#34;.&#34;</span>&nbsp;<span class="op" id="2610102">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610107"><a href="/net/parse.go.html#2666508">itod</a></span><span class="op" id="2610111">(</span><span class="builtintype" id="2610112">uint</span><span class="op" id="2610116">(</span><span class="ident" id="2610117"><a href="/net/ip.go.html#2610004">p4</a></span><span class="op" id="2610119">[</span><span class="num" id="2610120">2</span><span class="op" id="2610121">]</span><span class="op" id="2610122">)</span><span class="op" id="2610123">)</span>&nbsp;<span class="op" id="2610125">+</span>&nbsp;<span class="string" id="2610127">&#34;.&#34;</span>&nbsp;<span class="op" id="2610131">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610136"><a href="/net/parse.go.html#2666508">itod</a></span><span class="op" id="2610140">(</span><span class="builtintype" id="2610141">uint</span><span class="op" id="2610145">(</span><span class="ident" id="2610146"><a href="/net/ip.go.html#2610004">p4</a></span><span class="op" id="2610148">[</span><span class="num" id="2610149">3</span><span class="op" id="2610150">]</span><span class="op" id="2610151">)</span><span class="op" id="2610152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610155">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610158">if</span>&nbsp;<span class="builtinfunc" id="2610161">len</span><span class="op" id="2610164">(</span><span class="ident" id="2610165"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610166">)</span>&nbsp;<span class="op" id="2610168">!=</span>&nbsp;<span class="ident" id="2610171"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2610179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610183">return</span>&nbsp;<span class="string" id="2610190">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2610199">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610230">e0</span>&nbsp;<span class="op" id="2610233">:=</span>&nbsp;<span class="op" id="2610236">-</span><span class="num" id="2610237">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610240">e1</span>&nbsp;<span class="op" id="2610243">:=</span>&nbsp;<span class="op" id="2610246">-</span><span class="num" id="2610247">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610250">for</span>&nbsp;<span class="ident" id="2610254">i</span>&nbsp;<span class="op" id="2610256">:=</span>&nbsp;<span class="num" id="2610259">0</span><span class="op" id="2610260">;</span>&nbsp;<span class="ident" id="2610262"><a href="/net/ip.go.html#2610254">i</a></span>&nbsp;<span class="op" id="2610264">&lt;</span>&nbsp;<span class="ident" id="2610266"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2610273">;</span>&nbsp;<span class="ident" id="2610275"><a href="/net/ip.go.html#2610254">i</a></span>&nbsp;<span class="op" id="2610277">+=</span>&nbsp;<span class="num" id="2610280">2</span>&nbsp;<span class="op" id="2610282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610286">j</span>&nbsp;<span class="op" id="2610288">:=</span>&nbsp;<span class="ident" id="2610291"><a href="/net/ip.go.html#2610254">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610295">for</span>&nbsp;<span class="ident" id="2610299"><a href="/net/ip.go.html#2610286">j</a></span>&nbsp;<span class="op" id="2610301">&lt;</span>&nbsp;<span class="ident" id="2610303"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2610311">&amp;&amp;</span>&nbsp;<span class="ident" id="2610314"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610315">[</span><span class="ident" id="2610316"><a href="/net/ip.go.html#2610286">j</a></span><span class="op" id="2610317">]</span>&nbsp;<span class="op" id="2610319">==</span>&nbsp;<span class="num" id="2610322">0</span>&nbsp;<span class="op" id="2610324">&amp;&amp;</span>&nbsp;<span class="ident" id="2610327"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610328">[</span><span class="ident" id="2610329"><a href="/net/ip.go.html#2610286">j</a></span><span class="op" id="2610330">+</span><span class="num" id="2610331">1</span><span class="op" id="2610332">]</span>&nbsp;<span class="op" id="2610334">==</span>&nbsp;<span class="num" id="2610337">0</span>&nbsp;<span class="op" id="2610339">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610344"><a href="/net/ip.go.html#2610286">j</a></span>&nbsp;<span class="op" id="2610346">+=</span>&nbsp;<span class="num" id="2610349">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610357">if</span>&nbsp;<span class="ident" id="2610360"><a href="/net/ip.go.html#2610286">j</a></span>&nbsp;<span class="op" id="2610362">&gt;</span>&nbsp;<span class="ident" id="2610364"><a href="/net/ip.go.html#2610254">i</a></span>&nbsp;<span class="op" id="2610366">&amp;&amp;</span>&nbsp;<span class="ident" id="2610369"><a href="/net/ip.go.html#2610286">j</a></span><span class="op" id="2610370">-</span><span class="ident" id="2610371"><a href="/net/ip.go.html#2610254">i</a></span>&nbsp;<span class="op" id="2610373">&gt;</span>&nbsp;<span class="ident" id="2610375"><a href="/net/ip.go.html#2610240">e1</a></span><span class="op" id="2610377">-</span><span class="ident" id="2610378"><a href="/net/ip.go.html#2610230">e0</a></span>&nbsp;<span class="op" id="2610381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610386"><a href="/net/ip.go.html#2610230">e0</a></span>&nbsp;<span class="op" id="2610389">=</span>&nbsp;<span class="ident" id="2610391"><a href="/net/ip.go.html#2610254">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610396"><a href="/net/ip.go.html#2610240">e1</a></span>&nbsp;<span class="op" id="2610399">=</span>&nbsp;<span class="ident" id="2610401"><a href="/net/ip.go.html#2610286">j</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610406"><a href="/net/ip.go.html#2610254">i</a></span>&nbsp;<span class="op" id="2610408">=</span>&nbsp;<span class="ident" id="2610410"><a href="/net/ip.go.html#2610286">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2610420">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610493">if</span>&nbsp;<span class="ident" id="2610496"><a href="/net/ip.go.html#2610240">e1</a></span><span class="op" id="2610498">-</span><span class="ident" id="2610499"><a href="/net/ip.go.html#2610230">e0</a></span>&nbsp;<span class="op" id="2610502">&lt;=</span>&nbsp;<span class="num" id="2610505">2</span>&nbsp;<span class="op" id="2610507">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610511"><a href="/net/ip.go.html#2610230">e0</a></span>&nbsp;<span class="op" id="2610514">=</span>&nbsp;<span class="op" id="2610516">-</span><span class="num" id="2610517">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610521"><a href="/net/ip.go.html#2610240">e1</a></span>&nbsp;<span class="op" id="2610524">=</span>&nbsp;<span class="op" id="2610526">-</span><span class="num" id="2610527">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610534">const</span>&nbsp;<span class="ident" id="2610540">maxLen</span>&nbsp;<span class="op" id="2610547">=</span>&nbsp;<span class="builtinfunc" id="2610549">len</span><span class="op" id="2610552">(</span><span class="string" id="2610553">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="2610594">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610597">b</span>&nbsp;<span class="op" id="2610599">:=</span>&nbsp;<span class="builtinfunc" id="2610602">make</span><span class="op" id="2610606">(</span><span class="op" id="2610607">[</span><span class="op" id="2610608">]</span><span class="builtintype" id="2610609">byte</span><span class="op" id="2610613">,</span>&nbsp;<span class="num" id="2610615">0</span><span class="op" id="2610616">,</span>&nbsp;<span class="ident" id="2610618"><a href="/net/ip.go.html#2610540">maxLen</a></span><span class="op" id="2610624">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2610628">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610680">for</span>&nbsp;<span class="ident" id="2610684">i</span>&nbsp;<span class="op" id="2610686">:=</span>&nbsp;<span class="num" id="2610689">0</span><span class="op" id="2610690">;</span>&nbsp;<span class="ident" id="2610692"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610694">&lt;</span>&nbsp;<span class="ident" id="2610696"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2610703">;</span>&nbsp;<span class="ident" id="2610705"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610707">+=</span>&nbsp;<span class="num" id="2610710">2</span>&nbsp;<span class="op" id="2610712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610716">if</span>&nbsp;<span class="ident" id="2610719"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610721">==</span>&nbsp;<span class="ident" id="2610724"><a href="/net/ip.go.html#2610230">e0</a></span>&nbsp;<span class="op" id="2610727">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610732"><a href="/net/ip.go.html#2610597">b</a></span>&nbsp;<span class="op" id="2610734">=</span>&nbsp;<span class="builtinfunc" id="2610736">append</span><span class="op" id="2610742">(</span><span class="ident" id="2610743"><a href="/net/ip.go.html#2610597">b</a></span><span class="op" id="2610744">,</span>&nbsp;<span class="string" id="2610746">&#39;:&#39;</span><span class="op" id="2610749">,</span>&nbsp;<span class="string" id="2610751">&#39;:&#39;</span><span class="op" id="2610754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610759"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610761">=</span>&nbsp;<span class="ident" id="2610763"><a href="/net/ip.go.html#2610240">e1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610769">if</span>&nbsp;<span class="ident" id="2610772"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610774">&gt;=</span>&nbsp;<span class="ident" id="2610777"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2610785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610791">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610800">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610804">}</span>&nbsp;<span class="keyword" id="2610806">else</span>&nbsp;<span class="keyword" id="2610811">if</span>&nbsp;<span class="ident" id="2610814"><a href="/net/ip.go.html#2610684">i</a></span>&nbsp;<span class="op" id="2610816">&gt;</span>&nbsp;<span class="num" id="2610818">0</span>&nbsp;<span class="op" id="2610820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610825"><a href="/net/ip.go.html#2610597">b</a></span>&nbsp;<span class="op" id="2610827">=</span>&nbsp;<span class="builtinfunc" id="2610829">append</span><span class="op" id="2610835">(</span><span class="ident" id="2610836"><a href="/net/ip.go.html#2610597">b</a></span><span class="op" id="2610837">,</span>&nbsp;<span class="string" id="2610839">&#39;:&#39;</span><span class="op" id="2610842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2610850"><a href="/net/ip.go.html#2610597">b</a></span>&nbsp;<span class="op" id="2610852">=</span>&nbsp;<span class="ident" id="2610854"><a href="/net/parse.go.html#2666791">appendHex</a></span><span class="op" id="2610863">(</span><span class="ident" id="2610864"><a href="/net/ip.go.html#2610597">b</a></span><span class="op" id="2610865">,</span>&nbsp;<span class="op" id="2610867">(</span><span class="builtintype" id="2610868">uint32</span><span class="op" id="2610874">(</span><span class="ident" id="2610875"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610876">[</span><span class="ident" id="2610877"><a href="/net/ip.go.html#2610684">i</a></span><span class="op" id="2610878">]</span><span class="op" id="2610879">)</span><span class="op" id="2610880">&lt;&lt;</span><span class="num" id="2610882">8</span><span class="op" id="2610883">)</span><span class="op" id="2610884">|</span><span class="builtintype" id="2610885">uint32</span><span class="op" id="2610891">(</span><span class="ident" id="2610892"><a href="/net/ip.go.html#2609917">p</a></span><span class="op" id="2610893">[</span><span class="ident" id="2610894"><a href="/net/ip.go.html#2610684">i</a></span><span class="op" id="2610895">+</span><span class="num" id="2610896">1</span><span class="op" id="2610897">]</span><span class="op" id="2610898">)</span><span class="op" id="2610899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2610902">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2610905">return</span>&nbsp;<span class="builtintype" id="2610912">string</span><span class="op" id="2610918">(</span><span class="ident" id="2610919"><a href="/net/ip.go.html#2610597">b</a></span><span class="op" id="2610920">)</span><br>
<span class="lineno"></span><span class="op" id="2610922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2610925">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2610983">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="2611020">func</span>&nbsp;<span class="ident" id="2611025">ipEmptyString</span><span class="op" id="2611038">(</span><span class="ident" id="2611039">ip</span>&nbsp;<span class="ident" id="2611042"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2611044">)</span>&nbsp;<span class="builtintype" id="2611046">string</span>&nbsp;<span class="op" id="2611053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611056">if</span>&nbsp;<span class="builtinfunc" id="2611059">len</span><span class="op" id="2611062">(</span><span class="ident" id="2611063"><a href="/net/ip.go.html#2611039">ip</a></span><span class="op" id="2611065">)</span>&nbsp;<span class="op" id="2611067">==</span>&nbsp;<span class="num" id="2611070">0</span>&nbsp;<span class="op" id="2611072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611076">return</span>&nbsp;<span class="string" id="2611083">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611090">return</span>&nbsp;<span class="ident" id="2611097"><a href="/net/ip.go.html#2611039">ip</a></span><span class="op" id="2611099">.</span><span class="ident" id="2611100">String</span><span class="op" id="2611106">(</span><span class="op" id="2611107">)</span><br>
<span class="lineno">325</span><span class="op" id="2611109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2611112">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2611176">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="2611227">func</span>&nbsp;<span class="op" id="2611232">(</span><span class="ident" id="2611233">ip</span>&nbsp;<span class="ident" id="2611236"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2611238">)</span>&nbsp;<span class="ident" id="2611240">MarshalText</span><span class="op" id="2611251">(</span><span class="op" id="2611252">)</span>&nbsp;<span class="op" id="2611254">(</span><span class="op" id="2611255">[</span><span class="op" id="2611256">]</span><span class="builtintype" id="2611257">byte</span><span class="op" id="2611261">,</span>&nbsp;<span class="builtintype" id="2611263">error</span><span class="op" id="2611268">)</span>&nbsp;<span class="op" id="2611270">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611273">if</span>&nbsp;<span class="builtinfunc" id="2611276">len</span><span class="op" id="2611279">(</span><span class="ident" id="2611280"><a href="/net/ip.go.html#2611233">ip</a></span><span class="op" id="2611282">)</span>&nbsp;<span class="op" id="2611284">==</span>&nbsp;<span class="num" id="2611287">0</span>&nbsp;<span class="op" id="2611289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611293">return</span>&nbsp;<span class="op" id="2611300">[</span><span class="op" id="2611301">]</span><span class="builtintype" id="2611302">byte</span><span class="op" id="2611306">(</span><span class="string" id="2611307">&#34;&#34;</span><span class="op" id="2611309">)</span><span class="op" id="2611310">,</span>&nbsp;<span class="ident" id="2611312">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611320">if</span>&nbsp;<span class="builtinfunc" id="2611323">len</span><span class="op" id="2611326">(</span><span class="ident" id="2611327"><a href="/net/ip.go.html#2611233">ip</a></span><span class="op" id="2611329">)</span>&nbsp;<span class="op" id="2611331">!=</span>&nbsp;<span class="ident" id="2611334"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2611342">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2611345">len</span><span class="op" id="2611348">(</span><span class="ident" id="2611349"><a href="/net/ip.go.html#2611233">ip</a></span><span class="op" id="2611351">)</span>&nbsp;<span class="op" id="2611353">!=</span>&nbsp;<span class="ident" id="2611356"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2611364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611368">return</span>&nbsp;<span class="ident" id="2611375">nil</span><span class="op" id="2611378">,</span>&nbsp;<span class="ident" id="2611380"><a href="/net/ip.go.html#2603860">errors</a></span><span class="op" id="2611386">.</span><span class="ident" id="2611387">New</span><span class="op" id="2611390">(</span><span class="string" id="2611391">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="2611411">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611417">return</span>&nbsp;<span class="op" id="2611424">[</span><span class="op" id="2611425">]</span><span class="builtintype" id="2611426">byte</span><span class="op" id="2611430">(</span><span class="ident" id="2611431"><a href="/net/ip.go.html#2611233">ip</a></span><span class="op" id="2611433">.</span><span class="ident" id="2611434">String</span><span class="op" id="2611440">(</span><span class="op" id="2611441">)</span><span class="op" id="2611442">)</span><span class="op" id="2611443">,</span>&nbsp;<span class="ident" id="2611445">nil</span><br>
<span class="lineno"></span><span class="op" id="2611449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2611452">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="2611520">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="2611581">func</span>&nbsp;<span class="op" id="2611586">(</span><span class="ident" id="2611587">ip</span>&nbsp;<span class="op" id="2611590">*</span><span class="ident" id="2611591"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2611593">)</span>&nbsp;<span class="ident" id="2611595">UnmarshalText</span><span class="op" id="2611608">(</span><span class="ident" id="2611609">text</span>&nbsp;<span class="op" id="2611614">[</span><span class="op" id="2611615">]</span><span class="builtintype" id="2611616">byte</span><span class="op" id="2611620">)</span>&nbsp;<span class="builtintype" id="2611622">error</span>&nbsp;<span class="op" id="2611628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611631">if</span>&nbsp;<span class="builtinfunc" id="2611634">len</span><span class="op" id="2611637">(</span><span class="ident" id="2611638"><a href="/net/ip.go.html#2611609">text</a></span><span class="op" id="2611642">)</span>&nbsp;<span class="op" id="2611644">==</span>&nbsp;<span class="num" id="2611647">0</span>&nbsp;<span class="op" id="2611649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611653">*</span><span class="ident" id="2611654"><a href="/net/ip.go.html#2611587">ip</a></span>&nbsp;<span class="op" id="2611657">=</span>&nbsp;<span class="ident" id="2611659">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611665">return</span>&nbsp;<span class="ident" id="2611672">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2611680">s</span>&nbsp;<span class="op" id="2611682">:=</span>&nbsp;<span class="builtintype" id="2611685">string</span><span class="op" id="2611691">(</span><span class="ident" id="2611692"><a href="/net/ip.go.html#2611609">text</a></span><span class="op" id="2611696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2611699">x</span>&nbsp;<span class="op" id="2611701">:=</span>&nbsp;<span class="ident" id="2611704"><a href="/net/ip.go.html#2617916">ParseIP</a></span><span class="op" id="2611711">(</span><span class="ident" id="2611712"><a href="/net/ip.go.html#2611680">s</a></span><span class="op" id="2611713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611716">if</span>&nbsp;<span class="ident" id="2611719"><a href="/net/ip.go.html#2611699">x</a></span>&nbsp;<span class="op" id="2611721">==</span>&nbsp;<span class="ident" id="2611724">nil</span>&nbsp;<span class="op" id="2611728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611732">return</span>&nbsp;<span class="op" id="2611739">&amp;</span><span class="ident" id="2611740"><a href="/net/ip.go.html#2617529">ParseError</a></span><span class="op" id="2611750">{</span><span class="string" id="2611751">&#34;IP&nbsp;address&#34;</span><span class="op" id="2611763">,</span>&nbsp;<span class="ident" id="2611765"><a href="/net/ip.go.html#2611680">s</a></span><span class="op" id="2611766">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2611772">*</span><span class="ident" id="2611773"><a href="/net/ip.go.html#2611587">ip</a></span>&nbsp;<span class="op" id="2611776">=</span>&nbsp;<span class="ident" id="2611778"><a href="/net/ip.go.html#2611699">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611781">return</span>&nbsp;<span class="ident" id="2611788">nil</span><br>
<span class="lineno"></span><span class="op" id="2611792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="2611795">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="2611854">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2611912">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="2611939">func</span>&nbsp;<span class="op" id="2611944">(</span><span class="ident" id="2611945">ip</span>&nbsp;<span class="ident" id="2611948"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2611950">)</span>&nbsp;<span class="ident" id="2611952">Equal</span><span class="op" id="2611957">(</span><span class="ident" id="2611958">x</span>&nbsp;<span class="ident" id="2611960"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2611962">)</span>&nbsp;<span class="builtintype" id="2611964">bool</span>&nbsp;<span class="op" id="2611969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611972">if</span>&nbsp;<span class="builtinfunc" id="2611975">len</span><span class="op" id="2611978">(</span><span class="ident" id="2611979"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2611981">)</span>&nbsp;<span class="op" id="2611983">==</span>&nbsp;<span class="builtinfunc" id="2611986">len</span><span class="op" id="2611989">(</span><span class="ident" id="2611990"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2611991">)</span>&nbsp;<span class="op" id="2611993">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2611997">return</span>&nbsp;<span class="ident" id="2612004"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2612014">(</span><span class="ident" id="2612015"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612017">,</span>&nbsp;<span class="ident" id="2612019"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612026">if</span>&nbsp;<span class="builtinfunc" id="2612029">len</span><span class="op" id="2612032">(</span><span class="ident" id="2612033"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612035">)</span>&nbsp;<span class="op" id="2612037">==</span>&nbsp;<span class="ident" id="2612040"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2612048">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2612051">len</span><span class="op" id="2612054">(</span><span class="ident" id="2612055"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612056">)</span>&nbsp;<span class="op" id="2612058">==</span>&nbsp;<span class="ident" id="2612061"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2612069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612073">return</span>&nbsp;<span class="ident" id="2612080"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2612090">(</span><span class="ident" id="2612091"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612092">[</span><span class="num" id="2612093">0</span><span class="op" id="2612094">:</span><span class="num" id="2612095">12</span><span class="op" id="2612097">]</span><span class="op" id="2612098">,</span>&nbsp;<span class="ident" id="2612100"><a href="/net/ip.go.html#2604735">v4InV6Prefix</a></span><span class="op" id="2612112">)</span>&nbsp;<span class="op" id="2612114">&amp;&amp;</span>&nbsp;<span class="ident" id="2612117"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2612127">(</span><span class="ident" id="2612128"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612130">,</span>&nbsp;<span class="ident" id="2612132"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612133">[</span><span class="num" id="2612134">12</span><span class="op" id="2612136">:</span><span class="op" id="2612137">]</span><span class="op" id="2612138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612141">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612144">if</span>&nbsp;<span class="builtinfunc" id="2612147">len</span><span class="op" id="2612150">(</span><span class="ident" id="2612151"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612153">)</span>&nbsp;<span class="op" id="2612155">==</span>&nbsp;<span class="ident" id="2612158"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2612166">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2612169">len</span><span class="op" id="2612172">(</span><span class="ident" id="2612173"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612174">)</span>&nbsp;<span class="op" id="2612176">==</span>&nbsp;<span class="ident" id="2612179"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2612187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612191">return</span>&nbsp;<span class="ident" id="2612198"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2612208">(</span><span class="ident" id="2612209"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612211">[</span><span class="num" id="2612212">0</span><span class="op" id="2612213">:</span><span class="num" id="2612214">12</span><span class="op" id="2612216">]</span><span class="op" id="2612217">,</span>&nbsp;<span class="ident" id="2612219"><a href="/net/ip.go.html#2604735">v4InV6Prefix</a></span><span class="op" id="2612231">)</span>&nbsp;<span class="op" id="2612233">&amp;&amp;</span>&nbsp;<span class="ident" id="2612236"><a href="/net/ip.go.html#2612284">bytesEqual</a></span><span class="op" id="2612246">(</span><span class="ident" id="2612247"><a href="/net/ip.go.html#2611945">ip</a></span><span class="op" id="2612249">[</span><span class="num" id="2612250">12</span><span class="op" id="2612252">:</span><span class="op" id="2612253">]</span><span class="op" id="2612254">,</span>&nbsp;<span class="ident" id="2612256"><a href="/net/ip.go.html#2611958">x</a></span><span class="op" id="2612257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612263">return</span>&nbsp;<span class="ident" id="2612270">false</span><br>
<span class="lineno"></span><span class="op" id="2612276">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="2612279">func</span>&nbsp;<span class="ident" id="2612284">bytesEqual</span><span class="op" id="2612294">(</span><span class="ident" id="2612295">x</span><span class="op" id="2612296">,</span>&nbsp;<span class="ident" id="2612298">y</span>&nbsp;<span class="op" id="2612300">[</span><span class="op" id="2612301">]</span><span class="builtintype" id="2612302">byte</span><span class="op" id="2612306">)</span>&nbsp;<span class="builtintype" id="2612308">bool</span>&nbsp;<span class="op" id="2612313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612316">if</span>&nbsp;<span class="builtinfunc" id="2612319">len</span><span class="op" id="2612322">(</span><span class="ident" id="2612323"><a href="/net/ip.go.html#2612295">x</a></span><span class="op" id="2612324">)</span>&nbsp;<span class="op" id="2612326">!=</span>&nbsp;<span class="builtinfunc" id="2612329">len</span><span class="op" id="2612332">(</span><span class="ident" id="2612333"><a href="/net/ip.go.html#2612298">y</a></span><span class="op" id="2612334">)</span>&nbsp;<span class="op" id="2612336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612340">return</span>&nbsp;<span class="ident" id="2612347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612354">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612357">for</span>&nbsp;<span class="ident" id="2612361">i</span><span class="op" id="2612362">,</span>&nbsp;<span class="ident" id="2612364">b</span>&nbsp;<span class="op" id="2612366">:=</span>&nbsp;<span class="keyword" id="2612369">range</span>&nbsp;<span class="ident" id="2612375"><a href="/net/ip.go.html#2612295">x</a></span>&nbsp;<span class="op" id="2612377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612381">if</span>&nbsp;<span class="ident" id="2612384"><a href="/net/ip.go.html#2612298">y</a></span><span class="op" id="2612385">[</span><span class="ident" id="2612386"><a href="/net/ip.go.html#2612361">i</a></span><span class="op" id="2612387">]</span>&nbsp;<span class="op" id="2612389">!=</span>&nbsp;<span class="ident" id="2612392"><a href="/net/ip.go.html#2612364">b</a></span>&nbsp;<span class="op" id="2612394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612399">return</span>&nbsp;<span class="ident" id="2612406">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612417">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612420">return</span>&nbsp;<span class="ident" id="2612427">true</span><br>
<span class="lineno"></span><span class="op" id="2612432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2612435">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="2612490">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="2612522">func</span>&nbsp;<span class="ident" id="2612527">simpleMaskLength</span><span class="op" id="2612543">(</span><span class="ident" id="2612544">mask</span>&nbsp;<span class="ident" id="2612549"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2612555">)</span>&nbsp;<span class="builtintype" id="2612557">int</span>&nbsp;<span class="op" id="2612561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612564">var</span>&nbsp;<span class="ident" id="2612568">n</span>&nbsp;<span class="builtintype" id="2612570">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612575">for</span>&nbsp;<span class="ident" id="2612579">i</span><span class="op" id="2612580">,</span>&nbsp;<span class="ident" id="2612582">v</span>&nbsp;<span class="op" id="2612584">:=</span>&nbsp;<span class="keyword" id="2612587">range</span>&nbsp;<span class="ident" id="2612593"><a href="/net/ip.go.html#2612544">mask</a></span>&nbsp;<span class="op" id="2612598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612602">if</span>&nbsp;<span class="ident" id="2612605"><a href="/net/ip.go.html#2612582">v</a></span>&nbsp;<span class="op" id="2612607">==</span>&nbsp;<span class="num" id="2612610">0xff</span>&nbsp;<span class="op" id="2612615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612620"><a href="/net/ip.go.html#2612568">n</a></span>&nbsp;<span class="op" id="2612622">+=</span>&nbsp;<span class="num" id="2612625">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612630">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612645">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612668">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612686">for</span>&nbsp;<span class="ident" id="2612690"><a href="/net/ip.go.html#2612582">v</a></span><span class="op" id="2612691">&amp;</span><span class="num" id="2612692">0x80</span>&nbsp;<span class="op" id="2612697">!=</span>&nbsp;<span class="num" id="2612700">0</span>&nbsp;<span class="op" id="2612702">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612707"><a href="/net/ip.go.html#2612568">n</a></span><span class="op" id="2612708">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2612714"><a href="/net/ip.go.html#2612582">v</a></span>&nbsp;<span class="op" id="2612716">&lt;&lt;=</span>&nbsp;<span class="num" id="2612720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2612728">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612753">if</span>&nbsp;<span class="ident" id="2612756"><a href="/net/ip.go.html#2612582">v</a></span>&nbsp;<span class="op" id="2612758">!=</span>&nbsp;<span class="num" id="2612761">0</span>&nbsp;<span class="op" id="2612763">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612768">return</span>&nbsp;<span class="op" id="2612775">-</span><span class="num" id="2612776">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612784">for</span>&nbsp;<span class="ident" id="2612788"><a href="/net/ip.go.html#2612579">i</a></span><span class="op" id="2612789">++</span><span class="op" id="2612791">;</span>&nbsp;<span class="ident" id="2612793"><a href="/net/ip.go.html#2612579">i</a></span>&nbsp;<span class="op" id="2612795">&lt;</span>&nbsp;<span class="builtinfunc" id="2612797">len</span><span class="op" id="2612800">(</span><span class="ident" id="2612801"><a href="/net/ip.go.html#2612544">mask</a></span><span class="op" id="2612805">)</span><span class="op" id="2612806">;</span>&nbsp;<span class="ident" id="2612808"><a href="/net/ip.go.html#2612579">i</a></span><span class="op" id="2612809">++</span>&nbsp;<span class="op" id="2612812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612817">if</span>&nbsp;<span class="ident" id="2612820"><a href="/net/ip.go.html#2612544">mask</a></span><span class="op" id="2612824">[</span><span class="ident" id="2612825"><a href="/net/ip.go.html#2612579">i</a></span><span class="op" id="2612826">]</span>&nbsp;<span class="op" id="2612828">!=</span>&nbsp;<span class="num" id="2612831">0</span>&nbsp;<span class="op" id="2612833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612839">return</span>&nbsp;<span class="op" id="2612846">-</span><span class="num" id="2612847">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612860">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2612867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2612870">return</span>&nbsp;<span class="ident" id="2612877"><a href="/net/ip.go.html#2612568">n</a></span><br>
<span class="lineno">410</span><span class="op" id="2612879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2612882">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="2612953">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="2613027">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="2613049">func</span>&nbsp;<span class="op" id="2613054">(</span><span class="ident" id="2613055">m</span>&nbsp;<span class="ident" id="2613057"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2613063">)</span>&nbsp;<span class="ident" id="2613065">Size</span><span class="op" id="2613069">(</span><span class="op" id="2613070">)</span>&nbsp;<span class="op" id="2613072">(</span><span class="ident" id="2613073">ones</span><span class="op" id="2613077">,</span>&nbsp;<span class="ident" id="2613079">bits</span>&nbsp;<span class="builtintype" id="2613084">int</span><span class="op" id="2613087">)</span>&nbsp;<span class="op" id="2613089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613092"><a href="/net/ip.go.html#2613073">ones</a></span><span class="op" id="2613096">,</span>&nbsp;<span class="ident" id="2613098"><a href="/net/ip.go.html#2613079">bits</a></span>&nbsp;<span class="op" id="2613103">=</span>&nbsp;<span class="ident" id="2613105"><a href="/net/ip.go.html#2612527">simpleMaskLength</a></span><span class="op" id="2613121">(</span><span class="ident" id="2613122"><a href="/net/ip.go.html#2613055">m</a></span><span class="op" id="2613123">)</span><span class="op" id="2613124">,</span>&nbsp;<span class="builtinfunc" id="2613126">len</span><span class="op" id="2613129">(</span><span class="ident" id="2613130"><a href="/net/ip.go.html#2613055">m</a></span><span class="op" id="2613131">)</span><span class="op" id="2613132">*</span><span class="num" id="2613133">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613136">if</span>&nbsp;<span class="ident" id="2613139"><a href="/net/ip.go.html#2613073">ones</a></span>&nbsp;<span class="op" id="2613144">==</span>&nbsp;<span class="op" id="2613147">-</span><span class="num" id="2613148">1</span>&nbsp;<span class="op" id="2613150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613154">return</span>&nbsp;<span class="num" id="2613161">0</span><span class="op" id="2613162">,</span>&nbsp;<span class="num" id="2613164">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613167">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613170">return</span><br>
<span class="lineno"></span><span class="op" id="2613177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2613180">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="2613246">func</span>&nbsp;<span class="op" id="2613251">(</span><span class="ident" id="2613252">m</span>&nbsp;<span class="ident" id="2613254"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2613260">)</span>&nbsp;<span class="ident" id="2613262">String</span><span class="op" id="2613268">(</span><span class="op" id="2613269">)</span>&nbsp;<span class="builtintype" id="2613271">string</span>&nbsp;<span class="op" id="2613278">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613281">if</span>&nbsp;<span class="builtinfunc" id="2613284">len</span><span class="op" id="2613287">(</span><span class="ident" id="2613288"><a href="/net/ip.go.html#2613252">m</a></span><span class="op" id="2613289">)</span>&nbsp;<span class="op" id="2613291">==</span>&nbsp;<span class="num" id="2613294">0</span>&nbsp;<span class="op" id="2613296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613300">return</span>&nbsp;<span class="string" id="2613307">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613319">buf</span>&nbsp;<span class="op" id="2613323">:=</span>&nbsp;<span class="builtinfunc" id="2613326">make</span><span class="op" id="2613330">(</span><span class="op" id="2613331">[</span><span class="op" id="2613332">]</span><span class="builtintype" id="2613333">byte</span><span class="op" id="2613337">,</span>&nbsp;<span class="builtinfunc" id="2613339">len</span><span class="op" id="2613342">(</span><span class="ident" id="2613343"><a href="/net/ip.go.html#2613252">m</a></span><span class="op" id="2613344">)</span><span class="op" id="2613345">*</span><span class="num" id="2613346">2</span><span class="op" id="2613347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613350">for</span>&nbsp;<span class="ident" id="2613354">i</span><span class="op" id="2613355">,</span>&nbsp;<span class="ident" id="2613357">b</span>&nbsp;<span class="op" id="2613359">:=</span>&nbsp;<span class="keyword" id="2613362">range</span>&nbsp;<span class="ident" id="2613368"><a href="/net/ip.go.html#2613252">m</a></span>&nbsp;<span class="op" id="2613370">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613374"><a href="/net/ip.go.html#2613319">buf</a></span><span class="op" id="2613377">[</span><span class="ident" id="2613378"><a href="/net/ip.go.html#2613354">i</a></span><span class="op" id="2613379">*</span><span class="num" id="2613380">2</span><span class="op" id="2613381">]</span><span class="op" id="2613382">,</span>&nbsp;<span class="ident" id="2613384"><a href="/net/ip.go.html#2613319">buf</a></span><span class="op" id="2613387">[</span><span class="ident" id="2613388"><a href="/net/ip.go.html#2613354">i</a></span><span class="op" id="2613389">*</span><span class="num" id="2613390">2</span><span class="op" id="2613391">+</span><span class="num" id="2613392">1</span><span class="op" id="2613393">]</span>&nbsp;<span class="op" id="2613395">=</span>&nbsp;<span class="ident" id="2613397"><a href="/net/mac.go.html#2649509">hexDigit</a></span><span class="op" id="2613405">[</span><span class="ident" id="2613406"><a href="/net/ip.go.html#2613357">b</a></span><span class="op" id="2613407">&gt;&gt;</span><span class="num" id="2613409">4</span><span class="op" id="2613410">]</span><span class="op" id="2613411">,</span>&nbsp;<span class="ident" id="2613413"><a href="/net/mac.go.html#2649509">hexDigit</a></span><span class="op" id="2613421">[</span><span class="ident" id="2613422"><a href="/net/ip.go.html#2613357">b</a></span><span class="op" id="2613423">&amp;</span><span class="num" id="2613424">0xf</span><span class="op" id="2613427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613433">return</span>&nbsp;<span class="builtintype" id="2613440">string</span><span class="op" id="2613446">(</span><span class="ident" id="2613447"><a href="/net/ip.go.html#2613319">buf</a></span><span class="op" id="2613450">)</span><br>
<span class="lineno"></span><span class="op" id="2613452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="2613455">func</span>&nbsp;<span class="ident" id="2613460">networkNumberAndMask</span><span class="op" id="2613480">(</span><span class="ident" id="2613481">n</span>&nbsp;<span class="op" id="2613483">*</span><span class="ident" id="2613484"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2613489">)</span>&nbsp;<span class="op" id="2613491">(</span><span class="ident" id="2613492">ip</span>&nbsp;<span class="ident" id="2613495"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2613497">,</span>&nbsp;<span class="ident" id="2613499">m</span>&nbsp;<span class="ident" id="2613501"><a href="/net/ip.go.html#2604378">IPMask</a></span><span class="op" id="2613507">)</span>&nbsp;<span class="op" id="2613509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613512">if</span>&nbsp;<span class="ident" id="2613515"><a href="/net/ip.go.html#2613492">ip</a></span>&nbsp;<span class="op" id="2613518">=</span>&nbsp;<span class="ident" id="2613520"><a href="/net/ip.go.html#2613481">n</a></span><span class="op" id="2613521">.</span><span class="ident" id="2613522">IP</span><span class="op" id="2613524">.</span><span class="ident" id="2613525">To4</span><span class="op" id="2613528">(</span><span class="op" id="2613529">)</span><span class="op" id="2613530">;</span>&nbsp;<span class="ident" id="2613532"><a href="/net/ip.go.html#2613492">ip</a></span>&nbsp;<span class="op" id="2613535">==</span>&nbsp;<span class="ident" id="2613538">nil</span>&nbsp;<span class="op" id="2613542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613546"><a href="/net/ip.go.html#2613492">ip</a></span>&nbsp;<span class="op" id="2613549">=</span>&nbsp;<span class="ident" id="2613551"><a href="/net/ip.go.html#2613481">n</a></span><span class="op" id="2613552">.</span><span class="ident" id="2613553">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613558">if</span>&nbsp;<span class="builtinfunc" id="2613561">len</span><span class="op" id="2613564">(</span><span class="ident" id="2613565"><a href="/net/ip.go.html#2613492">ip</a></span><span class="op" id="2613567">)</span>&nbsp;<span class="op" id="2613569">!=</span>&nbsp;<span class="ident" id="2613572"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2613580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613585">return</span>&nbsp;<span class="ident" id="2613592">nil</span><span class="op" id="2613595">,</span>&nbsp;<span class="ident" id="2613597">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613609"><a href="/net/ip.go.html#2613499">m</a></span>&nbsp;<span class="op" id="2613611">=</span>&nbsp;<span class="ident" id="2613613"><a href="/net/ip.go.html#2613481">n</a></span><span class="op" id="2613614">.</span><span class="ident" id="2613615">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613621">switch</span>&nbsp;<span class="builtinfunc" id="2613628">len</span><span class="op" id="2613631">(</span><span class="ident" id="2613632"><a href="/net/ip.go.html#2613499">m</a></span><span class="op" id="2613633">)</span>&nbsp;<span class="op" id="2613635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613638">case</span>&nbsp;<span class="ident" id="2613643"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2613650">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613654">if</span>&nbsp;<span class="builtinfunc" id="2613657">len</span><span class="op" id="2613660">(</span><span class="ident" id="2613661"><a href="/net/ip.go.html#2613492">ip</a></span><span class="op" id="2613663">)</span>&nbsp;<span class="op" id="2613665">!=</span>&nbsp;<span class="ident" id="2613668"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2613676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613681">return</span>&nbsp;<span class="ident" id="2613688">nil</span><span class="op" id="2613691">,</span>&nbsp;<span class="ident" id="2613693">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613702">case</span>&nbsp;<span class="ident" id="2613707"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2613714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613718">if</span>&nbsp;<span class="builtinfunc" id="2613721">len</span><span class="op" id="2613724">(</span><span class="ident" id="2613725"><a href="/net/ip.go.html#2613492">ip</a></span><span class="op" id="2613727">)</span>&nbsp;<span class="op" id="2613729">==</span>&nbsp;<span class="ident" id="2613732"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2613740">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613745"><a href="/net/ip.go.html#2613499">m</a></span>&nbsp;<span class="op" id="2613747">=</span>&nbsp;<span class="ident" id="2613749"><a href="/net/ip.go.html#2613499">m</a></span><span class="op" id="2613750">[</span><span class="num" id="2613751">12</span><span class="op" id="2613753">:</span><span class="op" id="2613754">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613761">default</span><span class="op" id="2613768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613772">return</span>&nbsp;<span class="ident" id="2613779">nil</span><span class="op" id="2613782">,</span>&nbsp;<span class="ident" id="2613784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613789">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613792">return</span><br>
<span class="lineno"></span><span class="op" id="2613799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2613802">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="2613855">func</span>&nbsp;<span class="op" id="2613860">(</span><span class="ident" id="2613861">n</span>&nbsp;<span class="op" id="2613863">*</span><span class="ident" id="2613864"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2613869">)</span>&nbsp;<span class="ident" id="2613871">Contains</span><span class="op" id="2613879">(</span><span class="ident" id="2613880">ip</span>&nbsp;<span class="ident" id="2613883"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2613885">)</span>&nbsp;<span class="builtintype" id="2613887">bool</span>&nbsp;<span class="op" id="2613892">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613895">nn</span><span class="op" id="2613897">,</span>&nbsp;<span class="ident" id="2613899">m</span>&nbsp;<span class="op" id="2613901">:=</span>&nbsp;<span class="ident" id="2613904"><a href="/net/ip.go.html#2613460">networkNumberAndMask</a></span><span class="op" id="2613924">(</span><span class="ident" id="2613925"><a href="/net/ip.go.html#2613861">n</a></span><span class="op" id="2613926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613929">if</span>&nbsp;<span class="ident" id="2613932">x</span>&nbsp;<span class="op" id="2613934">:=</span>&nbsp;<span class="ident" id="2613937"><a href="/net/ip.go.html#2613880">ip</a></span><span class="op" id="2613939">.</span><span class="ident" id="2613940">To4</span><span class="op" id="2613943">(</span><span class="op" id="2613944">)</span><span class="op" id="2613945">;</span>&nbsp;<span class="ident" id="2613947"><a href="/net/ip.go.html#2613932">x</a></span>&nbsp;<span class="op" id="2613949">!=</span>&nbsp;<span class="ident" id="2613952">nil</span>&nbsp;<span class="op" id="2613956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613960"><a href="/net/ip.go.html#2613880">ip</a></span>&nbsp;<span class="op" id="2613963">=</span>&nbsp;<span class="ident" id="2613965"><a href="/net/ip.go.html#2613932">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2613968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2613971">l</span>&nbsp;<span class="op" id="2613973">:=</span>&nbsp;<span class="builtinfunc" id="2613976">len</span><span class="op" id="2613979">(</span><span class="ident" id="2613980"><a href="/net/ip.go.html#2613880">ip</a></span><span class="op" id="2613982">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2613985">if</span>&nbsp;<span class="ident" id="2613988"><a href="/net/ip.go.html#2613971">l</a></span>&nbsp;<span class="op" id="2613990">!=</span>&nbsp;<span class="builtinfunc" id="2613993">len</span><span class="op" id="2613996">(</span><span class="ident" id="2613997"><a href="/net/ip.go.html#2613895">nn</a></span><span class="op" id="2613999">)</span>&nbsp;<span class="op" id="2614001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614005">return</span>&nbsp;<span class="ident" id="2614012">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614022">for</span>&nbsp;<span class="ident" id="2614026">i</span>&nbsp;<span class="op" id="2614028">:=</span>&nbsp;<span class="num" id="2614031">0</span><span class="op" id="2614032">;</span>&nbsp;<span class="ident" id="2614034"><a href="/net/ip.go.html#2614026">i</a></span>&nbsp;<span class="op" id="2614036">&lt;</span>&nbsp;<span class="ident" id="2614038"><a href="/net/ip.go.html#2613971">l</a></span><span class="op" id="2614039">;</span>&nbsp;<span class="ident" id="2614041"><a href="/net/ip.go.html#2614026">i</a></span><span class="op" id="2614042">++</span>&nbsp;<span class="op" id="2614045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614049">if</span>&nbsp;<span class="ident" id="2614052"><a href="/net/ip.go.html#2613895">nn</a></span><span class="op" id="2614054">[</span><span class="ident" id="2614055"><a href="/net/ip.go.html#2614026">i</a></span><span class="op" id="2614056">]</span><span class="op" id="2614057">&amp;</span><span class="ident" id="2614058"><a href="/net/ip.go.html#2613899">m</a></span><span class="op" id="2614059">[</span><span class="ident" id="2614060"><a href="/net/ip.go.html#2614026">i</a></span><span class="op" id="2614061">]</span>&nbsp;<span class="op" id="2614063">!=</span>&nbsp;<span class="ident" id="2614066"><a href="/net/ip.go.html#2613880">ip</a></span><span class="op" id="2614068">[</span><span class="ident" id="2614069"><a href="/net/ip.go.html#2614026">i</a></span><span class="op" id="2614070">]</span><span class="op" id="2614071">&amp;</span><span class="ident" id="2614072"><a href="/net/ip.go.html#2613899">m</a></span><span class="op" id="2614073">[</span><span class="ident" id="2614074"><a href="/net/ip.go.html#2614026">i</a></span><span class="op" id="2614075">]</span>&nbsp;<span class="op" id="2614077">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614082">return</span>&nbsp;<span class="ident" id="2614089">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614103">return</span>&nbsp;<span class="ident" id="2614110">true</span><br>
<span class="lineno"></span><span class="op" id="2614115">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="2614118">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2614175">func</span>&nbsp;<span class="op" id="2614180">(</span><span class="ident" id="2614181">n</span>&nbsp;<span class="op" id="2614183">*</span><span class="ident" id="2614184"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2614189">)</span>&nbsp;<span class="ident" id="2614191">Network</span><span class="op" id="2614198">(</span><span class="op" id="2614199">)</span>&nbsp;<span class="builtintype" id="2614201">string</span>&nbsp;<span class="op" id="2614208">{</span>&nbsp;<span class="keyword" id="2614210">return</span>&nbsp;<span class="string" id="2614217">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="2614226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2614229">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="2614294">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="2614353">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2614413">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="2614476">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="2614538">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="2614584">func</span>&nbsp;<span class="op" id="2614589">(</span><span class="ident" id="2614590">n</span>&nbsp;<span class="op" id="2614592">*</span><span class="ident" id="2614593"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2614598">)</span>&nbsp;<span class="ident" id="2614600">String</span><span class="op" id="2614606">(</span><span class="op" id="2614607">)</span>&nbsp;<span class="builtintype" id="2614609">string</span>&nbsp;<span class="op" id="2614616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614619">nn</span><span class="op" id="2614621">,</span>&nbsp;<span class="ident" id="2614623">m</span>&nbsp;<span class="op" id="2614625">:=</span>&nbsp;<span class="ident" id="2614628"><a href="/net/ip.go.html#2613460">networkNumberAndMask</a></span><span class="op" id="2614648">(</span><span class="ident" id="2614649"><a href="/net/ip.go.html#2614590">n</a></span><span class="op" id="2614650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614653">if</span>&nbsp;<span class="ident" id="2614656"><a href="/net/ip.go.html#2614619">nn</a></span>&nbsp;<span class="op" id="2614659">==</span>&nbsp;<span class="ident" id="2614662">nil</span>&nbsp;<span class="op" id="2614666">||</span>&nbsp;<span class="ident" id="2614669"><a href="/net/ip.go.html#2614623">m</a></span>&nbsp;<span class="op" id="2614671">==</span>&nbsp;<span class="ident" id="2614674">nil</span>&nbsp;<span class="op" id="2614678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614682">return</span>&nbsp;<span class="string" id="2614689">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614698">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614701">l</span>&nbsp;<span class="op" id="2614703">:=</span>&nbsp;<span class="ident" id="2614706"><a href="/net/ip.go.html#2612527">simpleMaskLength</a></span><span class="op" id="2614722">(</span><span class="ident" id="2614723"><a href="/net/ip.go.html#2614623">m</a></span><span class="op" id="2614724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614727">if</span>&nbsp;<span class="ident" id="2614730"><a href="/net/ip.go.html#2614701">l</a></span>&nbsp;<span class="op" id="2614732">==</span>&nbsp;<span class="op" id="2614735">-</span><span class="num" id="2614736">1</span>&nbsp;<span class="op" id="2614738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614742">return</span>&nbsp;<span class="ident" id="2614749"><a href="/net/ip.go.html#2614619">nn</a></span><span class="op" id="2614751">.</span><span class="ident" id="2614752">String</span><span class="op" id="2614758">(</span><span class="op" id="2614759">)</span>&nbsp;<span class="op" id="2614761">+</span>&nbsp;<span class="string" id="2614763">&#34;/&#34;</span>&nbsp;<span class="op" id="2614767">+</span>&nbsp;<span class="ident" id="2614769"><a href="/net/ip.go.html#2614623">m</a></span><span class="op" id="2614770">.</span><span class="ident" id="2614771">String</span><span class="op" id="2614777">(</span><span class="op" id="2614778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2614781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614784">return</span>&nbsp;<span class="ident" id="2614791"><a href="/net/ip.go.html#2614619">nn</a></span><span class="op" id="2614793">.</span><span class="ident" id="2614794">String</span><span class="op" id="2614800">(</span><span class="op" id="2614801">)</span>&nbsp;<span class="op" id="2614803">+</span>&nbsp;<span class="string" id="2614805">&#34;/&#34;</span>&nbsp;<span class="op" id="2614809">+</span>&nbsp;<span class="ident" id="2614811"><a href="/net/parse.go.html#2666508">itod</a></span><span class="op" id="2614815">(</span><span class="builtintype" id="2614816">uint</span><span class="op" id="2614820">(</span><span class="ident" id="2614821"><a href="/net/ip.go.html#2614701">l</a></span><span class="op" id="2614822">)</span><span class="op" id="2614823">)</span><br>
<span class="lineno">495</span><span class="op" id="2614825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2614828">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="2614861">func</span>&nbsp;<span class="ident" id="2614866">parseIPv4</span><span class="op" id="2614875">(</span><span class="ident" id="2614876">s</span>&nbsp;<span class="builtintype" id="2614878">string</span><span class="op" id="2614884">)</span>&nbsp;<span class="ident" id="2614886"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2614889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614892">var</span>&nbsp;<span class="ident" id="2614896">p</span>&nbsp;<span class="op" id="2614898">[</span><span class="ident" id="2614899"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2614906">]</span><span class="builtintype" id="2614907">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2614913">i</span>&nbsp;<span class="op" id="2614915">:=</span>&nbsp;<span class="num" id="2614918">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614921">for</span>&nbsp;<span class="ident" id="2614925">j</span>&nbsp;<span class="op" id="2614927">:=</span>&nbsp;<span class="num" id="2614930">0</span><span class="op" id="2614931">;</span>&nbsp;<span class="ident" id="2614933"><a href="/net/ip.go.html#2614925">j</a></span>&nbsp;<span class="op" id="2614935">&lt;</span>&nbsp;<span class="ident" id="2614937"><a href="/net/ip.go.html#2603910">IPv4len</a></span><span class="op" id="2614944">;</span>&nbsp;<span class="ident" id="2614946"><a href="/net/ip.go.html#2614925">j</a></span><span class="op" id="2614947">++</span>&nbsp;<span class="op" id="2614950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614954">if</span>&nbsp;<span class="ident" id="2614957"><a href="/net/ip.go.html#2614913">i</a></span>&nbsp;<span class="op" id="2614959">&gt;=</span>&nbsp;<span class="builtinfunc" id="2614962">len</span><span class="op" id="2614965">(</span><span class="ident" id="2614966"><a href="/net/ip.go.html#2614876">s</a></span><span class="op" id="2614967">)</span>&nbsp;<span class="op" id="2614969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2614974">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2614996">return</span>&nbsp;<span class="ident" id="2615003">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615013">if</span>&nbsp;<span class="ident" id="2615016"><a href="/net/ip.go.html#2614925">j</a></span>&nbsp;<span class="op" id="2615018">&gt;</span>&nbsp;<span class="num" id="2615020">0</span>&nbsp;<span class="op" id="2615022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615027">if</span>&nbsp;<span class="ident" id="2615030"><a href="/net/ip.go.html#2614876">s</a></span><span class="op" id="2615031">[</span><span class="ident" id="2615032"><a href="/net/ip.go.html#2614913">i</a></span><span class="op" id="2615033">]</span>&nbsp;<span class="op" id="2615035">!=</span>&nbsp;<span class="string" id="2615038">&#39;.&#39;</span>&nbsp;<span class="op" id="2615042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615048">return</span>&nbsp;<span class="ident" id="2615055">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615062">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615067"><a href="/net/ip.go.html#2614913">i</a></span><span class="op" id="2615068">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615077">var</span>&nbsp;<span class="op" id="2615081">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615086">n</span>&nbsp;&nbsp;<span class="builtintype" id="2615089">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615096">ok</span>&nbsp;<span class="builtintype" id="2615099">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615110"><a href="/net/ip.go.html#2615086">n</a></span><span class="op" id="2615111">,</span>&nbsp;<span class="ident" id="2615113"><a href="/net/ip.go.html#2614913">i</a></span><span class="op" id="2615114">,</span>&nbsp;<span class="ident" id="2615116"><a href="/net/ip.go.html#2615096">ok</a></span>&nbsp;<span class="op" id="2615119">=</span>&nbsp;<span class="ident" id="2615121"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2615125">(</span><span class="ident" id="2615126"><a href="/net/ip.go.html#2614876">s</a></span><span class="op" id="2615127">,</span>&nbsp;<span class="ident" id="2615129"><a href="/net/ip.go.html#2614913">i</a></span><span class="op" id="2615130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615134">if</span>&nbsp;<span class="op" id="2615137">!</span><span class="ident" id="2615138"><a href="/net/ip.go.html#2615096">ok</a></span>&nbsp;<span class="op" id="2615141">||</span>&nbsp;<span class="ident" id="2615144"><a href="/net/ip.go.html#2615086">n</a></span>&nbsp;<span class="op" id="2615146">&gt;</span>&nbsp;<span class="num" id="2615148">0xFF</span>&nbsp;<span class="op" id="2615153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615158">return</span>&nbsp;<span class="ident" id="2615165">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615171">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615175"><a href="/net/ip.go.html#2614896">p</a></span><span class="op" id="2615176">[</span><span class="ident" id="2615177"><a href="/net/ip.go.html#2614925">j</a></span><span class="op" id="2615178">]</span>&nbsp;<span class="op" id="2615180">=</span>&nbsp;<span class="builtintype" id="2615182">byte</span><span class="op" id="2615186">(</span><span class="ident" id="2615187"><a href="/net/ip.go.html#2615086">n</a></span><span class="op" id="2615188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615194">if</span>&nbsp;<span class="ident" id="2615197"><a href="/net/ip.go.html#2614913">i</a></span>&nbsp;<span class="op" id="2615199">!=</span>&nbsp;<span class="builtinfunc" id="2615202">len</span><span class="op" id="2615205">(</span><span class="ident" id="2615206"><a href="/net/ip.go.html#2614876">s</a></span><span class="op" id="2615207">)</span>&nbsp;<span class="op" id="2615209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615213">return</span>&nbsp;<span class="ident" id="2615220">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615225">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615228">return</span>&nbsp;<span class="ident" id="2615235"><a href="/net/ip.go.html#2604600">IPv4</a></span><span class="op" id="2615239">(</span><span class="ident" id="2615240"><a href="/net/ip.go.html#2614896">p</a></span><span class="op" id="2615241">[</span><span class="num" id="2615242">0</span><span class="op" id="2615243">]</span><span class="op" id="2615244">,</span>&nbsp;<span class="ident" id="2615246"><a href="/net/ip.go.html#2614896">p</a></span><span class="op" id="2615247">[</span><span class="num" id="2615248">1</span><span class="op" id="2615249">]</span><span class="op" id="2615250">,</span>&nbsp;<span class="ident" id="2615252"><a href="/net/ip.go.html#2614896">p</a></span><span class="op" id="2615253">[</span><span class="num" id="2615254">2</span><span class="op" id="2615255">]</span><span class="op" id="2615256">,</span>&nbsp;<span class="ident" id="2615258"><a href="/net/ip.go.html#2614896">p</a></span><span class="op" id="2615259">[</span><span class="num" id="2615260">3</span><span class="op" id="2615261">]</span><span class="op" id="2615262">)</span><br>
<span class="lineno"></span><span class="op" id="2615264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2615267">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="2615337">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="2615408">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2615478">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2615487">func</span>&nbsp;<span class="ident" id="2615492">parseIPv6</span><span class="op" id="2615501">(</span><span class="ident" id="2615502">s</span>&nbsp;<span class="builtintype" id="2615504">string</span><span class="op" id="2615510">,</span>&nbsp;<span class="ident" id="2615512">zoneAllowed</span>&nbsp;<span class="builtintype" id="2615524">bool</span><span class="op" id="2615528">)</span>&nbsp;<span class="op" id="2615530">(</span><span class="ident" id="2615531">ip</span>&nbsp;<span class="ident" id="2615534"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2615536">,</span>&nbsp;<span class="ident" id="2615538">zone</span>&nbsp;<span class="builtintype" id="2615543">string</span><span class="op" id="2615549">)</span>&nbsp;<span class="op" id="2615551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615554"><a href="/net/ip.go.html#2615531">ip</a></span>&nbsp;<span class="op" id="2615557">=</span>&nbsp;<span class="builtinfunc" id="2615559">make</span><span class="op" id="2615563">(</span><span class="ident" id="2615564"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2615566">,</span>&nbsp;<span class="ident" id="2615568"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2615575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615578">ellipsis</span>&nbsp;<span class="op" id="2615587">:=</span>&nbsp;<span class="op" id="2615590">-</span><span class="num" id="2615591">1</span>&nbsp;<span class="comment" id="2615593">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615623">i</span>&nbsp;<span class="op" id="2615625">:=</span>&nbsp;<span class="num" id="2615628">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615638">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615661">if</span>&nbsp;<span class="ident" id="2615664"><a href="/net/ip.go.html#2615512">zoneAllowed</a></span>&nbsp;<span class="op" id="2615676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615680"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615681">,</span>&nbsp;<span class="ident" id="2615683"><a href="/net/ip.go.html#2615538">zone</a></span>&nbsp;<span class="op" id="2615688">=</span>&nbsp;<span class="ident" id="2615690"><a href="/net/ipsock.go.html#2632748">splitHostZone</a></span><span class="op" id="2615703">(</span><span class="ident" id="2615704"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615708">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2615712">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615744">if</span>&nbsp;<span class="builtinfunc" id="2615747">len</span><span class="op" id="2615750">(</span><span class="ident" id="2615751"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615752">)</span>&nbsp;<span class="op" id="2615754">&gt;=</span>&nbsp;<span class="num" id="2615757">2</span>&nbsp;<span class="op" id="2615759">&amp;&amp;</span>&nbsp;<span class="ident" id="2615762"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615763">[</span><span class="num" id="2615764">0</span><span class="op" id="2615765">]</span>&nbsp;<span class="op" id="2615767">==</span>&nbsp;<span class="string" id="2615770">&#39;:&#39;</span>&nbsp;<span class="op" id="2615774">&amp;&amp;</span>&nbsp;<span class="ident" id="2615777"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615778">[</span><span class="num" id="2615779">1</span><span class="op" id="2615780">]</span>&nbsp;<span class="op" id="2615782">==</span>&nbsp;<span class="string" id="2615785">&#39;:&#39;</span>&nbsp;<span class="op" id="2615789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615793"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2615802">=</span>&nbsp;<span class="num" id="2615804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615808"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2615810">=</span>&nbsp;<span class="num" id="2615812">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2615816">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615844">if</span>&nbsp;<span class="ident" id="2615847"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2615849">==</span>&nbsp;<span class="builtinfunc" id="2615852">len</span><span class="op" id="2615855">(</span><span class="ident" id="2615856"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2615857">)</span>&nbsp;<span class="op" id="2615859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615864">return</span>&nbsp;<span class="ident" id="2615871"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2615873">,</span>&nbsp;<span class="ident" id="2615875"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2615885">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2615889">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615938">j</span>&nbsp;<span class="op" id="2615940">:=</span>&nbsp;<span class="num" id="2615943">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2615946">for</span>&nbsp;<span class="ident" id="2615950"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2615952">&lt;</span>&nbsp;<span class="ident" id="2615954"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2615962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2615966">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2615983">n</span><span class="op" id="2615984">,</span>&nbsp;<span class="ident" id="2615986">i1</span><span class="op" id="2615988">,</span>&nbsp;<span class="ident" id="2615990">ok</span>&nbsp;<span class="op" id="2615993">:=</span>&nbsp;<span class="ident" id="2615996"><a href="/net/parse.go.html#2665351">xtoi</a></span><span class="op" id="2616000">(</span><span class="ident" id="2616001"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616002">,</span>&nbsp;<span class="ident" id="2616004"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616009">if</span>&nbsp;<span class="op" id="2616012">!</span><span class="ident" id="2616013"><a href="/net/ip.go.html#2615990">ok</a></span>&nbsp;<span class="op" id="2616016">||</span>&nbsp;<span class="ident" id="2616019"><a href="/net/ip.go.html#2615983">n</a></span>&nbsp;<span class="op" id="2616021">&gt;</span>&nbsp;<span class="num" id="2616023">0xFFFF</span>&nbsp;<span class="op" id="2616030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616035">return</span>&nbsp;<span class="ident" id="2616042">nil</span><span class="op" id="2616045">,</span>&nbsp;<span class="ident" id="2616047"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616059">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616111">if</span>&nbsp;<span class="ident" id="2616114"><a href="/net/ip.go.html#2615986">i1</a></span>&nbsp;<span class="op" id="2616117">&lt;</span>&nbsp;<span class="builtinfunc" id="2616119">len</span><span class="op" id="2616122">(</span><span class="ident" id="2616123"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616124">)</span>&nbsp;<span class="op" id="2616126">&amp;&amp;</span>&nbsp;<span class="ident" id="2616129"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616130">[</span><span class="ident" id="2616131"><a href="/net/ip.go.html#2615986">i1</a></span><span class="op" id="2616133">]</span>&nbsp;<span class="op" id="2616135">==</span>&nbsp;<span class="string" id="2616138">&#39;.&#39;</span>&nbsp;<span class="op" id="2616142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616147">if</span>&nbsp;<span class="ident" id="2616150"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2616159">&lt;</span>&nbsp;<span class="num" id="2616161">0</span>&nbsp;<span class="op" id="2616163">&amp;&amp;</span>&nbsp;<span class="ident" id="2616166"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2616168">!=</span>&nbsp;<span class="ident" id="2616171"><a href="/net/ip.go.html#2603923">IPv6len</a></span><span class="op" id="2616178">-</span><span class="ident" id="2616179"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2616187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616193">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616221">return</span>&nbsp;<span class="ident" id="2616228">nil</span><span class="op" id="2616231">,</span>&nbsp;<span class="ident" id="2616233"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616246">if</span>&nbsp;<span class="ident" id="2616249"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616250">+</span><span class="ident" id="2616251"><a href="/net/ip.go.html#2603910">IPv4len</a></span>&nbsp;<span class="op" id="2616259">&gt;</span>&nbsp;<span class="ident" id="2616261"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2616269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616275">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616299">return</span>&nbsp;<span class="ident" id="2616306">nil</span><span class="op" id="2616309">,</span>&nbsp;<span class="ident" id="2616311"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616319">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616324">ip4</span>&nbsp;<span class="op" id="2616328">:=</span>&nbsp;<span class="ident" id="2616331"><a href="/net/ip.go.html#2614866">parseIPv4</a></span><span class="op" id="2616340">(</span><span class="ident" id="2616341"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616342">[</span><span class="ident" id="2616343"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616344">:</span><span class="op" id="2616345">]</span><span class="op" id="2616346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616351">if</span>&nbsp;<span class="ident" id="2616354"><a href="/net/ip.go.html#2616324">ip4</a></span>&nbsp;<span class="op" id="2616358">==</span>&nbsp;<span class="ident" id="2616361">nil</span>&nbsp;<span class="op" id="2616365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616371">return</span>&nbsp;<span class="ident" id="2616378">nil</span><span class="op" id="2616381">,</span>&nbsp;<span class="ident" id="2616383"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616396"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616398">[</span><span class="ident" id="2616399"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616400">]</span>&nbsp;<span class="op" id="2616402">=</span>&nbsp;<span class="ident" id="2616404"><a href="/net/ip.go.html#2616324">ip4</a></span><span class="op" id="2616407">[</span><span class="num" id="2616408">12</span><span class="op" id="2616410">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616415"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616417">[</span><span class="ident" id="2616418"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616419">+</span><span class="num" id="2616420">1</span><span class="op" id="2616421">]</span>&nbsp;<span class="op" id="2616423">=</span>&nbsp;<span class="ident" id="2616425"><a href="/net/ip.go.html#2616324">ip4</a></span><span class="op" id="2616428">[</span><span class="num" id="2616429">13</span><span class="op" id="2616431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616436"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616438">[</span><span class="ident" id="2616439"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616440">+</span><span class="num" id="2616441">2</span><span class="op" id="2616442">]</span>&nbsp;<span class="op" id="2616444">=</span>&nbsp;<span class="ident" id="2616446"><a href="/net/ip.go.html#2616324">ip4</a></span><span class="op" id="2616449">[</span><span class="num" id="2616450">14</span><span class="op" id="2616452">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616457"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616459">[</span><span class="ident" id="2616460"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616461">+</span><span class="num" id="2616462">3</span><span class="op" id="2616463">]</span>&nbsp;<span class="op" id="2616465">=</span>&nbsp;<span class="ident" id="2616467"><a href="/net/ip.go.html#2616324">ip4</a></span><span class="op" id="2616470">[</span><span class="num" id="2616471">15</span><span class="op" id="2616473">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616478"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2616480">=</span>&nbsp;<span class="builtinfunc" id="2616482">len</span><span class="op" id="2616485">(</span><span class="ident" id="2616486"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616492"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2616494">+=</span>&nbsp;<span class="ident" id="2616497"><a href="/net/ip.go.html#2603910">IPv4len</a></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616508">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616521">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616550"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616552">[</span><span class="ident" id="2616553"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616554">]</span>&nbsp;<span class="op" id="2616556">=</span>&nbsp;<span class="builtintype" id="2616558">byte</span><span class="op" id="2616562">(</span><span class="ident" id="2616563"><a href="/net/ip.go.html#2615983">n</a></span>&nbsp;<span class="op" id="2616565">&gt;&gt;</span>&nbsp;<span class="num" id="2616568">8</span><span class="op" id="2616569">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616573"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2616575">[</span><span class="ident" id="2616576"><a href="/net/ip.go.html#2615938">j</a></span><span class="op" id="2616577">+</span><span class="num" id="2616578">1</span><span class="op" id="2616579">]</span>&nbsp;<span class="op" id="2616581">=</span>&nbsp;<span class="builtintype" id="2616583">byte</span><span class="op" id="2616587">(</span><span class="ident" id="2616588"><a href="/net/ip.go.html#2615983">n</a></span><span class="op" id="2616589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616593"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2616595">+=</span>&nbsp;<span class="num" id="2616598">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616603">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616631"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2616633">=</span>&nbsp;<span class="ident" id="2616635"><a href="/net/ip.go.html#2615986">i1</a></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616640">if</span>&nbsp;<span class="ident" id="2616643"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2616645">==</span>&nbsp;<span class="builtinfunc" id="2616648">len</span><span class="op" id="2616651">(</span><span class="ident" id="2616652"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616653">)</span>&nbsp;<span class="op" id="2616655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616660">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616673">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616724">if</span>&nbsp;<span class="ident" id="2616727"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616728">[</span><span class="ident" id="2616729"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616730">]</span>&nbsp;<span class="op" id="2616732">!=</span>&nbsp;<span class="string" id="2616735">&#39;:&#39;</span>&nbsp;<span class="op" id="2616739">||</span>&nbsp;<span class="ident" id="2616742"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616743">+</span><span class="num" id="2616744">1</span>&nbsp;<span class="op" id="2616746">==</span>&nbsp;<span class="builtinfunc" id="2616749">len</span><span class="op" id="2616752">(</span><span class="ident" id="2616753"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616754">)</span>&nbsp;<span class="op" id="2616756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616761">return</span>&nbsp;<span class="ident" id="2616768">nil</span><span class="op" id="2616771">,</span>&nbsp;<span class="ident" id="2616773"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616784"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616785">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616791">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616815">if</span>&nbsp;<span class="ident" id="2616818"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616819">[</span><span class="ident" id="2616820"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616821">]</span>&nbsp;<span class="op" id="2616823">==</span>&nbsp;<span class="string" id="2616826">&#39;:&#39;</span>&nbsp;<span class="op" id="2616830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616835">if</span>&nbsp;<span class="ident" id="2616838"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2616847">&gt;=</span>&nbsp;<span class="num" id="2616850">0</span>&nbsp;<span class="op" id="2616852">{</span>&nbsp;<span class="comment" id="2616854">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616878">return</span>&nbsp;<span class="ident" id="2616885">nil</span><span class="op" id="2616888">,</span>&nbsp;<span class="ident" id="2616890"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616898">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2616903"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2616912">=</span>&nbsp;<span class="ident" id="2616914"><a href="/net/ip.go.html#2615938">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616919">if</span>&nbsp;<span class="ident" id="2616922"><a href="/net/ip.go.html#2615623">i</a></span><span class="op" id="2616923">++</span><span class="op" id="2616925">;</span>&nbsp;<span class="ident" id="2616927"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2616929">==</span>&nbsp;<span class="builtinfunc" id="2616932">len</span><span class="op" id="2616935">(</span><span class="ident" id="2616936"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2616937">)</span>&nbsp;<span class="op" id="2616939">{</span>&nbsp;<span class="comment" id="2616941">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2616962">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616975">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2616978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2616982">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617016">if</span>&nbsp;<span class="ident" id="2617019"><a href="/net/ip.go.html#2615623">i</a></span>&nbsp;<span class="op" id="2617021">!=</span>&nbsp;<span class="builtinfunc" id="2617024">len</span><span class="op" id="2617027">(</span><span class="ident" id="2617028"><a href="/net/ip.go.html#2615502">s</a></span><span class="op" id="2617029">)</span>&nbsp;<span class="op" id="2617031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617035">return</span>&nbsp;<span class="ident" id="2617042">nil</span><span class="op" id="2617045">,</span>&nbsp;<span class="ident" id="2617047"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617057">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617102">if</span>&nbsp;<span class="ident" id="2617105"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2617107">&lt;</span>&nbsp;<span class="ident" id="2617109"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2617117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617121">if</span>&nbsp;<span class="ident" id="2617124"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2617133">&lt;</span>&nbsp;<span class="num" id="2617135">0</span>&nbsp;<span class="op" id="2617137">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617142">return</span>&nbsp;<span class="ident" id="2617149">nil</span><span class="op" id="2617152">,</span>&nbsp;<span class="ident" id="2617154"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617165">n</span>&nbsp;<span class="op" id="2617167">:=</span>&nbsp;<span class="ident" id="2617170"><a href="/net/ip.go.html#2603923">IPv6len</a></span>&nbsp;<span class="op" id="2617178">-</span>&nbsp;<span class="ident" id="2617180"><a href="/net/ip.go.html#2615938">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617184">for</span>&nbsp;<span class="ident" id="2617188">k</span>&nbsp;<span class="op" id="2617190">:=</span>&nbsp;<span class="ident" id="2617193"><a href="/net/ip.go.html#2615938">j</a></span>&nbsp;<span class="op" id="2617195">-</span>&nbsp;<span class="num" id="2617197">1</span><span class="op" id="2617198">;</span>&nbsp;<span class="ident" id="2617200"><a href="/net/ip.go.html#2617188">k</a></span>&nbsp;<span class="op" id="2617202">&gt;=</span>&nbsp;<span class="ident" id="2617205"><a href="/net/ip.go.html#2615578">ellipsis</a></span><span class="op" id="2617213">;</span>&nbsp;<span class="ident" id="2617215"><a href="/net/ip.go.html#2617188">k</a></span><span class="op" id="2617216">--</span>&nbsp;<span class="op" id="2617219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617224"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2617226">[</span><span class="ident" id="2617227"><a href="/net/ip.go.html#2617188">k</a></span><span class="op" id="2617228">+</span><span class="ident" id="2617229"><a href="/net/ip.go.html#2617165">n</a></span><span class="op" id="2617230">]</span>&nbsp;<span class="op" id="2617232">=</span>&nbsp;<span class="ident" id="2617234"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2617236">[</span><span class="ident" id="2617237"><a href="/net/ip.go.html#2617188">k</a></span><span class="op" id="2617238">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617246">for</span>&nbsp;<span class="ident" id="2617250">k</span>&nbsp;<span class="op" id="2617252">:=</span>&nbsp;<span class="ident" id="2617255"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2617264">+</span>&nbsp;<span class="ident" id="2617266"><a href="/net/ip.go.html#2617165">n</a></span>&nbsp;<span class="op" id="2617268">-</span>&nbsp;<span class="num" id="2617270">1</span><span class="op" id="2617271">;</span>&nbsp;<span class="ident" id="2617273"><a href="/net/ip.go.html#2617250">k</a></span>&nbsp;<span class="op" id="2617275">&gt;=</span>&nbsp;<span class="ident" id="2617278"><a href="/net/ip.go.html#2615578">ellipsis</a></span><span class="op" id="2617286">;</span>&nbsp;<span class="ident" id="2617288"><a href="/net/ip.go.html#2617250">k</a></span><span class="op" id="2617289">--</span>&nbsp;<span class="op" id="2617292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617297"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2617299">[</span><span class="ident" id="2617300"><a href="/net/ip.go.html#2617250">k</a></span><span class="op" id="2617301">]</span>&nbsp;<span class="op" id="2617303">=</span>&nbsp;<span class="num" id="2617305">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617312">}</span>&nbsp;<span class="keyword" id="2617314">else</span>&nbsp;<span class="keyword" id="2617319">if</span>&nbsp;<span class="ident" id="2617322"><a href="/net/ip.go.html#2615578">ellipsis</a></span>&nbsp;<span class="op" id="2617331">&gt;=</span>&nbsp;<span class="num" id="2617334">0</span>&nbsp;<span class="op" id="2617336">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2617340">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617391">return</span>&nbsp;<span class="ident" id="2617398">nil</span><span class="op" id="2617401">,</span>&nbsp;<span class="ident" id="2617403"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2617409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617412">return</span>&nbsp;<span class="ident" id="2617419"><a href="/net/ip.go.html#2615531">ip</a></span><span class="op" id="2617421">,</span>&nbsp;<span class="ident" id="2617423"><a href="/net/ip.go.html#2615538">zone</a></span><br>
<span class="lineno"></span><span class="op" id="2617428">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="2617431">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="2617524">type</span>&nbsp;<span class="ident" id="2617529">ParseError</span>&nbsp;<span class="keyword" id="2617540">struct</span>&nbsp;<span class="op" id="2617547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617550">Type</span>&nbsp;<span class="builtintype" id="2617555">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2617563">Text</span>&nbsp;<span class="builtintype" id="2617568">string</span><br>
<span class="lineno">640</span><span class="op" id="2617575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617578">func</span>&nbsp;<span class="op" id="2617583">(</span><span class="ident" id="2617584">e</span>&nbsp;<span class="op" id="2617586">*</span><span class="ident" id="2617587"><a href="/net/ip.go.html#2617529">ParseError</a></span><span class="op" id="2617597">)</span>&nbsp;<span class="ident" id="2617599">Error</span><span class="op" id="2617604">(</span><span class="op" id="2617605">)</span>&nbsp;<span class="builtintype" id="2617607">string</span>&nbsp;<span class="op" id="2617614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617617">return</span>&nbsp;<span class="string" id="2617624">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="2617635">+</span>&nbsp;<span class="ident" id="2617637"><a href="/net/ip.go.html#2617584">e</a></span><span class="op" id="2617638">.</span><span class="ident" id="2617639">Type</span>&nbsp;<span class="op" id="2617644">+</span>&nbsp;<span class="string" id="2617646">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2617651">+</span>&nbsp;<span class="ident" id="2617653"><a href="/net/ip.go.html#2617584">e</a></span><span class="op" id="2617654">.</span><span class="ident" id="2617655">Text</span><br>
<span class="lineno"></span><span class="op" id="2617660">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="2617663">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="2617723">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="2617781">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="2617823">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="2617887">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2617911">func</span>&nbsp;<span class="ident" id="2617916">ParseIP</span><span class="op" id="2617923">(</span><span class="ident" id="2617924">s</span>&nbsp;<span class="builtintype" id="2617926">string</span><span class="op" id="2617932">)</span>&nbsp;<span class="ident" id="2617934"><a href="/net/ip.go.html#2604330">IP</a></span>&nbsp;<span class="op" id="2617937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617940">for</span>&nbsp;<span class="ident" id="2617944">i</span>&nbsp;<span class="op" id="2617946">:=</span>&nbsp;<span class="num" id="2617949">0</span><span class="op" id="2617950">;</span>&nbsp;<span class="ident" id="2617952"><a href="/net/ip.go.html#2617944">i</a></span>&nbsp;<span class="op" id="2617954">&lt;</span>&nbsp;<span class="builtinfunc" id="2617956">len</span><span class="op" id="2617959">(</span><span class="ident" id="2617960"><a href="/net/ip.go.html#2617924">s</a></span><span class="op" id="2617961">)</span><span class="op" id="2617962">;</span>&nbsp;<span class="ident" id="2617964"><a href="/net/ip.go.html#2617944">i</a></span><span class="op" id="2617965">++</span>&nbsp;<span class="op" id="2617968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617972">switch</span>&nbsp;<span class="ident" id="2617979"><a href="/net/ip.go.html#2617924">s</a></span><span class="op" id="2617980">[</span><span class="ident" id="2617981"><a href="/net/ip.go.html#2617944">i</a></span><span class="op" id="2617982">]</span>&nbsp;<span class="op" id="2617984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2617988">case</span>&nbsp;<span class="string" id="2617993">&#39;.&#39;</span><span class="op" id="2617996">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618001">return</span>&nbsp;<span class="ident" id="2618008"><a href="/net/ip.go.html#2614866">parseIPv4</a></span><span class="op" id="2618017">(</span><span class="ident" id="2618018"><a href="/net/ip.go.html#2617924">s</a></span><span class="op" id="2618019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618023">case</span>&nbsp;<span class="string" id="2618028">&#39;:&#39;</span><span class="op" id="2618031">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618036">ip</span><span class="op" id="2618038">,</span>&nbsp;<span class="ident" id="2618040">_</span>&nbsp;<span class="op" id="2618042">:=</span>&nbsp;<span class="ident" id="2618045"><a href="/net/ip.go.html#2615492">parseIPv6</a></span><span class="op" id="2618054">(</span><span class="ident" id="2618055"><a href="/net/ip.go.html#2617924">s</a></span><span class="op" id="2618056">,</span>&nbsp;<span class="ident" id="2618058">false</span><span class="op" id="2618063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618068">return</span>&nbsp;<span class="ident" id="2618075"><a href="/net/ip.go.html#2618036">ip</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618080">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618086">return</span>&nbsp;<span class="ident" id="2618093">nil</span><br>
<span class="lineno"></span><span class="op" id="2618097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2618100">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="2618162">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2618223">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="2618249">//</span><br>
<span class="lineno"></span><span class="comment" id="2618252">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="2618315">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="2618380">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="2618444">func</span>&nbsp;<span class="ident" id="2618449">ParseCIDR</span><span class="op" id="2618458">(</span><span class="ident" id="2618459">s</span>&nbsp;<span class="builtintype" id="2618461">string</span><span class="op" id="2618467">)</span>&nbsp;<span class="op" id="2618469">(</span><span class="ident" id="2618470"><a href="/net/ip.go.html#2604330">IP</a></span><span class="op" id="2618472">,</span>&nbsp;<span class="op" id="2618474">*</span><span class="ident" id="2618475"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2618480">,</span>&nbsp;<span class="builtintype" id="2618482">error</span><span class="op" id="2618487">)</span>&nbsp;<span class="op" id="2618489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618492">i</span>&nbsp;<span class="op" id="2618494">:=</span>&nbsp;<span class="ident" id="2618497"><a href="/net/parse.go.html#2664110">byteIndex</a></span><span class="op" id="2618506">(</span><span class="ident" id="2618507"><a href="/net/ip.go.html#2618459">s</a></span><span class="op" id="2618508">,</span>&nbsp;<span class="string" id="2618510">&#39;/&#39;</span><span class="op" id="2618513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618516">if</span>&nbsp;<span class="ident" id="2618519"><a href="/net/ip.go.html#2618492">i</a></span>&nbsp;<span class="op" id="2618521">&lt;</span>&nbsp;<span class="num" id="2618523">0</span>&nbsp;<span class="op" id="2618525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618529">return</span>&nbsp;<span class="ident" id="2618536">nil</span><span class="op" id="2618539">,</span>&nbsp;<span class="ident" id="2618541">nil</span><span class="op" id="2618544">,</span>&nbsp;<span class="op" id="2618546">&amp;</span><span class="ident" id="2618547"><a href="/net/ip.go.html#2617529">ParseError</a></span><span class="op" id="2618557">{</span><span class="string" id="2618558">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="2618572">,</span>&nbsp;<span class="ident" id="2618574"><a href="/net/ip.go.html#2618459">s</a></span><span class="op" id="2618575">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618581">addr</span><span class="op" id="2618585">,</span>&nbsp;<span class="ident" id="2618587">mask</span>&nbsp;<span class="op" id="2618592">:=</span>&nbsp;<span class="ident" id="2618595"><a href="/net/ip.go.html#2618459">s</a></span><span class="op" id="2618596">[</span><span class="op" id="2618597">:</span><span class="ident" id="2618598"><a href="/net/ip.go.html#2618492">i</a></span><span class="op" id="2618599">]</span><span class="op" id="2618600">,</span>&nbsp;<span class="ident" id="2618602"><a href="/net/ip.go.html#2618459">s</a></span><span class="op" id="2618603">[</span><span class="ident" id="2618604"><a href="/net/ip.go.html#2618492">i</a></span><span class="op" id="2618605">+</span><span class="num" id="2618606">1</span><span class="op" id="2618607">:</span><span class="op" id="2618608">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618611">iplen</span>&nbsp;<span class="op" id="2618617">:=</span>&nbsp;<span class="ident" id="2618620"><a href="/net/ip.go.html#2603910">IPv4len</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618629">ip</span>&nbsp;<span class="op" id="2618632">:=</span>&nbsp;<span class="ident" id="2618635"><a href="/net/ip.go.html#2614866">parseIPv4</a></span><span class="op" id="2618644">(</span><span class="ident" id="2618645"><a href="/net/ip.go.html#2618581">addr</a></span><span class="op" id="2618649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618652">if</span>&nbsp;<span class="ident" id="2618655"><a href="/net/ip.go.html#2618629">ip</a></span>&nbsp;<span class="op" id="2618658">==</span>&nbsp;<span class="ident" id="2618661">nil</span>&nbsp;<span class="op" id="2618665">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618669"><a href="/net/ip.go.html#2618611">iplen</a></span>&nbsp;<span class="op" id="2618675">=</span>&nbsp;<span class="ident" id="2618677"><a href="/net/ip.go.html#2603923">IPv6len</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618687"><a href="/net/ip.go.html#2618629">ip</a></span><span class="op" id="2618689">,</span>&nbsp;<span class="ident" id="2618691">_</span>&nbsp;<span class="op" id="2618693">=</span>&nbsp;<span class="ident" id="2618695"><a href="/net/ip.go.html#2615492">parseIPv6</a></span><span class="op" id="2618704">(</span><span class="ident" id="2618705"><a href="/net/ip.go.html#2618581">addr</a></span><span class="op" id="2618709">,</span>&nbsp;<span class="ident" id="2618711">false</span><span class="op" id="2618716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618722">n</span><span class="op" id="2618723">,</span>&nbsp;<span class="ident" id="2618725"><a href="/net/ip.go.html#2618492">i</a></span><span class="op" id="2618726">,</span>&nbsp;<span class="ident" id="2618728">ok</span>&nbsp;<span class="op" id="2618731">:=</span>&nbsp;<span class="ident" id="2618734"><a href="/net/parse.go.html#2665011">dtoi</a></span><span class="op" id="2618738">(</span><span class="ident" id="2618739"><a href="/net/ip.go.html#2618587">mask</a></span><span class="op" id="2618743">,</span>&nbsp;<span class="num" id="2618745">0</span><span class="op" id="2618746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618749">if</span>&nbsp;<span class="ident" id="2618752"><a href="/net/ip.go.html#2618629">ip</a></span>&nbsp;<span class="op" id="2618755">==</span>&nbsp;<span class="ident" id="2618758">nil</span>&nbsp;<span class="op" id="2618762">||</span>&nbsp;<span class="op" id="2618765">!</span><span class="ident" id="2618766"><a href="/net/ip.go.html#2618728">ok</a></span>&nbsp;<span class="op" id="2618769">||</span>&nbsp;<span class="ident" id="2618772"><a href="/net/ip.go.html#2618492">i</a></span>&nbsp;<span class="op" id="2618774">!=</span>&nbsp;<span class="builtinfunc" id="2618777">len</span><span class="op" id="2618780">(</span><span class="ident" id="2618781"><a href="/net/ip.go.html#2618587">mask</a></span><span class="op" id="2618785">)</span>&nbsp;<span class="op" id="2618787">||</span>&nbsp;<span class="ident" id="2618790"><a href="/net/ip.go.html#2618722">n</a></span>&nbsp;<span class="op" id="2618792">&lt;</span>&nbsp;<span class="num" id="2618794">0</span>&nbsp;<span class="op" id="2618796">||</span>&nbsp;<span class="ident" id="2618799"><a href="/net/ip.go.html#2618722">n</a></span>&nbsp;<span class="op" id="2618801">&gt;</span>&nbsp;<span class="num" id="2618803">8</span><span class="op" id="2618804">*</span><span class="ident" id="2618805"><a href="/net/ip.go.html#2618611">iplen</a></span>&nbsp;<span class="op" id="2618811">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618815">return</span>&nbsp;<span class="ident" id="2618822">nil</span><span class="op" id="2618825">,</span>&nbsp;<span class="ident" id="2618827">nil</span><span class="op" id="2618830">,</span>&nbsp;<span class="op" id="2618832">&amp;</span><span class="ident" id="2618833"><a href="/net/ip.go.html#2617529">ParseError</a></span><span class="op" id="2618843">{</span><span class="string" id="2618844">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="2618858">,</span>&nbsp;<span class="ident" id="2618860"><a href="/net/ip.go.html#2618459">s</a></span><span class="op" id="2618861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2618864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2618867">m</span>&nbsp;<span class="op" id="2618869">:=</span>&nbsp;<span class="ident" id="2618872"><a href="/net/ip.go.html#2605185">CIDRMask</a></span><span class="op" id="2618880">(</span><span class="ident" id="2618881"><a href="/net/ip.go.html#2618722">n</a></span><span class="op" id="2618882">,</span>&nbsp;<span class="num" id="2618884">8</span><span class="op" id="2618885">*</span><span class="ident" id="2618886"><a href="/net/ip.go.html#2618611">iplen</a></span><span class="op" id="2618891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2618894">return</span>&nbsp;<span class="ident" id="2618901"><a href="/net/ip.go.html#2618629">ip</a></span><span class="op" id="2618903">,</span>&nbsp;<span class="op" id="2618905">&amp;</span><span class="ident" id="2618906"><a href="/net/ip.go.html#2604436">IPNet</a></span><span class="op" id="2618911">{</span><span class="ident" id="2618912">IP</span><span class="op" id="2618914">:</span>&nbsp;<span class="ident" id="2618916"><a href="/net/ip.go.html#2618629">ip</a></span><span class="op" id="2618918">.</span><span class="ident" id="2618919">Mask</span><span class="op" id="2618923">(</span><span class="ident" id="2618924"><a href="/net/ip.go.html#2618867">m</a></span><span class="op" id="2618925">)</span><span class="op" id="2618926">,</span>&nbsp;<span class="ident" id="2618928">Mask</span><span class="op" id="2618932">:</span>&nbsp;<span class="ident" id="2618934"><a href="/net/ip.go.html#2618867">m</a></span><span class="op" id="2618935">}</span><span class="op" id="2618936">,</span>&nbsp;<span class="ident" id="2618938">nil</span><br>
<span class="lineno"></span><span class="op" id="2618942">}</span>
</div>
</body>
</html>
